{"version":3,"sources":["webpack:///$_lazy_route_resource lazy namespace object","webpack:///src/app/app-routing.module.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///src/app/overlays/booking-confirm/booking-confirm.component.ts","webpack:///src/app/overlays/booking-confirm/booking-confirm.component.html","webpack:///src/app/overlays/booking-modal/booking-modal.component.ts","webpack:///src/app/overlays/booking-modal/booking-modal.component.html","webpack:///src/app/overlays/booking-modal/catering/catering.component.ts","webpack:///src/app/overlays/booking-modal/catering/catering.component.html","webpack:///src/app/overlays/booking-modal/catering/order-details/category/category.component.ts","webpack:///src/app/overlays/booking-modal/catering/order-details/category/category.component.html","webpack:///src/app/overlays/booking-modal/catering/order-details/item/item.component.ts","webpack:///src/app/overlays/booking-modal/catering/order-details/item/item.component.html","webpack:///src/app/overlays/booking-modal/catering/order-details/order-details.component.ts","webpack:///src/app/overlays/booking-modal/catering/order-details/order-details.component.html","webpack:///src/app/overlays/booking-modal/catering/order-list/item/item.component.ts","webpack:///src/app/overlays/booking-modal/catering/order-list/item/item.component.html","webpack:///src/app/overlays/booking-modal/catering/order-list/order-list.component.ts","webpack:///src/app/overlays/booking-modal/catering/order-list/order-list.component.html","webpack:///src/app/overlays/booking-modal/find-space/filters/filters.component.ts","webpack:///src/app/overlays/booking-modal/find-space/filters/filters.component.html","webpack:///src/app/overlays/booking-modal/find-space/find-space.component.ts","webpack:///src/app/overlays/booking-modal/find-space/find-space.component.html","webpack:///src/app/overlays/booking-modal/find-space/item/item.component.ts","webpack:///src/app/overlays/booking-modal/find-space/item/item.component.html","webpack:///src/app/overlays/booking-modal/form/form.component.ts","webpack:///src/app/overlays/booking-modal/form/form.component.html","webpack:///src/app/overlays/catering-confirm-modal/catering-confirm-modal.component.ts","webpack:///src/app/overlays/catering-confirm-modal/catering-confirm-modal.component.html","webpack:///src/app/overlays/catering-details-modal/catering-details-modal.component.ts","webpack:///src/app/overlays/catering-details-modal/catering-details-modal.component.html","webpack:///src/app/overlays/confirm-modal/confirm-modal.component.ts","webpack:///src/app/overlays/confirm-modal/confirm-modal.component.html","webpack:///src/app/overlays/meeting-details-modal/catering/catering.component.ts","webpack:///src/app/overlays/meeting-details-modal/catering/catering.component.html","webpack:///src/app/overlays/meeting-details-modal/details/details.component.ts","webpack:///src/app/overlays/meeting-details-modal/details/details.component.html","webpack:///src/app/overlays/meeting-details-modal/meeting-details-modal.component.ts","webpack:///src/app/overlays/meeting-details-modal/meeting-details-modal.component.html","webpack:///src/app/overlays/meeting-details-modal/private-details/private-details.component.ts","webpack:///src/app/overlays/meeting-details-modal/private-details/private-details.component.html","webpack:///src/app/overlays/meeting-details-modal/requirements/requirements.component.ts","webpack:///src/app/overlays/meeting-details-modal/requirements/requirements.component.html","webpack:///src/app/overlays/new-user-modal/new-user-modal.component.ts","webpack:///src/app/overlays/new-user-modal/new-user-modal.component.html","webpack:///src/app/overlays/overlays.module.ts","webpack:///src/app/overlays/package-options-modal/package-options-modal.component.ts","webpack:///src/app/overlays/package-options-modal/package-options-modal.component.html","webpack:///src/app/overlays/private-details-modal/private-details-modal.component.ts","webpack:///src/app/overlays/private-details-modal/private-details-modal.component.html","webpack:///src/app/overlays/recurrence-modal/recurrence-modal.component.ts","webpack:///src/app/overlays/recurrence-modal/recurrence-modal.component.html","webpack:///src/app/overlays/recurrence-spaces-modal/recurrence-spaces-modal.component.ts","webpack:///src/app/overlays/recurrence-spaces-modal/recurrence-spaces-modal.component.html","webpack:///src/app/overlays/requirement-details-modal/requirement-details-modal.component.ts","webpack:///src/app/overlays/requirement-details-modal/requirement-details-modal.component.html","webpack:///src/app/overlays/space-select-modal/space-select-modal.component.ts","webpack:///src/app/overlays/space-select-modal/space-select-modal.component.html","webpack:///src/app/services/app.service.ts","webpack:///src/app/services/data/base-api.class.ts","webpack:///src/app/services/data/base.service.ts","webpack:///src/app/services/data/bookings/booking.class.ts","webpack:///src/app/services/data/bookings/booking.utilities.ts","webpack:///src/app/services/data/bookings/bookings.service.ts","webpack:///src/app/services/data/catering/catering-categories.service.ts","webpack:///src/app/services/data/catering/catering-category.class.ts","webpack:///src/app/services/data/catering/catering-item.class.ts","webpack:///src/app/services/data/catering/catering-items.service.ts","webpack:///src/app/services/data/catering/catering-menu.service.ts","webpack:///src/app/services/data/catering/catering-order.class.ts","webpack:///src/app/services/data/location/location.class.ts","webpack:///src/app/services/data/location/location.utilities.ts","webpack:///src/app/services/data/organisation/building.class.ts","webpack:///src/app/services/data/organisation/level.class.ts","webpack:///src/app/services/data/organisation/organisation.class.ts","webpack:///src/app/services/data/organisation/organisation.service.ts","webpack:///src/app/services/data/reports/report.class.ts","webpack:///src/app/services/data/reports/reports.service.ts","webpack:///src/app/services/data/service-manager.class.ts","webpack:///src/app/services/data/spaces/space.class.ts","webpack:///src/app/services/data/spaces/space.utilities.ts","webpack:///src/app/services/data/spaces/spaces.service.ts","webpack:///src/app/services/data/users/user.class.ts","webpack:///src/app/services/data/users/user.utilities.ts","webpack:///src/app/services/data/users/users.service.ts","webpack:///src/app/services/hotkeys.service.ts","webpack:///src/app/services/settings.service.ts","webpack:///src/app/shared/base.class.ts","webpack:///src/app/shared/base.directive.ts","webpack:///src/app/shared/components/action-icon/action-icon.component.ts","webpack:///src/app/shared/components/action-icon/action-icon.component.html","webpack:///src/app/shared/components/custom-fields/action-field/action-field.component.ts","webpack:///src/app/shared/components/custom-fields/action-field/action-field.component.html","webpack:///src/app/shared/components/custom-fields/counter/counter.component.ts","webpack:///src/app/shared/components/custom-fields/counter/counter.component.html","webpack:///src/app/shared/components/custom-fields/date-field/date-field.component.ts","webpack:///src/app/shared/components/custom-fields/date-field/date-field.component.html","webpack:///src/app/shared/components/custom-fields/duration-field/duration-field.component.ts","webpack:///src/app/shared/components/custom-fields/duration-field/duration-field.component.html","webpack:///src/app/shared/components/custom-fields/time-field/time-field.component.ts","webpack:///src/app/shared/components/custom-fields/time-field/time-field.component.html","webpack:///src/app/shared/components/custom-fields/user-list-field/user-list-field.component.ts","webpack:///src/app/shared/components/custom-fields/user-list-field/user-list-field.component.html","webpack:///src/app/shared/components/custom-fields/user-search-field/user-search-field.component.ts","webpack:///src/app/shared/components/custom-fields/user-search-field/user-search-field.component.html","webpack:///src/app/shared/components/feedback/feedback.component.ts","webpack:///src/app/shared/components/feedback/feedback.component.html","webpack:///src/app/shared/components/forms/booking-form/booking-form.component.ts","webpack:///src/app/shared/components/forms/booking-form/booking-form.component.html","webpack:///src/app/shared/components/forms/user-form/user-form.component.ts","webpack:///src/app/shared/components/forms/user-form/user-form.component.html","webpack:///src/app/shared/components/icon/icon.component.ts","webpack:///src/app/shared/components/icon/icon.component.html","webpack:///src/app/shared/components/login/login.component.ts","webpack:///src/app/shared/components/login/login.component.html","webpack:///src/app/shared/components/popout-menu/popout-menu.component.ts","webpack:///src/app/shared/components/popout-menu/popout-menu.component.html","webpack:///src/app/shared/components/searchbar/searchbar.component.ts","webpack:///src/app/shared/components/searchbar/searchbar.component.html","webpack:///src/app/shared/components/sidebar/sidebar.component.ts","webpack:///src/app/shared/components/sidebar/sidebar.component.html","webpack:///src/app/shared/components/topbar-header/topbar-header.component.ts","webpack:///src/app/shared/components/topbar-header/topbar-header.component.html","webpack:///src/app/shared/components/user-avatar/user-avatar.component.ts","webpack:///src/app/shared/components/user-avatar/user-avatar.component.html","webpack:///src/app/shared/directives/cdk-drop-list-scroll-container.directive.ts","webpack:///src/app/shared/globals/angular-animations.ts","webpack:///src/app/shared/globals/application.ts","webpack:///src/app/shared/mocks/api/bookings.mock.ts","webpack:///src/app/shared/mocks/api/buildings.mock.ts","webpack:///src/app/shared/mocks/api/common.mock.ts","webpack:///src/app/shared/mocks/api/locations.mock.ts","webpack:///src/app/shared/mocks/api/organisation.mock.ts","webpack:///src/app/shared/mocks/api/spaces.mock.ts","webpack:///src/app/shared/mocks/api/users.mock.ts","webpack:///src/app/shared/mocks/index.ts","webpack:///src/app/shared/mocks/systems.mock.ts","webpack:///src/app/shared/shared.module.ts","webpack:///src/app/shared/utilities/api.utilities.ts","webpack:///src/app/shared/utilities/formatting.utilities.ts","webpack:///src/app/shared/utilities/general.utilities.ts","webpack:///src/app/shared/utilities/validation.utilities.ts","webpack:///src/app/shell/catering/catering.component.ts","webpack:///src/app/shell/catering/catering.component.html","webpack:///src/app/shell/catering/catering.module.ts","webpack:///src/app/shell/catering/menu/item-list/item-list.component.ts","webpack:///src/app/shell/catering/menu/item-list/item-list.component.html","webpack:///src/app/shell/catering/menu/item/item.component.ts","webpack:///src/app/shell/catering/menu/item/item.component.html","webpack:///src/app/shell/catering/menu/menu.component.ts","webpack:///src/app/shell/catering/menu/menu.component.html","webpack:///src/app/shell/catering/orders/item/item.component.ts","webpack:///src/app/shell/catering/orders/item/item.component.html","webpack:///src/app/shell/catering/orders/orders.component.ts","webpack:///src/app/shell/catering/orders/orders.component.html","webpack:///src/app/shell/catering/overlays/category-modal/category-modal.component.ts","webpack:///src/app/shell/catering/overlays/category-modal/category-modal.component.html","webpack:///src/app/shell/catering/overlays/group-modal/group-modal.component.ts","webpack:///src/app/shell/catering/overlays/group-modal/group-modal.component.html","webpack:///src/app/shell/catering/overlays/item-modal/item-modal.component.ts","webpack:///src/app/shell/catering/overlays/item-modal/item-modal.component.html","webpack:///src/app/shell/catering/overlays/order-details-modal/booking-details/booking-details.component.ts","webpack:///src/app/shell/catering/overlays/order-details-modal/booking-details/booking-details.component.html","webpack:///src/app/shell/catering/overlays/order-details-modal/items/items.component.ts","webpack:///src/app/shell/catering/overlays/order-details-modal/items/items.component.html","webpack:///src/app/shell/catering/overlays/order-details-modal/messages/messages.component.ts","webpack:///src/app/shell/catering/overlays/order-details-modal/messages/messages.component.html","webpack:///src/app/shell/catering/overlays/order-details-modal/order-details-modal.component.ts","webpack:///src/app/shell/catering/overlays/order-details-modal/order-details-modal.component.html","webpack:///src/app/shell/day-view/approvals-view/approvals-view.component.ts","webpack:///src/app/shell/day-view/approvals-view/approvals-view.component.html","webpack:///src/app/shell/day-view/approvals-view/event/event.component.ts","webpack:///src/app/shell/day-view/approvals-view/event/event.component.html","webpack:///src/app/shell/day-view/day-view.component.ts","webpack:///src/app/shell/day-view/day-view.component.html","webpack:///src/app/shell/day-view/day-view.module.ts","webpack:///src/app/shell/day-view/space/event/event.component.ts","webpack:///src/app/shell/day-view/space/event/event.component.html","webpack:///src/app/shell/day-view/space/space.component.ts","webpack:///src/app/shell/day-view/space/space.component.html","webpack:///src/app/shell/day-view/timeline/timeline.component.ts","webpack:///src/app/shell/day-view/timeline/timeline.component.html","webpack:///src/app/shell/reports/report-display/report-display.component.ts","webpack:///src/app/shell/reports/report-display/report-display.component.html","webpack:///src/app/shell/reports/report-table/report-table.component.ts","webpack:///src/app/shell/reports/report-table/report-table.component.html","webpack:///src/app/shell/reports/reports.component.ts","webpack:///src/app/shell/reports/reports.component.html","webpack:///src/app/shell/reports/reports.module.ts","webpack:///src/app/shell/shell.component.ts","webpack:///src/app/shell/shell.component.html","webpack:///src/app/shell/visitors/overlays/visitors-form-modal/event-form/event-form.component.ts","webpack:///src/app/shell/visitors/overlays/visitors-form-modal/event-form/event-form.component.html","webpack:///src/app/shell/visitors/overlays/visitors-form-modal/visitor-form/visitor-form.component.ts","webpack:///src/app/shell/visitors/overlays/visitors-form-modal/visitor-form/visitor-form.component.html","webpack:///src/app/shell/visitors/overlays/visitors-form-modal/visitors-form-modal.component.ts","webpack:///src/app/shell/visitors/overlays/visitors-form-modal/visitors-form-modal.component.html","webpack:///src/app/shell/visitors/timeline/item/item.component.ts","webpack:///src/app/shell/visitors/timeline/item/item.component.html","webpack:///src/app/shell/visitors/timeline/timeline.component.ts","webpack:///src/app/shell/visitors/timeline/timeline.component.html","webpack:///src/app/shell/visitors/timeline/visitor/visitor.component.ts","webpack:///src/app/shell/visitors/timeline/visitor/visitor.component.html","webpack:///src/app/shell/visitors/visitors.component.ts","webpack:///src/app/shell/visitors/visitors.component.html","webpack:///src/app/shell/visitors/visitors.module.ts","webpack:///src/app/shell/week-view/day-display/day-display.component.ts","webpack:///src/app/shell/week-view/day-display/day-display.component.html","webpack:///src/app/shell/week-view/day-display/item/item.component.ts","webpack:///src/app/shell/week-view/day-display/item/item.component.html","webpack:///src/app/shell/week-view/timeline/timeline.component.ts","webpack:///src/app/shell/week-view/timeline/timeline.component.html","webpack:///src/app/shell/week-view/week-view.component.ts","webpack:///src/app/shell/week-view/week-view.component.html","webpack:///src/app/shell/week-view/week-view.module.ts","webpack:///src/environments/environment.ts","webpack:///src/main.ts"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","routes","path","component","ShellWrapperComponent","children","loadChildren","m","DayViewModule","WeekViewModule","CateringModule","VisitorsModule","ReportsModule","redirectTo","AppRoutingModule","RouterModule","forRoot","useHash","NgModule","imports","AppComponent","_composer","_uploads","_md5_workers","_service","detectIE","location","href","origin","pathname","localStorage","removeItem","setup","initUploads","subscription","initialised","subscribe","state","timeout","token","auth","setTimeout","autoStart","endpoint","UploadManager","addProvider","Amazon","unsub","BaseDirective","Component","selector","templateUrl","styleUrls","encapsulation","ViewEncapsulation","None","AppModule","window","app_loaded","provide","MAT_LABEL_GLOBAL_OPTIONS","useValue","BrowserModule","BrowserAnimationsModule","ServiceWorkerModule","register","enabled","environment","production","HttpClientModule","FormsModule","ComposerModule","SharedOverlaysModule","SharedContentModule","declarations","providers","bootstrap","BookingConfirmComponent","_users","_org","_spaces","_dialog","_dialog_ref","_data","event","EventEmitter","loading","disableClose","checkSpaceAvailability","booking","save","success","emit","type","notifySuccess","err","notifyError","open","BookingModalComponent","data","Booking","close","spaces","changes","date","duration","length","reject","available","room_ids","map","space","join","space_list","was_available","name","options","host","organiser","reduce","request","byRequest","old_booking","title","date_value","duration_value","all_day","dayjs","end","add","format","isSame","humaniseDuration","attendees","filter","i","email","current","body","catering","order","find","a_space","location_id","level","building","buildings","bld","CateringOrder","symbol","currency","Object","key","Function","MAT_DIALOG_DATA","Inject","Output","console","log","pipe","first","_","flow_step","only_catering","loadFormData","toNextFlowStep","toPreviousFlowStep","resetForm","form","controls","value","step","metadata","ref","openEquipmentDetailsModal","has_catering","navigate","confirmBooking","order_list","openCateringDetailsModal","route","generateBookingForm","available_fields","form_data","toJSON","setValue","RequirementDetailsModalComponent","maxWidth","width","notes_field","notes","codes_field","equipment_codes","head_counts_field","expected_attendees","componentInstance","reason","afterClosed","CateringDetailsModalComponent","dirty","notifyInfo","valid","dialog_ref","maxHeight","setting","BookingCateringComponent","active_order","orders","index","findIndex","an_order","push","splice","startOf","valueOf","Input","CateringMenuCategoryComponent","CateringMenuItemComponent","field","list","item","an_item","setAmount","amount","valueChanges","selectPackageOptions","confirmed_item","CateringItem","notifyWarn","PackageOptionsModalComponent","CateringCategory","done","items","a_list","ANIMATION_SHOW_CONTRACT_EXPAND","animations","BookingCateringOrderDetailsComponent","_menu","category_list","available_times","generateAvailableTimes","time","delivery_time","initForm","FormGroup","FormControl","booking_date","loadMenu","BookingCateringConfirmModalComponent","query","room_id","start_date","generateStartAndEndTimes","start","minute","Math","ceil","isBefore","abs","diff","endOf","building_time","toDate","hour","as_dayjs","toLocalDate","possible_end","isAfter","active_building","within_restricted_time","has_available_items","form_controls","building_id","catering_restricted_from","total","restricted","subtract","category","can_order_anytime","confirmOrder","CateringOrderListItemComponent","edit","unit_price","BookingCateringOrderListComponent","forEach","next","BookingSpaceFiltersComponent","locations","locationsChange","building_list","now","listen","bld_list","unique","is_today","BookingFindSpaceComponent","zone_ids","change$","Subject","search_results$","debounceTime","distinctUntilChanged","switchMap","recurrence","recurrence_properties","period","recurr_period","toLowerCase","recurr_end","unix","bookable","catchError","of","onChange","multiple","concat","previous","BookingSpaceItemComponent","select","recurr_available","availability","selected","RecurrenceSpacesModalComponent","height","conflicts","recurr","conflict_list","replaces","count","ocurrence","BookingSpaceFlowFormComponent","can_return","markAllAsTouched","container","nativeElement","scrollIntoView","behavior","block","inline","ViewChild","item_list","codes","head_counts","needs_charge_code","active_space","note_list","note","message","charge_code","generateFormFields","is_valid","new_notes","author","submit","CONFIRM_METADATA","ConfirmModalComponent","content","action","icon","MeetingCateringDetailsComponent","setItem","JSON","stringify","creator","status","declined","MeetingDetailsDisplayComponent","person","pattern","RECURRENCE_PERIODS","MeetingDetailsModalComponent","_bookings","_on_error","setLoading","accept","comment","approval_status","decline","booking_id","icaluid","floor","date_string","start_time","deleteMeeting","acceptMeeting","declineMeeting","confirmDeleteMeeting","MeetingPrivateDetailsComponent","PrivateDetailsModalComponent","breakdown","openPrivateDetailsModal","MeetingDetailsRequirementsComponent","bookingChange","standalone","new_booking","NewUserModalComponent","user","User","generateUserForm","new_user","first_name","last_name","OVERLAYS","SpaceSelectModalComponent","RecurrenceModalComponent","CommonModule","ReactiveFormsModule","forChild","checkItemRequirements","must_select","getActiveItems","a_package","option","needed","active","available_durations","Array","fill","old_notes","saveChanges","RECURRENCE_METADATA","periods","details","Validators","required","occurrences","space_details","updateOccurrences","occurrence","unshift","replaced_by","head_count","equipment_code","search$","selected_spaces","request_map","types","active_type","update","space_types","ApplicationService","_app_ref","_zone","_title","_cache","_settings","_hotkeys","_analytics","_snackbar","_route_trail","_subjects","_observers","ServiceManager","setService","set","isStable","run","_stable","setupCache","waitForSettings","get","on_action","snackbar_ref","panelClass","afterDismissed","dismiss","onAction","msg","debug","notify","error","warn","info","args","stream","force","BehaviorSubject","getValue","asObservable","init","setupComposer","_initialised","application","composer","settings","protocol","domain","hostname","port","url","use_domain","mock","config","scope","auth_uri","token_uri","redirect_uri","handle_login","local_login","isEnabled","hash","activateUpdate","activated","reload","setInterval","checkForUpdate","bindings","title_suffix","setTitle","getTitle","api_endpoint","is_initialised","BaseClass","Injectable","providedIn","BaseDataClass","raw_data","event_subject","events","_server_names","zone_id","promise","d","task_name","parameters","task","obj","_changes","changeEvents","_timers","_intervals","_subscriptions","new_key","substr","undefined","serviceFor","BaseAPIService","_subscribers","_promises","_compare","a","b","_list_filter","_name","_api_route","load","engine","predicate","query_params","update_list","cache","toQueryString","result","http","process","results","new_item","updateList","post","analyticsEvent","method","concierge","post_data","_task","api_route","delay","stopPoll","sub","_poll","show","interval","complete","put","remove_ids","label","raw_item","old_list","compareFn","new_list","mixed_list","found","time_changed","_display","subject","start_epoch","Start","end_epoch","End","description","booking_type","visitors","_attendees","active_user","_location","location_name","Date","getTime","checked_in","checkins","notify_users","space_ids","_space_list","space_service","Space","show_as","edits","flatten","auto_approve","indexOf","sort","old_date","from_room","display","v","external","MINUTE","HOUR","DAY","WEEK","MONTH","DURATION_MAP","month","months","week","weeks","day","days","hours","minutes","BOOKING_COUNT","BOOKING_DATE","setMockBookingStartDatetime","generateMockBooking","override","random","padZero","faker","commerce","productName","generateMockUser","users","lorem","paragraph","address","city","getFreeBookingSlots","min_size","slots","bkn_start","bkn_end","getNextFreeBookingSlot","second","use_fields","user_service","current_user","fields","organiser_email","needs_space","setValidators","validateEndTime","disable","isFuture","simplified_fields","enable","control","rulesForSpace","space_rules_for_user","hide","rules","hasOwnProperty","zones","zone","rule_block","checkRules","conditions","ruleset","max_length","stringToMinutes","min_length","matches","counter","condition","groups","j","last_location","check","match","durationGreaterThanOrEqual","getMinLength","rule_list","values","min","min_block","el","duration_1","duration_2","str","parts","split","statusFromBookings","bookings","requestable","free_slots","next_free_slot","slot","currently_free","time_until_next_block","free_tomorrow","free_today","available_until","timeFormatString","BookingsService","localeCompare","CateringCategoriesService","order_anytime","anytime","_amount","instance_id","from_month","available_from","to_month","available_to","prior_notice","notice","price","supplier_cost","minimum_quantity","max","maximum_quantity","parent_categories","category_ids","categories","image_path","catering_type","out_of_stock","allergy","CateringItemsService","CateringMenuService","kitchen","pantry","with_changes","MapLocation","org_service","Organisation","map_id","desk_id","x","normalise","x_max","y","BuildingLevel","levelWithID","fixed","confidence","at_desk","empty","generateMockLocation","overrides","fixed_locations","maps","randomInt","Building","__type","disc_info","discovery_info","_extras","extras","extra_id","extra_name","_loan_items","loan_items","_levels","levels","_roles","roles","_lockers","lockers","locker_structure","_systems","systems","_phone_numbers","phone_numbers","longitude","latitude","_searchables","neighbourhoods","lvl","lvl_features","feature","level_id","booking_details","booking_rules","timezone","holding_bay","visitor_space","getItemWithKeys","_zones","bld_id","level_name","lower_name","num","replace","toUpperCase","short_name","map_url","floor_type","OrganisationService","_organisation","ids","_active_building","getItem","organisation","loadOrganisation","loadBuildings","loadLevels","loadSpaceTypes","tags","org_data","limit","bld_data","lvl_data","type_data","Report","cleanData","downloadFile","jsonToCsv","room_field","includes","price_field","date_field","row","room","CurrencyPipe","transform","formatRecurrence","csv_json","csvToJson","ReportsService","fromCSV","service","_service_list","provider","provideFor","OPTION_DEFAULTS","long_name","book_type","can_search","searchable","can_control","controlable","hourly_rate","cost_hour","capacity","occurence","support_url","image","raw_bookings","bkn","linked_spaces","linked_rooms","rm","rulesFor","bookingsFor","SPACE_COUNT","generateMockSpace","firstName","lastName","linked","USER_DOMAIN","business","availabilityOptionsToQuery","SpacesService","respond","available_spaces","_desk_bookings","windows_id","visitor","phone","mobile","business_unit","department","organisation_id","organisation_name","staff_code","fmno","delegates","officeLocation","desk","l","USER_COUNT","USER_EMAILS","company","companyName","delegate_count","phoneNumber","avatar","UsersService","uhttp","expiry","client_id","Md5","hashStr","sessionStorage","go","headers","HttpHeaders","append","authorise","logout","tries","locate","loadDelegates","promises","all","INVALID_STANDALONE_KEYS","HotkeysService","keydown_states","keydown_observers","combo_end","registered_combos","addEventListener","mapKey","last_down","preventDefault","combo","combination","validCombination","last_key","updateCombinationEndList","presses","key_list","non_meta","SettingsService","api","local","session","_app_name","built","build","core_version","version","loadFromFile","app","colors","app_name","shift","file","file_name","clearTimeout","clearInterval","fn","Subscription","unsubscribe","destroy","Directive","ActionIconComponent","ActionFieldComponent","show_tooltip","performAction","CounterComponent","ctrl_key","shift_key","new_value","_onChange","_onTouch","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","remove","DateFieldComponent","_from","position","offset","disabled","_trigger","closeMenu","openMenu","_to","menuOpen","MatMenuTrigger","openDatePicker","$event","stopPropagation","closeDatePicker","DurationFieldComponent","duration_options","generateDurationOptions","blocks","TimeFieldComponent","no_past_times","show_select","_time_options","select_field","focus","openedChange","datestamp","show_past","showSelect","UserListFieldComponent","q","slice","filterList","search_str","user_list","match_name","matchToHighlight","match_email","active_list","a_user","target","files","reader","FileReader","readAsText","evt","processCsvData","srcElement","addUser","template","addUsersFromFile","downloadCSVTemplate","UserSearchFieldComponent","resetSearchString","FeedbackComponent","_router","updateRoute","document","NavigationEnd","current_page","BookingFormComponent","UserFormComponent","IconComponent","LoginComponent","username","password","logo","login","setErrors","PopoutMenuComponent","actions","SearchbarComponent","valueChange","autofocus","focusField","input_field","SidebarComponent","TopbarHeaderComponent","_cdr","show_events","dateChange","event_map","detectChanges","trigger","changeDate","resetDate","UserAvatarComponent","ScrollDirection","CdkDropListScrollContainer","_cdkDropList","_renderer","direction","X","last_scroll","scrollContainer","element","closest","toArray","onDrop","onDrag","updateListPosition","scroll","scrollLeft","scrollTop","BOTH","Y","_dropListRef","_cacheOwnPosition","_siblings","isReceiving","CdkDrag","ContentChildren","ANIMATION_SHOW_ENTER_LEAVE","transition","style","opacity","animate","handlers","MOCK_BOOKINGS","rooms","MOCK_SPACES","MOCK_USERS","API","callback","from","to","route_params","MOCK_BUILDINGS","emergency","av_help","desk_tracking","desk_bookings","messaging","features","number","map_features","desks","DOMAIN","MOCK_ORG","MOCK_LOCATIONS","lvls","send_acceptance","space_data","Bookings","today","MOCK_CONTACTS","PREDEFINED_USERS","createSystem","LETTERS","NUMBERS","SPACE_LIST","IMAGES","booking_bindings","touch_enabled","cancel_timeout","control_url","desk_bindings","system","DeskManagement","DeskBookings","room_name","$start_meeting","last_meeting_started","$cancel_meeting","$waiter_call","$book","$check_in","$check_out","COMPONENTS","DIRECTIVES","ENTRY_COMPONENT","MATERIAL_MODULES","MatButtonModule","MatSnackBarModule","MatDialogModule","MatFormFieldModule","MatInputModule","MatProgressSpinnerModule","MatProgressBarModule","MatAutocompleteModule","MatSelectModule","MatChipsModule","MatRippleModule","MatMenuModule","MatCheckboxModule","MatTooltipModule","MatRadioModule","MatTabsModule","MatSlideToggleModule","CDK_MODULES","ScrollingModule","DragDropModule","CdkTableModule","APipesModule","ADatePickerModule","ACustomEventsModule","EditorModule","formatAttendeesWithHost","formatAttendees","attendee_str","formatDate","formatTime","formatPeriodWithDuration","t","formatPeriod","timestamp","formatDuration","formatSpaces","isMobileDevice","r","navigator","userAgent","isMobileSafari","agent","isAndroidChrome","toString","array","pos","arr","short","h","filters","f","word","regex","RegExp","parse","match_count","match_index","field_list","matched","changed","tokens","k","timeToDate","is24HourTime","localeString","toLocaleTimeString","filename","contents","createElement","setAttribute","encodeURIComponent","appendChild","click","removeChild","csv","lines","line","part","json","valid_keys","ua","msie","parseInt","substring","trident","rv","edge","eventToPoint","MouseEvent","clientX","clientY","touches","an_array","stack","res","pop","isArray","reverse","HAS_ERROR","validateDate","is_from","buildValidateStartTime","c","validateStartTime","date_obj","buildValidateDuration","validateDuration","buildValidateAttendees","validateAttendees","invalid","date_control","end_time","CateringComponent","_route","order_type","paramMap","params","has","page","ROUTES","CateringOrdersComponent","CateringMenuComponent","CateringMenuItemListComponent","CateringCategoryModalComponent","CateringGroupModalComponent","CateringItemModalComponent","CateringOrdersItemComponent","OrderDetailsModalComponent","OrderDetailsItemsComponent","OrderBookingDetailsComponent","OrderDetailsNotesComponent","openGroupModal","group","parent_id","parent","openItemModal","deleteItem","catering_menu","filtered_menu","loadCateringMenu","search","openCategoryModal","menu","statuses","colour","active_status","viewOrderDetails","filtered_orders","initBookings","queryParamMap","view_id","sub_item","sub_sub_item","_menu_categories","_upload_manager","fileReader","uploading","arrayBuffer","blob","blobUtil","arrayBufferToBlob","upload","uploads","access_url","readAsArrayBuffer","_menu_items","storeBooking","new_note","order_id","pending_booking","addNote","updated_booking","deliver_at_time","DayViewApprovalsComponent","getMonthlyPending","updateMeetings","processMeetings","previousValue","currentValue","room_list","waiting_on_event","pending_list","tentative","STATES","DayViewApprovalsEventComponent","acting","length_string","DayViewComponent","active_level","legend","legend_keys","color","updateLevel","newMeeting","DayViewTimelineComponent","DayViewSpaceComponent","DayViewSpaceEventComponent","overlap","calculatePosition","queryParams","view","shown_date","toFixed","top","left","overflow_top","overflow_bottom","has_visitors","time_period","expected","inView","dragging","overlap_details","position_list","overflow_only","checkInView","last_update","calculateOverlaps","collisions","cmp","cmp_start","cmp_end","in_view","offsetLeft","innerWidth","box","getBoundingClientRect","delta","pointerPosition","scroll_top","top_minutes","round","previousContainer","new_start","handleDropError","override_state","room_count","Set","size","checkCollisions","moveBooking","ignore","hide_bookings","confirm_msg","drop","UPDATE_INTERVAL","time_blocks","generateTimeBlocks","scroll_left","scroll_offset","filtered_spaces","loading_space","show_holding_bay","scroll_area","initSpaces","updateTime","updateBookings","room_type","updateScroll","active_hour","visible_rooms","space_type","querySelector","scroll_box","scrollTo","scrollHeight","scrollWidth","is_dragging","bottom","right","scrollView","cancelScroll","clearSelected","HostListener","ReportDisplayComponent","_reports","end_date","report","report_data","downloadCSV","generateReport","downloadReport","ReportTableComponent","hide_fields","ReportsComponent","reports","src","active_report","loading_state","is_logged_in","mod","EventFormComponent","addFrom","VisitorFormComponent","personChange","minLength","VisitorsFormModalComponent","VisitorBookingItemComponent","show_attendees","checked_in_users","counts","VisitorTimelineComponent","visitor_bookings","filtered_bookings","date_display","VisitorComponent","_element","is_match","addClass","removeClass","VisitorsComponent","WeekViewDayDisplayComponent","booking_list","WeekViewItemComponent","WeekViewTimelineComponent","date_list","generateDates","weekends","WeekViewComponent","enableProdMode","platformBrowser","bootstrapModule"],"mappings":"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","file":"main-es5.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ShellWrapperComponent } from './shell/shell.component';\n\nconst routes: Routes = [\n    {\n        path: '',\n        component: ShellWrapperComponent,\n        children: [\n            {\n                path: 'day-view',\n                loadChildren: () =>\n                    import('./shell/day-view/day-view.module').then(m => m.DayViewModule)\n            },\n            {\n                path: 'week-view',\n                loadChildren: () =>\n                    import('./shell/week-view/week-view.module').then(m => m.WeekViewModule)\n            },\n            {\n                path: 'catering',\n                loadChildren: () =>\n                    import('./shell/catering/catering.module').then(m => m.CateringModule)\n            },\n            {\n                path: 'visitors',\n                loadChildren: () =>\n                    import('./shell/visitors/visitors.module').then(m => m.VisitorsModule)\n            },\n            {\n                path: 'reports',\n                loadChildren: () =>\n                    import('./shell/reports/reports.module').then(m => m.ReportsModule)\n            },\n            { path: '**', redirectTo: 'day-view' }\n        ]\n    },\n    { path: '**', redirectTo: 'day-view' }\n];\n\n@NgModule({\n    imports: [RouterModule.forRoot(routes, { useHash: true })],\n    exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n","import { Component, ViewEncapsulation } from '@angular/core';\nimport { UploadManager, Amazon, Md5Workers } from '@acaprojects/ngx-uploads';\nimport { ComposerService } from '@placeos/composer';\n\nimport { detectIE } from './shared/utilities/general.utilities';\nimport { BaseDirective } from './shared/base.directive';\nimport { ApplicationService } from './services/app.service';\n\n@Component({\n    selector: 'app-root',\n    templateUrl: './app.component.html',\n    styleUrls: [\n        './styles/app.component.scss',\n        './styles/custom-element.styles.scss',\n        './styles/native-element.styles.scss',\n    ],\n    encapsulation: ViewEncapsulation.None,\n})\nexport class AppComponent extends BaseDirective {\n    constructor(\n        private _composer: ComposerService,\n        private _uploads: UploadManager,\n        private _md5_workers: Md5Workers,\n        private _service: ApplicationService\n    ) {\n        super();\n        /* istanbul ignore if */\n        if (detectIE() && detectIE() < 12) {\n            location.href = `${location.origin}${location.pathname}assets/not-supported.html`;\n            return;\n        }\n        localStorage.removeItem('CONCIERGE.date');\n        this._md5_workers.setup('assets/md5_worker.js');\n        this.initUploads();\n    }\n\n    private initUploads() {\n        this.subscription(\n            'composer',\n            this._service.initialised.subscribe((state) => {\n                /* istanbul ignore else */\n                if (state) {\n                    this.timeout('init_uploads', () => {\n                        const token = this._composer.auth.token;\n                        if (!token) {\n                            return setTimeout(() => this.initUploads(), 300);\n                        }\n                        this._uploads.token = token;\n                        this._uploads.autoStart = true;\n                        this._uploads.endpoint = '/api/staff/uploads';\n                        UploadManager.addProvider(Amazon);\n                    });\n                    this.unsub('composer');\n                }\n            })\n        );\n    }\n}\n","<div class=\"app\">\n    <router-outlet></router-outlet>\n</div>\n","import { BrowserModule } from '@angular/platform-browser';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\nimport { NgModule } from '@angular/core';\nimport { HttpClientModule } from '@angular/common/http';\nimport { FormsModule } from '@angular/forms';\nimport { MAT_LABEL_GLOBAL_OPTIONS } from '@angular/material/core';\n\nimport './shared/mocks';\n\nimport { ComposerModule } from '@placeos/composer';\n\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\nimport { ServiceWorkerModule } from '@angular/service-worker';\nimport { environment } from '../environments/environment';\n\nimport { SharedOverlaysModule } from './overlays/overlays.module';\nimport { SharedContentModule } from './shared/shared.module';\n\nimport { ShellWrapperComponent } from './shell/shell.component';\n\ndeclare global {\n    interface Window {\n        app_loaded: boolean;\n    }\n}\n\n@NgModule({\n    declarations: [\n        AppComponent,\n        ShellWrapperComponent,\n    ],\n    imports: [\n        BrowserModule,\n        BrowserAnimationsModule,\n        AppRoutingModule,\n        ServiceWorkerModule.register('ngsw-worker.js', { enabled: environment.production }),\n        HttpClientModule,\n        FormsModule,\n        ComposerModule,\n        SharedOverlaysModule,\n        SharedContentModule\n    ],\n    providers: [\n        { provide: MAT_LABEL_GLOBAL_OPTIONS, useValue: {float: 'nevet'} }\n    ],\n    bootstrap: [AppComponent]\n})\nexport class AppModule {\n    constructor() {\n        window.app_loaded = true;\n    }\n}\n","import { Component, EventEmitter, Inject, Output } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef, MatDialog } from '@angular/material/dialog';\n\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { HashMap } from 'src/app/shared/utilities/types.utilities';\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { humaniseDuration } from 'src/app/shared/utilities/general.utilities';\nimport { User } from 'src/app/services/data/users/user.class';\nimport { CateringOrder } from 'src/app/services/data/catering/catering-order.class';\nimport { BookingModalComponent } from '../booking-modal/booking-modal.component';\n\nimport * as dayjs from 'dayjs';\nimport { UsersService } from 'src/app/services/data/users/users.service';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\n\nexport interface BookingConfirmModalData {\n    old_booking: Booking\n    booking: Booking\n}\n\n@Component({\n    selector: 'a-booking-confirm-modal',\n    templateUrl: './booking-confirm.component.html',\n    styleUrls: ['./booking-confirm.component.scss']\n})\nexport class BookingConfirmComponent extends BaseDirective {\n    /** Emitter for user actions on the modal */\n    @Output() public event = new EventEmitter();\n    /** Display string for changes are being processed */\n    public loading: string;\n    /** Whether space availability is being checked */\n    public checking_available: boolean;\n    /** Whether to show all attendees */\n    public show_attendees: boolean;\n    /** Whether to show all attendees */\n    public show_locations: boolean;\n    /** Whether to show all catering orders */\n    public show_orders: boolean;\n    /** Whether booking has succeeded */\n    public success: boolean;\n\n    /** Whether booking needs to be accepted */\n    public get is_request(): boolean {\n        const options = {\n            date: this.booking.date,\n            duration: this.booking.duration,\n            host: this.organiser\n        };\n        return this.spaces.reduce((request, space) => request || space.byRequest(options), false);\n    }\n\n    /** Booking to confirm changes to */\n    public get old_booking(): Booking {\n        return this._data.old_booking;\n    }\n\n    /** Booking to confirm changes to */\n    public get booking(): Booking {\n        return this._data.booking;\n    }\n\n    /** Title of the displayed event */\n    public get title(): string {\n        return this.booking.title;\n    }\n\n    /** Display string of when the event will occur */\n    public get when(): string {\n        const date_value = this.booking.date;\n        const duration_value = this.booking.duration;\n        const all_day = this.booking.all_day;\n        const date = dayjs(date_value);\n        const end = date.add(duration_value, 'm');\n        if (all_day || duration_value > 23 * 60) {\n            return `${date.format('DD MMM YYYY')} - All Day`;\n        } else {\n            if (date.isSame(end, 'd')) {\n                return `${date.format('DD MMM YYYY, h:mm A')} - ${end.format('h:mm A')}`;\n            } else {\n                return `${date.format('DD MMM YYYY, h:mm A')} - ${end.format(\n                    'DD MMM YYYY, h:mm A'\n                )}`;\n            }\n        }\n    }\n\n    /** Display string for the event's duration */\n    public get duration(): string {\n        const duration_value = this.booking.duration;\n        return humaniseDuration(duration_value);\n    }\n\n    /** List of spaces associated with the event */\n    public get spaces(): Space[] {\n        return this.booking.space_list\n    }\n\n    /** List of attendees associated with the event not including the host */\n    public get attendees(): User[] {\n        const attendees = this.booking.attendees;\n        return attendees.filter(i => i.email !== this.organiser.email);\n    }\n\n    /** Host of the event */\n    public get organiser(): User {\n        return (\n             this.booking.organiser || this._users.current\n        );\n    }\n\n    /** Details about the event */\n    public get notes(): string {\n        return this.booking.body;\n    }\n\n    /** List of catering orders in the booking */\n    public get catering(): CateringOrder[] {\n        return (this.booking.catering || []).map(order => {\n            const space: any = this.spaces.find(a_space => a_space.id === order.location_id) || {\n                level: {}\n            };\n            const building: any =\n                this._org.buildings.find(bld => bld.id === space.level.id) || {};\n            return new CateringOrder({ ...order, location: space.name, symbol: building.currency });\n        });\n    }\n\n    /** Map of changes to the booking */\n    public get changes(): HashMap<boolean> {\n        if (!this.booking.id && this.old_booking) {\n            return {};\n        }\n        return Object.keys(this.booking).reduce((map, key) => {\n            if (!(this.booking[key] instanceof Function) && key[0] !== '_') {\n                map[key] = this.booking[key] !== this.old_booking[key];\n            }\n            return map;\n        }, {});\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _users: UsersService,\n        private _org: OrganisationService,\n        private _spaces: SpacesService,\n        private _dialog: MatDialog,\n        private _dialog_ref: MatDialogRef<BookingConfirmComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: BookingConfirmModalData\n    ) {\n        super();\n    }\n\n    /**\n     * Save booking changes\n     */\n    public saveChanges() {\n        this.loading = 'Checking availability of selected spaces';\n        this._dialog_ref.disableClose = true;\n        this.checkSpaceAvailability().then(\n            () => {\n                this.loading = 'Processing booking request...';\n                this.booking.save().then(\n                    () => {\n                        this.loading = null;\n                        this.success = true;\n                        this._dialog_ref.disableClose = false;\n                        this.event.emit({ type: 'success' });\n                        this._service.notifySuccess(\n                            `Successfully ${this.booking.id ? 'updated' : 'created'} booking`\n                        );\n                    },\n                    err => {\n                        this.loading = null;\n                        this._dialog_ref.disableClose = false;\n                        this._service.notifyError(\n                            `Error ${this.booking.id ? 'updating' : 'creating'} booking: ${err}`\n                        );\n                    }\n                );\n            },\n            err => {\n                this.loading = null;\n                this._dialog_ref.disableClose = false;\n                this._service.notifyError(`Error checking space availability: ${err}`);\n            }\n        );\n    }\n\n    public newBooking() {\n        this._dialog.open(BookingModalComponent, {\n            data: {\n                booking: new Booking({})\n            }\n        });\n        this._dialog_ref.close();\n    }\n\n    /**\n     * Check whether the selected spaces are available for the selected time period\n     */\n    public checkSpaceAvailability(): Promise<void> {\n        const spaces: Space[] = this.spaces;\n        if (\n            (this.booking.id && !this.changes.date && !this.changes.duration) ||\n            (spaces && spaces.length <= 0)\n        ) {\n            return Promise.resolve();\n        }\n        return new Promise((resolve, reject) => {\n            this._spaces.available({\n                room_ids: spaces.map(space => space.id).join(','),\n                date: this.booking.date,\n                duration: this.booking.duration\n            }).then(\n                space_list => {\n                    for (const space of space_list) {\n                        if (!space.was_available) {\n                            return reject(\n                                `${space.name} is not available at the select time period.`\n                            );\n                        }\n                    }\n                    resolve();\n                },\n                err => reject(err)\n            );\n        });\n    }\n}\n","<mat-dialog-content *ngIf=\"!loading; else load_state\">\n    <main>\n        <button name=\"close\" mat-icon-button mat-dialog-close>\n            <app-icon\n                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"\n            ></app-icon>\n        </button>\n        <div class=\"details\">\n            <img\n                [src]=\"\n                    success\n                        ? is_request\n                            ? 'assets/img/requested.svg'\n                            : 'assets/img/confirmed.svg'\n                        : 'assets/img/edit.svg'\n                \"\n            />\n            <div class=\"text\">\n                Booking Details\n                <span *ngIf=\"success && !is_request\">Confirmed!</span>\n                <span class=\"request\" *ngIf=\"success && is_request\">Requested!</span>\n            </div>\n            <div class=\"info\" *ngIf=\"success && is_request\">Please await confirmation of room</div>\n        </div>\n        <div class=\"field\" name=\"title\">\n            <label>Title<span *ngIf=\"changes.title\">*</span>:</label>\n            <div class=\"value\">{{ title || 'No title' }}</div>\n        </div>\n        <div class=\"field\" name=\"when\">\n            <label>When<span *ngIf=\"changes.date\">*</span>:</label>\n            <div class=\"value\">{{ when }}</div>\n        </div>\n        <div class=\"field\" name=\"duration\">\n            <label>Duration<span *ngIf=\"changes.duration\">*</span>:</label>\n            <div class=\"value\">{{ duration }}</div>\n        </div>\n        <div class=\"field multi\" name=\"location\">\n            <label\n                >Locations({{ spaces.length || '0' }})<span *ngIf=\"changes.location\">*</span\n                >:</label\n            >\n            <div class=\"value\">\n                <div class=\"list\" [class.shown]=\"show_locations\">\n                    <div class=\"list-item\" *ngFor=\"let item of spaces\" [title]=\"item?.name\">\n                        <div class=\"text\">{{ item?.name }}</div>\n                    </div>\n                    <div class=\"list-item\" *ngIf=\"!spaces.length\">No Locations</div>\n                </div>\n                <button\n                    class=\"show\"\n                    *ngIf=\"spaces.length > 5\"\n                    (touchrelease)=\"show_locations = !show_locations\"\n                >\n                    {{ show_locations ? 'Hide' : 'Show' }} Locations\n                </button>\n            </div>\n        </div>\n        <div class=\"field\" name=\"host\">\n            <label>Host<span *ngIf=\"changes.organiser\">*</span>:</label>\n            <div class=\"value\">{{ organiser?.name || organiser?.email }}</div>\n        </div>\n        <div class=\"field\" name=\"attendees\">\n            <label\n                >Attendees({{ attendees.length || '0' }})<span *ngIf=\"changes.attendees\">*</span\n                >:</label\n            >\n            <div class=\"value\">\n                <span *ngIf=\"!attendees || !attendees.length\">&lt;No Attendees&gt;</span>\n                <div class=\"list\" [class.shown]=\"show_attendees\">\n                    <div\n                        class=\"list-item\"\n                        *ngFor=\"let item of attendees\"\n                        [title]=\"item?.name + (item?.email ? '\\n' + item.email : '')\"\n                    >\n                        <div class=\"text\">\n                            <div class=\"name\">{{ item.name }}</div>\n                            <div class=\"email\" *ngIf=\"item.email\">\n                                <a [href]=\"'mailto:' + item.email + '?subject=' + booking.title\">{{\n                                    item.email\n                                }}</a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <button\n                    class=\"show\"\n                    *ngIf=\"attendees.length > 5\"\n                    (touchrelease)=\"show_attendees = !show_attendees\"\n                >\n                    {{ show_attendees ? 'Hide' : 'Show' }} Attendees\n                </button>\n            </div>\n        </div>\n        <div class=\"field\" name=\"notes\">\n            <label>Notes<span *ngIf=\"changes.body\">*</span>:</label>\n            <div class=\"value\" [innerHTML]=\"notes || 'No notes'\"></div>\n        </div>\n        <div class=\"field\" name=\"catering\">\n            <label\n                >Catering Orders({{ catering.length || '0' }})<span *ngIf=\"changes.catering\">*</span\n                >:</label\n            >\n            <div class=\"value\">\n                <div class=\"list\" [class.shown]=\"show_orders\">\n                    <div class=\"list-item\" *ngFor=\"let order of catering\">\n                        <div class=\"text\">\n                            <div class=\"name\">{{ order.location || '&lt;Removed&gt;' }}</div>\n                            <div class=\"email\">\n                                {{ order.item_count }} item{{ order.item_count === 1 ? '' : '' }} |\n                                {{ order.total / 100 | currency: order.symbol }}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <button\n                    class=\"show\"\n                    *ngIf=\"attendees.length > 5\"\n                    (touchrelease)=\"show_orders = !show_orders\"\n                >\n                    {{ show_orders ? 'Hide' : 'Show' }} Catering orders\n                </button>\n            </div>\n        </div>\n        <div class=\"info\" *ngIf=\"booking?.id\">\n            * - changed fields\n        </div>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions *ngIf=\"!loading\">\n    <footer>\n        <ng-container *ngIf=\"!success; else success_actions\">\n            <button mat-button class=\"inverse\" mat-dialog-close>Edit</button>\n            <button mat-button (tapped)=\"saveChanges()\">Save</button>\n        </ng-container>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main>\n        <div class=\"info-block center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">\n                {{ loading }}\n            </div>\n        </div>\n    </main>\n</ng-template>\n<ng-template #success_actions>\n    <button mat-button class=\"inverse\" name=\"new\" (tapped)=\"newBooking()\">New Booking</button>\n    <button mat-button mat-dialog-close>Close</button>\n</ng-template>\n","import { Component, OnInit, Inject } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport { MatDialog, MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { first } from 'rxjs/operators';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { AvailableBookingFields } from 'src/app/shared/utilities/settings.interfaces';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { HashMap, DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { generateBookingForm } from 'src/app/services/data/bookings/booking.utilities';\nimport { CateringDetailsModalComponent, CateringDetailsModalData } from '../catering-details-modal/catering-details-modal.component';\nimport { BookingConfirmComponent } from '../booking-confirm/booking-confirm.component';\nimport { RequirementDetailsModalComponent, RequirementDetailsModalData } from '../requirement-details-modal/requirement-details-modal.component';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\n\n\nexport interface BookingFlowEvent {\n    /** Type of flow event */\n    type: 'previous' | 'next' | 'reset' | 'close' | 'error';\n    /** Step which the event was emitted from */\n    step: string;\n    /** Additional metadata for the event */\n    metadata?: HashMap;\n}\n\nexport interface BookingModalData {\n    /** Booking to create/edit */\n    booking: Booking;\n    /** Whether to edit only catering */\n    only_catering?: boolean;\n}\n\n@Component({\n    selector: 'a-booking-modal',\n    templateUrl: './booking-modal.component.html',\n    styleUrls: ['./booking-modal.component.scss'],\n})\nexport class BookingModalComponent extends BaseDirective implements OnInit {\n    /** Form fields */\n    public form: FormGroup;\n    /** Form data store */\n    public booking: Booking;\n    /** Step of the booking flow that is currently active */\n    public flow_step: string;\n\n    /** Whether to edit only catering */\n    public get only_catering(): boolean {\n        return !!this._data.only_catering;\n    }\n\n    /** List of available booking fields for the form */\n    public get available_fields(): AvailableBookingFields[] {\n        return this._service.setting('app.booking.show_fields') || [];\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _spaces: SpacesService,\n        private _dialog: MatDialog,\n        private _dialog_ref: MatDialogRef<BookingModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: BookingModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        console.log('Init:');\n        this._dialog_ref.disableClose = true;\n        this._spaces.initialised.pipe(first(_ => _)).subscribe(() => {\n            console.log('Spaces loaded');\n            this.flow_step = this._data.only_catering ? 'catering' : 'form';\n            this.loadFormData();\n        });\n    }\n\n    /**\n     * Handle events from child components\n     * @param event Booking flow event\n     */\n    public handleFlowEvent(event: BookingFlowEvent) {\n        /* istanbul ignore else */\n        if (event.type === 'next') {\n            this.toNextFlowStep(event);\n        } else if (event.type === 'previous') {\n            this.toPreviousFlowStep(event);\n        } else if (event.type === 'reset') {\n            this.resetForm();\n        }\n    }\n\n    public close() {\n        this._dialog_ref.close();\n    }\n\n    private toNextFlowStep(event: BookingFlowEvent) {\n        const space_list = this.form.controls.space_list.value;\n        switch (event.step) {\n            case 'search':\n                if (\n                    space_list &&\n                    space_list.length &&\n                    (!event.metadata || !event.metadata.ref || event.metadata.ref !== 'equipment')\n                ) {\n                    this.openEquipmentDetailsModal();\n                } else {\n                    if (this.form.controls.has_catering && this.form.controls.has_catering.value) {\n                        this.navigate('catering');\n                    } else {\n                        this.navigate('form');\n                        this.confirmBooking();\n                    }\n                }\n                break;\n            case 'catering':\n                const order_list = this.form.controls.catering.value;\n                if (\n                    order_list &&\n                    order_list.length &&\n                    (!event.metadata || !event.metadata.ref || event.metadata.ref !== 'details')\n                ) {\n                    this.openCateringDetailsModal();\n                } else {\n                    this.navigate('form');\n                    this.confirmBooking();\n                }\n                break;\n            case 'form':\n                this.navigate('search');\n                break;\n        }\n    }\n\n    private toPreviousFlowStep(event: BookingFlowEvent) {\n        switch (event.step) {\n            case 'search':\n                this.navigate('form');\n                break;\n            case 'catering':\n                /* istanbul ignore else */\n                if (!this._data.only_catering) {\n                    this.navigate('search');\n                }\n                break;\n        }\n    }\n\n    private navigate(route: string) {\n        this.flow_step = route;\n    }\n\n    /** Clear user changes to the form data */\n    private resetForm() {\n        delete this.form;\n        this.form = generateBookingForm(\n            this.booking,\n            this.available_fields\n        );\n    }\n\n    /**\n     * Load existing form data or generate a new booking form\n     */\n    private loadFormData(): void {\n        let form_data: HashMap = this._data.booking.toJSON();\n        this.booking = new Booking(form_data);\n        this.form = generateBookingForm(\n            this.booking,\n            this.available_fields\n        );\n        /* istanbul ignore else */\n        if (form_data && form_data.room_ids && this.form.controls.space_list) {\n            this.form.controls.space_list.setValue(\n                form_data.room_ids.map(id => this._spaces.find(id) || { id, name: id })\n            );\n        }\n    }\n\n    /** Open modal for adding equipment requirements to booking */\n    private openEquipmentDetailsModal() {\n        const ref = this._dialog.open<\n            RequirementDetailsModalComponent,\n            RequirementDetailsModalData\n        >(RequirementDetailsModalComponent, {\n            maxWidth: '95vw',\n            width: '32em',\n            data: {\n                spaces: this.form.controls.space_list.value,\n                notes_field: this.form.controls.notes,\n                codes_field: this.form.controls.equipment_codes,\n                head_counts_field: this.form.controls.expected_attendees\n            }\n        });\n        this.subscription(\n            'modal_events',\n            ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    this.toNextFlowStep({\n                        type: 'next',\n                        step: 'search',\n                        metadata: { ref: 'equipment' }\n                    });\n                    ref.close();\n                }\n            })\n        );\n        ref.afterClosed().subscribe(() => this.unsub('modal_events'));\n    }\n\n    /** Open modal for adding equipment requirements to booking */\n    private openCateringDetailsModal() {\n        const ref = this._dialog.open<CateringDetailsModalComponent, CateringDetailsModalData>(\n            CateringDetailsModalComponent,\n            {\n                maxWidth: '95vw',\n                width: '32em',\n                data: {\n                    spaces: this.form.controls.space_list.value,\n                    notes_field: this.form.controls.notes,\n                    catering: this.form.controls.catering\n                }\n            }\n        );\n        this.subscription(\n            'modal_events',\n            ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    this.toNextFlowStep({\n                        type: 'next',\n                        step: 'catering',\n                        metadata: { ref: 'details' }\n                    });\n                    ref.close();\n                }\n            })\n        );\n        ref.afterClosed().subscribe(() => this.unsub('modal_events'));\n    }\n\n    /**\n     * Open modal to confirm the booking details\n     */\n    private confirmBooking() {\n        /* istanbul ignore else */\n        if (!this.form.dirty) {\n            this._service.notifyInfo('No changes have been made to booking');\n            return;\n        }\n        /* istanbul ignore else */\n        if (this.form.valid) {\n            const dialog_ref = this._dialog.open(BookingConfirmComponent, {\n                width: '32em',\n                maxWidth: '95vw',\n                maxHeight: '95vh',\n                data: { booking: this.booking }\n            });\n            dialog_ref.componentInstance.event.subscribe(event => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    this.close();\n                }\n            });\n        }\n    }\n}\n","<header>\n    <div class=\"heading\">{{ booking?.id ? 'Edit' : 'New' }} Booking</div>\n    <button mat-icon-button mat-dialog-close (tapped)=\"close()\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main>\n        <ng-container [ngSwitch]=\"flow_step\">\n            <ng-container *ngSwitchCase=\"'search'\">\n                <booking-find-space\n                    *ngIf=\"form\"\n                    [spaces]=\"form.controls.space_list\"\n                    [form]=\"form\"\n                    (event)=\"handleFlowEvent($event)\"\n                ></booking-find-space>\n            </ng-container>\n            <ng-container *ngSwitchCase=\"'catering'\">\n                <booking-catering\n                    *ngIf=\"form\"\n                    [form]=\"form\"\n                    [only]=\"only_catering\"\n                    (event)=\"handleFlowEvent($event)\"\n                ></booking-catering>\n            </ng-container>\n            <ng-container *ngSwitchDefault>\n                <booking-spaces-form\n                    *ngIf=\"form\"\n                    [form]=\"form\"\n                    (event)=\"handleFlowEvent($event)\"\n                ></booking-spaces-form>\n            </ng-container>\n        </ng-container>\n    </main>\n</mat-dialog-content>\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\n\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { BookingFlowEvent } from '../booking-modal.component';\nimport { CateringOrder } from 'src/app/services/data/catering/catering-order.class';\n\nimport * as dayjs from 'dayjs';\n\n@Component({\n    selector: 'booking-catering',\n    templateUrl: './catering.component.html',\n    styleUrls: ['./catering.component.scss'],\n})\nexport class BookingCateringComponent {\n    /** Form fields for the booking */\n    @Input() public form: FormGroup;\n    /** Whether catering is the only action in the flow */\n    @Input() public only: boolean;\n    /** Emitter for flow update events */\n    @Output() public event = new EventEmitter<BookingFlowEvent>();\n    /** Active order to display details for */\n    public active_order: CateringOrder;\n\n    /** Field for storing catering details */\n    public get catering_field() {\n        return this.form && this.form.controls.catering ? this.form.controls.catering : null;\n    }\n\n    /** List of spaces selected for the booking */\n    public get space_list(): Space[] {\n        return this.form && this.form.controls.space_list\n            ? this.form.controls.space_list.value\n            : [];\n    }\n\n    /** Date of the booking */\n    public get date(): number {\n        return this.form && this.form.controls.date\n            ? this.form.controls.date.value\n            : dayjs().startOf('m').valueOf();\n    }\n\n    /** Duration of the booking */\n    public get duration(): number {\n        return this.form && this.form.controls.duration ? this.form.controls.duration.value : 60;\n    }\n\n    /** Whether booking is all day */\n    public get all_day(): boolean {\n        return this.form && this.form.controls.all_day && this.form.controls.all_day.value;\n    }\n\n    /** Create a new catering order */\n    public newOrder(): void {\n        const order = new CateringOrder({});\n        this.active_order = order;\n    }\n\n    /** Handle changes to catering order */\n    public handleOrderEvent(order: CateringOrder) {\n        /* istanbul ignore else */\n        if (order) {\n            const orders = this.form.controls.catering.value;\n            const index = orders.findIndex((an_order) => order.id === an_order.id);\n            if (index < 0) {\n                orders.push(order);\n            } else {\n                orders.splice(index, 1, order);\n            }\n            this.form.controls.catering.setValue(orders);\n        }\n        this.active_order = null;\n    }\n}\n","<div class=\"catering\">\n    <ng-container *ngIf=\"!active_order; else order_display\">\n        <a-catering-order-list\n            [catering]=\"catering_field\"\n            [date]=\"date\"\n            [all_day]=\"all_day\"\n            [only_catering]=\"only\"\n            (order)=\"$event ? (active_order = $event) : newOrder()\"\n            (event)=\"event.emit($event)\"\n        ></a-catering-order-list>\n    </ng-container>\n</div>\n<ng-template #order_display>\n    <a-catering-order-details\n        [space_list]=\"space_list\"\n        [order]=\"active_order\"\n        [date]=\"date\"\n        [duration]=\"duration\"\n        [all_day]=\"all_day\"\n        (event)=\"$event ? handleOrderEvent($event) : active_order = null\"\n    ></a-catering-order-details>\n</ng-template>\n","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\nimport { FormControl } from '@angular/forms';\n\nimport { CateringCategory } from 'src/app/services/data/catering/catering-category.class';\n\n@Component({\n    selector: 'a-category-display',\n    templateUrl: './category.component.html',\n    styleUrls: ['./category.component.scss']\n})\nexport class CateringMenuCategoryComponent implements OnInit {\n    /** Category to display details for */\n    @Input() public category: CateringCategory;\n    /** Form control for the list of order items */\n    @Input() public items: FormControl;\n    /** Currency symbol for the active space */\n    @Input() public symbol: string;\n    /** Whether item should be disabled if not available anytime */\n    @Input() public disabled: boolean;\n    /** Emitter for close events */\n    @Output() public close = new EventEmitter<void>();\n\n    constructor() {}\n\n    ngOnInit(): void {}\n}\n","\n<div class=\"header\">\n    <div class=\"content\">\n        <button mat-icon-button (tapped)=\"close.emit()\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'arrow_back' }\"></app-icon>\n        </button>\n        <div class=\"name\">{{ category?.name }}</div>\n    </div>\n</div>\n<ng-container *ngIf=\"category.items && category.items.length; else empty_state\">\n    <div class=\"item\" *ngFor=\"let item of category.items\">\n        <a-catering-order-item [disabled]=\"disabled\" [symbol]=\"symbol\" [item]=\"item\" [field]=\"items\"></a-catering-order-item>\n    </div>\n</ng-container>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\" i18n=\"Catering category empty label\">Category contains no available items</div>\n    </div>\n</ng-template>\n","import { Component, OnInit, Input, SimpleChanges, OnChanges } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { FormControl } from '@angular/forms';\n\nimport { CateringCategory } from 'src/app/services/data/catering/catering-category.class';\nimport { ANIMATION_SHOW_CONTRACT_EXPAND } from 'src/app/shared/globals/angular-animations';\nimport { CateringItem } from 'src/app/services/data/catering/catering-item.class';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { PackageOptionsModalComponent } from 'src/app/overlays/package-options-modal/package-options-modal.component';\n\n@Component({\n    selector: 'a-catering-order-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss'],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND],\n})\nexport class CateringMenuItemComponent extends BaseDirective implements OnChanges {\n    /** Whether item is a child of another */\n    @Input() public subitem: boolean;\n    /** Item to display */\n    @Input() public item: CateringCategory;\n    /** Field for storing items */\n    @Input() public field: FormControl;\n    /** Current symbol for the selected space */\n    @Input() public symbol: string;\n    /** Whether item should be disabled if not available anytime */\n    @Input() public disabled: boolean;\n    /** Whether to show children items */\n    public show_children: boolean;\n\n    /** List of contents of the package */\n    public get contents(): string {\n        return this.item.items\n            ? this.item.items.reduce((list, item) => {\n                  /* istanbul ignore else */\n                  if (list) {\n                      list += '\\n\\n';\n                  }\n                  return (list += `${item.name}${\n                      (item as any).items\n                          ? (item as any).items.reduce(\n                                (a_list, an_item) =>\n                                    (a_list += `\\n ${an_item.amount ? '' : ''} ${an_item.name} `),\n                                ''\n                            )\n                          : ''\n                  } ${item.amount ? '' : ''}`);\n              }, '')\n            : '';\n    }\n\n    constructor(private _service: ApplicationService, private _dialog: MatDialog) {\n        super();\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.field && this.field) {\n            const list = this.field.value;\n            const item = list.find((an_item) => an_item.id === this.item.id);\n            this.item.setAmount(item ? item.amount : 0);\n            this.subscription(\n                'field_change',\n                this.field.valueChanges.subscribe((list) => {\n                    const item = list.find((an_item) => an_item.id === this.item.id);\n                    this.item.setAmount(item ? item.amount : 0);\n                })\n            );\n        }\n    }\n\n    /**\n     * Update the amount of the item in the order\n     * @param value New amount\n     */\n    public updateAmount(value: number) {\n        /* istanbul ignore else */\n        if (this.field) {\n            const list: CateringItem[] = this.field.value;\n            const item = list.find((an_item) => an_item.id === this.item.id);\n            if (item) {\n                this.item.setAmount(value);\n                item.setAmount(value);\n            } else {\n                const amount = this.item.amount;\n                this.item.setAmount(value);\n                if (this.item.package && amount < value) {\n                    this.selectPackageOptions().then(\n                        (confirmed_item) => {\n                            list.push(new CateringItem(confirmed_item));\n                            this.field.setValue(list.filter((an_item) => an_item.amount));\n                        },\n                        () => {\n                            this.item.setAmount(999);\n                            this.timeout('amount', () => this.item.setAmount(0), 5);\n                            this._service.notifyWarn(\n                                'Package options not selected. Item removed from order'\n                            );\n                        }\n                    );\n                } else {\n                    list.push(new CateringItem(this.item));\n                }\n            }\n            this.field.setValue(list.filter((an_item) => an_item.amount));\n        }\n    }\n\n    /** Reselect package options */\n    public updatePackageOptions(): void {\n        this.selectPackageOptions().then(\n            () => null,\n            () => null\n        );\n    }\n\n    /**\n     * Open modal for user to select package options\n     */\n    private selectPackageOptions(): Promise<CateringCategory> {\n        return new Promise((resolve, reject) => {\n            const ref = this._dialog.open(PackageOptionsModalComponent, {\n                maxWidth: '95vw',\n                data: {\n                    item: new CateringCategory(this.item),\n                },\n            });\n            let done = false;\n            ref.componentInstance.event.subscribe((event) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    done = true;\n                    resolve(ref.componentInstance.item);\n                    ref.close();\n                }\n            });\n            ref.afterClosed().subscribe(() => {\n                /* istanbul ignore else */\n                if (!done) {\n                    reject();\n                }\n            });\n        });\n    }\n}\n","<div\n    class=\"catering-item\"\n    *ngIf=\"item\"\n    [class.subitem]=\"subitem\"\n    [attr.disabled]=\"disabled && !item.can_order_anytime\"\n>\n    <div\n        class=\"image\"\n        *ngIf=\"!subitem\"\n        [style.background-image]=\"'url(' + item.image_path + ')'\"\n    ></div>\n    <div class=\"details\">\n        <div class=\"name\">{{ item.name }}</div>\n        <div class=\"description\">{{ item.package ? '[Package] ' : '' }}{{ item.description }}</div>\n        <div class=\"options\">\n            <div class=\"option price mobile-only\" *ngIf=\"item.unit_price\">\n                {{ item.unit_price / 100 | currency: symbol }}\n            </div>\n            <div\n                class=\"option\"\n                *ngIf=\"item.package && item.items.length && !item.must_select\"\n                [matTooltip]=\"contents\"\n                i18n=\"Catering order item available options label\"\n            >\n                { item.items.length, plural, =1 { Contains {{ item.items.length }} item } other {\n                Contains {{ item.items.length }} items } }\n            </div>\n            <div\n                class=\"option\"\n                *ngIf=\"item.package && item.must_select && item.amount > 0\"\n                [matTooltip]=\"contents\"\n            >\n                {{ item.must_select }}\n                <span class=\"not-mobile\" i18n=\"Catering order item selected options label\">\n                    Selected\n                </span>\n            </div>\n            <button\n                mat-button\n                *ngIf=\"item.package && item.must_select && item.amount > 0\"\n                (tapped)=\"updatePackageOptions()\"\n                i18n=\"Catering order item options change action\"\n            >\n                Customise\n            </button>\n        </div>\n    </div>\n    <div class=\"option price not-mobile\" *ngIf=\"item.unit_price\">\n        {{ item.unit_price / 100 | currency: symbol }}\n    </div>\n    <a-counter\n        *ngIf=\"!item.items || item.package\"\n        [ngModel]=\"item.amount\"\n        (ngModelChange)=\"updateAmount($event)\"\n    ></a-counter>\n    <button\n        mat-icon-button\n        *ngIf=\"item.items && item.items.length && !item.package\"\n        (tapped)=\"show_children = !show_children\"\n    >\n        <app-icon\n            [icon]=\"{\n                class: 'material-icons',\n                content: show_children ? 'keyboard_arrow_up' : 'keyboard_arrow_down'\n            }\"\n        ></app-icon>\n    </button>\n</div>\n<div class=\"children\" [@show]=\"show_children ? 'show' : 'hide'\">\n    <a-catering-order-item\n        *ngFor=\"let sub_item of item.items\"\n        [subitem]=\"true\"\n        [symbol]=\"symbol\"\n        [item]=\"sub_item\"\n        [field]=\"field\"\n    ></a-catering-order-item>\n</div>\n","import { Component, OnInit, Input, SimpleChanges, Output, EventEmitter } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { FormGroup, FormControl } from '@angular/forms';\n\nimport { CateringCategory } from 'src/app/services/data/catering/catering-category.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { Building } from 'src/app/services/data/organisation/building.class';\nimport { Identity, DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { CateringItem } from 'src/app/services/data/catering/catering-item.class';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { CateringOrder } from 'src/app/services/data/catering/catering-order.class';\nimport {\n    BookingCateringConfirmModalComponent,\n    CateringConfirmModalData,\n} from 'src/app/overlays/catering-confirm-modal/catering-confirm-modal.component';\n\nimport * as dayjs from 'dayjs';\nimport spacetime from 'spacetime';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\nimport { CateringMenuService } from 'src/app/services/data/catering/catering-menu.service';\n\n@Component({\n    selector: 'a-catering-order-details',\n    templateUrl: './order-details.component.html',\n    styleUrls: ['./order-details.component.scss'],\n})\nexport class BookingCateringOrderDetailsComponent extends BaseDirective implements OnInit {\n    /** Catering order to edit details of */\n    @Input() public order: CateringOrder;\n    /** Booking date */\n    @Input() public date: number;\n    /** Booking duration */\n    @Input() public duration: number;\n    /** Booking duration */\n    @Input() public space_list: Space[];\n    /** Whether booking is all day */\n    @Input() public all_day: boolean;\n    /** Emitter for changes to the catering order */\n    @Output() public event = new EventEmitter<CateringOrder>();\n    /** Form controls for order */\n    public form: FormGroup;\n    /** List of available catering item categories */\n    public category_list: CateringCategory[] = [];\n    /** Active category to display details for */\n    public active_category: CateringCategory;\n    /** List of available times for delivering catering */\n    public available_times: Identity[] = [];\n    /** Whether the menu is loading */\n    public loading: boolean;\n\n    /** Whether user is able to order from the currently selected space */\n    public get can_order(): boolean {\n        return (\n            (this.active_building.has_catering || this.category_list.length) &&\n            (!this.within_restricted_time || this.has_available_items)\n        );\n    }\n\n    /** Building associated with the selected space */\n    public get active_building(): Building {\n        const form_controls = (this.form || { controls: { location_id: { value: '' } } }).controls;\n        const space: Space = this.space_list.find(space => space.id == form_controls.location_id.value) || { level: {} } as any;\n        return (\n            this._org.buildings.find((bld) => space.level.building_id === bld.id) ||\n            ({ catering_restricted_from: 0 } as any)\n        );\n    }\n\n    /** Currency code for the active building */\n    public get symbol(): string {\n        return this.active_building.currency || 'USD';\n    }\n\n    /** Number of items in the order */\n    public get item_count(): number {\n        return this.form\n            ? this.form.controls.items.value.reduce((total, item) => total + item.amount, 0)\n            : 0;\n    }\n\n    /** Whether booking time is outside of catering hours */\n    public get out_of_hours(): boolean {\n        return this.form.controls.delivery_time.value < 0;\n    }\n\n    /** Whether booking is with the restricted ordering period */\n    public get within_restricted_time(): boolean {\n        const building = this.active_building;\n        /* istanbul ignore else */\n        if (!building.catering_restricted_from || building.catering_restricted_from <= 0) {\n            return false;\n        }\n        const date = dayjs();\n        const restricted = dayjs(this.date).subtract(building.catering_restricted_from, 'h');\n        return date.isAfter(restricted, 's');\n    }\n\n    /** Whether items are available for order at anytime */\n    public get has_available_items(): boolean {\n        return this.category_list.reduce(\n            (available, category) => available || category.can_order_anytime,\n            false\n        );\n    }\n\n    constructor(\n        private _spaces: SpacesService,\n        private _menu: CateringMenuService,\n        private _org: OrganisationService,\n        private _dialog: MatDialog\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.generateAvailableTimes();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.date || changes.duration) {\n            this.generateAvailableTimes();\n            /* istanbul ignore else */\n            if (\n                this.form &&\n                !this.available_times.find(\n                    (time) => time.id === this.form.controls.delivery_time.value\n                )\n            ) {\n                this.form.controls.delivery_time.setValue(this.available_times[0].id);\n            }\n        }\n        /* istanbul ignore else */\n        if (changes.space_list) {\n            /* istanbul ignore else */\n            if (this.form && this.space_list && !this.form.controls.location_id.value) {\n                this.form.controls.location_id.setValue(this.space_list[0].id);\n            }\n        }\n        /* istanbul ignore else */\n        if (changes.order && this.order) {\n            this.initForm();\n        }\n    }\n\n    public initForm() {\n        this.form = new FormGroup({\n            id: new FormControl(this.order.id),\n            booking_date: new FormControl(\n                this.all_day ? dayjs(this.date).startOf('d').valueOf() : this.date\n            ),\n            location_id: new FormControl(this.order.location_id || this.space_list[0].id),\n            delivery_time: new FormControl(this.order.delivery_time || this.available_times[0].id),\n            items: new FormControl(this.order.items.map((item) => new CateringItem(item))),\n        });\n        this.subscription(\n            'space_change',\n            this.form.controls.location_id.valueChanges.subscribe((space) => {\n                this.generateAvailableTimes();\n                if (\n                    !this.available_times.find(\n                        (time) => time.id === this.form.controls.delivery_time.value\n                    )\n                ) {\n                    this.form.controls.delivery_time.setValue(this.available_times[0].id);\n                }\n                this.loadMenu();\n            })\n        );\n        this.loadMenu();\n        this.generateAvailableTimes();\n        if (\n            this.form &&\n            !this.available_times.find((time) => time.id === this.form.controls.delivery_time.value)\n        ) {\n            this.form.controls.delivery_time.setValue(this.available_times[0].id);\n        }\n    }\n\n    public confirmOrder() {\n        const ref = this._dialog.open<\n            BookingCateringConfirmModalComponent,\n            CateringConfirmModalData\n        >(BookingCateringConfirmModalComponent, {\n            maxWidth: '95vw',\n            data: {\n                date: this.date,\n                form: this.form,\n            },\n        });\n        this.subscription(\n            'confirm_event',\n            ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    const order = new CateringOrder(this.form.value);\n                    this.event.emit(order);\n                    ref.close();\n                }\n            })\n        );\n        ref.afterClosed().subscribe(() => this.unsub('confirm_event'));\n    }\n\n    private loadMenu() {\n        const space = this.form.controls.location_id.value;\n        this.form.controls.items.setValue([]);\n        this.loading = true;\n        this._menu.query({ room_id: space }).then(\n            (list) => {\n                this.loading = false;\n                this.category_list = list.map((i) => new CateringCategory(i));\n            },\n            () => (this.loading = false)\n        );\n    }\n\n    /** Generate a list of available delivery times for the given booking time */\n    private generateAvailableTimes() {\n        const start_date = this.all_day ? dayjs(this.date).startOf('d') : dayjs(this.date);\n        let { start, end } = this.generateStartAndEndTimes();\n        start = start.minute(Math.ceil(start.minute() / 5) * 5);\n        this.available_times = [];\n        while (start.isBefore(end, 'm')) {\n            this.available_times.push({\n                id: Math.abs(start_date.diff(start, 'm')),\n                name: start.format('h:mm A'),\n            });\n            start = start.add(5, 'm');\n        }\n        /* istanbul ignore else */\n        if (this.available_times.length === 0) {\n            this.available_times.push({ id: -1, name: 'Out of hours' });\n        }\n    }\n\n    private generateStartAndEndTimes(): { start: dayjs.Dayjs; end: dayjs.Dayjs } {\n        let start = dayjs(this.date);\n        /* istanbul ignore else */\n        if (this.all_day) {\n            start = start.startOf('d');\n        }\n        let end = this.all_day ? start.endOf('d') : start.add(this.duration, 'm');\n        let building_time = spacetime(start.toDate());\n        // const space = this.form ? this.form.controls.location_id.value : null;\n        // if (space) {\n        //     const building = this._service.Organisation.buildings.find((bld) =>bld.id === space.level.building_id);\n        //     if (building && building.timezone) {\n        //         building_time = building_time.goto(building.timezone);\n        //     }\n        // }\n        building_time = building_time.hour(7);\n        const as_dayjs = dayjs(building_time.toLocalDate());\n        if (start.isBefore(as_dayjs, 'm')) {\n            start = as_dayjs;\n            end = start.add(13, 'h');\n        } else {\n            const possible_end = as_dayjs.hour(20);\n            if (end.isAfter(possible_end)) {\n                end = possible_end;\n            }\n        }\n        return { start, end };\n    }\n}\n","<div class=\"catering order-details\">\n    <div class=\"header\" *ngIf=\"form\">\n        <form [formGroup]=\"form\">\n            <div class=\"field\">\n                <label i18n=\"Catering order location label\">Deliver to:</label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select formControlName=\"location_id\">\n                        <mat-option *ngFor=\"let space of space_list\" [value]=\"space.id\">\n                            {{ space.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"start\" i18n=\"Catering order delivery time label\">At:</label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select name=\"start\" formControlName=\"delivery_time\">\n                        <mat-option *ngFor=\"let time of available_times\" [value]=\"time.id\">\n                            {{ time.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n        </form>\n    </div>\n    <div class=\"body\" *ngIf=\"!loading; else load_state\">\n        <ng-container *ngIf=\"!active_category; else category_display\">\n            <div class=\"contents\" *ngIf=\"can_order && category_list.length; else empty_state\">\n                <button\n                    mat-button\n                    class=\"category\"\n                    *ngFor=\"let item of category_list\"\n                    [style.background-image]=\"'url(' + item.image_path + ')'\"\n                    [disabled]=\"within_restricted_time && !item.can_order_anytime\"\n                    (tapped)=\"active_category = item\"\n                >\n                    <div class=\"overlay\"></div>\n                    <div class=\"name\">{{ item.name }}</div>\n                </button>\n            </div>\n        </ng-container>\n    </div>\n    <div class=\"footer\">\n        <button mat-button class=\"inverse\" (tapped)=\"event.emit()\" i18n=\"Catering order cancel action\">Back</button>\n        <button mat-button name=\"confirm\" [disabled]=\"!item_count || out_of_hours\" (tapped)=\"confirmOrder()\" i18n=\"Catering order confirm action\">\n            Confirm Order({{ item_count || '0' }})\n        </button>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div class=\"empty-state center\">\n        <div class=\"icon\">\n            <img alt=\"No Catering Available\" src=\"assets/img/no-catering.svg\" />\n        </div>\n        <p i18n=\"Catering order unavailable\">\n            Catering is <span class=\"bold\">not available</span> for this booking.<br />\n            Catering must be ordered within business hours\n            <span *ngIf=\"active_building?.catering_restricted_from\" class=\"bold\">\n                at least {{ active_building?.catering_restricted_from || '0' }} hours in advance for\n                meetings\n            </span>\n            at {{ active_building?.name }}.\n        </p>\n    </div>\n</ng-template>\n<ng-template #load_state>\n    <div class=\"body\">\n        <div class=\"info-block center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"48\"></mat-spinner>\n            </div>\n            <div class=\"text\" i18n=\"Catering order loading label\">Loading menu for {{ active_building?.name }}...</div>\n        </div>\n    </div>\n</ng-template>\n<ng-template #category_display>\n    <a-category-display\n        [category]=\"active_category\"\n        [symbol]=\"symbol\"\n        [items]=\"form.controls.items\"\n        [disabled]=\"within_restricted_time\"\n        (close)=\"active_category = null\"\n    ></a-category-display>\n</ng-template>\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\n\nimport { CateringOrder } from 'src/app/services/data/catering/catering-order.class';\nimport { ApplicationService } from 'src/app/services/app.service';\n\nimport * as dayjs from 'dayjs';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\n\n@Component({\n    selector: 'catering-order-list-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss']\n})\nexport class CateringOrderListItemComponent {\n    /** Catering order to display */\n    @Input() order: CateringOrder;\n    /** Selected datetime */\n    @Input() date: number;\n    /** Emitter for edit events */\n    @Output() public edit = new EventEmitter<void>();\n    /** Emitter for delete events */\n    @Output() public delete = new EventEmitter<void>();\n\n    /** Space selected for delivery */\n    public get space(): string {\n        const space = this._spaces.find((this.order || {}).location_id) || { name: '' };\n        return space.name || '<No Location>';\n    }\n    /** Delivery time for the order */\n    public get delivery_time(): string {\n        /* istanbul ignore else */\n        if (!this.order) {\n            return '<Meeting Start>';\n        }\n        const date = dayjs(this.order.booking_date).add(\n            this.order.changes.delivery_time || this.order.delivery_time,\n            'm'\n        );\n        return date.format('h:mm A');\n    }\n\n    /** Total cost of the order */\n    public get order_cost(): number {\n        const items = (this.order || { items: [] }).items as any;\n        return items.reduce((amount, item) => amount + item.amount * item.unit_price, 0);\n    }\n\n    /** Number of items in the order */\n    public get item_count(): number {\n        const items = (this.order || { items: [] }).items as any;\n        return items.reduce((amount, item) => amount + item.amount, 0);\n    }\n\n    /** Currency symbol for the selected space */\n    public get symbol(): string {\n        const space = this._spaces.find((this.order || {}).location_id);\n        /* istanbul ignore else */\n        if (!space || !space.level) {\n            return 'USD';\n        }\n        const building = this._org.buildings.find(\n            bld => bld.id === space.level.building_id\n        ) || { currency: 'USD' };\n        return building.currency;\n    }\n\n    constructor(private _spaces: SpacesService, private _org: OrganisationService) {}\n}\n","<div class=\"details\" i18n=\"Catering order item delivery details\">\n    Deliver to <span>{{ space }}</span> at <span>{{ delivery_time }}</span>\n</div>\n<div class=\"group\">\n    <div class=\"cost\">\n        {{ item_count }}\n        <span i18n=\"Items\">{ item_count, plural, =1 { item } other { items } }</span>\n    </div>\n    <div class=\"cost\">{{ order_cost / 100 | currency: symbol }}</div>\n</div>\n<div class=\"actions\">\n    <button mat-icon-button name=\"edit\" (tapped)=\"edit.emit()\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'edit' }\"></app-icon>\n    </button>\n    <button mat-icon-button name=\"delete\" class=\"inverse\" (tapped)=\"delete.emit()\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'delete' }\"></app-icon>\n    </button>\n</div>\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { FormControl } from '@angular/forms';\n\nimport { BookingFlowEvent } from '../../booking-modal.component';\nimport { CateringOrder } from 'src/app/services/data/catering/catering-order.class';\n\nimport * as dayjs from 'dayjs';\n\n@Component({\n    selector: 'a-catering-order-list',\n    templateUrl: './order-list.component.html',\n    styleUrls: ['./order-list.component.scss']\n})\nexport class BookingCateringOrderListComponent {\n    /** Form field for storing catering orders */\n    @Input() public catering: FormControl;\n    /** Selected datetime for the booking */\n    @Input() public date: number;\n    /** Whether booking is all day */\n    @Input() public all_day: boolean;\n    /** Whether catering is the only action in the flow */\n    @Input() public only_catering: boolean;\n    /** Emitter for flow update events */\n    @Output() public event = new EventEmitter<BookingFlowEvent>();\n    /** Emiiter for order events */\n    @Output() public order = new EventEmitter<CateringOrder>();\n\n    /** List of orders in the booking */\n    public get orders(): CateringOrder[] {\n        /* istanbul ignore else */\n        if (!this.catering) {\n            return [];\n        }\n        const orders = this.catering.value;\n        orders.forEach(\n            order =>\n                (order.booking_date = this.all_day\n                    ? dayjs(this.date)\n                          .startOf('d')\n                          .valueOf()\n                    : this.date)\n        );\n        return orders;\n    }\n\n    /** Emit event for a new catering order */\n    public newOrder() {\n        this.order.emit();\n    }\n\n    /** Emit event for editing existing order */\n    public editOrder(order: CateringOrder) {\n        this.order.emit(order);\n    }\n\n    /** Remove order from the list */\n    public deleteOrder(order: CateringOrder) {\n        const orders = this.orders;\n        const index = orders.findIndex(an_order => order.id === an_order.id);\n        /* istanbul ignore else */\n        if (index >= 0) {\n            orders.splice(index, 1);\n            this.catering.setValue(orders);\n        }\n    }\n\n    /**\n     * Proceed to the next step in the space booking flow\n     */\n    public next(): void {\n        this.event.emit({ type: 'next', step: 'catering' });\n    }\n\n    /** Move flow to previous step */\n    public previous(): void {\n        this.event.emit({ type: 'previous', step: 'catering' });\n    }\n}\n","<div class=\"catering order-list\">\n    <div class=\"header\">\n        <h3 i18n=\"Catering order list header\">Catering Orders</h3>\n    </div>\n    <div class=\"body\">\n        <ng-container *ngIf=\"orders && orders.length; else empty_state\">\n            <div class=\"list\">\n                <catering-order-list-item\n                    *ngFor=\"let order of orders\"\n                    [order]=\"order\"\n                    [date]=\"date\"\n                    (edit)=\"editOrder(order)\"\n                    (delete)=\"deleteOrder(order)\"\n                ></catering-order-list-item>\n            </div>\n            <button mat-button name=\"new\" (tapped)=\"newOrder()\" i18n=\"Catering order list add action\">\n                Add Order\n            </button>\n        </ng-container>\n    </div>\n    <div class=\"footer\">\n        <button\n            mat-button\n            class=\"inverse\"\n            name=\"previous\"\n            *ngIf=\"!only_catering\"\n            (tapped)=\"previous()\"\n            i18n=\"Catering order list cancel action\"\n        >\n            Back\n        </button>\n        <button mat-button name=\"next\" (tapped)=\"next()\" i18n=\"Catering order list continue action\">\n            Next\n        </button>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\" i18n=\"Catering order list empty label\">No catering orders</div>\n        <button mat-button name=\"new\" (tapped)=\"newOrder()\" i18n=\"Catering order list add action\">\n            Add Order\n        </button>\n    </div>\n</ng-template>\n","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\nimport { FormControl } from '@angular/forms';\n\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { Building } from 'src/app/services/data/organisation/building.class';\nimport { unique } from 'src/app/shared/utilities/general.utilities';\n\nimport * as dayjs from 'dayjs';\nimport { ANIMATION_SHOW_CONTRACT_EXPAND } from 'src/app/shared/globals/angular-animations';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\n\n@Component({\n    selector: 'booking-space-filters',\n    templateUrl: './filters.component.html',\n    styleUrls: ['./filters.component.scss'],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND]\n})\nexport class BookingSpaceFiltersComponent extends BaseDirective implements OnInit {\n    /** Date selected for the booking */\n    @Input() public date: FormControl;\n    /** List of location IDs being filtered on */\n    @Input() public locations: string[] = [];\n    /** Emitter for changes to location filter */\n    @Output() public locationsChange = new EventEmitter<string[]>();\n    /** List of available buildings */\n    public building_list: Building[] = [];\n    /** Whether to show the location list */\n    public show_locations: boolean;\n\n    /** Whether active date is current day */\n    public get is_today(): boolean {\n        const date = dayjs(this.date.value);\n        return dayjs().isSame(date, 'd');\n    }\n\n    /** Display string for the selected date */\n    public get date_display(): string {\n        const date = dayjs(this.date.value);\n        return this.is_today ? 'Today' : date.format('DD MMM YYYY');\n    }\n\n    /** List of filtered location */\n    public get location_list(): Building[] {\n        return this.locations.map(id => this.building_list.find(bld => bld.id === id));\n    }\n\n    constructor(private _org: OrganisationService) {\n        super();\n    }\n\n    public changeDate(amount: number) {\n        let date = dayjs(this.date.value).add(amount, 'd');\n        const now = dayjs().startOf('m');\n        if (date.isBefore(now, 's')) {\n            date = now;\n        }\n        this.date.setValue(date.valueOf());\n    }\n\n    public ngOnInit(): void {\n        this.subscription('buildings', this._org.listen('buildings').subscribe((bld_list) => {\n            this.building_list = bld_list;\n        }));\n    }\n\n    /**\n     * Update location filter to include the given building\n     * @param building Building to add\n     */\n    public addLocationFilter(building: Building): void {\n        this.locations.push(building.id);\n        this.locations = unique(this.locations);\n        this.locationsChange.emit(this.locations);\n    }\n\n    /**\n     * Remove location from the active filters\n     * @param building Building to remove\n     */\n    public removeLocationFilter(building: Building) {\n        this.locations.splice(\n            this.locations.findIndex(id => building.id === id),\n            1\n        );\n        this.locationsChange.emit(this.locations);\n    }\n}\n","<div class=\"space-filters\" *ngIf=\"date\">\n    <div class=\"actions\">\n        <div class=\"date\">\n            <button mat-icon-button [disabled]=\"is_today\" (tapped)=\"changeDate(-1)\">\n                <app-icon\n                    [icon]=\"{ class: 'material-icons', content: 'keyboard_arrow_left' }\"\n                ></app-icon>\n            </button>\n            <div class=\"text\">{{ date_display }}</div>\n            <button mat-icon-button (tapped)=\"changeDate(1)\">\n                <app-icon\n                    [icon]=\"{ class: 'material-icons', content: 'keyboard_arrow_right' }\"\n                ></app-icon>\n            </button>\n        </div>\n        <div class=\"location-list\">\n            <div class=\"inner\" (tapped)=\"show_locations = !show_locations\">\n                <img src=\"assets/img/location-img.svg\" />\n                <div class=\"text\" i18n=\"Booking space filters locations label\">Select locations(s)</div>\n                <app-icon\n                    [icon]=\"{\n                        class: 'material-icons',\n                        content: 'keyboard_arrow_' + (show_locations ? 'up' : 'down')\n                    }\"\n                ></app-icon>\n            </div>\n            <div\n                class=\"list\"\n                [@show]=\"show_locations ? 'show' : 'hide'\"\n            >\n            <div class=\"item\" *ngFor=\"let building of building_list\">\n                <mat-checkbox\n                    (change)=\"\n                        $event.checked\n                            ? addLocationFilter(building)\n                            : removeLocationFilter(building)\n                    \"\n                >\n                    <div class=\"building-name\">\n                        <div class=\"code\">{{ building.code }}</div>\n                        <div class=\"name\">{{ building.name }}</div>\n                        <div class=\"address\">{{ building.address }}</div>\n                    </div>\n                </mat-checkbox>\n            </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"filters\" *ngIf=\"location_list && location_list.length\">\n        <mat-chip-list aria-label=\"Location Filters\">\n            <mat-chip\n                *ngFor=\"let building of location_list\"\n                [id]=\"building.id\"\n                color=\"primary\"\n                [removable]=\"true\"\n                (removed)=\"removeLocationFilter(building)\"\n            >\n                {{ building.name }}\n                <app-icon\n                    matChipRemove\n                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"\n                ></app-icon>\n            </mat-chip>\n        </mat-chip-list>\n    </div>\n</div>\n","import {\n    Component,\n    OnInit,\n    Input,\n    SimpleChanges,\n    EventEmitter,\n    Output,\n    OnChanges\n} from '@angular/core';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { debounceTime, distinctUntilChanged, switchMap, catchError, map, first } from 'rxjs/operators';\nimport { Observable, of, Subject } from 'rxjs';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { Space, ISpaceAvailabilityOptions } from 'src/app/services/data/spaces/space.class';\nimport { BookingFlowEvent } from '../booking-modal.component';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\n\nimport * as dayjs from 'dayjs';\n\n@Component({\n    selector: 'booking-find-space',\n    templateUrl: './find-space.component.html',\n    styleUrls: ['./find-space.component.scss']\n})\nexport class BookingFindSpaceComponent extends BaseDirective implements OnInit, OnChanges {\n    /** Form control for setting the active space */\n    @Input() public spaces: FormControl;\n    /** Form group for booking */\n    @Input() public form: FormGroup;\n    /** Emitter for flow update events */\n    @Output() public event = new EventEmitter<BookingFlowEvent>();\n\n    /** List of spaces available during the required period */\n    public space_list: Space[] = [];\n    /** List of users from an API search */\n    public search_results$: Observable<Space[]>;\n    /** Whether space list is loading */\n    public loading: boolean;\n    /** List of zones to filter the spaces on */\n    public zone_ids: string[] = [];\n    /** Subject holding the value of the search */\n    public readonly change$ = new Subject<string>();\n\n    /**  Whether multiple spaces are allowed to be selected */\n    public get multiple(): boolean {\n        return this._service.setting('app.booking.multiple_spaces');\n    }\n\n    constructor(private _service: ApplicationService, private _spaces: SpacesService, private _org: OrganisationService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._spaces.initialised.pipe(first(_ => _)).subscribe(() => {\n            // Listen for input changes\n            this.search_results$ = this.change$.pipe(\n                debounceTime(400),\n                distinctUntilChanged(),\n                switchMap(_ => {\n                    this.loading = true;\n                    const recurrence = this.form.controls.recurrence ? this.form.controls.recurrence.value : null;\n                    const recurrence_properties = recurrence && recurrence.period && recurrence.period !== 'None' ? {\n                        recurr_period: (recurrence.period || '').toLowerCase(),\n                        recurr_end: dayjs(recurrence.end).unix()\n                    } : {};\n                    const query: ISpaceAvailabilityOptions = {\n                        date: this.form.controls.date.value,\n                        duration: this.form.controls.duration.value,\n                        zone_ids: this._org.building.id,\n                        bookable: true,\n                        ...recurrence_properties\n                    };\n                    /* istanbul ignore else */\n                    if (this.zone_ids && this.zone_ids.length) {\n                        query.zone_ids = this.zone_ids.join(',');\n                    }\n                    return this._spaces.available(query);\n                }),\n                catchError(_ => of([])),\n                map((list: Space[]) => {\n                    this.loading = false;\n                    return list;\n                })\n            );\n            // Process API results\n            this.subscription(\n                'search_results',\n                this.search_results$.subscribe(list => (this.space_list = list))\n            );\n            this.change$.next('');\n        });\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.form) {\n            const onChange = _ => this.change$.next(_);\n            /* istanbul ignore else */\n            if (this.form.controls.date) {\n                this.subscription(\n                    'date_field',\n                    this.form.controls.date.valueChanges.subscribe(onChange)\n                );\n            }\n            /* istanbul ignore else */\n            if (this.form.controls.duration) {\n                this.subscription(\n                    'duration_field',\n                    this.form.controls.duration.valueChanges.subscribe(onChange)\n                );\n            }\n        }\n    }\n\n    /**\n     * Update the selected space list\n     * @param space Space to add/toggle in the selected list\n     */\n    public selectSpace(space: Space) {\n        if (this.multiple) {\n            const list = this.spaces.value;\n            if (list.find(item => item.id === space.id)) {\n                this.spaces.setValue(list.filter(item => item.id !== space.id));\n            } else {\n                this.spaces.setValue(list.concat([space]));\n            }\n        } else {\n            this.spaces.setValue([space]);\n            this.event.emit({ type: 'next', step: 'search' });\n        }\n    }\n\n    /**\n     * Proceed to the next step in the space booking flow\n     */\n    public next(): void {\n        this.event.emit({ type: 'next', step: 'search' });\n    }\n\n    /** Move flow to previous step */\n    public previous(): void {\n        this.event.emit({ type: 'previous', step: 'search' });\n    }\n}\n","<div class=\"find-space\">\n    <div class=\"background\"></div>\n    <div class=\"header\">\n        <booking-space-filters\n            [date]=\"form.controls.date\"\n            [(locations)]=\"zone_ids\"\n            (locationsChange)=\"change$.next($event)\"\n        ></booking-space-filters>\n    </div>\n    <ng-container *ngIf=\"!loading; else load_state\">\n        <cdk-virtual-scroll-viewport\n            *ngIf=\"space_list && space_list.length; else empty_state\"\n            [itemSize]=\"130\"\n        >\n            <ng-container *cdkVirtualFor=\"let space of space_list\">\n                <a-booking-space-item\n                    [form]=\"form\"\n                    [space]=\"space\"\n                    [multi]=\"multiple\"\n                    (select)=\"selectSpace(space)\"\n                ></a-booking-space-item>\n            </ng-container>\n        </cdk-virtual-scroll-viewport>\n    </ng-container>\n    <div class=\"footer\">\n        <div class=\"box\">\n            <button\n                mat-button\n                class=\"inverse\"\n                name=\"previous\"\n                (tapped)=\"previous()\"\n                i18n=\"Booking spaces cancel action\"\n            >\n                Back\n            </button>\n            <button\n                mat-button\n                *ngIf=\"multiple\"\n                name=\"next\"\n                [disabled]=\"!spaces.value || !spaces.value.length\"\n                (tapped)=\"next()\"\n                i18n=\"Booking spaces continue action\"\n            >\n                Next\n            </button>\n        </div>\n    </div>\n</div>\n<ng-template #load_state>\n    <div class=\"body\">\n        <div class=\"info-block center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"48\"></mat-spinner>\n            </div>\n            <div class=\"text\" i18n=\"Booking spaces loading label\">\n                Checking space availability...\n            </div>\n        </div>\n    </div>\n</ng-template>\n<ng-template #empty_state>\n    <div class=\"body\">\n        <div class=\"info-block center\">\n            <div class=\"icon\">\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n            </div>\n            <div class=\"text\" i18n=\"Booking spaces empty label\">\n                No spaces available for the selected time\n            </div>\n        </div>\n    </div>\n</ng-template>\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { FormGroup } from '@angular/forms';\n\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport {\n    BookingRecurrenceDetails,\n    BookingRecurrenceSpaceDetails,\n} from 'src/app/services/data/bookings/booking.interfaces';\nimport {\n    RecurrenceSpacesModalComponent,\n    RecurrenceSpacesModalData,\n} from 'src/app/overlays/recurrence-spaces-modal/recurrence-spaces-modal.component';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\nimport { UsersService } from 'src/app/services/data/users/users.service';\n\n@Component({\n    selector: 'a-booking-space-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss'],\n})\nexport class BookingSpaceItemComponent extends BaseDirective {\n    /** Space to display */\n    @Input() public space: Space;\n    /** Form fields for booking */\n    @Input() public form: FormGroup;\n    /** Whether multiple spaces are able to be selected */\n    @Input() public multi: boolean;\n    /** Emitter for select actions on the */\n    @Output() public select = new EventEmitter<void>();\n\n    /** Whether space image should be displayed */\n    public get show_image() {\n        return this._service.setting('app.space_display.show_images');\n    }\n\n    /** Whether this space is selected */\n    public get selected(): boolean {\n        /* istanbul ignore else */\n        if (!this.form && this.space) {\n            return false;\n        }\n        return (\n            this.form.controls.space_list &&\n            !!(this.form.controls.space_list.value || []).find(\n                (space) => space.id === this.space.id\n            )\n        );\n    }\n\n    /** Whether space is booked by request */\n    public get is_request(): boolean {\n        /* istanbul ignore else */\n        if (!this.form) {\n            return false;\n        }\n        return this.space.byRequest({\n            date: this.form.controls.date.value,\n            duration: this.form.controls.duration.value,\n            host: this.form.controls.organiser.value || this._users.current,\n        });\n    }\n\n    public get availability(): string {\n        const count = this.space.recurr_available.reduce(\n            (count, ocurrence) => count + (ocurrence.available ? 1 : 0),\n            0\n        );\n        return count >= this.space.recurr_available.length\n            ? 'all'\n            : `${count} of ${this.space.recurr_available.length}`;\n    }\n\n    /** Display location of the space */\n    public get location(): string {\n        /* istanbul ignore else */\n        if (!this.space) {\n            return 'Unable to determine location';\n        }\n        const level = this.space.level;\n        const bld = this._org.buildings.find((building) => building.id === level.building_id);\n        return `${bld ? bld.name + ', ' : ''}${level.name}`;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _org: OrganisationService,\n        private _users: UsersService,\n        private _dialog: MatDialog\n    ) {\n        super();\n    }\n\n    public selectSpace() {\n        if (!this.space.recurr_available || this.availability === 'all' || this.selected) {\n            this.select.emit();\n        } else {\n            const ref = this._dialog.open<\n                RecurrenceSpacesModalComponent,\n                RecurrenceSpacesModalData\n            >(RecurrenceSpacesModalComponent, {\n                width: 'auto',\n                height: 'auto',\n                maxWidth: '95vw',\n                maxHeight: '95vh',\n                data: {\n                    space: this.space,\n                    duration: this.form.controls.duration.value,\n                    host: this.form.controls.organiser.value,\n                    conflicts: this.form.controls.recurrence.value.conflicts || [],\n                },\n            });\n            this.subscription(\n                'recurr_conflicts',\n                ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                    /* istanbul ignore else */\n                    if (event.reason === 'done') {\n                        const recurr: BookingRecurrenceDetails = this.form.controls.recurrence\n                            .value;\n                        const conflict_list: BookingRecurrenceSpaceDetails[] =\n                            recurr.conflicts || [];\n                        for (const item of event.metadata) {\n                            const index = conflict_list.findIndex(\n                                (event) =>\n                                    event.date === item.date && event.replaces === item.replaces\n                            );\n                            if (index >= 0) {\n                                conflict_list.splice(index, 1, item);\n                            } else {\n                                conflict_list.push(item);\n                            }\n                        }\n                        this.form.controls.recurrence.setValue({\n                            ...recurr,\n                            conflicts: conflict_list,\n                        });\n                        this.select.emit();\n                        ref.close();\n                    }\n                })\n            );\n        }\n    }\n}\n","<div class=\"space-details\" *ngIf=\"space\" [class.with-image]=\"show_image\">\n    <div class=\"details\">\n        <div\n            class=\"image\"\n            *ngIf=\"space.image\"\n            [style.background-image]=\"'url(' + space.image + ')'\"\n        ></div>\n        <div class=\"overlay\"></div>\n        <div class=\"name\">{{ space.name }}</div>\n        <div class=\"info\">\n            <div class=\"location\">{{ location }}</div>\n            <div class=\"capacity\">\n                <app-icon\n                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'account_circle' }\"\n                ></app-icon>\n                {{ space.capacity || '0' }}\n            </div>\n        </div>\n        <div\n            class=\"info recurr\"\n            *ngIf=\"space.recurr_available && space.recurr_available.length\"\n            i18n=\"Booking space availability label\"\n        >\n            Available for&nbsp;<span>{{ availability }}</span\n            >&nbsp;meeting ocurrences\n        </div>\n    </div>\n    <div class=\"actions\">\n        <button\n            mat-button\n            name=\"select\"\n            [class.inverse]=\"multi && !selected\"\n            (tapped)=\"selectSpace()\"\n        >\n            {{ multi ? (selected ? 'Remove' : 'Select') : is_request ? 'Request' : 'Book' }}\n        </button>\n    </div>\n</div>\n","import { Component, Input, Output, EventEmitter, ViewChild, ElementRef } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\n\nimport { BookingFlowEvent } from '../booking-modal.component';\n\n\n@Component({\n    selector: 'booking-spaces-form',\n    templateUrl: './form.component.html',\n    styleUrls: ['./form.component.scss']\n})\nexport class BookingSpaceFlowFormComponent {\n    /** Booking form fields */\n    @Input() public form: FormGroup;\n    /** Whether form is not the first page in the flow */\n    @Input() public can_return: boolean = false;\n    /** Emitter for flow update events */\n    @Output() public event = new EventEmitter<BookingFlowEvent>();\n\n    @ViewChild('container', { static: true }) private container: ElementRef<HTMLDivElement>;\n\n    /** Move flow to next step */\n    public next(): void {\n        this.form.markAllAsTouched();\n        /* istanbul ignore else */\n        if (this.form.valid) {\n            this.event.emit({ type: 'next', step: 'form' });\n        } else if (this.container) {\n            this.container.nativeElement.scrollIntoView({\n                behavior: 'smooth',\n                block: 'start',\n                inline: 'nearest'\n            });\n        }\n    }\n\n    /** Move flow to previous step */\n    public previous(): void {\n        this.event.emit({ type: 'previous', step: 'form' });\n    }\n\n    /** Reset form to initial state */\n    public resetForm(): void {\n        this.event.emit({ type: 'reset', step: 'form' });\n    }\n}\n","<div class=\"booking-form\" #container>\n    <form [formGroup]=\"form\" (ngSubmit)=\"next()\">\n        <div class=\"body\">\n            <a-booking-form [form]=\"form\"></a-booking-form>\n        </div>\n        <div class=\"footer\">\n            <button mat-button type=\"button\" name=\"return\" *ngIf=\"can_return\" class=\"inverse\" (tapped)=\"previous()\" i18n=\"Booking form cancel action\">Back</button>\n            <button mat-button type=\"submit\" i18n=\"Booking form continue action\">Next</button>\n        </div>\n    </form>\n</div>\n","import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { FormGroup, FormControl } from '@angular/forms';\n\nimport { CateringItem } from 'src/app/services/data/catering/catering-item.class';\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { BaseDirective } from 'src/app/shared/base.directive';\n\nimport * as dayjs from 'dayjs';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\n\nexport interface CateringConfirmModalData {\n    form: FormGroup;\n    date: number;\n}\n\n@Component({\n    selector: 'a-catering-confirm-modal',\n    templateUrl: './catering-confirm-modal.component.html',\n    styleUrls: ['./catering-confirm-modal.component.scss'],\n})\nexport class BookingCateringConfirmModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user actions on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** List of selected items for the order */\n    public item_list: CateringItem[] = [];\n\n    /** Space selected for delivery */\n    public get space(): Space {\n        return this._data.form && this._data.form.controls.space\n            ? this._data.form.controls.space.value\n            : ({} as any);\n    }\n    /** Delivery time for the order */\n    public get delivery_time(): string {\n        const date = dayjs(this._data.date);\n        return date.format('h:mm A');\n    }\n\n    /** Form field for order items */\n    public get item_field(): FormControl {\n        return this._data.form.controls.items as any;\n    }\n\n    /** Total cost of the order */\n    public get order_cost(): number {\n        return this.item_list.reduce((amount, item) => amount + item.amount * item.unit_price, 0);\n    }\n\n    /** Currency symbol for the selected space */\n    public get symbol(): string {\n        /* istanbul ignore else */\n        if (!this.space || !this.space.level) {\n            return 'USD';\n        }\n        const building = this._org.buildings.find(\n            (bld) => bld.id === this.space.level.building_id\n        ) || { currency: 'USD' };\n        return building.currency;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _org: OrganisationService,\n        private _dialog_ref: MatDialogRef<BookingCateringConfirmModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: CateringConfirmModalData\n    ) {\n        super();\n        if (!this._data.form) {\n            this._service.notifyError('No form data for order');\n            this._dialog_ref.close();\n        }\n    }\n\n    public ngOnInit(): void {\n        /* istanbul ignore else */\n        if (this._data.form.controls.items) {\n            this.subscription(\n                'item_list',\n                this._data.form.controls.items.valueChanges.subscribe((items) => {\n                    /* istanbul ignore else */\n                    if (!items || items.length <= 0) {\n                        this._dialog_ref.close();\n                    }\n                })\n            );\n        }\n        this.item_list = this._data.form.controls.items.value.map((item) => new CateringItem(item));\n    }\n}\n","<header>\n    <div class=\"heading\" i18n=\"Catering confirm order header\">Confirm Catering Order</div>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main>\n        <div class=\"details\">\n            Delivering to <span>{{ space.name || '&lt;Unset&gt;' }}</span> at <span>{{ delivery_time }}</span>\n        </div>\n        <div class=\"list\">\n            <a-catering-order-item\n                *ngFor=\"let item of item_list\"\n                [field]=\"item_field\"\n                [subitem]=\"true\"\n                [item]=\"item\"\n                [symbol]=\"symbol\"\n            ></a-catering-order-item>\n        </div>\n        <div class=\"total\">\n            <label>Order Total:</label>\n            <div class=\"value\">{{ order_cost / 100 | currency:symbol }}</div>\n        </div>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button (tapped)=\"event.emit({ reason: 'done' })\" i18n=\"Catering confirm save action\">Save Order</button>\n    </footer>\n</mat-dialog-actions>\n","import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { FormGroup, Validators, AbstractControl, FormControl } from '@angular/forms';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { HashMap, DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { BookingNote } from 'src/app/services/data/bookings/booking.interfaces';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { CateringOrder } from 'src/app/services/data/catering/catering-order.class';\n\nimport * as dayjs from 'dayjs';\nimport { UsersService } from 'src/app/services/data/users/users.service';\n\nexport interface CateringDetailsModalData {\n    spaces: Space[];\n    notes_field: AbstractControl;\n    catering: AbstractControl;\n}\n\n@Component({\n    selector: 'a-catering-details-modal',\n    templateUrl: './catering-details-modal.component.html',\n    styleUrls: ['./catering-details-modal.component.scss'],\n})\nexport class CateringDetailsModalComponent implements OnInit {\n    /** Emitter for modal events */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Mapping of spaces to notes */\n    public notes: HashMap<string> = {};\n    /** Mapping of spaces to cost codes */\n    public codes: HashMap<string> = {};\n    /** Mapping of spaces to estimated head count */\n    public head_counts: HashMap<string> = {};\n    /** Mapping of spaces to form fields */\n    public form: HashMap<FormGroup> = {};\n    /** Map of spaces to whether they need a charge code */\n    public needs_charge_code: HashMap<boolean> = {};\n    /** Index of the active space */\n    public active_space: number = 0;\n\n    /** List of selected spaces */\n    public get space_list(): Space[] {\n        return this._data.spaces || [];\n    }\n\n    public get active_form(): FormGroup {\n        return this.form[this.space_list[this.active_space].id];\n    }\n\n    /** Whether form fields are valid */\n    public get is_valid(): boolean {\n        return this.space_list.reduce((valid, space) => valid && this.form[space.id].valid, true);\n    }\n\n    constructor(\n        private _users: UsersService,\n        @Inject(MAT_DIALOG_DATA) private _data: CateringDetailsModalData\n    ) {}\n\n    public ngOnInit(): void {\n        const note_list = this._data.notes_field.value.filter(\n            (note: BookingNote) => note.type === 'catering'\n        );\n        this.notes = note_list.reduce((map, note) => {\n            map[note.space] = note.message;\n            return map;\n        }, {});\n        this.codes = this._data.catering.value.reduce((map, order: CateringOrder) => {\n            map[order.location_id] = order.charge_code;\n            return map;\n        }, {});\n        this.generateFormFields();\n    }\n\n    public submit(): void {\n        this.space_list.forEach((space) => this.form[space.id].markAllAsTouched());\n        /* istanbul ignore else */\n        if (this.is_valid) {\n            // Update notes\n            const notes = this._data.notes_field.value.filter(\n                (note: BookingNote) => note.type !== 'catering'\n            );\n            const new_notes = this.space_list.map(\n                (space) =>\n                    ({\n                        author: this._users.current.name,\n                        type: 'catering',\n                        message: this.form[space.id].controls.notes.value,\n                        space: space.id,\n                        date: dayjs().valueOf(),\n                    } as BookingNote)\n            );\n            this._data.notes_field.setValue(notes.concat(new_notes).filter((note) => note.message));\n            const orders = this._data.catering.value.map(\n                (order) =>\n                    new CateringOrder({\n                        ...order,\n                        charge_code: this.form[order.location_id].controls.code.value,\n                    })\n            );\n            this._data.catering.setValue(orders);\n            this.event.emit({ reason: 'done' });\n        }\n    }\n\n    /** Generate form fields for each space */\n    private generateFormFields(): void {\n        for (const space of this.space_list) {\n            this.form[space.id] = new FormGroup({\n                notes: new FormControl(this.notes[space.id] || ''),\n                code: new FormControl(this.codes[space.id] || ''),\n            });\n        }\n    }\n}\n","<div class=\"header\">\n    <div class=\"tabs\">\n        <mat-tab-group [(selectedIndex)]=\"active_space\">\n            <mat-tab\n                *ngFor=\"let space of space_list\"\n                [label]=\"space.name + (form[space.id].invalid && form[space.id].touched ? '*' : '')\"\n            ></mat-tab>\n        </mat-tab-group>\n    </div>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</div>\n<mat-dialog-content>\n    <main>\n        <div class=\"details\">\n            <img src=\"assets/img/food-notes.svg\" />\n            <div class=\"text\">Please specify any allergies or gluten intolerances</div>\n        </div>\n        <form *ngIf=\"space_list[active_space] && active_form\" [formGroup]=\"active_form\">\n            <div class=\"field\">\n                <label for=\"equipment-notes\" i18n=\"Catering details equipment notes label\">\n                    (eg - allergies, in tolerances, no ice in drinks etc) Additional requests are\n                    handled in confidence.\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"equipment-notes\"\n                        formControlName=\"notes\"\n                        placeholder=\"Add notes here...\"\n                        i18n-placeholder\n                    ></textarea>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label\n                    for=\"charge-code\"\n                    [class.error]=\"\n                        active_form.controls.code.touched && active_form.controls.code.invalid\n                    \"\n                    i18n=\"Catering details charge code label\"\n                >\n                    Charge Code<span *ngIf=\"needs_charge_code[space_list[active_space].id]\">*</span>\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"charge-code\"\n                        formControlName=\"code\"\n                        placeholder=\"Charge Code\"\n                        i18n-placeholder\n                    />\n                    <mat-error i18n=\"Catering details charge code error\">\n                        Charge Code is required\n                    </mat-error>\n                    <mat-hint i18n=\"Catering details charge code hint\">\n                        <span>Note:</span> Your booking will be confirmed before you are charged.\n                    </mat-hint>\n                </mat-form-field>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button (tapped)=\"submit()\" i18n=\"Catering details save action\">\n            Add to booking\n        </button>\n    </footer>\n</mat-dialog-actions>\n","import { Component, Output, EventEmitter, Inject } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport { ApplicationIcon } from '../../shared/utilities/settings.interfaces';\nimport { DialogEvent } from '../../shared/utilities/types.utilities';\nimport { BaseDirective } from 'src/app/shared/base.directive';\n\nexport interface ConfirmModalData {\n    /** Title of the modal */\n    title: string;\n    /** Contents of the modal */\n    content: string;\n    /** Text displaed on the confirmation button */\n    action?: string;\n    /** Icon to display on the modal */\n    icon: ApplicationIcon;\n}\n\nexport const CONFIRM_METADATA = {\n    height: 'auto',\n    width: '24em',\n    maxHeight: 'calc(100vh - 2em)',\n    maxWidth: 'calc(100vw - 2em)'\n};\n\n@Component({\n    selector: 'confirm-modal',\n    templateUrl: './confirm-modal.component.html',\n    styleUrls: ['./confirm-modal.component.scss']\n})\nexport class ConfirmModalComponent extends BaseDirective {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Loading state */\n    public loading: string;\n\n    /** Title of the confirm modal */\n    public get title(): string {\n        return (this._data ? this._data.title : null) || 'Confirm';\n    }\n\n    /** Body of the confirm modal */\n    public get content(): string {\n        return (this._data ? this._data.content : null) || 'Are you sure?';\n    }\n\n    /** Display text on the confirm button */\n    public get action(): string {\n        return (this._data ? this._data.action : null) || 'Ok';\n    }\n\n    /** Display icon properties */\n    public get icon(): ApplicationIcon {\n        return (this._data ? this._data.icon : null) || null;\n    }\n\n    constructor(\n        private _dialog: MatDialogRef<ConfirmModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: ConfirmModalData\n    ) {\n        super();\n    }\n    /**\n     * User confirmation of the content of the modal\n     */\n    public accept() {\n        this.event.emit({ reason: 'done' });\n    }\n}\n","<header>\n    <h3 mat-dialog-title>{{ title || 'Confirm' }}</h3>\n</header>\n<mat-dialog-content>\n    <div class=\"body\" *ngIf=\"!loading; else load_state\">\n        <app-icon *ngIf=\"icon\" [icon]=\"icon\"></app-icon>\n        <div class=\"content\">\n            <p [innerHTML]=\"content || 'Are you sure?'\"></p>\n        </div>\n    </div>\n</mat-dialog-content>\n<mat-dialog-actions *ngIf=\"!loading\">\n    <footer>\n        <button mat-button class=\"inverse\" mat-dialog-close i18n=\"Close confirm modal\">Cancel</button>\n        <button mat-button name=\"accept\" (tapped)=\"accept()\">{{ action || 'Ok' }}</button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <div class=\"body\">\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </div>\n</ng-template>\n","import { Component, OnInit, Input } from '@angular/core';\n\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { CateringOrder } from 'src/app/services/data/catering/catering-order.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { BookingModalComponent } from '../../booking-modal/booking-modal.component';\nimport { MatDialog } from '@angular/material/dialog';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\n\n@Component({\n    selector: 'meeting-catering',\n    templateUrl: './catering.component.html',\n    styleUrls: ['./catering.component.scss'],\n})\nexport class MeetingCateringDetailsComponent {\n    /** Booking to display details */\n    @Input() public booking: Booking;\n\n    /** List of orders for this booking and space */\n    public get orders(): CateringOrder[] {\n        return this.booking.catering.filter((order) => order.location_id === this.booking.space.id);\n    }\n\n    /** Total cost of all the orders */\n    public get total(): number {\n        let total = 0;\n        this.orders.forEach((order) => (total += order.total));\n        return total;\n    }\n\n    /** Charge code for orders in the active space */\n    public get charge_code(): string {\n        return (this.orders.length ? this.orders[0].charge_code : '') || '<No Charge code>';\n    }\n\n    /** Currency symbol for orders in active space */\n    public get symbol(): string {\n        const space = (this.booking.space || { level: { building_id: '' } });\n        const building = this._org.buildings.find(\n            (bld) => bld.id === space.level.building_id\n        ) || { currency: 'USD' };\n        return building.currency;\n    }\n\n    /** Notes for orders in active space */\n    public get notes(): string {\n        const note = this.booking.notes.find(\n            (note) =>\n                note.type === 'catering' &&\n                note.space === this.booking.space.id &&\n                note.author === this.booking.creator.name\n        );\n        return note ? note.message : '<No Notes>';\n    }\n\n    /** Whether booking has been declined or ended */\n    public get expired(): boolean {\n        return this.booking.status === 'done' || this.booking.declined;\n    }\n\n    constructor(private _org: OrganisationService, private _dialog: MatDialog) {}\n\n    /** Store the order details for viewing in another component */\n    public storeOrder(order: CateringOrder) {\n        localStorage.setItem('CONCIERGE.view_order', JSON.stringify(order.toJSON()));\n        localStorage.setItem('CONCIERGE.view_booking', JSON.stringify(this.booking.toJSON()));\n        localStorage.setItem('CONCIERGE.date', `${this.booking.date}`);\n    }\n\n    /** Open modal to edit catering details for booking */\n    public editMeetingCatering() {\n        this._dialog.open(BookingModalComponent, {\n            data: {\n                booking: this.booking,\n                only_catering: true,\n            },\n        });\n    }\n}\n","<div class=\"heading\">\n    Catering\n</div>\n<div class=\"content\" *ngIf=\"booking\">\n    <div class=\"field\">\n        <label for=\"orders\">Orders:</label>\n        <div class=\"value\" name=\"orders\" *ngIf=\"orders.length; else no_orders\">\n            <a\n                mat-button\n                *ngFor=\"let order of orders\"\n                [routerLink]=\"['/catering', 'orders']\"\n                [queryParams]=\"{ view: order.id }\"\n                (click)=\"storeOrder(order)\"\n                mat-dialog-close\n            >\n                <div class=\"details\">\n                    <div class=\"time\">At {{ order.deliver_at_time }}</div>\n                    <div class=\"count\">\n                        {{ order.item_count }} item{{ order.item_count === 1 ? '' : 's' }}\n                    </div>\n                    <div class=\"total\">{{ order.total / 100 | currency: order.symbol }}</div>\n                </div>\n            </a>\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"false\">\n        <label for=\"total\">Total:</label>\n        <div class=\"value\" name=\"total\">\n            {{ total / 100 | currency: symbol }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"false\">\n        <label for=\"charge-code\">Charge Code:</label>\n        <div class=\"value\" name=\"charge-code\">\n            {{ charge_code }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"false\">\n        <label for=\"notes\">Notes:</label>\n        <div class=\"value\" name=\"notes\">\n            {{ notes }}\n        </div>\n    </div>\n</div>\n<button class=\"footer\" mat-button name=\"edit\" *ngIf=\"!expired\" (tapped)=\"editMeetingCatering()\">\n    Edit Catering\n</button>\n<ng-template #no_orders>\n    <div class=\"value\" name=\"orders\">\n        &lt;No Catering Orders&gt;\n    </div>\n</ng-template>\n","import { Component, Input } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { humaniseDuration } from 'src/app/shared/utilities/general.utilities';\nimport { RECURRENCE_PERIODS } from 'src/app/shared/utilities/formatting.utilities';\nimport { BookingModalComponent } from '../../booking-modal/booking-modal.component';\n\nimport * as dayjs from 'dayjs';\n\n@Component({\n    selector: 'meeting-details',\n    templateUrl: './details.component.html',\n    styleUrls: ['./details.component.scss'],\n})\nexport class MeetingDetailsDisplayComponent {\n    /** Booking to display details */\n    @Input() public booking: Booking;\n\n    /** Display string for the locations in the booking */\n    public get location() {\n        return this.booking.space_list.map((space) => space.name).join('\\n');\n    }\n    /** Display string for the booking duration */\n    public get duration() {\n        return this.booking ? humaniseDuration(this.booking.duration) : '1 hour';\n    }\n    /** Display string for attendees in booking */\n    public get start_time() {\n        return dayjs(this.booking.date).format('DD MMM YYYY, h:mm A');\n    }\n    /** Display string for attendees in booking */\n    public get end_time() {\n        return dayjs(this.booking.date)\n            .add(this.booking.duration, 'm')\n            .format('DD MMM YYYY, h:mm A');\n    }\n    /** Display string for attendees in booking */\n    public get attendees() {\n        return this.booking.attendees.map((person) => person.name).join('\\n');\n    }\n\n    /** Recurrence setting for booking */\n    public get recurrence(): string {\n        const { end, period } = this.booking.recurrence;\n        /* istanbul ignore if */\n        if (!period) {\n            return '<No recurrence>';\n        }\n        const pattern = RECURRENCE_PERIODS.find((i) => i.toLowerCase() === `${period}`);\n        const date = dayjs(end).format('DD MMM YYYY');\n        return `${pattern} until ${date}`;\n    }\n\n    /** Whether booking has been declined or ended */\n    public get expired(): boolean {\n        return this.booking.status === 'done' || this.booking.declined;\n    }\n\n    constructor(private _dialog: MatDialog) {}\n\n    public editMeeting() {\n        this._dialog.open(BookingModalComponent, {\n            data: {\n                booking: this.booking,\n            },\n        });\n    }\n}\n","<div class=\"heading\">\n    Meeting Details\n</div>\n<div class=\"content\" *ngIf=\"booking\">\n    <div class=\"field\" [class.edited]=\"true\">\n        <label for=\"host\">Host:</label>\n        <div class=\"value\" name=\"host\">\n            {{ booking.organiser?.name || booking.organiser_email }}\n        </div>\n        <div class=\"actions\">\n            <a\n                mat-icon-button\n                target=\"_blank\"\n                [href]=\"'mailto:' + booking.organiser_email + '?subject=' + booking.title\"\n            >\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'mail' }\"></app-icon>\n            </a>\n            <a\n                mat-icon-button\n                [attr.disabled]=\"!booking.organiser?.phone\"\n                target=\"_blank\"\n                [href]=\"'tel:' + booking.organiser?.phone\"\n            >\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'call' }\"></app-icon>\n            </a>\n        </div>\n    </div>\n    <div class=\"field\" *ngIf=\"booking.creator_email && booking.creator_email !== booking.organiser_email\" [class.edited]=\"true\">\n        <label for=\"host\">Booked By:</label>\n        <div class=\"value\" name=\"host\">\n            {{ booking.creator?.name || booking.creator_email }}\n        </div>\n        <div class=\"actions\">\n            <a\n                mat-icon-button\n                target=\"_blank\"\n                [href]=\"'mailto:' + booking.creator_email + '?subject=' + booking.title\"\n            >\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'mail' }\"></app-icon>\n            </a>\n            <a\n                mat-icon-button\n                [attr.disabled]=\"!booking.creator?.phone\"\n                target=\"_blank\"\n                [href]=\"'tel:' + booking.creator?.phone\"\n            >\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'call' }\"></app-icon>\n            </a>\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"false\">\n        <label for=\"location\">Location(s):</label>\n        <div class=\"value\" name=\"location\">\n            {{ location }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"false\">\n        <label for=\"start-time\">Start:</label>\n        <div class=\"value\" name=\"start-time\">\n            {{ start_time }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"false\">\n        <label for=\"end-time\">End:</label>\n        <div class=\"value\" name=\"end-time\">\n            {{ end_time }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"false\">\n        <label for=\"duration\">Duration:</label>\n        <div class=\"value\" name=\"duration\">\n            {{ duration }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"false\">\n        <label for=\"recurrence\">Recurrence:</label>\n        <div class=\"value\" name=\"recurrence\">\n            {{ recurrence }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"false\">\n        <label for=\"attendees\">Attendees:</label>\n        <div class=\"value\" name=\"attendees\">\n            {{ attendees }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"false\">\n        <label for=\"vc-equipment\">VC Equipment:</label>\n        <div class=\"value\" name=\"vc-equipment\">\n            No\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"false\">\n        <label for=\"notes\">Notes:</label>\n        <div class=\"value html\" name=\"notes\" [innerHTML]=\"booking.body | sanitize:'html'\"></div>\n    </div>\n</div>\n<button class=\"footer\" *ngIf=\"!expired\" mat-button (tapped)=\"editMeeting()\">\n    Edit Meeting\n</button>\n","import { Component, Inject, Output, EventEmitter } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material/dialog';\n\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport {\n    ConfirmModalComponent,\n    ConfirmModalData,\n    CONFIRM_METADATA,\n} from '../confirm-modal/confirm-modal.component';\nimport { DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { BookingsService } from 'src/app/services/data/bookings/bookings.service';\n\nexport interface MeetingDetailsModalData {\n    booking: Booking;\n}\n\n@Component({\n    selector: 'a-meeting-details-modal',\n    templateUrl: './meeting-details-modal.component.html',\n    styleUrls: ['./meeting-details-modal.component.scss'],\n})\nexport class MeetingDetailsModalComponent extends BaseDirective {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Display string for the loading state */\n    public loading: string;\n    /** Handler for request errors */\n    private _on_error = (message) => (err) => {\n        this._service.notifyError(`${message}. Error: ${err.message || err}`);\n        this.setLoading(null);\n    };\n    /** Booking to view details */\n    public get booking(): Booking {\n        return this._data.booking;\n    }\n    /** Type of meeting */\n    public get type(): string {\n        return this.booking.declined ? 'declined' : this.booking.type;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _bookings: BookingsService,\n        private _dialog_ref: MatDialogRef<MeetingDetailsModalComponent>,\n        private _dialog: MatDialog,\n        @Inject(MAT_DIALOG_DATA) private _data: MeetingDetailsModalData\n    ) {\n        super();\n    }\n\n    public setLoading(state: string) {\n        this.loading = state;\n        this._dialog_ref.disableClose = !!this.loading;\n    }\n\n    public acceptMeeting() {\n        this.setLoading('Accepting meeting...');\n        this._bookings.accept(this.booking.id, {\n            comment: '',\n            room_id: this.booking.space.id,\n        }).then(() => {\n            this._service.notifySuccess('Meeting approved.');\n            this.booking.approval_status[this.booking.space.id] = 'accepted';\n            this.setLoading(null);\n            this.event.emit({ reason: 'action', metadata: 'approved' });\n        }, this._on_error('Unable to approving meeting'));\n    }\n\n    public declineMeeting() {\n        this.setLoading('Declining meeting...');\n        this._bookings.decline(this.booking.id, {\n            booking_id: this.booking.id,\n            organiser: this.booking.organiser.email,\n            icaluid: this.booking.icaluid,\n            start: Math.floor(this.booking.date / 1000),\n            end: Math.floor(this.booking.date / 1000) + this.booking.duration * 60,\n            room_id: this.booking.space.id,\n        }).then(() => {\n            this._service.notifySuccess('Meeting declined.');\n            this.booking.approval_status[this.booking.space.id] = 'declined';\n            this.setLoading(null);\n            this.event.emit({ reason: 'action', metadata: 'declined' });\n        }, this._on_error('Unable to declining meeting'));\n    }\n\n    /** Open modal to confirm deletion of booking */\n    public confirmDeleteMeeting() {\n        const ref = this._dialog.open<ConfirmModalComponent, ConfirmModalData>(\n            ConfirmModalComponent,\n            {\n                ...CONFIRM_METADATA,\n                data: {\n                    title: 'Delete meeting',\n                    content: `Are you sure you want to delete the meeting in ${this.booking.space.name} at ${this.booking.date_string}, ${this.booking.start_time}?`,\n                    icon: { type: 'icon', class: 'material-icons', content: 'delete' },\n                },\n            }\n        );\n        this.subscription(\n            'confirm',\n            ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    this.deleteMeeting().catch(this._on_error('Error deleting booking'));\n                }\n                ref.close();\n            })\n        );\n        ref.afterClosed().subscribe(() => this.unsub('confirm'));\n    }\n\n    /** Delete booking */\n    private async deleteMeeting() {\n        this.setLoading('Deleting meeting...');\n        await this.booking.delete();\n        this._service.notifySuccess('Successfully deleted booking');\n        this.setLoading(null);\n        this.event.emit({ reason: 'action', metadata: 'removed' });\n        this._dialog_ref.close();\n    }\n}\n","<header [class]=\"type\">\n    <div class=\"time\">{{ booking.time_period }}</div>\n    <div class=\"heading\">{{ booking?.title }}</div>\n    <div class=\"actions\">\n        <button mat-icon-button name=\"menu\" [matMenuTriggerFor]=\"appMenu\" *ngIf=\"!loading\">\n            <app-icon\n                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'more_vert' }\"\n            ></app-icon>\n        </button>\n        <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n            <app-icon\n                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"\n            ></app-icon>\n        </button>\n    </div>\n</header>\n<mat-dialog-content [class]=\"type\">\n    <main *ngIf=\"!loading; else load_state\">\n        <div class=\"block\">\n            <meeting-details [booking]=\"booking\"></meeting-details>\n        </div>\n        <div class=\"block\">\n            <meeting-details-requirements [booking]=\"booking\" (loading)=\"setLoading($event)\"></meeting-details-requirements>\n        </div>\n        <div class=\"block\">\n            <meeting-catering [booking]=\"booking\"></meeting-catering>\n        </div>\n        <div class=\"block\">\n            <meeting-private-details [booking]=\"booking\"></meeting-private-details>\n        </div>\n    </main>\n</mat-dialog-content>\n<mat-menu #appMenu=\"matMenu\">\n    <button mat-menu-item name=\"accept\" (tapped)=\"acceptMeeting()\">\n        <div class=\"group\">\n            <app-icon\n                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'event_available' }\"\n            ></app-icon>\n            Accept Meeting\n        </div>\n    </button>\n    <button mat-menu-item name=\"decline\" (tapped)=\"declineMeeting()\">\n        <div class=\"group\">\n            <app-icon\n                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'event_busy' }\"\n            ></app-icon>\n            Decline Meeting\n        </div>\n    </button>\n    <button mat-menu-item [class.error]=\"true\" name=\"delete\" (tapped)=\"confirmDeleteMeeting()\">\n        <div class=\"group\">\n            <app-icon\n                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'delete' }\"\n            ></app-icon>\n            Delete Meeting\n        </div>\n    </button>\n</mat-menu>\n<ng-template #load_state>\n    <main>\n        <div class=\"info-block center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </main>\n</ng-template>\n","import { Component, OnInit, Input } from '@angular/core';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { humaniseDuration } from 'src/app/shared/utilities/general.utilities';\nimport { MatDialog } from '@angular/material/dialog';\nimport { PrivateDetailsModalComponent } from '../../private-details-modal/private-details-modal.component';\n\n@Component({\n    selector: 'meeting-private-details',\n    templateUrl: './private-details.component.html',\n    styleUrls: ['./private-details.component.scss'],\n})\nexport class MeetingPrivateDetailsComponent implements OnInit {\n    /** Booking to display details */\n    @Input() public booking: Booking;\n\n    public get setup(): string {\n        return this.booking && this.booking.setup ? humaniseDuration(this.booking.setup) : '<No Setup time>';\n    }\n\n    public get breakdown(): string {\n        return this.booking && this.booking.breakdown ? humaniseDuration(this.booking.breakdown) : '<No Breakdown time>';\n    }\n\n    public get notes() {\n        return '';\n    }\n\n    constructor(private _dialog: MatDialog) {}\n\n    ngOnInit(): void {}\n\n    public openPrivateDetailsModal() {\n        this._dialog.open(PrivateDetailsModalComponent, {\n            data: {\n                booking: this.booking\n            }\n        });\n    }\n}\n","<div class=\"heading\">\n    Private Details\n</div>\n<div class=\"content\">\n    <div class=\"field\">\n        <label for=\"setup\">Setup:</label>\n        <div class=\"value\" name=\"setup\">\n            {{ setup }}\n        </div>\n    </div>\n    <div class=\"field\">\n        <label for=\"breakdown\">Breakdown:</label>\n        <div class=\"value\" name=\"breakdown\">\n            {{ breakdown }}\n        </div>\n    </div>\n    <div class=\"field\">\n        <label for=\"notes\">Private Notes:</label>\n        <div class=\"value\" name=\"notes\">\n            {{ notes || '&lt;No Notes&gt;' }}\n        </div>\n    </div>\n</div>\n<button class=\"footer\" mat-button (tapped)=\"openPrivateDetailsModal()\">\n    Edit Private Details\n</button>\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { RequirementDetailsModalComponent, RequirementDetailsModalData } from '../../requirement-details-modal/requirement-details-modal.component';\nimport { generateBookingForm } from 'src/app/services/data/bookings/booking.utilities';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { BaseDirective } from 'src/app/shared/base.directive';\n\n@Component({\n    selector: 'meeting-details-requirements',\n    templateUrl: './requirements.component.html',\n    styleUrls: ['./requirements.component.scss'],\n})\nexport class MeetingDetailsRequirementsComponent extends BaseDirective {\n    /** Booking to display details */\n    @Input() public booking: Booking;\n    /** Emitter for changes to the booking */\n    @Output() public bookingChange = new EventEmitter<Booking>();\n    /** Emitter for changes to the loading state */\n    @Output() public loading = new EventEmitter<string>()\n\n    /** Requirement notes */\n    public get notes(): string {\n        const note = this.booking.notes.find(\n            (note) => note.type === 'equipment' && this.booking.space.id === note.space\n        );\n        return (note ? note.message : '') || '<No Notes>';\n    }\n\n    /** Whether booking has been declined or ended */\n    public get expired(): boolean {\n        return this.booking.status === 'done' || this.booking.declined;\n    }\n\n    constructor(private _dialog: MatDialog, private _service: ApplicationService) {\n        super();\n    }\n\n\n    /** Open modal for adding equipment requirements to booking */\n    public openEquipmentDetailsModal() {\n        const form = generateBookingForm(this.booking, ['space_list']);\n        const ref = this._dialog.open<\n            RequirementDetailsModalComponent,\n            RequirementDetailsModalData\n        >(RequirementDetailsModalComponent, {\n            maxWidth: '95vw',\n            width: '32em',\n            data: {\n                spaces: form.controls.space_list.value,\n                notes_field: form.controls.notes,\n                codes_field: form.controls.equipment_codes,\n                head_counts_field: form.controls.expected_attendees,\n                standalone: true\n            }\n        });\n        this.subscription(\n            'modal_events',\n            ref.componentInstance.event.subscribe(async (event: DialogEvent) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    ref.close();\n                    this.loading.emit('Updating requirements...');\n                    const new_booking: Booking = await this.booking.save().catch((err) => {\n                        this._service.notifyError(`Error updating requirements. Error: ${err.message || err}`);\n                    }) as any;\n                    this.loading.emit(null);\n                    /* istanbul ignore else */\n                    if (new_booking) {\n                        this.booking = new_booking;\n                        this.bookingChange.emit(new_booking);\n                    }\n                }\n            })\n        );\n    }\n}\n","<div class=\"heading\">\n    Room Requirements\n</div>\n<div class=\"content\" *ngIf=\"booking\">\n    <div class=\"field\">\n        <label for=\"location\">Location:</label>\n        <div class=\"value\" name=\"location\">\n            {{ booking.space?.name || booking.space_ids[0] }}\n        </div>\n    </div>\n    <div class=\"field\">\n        <label for=\"expected\">Expected Attendees:</label>\n        <div class=\"value\" name=\"expected\">\n            {{ (booking.expected_attendees || {})[booking.space?.id || booking.space_ids[0]] || '0' }}\n        </div>\n    </div>\n    <div class=\"field\">\n        <label for=\"charge-code\">Charge Code:</label>\n        <div class=\"value\" name=\"charge-code\">\n            {{ (booking.equipment_codes || {})[booking.space?.id || booking.space_ids[0]] || '&lt;No Charge Code&gt;' }}\n        </div>\n    </div>\n    <div class=\"field\">\n        <label for=\"notes\">Private Notes:</label>\n        <div class=\"value\" name=\"notes\">\n            {{ notes }}\n        </div>\n    </div>\n</div>\n<button class=\"footer\" mat-button *ngIf=\"!expired\" (tapped)=\"openEquipmentDetailsModal()\">\n    Edit Requirements\n</button>\n","import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { generateUserForm } from 'src/app/services/data/users/user.utilities';\nimport { User } from 'src/app/services/data/users/user.class';\nimport { DialogEvent } from '../../shared/utilities/types.utilities';\n\n@Component({\n  selector: 'new-user-modal',\n  templateUrl: './new-user-modal.component.html',\n  styleUrls: ['./new-user-modal.component.scss']\n})\nexport class NewUserModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form fields for the new user */\n    public form: FormGroup;\n    /** New user data store */\n    public user: User;\n    /** Whether user details are being saved */\n    public loading: boolean;\n\n    public ngOnInit(): void {\n        this.user = new User({});\n        this.form = generateUserForm(this.user);\n    }\n\n    public saveChanges() {\n        this.form.markAllAsTouched();\n        if (this.form.valid) {\n            const new_user = new User({\n                ...this.form.value,\n                name: `${this.form.value.first_name} ${this.form.value.last_name}`,\n                type: 'external'\n            });\n            this.event.emit({ reason: 'done', metadata: new_user });\n        }\n    }\n\n}\n","<header>\n    <h3 mat-dialog-title>Add External Attendee</h3>\n    <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<div class=\"body\" *ngIf=\"!loading; else load_state\">\n    <user-form [form]=\"form\"></user-form>\n</div>\n<footer *ngIf=\"!loading\">\n    <button mat-button class=\"inverse\" mat-dialog-close>Cancel</button>\n    <button mat-button (tapped)=\"saveChanges()\">Save</button>\n</footer>\n<ng-template #load_state>\n    <div class=\"body\">\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">\n                Saving attendee...\n            </div>\n        </div>\n    </div>\n</ng-template>\n\n","\nimport { NgModule, Type } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ReactiveFormsModule, FormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\n\nimport { SharedContentModule } from '../shared/shared.module';\n\nimport { ConfirmModalComponent } from './confirm-modal/confirm-modal.component';\nimport { NewUserModalComponent } from './new-user-modal/new-user-modal.component';\nimport { SpaceSelectModalComponent } from './space-select-modal/space-select-modal.component';\nimport { RecurrenceModalComponent } from './recurrence-modal/recurrence-modal.component';\nimport { MeetingDetailsModalComponent } from './meeting-details-modal/meeting-details-modal.component';\nimport { MeetingDetailsDisplayComponent } from './meeting-details-modal/details/details.component';\nimport { MeetingDetailsRequirementsComponent } from './meeting-details-modal/requirements/requirements.component';\nimport { MeetingCateringDetailsComponent } from './meeting-details-modal/catering/catering.component';\nimport { MeetingPrivateDetailsComponent } from './meeting-details-modal/private-details/private-details.component';\nimport { PrivateDetailsModalComponent } from './private-details-modal/private-details-modal.component';\nimport { BookingModalComponent } from './booking-modal/booking-modal.component';\nimport { RequirementDetailsModalComponent } from './requirement-details-modal/requirement-details-modal.component';\nimport { RecurrenceSpacesModalComponent } from './recurrence-spaces-modal/recurrence-spaces-modal.component';\nimport { PackageOptionsModalComponent } from './package-options-modal/package-options-modal.component';\nimport { CateringDetailsModalComponent } from './catering-details-modal/catering-details-modal.component';\nimport { BookingCateringConfirmModalComponent } from './catering-confirm-modal/catering-confirm-modal.component';\nimport { BookingConfirmComponent } from './booking-confirm/booking-confirm.component';\nimport { BookingCateringComponent } from './booking-modal/catering/catering.component';\nimport { BookingFindSpaceComponent } from './booking-modal/find-space/find-space.component';\nimport { BookingSpaceFiltersComponent } from './booking-modal/find-space/filters/filters.component';\nimport { BookingSpaceItemComponent } from './booking-modal/find-space/item/item.component';\nimport { BookingSpaceFlowFormComponent } from './booking-modal/form/form.component';\nimport { BookingCateringOrderDetailsComponent } from './booking-modal/catering/order-details/order-details.component';\nimport { BookingCateringOrderListComponent } from './booking-modal/catering/order-list/order-list.component';\nimport { CateringOrderListItemComponent } from './booking-modal/catering/order-list/item/item.component';\nimport { CateringMenuCategoryComponent } from './booking-modal/catering/order-details/category/category.component';\nimport { CateringMenuItemComponent } from './booking-modal/catering/order-details/item/item.component';\n\nconst OVERLAYS: Type<any>[] = [\n    ConfirmModalComponent,\n    NewUserModalComponent,\n    SpaceSelectModalComponent,\n    RecurrenceModalComponent,\n    MeetingDetailsModalComponent,\n    PrivateDetailsModalComponent,\n    BookingModalComponent,\n    RequirementDetailsModalComponent,\n];\n\n@NgModule({\n    declarations: [\n        ...OVERLAYS,\n        MeetingDetailsDisplayComponent,\n        MeetingDetailsRequirementsComponent,\n        MeetingCateringDetailsComponent,\n        MeetingPrivateDetailsComponent,\n        RecurrenceSpacesModalComponent,\n        PackageOptionsModalComponent,\n        CateringDetailsModalComponent,\n        BookingCateringConfirmModalComponent,\n        BookingConfirmComponent,\n        BookingSpaceFlowFormComponent,\n        BookingCateringComponent,\n        BookingFindSpaceComponent,\n        BookingSpaceFiltersComponent,\n        BookingSpaceItemComponent,\n        BookingCateringComponent,\n        BookingCateringOrderDetailsComponent,\n        BookingCateringOrderListComponent,\n        CateringOrderListItemComponent,\n        CateringMenuCategoryComponent,\n        CateringMenuItemComponent\n    ],\n    imports: [\n        CommonModule,\n        SharedContentModule,\n        FormsModule,\n        ReactiveFormsModule,\n        RouterModule.forChild([])\n    ],\n    exports: [\n        ...OVERLAYS\n    ]\n})\nexport class SharedOverlaysModule {}\n","import { Component, Output, EventEmitter, Inject } from '@angular/core';\n\nimport { DialogEvent, HashMap } from 'src/app/shared/utilities/types.utilities';\nimport { CateringCategory } from 'src/app/services/data/catering/catering-category.class';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { CateringItem } from 'src/app/services/data/catering/catering-item.class';\n\nexport interface PackageOptionsModalData {\n    item: CateringCategory;\n}\n\nexport function checkItemRequirements(category: CateringCategory): boolean {\n    const items = category.items;\n    return category.must_select >= items.length\n        ? items.reduce((valid, item) => valid && checkItemRequirements(item as any), true)\n        : items.reduce((amount, item) => (amount + item.amount ? 1 : 0), 0) ===\n              category.must_select;\n}\n\nexport function getActiveItems(category: CateringCategory): HashMap<string> {\n    let map = {};\n    if (category.items) {\n        const item = category.items.find(item  => item.amount > 0);\n        if (item) {\n            map[category.id] = item.id;\n        }\n        category.items.forEach(item => map = { ...map, ...getActiveItems(item as any) })\n    }\n    return map;\n}\n\n@Component({\n    selector: 'a-package-options-modal',\n    templateUrl: './package-options-modal.component.html',\n    styleUrls: ['./package-options-modal.component.scss']\n})\nexport class PackageOptionsModalComponent {\n    /** Emitter for user actions on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n\n    /** Item to select options for */\n    public get item(): CateringCategory {\n        return this._data.item;\n    }\n\n    /** Whether package requirements have been met */\n    public get requirements_met(): boolean {\n        return checkItemRequirements(this.item);\n    }\n\n    public get active_items(): HashMap<string> {\n        return getActiveItems(this.item);\n    }\n\n    constructor(@Inject(MAT_DIALOG_DATA) private _data: PackageOptionsModalData) {}\n\n    /**\n     * Update the list of selected items\n     */\n    public updateAmount(a_package: CateringCategory, option: CateringItem, state: boolean) {\n        if (state) {\n            const needed = a_package.must_select;\n            const active = a_package.items.filter(an_item => an_item.amount > 0).length;\n            if (active >= needed) {\n                const item = a_package.items.find(an_item => an_item.amount > 0);\n                item.setAmount(0);\n            }\n            option.setAmount(1);\n        } else {\n            option.setAmount(0);\n        }\n    }\n}\n","<header>\n    <h3 i18n=\"Catering package options header\">Package Options</h3>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main>\n        <ng-container *ngTemplateOutlet=\"item_display; context: { package: item }\"></ng-container>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button [disabled]=\"!requirements_met\" (tapped)=\"event.emit({ reason: 'done' })\" i18n=\"Catering package options save action\">\n            Confirm Options\n        </button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #item_display let-package=\"package\">\n    <ng-container *ngIf=\"package.items && package.items.length\">\n        <mat-radio-group name=\"sub-item-list\" [ngModel]=\"active_items[package.id]\">\n            <div class=\"item\" *ngFor=\"let option of package.items\" [attr.to-select]=\"option.must_select\">\n            <ng-container\n                *ngIf=\"\n                    package.must_select &&\n                    package.must_select < package.items.length &&\n                    !option.must_select\n                \"\n            >\n                <mat-checkbox\n                    name=\"selected\"\n                    *ngIf=\"package.must_select > 1\"\n                    [checked]=\"!!option.amount\"\n                    (change)=\"updateAmount(package, option, $event.checked)\"\n                >\n                    {{ option.name }}\n                </mat-checkbox>\n                <mat-radio-button\n                    name=\"selected\"\n                    *ngIf=\"package.must_select === 1\"\n                    [value]=\"option.id\"\n                    (change)=\"updateAmount(package, option, true)\"\n                >\n                    {{ option.name }}\n                </mat-radio-button>\n            </ng-container>\n            <ng-container *ngIf=\"package.must_select >= package.items.length || option.must_select\">\n                {{ option.name }}\n            </ng-container>\n            <ng-container\n                *ngTemplateOutlet=\"item_display; context: { package: option }\"\n            ></ng-container>\n        </div>\n    </mat-radio-group>\n    </ng-container>\n</ng-template>\n","import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { FormGroup, FormControl } from '@angular/forms';\n\nimport { UsersService } from 'src/app/services/data/users/users.service';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { Identity, DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { humaniseDuration } from 'src/app/shared/utilities/general.utilities';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { BookingNote } from 'src/app/services/data/bookings/booking.interfaces';\n\nimport * as dayjs from 'dayjs';\n\nexport interface PrivateDetailsModalData {\n    booking: Booking;\n}\n\n@Component({\n    selector: 'a-private-details-modal',\n    templateUrl: './private-details-modal.component.html',\n    styleUrls: ['./private-details-modal.component.scss'],\n})\nexport class PrivateDetailsModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form Fields for private details */\n    public form: FormGroup;\n    /** Whether changes are being saved */\n    public loading: boolean;\n    /** List of available durations for setup and breakdown */\n    public available_durations: Identity[] = new Array(5)\n        .fill(0)\n        .map((_, i) => ({ id: i * 15, name: humaniseDuration(i * 15) || '0 minutes' }));\n\n    public get booking(): Booking {\n        return this._data.booking;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _users: UsersService,\n        private _dialog_ref: MatDialogRef<PrivateDetailsModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: PrivateDetailsModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        const note = this.booking.notes.find(\n            (note) => note.type === 'private' && note.space === this.booking.space.id\n        ) || { message: '' };\n        this.form = new FormGroup({\n            setup: new FormControl(this.booking.setup || 0),\n            breakdown: new FormControl(this.booking.breakdown || 0),\n            notes: new FormControl(note.message),\n        });\n    }\n\n    public saveChanges() {\n        if (this.form.dirty) {\n            const old_notes = this.booking.notes.filter(\n                (note) => !(note.type === 'private' && note.space === this.booking.space.id)\n            );\n            const notes = [\n                ...old_notes,\n                {\n                    type: 'private',\n                    date: dayjs().valueOf(),\n                    message: this.form.value.notes,\n                    author: this._users.current.name,\n                    space: this.booking.space.id,\n                } as BookingNote,\n            ];\n            const new_booking = new Booking({\n                ...this.booking.toJSON(),\n                ...this.form.value,\n                notes,\n            });\n            this.loading = true;\n            this._dialog_ref.disableClose = true;\n            new_booking.save().then(\n                (booking) => {\n                    this._service.notifySuccess('Successfully updated private details');\n                    this.event.emit({ reason: 'done', metadata: booking });\n                    this._dialog_ref.close();\n                },\n                (err) => {\n                    this._dialog_ref.disableClose = false;\n                    this._service.notifyError(\n                        `Unable to save changes to private details. Error: ${err.message || err}`\n                    );\n                    this.loading = false;\n                }\n            );\n        } else {\n            this._dialog_ref.close();\n        }\n    }\n}\n","<header>\n    <div class=\"heading\">Edit Private Details</div>\n    <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main *ngIf=\"!loading; else load_state\">\n        <form *ngIf=\"form\" [formGroup]=\"form\">\n            <div class=\"field\">\n                <label for=\"setup\">Setup:</label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select name=\"setup\" formControlName=\"setup\" placeholder=\"None\">\n                        <mat-option *ngFor=\"let duration of available_durations\" [value]=\"duration.id\">\n                            {{ duration.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"breakdown\">Breakdown:</label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select name=\"breakdown\" formControlName=\"breakdown\" placeholder=\"None\">\n                        <mat-option *ngFor=\"let duration of available_durations\" [value]=\"duration.id\">\n                            {{ duration.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"notes\">Notes:</label>\n                <mat-form-field name=\"notes\" appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"notes\"\n                        placeholder=\"Private Notes\"\n                        formControlName=\"notes\"\n                    ></textarea>\n                </mat-form-field>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button (tapped)=\"saveChanges()\">Save</button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main>\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div classs=\"text\">Updating private details...</div>\n        </div>\n    </main>\n</ng-template>\n","import { Component, OnInit, Output, EventEmitter, Inject } from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport { DialogEvent, Identity } from '../../shared/utilities/types.utilities';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { BookingRecurrenceDetails } from 'src/app/services/data/bookings/booking.interfaces';\n\nexport interface RecurrenceModalData {\n    /** Current recurrence details */\n    details: BookingRecurrenceDetails;\n    /** Currently set date for the booking */\n    date: number;\n}\n\nexport const RECURRENCE_METADATA = {\n    height: 'auto',\n    width: '24em',\n    maxHeight: 'calc(100vh - 2em)',\n    maxWidth: 'calc(100vw - 2em)'\n};\n\n@Component({\n    selector: 'recurrence-modal',\n    templateUrl: './recurrence-modal.component.html',\n    styleUrls: ['./recurrence-modal.component.scss']\n})\nexport class RecurrenceModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form fields for recurrence */\n    public form: FormGroup;\n    /** Loading state */\n    public loading: string;\n    /** Available recurrence periods */\n    public periods: Identity[] = [\n        { id: 'None', name: 'None' },\n        { id: 'Daily', name: 'Daily' },\n        { id: 'Weekly', name: 'Weekly' },\n        { id: 'Biweekly', name: 'Biweekly' },\n        { id: 'Monthly', name: 'Monthly' },\n    ];\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: RecurrenceModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.form = new FormGroup({\n            period: new FormControl(this._data.details.period || 'none'),\n            end: new FormControl(this._data.details.end || this._data.date, [Validators.required]),\n        });\n    }\n\n    /**\n     * User confirmation of the content of the modal\n     */\n    public save() {\n        this.form.markAllAsTouched();\n        /* istanbul ignore else */\n        if (this.form.valid) {\n            this.loading = 'Adding recurrence data to booking...';\n            this.event.emit({ reason: 'done', metadata: { ...this._data.details, ...this.form.value } });\n        }\n    }\n}\n","<header>\n    <div class=\"heading\" mat-dialog-title>Booking Recurrence</div>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main *ngIf=\"!loading; else load_state\">\n        <form *ngIf=\"form\" [formGroup]=\"form\">\n            <div class=\"field\" *ngIf=\"form.controls.period && periods.length > 1\">\n                <label for=\"period\">Period: </label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select name=\"period\" formControlName=\"period\" placeholder=\"None\">\n                        <mat-option *ngFor=\"let type of periods\" [value]=\"type.id\">\n                            {{ type.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class=\"field\" *ngIf=\"form.controls.end\">\n                <label\n                    for=\"end\"\n                    [class.error]=\"form.controls.end.errors && form.controls.end.touched\"\n                >\n                    End Date<span>*</span>:\n                </label>\n                <a-date-field name=\"end\" formControlName=\"end\"></a-date-field>\n                <div\n                    class=\"error-message\"\n                    *ngIf=\"form.controls.end.errors && form.controls.end.touched\"\n                >\n                    End date needs to be in the future\n                </div>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions *ngIf=\"!loading\">\n    <footer>\n        <button mat-button (tapped)=\"save()\">Add to Booking</button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <div class=\"body\">\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </div>\n</ng-template>\n","import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialog } from '@angular/material/dialog';\n\nimport { Space, RecurrenceAvailability } from 'src/app/services/data/spaces/space.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { SpaceSelectModalComponent, SpaceSelectModalData } from 'src/app/overlays/space-select-modal/space-select-modal.component';\nimport { User } from 'src/app/services/data/users/user.class';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { unique } from 'src/app/shared/utilities/general.utilities';\nimport { BookingRecurrenceSpaceDetails } from 'src/app/services/data/bookings/booking.interfaces';\nimport { DialogEvent } from 'src/app/shared/utilities/types.utilities';\n\nimport * as dayjs from 'dayjs';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\n\nexport interface RecurrenceSpacesModalData {\n    /** Space that has recurrence unavailability */\n    space: Space;\n    /** Duration of the booking */\n    duration: number;\n    /** Duration of the booking */\n    host: User;\n    /** List of current conflict matchups */\n    conflicts: BookingRecurrenceSpaceDetails[];\n}\n\nexport interface OccurrenceDetails extends RecurrenceAvailability {\n    /** Display string for the occurence datetime */\n    date_string: string;\n    /** Name of the space that replaces the space on this occurrence */\n    replaced_by: string;\n}\n\n@Component({\n    selector: 'a-recurrence-spaces-modal',\n    templateUrl: './recurrence-spaces-modal.component.html',\n    styleUrls: ['./recurrence-spaces-modal.component.scss']\n})\nexport class RecurrenceSpacesModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for modal events */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** List of occurence details for space booking */\n    public occurrences: OccurrenceDetails[] = [];\n    /** List of space details for occurrences */\n    public space_details: BookingRecurrenceSpaceDetails[] = []\n\n    /** Space to setup recurrence for */\n    public get space(): Space {\n        return this._data.space;\n    }\n\n    /** Whether all occurences have a valid space */\n    public get occurrences_valid(): boolean {\n        return this.occurrences.reduce((valid, event) => valid && (event.available || !!event.replaced_by), true);\n    }\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: RecurrenceSpacesModalData,\n        private _dialog: MatDialog,\n        private _spaces: SpacesService\n    ) {\n        super();\n    }\n\n    ngOnInit(): void {\n        this.space_details = [].concat(this._data.conflicts || []);\n        this.updateOccurrences();\n    }\n\n    public save() {\n        this.event.emit({ reason: 'done', metadata: this.space_details });\n    }\n\n    public selectSpace(occurrence: OccurrenceDetails) {\n        const ref = this._dialog.open<SpaceSelectModalComponent, SpaceSelectModalData>(\n            SpaceSelectModalComponent,\n            {\n                width: 'auto',\n                height: 'auto',\n                maxWidth: '95vw',\n                data: {\n                    spaces: [],\n                    zone_ids: this.space.level.building_id,\n                    date: occurrence.date * 1000,\n                    duration: this._data.duration,\n                    host: this._data.host,\n                    multiple: false\n                }\n            }\n        );\n        this.subscription(\n            'new_spaces',\n            ref.componentInstance.event.subscribe(event => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    const space = event.metadata[0];\n                    /* istanbul ignore else */\n                    if (space) {\n                        this.space_details.unshift({\n                            date: occurrence.date,\n                            space: space.email,\n                            replaces: this.space.email\n                        });\n                        this.space_details = unique(this.space_details, 'date');\n                    }\n                    this.updateOccurrences();\n                    ref.close();\n                    this.unsub('new_spaces');\n                }\n            })\n        );\n    }\n\n    private updateOccurrences() {\n        this.occurrences = this._data.space.recurr_available.map(event => {\n            const space_details = this.space_details.find(details => details.date === event.date && details.replaces === this.space.email);\n            const email = (space_details || {}).space;\n            const space = this._spaces.find(email) || { email, name: email };\n            return {\n                ...event,\n                date_string: dayjs(event.date * 1000).format('dddd, DD MMMM YYYY'),\n                replaced_by: space.name\n            }\n        });\n    }\n}\n","<header>\n    <div class=\"heading\" i18n=\"Space recurrence header\">Recurrence - {{ space.name }}</div>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main>\n        <div class=\"info\" i18n=\"Space recurrence information\">\n            * Select individual dates to update selected space\n        </div>\n        <div class=\"item\" *ngFor=\"let item of occurrences\">\n            <div class=\"date\">{{ item.date_string }}</div>\n            <div class=\"action\">\n                <button\n                    mat-button\n                    [class.inverse]=\"!item.available && !item.replaced_by\"\n                    (tapped)=\"selectSpace(item)\"\n                >\n                    <div class=\"content\">\n                        {{ item.replaced_by || (item.available ? space.name : 'Find Room') }}\n                    </div>\n                </button>\n            </div>\n        </div>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button\n            mat-button\n            [disabled]=\"!occurrences_valid\"\n            (tapped)=\"save()\"\n            i18n=\"Space recurrence save action\"\n        >\n            Add to Booking\n        </button>\n    </footer>\n</mat-dialog-actions>\n","import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { FormGroup, Validators, AbstractControl, FormControl } from '@angular/forms';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { HashMap, DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { BookingNote } from 'src/app/services/data/bookings/booking.interfaces';\nimport { ApplicationService } from 'src/app/services/app.service';\n\nimport * as dayjs from 'dayjs';\nimport { UsersService } from 'src/app/services/data/users/users.service';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\n\nexport interface RequirementDetailsModalData {\n    spaces: Space[];\n    notes_field: AbstractControl;\n    codes_field: AbstractControl;\n    head_counts_field: AbstractControl;\n    standalone?: boolean\n}\n\n@Component({\n    selector: 'a-requirement-details-modal',\n    templateUrl: './requirement-details-modal.component.html',\n    styleUrls: ['./requirement-details-modal.component.scss']\n})\nexport class RequirementDetailsModalComponent implements OnInit {\n    /** Emitter for modal events */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Mapping of spaces to notes */\n    public notes: HashMap<string> = {};\n    /** Mapping of spaces to cost codes */\n    public codes: HashMap<string> = {};\n    /** Mapping of spaces to estimated head count */\n    public head_counts: HashMap<string> = {};\n    /** Mapping of spaces to form fields */\n    public form: HashMap<FormGroup> = {};\n    /** Map of spaces to whether they need a charge code */\n    public needs_charge_code: HashMap<boolean> = {};\n    /** Index of the active space */\n    public active_space: number = 0;\n\n    /** List of selected spaces */\n    public get space_list(): Space[] {\n        return this._data.spaces;\n    }\n\n    public get active_form(): FormGroup {\n        return this.form[this.space_list[this.active_space].id];\n    }\n\n    /** Whether form fields are valid */\n    public get is_valid(): boolean {\n        return this.space_list.reduce((valid, space) => valid && this.form[space.id].valid, true);\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _users: UsersService,\n        @Inject(MAT_DIALOG_DATA) private _data: RequirementDetailsModalData\n    ) {}\n\n    public ngOnInit(): void {\n        const note_list = this._data.notes_field.value\n            .filter((note: BookingNote) => note.type === 'equipment')\n        this.notes = note_list.reduce((map, note) => {\n            map[note.space] = note.message;\n            return map;\n        }, {});\n        this.codes = { ...this._data.codes_field.value };\n        this.head_counts = { ...this._data.head_counts_field.value };\n        this.generateFormFields();\n    }\n\n    public submit(): void {\n        this.space_list.forEach(space => this.form[space.id].markAllAsTouched());\n        /* istanbul ignore else */\n        if (this.is_valid) {\n            // Update notes\n            const notes = this._data.notes_field.value\n                .filter((note: BookingNote) => note.type !== 'equipment');\n            const new_notes = this.space_list.map(space => ({\n                author: this._users.current.name,\n                type: 'equipment',\n                message: this.form[space.id].controls.notes.value,\n                space: space.id,\n                date: dayjs().valueOf()\n            } as BookingNote));\n            this._data.notes_field.setValue(notes.concat(new_notes).filter(note => note.message));\n            this._data.codes_field.setValue(this.space_list.reduce((map, space) => {\n                map[space.id] = this.form[space.id].controls.code.value;\n                return map;\n            }, {}));\n            this._data.head_counts_field.setValue(this.space_list.reduce((map, space) => {\n                map[space.id] = this.form[space.id].controls.head_count.value;\n                return map;\n            }, {}));\n            this.event.emit({ reason: 'done' });\n        }\n    }\n\n    /** Generate form fields for each space */\n    private generateFormFields(): void {\n        for (const space of this.space_list) {\n            const building = this._org.buildings.find(\n                bld => bld.id === space.level.building_id\n            );\n            this.needs_charge_code[space.id] = building ? building.required.equipment_code : false;\n            this.form[space.id] = new FormGroup({\n                notes: new FormControl(this.notes[space.id] || ''),\n                code: new FormControl(\n                    this.codes[space.id] || '',\n                    this.needs_charge_code[space.id] ? [Validators.required] : []\n                ),\n                head_count: new FormControl(this.head_counts[space.id] || '', [Validators.required])\n            });\n        }\n    }\n}\n","<div class=\"header\">\n    <div class=\"tabs\">\n        <mat-tab-group [(selectedIndex)]=\"active_space\">\n            <mat-tab\n                *ngFor=\"let space of space_list\"\n                [label]=\"space.name + (form[space.id].invalid && form[space.id].touched ? '*' : '')\"\n            ></mat-tab>\n        </mat-tab-group>\n    </div>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</div>\n<mat-dialog-content>\n    <main>\n        <div class=\"details\">\n            <img src=\"assets/img/equipment.svg\" />\n            <div class=\"text\" i18n=\"Booking equipment information\">\n                Would you like to add equipment to your booking's spaces?\n            </div>\n        </div>\n        <form *ngIf=\"space_list[active_space] && active_form\" [formGroup]=\"active_form\">\n            <div class=\"field\">\n                <label for=\"equipment-notes\" i18n=\"Booking equipment notes label\">\n                    (eg - particular room configurations or specific equipment etc) Additional\n                    requests are handled in confidence\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"equipment-notes\"\n                        formControlName=\"notes\"\n                        placeholder=\"Add notes here...\"\n                        i18n-placeholder\n                    ></textarea>\n                </mat-form-field>\n            </div>\n            <div class=\"fieldset\">\n                <div class=\"field\">\n                    <label\n                        for=\"charge-code\"\n                        [class.error]=\"\n                            active_form.controls.code.touched && active_form.controls.code.invalid\n                        \"\n                        i18n=\"Booking equipment charge code label\"\n                    >\n                        Charge Code<span *ngIf=\"needs_charge_code[space_list[active_space].id]\"\n                            >*</span\n                        >\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"charge-code\"\n                            formControlName=\"code\"\n                            placeholder=\"Charge Code\"\n                            i18n-placeholder\n                        />\n                        <mat-hint i18n=\"Booking equipment charge code hint\">\n                            <span>Note:</span> Your booking will be confirmed before you are\n                            charged.\n                        </mat-hint>\n                        <mat-error i18n=\"Booking equipment charge code error\">\n                            Charge Code is required\n                        </mat-error>\n                    </mat-form-field>\n                </div>\n                <div class=\"field\">\n                    <label\n                        for=\"head-count\"\n                        [class.error]=\"\n                            active_form.controls.head_count.touched &&\n                            active_form.controls.head_count.invalid\n                        \"\n                        i18n=\"Booking equipment headcount label\"\n                    >\n                        Headcount Estimate<span>*</span>\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"head-count\"\n                            formControlName=\"head_count\"\n                            type=\"number\"\n                            placeholder=\"e.g. 12\"\n                            i18n-placeholder\n                        />\n                        <mat-hint i18n=\"Booking equipment headcount hint\">\n                            <span>Note:</span> This estimate is used to calculate catering and/or\n                            assign rooms. Please keep updated of any changes.\n                        </mat-hint>\n                        <mat-error i18n=\"Booking equipment headcount error\">\n                            Headcount Estimate is required\n                        </mat-error>\n                    </mat-form-field>\n                </div>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button (tapped)=\"submit()\">Add to booking</button>\n    </footer>\n</mat-dialog-actions>\n","import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { Observable, Subject, of } from 'rxjs';\nimport { debounceTime, distinctUntilChanged, switchMap, catchError, map } from 'rxjs/operators';\n\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { User } from 'src/app/services/data/users/user.class';\nimport { Space, SpaceBookingRuleOptions } from 'src/app/services/data/spaces/space.class';\nimport { Building } from 'src/app/services/data/organisation/building.class';\nimport { Identity, HashMap, DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { unique } from 'src/app/shared/utilities/general.utilities';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\n\nexport interface SpaceSelectModalData {\n    /** List of selected spaces */\n    spaces: Space[];\n    /** Start time for availability of spaces */\n    date: number;\n    /** Duration of the availability block to look for */\n    duration: number;\n    /** Host of the booking being made */\n    host: User;\n    /** Whether multiple spaces can be selected */\n    multiple: boolean;\n    /** Force zone ids */\n    zone_ids?: string;\n}\n\n@Component({\n    selector: 'a-space-select-modal',\n    templateUrl: './space-select-modal.component.html',\n    styleUrls: ['./space-select-modal.component.scss']\n})\nexport class SpaceSelectModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Whether space list is being loaded */\n    public loading: boolean;\n    /** List of available spaces to select from */\n    public spaces: Space[] = [];\n    /** Active building to filter spaces on */\n    public active_building: Building;\n    /** Active building to filter spaces on */\n    public active_type: Identity;\n    /** List of items from an API search */\n    public search_results$: Observable<Space[]>;\n    /** Subject holding the value of the search */\n    public readonly search$ = new Subject<string>();\n    /** List of currently selected spaces */\n    public selected_spaces: Space[] = [];\n    /** Mapping as to whether a space is by request */\n    public request_map: HashMap<boolean> = {};\n    /** Whether selected list should be shown on mobile */\n    public show_list: boolean;\n\n    /** List of available buildings */\n    public types: Identity[] = []\n\n    /** List of available buildings */\n    public get buildings(): Building[] {\n        return this._org.buildings;\n    }\n\n    /** Whether multiple spaces can be selected */\n    public get multiple(): boolean {\n        return !!this._data.multiple;\n    }\n\n    public get has_zone(): boolean {\n        return !!this._data.zone_ids;\n    }\n\n    constructor(\n        private _spaces: SpacesService,\n        private _org: OrganisationService,\n        @Inject(MAT_DIALOG_DATA) private _data: SpaceSelectModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.selected_spaces = [].concat(this._data.spaces || []);\n        // Listen for input changes\n        this.search_results$ = this.search$.pipe(\n            debounceTime(400),\n            distinctUntilChanged(),\n            switchMap(_ => {\n                this.loading = true;\n                const zone_ids: string[] = [];\n                /* istanbul ignore else */\n                if (this.active_building) {\n                    zone_ids.push(this.active_building.id);\n                }\n                /* istanbul ignore else */\n                if (this.active_type) {\n                    zone_ids.push(`${this.active_type.id}`);\n                }\n                return this._spaces.available({\n                    zone_ids: this._data.zone_ids || zone_ids.join(','),\n                    date: this._data.date,\n                    duration: this._data.duration\n                });\n            }),\n            catchError(_ => of([])),\n            map((list: Space[]) => {\n                this.loading = false;\n                const selected = this.selected_spaces;\n                return list.filter((item: any) => !selected.find(space => space.id === item.id));\n            })\n        );\n        // Process API results\n        this.subscription(\n            'search_results',\n            this.search_results$.subscribe(list => {\n                this.spaces = list;\n                this.update();\n            })\n        );\n        this.active_building = this._org.building;\n        this.types = [{ id: '', name: 'Any Space Type' } as any].concat(\n            this._org.space_types || []\n        );\n        this.active_type = this.types[0];\n        this.search$.next('');\n    }\n\n    /** Add space to selected list */\n    public addSpace(space: Space) {\n        this.selected_spaces.push(space);\n        this.selected_spaces = unique(this.selected_spaces, 'id');\n    }\n\n    /** Remove space from selected list */\n    public removeSpace(space: Space) {\n        this.selected_spaces = this.selected_spaces.filter(a_space => a_space.id !== space.id);\n    }\n\n    /** Emit current state of the selected list */\n    public save(list: Space[]) {\n        this.event.emit({ reason: 'done', metadata: list });\n    }\n\n    private update() {\n        const map = {};\n        const options: SpaceBookingRuleOptions = {\n            date: this._data.date,\n            duration: this._data.duration,\n            host: this._data.host\n        };\n        this.selected_spaces.forEach(space => (map[space.id] = space.byRequest(options)));\n        this.spaces.forEach(space => (map[space.id] = space.byRequest(options)));\n        this.request_map = map;\n    }\n}\n","<header>\n    <div class=\"heading\">Select meeting space{{ multiple ? 's' : '' }}</div>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main>\n        <div class=\"block available\">\n            <ng-container *ngIf=\"!has_zone\">\n                <mat-form-field appearance=\"outline\" *ngIf=\"buildings && buildings.length > 1\">\n                    <mat-select\n                        #select\n                        [(value)]=\"active_building\"\n                        (valueChange)=\"search$.next(active_building.id + '|' + active_type.id)\"\n                    >\n                        <mat-option *ngFor=\"let building of buildings\" [value]=\"building\">\n                            {{ building.code }} - {{ building.name\n                            }}{{ building.address ? ', ' + building.address : '' }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <mat-form-field appearance=\"outline\" *ngIf=\"types && types.length > 1\">\n                    <mat-select\n                        #select\n                        [(value)]=\"active_type\"\n                        (valueChange)=\"search$.next(active_building.id + '|' + active_type.id)\"\n                    >\n                        <mat-option *ngFor=\"let type of types\" [value]=\"type\">\n                            {{ type?.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </ng-container>\n            <div class=\"list\">\n                <ng-container *ngIf=\"!loading; else load_state\">\n                    <ng-container *ngIf=\"spaces && spaces.length; else empty_state\">\n                        <div class=\"item\" *ngFor=\"let space of spaces\">\n                            <div class=\"details\">\n                                <div class=\"name\">{{ space.name }}</div>\n                                <div class=\"info\">{{ space.level.name }}</div>\n                            </div>\n                            <div class=\"capacity\">\n                                <app-icon\n                                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'account_circle' }\"\n                                ></app-icon>\n                                <div class=\"text\">{{ space.capacity || '0' }}</div>\n                            </div>\n                            <div class=\"actions\">\n                                <button\n                                    [class.request]=\"request_map[space.id]\"\n                                    mat-button\n                                    (tapped)=\"multiple ? addSpace(space) : save([space])\"\n                                >\n                                    Select\n                                </button>\n                            </div>\n                        </div>\n                    </ng-container>\n                </ng-container>\n            </div>\n        </div>\n        <div class=\"block selected\" *ngIf=\"multiple\" [class.show]=\"show_list\">\n            <h3>Selected spaces</h3>\n            <div class=\"list\">\n                <ng-container\n                    *ngIf=\"selected_spaces && selected_spaces.length; else empty_select_state\"\n                >\n                    <div class=\"item\" *ngFor=\"let space of selected_spaces\">\n                        <div\n                            class=\"icon\"\n                            [class.request]=\"request_map[space.id]\"\n                            [matTooltip]=\"\n                                request_map[space.id]\n                                    ? 'Bookings in this space need to be approved by a member of the concierge team'\n                                    : ''\n                            \"\n                        >\n                            <app-icon\n                                [icon]=\"{\n                                    class: 'material-icons',\n                                    content: request_map[space.id] ? 'warning' : 'done'\n                                }\"\n                            ></app-icon>\n                        </div>\n                        <div class=\"details\">\n                            <div class=\"name\">{{ space.name }}</div>\n                            <div class=\"info\">{{ space.level.name }}</div>\n                        </div>\n                        <div class=\"capacity\">\n                            <app-icon\n                                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'account_circle' }\"\n                            ></app-icon>\n                            <div class=\"text\">{{ space.capacity || '0' }}</div>\n                        </div>\n                        <div class=\"actions\">\n                            <button mat-icon-button (tapped)=\"removeSpace(space)\">\n                                <app-icon\n                                    [icon]=\"{ class: 'material-icons', content: 'close' }\"\n                                ></app-icon>\n                            </button>\n                        </div>\n                    </div>\n                </ng-container>\n            </div>\n            <footer>\n                <button mat-button (tapped)=\"save(this.selected_spaces)\">Add to booking</button>\n            </footer>\n            <button mat-icon-button [class.close]=\"true\" [class.mobile-only]=\"true\" (tapped)=\"show_list = false\">\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n            </button>\n            <div class=\"tag mobile-only\">\n                <button mat-icon-button (tapped)=\"show_list = true\">\n                    <app-icon [icon]=\"{ class: 'material-icons', content: 'list' }\"></app-icon>\n                </button>\n            </div>\n        </div>\n    </main>\n</mat-dialog-content>\n<ng-template #load_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <mat-spinner diameter=\"48\"></mat-spinner>\n        </div>\n        <div class=\"text\">Loading available spaces...</div>\n    </div>\n</ng-template>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No available spaces</div>\n    </div>\n</ng-template>\n<ng-template #empty_select_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No selected spaces</div>\n    </div>\n</ng-template>\n","import { Injectable, ApplicationRef, NgZone } from '@angular/core';\nimport { Title } from '@angular/platform-browser';\nimport { SwUpdate } from '@angular/service-worker';\nimport { first } from 'rxjs/operators';\n\nimport { MatSnackBar } from '@angular/material/snack-bar';\n\nimport { ComposerService } from '@placeos/composer';\nimport { PlaceOSOptions } from '@placeos/ts-client';\nimport { HeapIoService } from '@acaprojects/ngx-heap-io';\n\nimport { Observable, BehaviorSubject, Subject } from 'rxjs';\n\nimport { BaseClass } from '../shared/base.class';\nimport { ConsoleStream, SettingsService } from './settings.service';\nimport { ApplicationLoadingState } from '../shared/utilities/types.utilities';\n\nimport { HotkeysService } from './hotkeys.service';\nimport { ComposerSettings, ApplicationIcon } from '../shared/utilities/settings.interfaces';\nimport { ServiceManager } from './data/service-manager.class';\n\ndeclare global {\n    interface Window {\n        application: ApplicationService;\n        mock: {\n            enabled: boolean;\n            backend: any;\n        };\n    }\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class ApplicationService extends BaseClass {\n    /** List of previous routes for return navigation */\n    private _route_trail: string[] = [];\n    /** Map of state variables for Service */\n    protected _subjects: {\n        [key: string]: BehaviorSubject<any> | Subject<any>;\n    } = {};\n    /** Map of observables for state variables */\n    protected _observers: { [key: string]: Observable<any> } = {};\n    /** Whether the application has stablised */\n    private _stable: boolean;\n\n    /** Whether the application has stablised */\n    public get is_stable(): boolean {\n        return this._stable || false;\n    }\n\n    constructor(\n        private _app_ref: ApplicationRef,\n        private _zone: NgZone,\n        private _title: Title,\n        private _cache: SwUpdate,\n        private _settings: SettingsService,\n        private _hotkeys: HotkeysService,\n        private _composer: ComposerService,\n        private _analytics: HeapIoService,\n        private _snackbar: MatSnackBar\n    ) {\n        super();\n        ServiceManager.setService(ApplicationService, this);\n        this.set('system', null);\n        this.set('title', 'Home');\n        this.set('loading', {});\n        this.set('APP.breakdown', false);\n        this.set('CONCIERGE.legend', {});\n        this.set('CONCIERGE.pending_bookings', {});\n        this.set('CONCIERGE.day_view.viewing', null);\n        this._app_ref.isStable.pipe(first((_) => _)).subscribe(() => {\n            this._zone.run(() => {\n                this._stable = true;\n                this.log('APP', `Application has stablised.`);\n                this.setupCache();\n                this.waitForSettings();\n            });\n        });\n    }\n\n    public get Bindings() {\n        return this._composer.bindings;\n    }\n    /** Analytics service */\n    public get Analytics() {\n        return {};\n    }\n    /** Analytics service */\n    public get Hotkeys() {\n        return this._hotkeys;\n    }\n\n    /**\n     * Get a setting from the settings service\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n     */\n    public setting(key: string): any {\n        return this._settings.get(key);\n    }\n\n    /**\n     * Title of the page\n     */\n    public set title(value: string) {\n        const title_suffix = this.setting('app.title');\n        this.set('title', value);\n        this._title.setTitle(`${value ? value + ' | ' : ''}${title_suffix}`);\n    }\n\n    /**\n     * Title of the page\n     */\n    public get title(): string {\n        return this._title.getTitle();\n    }\n\n    /** Root API Endpoint */\n    public get endpoint() {\n        return `/api/staff/`;\n    }\n\n    /** Root API Endpoint for engine */\n    public get engine_endpoint() {\n        return this._composer.auth.api_endpoint + '/';\n    }\n\n    /** Whether settings has been loaded */\n    public get has_settings(): boolean {\n        return this._settings.is_initialised;\n    }\n\n    /**\n     * Create notification popup\n     * @param type CSS Class to add to the notification\n     * @param message Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     * @param icon Icon to render to the left of the notification message\n     */\n    public notify(\n        type: string,\n        message: string,\n        action: string = 'OK',\n        on_action?: () => void,\n        icon: ApplicationIcon = {\n            type: 'icon',\n            class: 'material-icons',\n            content: 'info',\n        }\n    ): void {\n        const snackbar_ref = this._snackbar.open(message, action, {\n            panelClass: [type],\n            duration: 5000,\n        });\n        this.subscription(\n            'snackbar_close',\n            snackbar_ref.afterDismissed().subscribe(() => {\n                this.unsub('snackbar_close');\n                this.unsub('notify');\n            })\n        );\n        if (action) {\n            on_action = on_action || (() => snackbar_ref.dismiss());\n            this.subscription(\n                'notify',\n                snackbar_ref.onAction().subscribe(() => on_action())\n            );\n        }\n    }\n\n    /**\n     * Create success notification popup\n     * @param msg Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     */\n    public notifySuccess(msg: string, action?: string, on_action?: () => void): void {\n        const icon: ApplicationIcon = {\n            type: 'icon',\n            class: 'material-icons',\n            content: 'done',\n        };\n        console.debug(msg);\n        this.notify('success', msg, action, on_action, icon);\n    }\n\n    /**\n     * Create error notification popup\n     * @param msg Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     */\n    public notifyError(msg: string, action?: string, on_action?: () => void): void {\n        const icon: ApplicationIcon = {\n            type: 'icon',\n            class: 'material-icons',\n            content: 'error',\n        };\n        console.error(msg);\n        this.notify('error', msg, action, on_action, icon);\n    }\n\n    /**\n     * Create warning notification popup\n     * @param msg Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     */\n    public notifyWarn(msg: string, action?: string, on_action?: () => void): void {\n        const icon: ApplicationIcon = {\n            type: 'icon',\n            class: 'material-icons',\n            content: 'warning',\n        };\n        console.warn(msg);\n        this.notify('warn', msg, action, on_action, icon);\n    }\n\n    /**\n     * Create info notification popup\n     * @param msg Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     */\n    public notifyInfo(msg: string, action?: string, on_action?: () => void): void {\n        console.info(msg);\n        this.notify('info', msg, action, on_action);\n    }\n\n    /**\n     * Log data to the browser console\n     * @param type Type of message\n     * @param msg Message body\n     * @param args array of argments to log to the console\n     * @param stream Stream to emit the console on. 'debug', 'log', 'warn' or 'error'\n     * @param force Whether to force message to be emitted when debug is disabled\n     */\n    public log(\n        type: string,\n        msg: string,\n        args?: any,\n        stream: ConsoleStream = 'debug',\n        force: boolean = false\n    ): void {\n        this._settings.log(type, msg, args, stream, force);\n    }\n\n    /**\n     * Get the current value of the named property\n     * @param name Property name\n     */\n    public get<U = any>(name: string): U {\n        return this._subjects[name] && this._subjects[name] instanceof BehaviorSubject\n            ? (this._subjects[name] as BehaviorSubject<U>).getValue()\n            : null;\n    }\n\n    /**\n     * Listen to value change of the named property\n     * @param name Property name\n     * @param next Callback for value changes\n     */\n    public listen<U = any>(name: string): Observable<U> {\n        return this._observers[name] ? this._observers[name] : null;\n    }\n\n    /**\n     * Update the value of the named property\n     * @param name Property name\n     * @param value New value\n     */\n    public set<U = any>(name: string, value: U): void {\n        if (!this._subjects[name]) {\n            this._subjects[name] = new BehaviorSubject<U>(value);\n            this._observers[name] = this._subjects[name].asObservable();\n        } else {\n            this._subjects[name].next(value);\n        }\n    }\n\n    /** Wait for settings to be initialised before setting up the application */\n    private waitForSettings() {\n        // Wait until the settings have loaded before initialising\n        this._settings.initialised.pipe(first((_) => _)).subscribe(() => this.init());\n    }\n\n    /**\n     * Initialise application services\n     */\n    private init(): void {\n        this.setupComposer();\n        // this.setupAnalytics();\n        this._composer.initialised\n            .pipe(first((_) => _))\n            .subscribe(() => this._initialised.next(true));\n        // Add service to window if in debug mode\n        if (window.debug) {\n            window.application = this;\n        }\n    }\n\n    /**\n     * Initialise the composer library comms\n     */\n    private setupComposer(): void {\n        this.log('SYSTEM', 'Setup up composer...');\n        const loading: ApplicationLoadingState = this.get('loading') || {};\n        loading.composer = {\n            message: 'Initialising service connection',\n            state: 'loading',\n        };\n        this.set('loading', loading);\n        // Get application settings\n        const settings: ComposerSettings = this._settings.get('composer') || {};\n        const protocol = settings.protocol || location.protocol;\n        const host = settings.domain || location.hostname;\n        const port = settings.port || location.port;\n        const url = settings.use_domain ? `${protocol}//${host}:${port}` : location.origin;\n        const route = settings.route || '';\n        const mock = this._settings.get('mock');\n        // Generate configuration object\n        const config: PlaceOSOptions = {\n            scope: 'public',\n            host: `${host}:${port}`,\n            auth_uri: `${url}/auth/oauth/authorize`,\n            token_uri: `${url}/auth/token`,\n            redirect_uri: `${location.origin}${route}/oauth-resp.html`,\n            handle_login: !settings.local_login,\n            mock,\n        };\n        this._composer.setup(config);\n        loading.composer = {\n            message: 'Initialising service connection',\n            state: 'complete',\n        };\n        this.set('loading', loading);\n    }\n\n    /**\n     * Setup handler for cache change events\n     */\n    private setupCache() {\n        if (this._cache.isEnabled) {\n            this.subscription(\n                'cache_update',\n                this._cache.available.subscribe((event) => {\n                    const current = `current version is ${event.current.hash}`;\n                    const available = `available version is ${event.available.hash}`;\n                    this.log('CACHE', `Update available: ${current} ${available}`);\n                    this.activateUpdate();\n                })\n            );\n            this.subscription(\n                'cache_activated',\n                this._cache.activated.subscribe(() => {\n                    this.log('CACHE', `Updates activated. Reloading...`);\n                    this.notifyInfo(\n                        'Newer version of the application is available',\n                        'Refresh',\n                        () => location.reload(true)\n                    );\n                })\n            );\n            setInterval(() => {\n                this.log('CACHE', `Checking for updates...`);\n                this._cache.checkForUpdate();\n            }, 5 * 60 * 1000);\n        }\n    }\n\n    /**\n     * Update the cache and reload the page\n     *\n     */\n    private activateUpdate() {\n        if (this._cache.isEnabled) {\n            this.log('CACHE', `Activating changes to the cache...`);\n            this._cache.activateUpdate().then(() => {\n                this.notifyInfo('Newer version of the application is available', 'Refresh', () =>\n                    location.reload(true)\n                );\n            });\n        }\n    }\n}\n","import { Subject, Observable } from 'rxjs';\n\nimport { BaseClass } from '../../shared/base.class';\nimport { HashMap } from '../../shared/utilities/types.utilities';\nimport { ServiceManager, ServiceLike } from './service-manager.class';\n\nexport type ApiEventType = 'value_change' | 'item_saved' | 'reset' | 'other';\n\nexport interface ApiEvent<T = HashMap> {\n    type: ApiEventType;\n    metadata: T;\n}\n\nexport class BaseDataClass extends BaseClass {\n    /** Subject for emitting events on the object */\n    protected readonly event_subject = new Subject<ApiEvent>();\n    /** Observable for events on this object */\n    public readonly events = this.event_subject.asObservable();\n    /** Unique Identifier of the object */\n    public readonly id: string;\n    /** Human readable name of the object */\n    public readonly name: string;\n    /** Email address associated with the object */\n    public readonly email: string;\n    /** Map of local property names to server ones */\n    protected _server_names: HashMap<string> = {};\n    /** Service for managing model on the server */\n    protected get _service(): ServiceLike {\n        return ServiceManager.serviceFor(BaseDataClass);\n    }\n\n    constructor(raw_data: HashMap) {\n        super();\n        this.id = raw_data.id || raw_data.zone_id || raw_data.email || '';\n        this.name = raw_data.name || '';\n        this.email = `${raw_data.email || ''}`.toLowerCase();\n    }\n\n    /**\n     * Save pending changes to server\n     */\n    public save(): Promise<BaseDataClass> {\n        if (this._service) {\n            const form = this.toJSON();\n            return new Promise((resolve, reject) => {\n                const promise = this.id\n                    ? this._service.update(this.id, form)\n                    : this._service.add(form);\n                promise.then(\n                    (d) => {\n                        this.event_subject.next({ type: 'item_saved',  metadata: d });\n                        resolve(d);\n                    },\n                    (_) => reject(_)\n                );\n            });\n        } else {\n            Promise.reject('No service to process request');\n        }\n    }\n\n    /**\n     * Delete this item from the server\n     */\n    public delete(): Promise<void> {\n        if (this.id) {\n            return this._service.delete(this.id);\n        }\n    }\n\n    /**\n     * Run task for this item on the service\n     * @param task_name Name of the task\n     * @param parameters Parameters to pass to the task request\n     */\n    public runTask(task_name: string, parameters: HashMap): Promise<void> {\n        if (this.id) {\n            return this._service.task(this.id, task_name, parameters);\n        }\n    }\n    /**\n     * Convert object into plain object\n     */\n    public toJSON(this: BaseDataClass): HashMap {\n        const obj: any = { ...this };\n        // Remove local private members\n        delete obj._service;\n        delete obj._changes;\n        delete obj.changeEvents;\n        // Remove parent private members\n        delete obj._timers;\n        delete obj._intervals;\n        delete obj._subscriptions;\n        delete obj._server_names;\n        delete obj._initialised;\n        // Convert remaining members to be public\n        const keys = Object.keys(obj);\n        for (const key of keys) {\n            if (key[0] === '_') {\n                const new_key = this._server_names[key.substr(1)] || key.substr(1);\n                obj[new_key] = obj[key];\n                delete obj[key];\n            } else if (obj[key] === undefined) {\n                delete obj[key];\n            }\n        }\n        return obj;\n    }\n\n    /**\n     * Make a copy of this object\n     */\n    public clone(): BaseDataClass {\n        return new BaseDataClass(this);\n    }\n\n    /**\n     * Make a copy of this object without identification data\n     */\n    public duplicate(): BaseDataClass {\n        return new BaseDataClass({ ...this, id: null, email: null });\n    }\n}\n","import { ComposerService } from '@placeos/composer';\nimport { BehaviorSubject, Observable, Subscription, Subscriber, Subject } from 'rxjs';\nimport { first } from 'rxjs/operators';\n\nimport { BaseDataClass } from './base-api.class';\nimport { BaseClass } from '../../shared/base.class';\nimport { ApplicationService } from '../app.service';\nimport { HashMap } from '../../shared/utilities/types.utilities';\nimport { toQueryString } from '../../shared/utilities/api.utilities';\nimport { ServiceManager } from './service-manager.class';\n\nexport interface IEngineResponse {\n    results: HashMap[];\n    total: number;\n}\n\nexport class BaseAPIService<T extends {} = BaseDataClass> extends BaseClass {\n    /** Application service */\n    public parent: ApplicationService;\n    /** Display name of the service */\n    protected _name: string;\n    /** API Route of the service */\n    protected _api_route: string;\n    /** Map of state variables for Service */\n    protected _subjects: { [key: string]: BehaviorSubject<any> | Subject<any> } = {};\n    /** Map of observables for state variables */\n    protected _observers: { [key: string]: Observable<any> } = {};\n    /** Map of poll subscribers for API endpoints */\n    protected _subscribers: { [key: string]: Subscriber<any> } = {};\n    /** Map of promises for Service */\n    protected _promises: { [key: string]: Promise<any> } = {};\n    /** Comparison function for service items */\n    protected _compare: (a: T, b: T) => boolean = (a, b) =>\n        a === b || (a as any).id === (b as any).id;\n    /** Default filter function for list method */\n    protected _list_filter: (a: T) => boolean = (a) => !!a;\n\n    /** Http Client */\n    protected get http() {\n        return this._composer.http;\n    }\n\n    constructor(protected _composer: ComposerService) {\n        super();\n        this._name = 'Base';\n        this._api_route = 'base';\n        this.set('list', []);\n    }\n\n    /**\n     * Initailise service\n     */\n    public init() {\n        this.load().then(\n            (_) => this._initialised.next(true),\n            (err) => {\n                this.timeout('init', () => this.init(), 1000);\n            }\n        );\n    }\n\n    /**\n     * Get API route for the service\n     * @param engine Whether endpoint is using the application API or engine API\n     */\n    public route(engine: boolean = false) {\n        const endpoint = engine\n                ? this._composer.auth.api_endpoint\n                : '/api/staff';\n        return `${endpoint}${this._api_route}`;\n    }\n    /** API Route of the service */\n    public get api_route() {\n        return this._api_route;\n    }\n\n    /**\n     * Get the current value of the named property\n     * @param name Property name\n     */\n    public get<U = any>(name: string): U {\n        if (!this._observers[name]) {\n            this.set<U>(name, null);\n        }\n        return (this._subjects[name] as BehaviorSubject<U>).getValue();\n    }\n\n    /**\n     * Listen to value change of the named property\n     * @param name Property name\n     * @param next Callback for value changes\n     */\n    public listen<U = any>(name: string): Observable<U> {\n        if (!this._observers[name]) {\n            this.set<U>(name, null);\n        }\n        return this._observers[name];\n    }\n\n    /**\n     * Update the value of the named property\n     * @param name Property name\n     * @param value New value\n     */\n    protected set<U = any>(name: string, value: U): void {\n        if (!this._subjects[name]) {\n            this._subjects[name] = new BehaviorSubject<U>(value);\n            this._observers[name] = this._subjects[name].asObservable();\n        } else {\n            this._subjects[name].next(value);\n        }\n    }\n\n    /**\n     * Get list of loaded items\n     * @param predicate Function for filtering the list\n     */\n    public filter(predicate: (a: T) => boolean = this._list_filter): T[] {\n        const list = this.get('list') || [];\n        return list.reduce((a, i) => {\n            if (predicate(i)) {\n                a.push(i);\n            }\n            return a;\n        }, []);\n    }\n\n    /**\n     * Get item with the given id from the loaded items\n     * @param id ID of the item\n     */\n    public find(id: string): T {\n        const list = this.get('list') || [];\n        return list.find(\n            (i) => i.id === id || (i.email || '').toLowerCase() === (id || '').toLowerCase()\n        );\n    }\n\n    /**\n     * Query the index of the API route associated with this service\n     * @param query_params Map of query paramaters to add to the request URL\n     */\n    public query(query_params: HashMap = { update_list: true }): Promise<T[]> {\n        let engine = false;\n        let cache = 1000;\n        /* istanbul ignore else */\n        if (query_params) {\n            engine = !!query_params.engine;\n            delete query_params.engine;\n            cache = query_params.cache || 1000;\n            delete query_params.cache;\n        }\n        const query = toQueryString(query_params);\n        const key = `query|${query}`;\n        if (!this._promises[key]) {\n            this._promises[key] = new Promise((resolve, reject) => {\n                const url = `${this.route(engine)}${query ? '?' + query : ''}`;\n                let result: T[] | HashMap[] = [];\n                this.http.get(url).subscribe(\n                    (d: IEngineResponse | HashMap[]) => {\n                        result =\n                            d && d instanceof Array\n                                ? d.map((i) => this.process(i))\n                                : d && !(d instanceof Array) && d.results\n                                ? (d.results as HashMap[])\n                                : [];\n                    },\n                    (e) => {\n                        reject(e);\n                        this._promises.new_item = null;\n                    },\n                    () => {\n                        if (\n                            (!query || (query_params && query_params.update_list)) &&\n                            result.length > 0 &&\n                            result[0] instanceof BaseDataClass\n                        ) {\n                            this.set('list', this.updateList(this.get('list'), result as T[]));\n                        }\n                        resolve(result);\n                        this.timeout(key, () => (this._promises[key] = null), cache);\n                    }\n                );\n            });\n        }\n        return this._promises[key];\n    }\n\n    /**\n     * Query the API route for a sepecific item\n     * @param id ID of the item\n     * @param query_params Map of query paramaters to add to the request URL\n     */\n    public show(id: string, query_params: HashMap = {}): Promise<T> {\n        let engine = false;\n        /* istanbul ignore else */\n        if (query_params) {\n            engine = !!query_params.engine;\n            delete query_params.engine;\n        }\n        const query = toQueryString(query_params);\n        const key = `show|${id}|${query}`;\n        /* istanbul ignore else */\n        if (!this._promises[key]) {\n            this._promises[key] = new Promise<T>((resolve, reject) => {\n                const url = `${this.route(engine)}/${id}${query ? '?' + query : ''}`;\n                let result: T = null;\n                this.http.get(url).subscribe(\n                    (d) => (result = this.process(d)),\n                    (e) => {\n                        reject(e);\n                        this._promises.new_item = null;\n                    },\n                    () => {\n                        resolve(result);\n                        this.timeout(key, () => (this._promises[key] = null), 1000);\n                    }\n                );\n            });\n        }\n        return this._promises[key];\n    }\n\n    /**\n     * Make post request for a new item to the service\n     * @param form_data Data to post to the server\n     * @param query_params Map of query paramaters to add to the request URL\n     */\n    public add(form_data: HashMap, query_params: HashMap = {}): Promise<T> {\n        /* istanbul ignore else */\n        if (!this._promises.new_item) {\n            this._promises.new_item = new Promise<T>((resolve, reject) => {\n                const query = toQueryString(query_params);\n                const url = `${this.route(query_params.engine)}${query ? '?' + query : ''}`;\n                let result: T = null;\n                this.http.post(url, form_data).subscribe(\n                    (d) => (result = this.process(d)),\n                    (e) => {\n                        reject(e);\n                        this.analyticsEvent(`create-${this._name.toLowerCase()}-failed`);\n                        this._promises.new_item = null;\n                    },\n                    () => {\n                        resolve(result);\n                        this.set('list', this.updateList(this.get('list'), [result]));\n                        this.analyticsEvent(`create-${this._name.toLowerCase()}-success`);\n                        this._promises.new_item = null;\n                    }\n                );\n            });\n        }\n        return this._promises.new_item;\n    }\n\n    /**\n     * Perform API task for the given item ID\n     * @param id ID of the item\n     * @param task_name Name of the task\n     * @param form_data Map of data to pass to the API\n     * @param method Verb to use for request\n     */\n    public task<U = any>(\n        id: string,\n        task_name: string,\n        form_data: HashMap = {},\n        method: 'post' | 'get' = 'post'\n    ): Promise<U> {\n        const query = toQueryString({ ...form_data, concierge: true });\n        const key = `task|${id}|${task_name}|${query}`;\n        /* istanbul ignore else */\n        if (!this._promises[key]) {\n            this._promises[key] = new Promise<U>((resolve, reject) => {\n                const post_data = { ...form_data, id, _task: task_name };\n                const url = `${this.api_route}/${id}/${task_name}`;\n                let result: any;\n                const request =\n                    method === 'post'\n                        ? this.http.post(url, post_data)\n                        : this.http.get(`${url}${query ? '?' + query : ''}`);\n                request.subscribe(\n                    (d) => (result = d),\n                    (e) => {\n                        reject(e);\n                        this.analyticsEvent(\n                            `${this._name.toLowerCase()}-task-${task_name}-failed`,\n                            id\n                        );\n                        delete this._promises[key];\n                    },\n                    () => {\n                        resolve(result as U);\n                        this.analyticsEvent(\n                            `${this._name.toLowerCase()}-task-${task_name}-success`,\n                            id\n                        );\n                        this.timeout(key, () => delete this._promises[key], 1000);\n                    }\n                );\n            });\n        }\n        return this._promises[key];\n    }\n\n    /**\n     * Setup a poller for an API endpoint\n     * @param id Show request ID. Leave blank to poll on the query endpoint\n     * @param query_params Map of query paramaters to add to the polled URL\n     * @param delay Delay between each poll event\n     */\n    public poll(\n        id?: string,\n        query_params: HashMap = {},\n        delay: number = 5000\n    ): Observable<T | T[]> {\n        const key = `poll|${id || ''}|${toQueryString(query_params) || ''}`;\n        this.stopPoll(id, query_params);\n        this._subjects[key] = new Subject<T | T[]>();\n        this._observers[key] = this._subjects[key].asObservable();\n        const sub = this._subjects[key];\n        const query = { ...(query_params || {}), _poll: true };\n        if (id) {\n            this.show(id, query).then(\n                (d) => sub.next(d),\n                (e) => sub.error(e)\n            );\n            this.interval(\n                key,\n                () => {\n                    this.show(id, query).then(\n                        (d) => sub.next(d),\n                        (e) => sub.error(e)\n                    );\n                },\n                delay\n            );\n        } else {\n            this.query(query).then(\n                (d) => sub.next(d),\n                (e) => sub.error(e)\n            );\n            this.interval(\n                key,\n                () => {\n                    this.query(query).then(\n                        (d) => sub.next(d),\n                        (e) => sub.error(e)\n                    );\n                },\n                delay\n            );\n        }\n        return this._observers[key];\n    }\n\n    /**\n     * Destroy poller\n     * @param id\n     * @param query_params\n     */\n    public stopPoll(id?: string, query_params: HashMap = {}) {\n        const key = `poll|${id || ''}|${toQueryString(query_params) || ''}`;\n        /* istanbul ignore else */\n        if (this._subjects[key]) {\n            this._subjects[key].complete();\n            this._subjects[key] = null;\n            this._observers[key] = null;\n        }\n    }\n\n    /**\n     * Make put request for changes to the item with the given id\n     * @param id ID of the item being updated\n     * @param form_data New values for the item\n     * @param query_params Map of query paramaters to add to the request URL\n     */\n    public update(id: string, form_data: HashMap, query_params: HashMap = {}): Promise<T> {\n        const key = `update|${id}`;\n        /* istanbul ignore else */\n        if (!this._promises[key]) {\n            this._promises[key] = new Promise<T>((resolve, reject) => {\n                const query = toQueryString({ ...query_params, concierge: true });\n                const url = `${this.route(query_params.engine)}/${id}${query ? '?' + query : ''}`;\n                let result: T = null;\n                this.http.put(url, form_data).subscribe(\n                    (d) => (result = this.process(d)),\n                    (e) => {\n                        reject(e);\n                        this.analyticsEvent(`update-${this._name.toLowerCase()}-failed`, id);\n                        this._promises[key] = null;\n                    },\n                    () => {\n                        resolve(result);\n                        this.set(\n                            'list',\n                            this.updateList(this.removeItem(this.get('list'), { id } as any), [\n                                result,\n                            ])\n                        );\n                        this.analyticsEvent(`update-${this._name.toLowerCase()}-success`, id);\n                        this._promises[key] = null;\n                    }\n                );\n            });\n        }\n        return this._promises[key];\n    }\n\n    /**\n     * Make delete request for the given item\n     * @param id ID of item\n     */\n    public delete(id: string): Promise<void> {\n        const key = `delete|${id}`;\n        /* istanbul ignore else */\n        if (!this._promises[key]) {\n            this._promises[key] = new Promise<void>((resolve, reject) => {\n                const url = `${this.route()}/${id}`;\n                this.http.delete(url).subscribe(\n                    (_) => null,\n                    (e) => reject(e),\n                    () => {\n                        this.set('list', this.removeItem(this.get('list'), { id } as any));\n                        resolve();\n                    }\n                );\n            });\n        }\n        return this._promises[key];\n    }\n\n    /**\n     * Add new API item from another service or API class\n     * @param id ID of the item/or service adding the new item\n     * @param data Raw API data for the new item\n     * @param type Adder type\n     */\n    public addFrom(\n        id: string,\n        data: HashMap,\n        type: 'class' | 'service' | 'other' = 'other'\n    ): string {\n        const new_item = this.process(data);\n        this.set('list', this.updateList(this.get('list'), [new_item]));\n        return (new_item as any).id;\n    }\n\n    /**\n     * Remove items with the given IDs from the list\n     * @param id ID of the item/or service remove the list of items\n     * @param remove_ids List of item IDs to remove\n     * @param type Remover type\n     */\n    public removeFrom(\n        id: string,\n        remove_ids: string[],\n        type: 'class' | 'service' | 'other' = 'other'\n    ) {}\n\n    /**\n     * Load initial data for the service\n     */\n    protected async load(): Promise<void> {}\n\n    /**\n     * Post analytics event for this service\n     * @param action Name of the action to post\n     */\n    protected analyticsEvent(action: string, label?: string) {\n        // this.parent.Analytics.track(this._name, { desc: `${this.parent.name.toLowerCase()}-${action}`, label });\n    }\n\n    /**\n     * Convert raw API data into a valid API Object\n     * @param raw_item Raw API data\n     */\n    protected process(raw_item: HashMap): T {\n        return raw_item as T;\n    }\n\n    /**\n     * Update recorded list of items\n     * @param old_list Old list of items\n     * @param list List of updated items\n     * @param compareFn Function to compare items to remove duplicates\n     */\n    public updateList(\n        old_list: T[],\n        list: T[],\n        compareFn: (a: T, b: T) => boolean = this._compare\n    ): T[] {\n        /* istanbul ignore else */\n        if (!list || list.length === 0) {\n            return old_list;\n        }\n        const new_list: T[] = [];\n        const mixed_list = [...list, ...old_list];\n        /* istanbul ignore else */\n        if (!compareFn) {\n            compareFn = this._compare;\n        }\n        for (const item of mixed_list) {\n            const found = new_list.find((i) => compareFn(i, item));\n            /* istanbul ignore else */\n            if (!found) {\n                new_list.push(item);\n            }\n        }\n        return new_list;\n    }\n\n    /**\n     * Remove the given item from the given list\n     * @param list List of items\n     * @param item Item to remove\n     * @param compareFn Function to compare items\n     */\n    protected removeItem(list: T[], item: T, compareFn?: (a: T, b: T) => boolean) {\n        const new_list = [];\n        /* istanbul ignore else */\n        if (!compareFn) {\n            compareFn = this._compare;\n        }\n        list.forEach((i) => (compareFn(item, i) ? null : new_list.push(i)));\n        return new_list;\n    }\n}\n","import { BaseDataClass } from '../base-api.class';\n\nimport { BookingNote, BookingRecurrenceDetails } from './booking.interfaces';\nimport { CateringOrder } from '../catering/catering-order.class';\nimport { User } from '../users/user.class';\nimport { HashMap } from '../../../shared/utilities/types.utilities';\nimport { humaniseDuration, unique, flatten } from '../../../shared/utilities/general.utilities';\nimport { Space } from '../spaces/space.class';\nimport { ServiceManager } from '../service-manager.class';\n\nimport * as dayjs from 'dayjs';\n\nexport class Booking extends BaseDataClass {\n    /** Unique calendar event ID */\n    public readonly icaluid: string;\n    /** Subject or title of the booking */\n    public readonly title: string;\n    /** Unix timestamp of the booking start */\n    public readonly date: number;\n    /** Length of the booking in minutes */\n    public readonly duration: number;\n    /** Description or details of the booking */\n    public readonly body: string;\n    /** Type of booking */\n    public readonly type: string;\n    /** Whether the booking has catering associated with it */\n    public readonly has_catering: boolean;\n    /** List of catering orders for the booking */\n    public readonly catering: readonly CateringOrder[];\n    /** String location set in booking */\n    public readonly _location: string;\n    /** Whether booking's duration covers all day */\n    public readonly all_day: boolean;\n    /** Details of the recurrence */\n    public readonly recurrence: BookingRecurrenceDetails;\n    /** Mapping of emails to approval statuses */\n    public readonly approval_status: HashMap<string>;\n    /** Host/Organiser of the booking */\n    public readonly organiser: User;\n    /** List of people invited to attend the booking */\n    public readonly attendees: User[];\n    /** Author of the booking */\n    public readonly creator: User;\n    /** List of notes associated with the booking */\n    public readonly notes: readonly BookingNote[];\n    /** Mapping of spaces to equipment charge codes */\n    public readonly equipment_codes: HashMap<string>;\n    /** Mapping of spaces to expected number of attendees */\n    public readonly expected_attendees: HashMap<number>;\n    /** Setup time before the meeting in minutes */\n    public readonly setup: number;\n    /** List of checked in attendees */\n    public readonly checked_in: string[];\n    /** Breakdown time after booking in minutes */\n    public readonly breakdown: number;\n    /** List of fields edited since creation */\n    public readonly edits: string[];\n    /** List of spaces associated with the booking */\n    public readonly space_list: Space[];\n    /** List of users to be notified on visitor arrivals */\n    public readonly notify_users: readonly string[];\n    /** Whether the time or duration has changed */\n    public time_changed = false;\n    /** Map of display strings */\n    private _display: HashMap<string> = {};\n    /** Service for managing Bookings */\n    protected get _service() {\n        return ServiceManager.serviceFor(Booking);\n    }\n\n    constructor(raw_data: HashMap = {}) {\n        super(raw_data);\n        this.icaluid = raw_data.icaluid || this.id || '';\n        this.title = raw_data.title || raw_data.subject || raw_data.Subject || '';\n        const time =\n            raw_data.date || raw_data.start_epoch * 1000 || raw_data.start * 1000 || raw_data.Start;\n        const start = dayjs(time).startOf('m');\n        this.date = !time\n            ? start.minute(Math.ceil(start.minute() / 5) * 5).valueOf()\n            : start.valueOf();\n        this.duration =\n            raw_data.duration ||\n            dayjs(raw_data.end_epoch * 1000 || raw_data.end * 1000 || raw_data.End).diff(\n                start,\n                'm'\n            ) ||\n            60;\n        this.body =\n            // (raw_data.body instanceof Object ? raw_data.body.content : raw_data.body) ||\n            raw_data.description || '';\n        this.type =\n            raw_data.booking_type ||\n            raw_data.type ||\n            (raw_data.visitors ? 'external' : null) ||\n            'internal';\n        this.has_catering = !!raw_data.has_catering;\n        this.attendees = (raw_data.attendees || raw_data._attendees || []).map((i) => new User(i));\n        this.organiser =\n            (raw_data.organiser ? new User(raw_data.organiser) : User.active_user) || new User();\n        this.creator = raw_data.creator ? new User(raw_data.creator) : this.organiser;\n        this._location = raw_data.location_name || raw_data.location || '';\n        this.all_day = raw_data.all_day || this.duration > 23 * 60;\n        this.setup = raw_data.setup || 0;\n        this.breakdown = raw_data.breakdown || 0;\n        this.recurrence = raw_data.recurrence || raw_data.recurr || {};\n        if (this.recurrence.end && this.recurrence.end < new Date().getTime()) {\n            (this as any).recurrence = {\n                ...this.recurrence,\n                start: this.recurrence.start,\n                end: this.recurrence.end,\n            };\n        }\n        this.notes = raw_data.notes || [];\n        this.equipment_codes = raw_data.equipment_codes || raw_data.equipment_code || {};\n        this.expected_attendees = raw_data.expected_attendees || {};\n        this.approval_status = raw_data.approval_status || raw_data.status || {};\n        this.checked_in = raw_data.checked_in || raw_data.checkins || [];\n        this.notify_users = raw_data.notify_users || [];\n        if (raw_data.description && !this.notes.find((i) => i.type === 'description')) {\n            this.notes = [\n                ...this.notes,\n                {\n                    type: 'description',\n                    date: -1,\n                    message: raw_data.description,\n                    author: this.organiser.email,\n                },\n            ];\n        }\n        this._display = {\n            date: start.format('DD MMM YYYY'),\n            time: `${start.format('h:mma')} - ${dayjs(start)\n                .add(this.duration, 'm')\n                .format('h:mma')}`,\n            start: start.format('h:mma'),\n            end: dayjs(start).add(this.duration, 'm').format('h:mma'),\n            duration: humaniseDuration(this.duration),\n        };\n        const space_ids = unique(\n            raw_data.room_ids || raw_data.room_id || raw_data._space_list || []\n        );\n        const space_service = ServiceManager.serviceFor(Space);\n        if (space_service) {\n            this.space_list = space_ids.map((id) => {\n                return space_service.find(id) || new Space({ id, name: id, email: id });\n            });\n        } else {\n            this.space_list = space_ids.map((id) => new Space({ id, name: id, email: id }));\n        }\n        if (raw_data.show_as && raw_data.show_as === 'cancelled') {\n            this.space_list.forEach((space) => (this.approval_status[space.email] = 'declined'));\n        }\n        this.catering = (raw_data.catering instanceof Array ? raw_data.catering : []).map(\n            (i) => new CateringOrder(i)\n        );\n        this.edits =\n            raw_data.edits instanceof Array\n                ? raw_data.edits\n                : unique(flatten(Object.keys(raw_data.edits || {}).map((i) => raw_data.edits[i])));\n    }\n\n    /** Whether booking has been declined */\n    public get declined(): boolean {\n        for (const space of this.space_list) {\n            if ((this.approval_status[space.email] || '').indexOf('decline') >= 0) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /** Whether booking has been approved */\n    public get approved(): boolean {\n        for (const space of this.space_list) {\n            if (\n                this.approval_status[space.email] &&\n                (this.approval_status[space.email].indexOf('tentative') >= 0 ||\n                    this.approval_status[space.email].indexOf('decline') >= 0)\n            ) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    /** Whether booking is tentative */\n    public get tentative(): boolean {\n        for (const space of this.space_list) {\n            if (\n                this.approval_status[space.email] &&\n                this.approval_status[space.email].indexOf('tentative') >= 0\n            ) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /** Whether booking contains external visitors in the attendee list */\n    public get has_visitors(): boolean {\n        return this.attendees.reduce((a, v) => a || v.external, false);\n    }\n\n    /** Status of the booking */\n    public get status(): 'future' | 'upcoming' | 'done' | 'started' | 'in_progress' {\n        const now = dayjs();\n        const date = dayjs(this.date);\n        if (now.isBefore(date.subtract(15, 'm'), 'm')) {\n            return 'future';\n        } else if (now.isBefore(date, 'm')) {\n            return 'upcoming';\n        } else if (now.isBefore(date.add(15, 'm'), 'm')) {\n            return 'started';\n        } else if (now.isBefore(date.add(this.duration, 'm'), 'm')) {\n            return 'in_progress';\n        }\n        return 'done';\n    }\n\n    /** Description of the booking purpose */\n    public get description(): string {\n        const note = (this.notes || []).find((i) => i.type === 'description');\n        return note ? note.message : '';\n    }\n\n    /** Get the first space from the space list */\n    public get space(): Space {\n        return this.space_list[0] || ({ level: { name: '<No Location>' } } as any);\n    }\n\n    /** Display value for the date */\n    public get date_string(): string {\n        return this._display.date;\n    }\n    /** Display valuie for the start and end times of the booking */\n    public get time_period(): string {\n        return this._display.time;\n    }\n    /** Display value for the start time of the booking */\n    public get start_time(): string {\n        return this._display.start;\n    }\n    /** Display value for the end time of the booking */\n    public get end_time(): string {\n        return this._display.end;\n    }\n    /** Display value for the duration of the booking */\n    public get length_string(): string {\n        return this._display.duration;\n    }\n    /** Display value for the location of the booking */\n    public get location(): string {\n        return (\n            this.space_list.map((space) => space.name).join(', ') ||\n            this._location ||\n            'No location set'\n        );\n    }\n    /** Display value for the level of the first space in the booking */\n    public get level(): string {\n        return this.space.level.name;\n    }\n\n    /**\n     * Make a copy of this object\n     */\n    public clone(): Booking {\n        return new Booking(this);\n    }\n\n    /**\n     * Make a copy of this object without identification data\n     */\n    public duplicate(): Booking {\n        return new Booking({\n            ...this.toJSON(),\n            id: null,\n            email: null,\n            icaluid: null,\n        });\n    }\n\n    /**\n     * Convert object into plain object\n     */\n    public toJSON(this: Booking): HashMap {\n        const data = super.toJSON();\n        const date = dayjs(data.date);\n        data.start = data.all_day ? date.startOf('d').unix() : date.unix();\n        data.end = date.add(data.duration || 60, 'm').unix();\n        data.auto_approve = data.space_list.map((space) => {\n            return !this.id || this.time_changed\n                ? !space ||\n                      (space instanceof Space &&\n                          !space.byRequest({\n                              date: data.date,\n                              duration: data.duration,\n                              host: data.organiser,\n                          }))\n                : (this.approval_status[space.email] || '').indexOf('tentative') < 0;\n        });\n        if (data.body && !data.notes.find((note) => note.message === data.body)) {\n            data.notes\n                .filter((note) => note.type !== 'description')\n                .push({\n                    type: 'description',\n                    message: data.body,\n                    author: this.creator.email,\n                    date: dayjs().valueOf(),\n                } as BookingNote);\n            data.notes.sort((a, b) => b.date - a.date);\n        }\n        data.attendees = unique([data.organiser].concat(data.attendees), 'email');\n        data.notify_users = [data.organiser.email];\n        data.room_ids = data.space_list.map((space) => space.email);\n        data.old_date = this.date;\n        if (data.id) {\n            data.from_room = this.space ? this.space.email : '';\n        }\n        data.description = data.body;\n        data.recurr = data.recurrence;\n        data.booking_type = data.type;\n        delete data.type;\n        delete data.recurrence;\n        delete data.space_list;\n        delete data.date;\n        delete data.duration;\n        delete data.display;\n        delete data.email;\n        delete data.name;\n        return data;\n    }\n}\n","import { FormGroup, FormControl, Validators, AbstractControl } from '@angular/forms';\nimport { Subscription } from 'rxjs';\n\nimport {\n    padZero,\n    humaniseDuration,\n    timeFormatString,\n} from '../../../shared/utilities/general.utilities';\n\nimport { generateMockUser } from '../users/user.utilities';\nimport { Booking } from './booking.class';\nimport { User } from '../users/user.class';\nimport { Space } from '../spaces/space.class';\nimport { CateringOrder } from '../catering/catering-order.class';\nimport { HashMap } from 'src/app/shared/utilities/types.utilities';\nimport { AvailableBookingFields } from 'src/app/shared/utilities/settings.interfaces';\nimport { BookingRule, SpaceCheckOptions, SpaceRules, SpaceRuleOptions } from './booking.interfaces';\nimport { validateEndTime } from 'src/app/shared/utilities/validation.utilities';\n\nimport * as faker from 'faker';\nimport * as dayjs from 'dayjs';\nimport { ServiceManager } from '../service-manager.class';\n\nconst MINUTE = 1;\nconst HOUR = 60;\nconst DAY = 24 * HOUR;\nconst WEEK = 7 * DAY;\nconst MONTH = 30 * DAY;\n\nconst DURATION_MAP: { [duration: string]: number } = {\n    month: MONTH,\n    months: MONTH,\n    week: WEEK,\n    weeks: WEEK,\n    day: DAY,\n    days: DAY,\n    hour: HOUR,\n    hours: HOUR,\n    minute: MINUTE,\n    minutes: MINUTE,\n};\n\nlet BOOKING_COUNT = 0;\nlet BOOKING_DATE = dayjs().hour(6).minute(0).subtract(1, 'd').startOf('m');\n\n/**\n * Set the initial time used for generating mock bookings\n * @param time New initial time as ms from UTC epoch\n */\nexport function setMockBookingStartDatetime(time: number) {\n    BOOKING_DATE = dayjs(time).startOf('m');\n}\n\n/**\n * Create mock raw API data for a booking\n * @param override Overrides the properties of the generated booking with it's own\n */\nexport function generateMockBooking(override: HashMap = {}) {\n    const id = `booking-${BOOKING_COUNT++}`;\n    BOOKING_DATE = BOOKING_DATE.add(Math.floor(Math.random() * 4 + 2) * 15, 'm');\n    const start = BOOKING_DATE.valueOf();\n    const duration = Math.floor(Math.random() * 4 + 2) * 15;\n    BOOKING_DATE = BOOKING_DATE.add(Math.floor(Math.random() * 4) * 15, 'm');\n    return {\n        id,\n        icaluid: padZero(Math.floor(Math.random() * 99999999), 8),\n        title: `${faker.commerce.productName()} Meeting`,\n        attendees: Array(Math.floor(Math.random() * 5 + 2))\n            .fill(0)\n            .map((i) => generateMockUser(override.users)),\n        organiser: generateMockUser(),\n        start_epoch: dayjs(start).unix(),\n        end_epoch: dayjs(start).add(duration, 'm').unix(),\n        description: faker.lorem.paragraph(),\n        notes: [{ type: 'other', message: faker.lorem.paragraph() }],\n        location: faker.address.city(),\n        has_catering: Math.floor(Math.random() * 34567) % 3 === 0,\n        catering: [],\n        room_ids: [],\n        ...override,\n    };\n}\n\nexport interface IBookingSlot {\n    start: number;\n    end: number;\n}\n\n/**\n * Generate a list of free time slots between the given bookings\n * @param list List of bookings to find slots between\n * @param min_size Minimum length of a free slot in minutes\n */\nexport function getFreeBookingSlots(list: Booking[], min_size: number = 30): IBookingSlot[] {\n    /* istanbul ignore else */\n    if (!list) {\n        return [\n            {\n                start: 0,\n                end: dayjs().startOf('m').valueOf() * 10,\n            },\n        ];\n    }\n    const slots: IBookingSlot[] = [];\n    let start = dayjs(0);\n    list.sort((a, b) => a.date - b.date);\n    for (const booking of list) {\n        const bkn_start = dayjs(booking.date);\n        const bkn_end = bkn_start.add(booking.duration, 'm');\n        if (bkn_start.isAfter(start)) {\n            const diff = Math.abs(bkn_start.diff(start, 'm'));\n            /* istanbul ignore else */\n            if (diff >= min_size) {\n                slots.push({ start: start.valueOf(), end: bkn_start.valueOf() });\n            }\n            start = bkn_end;\n        } else if (start.startOf('m').valueOf() === bkn_start.startOf('m').valueOf()) {\n            start = bkn_end;\n        }\n    }\n    slots.push({\n        start: start.valueOf(),\n        end: dayjs().startOf('m').valueOf() * 10,\n    });\n    return slots;\n}\n\n/**\n * Get the next free time slot from the given bookings\n * @param list List of bookings to find the next slot\n * @param date Date to find next slot after in ms since UTC epoch\n * @param min_size Minimum length of the free slot in minutes\n */\nexport function getNextFreeBookingSlot(\n    list: Booking[],\n    date: number = dayjs().valueOf(),\n    min_size: number = 30\n): IBookingSlot {\n    const slots = getFreeBookingSlots(list, min_size);\n    const time = dayjs(date).startOf('m').second(1);\n    for (const block of slots) {\n        const start = dayjs(block.start).startOf('m');\n        const end = dayjs(block.end).startOf('m');\n        if (start.isAfter(time, 's')) {\n            return block;\n        } else if (time.isBefore(end, 's')) {\n            const duration = end.diff(time, 'm');\n            /* istanbul ignore else */\n            if (duration >= min_size) {\n                return block;\n            }\n        }\n    }\n    return slots[slots.length - 1];\n}\n\n/**\n * Generate form fields for the given booking\n * @param booking Booking to generate form for\n * @param current_user Current user of the system to default as the host\n */\nexport function generateBookingForm(\n    booking: Booking,\n    use_fields: AvailableBookingFields[]\n): FormGroup {\n    if (!booking) {\n        throw Error('No booking passed');\n    }\n    const user_service = ServiceManager.serviceFor(User);\n    const current_user =\n        user_service.current ||\n        new User({ id: 'local-user', name: 'Local User', email: 'local@place.tech' });\n    const fields: HashMap<FormControl> = {\n        id: new FormControl(booking.id || ''),\n        space_list: new FormControl(booking.space_list, []),\n        date: new FormControl(booking.date, [Validators.required]),\n        duration: new FormControl(booking.duration),\n        organiser: new FormControl(booking.organiser || current_user, [Validators.required]),\n        organiser_email: new FormControl(booking.organiser.email || current_user.email, [\n            Validators.required,\n        ]),\n        attendees: new FormControl(booking.attendees, []),\n        title: new FormControl(booking.title || '', [Validators.required]),\n        type: new FormControl(booking.type),\n        body: new FormControl(booking.body),\n        notes: new FormControl(booking.notes),\n        equipment_codes: new FormControl(booking.equipment_codes),\n        expected_attendees: new FormControl(booking.expected_attendees),\n        catering: new FormControl(\n            booking.catering.map(\n                (order) => new CateringOrder({ ...order, booking_date: booking.date })\n            )\n        ),\n        recurrence: new FormControl(booking.recurrence),\n        all_day: new FormControl(!!booking.all_day),\n        has_catering: new FormControl(!!booking.has_catering),\n        needs_space: new FormControl(true),\n    };\n    fields.duration.setValidators([Validators.required, validateEndTime(fields.date)]);\n    /* istanbul ignore else */\n    if (booking.id) {\n        fields.organiser.disable();\n        /* istanbul ignore else */\n        if (dayjs(booking.date).isBefore(dayjs(), 'm')) {\n            fields.date.disable();\n        }\n    } else {\n        fields.date.setValidators([Validators.required, isFuture]);\n    }\n    const simplified_fields: HashMap<FormControl> = [\n        'id',\n        'space_list',\n        'space_ids',\n        'notes',\n        'equipment_codes',\n        'expected_attendees',\n        'organiser_email',\n        ...use_fields,\n    ].reduce((map, key) => {\n        /* istanbul ignore else */\n        if (fields[key]) {\n            map[key] = fields[key];\n        }\n        return map;\n    }, {});\n    if (simplified_fields.all_day) {\n        simplified_fields.all_day.valueChanges.subscribe((value) => {\n            if (value) {\n                simplified_fields.time.disable();\n                simplified_fields.duration.disable();\n            } else {\n                simplified_fields.time.enable();\n                simplified_fields.duration.enable();\n            }\n        });\n    }\n    // Generate form group for booking item\n    const form = new FormGroup(simplified_fields);\n    return form;\n}\n\n/**\n * Validate whether date is in the future\n * @param control Control to check value\n */\nexport function isFuture(control: AbstractControl) {\n    let now = dayjs().startOf('m');\n    now = now.minute(Math.floor(now.minute() / 5) * 5);\n    const date = dayjs(control.value);\n    return date.isBefore(now, 's') ? { date: 'Date needs to be in the future' } : null;\n}\n\n/**\n * Get booking rules for the given user and space\n * @param user User to determine applicable rules\n * @param space Space to get rules for\n * @param time Booking start time in ms since UTC epoch\n * @param rules List of booking rules for the building\n */\nexport function rulesForSpace(options: SpaceRuleOptions): SpaceRules {\n    if (!options) {\n        throw Error('Options are needed to check for rule matches');\n    }\n    const space_rules_for_user: SpaceRules = {\n        auto_approve: true,\n        hide: true,\n    };\n    /* istanbul ignore else */\n    if (options.space) {\n        for (const type in options.rules) {\n            if (\n                options.rules.hasOwnProperty(type) &&\n                options.rules[type] instanceof Array &&\n                options.space.zones.find((zone) => zone === type)\n            ) {\n                for (const rule_block of options.rules[type]) {\n                    /* istanbul ignore else */\n                    if (\n                        checkRules({\n                            user: options.user,\n                            space: options.space,\n                            time: options.time,\n                            recurr_end: options.recurr_end,\n                            duration: options.duration,\n                            rules: rule_block.conditions,\n                        })\n                    ) {\n                        const ruleset = rule_block.rules;\n                        const conditions = rule_block.conditions;\n                        space_rules_for_user.hide = false;\n                        /* istanbul ignore else */\n                        if (conditions.max_length) {\n                            space_rules_for_user.max_length = stringToMinutes(\n                                conditions.max_length as string\n                            );\n                        }\n                        /* istanbul ignore else */\n                        if (conditions.min_length) {\n                            space_rules_for_user.min_length = stringToMinutes(\n                                conditions.min_length as string\n                            );\n                        }\n                        // NOTE: use max_length in conditions instead of book_length in rules\n                        // if (ruleset.book_length) {\n                        //     space_rules_for_user.max_length = stringToMinutes(ruleset.book_length as string);\n                        // }\n                        /* istanbul ignore else */\n                        if (ruleset.auto_approve !== undefined) {\n                            space_rules_for_user.auto_approve = ruleset.auto_approve;\n                        }\n                        break;\n                    }\n                }\n            }\n            /* istanbul ignore else */\n            if (!space_rules_for_user.hide) {\n                break;\n            }\n        }\n    }\n    return space_rules_for_user;\n}\n\n/**\n * Check if user matches the given ruleset\n * @param user User to determine applicable rules\n * @param space Space to get rules for\n * @param time Booking start time in ms since UTC epoch\n * @param rules List of booking rules for the building\n */\nfunction checkRules(options: SpaceCheckOptions): boolean {\n    /* istanbul ignore else */\n    if (options.rules) {\n        const time = dayjs(options.time);\n        const recurr = options.recurr_end ? dayjs(options.recurr_end) : dayjs();\n        const count = Object.keys(options.rules).length;\n        let matches = 0;\n        for (const key of Object.keys(options.rules)) {\n            let counter = 0;\n            const condition: string[] =\n                options.rules[key] instanceof Array\n                    ? (options.rules[key] as [])\n                    : [options.rules[key] as string];\n            switch (key) {\n                case 'groups':\n                    /* istanbul ignore else */\n                    if (options.user && options.user.groups) {\n                        counter = 0;\n                        condition.forEach((i) =>\n                            options.user.groups.find((j) => j === i) ? counter++ : null\n                        );\n                        /* istanbul ignore else */\n                        if (counter > 0) {\n                            matches++;\n                        }\n                    }\n                    break;\n                case 'locations':\n                    /* istanbul ignore else */\n                    if (options.user && options.user.location) {\n                        counter = 0;\n                        condition.forEach((i) =>\n                            (options.user.last_location.name || '').indexOf(i) >= 0\n                                ? counter++\n                                : null\n                        );\n                        /* istanbul ignore else */\n                        if (counter >= options.rules[key].length) {\n                            matches++;\n                        }\n                    }\n                    break;\n                case 'is_before':\n                    /* istanbul ignore else */\n                    if (options.time) {\n                        const duration = stringToMinutes(condition[0]);\n                        const check = dayjs().add(duration, 'm');\n                        let match = time.isBefore(check, 'm');\n                        /* istanbul ignore else */\n                        if (recurr) {\n                            match = match && recurr.isBefore(check, 'm');\n                        }\n                        matches += match ? 1 : 0;\n                    }\n                    break;\n                case 'is_after':\n                    /* istanbul ignore else */\n                    if (options.time) {\n                        const duration = stringToMinutes(condition[0]);\n                        const check = dayjs().add(duration, 'm');\n                        time.isAfter(check, 'm') ? matches++ : '';\n                    }\n                    break;\n                case 'min_length':\n                    /* istanbul ignore else */\n                    if (options.duration) {\n                        durationGreaterThanOrEqual(options.duration, condition[0]) ? matches++ : '';\n                    }\n                    break;\n                case 'max_length':\n                    /* istanbul ignore else */\n                    if (options.duration) {\n                        durationGreaterThanOrEqual(condition[0], options.duration) ? matches++ : '';\n                    }\n                    break;\n            }\n        }\n        return matches >= count;\n    }\n    return false;\n}\n\n/**\n * Get minimum duration from ruleset in minutes\n * Default to 5min\n */\nexport function getMinLength(rule_list: HashMap<BookingRule[]>): number {\n    return Object.values(rule_list).reduce((min, block) => {\n        const min_block = block.reduce((min_length, el) => {\n            if (el.conditions.min_length && stringToMinutes(el.conditions.min_length) > min) {\n                return stringToMinutes(el.conditions.min_length);\n            } else {\n                return min_length;\n            }\n        }, 5);\n        if (min_block > min) {\n            return min_block;\n        } else {\n            return min;\n        }\n    }, 5) as number;\n}\n\n/**\n * Whether the first input is greater than the last. Converts duration strings into minutes\n * @param duration_1 First input can be a number in minutes or a duration string e.g. `1 hour`\n * @param duration_2 Second input can be a number in minutes or a duration string e.g. `30 minutes`\n */\nexport function durationGreaterThanOrEqual(\n    duration_1: string | number,\n    duration_2: string | number\n) {\n    const first: number = typeof duration_1 === 'string' ? stringToMinutes(duration_1) : duration_1;\n    const second: number =\n        typeof duration_2 === 'string' ? stringToMinutes(duration_2) : duration_2;\n    return first >= second;\n}\n\n/**\n * Conver time string into minutes\n * @param str timestring e.g. `'1 day'`, `'15 minutes'`, `'2 weeks'`\n */\nexport function stringToMinutes(str: string): number {\n    const parts = str.split(' ');\n    return +parts[0] * DURATION_MAP[parts[1]];\n}\n\n/**\n * Get current status within bookings\n * @param bookings List of bookings\n * @param host Host of the new event\n * @param date Datetime of the new event\n */\nexport function statusFromBookings(\n    bookings: Booking[],\n    bookable: boolean,\n    requestable: boolean,\n    date: number = dayjs().valueOf()\n) {\n    const free_slots = getFreeBookingSlots(bookings);\n    const now = dayjs(date);\n    const next_free_slot = free_slots.find((slot) => {\n        const start = dayjs(slot.start);\n        const end = dayjs(slot.end);\n        return start.isAfter(now) || (now.isAfter(start, 's') && now.isBefore(end, 'm'));\n    });\n    const start = dayjs(next_free_slot.start);\n    const end = dayjs(next_free_slot.end);\n    const currently_free = now.isAfter(start, 's') && now.isBefore(end, 'm');\n    const time_until_next_block = humaniseDuration(\n        currently_free ? end.diff(now, 'm') : start.diff(now, 'm'),\n        true\n    );\n    const free_tomorrow = !currently_free && !start.isSame(now, 'd');\n    const free_today = currently_free && !end.isSame(now, 'd');\n    return {\n        status: !bookable\n            ? 'Not Bookable'\n            : currently_free\n            ? requestable\n                ? 'Available by Request'\n                : 'Available'\n            : 'Meeting in Progress',\n        available_until: free_today\n            ? 'No meetings today'\n            : currently_free\n            ? `Free until ${end.format(timeFormatString())}(${time_until_next_block})`\n            : free_tomorrow\n            ? 'Unavailable today'\n            : `Free at ${start.format(timeFormatString())}(${time_until_next_block})`,\n    };\n}\n","\nimport { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\n\nimport { BaseAPIService } from '../base.service';\nimport { Booking } from './booking.class';\nimport { HashMap } from '../../../shared/utilities/types.utilities';\nimport { ServiceManager } from '../service-manager.class';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class BookingsService extends BaseAPIService<Booking> {\n    constructor(protected _composer: ComposerService) {\n        super(_composer);\n        ServiceManager.setService(Booking, this);\n        this._name = 'Bookings';\n        this._api_route = '/bookings';\n        this._compare = (a, b) => !(a.id || '').localeCompare(b.id) || !(a.icaluid || '').localeCompare(b.icaluid);\n    }\n\n    public accept(id: string, fields?: HashMap) {\n        return this.task(id, 'accept', fields);\n    }\n\n    public decline(id: string, fields?: HashMap) {\n        return this.task(id, 'concierge_decline', fields);\n    }\n\n    protected process(raw_data: HashMap): Booking {\n        return new Booking(raw_data);\n    }\n}\n","\nimport { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\n\nimport { CateringCategory } from './catering-category.class';\nimport { BaseAPIService } from '../base.service';\nimport { ServiceManager } from '../service-manager.class';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class CateringCategoriesService extends BaseAPIService<CateringCategory> {\n\n    constructor(protected _composer: ComposerService) {\n        super(_composer);\n        ServiceManager.setService(CateringCategory, this);\n        this._name = 'catering category/group';\n        this._api_route = '/catering/category';\n    }\n\n    public query(): never {\n        throw Error('No index endpoint for catering categories. Use catering menu service.');\n    }\n\n    public show(): never {\n        throw Error('No show endpoint for catering categories. Use catering menu service.');\n    }\n\n    public processItem(raw_item: any) {\n        return new CateringCategory(raw_item);\n    }\n\n    public format(item: CateringCategory) {\n        return item instanceof CateringCategory ? item.toJSON() : item;\n    }\n}\n","import { CateringItem } from \"./catering-item.class\";\nimport { HashMap } from \"../../../shared/utilities/types.utilities\";\n\nexport class CateringCategory extends CateringItem {\n    /** List of items associated with the category */\n    public readonly items: readonly CateringItem[];\n    /** Whether child items are part of a package */\n    public readonly package: boolean;\n    /** List of zone ids associated with the category */\n    public readonly zones: readonly string[];\n\n    public get can_order_anytime(): boolean {\n        return (\n            this.order_anytime ||\n            this.items.reduce(\n                (anytime, item) => anytime || item.can_order_anytime,\n                false\n            )\n        );\n    }\n\n    constructor(data: HashMap) {\n        super(data);\n        this.items = (data.items || []).map(item =>\n            item.items ? new CateringCategory(item) : new CateringItem(item)\n        );\n        this.package = data.package === 'true' || data.package === true;\n        this.zones = data.zones && data.zones.length ? [ ...data.zones ] : [];\n        (this as any).must_select = this.must_select || this.items.length;\n        (this as any).order_anytime = !!data.order_anytime && this.package;\n    }\n\n    /**\n     * Convert class object into plain object\n     */\n    public toJSON(this: CateringItem): HashMap {\n        const obj = super.toJSON();\n        obj.items = obj.items.map((item: CateringItem) => item.toJSON());\n        obj.order_anytime = !!obj.order_anytime && obj.package;\n        return obj;\n    }\n}\n","import { HashMap } from \"../../../shared/utilities/types.utilities\";\n\nexport interface CateringAvailability {\n    /** Month of the year that the item starts being available */\n    readonly from_month: number;\n    /** Month of the year that the item ends being available */\n    readonly to_month: number;\n}\n\nexport class CateringItem {\n    /** Unique ID of the catering item */\n    public readonly id: string;\n    /** Display name of the catering item */\n    public readonly name: string;\n    /** Description of the item */\n    public readonly description: string;\n    /** URL to the image associated with the item */\n    public readonly image_path: string;\n    /** Type of catering item */\n    public readonly catering_type: string;\n    /** Availability of the item */\n    public readonly available: CateringAvailability;\n    /** Time in hours that is needed to prepare the item beforehand */\n    public readonly prior_notice: number;\n    /** Cost of the item without decimals */\n    public readonly unit_price: number;\n    /** Cost of the item without decimals */\n    public readonly supplier_cost: number;\n    /** Minimum number this item allowed in an order */\n    public readonly minimum_quantity: number;\n    /** Maximum number this item allowed in an order */\n    public readonly maximum_quantity: number;\n    /** List of categories that the item is contained in */\n    public readonly parent_categories: readonly string[];\n    /** Allegen information associated with the item */\n    public readonly allergy: string;\n    /** Whether the supply of this item has run out */\n    public readonly out_of_stock: boolean;\n    /** Whether item can be ordered within the time limit set by the building */\n    public readonly order_anytime: boolean;\n    /** Number of child items that must be selected as part of the package */\n    public readonly must_select: number;\n    /** Number of this item in the assoicated order */\n    private _amount = 0;\n    /** Unique ID of the catering item */\n    private instance_id: string;\n\n\n    public get can_order_anytime(): boolean {\n        return this.order_anytime;\n    }\n\n    /** Number of this item in the assoicated order */\n    public get amount(): number {\n        return this._amount || 0;\n    }\n\n    /** Total cost of the amount of items set */\n    public get total(): number {\n        return (this._amount * this.unit_price) || 0;\n    }\n\n    constructor(data: HashMap) {\n        this.instance_id = `item-${Math.floor(Math.random() * 999_999_999)}`\n        this.id = data.id || '';\n        this.name = data.name || '';\n        this.available = {\n            from_month: (data.available ? data.available.from_month : data.available_from) || -1,\n            to_month: (data.available ? data.available.to_month : data.available_to) || -1,\n        };\n        this.description = data.description || '';\n        this.prior_notice = data.prior_notice || data.notice;\n        this.unit_price = data.unit_price || data.price || 0;\n        this.supplier_cost = data.supplier_cost;\n        this.minimum_quantity = Math.max(0, data.minimum_quantity || 0);\n        this.maximum_quantity = Math.max(1, data.maximum_quantity || 999);\n        this.parent_categories = data.category_ids || data.parent_categories || data.categories;\n        this.order_anytime = !!data.order_anytime;\n        this.image_path = data.image_path || '';\n        this.catering_type = data.catering_type;\n        this.must_select = data.must_select || 0;\n        this.out_of_stock = !!data.out_of_stock || data.hide;\n        this._amount = data._amount || data.amount || 0;\n        this.allergy = data.allergy;\n    }\n\n    public setAmount(amount: number = 0): void {\n        if (amount <= this._amount) {\n            if (amount < this.minimum_quantity) {\n                amount = 0;\n            }\n        } else {\n            if (amount < this.minimum_quantity) {\n                amount = this.minimum_quantity;\n            }\n        }\n        this._amount = Math.max(0, Math.min(this.maximum_quantity, amount));\n    }\n\n    /**\n     * Increase amount of the item the order\n     * @param amount Amount to increase by\n     */\n    public addToOrder(amount: number = 1) {\n        amount = Math.max(1, amount);\n        this._amount += amount;\n        if (this._amount < 0) {\n            this._amount = 0;\n        } else if (this._amount < this.minimum_quantity) {\n            this._amount = this.minimum_quantity;\n        } else if (this._amount > this.maximum_quantity) {\n            this._amount = this.maximum_quantity;\n        }\n    }\n\n    /**\n     * Decrease amount of the item the order\n     * @param amount Amount to decrease by\n     */\n    public removeFromOrder(amount: number = 1) {\n        amount = Math.max(1, amount);\n        this._amount -= amount;\n        if (this._amount < 0) {\n            this._amount = 0;\n        } else if (this._amount < this.minimum_quantity) {\n            this._amount = 0;\n        }\n    }\n\n    /**\n     * Convert class object into plain object\n     */\n    public toJSON(this: CateringItem): HashMap {\n        const obj: any = { ...this };\n        // Remove local private members\n        delete obj._changes;\n        delete obj._server_names;\n        // Convert remaining members to be public\n        obj.price = obj.unit_price;\n        obj.hide = obj.out_of_stock;\n        obj.categories = obj.parent_categories;\n        const keys = Object.keys(obj);\n        for (const key of keys) {\n            if (key[0] === '_') {\n                const new_key = key.substr(1);\n                obj[new_key] = obj[key];\n                delete obj[key];\n            } else if (obj[key] === undefined) {\n                delete obj[key];\n            }\n        }\n        return obj;\n    }\n}\n","\nimport { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\n\nimport { BaseAPIService } from '../base.service';\nimport { CateringItem } from './catering-item.class';\nimport { ServiceManager } from '../service-manager.class';\n\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class CateringItemsService extends BaseAPIService<CateringItem> {\n    constructor(protected _composer: ComposerService) {\n        super(_composer);\n        ServiceManager.setService(CateringItem, this);\n        this._name = 'Catering Menu';\n        this._api_route = '/catering/item';\n    }\n\n    public query(): never {\n        throw Error('No index endpoint for catering items. Use menu service.');\n    }\n\n    public show(): never {\n        throw Error('No show endpoint for catering items. Use menu service.');\n    }\n\n    public processItem(raw_item: any) {\n        return new CateringItem(raw_item);\n    }\n\n    public format(item: CateringItem) {\n        return item instanceof CateringItem ? item.toJSON() : item;\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\n\nimport { CateringItem } from './catering-item.class';\nimport { CateringCategory } from './catering-category.class';\nimport { BaseAPIService } from '../base.service';\nimport { HashMap } from '../../../shared/utilities/types.utilities';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class CateringMenuService extends BaseAPIService<CateringItem | CateringCategory> {\n    constructor(protected _composer: ComposerService) {\n        super(_composer);\n        this._name = 'Catering Menu';\n        this._api_route = '/menu';\n    }\n\n    /**\n     * Convert user data to local format\n     * @param user User data\n     */\n    protected processItem(item: HashMap) {\n        return item.items ? new CateringCategory(item) : new CateringItem(item);\n    }\n}\n","import { CateringItem } from './catering-item.class';\nimport { HashMap } from '../../../shared/utilities/types.utilities';\n\nimport { CateringCategory } from './catering-category.class';\nimport { Booking } from '../bookings/booking.class';\n\nimport * as dayjs from 'dayjs';\n\nexport type CateringOrderMutableProperties =\n    | 'items'\n    | 'location_id'\n    | 'location'\n    | 'delivery_time'\n    | 'charge_code'\n    | 'notes'\n    | 'status';\n\nexport type CateringOrderStatus = 'accepted' | 'preparing' | 'ready' | 'delivered' | 'cancelled';\n\nexport class CateringOrder {\n    /** Booking associated with the order */\n    public booking: Booking;\n    /** Whether the order status change is loading */\n    public loading: boolean;\n    /** Unique ID for the catering order */\n    readonly id: string;\n    /** Unique ID for the catering order */\n    readonly booking_id: string;\n    /** Number of minutes after the start of the associated meeting to delivery the order */\n    readonly booking_date: number = dayjs()\n        .startOf('m')\n        .valueOf();\n    /** Number of minutes after the start of the associated meeting to delivery the order */\n    readonly delivery_time: number = 0;\n    /** ID of the location to deliver the items to */\n    readonly location_id: string = '';\n    /** Display text for the location to deliver the items to */\n    readonly location: string = '';\n    /** Status of the catering order */\n    readonly status: CateringOrderStatus;\n    /** Whether items in the order need to be prepared in the kitchen */\n    readonly kitchen: boolean;\n    /** Whether items in the order are in the pantry */\n    readonly pantry: boolean;\n    /** List of items */\n    readonly items: readonly (CateringItem | CateringCategory)[] = [];\n    /** Creation time of the order */\n    readonly created_at: number;\n    /** Charge code associated with the order */\n    readonly charge_code: string;\n    /** Notes associated with the order */\n    readonly notes: string;\n    /** Mapping of properties to their changes */\n    private _changes: HashMap = {};\n    /** Map of local property names to server ones */\n    protected _server_names: HashMap<string> = {};\n    /** Currency code for the location of the order */\n    public symbol: string;\n    /** Whether the is an error with the order */\n    public error: boolean;\n\n    constructor(data: HashMap) {\n        this.id = data.id || `order-${Math.floor(Math.random() * 999_999_999)}`;\n        this.booking = data.booking;\n        this.delivery_time = data.delivery_time || data.start || 0;\n        this.booking_date = data.booking_date;\n        this.location_id = data.location_id || data.location;\n        this.location = data.location || '';\n        this.status = data.status || 'accepted';\n        this.charge_code = data.charge_code || data.code;\n        this.notes = data.notes;\n        this.kitchen = data.kitchen instanceof Array ? !!data.kitchen.length : data.kitchen;\n        this.pantry = data.pantry instanceof Array ? !!data.pantry.length : data.pantry;\n        this.symbol = data.symbol || 'USD';\n        this.items = (data.items || [])\n            .map(item => (item.items ? new CateringCategory(item) : new CateringItem(item)))\n            .filter(item => !!item.amount);\n    }\n\n    /** Mapping of properties to their changes */\n    public get changes(): HashMap<any> {\n        return { ...this._changes } || {};\n    }\n\n    /** Display string for the types of items in the order */\n    public get type(): string {\n        let type = '';\n        /* istanbul ignore else */\n        if (this.kitchen) type += 'Kitchen';\n        /* istanbul ignore else */\n        if (this.pantry) {\n            /* istanbul ignore else */\n            if (type) type += ' + ';\n            type += 'Pantry';\n        }\n        return type;\n    }\n\n    /** Total cost of the order */\n    public get total(): number {\n        return this.items.reduce((total, item) => total + (item.total || 0), 0);\n    }\n\n    /** Total number of items in the order */\n    public get item_count(): number {\n        return this.items.reduce((total, item) => total + (item.amount || 0), 0);\n    }\n\n    /** Display string for the delivery time of the order */\n    public get deliver_at_time(): string {\n        const date = this.booking ? this.booking.date : this.booking_date;\n        return dayjs(date)\n            .add(this.delivery_time, 'm')\n            .format('h:mm A');\n    }\n\n    /** Display string for the delivery date of the order */\n    public get deliver_on_date(): string {\n        const date = this.booking ? this.booking.date : this.booking_date;\n        return dayjs(date)\n            .add(this.delivery_time, 'm')\n            .format('DD MMM YYYY');\n    }\n\n    /** Whether there are any pending changes to be saved */\n    public get has_changes(): boolean {\n        return !!Object.keys(this._changes).length;\n    }\n\n    /**\n     * Store pending changes for the given property\n     * @param name Property to update value\n     * @param value New value to save for property\n     */\n    public storePendingChanges(name: CateringOrderMutableProperties, value: any): void {\n        this._changes[name] = value;\n    }\n\n    /** Clear any changes waiting to be saved */\n    public clearPendingChanges() {\n        delete this._changes;\n        this._changes = {};\n    }\n\n    /**\n     * Convert class object into plain object\n     */\n    public toJSON(this: CateringOrder, with_changes: boolean = true): HashMap {\n        const obj: any = { ...this };\n        // Remove local private members\n        delete obj._changes;\n        delete obj._server_names;\n        // Remove local public members\n        delete obj.booking;\n        delete obj.loading;\n\n        // Convert remaining members to be public\n        const keys = Object.keys(obj);\n        for (const key of keys) {\n            if (key[0] === '_') {\n                const new_key = this._server_names[key.substr(1)] || key.substr(1);\n                obj[new_key] = obj[key];\n                delete obj[key];\n            } else if (obj[key] === undefined) {\n                delete obj[key];\n            }\n        }\n        obj.items = obj.items.map((item: CateringItem) => item.toJSON());\n        return with_changes ? { ...obj, ...this._changes } : obj;\n    }\n}\n","import { HashMap } from 'src/app/shared/utilities/types.utilities';\n\nimport { BuildingLevel } from '../organisation/level.class';\nimport { ServiceManager, ServiceLike } from '../service-manager.class';\nimport { Organisation } from '../organisation/organisation.class';\n\nexport class MapLocation {\n    /** ID of the element on the associated map */\n    public readonly id?: string;\n    /** Name of the location */\n    public readonly name?: string;\n    /** X coordinate of the location */\n    public readonly x?: number;\n    /** Y coordinate of the location */\n    public readonly y?: number;\n    /** Level details for the location */\n    public readonly level: BuildingLevel;\n    /** Whether the position is fixed */\n    public readonly fixed: boolean;\n    /** Accuracy of the location when not fixed */\n    public readonly confidence?: number;\n    /** Whether location is at a desk */\n    public readonly at_desk?: boolean;\n    /** Whether location is set */\n    public readonly empty: boolean;\n    /** Service for managing model on the server */\n    protected get _service(): ServiceLike {\n        return ServiceManager.serviceFor(MapLocation);\n    }\n\n    /** Display string for the building and level of the location */\n    public get display(): string {\n        const org_service = ServiceManager.serviceFor(Organisation);\n        const bld = org_service.buildings.find((bld) => bld.id === this.level.building_id);\n        return bld ? `${bld.name}, ${this.level.name}` : this.level.name;\n    }\n\n    /** Whether location is in a different building from the active one */\n    public get in_another_building(): boolean {\n        const org_service = ServiceManager.serviceFor(Organisation);\n        return org_service.building.id !== this.level.building_id;\n    }\n\n    constructor(raw_data: HashMap) {\n        const org_service = ServiceManager.serviceFor(Organisation);\n        this.id = raw_data.id || raw_data.map_id || raw_data.desk_id;\n        this.name = raw_data.name || '';\n        this.x = raw_data.x\n            ? Math.floor(this.normalise(raw_data.x, raw_data.x_max || 10000) * 10000)\n            : null;\n        this.y = raw_data.y\n            ? Math.floor(this.normalise(raw_data.y, raw_data.x_max || 10000) * 10000)\n            : null;\n        this.level =\n            raw_data.level instanceof BuildingLevel\n                ? raw_data.level\n                : org_service\n                ? org_service.levelWithID(raw_data.level)\n                : new BuildingLevel({ id: raw_data.level });\n        this.fixed = this.x === null && this.y === null;\n        this.confidence = Math.max(5, Math.min(15, raw_data.confidence || 0));\n        this.at_desk = this.id && this.id.indexOf('area-') === 0;\n        this.empty = !(this.name && this.level && (this.id || this.x || this.y));\n    }\n\n    /** Normalise the given value within the max */\n    private normalise(value: number, max: number): number {\n        return value / (max * 1.0);\n    }\n}\n","import { HashMap } from 'src/app/shared/utilities/types.utilities';\nimport { randomInt } from 'src/app/shared/utilities/general.utilities';\n\nexport function generateMockLocation(overrides: HashMap, fixed_locations: string[], maps: string[]): HashMap {\n    const fixed = randomInt(999_999_999) % 2 === 0;\n    if (fixed && (!overrides || overrides.fixed)) {\n        return {\n            map_id: fixed_locations[randomInt(fixed_locations.length)],\n            level: maps[randomInt(maps.length)],\n            ...overrides\n        }\n    } else {\n        return {\n            x: randomInt(900, 100),\n            x_max: 1000,\n            y: randomInt(500, 100),\n            level: maps[randomInt(maps.length)],\n            confidence: randomInt(30),\n            ...overrides\n        }\n    }\n}\n","import { BaseDataClass } from '../base-api.class';\nimport { HashMap, Identity } from '../../../shared/utilities/types.utilities';\nimport { getItemWithKeys } from '../../../shared/utilities/general.utilities';\nimport { BaseAPIService } from '../base.service';\nimport { Organisation } from './organisation.class';\nimport { BuildingLevel } from './level.class';\nimport { BookingRule } from '../bookings/booking.interfaces';\n\nexport interface IBuildingRoleUser {\n    name: string;\n    email: string;\n    phone: string;\n}\n\nexport interface LockerMap {\n    [zone: string]: {\n        [area: string]: {\n            [type: string]: (string | boolean)[][];\n        };\n    };\n}\n\nexport interface ICoordinates {\n    longitude: number;\n    latitude: number;\n}\n\nexport interface LevelFeature {\n    id: string;\n    level_id: string;\n    name: string;\n}\n\nexport interface BookingRuleDetails {\n    /** List of booking rules details for the building */\n    readonly rules: readonly string[];\n    /** Custom booking rules for the map */\n    readonly map_rules?: readonly string[];\n    /** Contact email address for the building */\n    readonly contact?: string;\n    /** Information string to display before the rule listings */\n    readonly info?: string;\n}\n\nexport class Building extends BaseDataClass {\n    /** Engine Zone ID for the building */\n    public readonly zone_id: string;\n    /** Organisation Code for the building */\n    public readonly code: string;\n    /** Geographical address of the building */\n    public readonly address: string;\n    /** Details about the booking rules for the building */\n    public readonly booking_details: BookingRuleDetails;\n    /** Details about the booking rules for the building */\n    public readonly booking_rules: HashMap<readonly BookingRule[]>;\n    /** Number of hour before a booking catering is restricted */\n    public readonly catering_restricted_from: number;\n    /** Currency code for the country assoicated with the building */\n    public readonly currency: string;\n    /** Map of fields that are required on the form */\n    public readonly required: HashMap<boolean>;\n    /** IANA timezone database string for the location the building resides  */\n    public readonly timezone: string;\n    /** Whether catering is available in this building */\n    public readonly has_catering: boolean;\n    /** ID of the system used for the holding bay */\n    public readonly holding_bay: string;\n    /** ID of the system used for standalone visitors bookings */\n    public readonly visitor_space: string;\n    /** List of available extras for the building */\n    private _extras: Identity[];\n    /** List of available extra equipment for loan at the building */\n    private _loan_items: Identity[];\n    /** List of available levels for the building */\n    private _levels: BuildingLevel[];\n    /** Map of custom settings for the building */\n    private _settings: HashMap;\n    /** Map of roles and list of the associated users */\n    private _roles: HashMap<IBuildingRoleUser[]>;\n    /** Map of the locker ID arrays */\n    private _lockers: LockerMap;\n    /** Map of important system ids for the building */\n    private _systems: HashMap<string>;\n    /** Map of important phone numbers for the building */\n    private _phone_numbers: HashMap<string>;\n    /** Globe coordiates for the build */\n    private _location: ICoordinates;\n    /** List of zones associated with the building */\n    private _zones: string[];\n    /** Searchable map features */\n    private _searchables: LevelFeature[];\n    /** Class type of required service */\n    protected __type: string = 'Building';\n\n    constructor(raw_data: HashMap) {\n        super(raw_data);\n        const settings = raw_data.settings || {};\n        const disc_info = settings.discovery_info || settings;\n        this.zone_id = raw_data.zone_id || raw_data.zone;\n        this._extras = (raw_data.extras || disc_info.extras || []).map(i => ({ id: i.extra_id || i.id, name: i.extra_name || i.name }));\n        this._loan_items = (raw_data.loan_items || disc_info.loan_items  || []).map(i => ({ id: i.extra_id || i.id, name: i.extra_name || i.name }));\n        this._levels = (raw_data.levels || disc_info.levels  || []).map(i => new BuildingLevel({ ...i, building_id: this.id }));\n        this._roles = raw_data.roles || disc_info.roles || {};\n        this._lockers = raw_data.lockers || raw_data.locker_structure || disc_info.locker_structure || {};\n        this._systems = raw_data.systems || disc_info.systems || {};\n        this._settings = settings;\n        this._phone_numbers = raw_data.phone_numbers || disc_info.phone_numbers || {};\n        this._location = raw_data.location || disc_info.location || { longitude: null, latitude: null };\n        this._searchables = [];\n        if (raw_data.neighbourhoods) {\n            for (const lvl in raw_data.neighbourhoods) {\n                if (raw_data.neighbourhoods.hasOwnProperty(lvl)) {\n                    const lvl_features = raw_data.neighbourhoods[lvl] || {};\n                    for (const feature in lvl_features) {\n                        if (lvl_features.hasOwnProperty(feature)) {\n                            this._searchables.push({\n                                id: lvl_features[feature],\n                                name: feature,\n                                level_id: lvl\n                            });\n                        }\n                    }\n                }\n            }\n        }\n        this.code = raw_data.code || disc_info.code || settings.code || '';\n        this.address = raw_data.address || disc_info.address || settings.address || '';\n        this.booking_details = raw_data.booking_details || disc_info.booking_details || settings.booking_details || null;\n        this.booking_rules = raw_data.booking_rules || disc_info.booking_rules || settings.booking_rules || {};\n        this.catering_restricted_from = raw_data.catering_restricted_from || disc_info.catering_restricted_from || settings.catering_restricted_from || 0;\n        this.currency = raw_data.currency || disc_info.currency || settings.currency || 'USD';\n        this.required = raw_data.required || disc_info.required || settings.required || {};\n        this.timezone = raw_data.timezone || disc_info.timezone || settings.timezone || '';\n        this.has_catering = raw_data.has_catering || disc_info.has_catering || settings.has_catering || false;\n        this.holding_bay = raw_data.holding_bay || disc_info.holding_bay || settings.holding_bay || '';\n        this.visitor_space = raw_data.visitor_space || disc_info.visitor_space || settings.visitor_space || '';\n    }\n\n    /** List of available extras for the building */\n    public get extras(): Identity[] {\n        return [...(this._extras || [])];\n    }\n    /** List of available extras for the building */\n    public get loan_items(): Identity[] {\n        return [...(this._loan_items || [])];\n    }\n    /** List of available levels for the building */\n    public get levels(): BuildingLevel[] {\n        return [...(this._levels || [])];\n    }\n    /**\n     * Get a custom building setting\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n     */\n    public setting(key: string): any {\n        const keys = key.split('.');\n        const value = getItemWithKeys(keys, this._settings);\n        return value;\n    }\n\n    /**\n     * Get list of users with the associated role\n     * @param name Role to find users for\n     */\n    public role(name: string): IBuildingRoleUser[] {\n        return [...(this._roles[name] || [])];\n    }\n    /**\n     * Get list of the names of available user role lists\n     */\n    public get role_names(): string[] {\n        return Object.keys(this._roles).filter(i => this._roles.hasOwnProperty(i));\n    }\n    /** Map of the locker ID arrays */\n    public get lockers(): LockerMap {\n        return { ...(this._lockers || {}) };\n    }\n    /** Map of important system ids for the building */\n    public get systems(): HashMap<string> {\n        return { ...(this._systems || {}) };\n    }\n    /** Map of important phone numbers for the building */\n    public get phone_numbers(): HashMap<string> {\n        return { ...(this._phone_numbers || {}) };\n    }\n    /** Real coordinates */\n    public get location(): ICoordinates {\n        return { ...this._location };\n    }\n    /** List of zones associated with the building */\n    public get zones(): string[] {\n        return [...(this._zones || [])];\n    }\n    /** Searchable map features */\n    public get searchables(): LevelFeature[] {\n        return [...(this._searchables || [])];\n    }\n\n    /**\n     * Get search map feature for the given level ID\n     * @param level_id ID of level to grab features for\n     */\n    public featuresForLevel(level_id: string): LevelFeature[] {\n        return (this._searchables || []).filter(i => i.level_id === level_id);\n    }\n\n    /**\n     * Building objects are readonly and cannot be changed\n     */\n    public async save(): Promise<Building> {\n        throw new Error('Building objects are readonly and cannot be changed');\n    }\n\n    /**\n     * Building objects are readonly and cannot be deleted\n     */\n    public async delete(): Promise<void> {\n        throw new Error('Building objects are readonly and cannot be deleted');\n    }\n}\n","import { HashMap } from 'src/app/shared/utilities/types.utilities';\n\n/** Building Level data */\nexport class BuildingLevel {\n    /** ID of the building level zone */\n    readonly id: string;\n    /** ID of the building zone associated with the level */\n    readonly building_id: string;\n    /** Name of the level */\n    readonly name: string;\n    /** Number or short identifier of the level */\n    readonly short_name: string;\n    /** Map URL for the level */\n    readonly map_url: string;\n    /** Usage type for the level */\n    readonly type: 'staff' | 'client' | 'any';\n    /** Setting for the level */\n    readonly settings: HashMap;\n\n    constructor(_data: any) {\n        this.id = _data.id || _data.level_id || '';\n        this.building_id = _data.bld_id || _data.building_id || '';\n        this.name = _data.name || _data.level_name || '';\n        const lower_name = this.name.toLowerCase();\n        const num = lower_name.indexOf('level') >= 0 ? lower_name.replace(/ ?level ?/gi, '') : lower_name.substr(0, 1).toUpperCase();\n        this.short_name = _data.short_name || num || '';\n        this.map_url = _data.map_url || '';\n        this.type = _data.type || _data.floor_type || 'any';\n        this.settings = _data.settings;\n    }\n}\n","import { BaseDataClass } from '../base-api.class';\nimport { HashMap } from '../../../shared/utilities/types.utilities';\nimport { getItemWithKeys } from '../../../shared/utilities/general.utilities';\nimport { BaseAPIService } from '../base.service';\nimport { ServiceManager } from '../service-manager.class';\nimport { OrganisationService } from './organisation.service';\n\nexport class Organisation extends BaseDataClass {\n    /** Service for managing organisations */\n    protected get _service() {\n        return ServiceManager.serviceFor(Organisation);\n    }\n    /** Map of custom settings for the building */\n    private _settings: HashMap;\n\n    constructor(raw_data: HashMap) {\n        super(raw_data);\n        this._settings = raw_data.settings || {};\n    }\n\n    /**\n     * Get a custom building setting\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n     */\n    public setting(key: string): any {\n        const keys = key.split('.');\n        const value = getItemWithKeys(keys, this._settings);\n        return value;\n    }\n\n    /**\n     * Building objects are readonly and cannot be changed\n     */\n    public async save(): Promise<Organisation> {\n        throw new Error('Organisation objects are readonly and cannot be changed');\n    }\n\n    /**\n     * Building objects are readonly and cannot be deleted\n     */\n    public async delete(): Promise<void> {\n        throw new Error('Organisation objects are readonly and cannot be deleted');\n    }\n}\n","import { Injectable } from '@angular/core';\n\nimport { ComposerService } from '@placeos/composer';\n\nimport { BaseAPIService } from '../base.service';\nimport { Organisation } from './organisation.class';\nimport { Building } from './building.class';\nimport {\n    HashMap,\n    ApplicationLoadingState,\n    Identity,\n} from '../../../shared/utilities/types.utilities';\nimport { BuildingLevel } from './level.class';\nimport { User } from '../users/user.class';\nimport { first } from 'rxjs/operators';\nimport { ApplicationService } from '../../app.service';\nimport { ServiceManager } from '../service-manager.class';\nimport { UsersService } from '../users/users.service';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class OrganisationService extends BaseAPIService {\n    /** Organisation data for the application */\n    private _organisation: Organisation;\n    /** Actively displayed building */\n    private _active_building: string;\n\n    constructor(\n        protected _composer: ComposerService,\n        private _service: ApplicationService,\n        private _users: UsersService\n    ) {\n        super(_composer);\n        ServiceManager.setService(Organisation, this);\n        ServiceManager.setService(Building, this);\n        this._name = 'Organisation';\n        this._api_route = '/zones';\n        this.set('buildings', []);\n        this.set('active_building', null);\n        this._users.initialised.pipe(first((_) => _)).subscribe(() => this.init());\n    }\n\n    /**\n     * Add is not available on organisation service\n     */\n    public async add(form_data: HashMap, query_params?: HashMap): Promise<Organisation> {\n        throw new Error('Add is not available on the organisation service');\n    }\n\n    /**\n     * Update is not available on organisation service\n     */\n    public async update(\n        id: string,\n        form_data: HashMap,\n        query_params?: HashMap\n    ): Promise<Organisation> {\n        throw new Error('Update is not available on the organisation service');\n    }\n\n    /**\n     * Delete is not available on organisation service\n     */\n    public async delete(id: string): Promise<void> {\n        throw new Error('Delete is not available on the organisation service');\n    }\n\n    /**\n     * Get list of levels for the given building ID\n     * @param bld_id Building ID\n     */\n    public levels(bld_id: string): any[] {\n        return (this.buildings.find((i) => i.id === bld_id) || ({} as Building)).levels;\n    }\n\n    /**\n     * Get a setting from the organisation or active building\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n     */\n    public setting(key: string) {\n        return this.building.setting(key) || this._organisation.setting(key);\n    }\n\n    /** Active building */\n    public get building(): Building {\n        return this.buildings.find((i) => i.id === this._active_building);\n    }\n\n    /** List of types of spaces */\n    public get space_types(): Identity[] {\n        return this.get('space_types') || [];\n    }\n\n    public set building(bld: Building) {\n        if (bld instanceof Building) {\n            this._active_building = bld.id;\n        } else {\n            this._active_building = bld;\n        }\n        this.set('active_building', this.building);\n    }\n\n    /** List of buildings for the organisation */\n    public get buildings(): Building[] {\n        return this.get<Building[]>('buildings') || [];\n    }\n\n    /**\n     * Get list of available equipment\n     * @param id ID of the building to get the list from. i.e. Defaults to the active building\n     */\n    public getExtras(id: string, bld_id?: string) {\n        const bld = this.buildings.find((i) => i.id === bld_id) || this.building;\n        if (bld && id) {\n            return bld.extras.filter((i) => `${i.id}`.indexOf(id) >= 0);\n        }\n        return [];\n    }\n\n    /**\n     * Get the first level matching the list of given IDs\n     * @param ids List of ID to search with\n     */\n    public levelWithID(ids: string | string[]): BuildingLevel {\n        const list = ids instanceof Array ? ids : [ids];\n        const bld_list = this.buildings;\n        for (const id of list) {\n            for (const bld of bld_list) {\n                for (const lvl of bld.levels) {\n                    if (lvl.id === id) {\n                        return lvl;\n                    }\n                }\n            }\n        }\n        return null;\n    }\n\n    /**\n     * Initialise service data\n     */\n    protected async load(): Promise<void> {\n        /* istanbul ignore else */\n        if (localStorage) {\n            this._active_building = localStorage.getItem(`CONCIERGE.building`);\n        }\n        const loading: ApplicationLoadingState = this._service.get('loading') || {};\n        loading.organisation = { message: 'Loading organisation data', state: 'loading' };\n        await this.loadOrganisation();\n        loading.organisation = { message: 'Loading organisation data', state: 'complete' };\n        loading.buildings = { message: 'Loading building data', state: 'loading' };\n        this._service.set('loading', loading);\n        await this.loadBuildings();\n        loading.buildings = { message: 'Loading building data', state: 'complete' };\n        loading.levels = { message: 'Loading building floor data', state: 'loading' };\n        this._service.set('loading', loading);\n        await this.loadLevels();\n        loading.levels = { message: 'Loading building floor data', state: 'complete' };\n        this._service.set('loading', loading);\n        loading.space_types = { message: 'Loading space type data', state: 'loading' };\n        this._service.set('loading', loading);\n        await this.loadSpaceTypes();\n        loading.space_types = { message: 'Loading space type data', state: 'complete' };\n        this._service.set('loading', loading);\n        const user = this._users.current;\n        if (user) {\n            const building = this.buildings.find((bld) => bld.code === user.location);\n            if (building) {\n                this._active_building = building.id;\n                this.set('active_building', building);\n            } else {\n                this._active_building = this.building.id;\n                this.set('active_building', this.building);\n            }\n        }\n    }\n\n    /**\n     * Load organisation data for application\n     */\n    public async loadOrganisation(): Promise<void> {\n        const org_data = await this.query({ tags: 'org', engine: true });\n        this._organisation = new Organisation(org_data[0]);\n        this.set('organisation', this._organisation);\n    }\n\n    /**\n     * Load building data for the organisation\n     */\n    public async loadBuildings(): Promise<void> {\n        const bld_data = await this.query({ tags: 'building', engine: true, limit: 500 });\n        const buildings = (bld_data as HashMap[]).map((i) => new Building(i));\n        this.set('buildings', buildings);\n        /* istanbul ignore else */\n        if (!this._active_building && buildings && buildings.length > 0) {\n            this._active_building = buildings[0].id;\n        }\n    }\n\n    /**\n     * Load level data for the buildings\n     */\n    public async loadLevels(): Promise<void> {\n        const lvl_data = await this.query({ tags: 'level', engine: true });\n        const levels = (lvl_data as HashMap[]).map((i) => new BuildingLevel(i));\n        this.set('levels', levels);\n    }\n\n    /**\n     * Load space type data for the buildings\n     */\n    public async loadSpaceTypes(): Promise<void> {\n        const type_data = await this.query({ tags: 'room', engine: true });\n        const types = (type_data as HashMap[]).map((i) => ({ id: i.id, name: i.name }));\n        this.set('space_types', types);\n    }\n}\n","import { CurrencyPipe } from '@angular/common';\n\nimport { HashMap } from 'src/app/shared/utilities/types.utilities';\nimport { csvToJson, downloadFile, jsonToCsv, humaniseDuration } from 'src/app/shared/utilities/general.utilities';\nimport { Booking } from '../bookings/booking.class';\nimport { formatRecurrence } from 'src/app/shared/utilities/formatting.utilities';\nimport { ServiceManager, ServiceLike } from '../service-manager.class';\n\nimport * as dayjs from 'dayjs';\nimport { Space } from '../spaces/space.class';\nimport { Organisation } from '../organisation/organisation.class';\n\nexport type BookingReport = Report<Booking>;\n\nexport class Report<T extends {} = HashMap> {\n    /** Type of report */\n    public readonly type: string;\n    /** List of data associated with the report */\n    public readonly data: T[];\n    /** Service for managing model on the server */\n    protected get _service(): ServiceLike {\n        return ServiceManager.serviceFor(Report);\n    }\n\n    constructor(raw_data: HashMap) {\n        this.type = raw_data.type || '';\n        this.data = this.cleanData(raw_data.data || []);\n    }\n\n    /** Create report data structure from CSV */\n    public static fromCSV(type: string, data: string): Report {\n        const csv_json = csvToJson(data);\n        return new Report({ type, data: csv_json });\n    }\n\n    /** Download report data as CSV format */\n    public downloadCSV(name: string = 'unammed.csv'): void {\n        downloadFile(name, jsonToCsv(this.data));\n    }\n\n    /** Download report data as JSON format */\n    public downloadJSON(name: string = 'unnamed.json'): void {\n        downloadFile(name, JSON.stringify(this.data, undefined, 4));\n    }\n\n    private cleanData(data: T[]) {\n        if (data.length > 0 && this.type === 'catering') {\n            const fields = Object.keys(data[0]);\n            const room_field = fields.find(key => key.toLowerCase().includes('room') && key.toLowerCase().includes('email'));\n            const price_field = fields.find(key => key.toLowerCase().includes('price'));\n            const date_field = fields.find(key => key.toLowerCase().includes('date'));\n            for (let row of data){\n                /* istanbul ignore else */\n                if (room_field && price_field) {\n                    const space_service = ServiceManager.serviceFor(Space);\n                    const room = space_service.find(row[room_field].toLowerCase());\n                    const org_service = ServiceManager.serviceFor(Organisation);\n                    const bld = org_service.buildings.find(bld => bld.id === ((room || {}).level || {}).building_id);\n                    /* istanbul ignore else */\n                    if (bld) {\n                        row[price_field] = (new CurrencyPipe('en_us')).transform(row[price_field] / 100, bld.currency || 'USD');\n                    }\n                }\n                /* istanbul ignore else */\n                if (date_field) {\n                    row[date_field] = dayjs(row[date_field]).format('DD MMM YYYY - HH:mm');\n                }\n                for (let field of fields) {\n                    row[field] = typeof row[field] === 'string' ? row[field].replace(/\\,/g, '') : row[field];\n                }\n            }\n        } else if (this.type === 'bookings') {\n           data = data.map(i => {\n               const booking = new Booking(i).toJSON();\n               delete booking.id;\n               delete booking.icaluid;\n               delete booking.type;\n               delete booking.auto_approve;\n               delete booking.notify_users;\n               delete booking.organiser_email;\n               delete booking.edits;\n               delete booking.catering;\n               delete booking.checked_in;\n               delete booking.old_date;\n               delete booking.from_room;\n               delete booking.approval_status;\n               booking.body = booking.body.replace(/<[^>]*>?/gm, '');\n               booking.organiser = booking.organiser.name || booking.organiser.email;\n               booking.equipment_codes = Object.keys(booking.equipment_codes).map(key => booking.equipment_codes[key]).join(', ');\n               booking.expected_attendees = Object.keys(booking.expected_attendees).map(key => booking.expected_attendees[key]).join(', ');\n               booking.attendees = booking.attendees.map(person => person.name || person.email).join(', ');\n               booking.start = dayjs(booking.start * 1000).format('DD MMM YYYY, h:mm A');\n               booking.end = dayjs(booking.end * 1000).format('DD MMM YYYY, h:mm A');\n               booking.notes = booking.notes.map(note  => note.author ? `[${note.author}|${note.type}]${note.message.replace(/<[^>]*>?/gm, '')}` : '').join('\\n');\n               booking.setup = humaniseDuration(booking.setup);\n               booking.breakdown = humaniseDuration(booking.breakdown);\n               booking.recurrence = formatRecurrence({ start: booking.date, ...booking.recurrence});\n\n               return booking;\n            }) as any;\n        }\n        return data;\n    }\n}\n","import { Injectable } from '@angular/core';\n\nimport { ComposerService } from '@placeos/composer';\n\nimport { BaseAPIService } from '../base.service';\nimport { Report } from './report.class';\nimport { ServiceManager } from '../service-manager.class';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class ReportsService extends BaseAPIService<Report> {\n    constructor(protected _composer: ComposerService) {\n        super(_composer);\n        ServiceManager.setService(Report, this);\n        this._name = 'Reports';\n        this._api_route = '/reports';\n    }\n\n    protected process(raw_data: any): Report {\n        return raw_data instanceof Array\n            ? new Report({ data: raw_data })\n            : Report.fromCSV('', raw_data);\n    }\n}\n","import { Type } from '@angular/core';\nimport { Observable } from 'rxjs';\n\nimport { HashMap } from 'src/app/shared/utilities/types.utilities';\nimport { BaseDataClass } from './base-api.class';\n\n\nexport interface ServiceLike<T = BaseDataClass> extends HashMap {\n    parent: any;\n    add: (_: HashMap) => Promise<T>\n    update: (id: string, _: HashMap) => Promise<T>\n    delete: (id: string) => Promise<void>\n    task: (id: string, name: string, data: HashMap) => Promise<void>\n    listen: <U = any>(prop: string) => Observable<U>\n}\nexport interface ServiceProvider<T extends ServiceLike> {\n    provideFor: Type<any>;\n    useValue: T\n}\n\nexport class ServiceManager {\n    /** Map of available services for child classes */\n    private static _service_list: ServiceProvider<any>[] = [];\n    /** Set the services used to handle data model requests */\n    public static setService(type: Type<any>, service: any): void {\n        if (window.debug) {\n            (window as any).ServiceManager = this._service_list;\n        }\n        const index = ServiceManager._service_list.findIndex(provider => provider.provideFor === type);\n        if (index >= 0) {\n            ServiceManager._service_list.splice(index, 1, { provideFor: type, useValue: service });\n        } else {\n            ServiceManager._service_list.push({ provideFor: type, useValue: service });\n        }\n    }\n    /** Get the services used to handle data model requests */\n    public static serviceFor(type: Type<any>): ServiceLike<any> {\n        const provider = ServiceManager._service_list.find(provider => provider.provideFor === type) || { useValue: null };\n        return provider.useValue;\n    }\n\n    constructor() {\n        throw new Error('ServiceMananger is static class');\n    }\n}\n","import { BaseDataClass } from '../base-api.class';\nimport { HashMap, Identity } from '../../../shared/utilities/types.utilities';\nimport { Booking } from '../bookings/booking.class';\nimport { BuildingLevel } from '../organisation/level.class';\nimport { SpaceRules } from '../bookings/booking.interfaces';\nimport { rulesForSpace } from '../bookings/booking.utilities';\nimport { User } from '../users/user.class';\n\nimport * as dayjs from 'dayjs';\nimport { Building } from '../organisation/building.class';\nimport { Organisation } from '../organisation/organisation.class';\nimport { ServiceManager } from '../service-manager.class';\n\nexport interface ISpaceAvailabilityOptions {\n    /** Start date and time of the availability block */\n    date?: number;\n    /** Length of the availability block */\n    duration: number;\n    /**  */\n    id?: string;\n    /** List of spaces to look at the availability for */\n    room_ids?: string;\n    /** Whether the spaces looked at should be bookable */\n    bookable?: boolean;\n    /** List of spaces or zones to ignore */\n    ignore?: string;\n    /** List of zones to look at the availability for */\n    zone_ids?: string;\n    /** Whether space bookings should not be returned */\n    hide_bookings?: boolean;\n\n    clear?: boolean;\n}\n\nexport interface SpaceBookingRuleOptions {\n    date: number;\n    duration: number;\n    host: User;\n}\n\nconst OPTION_DEFAULTS: ISpaceAvailabilityOptions = {\n    duration: 60,\n};\n\nexport interface RecurrenceAvailability {\n    /** Unix epoch in seconds */\n    readonly date: number;\n    /** Whetehr space is available at this time */\n    readonly available: boolean;\n}\n\nexport class Space extends BaseDataClass {\n    /** Extends name for the space */\n    public readonly long_name: string;\n    /** CSS selector for the location of the space of the level's map */\n    public readonly map_id: string;\n    /** Type of space */\n    public readonly type: string;\n    /** Whether user can search for this space */\n    public readonly can_search: boolean;\n    /** Whether user can open the control URL if available */\n    public readonly can_control: boolean;\n    /** Hourly cost for using the space */\n    public readonly hourly_rate: number;\n    /** Whether space can be booked by users */\n    public readonly bookable: boolean;\n    /** People capacity of the space */\n    public readonly capacity: number;\n    /** Index to force order when sorting multiple spaces */\n    public readonly sort_priority: number;\n    /** Setup time for bookings in this space */\n    public readonly setup: number;\n    /** Breakdown time for bookings in this space */\n    public readonly breakdown: number;\n    /** Last returned availability result */\n    public readonly was_available: boolean;\n    /** URL for the control interface of the space */\n    public readonly support_url: boolean;\n    /** Display image for the space */\n    public readonly image: string;\n    /** List of recurrence occurrence availability details */\n    public readonly recurr_available: readonly RecurrenceAvailability[];\n    /** Engine zones associated with the space */\n    public readonly zones: readonly string[];\n    /** Bookings associated with the space */\n    public bookings: readonly Booking[];\n    /** List of ids for linked spaces */\n    public linked_spaces: readonly string[];\n    /** Service for managing spaces */\n    protected get _service() {\n        return ServiceManager.serviceFor(Building);\n    }\n    /** List of equipment available in the space */\n    private _extras: Identity[];\n\n    constructor(raw_data: HashMap = {}) {\n        super(raw_data);\n        const settings = raw_data.settings || {};\n\n        this.long_name = settings.long_name || raw_data.long_name;\n        this.map_id = settings.map_id || raw_data.map_id || '';\n        this.type =\n            settings.book_type ||\n            (this.level.settings || {}).book_type ||\n            raw_data.book_type ||\n            raw_data.type ||\n            'book';\n        this.can_search =\n            settings.searchable || raw_data.searchable || raw_data.can_search || false;\n        this.can_control =\n            settings.controlable || raw_data.controlable || raw_data.can_control || false;\n        this.hourly_rate = settings.cost_hour || raw_data.cost_hour || raw_data.hourly_rate || 0;\n        this.bookable = settings.bookable || raw_data.bookable || false;\n        this.setup = (settings.setup || 0) / 60 || raw_data.setup || 0;\n        this.breakdown = (settings.breakdown || 0) / 60 || raw_data.breakdown || 0;\n        this.capacity = raw_data.capacity || 0;\n        this.recurr_available = raw_data.recurr_available || settings.recurr_available || [];\n        const available = !!this.recurr_available.find((occurence) => !!occurence.available);\n        this.was_available =\n            settings.available ||\n            raw_data.available ||\n            raw_data.was_available ||\n            available ||\n            false;\n        this.support_url = raw_data.support_url;\n        this.image = raw_data.image || '';\n\n        this.zones = raw_data.zones instanceof Array ? raw_data.zones : [];\n        const raw_bookings = settings.bookings || raw_data.bookings || [];\n        this.bookings = raw_bookings.map((bkn) => new Booking(bkn));\n        this._extras = [];\n        this.linked_spaces =\n            settings.linked_rooms || raw_data.linked_rooms || raw_data.linked_spaces || [];\n    }\n\n    /** Whether the space has a booking in progress */\n    public get in_use(): boolean {\n        return !!this.current;\n    }\n\n    /** Get any current in progress meeting */\n    public get current(): Booking {\n        const bookings = this.bookings;\n        for (const bkn of bookings) {\n            const status = bkn.status;\n            if (status === 'in_progress' || status === 'started') {\n                return bkn;\n            }\n        }\n        return null;\n    }\n\n    /** Get the next upcoming meeting */\n    public get next(): Booking {\n        const now = dayjs().valueOf();\n        const bookings = this.bookings;\n        for (const bkn of bookings) {\n            if (bkn.date > now) {\n                return bkn;\n            }\n        }\n        return null;\n    }\n\n    /** List of bookings for today */\n    public get todays_bookings(): readonly Booking[] {\n        return this.bookingsFor(dayjs().valueOf());\n    }\n\n    /** Level in which the space is associated */\n    public get level(): BuildingLevel {\n        const service = ServiceManager.serviceFor(Organisation);\n        return (service ? service.levelWithID(this.zones as any) : null) || new BuildingLevel({});\n    }\n\n    /**\n     * Get bookings for space\n     * @param date Date to filter bookings on\n     */\n    public bookingsFor(date?: number): readonly Booking[] {\n        if (date) {\n            const day = dayjs(date);\n            return this.bookings.filter((i) => {\n                const start = dayjs(i.date);\n                return start.isSame(day, 'd');\n            });\n        } else {\n            return this.bookings;\n        }\n    }\n\n    /**\n     * Whether the space is available.\n     */\n    public isAvailable(options?: ISpaceAvailabilityOptions): Promise<boolean> {\n        options = options\n            ? { ...OPTION_DEFAULTS, ...options, room_ids: this.id }\n            : { ...OPTION_DEFAULTS, room_ids: this.id };\n        return new Promise((resolve) => {\n            (this._service as any).available(options).then(\n                (list: Space[]) => {\n                    for (const rm of list) {\n                        if (rm.id === this.id) {\n                            return resolve(true);\n                        }\n                    }\n                    resolve(false);\n                },\n                () => resolve(false)\n            );\n        });\n    }\n\n    /**\n     * Make a copy of this object\n     */\n    public clone(): Space {\n        return new Space(this);\n    }\n\n    /**\n     * Make a copy of this object without identification data\n     */\n    public duplicate(): Space {\n        return new Space({ ...this, id: null, email: null, bookings: [] });\n    }\n\n    /**\n     * Generate the booking rules for space with given options\n     * @param options Conditions for generating the space rules\n     */\n    public rulesFor(options: SpaceBookingRuleOptions): SpaceRules {\n        const service = ServiceManager.serviceFor(Building);\n        if (!service || !this.level) {\n            return { auto_approve: true, hide: false };\n        }\n        const building = service.buildings.find((bld) => bld.id === this.level.building_id);\n        if (!building) {\n            return { auto_approve: true, hide: false };\n        }\n        const { date, duration, host } = options;\n        const rules: SpaceRules = rulesForSpace({\n            time: date,\n            duration,\n            space: this,\n            user: host,\n            rules: building.booking_rules,\n        });\n        return rules;\n    }\n\n    /**\n     * Whether space can only be booked by request\n     * @param options Conditions for checking the space rules\n     */\n    public byRequest(options: SpaceBookingRuleOptions) {\n        const rules = this.rulesFor(options);\n        return !rules.auto_approve;\n    }\n}\n","import { HashMap } from '../../../shared/utilities/types.utilities';\nimport { generateMockBooking } from '../bookings/booking.utilities';\nimport { USER_DOMAIN } from '../users/user.utilities';\nimport { ISpaceAvailabilityOptions } from './space.class';\n\nimport * as faker from 'faker';\nimport * as dayjs from 'dayjs';\n\nlet SPACE_COUNT: number = 0;\n\nexport function generateMockSpace(overrides: HashMap = {}): HashMap {\n    const id = `space-${SPACE_COUNT++}`;\n    const name = `${faker.name.firstName()} ${faker.name.lastName()} Space`;\n    const linked = Math.floor(Math.random() * 99999) % 2 === 0 && SPACE_COUNT > 1;\n    return {\n        id,\n        name,\n        long_name: `${name} with an long name`,\n        map_id: `${SPACE_COUNT}`,\n        capacity: Math.floor(Math.random() * 20 + 1) * 2,\n        email: `${name.toLowerCase().split(' ').join('.')}@${USER_DOMAIN}`,\n        type: faker.commerce.productName(),\n        searchable: Math.floor(Math.random() * 99999) % 2 === 0,\n        controlable: Math.floor(Math.random() * 99999) % 2 === 0,\n        bookable: Math.floor(Math.random() * 99999) % 2 === 0,\n        cost_hour: Math.floor(Math.random() * 300) * 100,\n        setup: Math.floor(Math.random() * 6) * 5,\n        breakdown: Math.floor(Math.random() * 6) * 5,\n        zones: ['zone_lvl-0'],\n        support_url: `/control/#/${id}`,\n        bookings: Array(10).fill(0).map(i => generateMockBooking()),\n        linked_rooms: linked ? [`space-${Math.floor(Math.random() * (SPACE_COUNT - 1))}`] : [],\n        image: faker.image.business(),\n        ...overrides\n    };\n}\n\nexport function availabilityOptionsToQuery(options: ISpaceAvailabilityOptions): HashMap {\n    let query: HashMap = {};\n    if (options) {\n        query = { ...options };\n        if (options.date) {\n            const date = dayjs(options.date).startOf('m');\n            query.available_from = date.unix();\n            query.available_to = date.add(options.duration || 60, 'm').unix();\n            delete query.date;\n            delete query.duration;\n        }\n    }\n    return query;\n}\n","import { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\nimport { first } from 'rxjs/operators';\n\nimport { BaseAPIService } from '../base.service';\nimport { Space, ISpaceAvailabilityOptions } from './space.class';\nimport { HashMap, ApplicationLoadingState } from '../../../shared/utilities/types.utilities';\nimport { availabilityOptionsToQuery } from './space.utilities';\nimport { ServiceManager } from '../service-manager.class';\nimport { OrganisationService } from '../organisation/organisation.service';\nimport { ApplicationService } from '../../app.service';\n\nimport * as dayjs from 'dayjs';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class SpacesService extends BaseAPIService<Space> {\n    constructor(protected _composer: ComposerService, private _org: OrganisationService, private _service: ApplicationService) {\n        super(_composer);\n        ServiceManager.setService(Space, this);\n        this._name = 'Space';\n        this._api_route = '/rooms';\n        this._compare = (a, b) => !a.id.localeCompare(b.id) || !a.email.localeCompare(b.email);\n        this._list_filter = (a: Space) => {\n            const bld = this._org.building;\n            return a.level.building_id === bld.id;\n        };\n        this._composer.initialised.pipe(first((_) => _)).subscribe(() => this.init());\n    }\n\n    /**\n     * Get available spaces\n     * @param options\n     */\n    public available(options: ISpaceAvailabilityOptions): Promise<Space[]> {\n        if (!options) {\n            throw new Error('Space avilability requires request options');\n        }\n        if (!options.date) {\n            options.date = dayjs()\n                .startOf('m')\n                .valueOf();\n        }\n        const key = `available|${options.id ? options.id : ''}`;\n        if (!this._promises[key]) {\n            this._promises[key] = new Promise((resolve, reject) => {\n                const respond = (list: Space[]) => {\n                    const available_spaces = list.filter(i => {\n                        const linked = list.filter(j => i.linked_spaces.indexOf(j.id) >= 0);\n                        return (\n                            i.was_available && linked.reduce((a, v) => a && v.was_available, true)\n                        );\n                    });\n                    delete this._promises[key];\n                    resolve(available_spaces);\n                };\n                const error = e => {\n                    reject(e);\n                    delete this._promises[key];\n                };\n                const query = availabilityOptionsToQuery(options);\n                if (options.id) {\n                    this.show(options.id, query).then(i => respond([i]), error);\n                } else {\n                    this.query(query).then(respond, error);\n                }\n            });\n        }\n        return this._promises[key];\n    }\n\n    /**\n     * Load initial data for the service\n     */\n    protected async load(): Promise<void> {\n        const loading: ApplicationLoadingState = this._service.get('loading') || {};\n        if (!loading.spaces) {\n            loading.spaces = { message: 'Loading space data', state: 'loading' };\n            this._service.set('loading', loading);\n        }\n        await this.query().catch(() => {\n            loading.spaces = { message: 'Loading space data', state: 'failed' };\n            this._service.set('loading', loading);\n        });\n        loading.spaces = { message: 'Loading space data', state: 'complete' };\n        this._service.set('loading', loading);\n    }\n\n    /**\n     * Convert raw data into API object\n     * @param raw_data Raw API data\n     */\n    protected process(raw_data: HashMap): Space {\n        return new Space(raw_data);\n    }\n}\n","import { BaseDataClass } from '../base-api.class';\nimport { HashMap, Identity } from '../../../shared/utilities/types.utilities';\nimport { MapLocation } from '../location/location.class';\nimport { ServiceManager } from '../service-manager.class';\n\nexport class User extends BaseDataClass {\n    /** Currently logged in user */\n    public static get active_user(): User {\n        const service = ServiceManager.serviceFor(User);\n        return service ? service.current : null;\n    }\n    /** First name of the user */\n    public readonly first_name: string;\n    /** Last name of the user */\n    public readonly last_name: string;\n    /** Windows user ID */\n    public readonly windows_id: string;\n    /** Type of user */\n    public readonly type: 'partner' | 'external' | 'internal';\n    /** Contact phone number of the user */\n    public readonly phone: string;\n    /** Organisational department the user is part of */\n    public readonly business_unit: string;\n    /** Whether user is external from the application's organisation */\n    public readonly external: boolean;\n    /** Organisational Identifier for the user */\n    public readonly staff_code: string;\n    /** Basic location descriptor for the user */\n    public readonly location: string;\n    /** List of users that this user can act on behalf */\n    public readonly delegates: readonly string[];\n    /** URL of the user's avatar image */\n    public readonly image: string;\n    /** List of user groups associated with this user */\n    public readonly groups: readonly string[];\n    /** Organisation the user is associated with */\n    private _organisation: Identity;\n\n    /** Map location of the user */\n    private _location: MapLocation;\n    /** List of desk bookings */\n    private _desk_bookings: HashMap = {};\n\n    constructor(raw_data: HashMap = {}) {\n        super(raw_data);\n        this.first_name = raw_data.first_name || '';\n        this.last_name = raw_data.last_name || '';\n        this.windows_id = raw_data.email || '';\n        this.type = raw_data.visitor ? 'external' : raw_data.type || 'internal';\n        this.phone = raw_data.phone || raw_data.mobile || '';\n        this.business_unit = raw_data.business_unit || raw_data.department || '';\n        this._organisation = raw_data.organisation || {\n            id: raw_data.organisation_id,\n            name: raw_data.organisation_name\n        };\n        this.external = this.type === 'external';\n        this._location = null;\n        this.image = raw_data.image || '';\n        this.staff_code = raw_data.staff_code || raw_data.fmno || '';\n        this.delegates = raw_data.delegates || [];\n        this._location = new MapLocation(\n            raw_data.location && raw_data.location instanceof Object\n                ? raw_data.location\n                : { name: raw_data.location }\n        );\n        this.groups = raw_data.groups || [];\n        this.location = raw_data.location || raw_data.officeLocation || '';\n    }\n\n    /** Organisation the user is associated with */\n    public get organisation() {\n        return this._organisation;\n    }\n\n    /** Map location of the user */\n    public get last_location(): MapLocation {\n        return new MapLocation(this._location || {})\n    }\n\n    /**\n     * Ask the server for the users current location\n     */\n    public locate(): Promise<MapLocation> {\n        const service: any = ServiceManager.serviceFor(MapLocation);\n        return new Promise((resolve, reject) => {\n            if (service) {\n                service.show(this.id, { desk: this.email }).then(\n                    l => {\n                        this._location = l;\n                        resolve(l);\n                    },\n                    e => reject(e)\n                );\n            } else {\n                resolve(null);\n            }\n        });\n    }\n\n    /**\n     * Whether user is available during the given period\n     * @param start Start time as a unix timestamp with milliseconds\n     * @param end End time as a unix timestamp with milliseconds\n     */\n    public available(start?: number, end?: number): Promise<boolean> {\n        return new Promise<boolean>(resolve => {\n            this._service.query({ email: this.email, start, end }).then(\n                l => resolve(l && l.length > 0),\n                _ => resolve(false)\n            );\n        });\n    }\n\n    /**\n     * Make a copy of this object\n     */\n    public clone(): User {\n        return new User(this);\n    }\n\n    /**\n     * Make a copy of this object without identification data\n     */\n    public duplicate(): User {\n        return new User({ ...this, id: null, email: null });\n    }\n\n    /**\n     * Convert object into plain object\n     */\n    public toJSON(this: User): HashMap {\n        const data = super.toJSON();\n        delete data.location;\n        return data;\n    }\n}\n","import { HashMap } from '../../../shared/utilities/types.utilities';\n\nimport * as faker from 'faker';\nimport { padZero, unique } from '../../../shared/utilities/general.utilities';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { User } from './user.class';\nimport { Subscription } from 'rxjs';\n\nlet USER_COUNT = 0;\n\nexport let USER_DOMAIN = 'acaprojects.com';\n\nconst USER_EMAILS: string[] = [];\n\n/**\n * Generate raw mock data for a user\n * @param id Forced ID for the mock\n * @param name Forced name for the user\n * @param external Whether user is external of the organisation\n */\nexport function generateMockUser(override: HashMap = {}): HashMap {\n    const id = `user-${USER_COUNT++}`;\n    const name = `${faker.name.firstName()} ${faker.name.lastName()}`;\n    const external = override.external || !((Math.random() * 99999) % 2);\n    const organisation = external ? faker.company.companyName() : USER_DOMAIN.split('.')[0];\n    let delegates: string[] = [];\n    const delegate_count = Math.min(Math.random() * 4 + 1, USER_EMAILS.length);\n    for (let i = 0; i < delegate_count; i++) {\n        delegates.push(USER_EMAILS[Math.floor(Math.random() * USER_EMAILS.length)]);\n    }\n    delegates = unique(delegates);\n    const email = `${name\n        .split(' ')\n        .join('.')\n        .toLowerCase()}@${external ? 'not-' : ''}${USER_DOMAIN}`;\n    USER_EMAILS.push(email);\n    return {\n        id,\n        name,\n        first_name: name.split(' ')[0],\n        last_name: name.split(' ')[1],\n        email,\n        phone: faker.phone.phoneNumber(),\n        visitor: external,\n        organisation: {\n            id: organisation\n                .split(' ')\n                .join('.')\n                .toLowerCase(),\n            name: organisation\n        },\n        department: faker.commerce.department(),\n        staff_code: padZero(Math.floor(Math.random() * 99999), 5),\n        delegates,\n        image: faker.image.avatar(),\n        ...override\n    };\n}\n\n/**\n * Generate form fields for the given user\n * @param user User to generate form for\n */\nexport function generateUserForm(user: User): FormGroup {\n    if (!user) {\n        throw Error('No user passed');\n    }\n    const fields: HashMap<FormControl> = {\n        id: new FormControl(user.id || ''),\n        name: new FormControl(user.name || ''),\n        first_name: new FormControl(user.first_name || ''),\n        last_name: new FormControl(user.last_name || ''),\n        email: new FormControl(user.email || '', [Validators.email, Validators.required])\n    };\n    // Generate form group for booking item\n    return new FormGroup(fields);\n}\n","import { Injectable } from '@angular/core';\nimport { Location } from '@angular/common';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { ComposerService } from '@placeos/composer';\nimport { first } from 'rxjs/operators';\n\nimport { Md5 } from 'ts-md5/dist/md5';\n\nimport { BaseAPIService } from '../base.service';\nimport { User } from './user.class';\nimport { HashMap, ApplicationLoadingState } from '../../../shared/utilities/types.utilities';\nimport { unique } from 'src/app/shared/utilities/general.utilities';\n\nimport * as dayjs from 'dayjs';\nimport { ApplicationService } from '../../app.service';\nimport { ServiceManager } from '../service-manager.class';\n\nexport interface ILoginOptions {\n    /** URL to post login request to */\n    url?: string;\n    /** Whether form data is passed in the body of the request */\n    form?: boolean;\n    /** Custom headers to pass into the post request */\n    headers?: HashMap<string>;\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class UsersService extends BaseAPIService<User> {\n    constructor(\n        protected _composer: ComposerService,\n        protected uhttp: HttpClient,\n        protected location: Location,\n        private _service: ApplicationService\n    ) {\n        super(_composer);\n        console.log('Initialised Users');\n        ServiceManager.setService(User, this);\n        this._name = 'Users';\n        this._api_route = '/users';\n        this._compare = (a, b) => !a.id.localeCompare(b.id) || !a.email.localeCompare(b.email);\n        this.set('current_user', new User({ id: 'local_user', name: 'Local User' }));\n        this._composer.initialised.pipe(first((_) => _)).subscribe(() => this.init());\n    }\n\n    /** Currently logged in user */\n    public get current(): User {\n        return this.get('current_user');\n    }\n\n    /** Whether the user has properly logged in */\n    public get is_logged_in(): boolean {\n        return this.current && this.current.id !== 'local_user';\n    }\n\n    /** istanbul ignore function */\n    /**\n     * Sets the access token and expiry for the user\n     * @param token OAuth bearer token\n     * @param expiry Expiry epoch timestamp in ms\n     * @param reload Whether to reload the page after setting tokens\n     */\n    public setToken(token: string, expiry?: number, reload: boolean = true) {\n        if (!expiry) {\n            expiry = dayjs().add(7, 'd').endOf('d').valueOf();\n        }\n        const path = `${location.origin}${\n            this._service.setting('composer.route') || ''\n        }/oauth-resp.html`;\n        const client_id = Md5.hashStr(path);\n        if (sessionStorage) {\n            sessionStorage.setItem(`${client_id}_access_token`, token);\n            sessionStorage.setItem(`${client_id}_expires_at`, `${expiry}`);\n        }\n        if (localStorage) {\n            localStorage.setItem(`${client_id}_access_token`, token);\n            localStorage.setItem(`${client_id}_expires_at`, `${expiry}`);\n        }\n        if (reload) {\n            this.location.go(this.location.path());\n        }\n        return path;\n    }\n\n    /**\n     * Post login request to the API\n     * @param query_params Key value pairs to pass into\n     * @param options Options for the login request\n     */\n    public login(query_params: HashMap, options: ILoginOptions = {}): Promise<void> {\n        if (!this._promises['login']) {\n            this._promises['login'] = new Promise<void>((resolve, reject) => {\n                this.set('status', 'loading');\n                let headers = new HttpHeaders();\n                if (!options || options.form !== false) {\n                    headers = headers.append('Content-Type', 'application/x-www-form-urlencoded');\n                }\n                const url = (options ? options.url : '') || '/auth/signin';\n                this.uhttp.post(url, query_params, { headers }).subscribe(\n                    (_) => null,\n                    (e) => reject(e),\n                    () => {\n                        this._composer.auth.authorise();\n                        resolve();\n                    }\n                );\n            });\n        }\n        return this._promises['login'];\n    }\n\n    /**\n     * Logout of user and redirect to logout URL\n     */\n    public logout() {\n        this._composer.auth.logout();\n    }\n\n    /**\n     * Load initial data for the service\n     */\n    protected load(tries: number = 0): Promise<void> {\n        const loading: ApplicationLoadingState = this._service.get('loading') || {};\n        if (!loading.user) {\n            loading.user = { message: 'Loading user credentials', state: 'loading' };\n            this._service.set('loading', loading);\n        }\n        this.set('status', 'loading');\n        return new Promise<void>((resolve) => {\n            if (tries > 4) {\n                this.set('status', 'invalid');\n                loading.user = { message: 'Loading user credentials', state: 'failed' };\n                this._service.set('loading', loading);\n                return resolve();\n            }\n            this.show('current').then(\n                (current_user) => {\n                    this.set('status', 'available');\n                    this.set('current_user', current_user);\n                    this._initialised.next(true)\n                    if (this._service && this._service.setting('app.user.grab_api_details')) {\n                        this.show(current_user.email).then(\n                            (user) => {\n                                this.set('current_user', user);\n                                if (this._service.setting('app.user.update_location')) {\n                                    this.interval('location', () => user.locate(), 5000);\n                                }\n                                this.loadDelegates();\n                                resolve();\n                                loading.user = {\n                                    message: 'Loading user credentials',\n                                    state: 'complete',\n                                };\n                                this._service.set('loading', loading);\n                            },\n                            () =>\n                                this.timeout('load', () => this.load(++tries).then(() => resolve()))\n                        );\n                    } else {\n                        if (this._service.setting('app.user.update_location')) {\n                            this.interval('location', () => current_user.locate(), 5000);\n                        }\n                        this.loadDelegates();\n                        resolve();\n                        loading.user = { message: 'Loading user credentials', state: 'complete' };\n                        this._service.set('loading', loading);\n                    }\n                },\n                () => this.timeout('load', () => this.load(++tries).then(() => resolve()))\n            );\n        });\n    }\n\n    private async loadDelegates() {\n        const delegates = this.current.delegates;\n        if (!delegates || !delegates.length) {\n            return [];\n        }\n        const promises: Promise<User>[] = [];\n        for (const email of delegates) {\n            promises.push(this.show(email));\n        }\n        const list = await Promise.all(promises);\n        this.set('delegates', list);\n        this.set('list', unique((this.get('list') || []).concat(list)));\n        return list;\n    }\n\n    /**\n     * Convert raw API data into a valid User Object\n     * @param raw_item Raw API data\n     */\n    protected process(raw_data: any): User {\n        return new User(raw_data);\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable, Subscription } from 'rxjs';\n\nimport { HashMap } from '../shared/utilities/types.utilities';\nimport { unique } from '../shared/utilities/general.utilities';\n\n/** List of keys that cannot be in a combination by themselves or with each other */\nconst INVALID_STANDALONE_KEYS: string[] = ['control', 'shift', 'alt', 'meta', 'os'];\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class HotkeysService {\n    /** Map of subjects which store press states of keys */\n    private keydown_states: HashMap<BehaviorSubject<number>> = {};\n    /** Map of obserers for key state subjects */\n    private keydown_observers: HashMap<Observable<number>> = {};\n    /** List of keys at the end of a combination */\n    private combo_end: string[] = [];\n    /** List of registered hotkey combinations */\n    private registered_combos: string[][] = [];\n    /** Counter for the number of keydown events. Used for checking order of key presses */\n    private counter: number = 0;\n    /** Last key code to be pressed */\n    private last_down: string;\n\n    constructor() {\n        window.addEventListener('keydown', (event: KeyboardEvent) => {\n            const code = this.mapKey((event.code || '').toLowerCase());\n            /* istanbul ignore else */\n            if (this.last_down !== code) {\n                /* istanbul ignore else */\n                if (!this.keydown_states[code]) {\n                    this.keydown_states[code] = new BehaviorSubject(null);\n                    this.keydown_observers[code] = this.keydown_states[code].asObservable();\n                }\n                this.keydown_states[code].next(++this.counter);\n                /* istanbul ignore else */\n                if (this.combo_end.indexOf(code) >= 0) {\n                    event.preventDefault();\n                }\n                this.last_down = code;\n            }\n        });\n\n        window.addEventListener('keyup', (event: KeyboardEvent) => {\n            const code = this.mapKey((event.code || '').toLowerCase());\n            /* istanbul ignore else */\n            if (this.keydown_states[code]) {\n                this.keydown_states[code].next(null);\n            }\n            /* istanbul ignore else */\n            if (this.last_down === code) {\n                this.last_down = null;\n            }\n        });\n    }\n\n    /**\n     * Listen to the given key combination\n     * @param combo Array of key codes to listen to or a hotkey string e.g. `Alt+Shift+KeyK`\n     * @param next Callback for combination presses\n     */\n    public listen(combo: string | string[], next: () => void): Subscription {\n        combo = (combo instanceof Array ? combo : combo.split('+'));\n        const combination: string[] = combo.map(i => this.mapKey(i.toLowerCase()));\n        /* istanbul ignore else */\n        if (combination.length > 0 && this.validCombination(combination)) {\n            this.registered_combos.push(combination);\n            const last_key = combination[combination.length - 1];\n            /* istanbul ignore else */\n            if (!this.keydown_states[last_key]) {\n                this.keydown_states[last_key] = new BehaviorSubject(null);\n                this.keydown_observers[last_key] = this.keydown_states[last_key].asObservable();\n            }\n            this.updateCombinationEndList();\n            return this.keydown_observers[last_key].subscribe((count) => {\n                /* istanbul ignore else */\n                if (count) {\n                    const presses: number[] = [];\n                    /* istanbul ignore else */\n                    if (combination.length > 0) {\n                        // Check that keys are pressed\n                        for (const key of combination) {\n                            const state = this.keydown_states[key];\n                            presses.push(state ? state.getValue() || -1 : -1);\n                        }\n                        // Check that keys are pressed in the correct order\n                        for (let i = 0; i < combination.length - 1; i++) {\n                            if (presses[i] > presses[i + 1]) { return; }\n                        }\n                    }\n                    const total = presses.reduce((a, v) => a + (v > 0 ? 1 : -1), 0);\n                    /* istanbul ignore else */\n                    if (total >= combination.length) {\n                        next();\n                    }\n                }\n            });\n        }\n        return null;\n    }\n\n    /**\n     * Map key codes with multiple versions to simple form\n     * @param code Code to transform\n     */\n    private mapKey(code: string): string {\n        /* istanbul ignore else */\n        if (code.indexOf('alt') >= 0 || code.indexOf('shift') >= 0 || code.indexOf('control') >= 0) {\n            return code.replace('left', '').replace('right', '');\n        }\n        return code;\n    }\n\n    /**\n     * Update the list of the last keys in combinations to allow for prevent default actions on pre-existing hotkeys\n     */\n    private updateCombinationEndList(): void {\n        const key_list = [];\n        for (const combo of this.registered_combos) {\n            this.combo_end.push(combo[combo.length - 1]);\n        }\n        this.combo_end = unique(key_list);\n    }\n\n    /**\n     * Checks if the given hotkey combination is allowed and valid\n     * @param combo Array of key codes\n     */\n    private validCombination(combo: string[]): boolean {\n        let non_meta = 0;\n        for (const key of combo) {\n            /* istanbul ignore else */\n            if (INVALID_STANDALONE_KEYS.indexOf(key) < 0) {\n                non_meta++;\n            }\n        }\n        return non_meta > 0;\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\n\nimport { HashMap } from '../shared/utilities/types.utilities';\nimport { getItemWithKeys } from '../shared/utilities/general.utilities';\nimport { version, build, core_version } from '../shared/globals/application';\nimport { BaseClass } from '../shared/base.class';\n\nimport * as dayjs from 'dayjs';\n\ninterface SettingsMap {\n    api: HashMap;\n    local: HashMap;\n    session: HashMap;\n    [block: string]: HashMap;\n}\n\ndeclare global {\n    interface Window {\n        debug: boolean;\n    }\n}\n\nexport type ConsoleStream = 'debug' | 'warn' | 'log' | 'error';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class SettingsService extends BaseClass {\n\n    /** Map of settings */\n    private _settings: SettingsMap = { api: {}, local: {}, session: {} };\n    /** Store for promises */\n    private _promises: { [name: string]: Promise<any> } = {};\n    /** Name of the application */\n    private _app_name = 'PlaceOS';\n\n    constructor(private http: HttpClient) {\n        super();\n        const now = dayjs();\n        const built = now.isSame(build, 'd') ? `Today at ${build.format('h:mmA')}` : build.format('D MMM YYYY, h:mmA');\n        this.log('CORE', `${core_version}`, null, 'debug', true);\n        this.log('APP', `${version} | Built: ${built}`, null, 'debug', true);\n        this.init();\n    }\n\n    /**\n     * Initialise the settings\n     */\n    public async init() {\n        await this.loadFromFile('api');\n        if (this._settings.api.debug) {\n            window.debug = true;\n        }\n        if (this._settings.api.app && this._settings.api.app.name) {\n            this._app_name = this._settings.api.app.name;\n        }\n        this.log('Settings', 'Successfully loaded settings');\n        this._initialised.next(true);\n    }\n\n    /** Whether settings service has initialised */\n    public get app_name() { return this._app_name; }\n\n    /**\n     * Log data to the browser console\n     * @param type Type of message\n     * @param msg Message body\n     * @param args array of argments to log to the console\n     * @param stream Stream to emit the console on. 'debug', 'log', 'warn' or 'error'\n     * @param force Whether to force message to be emitted when debug is disabled\n     */\n    public log(type: string, msg: string, args?: any, stream: ConsoleStream = 'debug', force: boolean = false) {\n        if (window.debug || force) {\n            const colors: string[] = ['color: #E91E63', 'color: #3F51B5', 'color: default'];\n            if (args) {\n                console[stream](`%c[${this.app_name}]%c[${type}] %c${msg}`, ...colors, args);\n            } else {\n                console[stream](`%c[${this.app_name}]%c[${type}] %c${msg}`, ...colors);\n            }\n        }\n    }\n\n    /**\n     * Get a setting\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n     */\n    public get(key: string): any {\n        const keys = key.split('.');\n        let value = null;\n        if (keys[0] === 'session') {\n            keys.shift();\n            value = getItemWithKeys(keys, this._settings.session);\n        } else if (keys[0] === 'local') {\n            keys.shift();\n            value = getItemWithKeys(keys, this._settings.local);\n        } else {\n            value = getItemWithKeys(keys, this._settings.api) ||\n                getItemWithKeys(keys, this._settings.session) ||\n                getItemWithKeys(keys, this._settings.local);\n        }\n        return value;\n    }\n\n    /**\n     * Load setting data from a file\n     * @param name Namespace to add file data to\n     * @param file URL to file to load setting data from\n     */\n    private async loadFromFile(name: string, file: string = 'assets/settings.json', tries: number = 0) {\n        if (file !== 'assets/settings.json' && tries > 5) {\n            return Promise.resolve();\n        }\n        const file_name = file.split('/')[file.split('/').length - 1];\n        // Check if data has been loaded into the global space\n        if (window[file_name] instanceof Object) {\n            this._settings[name] = { ...(this._settings[name] || {}), ...window[file_name] };\n            return Promise.resolve();\n        }\n        const key = `load|${name}|${file}`;\n        if (!this._promises[key]) {\n            this._promises[key] = new Promise<void>((resolve, reject) => {\n                this.http.get(file).subscribe(\n                    (data) => {\n                        this._settings[name] = { ...(this._settings[name] || {}), ...(data || {}) };\n                    }, (e) => {\n                        this.log('Settings', `Failed to load settings from \"${file}\"`);\n                        this._promises[key] = null;\n                        this.timeout(`load_${file_name}`, () => {\n                            this.loadFromFile(name, file, ++tries).then(() => resolve());\n                        })\n                    }, () => resolve()\n                );\n            });\n        }\n        return this._promises[key];\n    }\n\n}\n","import { Subscription, BehaviorSubject } from \"rxjs\";\n\nexport class BaseClass {\n    /** Store for named timers */\n    protected _timers: { [name: string]: number } = {};\n    /** Store for named intervals */\n    protected _intervals: { [name: string]: number } = {};\n    /** Store for named subscription unsub callbacks */\n    protected _subscriptions: { [name: string]: (Subscription | (() => void)) } = {};\n    /** Subject which stores the initialised state of the object */\n    protected readonly _initialised = new BehaviorSubject<boolean>(false);\n\n    /** Observable of the initialised state of the object */\n    public get initialised(): BehaviorSubject<boolean> {\n        return this._initialised;\n    }\n    /** Whether the object has been initialised */\n    public get is_initialised(): boolean {\n        return this._initialised.getValue();\n    }\n\n    protected destroy() {\n        for (const key in this._timers) {\n            /* istanbul ignore else */\n            if (this._timers.hasOwnProperty(key)) {\n                this.clearTimeout(key);\n            }\n        }\n        for (const key in this._intervals) {\n            /* istanbul ignore else */\n            if (this._intervals.hasOwnProperty(key)) {\n                this.clearInterval(key);\n            }\n        }\n        for (const key in this._subscriptions) {\n            /* istanbul ignore else */\n            if (this._subscriptions.hasOwnProperty(key)) {\n                this.unsub(key);\n            }\n        }\n    }\n\n    /**\n     * Creates a named timer\n     * @param name Name of the timer\n     * @param fn Callback function for the timer\n     * @param delay Callback delay\n     */\n    protected timeout(name: string, fn: () => void, delay: number = 300) {\n        if (name && fn && fn instanceof Function) {\n            this.clearTimeout(name);\n            this._timers[name] = <any>setTimeout(() => {\n                fn();\n                this._timers[name] = null;\n            }, delay);\n        } else {\n            throw new Error(\n                name ? 'Cannot create named timeout without a name' : 'Cannot create a timeout without a callback'\n            );\n        }\n    }\n\n    /**\n     * Clears the named timer\n     * @param name Timer name\n     */\n    protected clearTimeout(name: string) {\n        /* istanbul ignore else */\n        if (this._timers[name]) {\n            clearTimeout(this._timers[name]);\n            this._timers[name] = null;\n        }\n    }\n\n    /**\n     * Creates a named interval\n     * @param name Name of the interval\n     * @param fn Callback function for the interval\n     * @param delay Callback delay\n     */\n    protected interval(name: string, fn: () => void, delay: number = 300) {\n        if (name && fn && fn instanceof Function) {\n            this.clearInterval(name);\n            this._intervals[name] = <any>setInterval(() => fn(), delay);\n        } else {\n            throw new Error(\n                name ? 'Cannot create named interval without a name' : 'Cannot create a interval without a callback'\n            );\n        }\n    }\n\n    /**\n     * Clears the named interval\n     * @param name Timer name\n     */\n    protected clearInterval(name: string) {\n        /* istanbul ignore else */\n        if (this._intervals[name]) {\n            clearInterval(this._intervals[name]);\n            this._intervals[name] = null;\n        }\n    }\n\n    /**\n     * Store named subscription\n     * @param name Name of the subscription\n     * @param unsub Unsubscribe callback or Subscription object\n     */\n    protected subscription(name: string, unsub: Subscription | (() => void)) {\n        this.unsub(name);\n        this._subscriptions[name] = unsub\n    }\n\n    /**\n     * Call unsubscribe callback with the given name\n     * @param name\n     */\n    protected unsub(name: string) {\n        /* istanbul ignore else */\n        if (this._subscriptions && this._subscriptions[name]) {\n            this._subscriptions[name] instanceof Subscription\n                ? (this._subscriptions[name] as Subscription).unsubscribe()\n                : (this._subscriptions[name] as any)();\n            this._subscriptions[name] = null;\n        }\n    }\n}\n","\nimport { Directive, OnDestroy } from '@angular/core';\nimport { BaseClass } from './base.class';\n\n@Directive({\n    selector: 'a-very-basic-component-base-that-should-not-be-used'\n})\nexport class BaseDirective extends BaseClass implements OnDestroy {\n    public ngOnDestroy(): void {\n        this.destroy();\n    }\n}\n\n","import { Component, OnInit, Input } from '@angular/core';\nimport { ApplicationIcon } from '../../utilities/settings.interfaces';\n\n@Component({\n    selector: 'action-icon',\n    templateUrl: './action-icon.component.html',\n    styleUrls: ['./action-icon.component.scss']\n})\nexport class ActionIconComponent implements OnInit {\n    /** Icon to display */\n    @Input() public icon: ApplicationIcon;\n    /** Whether action is being processed */\n    @Input() public loading: boolean;\n    /** State of the action */\n    @Input() public state: 'success' | 'error' | '' = '';\n\n    constructor() {}\n\n    ngOnInit(): void {}\n}\n","<div class=\"action-icon\" [class.fade]=\"state || loading\">\n    <app-icon [icon]=\"icon\"></app-icon>\n    <div class=\"'state center ' + state\" *ngIf=\"!loading && state\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: state === 'success' ? 'done' : 'close' }\"></app-icon>\n    </div>\n    <div class=\"loader center\" *ngIf=\"loading\">\n        <mat-spinner [diameter]=\"16\"></mat-spinner>\n    </div>\n</div>\n","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\n\n@Component({\n  selector: 'an-action-field',\n  templateUrl: './action-field.component.html',\n  styleUrls: ['./action-field.component.scss']\n})\nexport class ActionFieldComponent extends BaseDirective {\n    /** Name of the field */\n    @Input() public name: string;\n    /** Value to display on the field */\n    @Input() public placeholder: string;\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Emitter for user interaction events */\n    @Output('onAction') public on_action = new EventEmitter();\n    /** Whether to show tooltip */\n    public show_tooltip = false;\n\n    /**\n     * Emit that the user has performed an action on the field\n     */\n    public performAction() {\n        this.show_tooltip = !this.show_tooltip;\n        this.on_action.emit();\n    }\n}\n","<div class=\"action-field\" role=\"button\" [attr.disabled]=\"disabled\" form-field tabindex=\"0\" (keydown.enter)=\"performAction()\">\n    <div class=\"display\" (tapped)=\"performAction()\">{{ placeholder }}</div>\n    <div class=\"icon\" (tapped)=\"performAction()\">\n        <app-icon\n            [icon]=\"{\n                type: 'icon',\n                class: 'material-icons',\n                content: show_tooltip ? 'arrow_drop_up' : 'arrow_drop_down'\n            }\"\n        ></app-icon>\n    </div>\n</div>\n","import { Component, forwardRef, Input } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\n\n@Component({\n  selector: 'a-counter',\n  templateUrl: './counter.component.html',\n  styleUrls: ['./counter.component.scss'],\n  providers: [\n      {\n          provide: NG_VALUE_ACCESSOR,\n          /* istanbul ignore next */\n          useExisting: forwardRef(() => CounterComponent),\n          multi: true\n      }\n  ]\n})\nexport class CounterComponent implements ControlValueAccessor {\n    /** Size of a single step */\n    @Input() public step: number = 1;\n    /** Maximum amount for the counter */\n    @Input() public max: number = 10;\n    /** Minimum amount for the counter */\n    @Input() public min: number = 0;\n    /** Current value of the counter */\n    public value: number;\n    /** Whether shift key is being held by the user */\n    public shift_key: boolean;\n    /** Whether control key is being held by the user */\n    public ctrl_key: boolean;\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    /**\n     * Add the `step` to the current value\n     */\n    public add() {\n        if (!this.value) { this.value = this.min || 0 }\n        const step = this.ctrl_key ? 100 : this.shift_key ? 10 : this.step || 1;\n        this.value += step;\n        if (this.value > this.max) {\n            this.value = this.max || 10;\n        }\n        this.setValue(this.value);\n    }\n\n    /** Remove the `step` from the current value */\n    public remove() {\n        if (!this.value) { this.value = this.min || 0 }\n        const step = this.ctrl_key ? 100 : this.shift_key ? 10 : this.step || 1;\n        this.value -= step;\n        if (this.value < this.min) {\n            this.value = this.min || 0;\n        }\n        this.setValue(this.value);\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number): void {\n        this.value = new_value;\n        /* istanbul ignore else */\n        if (this._onChange) {\n            this._onChange(new_value);\n        }\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.value = value;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n}\n","<div\n    class=\"counter\"\n    (window:keydown.shift)=\"shift_key = true\"\n    (window:keydown.control)=\"ctrl_key = true\"\n    (window:keydown.meta)=\"ctrl_key = true\"\n    (window:keyup.shift)=\"shift_key = false\"\n    (window:keyup.control)=\"ctrl_key = false\"\n    (window:keyup.meta)=\"ctrl_key = false\"\n>\n    <button mat-icon-button name=\"remove\" [disabled]=\"!value || value === min\" (tapped)=\"remove()\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'remove' }\"></app-icon>\n    </button>\n    <div class=\"value\">\n        {{ value || '0' }}\n    </div>\n    <button mat-icon-button name=\"add\" [disabled]=\"value === max\" (tapped)=\"add()\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'add' }\"></app-icon>\n    </button>\n</div>\n","import { Component, OnInit, forwardRef, Input, ViewChild } from '@angular/core';\nimport { NG_VALUE_ACCESSOR, ControlValueAccessor } from '@angular/forms';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\n\nimport * as dayjs from 'dayjs';\nimport { MatMenuTrigger } from '@angular/material/menu';\n\n@Component({\n    selector: 'a-date-field',\n    templateUrl: './date-field.component.html',\n    styleUrls: ['./date-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DateFieldComponent),\n            multi: true\n        }\n    ]\n})\nexport class DateFieldComponent extends BaseDirective implements OnInit, ControlValueAccessor {\n    /** Earliest date available the user is allowed to pick */\n    @Input('from') public _from: number = dayjs().valueOf();\n    /** Latest date available the user is allowed to pick */\n    @Input('to') public _to: number;\n    /** Position of the tooltip */\n    @Input() public position: 'right' | 'left' = 'right';\n    /** Offset of the tooltip */\n    @Input() public offset: 'top' | 'bottom' = 'bottom';\n    /** Whether form control is disabled */\n    @Input() public disabled: boolean;\n    /** Whether to show the calendar tooltip */\n    public show_tooltip: boolean;\n    /** Currently selected date */\n    public date: number;\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    @ViewChild(MatMenuTrigger, { static: true }) private _trigger: MatMenuTrigger;\n\n    /** First allowed date on the calendar */\n    public get from(): number {\n        return this._from || dayjs().startOf('d').valueOf();\n    }\n    /** Current date value */\n    public get until(): number {\n        return this._to || dayjs().endOf('d').add(1, 'y').valueOf();\n    }\n    /** Display value for the current date */\n    public get date_string(): string {\n        return dayjs(this.date).format('DD MMM YYYY');\n    }\n\n    /** Whether date picker is open */\n    public get is_open(): boolean {\n        return this._trigger.menuOpen;\n    }\n\n    public ngOnInit() {\n        this.date = dayjs().valueOf();\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number) {\n        this.date = new_value;\n        if (this._onChange) {\n            this._onChange(new_value);\n        }\n        this.show_tooltip = false;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.date = value;\n        this.show_tooltip = false;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /** Set the state of the tooltip to closed after delay */\n    public closeDatePicker() {\n        this._trigger.closeMenu();\n    }\n\n    /** Set the state of the tooltip to closed after delay */\n    public openDatePicker() {\n        this._trigger.openMenu();\n    }\n}\n","<div\n    class=\"date-field\"\n    role=\"button\"\n    form-field\n    tabindex=\"0\"\n    [class.active]=\"is_open\"\n    [attr.disabled]=\"disabled\"\n    (keydown.enter)=\"openDatePicker()\"\n    [matMenuTriggerFor]=\"appMenu\"\n>\n    <div class=\"display\">{{ date_string }}</div>\n    <div class=\"icon\">\n        <app-icon\n            [icon]=\"{\n                type: 'icon',\n                class: 'material-icons',\n                content: is_open ? 'arrow_drop_up' : 'arrow_drop_down'\n            }\"\n        ></app-icon>\n    </div>\n</div>\n<mat-menu #appMenu=\"matMenu\">\n    <div mat-menu-item class=\"date-picker\" (click)=\"$event.stopPropagation()\">\n        <a-date-picker\n            [ngModel]=\"date\"\n            [options]=\"{ from: from, to: until }\"\n            (ngModelChange)=\"setValue($event); closeDatePicker()\"\n        ></a-date-picker>\n    </div>\n</mat-menu>\n","import { Component, OnInit, forwardRef, Input, OnChanges, SimpleChanges } from '@angular/core';\nimport { NG_VALUE_ACCESSOR, ControlValueAccessor } from '@angular/forms';\n\nimport { Identity } from 'src/app/shared/utilities/types.utilities';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { humaniseDuration } from 'src/app/shared/utilities/general.utilities';\n\nimport * as dayjs from 'dayjs';\n\n@Component({\n    selector: 'a-duration-field',\n    templateUrl: './duration-field.component.html',\n    styleUrls: ['./duration-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DurationFieldComponent),\n            multi: true\n        }\n    ]\n})\nexport class DurationFieldComponent extends BaseDirective implements OnInit, OnChanges, ControlValueAccessor {\n    /** Maximum duration option available */\n    @Input() public max: number = 240;\n    /** Minimum duration option available */\n    @Input() public min: number = 15;\n    /** Step value between options */\n    @Input() public step: number = 15;\n    /** Reference time for displaying next to durations */\n    @Input() public time: number;\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n\n    public duration: string = '60';\n    /** List of available duration options */\n    public duration_options: Identity[];\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    public ngOnInit(): void {\n        this.duration_options = this.generateDurationOptions(this.max, this.min, this.step);\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.max || changes.min || changes.step || changes.time) {\n            this.duration_options = this.generateDurationOptions(this.max, this.min, this.step);\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: string): void {\n        this.duration = new_value;\n        /* istanbul ignore else */\n        if (this._onChange) {\n            this._onChange(+new_value);\n        }\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.duration = `${value}`;\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n\n    private generateDurationOptions(max: number, min: number, step: number): Identity[] {\n        const blocks: Identity[] = [];\n        let time = min;\n        let date = this.time ? dayjs(this.time) : null;\n        while (time <= max) {\n            blocks.push({\n                id: `${time}`,\n                name: `${humaniseDuration(time)}${date ? ' (' + date.add(time, 'm').format('h:mm A') + ')': ''}`\n            });\n            time += step;\n        }\n        return blocks;\n    }\n}\n","<div class=\"duration-field\" [attr.disabled]=\"disabled\">\n    <mat-form-field appearance=\"outline\">\n        <mat-select #select [value]=\"duration\" [disabled]=\"disabled\" (valueChange)=\"setValue($event)\">\n            <mat-option *ngFor=\"let option of duration_options\" [value]=\"option.id\">\n                {{ option.name }}\n            </mat-option>\n        </mat-select>\n    </mat-form-field>\n</div>\n","import { Component, forwardRef, Input, ViewChild, OnInit, SimpleChanges, OnChanges } from '@angular/core';\nimport { NG_VALUE_ACCESSOR, ControlValueAccessor } from '@angular/forms';\nimport { MatSelect } from '@angular/material/select';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { timeFormatString } from 'src/app/shared/utilities/general.utilities';\nimport { Identity } from 'src/app/shared/utilities/types.utilities';\n\nimport * as dayjs from 'dayjs';\n\n@Component({\n    selector: 'a-time-field',\n    templateUrl: './time-field.component.html',\n    styleUrls: ['./time-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => TimeFieldComponent),\n            multi: true\n        }\n    ]\n})\nexport class TimeFieldComponent extends BaseDirective implements OnInit, OnChanges, ControlValueAccessor {\n    /** Time step between each allowed time option */\n    @Input() public step: number = 15;\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Whether past times are allowed */\n    @Input() public no_past_times: boolean = true;\n    /** String representing the currently set time */\n    public date: number = dayjs().valueOf();\n    /** String representing the currently set time */\n    public time: string = dayjs().format('HH:mm');\n    /** Available time blocks for the selected date */\n    public _time_options: Identity[];\n    /** Whether select field should be shown */\n    public show_select: boolean;\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    /** Select field for selecting the time */\n    @ViewChild('select') private select_field: MatSelect;\n\n    public ngOnInit(): void {\n        this.show_select = true;\n        this._time_options = this.generateAvailableTimes(this.date, !this.no_past_times, this.step);\n        this.timeout('hide', () => this.show_select = false);\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.no_past_times || changes.step) {\n            this._time_options = this.generateAvailableTimes(this.date, !this.no_past_times, this.step);\n        }\n    }\n\n    /** Available time blocks for the selected date */\n    public get time_options() {\n        const time = this.time.split(':');\n        const date = dayjs(this.date).hour(+time[0]).minute(+time[1]);\n        /* istanbul ignore else */\n        if (date.minute() % 15 !== 0 && !this._time_options.find(time => time.id === date.format('HH:mm'))) {\n            this._time_options.push({\n                name: `${date.format(timeFormatString())}`,\n                id: date.format('HH:mm')\n            });\n            this._time_options.sort((a, b) => `${a.id}`.localeCompare(`${b.id}`));\n        }\n        return this._time_options;\n    }\n\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: string): void {\n        this.time = new_value;\n        /* istanbul ignore else */\n        if (this._onChange) {\n            const time = this.time.split(':');\n            const date = dayjs(this.date).hour(+time[0]).minute(+time[1]).startOf('m');\n            this._onChange(date.valueOf());\n        }\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.date = value;\n        const date = dayjs(this.date).startOf('m');\n        this.time = date.format('HH:mm');\n        this._time_options = this.generateAvailableTimes(this.date, !this.no_past_times, this.step);\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n\n    /**\n     * Show select field for time options\n     */\n    public showSelect() {\n        this.show_select = true;\n        this.timeout('on_shown', () => {\n            /* istanbul ignore else */\n            if (this.select_field) {\n                this.select_field.focus();\n                this.select_field.open();\n                this.subscription('listen_close', this.select_field.openedChange.subscribe((state) => {\n                    /* istanbul ignore else */\n                    if (!state) {\n                        this.show_select = false;\n                    }\n                }));\n            }\n        })\n    }\n\n    /**\n     * Generate a list of time options for the given date\n     * @param datestamp Date to generate options for\n     * @param show_past Whether past times should be options\n     */\n    private generateAvailableTimes(datestamp: number, show_past: boolean, step: number): Identity[] {\n        const now = dayjs();\n        let date = dayjs(datestamp);\n        const blocks = [];\n        /* istanbul ignore else */\n        if (show_past || date.isAfter(now, 'd')) {\n            date = date.startOf('d');\n        }\n        date = date.minute(Math.ceil(date.minute() / step) * step);\n        const end = date.endOf('d');\n        // Add options for the rest of the day\n        while (date.isBefore(end, 'm')) {\n            blocks.push({\n                name: `${date.format(timeFormatString())}`,\n                id: date.format('HH:mm')\n            });\n            date = date.add(step, 'm');\n        }\n        return blocks;\n    }\n}\n","<div\n    class=\"time-field\"\n    role=\"button\"\n    [style.display]=\"show_select ? 'none' : ''\"\n    [attr.disabled]=\"disabled\"\n    form-field\n    tabindex=\"0\"\n    (keydown.enter)=\"showSelect()\"\n>\n    <div class=\"display\">\n        <input\n            matInput\n            type=\"time\"\n            [disabled]=\"disabled\"\n            [ngModel]=\"time\"\n            (ngModelChange)=\"setValue($event)\"\n        />\n    </div>\n    <div class=\"icon\" (tapped)=\"showSelect()\">\n        <app-icon\n            [icon]=\"{\n                type: 'icon',\n                class: 'material-icons',\n                content: show_select ? 'arrow_drop_up' : 'arrow_drop_down'\n            }\"\n        ></app-icon>\n    </div>\n</div>\n<mat-form-field appearance=\"outline\" *ngIf=\"show_select\">\n    <mat-select #select [value]=\"time\" [disabled]=\"disabled\" (valueChange)=\"setValue($event)\">\n        <mat-option *ngFor=\"let option of time_options\" [value]=\"option.id\">\n            {{ option.name }}\n        </mat-option>\n    </mat-select>\n</mat-form-field>\n","import { Component, OnInit, forwardRef, Output, EventEmitter, Input } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { Subject, Observable, of } from 'rxjs';\nimport { switchMap, debounceTime, distinctUntilChanged, map, catchError } from 'rxjs/operators';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { User } from 'src/app/services/data/users/user.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport {\n    filterList,\n    matchToHighlight,\n    downloadFile,\n    csvToJson,\n} from 'src/app/shared/utilities/general.utilities';\nimport { UsersService } from 'src/app/services/data/users/users.service';\n\n@Component({\n    selector: 'a-user-list-field',\n    templateUrl: './user-list-field.component.html',\n    styleUrls: ['./user-list-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => UserListFieldComponent),\n            multi: true,\n        },\n    ],\n})\nexport class UserListFieldComponent extends BaseDirective implements OnInit, ControlValueAccessor {\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Number of characters needed before a search will start */\n    @Input() public limit: number = 3;\n    /** Emitter for action to make a new user */\n    @Output('newUser') public new_user = new EventEmitter<void>();\n\n    /** User list to display */\n    public user_list: User[];\n    /** List of active selected users on the list */\n    public active_list: User[];\n    /** Whether user list is loading */\n    public loading: boolean;\n    /** String  */\n    public search_str: string;\n    /** List of users from an API search */\n    public search_results$: Observable<User[]>;\n    /** Subject holding the value of the search */\n    public search$ = new Subject<string>();\n\n    /** Form control on change handler */\n    private _onChange: (_: User[]) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: User[]) => void;\n\n    constructor(private _service: ApplicationService, private _users: UsersService) {\n        super();\n    }\n\n    ngOnInit() {\n        // Listen for input changes\n        this.search_results$ = this.search$.pipe(\n            debounceTime(400),\n            distinctUntilChanged(),\n            switchMap((query) => {\n                this.loading = true;\n                return query.length >= this.limit\n                    ? this._users.query({\n                          q: query.slice(0, Math.max(this.limit, 3)),\n                          cache: 60 * 1000,\n                      })\n                    : Promise.resolve([]);\n            }),\n            catchError((_) => of([])),\n            map((list: User[]) => {\n                this.loading = false;\n                return filterList(this.search_str, list, ['name', 'email']);\n            })\n        );\n        // Process API results\n        this.subscription(\n            'search_results',\n            this.search_results$.subscribe((list) => {\n                this.user_list = list;\n                this.user_list.forEach((i: any) => {\n                    i.match_name = matchToHighlight(i.match_name);\n                    i.match_email = matchToHighlight(i.match_email);\n                    return i;\n                });\n            })\n        );\n    }\n\n    /**\n     * Add user to the user list\n     * @param user\n     */\n    public addUser(user: User) {\n        /* istanbul ignore else */\n        if (!this.active_list) {\n            this.active_list = [];\n        }\n        const index = this.active_list.findIndex((a_user) => a_user.id === user.id);\n        /* istanbul ignore else */\n        if (index < 0) {\n            this.active_list = [...this.active_list, user];\n        }\n        this.setValue(this.active_list);\n        this.search_str = '';\n    }\n\n    /**\n     * Remove user from the user list\n     * @param user\n     */\n    public removeUser(user: User) {\n        this.active_list = this.active_list.filter((a_user) => a_user.id !== user.id);\n        this.setValue(this.active_list);\n    }\n\n    /**\n     * Load CSV file and populate the user list with the contents\n     * @param event File input field event\n     */\n    public addUsersFromFile(event) {\n        /* istanbul ignore else */\n        if (event.target) {\n            const file = event.target.files[0];\n            /* istanbul ignore else */\n            if (file) {\n                const reader = new FileReader();\n                reader.readAsText(file, 'UTF-8');\n                reader.addEventListener('load', (evt) => {\n                    this.processCsvData((evt.srcElement as any).result);\n                    event.target.value = '';\n                });\n                reader.addEventListener('error', (_) =>\n                    this._service.notifyError('Error reading file.')\n                );\n            }\n        }\n    }\n\n    /**\n     * Process raw CSV data and save user data to attendee list\n     * @param data CSV data\n     */\n    private processCsvData(data: string) {\n        const list = csvToJson(data) || [];\n        const id = this._users.current.staff_code;\n        list.forEach((el) => {\n            el.name = el.name || `${el.first_name} ${el.last_name}`;\n            const display = (el.name || `${Math.floor(Math.random() * 9999_9999)}`)\n                .split(' ')\n                .join('_')\n                .toLowerCase();\n            /* istanbul ignore else */\n            if (!el.email) {\n                el.email = `${display}+${id}@guest.mckinsey.com`;\n            }\n            el.type = 'external';\n            this.addUser(new User(el));\n        });\n    }\n\n    /* istanbul ignore next */\n    /** Download template CSV file */\n    public downloadCSVTemplate() {\n        const template = `Organisation Name,First Name,Last Name,Email,Phone\\nFake Org,John,Smith,john.smith@example.com,01234567898`;\n        downloadFile('template.csv', template);\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: User[]): void {\n        this.active_list = new_value;\n        if (this._onChange) {\n            this._onChange(new_value);\n        }\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: User[]) {\n        this.active_list = value;\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: User[]) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: User[]) => void): void {\n        this._onTouch = fn;\n    }\n}\n","<div class=\"user-list-field\" form-field [attr.disabled]=\"disabled\">\n    <mat-form-field appearance=\"outline\">\n        <input\n            matInput\n            name=\"user-search\"\n            [(ngModel)]=\"search_str\"\n            (ngModelChange)=\"search$.next($event)\"\n            [disabled]=\"disabled\"\n            placeholder=\"Search for user...\"\n            i18n-placeholder\n            [matAutocomplete]=\"auto\"\n        />\n        <div class=\"prefix\" matPrefix>\n            <app-icon\n                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'search' }\"\n            ></app-icon>\n        </div>\n        <div class=\"suffix\" matSuffix *ngIf=\"loading\">\n            <mat-spinner diameter=\"16\"></mat-spinner>\n        </div>\n    </mat-form-field>\n    <mat-autocomplete #auto=\"matAutocomplete\" (optionSelected)=\"addUser($event.option.value)\">\n        <mat-option *ngFor=\"let option of user_list\" [value]=\"option\">\n            <div class=\"name\">{{ option.name }}</div>\n            <div class=\"email\">{{ option.email }}</div>\n        </mat-option>\n    </mat-autocomplete>\n    <div class=\"actions\">\n        <button type=\"button\" name=\"new-contact\" matRipple (tapped)=\"new_user.emit()\" i18n=\"Add new external attendee\">\n            New Contact\n        </button>\n        <button type=\"button\" name=\"upload-csv\" matRipple i18n=\"Upload attendee list from CSV file\">\n            Upload CSV\n            <input type=\"file\" (change)=\"addUsersFromFile($event)\" />\n        </button>\n        <button type=\"button\" name=\"download-template\" matRipple (tapped)=\"downloadCSVTemplate()\" i18n=\"Download template CSV file\">\n            CSV Template\n        </button>\n    </div>\n    <div class=\"user-list\">\n        <mat-chip-list\n            aria-label=\"User List\"\n            *ngIf=\"active_list && active_list.length; else empty_state\"\n        >\n            <mat-chip\n                *ngFor=\"let user of active_list\"\n                [id]=\"user.email\"\n                [color]=\"user.external ? 'accent' : 'primary'\"\n                [removable]=\"true\"\n                (removed)=\"removeUser(user)\"\n            >\n                {{ user.name }}\n                <app-icon\n                    matChipRemove\n                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"\n                ></app-icon>\n            </mat-chip>\n        </mat-chip-list>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div i18n=\"Attendee empty state\">No attendees</div>\n</ng-template>\n","import { Component, OnInit, forwardRef, Input } from '@angular/core';\nimport { NG_VALUE_ACCESSOR, ControlValueAccessor } from '@angular/forms';\nimport { Subject, Observable, of } from 'rxjs';\nimport { switchMap, debounceTime, distinctUntilChanged, map, catchError } from 'rxjs/operators';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { User } from 'src/app/services/data/users/user.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { filterList, matchToHighlight } from 'src/app/shared/utilities/general.utilities';\nimport { UsersService } from 'src/app/services/data/users/users.service';\n\n@Component({\n    selector: 'a-user-search-field',\n    templateUrl: './user-search-field.component.html',\n    styleUrls: ['./user-search-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => UserSearchFieldComponent),\n            multi: true\n        }\n    ]\n})\nexport class UserSearchFieldComponent extends BaseDirective implements OnInit, ControlValueAccessor {\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Limit available options to these */\n    @Input() public options: User[];\n    /** Currently selected user */\n    public active_user: User;\n    /** User list to display */\n    public user_list: User[];\n    /** Whether user list is loading */\n    public loading: boolean;\n    /** Current display value of the search input field  */\n    public search_str: string;\n    /** List of users from an API search */\n    public search_results$: Observable<User[]>;\n    /** Subject holding the value of the search */\n    public search$ = new Subject<string>();\n\n    /** Form control on change handler */\n    private _onChange: (_: User) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: User) => void;\n\n    constructor(private _users: UsersService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n\n        // Listen for input changes\n        this.search_results$ = this.search$.pipe(\n            debounceTime(400),\n            distinctUntilChanged(),\n            switchMap(query => {\n                this.loading = true;\n                return this.options && this.options.length > 0\n                    ? Promise.resolve(this.options)\n                    : query.length >= 3\n                        ? (this._users.query({ q: query.slice(0, 3), cache: 60 * 1000 }) as Promise<User[]>)\n                        : Promise.resolve([]);\n            }),\n            catchError((err) => of([])),\n            map((list: User[]) => {\n                this.loading = false;\n                return filterList(this.search_str, list, ['name', 'email']);\n            })\n        );\n        // Process API results\n        this.subscription('search_results', this.search_results$.subscribe(list => {\n            this.user_list = list;\n            this.user_list.forEach((i: any) => {\n                i.match_name = matchToHighlight(i.match_name);\n                i.match_email = matchToHighlight(i.match_email);\n                return i;\n            });\n        }));\n    }\n\n    /**\n     * Reset the search string back to the name of the active user\n     */\n    public resetSearchString() {\n        if (this.active_user) {\n            this.search_str = this.active_user.name;\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: User): void {\n        this.active_user = new_value;\n        if (this._onChange) {\n            this._onChange(new_value);\n        }\n        this.resetSearchString();\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: User) {\n        this.active_user = value;\n        this.resetSearchString();\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: User) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: User) => void): void {\n        this._onTouch = fn;\n    }\n}\n","<div class=\"user-search-field\" form-field>\n    <mat-form-field appearance=\"outline\">\n        <input\n            matInput\n            name=\"user-search\"\n            [(ngModel)]=\"search_str\"\n            (ngModelChange)=\"search$.next($event)\"\n            [disabled]=\"disabled\"\n            placeholder=\"Search for user...\"\n            i18n-placeholder\n            [matAutocomplete]=\"auto\"\n            (blur)=\"resetSearchString()\"\n        />\n        <div class=\"prefix\" matPrefix>\n            <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'search' }\"></app-icon>\n        </div>\n        <div class=\"suffix\" matSuffix *ngIf=\"loading\">\n            <mat-spinner diameter=\"16\"></mat-spinner>\n        </div>\n    </mat-form-field>\n    <mat-autocomplete #auto=\"matAutocomplete\" (optionSelected)=\"setValue($event.option.value)\">\n        <mat-option *ngFor=\"let option of user_list\" [value]=\"option\">\n            <div class=\"name\">{{ option.name }}</div>\n            <div class=\"email\">{{ option.email }}</div>\n        </mat-option>\n    </mat-autocomplete>\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { NavigationEnd, Router } from '@angular/router';\n\nimport { BaseDirective } from '../../base.directive';\n\n@Component({\n    selector: 'feedback',\n    templateUrl: './feedback.component.html',\n    styleUrls: ['./feedback.component.scss'],\n})\nexport class FeedbackComponent extends BaseDirective implements OnInit {\n    /** Name of the currently active page */\n    public current_page: string;\n\n    constructor(private _router: Router) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.timeout('Getting Title', () => this.updateRoute(document.title));\n        this._router.events.subscribe((event: NavigationEnd) => {\n            /* istanbul ignore else */\n            if (event instanceof NavigationEnd) {\n                this.timeout('Getting Title', () => this.updateRoute(document.title));\n            }\n        });\n    }\n\n    public updateRoute(location) {\n        location = location.substr(0, location.indexOf(' |'));\n        this.current_page = location;\n    }\n}\n","<a [href]=\"'mailto:converge_feedback@mckinsey.com?subject=Feedback for page: ' + current_page\">\n    <div class=\"feedback-button\">\n        <span class=\"text\" i18n>Feedback</span>\n        <span class=\"icon\">\n            <app-icon [icon]=\"{class:'material-icons', content: 'feedback'}\"></app-icon>\n        </span>\n    </div>\n</a>\n","import { Component, Input } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport { MatDialog } from '@angular/material/dialog';\nimport { first } from 'rxjs/operators';\n\nimport { BaseDirective } from '../../../base.directive';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { NewUserModalComponent } from 'src/app/overlays/new-user-modal/new-user-modal.component';\nimport { unique } from 'src/app/shared/utilities/general.utilities';\nimport { Identity } from 'src/app/shared/utilities/types.utilities';\nimport { User } from 'src/app/services/data/users/user.class';\nimport {\n    SpaceSelectModalComponent,\n    SpaceSelectModalData,\n} from 'src/app/overlays/space-select-modal/space-select-modal.component';\nimport {\n    RecurrenceModalData,\n    RecurrenceModalComponent,\n} from 'src/app/overlays/recurrence-modal/recurrence-modal.component';\nimport { UsersService } from 'src/app/services/data/users/users.service';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\n\nimport * as dayjs from 'dayjs';\n\n@Component({\n    selector: 'a-booking-form',\n    templateUrl: './booking-form.component.html',\n    styleUrls: ['./booking-form.component.scss'],\n})\nexport class BookingFormComponent extends BaseDirective {\n    /** Form fields for booking */\n    @Input() public form: FormGroup;\n    /** List of available users to host bookings */\n    public user_list: User[] = [];\n\n    constructor(\n        private _service: ApplicationService,\n        private _users: UsersService,\n        private _dialog: MatDialog\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._users.initialised.pipe(first((_) => _)).subscribe(() => {\n            const user: User = this._users.current;\n            const delegates = user.delegates.map(\n                (email) => this._users.find(email) || new User({ email, name: email.split('@')[0] })\n            );\n            this.user_list = [user].concat(delegates);\n        });\n    }\n\n    /** Display string for the recurrence value of the booking */\n    public get recurrence(): string {\n        const recurrence = this.form.controls.recurrence\n            ? this.form.controls.recurrence.value\n            : null;\n        const periods = ['None', 'Daily', 'Weekly', 'Biweekly', 'Monthly'];\n        if (!recurrence || !recurrence.period || (recurrence.period as any) >= periods.length) {\n            return 'No recurrence';\n        }\n        const period =\n            typeof recurrence.period === 'string' ? recurrence.period : periods[recurrence.period];\n        const end = recurrence.end\n            ? `until ${dayjs(recurrence.end).format('DD MMM YYYY')}`\n            : 'forever';\n        return `${period} ${end}`;\n    }\n\n    /** Whether notes and description should use the HTML editor */\n    public get use_html(): boolean {\n        return this._service.setting('app.booking.html_body') || false;\n    }\n\n    /** List of available types for bookings */\n    public get booking_types(): Identity[] {\n        return this._service.setting('app.booking.booking_types') || [];\n    }\n\n    /** Display string for the list of active spaces */\n    public get spaces(): string {\n        const spaces = this.form.controls.space_list.value;\n        return spaces.length === 1\n            ? spaces[0].name\n            : spaces.length > 1\n            ? `${spaces.length} spaces selected`\n            : 'No Spaces selected';\n    }\n\n    /**\n     * Open modal to change the space details for the booking\n     */\n    public openSpacesModal(): void {\n        const ref = this._dialog.open<SpaceSelectModalComponent, SpaceSelectModalData>(\n            SpaceSelectModalComponent,\n            {\n                width: 'auto',\n                height: 'auto',\n                maxWidth: '95vw',\n                data: {\n                    spaces: this.form.controls.space_list.value,\n                    date: this.form.controls.date.value,\n                    duration: this.form.controls.duration.value,\n                    host: this.form.controls.organiser.value,\n                    multiple: true,\n                },\n            }\n        );\n        this.subscription(\n            'new_spaces',\n            ref.componentInstance.event.subscribe((event) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    let space_list = this.form.controls.space_list.value;\n                    space_list = event.metadata;\n                    this.form.controls.space_list.setValue(unique(space_list, 'id'));\n                    ref.close();\n                    this.unsub('new_spaces');\n                }\n            })\n        );\n    }\n\n    /**\n     * Open modal to change the recurrence details for the booking\n     */\n    public openRecurrenceModal() {\n        const ref = this._dialog.open<RecurrenceModalComponent, RecurrenceModalData>(\n            RecurrenceModalComponent,\n            {\n                width: 'auto',\n                height: 'auto',\n                maxWidth: '95vw',\n                data: {\n                    details: this.form.controls.recurrence.value,\n                    date: this.form.controls.date.value,\n                },\n            }\n        );\n        this.subscription(\n            'recurrence',\n            ref.componentInstance.event.subscribe((event) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    this.form.controls.recurrence.setValue(\n                        event.metadata && event.metadata.period !== 'none' ? event.metadata : {}\n                    );\n                    ref.close();\n                    this.unsub('recurrence');\n                }\n            })\n        );\n    }\n\n    /**\n     * Open modal to change the recurrence details for the booking\n     */\n    public openNewUserModal() {\n        const ref = this._dialog.open<NewUserModalComponent>(NewUserModalComponent, {\n            width: 'auto',\n            height: 'auto',\n        });\n        this.subscription(\n            'new_user',\n            ref.componentInstance.event.subscribe((event) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    const attendees = this.form.controls.attendees.value;\n                    attendees.push(event.metadata);\n                    this.form.controls.attendees.setValue(unique(attendees, 'email'));\n                    ref.close();\n                    this.unsub('new_user');\n                }\n            })\n        );\n    }\n}\n","<div class=\"booking-form\" *ngIf=\"form\" [formGroup]=\"form\">\n    <div\n        class=\"field\"\n        *ngIf=\"form.controls.id && form.controls.id.value && form.controls.space_list\"\n    >\n        <label for=\"spaces\" i18n=\"Booking form spaces label\">Spaces: </label>\n        <an-action-field\n            name=\"spaces\"\n            [placeholder]=\"spaces\"\n            (onAction)=\"openSpacesModal()\"\n        ></an-action-field>\n    </div>\n    <div class=\"field\" *ngIf=\"form.controls.title\">\n        <label\n            for=\"title\"\n            [class.error]=\"form.controls.title.invalid && form.controls.title.touched\"\n            i18n=\"Booking form title label\"\n        >\n            Title<span>*</span>:\n        </label>\n        <mat-form-field appearance=\"outline\">\n            <input matInput name=\"title\" placeholder=\"Meeting Title\" i18n-placeholder formControlName=\"title\" />\n\n            <mat-error *ngIf=\"form.controls.title.invalid\" i18n=\"Booking form title error\"\n                >Title is required</mat-error\n            >\n        </mat-form-field>\n    </div>\n    <div class=\"group date\">\n        <div class=\"field\" *ngIf=\"form.controls.date\">\n            <label for=\"date\" i18n=\"Booking form date label\">Date: </label>\n            <a-date-field name=\"date\" formControlName=\"date\"></a-date-field>\n        </div>\n        <div class=\"field\" *ngIf=\"form.controls.recurrence\">\n            <label for=\"recurrence\" i18n=\"Booking form recurrence label\">Recurrence: </label>\n            <an-action-field\n                name=\"recurrence\"\n                [placeholder]=\"recurrence\"\n                (onAction)=\"openRecurrenceModal()\"\n            ></an-action-field>\n        </div>\n    </div>\n    <div class=\"group time\">\n        <div class=\"field\" *ngIf=\"form.controls.date\">\n            <label for=\"start-time\" i18n=\"Booking form start time label\">Start Time: </label>\n            <a-time-field\n                name=\"start-time\"\n                [disabled]=\"form.controls.all_day?.value\"\n                formControlName=\"date\"\n            ></a-time-field>\n            <div class=\"error info\" *ngIf=\"form.controls.date.touched && form.controls.date.invalid\">\n                Date and time must be in the future\n            </div>\n        </div>\n        <div class=\"field\" *ngIf=\"form.controls.duration\">\n            <div class=\"label-group\">\n                <label for=\"duration\" i18n=\"Booking form duration label\">Duration: </label>\n                <mat-checkbox\n                    formControlName=\"all_day\"\n                    *ngIf=\"form.controls.all_day\"\n                    i18n=\"Booking form all day label\"\n                    >All day booking</mat-checkbox\n                >\n            </div>\n            <a-duration-field\n                name=\"duration\"\n                [max]=\"720\"\n                [disabled]=\"form.controls.all_day?.value\"\n                [time]=\"form.controls.date?.value\"\n                formControlName=\"duration\"\n            ></a-duration-field>\n            <div class=\"error info\" *ngIf=\"form.controls.duration.touched && form.controls.duration.invalid\">\n                Duration is invalid. End time must be in the future\n            </div>\n        </div>\n    </div>\n    <div class=\"field\" *ngIf=\"form.controls.organiser\">\n        <label for=\"organiser\" i18n=\"Booking form organiser label\">Host: </label>\n        <mat-form-field appearance=\"outline\">\n            <mat-select\n                name=\"organiser\"\n                formControlName=\"organiser\"\n                [placeholder]=\"form.controls.organiser.value.name || form.controls.organiser.value.email\"\n            >\n                <mat-option *ngFor=\"let user of user_list\" [value]=\"user\">\n                    {{ user.name || user.email }}\n                </mat-option>\n            </mat-select>\n        </mat-form-field>\n    </div>\n    <div class=\"field\" *ngIf=\"form.controls.attendees\">\n        <label for=\"attendees\" i18n=\"Booking form attendees label\">Attendees: </label>\n        <a-user-list-field\n            name=\"attendees\"\n            formControlName=\"attendees\"\n            (newUser)=\"openNewUserModal()\"\n        ></a-user-list-field>\n    </div>\n    <div class=\"field\" *ngIf=\"form.controls.type && booking_types.length > 1\">\n        <label for=\"booking-type\" i18n=\"Booking form booking type label\">Booking Type: </label>\n        <mat-form-field appearance=\"outline\">\n            <mat-select name=\"booking-type\" formControlName=\"type\">\n                <mat-option *ngFor=\"let type of booking_types\" [value]=\"type.id\">\n                    {{ type.name }}\n                </mat-option>\n            </mat-select>\n        </mat-form-field>\n    </div>\n    <div class=\"field\" *ngIf=\"form.controls.has_catering\">\n        <mat-checkbox\n            formControlName=\"has_catering\"\n            i18n=\"Booking form need catering label\"\n        >\n            Need catering?\n        </mat-checkbox>\n    </div>\n    <div class=\"field\" *ngIf=\"form.controls.body\">\n        <label for=\"body\" i18n=\"Booking form notes label\">Notes: </label>\n        <mat-form-field name=\"body\" appearance=\"outline\" *ngIf=\"!use_html; else html_editor\">\n            <textarea\n                matInput\n                name=\"description\"\n                placeholder=\"Meeting Description\"\n                i18n-placeholder\n                formControlName=\"body\"\n            ></textarea>\n        </mat-form-field>\n        <ng-template #html_editor>\n            <editor formControlName=\"body\"></editor>\n        </ng-template>\n    </div>\n</div>\n","import { Component, Input } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\n\n@Component({\n  selector: 'user-form',\n  templateUrl: './user-form.component.html',\n  styleUrls: ['./user-form.component.scss']\n})\nexport class UserFormComponent {\n    /** Group of form fields used for creating the system */\n    @Input() public form: FormGroup;\n}\n","<div class=\"user form\" *ngIf=\"form\">\n    <form [formGroup]=\"form\">\n        <div class=\"field\" *ngIf=\"form.controls.name\">\n            <label\n                for=\"first-name\"\n                [class.error]=\"form.controls.name.invalid && form.controls.name.touched\"\n                i18n=\"User form first name label\"\n                >First Name:</label\n            >\n            <mat-form-field appearance=\"outline\">\n                <input\n                    matInput\n                    name=\"first-name\"\n                    placeholder=\"First name\"\n                    i18n-placeholder\n                    formControlName=\"first_name\"\n                />\n                <mat-error i18n=\"User form first name error\">First name is required</mat-error>\n            </mat-form-field>\n        </div>\n        <div class=\"field\" *ngIf=\"form.controls.name\">\n            <label\n                for=\"system-name\"\n                [class.error]=\"form.controls.name.invalid && form.controls.name.touched\"\n                i18n=\"User form last name label\"\n                >Last Name:</label\n            >\n            <mat-form-field appearance=\"outline\">\n                <input\n                    matInput\n                    name=\"last-name\"\n                    placeholder=\"Last name\"\n                    i18n-placeholder\n                    formControlName=\"last_name\"\n                />\n                <mat-error i18n=\"User form last name error\">Last name is required</mat-error>\n            </mat-form-field>\n        </div>\n        <div class=\"field\" *ngIf=\"form.controls.email\">\n            <label\n                for=\"email\"\n                [class.error]=\"form.controls.email.invalid && form.controls.email.touched\"\n                i18n=\"User form email label\"\n                >Email<span>*</span>:</label\n            >\n            <mat-form-field appearance=\"outline\">\n                <input matInput name=\"email\" placeholder=\"Email Address\" i18n-placeholder formControlName=\"email\" />\n                <mat-error i18n=\"User form email error\">A valid email is required</mat-error>\n            </mat-form-field>\n        </div>\n    </form>\n</div>\n","import { Component, Input } from '@angular/core';\nimport { ApplicationIcon } from '../../utilities/settings.interfaces';\nimport { BaseDirective } from '../../base.directive';\n\n@Component({\n    selector: 'app-icon',\n    templateUrl: './icon.component.html',\n    styleUrls: ['./icon.component.scss']\n})\nexport class IconComponent extends BaseDirective {\n    @Input() public icon: ApplicationIcon;\n}\n","<div class=\"app-icon\" *ngIf=\"icon\">\n    <i *ngIf=\"icon.type !== 'img'\" [class]=\"icon.class\">{{ icon.content }}</i>\n    <img *ngIf=\"icon.type === 'img'\" [src]=\"icon.src | safe:'resource'\" />\n</div>","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { first } from 'rxjs/operators';\n\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { BaseDirective } from '../../base.directive';\nimport { ApplicationIcon } from '../../utilities/settings.interfaces';\nimport { UsersService } from 'src/app/services/data/users/users.service';\n\n@Component({\n    selector: 'app-login',\n    templateUrl: './login.component.html',\n    styleUrls: ['./login.component.scss'],\n})\nexport class LoginComponent extends BaseDirective implements OnInit {\n    /** Logo of the application organisation */\n    public logo: ApplicationIcon;\n    /** Whether the user credentials are being checked */\n    public loading: boolean;\n    /** Form fields for the login form */\n    public form: FormGroup;\n\n    /** Password field element */\n    @ViewChild('pass_field', { static: true }) private pwd_field: ElementRef<HTMLInputElement>;\n\n    constructor(private _service: ApplicationService, private _users: UsersService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.loading = true;\n        this.form = new FormGroup({\n            username: new FormControl('', [Validators.required]),\n            password: new FormControl('', [Validators.required]),\n        });\n        this._service.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.loading = false;\n            this.logo = this._service.setting('app.logo_light') || { type: 'icon' };\n        });\n    }\n\n    /** Perform user login */\n    public login() {\n        this.loading = true;\n        const form = this.form.value;\n        this._users\n            .login(\n                {\n                    username: form.username,\n                    password: form.password,\n                },\n                { form: true }\n            )\n            .then(\n                () => this.loading = false,\n                () => {\n                    this.loading = false;\n                    this.form.controls.password.setErrors({ check: true });\n                }\n            );\n    }\n}\n","<div class=\"login\">\n    <div class=\"login-form\">\n        <form [formGroup]=\"form\">\n            <div class=\"header\" [style.background-color]=\"logo?.background\">\n                <div class=\"logo\">\n                    <i *ngIf=\"logo?.type === 'icon'\" [class]=\"logo.class\">{{ logo.content }}</i>\n                    <img *ngIf=\"logo?.type === 'img'\" [src]=\"logo.src | safe: 'resource'\" />\n                </div>\n            </div>\n            <div class=\"body\">\n                <ng-container *ngIf=\"!loading; else loading_state\">\n                    <div class=\"field\">\n                        <label\n                            for=\"username\"\n                            [class.error]=\"\n                                form.controls.username.invalid && form.controls.username.touched\n                            \"\n                            i18n=\"Login form username label\"\n                        >\n                            Username:\n                        </label>\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                matInput\n                                name=\"username\"\n                                placeholder=\"Username/Email\"\n                                i18n-placeholder\n                                formControlName=\"username\"\n                            />\n                            <mat-error i18n=\"Login form username error\"\n                                >Username is required</mat-error\n                            >\n                        </mat-form-field>\n                    </div>\n                    <div class=\"field\">\n                        <label\n                            for=\"password\"\n                            [class.error]=\"\n                                form.controls.password.invalid && form.controls.password.touched\n                            \"\n                            i18n=\"Login form password label\"\n                        >\n                            Password:\n                        </label>\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                matInput\n                                name=\"password\"\n                                placeholder=\"Password\"\n                                i18n-placeholder\n                                formControlName=\"password\"\n                                (keyup.enter)=\"login()\"\n                            />\n                            <mat-error i18n=\"Login form password error\"\n                                >Invalid username or password</mat-error\n                            >\n                        </mat-form-field>\n                    </div>\n                </ng-container>\n            </div>\n            <div class=\"footer\" *ngIf=\"!loading\">\n                <button mat-button (tapped)=\"login()\" i18n=\"Login action\">Login</button>\n            </div>\n        </form>\n    </div>\n</div>\n<ng-template #loading_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <mat-spinner diameter=\"64\"></mat-spinner>\n        </div>\n        <div class=\"text\" i18n=\"Checking login status\">Checking user credentials...</div>\n    </div>\n</ng-template>\n","import { Component, OnInit, Input, ContentChildren, Output, EventEmitter } from '@angular/core';\nimport { ApplicationIcon } from '../../utilities/settings.interfaces';\nimport { BaseDirective } from '../../base.directive';\n\nexport interface PopoutAction extends ApplicationIcon {\n    /** ID of the action */\n    id: string;\n}\n\n@Component({\n    selector: 'a-popout-menu',\n    templateUrl: './popout-menu.component.html',\n    styleUrls: ['./popout-menu.component.scss']\n})\nexport class PopoutMenuComponent extends BaseDirective {\n    /** List of available actions */\n    @Input() public actions: PopoutAction[] = [];\n    /** Emitter for user actions */\n    @Output() public action = new EventEmitter<string>();\n    /** Whether actions should show */\n    public show: boolean;\n\n    public close() {\n        this.timeout('close', () => {\n            this.show = false;\n        });\n    }\n}\n","<button\n    mat-icon-button\n    [class.small]=\"true\"\n    name=\"action\"\n    *ngFor=\"let item of actions; let i = index\"\n    [style.top]=\"show ? (-110 * i - 60) + '%' : ''\"\n    (tapped)=\"action.emit(item.id); show = false\"\n>\n    <app-icon [icon]=\"item\"></app-icon>\n</button>\n<button mat-icon-button name=\"menu\" [class.show]=\"show\" (tapped)=\"show = !show\" (window:click)=\"show ? close() : ''\">\n    <app-icon [icon]=\"{ class: 'material-icons', content: show ? 'add' : 'more_vert' }\"></app-icon>\n</button>\n","import { Component, OnInit, Input, EventEmitter, Output, ViewChild, ElementRef, SimpleChanges, OnChanges } from '@angular/core';\nimport { BaseDirective } from '../../base.directive';\n\n@Component({\n    selector: 'a-searchbar',\n    templateUrl: './searchbar.component.html',\n    styleUrls: ['./searchbar.component.scss']\n})\nexport class SearchbarComponent extends BaseDirective implements OnChanges {\n    /** Current contents of the searchbar input */\n    @Input('value') public value: string;\n    /** Current contents of the searchbar input */\n    @Input() public placeholder: string;\n    /** Whether external changes are being processed */\n    @Input() public loading: boolean;\n    /** Whether external changes are being processed */\n    @Input() public autofocus: boolean;\n    /** Emitter for changes to the searchbar value */\n    @Output() public valueChange = new EventEmitter<string>();\n    /** Input field reference */\n    @ViewChild('input', { static: true }) private input_field: ElementRef<HTMLInputElement>;\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.autofocus && this.autofocus) {\n            this.focusField()\n        }\n    }\n\n    public focusField() {\n        /* istanbul ignore else */\n        if (this.input_field && this.input_field.nativeElement) {\n            this.input_field.nativeElement.focus();\n        }\n    }\n}\n","<div class=\"searchbar\" tabindex=\"0\" (focus)=\"focusField()\" (click)=\"focusField()\">\n    <div class=\"prefix\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'search' }\"></app-icon>\n    </div>\n    <div class=\"input\">\n        <input #input\n            type=\"text\"\n            [(ngModel)]=\"value\"\n            (ngModelChange)=\"valueChange.emit($event)\"\n            [placeholder]=\"placeholder || 'Search...'\"\n            i18n-placeholder\n        />\n    </div>\n    <div class=\"suffix\" *ngIf=\"loading\">\n        <mat-spinner diameter=\"32\"></mat-spinner>\n    </div>\n</div>\n","import { Component, OnInit } from '@angular/core';\n\nimport { Building } from 'src/app/services/data/organisation/building.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { ApplicationLinkInternal, ApplicationIcon } from '../../utilities/settings.interfaces';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\n\n@Component({\n    selector: 'a-sidebar',\n    templateUrl: './sidebar.component.html',\n    styleUrls: ['./sidebar.component.scss']\n})\nexport class SidebarComponent implements OnInit {\n\n    /** Currently active building */\n    public get active_building(): Building {\n        return this._org.building;\n    }\n    public set active_building(building: Building) {\n        this._org.building = building;\n    }\n\n    /** List of available menu items */\n    public get menu_items(): ApplicationLinkInternal[] {\n        return this._service.setting('app.general.menu.items') || [];\n    }\n\n    /** Logo for the application organisation */\n    public get logo(): ApplicationIcon {\n        return this._service.setting('app.logo_light');\n    }\n\n    /** List of available buildings */\n    public get buildings(): Building[] {\n        return this._org.buildings || [];\n    }\n\n    constructor(private _service: ApplicationService, private _org: OrganisationService) {}\n\n    ngOnInit(): void {}\n}\n","<div class=\"logo\">\n    <i *ngIf=\"logo?.type === 'icon'\" [class]=\"logo.class\">{{ logo.content }}</i>\n    <img *ngIf=\"logo?.type === 'img'\" [src]=\"logo.src | safe: 'resource'\" />\n</div>\n<div class=\"menu\">\n    <a\n        mat-button\n        class=\"item\"\n        *ngFor=\"let item of menu_items\"\n        [routerLink]=\"[item.route]\"\n        routerLinkActive=\"active\"\n    >\n        <div class=\"content\">\n            <div class=\"bar\"></div>\n            <div class=\"icon\">\n                <app-icon [icon]=\"item.icon\"></app-icon>\n            </div>\n            <div class=\"text\">{{ item.name }}</div>\n        </div>\n    </a>\n</div>\n<div class=\"building dark-mode\" *ngIf=\"buildings && buildings.length > 1\">\n    <mat-form-field appearance=\"outline\">\n        <mat-select [(ngModel)]=\"active_building\">\n            <mat-option *ngFor=\"let building of buildings\" [value]=\"building\">\n                {{ building.name }}\n            </mat-option>\n        </mat-select>\n    </mat-form-field>\n</div>\n","import { Component, OnInit, Input, Output, EventEmitter, ViewChild, ChangeDetectorRef } from '@angular/core';\nimport { MatMenuTrigger } from '@angular/material/menu';\nimport { first } from 'rxjs/operators';\n\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { BaseDirective } from '../../base.directive';\n\nimport * as dayjs from 'dayjs';\n\n@Component({\n    selector: 'a-topbar-header',\n    templateUrl: './topbar-header.component.html',\n    styleUrls: ['./topbar-header.component.scss']\n})\nexport class TopbarHeaderComponent extends BaseDirective implements OnInit {\n    /** Currently selected date */\n    @Input() public date: number;\n    /** Whether to show the events for the active month */\n    @Input() public show_events: boolean = false;\n    /** Emiiter for changes selected date */\n    @Output() public dateChange = new EventEmitter<number>();\n    /** Counters of the events on given dates. Key format is `YYYY-MM-DD` */\n    public event_map: { [date: string]: number };\n\n    @ViewChild(MatMenuTrigger, { static: true }) trigger: MatMenuTrigger;\n\n    /** Display string for the currently selected date */\n    public get date_display(): string {\n        const date = dayjs(this.date);\n        return !date.isSame(dayjs(), 'd') ? date.format('DD MMM YYYY') : '';\n    }\n\n    constructor(private _service: ApplicationService, private _cdr: ChangeDetectorRef) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._service.initialised.pipe(first(_ => _)).subscribe(() => {\n            const date = +(localStorage.getItem('CONCIERGE.date'));\n            /* istanbul ignore else */\n            if (date && date !== this.date) {\n                this.timeout('init', () => {\n                    this.date = date;\n                    this.dateChange.emit(this.date);\n                }, 10)\n            }\n            this.subscription('events', this._service.listen('CONCIERGE.pending_bookings').subscribe((value) => {\n                this.event_map = { ...value } || {};\n                this._cdr.detectChanges();\n            }));\n        });\n    }\n\n    /** Change the selected date */\n    public changeDate(value: number) {\n        let date = dayjs(this.date).startOf('d');\n        date = date.add(value, 'd');\n        this.date = date.valueOf();\n        this.dateChange.emit(this.date);\n        localStorage.setItem('CONCIERGE.date', `${this.date}`);\n    }\n\n    /** Reset date to the current date */\n    public resetDate() {\n        this.date = dayjs().startOf('d').valueOf();\n        this.dateChange.emit(this.date);\n        localStorage.setItem('CONCIERGE.date', `${this.date}`);\n    }\n\n    public closeDatePicker() {\n        this.trigger.closeMenu();\n    }\n}\n","<div class=\"topbar-header\">\n    <div class=\"content\">\n        <ng-content></ng-content>\n    </div>\n    <div class=\"date\">\n        <div class=\"picker\">\n            <button mat-icon-button name=\"previous\" (tapped)=\"changeDate(-1)\">\n                <app-icon\n                    [icon]=\"{ class: 'material-icons', content: 'keyboard_arrow_left' }\"\n                ></app-icon>\n            </button>\n            <div class=\"text\" (dblclick)=\"resetDate()\">{{ date_display || 'Today' }}</div>\n            <button mat-icon-button name=\"next\" (tapped)=\"changeDate(1)\">\n                <app-icon\n                    [icon]=\"{ class: 'material-icons', content: 'keyboard_arrow_right' }\"\n                ></app-icon>\n            </button>\n        </div>\n        <button class=\"calendar\" mat-icon-button [matMenuTriggerFor]=\"appMenu\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'today' }\"></app-icon>\n        </button>\n    </div>\n</div>\n<mat-menu #appMenu=\"matMenu\" [class.dark-mode]=\"true\">\n    <div mat-menu-item class=\"date-picker\" (click)=\"$event.stopPropagation()\">\n        <a-date-picker\n            [(ngModel)]=\"date\"\n            [counters]=\"show_events ? event_map : {}\"\n            (ngModelChange)=\"dateChange.emit($event); closeDatePicker()\"\n        ></a-date-picker>\n    </div>\n</mat-menu>\n","import { Component, Input } from '@angular/core';\nimport { User } from 'src/app/services/data/users/user.class';\n\n@Component({\n    selector: 'a-user-avatar',\n    templateUrl: './user-avatar.component.html',\n    styleUrls: ['./user-avatar.component.scss']\n})\nexport class UserAvatarComponent {\n    /** User to display avatar for */\n    @Input() public user: User;\n\n    public get initials(): string {\n        if (!this.user) {\n            return 'NA';\n        }\n        const parts = this.user.name.split(' ');\n        return parts.length > 1\n            ? `${parts[0][0]}${parts[parts.length - 1][0]}`\n            : this.user.name.slice(0, 2);\n    }\n}\n","<div class=\"user-avatar\" *ngIf=\"user\" [attr.user-id]=\"user.id\">\n    <div class=\"initials\" *ngIf=\"!user.image; else image_state\">{{ initials }}</div>\n</div>\n<ng-template #image_state>\n    <img [src]=\"user.image | safe: 'resource'\" />\n</ng-template>\n","import {\n    Directive,\n    Input,\n    Renderer2,\n    SimpleChanges,\n    OnChanges,\n    ContentChildren,\n    QueryList,\n    AfterContentInit\n} from '@angular/core';\nimport { CdkDropList, CdkDrag } from '@angular/cdk/drag-drop';\n\nimport { BaseDirective } from '../base.directive';\n\nexport enum ScrollDirection {\n    NONE,\n    X,\n    Y,\n    BOTH\n}\n\n@Directive({\n    selector: '[cdkDropList][scrollContainer]'\n})\nexport class CdkDropListScrollContainer extends BaseDirective\n    implements OnChanges, AfterContentInit {\n    /** Direction of scroll to determine updating the position of the drop list */\n    @Input() direction: ScrollDirection = ScrollDirection.X;\n    /** Name of the scroll container for the list */\n    @Input() scrollContainer: string;\n    /** Scroll container element */\n    public element: HTMLElement;\n    /** Last scroll position */\n    public last_scroll: { x: number; y: number } = { x: 0, y: 0 };\n\n    /** Draggable children elements */\n    @ContentChildren(CdkDrag) private items: QueryList<CdkDrag>;\n\n    constructor(private _cdkDropList: CdkDropList, private _renderer: Renderer2) {\n        super();\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.scrollContainer && this.scrollContainer) {\n            this.element = this._cdkDropList.element.nativeElement.closest(\n                this.scrollContainer\n            ) as HTMLElement;\n        }\n    }\n\n    public ngAfterContentInit(): void {\n        this.subscription(\n            'drag_items',\n            this.items.changes.subscribe((items: QueryList<CdkDrag>) => {\n                const list = items.toArray();\n                list.forEach((i, index) => {\n                    this.subscription(\n                        `list-item-${index}`,\n                        this._renderer.listen(i.element.nativeElement, 'mousedown', () => {\n                            this.subscription(\n                                'item-dragged',\n                                this._renderer.listen('window', 'mouseup', () => this.onDrop())\n                            );\n                            this.onDrag();\n                        })\n                    );\n                    this.subscription(\n                        `list-item-touch-${index}`,\n                        this._renderer.listen(i.element.nativeElement, 'touchstart', () => {\n                            this.subscription(\n                                'item-dragged',\n                                this._renderer.listen('window', 'touchend', () => this.onDrop())\n                            );\n                            this.onDrag();\n                        })\n                    );\n                });\n            })\n        );\n    }\n\n    /** Start listing for scroll events on the container */\n    public onDrag() {\n        if (this.element) {\n            this.subscription(\n                'scroll',\n                this._renderer.listen(this.element, 'scroll', () => this.updateListPosition())\n            );\n        }\n    }\n\n    /** Stop listening for scroll events on the container */\n    public onDrop() {\n        this.unsub('scroll');\n    }\n\n    /**\n     * Forcefully update the position data of the drop list\n     */\n    private updateListPosition() {\n        this.timeout(\n            'update_positions',\n            () => {\n                const scroll = { x: this.element.scrollLeft, y: this.element.scrollTop };\n                if (\n                    ((this.direction === ScrollDirection.BOTH ||\n                        this.direction === ScrollDirection.Y) &&\n                        scroll.y !== this.last_scroll.y) ||\n                    ((this.direction === ScrollDirection.BOTH ||\n                        this.direction === ScrollDirection.X) &&\n                        scroll.x !== this.last_scroll.x)\n                ) {\n                    (this._cdkDropList._dropListRef as any)._cacheOwnPosition();\n                    (this._cdkDropList._dropListRef as any)._siblings.forEach(i =>\n                        i.isReceiving() ? i._cacheOwnPosition() : null\n                    );\n                }\n                this.last_scroll = scroll;\n            },\n            50\n        );\n    }\n}\n","import { trigger, transition, style, animate, state } from '@angular/animations';\n\nexport const ANIMATION_SHOW_ENTER_LEAVE = trigger('show', [\n    transition(':enter', [\n        style({ opacity: 0, height: 0 }),\n        animate(300, style({ opacity: 1, height: '*' }))\n    ]),\n    transition(':leave', [\n        style({ opacity: 1, height: '*' }),\n        animate(300, style({ opacity: 0, height: 0 }))\n    ])\n]);\n\nexport const ANIMATION_SHOW_CONTRACT_EXPAND = trigger('show', [\n    state('show', style({ opacity: 1, height: '*' })),\n    state('hide', style({ opacity: 0, height: 0, 'pointer-events': 'none' })),\n    transition('show <=> hide', animate('200ms ease-in'))\n]);\n","\nimport * as dayjs from 'dayjs';\n\n/** Version number of the application */\nexport const version = 'local-dev';\n/** Version number of the base application */\nexport const core_version = '1.0.0';\n/** Build time of the application */\nexport const build = dayjs();\n","\nimport { MockHttpRequestHandler } from '@placeos/ts-client';\n\nimport { generateMockBooking } from 'src/app/services/data/bookings/booking.utilities';\nimport { randomInt, unique } from '../../utilities/general.utilities';\nimport { MOCK_SPACES } from './spaces.mock';\nimport { MOCK_USERS } from './users.mock';\nimport { API } from './common.mock';\n\nimport * as dayjs from 'dayjs';\n\nwindow.control = window.control || {};\nwindow.control.systems = window.control.systems || {};\nwindow.control.handlers = window.control.handlers || [];\n\nexport const MOCK_BOOKINGS = Array(200)\n    .fill(0)\n    .map(i => {\n        const rooms = unique(Array(randomInt(4))\n            .fill(0)\n            .map(i => MOCK_SPACES[Math.floor(Math.random() * MOCK_SPACES.length)]), 'id');\n        // Set the organiser with the generated user list\n        const organiser = randomInt(9999) % 10 === 0 ? MOCK_USERS[MOCK_USERS.length - 1] : MOCK_USERS[randomInt(MOCK_USERS.length)];\n        // Set the attendees with the generated user list\n        const attendees = unique(\n            Array(randomInt(20))\n                .fill(0)\n                .map(i => MOCK_USERS[randomInt(MOCK_USERS.length)]),\n            'email'\n        );\n        return generateMockBooking({\n            organiser,\n            attendees,\n            room_ids: rooms.map(i => i.email)\n        });\n    });\n\nMOCK_SPACES.forEach(i => i.bookings = MOCK_BOOKINGS.filter(j => j.room_ids.indexOf(i.email) >= 0));\n\n// Handler for bookings index\nwindow.control.handlers.push({\n    path: `${API}/bookings`,\n    metadata: MOCK_BOOKINGS,\n    method: 'GET',\n    callback: event => {\n        const user = MOCK_USERS[MOCK_USERS.length - 1];\n        let data = !event.query_params.email\n            ? MOCK_BOOKINGS.filter(\n                  i => i.organiser.email === user.email || i.organiser === user.email || i.attendees.reduce((a, v) => a || v.email === user.email, false)\n              )\n            : MOCK_BOOKINGS.filter(\n                  i =>\n                  i.organiser.email === event.query_params.email ||\n                  (i.organiser as any) === event.query_params.email ||\n                      i.attendees.reduce((a, v) => a || v.email === event.query_params.email, false)\n            );\n        // Filter bookings between a given period\n        if (event.query_params.from) {\n            const start = dayjs(+event.query_params.from * 1000);\n            const end = event.query_params.to ? dayjs(+event.query_params.to * 1000).endOf('m') : start.endOf('d');\n            data = data.filter(i => {\n                const bkn_start = dayjs(i.start_epoch * 1000).startOf('m').second(1);\n                const bkn_end = dayjs(i.end_epoch * 1000);\n                return (bkn_start.isAfter(start, 's') && bkn_start.isBefore(end, 'm')) || (bkn_end.isAfter(start, 'm') && bkn_end.isBefore(end, 's'));\n            });\n        }\n        return data;\n    }\n} as MockHttpRequestHandler);\n\n// Handler for bookings show\nwindow.control.handlers.push({\n    path: `${API}/bookings/:id`,\n    metadata: MOCK_BOOKINGS,\n    method: 'GET',\n    callback: event => {\n        if (event.route_params.id) {\n            const booking = MOCK_BOOKINGS.find(i => i.id === event.route_params.id || i.icaluid === event.route_params.id);\n            if (booking) {\n                return booking;\n            } else {\n                throw { status: 404, message: 'Booking not found.' }\n            }\n        } else {\n            throw { status: 400, message: 'Invalid booking ID' };\n        }\n    }\n} as MockHttpRequestHandler);\n\n// Handler for new bookings\nwindow.control.handlers.push({\n    path: `${API}/bookings`,\n    metadata: MOCK_BOOKINGS,\n    method: 'POST',\n    callback: (event) => {\n        if (event.body) {\n            event.body.id = `bkn-${randomInt(9_999_999)}`;\n            event.body.icaluid = `ical-${event.body.id}`;\n            MOCK_BOOKINGS.push(event.body);\n            MOCK_SPACES.forEach(space => space.bookings = MOCK_BOOKINGS.filter(booking => booking.room_ids.indexOf(space.email) >= 0));\n            return event.body;\n        } else {\n            throw { status: 500, message: 'Invalid booking data' };\n        }\n    }\n} as MockHttpRequestHandler);\n\n// Handler for updating exisiting bookings\nwindow.control.handlers.push({\n    path: `${API}/bookings/:id`,\n    metadata: MOCK_BOOKINGS,\n    method: 'PUT',\n    callback: (event) => {\n        if (event.route_params.id) {\n            const index = MOCK_BOOKINGS.findIndex(i => i.id === event.route_params.id || i.icaluid === event.route_params.id);\n            if (index >= 0) {\n                MOCK_BOOKINGS[index] = event.body;\n                MOCK_SPACES.forEach(i => i.bookings = MOCK_BOOKINGS.filter(j => (j.room_ids).indexOf(i.email) >= 0));\n                return event.body;\n            } else {\n                throw { status: 404, message: 'Booking not found' };\n            }\n        } else\n            throw { status: 500, message: 'Invalid booking ID' };\n    }\n} as MockHttpRequestHandler);\n\n// Handler for deleting exisiting bookings\nwindow.control.handlers.push({\n    path: `${API}/bookings/:id`,\n    metadata: MOCK_BOOKINGS,\n    method: 'DELETE',\n    callback: (event) => {\n        if (event.route_params.id) {\n            const index = MOCK_BOOKINGS.findIndex(i => i.id === event.route_params.id || i.icaluid === event.route_params.id);\n            if (index >= 0) {\n                MOCK_BOOKINGS.splice(index, 1);\n                MOCK_SPACES.forEach(i => i.bookings = MOCK_BOOKINGS.filter(j => j.room_ids.indexOf(i.email) >= 0));\n            } else {\n                throw { status: 404, message: 'Booking not found' };\n            }\n        } else\n            throw { status: 500, message: 'Invalid booking ID' };\n    }\n} as MockHttpRequestHandler);\n","\nimport { MockHttpRequestHandler } from '@placeos/ts-client';\n\nimport { MOCK_ORG } from './organisation.mock';\nimport { DOMAIN } from './common.mock';\n\nwindow.control = window.control || {};\nwindow.control.systems = window.control.systems || {};\nwindow.control.handlers = window.control.handlers || [];\n\nexport const MOCK_BUILDINGS = [{\n    id: 'zone_bld-01',\n    zone_id: 'zone_bld-01',\n    name: 'Sydney',\n    settings: {\n        discovery_info: {\n            timezone: 'Australia/Sydney',\n            phone: {\n                emergency: '0412345678',\n                av_help: '0412345678',\n                concierge: '0412345678'\n            },\n            locations: {},\n            desk_tracking: 'sys-B0',\n            systems: {\n                desk_bookings: 'sys-B0'\n            },\n            messaging: 'sys-B0',\n            features: [],\n            catering: {},\n            neighbourhoods: {\n                'zone_lvl-01': {\n                    'Test Searchable': 'Device_Bench'\n                }\n            },\n            visitor_space: 'sydney-10.05@acaprojects.com',\n            levels: [\n                {\n                    level_id: 'zone_lvl-01',\n                    level_name: 'Level 1',\n                    number: 1,\n                    map_url: 'assets/maps/level_01.svg',\n                    floor_type: 'staff',\n                    settings: {\n                        map_features: [\n                            { id: 'Device_Bench', name: 'Device Bench' },\n                            { id: 'people', name: 'People' }\n                        ]\n                    },\n                    desks: 6,\n                },\n                {\n                    level_id: 'zone_lvl-02',\n                    level_name: 'Level 2',\n                    number: 2,\n                    map_url: 'assets/maps/level_02.svg',\n                    floor_type: 'client',\n                    book_type: 'Request',\n                    desks: 6,\n                },\n                {\n                    level_id: 'zone_lvl-03',\n                    level_name: 'Level 3',\n                    number: 3,\n                    map_url: 'assets/maps/level_03.svg',\n                    floor_type: 'staff',\n                    desks: 6,\n                },\n                {\n                    level_id: 'zone_lvl-10',\n                    level_name: 'Level 10',\n                    number: 10,\n                    map_url: 'assets/maps/level_10.svg',\n                    floor_type: 'staff',\n                    desks: 186,\n                }\n            ],\n            roles: {\n                'fire-warden': [\n                    { name: 'Alex Sorafumo', email: `alex.sorafumo@${DOMAIN}`, phone: '0412345678' },\n                    { name: 'Bob Jane', email: `bob.jane@${DOMAIN}`, phone: '0423456789' },\n                    { name: 'Rupert', email: `rupert@${DOMAIN}`, phone: '0434567890' }\n                ],\n                'first-aider': [\n                    { name: 'Ben Hoad', email: `ben.hoad@${DOMAIN}`, phone: '0412345678' },\n                    { name: 'Kim Burgess', email: `kim.burgess@${DOMAIN}`, phone: '0423456789' },\n                    { name: 'Mr Pop', email: `mr.pop@${DOMAIN}`, phone: '0434567890' }\n                ]\n            },\n            extras: [\n                { extra_id: 'VidConf', extra_name: 'Video Conference' },\n                { extra_id: 'AV', extra_name: 'AV' },\n                { extra_id: 'presentation', extra_name: 'Wireless Presentation' },\n                { extra_id: 'phone', extra_name: 'Conference Phone' },\n            ],\n            loan_items: [\n                { extra_id: 'ConfKit', extra_name: 'Conference Kit' },\n                { extra_id: 'Chairs', extra_name: 'Chairs' },\n            ],\n        },\n    },\n}];\n\nMOCK_BUILDINGS.push({ ...MOCK_BUILDINGS[0], name: 'London' });\n\nMOCK_ORG[0].discovery_info.buildings = MOCK_BUILDINGS;\n\nsetTimeout(() => {\n    window.control.handlers.push({\n        path: '/api/engine/v2/zones',\n        metadata: MOCK_BUILDINGS,\n        callback: (event) => {\n            if (event.query_params.tags === 'building') {\n                return { total: MOCK_BUILDINGS.length, results: MOCK_BUILDINGS };\n            } else if (event.query_params.tags === 'org') {\n                return { total: MOCK_ORG.length, results: MOCK_ORG };\n            } else if (event.query_params.tags === 'level') {\n                return { total: 0, results: [] };\n            }\n        }\n    } as MockHttpRequestHandler);\n});\n","\n/** Domain of the organisation */\nexport const DOMAIN = 'acaprojects.com';\n/** Endpoint where the staff API is located */\nexport const API = '/api/staff';\n","import { MockHttpRequestHandler } from '@placeos/ts-client';\n\nimport { MOCK_USERS } from \"./users.mock\";\nimport { MOCK_SPACES } from './spaces.mock';\nimport { MOCK_BUILDINGS } from './buildings.mock';\nimport { randomInt } from '../../utilities/general.utilities';\nimport { generateMockLocation } from 'src/app/services/data/location/location.utilities';\n\nexport const MOCK_LOCATIONS: any[] = [];\n\nconst spaces = MOCK_SPACES.map(space => space.map_id);\nconst levels = MOCK_BUILDINGS.reduce((lvls, bld) => {\n    bld.settings.discovery_info.levels.forEach(lvl => lvls.push(lvl.level_id));\n    return lvls;\n}, []);\n\nfor (const user of MOCK_USERS) {\n    if (user.location || randomInt(99999) % 2 === 0) {\n        user.location = generateMockLocation(null, spaces, levels);\n        MOCK_LOCATIONS.push(user.location);\n    }\n}\n\nsetTimeout(() => {\n    window.control.handlers.push({\n        path: '/api/staff/people/:email',\n        metadata: MOCK_LOCATIONS,\n        callback: (event) => {\n            if (event.route_params.email) {\n                const user = MOCK_USERS.find(user => user.email === event.route_params.email || user.id === event.route_params.email);\n                if (user) {\n                    return user.location;\n                }\n            }\n            throw { status: 404, message: `Unable to locate user with email ${event.route_params.email}` };\n        }\n    } as MockHttpRequestHandler);\n});\n\n\n","export const MOCK_ORG = [\n    {\n        send_acceptance: true,\n        discovery_info: {\n            buildings: []\n        }\n    }\n];\n","import { generateMockSpace } from 'src/app/services/data/spaces/space.utilities';\nimport { API } from './common.mock';\nimport { MockHttpRequestHandler } from '@placeos/ts-client';\n\nimport * as dayjs from 'dayjs';\n\nwindow.control = window.control || {};\nwindow.control.systems = window.control.systems || {};\nwindow.control.handlers = window.control.handlers || [];\n\nexport const MOCK_SPACES = [\n    { id: '1.01', name: 'Meeting', zones: ['zone_bld-01', 'zone_lvl-01'] },\n    { id: '1.02', name: 'Collaboration', zones: ['zone_bld-01', 'zone_lvl-01'] },\n    { id: '1.03', name: 'Team Meeting', zones: ['zone_bld-01', 'zone_lvl-01'] },\n    { id: '1.04', name: 'Pod', zones: ['zone_bld-01', 'zone_lvl-01'] },\n    { id: '1.05', name: 'IT Support', zones: ['zone_bld-01', 'zone_lvl-01'] }\n].map((space_data: any) => {\n    const space = generateMockSpace({\n        ...space_data,\n        map_id: `area-${space_data.id}-status`,\n        id: `sys_rm-${space_data.id}`,\n        name: `${space_data.name} ${space_data.id}`\n    });\n    window.control.systems[space.id] = {\n        Bookings: [\n            {\n                today: space.bookings\n            }\n        ]\n    };\n    return space;\n});\n\n// Add handler for users index\nwindow.control.handlers.push({\n    path: `${API}/rooms`,\n    metadata: MOCK_SPACES,\n    callback: event => {\n        let results = MOCK_SPACES;\n        if (event.query_params.q) {\n            const query = event.query_params.q.toLowerCase();\n            results = results.filter(\n                i =>\n                    (i.id || '').toLowerCase().indexOf(query) >= 0 ||\n                    (i.name || '').toLowerCase().indexOf(query) >= 0 ||\n                    (i.email || '').toLowerCase().indexOf(query) >= 0\n            );\n        }\n        // Remove rooms without given zones from results\n        if (event.query_params.zone_ids) {\n            const zone_ids = event.query_params.zone_ids.split(',');\n            results = results.filter(i => {\n                let count = 0;\n                for (const zone of zone_ids) {\n                    if (i.zones.indexOf(zone) >= 0) {\n                        count++;\n                    }\n                }\n                return count >= zone_ids.length;\n            });\n        }\n        // Remove rooms without given ids from results\n        if (event.query_params.room_ids) {\n            const room_ids = event.query_params.room_ids.split(',');\n            results = results.filter(i => room_ids.indexOf(i.id) >= 0);\n        }\n        // Update availability status of each room results\n        if (event.query_params.available_from) {\n            const from = dayjs(+event.query_params.available_from * 1000);\n            const to = dayjs(+event.query_params.available_to * 1000);\n            results.forEach(space => {\n                for (const booking of space.bookings) {\n                    const start = dayjs(booking.start_epoch * 1000);\n                    const end = dayjs(booking.end_epoch * 1000);\n                    if (\n                        (from.isAfter(start, 'm') && from.isBefore(end, 'm')) ||\n                        (to.isAfter(start, 'm') && to.isBefore(end, 'm')) ||\n                        (start.isAfter(from, 'm') && start.isBefore(to, 'm'))\n                    ) {\n                        space.settings = { available: false };\n                    } else {\n                        space.settings = { available: true };\n                    }\n                }\n            });\n        }\n        return results;\n    }\n} as MockHttpRequestHandler);\n","\nimport { MockHttpRequestHandler } from '@placeos/ts-client';\n\nimport { generateMockUser } from 'src/app/services/data/users/user.utilities';\nimport { API } from './common.mock';\n\nwindow.control = window.control || {};\nwindow.control.systems = window.control.systems || {};\nwindow.control.handlers = window.control.handlers || [];\n\nexport const MOCK_USERS = Array(Math.floor(Math.random() * 300 + 100)).fill(0)\n    .map(i => generateMockUser());\nexport const MOCK_CONTACTS = Array(Math.floor(Math.random() * 300 + 100)).fill(0)\n    .map(i => generateMockUser({ visitor: true }));\n\nexport const PREDEFINED_USERS = [\n    'Jonathan McFarlane',\n    'Stephen Von Takach',\n    'Alex Sorafumo',\n    'Candy Russo',\n    'Cristina Boston',\n    'Eugene Murphy',\n    'Ben Hoad',\n    'Kim Burgess',\n    'Desk Test',\n    'Space Test',\n    'Wireless Test',\n    'Zo-Kalar'\n];\n\n// Add predefined user to user list\nfor (const user of PREDEFINED_USERS) {\n    const id = user.split(' ').join('.').toLowerCase();\n    const new_user = generateMockUser({ id, name: user });\n    new_user.location = true;\n    MOCK_USERS.push(new_user);\n}\n\n// Add handler for users index\nwindow.control.handlers.push({\n    path: `${API}/users`,\n    metadata: MOCK_USERS,\n    callback: (event) => {\n        if (event.query_params.q) {\n            const query = event.query_params.q.toLowerCase();\n            return MOCK_USERS.filter(i =>\n                (i.id || '').toLowerCase().indexOf(query) >= 0 ||\n                (i.name || '').toLowerCase().indexOf(query) >= 0 ||\n                (i.email || '').toLowerCase().indexOf(query) >= 0\n            );\n        }\n        return MOCK_USERS;\n    }\n} as MockHttpRequestHandler);\n\n// Add handler for current user\nwindow.control.handlers.push({\n    path: `/api/engine/v2/users/current`,\n    metadata: MOCK_USERS[MOCK_USERS.length - 1],\n} as MockHttpRequestHandler);\n\n// Add handler for users show\nwindow.control.handlers.push({\n    path: `${API}/users/:id`,\n    metadata: MOCK_USERS,\n    callback: (event) => {\n        const user = MOCK_USERS.find(i => i.id === event.route_params.id || i.name === event.route_params.id || i.email === event.route_params.id);\n        if (user) {\n            return user;\n        }\n        throw { status: 404, message: 'User not found' };\n    }\n} as MockHttpRequestHandler);\n\n// Add handler for contacts index\nwindow.control.handlers.push({\n    path: `${API}/contacts`,\n    metadata: MOCK_CONTACTS,\n    callback: (event) => {\n        if (event.query_params.q) {\n            const query = event.query_params.q.toLowerCase();\n            return MOCK_CONTACTS.filter(i =>\n                (i.id || '').toLowerCase().indexOf(query) >= 0 ||\n                (i.name || '').toLowerCase().indexOf(query) >= 0 ||\n                (i.email || '').toLowerCase().indexOf(query) >= 0\n            );\n        }\n        return MOCK_USERS;\n    }\n} as MockHttpRequestHandler);\n\n// Add handler for contacts show\nwindow.control.handlers.push({\n    path: `${API}/contacts/:id`,\n    metadata: MOCK_USERS,\n    callback: (event) => {\n        const user = MOCK_USERS.find(i => i.id === event.route_params.id || i.name === event.route_params.id);\n        if (user) {\n            return user;\n        }\n        throw { status: 404, message: 'User not found' };\n    }\n} as MockHttpRequestHandler);\n\n\n","\nimport { createSystem } from './systems.mock';\n\nimport './api/organisation.mock';\nimport './api/buildings.mock';\nimport './api/users.mock';\nimport './api/spaces.mock';\nimport './api/bookings.mock';\nimport './api/locations.mock';\n\nwindow.control = window.control || {};\nwindow.control.systems = {\n    ...window.control.systems,\n    ['sys-B0']: createSystem('sys-B0')\n} || {};\nwindow.control.handlers = window.control.handlers || [];\n","\n\nimport { generateMockSpace } from \"../../services/data/spaces/space.utilities\";\nimport { setMockBookingStartDatetime } from \"../../services/data/bookings/booking.utilities\";\n\nimport * as dayjs from 'dayjs';\n\nexport interface IBookingPanelBindings {\n    /** Whether user input is enabled */\n    touch_enabled: boolean;\n    /** Number of seconds before a meeting can be started, being truthy enables start/stop and auto-cancellations */\n    timeout?: number;\n    /** Number of seconds after the start of a meeting when it is auto-cancelled, overrides `timeout` value */\n    cancel_timeout?: number;\n    /** Whether to display hearing assistance UI elements */\n    has_accessability?: boolean;\n    /** URL to embed into the control modal when opened */\n    control_url?: string;\n    /** Whether to display catering UI elements */\n    has_catering?: boolean;\n    /** Whether to hide booking details(title and host) */\n    hide_details?: boolean;\n    /** Whether to hide the title of the displayed bookings */\n    hide_title?: boolean;\n    /** Whether to hide user(host) details */\n    hide_user?: boolean;\n    /** Whether to hide timeline availability */\n    hide_availability?: boolean;\n    /** Whether to disable booking from the UI */\n    booking_disabled?: boolean;\n    /** Whether booking future meetings are allowed */\n    no_timeline_bookings?: boolean;\n    /** Time before the booking end with which the current booking is endable in ms from UTC epoch */\n    is_endable?: number;\n    /** Whether to automatically ask user starting the current meeting */\n    ask_start?: boolean;\n    /** Whether to automatically ask user about ending the active meeting */\n    ask_end?: boolean;\n    /** Default meeting title if the displayed meeting doesn't have one */\n    default_title?: string;\n    /** Hide all meeting related details */\n    hide_all?: boolean;\n    /** Title of the active space */\n    title?: string;\n    /** Description of the active space */\n    description?: string;\n    /** URL of an icon image to display on the UI */\n    icon?: string;\n    /** Whether the space status is displayed on the right */\n    flip_status?: boolean;\n    /** Whether bookings can be automatically cancelled once they expire */\n    can_cancel?: boolean;\n    /** Minimum bookable duration in minutes */\n    min_duration?: number;\n    /** Maximum bookable duration in minutes */\n    max_duration?: number;\n    /** Start time of the business day with format `HH:mm` */\n    business_start?: string;\n    /** End time of the business day with format `HH:mm` */\n    business_end?: string;\n\n}\n\nconst LETTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');\nconst NUMBERS = '0123456789'.split('');\n\nlet index = 0;\n\nconst SPACE_LIST: any[] = [];\n\nconst IMAGES: string[] = ['large_down', 'large_up', 'small_down', 'small_up'];\n\n/**\n * Create mock engine booking module with appropriate bookings and space data\n */\nexport function createSystem(id?: string) {\n    id = id || `sys-${LETTERS[Math.floor(index / NUMBERS.length)]}${NUMBERS[(index++) % NUMBERS.length]}`;\n    setMockBookingStartDatetime(dayjs().minute(-50).valueOf());\n    const space = generateMockSpace({ id });\n    SPACE_LIST.push(space);\n\n    const booking_bindings: IBookingPanelBindings = {\n        touch_enabled: true,\n        timeout: 300,\n        cancel_timeout: 600,\n        has_catering: true,\n        control_url: 'https://aca.im/demo/aca/control/',\n        icon: `/assets/img/${IMAGES[Math.floor(Math.random() * IMAGES.length)]}.png`\n    };\n\n    const today = dayjs();\n    const desk_bindings = {\n        'zone_lvl-01:bookings': {\n            'SYD.1.09.E': {\n                [today.format('YYYY-MM-DD')]: {\n                    // 'first@acaprojects.com': {\n                    'zo-kalar@acaprojects.com': {\n                        start: today.subtract(1, 'h').unix(),\n                        end: today.add(1, 'h').unix(),\n                        checked_in: true\n                    }\n                },\n                [today.add(1, 'd').format('YYYY-MM-DD')]: {\n                    'second@acaprojects.com': {\n                        start: today.add(1, 'd').subtract(1, 'h').unix(),\n                        end: today.add(1, 'd').add(1, 'h').unix()\n                    }\n                }\n            },\n            'SYD.1.09.F': {},\n            'SYD.1.09.G': {}\n        },\n        'zone_lvl-02:bookings': {\n            'SYD.2.01.A': {\n                [today.format('YYYY-MM-DD')]: {\n                    'first@acaprojects.com': {\n                        start: today.subtract(1, 'h').unix(),\n                        end: today.add(1, 'h').unix(),\n                        checked_in: true\n                    }\n                },\n                [today.add(1, 'd').format('YYYY-MM-DD')]: {\n                    'second@acaprojects.com': {\n                        start: today.add(1, 'd').subtract(1, 'h').unix(),\n                        end: today.add(1, 'd').add(1, 'h').unix()\n                    }\n                }\n            },\n            'SYD.2.01.B': {},\n            'SYD.2.01.C': {}\n        }\n    };\n\n    const system = {\n        id, name: space.name,\n        Bookings: [],\n        DeskManagement: [{\n            'zone_lvl-01:desk_ids': ['SYD.1.09.E', 'SYD.1.09.F', 'SYD.1.09.G']\n        }],\n        DeskBookings: []\n    };\n    system.Bookings.push({\n        ...booking_bindings,\n        room_name: space.name,\n        today: space.bookings,\n        $start_meeting: (time: number) => {\n            system.Bookings[0].last_meeting_started = time;\n        },\n        $cancel_meeting: (time: number, reason: string) => {\n            const list = system.Bookings[0].today;\n            system.Bookings[0].today = list.filter(i => i.date !== time);\n        },\n        $waiter_call: () => {\n            console.log(`[MOCK][${id}] Waiter called...`);\n        }\n    });\n    system.DeskBookings.push({\n        ...desk_bindings,\n        $book: (email: string, desk: string, date: number) => {\n            console.log('[MOCK] Book called');\n        },\n        $check_in: (email: string, desk: string) => {\n            system.DeskBookings[0]['zone_lvl-01:bookings'][desk][dayjs().format('YYYY-MM-DD')][email].checked_in = true;\n        },\n        $check_out: (email: string, desk: string) => {\n            console.log(`[MOCK]Check out called`);\n        },\n    });\n    return system;\n}\n","\nimport { NgModule, Type } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\nimport { EditorModule } from '@tinymce/tinymce-angular';\nimport { ComposerModule } from '@placeos/composer';\n\nimport { ScrollingModule } from '@angular/cdk/scrolling';\nimport { DragDropModule } from '@angular/cdk/drag-drop';\nimport { CdkTableModule } from '@angular/cdk/table';\n\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatRippleModule } from '@angular/material/core';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\n\nimport { APipesModule } from '@acaprojects/ngx-pipes';\nimport { ACustomEventsModule } from '@acaprojects/ngx-custom-events';\nimport { ADatePickerModule } from '@acaprojects/ngx-date-picker';\n\nimport { BaseDirective } from './base.directive';\nimport { LoginComponent } from './components/login/login.component';\nimport { IconComponent } from './components/icon/icon.component';\nimport { TopbarHeaderComponent } from './components/topbar-header/topbar-header.component';\nimport { SearchbarComponent } from './components/searchbar/searchbar.component';\nimport { UserAvatarComponent } from './components/user-avatar/user-avatar.component';\nimport { PopoutMenuComponent } from './components/popout-menu/popout-menu.component';\nimport { FeedbackComponent } from './components/feedback/feedback.component'\n\nimport { UserFormComponent } from './components/forms/user-form/user-form.component';\nimport { BookingFormComponent } from './components/forms/booking-form/booking-form.component';\n\nimport { UserSearchFieldComponent } from './components/custom-fields/user-search-field/user-search-field.component';\nimport { TimeFieldComponent } from './components/custom-fields/time-field/time-field.component';\nimport { DurationFieldComponent } from './components/custom-fields/duration-field/duration-field.component';\nimport { DateFieldComponent } from './components/custom-fields/date-field/date-field.component';\nimport { ActionFieldComponent } from './components/custom-fields/action-field/action-field.component';\nimport { UserListFieldComponent } from './components/custom-fields/user-list-field/user-list-field.component';\nimport { CounterComponent } from './components/custom-fields/counter/counter.component';\nimport { CdkDropListScrollContainer } from './directives/cdk-drop-list-scroll-container.directive';\nimport { SidebarComponent } from './components/sidebar/sidebar.component';\nimport { ActionIconComponent } from './components/action-icon/action-icon.component';\n\nconst COMPONENTS: Type<any>[] = [\n    BaseDirective,\n    LoginComponent,\n    IconComponent,\n    ActionIconComponent,\n    TopbarHeaderComponent,\n    SearchbarComponent,\n    UserAvatarComponent,\n\n    UserFormComponent,\n    BookingFormComponent,\n\n    PopoutMenuComponent,\n    FeedbackComponent,\n    SidebarComponent\n];\n\nconst DIRECTIVES: Type<any>[] = [\n    CdkDropListScrollContainer\n]\n\nconst ENTRY_COMPONENT: Type<any>[] = [\n    DateFieldComponent,\n    ActionFieldComponent,\n    TimeFieldComponent,\n    DurationFieldComponent,\n    UserSearchFieldComponent,\n    UserListFieldComponent,\n    CounterComponent,\n];\n\nconst MATERIAL_MODULES: any[] = [\n    MatButtonModule,\n    MatSnackBarModule,\n    MatDialogModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatProgressSpinnerModule,\n    MatProgressBarModule,\n    MatAutocompleteModule,\n    MatSelectModule,\n    MatChipsModule,\n    MatRippleModule,\n    MatMenuModule,\n    MatCheckboxModule,\n    MatTooltipModule,\n    MatRadioModule,\n    MatTabsModule,\n    MatSlideToggleModule\n];\n\nconst CDK_MODULES: any[] = [\n    ScrollingModule,\n    DragDropModule,\n    CdkTableModule\n];\n\n@NgModule({\n    declarations: [\n        ...COMPONENTS,\n        ...ENTRY_COMPONENT,\n        ...DIRECTIVES\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        APipesModule,\n        ADatePickerModule,\n        ACustomEventsModule,\n        RouterModule,\n        EditorModule,\n        ComposerModule,\n        ...MATERIAL_MODULES,\n        ...CDK_MODULES\n    ],\n    exports: [\n        APipesModule,\n        ACustomEventsModule,\n        ADatePickerModule,\n        ...COMPONENTS,\n        ...DIRECTIVES,\n        ...ENTRY_COMPONENT,\n        ...MATERIAL_MODULES,\n        ...CDK_MODULES\n    ]\n})\nexport class SharedContentModule {}\n","import { HashMap } from \"./types.utilities\";\n\n/**\n * Convert map into a query string\n * @param map Key value pairs to convert\n */\nexport function toQueryString(map: HashMap) {\n    let str = '';\n    if (map) {\n        for (const key in map) {\n            if (map.hasOwnProperty(key) && map[key] !== undefined && map[key] !== null) {\n                str += `${(str ? '&' : '')}${key}=${map[key]}`;\n            }\n        }\n    }\n    return str;\n}\n","\nimport { humaniseDuration } from './general.utilities';\n\nimport { User } from '../../services/data/users/user.class';\nimport { Space } from '../../services/data/spaces/space.class';\n\nimport * as dayjs from 'dayjs';\n\n// attendees: FormFormatters.attendees(user),\n// date: FormFormatters.date,\n// room: FormFormatters.space,\n// recurrence: FormFormatters.recurrence\n\n/**\n * Get function to create formatted string for a list of users with a host\n * @param host Host user\n */\nexport function formatAttendeesWithHost(host: User): (_: User[]) => string {\n    return (l) => formatAttendees(l, host);\n}\n\n/**\n * Create formatted string from a list of users\n * @param list List of users\n * @param host Owner of the list of users\n */\nexport function formatAttendees(list: User[], host?: User) {\n    let attendee_str: string = '';\n    if (list && list.length > 0) {\n        const users = [...list];\n        if (host) {\n            const result = users.find(a => a.email === host.email);\n            if (result) {\n                users.splice(users.indexOf(result), 1);\n            }\n        }\n        const length = users.length + (host ? 1 : 0);\n        attendee_str = `${length} Attendee${length === 1 ? '' : 's'}; ${host ? host.name : ''}`;\n        for (const item of users) {\n            if (attendee_str) {\n                attendee_str += ', ';\n            }\n            attendee_str += item.name;\n        }\n        attendee_str = attendee_str.replace('; ,', ';');\n    }\n    return attendee_str;\n}\n\n/**\n * Create date formatted string for given date\n * @param date Date to format\n */\nexport function formatDate(date: number) {\n    return dayjs(date).format('DD MMMM YYYY');\n}\n\n/**\n * Create time formatted string for given date\n * @param date Date to format\n */\nexport function formatTime(date: number) {\n    return dayjs(date).format('h:mm A');\n}\n\n/**\n * Create formatted string for a period of given duration\n * @param duration Period duration in minutes\n */\nexport function formatPeriodWithDuration(duration: number) {\n    return (t) => formatPeriod(t, duration);\n}\n\n/**\n * Create formatted string for a period of given duration\n * @param timestamp Start hours and minutes of the period in the format `HH:mm`\n * @param duration Period duration in minutes\n */\nexport function formatPeriod(timestamp: string, duration: number = 60) {\n    const parts = timestamp.split(':');\n    const date = dayjs().hour(+parts[0]).minute(+parts[1]);\n    return `${date.format('h:mm A')} - ${date.add(duration, 'm').format('h:mm A')} (${humaniseDuration(duration)})`;\n}\n\n/**\n * Create formatted human readable string for a given duration\n * @param duration Duration in minutes\n */\nexport function formatDuration(duration: number) {\n    return humaniseDuration(duration);\n}\n\n/** Human readable names of applicable recurrence periods */\nexport const RECURRENCE_PERIODS: string[] = ['None', 'Daily', 'Weekly', 'Monthly', 'Yearly'];\n\n/**\n * Create human readable string for recurrence metadata\n * @param value\n */\nexport function formatRecurrence(value: { period: string | number, end: number }) {\n    if (!value || !value.period || value.period as any >= RECURRENCE_PERIODS.length) {\n        return 'No recurrence';\n    }\n    const period = typeof value.period === 'string' ? value.period : RECURRENCE_PERIODS[value.period];\n    const end = value.end ? `until ${dayjs(value.end).format('DD MMM YYYY')}` : 'forever';\n    return `${period} ${end}`;\n}\n\n/**\n * Create human readable string for a room or list of rooms\n * @param list List of spaces/rooms\n */\nexport function formatSpaces(list: Space | Space[]) {\n    if (!list || (list instanceof Array && list.length <= 0)) {\n        return 'No selected space';\n    }\n    if (list instanceof Array) {\n        return list.length === 1 ? list[0].name : `${list.length} Space${list.length !== 1 ? 's' : ''}`;\n    } else {\n        const capacity = list.capacity ? '(' + list.capacity + ' ' + (list.capacity === 1 ? 'person' : 'people') + ')' : '';\n        return `${list.name} ${capacity}`;\n    }\n}\n","import { HashMap, Point } from './types.utilities';\n\nimport * as dayjs from 'dayjs';\n\nexport function getItemWithKeys(keys: string[], map: HashMap) {\n    const key = keys.shift();\n    if (map[key]) {\n        return keys.length > 0 ? getItemWithKeys(keys, map[key]) : map[key];\n    }\n    return null;\n}\n\n/* istanbul ignore next */\n/**\n * Checks whether the platform is a mobile device.\n */\nexport function isMobileDevice(): boolean {\n    const r = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;\n    return !!navigator.userAgent.match(r);\n}\n\n/* istanbul ignore next */\n/**\n * Checks whether the browser is Mobile Safari.\n */\nexport function isMobileSafari(): boolean {\n    const agent = navigator.userAgent;\n    return !!(\n        agent.match(/iPhone|iPad|iPod/) &&\n        agent.match(/AppleWebKit/) &&\n        !agent.match('CriOS')\n    );\n}\n\n/* istanbul ignore next */\n/**\n * Checks whether the browser is Android Chrome.\n */\nexport function isAndroidChrome(): boolean {\n    const agent = navigator.userAgent;\n    return !!(agent.match(/Android/) && agent.match(/Chrome/));\n}\n\n/**\n * Generate string representation of a number with zeros padding the length\n * @param value Number to pad with zeros\n * @param length Length of the resulting string\n */\nexport function padZero(value: number, length: number): string {\n    let str = value.toString();\n    while (str.length < length) {\n        str = '0' + str;\n    }\n    return str;\n}\n\n/**\n * Remove duplicates from the given array\n * @param array List of items to remove duplicates from\n * @param key Key on array objects to compare for uniqueness\n */\nexport function unique(array: any[], key: string = '') {\n    return array.filter(\n        (el, pos, arr) =>\n            arr.indexOf(key ? arr.find((i) => i[key] === el[key]) : arr.find((i) => i === el)) ===\n            pos\n    );\n}\n\n/**\n * Convert duration to human readable string\n * @param duration Duration in minutes\n * @param short Whether to use short form of duration words e.g. hours as h\n */\nexport function humaniseDuration(duration: number, short: boolean = false) {\n    if (!duration || duration < 0) {\n        return '';\n    }\n    const h = Math.floor(duration / 60);\n    let d = `${h >= 1 ? h + (short ? 'h' : ' hour' + (h === 1 ? '' : 's')) : ''}`;\n    if (duration % 60 !== 0) {\n        if (d) {\n            d += short ? ' ' : ', ';\n        }\n        const m = duration % 60;\n        d += `${m >= 1 ? m + (short ? 'm' : ' minute' + (m === 1 ? '' : 's')) : ''}`;\n    }\n    return d;\n}\n\n/**\n * Get a filtered list of items\n * @param filter Value to filter on\n * @param items List of results to filter\n * @param fields Fields to check for matches on each item\n */\nexport function filterList<T = HashMap>(\n    filter: string,\n    items?: T[],\n    fields: string[] = ['id']\n): T[] {\n    let results: any[];\n    // Tokenise filter string\n    const filters = (filter || '').toLowerCase().split(' ');\n    const list = {};\n    for (const f of filters) {\n        /* istanbul ignore else */\n        if (f) {\n            /* istanbul ignore else */\n            if (!list[f]) {\n                list[f] = 0;\n            }\n            list[f]++;\n        }\n    }\n    // Group similar tokens\n    const parts = [];\n    for (const f in list) {\n        /* istanbul ignore else */\n        if (list.hasOwnProperty(f)) {\n            parts.push({ word: f, count: list[f], regex: new RegExp(f, 'gi') });\n        }\n    }\n    parts.sort((a, b) => b.word.length - a.word.length || a.word.localeCompare(b.word));\n    const item_list = JSON.parse(JSON.stringify(items || []));\n    /* istanbul ignore else */\n    if (filter) {\n        results = item_list.filter((item) => {\n            let match_count = 0;\n            item.match_index = 65535;\n            item.match = '';\n            const field_list = {};\n            // Initialise field match variables\n            for (const f of fields) {\n                field_list[f] = {\n                    value: (item[f] || '').toLowerCase(),\n                    index: 65536,\n                    matched: 0,\n                };\n            }\n            // Search for matches with the tokenised filter string\n            for (const i of parts) {\n                /* istanbul ignore else */\n                if (i.word) {\n                    // Check fields for matches\n                    for (const f of fields) {\n                        const field = field_list[f];\n                        const index = field.value.indexOf(i.word);\n                        field.index = index < field.index ? index : field.index;\n                        field.matches = (field.value.match(i.regex) || []).length;\n                        field.value = field.value.replace(i.regex, ' ');\n                    }\n                    // Update token match count\n                    for (const f of fields) {\n                        const field = field_list[f];\n                        /* istanbul ignore else */\n                        if (field.matches >= i.count) {\n                            match_count++;\n                            // Update field matches\n                            let changed = 0;\n                            const tokens = (item[`match_${f}`] || item[f] || '').split(' ');\n                            for (const k of tokens) {\n                                /* istanbul ignore else */\n                                if (changed >= i.count) {\n                                    break;\n                                }\n                                /* istanbul ignore else */\n                                if (k.toLowerCase().indexOf(i.word) >= 0 && k.indexOf('`') < 0) {\n                                    tokens[tokens.indexOf(k)] = k.replace(i.regex, '`$&`');\n                                    changed++;\n                                }\n                            }\n                            item[`match_${f}`] = tokens.join(' ');\n                            break;\n                        }\n                    }\n                }\n            }\n            // Get field with the most relevent match\n            for (const f of fields) {\n                const field = field_list[f];\n                /* istanbul ignore else */\n                if (field.index < item.match_index && field.index >= 0) {\n                    item.match_index = field.index;\n                    item.match = f;\n                }\n            }\n            return item.match_index >= 0 && item.match && match_count >= parts.length;\n        });\n    } else {\n        results = item_list;\n    }\n    // Sort by order of relevence then name\n    results.sort((a, b) => {\n        const diff = a.match_index - b.match_index;\n        return diff === 0 ? a.name.localeCompare(b.name) : diff;\n    });\n    return results;\n}\n\n/**\n * Convert a match string from `filterList` to renderable HTML\n * @param str Match string to change\n */\nexport function matchToHighlight(str: string): string {\n    /* istanbul ignore else */\n    if (str) {\n        str = str.replace(/\\`[a-zA-Z0-9\\@\\.\\_]*\\`/g, '<span class=\"highlight\">$&</span>');\n        str = str.replace(/\\`/g, '');\n    }\n    return str;\n}\n\n/**\n * Convert time string to ms from UTC epoch for today\n * @param time Time string in the format `HH:mm`\n */\nexport function timeToDate(time: string): number {\n    const parts = time.split(':');\n    const date = dayjs()\n        .hour(+parts[0])\n        .minute(+parts[1])\n        .startOf('m');\n    return date.valueOf();\n}\n\n/**\n * Generate a random number\n * @param ceil Biggest value to generate not inclusive\n * @param floor Smallest value to generate. Defaults to 0\n */\nexport function randomInt(ceil: number, floor: number = 0) {\n    return Math.floor(Math.random() * (ceil - floor)) + floor;\n}\n\n/** Get time format string for locale */\nexport function timeFormatString(): string {\n    return is24HourTime() ? 'HH:mm' : 'h:mm A';\n}\n\n/** Whether locale string is displayed in 24 hour time */\nexport function is24HourTime(): boolean {\n    const date = new Date();\n    const localeString = date.toLocaleTimeString();\n    return localeString.indexOf('AM') < 0 && localeString.indexOf('PM') < 0;\n}\n\n/**\n * Downloads a file to the users computer with the given filename and contents\n * @param filename Name of the file to download\n * @param contents Contents of the file to download\n */\nexport function downloadFile(filename: string, contents: string) {\n    const element = document.createElement('a');\n    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(contents));\n    element.setAttribute('download', filename);\n\n    element.style.display = 'none';\n    document.body.appendChild(element);\n\n    element.click();\n\n    document.body.removeChild(element);\n}\n\n/**\n * Parse raw CSV data into a JSON object\n * @param csv CSV data to parse\n */\nexport function csvToJson(csv: string) {\n    const lines = csv.split('\\n');\n    let fields = lines.splice(0, 1)[0].split(',');\n    fields = fields.map((v) => v.replace('\\r', ''));\n    const list: any[] = [];\n    for (const line of lines) {\n        let parts = line.split(',');\n        parts = parts.map((v) => v.replace('\\r', ''));\n        /* istanbul ignore else */\n        if (parts.length >= fields.length) {\n            const item: any = {};\n            for (let i = 0; i <= parts.length; i++) {\n                let part = null;\n                part = parts[i];\n                /* istanbul ignore else */\n                if (part !== undefined) {\n                    item[(fields[i] || '').split(' ').join('_').toLowerCase()] = part;\n                }\n            }\n            list.push(item);\n        }\n    }\n\n    return list;\n}\n\n/**\n * Convert javascript array to CSV string\n * @param json Javascript array to convert\n */\nexport function jsonToCsv(json: HashMap[]) {\n    /* istanbul ignore else */\n    if (json instanceof Array && json.length > 0) {\n        const keys = Object.keys(json[0]);\n        const valid_keys = keys.filter((key) => json[0].hasOwnProperty(key));\n        return `\\uFEFF${valid_keys.join(',')}\\n${json\n            .map((item) => valid_keys.map((key) => item[key]).join(','))\n            .join('\\n')}`;\n    }\n    return '';\n}\n\n\n/* istanbul ignore next */\n/**\n * detect IE\n * returns version of IE or false, if browser is not Internet Explorer\n */\nexport function detectIE() {\n    var ua = window.navigator.userAgent;\n\n    var msie = ua.indexOf('MSIE ');\n    if (msie > 0) {\n        // IE 10 or older => return version number\n        return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\n    }\n\n    var trident = ua.indexOf('Trident/');\n    if (trident > 0) {\n        // IE 11 => return version number\n        var rv = ua.indexOf('rv:');\n        return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\n    }\n\n    var edge = ua.indexOf('Edge/');\n    if (edge > 0) {\n        // Edge (IE 12+) => return version number\n        return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\n    }\n\n    // other browser\n    return false;\n}\n\n/**\n * Grab point details from mouse or touch event\n * @param event Event to grab details from\n */\nexport function eventToPoint(event: MouseEvent | TouchEvent): Point {\n    if (!event) {\n        return { x: -1, y: -1 };\n    }\n    if (event instanceof MouseEvent) {\n        return { x: event.clientX, y: event.clientY };\n    } else {\n        return event.touches && event.touches.length > 0\n            ? { x: event.touches[0].clientX, y: event.touches[0].clientY }\n            : { x: -1, y: -1 };\n    }\n}\n\n/**\n * Flatten nested array\n * @param an_array Array to flatten\n */\nexport function flatten<T = any>(an_array: T[]) {\n    const stack = [...an_array];\n    const res = [];\n    while (stack.length) {\n        // pop value from stack\n        const next = stack.pop();\n        if (Array.isArray(next)) {\n            // push back array items, won't modify the original input\n            stack.push(...next);\n        } else {\n            res.push(next);\n        }\n    }\n    // reverse to restore input order\n    return res.reverse();\n}\n","import { AbstractControl } from '@angular/forms';\n\nimport { User } from '../../services/data/users/user.class';\n\nimport * as dayjs from 'dayjs';\n\nconst HAS_ERROR = true;\n\n/**\n * Check that control value is a date that is the same or after from date\n * @param control Angular form control\n * @param is_from Comparison date(ms from UTC epoch). Defaults to the current time\n */\nexport function validateDate(control: AbstractControl, is_from: number = dayjs().valueOf()) {\n    const from = dayjs(is_from);\n    const date = dayjs(control.value || undefined);\n    return date.isBefore(from, 'd') ? { date: HAS_ERROR, message: 'Booking needs to be made in the future' } : null;\n}\n\n/**\n * Build start time validation function\n * @param date Date of the time to check\n * @param is_from Comparison date(ms from UTC epoch). Defaults to the current time\n */\nexport function buildValidateStartTime(date: number, is_from: number = dayjs().valueOf()) {\n    return (c) => validateStartTime(c, date, is_from);\n}\n\n/**\n * Check that control value time is after the comparison date time\n * @param control Angular form control\n * @param date Date of the time to check\n * @param is_from Comparison date(ms from UTC epoch). Defaults to the current time\n */\nexport function validateStartTime(control: AbstractControl, date: number, is_from: number = dayjs().valueOf()) {\n    const now = dayjs(is_from);\n    const parts = control.value.split(':');\n    const date_obj = dayjs(date).hour(+parts[0]).minute(+parts[1]);\n    return date_obj.isBefore(now, 'm') ? { start: HAS_ERROR, message: 'Booking time needs to be made in the future' } : null;\n}\n\nexport function buildValidateDuration(min: number = 30, max: number = 240) {\n    return (c) => validateDuration(c, min, max);\n}\n\nexport function validateDuration(control: AbstractControl, min: number = 30, max: number = 240) {\n    if (control.value < (min || 30)) {\n        return { duration: HAS_ERROR, message: `Minimum booking duration is ${min} minute${min === 1 ? 's' : ''}` };\n    } else if (control.value > (max || 480)) {\n        return { length: HAS_ERROR, message: `Maximum booking duration is ${max} minute${max === 1 ? 's' : ''}` };\n    }\n    return null;\n}\n\nexport function buildValidateAttendees(host: User, min: number = 0) {\n    return (c) => validateAttendees(c, host, min);\n}\n\nexport function validateAttendees(control: AbstractControl, host: User, min: number = 0) {\n    if (!control || !(control.value instanceof Array)) {\n        return min > 0\n            ? { invalid: true, message: `Minimum of ${min} attendee${min === 1 ? ' is' : 's are'} required other than you` }\n            : null;\n    }\n    const list: User[] = control.value;\n    if (host) {\n        const result = list.find(a => a.email === host.email);\n        if (result) { list.splice(list.indexOf(result), 1); }\n    }\n    return list.length >= min ? null : {\n        count: true,\n        message: `Minimum of ${min} attendee${min === 1 ? ' is' : 's are'} required other than you`\n    };\n}\n\nexport function validateEndTime(date_control: AbstractControl) {\n    return (control: AbstractControl) => {\n        const date = dayjs(date_control ? date_control.value : undefined).add(control.value || 60, 'm');\n        return date.isBefore(dayjs(), 'm') ? { end_time: true } : null;\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\n\n@Component({\n    selector: 'app-catering',\n    templateUrl: './catering.component.html',\n    styleUrls: ['./catering.component.scss']\n})\nexport class CateringComponent extends BaseDirective implements OnInit {\n    /** Currently selected date */\n    public date: string;\n    /** Name of the page to display */\n    public page: string;\n    /** Filter string for searching */\n    public search_str: string;\n    /** Toggle for new category modal */\n    public category: number = 0;\n    /** Toggle for new package modal */\n    public package: number = 0;\n    /** Number of categories being displayed */\n    public length: number;\n    /** Order type to filter by */\n    public order_type: string = '';\n\n    constructor(private _route: ActivatedRoute) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.category = 0;\n        this.subscription('route.params', this._route.paramMap.subscribe((params) => {\n            if (params.has('page')) {\n                this.page = params.get('page');\n            }\n        }));\n    }\n}\n","<div class=\"catering\">\n    <a-sidebar></a-sidebar>\n    <div class=\"group\">\n        <a-topbar-header [(date)]=\"date\">\n            <div class=\"input-wrapper\" *ngIf=\"page\">\n                <mat-form-field [class.rounded]=\"true\" appearance=\"outline\">\n                    <app-icon [icon]=\"{ class: 'material-icons', content: 'search' }\" matPrefix></app-icon>\n                    <input matInput [(ngModel)]=\"search_str\" name=\"visitor-name\" placeholder=\"Search...\" />\n                    <button mat-icon-button matSuffix *ngIf=\"search_str\" (tapped)=\"search_str = ''\">\n                        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n                    </button>\n                </mat-form-field>\n                <mat-form-field *ngIf=\"page === 'orders'\" [class.other-field]=\"true\" appearance=\"outline\">\n                    <mat-select [(ngModel)]=\"order_type\">\n                        <mat-option [value]=\"''\">All Orders</mat-option>\n                        <mat-option [value]=\"'Pantry'\">Pantry Only</mat-option>\n                        <mat-option [value]=\"'Kitchen'\">Kitchen Only</mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <button mat-button *ngIf=\"page === 'menu'\" (tapped)=\"category = category + 1\">New Category</button>\n            <button mat-button *ngIf=\"page === 'menu' && length\" (tapped)=\"package = package + 1\">Add sub-category</button>\n        </a-topbar-header>\n        <main>\n            <ng-container [ngSwitch]=\"page\">\n                <ng-container *ngSwitchCase=\"'menu'\">\n                    <a-catering-menu [search]=\"search_str\" [category]=\"category\" [package]=\"package\" (length)=\"length=$event\"></a-catering-menu>\n                </ng-container>\n                <ng-container *ngSwitchCase=\"'orders'\">\n                    <a-catering-orders [date]=\"date\" [search]=\"search_str\" [type]=\"order_type\"></a-catering-orders>\n                </ng-container>\n                <ng-container *ngSwitchDefault>\n                    <div class=\"options\">\n                        <a class=\"card\" mat-button [routerLink]=\"['/catering', 'menu']\">\n                            <div class=\"content\">\n                                <div\n                                    class=\"img\"\n                                    [style.background]=\"\n                                        'linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(assets/img/menus.jpg)'\n                                            | safe: 'style'\n                                    \"\n                                >\n                                    <h2>Menus and Pricing</h2>\n                                </div>\n                                <div class=\"desc\">View and edit menus and pricing</div>\n                            </div>\n                        </a>\n                        <a class=\"card\" mat-button [routerLink]=\"['/catering', 'orders']\">\n                            <div class=\"content\">\n                                <div\n                                    class=\"img\"\n                                    [style.background]=\"\n                                        'linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(assets/img/orders.jpg)'\n                                            | safe: 'style'\n                                    \"\n                                >\n                                    <h2>Catering Orders</h2>\n                                </div>\n                                <div class=\"desc\">\n                                    View catering orders and their statuses upon arrival\n                                </div>\n                            </div>\n                        </a>\n                    </div>\n                </ng-container>\n            </ng-container>\n        </main>\n    </div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Route, RouterModule } from '@angular/router';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { CateringComponent } from './catering.component';\nimport { SharedContentModule } from 'src/app/shared/shared.module';\nimport { CateringOrdersComponent } from './orders/orders.component';\nimport { CateringMenuComponent } from './menu/menu.component';\nimport { CateringMenuItemListComponent } from './menu/item-list/item-list.component';\nimport { CateringMenuItemComponent } from './menu/item/item.component';\nimport { CateringCategoryModalComponent } from './overlays/category-modal/category-modal.component';\nimport { CateringGroupModalComponent } from './overlays/group-modal/group-modal.component';\nimport { CateringItemModalComponent } from './overlays/item-modal/item-modal.component';\nimport { CateringOrdersItemComponent } from './orders/item/item.component';\nimport { OrderDetailsModalComponent } from './overlays/order-details-modal/order-details-modal.component';\nimport { OrderDetailsItemsComponent } from './overlays/order-details-modal/items/items.component';\nimport { OrderBookingDetailsComponent } from './overlays/order-details-modal/booking-details/booking-details.component';\nimport { OrderDetailsNotesComponent } from './overlays/order-details-modal/messages/messages.component';\n\nconst ROUTES: Route[] = [\n    { path: '', component: CateringComponent },\n    { path: ':page', component: CateringComponent },\n    { path: '**', redirectTo: '' },\n];\n\n@NgModule({\n    declarations: [\n        CateringComponent,\n        CateringOrdersComponent,\n        CateringMenuComponent,\n        CateringMenuItemListComponent,\n        CateringMenuItemComponent,\n        CateringCategoryModalComponent,\n        CateringGroupModalComponent,\n        CateringItemModalComponent,\n        CateringOrdersItemComponent,\n        OrderDetailsModalComponent,\n        OrderDetailsItemsComponent,\n        OrderBookingDetailsComponent,\n        OrderDetailsNotesComponent,\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        RouterModule.forChild(ROUTES),\n        SharedContentModule,\n    ],\n})\nexport class CateringModule {}\n","import { Component, Input, SimpleChanges, OnChanges } from '@angular/core';\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\n\nimport { CateringCategory } from 'src/app/services/data/catering/catering-category.class';\nimport { CateringGroupModalComponent } from '../../overlays/group-modal/group-modal.component';\nimport { Building } from 'src/app/services/data/organisation/building.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\n\n@Component({\n    selector: 'a-catering-menu-item-list',\n    templateUrl: './item-list.component.html',\n    styleUrls: ['./item-list.component.scss'],\n})\nexport class CateringMenuItemListComponent extends BaseDirective implements OnChanges {\n    /** Category to display details for */\n    @Input() public category: CateringCategory;\n    /** Toggle for new groups */\n    @Input() public package: number;\n\n    /** Currently active building */\n    public get building(): Building {\n        return this._org.building;\n    }\n\n    constructor(private _dialog: MatDialog, private _org: OrganisationService) {\n        super();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.package && this.package) {\n            this.openGroupModal();\n        }\n    }\n\n    public openGroupModal(group?: CateringCategory) {\n        /* istanbul ignore else */\n        if (!group) {\n            group = new CateringCategory({\n                parent_id: this.category.id,\n                zones: [this.building.id],\n            });\n        }\n        const ref = this._dialog.open(CateringGroupModalComponent, {\n            data: { group, parent: this.category },\n        });\n        this.subscription(\n            'category_modal',\n            ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    const index = this.category.items.findIndex(\n                        (item) => event.metadata.id === item.id\n                    );\n                    if (index >= 0) {\n                        (this.category.items as any[]).splice(index, 1, event.metadata);\n                    } else {\n                        (this.category.items as any[]).push(event.metadata);\n                    }\n                }\n            })\n        );\n    }\n}\n","<div class=\"list\">\n    <ng-container *ngIf=\"category && category.items && category.items.length; else empty_state\">\n        <div class=\"item\" *ngFor=\"let item of category.items\">\n            <a-catering-menu-item [parent]=\"category\" [item]=\"item\"></a-catering-menu-item>\n        </div>\n    </ng-container>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No packages or sub-categories for {{ category.name }}</div>\n    </div>\n</ng-template>\n","import { Component, OnInit, Input, SimpleChanges } from '@angular/core';\n\nimport { CateringCategory } from 'src/app/services/data/catering/catering-category.class';\nimport { ANIMATION_SHOW_CONTRACT_EXPAND } from 'src/app/shared/globals/angular-animations';\nimport { MatDialog } from '@angular/material/dialog';\nimport { CateringGroupModalComponent } from '../../overlays/group-modal/group-modal.component';\nimport { CateringItem } from 'src/app/services/data/catering/catering-item.class';\nimport { ConfirmModalComponent } from 'src/app/overlays/confirm-modal/confirm-modal.component';\nimport { CateringComponent } from '../../catering.component';\nimport { DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { Building } from 'src/app/services/data/organisation/building.class';\nimport { CateringItemModalComponent } from '../../overlays/item-modal/item-modal.component';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\n\n@Component({\n    selector: 'a-catering-menu-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss'],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND],\n})\nexport class CateringMenuItemComponent extends BaseDirective {\n    /** Whether item is a child of another */\n    @Input() public subitem: boolean;\n    /** Item to display */\n    @Input() public item: CateringCategory;\n\n    @Input() public parent: CateringCategory;\n    /** Current symbol for the selected space */\n    @Input() public symbol: string;\n    /** Whether item should be disabled if not available anytime */\n    @Input() public disabled: boolean;\n    /** Whether to show children items */\n    public show_children: boolean;\n\n    /** Currently active building */\n    public get building(): Building {\n        return this._org.building;\n    }\n\n    constructor(private _dialog: MatDialog, private _org: OrganisationService) {\n        super();\n    }\n\n    public openGroupModal(group?: CateringCategory) {\n        /* istanbul ignore else */\n        if (!group) {\n            group = new CateringCategory({ parent_id: this.item.id, zones: [this.building.id] });\n        }\n        this._dialog.open(CateringGroupModalComponent, {\n            data: { group, parent: group.id ? this.parent : this.item },\n        });\n    }\n\n    public openItemModal(item?: CateringItem) {\n        /* istanbul ignore else */\n        if (!item) {\n            item = new CateringItem({ parent_id: this.item.id });\n        }\n        const ref = this._dialog.open(CateringItemModalComponent, {\n            data: { item, parent: item.id ? this.parent : this.item },\n        });\n        this.subscription('item-modal', ref.componentInstance.event.subscribe((event) => {\n            if (event.reason === 'done' && event.metadata) {\n                if (this.item.items) {\n                    (this.item.items as any[]).push(event.metadata);\n                }\n            }\n        }));\n\n    }\n\n    public deleteItem() {\n        const type =\n            this.item instanceof CateringComponent\n                ? this.item.package\n                    ? 'Package'\n                    : 'Sub-category'\n                : 'Item';\n        const ref = this._dialog.open(ConfirmModalComponent, {\n            data: {\n                title: `Delete catering ${type}`,\n                content: `Are you sure you want to delete the catering ${type} \"${\n                    this.item.name\n                }\"?<br />${\n                    this.item instanceof CateringCategory\n                        ? 'Any children items or groups will be <strong>immediately</strong> deleted'\n                        : ''\n                }`,\n                icon: { type: 'icon', class: 'material-icons', content: 'delete' },\n                action: 'Ok',\n            },\n        });\n        ref.componentInstance.event.subscribe((event: DialogEvent) => {\n            /* istanbul ignore else */\n            if (event.reason === 'done') {\n                ref.componentInstance.loading = `Deleting ${type}...`;\n            }\n        });\n    }\n}\n","<div\n    class=\"catering-item\"\n    *ngIf=\"item\"\n    [class.subitem]=\"subitem\"\n>\n    <div\n        class=\"image\"\n        *ngIf=\"!subitem\"\n        [style.background-image]=\"'url(' + item.image_path + ')'\"\n    ></div>\n    <div class=\"details\">\n        <div class=\"name\">{{ item.name }}</div>\n        <div class=\"description\">{{ item.package ? '[Package] ' : '' }}{{ item.description }}</div>\n        <div class=\"options\">\n            <div class=\"option price mobile-only\" *ngIf=\"item.unit_price\">\n                {{ item.unit_price / 100 | currency: symbol }}\n            </div>\n            <div\n                class=\"option\"\n                *ngIf=\"item.package && item.items.length && !item.must_select\"\n            >\n                Contains {{ item.items.length }} item{{ item.items.length === 1 ? '' : 's' }}\n            </div>\n            <div\n                class=\"option\"\n                *ngIf=\"item.package && item.must_select && item.amount > 0\"\n            >\n                <span class=\"not-mobile\">Selected </span>{{ item.must_select }} opt<span\n                    class=\"not-mobile\"\n                    >ion</span\n                >{{ item.items.length === 1 ? '' : 's' }}\n            </div>\n        </div>\n    </div>\n    <div class=\"option price not-mobile\" *ngIf=\"item.unit_price\">\n        {{ item.unit_price / 100 | currency: symbol }}\n    </div>\n    <button mat-icon-button name=\"more\" [matMenuTriggerFor]=\"appMenu\">\n        <app-icon [icon]=\"{ class:'material-icons', content: 'more_vert'}\"></app-icon>\n    </button>\n    <button\n        mat-icon-button\n        name=\"show-children\"\n        [class.hide]=\"!(item.items && item.items.length)\"\n        (tapped)=\"show_children = !show_children\"\n    >\n        <app-icon\n            [icon]=\"{\n                class: 'material-icons',\n                content: show_children ? 'keyboard_arrow_up' : 'keyboard_arrow_down'\n            }\"\n        ></app-icon>\n    </button>\n</div>\n<div class=\"children\" [@show]=\"show_children ? 'show' : 'hide'\">\n    <a-catering-menu-item\n        *ngFor=\"let sub_item of item.items\"\n        [subitem]=\"true\"\n        [symbol]=\"symbol\"\n        [parent]=\"item\"\n        [item]=\"sub_item\"\n    ></a-catering-menu-item>\n</div>\n<mat-menu #appMenu=\"matMenu\">\n    <ng-container *ngIf=\"item.items\">\n        <button mat-menu-item name=\"add-group\" (tapped)=\"openGroupModal()\">\n            <div class=\"group\">\n                <app-icon [icon]=\"{ class:'material-icons', content: 'add'}\"></app-icon>\n                <div class=\"text\">Add Group</div>\n            </div>\n        </button>\n        <button mat-menu-item name=\"add-item\" (tapped)=\"openItemModal()\">\n            <div class=\"group\">\n                <app-icon [icon]=\"{ class:'material-icons', content: 'add'}\"></app-icon>\n                <div class=\"text\">Add Item</div>\n            </div>\n        </button>\n    </ng-container>\n    <button mat-menu-item name=\"edit\" (tapped)=\"item.items ? openGroupModal(item) : openItemModal(item)\">\n        <div class=\"group\">\n            <app-icon [icon]=\"{ class:'material-icons', content: 'edit'}\"></app-icon>\n            <div class=\"text\">Edit {{ item.items ? (item.package ? 'Package' : 'Sub-category') : 'item' }}</div>\n        </div>\n    </button>\n    <button mat-menu-item name=\"delete\" class=\"delete\" (tapped)=\"deleteItem()\">\n        <div class=\"group\">\n            <app-icon [icon]=\"{ class:'material-icons', content: 'delete'}\"></app-icon>\n            <div class=\"text\">Delete {{ item.items ? (item.package ? 'Package' : 'Sub-category') : 'item' }}</div>\n        </div>\n    </button>\n</mat-menu>\n","import { Component, OnInit, Input, SimpleChanges, EventEmitter, Output } from '@angular/core';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { Building } from 'src/app/services/data/organisation/building.class';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { CateringCategory } from 'src/app/services/data/catering/catering-category.class';\nimport { MatDialog } from '@angular/material/dialog';\nimport { CateringCategoryModalComponent } from '../overlays/category-modal/category-modal.component';\nimport { HashMap, DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\nimport { CateringMenuService } from 'src/app/services/data/catering/catering-menu.service';\n\n@Component({\n    selector: 'a-catering-menu',\n    templateUrl: './menu.component.html',\n    styleUrls: ['./menu.component.scss'],\n})\nexport class CateringMenuComponent extends BaseDirective implements OnInit {\n    /** Filter string for catering items */\n    @Input() public search: string;\n    /** Opens new category modal on change */\n    @Input() public category: number;\n    /** Opens new category modal on change */\n    @Input() public package: number;\n    /** Emitter for changes to the length of catering categories */\n    @Output() public length = new EventEmitter<number>();\n    /** List of top level catering categories */\n    public catering_menu: CateringCategory[] = [];\n    /** Filtered list of top level catering categories */\n    public filtered_menu: CateringCategory[] = [];\n    /** Whether menu details are being loaded */\n    public loading: boolean;\n    /** Index of the active tab */\n    public index: number = 0;\n    /** Map of indexes to package open state */\n    public state: HashMap<number> = {};\n\n    /** Currently active building */\n    public get building(): Building {\n        return this._org.building;\n    }\n\n    constructor(private _service: ApplicationService, private _org: OrganisationService, private _menu: CateringMenuService, private _dialog: MatDialog) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.subscription(\n            'building',\n            this._org.listen('active_building').subscribe((_) => {\n                this.index = 0;\n                this.catering_menu = [];\n                this.filtered_menu = [];\n                this.loadCateringMenu();\n            })\n        );\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.search) {\n            this.filtered_menu = this.filter(this.catering_menu);\n        }\n        if (changes.category && this.category) {\n            this.openCategoryModal();\n        }\n        if (changes.package) {\n            this.state[this.index] = this.package;\n        }\n    }\n\n    public openCategoryModal(category?: CateringCategory) {\n        /* istanbul ignore else */\n        if (!category) {\n            category = new CateringCategory({ zones: [this.building.id] });\n        }\n        const ref = this._dialog.open(CateringCategoryModalComponent, { data: { category } });\n        this.subscription('category_modal', ref.componentInstance.event.subscribe((event: DialogEvent) => {\n            /* istanbul ignore else */\n            if (event.reason === 'done') {\n                const index = this.catering_menu.findIndex(item => event.metadata.id === item.id);\n                if (index >= 0) {\n                    this.catering_menu.splice(index, 1, event.metadata);\n                    this.index = index;\n                } else {\n                    this.index = this.catering_menu.length;\n                    this.catering_menu.push(event.metadata);\n                }\n            }\n        }));\n\n    }\n\n    private loadCateringMenu(): void {\n        /* istanbul ignore else */\n        if (this.building) {\n            this.loading = true;\n            this._menu.query({ zone_id: this.building.id }).then(\n                (menu: any[]) => {\n                    this.catering_menu = (menu || []).map((item) => new CateringCategory(item));\n                    this.length.emit(this.catering_menu.length);\n                    this.filtered_menu = this.filter(this.catering_menu);\n                    this.loading = false;\n                },\n                (err) => {\n                    this._service.notifyError(\n                        `Error loading menu for ${this.building.name}. Error: ${err.message | err}`,\n                        'Retry',\n                        () => this.loadCateringMenu()\n                    );\n                    this.loading = false;\n                }\n            );\n        }\n    }\n\n    /** Filter the list of catering items */\n    private filter(list: CateringCategory[]) {\n        return list;\n    }\n}\n","<div class=\"menu page dark-mode\">\n    <ng-container *ngIf=\"!loading; else load_state\">\n        <mat-tab-group *ngIf=\"filtered_menu && filtered_menu.length; else empty_state\" [(selectedIndex)]=\"index\">\n            <mat-tab *ngFor=\"let category of filtered_menu; let i = index\">\n                <ng-template mat-tab-label>\n                    <div class=\"tab-label\">\n                        <div class=\"label\">{{category?.name}}</div>\n                        <button mat-icon-button name=\"edit\" (click)=\"$event.stopPropagation()\" (tapped)=\"openCategoryModal(category)\">\n                            <app-icon [icon]=\"{ class: 'material-icons', content: 'edit' }\"></app-icon>\n                        </button>\n                    </div>\n                </ng-template>\n                <a-catering-menu-item-list [package]=\"state[i]\" [category]=\"category\"></a-catering-menu-item-list>\n            </mat-tab>\n        </mat-tab-group>\n    </ng-container>\n</div>\n<ng-template #load_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <mat-spinner diameter=\"32\"></mat-spinner>\n        </div>\n        <div class=\"text\">Loading menu for {{ building.name }}</div>\n    </div>\n</ng-template>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No menu categories for {{ building.name }}</div>\n    </div>\n</ng-template>\n","import { Component, OnInit, Input, SimpleChanges, OnChanges } from '@angular/core';\n\nimport {\n    CateringOrder,\n    CateringOrderStatus,\n} from 'src/app/services/data/catering/catering-order.class';\nimport { ANIMATION_SHOW_CONTRACT_EXPAND } from 'src/app/shared/globals/angular-animations';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { Identity, HashMap } from 'src/app/shared/utilities/types.utilities';\nimport { MatDialog } from '@angular/material/dialog';\nimport { OrderDetailsModalComponent } from '../../overlays/order-details-modal/order-details-modal.component';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\n\n@Component({\n    selector: 'a-catering-orders-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss'],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND],\n})\nexport class CateringOrdersItemComponent implements OnChanges {\n    /** Catering order details to display */\n    @Input() public order: CateringOrder;\n    /** Search filter string */\n    @Input() public search: string;\n    /** Whether order items should be shown */\n    public show_items: boolean;\n    /** Actively selected status */\n    public active_status: CateringOrderStatus;\n    /** Whether status is being updated */\n    public loading: boolean;\n\n    public get search_matches(): HashMap<boolean> {\n        const map = {};\n        const filter = this.search.toLowerCase();\n        this.order.items.forEach(item => {\n            map[item.id] = item.name.toLowerCase().indexOf(filter) >= 0;\n        });\n        return map;\n    }\n\n    public statuses: Identity[] = [\n        { id: 'accepted', name: 'Accepted', icon: { class: 'custom-accepted' }, colour: '#3996B6' },\n        {\n            id: 'preparing',\n            name: 'Preparing',\n            icon: { class: 'custom-preparing' },\n            colour: '#E7536B',\n        },\n        { id: 'ready', name: 'Ready', icon: { class: 'custom-ready' }, colour: '#FFD028' },\n        {\n            id: 'delivered',\n            name: 'Delivered',\n            icon: { class: 'custom-delivered' },\n            colour: '#75BB43',\n        },\n        {\n            id: 'cancelled',\n            name: 'Cancelled',\n            icon: { class: 'custom-cancelled' },\n            colour: '#747474',\n        },\n    ];\n\n    /** Details for the active status */\n    public get status_details(): Identity {\n        return this.statuses.find((status) => status.id === this.active_status) || ({} as any);\n    }\n\n    public get space(): Space {\n        return this._spaces.find(this.order.location_id);\n    }\n\n    constructor(private _service: ApplicationService, private _spaces: SpacesService, private _dialog: MatDialog) {}\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.order && this.order) {\n            this.active_status = this.order.status;\n        }\n    }\n\n    /** Update the status of the order in the booking */\n    public async updateStatus(): Promise<void> {\n        const booking = this.order.booking;\n        /* istanbul ignore else */\n        if (booking) {\n            this.loading = true;\n            const catering = [...booking.catering];\n            catering.splice(\n                catering.findIndex((order) => order.id === this.order.id),\n                1,\n                new CateringOrder({ ...this.order, status: this.active_status })\n            );\n            const new_booking = new Booking({ ...booking, catering });\n            await new_booking.save().catch((err) => {\n                this._service.notifyError(\n                    `Error updating order status. Error: ${err.message || err}`\n                );\n                this.active_status = this.order.status;\n            });\n            this.loading = false;\n        }\n    }\n\n    /** Open modal to view catering order details */\n    public viewOrderDetails(): void {\n        this._dialog.open(OrderDetailsModalComponent, {\n            maxHeight: '95vh',\n            maxWidth: '95vw',\n            data: {\n                order: this.order,\n                booking: this.order.booking\n            }\n        });\n    }\n}\n","<div class=\"order\" [class.showing]=\"show_items || search\">\n    <div class=\"details\" [class.showing]=\"show_items\" [class.not-match]=\"search\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'room_service' }\"></app-icon>\n        </div>\n        <div class=\"time\">{{ order.deliver_at_time }}</div>\n        <div class=\"location\">{{ order.location || space?.name }}</div>\n        <div class=\"host\">{{ order.booking?.organiser.name }}</div>\n        <div class=\"package-type\">\n            <ng-container *ngIf=\"order.kitchen\"><span>(K)</span> Kitchen<br /></ng-container>\n            <ng-container *ngIf=\"order.pantry\"><span>(P)</span> Pantry</ng-container>\n        </div>\n        <div class=\"status\">\n            <mat-form-field\n                class=\"rounded visible\"\n                appearance=\"outline\"\n                *ngIf=\"statuses && statuses.length > 1\"\n            >\n                <mat-select\n                    #select\n                    [(value)]=\"active_status\"\n                    (valueChange)=\"updateStatus()\"\n                    placeholder=\"New Order\"\n                    [disabled]=\"loading\"\n                >\n                    <mat-select-trigger>\n                        <div class=\"group\">\n                            <div class=\"icon\">\n                                <div\n                                    class=\"wrapper\"\n                                    [style.backgroundColor]=\"loading ? '#eee' : status_details?.colour\"\n                                >\n                                    <app-icon *ngIf=\"!loading\" [icon]=\"status_details?.icon\"></app-icon>\n                                    <mat-spinner *ngIf=\"loading\" diameter=\"16\"></mat-spinner>\n                                </div>\n                            </div>\n                            <div class=\"text\">{{ status_details?.name }}</div>\n                        </div>\n                    </mat-select-trigger>\n                    <mat-option *ngFor=\"let status of statuses\" [value]=\"status.id\">\n                        <div class=\"group\">\n                            <div class=\"text\">{{ status.name }}</div>\n                            <div class=\"colour\" [style.backgroundColor]=\"status.colour\"></div>\n                        </div>\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n        </div>\n        <button mat-icon-button name=\"view\" (tapped)=\"viewOrderDetails()\">\n            <app-icon\n                [icon]=\"{\n                    class: 'material-icons',\n                    content: 'visibility'\n                }\"\n            ></app-icon>\n        </button>\n        <div class=\"more\">\n            <button mat-icon-button name=\"more\" (tapped)=\"show_items = !show_items\">\n                <app-icon\n                    [icon]=\"{\n                        class: 'material-icons',\n                        content: show_items ? 'keyboard_arrow_down' : 'keyboard_arrow_right'\n                    }\"\n                ></app-icon>\n            </button>\n        </div>\n    </div>\n    <div class=\"list\" [@show]=\"show_items || search ? 'show' : 'hide'\">\n        <div class=\"bar\"></div>\n        <div class=\"item\" *ngFor=\"let item of order.items\" [class.not-match]=\"search && !search_matches[item.id]\">\n            <div class=\"icon\">\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'local_pizza' }\"></app-icon>\n            </div>\n            <div class=\"item-details\">\n                <div class=\"name\">{{ item.name }}</div>\n                <div class=\"quanity\">x {{ item.amount }}</div>\n            </div>\n            <div class=\"bar\"></div>\n        </div>\n    </div>\n</div>\n","import { Component, OnInit, Input, SimpleChanges, OnChanges } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Observable, Subject, of } from 'rxjs';\nimport {\n    debounceTime,\n    distinctUntilChanged,\n    switchMap,\n    catchError,\n    map,\n    first,\n} from 'rxjs/operators';\n\nimport { CateringOrder } from 'src/app/services/data/catering/catering-order.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { Building } from 'src/app/services/data/organisation/building.class';\nimport { unique } from 'src/app/shared/utilities/general.utilities';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { CateringCategory } from 'src/app/services/data/catering/catering-category.class';\nimport { OrderDetailsModalComponent } from '../overlays/order-details-modal/order-details-modal.component';\n\nimport * as dayjs from 'dayjs';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\n\n@Component({\n    selector: 'a-catering-orders',\n    templateUrl: './orders.component.html',\n    styleUrls: ['./orders.component.scss'],\n})\nexport class CateringOrdersComponent extends BaseDirective implements OnInit, OnChanges {\n    /** Search filter string */\n    @Input() public search: string = '';\n    /** Currently selected date */\n    @Input() public date: number;\n    /** Type of order to show */\n    @Input() public type: '' | 'Pantry' | 'Kitchen';\n    /** List of catering orders for the selected date */\n    public orders: CateringOrder[] = [];\n    /** List of catering orders for the selected date */\n    public filtered_orders: CateringOrder[] = [];\n    /** Whether catering orders are loading */\n    public loading: boolean;\n    /** List of space IDs for active building */\n    public available_spaces: string[] = [];\n    /** List of items from an API search */\n    public search_results$: Observable<CateringOrder[]>;\n    /** Subject holding the value of the search */\n    public readonly search$ = new Subject<string>();\n\n    /** Display string for the currenly selected date */\n    public get date_display(): string {\n        const date = dayjs(this.date);\n        return dayjs().isSame(date, 'd') ? 'Today' : date.format('DD MMM YYYY');\n    }\n\n    /** Active building */\n    public get building(): Building {\n        return this._org.building;\n    }\n\n    constructor(\n        private _spaces: SpacesService,\n        private _org: OrganisationService,\n        private _route: ActivatedRoute,\n        private _dialog: MatDialog\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._spaces.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.subscription(\n                'building',\n                this._org.listen('active_building').subscribe(() => {\n                    this.search$.next(`${this.date}|${this.building.id}`);\n                    this.available_spaces = this._spaces.filter(\n                        (space) => space.zones.indexOf(this.building.id) >= 0\n                    ).map((i) => i.id);\n                })\n            );\n            this.available_spaces = this._spaces.filter(\n                (space) => space.zones.indexOf(this.building.id) >= 0\n            ).map((i) => i.id);\n            this.initBookings();\n            this.interval(\n                'update_bookings',\n                () => this.search$.next(`${this.date}|${this.building.id}|${dayjs().unix()}`),\n                30 * 1000\n            );\n            this.search$.next(`${this.date}|${this.building.id}|${dayjs().unix()}`);\n            this.subscription(\n                'route.query',\n                this._route.queryParamMap.subscribe((params) => {\n                    /* istanbul ignore else */\n                    if (params.has('view')) {\n                        const view_id = params.get('view');\n                        const details = localStorage.getItem('CONCIERGE.view_order');\n                        const booking_details = localStorage.getItem('CONCIERGE.view_booking');\n                        /* istanbul ignore else */\n                        if (details) {\n                            const booking = new Booking(JSON.parse(booking_details));\n                            const order = new CateringOrder(JSON.parse(details));\n                            order.booking = booking;\n                            this.viewOrderDetails(order);\n                            localStorage.removeItem('CONCIERGE.view_order');\n                            localStorage.removeItem('CONCIERGE.view_booking');\n                        }\n                    }\n                })\n            );\n        });\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.date && this.building) {\n            this.search$.next(`${this.date}|${this.building.id}`);\n        }\n        /* istanbul ignore else */\n        if (changes.search || changes.type) {\n            this.filtered_orders = this.filter(this.orders, this.search);\n        }\n    }\n\n    /* istanbul ignore next */\n    public trackByFn(index: number, order: CateringOrder) {\n        return order ? order.id : undefined;\n    }\n\n    /** Open modal to view catering order details */\n    public viewOrderDetails(order: CateringOrder): void {\n        this._dialog.open(OrderDetailsModalComponent, {\n            maxHeight: '95vh',\n            maxWidth: '95vw',\n            data: {\n                order: order,\n                booking: order.booking,\n            },\n        });\n    }\n\n    /**\n     * Filter list to find matching items\n     * @param list List of orders to filter\n     * @param search Filter string\n     */\n    private filter(list: CateringOrder[], search: string = '') {\n        const filter = search.toLowerCase();\n        return list.filter((order) => {\n            return (\n                (!this.type ||\n                    (this.type === 'Pantry' && order.pantry) ||\n                    (this.type === 'Kitchen' && order.kitchen)) &&\n                order.items.find(\n                    (item: CateringCategory) =>\n                        item.name.toLowerCase().indexOf(filter) >= 0 ||\n                        (item.items &&\n                            item.items.find((sub_item: CateringCategory) => {\n                                return (\n                                    sub_item.name.toLowerCase().indexOf(filter) >= 0 ||\n                                    (sub_item.items &&\n                                        sub_item.items.find((sub_sub_item) => {\n                                            return (\n                                                sub_sub_item.name.toLowerCase().indexOf(filter) >= 0\n                                            );\n                                        }))\n                                );\n                            }))\n                )\n            );\n        });\n    }\n\n    private initBookings() {\n        // Listen for input changes\n        this.search_results$ = this.search$.pipe(\n            debounceTime(100),\n            distinctUntilChanged(),\n            switchMap((_) => {\n                this.loading = true;\n                const date = dayjs(this.date).startOf('d');\n                return this._spaces.query({\n                    zone_ids: this.building.id,\n                    available_from: date.unix(),\n                    available_to: date.endOf('d').unix(),\n                });\n            }),\n            catchError((_) => of([])),\n            map((space_list: Space[]) => {\n                let orders: CateringOrder[] = [];\n                space_list.forEach((space) => {\n                    space.bookings.forEach((booking) => {\n                        const catering = booking.catering;\n                        catering.forEach((order) => {\n                            (order as any).booking_date = booking.date;\n                            order.booking = booking;\n                        });\n                        orders = orders.concat(booking.catering);\n                    });\n                });\n                orders = unique(orders, 'id');\n                orders = orders.filter(\n                    (order) => this.available_spaces.indexOf(order.location_id) >= 0\n                );\n                orders.sort(\n                    (a, b) =>\n                        a.booking_date +\n                        a.delivery_time * 60 * 1000 -\n                        (b.booking_date + b.delivery_time * 60 * 1000)\n                );\n                return orders;\n            })\n        );\n        // Process API results\n        this.subscription(\n            'search_results',\n            this.search_results$.subscribe((list) => {\n                this.loading = false;\n                this.orders = list;\n                this.filtered_orders = this.filter(list, this.search);\n            })\n        );\n    }\n}\n","<div class=\"loader\" *ngIf=\"loading\">\n    <mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>\n</div>\n<div class=\"heading\">\n    <div class=\"icon\"></div>\n    <div class=\"time\">Time</div>\n    <div class=\"location\">Location</div>\n    <div class=\"host\">Host</div>\n    <div class=\"types\">Package Types</div>\n    <div class=\"state\">Status</div>\n</div>\n<div class=\"list\">\n    <ng-container *ngIf=\"filtered_orders && filtered_orders.length; else empty_state\">\n        <div class=\"top-row\"></div>\n        <a-catering-orders-item\n            *ngFor=\"let order of filtered_orders; trackBy: trackByFn\"\n            [order]=\"order\"\n            [search]=\"search\"\n        ></a-catering-orders-item>\n    </ng-container>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No catering orders for {{ date_display }}</div>\n    </div>\n</ng-template>\n","import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { UploadManager, Amazon } from '@acaprojects/ngx-uploads';\n\nimport { CateringCategory } from 'src/app/services/data/catering/catering-category.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { DialogEvent } from 'src/app/shared/utilities/types.utilities';\n\nimport * as blobUtil from 'blob-util';\nimport { CateringCategoriesService } from 'src/app/services/data/catering/catering-categories.service';\n\nexport interface CateringCategoryModalData {\n    /** Category to edit */\n    category: CateringCategory;\n}\n\n@Component({\n    selector: 'a-catering-category-modal',\n    templateUrl: './category-modal.component.html',\n    styleUrls: ['./category-modal.component.scss'],\n})\nexport class CateringCategoryModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form controls for editing category */\n    public form: FormGroup;\n    /** Display string for current loading state */\n    public loading: string;\n    /** Whether image is being uploaded */\n    public uploading: boolean;\n\n    public get category(): CateringCategory {\n        return this._data.category;\n    }\n\n    public get image(): string {\n        return this.form.controls.image_path.value;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _menu_categories: CateringCategoriesService,\n        private _upload_manager: UploadManager,\n        private _dialog_ref: MatDialogRef<CateringCategoryModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: CateringCategoryModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.form = new FormGroup({\n            name: new FormControl(this.category.name, [Validators.required]),\n            description: new FormControl(this.category.description),\n            image_path: new FormControl(this.category.image_path),\n        });\n    }\n\n    public submit() {\n        this.form.markAllAsTouched();\n        /* istanbul ignore else */\n        if (this.form.valid) {\n            const data = { ...this.category.toJSON(), ...this.form.value };\n            const request = this.category.id\n                ? this._menu_categories.update(this.category.id, data)\n                : this._menu_categories.add(data);\n            request.then(\n                (item) => {\n                    this.event.emit({ reason: 'done', metadata: item });\n                    this._dialog_ref.close();\n                },\n                (err) =>\n                    this._service.notifyError(\n                        `Error ${this.category.id ? 'updating' : 'creating'} category. Error: ${\n                            err.message || err\n                        }`\n                    )\n            );\n        }\n    }\n\n    /** Upload the image to the cloud */\n    public uploadImage(event) {\n        /* istanbul ignore else */\n        if (event && event.target && event.target.files) {\n            const files: FileList = event.target.files;\n            /* istanbul ignore else */\n            if (files.length) {\n                const fileReader = new FileReader();\n                fileReader.addEventListener('loadend', (e: any) => {\n                    this.uploading = true;\n                    const arrayBuffer = e.target.result;\n                    const blob = blobUtil.arrayBufferToBlob(arrayBuffer, 'image/png');\n                    this._upload_manager.upload([blob], { file_name: files[0].name });\n                    const upload = this._upload_manager.uploads[\n                        this._upload_manager.uploads.length - 1\n                    ];\n                    this.interval('upload', () => {\n                        /* istanbul ignore else */\n                        if (upload.complete || upload.error) {\n                            /* istanbul ignore else */\n                            if (upload.access_url && upload.complete) {\n                                this.form.controls.image_path.setValue(upload.access_url);\n                            }\n                            this.uploading = false;\n                            this.clearInterval('upload');\n                        }\n                    });\n                });\n                fileReader.readAsArrayBuffer(files[0]);\n            }\n        }\n    }\n}\n","<header>\n    <div class=\"heading\">{{ category.id ? 'Edit' : 'Add' }} category</div>\n    <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main *ngIf=\"!loading; else load_state\">\n        <form [formGroup]=\"form\" *ngIf=\"form\">\n            <div class=\"field\">\n                <div\n                    class=\"image\"\n                    [style.background]=\"\n                        'linear-gradient(rgba(0,0,0,.35),rgba(0,0,0,.35)), url(' + image + ')'\n                            | safe: 'style'\n                    \"\n                >\n                    <app-icon\n                        *ngIf=\"!uploading\"\n                        [icon]=\"{ class: 'material-icons', content: 'cloud_upload' }\"\n                    ></app-icon>\n                    <mat-spinner *ngIf=\"uploading\" diameter=\"48\"></mat-spinner>\n                    <input type=\"file\" (change)=\"uploadImage($event)\" />\n                </div>\n            </div>\n            <div class=\"field\">\n                <label\n                    for=\"name\"\n                    [class.error]=\"form.controls.name.errors && form.controls.name.touched\"\n                    >Name<span>*</span></label\n                >\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"name\"\n                        placeholder=\"Category Name\"\n                        formControlName=\"name\"\n                    />\n                    <mat-error>A valid name is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"description\">Description</label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"description\"\n                        placeholder=\"Category Description\"\n                        formControlName=\"description\"\n                    ></textarea>\n                </mat-form-field>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button [disabled]=\"uploading\" (tapped)=\"submit()\">Save</button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main>\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </main>\n</ng-template>\n","import { Component, OnInit, Inject, EventEmitter, Output } from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { UploadManager } from '@acaprojects/ngx-uploads';\n\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { CateringCategory } from 'src/app/services/data/catering/catering-category.class';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { DialogEvent, Identity } from 'src/app/shared/utilities/types.utilities';\n\nimport * as blobUtil from 'blob-util';\nimport { CateringCategoriesService } from 'src/app/services/data/catering/catering-categories.service';\n\nexport interface CateringGroupModalData {\n    group: CateringCategory;\n    parent: CateringCategory;\n}\n\n@Component({\n    selector: 'a-catering-group-modal',\n    templateUrl: './group-modal.component.html',\n    styleUrls: ['./group-modal.component.scss'],\n})\nexport class CateringGroupModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form controls for editing category */\n    public form: FormGroup;\n    /** Display string for current loading state */\n    public loading: string;\n    /** Whether image is being uploaded */\n    public uploading: boolean;\n    /** List of available catering types */\n    public readonly types: Identity[] = [\n        { id: 'kitchen', name: 'Kitchen' },\n        { id: 'pantry', name: 'Pantry' },\n    ];\n\n    /** Category being edit/created */\n    public get category(): CateringCategory {\n        return this._data.group;\n    }\n\n    /** Parent category of the catergory being created/edited */\n    public get parent(): CateringCategory {\n        return this._data.parent;\n    }\n\n    /** Image URL for the category */\n    public get image(): string {\n        return this.form.controls.image_path.value;\n    }\n\n    /** Whether category is a package */\n    public get package(): boolean {\n        return this.form.controls.package.value;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _menu_categories: CateringCategoriesService,\n        private _upload_manager: UploadManager,\n        private _dialog_ref: MatDialogRef<CateringGroupModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: CateringGroupModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.form = new FormGroup({\n            name: new FormControl(this.category.name, [Validators.required]),\n            description: new FormControl(this.category.description),\n            image_path: new FormControl(this.category.image_path),\n            catering_type: new FormControl(this.category.catering_type, [Validators.required]),\n            package: new FormControl(this.category.package || false),\n            must_select: new FormControl(this.category.must_select),\n            unit_price: new FormControl(this.category.unit_price),\n            minimum_quantity: new FormControl(this.category.minimum_quantity),\n            maximum_quantity: new FormControl(this.category.maximum_quantity),\n            order_anytime: new FormControl(this.category.order_anytime),\n            out_of_stock: new FormControl(this.category.out_of_stock),\n        });\n    }\n\n    public submit() {\n        this.form.markAllAsTouched();\n        /* istanbul ignore else */\n        if (this.form.valid) {\n            const data = { ...this.category.toJSON(), ...this.form.value };\n            const request = this.category.id\n                ? this._menu_categories.update(this.category.id, data)\n                : this._menu_categories.add(data);\n            request.then(\n                (item) => {\n                    this.event.emit({ reason: 'done', metadata: item });\n                    this._dialog_ref.close();\n                },\n                (err) =>\n                    this._service.notifyError(\n                        `Error ${this.category.id ? 'updating' : 'creating'} category. Error: ${\n                            err.message || err\n                        }`\n                    )\n            );\n        }\n    }\n\n    /** Upload the image to the cloud */\n    public uploadImage(event) {\n        /* istanbul ignore else */\n        if (event && event.target && event.target.files) {\n            const files: FileList = event.target.files;\n            /* istanbul ignore else */\n            if (files.length) {\n                const fileReader = new FileReader();\n                fileReader.addEventListener('loadend', (e: any) => {\n                    this.uploading = true;\n                    const arrayBuffer = e.target.result;\n                    const blob = blobUtil.arrayBufferToBlob(arrayBuffer, 'image/png');\n                    this._upload_manager.upload([blob], { file_name: files[0].name });\n                    const upload = this._upload_manager.uploads[\n                        this._upload_manager.uploads.length - 1\n                    ];\n                    this.interval('upload', () => {\n                        /* istanbul ignore else */\n                        if (upload.complete || upload.error) {\n                            /* istanbul ignore else */\n                            if (upload.access_url && upload.complete) {\n                                this.form.controls.image_path.setValue(upload.access_url);\n                            }\n                            this.uploading = false;\n                            this.clearInterval('upload');\n                        }\n                    });\n                });\n                fileReader.readAsArrayBuffer(files[0]);\n            }\n        }\n    }\n}\n","<header>\n    <div class=\"heading\">\n        {{ category.id ? 'Edit' : 'Add' }} {{ package ? 'package' : 'sub-category' }}\n    </div>\n    <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main *ngIf=\"!loading; else load_state\">\n        <form [formGroup]=\"form\">\n            <div class=\"field\">\n                <div\n                    class=\"image\"\n                    [style.background]=\"\n                        'linear-gradient(rgba(0,0,0,.35),rgba(0,0,0,.35)), url(' + image + ')'\n                            | safe: 'style'\n                    \"\n                >\n                    <app-icon\n                        *ngIf=\"!uploading\"\n                        [icon]=\"{ class: 'material-icons', content: 'cloud_upload' }\"\n                    ></app-icon>\n                    <mat-spinner *ngIf=\"uploading\" diameter=\"48\"></mat-spinner>\n                    <input type=\"file\" (change)=\"uploadImage($event)\" />\n                </div>\n            </div>\n            <div class=\"field padded\">\n                <label for=\"name\">Parent Category</label>\n                <div class=\"value\">{{ parent.name }}</div>\n            </div>\n            <div class=\"field padded\">\n                <mat-checkbox formControlName=\"package\">Package</mat-checkbox>\n            </div>\n            <div class=\"field\">\n                <label\n                    for=\"name\"\n                    [class.error]=\"form.controls.name.errors && form.controls.name.touched\"\n                    >Name<span>*</span></label\n                >\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"name\"\n                        placeholder=\"Category Name\"\n                        formControlName=\"name\"\n                    />\n                    <mat-error>A valid name is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label\n                    for=\"type\"\n                    [class.error]=\"\n                        form.controls.catering_type.errors && form.controls.catering_type.touched\n                    \"\n                    >Type<span>*</span></label\n                >\n                <mat-form-field appearance=\"outline\">\n                    <mat-select\n                        name=\"type\"\n                        formControlName=\"catering_type\"\n                        placeholder=\"Select type\"\n                    >\n                        <mat-option *ngFor=\"let type of types\" [value]=\"type.id\">\n                            {{ type.name }}\n                        </mat-option>\n                    </mat-select>\n                    <mat-error>Type is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"description\">Description</label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"description\"\n                        placeholder=\"Category Description\"\n                        formControlName=\"description\"\n                    ></textarea>\n                </mat-form-field>\n            </div>\n            <ng-container *ngIf=\"package\">\n                <div class=\"field padded\">\n                    <mat-checkbox formControlName=\"out_of_stock\">Out of Stock</mat-checkbox>\n                </div>\n                <div class=\"field padded\">\n                    <mat-checkbox formControlName=\"order_anytime\">Can order anytime</mat-checkbox>\n                </div>\n                <div class=\"field\">\n                    <label for=\"unit-price\">Unit Price</label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"unit-price\"\n                            type=\"number\"\n                            placeholder=\"Price for one unit of the item without decimal places\"\n                            formControlName=\"unit_price\"\n                        />\n                    </mat-form-field>\n                </div>\n            </ng-container>\n            <div class=\"field\">\n                <label for=\"must-select\"\n                    >Items to select from {{ package ? 'package' : 'sub-category' }}</label\n                >\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"must-select\"\n                        type=\"number\"\n                        placeholder=\"Must select X items from grouping\"\n                        formControlName=\"must_select\"\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"min-quanity\">Minimum Quanity</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"min-quanity\"\n                        type=\"number\"\n                        placeholder=\"Minimum Quantity\"\n                        formControlName=\"minimum_quantity\"\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"max-quanity\">Maximum Quanity</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"max-quanity\"\n                        type=\"number\"\n                        placeholder=\"Maximum Quantity\"\n                        formControlName=\"maximum_quantity\"\n                    />\n                </mat-form-field>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button [disabled]=\"uploading\" (tapped)=\"submit()\">Save</button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main>\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </main>\n</ng-template>\n","import { Component, OnInit, Inject, EventEmitter, Output } from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { CateringItem } from 'src/app/services/data/catering/catering-item.class';\nimport { CateringCategory } from 'src/app/services/data/catering/catering-category.class';\nimport { DialogEvent, Identity } from 'src/app/shared/utilities/types.utilities';\nimport { CateringItemsService } from 'src/app/services/data/catering/catering-items.service';\n\nexport interface CateringItemModalData {\n    item: CateringItem;\n    parent: CateringCategory;\n}\n\n@Component({\n    selector: 'a-catering-item-modal',\n    templateUrl: './item-modal.component.html',\n    styleUrls: ['./item-modal.component.scss'],\n})\nexport class CateringItemModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form controls for editing category */\n    public form: FormGroup;\n    /** Display string for current loading state */\n    public loading: string;\n    /** Whether image is being uploaded */\n    public uploading: boolean;\n    /** List of available catering types */\n    public readonly types: Identity[] = [\n        { id: 'kitchen', name: 'Kitchen' },\n        { id: 'pantry', name: 'Pantry' },\n    ];\n\n    /** Category being edit/created */\n    public get item(): CateringItem {\n        return this._data.item;\n    }\n\n    /** Parent category of the catergory being created/edited */\n    public get parent(): CateringCategory {\n        return this._data.parent;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _menu_items: CateringItemsService,\n        private _dialog_ref: MatDialogRef<CateringItemModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: CateringItemModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.form = new FormGroup({\n            name: new FormControl(this.item.name, [Validators.required]),\n            description: new FormControl(this.item.description),\n            catering_type: new FormControl(this.item.catering_type, [Validators.required]),\n            supplier_cost: new FormControl(this.item.supplier_cost),\n            unit_price: new FormControl(this.item.unit_price),\n            minimum_quantity: new FormControl(this.item.minimum_quantity),\n            maximum_quantity: new FormControl(this.item.maximum_quantity),\n            order_anytime: new FormControl(this.item.order_anytime),\n            out_of_stock: new FormControl(this.item.out_of_stock),\n            allergy: new FormControl(this.item.allergy),\n            parent_categories: new FormControl([this._data.parent.id])\n        });\n    }\n\n    public submit() {\n        this.form.markAllAsTouched();\n        /* istanbul ignore else */\n        if (this.form.valid) {\n            const data = new CateringItem({ ...this.item.toJSON(), ...this.form.value }).toJSON();\n            const request = this.item.id\n                ? this._menu_items.update(this.item.id, data)\n                : this._menu_items.add(data);\n            request.then(\n                (item) => {\n                    this.event.emit({ reason: 'done', metadata: item });\n                    this._dialog_ref.close();\n                },\n                (err) =>\n                    this._service.notifyError(\n                        `Error ${this.item.id ? 'updating' : 'creating'} item. Error: ${\n                            err.message || err\n                        }`\n                    )\n            );\n        }\n    }\n}\n","<header>\n    <div class=\"heading\">{{ item.id ? 'Edit' : 'Add' }} catering item</div>\n    <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main *ngIf=\"!loading; else load_state\">\n        <form [formGroup]=\"form\">\n            <div class=\"field padded\">\n                <label for=\"name\">Parent Category</label>\n                <div class=\"value\">{{ parent.name }}</div>\n            </div>\n            <div class=\"field\">\n                <label\n                    for=\"name\"\n                    [class.error]=\"form.controls.name.errors && form.controls.name.touched\"\n                    >Name<span>*</span></label\n                >\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"name\"\n                        placeholder=\"Category Name\"\n                        formControlName=\"name\"\n                    />\n                    <mat-error>A valid name is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label\n                    for=\"type\"\n                    [class.error]=\"\n                        form.controls.catering_type.errors && form.controls.catering_type.touched\n                    \"\n                    >Type<span>*</span></label\n                >\n                <mat-form-field appearance=\"outline\">\n                    <mat-select\n                        name=\"type\"\n                        formControlName=\"catering_type\"\n                        placeholder=\"Select type\"\n                    >\n                        <mat-option *ngFor=\"let type of types\" [value]=\"type.id\">\n                            {{ type.name }}\n                        </mat-option>\n                    </mat-select>\n                    <mat-error>Type is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"description\">Description</label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"description\"\n                        placeholder=\"Category Description\"\n                        formControlName=\"description\"\n                    ></textarea>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"allergy\">Allegen Information</label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"allergy\"\n                        placeholder=\"Allergy details about the item\"\n                        formControlName=\"allergy\"\n                    ></textarea>\n                </mat-form-field>\n            </div>\n            <div class=\"field padded\">\n                <mat-checkbox formControlName=\"out_of_stock\">Out of Stock</mat-checkbox>\n            </div>\n            <div class=\"field padded\">\n                <mat-checkbox formControlName=\"order_anytime\">Can order anytime</mat-checkbox>\n            </div>\n            <div class=\"field\">\n                <label for=\"supplier-price\">Supplier Price</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"supplier-price\"\n                        type=\"number\"\n                        placeholder=\"Price for one unit of the item from the supplier\"\n                        formControlName=\"supplier_cost\"\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"unit-price\">Unit Price</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"unit-price\"\n                        type=\"number\"\n                        placeholder=\"Price for one unit of the item without decimal places\"\n                        formControlName=\"unit_price\"\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"min-quanity\">Minimum Quanity</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"min-quanity\"\n                        type=\"number\"\n                        placeholder=\"Minimum Quantity\"\n                        formControlName=\"minimum_quantity\"\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"max-quanity\">Maximum Quanity</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"max-quanity\"\n                        type=\"number\"\n                        placeholder=\"Maximum Quantity\"\n                        formControlName=\"maximum_quantity\"\n                    />\n                </mat-form-field>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button [disabled]=\"uploading\" (tapped)=\"submit()\">Save</button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main>\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </main>\n</ng-template>\n","import { Component, OnInit, Input } from '@angular/core';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\n\n@Component({\n    selector: 'order-booking-details',\n    templateUrl: './booking-details.component.html',\n    styleUrls: ['./booking-details.component.scss'],\n})\nexport class OrderBookingDetailsComponent {\n    /** Booking details to display */\n    @Input() public booking: Booking;\n\n    /** Store booking details to be used in another component */\n    public storeBooking() {\n        localStorage.setItem('CONCIERGE.view_booking', JSON.stringify(this.booking.toJSON()));\n        localStorage.setItem('CONCIERGE.date', `${this.booking.date}`);\n    }\n}\n","<div class=\"heading\">\n    Meeting Details\n</div>\n<div class=\"content\">\n    <div class=\"field\">\n        <label for=\"host\">Host:</label>\n        <div class=\"value\" name=\"host\">\n            {{ booking.organiser?.name }}\n        </div>\n    </div>\n    <div class=\"field\">\n        <label for=\"space\">Room:</label>\n        <div class=\"value\" name=\"space\">\n            {{ booking.space?.name }}\n        </div>\n    </div>\n    <div class=\"field\">\n        <label for=\"period\">Period:</label>\n        <div class=\"value\" name=\"period\">\n            {{ booking.time_period }}\n        </div>\n    </div>\n    <div class=\"field\">\n        <label for=\"attendees\">Attendees:</label>\n        <div class=\"value\" name=\"attendees\">\n            {{ booking.attendees?.length || '0' }}({{ booking.expected_attendees[booking.space?.id] || 0 }} expected)\n        </div>\n    </div>\n</div>\n<a\n    class=\"footer\"\n    button\n    mat-button\n    [routerLink]=\"['/day-view', booking.space?.level.id]\"\n    [queryParams]=\"{ view: booking.id.slice(0, 10) }\"\n    (click)=\"storeBooking()\"\n    mat-dialog-close\n>\n    View on Day View\n</a>\n","import { Component, Input } from '@angular/core';\n\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { CateringOrder } from 'src/app/services/data/catering/catering-order.class';\nimport { CateringCategory } from 'src/app/services/data/catering/catering-category.class';\n\n@Component({\n    selector: 'order-details-items',\n    templateUrl: './items.component.html',\n    styleUrls: ['./items.component.scss'],\n})\nexport class OrderDetailsItemsComponent {\n    /** Booking details to display */\n    @Input() public booking: Booking;\n    /** Catering order to display notes for */\n    @Input() public order: CateringOrder;\n\n    /** List of items in the order */\n    public get items(): (CateringCategory)[] {\n        return this.order.items as any || [];\n    }\n}\n","<div class=\"heading\">\n    Order Details\n</div>\n<div class=\"content\">\n    <ng-container *ngIf=\"items && items.length; else empty_state\">\n        <div class=\"item\" *ngFor=\"let item of items\">\n            <div class=\"details\">\n                <div class=\"name\">{{ item.name }}</div>\n                <div class=\"amount\">x{{ item.amount }}</div>\n            </div>\n            <ng-container *ngIf=\"item.items\">\n                <div class=\"sub-item\" *ngFor=\"let sub_item of item.items\">\n                    <div class=\"name\">{{ sub_item.name }}</div>\n                    <ng-container *ngIf=\"sub_item.items\">\n                        <div class=\"sub-item\" *ngFor=\"let sub_sub_item of sub_item.items\">\n                            <div class=\"name\">{{ sub_sub_item.name }}</div>\n                        </div>\n                    </ng-container>\n                </div>\n            </ng-container>\n        </div>\n    </ng-container>\n</div>\n<button class=\"footer\" mat-button>\n    Edit Order\n</button>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">\n            No items in order\n        </div>\n    </div>\n</ng-template>\n","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\n\nimport { CateringOrder } from 'src/app/services/data/catering/catering-order.class';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { BookingNote } from 'src/app/services/data/bookings/booking.interfaces';\n\nimport * as dayjs from 'dayjs';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { UsersService } from 'src/app/services/data/users/users.service';\n\n@Component({\n    selector: 'order-details-notes',\n    templateUrl: './messages.component.html',\n    styleUrls: ['./messages.component.scss'],\n})\nexport class OrderDetailsNotesComponent implements OnInit {\n    /** Booking details to display */\n    @Input() public booking: Booking;\n    /** Catering order to display notes for */\n    @Input() public order: CateringOrder;\n    /** Emitter for changes to the active booking */\n    @Output() public bookingChange = new EventEmitter<Booking>();\n    /** Contents of the new private note */\n    public new_note: string;\n    /** Whether a note is being added */\n    public loading: boolean;\n\n    /** List of notes for catering order space */\n    public get notes(): BookingNote[] {\n        const notes = this.booking.notes.filter((note) => {\n            return (\n                note.type === 'catering' &&\n                note.space === this.order.location_id &&\n                (!note.order_id || note.order_id === this.order.id)\n            );\n        });\n        notes.forEach((note) => {\n            note.time = dayjs(note.date).format('DD MMM, h:mm A');\n        });\n        return notes;\n    }\n\n    constructor(private _service: ApplicationService, private _users: UsersService) {}\n\n    ngOnInit(): void {}\n\n    /**\n     * Add note for catering order\n     */\n    public async addNote() {\n        /* istanbul ignore else */\n        if (this.booking && this.new_note) {\n            const user = this._users.current;\n            const notes = this.booking.notes;\n            const date = dayjs().startOf('m');\n            const new_notes = [\n                ...notes,\n                {\n                    type: 'catering',\n                    date: date.valueOf(),\n                    author: user.name,\n                    order_id: this.order.id,\n                    space: this.booking.space.id,\n                    message: this.new_note,\n                    time: date.format('h:mm A'),\n                },\n            ];\n            const pending_booking = new Booking({ ...this.booking, notes: new_notes })\n            this.loading = true;\n            const new_booking: Booking = (await pending_booking.save().catch((err) => {\n                this._service.notifyError(\n                    `Failed to add note to order meeting. Error: ${err.message || err}`\n                );\n                this.loading = false;\n                throw err;\n            })) as any;\n            this.booking = new_booking;\n            this.order.booking = new_booking;\n            this.bookingChange.emit(new_booking);\n            this.loading = false;\n            this.new_note = '';\n        }\n    }\n}\n","<div class=\"heading\">\n    Private Notes\n</div>\n<div class=\"content\">\n    <ng-container *ngIf=\"notes && notes.length; else empty_state\">\n        <div class=\"note\" *ngFor=\"let item of notes\">\n            <div class=\"text\">{{ item.message }}</div>\n            <div class=\"details\">\n                <div class=\"author\">{{ item.author }}</div>\n                <div class=\"fill\"></div>\n                <div class=\"time\">{{ item.time }}</div>\n            </div>\n        </div>\n    </ng-container>\n</div>\n<div class=\"footer\">\n    <mat-form-field appearance=\"none\">\n        <input matInput [(ngModel)]=\"new_note\" [disabled]=\"loading\" placeholder=\"Type to add notes\" (keyup.enter)=\"addNote()\"/>\n        <button mat-icon-button matSuffix name=\"add-note\" [disabled]=\"!new_note || loading\" (tapped)=\"addNote()\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'send' }\"></app-icon>\n        </button>\n    </mat-form-field>\n    <div class=\"loader center\" *ngIf=\"loading\">\n        <mat-spinner diameter=\"32\"></mat-spinner>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">\n            No private notes for order\n        </div>\n    </div>\n</ng-template>\n","import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport { CateringOrder, CateringOrderStatus } from 'src/app/services/data/catering/catering-order.class';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { DialogEvent, Identity } from 'src/app/shared/utilities/types.utilities';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\n\nimport * as dayjs from 'dayjs';\n\nexport interface OrderDetailsModalData {\n    /** Order to display details for */\n    order: CateringOrder;\n    /** Booking associated with catering order */\n    booking: Booking;\n}\n\n@Component({\n    selector: 'a-order-details-modal',\n    templateUrl: './order-details-modal.component.html',\n    styleUrls: ['./order-details-modal.component.scss'],\n})\nexport class OrderDetailsModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Whether status is being updated */\n    public loading: boolean;\n    /** Actively selected status */\n    public active_status: CateringOrderStatus;\n    /** List of available order statuses */\n    public statuses: Identity[] = [\n        { id: 'accepted', name: 'Accepted', icon: { class: 'custom-accepted' }, colour: '#3996B6' },\n        {\n            id: 'preparing',\n            name: 'Preparing',\n            icon: { class: 'custom-preparing' },\n            colour: '#E7536B',\n        },\n        { id: 'ready', name: 'Ready', icon: { class: 'custom-ready' }, colour: '#FFD028' },\n        {\n            id: 'delivered',\n            name: 'Delivered',\n            icon: { class: 'custom-delivered' },\n            colour: '#75BB43',\n        },\n        {\n            id: 'cancelled',\n            name: 'Cancelled',\n            icon: { class: 'custom-cancelled' },\n            colour: '#747474',\n        },\n    ];\n\n    /** Active booking to display */\n    public get booking(): Booking {\n        return this._data.booking;\n    }\n    public set booking(bkn: Booking) {\n        this._data.booking = bkn;\n    }\n\n    /** Order to display */\n    public get order(): CateringOrder {\n        return this._data.order;\n    }\n\n    /** Details for the active status */\n    public get status_details(): Identity {\n        return this.statuses.find((status) => status.id === this.active_status);\n    }\n\n    /** Space associated with the order */\n    public get space(): Space {\n        return this._spaces.find(this._data.order.location_id);\n    }\n\n    /** Details about the delivery time */\n    public get time(): string {\n        const date = dayjs(this._data.booking.date).add(this._data.order.delivery_time, 'm');\n        return `(${date.format('DD MMM YYYY')}) To be delivered at ${this._data.order.deliver_at_time}`;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _spaces: SpacesService,\n        @Inject(MAT_DIALOG_DATA) private _data: OrderDetailsModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.active_status = this._data.order.status;\n    }\n\n    /** Update the status of the order in the booking */\n    public async updateStatus(): Promise<void> {\n        const booking = this._data.booking;\n        /* istanbul ignore else */\n        if (booking) {\n            this.loading = true;\n            const catering = [...booking.catering];\n            catering.splice(\n                catering.findIndex((order) => order.id === this._data.order.id),\n                1,\n                new CateringOrder({ ...this._data.order, status: this.active_status })\n            );\n            const new_booking = new Booking({ ...booking, catering });\n            const updated_booking: any = await new_booking.save().catch((err) => {\n                this._service.notifyError(\n                    `Error updating order status. Error: ${err.message || err}`\n                );\n                this.active_status = this._data.order.status;\n            });\n            if (updated_booking) {\n                this.booking = updated_booking;\n            }\n            this.loading = false;\n        }\n    }\n}\n","\n<mat-dialog-content>\n    <main>\n        <div class=\"details\">\n            <div class=\"burger-icon\"></div>\n            <div class=\"location\">{{ space?.name }}</div>\n            <div class=\"time\">{{ time }}</div>\n            <div class=\"status\">\n                <mat-form-field\n                    class=\"rounded visible\"\n                    appearance=\"outline\"\n                    *ngIf=\"statuses && statuses.length > 1\"\n                >\n                    <mat-select\n                        #select\n                        [(value)]=\"active_status\"\n                        (valueChange)=\"updateStatus()\"\n                        placeholder=\"New Order\"\n                        [disabled]=\"loading\"\n                    >\n                        <mat-select-trigger>\n                            <div class=\"group\">\n                                <div class=\"icon\">\n                                    <div\n                                        class=\"wrapper\"\n                                        [style.backgroundColor]=\"loading ? '#eee' : status_details?.colour\"\n                                    >\n                                        <app-icon *ngIf=\"!loading\" [icon]=\"status_details?.icon\"></app-icon>\n                                        <mat-spinner *ngIf=\"loading\" diameter=\"16\"></mat-spinner>\n                                    </div>\n                                </div>\n                                <div class=\"text\">{{ status_details?.name }}</div>\n                            </div>\n                        </mat-select-trigger>\n                        <mat-option *ngFor=\"let status of statuses\" [value]=\"status.id\">\n                            <div class=\"group\">\n                                <div class=\"text\">{{ status.name }}</div>\n                                <div class=\"colour\" [style.backgroundColor]=\"status.colour\"></div>\n                            </div>\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n        </div>\n        <div class=\"content\">\n            <div class=\"block\">\n                <order-booking-details [booking]=\"booking\"></order-booking-details>\n            </div>\n            <div class=\"block\">\n                <order-details-items [booking]=\"booking\" [order]=\"order\"></order-details-items>\n            </div>\n            <div class=\"block\">\n                <order-details-notes [(booking)]=\"booking\" [order]=\"order\"></order-details-notes>\n            </div>\n        </div>\n        <button class=\"close\" mat-icon-button mat-dialog-close>\n            <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n        </button>\n    </main>\n</mat-dialog-content>\n","import { Component, OnInit, Input, OnChanges, SimpleChanges } from '@angular/core';\n\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { ApplicationService } from 'src/app/services/app.service';\n\nimport * as dayjs from 'dayjs';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\n\n@Component({\n    selector: 'day-view-approvals-view',\n    templateUrl: './approvals-view.component.html',\n    styleUrls: ['./approvals-view.component.scss'],\n})\nexport class DayViewApprovalsComponent extends BaseDirective implements OnInit, OnChanges {\n    /** Timestamp of the active date */\n    @Input() public date: number;\n    /** ID of the active level */\n    @Input() public level: string;\n    /** List of bookings that are pending approval */\n    public events: Booking[] = [];\n    /** List of spaces to check for pending approvals */\n    public space_list: string[] = [];\n    /** Whether the pending bookings are being loaded */\n    public loading: boolean;\n    /** Whether an event action is in progress */\n    public waiting_on_event: boolean;\n\n    /** Display value for the active date */\n    public get date_display(): string {\n        const now = dayjs().startOf('d');\n        const date = dayjs(this.date).startOf('d');\n        if (now.isSame(date, 'd')) {\n            return 'Today';\n        } else if (date.diff(now, 'd') === 1) {\n            return 'Tomorrow';\n        } else if (now.diff(date, 'd') === 1) {\n            return 'Yesterday';\n        }\n        return date.format('DD MMM YYYY');\n    }\n\n    constructor(private _service: ApplicationService, private _org: OrganisationService, private _spaces: SpacesService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.getMonthlyPending();\n        this.interval('monthly_pending', () => this.getMonthlyPending(), 10 * 60 * 1000);\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.date) {\n            this.events = [];\n            this.updateMeetings();\n            // this.interval('update_meetings', () => this.updateMeetings(), 60 * 1000);\n            this.processMeetings();\n            this.interval('process_meetings', () => this.processMeetings(), 1 * 1000);\n            /* istanbul ignore else */\n            if (!dayjs(changes.date.previousValue).isSame(dayjs(changes.date.currentValue), 'M')) {\n                this.getMonthlyPending();\n                this.interval('monthly_pending', () => this.getMonthlyPending(), 10 * 60 * 1000);\n            }\n        }\n        if (changes.level) {\n            this.events = [];\n            const building = this._org.building;\n            this.space_list = this._spaces.filter(\n                (space) => space.zones.indexOf(this.level === '' ? building.id : this.level) >= 0\n            ).map((i) => i.name);\n            this.processMeetings();\n            this.getMonthlyPending();\n        }\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Track by function for ngFor optimisation\n     * @param index Index of the item\n     * @param item Data associated with the item at the given index\n     */\n    public trackByFn(index: number, item: Booking) {\n        return item.id || index;\n    }\n\n    /** Update listing of meetings pending approval */\n    private updateMeetings() {\n        const time = dayjs(this.date).startOf('d');\n        const end = time.endOf('d');\n        this.loading = true;\n        const building = this._org.building;\n        this._spaces.query({\n            zone_ids: this.level || building.id,\n            available_from: time.unix(),\n            available_to: end.unix(),\n        }).then((room_list) => {\n            this.space_list = room_list.map((i) => i.id);\n            this.processMeetings();\n            this.loading = false;\n        });\n    }\n\n    /**\n     * Update pending meetings from list of rooms\n     */\n    private processMeetings() {\n        /* istanbul ignore if */\n        if (this.waiting_on_event) {\n            return;\n        }\n        this.events = this.process(this.date);\n        const pending_list = this._service.get('CONCIERGE.pending_bookings') || {};\n        pending_list[dayjs(this.date).format('YYYY-MM-DD')] = this.events.length;\n        this._service.set('CONCIERGE.pending_bookings', pending_list);\n    }\n\n    private process(date: number) {\n        let events: Booking[] = [];\n        for (const id of this.space_list) {\n            const rm = this._spaces.find(id);\n            /* istanbul ignore else */\n            if (rm) {\n                events = events.concat(rm.bookingsFor(date).filter((booking) => booking.tentative));\n            }\n        }\n        return events.sort((a, b) => a.date - b.date);\n    }\n\n    private getMonthlyPending() {\n        const now = dayjs().startOf('d');\n        let start = dayjs(this.date).startOf('M');\n        const end = start.endOf('M');\n        /* istanbul ignore else */\n        if (now.isAfter(end, 'm')) {\n            return;\n        } else if (now.isAfter(start, 'm')) {\n            start = now;\n        }\n        console.log('Level:', this.level);\n        const building = this._org.building;\n        this._spaces.query({\n            zone_ids: this.level || building.id,\n            available_from: start.unix(),\n            available_to: end.unix(),\n        }).then((_) => {\n            const pending_list = this._service.get('CONCIERGE.pending_bookings') || {};\n            for (let date = start; date.isBefore(end, 'm'); date = date.add(1, 'd')) {\n                const events = this.process(date.valueOf());\n                pending_list[date.format('YYYY-MM-DD')] = events.length;\n            }\n            this._service.set('CONCIERGE.pending_bookings', pending_list);\n        });\n    }\n}\n","<div class=\"approvals-view\">\n    <div class=\"content\" *ngIf=\"events && events.length; else empty_state\">\n        <div class=\"date\">\n            <div class=\"bar\"></div>\n            <div class=\"display\">{{ date_display }}</div>\n            <div class=\"bar\"></div>\n        </div>\n        <approvals-event *ngFor=\"let item of events; trackBy: trackByFn\" [event]=\"item\" (acting)=\"waiting_on_event = $event\"></approvals-event>\n    </div>\n    <div class=\"load-state\" *ngIf=\"loading\">\n        <div class=\"no-item center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n        </div>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block center\" *ngIf=\"!loading\">\n        <div class=\"icon\">\n            <i class=\"material-icons\">close</i>\n        </div>\n        <div class=\"text\">No meetings pending approval</div>\n    </div>\n</ng-template>\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { trigger, style, animate, transition } from '@angular/animations';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { CateringOrder } from 'src/app/services/data/catering/catering-order.class';\nimport { DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { ConfirmModalComponent } from 'src/app/overlays/confirm-modal/confirm-modal.component';\nimport { MeetingDetailsModalComponent } from 'src/app/overlays/meeting-details-modal/meeting-details-modal.component';\nimport { BookingsService } from 'src/app/services/data/bookings/bookings.service';\n\nconst STATES: { [id: string]: string } = {};\n\n@Component({\n    selector: 'approvals-event',\n    templateUrl: './event.component.html',\n    styleUrls: ['./event.component.scss'],\n    animations: [\n        trigger('show', [\n            transition(':enter', [\n                style({ opacity: 0, height: 0 }),\n                animate(200, style({ opacity: 1, height: '*' })),\n            ]),\n            transition(':leave', [\n                style({ opacity: 1, height: '*' }),\n                animate(200, style({ opacity: 0, height: 0 })),\n            ]),\n        ]),\n    ],\n})\nexport class DayViewApprovalsEventComponent extends BaseDirective {\n    /** Event to display */\n    @Input() event: Booking;\n    /** Event emitter for event actions */\n    @Output() acting = new EventEmitter<boolean>();\n    /** Whether approval action is being processed */\n    public loading: boolean;\n    /** Whether event details are shown */\n    public shown: boolean;\n\n    public get was_edited(): boolean {\n        return this.event.edits.length > 0;\n    }\n\n    /** Type of event */\n    public get type(): string {\n        return this.event.type;\n    }\n\n    /** Person to notify when external attendees arrive */\n    public get notifyee() {\n        return 'Concierge';\n    }\n\n    /** Description of the meeting */\n    public get description(): string {\n        return this.event.description;\n    }\n\n    /** Whether the meeting has catering attached */\n    public get has_catering(): boolean {\n        const catering: readonly CateringOrder[] = this.event.catering;\n        return !!catering.find((order) => this.event.space.id === order.location_id);\n    }\n\n    /** View booking details */\n    public view() {\n        this.timeout(\n            'view',\n            () => {\n                this._dialog.open(MeetingDetailsModalComponent, {\n                    data: {\n                        booking: this.event,\n                    },\n                });\n                this._service.set('CONCIERGE.day_view.viewing', this.event);\n            },\n            50\n        );\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _bookings: BookingsService,\n        private _dialog: MatDialog\n    ) {\n        super();\n    }\n\n    /**\n     * Approve the meeting for the set room\n     */\n    public accept() {\n        this.acting.emit(true);\n        const ref = this._dialog.open(ConfirmModalComponent, {\n            data: {\n                title: 'Approve Meeting',\n                content: `Approve ${this.event.organiser.name}'s meeting in \"${this.event.space.name}\" at ${this.event.start_time} for ${this.event.length_string} on ${this.event.date_string}`,\n                icon: { type: 'icon', class: 'material-icons', content: 'event_available' },\n                action: 'Ok',\n            },\n        });\n        ref.componentInstance.event.subscribe((event: DialogEvent) => {\n            /* istanbul ignore else */\n            if (event.reason === 'done') {\n                this.loading = true;\n                this._bookings\n                    .accept(this.event.id, {\n                        comment: '',\n                        room_id: this.event.space.id,\n                    })\n                    .then(\n                        () => {\n                            this._service.notifySuccess('Meeting approved.');\n                            this.event.approval_status[this.event.space.id] = 'accepted';\n                            STATES[this.event.id] = 'accepted';\n                            this._service.set('BOOKING.states', STATES);\n                            this.loading = false;\n                            this.acting.emit(false);\n                        },\n                        () => {\n                            this.acting.emit(false);\n                            this._service.notifyError('Error approving meeting.');\n                            this.loading = false;\n                        }\n                    );\n            }\n            ref.close();\n        });\n    }\n\n    /**\n     * Decline meeting for the set room\n     */\n    public decline() {\n        this.acting.emit(true);\n        const ref = this._dialog.open(ConfirmModalComponent, {\n            data: {\n                title: 'Decline Meeting',\n                content: `Decline ${\n                    this.event.organiser.name || this.event.organiser\n                }'s meeting in \"${this.event.space.name}\" at ${this.event.start_time} for ${\n                    this.event.length_string\n                } on ${this.event.date_string}`,\n                icon: { type: 'icon', class: 'material-icons', content: 'event_busy' },\n                action: 'Ok',\n            },\n        });\n        ref.componentInstance.event.subscribe((event: DialogEvent) => {\n            /* istanbul ignore else */\n            if (event.reason === 'done') {\n                this.loading = true;\n                const booking: Booking = this.event;\n                this.loading = true;\n                this._bookings\n                    .decline(booking.id, {\n                        booking_id: booking.id,\n                        organiser: booking.organiser.email,\n                        icaluid: booking.icaluid,\n                        start: Math.floor(booking.date / 1000),\n                        end: Math.floor(booking.date / 1000) + booking.duration * 60,\n                        room_id: booking.space.id,\n                    })\n                    .then(\n                        () => {\n                            this._service.notifySuccess('Meeting declined.');\n                            this.event.approval_status[booking.space.id] = 'declined';\n                            STATES[this.event.id] = 'declined';\n                            this._service.set('BOOKING.states', STATES);\n                            this.loading = false;\n                            this.acting.emit(false);\n                        },\n                        () => {\n                            this.acting.emit(false);\n                            this._service.notifyError('Error declining meeting.');\n                            this.loading = false;\n                        }\n                    );\n            }\n            ref.close();\n        });\n    }\n}\n","<div\n    [class]=\"'approval-event' + (type ? ' ' + type : '')\"\n    *ngIf=\"event && !event.approved\"\n    [attr.event-id]=\"event.id\"\n>\n    <div class=\"header\">\n        <div class=\"avatar\">\n            <a-user-avatar [user]=\"event.organiser\"></a-user-avatar>\n        </div>\n        <div class=\"details\">\n            <div class=\"text bold\">\n                {{ event.all_day ? 'All Day' : event.start_time + ' - ' + event.end_time }}\n                {{ event.space ? 'in ' + event.space.name : '' }}\n                <div *ngIf=\"was_edited\"></div>\n            </div>\n            <div class=\"text\">{{ event.title }}</div>\n        </div>\n        <button mat-icon-button class=\"search\" name=\"view\" (tapped)=\"view()\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'search' }\"></app-icon>\n        </button>\n    </div>\n    <div class=\"body\">\n        <div class=\"control\">\n            <div class=\"bar\"></div>\n            <app-icon\n                (tapped)=\"shown = !shown\"\n                [icon]=\"{\n                    class: 'material-icons',\n                    content: 'keyboard_arrow_' + (shown ? 'up' : 'down')\n                }\"\n            ></app-icon>\n            <div class=\"bar\"></div>\n        </div>\n        <div class=\"contents\" *ngIf=\"shown\" [@show]>\n            <div class=\"field\">\n                <label for=\"name\">Host:</label>\n                <div class=\"value\" name=\"host\">\n                    <div class=\"text\">{{ event.organiser?.name }}</div>\n                    <div class=\"actions\">\n                        <a\n                            mat-icon-button\n                            [href]=\"'mailto:' + event.organiser?.email\"\n                            [attr.disabled]=\"!event.organiser?.email\"\n                        >\n                            <app-icon\n                                [icon]=\"{ class: 'material-icons', content: 'email' }\"\n                            ></app-icon>\n                        </a>\n                        <a\n                            mat-icon-button\n                            [href]=\"'tel:' + event.organiser?.phone\"\n                            [attr.disabled]=\"!event.organiser?.phone\"\n                        >\n                            <app-icon\n                                [icon]=\"{ class: 'material-icons', content: 'phone' }\"\n                            ></app-icon>\n                        </a>\n                    </div>\n                </div>\n            </div>\n            <div\n                class=\"field\"\n                *ngIf=\"\n                    event.creator &&\n                    event.organiser &&\n                    event.organiser.email !== event.creator.email\n                \"\n            >\n                <label for=\"bookee\">Booked by:</label>\n                <div class=\"value\" name=\"bookee\">\n                    <div class=\"text\">{{ event.creator?.name }}</div>\n                    <div class=\"actions\">\n                        <a\n                            mat-icon-button\n                            [href]=\"'mailto:' + event.creator?.email\"\n                            [attr.disabled]=\"!event.creator?.email\"\n                        >\n                            <app-icon\n                                [icon]=\"{ class: 'material-icons', content: 'email' }\"\n                            ></app-icon>\n                        </a>\n                        <a\n                            mat-icon-button\n                            [href]=\"'tel:' + event.creator?.phone\"\n                            [attr.disabled]=\"!event.creator?.phone\"\n                        >\n                            <app-icon\n                                [icon]=\"{ class: 'material-icons', content: 'phone' }\"\n                            ></app-icon>\n                        </a>\n                    </div>\n                </div>\n            </div>\n            <div class=\"field multiline\">\n                <label for=\"attendees\">Attendees:</label>\n                <div class=\"value\" name=\"attendees\">\n                    <div class=\"attendee\" *ngFor=\"let item of event.attendees\">{{ item.name }}</div>\n                </div>\n            </div>\n            <div class=\"field\">\n                <label for=\"notifyee\">Welcomed by:</label>\n                <div class=\"value\" name=\"notifyee\">{{ notifyee }}</div>\n            </div>wwwwwwwww\n            <div class=\"field\">\n                <label for=\"catering\">Catering:</label>\n                <div class=\"value\" name=\"catering\">\n                    {{ has_catering ? 'Catered' : 'No Catering' }}\n                </div>\n            </div>\n            <div class=\"field\" *ngIf=\"description\">\n                <label for=\"notes\">Notes:</label>\n                <div class=\"value\" name=\"notes\" [innerHTML]=\"description || '' | safe\"></div>\n            </div>\n        </div>\n    </div>\n    <div class=\"footer\">\n        <button\n            mat-button\n            class=\"inverse\"\n            name=\"accept\"\n            (tapped)=\"accept()\"\n            [class.accepted]=\"event.approved\"\n        >\n            Accept{{ event.approved ? 'ed' : '' }}\n        </button>\n        <button\n            mat-button\n            class=\"inverse\"\n            name=\"decline\"\n            (tapped)=\"decline()\"\n            [class.declined]=\"event.declined\"\n        >\n            Decline{{ event.declined ? 'd' : '' }}\n        </button>\n    </div>\n    <div class=\"load-state\" *ngIf=\"loading\">\n        <div class=\"no-item center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">Processing request...</div>\n        </div>\n    </div>\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { BuildingLevel } from 'src/app/services/data/organisation/level.class';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { Identity } from 'src/app/shared/utilities/types.utilities';\nimport { first } from 'rxjs/operators';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { BookingModalComponent } from 'src/app/overlays/booking-modal/booking-modal.component';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\n\n@Component({\n    selector: 'a-day-view',\n    templateUrl: './day-view.component.html',\n    styleUrls: ['./day-view.component.scss']\n})\nexport class DayViewComponent extends BaseDirective implements OnInit {\n    /** Currently selected date */\n    public date: string;\n    /** ID of the currently selected level */\n    public active_level: string = '';\n    /** ID of the currently selected level */\n    public active_type: string = '';\n    /** List of levels available for the active building */\n    public levels: BuildingLevel[] = [];\n    /** List of space types available for the active building */\n    public space_types: Identity[] = [];\n    /** Whether to show only items with a setup and/or breakdown time */\n    public only_overflow: boolean;\n    /** List of legend keys to show */\n    public legend: string[] = [];\n    /** List of available legend keys */\n    public readonly legend_keys: readonly Identity[] = [\n        { name: 'Internal', id: 'internal', color: '#E69FC7' },\n        { name: 'Client', id: 'client', color: '#1F40E6' },\n        { name: 'External', id: 'external', color: '#8C5AC8' },\n        { name: 'Setup', id: 'setup', color: '#d32f2f' },\n        { name: 'Training', id: 'training', color: '#F0E700' },\n        { name: 'Interview', id: 'interview', color: '#348D02' }\n    ]\n\n    constructor(\n        private _service: ApplicationService,\n        private _org: OrganisationService,\n        private _dialog: MatDialog,\n        private _router: Router,\n        private _route: ActivatedRoute\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._org.initialised.pipe(first(_ => _)).subscribe(() => {\n            this.legend = this.legend_keys.map(item => `${item.id}`);\n            this.subscription('route.params', this._route.paramMap.subscribe((params) => {\n                /* istanbul ignore else */\n                if (params.has('level') && this.active_level !== params.get('level')) {\n                    const level = this._org.levelWithID(params.get('level'));\n                    /* istanbul ignore else */\n                    if (level) {\n                        const building = this._org.buildings.find(bld => bld.id === level.building_id);\n                        /* istanbul ignore else */\n                        if (building) {\n                            this.active_level = level.id;\n                            this._org.building = building;\n                        }\n                    }\n                }\n            }));\n            this.subscription(\n                'building',\n                this._org.listen('active_building').subscribe(() => {\n                    const building = this._org.building;\n                    /* istanbul ignore else */\n                    if (!building.levels.find(lvl => lvl.id === this.active_level)) {\n                        this.active_level = (building.levels[0]).id;\n                        this.updateLevel();\n                    }\n                    this.levels = [{ id: '', name: 'All Levels' } as any].concat(\n                        building.levels\n                    );\n                    this.levels.sort((a, b) => a.name.localeCompare(b.name));\n                    this.space_types = [{ id: '', name: 'All Space Types' } as any].concat(\n                        this._org.space_types\n                    );\n                })\n            );\n        });\n    }\n\n    public newMeeting() {\n        this._dialog.open(BookingModalComponent, {\n            data: {\n                booking: new Booking({})\n            }\n        });\n    }\n\n    public updateLevel() {\n        this._router.navigate(['/day-view', this.active_level]);\n    }\n}\n","<div class=\"day-view\">\n    <a-sidebar></a-sidebar>\n    <div class=\"group\">\n        <a-topbar-header [(date)]=\"date\" [show_events]=\"true\">\n            <div class=\"topbar\">\n                <mat-form-field *ngIf=\"levels && levels.length > 1\" appearance=\"outline\">\n                    <mat-select [(ngModel)]=\"active_level\" (ngModelChange)=\"updateLevel()\">\n                        <mat-option *ngFor=\"let level of levels\" [value]=\"level?.id\">\n                            {{ level?.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <mat-form-field *ngIf=\"space_types && space_types.length > 1\" appearance=\"outline\">\n                    <mat-select [(ngModel)]=\"active_type\">\n                        <mat-option *ngFor=\"let type of space_types\" [value]=\"type?.id\">\n                            {{ type?.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select [(ngModel)]=\"legend\" multiple placeholder=\"No items shown\">\n                      <mat-select-trigger>Legend</mat-select-trigger>\n                      <mat-option *ngFor=\"let key of legend_keys\" [value]=\"key?.id\">\n                          <div class=\"key\">\n                              <div class=\"text\">{{key?.name}}</div>\n                              <div class=\"colour\">\n                                  <div class=\"blob\" [style.backgroundColor]=\"key.color\"></div>\n                              </div>\n                          </div>\n                      </mat-option>\n                    </mat-select>\n                  </mat-form-field>\n\n                <mat-slide-toggle\n                    [(ngModel)]=\"only_overflow\"\n                    labelPosition=\"before\"\n                    title=\"Only show meetings with setup and breakdown times\"\n                >\n                    Only Setup/Breakdown\n                </mat-slide-toggle>\n            </div>\n        </a-topbar-header>\n        <main>\n            <day-view-timeline\n                [date]=\"date\"\n                [level]=\"active_level\"\n                [legend]=\"legend\"\n                [overflow_only]=\"only_overflow\"\n                [space_type]=\"active_type\"\n            ></day-view-timeline>\n        </main>\n    </div>\n    <button mat-button class=\"new-item\" name=\"new\" (tapped)=\"newMeeting()\">\n        <div class=\"content\">\n            <div class=\"material-icons\">add</div>\n            <div class=\"text\">New Meeting</div>\n        </div>\n    </button>\n</div>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { DayViewComponent } from './day-view.component';\nimport { DayViewTimelineComponent } from './timeline/timeline.component';\nimport { DayViewApprovalsComponent } from './approvals-view/approvals-view.component';\nimport { DayViewApprovalsEventComponent } from './approvals-view/event/event.component';\nimport { DayViewSpaceComponent } from './space/space.component';\nimport { DayViewSpaceEventComponent } from './space/event/event.component';\n\nimport { SharedContentModule } from 'src/app/shared/shared.module';\nimport { FormsModule } from '@angular/forms';\n\nconst ROUTES: Route[] = [\n    { path: '', component: DayViewComponent },\n    { path: ':level', component: DayViewComponent },\n    { path: '**', redirectTo: '' }\n];\n\n@NgModule({\n    declarations: [\n        DayViewComponent,\n        DayViewTimelineComponent,\n        DayViewApprovalsComponent,\n        DayViewApprovalsEventComponent,\n        DayViewSpaceComponent,\n        DayViewSpaceEventComponent\n    ],\n    imports: [CommonModule, FormsModule, RouterModule.forChild(ROUTES), SharedContentModule]\n})\nexport class DayViewModule {}\n","import {\n    Component,\n    OnInit,\n    Input,\n    OnChanges,\n    SimpleChanges,\n    Output,\n    EventEmitter,\n} from '@angular/core';\nimport { Router } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { ApplicationService } from 'src/app/services/app.service';\n\nimport * as dayjs from 'dayjs';\nimport { CateringOrder } from 'src/app/services/data/catering/catering-order.class';\nimport { MeetingDetailsModalComponent } from 'src/app/overlays/meeting-details-modal/meeting-details-modal.component';\n\n/** Details about the associated event overlapping with other events */\nexport interface IEventOverlap {\n    /** Index of this item with the overlapping items */\n    index: number;\n    /** Total number of items overlapping with this one */\n    total: number;\n}\n\n@Component({\n    selector: 'day-view-space-event',\n    templateUrl: './event.component.html',\n    styleUrls: ['./event.component.scss'],\n})\nexport class DayViewSpaceEventComponent extends BaseDirective implements OnChanges {\n    /** Event to display */\n    @Input() public event: any;\n    /** Date to display events for */\n    @Input() public date: number;\n    /** Event to display */\n    @Input() public space: Space;\n    /** Whether the item is a fixed size */\n    @Input() public fixed: boolean;\n    /** Overlap details for the event */\n    @Input() public overlap: IEventOverlap;\n    /** Whether an action is being processed for this event */\n    @Input() public loading: boolean;\n    /** Emitter for the current position of the event within the timeline */\n    @Output() public position = new EventEmitter<{ top: number; height: number }>();\n\n    /** Position of the event start time in the day */\n    public top: number;\n    /** Position of the event relative to overlapping events */\n    public left: number;\n    /** Height based of the duration of the event */\n    public height: number;\n    /** Size of the event when overlapping with other events */\n    public width: number;\n    /** Offset from the event's top that the setup time starts */\n    public overflow_top: number;\n    /** Offset from the event's bottom that the breakdown time ends */\n    public overflow_bottom: number;\n\n    constructor(\n        private _service: ApplicationService,\n        private _dialog: MatDialog,\n        private _router: Router\n    ) {\n        super();\n    }\n\n    /** Type of booking */\n    public get type(): string {\n        if (this.event.declined) {\n            return 'cancelled';\n        }\n        const booking_type = this.event.type;\n        if (booking_type === 'internal' && this.event.has_visitors) {\n            return 'external';\n        }\n        return booking_type;\n    }\n\n    /** Period that the event will occur during the day */\n    public get period(): string {\n        return this.event.time_period;\n    }\n\n    /** Number attendees expected to turn up to the event */\n    public get expected(): number {\n        const expected = this.event.expected_attendees;\n        return this.space ? expected[this.space.id] || 0 : 0;\n    }\n\n    /** Whether the meeting has catering attached */\n    public get has_catering(): boolean {\n        return !!this.order;\n    }\n\n    public get order(): CateringOrder {\n        return this.event.catering.find((order) => order.location_id === this.space.id);\n    }\n\n    /** View booking details */\n    public view() {\n        this._dialog.open(MeetingDetailsModalComponent, {\n            maxHeight: '95vh',\n            maxWidth: '95vw',\n            data: {\n                booking: this.event,\n            },\n        });\n    }\n\n    /** Whether event is active */\n    public get active(): boolean {\n        const event = this._service.get('CONCIERGE.day_view.viewing');\n        return !event || event.id === this.event.id;\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.event || changes.overlap || changes.date) {\n            this.calculatePosition();\n        }\n    }\n\n    /**\n     * View catering order for the event\n     */\n    public viewOrder(id: string) {\n        /* istanbul ignore else */\n        if (this.event && this.event.catering) {\n            /* istanbul ignore else */\n            if (sessionStorage) {\n                sessionStorage.setItem('CONCIERGE.view_order', id);\n                const booking = JSON.stringify(this.event.toJSON());\n                sessionStorage.setItem('CONCIERGE.order_booking', booking);\n            }\n            this._router.navigate(['/catering', 'orders'], {\n                queryParams: { booking: this.event.id, view: id },\n            });\n        }\n    }\n\n    /** Calculate the position */\n    private calculatePosition() {\n        /* istanbul ignore else */\n        if (this.event) {\n            const overlap = this.overlap || { index: 0, total: 1 };\n            const shown_date = dayjs(this.date).startOf('d');\n            const date = dayjs(this.event.date).startOf('m');\n            const start = +date.diff(shown_date, 'h', true).toFixed(3);\n            const duration = Math.min(\n                this.event.duration,\n                Math.abs(shown_date.diff(date.add(this.event.duration, 'm'), 'm'))\n            );\n            this.top = Math.max(0, (start / 24) * 100);\n            this.height = Math.min(\n                100 - this.top,\n                this.fixed ? duration / 60 : (duration / 60 / 24) * 100\n            );\n            this.position.emit({ top: this.top, height: (duration / 60 / 24) * 100 });\n            this.width = Math.min(100, 100 / overlap.total + 5);\n            this.left = Math.min(100 - this.width, this.width * overlap.index - 5 * overlap.index);\n            this.overflow_top = (this.event.setup ? this.event.setup / duration : -0.1) * 100;\n            this.overflow_bottom =\n                (this.event.breakdown ? this.event.breakdown / duration : -0.1) * 100;\n        }\n    }\n}\n","<div\n    class=\"event-container\"\n    [id]=\"'event-' + event.local_id\"\n    *ngIf=\"event\"\n    [class.fixed]=\"fixed\"\n    [class.inactive]=\"!active\"\n    [style.top]=\"top + '%'\"\n    [style.left]=\"left + '%'\"\n    [style.width]=\"fixed ? '15rem' : width + '%'\"\n    [style.height]=\"fixed ? height * 3 + 'rem' : height + '%'\"\n>\n    <div\n        [class]=\"'overflow' + (type ? ' ' + type : '')\"\n        [style.top]=\"-overflow_top + '%'\"\n        [style.bottom]=\"-overflow_bottom + '%'\"\n    ></div>\n    <div\n        [class]=\"'event' + (type ? ' ' + type : '') + (top > 50 ? ' low' : '')\"\n        [style.z-index]=\"(overlap?.index || 0) + 2\"\n        (tapped)=\"view()\"\n    >\n        <div class=\"header\">\n            <div class=\"text\">{{ event.all_day ? 'All Day' : period }}</div>\n            <div class=\"handle\">\n                <app-icon\n                    *ngIf=\"!loading && (event.declined || event.approved)\"\n                    [icon]=\"{\n                        class: 'material-icons',\n                        content: event.approved ? 'done' : event.declined ? 'event_busy' : ''\n                    }\"\n                >\n                </app-icon>\n                <mat-spinner *ngIf=\"loading\" diameter=\"16\"></mat-spinner>\n            </div>\n        </div>\n        <div class=\"body\">\n            <div class=\"field host\">\n                <div class=\"label\">Host:&nbsp;</div>\n                <div class=\"value\" [title]=\"'Host: ' + (event.organiser?.name || event.organiser)\">\n                    {{ event.organiser?.name || event.organiser }}\n                </div>\n            </div>\n            <div\n                class=\"field booked-by\"\n                *ngIf=\"event.creator && event.creator.email !== event.organiser.email\"\n            >\n                <div class=\"label\">Booked by:&nbsp;</div>\n                <div\n                    class=\"value\"\n                    [title]=\"'Booked By: ' + (event.creator?.name || event.creator)\"\n                >\n                    {{ event.creator?.name || event.creator }}\n                </div>\n            </div>\n            <div class=\"field\">\n                <!-- <div class=\"label\">Event:</div> -->\n                <div class=\"value\" [title]=\"'Title: ' + event.title\">{{ event.title }}</div>\n            </div>\n            <div class=\"field\">\n                <div class=\"value\">\n                    {{ event.attendees ? event.attendees.length || 'No' : 'No' }} Attendee{{\n                        event.attendees?.length === 1 ? '' : 's'\n                    }}{{ expected ? '(' + expected + ' Expected)' : '' }}\n                </div>\n            </div>\n            <div\n                class=\"field\"\n                *ngIf=\"event.notify_users\"\n                [title]=\"'Welcomed by: ' + event.notify_users[0]\"\n            >\n                <div class=\"value\">Welcomed by: {{ event.notify_users[0] }}</div>\n            </div>\n            <div class=\"field\" *ngIf=\"has_catering\">\n                <div class=\"value\">Catered</div>\n            </div>\n        </div>\n    </div>\n    <button\n        class=\"catering-icon\"\n        mat-icon-button\n        name=\"view-catering\"\n        *ngIf=\"has_catering\"\n        (tapped)=\"viewOrder(order.id)\"\n    >\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'restaurant' }\"></app-icon>\n    </button>\n</div>\n","import {\n    Component,\n    OnChanges,\n    Input,\n    SimpleChanges,\n    Output,\n    EventEmitter,\n    ViewChild,\n    ElementRef,\n} from '@angular/core';\nimport { CdkDragMove, CdkDragDrop } from '@angular/cdk/drag-drop';\n\nimport { IEventOverlap } from './event/event.component';\n\nimport * as dayjs from 'dayjs';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { first } from 'rxjs/operators';\nimport { ConfirmModalComponent } from 'src/app/overlays/confirm-modal/confirm-modal.component';\nimport { MatDialog } from '@angular/material/dialog';\nimport { DialogEvent, HashMap } from 'src/app/shared/utilities/types.utilities';\nimport { DayViewSettings } from 'src/app/shared/utilities/settings.interfaces';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\n\n@Component({\n    selector: 'day-view-space',\n    templateUrl: './space.component.html',\n    styleUrls: ['./space.component.scss'],\n})\nexport class DayViewSpaceComponent extends BaseDirective implements OnChanges {\n    /** List of space dropzones connected to */\n    @Input() public space_list: string[];\n    /** Date to display events for */\n    @Input() public date: number;\n    /** Space to display events for */\n    @Input() public space: Space;\n    /** Scroll value of the day view */\n    @Input() public scroll: number;\n    /** Only show events with setup and/or breakdown times */\n    @Input() public overflow_only: boolean;\n    /** Mapping of whether to show events with a given legend id */\n    @Input() public legend: HashMap<boolean> = {};\n    /** Scroll value to add to drop placeholders */\n    @Input('scrollTop') public scroll_top: number;\n    /** Last update time of the displayed bookings */\n    @Input('lastUpdate') public last_update: number;\n    /** Emitter for whether the space column is in view */\n    @Output() public inView = new EventEmitter<boolean>();\n    /** Emitter for whether an event is being dragged */\n    @Output() public dragging = new EventEmitter<boolean>();\n    /** Mapping of event IDs to overlap details */\n    public overlap_details: HashMap<IEventOverlap> = {};\n    /** Mapping of positions of event in the day */\n    public position_list: HashMap<{ top: number; height: number }> = {};\n    /** Override for mapped position */\n    public top: number;\n    /** Client Rectangle for the container element box */\n    public box: ClientRect;\n    /** Whether the space list is in view */\n    public in_view: boolean;\n    /** ID of the booking with an action processing */\n    public override_state: string;\n    /** Map of bookings to whether they are loading */\n    public loading: HashMap<boolean> = {};\n    /** Settings for day view */\n    public settings: DayViewSettings = {} as any;\n\n    /** Container element for the component contents */\n    @ViewChild('view', { static: true }) private view: ElementRef<HTMLDivElement>;\n\n    constructor(\n        private _service: ApplicationService,\n        private _spaces: SpacesService,\n        private _dialog: MatDialog\n    ) {\n        super();\n    }\n\n    /** Events to display for the active date */\n    public get events(): Booking[] {\n        /* istanbul ignore else */\n        if (this.space) {\n            const bookings = this.space.bookingsFor(this.date);\n            const list = bookings.filter((event) => {\n                if (this.override_state && this.override_state === event.icaluid) {\n                    this.loading[event.id] = true;\n                }\n                return event.declined\n                    ? (!this.overflow_only || event.setup || event.breakdown) &&\n                          this.legend.declined !== false\n                    : (!this.overflow_only || event.setup || event.breakdown) &&\n                          this.legend[event.type] !== false;\n            });\n            return list;\n        }\n        return [];\n    }\n\n    public ngOnInit(): void {\n        this._service.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.settings = this._service.setting('app.day_view') || {};\n            this.subscription(\n                'breakdown',\n                this._service.listen('APP.breakdown').subscribe((state) => {\n                    this.overflow_only = state;\n                })\n            );\n            this.subscription(\n                'legend',\n                this._service.listen('CONCIERGE.legend').subscribe((state) => {\n                    this.legend = state || {};\n                })\n            );\n        });\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.scroll) {\n            this.checkInView();\n        }\n        /* istanbul ignore else */\n        if (changes.last_update) {\n            this.timeout('update_overlaps', () => this.calculateOverlaps(), 1000);\n        }\n    }\n\n    /**\n     * Track by function for ngFor optimisation\n     * @param index Index of the item\n     * @param item Data associated with the item at the given index\n     */\n    public trackByFn(index: number, item: Booking) {\n        return item.id || index;\n    }\n\n    /**\n     * Calculate to overlap details for the booking events on the space\n     */\n    private calculateOverlaps() {\n        const events = this.events.sort(\n            (a, b) =>\n                a.date - b.date ||\n                a.duration - b.duration ||\n                (a.title || '').localeCompare(b.title || '')\n        );\n        events.forEach((i) => (this.overlap_details[i.id] = { index: 0, total: 1 }));\n        for (const bkn of events) {\n            const bkn_start = dayjs(bkn.date).startOf('m');\n            const bkn_end = dayjs(bkn_start).add(bkn.duration, 'm').startOf('m');\n            let count = 1;\n            let index = 0;\n            const collisions: Booking[] = [];\n            for (const cmp of events) {\n                /* istanbul ignore else */\n                if (bkn.id !== cmp.id) {\n                    const cmp_start = dayjs(cmp.date).startOf('m');\n                    const cmp_end = dayjs(cmp_start).add(cmp.duration, 'm').startOf('m');\n                    /* istanbul ignore else */\n                    if (\n                        bkn_start.isSame(cmp_start, 'm') ||\n                        (bkn_start.isAfter(cmp_start, 'm') && bkn_start.isBefore(cmp_end, 'm')) ||\n                        bkn_end.isSame(cmp_end, 'm') ||\n                        (bkn_end.isAfter(cmp_start, 'm') && bkn_end.isBefore(cmp_end, 'm'))\n                    ) {\n                        count++;\n                        collisions.push(bkn);\n                        /* istanbul ignore else */\n                        if (\n                            events.findIndex((i) => i.id === bkn.id) >\n                            events.findIndex((i) => i.id === cmp.id)\n                        ) {\n                            index++;\n                        }\n                    }\n                }\n            }\n            this.overlap_details[bkn.id] = { index: Math.max(0, index), total: count };\n        }\n    }\n\n    /**\n     * Check whether the space column is with the view of the\n     */\n    private checkInView() {\n        /* istanbul ignore else */\n        if (this.view && this.view.nativeElement) {\n            const el = this.view.nativeElement;\n            this.in_view =\n                el.offsetLeft + this.scroll >= -240 &&\n                el.offsetLeft + this.scroll <= window.innerWidth;\n            this.inView.emit(this.in_view);\n        }\n    }\n\n    /**\n     * Initialise drag events\n     */\n    public initDrag() {\n        this.box = this.view.nativeElement.getBoundingClientRect();\n        this.dragging.emit(true);\n    }\n\n    /**\n     * Cleanup after drag\n     */\n    public endDrag() {\n        this.timeout('end_drag', () => (this.top = 0), 10);\n        this.dragging.emit(false);\n    }\n\n    /**\n     * Update top position of the dragged event placeholder\n     * @param booking Booking being dragged\n     * @param event Drag event\n     */\n    public updateDragTop(event: CdkDragMove<Booking>) {\n        /* istanbul ignore else */\n        if (event.delta.y) {\n            const y = event.pointerPosition.y;\n            const top = (y - this.box.top - this.scroll_top) / this.box.height;\n            const top_minutes = (Math.round((top * 24 * 60) / 15) * 15) / 60;\n            this.top = (top_minutes / 24) * 100;\n        }\n    }\n\n    /**\n     * Handle drop event\n     * @param event\n     */\n    public drop(event: CdkDragDrop<{ top: number; list: Booking[] }>): void {\n        const id = event.item.element.nativeElement.id;\n        const booking = event.previousContainer.data.list.find((i) => i.id === id);\n        /* istanbul ignore else */\n        if (!booking) {\n            return;\n        }\n        const top = event.previousContainer.data.top;\n        const new_start = Math.round(((top || 0) / 100) * 24 * 60);\n        const old_date = dayjs(booking.date);\n        const date = old_date.startOf('d').minute(new_start);\n        const now = dayjs().startOf('m');\n        /* istanbul ignore else */\n        // Prevent moving event into past\n        if (now.isAfter(date, 'm')) {\n            this.handleDropError(booking.id, 'Meetings cannot be moved into the past');\n            return;\n        }\n        // Check for collisions\n        this.loading[booking.id] = true;\n        this.override_state = booking.icaluid;\n        let room = booking.space;\n        let message = `Update ${booking.organiser.name}'s meeting in \"${\n            booking.space.name\n        }\" from ${old_date.format('h:mm A')} to ${date.format('h:mm A')}`;\n        let success = `Successfully updated meeting time from ${old_date.format(\n            'h:mm A'\n        )} to ${date.format('h:mm A')}`;\n        /* istanbul ignore else */\n        if (event.container !== event.previousContainer) {\n            // Same room\n            room = this._spaces.find(event.container.id.replace('space-col-', '')) || room;\n            message = `Move ${booking.organiser.name}'s meeting in \"${booking.space.name}\" to \"${\n                room.name\n            }\" at ${date.format('h:mm A')}`;\n            success = `Successfully moved booking to \"${room.name}\" at ${date.format('h:mm A')}`;\n        }\n        /* istanbul ignore else */\n        // Check if booking has a change\n        if (room === booking.space && date.isSame(old_date, 'm')) {\n            this.handleDropError(booking.id, 'The meeting is already in this room');\n            return;\n        }\n        const room_list = [room, ...booking.space_list.filter((i) => i.id !== booking.space.id)];\n        // Check if booking is already in the room\n        const room_count = room_list.reduce((a, v) => a.add(v.id), new Set()).size;\n        /* istanbul ignore else */\n        if (room_count < room_list.length) {\n            this.handleDropError(booking.id, 'The meeting is already in this room');\n            return;\n        }\n        const new_booking = new Booking({\n            ...booking,\n            room_ids: room_list.map((space) => space.id),\n        });\n        this.checkCollisions(\n            room_list,\n            date.valueOf(),\n            new_booking.duration,\n            new_booking.icaluid\n        ).then(\n            () => {\n                this.moveBooking(message, new_booking).then(\n                    (_) => {\n                        this.override_state = null;\n                        this._service.notifySuccess(success);\n                    },\n                    (err) => this.handleDropError(new_booking.id, `Error: ${err}`)\n                );\n            },\n            () => this.handleDropError(new_booking.id, 'Updated meeting time clashes with another')\n        );\n    }\n\n    /**\n     * Check if there are any booking collisions with the new booking time\n     * @param spaces\n     * @param date\n     * @param duration\n     */\n    private checkCollisions(\n        spaces: Space[],\n        date: number,\n        duration: number,\n        ignore?: string\n    ): Promise<void> {\n        return new Promise((resolve, reject) => {\n            this._spaces\n                .available({\n                    room_ids: spaces.map((i) => i.id).join(','),\n                    date,\n                    duration,\n                    ignore,\n                    hide_bookings: true,\n                })\n                .then(\n                    (list) => {\n                        list.length === spaces.length ? resolve() : reject();\n                    },\n                    () => reject()\n                );\n        });\n    }\n\n    /**\n     * Handle errors from drop move logic\n     * @param id Booking ID\n     * @param message Error description\n     */\n    private handleDropError(id: string, message: string) {\n        this.loading[id] = false;\n        this.override_state = null;\n        this._service.notifyError(message);\n    }\n\n    /**\n     * Update booking\n     * @param confirm_msg\n     * @param new_booking\n     */\n    private moveBooking(confirm_msg: string, new_booking: Booking): Promise<Booking> {\n        return new Promise((resolve, reject) => {\n            const ref = this._dialog.open<ConfirmModalComponent>(ConfirmModalComponent, {\n                data: {\n                    title: 'Update meeting',\n                    content: confirm_msg,\n                    icon: { type: 'icon', class: 'material-icons', content: 'event_available' },\n                    action: 'Ok',\n                },\n            });\n            this.subscription(\n                'confirm',\n                ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                    /* istanbul ignore else */\n                    if (event.reason === 'done') {\n                        new_booking.save().then(\n                            (bkn: Booking) => resolve(bkn),\n                            (err) => reject(err)\n                        );\n                    }\n                    ref.close();\n                })\n            );\n        });\n    }\n}\n","<div\n    class=\"space-display\"\n    #view\n    cdkDropList\n    cdkDropListSortingDisabled\n    [cdkDropListConnectedTo]=\"space_list || []\"\n    [cdkDropListData]=\"{ top: top, list: events }\"\n    (cdkDropListDropped)=\"drop($event)\"\n    scrollContainer=\"#day-view-scroll\"\n    [id]=\"'space-col-' + space?.id\"\n>\n    <div class=\"drop-zone\" cdkDrag></div>\n    <div\n        [style.display]=\"in_view !== false ? '' : 'none'\"\n        *ngFor=\"let item of events; trackBy: trackByFn\"\n        cdkDrag\n        (cdkDragStarted)=\"initDrag()\"\n        (cdkDragMoved)=\"updateDragTop($event)\"\n        (cdkDragReleased)=\"endDrag()\"\n        [cdkDragDisabled]=\"\n            item.status !== 'upcoming' || item.declined || !settings.dragdrop\n        \"\n    >\n        <day-view-space-event\n            [space]=\"space\"\n            [date]=\"date\"\n            [event]=\"item\"\n            [loading]=\"loading ? loading[item.id] : null\"\n            [overlap]=\"overlap_details ? overlap_details[item.id] : null\"\n            (position)=\"position_list ? position_list[item.id] = $event : ''\"\n        ></day-view-space-event>\n        <div class=\"event-preview\" *cdkDragPreview>\n            <div class=\"content\">\n                <day-view-space-event\n                    [fixed]=\"true\"\n                    [space]=\"space\"\n                    [event]=\"item\"\n                ></day-view-space-event>\n            </div>\n        </div>\n        <div\n            class=\"event-placeholder\"\n            *cdkDragPlaceholder\n            [style.top]=\"(top || (position_list[item.id] ? position_list[item.id].top : 0)) + '%'\"\n            [style.height]=\"(position_list[item.id] ? position_list[item.id].height : 100) + '%'\"\n        ></div>\n    </div>\n</div>\n<div class=\"moving\" *ngIf=\"override_state\">\n    <div class=\"text\">Moving meeting</div>\n    <div class=\"spinner\">\n        <mat-spinner diameter=\"32\"></mat-spinner>\n    </div>\n</div>\n","import {\n    Component,\n    OnInit,\n    HostListener,\n    ViewChild,\n    ElementRef,\n    Renderer2,\n    Input,\n    SimpleChanges,\n} from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { first } from 'rxjs/operators';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { Identity, HashMap } from 'src/app/shared/utilities/types.utilities';\nimport { MeetingDetailsModalComponent } from 'src/app/overlays/meeting-details-modal/meeting-details-modal.component';\n\nimport * as dayjs from 'dayjs';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\n\nconst UPDATE_INTERVAL = 30;\n\n@Component({\n    selector: 'day-view-timeline',\n    templateUrl: './timeline.component.html',\n    styleUrls: ['./timeline.component.scss'],\n})\nexport class DayViewTimelineComponent extends BaseDirective implements OnInit {\n    /** Timestamp of the active date */\n    @Input() public date: number;\n    /** ID of the active level */\n    @Input() public level: string;\n    /** ID of the room type to filter displayed spaces by */\n    @Input() public space_type: string;\n    /** List of shown legend items */\n    @Input() public legend: string[] = [];\n    /** Whether to show only items with a setup and/or breakdown time */\n    @Input() public overflow_only: boolean;\n    /** Whether space bookings are being loaded */\n    @Input() public loading: boolean;\n    /** List of timeblocks to display */\n    public time_blocks: Identity[] = this.generateTimeBlocks();\n    /** Top value of the content scroll */\n    public scroll_top: number = 0;\n    /** Left value of the content scroll */\n    public scroll_left: number = 0;\n    /** Offset of the scroll value when starting a drag */\n    public scroll_offset: number = 0;\n    /** List of spaces to display for  */\n    public spaces: Space[] = [];\n    /** List of spaces to display for  */\n    public filtered_spaces: Space[] = [];\n    /** Mapping of space ids to whether they are in view */\n    public in_view: { [id: string]: boolean } = {};\n    /** Percent of the day that is now */\n    public now: number;\n    /** Whether the active day is today */\n    public is_today: boolean;\n    /** Currently active hour of the day */\n    public active_hour: string;\n    /** Mapping of spaces loading booking date */\n    public loading_space: { [id: string]: boolean } = {};\n    /** Booking ID to open modal for */\n    public view_id: string;\n    /** Last update time for the space bookings */\n    public last_update: number = 0;\n    /** Whether an event is being dragged */\n    public is_dragging: boolean;\n    /** Client rectangle for the scroll area */\n    public box: ClientRect;\n    /** Whether to show the holding bay */\n    public show_holding_bay: boolean = true;\n\n    /** Scrollable area of the day view */\n    @ViewChild('scroll_area', { static: true }) private scroll_area: ElementRef<HTMLDivElement>;\n\n    /** Update scroll box when the window is resized */\n    @HostListener('window:resize') public onResize() {\n        if (this.scroll_area.nativeElement) {\n            this.box = this.scroll_area.nativeElement.getBoundingClientRect();\n        }\n    }\n\n    public get legend_map(): HashMap<boolean> {\n        const map: any = {};\n        this.legend.forEach((item) => (map[item] = true));\n        return map;\n    }\n\n    public get is_loading(): boolean {\n        return (\n            this.loading ||\n            Object.keys(this.loading_space).reduce(\n                (loading, key) => loading || this.loading_space[key],\n                false\n            )\n        );\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _spaces: SpacesService,\n        private _org: OrganisationService,\n        private _route: ActivatedRoute,\n        private _renderer: Renderer2,\n        private _dialog: MatDialog\n    ) {\n        super();\n    }\n\n    public get holding_bay(): Space {\n        const bld = this._org.building;\n        /* istanbul ignore else */\n        if (bld && bld.holding_bay) {\n            return this._spaces.find(bld.holding_bay);\n        }\n        return null;\n    }\n\n    public ngOnInit(): void {\n        this._spaces.initialised.pipe(first((_) => _)).subscribe(() => {\n            const zone_id = !this.level ? this._org.building.id : this.level;\n            this.spaces = this._spaces.filter((_) => _.zones.indexOf(zone_id) >= 0);\n            this.init();\n            this.initSpaces();\n            // Update time\n            this.updateTime();\n            this.interval('time', () => this.updateTime(), 15 * 1000);\n        });\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.date) {\n            this.is_today = dayjs().isSame(dayjs(this.date), 'd');\n            this.updateBookings();\n            this.interval('bookings', () => this.updateBookings(), UPDATE_INTERVAL * 1000);\n        }\n        /* istanbul ignore else */\n        if (changes.level && this._org.building) {\n            const zone_id = !this.level ? this._org.building.id : this.level;\n            this.spaces = this._spaces.filter((_) => _.zones.indexOf(zone_id) >= 0);\n            this.initSpaces();\n            this.updateBookings();\n            this.interval('bookings', () => this.updateBookings(), UPDATE_INTERVAL * 1000);\n        }\n        /* istanbul ignore else */\n        if (changes.room_type) {\n            this.initSpaces();\n        }\n    }\n\n    public init() {\n        this._service.title = 'Day View';\n        this.subscription(\n            'viewing',\n            this._service\n                .listen('CONCIERGE.day_view.viewing')\n                .subscribe((event) => this.scrollIntoView(event))\n        );\n        // Subscribe to route query changes\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                /* istanbul ignore else */\n                if (params.has('view')) {\n                    this.view_id = params.get('view');\n                    const details = localStorage.getItem('CONCIERGE.view_booking');\n                    /* istanbul ignore else */\n                    if (details) {\n                        const booking = new Booking(JSON.parse(details));\n                        this.view(booking);\n                        localStorage.removeItem('CONCIERGE.view_booking');\n                    }\n                }\n            })\n        );\n        // Update bookings for visible rooms\n        this.updateBookings();\n        this.interval('bookings', () => this.updateBookings(), UPDATE_INTERVAL * 1000);\n        this.interval(\n            'scroll',\n            () => {\n                /* istanbul ignore else */\n                if (this.scroll_area && this.scroll_area.nativeElement) {\n                    this.updateScroll({ target: this.scroll_area.nativeElement });\n                }\n            },\n            1000\n        );\n        /* istanbul ignore else */\n        if (this.scroll_area.nativeElement) {\n            this.box = this.scroll_area.nativeElement.getBoundingClientRect();\n        }\n    }\n\n    /** List of space */\n    public get space_zones(): string[] {\n        return this.spaces.map((i) => `space-col-${i.id}`);\n    }\n\n    /**\n     * Update scroll parameters to match the change in the scroll position\n     * @param event\n     */\n    public updateScroll(event) {\n        this.scroll_top = event.target.scrollTop;\n        this.scroll_left = event.target.scrollLeft;\n    }\n\n    /** Generate time blocks to display on the day view */\n    private generateTimeBlocks(): Identity[] {\n        const blocks: Identity[] = [];\n        const date = dayjs().startOf('h');\n        for (let i = 0; i < 24; i++) {\n            blocks.push({\n                id: date.hour(i).format('HH:mm'),\n                name: date.hour(i).format('h:mm A'),\n            });\n        }\n        return blocks;\n    }\n\n    /** Update the now line position */\n    private updateTime() {\n        const time = dayjs();\n        this.now = (time.hour() + time.minute() / 60) / 24;\n        this.active_hour = time.startOf('h').format('HH:mm');\n    }\n\n    /** Update bookings for rooms in view */\n    private updateBookings() {\n        const visible_rooms = this.spaces.filter((i) => this.in_view[i.id] !== false);\n        console.log('Update bookings:', visible_rooms);\n        if (visible_rooms.length) {\n            visible_rooms.forEach((rm) => (this.loading_space[rm.id] = true));\n            const time = dayjs(this.date).startOf('d');\n            const end = time.endOf('d');\n            const room_ids = visible_rooms.reduce((v, i) => v + (v ? ',' : '') + i.id, '');\n            const level = this._service.get('APP.level');\n            const zone_ids = [level === -1 ? this._org.building.id : level];\n            /* istanbul ignore else */\n            if (this.space_type) {\n                zone_ids.push(this.space_type);\n            }\n            this.loading = true;\n            this._spaces\n                .query({\n                    room_ids,\n                    zone_ids: zone_ids.join(','),\n                    available_from: time.unix(),\n                    available_to: end.unix(),\n                })\n                .then(\n                    (room_list) => {\n                        room_list.forEach((rm) => {\n                            /* istanbul ignore else */\n                            if (this.view_id) {\n                                const booking = rm.bookings.find((i) => i.id === this.view_id);\n                                /* istanbul ignore else */\n                                if (booking) {\n                                    this.view(booking);\n                                }\n                            }\n                            const space = this.filtered_spaces.find((space) => space.id === rm.id);\n                            /* istanbul ignore else */\n                            if (space) {\n                                (space as any)._bookings = (rm as any)._bookings;\n                            }\n                        });\n\n                        delete this.loading_space;\n                        this.last_update = dayjs().valueOf();\n                        this.loading_space = {};\n                        this.loading = false;\n                    },\n                    () => (this.loading = false)\n                );\n        }\n    }\n\n    /**\n     * View booking details\n     * @param booking Booking to view the details of\n     */\n    private view(booking: Booking) {\n        this._dialog.open(MeetingDetailsModalComponent, {\n            data: {\n                booking,\n            },\n        });\n        this.view_id = null;\n    }\n\n    /**\n     * Scroll booking to the event on the day view\n     * @param booking Booking to scroll into view\n     */\n    private scrollIntoView(booking: Booking) {\n        if (booking && this.scroll_area && this.scroll_area.nativeElement) {\n            const element: HTMLDivElement = this.scroll_area.nativeElement.querySelector(\n                `#event-${booking.id}`\n            );\n            /* istanbul ignore else */\n            if (element) {\n                const scroll_box = this.scroll_area.nativeElement.getBoundingClientRect();\n                const box = element.getBoundingClientRect();\n                this.scroll_area.nativeElement.scrollTo({\n                    left: box.left - scroll_box.left + this.scroll_area.nativeElement.scrollLeft,\n                    top: box.top - scroll_box.top + this.scroll_area.nativeElement.scrollTop,\n                    behavior: 'smooth',\n                });\n            }\n        }\n    }\n\n    /**\n     * Setup an auto-scroll for the display view\n     * @param x\n     * @param y\n     */\n    public scrollView(x: number, y: number) {\n        /* istanbul ignore else */\n        if (x || y) {\n            this.scroll_area.nativeElement.scrollTop += y || 0;\n            this.scroll_area.nativeElement.scrollLeft += x || 0;\n            /* istanbul ignore else */\n            if (\n                (y &&\n                    this.scroll_area.nativeElement.scrollTop >=\n                        this.scroll_area.nativeElement.scrollHeight) ||\n                (x &&\n                    this.scroll_area.nativeElement.scrollLeft >=\n                        this.scroll_area.nativeElement.scrollWidth) ||\n                (y && this.scroll_area.nativeElement.scrollTop <= 0) ||\n                (x && this.scroll_area.nativeElement.scrollLeft <= 0)\n            ) {\n                this.clearInterval('auto_scroll');\n            }\n            this.updateScroll({ target: this.scroll_area.nativeElement });\n        }\n    }\n\n    public clearSelected() {\n        this._service.set('CONCIERGE.day_view.viewing', null);\n    }\n\n    public cancelScroll() {\n        this.clearInterval('auto_scroll');\n    }\n\n    public dragChange(is_dragging: boolean) {\n        if (is_dragging) {\n            this.scroll_offset = this.scroll_area.nativeElement.scrollTop;\n            this.subscription(\n                'listen_move',\n                this._renderer.listen('window', 'mousemove', (event: MouseEvent) => {\n                    const position = { x: event.clientX, y: event.clientY };\n                    const y =\n                        position.y > this.box.bottom - this.box.height * 0.05\n                            ? 1\n                            : position.y < this.box.top + this.box.height * 0.05\n                            ? -1\n                            : 0;\n                    const x =\n                        position.x > this.box.right - this.box.width * 0.05\n                            ? 1\n                            : position.x < this.box.left + this.box.height * 0.05\n                            ? -1\n                            : 0;\n                    this.scrollView(x * 5, y * 5);\n                    this.interval('auto_scroll', () => this.scrollView(x * 10, y * 10), 10);\n                })\n            );\n            this.clearInterval('bookings');\n        } else {\n            this.interval('bookings', () => this.updateBookings(), UPDATE_INTERVAL * 1000);\n            this.cancelScroll();\n            this.unsub('listen_move');\n        }\n    }\n\n    private initSpaces() {\n        const holding_bay = this.holding_bay;\n        this.filtered_spaces = this.spaces.filter(\n            (i) =>\n                (!this.space_type || i.zones.indexOf(this.space_type) >= 0) &&\n                (!holding_bay || i.id !== holding_bay.id) &&\n                i.bookable\n        );\n        this.filtered_spaces.sort((a, b) => a.name.localeCompare(b.name));\n        console.log('Init spaces');\n    }\n}\n","<div class=\"timeline\">\n    <div class=\"loader\" *ngIf=\"is_loading\">\n        <mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>\n    </div>\n    <div class=\"header\">\n        <div class=\"time-blocks\"><div class=\"text\">Time</div></div>\n        <div class=\"flex\">\n            <div class=\"group\" [style.left]=\"-scroll_left + 'px'\">\n                <div\n                    class=\"space-header\"\n                    *ngFor=\"let item of filtered_spaces\"\n                    [title]=\"item.long_name\"\n                >\n                    <div class=\"details\">\n                        <div class=\"text\">{{ item.name }}</div>\n                        <div class=\"icon\"></div>\n                    </div>\n                    <div class=\"capacity\">\n                        Capacity - {{ item.capacity || '0' }}\n                        {{ item.capacity === 1 ? 'person' : 'people' }}\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"sidebar\" *ngIf=\"holding_bay\" [class.show]=\"show_holding_bay\">\n            <div class=\"space-header\" [title]=\"holding_bay.name\">\n                <div class=\"text\">Holding Bay</div>\n                <div class=\"icon\"></div>\n            </div>\n            <div class=\"tag\" (touchrelease)=\"show_holding_bay = !show_holding_bay\">\n                <div class=\"icon\">\n                    <i class=\"material-icons\">{{\n                        show_holding_bay ? 'keyboard_arrow_right' : 'event_available'\n                    }}</i>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"body\" (touchrelease)=\"clearSelected()\">\n        <div class=\"time-blocks\">\n            <div class=\"group\" [style.top]=\"-scroll_top + 'px'\">\n                <div class=\"block\" *ngFor=\"let item of time_blocks\">\n                    <div div class=\"hour\" [class.active]=\"is_today && item.id === active_hour\">\n                        {{ item.name }}\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"flex content\" #scroll_area id=\"day-view-scroll\" (scroll)=\"updateScroll($event)\">\n            <div class=\"time-lines\" [style.min-width]=\"filtered_spaces.length * 15 + 'rem'\">\n                <div class=\"block\" *ngFor=\"let item of time_blocks\">\n                    <div class=\"line\"></div>\n                </div>\n            </div>\n            <div class=\"space-day\">\n                <div\n                    class=\"space\"\n                    [style.min-height]=\"time_blocks.length * 3 + 'rem'\"\n                    *ngFor=\"let item of filtered_spaces\"\n                    cdkDropListGroup\n                >\n                    <day-view-space\n                        [space_list]=\"space_zones\"\n                        [date]=\"date\"\n                        [space]=\"item\"\n                        [legend]=\"legend_map\"\n                        [overflow_only]=\"overflow_only\"\n                        [scroll]=\"-scroll_left\"\n                        [scrollTop]=\"scroll_offset - scroll_top\"\n                        [lastUpdate]=\"last_update\"\n                        (dragging)=\"dragChange($event)\"\n                        (inView)=\"in_view[item.id] = $event\"\n                    ></day-view-space>\n                </div>\n            </div>\n        </div>\n        <div\n            class=\"now-line\"\n            *ngIf=\"is_today\"\n            [style.top]=\"\n                'calc(' + now * time_blocks.length * 3 + 'rem - ' + scroll_top + 'px)' | safe:'style'\n            \"\n        >\n            <div class=\"knob\"></div>\n        </div>\n        <div class=\"sidebar\" *ngIf=\"holding_bay\" [class.show]=\"show_holding_bay\">\n            <day-view-space\n                *ngIf=\"holding_bay\"\n                [date]=\"date\"\n                [space]=\"holding_bay\"\n                [lastUpdate]=\"last_update\"\n                (dragging)=\"dragChange($event)\"\n                (inView)=\"in_view[holding_bay.id] = $event\"\n            ></day-view-space>\n            <day-view-approvals-view [date]=\"date\" [level]=\"level\"></day-view-approvals-view>\n        </div>\n    </div>\n</div>\n","import { Component, OnInit, Input, SimpleChanges, OnChanges } from '@angular/core';\nimport { first } from 'rxjs/operators';\n\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { Building } from 'src/app/services/data/organisation/building.class';\nimport { ReportDetails } from '../reports.component';\nimport { Report } from 'src/app/services/data/reports/report.class';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\nimport { ReportsService } from 'src/app/services/data/reports/reports.service';\n\nimport * as dayjs from 'dayjs';\n\n@Component({\n    selector: 'a-report-display',\n    templateUrl: './report-display.component.html',\n    styleUrls: ['./report-display.component.scss'],\n})\nexport class ReportDisplayComponent implements OnInit, OnChanges {\n    /** Details about the report being requested */\n    @Input() public report: ReportDetails;\n    /** Start date for the generated report */\n    public start_date: number = dayjs().startOf('d').valueOf();\n    /** End date for the generated report */\n    public end_date: number = dayjs().endOf('d').valueOf();\n    /** List of report data entries */\n    public report_data: Report;\n    /** Whether report data is loading */\n    public loading: boolean;\n    /** List of selected locations */\n    public locations: Building[];\n\n    /** List of available buildings */\n    public get buildings(): Building[] {\n        return this._org.buildings;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _org: OrganisationService,\n        private _reports: ReportsService\n    ) {}\n\n    public ngOnInit(): void {\n        this._org.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.locations = [this._org.building];\n        });\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.report) {\n            this.report_data = null;\n        }\n    }\n\n    /**\n     * Generate report\n     */\n    public generateReport() {\n        /* istanbul ignore else */\n        if (this.report) {\n            this.loading = true;\n            this.report_data = null;\n            this._reports\n                .show(this.report.id, {\n                    date: dayjs(this.start_date).format('YYYY-MM-DD'),\n                    start_date: Math.floor(this.start_date / 1000),\n                    end_date: Math.floor(this.end_date / 1000),\n                    zone_ids: this.locations.map((i) => i.id).join(','),\n                })\n                .then(\n                    (report) => {\n                        this.loading = false;\n                        this.report_data = new Report({ ...report, type: this.report.id });\n                    },\n                    (err) => {\n                        this.loading = false;\n                        this._service.notifyError(\n                            `Error generating report. Error: ${err.message || err}`\n                        );\n                    }\n                );\n        }\n    }\n\n    public downloadReport() {\n        /* istanbul ignore else */\n        if (this.report_data) {\n            const date = dayjs(this.start_date).format('YYYY-MM-DD');\n            this.report_data.downloadCSV(\n                `${this.report.name.split(' ').join('_').toLowerCase()}+${date}.csv`\n            );\n        }\n    }\n}\n","<div class=\"header\">\n    <div class=\"period\">\n        <div class=\"field\">\n            <label for=\"start-date\">Start Date</label>\n            <a-date-field\n                name=\"start-date\"\n                [(ngModel)]=\"start_date\"\n                [from]=\"end_date / 10\"\n                [to]=\"end_date\"\n            ></a-date-field>\n        </div>\n        <div class=\"gap\">to</div>\n        <div class=\"field\">\n            <label for=\"end-date\">End Date</label>\n            <a-date-field\n                name=\"end-date\"\n                [(ngModel)]=\"end_date\"\n                [from]=\"start_date\"\n                [to]=\"start_date * 10\"\n            ></a-date-field>\n        </div>\n    </div>\n    <div class=\"location dark-mode\">\n        <mat-form-field appearance=\"outline\" *ngIf=\"buildings && buildings.length > 1\">\n            <mat-select name=\"locations\" [(ngModel)]=\"locations\" multiple>\n                <mat-select-trigger>\n                    {{ locations ? locations[0]?.name : '' }}\n                    <span *ngIf=\"locations?.length > 1\" class=\"selection\">\n                        (+{{ locations.length - 1 }}\n                        {{ locations?.length === 2 ? 'other' : 'others' }})\n                    </span>\n                </mat-select-trigger>\n                <mat-option *ngFor=\"let building of buildings\" [value]=\"building\">\n                    <div class=\"option\">\n                        <div class=\"code\">{{ building.code }}</div>\n                        <div class=\"name\">{{ building.name }}</div>\n                    </div>\n                </mat-option>\n            </mat-select>\n        </mat-form-field>\n    </div>\n    <div class=\"actions\">\n        <button mat-button name=\"generate\" [disabled]=\"loading\" (tapped)=\"generateReport()\">\n            <span *ngIf=\"!loading; else gen_loader\">Generate</span>\n            <ng-template #gen_loader><mat-spinner diameter=\"32\"></mat-spinner></ng-template>\n        </button>\n        <button mat-button name=\"download\" [disabled]=\"!report_data\" (tapped)=\"downloadReport()\">Download</button>\n    </div>\n</div>\n<div class=\"display\">\n    <ng-container *ngIf=\"!loading; else load_state\">\n        <ng-container *ngIf=\"report_data && report_data.data.length; else empty_state\">\n            <a-report-table [list]=\"report_data.data || []\" [details]=\"report\"></a-report-table>\n        </ng-container>\n    </ng-container>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'arrow_upward' }\"></app-icon>\n        </div>\n        <div class=\"text\">\n            {{\n                report_data ? 'No entries for selected date' : 'Press generate above to view report'\n            }}\n        </div>\n    </div>\n</ng-template>\n<ng-template #load_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <mat-spinner diameter=\"32\"></mat-spinner>\n        </div>\n        <div class=\"text\">Loading report...</div>\n    </div>\n</ng-template>\n","import { Component, Input, SimpleChanges, OnChanges } from '@angular/core';\nimport { HashMap } from 'src/app/shared/utilities/types.utilities';\nimport { ReportDetails } from '../reports.component';\n\n@Component({\n    selector: 'a-report-table',\n    templateUrl: './report-table.component.html',\n    styleUrls: ['./report-table.component.scss'],\n})\nexport class ReportTableComponent implements OnChanges {\n    /** List of report table data */\n    @Input() public list: HashMap[] = [];\n    /** Map of details for report */\n    @Input() public details: ReportDetails;\n\n    public fields: string[] = [];\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.list && this.list && this.list.length) {\n            this.fields = Object.keys(this.list[0]).filter(i => this.details.hide_fields.indexOf(i) < 0);\n        }\n    }\n}\n","<table cdk-table [dataSource]=\"list\">\n    <!-- Position Column -->\n    <ng-container *ngFor=\"let key of fields\" [cdkColumnDef]=\"key\">\n        <th cdk-header-cell [attr.name]=\"key\" *cdkHeaderCellDef>{{ key }}</th>\n        <td cdk-cell [attr.name]=\"key\" *cdkCellDef=\"let element\">{{ element[key] }}</td>\n    </ng-container>\n\n    <tr cdk-header-row *cdkHeaderRowDef=\"fields\"></tr>\n    <tr cdk-row *cdkRowDef=\"let row; columns: fields\"></tr>\n</table>\n","import { Component, OnInit } from '@angular/core';\nimport { ApplicationIcon } from 'src/app/shared/utilities/settings.interfaces';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { BaseDirective } from 'src/app/shared/base.directive';\n\nexport interface ReportDetails {\n    /** ID associated with the report */\n    id: string;\n    /** Name of the report */\n    name: string;\n    /** Shortened name of the report */\n    short_name: string;\n    /** More details about the report */\n    description: string;\n    /** Fields to hide on the UI */\n    hide_fields: string[];\n    /** Icon to display for report */\n    icon: ApplicationIcon;\n}\n\n@Component({\n    selector: 'a-reports',\n    templateUrl: './reports.component.html',\n    styleUrls: ['./reports.component.scss'],\n})\nexport class ReportsComponent extends BaseDirective implements OnInit {\n    /** Currently selected date */\n    public date: string;\n    /** ID of the active report */\n    public active_report: string;\n    /** List of available reports to display */\n    public readonly reports: ReportDetails[] = [\n        {\n            id: 'bookings',\n            name: 'Aggregate Bookings Report',\n            short_name: 'Bookings',\n            description: 'Generate comprehensive report on various aspects of bookings',\n            hide_fields: ['room_email'],\n            icon: { type: 'img', src: 'assets/img/report-booking.svg' }\n        },\n        {\n            id: 'catering',\n            name: 'Aggregate Charge Back Report',\n            short_name: 'Catering',\n            description: 'View confirmed catering report or mark up unconfirmed catering',\n            hide_fields: ['room_email'],\n            icon: { type: 'icon', class: 'material-icons', content: 'room_service' }\n        },\n    ];\n\n    public get the_report(): ReportDetails {\n        return this.reports.find(report => report.id === this.active_report);\n    }\n\n    constructor(private _route: ActivatedRoute, private _router: Router) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.subscription('route.params', this._route.paramMap.subscribe((params) => {\n            if (params.has('report')) {\n                this.active_report = params.get('report');\n            }\n        }));\n    }\n\n    public updateReport() {\n        this._router.navigate(['/reports', this.active_report]);\n    }\n}\n","<div class=\"reports\">\n    <a-sidebar></a-sidebar>\n    <div class=\"group\">\n        <a-topbar-header [(date)]=\"date\">\n            <div class=\"topbar\" *ngIf=\"active_report\">\n                <mat-form-field *ngIf=\"reports && reports.length > 1\" appearance=\"outline\">\n                    <mat-select [(ngModel)]=\"active_report\" (ngModelChange)=\"updateReport()\">\n                        <mat-option *ngFor=\"let report of reports\" [value]=\"report.id\">\n                            {{ report.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n        </a-topbar-header>\n        <main>\n            <div class=\"options\" *ngIf=\"!active_report; else report_display\">\n                <a\n                    class=\"card\"\n                    mat-button\n                    *ngFor=\"let report of reports\"\n                    [routerLink]=\"['/reports', report.id]\"\n                >\n                    <div class=\"content\">\n                        <div class=\"icon\">\n                            <app-icon [icon]=\"report.icon\"></app-icon>\n                        </div>\n                        <h3>{{ report.short_name }}</h3>\n                        <div class=\"details\">\n                            <div class=\"desc\">{{ report.description }}</div>\n                            <app-icon\n                                [icon]=\"{\n                                    class: 'material-icons',\n                                    content: 'keyboard_arrow_right'\n                                }\"\n                            ></app-icon>\n                        </div>\n                    </div>\n                </a>\n            </div>\n        </main>\n    </div>\n</div>\n<ng-template #report_display>\n    <a-report-display [report]=\"the_report\">\n    </a-report-display>\n</ng-template>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Route, RouterModule } from '@angular/router';\n\nimport { ReportsComponent } from './reports.component';\nimport { SharedContentModule } from 'src/app/shared/shared.module';\nimport { ReportDisplayComponent } from './report-display/report-display.component';\nimport { ReportTableComponent } from './report-table/report-table.component';\n\nconst ROUTES: Route[] = [\n    { path: '', component: ReportsComponent },\n    { path: ':report', component: ReportsComponent },\n    { path: '**', redirectTo: '' }\n];\n\n@NgModule({\n  declarations: [ReportsComponent, ReportDisplayComponent, ReportTableComponent],\n  imports: [CommonModule, FormsModule, RouterModule.forChild(ROUTES), SharedContentModule]\n})\nexport class ReportsModule { }\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { first } from 'rxjs/operators';\n\nimport { BaseDirective } from '../shared/base.directive';\nimport { ApplicationService } from '../services/app.service';\nimport { ApplicationLoadingState, LoadingState } from '../shared/utilities/types.utilities';\nimport { ApplicationIcon } from '../shared/utilities/settings.interfaces';\nimport { UsersService } from '../services/data/users/users.service';\n\n@Component({\n    selector: 'app-shell-wrapper',\n    templateUrl: './shell.component.html',\n    styleUrls: ['./shell.component.scss'],\n})\nexport class ShellWrapperComponent extends BaseDirective implements OnInit {\n    /** Loading state of the application */\n    public loading_state: ApplicationLoadingState;\n    /** Logo of the application organisation */\n    public logo: ApplicationIcon;\n\n    constructor(private _service: ApplicationService, private _users: UsersService) {\n        super();\n    }\n\n    /** Whether the user needs to login */\n    public get show_login(): boolean {\n        return !this._users.is_logged_in;\n    }\n\n    /** Whether a module is still loading data */\n    public get is_loading(): boolean {\n        if (this.loading_state) {\n            for (const mod in this.loading_state) {\n                if (this.loading_state[mod] && this.loading_state[mod].state === 'loading') {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n\n    /** List of modules with a loading state */\n    public get loading_state_list(): LoadingState[] {\n        const list: LoadingState[] = [];\n        for (const mod in this.loading_state) {\n            if (this.loading_state[mod]) {\n                list.push(this.loading_state[mod]);\n            }\n        }\n        return list;\n    }\n\n    public ngOnInit(): void {\n        this.subscription(\n            'loading',\n            this._service.listen<ApplicationLoadingState>('loading').subscribe((loading) => {\n                this.loading_state = loading;\n            })\n        );\n        this._service.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.logo = this._service.setting('app.logo_dark') || { type: 'icon' };\n        });\n    }\n}\n","\n<div class=\"shell\">\n    <div class=\"view\" *ngIf=\"!show_login\">\n        <router-outlet></router-outlet>\n    </div>\n    <div class=\"login-module\" *ngIf=\"show_login\">\n        <app-login></app-login>\n    </div>\n    <div class=\"loading-block\" *ngIf=\"is_loading\">\n        <div class=\"info-block\">\n            <div class=\"header\" [style.background-color]=\"logo?.background\">\n                <div class=\"logo\">\n                    <i *ngIf=\"logo?.type === 'icon'\" [class]=\"logo.class\">{{ logo.content }}</i>\n                    <img *ngIf=\"logo?.type === 'img'\" [src]=\"logo.src | safe:'resource'\" />\n                </div>\n            </div>\n            <div class=\"item\" *ngFor=\"let item of loading_state_list\">\n                <div class=\"message\">{{ item.message }}</div>\n                <div class=\"icon\">\n                    <ng-container [ngSwitch]=\"item.state\">\n                        <ng-container *ngSwitchCase=\"'complete'\">\n                            <i class=\"material-icons success\">done</i>\n                        </ng-container>\n                        <ng-container *ngSwitchCase=\"'failed'\">\n                            <i class=\"material-icons failure\">close</i>\n                        </ng-container>\n                        <ng-container *ngSwitchDefault>\n                            <mat-spinner diameter=\"16\"></mat-spinner>\n                        </ng-container>\n                    </ng-container>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n","import { Component, OnInit, Input, SimpleChanges, OnChanges } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\n\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { User } from 'src/app/services/data/users/user.class';\nimport { Identity } from 'src/app/shared/utilities/types.utilities';\nimport { UsersService } from 'src/app/services/data/users/users.service';\n\n@Component({\n    selector: 'a-event-form',\n    templateUrl: './event-form.component.html',\n    styleUrls: ['./event-form.component.scss'],\n})\nexport class EventFormComponent implements OnChanges {\n    /** Booking details to display */\n    @Input() public event: Booking;\n    /** Booking details to display */\n    @Input() public form: FormGroup;\n\n    /** List of attendees in the booking */\n    public attendees: User[] = [];\n\n    constructor(private _users: UsersService) {}\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.event || changes.form) {\n            this.attendees = this.form.controls.attendees.value;\n        }\n    }\n\n    public addVisitor() {\n        const list = this.form.controls.attendees.value;\n        list.push(new User({ visitor: true }));\n        this.form.controls.attendees.setValue(list);\n    }\n\n    /** Replace visitor with updated values */\n    public replaceVisitor(item: User, index: number) {\n        const attendees = this.attendees;\n        attendees.splice(index, 1, item);\n        this.attendees = attendees;\n        this._users.addFrom('visitor-modal', item.toJSON(), 'other');\n        this.form.controls.attendees.setValue(attendees);\n    }\n\n    /** Remove visitor from attendee list */\n    public removeVisitor(item: User, index: number) {\n        const attendees = this.attendees;\n        attendees.splice(index, 1);\n        this.form.controls.attendees.setValue(attendees);\n    }\n\n    public trackByFn(index: number, item: Identity) {\n        return index;\n    }\n}\n","<form *ngIf=\"form\" [formGroup]=\"form\">\n    <div class=\"visitor-booking\" *ngIf=\"event\">\n        <div class=\"details\">\n            <div class=\"icon\">\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'event' }\"></app-icon>\n            </div>\n            <div class=\"time\">{{ event.start_time }} <span> - {{ event.duration > 0 ? event.end_time : '' }}</span></div>\n            <div class=\"host\">\n                <div class=\"staff\">S</div>\n                <div class=\"name\">{{ event.organiser?.name || event.organiser_email }}</div>\n            </div>\n            <div class=\"title\">\n                <label for=\"title\">Title</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"title\"\n                        placeholder=\"Meeting Title\"\n                        formControlName=\"title\"\n                    />\n                    <mat-error>Title is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"actions\"></div>\n        </div>\n        <div class=\"attendees\">\n            <div class=\"bar\"></div>\n            <ng-container *ngFor=\"let item of attendees; let i = index; trackBy: trackByFn\">\n                <div class=\"visitor\" *ngIf=\"item.external\">\n                    <a-visitor-form\n                        [event]=\"event\"\n                        [person]=\"item\"\n                        (personChange)=\"replaceVisitor($event, i)\"\n                    ></a-visitor-form>\n                    <button mat-icon-button name=\"remove\" (tapped)=\"removeVisitor(item, i)\">\n                        <app-icon [icon]=\"{ class: 'material-icons', content: 'delete' }\"></app-icon>\n                    </button>\n                </div>\n            </ng-container>\n            <button mat-button type=\"button\" name=\"add\" [class.add]=\"true\" (tapped)=\"addVisitor()\">\n                <div class=\"content\">\n                    <div class=\"icon\">\n                        <app-icon [icon]=\"{ class: 'material-icons', content: 'add' }\"></app-icon>\n                    </div>\n                    <div class=\"text\">Add visitor</div>\n                    <div class=\"bar\"></div>\n                </div>\n            </button>\n        </div>\n    </div>\n</form>\n","import { Component, OnInit, Input, SimpleChanges, OnChanges, EventEmitter, Output } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\n\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { User } from 'src/app/services/data/users/user.class';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { ApplicationService } from 'src/app/services/app.service';\n\n@Component({\n    selector: 'a-visitor-form',\n    templateUrl: './visitor-form.component.html',\n    styleUrls: ['./visitor-form.component.scss'],\n})\nexport class VisitorFormComponent extends BaseDirective implements OnChanges {\n    /** Booking that the user is assoicated with */\n    @Input() public event: Booking;\n    /** User details to display */\n    @Input() public person: User;\n    /** Form control for attendees */\n    @Input() public field: FormControl;\n    /** Emitter for changes to the person */\n    @Output() public personChange = new EventEmitter<User>();\n    /** Form fields for visitor details */\n    public form: FormGroup;\n\n    constructor(private _service: ApplicationService) {\n        super();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.person) {\n            delete this.form;\n            this.form = new FormGroup({\n                name: new FormControl(this.person.name, [Validators.minLength(2)]),\n                email: new FormControl(this.person.email, [Validators.required, Validators.email]),\n            });\n        }\n    }\n\n    public updatePerson() {\n        this.form.markAllAsTouched();\n        /* istanbul ignore else */\n        if (this.form.valid) {\n            this.person = new User({ ...this.form.value, visitor: true });\n            this.personChange.emit(this.person);\n        }\n    }\n}\n","<div class=\"icon\">\n    <app-icon [icon]=\"{ class: 'material-icons', content: 'face' }\"></app-icon>\n</div>\n<form *ngIf=\"form\" [formGroup]=\"form\">\n    <div class=\"details\">\n        <div class=\"name\">\n            <label for=\"name\">Name</label>\n            <mat-form-field appearance=\"outline\">\n                <input matInput name=\"name\" placeholder=\"Name\" formControlName=\"name\" (blur)=\"updatePerson()\" />\n                <mat-error>Name is required</mat-error>\n            </mat-form-field>\n        </div>\n        <div class=\"email\">\n            <label for=\"email\">Email Address</label>\n            <mat-form-field appearance=\"outline\">\n                <input matInput name=\"email\" type=\"email\" placeholder=\"Email Address\" formControlName=\"email\" (blur)=\"updatePerson()\" />\n                <mat-error>A valid email address is required</mat-error>\n            </mat-form-field>\n        </div>\n    </div>\n</form>\n<div class=\"bar\"></div>\n","import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { FormGroup, Validators, FormControl } from '@angular/forms';\nimport { MAT_DIALOG_DATA, MatDialogRef, MatDialog } from '@angular/material/dialog';\n\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { User } from 'src/app/services/data/users/user.class';\nimport { DialogEvent } from 'src/app/shared/utilities/types.utilities';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport {\n    ConfirmModalComponent,\n    CONFIRM_METADATA,\n} from 'src/app/overlays/confirm-modal/confirm-modal.component';\n\nexport interface VisitorsFormModalData {\n    /** Details of visitor listing */\n    booking: Booking;\n}\n\n@Component({\n    selector: 'a-visitors-form-modal',\n    templateUrl: './visitors-form-modal.component.html',\n    styleUrls: ['./visitors-form-modal.component.scss'],\n})\nexport class VisitorsFormModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form fields for visitor booking */\n    public form: FormGroup;\n    /** Display string for the loading state */\n    public loading: string;\n\n    /** Visitor booking data */\n    public get booking(): Booking {\n        return this._data.booking;\n    }\n\n    /** Whether form fields contain an attendee */\n    public get has_attendees() {\n        return (\n            this.form &&\n            this.form.controls.attendees.value &&\n            this.form.controls.attendees.value.length\n        );\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _dialog_ref: MatDialogRef<VisitorsFormModalComponent>,\n        private _dialog: MatDialog,\n        @Inject(MAT_DIALOG_DATA) private _data: VisitorsFormModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.form = new FormGroup({\n            title: new FormControl(this.booking.title, [Validators.required]),\n            attendees: new FormControl(this.booking.attendees, [Validators.minLength(1)]),\n        });\n    }\n\n    /** Delete visitor booking */\n    public delete() {\n        const ref = this._dialog.open(ConfirmModalComponent, {\n            ...CONFIRM_METADATA,\n            data: {\n                title: 'Delete meeting',\n                content: 'Are you sure you wish to delete this meeting?',\n                icon: { type: 'icon', class: 'material-icons', content: 'delete' },\n                action: 'Ok',\n            },\n        });\n        this.subscription(\n            'confirm',\n            ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    /* istanbul ignore else */\n                    if (this.booking.id) {\n                        this.loading = 'Deleting visitor booking...';\n                        this._dialog_ref.disableClose = true;\n                        this.booking.delete().then(\n                            () => {\n                                this.event.emit({ reason: 'done' });\n                                this._service.notifySuccess('Successfully removed visitors.');\n                                this._dialog_ref.close();\n                            },\n                            (err) => {\n                                this.loading = null;\n                                this._service.notifyError(\n                                    `Failed to remove visitors. Error: ${err.message || err}`\n                                );\n                                this._dialog_ref.disableClose = false;\n                            }\n                        );\n                    }\n                }\n                ref.close();\n            })\n        );\n    }\n\n    /** Save changes to visitor booking */\n    public save() {\n        this.timeout('save', () => {\n            this.loading = 'Saving visitor booking...';\n            this.form.markAllAsTouched();\n            this._dialog_ref.disableClose = true;\n            /* istanbul ignore else */\n            if (this.form.dirty && this.form.valid) {\n                const new_booking = new Booking({ ...this.booking, ...this.form.value });\n                new_booking.save().then(\n                    (bkn) => {\n                        this.event.emit({ reason: 'done', metadata: bkn });\n                        this._service.notifySuccess(\n                            this.booking.id\n                                ? 'Successfully updated visitors.'\n                                : 'Successfully added visitors.'\n                        );\n                        this._dialog_ref.close();\n                    },\n                    (err) => {\n                        this.loading = null;\n                        this._service.notifyError(\n                            `Failed to ${this.booking.id ? 'update' : 'add'} visitors. Error: ${\n                                err.message || err\n                            }`\n                        );\n                        this._dialog_ref.disableClose = false;\n                    }\n                );\n            }\n        });\n    }\n}\n","<header>\n    <div class=\"heading\">{{ booking.id ? 'Edit' : 'New' }} Visitors</div>\n    <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main *ngIf=\"!loading; else load_state\">\n        <a-event-form [form]=\"form\" [event]=\"booking\"></a-event-form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions *ngIf=\"!loading\">\n    <footer>\n        <button mat-button name=\"save\" [disabled]=\"!has_attendees\" (tapped)=\"save()\">Save</button>\n        <button mat-button name=\"delete\" class=\"error\" *ngIf=\"booking.id\" (tapped)=\"delete()\">\n            Delete\n        </button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main style=\"min-height: 12em;\">\n        <div class=\"info-block center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </main>\n</ng-template>\n","import { Component, Input, SimpleChanges, OnChanges } from '@angular/core';\n\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { ANIMATION_SHOW_CONTRACT_EXPAND } from 'src/app/shared/globals/angular-animations';\nimport {\n    VisitorsFormModalComponent,\n    VisitorsFormModalData,\n} from '../../overlays/visitors-form-modal/visitors-form-modal.component';\nimport { MatDialog } from '@angular/material/dialog';\n\n@Component({\n    selector: 'a-visitor-booking',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss'],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND],\n})\nexport class VisitorBookingItemComponent implements OnChanges {\n    /** Booking details to display */\n    @Input() public event: Booking;\n    /** Search filter string */\n    @Input() public search: string;\n    /** Whether attendee list should be shown */\n    public show_attendees: boolean;\n\n    /** Display string for checkin statuses of all attendees */\n    public get status(): string {\n        const checked_in_users = this.event.checked_in;\n        const { checked_in, count } = this.event.attendees.reduce(\n            (counts, user) => {\n                /* istanbul ignore else */\n                if (user.external) {\n                    counts.count++;\n                    /* istanbul ignore else */\n                    if (checked_in_users.indexOf(user.email) >= 0) {\n                        counts.checked_in++;\n                    }\n                }\n                return counts;\n            },\n            { checked_in: 0, count: 0 }\n        );\n        return `${checked_in} / ${count}`;\n    }\n\n    /** URL for mailing all attendees of the event */\n    public get mail_url(): string {\n        const subject = encodeURIComponent(\n            `${this.event.title}\" at ${this.event.start_time}, ${this.event.date_string}`\n        );\n        return `mailto:${this.event.attendees\n            .map((user) => user.email)\n            .join(',')}?Subject=${subject}\"`;\n    }\n\n    constructor(private _dialog: MatDialog) {}\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.search) {\n            this.show_attendees = !!this.search;\n        }\n    }\n\n    public openEditModal() {\n        this._dialog.open<VisitorsFormModalComponent, VisitorsFormModalData>(\n            VisitorsFormModalComponent,\n            {\n                data: {\n                    booking: this.event,\n                },\n            }\n        );\n    }\n}\n","<div class=\"visitor-booking\" *ngIf=\"event\" [class.showing]=\"show_attendees\">\n    <div class=\"details\" [class.blur]=\"search\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'event' }\"></app-icon>\n        </div>\n        <div class=\"time\">\n            <ng-container *ngIf=\"!event.all_day\">\n                {{ event.start_time }} <span> - {{ event.duration > 0 ? event.end_time : '' }}</span>\n            </ng-container>\n            <ng-container *ngIf=\"event.all_day\">All Day</ng-container>\n        </div>\n        <div class=\"host\">\n            <div class=\"staff\">S</div>\n            <div class=\"name\">{{ event.organiser?.name || event.organiser_email }}</div>\n        </div>\n        <div class=\"title\">{{ event.title }}</div>\n        <div class=\"location\">{{ event.space?.name || event.location }}</div>\n        <div class=\"status\">{{ status }}</div>\n        <div class=\"actions\">\n            <a mat-icon-button matTooltip=\"Email Visitors\" name=\"email-all\" [href]=\"mail_url | safe:'url'\">\n                <action-icon\n                    [icon]=\"{ class: 'material-icons', content: 'mail' }\"\n                ></action-icon>\n            </a>\n            <button mat-icon-button name=\"checkin-all\" matTooltip=\"Checkin All Visitors\">\n                <action-icon\n                    [icon]=\"{ class: 'material-icons', content: 'event_available' }\"\n                ></action-icon>\n            </button>\n            <button mat-icon-button matTooltip=\"Edit Visitors\" name=\"edit\" (tapped)=\"openEditModal()\">\n                <action-icon [icon]=\"{ class: 'material-icons', content: 'edit' }\"></action-icon>\n            </button>\n        </div>\n        <div class=\"toggle\">\n            <button mat-icon-button name=\"show-attendees\" (tapped)=\"show_attendees = !show_attendees\">\n                <app-icon\n                    [icon]=\"{\n                        class: 'material-icons',\n                        content: show_attendees ? 'keyboard_arrow_down' : 'keyboard_arrow_right'\n                    }\"\n                ></app-icon>\n            </button>\n        </div>\n    </div>\n    <div class=\"attendees\" [@show]=\"show_attendees ? 'show' : 'hide'\">\n        <div class=\"bar\"></div>\n        <a-visitor *ngFor=\"let item of event.attendees\" [event]=\"event\" [person]=\"item\" [search]=\"search\"></a-visitor>\n    </div>\n</div>\n","import { Component, OnInit, Input, SimpleChanges } from '@angular/core';\nimport { Observable, Subject, of } from 'rxjs';\nimport {\n    debounceTime,\n    distinctUntilChanged,\n    switchMap,\n    catchError,\n    map,\n    first\n} from 'rxjs/operators';\n\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\n\nimport * as dayjs from 'dayjs';\n\n@Component({\n    selector: 'visitor-timeline',\n    templateUrl: './timeline.component.html',\n    styleUrls: ['./timeline.component.scss']\n})\nexport class VisitorTimelineComponent extends BaseDirective implements OnInit {\n    /** Currently selected date */\n    @Input() public date: number;\n    /** Filter string */\n    @Input() public search: string;\n    /** List of visitor bookings for the current date */\n    public visitor_bookings: Booking[] = [];\n    /** List of filtered bookings */\n    public filtered_bookings: Booking[] = [];\n    /** Whether visitor list is loading */\n    public loading: boolean;\n    /** List of items from an API search */\n    public search_results$: Observable<Booking[]>;\n    /** Subject holding the value of the search */\n    public readonly search$ = new Subject<string>();\n\n    /** Display string for the selected date */\n    public get date_display() {\n        const date = dayjs(this.date);\n        return date.isSame(dayjs(), 'd') ? 'Today' : date.format('DD MMM YYYY');\n    }\n\n    public get active_index(): number {\n        /* istanbul ignore else */\n        if (this.date_display === 'Today') {\n            const date = dayjs().startOf('m').valueOf();\n            return this.filtered_bookings.findIndex(bkn => date > bkn.date);\n        }\n        return -1;\n    }\n\n    constructor(private _org: OrganisationService, private _spaces: SpacesService) {\n        super();\n    }\n\n    ngOnInit(): void {\n        this._org.initialised.pipe(first(_ => _)).subscribe(() => {\n            this.initBookings();\n            this.subscription(\n                'building',\n                this._org.listen('active_building').subscribe(_ =>\n                    this.search$.next(`${this.date}|${_.id}`)\n                )\n            );\n            this.interval('update_bookings', () => this.search$.next(`${this.date}|${dayjs().unix()}`), 30 * 1000);\n        });\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.date) {\n            this.search$.next(`${this.date}`);\n        }\n        /* istanbul ignore else */\n        if (changes.search) {\n            this.filtered_bookings = this.filter(this.search);\n        }\n    }\n\n    /** Filter the visitor bookings */\n    public filter(str: string = '') {\n        const search = str.toLowerCase();\n        return this.visitor_bookings.filter(booking => {\n            return booking.attendees.find(\n                user =>\n                    user.name.toLowerCase().indexOf(search) >= 0 ||\n                    user.email.toLowerCase().indexOf(search) >= 0\n            );\n        });\n    }\n\n    private initBookings() {\n        // Listen for input changes\n        this.search_results$ = this.search$.pipe(\n            debounceTime(100),\n            distinctUntilChanged(),\n            switchMap(_ => {\n                this.loading = true;\n                const date = dayjs(this.date).startOf('d');\n                const zone = this._org.building.id;\n                return this._spaces.query({\n                    zone_ids: zone,\n                    available_from: date.unix(),\n                    available_to: date.endOf('d').unix()\n                });\n            }),\n            catchError(_ => of([])),\n            map((list: Space[]) => {\n                const bookings: Booking[] = list.reduce(\n                    (items, space) => items.concat(space.bookingsFor(this.date)),\n                    []\n                );\n                bookings.sort((a, b) => a.date - b.date);\n                console.log('Bookings:', bookings.length, bookings.filter(bkn => bkn.has_visitors).length)\n                return bookings.filter(bkn => bkn.has_visitors);\n            })\n        );\n        // Process API results\n        this.subscription(\n            'search_results',\n            this.search_results$.subscribe(list => {\n                this.loading = false;\n                this.visitor_bookings = list;\n                this.filtered_bookings = this.filter(this.search);\n            })\n        );\n    }\n}\n","<div class=\"visitor-timeline\">\n    <div class=\"loader\" *ngIf=\"loading\">\n        <mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>\n    </div>\n    <div class=\"heading\">\n        <div class=\"icon\"></div>\n        <div class=\"time\">Time</div>\n        <div class=\"host\">Host</div>\n        <div class=\"title\">Title</div>\n        <div class=\"location\">Location</div>\n        <div class=\"state\">Status</div>\n    </div>\n    <div class=\"list\">\n        <ng-container *ngIf=\"filtered_bookings && filtered_bookings.length; else empty_state\">\n            <div class=\"current-line\" *ngIf=\"date_display === 'Today' && (active_index === -1)\">\n                <div class=\"triangle\"></div>\n            </div>\n            <ng-container *ngFor=\"let booking of filtered_bookings; let i = index\">\n                <a-visitor-booking [event]=\"booking\" [search]=\"search\"></a-visitor-booking>\n                <div class=\"current-line\" *ngIf=\"date_display === 'Today' && (active_index === i)\">\n                    <div class=\"triangle\"></div>\n                </div>\n            </ng-container>\n        </ng-container>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No visitors {{ search ? 'matching ' + '\"' + search + '\"' : '' }} for {{ date_display }}</div>\n    </div>\n</ng-template>\n","import { Component, Input, SimpleChanges, Renderer2, ElementRef, OnChanges } from '@angular/core';\n\nimport { User } from 'src/app/services/data/users/user.class';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\n\n@Component({\n    selector: 'a-visitor',\n    templateUrl: './visitor.component.html',\n    styleUrls: ['./visitor.component.scss']\n})\nexport class VisitorComponent implements OnChanges {\n    /** Booking that the user is assoicated with */\n    @Input() public event: Booking;\n    /** User details to display */\n    @Input() public person: User;\n    /** Search filter string */\n    @Input() public search: string;\n    /** Status of the visitor */\n    public status: string;\n\n    /** Whether user is a match for  */\n    public get is_match(): boolean {\n        const search = (this.search || '').toLowerCase();\n        return (\n            this.person.name.toLowerCase().indexOf(search) >= 0 ||\n            this.person.email.toLowerCase().indexOf(search) >= 0\n        );\n    }\n\n    /** URL for mailing all attendees of the event */\n    public get mail_url(): string {\n        return `mailto:${this.person.email}?subject=\"${this.event.title}\"%20at%20${\n            this.event.start_time\n        },%20${this.event.date_string}${\n            this.event.organiser.email.toLowerCase() !== this.person.email\n                ? '&cc=' + this.event.organiser.email\n                : ''\n        }`;\n    }\n\n    constructor(private _element: ElementRef<HTMLElement>, private _renderer: Renderer2) {}\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.search) {\n            if (this.search && !this.is_match) {\n                this._renderer.addClass(this._element.nativeElement, 'not-match');\n            } else {\n                this._renderer.removeClass(this._element.nativeElement, 'not-match');\n            }\n        }\n    }\n}\n","<div class=\"icon\">\n    <app-icon [icon]=\"{ class: 'material-icons', content: 'face' }\"></app-icon>\n</div>\n<div class=\"details\">\n    <div class=\"user\">\n        <div class=\"staff\" *ngIf=\"!person.external\">S</div>\n        <div class=\"name\">{{ person?.name || person?.email }}</div>\n    </div>\n    <div class=\"title\"></div>\n    <div class=\"status\" *ngIf=\"person.external\">{{ status }}</div>\n    <div class=\"actions\">\n        <a mat-icon-button matTooltip=\"Email Visitor\" [href]=\"mail_url | safe:'url'\">\n            <action-icon\n                [icon]=\"{ class: 'material-icons', content: 'mail' }\"\n            ></action-icon>\n        </a>\n        <button mat-icon-button matTooltip=\"Checkin Visitor\">\n            <action-icon *ngIf=\"person.external\"\n                [icon]=\"{ class: 'material-icons', content: 'event_available' }\"\n            ></action-icon>\n        </button>\n        <button mat-icon-button [disabled]=\"true\"></button>\n    </div>\n    <div class=\"empty\"></div>\n</div>\n<div class=\"bar\"></div>\n","import { Component, OnInit } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport {\n    VisitorsFormModalComponent,\n    VisitorsFormModalData,\n} from './overlays/visitors-form-modal/visitors-form-modal.component';\n\nimport * as dayjs from 'dayjs';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\n\n@Component({\n    selector: 'app-visitors',\n    templateUrl: './visitors.component.html',\n    styleUrls: ['./visitors.component.scss'],\n})\nexport class VisitorsComponent implements OnInit {\n    /** Currently selected date */\n    public date: string;\n    /** Search filter string */\n    public search_str: string;\n\n    public get has_visitor_space(): boolean {\n        const building = this._org.building;\n        return !!this._spaces.find(building.visitor_space || building.holding_bay);\n    }\n\n    constructor(\n        private _dialog: MatDialog,\n        private _spaces: SpacesService,\n        private _org: OrganisationService\n    ) {}\n\n    ngOnInit(): void {}\n\n    public newVisitorMeeting() {\n        let date = dayjs();\n        date = date.minute(Math.ceil(date.minute() / 5) * 5);\n        const building = this._org.building;\n        const space = this._spaces.find(building.visitor_space || building.holding_bay);\n        const booking = new Booking({ date: date.valueOf(), duration: -1, room_id: [space.email] });\n        this._dialog.open<VisitorsFormModalComponent, VisitorsFormModalData>(\n            VisitorsFormModalComponent,\n            {\n                data: {\n                    booking,\n                },\n            }\n        );\n    }\n}\n","<div class=\"visitors\">\n    <a-sidebar></a-sidebar>\n    <div class=\"group\">\n        <a-topbar-header [(date)]=\"date\" (dateChange)=\"search_str = ''\">\n            <div class=\"input-wrapper\">\n                <mat-form-field [class.rounded]=\"true\" appearance=\"outline\">\n                    <app-icon [icon]=\"{ class: 'material-icons', content: 'search' }\" matPrefix></app-icon>\n                    <input matInput [(ngModel)]=\"search_str\" name=\"visitor-name\" placeholder=\"Search...\" />\n                    <button mat-icon-button matSuffix *ngIf=\"search_str\" (tapped)=\"search_str = ''\">\n                        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n                    </button>\n                </mat-form-field>\n            </div>\n        </a-topbar-header>\n        <main>\n            <visitor-timeline [date]=\"date\" [search]=\"search_str\"></visitor-timeline>\n        </main>\n    </div>\n    <button mat-button name=\"new\" class=\"new-item\" (tapped)=\"newVisitorMeeting()\" *ngIf=\"has_visitor_space\">\n        <div class=\"content\">\n            <div class=\"material-icons\">add</div>\n            <div class=\"text\">Add Visitors</div>\n        </div>\n    </button>\n</div>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Route, RouterModule } from '@angular/router';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { VisitorsComponent } from './visitors.component';\nimport { SharedContentModule } from 'src/app/shared/shared.module';\nimport { VisitorTimelineComponent } from './timeline/timeline.component';\nimport { VisitorBookingItemComponent } from './timeline/item/item.component';\nimport { VisitorComponent } from './timeline/visitor/visitor.component';\nimport { VisitorsFormModalComponent } from './overlays/visitors-form-modal/visitors-form-modal.component';\nimport { EventFormComponent } from './overlays/visitors-form-modal/event-form/event-form.component';\nimport { VisitorFormComponent } from './overlays/visitors-form-modal/visitor-form/visitor-form.component';\n\nconst ROUTES: Route[] = [\n    { path: '', component: VisitorsComponent },\n    { path: ':level', component: VisitorsComponent },\n    { path: '**', redirectTo: '' },\n];\n\n@NgModule({\n    declarations: [\n        VisitorsComponent,\n        VisitorTimelineComponent,\n        VisitorBookingItemComponent,\n        VisitorComponent,\n        VisitorsFormModalComponent,\n        EventFormComponent,\n        VisitorFormComponent,\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        RouterModule.forChild(ROUTES),\n        SharedContentModule,\n    ],\n})\nexport class VisitorsModule {}\n","import { Component, Input, SimpleChanges, OnChanges } from '@angular/core';\n\nimport { Space } from 'src/app/services/data/spaces/space.class';\n\nimport * as dayjs from 'dayjs';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\n\n@Component({\n    selector: 'week-view-day-display',\n    templateUrl: './day-display.component.html',\n    styleUrls: ['./day-display.component.scss']\n})\nexport class WeekViewDayDisplayComponent implements OnChanges {\n    /** Date to display bookings for */\n    @Input() public date: number;\n    /** List of spaces to display bookings for */\n    @Input() public spaces: Space[];\n    /** List of bookings for this date */\n    public booking_list: Booking[] = [];\n\n    /** Display string for the set date */\n    public get date_display(): string {\n        const date = dayjs(this.date);\n        return date.format('ddd, DD MMM YYYY');\n    }\n\n    /** Whether the date set is today */\n    public get is_today(): boolean {\n        return dayjs(this.date).isSame(dayjs(), 'd');\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.date || changes.spaces) {\n            this.updateBookings();\n        }\n    }\n\n    private updateBookings(): void {\n        let bookings = [];\n        this.spaces.forEach(space => {\n            bookings = bookings.concat(space.bookingsFor(this.date));\n        });\n        bookings.sort((a, b) => a.date - b.date);\n        this.booking_list = bookings;\n    }\n}\n","<div class=\"heading\">\n    <div class=\"text\">{{ date_display }}</div>\n    <div class=\"info\" *ngIf=\"is_today\">Today</div>\n</div>\n<div class=\"list\">\n    <ng-container *ngIf=\"booking_list && booking_list.length; else empty_state\">\n        <week-view-item *ngFor=\"let event of booking_list\" [event]=\"event\"></week-view-item>\n    </ng-container>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No events for {{ date_display }}</div>\n    </div>\n</ng-template>\n","import { Component, Input } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { MeetingDetailsModalComponent } from 'src/app/overlays/meeting-details-modal/meeting-details-modal.component';\n\n@Component({\n    selector: 'week-view-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss']\n})\nexport class WeekViewItemComponent {\n    @Input() public event: Booking;\n\n    /** Type of booking */\n    public get type(): string {\n        if (this.event.declined) {\n            return 'cancelled';\n        }\n        const booking_type = this.event.type;\n        if (booking_type === 'internal' && this.event.has_visitors) {\n            return 'external';\n        }\n        return booking_type;\n    }\n\n    constructor(private _dialog: MatDialog) {}\n\n    /**\n     * Open modal to view bookings details\n     */\n    public viewMeetingDetails() {\n        this._dialog.open(MeetingDetailsModalComponent, {\n            maxWidth: 'calc(100vw - 2em)',\n            data: {\n                booking: this.event\n            }\n        })\n    }\n}\n","<div\n    [class]=\"\n        'event' +\n        (type ? ' ' + type : '') +\n        (event.status === 'done' ? ' ended' : '') +\n        (event.status === 'in_progress' ? 'in-progress' : '')\n    \"\n    *ngIf=\"event\"\n    [attr.id]=\"event?.id\"\n    (tapped)=\"viewMeetingDetails()\"\n>\n    <div class=\"heading\">\n        <div class=\"text\">{{ event.all_day ? 'All Day' : event.time_period }}</div>\n        <div class=\"handle\">\n            <app-icon\n                *ngIf=\"event.declined || event.approved\"\n                [icon]=\"{\n                    class: 'material-icons',\n                    content: event.approved ? 'done' : 'event_busy'\n                }\"\n            >\n            </app-icon>\n        </div>\n    </div>\n    <div class=\"details\">\n        <div class=\"field\" [title]=\"event.organiser?.name || event.organiser_email\">\n            <label for=\"host\">Host:</label>\n            <div class=\"value\" name=\"host\">{{ event.organiser?.name || event.organiser_email }}</div>\n        </div>\n        <div class=\"field\" [title]=\"event.space?.name || event.location\">\n            <label for=\"location\">Location:</label>\n            <div class=\"value\" name=\"location\" [matTooltip]=\"event.space?.name || event.location\">\n                {{ event.space?.name || event.location }}\n            </div>\n        </div>\n        <div class=\"field\">\n            <label for=\"attendees\">Attendees:</label>\n            <div class=\"value\" name=\"attendees\">{{ event.attendees?.length || '0' }}</div>\n        </div>\n    </div>\n</div>\n","import { Component, OnInit, Input, SimpleChanges } from '@angular/core';\nimport { Subject, Observable, of } from 'rxjs';\nimport { debounceTime, distinctUntilChanged, switchMap, catchError } from 'rxjs/operators';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { ApplicationService } from 'src/app/services/app.service';\n\nimport * as dayjs from 'dayjs';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\n\n@Component({\n    selector: 'week-view-timeline',\n    templateUrl: './timeline.component.html',\n    styleUrls: ['./timeline.component.scss']\n})\nexport class WeekViewTimelineComponent extends BaseDirective implements OnInit {\n    /** Timestamp of the active date */\n    @Input() public date: number;\n    /** ID of the active level */\n    @Input() public level: string;\n    /** ID of the room type to filter displayed spaces by */\n    @Input() public space_type: string;\n    /** Whether weekends are displayed */\n    @Input() public weekends: boolean;\n    /** Whether space bookings are being loaded */\n    @Input() public loading: boolean;\n    /** List of dates to display */\n    public date_list: number[] = [];\n    /** List of spaces to display bookings for */\n    public space_list: Space[] = [];\n    /** List of items from an API search */\n    public search_results$: Observable<Space[]>;\n    /** Subject holding the value of the search */\n    public readonly search$ = new Subject<string>();\n\n    constructor(private _spaces: SpacesService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.date_list = this.generateDates(this.date, this.weekends);\n        this.initBookings();\n        this.search$.next(`${this.date}|${this.weekends}|${this.level}`);\n        this.interval(\n            'update_booking',\n            () =>\n                this.search$.next(`${this.date}|${this.weekends}|${this.level}|${dayjs().unix()}`),\n            30 * 1000\n        );\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.date || changes.weekends || changes.level) {\n            this.date_list = this.generateDates(this.date, this.weekends);\n            this.search$.next(`${this.date}|${this.weekends}|${this.level}`);\n        }\n    }\n\n    /**\n     * Generate list of dates to display\n     * @param date Currently selected date\n     * @param weekends Whether weekends should be included\n     */\n    private generateDates(date: number, weekends: boolean = false): number[] {\n        const list: number[] = [];\n        let day = dayjs(date).startOf('d');\n        let start = day.startOf('w');\n        const end = start.endOf('w');\n        while (start.isBefore(end, 'm')) {\n            if ((start.day() !== 0 && start.day() !== 6) || weekends) {\n                list.push(start.valueOf());\n            }\n            start = start.add(1, 'd');\n        }\n        return list;\n    }\n\n    private initBookings() {\n        // Listen for input changes\n        this.search_results$ = this.search$.pipe(\n            debounceTime(100),\n            distinctUntilChanged(),\n            switchMap(_ => {\n                this.loading = true;\n                const date = dayjs(this.date).startOf('w');\n                return this._spaces.query({\n                    zone_ids: `${this.level}${this.space_type ? ',' + this.space_type : ''}`,\n                    available_from: Math.floor(this.date_list[0] / 1000) || date.unix(),\n                    available_to:\n                        Math.floor(this.date_list[this.date_list.length - 1] / 1000) ||\n                        date.endOf('w').unix()\n                });\n            }),\n            catchError(_ => of([]))\n        );\n        // Process API results\n        this.subscription(\n            'search_results',\n            this.search_results$.subscribe(list => {\n                this.loading = false;\n                this.space_list = list;\n            })\n        );\n    }\n}\n","<div class=\"week-timeline\">\n    <div class=\"loader\" *ngIf=\"loading\">\n        <mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>\n    </div>\n    <week-view-day-display\n        *ngFor=\"let date of date_list\"\n        [date]=\"date\"\n        [spaces]=\"space_list\"\n    ></week-view-day-display>\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { first } from 'rxjs/operators';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { BuildingLevel } from 'src/app/services/data/organisation/level.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { Identity } from 'src/app/shared/utilities/types.utilities';\nimport { BookingModalComponent } from 'src/app/overlays/booking-modal/booking-modal.component';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { OrganisationService } from 'src/app/services/data/organisation/organisation.service';\n\n@Component({\n    selector: 'a-week-view',\n    templateUrl: './week-view.component.html',\n    styleUrls: ['./week-view.component.scss'],\n})\nexport class WeekViewComponent extends BaseDirective implements OnInit {\n    /** Currently selected date */\n    public date: string;\n    /** Whether weekends are displayed */\n    public weekend: boolean;\n    /** ID of the currently selected level */\n    public active_level: string = '';\n    /** ID of the currently selected level */\n    public active_type: string = '';\n    /** List of levels available for the active building */\n    public levels: BuildingLevel[] = [];\n    /** List of space types available for the active building */\n    public space_types: Identity[] = [];\n\n    constructor(\n        private _service: ApplicationService,\n        private _org: OrganisationService,\n        private _dialog: MatDialog,\n        private _router: Router,\n        private _route: ActivatedRoute\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._service.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.subscription(\n                'route.params',\n                this._route.paramMap.subscribe((params) => {\n                    /* istanbul ignore else */\n                    if (params.has('level') && this.active_level !== params.get('level')) {\n                        const level = this._org.levelWithID(params.get('level'));\n                        /* istanbul ignore else */\n                        if (level) {\n                            const building = this._org.buildings.find(\n                                (bld) => bld.id === level.building_id\n                            );\n                            /* istanbul ignore else */\n                            if (building) {\n                                this.active_level = level.id;\n                                this._org.building = building;\n                            }\n                        }\n                    }\n                })\n            );\n            this.subscription(\n                'building',\n                this._org.listen('active_building').subscribe(() => {\n                    const building = this._org.building;\n                    /* istanbul ignore else */\n                    if (!building.levels.find((lvl) => lvl.id === this.active_level)) {\n                        this.active_level = (building.levels[0] || { id: '' }).id;\n                        this.updateLevel();\n                    }\n                    this.levels = [{ id: '', name: 'All Levels' } as any].concat(building.levels);\n                    this.levels.sort((a, b) => a.name.localeCompare(b.name));\n                    this.space_types = [{ id: '', name: 'All Space Types' } as any].concat(\n                        this._org.space_types\n                    );\n                })\n            );\n        });\n    }\n\n    public newMeeting() {\n        this._dialog.open(BookingModalComponent, {\n            data: {\n                booking: new Booking({}),\n            },\n        });\n    }\n\n    public updateLevel() {\n        this._router.navigate(['/week-view', this.active_level]);\n    }\n}\n","<div class=\"week-view\">\n    <a-sidebar></a-sidebar>\n    <div class=\"group\">\n        <a-topbar-header [(date)]=\"date\">\n            <div class=\"topbar\">\n                <mat-form-field *ngIf=\"levels && levels.length > 1\" appearance=\"outline\">\n                    <mat-select [(ngModel)]=\"active_level\" (ngModelChange)=\"updateLevel()\">\n                        <mat-option *ngFor=\"let level of levels\" [value]=\"level?.id\">\n                            {{ level?.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <mat-form-field *ngIf=\"space_types && space_types.length > 1\" appearance=\"outline\">\n                    <mat-select [(ngModel)]=\"active_type\">\n                        <mat-option *ngFor=\"let type of space_types\" [value]=\"type?.id\">\n                            {{ type?.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <mat-slide-toggle\n                    [(ngModel)]=\"weekend\"\n                    labelPosition=\"before\"\n                    title=\"Only show meetings with setup and breakdown times\"\n                >\n                    Show Weekends\n                </mat-slide-toggle>\n            </div>\n        </a-topbar-header>\n        <main>\n            <week-view-timeline\n                [date]=\"date\"\n                [level]=\"active_level\"\n                [space_type]=\"active_type\"\n                [weekends]=\"weekend\"\n            ></week-view-timeline>\n        </main>\n    </div>\n    <button mat-button class=\"new-item\" name=\"new\" (tapped)=\"newMeeting()\">\n        <div class=\"content\">\n            <div class=\"material-icons\">add</div>\n            <div class=\"text\">New Meeting</div>\n        </div>\n    </button>\n</div>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { WeekViewComponent } from './week-view.component';\nimport { WeekViewTimelineComponent } from './timeline/timeline.component';\nimport { SharedContentModule } from 'src/app/shared/shared.module';\nimport { WeekViewDayDisplayComponent } from './day-display/day-display.component';\nimport { WeekViewItemComponent } from './day-display/item/item.component';\n\nconst ROUTES: Route[] = [\n    { path: '', component: WeekViewComponent },\n    { path: ':level', component: WeekViewComponent },\n    { path: '**', redirectTo: '' }\n];\n\n@NgModule({\n    declarations: [WeekViewComponent, WeekViewTimelineComponent, WeekViewDayDisplayComponent, WeekViewItemComponent],\n    imports: [CommonModule, FormsModule, RouterModule.forChild(ROUTES), SharedContentModule]\n})\nexport class WeekViewModule {}\n","export const environment = {\n  production: true\n};\n","\nimport { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"]}