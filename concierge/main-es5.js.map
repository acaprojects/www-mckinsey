{"version":3,"sources":["webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/animations/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/animations/src/lib/angular-animations.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/animations/src/lib/animations.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/base.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/base.directive.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/base.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/cdk-drop-list-scroll-container.directive.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/date.spec-helpers.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/date.utils.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/general.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/image.directive.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/numbers-only.directive.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/replace.pipe.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/bookings/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/bookings/src/lib/bookings.actions.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/bookings/src/lib/bookings.effects.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/bookings/src/lib/bookings.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/bookings/src/lib/bookings.reducer.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/bookings/src/lib/bookings.utils.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/buildings/src/lib/buildings.actions.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/api.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/app.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/base-api.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/base.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/booking-filter.utils.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/booking.form.actions.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/booking.form.data.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/booking.form.spec-helpers.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/booking.selectors.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/booking.utils.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/room-results/room-results.viewmodel.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/booking-state.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/booking.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/booking.types.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/booking.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/bookings.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/bookingsPaginated.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/space.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering-categories.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering-category.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering-item.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering-items.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering-menu.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering-notes.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering-order.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/data-common.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/hotkeys.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/location/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/location/location.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/location/location.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/organisation/building.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/organisation/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/organisation/level.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/organisation/organisation.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/organisation/organisation.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/paginated.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/recurrence/recurrence.utils.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/reports/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/reports/report.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/reports/reports.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/service-manager.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/settings.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/spaces/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/spaces/space.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/spaces/space.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/spaces/spaces.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/spec-helpers.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/users/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/users/user.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/users/user.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/users/users.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/validation.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/date-tz/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/date-tz/src/lib/date-tz.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/environment/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/environment/src/lib/environment.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/environment/src/lib/environment.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/environment/src/lib/version.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/booking-confirm/booking-confirm.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/booking-confirm/booking-confirm.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/booking-form/booking-form.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/booking-form/booking-form.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/catering-confirm-modal/catering-confirm-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/catering-confirm-modal/catering-confirm-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/catering-details-modal/catering-details-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/catering-details-modal/catering-details-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/confirm-modal/confirm-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/confirm-modal/confirm-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/legacy-overlays.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/new-user-modal/new-user-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/new-user-modal/new-user-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/no-catering-modal/no-catering-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/no-catering-modal/no-catering-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/requirement-details-modal/requirement-details-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/requirement-details-modal/requirement-details-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/space-select-modal/space-select-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/space-select-modal/space-select-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/user-form/user-form.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/user-form/user-form.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/action-icon/action-icon.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/action-icon/action-icon.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/bookings/catering/item/item.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/bookings/catering/item/item.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/bookings/catering/package-options-modal/package-options-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/bookings/catering/package-options-modal/package-options-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/action-field/action-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/action-field/action-field.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/counter/counter.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/counter/counter.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/date-field/date-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/date-field/date-field.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/duration-field/duration-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/duration-field/duration-field.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/time-field/time-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/time-field/time-field.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/user-list-field/user-list-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/user-list-field/user-list-field.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/user-search-field/user-search-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/user-search-field/user-search-field.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/feedback/feedback.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/feedback/feedback.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/icon/icon.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/icon/icon.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/legacy-ui.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/popout-menu/popout-menu.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/popout-menu/popout-menu.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/searchbar/searchbar.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/searchbar/searchbar.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/user-avatar/user-avatar.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/user-avatar/user-avatar.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/loading/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/loading/src/lib/loading.actions.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/loading/src/lib/loading.effects.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/loading/src/lib/loading.model.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/loading/src/lib/loading.selectors.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/loading/testing/effects.testing.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/loading/testing/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/rooms/src/lib/rooms.actions.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/storage/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/storage/src/lib/localstorage.wrapper.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/storage/src/lib/storage.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/aca-date-picker/aca-date-picker.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/aca-date-picker/aca-date-picker.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/alert-banner/alert-banner.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/auto-complete-chip-select-item/auto-complete-chip-select-item.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/auto-complete-chip-select-item/groupHeader.pipe.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/auto-complete-select-option/auto-complete-select-option.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/auto-complete-select-option/auto-complete-select-option.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/base-template.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/cng-select/cng-select-options.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/cng-select/cng-select-options.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/cng-select/cng-select.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/cng-select/cng-select.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/cng-select/dropdown-trigger-for.directive.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/collapse-header/collapse-header.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/conflict-alert-modal/conflict-alert-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/conflict-alert-modal/conflict-alert-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/conflicts-modal/conflicts-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/conflicts-modal/conflicts-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/date-tz-calendar-widget/date-tz-calendar-widget.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/date-tz-calendar-widget/date-tz-calendar-widget.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/date-tz-date-picker/date-tz-date-picker.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/date-tz-duration-field/date-tz-duration-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/date-tz-time-field/date-tz-time-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/duration-field/duration-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/error-message/error-message.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/icons/calendar/calendar-icon.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/icons/calendar/chevron-icon.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/icons/close/close-icon.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/informational-image/informational-image.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/label/label.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/legend-dropdown/legend-dropdown.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/mck-date-picker/mck-date-picker.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/modal-button-row/modal-button-row.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/modal/modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/override-changes-modal/override-changes-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/override-changes-modal/override-changes-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/pipes/filter.pipe.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/pipes/sanitise.pipe.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/radio-select/radio-select.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/recurrence-booking-form/recurrence-booking-form.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/recurrence-booking-form/recurrence-booking-form.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/recurrence-date-form/recurrence-date-form.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/recurrence-date-form/recurrence-date-form.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/recurrence-pattern-form/recurrence-pattern-form.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/recurrence-pattern-form/recurrence-pattern-form.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/select-option/select-option.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/select/select.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/select/select.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/selected-chip-count/selected-chip-count.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/spacer/spacer.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/switch-group/switch-group.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/time-field/time-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/toggle/toggle.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/types.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/ui.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/utils/time.utils.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/user/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/user/src/lib/user.actions.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/user/src/lib/user.effects.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/user/src/lib/user.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/user/src/lib/user.reducer.ts","webpack:///$_lazy_route_resource lazy namespace object","webpack:///src/app/app-routing.module.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///src/app/bookings/booking-modal/booking-modal.component.ts","webpack:///src/app/bookings/booking-modal/booking-modal.component.html","webpack:///src/app/bookings/booking-modal/catering/catering.component.ts","webpack:///src/app/bookings/booking-modal/catering/catering.component.html","webpack:///src/app/bookings/booking-modal/catering/order-details/category/category.component.ts","webpack:///src/app/bookings/booking-modal/catering/order-details/category/category.component.html","webpack:///src/app/bookings/booking-modal/catering/order-details/order-details.component.ts","webpack:///src/app/bookings/booking-modal/catering/order-details/order-details.component.html","webpack:///src/app/bookings/booking-modal/catering/order-list/item/item.component.ts","webpack:///src/app/bookings/booking-modal/catering/order-list/item/item.component.html","webpack:///src/app/bookings/booking-modal/catering/order-list/order-list.component.ts","webpack:///src/app/bookings/booking-modal/catering/order-list/order-list.component.html","webpack:///src/app/bookings/booking-modal/find-space/filters/filters.component.ts","webpack:///src/app/bookings/booking-modal/find-space/filters/filters.component.html","webpack:///src/app/bookings/booking-modal/find-space/find-space.component.ts","webpack:///src/app/bookings/booking-modal/find-space/find-space.component.html","webpack:///src/app/bookings/booking-modal/find-space/item/item.component.ts","webpack:///src/app/bookings/booking-modal/find-space/item/item.component.html","webpack:///src/app/bookings/booking-modal/form/form.component.ts","webpack:///src/app/bookings/booking-modal/form/form.component.html","webpack:///src/app/bookings/bookings.module.ts","webpack:///src/app/bookings/delete-confirm-modal/delete-confirm-modal.component.ts","webpack:///src/app/bookings/delete-confirm-modal/delete-confirm-modal.component.html","webpack:///src/app/calendar/calendar.module.ts","webpack:///src/app/calendar/day-view/approvals-view/approvals-view.component.ts","webpack:///src/app/calendar/day-view/approvals-view/approvals-view.component.html","webpack:///src/app/calendar/day-view/approvals-view/event/event.component.ts","webpack:///src/app/calendar/day-view/approvals-view/event/event.component.html","webpack:///src/app/calendar/day-view/day-view.component.ts","webpack:///src/app/calendar/day-view/day-view.component.html","webpack:///src/app/calendar/day-view/day-view.module.ts","webpack:///src/app/calendar/day-view/space/event/event.component.ts","webpack:///src/app/calendar/day-view/space/event/event.component.html","webpack:///src/app/calendar/day-view/space/space.component.ts","webpack:///src/app/calendar/day-view/space/space.component.html","webpack:///src/app/calendar/day-view/timeline/timeline.component.ts","webpack:///src/app/calendar/day-view/timeline/timeline.component.html","webpack:///src/app/calendar/meeting-details-modal/catering/catering.component.ts","webpack:///src/app/calendar/meeting-details-modal/catering/catering.component.html","webpack:///src/app/calendar/meeting-details-modal/details/details.component.ts","webpack:///src/app/calendar/meeting-details-modal/details/details.component.html","webpack:///src/app/calendar/meeting-details-modal/meeting-details-modal.component.ts","webpack:///src/app/calendar/meeting-details-modal/meeting-details-modal.component.html","webpack:///src/app/calendar/meeting-details-modal/private-details-modal/private-details-modal.component.ts","webpack:///src/app/calendar/meeting-details-modal/private-details-modal/private-details-modal.component.html","webpack:///src/app/calendar/meeting-details-modal/private-details/private-details.component.ts","webpack:///src/app/calendar/meeting-details-modal/private-details/private-details.component.html","webpack:///src/app/calendar/meeting-details-modal/recurring-details/recurring-details.component.ts","webpack:///src/app/calendar/meeting-details-modal/recurring-details/recurring-details.component.html","webpack:///src/app/calendar/meeting-details-modal/requirements/requirements.component.ts","webpack:///src/app/calendar/meeting-details-modal/requirements/requirements.component.html","webpack:///src/app/calendar/week-view/day-display/day-display.component.ts","webpack:///src/app/calendar/week-view/day-display/day-display.component.html","webpack:///src/app/calendar/week-view/day-display/item/item.component.ts","webpack:///src/app/calendar/week-view/day-display/item/item.component.html","webpack:///src/app/calendar/week-view/timeline/timeline.component.ts","webpack:///src/app/calendar/week-view/timeline/timeline.component.html","webpack:///src/app/calendar/week-view/week-view.component.ts","webpack:///src/app/calendar/week-view/week-view.component.html","webpack:///src/app/calendar/week-view/week-view.module.ts","webpack:///src/app/catering/catering.component.ts","webpack:///src/app/catering/catering.component.html","webpack:///src/app/catering/catering.module.ts","webpack:///src/app/catering/catering.storage.ts","webpack:///src/app/catering/menu/item-list/item-list.component.ts","webpack:///src/app/catering/menu/item-list/item-list.component.html","webpack:///src/app/catering/menu/item/item.component.ts","webpack:///src/app/catering/menu/item/item.component.html","webpack:///src/app/catering/menu/menu.component.ts","webpack:///src/app/catering/menu/menu.component.html","webpack:///src/app/catering/orders/item/item.component.ts","webpack:///src/app/catering/orders/item/item.component.html","webpack:///src/app/catering/orders/orders.component.ts","webpack:///src/app/catering/orders/orders.component.html","webpack:///src/app/catering/overlays/category-modal/category-modal.component.ts","webpack:///src/app/catering/overlays/category-modal/category-modal.component.html","webpack:///src/app/catering/overlays/group-modal/group-modal.component.ts","webpack:///src/app/catering/overlays/group-modal/group-modal.component.html","webpack:///src/app/catering/overlays/item-modal/item-modal.component.ts","webpack:///src/app/catering/overlays/item-modal/item-modal.component.html","webpack:///src/app/catering/overlays/order-details-modal/booking-details/booking-details.component.ts","webpack:///src/app/catering/overlays/order-details-modal/booking-details/booking-details.component.html","webpack:///src/app/catering/overlays/order-details-modal/items/items.component.ts","webpack:///src/app/catering/overlays/order-details-modal/items/items.component.html","webpack:///src/app/catering/overlays/order-details-modal/messages/messages.component.ts","webpack:///src/app/catering/overlays/order-details-modal/messages/messages.component.html","webpack:///src/app/catering/overlays/order-details-modal/order-details-modal.component.ts","webpack:///src/app/catering/overlays/order-details-modal/order-details-modal.component.html","webpack:///src/app/components/access-denied/access-denied.component.ts","webpack:///src/app/components/access-denied/access-denied.component.html","webpack:///src/app/components/sidebar/sidebar.component.ts","webpack:///src/app/components/sidebar/sidebar.component.html","webpack:///src/app/components/topbar-header/topbar-header.component.ts","webpack:///src/app/components/topbar-header/topbar-header.component.html","webpack:///src/app/login/login.component.ts","webpack:///src/app/login/login.component.html","webpack:///src/app/reports/report-display/report-display.component.ts","webpack:///src/app/reports/report-display/report-display.component.html","webpack:///src/app/reports/report-table/report-table.component.ts","webpack:///src/app/reports/report-table/report-table.component.html","webpack:///src/app/reports/reports.component.ts","webpack:///src/app/reports/reports.component.html","webpack:///src/app/reports/reports.module.ts","webpack:///src/app/room-admin/bulk-qr-overlay/bulk-qr-overlay.component.ts","webpack:///src/app/room-admin/bulk-qr-overlay/bulk-qr-overlay.component.html","webpack:///src/app/room-admin/manage-photos/manage-photos.component.ts","webpack:///src/app/room-admin/manage-photos/manage-photos.component.html","webpack:///src/app/room-admin/room-admin-routing.module.ts","webpack:///src/app/room-admin/room-admin.component.ts","webpack:///src/app/room-admin/room-admin.component.html","webpack:///src/app/room-admin/room-admin.module.ts","webpack:///src/app/room-admin/room-details/room-details-wrapper.component.ts","webpack:///src/app/room-admin/room-details/room-details.component.ts","webpack:///src/app/room-admin/room-details/room-details.component.html","webpack:///src/app/room-admin/rooms-table/rooms-table-datasource.ts","webpack:///src/app/room-admin/rooms-table/rooms-table.component.ts","webpack:///src/app/room-admin/rooms-table/rooms-table.component.html","webpack:///src/app/room-admin/services/index.ts","webpack:///src/app/room-admin/services/read-local-pic.service.ts","webpack:///src/app/room-admin/services/resize.service.ts","webpack:///src/app/room-admin/services/room-admin.service.ts","webpack:///src/app/room-admin/util/file-drag-n-drop.directive.ts","webpack:///src/app/room-admin/util/room-admin-utility.ts","webpack:///src/app/shared/shared.module.ts","webpack:///src/app/shell/shell.component.ts","webpack:///src/app/shell/shell.component.html","webpack:///src/app/visitors/overlays/visitors-form-modal/event-form/event-form.component.ts","webpack:///src/app/visitors/overlays/visitors-form-modal/event-form/event-form.component.html","webpack:///src/app/visitors/overlays/visitors-form-modal/visitor-form/visitor-form.component.ts","webpack:///src/app/visitors/overlays/visitors-form-modal/visitor-form/visitor-form.component.html","webpack:///src/app/visitors/overlays/visitors-form-modal/visitors-form-modal.component.ts","webpack:///src/app/visitors/overlays/visitors-form-modal/visitors-form-modal.component.html","webpack:///src/app/visitors/timeline/item/item.component.ts","webpack:///src/app/visitors/timeline/item/item.component.html","webpack:///src/app/visitors/timeline/timeline.component.ts","webpack:///src/app/visitors/timeline/timeline.component.html","webpack:///src/app/visitors/timeline/visitor/visitor.component.ts","webpack:///src/app/visitors/timeline/visitor/visitor.component.html","webpack:///src/app/visitors/visitors.component.ts","webpack:///src/app/visitors/visitors.component.html","webpack:///src/app/visitors/visitors.module.ts","webpack:///src/environments/environment.ts","webpack:///src/environments/settings.ts","webpack:///src/main.ts"],"names":["ANIMATION_SHOW_ENTER_LEAVE","trigger","transition","style","opacity","height","animate","ANIMATION_SHOW_CONTRACT_EXPAND","state","AnimationsModule","CommonModule","NgModule","imports","BaseClass","_timers","_intervals","_subscriptions","_initialised","BehaviorSubject","key","hasOwnProperty","clearTimeout","clearInterval","unsub","name","fn","delay","Function","setTimeout","Error","setInterval","Subscription","unsubscribe","getValue","BaseDirective","destroy","Directive","selector","BaseModule","NumbersOnlyDirective","declarations","exports","ScrollDirection","CdkDropListScrollContainer","_cdkDropList","_renderer","direction","X","last_scroll","x","y","changes","scrollContainer","element","nativeElement","closest","subscription","items","subscribe","list","toArray","forEach","i","index","listen","onDrop","onDrag","updateListPosition","timeout","scroll","scrollLeft","scrollTop","BOTH","Y","_dropListRef","_cacheOwnPosition","_siblings","isReceiving","CdkDrag","Input","ContentChildren","initialTime","mockDate","timeOverride","set","Date","resetDate","reset","closestToTimeSlot","date","stepMinute","start","millisecond","second","minute","Math","ceil","plus","minutes","closestToTimeSlotTz","dateTz","setValue","addValue","durationHumanized","duration","short","h","floor","d","m","weekDayMonthYearFormat","formatDate","extractDateFromInput","input","checkHour","startDate","dayjs","dayJsTimeFormatString","isValid","cleanedInput","times","split","undefined","length","dayJsHoursMinutes","month","year","hour","nearestStepToInput","step","currentStartDate","luxonDate","DateTime","fromMillis","valueOf","closestDate","toFormat","nearestDurationToInput","durationGroups","value","parseInt","indexOf","add","diff","closestDurationGroup","find","max","offset","reduce","previousValue","currentValue","resetSecondsOnTimestamp","timestamp","toMillis","formatDateWithSuffix","dateObj","day","getDate","toLocaleString","getFullYear","nthNumber","number","getListOfDateFormat","extend","utc","timezone","isToday","weekday","customParseFormat","log","type","msg","args","stream","force","app_name","window","debug","colors","console","getItemWithKeys","keys","map","slice","isMobileDevice","r","navigator","userAgent","match","isMobileSafari","agent","isAndroidChrome","padZero","str","toString","unique","array","filter","el","pos","arr","humaniseDuration","durationInput","size","singular","format","hours","filterList","fields","results","filters","toLowerCase","f","parts","push","word","count","regex","RegExp","sort","a","b","localeCompare","item_list","JSON","parse","stringify","item","match_count","match_index","field_list","matched","field","matches","replace","changed","tokens","k","join","matchToHighlight","timeToDate","time","DateNow","startOfValue","ms","randomInt","random","timeFormatString","is24HourTime","hoursMinutes","timezoneNameToDate","timeZoneName","zone","toZone","e","timezoneDisplay","gmtOffsetDisplay","timeWithZoneFormatString","toLocaleLowerCase","timeWithGmtOffsetFormatString","startEndTimeFormatString","startDateTz","endDateTz","startEndTimeWithZoneFormatString","dateLocalFormatString","comma","formatLocalDate","dateBuildingFormatString","shorterLocalDateFormatString","shorterBuildingDateFormatString","localeString","toLocaleTimeString","document","querySelector","getAttribute","language","downloadFile","filename","contents","createElement","setAttribute","encodeURIComponent","display","body","appendChild","click","removeChild","csvToJson","csv","lines","splice","v","line","part","jsonToCsv","json","Array","Object","valid_keys","detectIE","ua","msie","substring","trident","rv","edge","eventToPoint","event","MouseEvent","clientX","clientY","touches","flatten","an_array","stack","res","next","pop","isArray","reverse","seed","xmur3","rand","sfc32","predictableRandomInt","imul","charCodeAt","c","t","isLessThanBreakpoint","breakpoint","innerWidth","toTitleCase","toUpperCase","ImageDirective","_el","initalValue","stopPropagation","HostListener","ReplacePipe","from","to","Pipe","bookingStateSelector","bookings","loadBookingsWithQuery","createAction","props","loadHomepageBookingsResults","createLoadingAction","loadUpcomingBookingsResults","loadPastBookingsResults","loadCancelledBookingsResults","loadBookingByIdResults","clearBookingByIdResults","BookingsEffects","actions","bookingService","afterBookingsRequestResultsLoadOthersEffect","pipe","ofType","mergeMap","action","DateTZ","yourBookingsRequest","email","pagination","limit","show_cancelled","end_epoch","subtractValue","seconds","include_rooms","upcomingRequest","pastRequest","start_epoch","cancelledRequest","byIdRequest","id","effects","target","request","loadHomepageBookingsResultsEffect","createLoadingEffect","userBookings","loadUpcomingBookingsResultsEffect","loadPastBookingsResultsEffect","loadCancelledBookingsResultsEffect","loadBookingByIdResultsEffect","Effect","Injectable","BookingsModule","EffectsModule","forFeature","StoreModule","bookingsReducer","initialBookingsState","query","LoadingModel","empty","homepage","upcoming","past","cancelled","bookingById","createReducer","on","ons","initialBookingFormState","activeFormFilters","bookingFormReducer","storeBookingFormData","activeForm","payload","clearBookingFormData","openBookingSurvey","bookingCompleted","storeRoomFilters","clearRoomFilters","mapBookingToSelectOption","booking","loadBuildings","buildingStateSelector","buildings","selectLoadBuildingsSuccess","createSelector","selectors","optionalSuccess","selectBuildingOptionsGroupedByCity","success","mapped","Map","s","found","city","get","selectLevelByZoneId","param","levels","l","toQueryString","ApplicationService","store","analytics","_app_ref","_zone","_title","_settings","_hotkeys","_composer","_snackbar","_environment","_subjects","_observers","isStable","first","_","run","waitForSettings","message","on_action","icon","content","snackbar_ref","open","panelClass","afterDismissed","dismiss","onAction","notify","asObservable","initialised","init","setupComposer","select","selectCurrentUser","user","take","setupAnalytics","fmno","application","loading","composer","settings","protocol","location","host","domain","hostname","port","url","use_domain","origin","route","includes","mock","href","localStorage","getItem","config","scope","auth_uri","token_uri","redirect_uri","handle_login","local_login","setup","heap_io_id","heapIo","app_id","load","identify","frontend","isIt","_kioskFormFilter","title_suffix","setting","setTitle","getTitle","auth","api_endpoint","is_initialised","providedIn","BaseDataClass","raw_data","event_subject","Subject","events","_server_names","zone_id","_service","form","toJSON","Promise","resolve","reject","promise","update","then","metadata","task_name","parameters","task","obj","_changes","new_key","ServiceManager","serviceFor","BaseAPIService","settingsService","_subscribers","_promises","_compare","_list_filter","_name","_api_route","form_data","concierge","err","engine","endpoint","predicate","query_params","cache","result","http","process","processApiResult","catchError","error","of","new_item","post","injectConcierge","analyticsEvent","updateList","method","post_data","_task","put","removeItem","should_inject_concierge","apiSubRoute","token","sessionStorage","access_token","headers","HttpHeaders","requestOptions","q","label","raw_item","old_list","compareFn","new_list","mixed_list","spaceExtraFeatureToDisplayName","feature","SpaceFeatures","VideoConference","ConferencePhone","WirelessContentSharing","FlipChart","Glassboard","ElectronicWhiteboard","ConferenceRoom","TeamRoom","PartnerOffice","PhoneBooth","NaturalLight","BoardRoom","CocktailRoom","TheatreRoom","WorkshopRoom","UShapeRoom","Miscellaneous","Catering","instantBookOption","shortDisplay","instantBookOptions","mapSpaceFeaturesToSelectOption","roomEquipmentRequiredOptions","internalRoomTypeRequiredOptions","externalRoomTypeRequiredOptions","roomDetailsRequired","roomCateringAvailable","SpaceFilterReason","filterSpacesByAppliedFilters","formFilters","spaces","currentUser","instantBook","some","onlyCatering","featureFilters","formFiltersEmpty","options","rulesCount","ruleReason","excludedByFiltersCount","statusMap","group","filteredSpaces","space","Space","raw_space","building","zones","rules","rulesForSpace","booking_rules","reason","valid","hide","hasAllFeatures","every","featuresArray","canBook","bookable","matchesType","bookingType","internal_or_external","hasCatering","has_catering","status","statusFromBookings","Booking","auto_approve","groupEnd","specificReason","None","Filters","OfficeRules","DEFAULT_BOOKING_DURATION","internalBookingTypeOption","allBookingTypeOption","bookingTypeOptions","defaultRoomSizeOption","roomSizeOptions","roomSizeOptionsKiosk","roomCapacityToValue","roomSize","roomMaxCapacityToValue","roomFormDataToQuery","data","filteredLocationIds","groupChild","locations","capacity","capacity_max","now","defaultTestBookingForm","selectBookingFormsData","bookingForm","selectActiveForm","is_local_tz","building_tz","selectBookingType","selectBookingLocations","groupHeader","selectIsInternal","selectFormFilters","selectRoomResultsFromState","roomStateSelector","loadRoomsForResults","model","selectRoomResultsFromState_map","loadRoomsForResultsMap","selectLaterThatDayResultsFromState","loadLaterThatDayResults","selectNextDayResultsFromState","loadNextDayResults","selectByIdResultsFromState","loadByIdResults","selectDiffSizeResultsFromState","loadDiffSizeResults","selectHomepageBookingsResultsFromState","selectUpcomingBookingsResultsFromState","selectPastBookingsResultsFromState","selectCancelledBookingsResultsFromState","selectBookingByIdResultsFromState","filterSpacesByAppliedFiltersIfSuccess","mutate","selectFilteredResults","selectMapFilteredResults","selectFilteredLaterDayResults","selectFilteredNextDayResults","selectFilteredByIdResults","selectFilteredDiffSizeResults","selectSelectedBuildingOptions","MAX_ABBREV_LOCATIONS","mapBuildingToSelectOption","dropdownOverride","code","address","groupId","meta","mapCityToAllSelectOption","flattenDisplayOffices","grouped","toggleSelectedByGroup","selectedOptions","option","toSelect","selected","newGroup","remainingChildrenInGroup","o","ng","truncateLocationList","truncatedLocations","shouldTruncate","mapBuildingLevelToOption","level","flattenBuildingsWithLevels","flattenedLevels","placeholderRoute","num","setupRoomImages","componentReference","image_positions","rootFolderURL","fileSlug","imagesLoaded","foundImages","path","n","desiredImageName","desiredImage","pathname","tester","Image","onload","loadImages","src","bookingStatusDetails","image","text","title","roomHasCateringHours","catering_hours","cateringAllowed","disallowedStatus","opens","closed","end","openMinutes","closeMinutes","startOfDay","cateringOpenTime","cateringCloseTime","checkCollisions","service","available","room_ids","breakdown","hide_bookings","start_time","end_time","has_conflict","bkn","b_setup","b_breakdown","getStatusErrorMessage","RoomResultsViewModel","levelDisplay","short_name","local_name","office","mapResultsToViewModels","BookingStateService","_org","_spaces","ngZone","_poll","_long_poll","_long_poll_week","_bookings","_noOfMeetings","_filters","_dateTz","_loading","_state","combineLatest","filtered","bdTz","booking_date","startTz","endTz","endOfValue","filterBookings","shareReplay","filtered_week","bd","getEndOfWeek","filtered_month","search","debounceTime","switchMap","fzone","queryBooking","zone_ids","available_from","available_to","search_long_week","querySpace","space_list","processBookings","dailyCount","days","daily_count","buildSpaceLongQuery","counts","details","runOutsideAngular","interval","new_bookings","concat","icaluid","undo","attempted_to_delete","bkg","booking_master","recurrence_type","recurrence_master_id","period","replaceBookings","room_email","fromTz","toTz","intersects","timePeriodsIntersect","in_zone","room","has_space","space_emails","in_zones","declined","getType","show","hide_type","dateWeekday","time_changed","SettingsService","is_concierge","nowTz","defaultTitle","defaultLocalTimezone","Intl","DateTimeFormat","resolvedOptions","timeZone","defaultBuildingZone","defaultOrgainiser","User","active_user","defaultBookingType","building_zone","booking_type","attendees","organiser","creator","booked_by","notes","equipment_codes","expected_attendees","check_ins","notify_users","company","booker","booker_concierge","level_zone","room_id","findSpace","defaultStartTz","startEpochProvided","startDateTzProvided","round","created_epoch","all_day","show_as","approvalStatus","approval_status","catering","CateringOrder","edited_fields","edits","values","recurrence_count","recurrence_days","occurrence_edits","recurrence_endTz","recurrence_end","recurrence_exceptions","occurrence_ids","recurrence_interval","recurrence_period","occurrence_details","is_recurrent","recurrence_starts","author","isEdit","opts","note","handleRecurrenceFields","recurrence_list","location_name","from_room","approve","old_start","old_end","creation_date","creationDateTz","cateringOrders","allAttendees","checked_in","checkInsArray","has_visitors","occurence","getTime","shift","_recurrence_endTz","byRequest","tentative","delivery_time","getTimezoneOffsetString","abs","dateDiff","displayEndDateTz","external","buildingTzDt","isBeforeDate","isAfterDate","mergeCateringOrders","order_list","orders","order","location_id","booking_timezone","BOOKING_STATUS","MINUTE","HOUR","DAY","WEEK","MONTH","DURATION_MAP","months","week","weeks","bookingOptionsToQuery","property","until","getFreeBookingSlots","min_size","slots","bkn_start","bkn_end","getNextFreeBookingSlot","date_","block","generateBookingForm","use_fields","isConcierge","manualTimezone","user_service","current_user","current","FormControl","disabled","Validators","required","validators","minLength","updateOn","needs_space","is_before_date","setValidators","validateEndTime","disable","dateValidators","isFuture","validDateTZ","updateValueAndValidity","list_length","valueChanges","expected","codes","new_expected","new_codes","space_needed","simplified_fields","handleAllDay","clone","enable","occurrences","RecurrencePeriod","LIST","occurrence","SeriesAction","CLONE","BookingAction","start_dateTz","d1","d2","_recurr_end","fields_with_recurrence","WEEKLY","recurrence_pattern","arrayWithValues","FormGroup","control","validDate","isSameDate","JSDate","getMinLength","rule_list","min","min_block","min_length","conditions","stringToMinutes","durationGreaterThanOrEqual","duration_1","duration_2","requestable","free_slots","next_free_slot","currently_free","time_until_next_block","free_tomorrow","free_today","available_until","spaceStatusToDisplay","filter_options","filtered_list","updated_list","start1","end1","start2","end2","formatWhen","startTZ","endTZ","displayEndTZ","BookingsService","setService","uniqueId","respond","series","toApiJSON","taskObsr","requests","booking_id","forkJoin","BookingsPaginatedService","getHoldingBay","queryHoldingBay","response","PaginatedAPIService","space_rules_for_user","rule_block","checkRules","ruleset","max_length","counter","condition","groups","j","last_location","check","CateringCategoriesService","CateringCategory","is_category","must_select","order_anytime","CateringItem","_amount","instance_id","from_month","to_month","description","prior_notice","notice","unit_price","price","supplier_cost","minimum_quantity","maximum_quantity","parent_categories","category_ids","categories","image_path","catering_type","amount","allergy","cateringItems","filteredCateringItems","out_of_stock","availableItems","substr","anytime","can_order_anytime","CateringItemsService","CateringMenuService","CateringNotesService","cateringNotes","hasBookingAttached","bookingDateTz","charge_code","kitchen","pantry","symbol","total","deliver_date","mergeCateringItemWithFormData","existing","override","DataCommonModule","INVALID_STANDALONE_KEYS","HotkeysService","keydown_states","keydown_observers","combo_end","registered_combos","addEventListener","mapKey","last_down","preventDefault","combo","combination","validCombination","last_key","updateCombinationEndList","presses","key_list","non_meta","MapLocation","map_id","desk_id","normalise","x_max","Organisation","BuildingLevel","levelWithID","fixed","confidence","at_desk","bld","building_id","LocationService","Building","disc_info","discovery_info","extras","extra_id","extra_name","loan_items","_roles","roles","_lockers","lockers","locker_structure","_systems","systems","_phone_numbers","phone_numbers","_location","longitude","latitude","searchables","neighbourhoods","lvl","lvl_features","level_id","booking_details","catering_restricted_from","currency","requires_equipment_code","equipment_code","requires_expected_attendees","holding_bay","visitor_space","sort_order","_data","bld_id","level_name","lower_name","map_url","floor_type","available_buildings","OrganisationService","_users","_organisation","ids","bld_list","_active_building","organisation","loadOrganisation","loadLevels","space_types","loadSpaceTypes","tags","org_data","loadBuildingsWithOrg","bld_data","lvl_data","type_data","types","getOrganizationFiltersByRoomType","setItem","DaysOfWeek","RepeatsOn","recurrencePeriodToDurationType","DAILY","ABSOLUTE_MONTHLY","generateWeekDays","params","start_week","week_days","activeDate","active","full_name","day_index","getFirstDateFromList","getLastDateFromList","recurrenceDetails","recurr","getPeriod","recurrenceRecurringDetails","removeExpiredOcurrences","controls","tz","date_now","setStartAndEndDateFromArray","dates","setRecurrenceStartsTime","dateHour","Report","cleanData","txt","charAt","formatCancelledBy","room_field","price_field","row","space_service","org_service","CurrencyPipe","transform","organizer","person","isCancelled","cancelled_by","cancelled_at_epoch","cancelled_date","remove_fields","output","idx_a","idx_b","csv_json","ReportsService","fromCSV","_service_list","findIndex","provider","provideFor","useValue","SETTINGS_TOKEN","SettingsObject","_app_name","_overrides","_observables","VERSION","built","semver","hash","override_settings","Inject","OPTION_DEFAULTS","SpaceEquipments","SpaceStyles","EMPTY_ARRAY","room_style","equipment","defaultGlobalName","defaultSettings","room_name","support_url","features","extra_features","room_type","simple_name","rulesFor","nowMs","runningBookings","bks","startEpoch","endEpoch","spaceWithBookings","roomType","natural_light","vc","Set","recurrence_availability","availabilityOptionsToQuery","hide_declined","blds","bld_b","a_has_zone","b_has_zone","SPACE_LIST","SpacesService","queryRooms","updateSpace","uploadSpacePhotos","filterAvailableSpaces","faker","SERVICE","generateMockOrganisationService","jest","generateMockBuilding","getRoomTypeSubsetDDOptions","generateMockDataService","generateMockSpacesService","generateMockUsersService","loadCurrentUser","bookingState","setZone","setDate","setFilters","remove","startPolling","startPollingMonth","startPollingWeek","startPollingEveryFiveMin","test_app","logo_light","background","logo_dark","heap_io","force_ssl","secure_cookie","disable_text_capture","cookie_path","TEST_SETTINGS","app","generateMockSettingsService","overrides","provideMockSettingsObject","provide","generateMockAppService","settingsOverrides","notifyInfo","notifyWarn","notifySuccess","notifyError","navigate","navigateBack","Composer","Hotkeys","Users","Locations","Base","Menu","Spaces","Bookings","Reports","CateringItems","CateringCategories","Settings","generateMockUser","booking_list","fill","generateMockBooking","mockReturnValue","save","addFrom","removeFrom","clearList","removeFromList","accept","decline","checkin","is_logged_in","queryRoomsForQR","queryObsr","checkinIndividualVisitor","updateObsr","mockImplementation","SPACE_COUNT","generateMinimalRoomDetails","generateMockSpace","space_id","recurring_search","lastName","room_booking_screen","linked","commerce","productName","searchable","controlable","hourly_rate","sort_priority","business","USER_DOMAIN","BOOKING_COUNT","BOOKING_DATE","setMockBookingStartDatetime","visitor","generateMockCateringOrder","menu","date_start","users","lorem","paragraph","BLD_COUNT","LVL_COUNT","generateMockLevel","levelGenerator","firstName","test","nested","level2","org","USER_COUNT","USER_EMAILS","companyName","delegates","delegate_count","first_name","last_name","phone","phoneNumber","department","staff_code","avatar","pickMenuItem","menu_map","category","generateMockLocation","fixed_locations","maps","ORG_COUNT","generateMockOrganisation","generateMockBuildingSetByCity","generateMockModalData","pendingDate","pendingDuration","mockDateToBuildingTz","windows_id","mobile","business_unit","organisation_id","organisation_name","officeLocation","desk","generateUserForm","pattern","UsersService","uhttp","expiry","reload","client_id","Md5","hashStr","go","append","authorise","logout","tries","locate","loadDelegates","promises","all","HAS_ERROR","buildValidateDate","validateDate","is_from","buildValidateStartTime","validateStartTime","date_obj","buildValidateDuration","validateDuration","buildValidateAttendees","validateAttendees","invalid","dateControlTz","noWhitespaceValidator","isWhitespace","trim","whitespace","date_org","local_tz","zoneName","compare_to","unit","ans_unit","newDate","startOf","monday","sunday","later","endOf","isLastDayOfMonth","minus","hasSame","dateYear","dateMonth","dateDay","trunc","toSeconds","toUTC","toJSDate","getDay","convertLocalTimestampToTimezonedDateTz","buildingTimezone","getHours","getMinutes","convertTimezonedTimestampToLocalDateTz","localOffset","getTimezoneOffset","desiredOffset","eleA","localTimezone","offset_minutes","toMiddayUTC","timezoneOffset","EnvironmentModule","providers","ENVIRONMENT_TOKEN","EnvironmentService","environment","production","BookingConfirmComponent","_booking_state_service","_router","_dialog","_dialog_ref","EventEmitter","lastMomentConflict","old_booking","is_request","approved","bookingDetails","bookedBy","disableClose","checkSpaceAvailability","newEmail","replaceObjects","constructor","replacement","nk","has_note_buffer","EDIT","updated","master_booking","emit","erroMessage","close","queryParams","ignore","ref","ConflictsModalComponent","maxWidth","width","conflicts","copy_conflicts","componentInstance","clipboard","writeText","conflictsText","afterClosed","duration_value","recurrenceDates","a_space","dateTZ","MAT_DIALOG_DATA","Component","templateUrl","styleUrls","Output","BookingFormComponent","cdRef","user_list","fromDateTz","untilDateTz","localStart","localEnd","updateCoachmarkTimes","skip","distinctUntilChanged","recurrenceStarts","clearValidators","arrayValidators","disableInputs","has_id","is_edit","patchValue","SpaceSelectModalComponent","multiple","needsCatering","NewUserModalComponent","detectChanges","localTzOffset","buildingTzOffset","changeDetection","ChangeDetectionStrategy","OnPush","BookingCateringConfirmModalComponent","CateringDetailsModalComponent","_cateringNotesService","head_counts","needs_charge_code","active_space","note_list","notes_field","generateFormFields","markAllAsTouched","is_valid","new_notes","setNotes","_scrollToBottom","_content_el","scrollTo","top","scrollHeight","left","behavior","active_form","errors","minlength","submit","ViewChild","CONFIRM_METADATA","maxHeight","ConfirmModalComponent","DECLARATIONS","NoCateringModalComponent","RequirementDetailsModalComponent","UserFormComponent","LegacyOverlaysModule","LegacyUiModule","FormsModule","ReactiveFormsModule","UiModule","EditorModule","new_user","confirm","cancel","codes_field","head_counts_field","head_count","roomBasedEqCode","officeBasedEqCode","change$","selected_spaces","request_map","formGroup","triggerSearch","savedSelection","request_id","search_results$","active_building","resp","active_type","_space","setDefaultBuilding","grouped_by_city","city_buildings","noCateringDialogRef","autoFocus","backdropClass","defaultBld","opt","space_a","space_b","withLatestFrom","formData","ActionIconComponent","hasSelectionRequirements","getActiveList","CateringMenuItemComponent","initial_state","an_cat","setAmount","cat","an_item","updatePackageSelection","setPrice","selectPackageOptions","confirmed_item","cart_item","active_items","updatedList","PackageOptionsModalComponent","done","a_list","animations","checkItemRequirements","getActiveItems","a_package","needed","ActionFieldComponent","show_tooltip","performAction","CounterComponent","useInput","previous_value","handleTimeout","ctrl_key","shift_key","new_value","changeInput","Number","isNaN","_onChange","_onTouch","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","DateFieldComponent","_from","position","onChange","old_date","new_d","new_date","_trigger","closeMenu","openMenu","_to","years","menuOpen","MatMenuTrigger","openDatePicker","$event","closeDatePicker","DurationFieldComponent","specialPreprops","duration_options","generateDurationOptions","blocks","TimeFieldComponent","no_past_times","show_select","_time_options","generateAvailableTimes","select_field","focus","openedChange","datestamp","show_past","showSelect","UserListFieldComponent","search$","search_str","match_name","match_email","inputAutoComplete","openPanel","closePanel","active_list","a_user","file","files","reader","FileReader","readAsText","evt","processCsvData","srcElement","endsWith","addUser","template","MatAutocompleteTrigger","addUsersFromFile","downloadCSVTemplate","read","UserSearchFieldComponent","resetSearchString","FeedbackComponent","updateRoute","NavigationEnd","current_page","IconComponent","PopoutMenuComponent","SearchbarComponent","UserAvatarComponent","MATERIAL_MODULES","MatButtonModule","MatSnackBarModule","MatDialogModule","MatFormFieldModule","MatInputModule","MatProgressSpinnerModule","MatProgressBarModule","MatAutocompleteModule","MatSelectModule","MatChipsModule","MatRippleModule","MatMenuModule","MatCheckboxModule","MatTooltipModule","MatRadioModule","MatTabsModule","MatSlideToggleModule","ACA_PIPES_MODULE","valueChange","autofocus","focusField","input_field","actionPrefix","stateKey","buildAction","postfix","clear","wrapLoading","selectData","warn","selSuccess","selectSuccess","selOptionalSuccess","selectOptionalSuccess","selError","selectOptionalError","selLoading","selectIsLoading","actionObject","caller","flatMap","isLoading","hasError","hasSuccess","_success","isEmpty","isSuccess","isError","hasLoaded","shouldLoad","selectIsSuccess","selectIsError","selectHasLoaded","selectIsEmpty","generateMockActions","dispatcher","Actions","verifyActionSuccess","effect","expect","toBeDefined","toStrictEqual","verifyActionError","rooms","loadRoomsWithQuery","selectRoomResultsSuccess","LocalStorageWrapper","prefix","StorageModule","AcaDatePickerComponent","klass","show_last_selection","min_offset","max_offset","date_list","month_name","days_of_week","day_format","month_format","generateMonth","generateDaysOfTheWeek","updateOptions","counters","difference","today","end_","non_month","_change_timer","new_offset","updateDate","changeMonth","AlertMode","AlertBannerDisplay","AlertBannerComponent","mode","Warning","showClose","V1","iconPath","materialColor","closeIcon","_onModeChange","Coachmark","BlueCoachmark","AutoCompleteChipSelectItemComponent","optionSelected","feedbackOutput","chipsCleared","onClickConfirm","selectOnlyOneGroup","localFilter","selectOnlyOneGroupChange","separatorKeysCodes","ENTER","COMMA","filterFormControl","focused","mobileFullScreen","autocompleteOptions","filteredAutocompleteOptions","chipOptions","enableCTAs","hasChips","scrollEvent","panelOpen","onFocus","blur","valueAccessor","color","enabled","selectedGroupHeader","getFilteredAutocompleteOptions","groupHeaders","g","searchString","exactMatches","moreOptions","joinedOptions","groupIds","parents","jo","matInput","feedbackInput","useCTAs","focusIn","fromPanel","componentInput","loseFocus","isDisabled","spl","removeEventListener","dirty","touched","keyedInput","onPanelFocusChange","selectOption","encapsulation","ViewEncapsulation","Self","Optional","GroupHeaderPipe","hasHeader","displayAsHeader","AutoCompleteSelectOptionComponent","filteredOptionsChange","inputTextChange","emptyBoxEvent","_options","updateFilteredOptions","selectedValue","resetInput","filteredOptions","startWith","_filter","filterValue","filterValues","matchesAll","onChangeInput","BaseTemplateComponent","vcRef","isRendered","attemptViewEmbed","createEmbeddedView","TemplateRef","CngSelectOptionsComponent","CngSelectComponent","isClosed","defaultSelected","onChangeCallback","DropdownTriggerForDirective","overlay","elementRef","viewContainerRef","renderer","isDropdownOpen","dropdownClosingActionsSub","EMPTY","isPanelOpened","destroyDropdown","openDropdown","ddWidth","dropdownPanel","offsetWidth","overlayRef","create","hasBackdrop","scrollStrategy","scrollStrategies","positionStrategy","flexibleConnectedTo","withPositions","originX","originY","overlayX","overlayY","offsetY","templatePortal","TemplatePortal","templateRef","attach","dropdownClosingActions","backdropClick$","backdropClick","detachment$","detachments","dropdownClosed","merge","detach","dispose","CollapseHeaderComponent","isExpanded","ConflictAlertModalComponent","dialogRef","dialogData","callback","dateIsToday","copy","DateTzCalendarWidgetComponent","className","selectedDateTz","_today","registerOnChange","registerOnTouched","startOfMonthDateTz","DateTzDatePickerComponent","icon_only","onSelect","can_pick_today","selectedDateTzValue","resetToLastSelection","_acaDatePicker","initialDateSelectionTz","writeValue","newValueTz","newDateTz","onDatePickerClose","DateTzDurationFieldComponent","defaultDurationGroups","DEFAULT_DURATION","currentStartDateTz","nearestStep","placeHolderOption","selectedOption","generateDurationOptionsFromGroups","extended","dopt","DateTzTimeFieldComponent","noPastTimes","show_current","startFromDateTz","selectedTimeString","generateAvailableTimesTz","generateOptionForDateTz","os","timeOptions","displayString","newTimeTz","setSelectedValues","ErrorMessageComponent","CalendarIconComponent","ChevronIconComponent","CloseIconComponent","InformationalImageComponent","LabelComponent","LegendDropdownComponent","isOpen","placeholderOpen","placeholder","MckDatePickerComponent","dateValue","initialDateSelection","goToToday","secondarySubmit","primarySubmit","ModalButtonRowComponent","primaryDisabled","disableFixed","secondaryDisabled","smallButtons","ModalComponent","shouldClose","OverrideChangesModalComponent","FilterPipe","searchText","objectKey","splitKeys","it","included","SecurityContext","SanitizePipe","sanitizer","sanitize","RESOURCE_URL","URL","SCRIPT","STYLE","HTML","RadioSelectComponent","RecurringBookingForm","recurrence_types","PATTERN","DATE","recurrencePeriod","current_type","pattern_form","recurrencePatternFormControl","RecurrencePatternForm","onChangeType","RecurrenceDateForm","selected_dates","setPickerToGivenDate","start_date","formDateTz","is_selected","setDateTzForm","dateTsValue","addDate","fromStartTz","untilTz","repeat_period_options","validateRecurrenceInterval","repeat_every_options","recurrenceIntervalFormControl","fromEndTz","setEndDateFromStartDate","recurrenceDateStartTzFormControl","recurrencePeriodFormControl","generateMaxIntervals","recurrenceDaysFormControl","current_days","generateOcurrenceList","recurrenceEndFormControl","end_date","updateActiveWeekday","updateValidators","date_diff","periodToDurationType","first_date","recurr_days","daysInMonth","_week_days","new_day","current_index","setRepeatEvery","setRepeatPeriod","SelectOptionComponent","ignoreDisabled","noEntriesFoundLabel","SelectComponent","searchEnabled","splitDisplay","showDivider","SelectedChipCountComponent","SpacerMode","SpacerComponent","Horizontal","SwitchGroupComponent","optionChecked","closestTimeSlot","buildingDate","newTime","ToggleComponent","selectedChange","MatIconModule","MatExpansionModule","OverlayModule","NgxMatSelectSearchModule","NgxSkeletonLoaderModule","ALL_DAY_BOOKING_VALUE","showPast","inputDate","allDayOption","oneWeekOption","loadUser","selectUserState","selectHasUserData","UserEffects","userService","UserModule","userReducer","initialUserState","webpackEmptyAsyncContext","req","module","routes","component","ShellWrapperComponent","children","loadChildren","DayViewModule","WeekViewModule","CateringModule","VisitorsModule","ReportsModule","RoomAdminModule","redirectTo","AppRoutingModule","RouterModule","forRoot","useHash","AppComponent","_uploads","_md5_workers","timezoneString","initUploads","autoStart","UploadManager","addProvider","Amazon","localStorageSyncReducer","reducer","localStorageSync","rehydrate","metaReducers","AppModule","app_loaded","MAT_LABEL_GLOBAL_OPTIONS","DEFAULT_SETTINGS","BrowserModule","BrowserAnimationsModule","HttpClientModule","ComposerModule","CalendarModule","SharedContentModule","bootstrap","BookingModalComponent","iscloning","getModalTitle","flow_step","only_catering","loadFormData","modalTitle","toNextFlowStep","toPreviousFlowStep","resetForm","openRecurrenceConflictsModal","openEquipmentDetailsModal","confirmBooking","openCateringDetailsModal","overrideChanges","markAsDirty","is_recurr_series_edit","available_fields","addControl","is_cloning_or_edit","recurrenEndFromOcurrences","edit_recurrence","markAsTouched","equipment_ref","catering_ref","clearRecurrenceValidators","formValues","sanitizeBookingFromCloning","dialog_ref","emitEvent","acc","recurr_ref","BookingCateringComponent","active_order","an_order","CateringMenuCategoryComponent","BookingCateringOrderDetailsComponent","_menu","category_list","available_times","matched_items","initForm","_input_el","show_search","loadMenu","generateStartAndEndTimes","logDateTz","space_email","building_time","cat_start_time","cat_end_time","has_available_items","out_of_hours","form_controls","confirmOrder","CateringOrderListItemComponent","edit","BookingCateringOrderListComponent","previous","BookingSpaceFiltersComponent","initBuildings","locationsChange","building_list","now_","is_today","BookingFindSpaceComponent","_booking_state","selectedSpace","oldSpace","handleEditConflicts","occurrences_org","booking_org","ocurr","to_hours","to_minutes","new_conflicts","spaceConflicts","isCloning","original_space","sortByRecurrenceAvailability","booking_space_list","a_availability","b_availability","toggle","BookingSpaceItemComponent","availableOccurrences","BookingSpaceFlowFormComponent","can_return","container","scrollIntoView","inline","DeleteConfirmModalComponent","ScrollingModule","MeetingDetailsModalComponent","PrivateDetailsModalComponent","MeetingDetailsDisplayComponent","MeetingRecurringDetailsDisplayComponent","MeetingDetailsRequirementsComponent","MeetingCateringDetailsComponent","MeetingPrivateDetailsComponent","DayViewApprovalsComponent","_bookings_service","inputText","incommingRequests","selectedSort","updatedRequest","sortOrderByOptions","expiredBkngs","pendingBkngs","bkng","timeBasedStatusLabel","declineExpiredBookings","cloneDeep","searchRequest","sortingValue","date_string","street_and_city","att","weekdayLong","weekdayShort","applyOrderBy","declineMultiple","resArray","STATES","DayViewApprovalsEventComponent","_booking_state_sevice","acting","showCateringNote","showEquipmentNote","cateringNote","equipmentNote","cateringOrderItems","updateData","createdDate","createdTime","creationDate","officeAddress","length_string","acceptedBooking","view","DayViewComponent","_route","active_level","legend","legend_list","legend_keys","banner_mode","showBanner","undo_banner_mode","paramMap","has","has_access","updateLevel","numeric","ignorePunctuation","undo_action","_undo_timer","attentToDelete","configureIfLinksFromEmail","bookingId","snapshot","dispatch","levelId","updateDateTz","replaceUrl","checked","ROUTES","forChild","DayViewTimelineComponent","DayViewSpaceComponent","DayViewSpaceEventComponent","calculatePosition","overlap","storeOrder","shown_date","from_previous_day","toFixed","overflow_top","overflow_bottom","time_period","cdr","inView","dragging","event_list","overlap_details","position_list","filterEvents","overflow_only","checkInView","last_update","calculateOverlaps","override_state","collisions","cmp","cmp_start","cmp_end","in_view","offsetLeft","box","getBoundingClientRect","delta","pointerPosition","scroll_top","top_minutes","previousContainer","new_start","handleDropError","room_list","room_count","new_booking","moveBooking","confirm_msg","drop","UPDATE_INTERVAL","time_blocks","generateTimeBlocks","scroll_left","scroll_offset","filtered_spaces","loading_space","show_holding_bay","space_zones","modalInitialized","scroll_area","initSpaces","updateTime","addClass","virtualScroll","space_type","stopPolling","queryParamMap","view_id","spaceJson","active_hour","scroll_box","date_percent","scrollWidth","updateScroll","is_dragging","bottom","right","scrollView","cancelScroll","CdkVirtualScrollViewport","clearSelected","updateBooking","_updateOrders","closeAll","ord","editMeetingCatering","edited","setDetails","_on_error","setLoading","deleteMeeting","booking_data","book","_booking","available_durations","old_notes","openPrivateDetailsModal","confirmDelete","_specific_dates","expired_ocurrences","recurrence_startTz","ocurrence","specific_dates","duplicate","_recurrence_startTz","_recurrence_period","_recurrence_interval","_occurrence_details","val","_master_booking","editSeries","cloneSeries","cancelSeries","bookingChange","standalone","WeekViewDayDisplayComponent","WeekViewItemComponent","WeekViewTimelineComponent","dateListTz","generateDatesTz","weekends","WeekViewComponent","orderDetailsExpanded","CateringComponent","cateringStorage","order_type","orderDetails","page","relativeTo","CateringStorage","CateringOrdersComponent","CateringMenuComponent","CateringMenuItemListComponent","CateringCategoryModalComponent","CateringGroupModalComponent","CateringItemModalComponent","CateringOrdersItemComponent","OrderDetailsModalComponent","OrderDetailsItemsComponent","OrderBookingDetailsComponent","OrderDetailsNotesComponent","CateringMenuOrderComponent","removeValue","orderDetailsKey","openGroupModal","parent_id","parent","_menu_items","_menu_categories","updateItemList","old_item","itm","openItemModal","deleteItem","catering_menu","filtered_menu","removeFromMenu","loadCateringMenu","openCategoryModal","depth","item_details","showIndividualItem","statuses","colour","active_status","updateItemDetails","show_items","updated_booking","sub_item","sub_sub_item","viewOrderDetails","expandMore","filtered_orders","display_orders","deliver_at_time","_upload_manager","fileReader","uploading","arrayBuffer","blob","blobUtil","arrayBufferToBlob","upload","file_name","uploads","complete","access_url","readAsArrayBuffer","storeBooking","editing","new_note","order_id","pending_booking","addNote","AccessDenied","SidebarComponent","TopbarHeaderComponent","show_add_item","show_events","dateChangeTz","timezone_value","event_map","dateInputTz","changeDate","noOfCount","applyDatePickerValue","LoginComponent","username","password","logo","login","setErrors","ReportDisplayComponent","_reports","multipleLocations","locationChanged","report","report_data","downloadCSV","checkDates","generateReport","downloadReport","ReportTableComponent","hide_fields","ReportsComponent","reports","multi_locations","active_report","BulkQrOverlayComponent","selectItemChange","selectAllChange","downloadQrCodeRequested","cancelClick","qrCodeUrlsChange","qrCodeUrls","qrTabClick","itemsCheckboxes","newArr","isLevel","checkbox","selectAll","roomname","checkedRoomObj","checkedLevelObj","checkedFlag","assign","allLevels","onSubmit","onSelectAllChange","onCancel","photoArray","photoUploadArray","ManagePhotosComponent","resizeService","readLocalPicService","httpClient","imageInitial","imageToModify","uploadError","uploadingStatus","resizedFiles","requiredFileType","RequiredFileType","photos","indexToReplace","canvas","context","getContext","ext","unusedIdx","readFileInput","base64Img","that","resizeImage","RoomPhotoDiamension","outputFormat","imgResized","createImage","clearRect","drawImage","dataURL","toDataURL","uploadProgress","obs","img","FormData","b64toFile","tap","updateProgressMeter","suffixes","failedNo","photo","RoomAdminComponent","RoomDetailsWrapperComponent","RoomAdminRoutingModule","cdref","roomAdminService","detailsViewIndex","rowInfo","enableOverlay","updatePayload","roomDataSource","roomnum","roomtype","roomobject","newUrls","doc","isRoom","qrcode","imageData","drawCanvas","addImage","addPage","ResizeService","ReadLocalPicService","RoomAdminService","MatTableModule","MatPaginatorModule","MatSortModule","QRCodeModule","RoomsTableComponent","RoomDetailsComponent","FileDragNDropDirective","cd","getCurrentNavigation","getToRoomList","_snackBar","givenRoomType","givenRoomSubType","uploadedPhotos","parentFun","disableButtons","windowLocation","roomImages","history","pushState","cityname","rowInfoData","internalSubSet","externalSubset","roomSubsetOptions","internal","roomSubType","givenCateringAvailability","setAllDropdowns","reactiveForm","maxLength","roomnumber","roomvisibility","isFeatureChecked","conference_phone","wireless_content_sharing","flipchart","glassboard","whiteboard","boardroom","cocktail","theatre","workshop","u_shape","miscellaneous","roomImagesFileSlug","imgArr","formValue","roomObject","allowed_keys","getExtraFeatures","excludeFromExtraFeatures","isEqAndDetail","updateAllRooms","markAsPristine","markForCheck","roomTypeDD","ddBoxClass","roomTypeOptions","roomTypeChanged","bind","roomSubsetDD","roomTypeSubsetChanged","roomVisibilityDD","roomVisibilityOptions","roomVisibilityChanged","canteringAvailabilityDD","canteringAvailabilityOptions","roomCateringChanged","subset","visibility","isCatering","arcY","arc_X_Center","otrRadius","whtRadius","innrRadius","ctx","strokeStyle","moveTo","lineTo","stroke","font","textAlign","fillText","beginPath","arc","PI","fillStyle","fillRect","roomid","win","write","downloadQRPdf","openManagePhotosModal","EXAMPLE_DATA","RoomsTableDataSource","datatwo","dataMutations","paginator","sortChange","getPagedData","getSortedData","startIndex","pageIndex","pageSize","isAsc","compare","DataSource","onDetailsClick","rowClicked","displayedColumns","dataSource","formattedInputValue","inputValue","firstChange","table","firstPage","navigationExtras","skipLocationChange","MatPaginator","MatSort","MatTable","errorMessage","NOT_FOUND_ERR","SECURITY_ERR","ABORT_ERR","NOT_READABLE_ERR","ENCODING_ERR","NO_MODIFICATION_ALLOWED_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","QUOTA_EXCEEDED_ERR","TYPE_MISMATCH_ERR","PATH_EXISTS_ERR","inputFile","File","FileList","Blob","onabort","eventErrorDecoder","onerror","readAsDataURL","dataURI","byteString","atob","mimeString","ab","ArrayBuffer","ia","Uint8Array","crossOrigin","cnv","tmpCanvas","cnx","isCanvasSupported","sizeScale","resizeImageWidthHeight","resizeImageBySize","mainCanvas","pixelStepWidth","pixelStepHeight","newWidth","newHeight","resizeCanvas","targetSize","tmpResult","sizeOfTheImage","calulateImageSize","divideStrategy","iteratorLimit","newImageSize","sizeOfTheImageTmp","imgString","isForLevels","filesChangeEmiter","borderStyle","borderColor","borderRadius","dataTransfer","HostBinding","COMPONENTS","DIRECTIVES","CDK_MODULES","DragDropModule","CdkTableModule","APipesModule","ACustomEventsModule","loading_state","mod","EventFormComponent","visitorFG","createVisitor","getVisitors","removeAt","VisitorFormComponent","personChange","VisitorsFormModalComponent","fb","attendeesStatus","visitors","attendee","VisitorBookingItemComponent","matched_attendees","checked_in_users","host_email","response_type","show_attendees","is_match","checkedInStatus","subject","VisitorTimelineComponent","filtered_bookings","updateEvents","show_all","unsorted_bookings","VisitorComponent","_element","removeClass","VisitorsComponent","hmr","general","copyright","booking_types","show_fields","html_body","multiple_spaces","desk_start","day_view","dragdrop","enableProdMode","platformBrowser","bootstrapModule"],"mappings":"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AA;AAAA;AAAA;AAEpE;AACC;AACC;AACC;AAAsB;AAAS;AAC/B;AAGC;AACC;AACC;AASD;AACD;AACF;AACA;AACC;AACC;AACC;AAA4E;AAAI;AAChF;AACD;AACA;AACC;AAA8E;AAAK;AACnF;AACD;AACA;AACC;AAAwF;AAAQ;AAChG;AACD;AACD;AAEA;AACC;AACC;AAAmB;AAAS;AAC5B;AAED;AACA;AACC;AAAmB;AAAW;AAC9B;AAED;AACA;AACC;AAAsB;AAAQ;AAC9B;AAEA;AAYD;AACD;AACD;AAGA;AACC;AACC;AACC;AAAmB;AAAe;AAClC;AAED;AACA;AACC;AAAmB;AAAqB;AACxC;AAED;AACD;AAEA;AACC;AACC;AACA;AAA0C;AAAmC;AAE9E;AACA;AACC;AACA;AAA8C;AAAoC;AACnF;AACD;AAED;AAEA;AACC;AACC;AACC;AACC;AAAkB;AAA0B;AAC7C;AACA;AAA6B;AAAc;AAC3C;AACC;AAAG;AAAqB;AACxB;AACD;AACA;AACC;AAAG;AAAgB;AACnB;AACD;AACA;AACC;AAAG;AAAwB;AAC3B;AACD;AACA;AACC;AAAG;AAAS;AACZ;AACD;AACA;AACC;AAAG;AAAU;AACb;AACD;AACA;AACC;AAAG;AAAU;AACb;AACD;AACA;AAA6B;AAAW;AACxC;AACC;AAAG;AAAqC;AACxC;AACD;AACA;AACC;AAAG;AAAoB;AACvB;AACD;AACA;AACC;AAAG;AAAmB;AACtB;AACD;AACA;AACC;AAAG;AAAkB;AACrB;AACD;AACA;AACC;AAAG;AAAmB;AACtB;AACD;AACA;AACC;AAAG;AAAkB;AACrB;AACD;AACA;AACC;AAAG;AAAa;AAChB;AACD;AACD;AACD;AACD;AAGD;AACD;AAEA;AAA6I;AAAa;AAC1J;AAA2I;AAAA;AAAA;AAAA;AAAA;AAAsB;AAAgB;AAEjL;AACA;AACD;;;;;AA5K2B;AAOtB;AAAA;AAGQ;AAAA;AACN;AAAA;AAeiB;AAAA;AAIC;AAAA;AAIK;AAAA;AAQZ;AAAA;AAKA;AAAA;AAMX;AAAA;AACI;AAAA;AAqBO;AAAA;AAKA;AAAA;AAuFgD;AAA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","file":"main-es5.js","sourcesContent":["export * from './lib/animations.module';\nexport * from './lib/angular-animations'\n","import { trigger, transition, style, animate, state } from '@angular/animations';\n\nexport const ANIMATION_SHOW_ENTER_LEAVE = trigger('show', [\n    transition(':enter', [\n        style({ opacity: 0, height: 0 }),\n        animate(300, style({ opacity: 1, height: '*' }))\n    ]),\n    transition(':leave', [\n        style({ opacity: 1, height: '*' }),\n        animate(300, style({ opacity: 0, height: 0 }))\n    ])\n]);\n\nexport const ANIMATION_SHOW_CONTRACT_EXPAND = trigger('show', [\n    state('show', style({ opacity: 1, height: '*' })),\n    state('hide', style({ opacity: 0, height: 0 })),\n    transition('show <=> hide', animate('200ms ease-in'))\n]);\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n  imports: [CommonModule],\n})\nexport class AnimationsModule {}\n","export * from './lib/base.module';\nexport * from './lib/types.utilities';\nexport * from './lib/general.utilities';\nexport * from './lib/base.class';\nexport * from './lib/base.directive';\nexport * from './lib/date.utils'\nexport * from './lib/date.spec-helpers'\nexport * from './lib/replace.pipe'\nexport * from './lib/cdk-drop-list-scroll-container.directive'\nexport * from './lib/image.directive';\n","import { Subscription, BehaviorSubject } from \"rxjs\";\n\nexport class BaseClass {\n    /** Store for named timers */\n    protected _timers: { [name: string]: number } = {};\n    /** Store for named intervals */\n    protected _intervals: { [name: string]: number } = {};\n    /** Store for named subscription unsub callbacks */\n    protected _subscriptions: { [name: string]: (Subscription | (() => void)) } = {};\n    /** Subject which stores the initialised state of the object */\n    protected readonly _initialised = new BehaviorSubject<boolean>(false);\n\n    /** Observable of the initialised state of the object */\n    public get initialised(): BehaviorSubject<boolean> {\n        return this._initialised;\n    }\n    /** Whether the object has been initialised */\n    public get is_initialised(): boolean {\n        return this._initialised.getValue();\n    }\n\n    protected destroy() {\n        for (const key in this._timers) {\n            if (this._timers.hasOwnProperty(key)) {\n                this.clearTimeout(key);\n            }\n        }\n        for (const key in this._intervals) {\n            if (this._intervals.hasOwnProperty(key)) {\n                this.clearInterval(key);\n            }\n        }\n        for (const key in this._subscriptions) {\n            if (this._subscriptions.hasOwnProperty(key)) {\n                this.unsub(key);\n            }\n        }\n    }\n\n    /**\n     * Creates a named timer\n     * @param name Name of the timer\n     * @param fn Callback function for the timer\n     * @param delay Callback delay\n     */\n    protected timeout(name: string, fn: () => void, delay: number = 300) {\n        if (name && fn && fn instanceof Function) {\n            this.clearTimeout(name);\n            this._timers[name] = <any>setTimeout(() => {\n                fn();\n                this._timers[name] = null;\n            }, delay);\n        } else {\n            throw new Error(\n                name ? 'Cannot create named timeout without a name' : 'Cannot create a timeout without a callback'\n            );\n        }\n    }\n\n    /**\n     * Clears the named timer\n     * @param name Timer name\n     */\n    protected clearTimeout(name: string) {\n        if (this._timers[name]) {\n            clearTimeout(this._timers[name]);\n            this._timers[name] = null;\n        }\n    }\n\n    /**\n     * Creates a named interval\n     * @param name Name of the interval\n     * @param fn Callback function for the interval\n     * @param delay Callback delay\n     */\n    protected interval(name: string, fn: () => void, delay: number = 300) {\n        if (name && fn && fn instanceof Function) {\n            this.clearInterval(name);\n            this._intervals[name] = <any>setInterval(() => fn(), delay);\n        } else {\n            throw new Error(\n                name ? 'Cannot create named interval without a name' : 'Cannot create a interval without a callback'\n            );\n        }\n    }\n\n    /**\n     * Clears the named interval\n     * @param name Timer name\n     */\n    protected clearInterval(name: string) {\n        if (this._intervals[name]) {\n            clearInterval(this._intervals[name]);\n            this._intervals[name] = null;\n        }\n    }\n\n    /**\n     * Store named subscription\n     * @param name Name of the subscription\n     * @param unsub Unsubscribe callback or Subscription object\n     */\n    protected subscription(name: string, unsub: Subscription | (() => void)) {\n        this.unsub(name);\n        this._subscriptions[name] = unsub\n    }\n\n    /**\n     * Call unsubscribe callback with the given name\n     * @param name\n     */\n    protected unsub(name: string) {\n        if (this._subscriptions && this._subscriptions[name]) {\n            this._subscriptions[name] instanceof Subscription\n                ? (this._subscriptions[name] as Subscription).unsubscribe()\n                : (this._subscriptions[name] as any)();\n            this._subscriptions[name] = null;\n        }\n    }\n}\n","\nimport { Directive, OnDestroy } from '@angular/core';\nimport { BaseClass } from './base.class';\n\n@Directive({\n    selector: 'a-very-basic-component-base-that-should-not-be-used'\n})\nexport class BaseDirective extends BaseClass implements OnDestroy {\n    public ngOnDestroy(): void {\n        this.destroy();\n    }\n}","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NumbersOnlyDirective } from './numbers-only.directive';\n\n@NgModule({\n    imports: [CommonModule,],\n    declarations: [\n        NumbersOnlyDirective\n    ],\n    exports: [\n        NumbersOnlyDirective\n    ]\n})\nexport class BaseModule {\n}\n","import {\n    Directive,\n    Input,\n    Renderer2,\n    SimpleChanges,\n    OnChanges,\n    ContentChildren,\n    QueryList,\n    AfterContentInit\n} from '@angular/core';\nimport { CdkDropList, CdkDrag } from '@angular/cdk/drag-drop';\nimport { BaseDirective } from './base.directive';\n\nexport enum ScrollDirection {\n    NONE,\n    X,\n    Y,\n    BOTH\n}\n\n@Directive({\n    selector: '[cdkDropList][scrollContainer]'\n})\nexport class CdkDropListScrollContainer extends BaseDirective\n    implements OnChanges, AfterContentInit {\n    /** Direction of scroll to determine updating the position of the drop list */\n    @Input() direction: ScrollDirection = ScrollDirection.X;\n    /** Name of the scroll container for the list */\n    @Input() scrollContainer: string;\n    /** Scroll container element */\n    public element: HTMLElement;\n    /** Last scroll position */\n    public last_scroll: { x: number; y: number } = { x: 0, y: 0 };\n\n    /** Draggable children elements */\n    @ContentChildren(CdkDrag) private items: QueryList<CdkDrag>;\n\n    constructor(private _cdkDropList: CdkDropList, private _renderer: Renderer2) {\n        super();\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.scrollContainer && this.scrollContainer) {\n            this.element = this._cdkDropList.element.nativeElement.closest(\n                this.scrollContainer\n            ) as HTMLElement;\n        }\n    }\n\n    public ngAfterContentInit(): void {\n        this.subscription(\n            'drag_items',\n            this.items.changes.subscribe((items: QueryList<CdkDrag>) => {\n                const list = items.toArray();\n                list.forEach((i, index) => {\n                    this.subscription(\n                        `list-item-${index}`,\n                        this._renderer.listen(i.element.nativeElement, 'mousedown', () => {\n                            this.subscription(\n                                'item-dragged',\n                                this._renderer.listen('window', 'mouseup', () => this.onDrop())\n                            );\n                            this.onDrag();\n                        })\n                    );\n                    this.subscription(\n                        `list-item-touch-${index}`,\n                        this._renderer.listen(i.element.nativeElement, 'touchstart', () => {\n                            this.subscription(\n                                'item-dragged',\n                                this._renderer.listen('window', 'touchend', () => this.onDrop())\n                            );\n                            this.onDrag();\n                        })\n                    );\n                });\n            })\n        );\n    }\n\n    /** Start listing for scroll events on the container */\n    public onDrag() {\n        if (this.element) {\n            this.subscription(\n                'scroll',\n                this._renderer.listen(this.element, 'scroll', () => this.updateListPosition())\n            );\n        }\n    }\n\n    /** Stop listening for scroll events on the container */\n    public onDrop() {\n        this.unsub('scroll');\n    }\n\n    /**\n     * Forcefully update the position data of the drop list\n     */\n    private updateListPosition() {\n        this.timeout(\n            'update_positions',\n            () => {\n                const scroll = { x: this.element.scrollLeft, y: this.element.scrollTop };\n                if (\n                    ((this.direction === ScrollDirection.BOTH ||\n                        this.direction === ScrollDirection.Y) &&\n                        scroll.y !== this.last_scroll.y) ||\n                    ((this.direction === ScrollDirection.BOTH ||\n                        this.direction === ScrollDirection.X) &&\n                        scroll.x !== this.last_scroll.x)\n                ) {\n                    (this._cdkDropList._dropListRef as any)._cacheOwnPosition();\n                    (this._cdkDropList._dropListRef as any)._siblings.forEach(i =>\n                        i.isReceiving() ? i._cacheOwnPosition() : null\n                    );\n                }\n                this.last_scroll = scroll;\n            },\n            50\n        );\n    }\n}\n","import MockDate from 'mockdate';\n\n/**\n * August 13, 2020 at 7:22:12 UTC\n */\nconst initialTime = 1597346532 * 1000;\n\nexport const mockDate = (timeOverride = initialTime) => MockDate.set(new Date(timeOverride));\n\nexport const resetDate = () => MockDate.reset();\n","import { DateNow, DateTZ } from '@mckinsey-converge/date-tz'\nimport { DateTime } from 'luxon';\nimport * as dayjs from 'dayjs';\nimport {\n    dayJsHoursMinutes,\n    dayJsTimeFormatString,\n} from './general.utilities';\n\n/**\n * Allows you to split up durations into a group.\n */\nexport interface DurationGroup {\n    /**\n     * Step amount to generate between start and max.\n     */\n    step: number;\n    /**\n     * Where to start in minutes.\n     */\n    start: number;\n    /**\n     * Where to end in minutes.\n     */\n    max: number;\n}\n\n/**\n * Find the multiple of `stepMinute` which is closest to the 'minutes' property of the given date.\n * @param date - Any Lexon date.\n * @param stepMinute - The number of minutes between one timeslot and the next. Integer value\n * 1 to 59, inclusive.\n */\n// R--- depreciate this one\nexport const closestToTimeSlot = (date: DateTime, stepMinute: number, start: number = 0) : DateTime => {\n    return date.set({ millisecond: 0, second: 0, minute: Math.ceil(date.minute / stepMinute) * stepMinute })\n        .plus({ minutes: start % 60 }) // apply offset as well if it starts at 15.\n};\n\nexport const closestToTimeSlotTz = (dateTz: DateTZ, stepMinute: number, start: number = 0) : DateTZ => {\n    return dateTz.setValue({ millisecond: 0, second: 0, minute: Math.ceil(dateTz.minutes / stepMinute) * stepMinute })\n        .addValue({ minutes: start % 60 }) // apply offset as well if it starts at 15.\n};\n\n/**\n * Convert duration to human readable string\n * @param duration Duration in minutes\n * @param short Whether to use short form of duration words e.g. hours as hrs, or minutes as mins\n */\nexport function durationHumanized(duration: number, short: boolean = false): string {\n    if (!duration || duration < 0) {\n        return '';\n    }\n    const h = Math.floor(duration / 60);\n    let d = `${h >= 1 ? h + (short ? ' hr' : ' hour' + (h === 1 ? '' : 's')) : ''}`;\n    if (duration % 60 !== 0) {\n        if (d) {\n            d += short ? ' ' : ', ';\n        }\n        const m = duration % 60;\n        d += `${m >= 1 ? m + (short ? ' min' : ' minute' + (m === 1 ? '' : 's')) : ''}`;\n    }\n    return d;\n}\n\nexport const weekDayMonthYearFormat = (date: DateTZ): string => date.formatDate('ccc dd MMM yyyy');\n\n/**\n * Tries to extract best-fit input\n * @return undefined if not valid. otherwise if good\n */\nexport const extractDateFromInput = (input: string,\n    checkHour,\n    startDate: dayjs.Dayjs): dayjs.Dayjs | undefined => {\n    // check if input has am/pm or normal 24 hour time.\n    // let date = dayjs(input, 'HH:mm');\n    // let date = dayjs(input, 'h:mma');\n    let date = dayjs(input, dayJsTimeFormatString());\n    if (!date.isValid()) {\n        // patch if time is in format xx:x to assume you meant xx:x0\n        let cleanedInput = input;\n        const times = input.split(':');\n        if(!input){\n            return undefined\n        }\n        if (times.length === 2) {\n            if (times[1].length === 1) {\n                cleanedInput = `${times[0]}:${times[1]}0`;\n            }\n        }\n        // may be other input, lets try next value (without am/pm)\n        date = dayjs(cleanedInput, dayJsHoursMinutes());\n        // might be just purely an hour\n        if (!date.isValid() && checkHour) {\n            date = dayjs(input, 'H');\n        }\n    }\n    // We expect input times to be in the future. If now is in the afternoon, this\n    // simple block will ensure the returned date is also in the afternoon.\n    //\n    // NB: dayjs parses times as morning by default.\n    if (date.isValid()) {\n        // Move to the selected start date\n        date = date.month(startDate.month()).date(startDate.date()).year(startDate.year());\n        if (startDate.hour() > date.hour() && date.date() === startDate.date()) {\n            date = date.set('hour', date.hour() + 12);\n        }\n    }\n\n    return date.isValid() ? date : undefined;\n};\n\n\n/**\n * 1. Calculates the date from input via {@link extractDateFromInput}.\n * 2. Finds the nearest time slot that it can be via {@link closestToTimeSlot}.\n * 3. Then returns the time-format string the input expects so autocomplete can suggest\n *    closest match.\n * @param step The step between time slots.\n * @param input The input text.\n */\nexport const nearestStepToInput = (\n    step: number,\n    input: string,\n    currentStartDate: number,\n    start: number = 0\n): string => {\n    let date = extractDateFromInput(input, false, dayjs(currentStartDate));\n    if (date) {\n        const luxonDate = DateTime.fromMillis(date.valueOf());\n        const closestDate = closestToTimeSlot(luxonDate, step, start);\n        return closestDate.toFormat(dayJsHoursMinutes());\n    } else {\n        return input;\n    }\n};\n/**\n * Similiar to {@link nearestStepToInput} instead:\n * 1. Calculates the date from input via {@link extractDateFromInput}.\n * 2. Finds which duration group is closest to the currentStartDate. If not found\n *    return vanilla text.\n * 3. Finds the nearest time slot that it can be via {@link closestToTimeSlot}.\n * 4. Then returns the time-format string the input expects so autocomplete can suggest\n *    closest match.\n */\nexport const nearestDurationToInput = (durationGroups: DurationGroup[],\n    currentStartDate: number,\n    value: string): string => {\n\n    let date = extractDateFromInput(value, false, dayjs(currentStartDate));\n\n    if (!date) {\n        // Check if the input is a duration \n        const duration = parseInt(value);\n        if (typeof (duration) === 'number' && value.indexOf(':') === -1 && duration > 12) {\n            date = dayjs(currentStartDate).add(duration, 'm');\n        }\n    }\n\n    if (date) {\n        const minutes = date.diff(currentStartDate, 'minute');\n        const closestDurationGroup = durationGroups.find(d => {\n            return (minutes <= d.max);\n        });\n        if (closestDurationGroup) {\n            const offset = [closestDurationGroup].reduce((previousValue, currentValue) => {\n                return previousValue + currentValue.start;\n            }, 0);\n            const luxonDate = DateTime.fromMillis(date.valueOf());\n            const closestDate = closestToTimeSlot(luxonDate, closestDurationGroup.step, 0);\n            return closestDate.toFormat(dayJsHoursMinutes());\n        }\n    }\n\n    return value;\n};\n\nexport const resetSecondsOnTimestamp = (timestamp: number) => {\n    return DateTime.fromMillis(timestamp).set({ second: 0, millisecond: 0 }).toMillis();\n}\n\nexport const formatDateWithSuffix = (date: string): string => {\n    const dateObj = new Date(date);\n    const day = dateObj.getDate();\n    const month = dateObj.toLocaleString(\"default\", { month: \"short\" });\n    const year = dateObj.getFullYear();\n    return `${day}${nthNumber(day)} ${month} ${year}`; //this.event.date_string;\n}\n\nconst nthNumber = (number) => {\n    return number > 0\n        ? [\"th\", \"st\", \"nd\", \"rd\"][\n                (number > 3 && number < 21) || number % 10 > 3 ? 0 : number % 10\n            ]\n        : \"\";\n};\n\nexport const getListOfDateFormat = () => {\n    return [\t\n        'MMMM dd y', \t//March 07 2023\n        'MMM dd, y',\t//Mar 07 2023\n        'MMMM dd',\t\t//March 07\n        'MMM dd', \t\t//Mar 07\n        'MM dd', \t\t//03 07\n\n        'MM-dd-yy',\t\t//03-07-23\n        'MM-dd-yyyy',\t//03-07-2023\n        'MMMM-dd-yyyy', //March-07-2023\n        'MMMM-dd-yy',\t//March-07-23\n\n        'MMMM-dd',\t\t//March-07\n        'MMM-dd',\t\t//Mar-07\n        \n        'MMM-dd-y',\t\t//Mar-07-2023\n\n        'MM/dd',\t\t//03/07\n        'MM/dd/yy',\t\t//03/07/23\n        'MM/dd/yyyy',\t//03/07/2023\n        \n        'dd/MM',\t\t//07/03\n        'dd/MM/yy',\t\t//07/03/23\n        'dd/MM/yyyy',\t//07/03/2023\n        \n        'dd-MMMM',\t\t//07-March\n        'dd MMMM',\t\t//07 March\n        'dd-MMM',\t\t//07-Mar\n        'dd MMM',\t\t//07 Mar\n\n        'dd-MM-y',\t\t//07-03-23\n        'dd MMMM yy',\t//07 March 23\n        \n        'dd/MMM/y',\t    //07/Mar/2023\n        'dd/MMMM/y',    //07/March/2023\n        'dd/MMM/yy',    //07/Mar/23\n        'dd/MMMM/yy',   //07/March/23\n        \n\n        'dd-MMMM-yy',\t//07-March-23\n        'dd-MMM-yy',\t//07-Mar-23\n        'dd-MM-yy',\t\t//07-03-23\n        'MMMM-dd-yy',\t//March-07-23\n        'MMM-dd-yy',\t//Mar-07-23\n\n        'MMMM dd yy',\t//March 07 23\n        'MMM dd, yy',\t//Mar 07 23\n        'MM dd, yy',\t//03 07 23\n\n        'dd MMMM y',\t//07 March 2023\n        'dd MMM, y',\t//07 Mar 2023\n        'dd MM, yy',\t//07 03, 23\n        'dd-MMM-y',\t//07-Mar-2023\n\n        'h:mm a', // 3:30 pm\n        'h:mma' // 3:30 pm\n\n    ];\n}","import { HashMap, Point } from './types.utilities';\n\nimport * as dayjs from 'dayjs';\nimport * as utc from 'dayjs/plugin/utc';\nimport * as timezone from 'dayjs/plugin/timezone';\nimport * as isToday from 'dayjs/plugin/isToday';\nimport * as weekday from 'dayjs/plugin/weekday';\nimport * as customParseFormat from 'dayjs/plugin/customParseFormat';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n// TODO: this is not the best place to import this timezone addition\ndayjs.extend(utc);\ndayjs.extend(timezone);\ndayjs.extend(isToday);\ndayjs.extend(weekday);\ndayjs.extend(customParseFormat);\n\n/** Available console output streams. */\nexport type ConsoleStream = 'debug' | 'warn' | 'log' | 'error' | 'info';\n\n/**\n * Log data to the browser console\n * @param type Type of message\n * @param msg Message body\n * @param args array of argments to log to the console\n * @param stream Stream to emit the console on. 'debug', 'log', 'warn' or 'error'\n * @param force Whether to force message to be emitted when debug is disabled\n */\nexport function log(\n    type: string,\n    msg: string,\n    args?: any,\n    stream: ConsoleStream = 'debug',\n    force: boolean = false,\n    app_name: string = 'STAFF'\n) {\n    if ((window as any).debug || force) {\n        const colors: string[] = [\n            'color: #E91E63',\n            'color: #3F51B5',\n            'color: default',\n        ];\n        if (args) {\n            console[stream](\n                `%c[${app_name}]%c[${type}] %c${msg}`,\n                ...colors,\n                args\n            );\n        } else {\n            console[stream](`%c[${app_name}]%c[${type}] %c${msg}`, ...colors);\n        }\n    }\n}\n\n/**\n * Get item from the nested object\n * @param keys List of sub-keys to search for\n * @param map Object to search\n */\n export function getItemWithKeys(keys: string[], map: HashMap) {\n    const key = keys[0];\n    if (map && key in map) {\n        return keys.length > 1\n            ? getItemWithKeys(keys.slice(1), map[key] || {})\n            : map[key];\n    }\n    return null;\n}\n\n/* istanbul ignore next */\n/**\n * Checks whether the platform is a mobile device.\n */\nexport function isMobileDevice(): boolean {\n    const r = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;\n    return !!navigator.userAgent.match(r);\n}\n\n/* istanbul ignore next */\n/**\n * Checks whether the browser is Mobile Safari.\n */\nexport function isMobileSafari(): boolean {\n    const agent = navigator.userAgent;\n    return !!(\n        agent.match(/iPhone|iPad|iPod/) &&\n        agent.match(/AppleWebKit/) &&\n        !agent.match('CriOS')\n    );\n}\n\n/* istanbul ignore next */\n/**\n * Checks whether the browser is Android Chrome.\n */\nexport function isAndroidChrome(): boolean {\n    const agent = navigator.userAgent;\n    return !!(agent.match(/Android/) && agent.match(/Chrome/));\n}\n\n/**\n * Generate string representation of a number with zeros padding the length\n * @param value Number to pad with zeros\n * @param length Length of the resulting string\n */\nexport function padZero(value: number, length: number): string {\n    let str = value.toString();\n    while (str.length < length) {\n        str = '0' + str;\n    }\n    return str;\n}\n\n/**\n * Remove duplicates from the given array\n * @param array List of items to remove duplicates from\n * @param key Key on array objects to compare for uniqueness\n */\nexport function unique<T>(array: T[], key: keyof T | undefined = undefined) {\n    return array.filter(\n        (el, pos, arr) =>\n            el &&\n            arr.indexOf(\n                key\n                    ? arr.find((i) => i && i[key] === el[key])\n                    : arr.find((i) => i === el)\n            ) === pos\n    );\n}\n\n/**\n * Convert duration to human readable string\n * @param duration Duration in minutes\n * @param short Whether to use short form of duration words e.g. hours as h\n */\nexport function humaniseDuration(durationInput: number, size: string = 'long') {\n    const duration = Math.floor(durationInput);\n    if (!duration || duration < 0) {\n        return '';\n    }\n    let singular = false;\n    let format = { hours: ' hour', minutes: ' minute' };\n    switch (size) {\n        case 'medium':\n            format = { hours: 'hr', minutes: 'min' };\n            break;\n        case 'short':\n            format = { hours: 'h', minutes: 'm' };\n            singular = true;\n            break;\n    }\n    const h = Math.floor(duration / 60);\n    let d = `${\n        h >= 1\n            ? h +\n              (singular ? format.hours : format.hours + (h === 1 ? '' : 's'))\n            : ''\n    }`;\n    if (duration % 60 !== 0) {\n        if (d) {\n            d += singular ? ' ' : ', ';\n        }\n        const m = duration % 60;\n        d += `${\n            m >= 1\n                ? m +\n                  (singular\n                      ? format.minutes\n                      : format.minutes + (m === 1 ? '' : 's'))\n                : ''\n        }`;\n    }\n    return d;\n}\n\n/**\n * Get a filtered list of items\n * @param filter Value to filter on\n * @param items List of results to filter\n * @param fields Fields to check for matches on each item\n */\nexport function filterList<T = HashMap>(\n    filter: string,\n    items?: T[],\n    fields: string[] = ['id']\n): T[] {\n    let results: any[];\n    // Tokenise filter string\n    const filters = (filter || '').toLowerCase().split(' ');\n    const list = {};\n    for (const f of filters) {\n        /* istanbul ignore else */\n        if (f) {\n            /* istanbul ignore else */\n            if (!list[f]) {\n                list[f] = 0;\n            }\n            list[f]++;\n        }\n    }\n    // Group similar tokens\n    const parts = [];\n    for (const f in list) {\n        /* istanbul ignore else */\n        if (list.hasOwnProperty(f)) {\n            parts.push({ word: f, count: list[f], regex: new RegExp(f, 'gi') });\n        }\n    }\n    parts.sort(\n        (a, b) => b.word.length - a.word.length || a.word.localeCompare(b.word)\n    );\n    const item_list = JSON.parse(JSON.stringify(items || []));\n    /* istanbul ignore else */\n    if (filter) {\n        results = item_list.filter((item) => {\n            let match_count = 0;\n            item.match_index = 65535;\n            item.match = '';\n            const field_list = {};\n            // Initialise field match variables\n            for (const f of fields) {\n                field_list[f] = {\n                    value: (item[f] || '').toLowerCase(),\n                    index: 65536,\n                    matched: 0,\n                };\n            }\n            // Search for matches with the tokenised filter string\n            for (const i of parts) {\n                /* istanbul ignore else */\n                if (i.word) {\n                    // Check fields for matches\n                    for (const f of fields) {\n                        const field = field_list[f];\n                        const index = field.value.indexOf(i.word);\n                        field.index = index < field.index ? index : field.index;\n                        field.matches = (\n                            field.value.match(i.regex) || []\n                        ).length;\n                        field.value = field.value.replace(i.regex, ' ');\n                    }\n                    // Update token match count\n                    for (const f of fields) {\n                        const field = field_list[f];\n                        /* istanbul ignore else */\n                        if (field.matches >= i.count) {\n                            match_count++;\n                            // Update field matches\n                            let changed = 0;\n                            const tokens = (\n                                item[`match_${f}`] ||\n                                item[f] ||\n                                ''\n                            ).split(' ');\n                            for (const k of tokens) {\n                                /* istanbul ignore else */\n                                if (changed >= i.count) {\n                                    break;\n                                }\n                                /* istanbul ignore else */\n                                if (\n                                    k.toLowerCase().indexOf(i.word) >= 0 &&\n                                    k.indexOf('`') < 0\n                                ) {\n                                    tokens[tokens.indexOf(k)] = k.replace(\n                                        i.regex,\n                                        '`$&`'\n                                    );\n                                    changed++;\n                                }\n                            }\n                            item[`match_${f}`] = tokens.join(' ');\n                            break;\n                        }\n                    }\n                }\n            }\n            // Get field with the most relevent match\n            for (const f of fields) {\n                const field = field_list[f];\n                /* istanbul ignore else */\n                if (field.index < item.match_index && field.index >= 0) {\n                    item.match_index = field.index;\n                    item.match = f;\n                }\n            }\n            return (\n                item.match_index >= 0 &&\n                item.match &&\n                match_count >= parts.length\n            );\n        });\n    } else {\n        results = item_list;\n    }\n    // Sort by order of relevence then name\n    results.sort((a, b) => {\n        const diff = a.match_index - b.match_index;\n        return diff === 0 ? a.name.localeCompare(b.name) : diff;\n    });\n    return results;\n}\n\n/**\n * Convert a match string from `filterList` to renderable HTML\n * @param str Match string to change\n */\nexport function matchToHighlight(str: string): string {\n    /* istanbul ignore else */\n    if (str) {\n        str = str.replace(\n            /\\`[a-zA-Z0-9\\@\\.\\_]*\\`/g,\n            '<span class=\"highlight\">$&</span>'\n        );\n        str = str.replace(/\\`/g, '');\n    }\n    return str;\n}\n\n/**\n * Convert time string to ms from UTC epoch for today\n * @param time Time string in the format `HH:mm`\n */\nexport function timeToDate(time: string): number {\n    const parts = time.split(':');\n    const date = DateNow(new Date())\n        .setValue({\n            hour: +parts[0],\n            minute: +parts[1],\n        })\n        .startOfValue('minute');\n    return date.ms;\n}\n\n/**\n * Generate a random number\n * @param ceil Biggest value to generate not inclusive\n * @param floor Smallest value to generate. Defaults to 0\n */\nexport function randomInt(ceil: number, floor: number = 0) {\n    return Math.floor(Math.random() * (ceil - floor)) + floor;\n}\n\n/**\n * Get time format string for locale\n * @param isLowerCaseAmPm - if true, we use lowercase for am/pm.\n */\nexport function timeFormatString(): string {\n    return is24HourTime() ? 'HH:mm' : 'h:mma';\n}\n\nexport const hoursMinutes = (): string => (is24HourTime() ? 'HH:mm' : 'h:mma');\n\nexport function dayJsTimeFormatString(): string {\n    return is24HourTime() ? 'HH:mm' : 'h:mma';\n}\n\nexport const dayJsHoursMinutes = (): string =>\n    is24HourTime() ? 'HH:mm' : 'h:mm';\n\n/**\n * Converts a timeZone name into a date object.\n * @param timeZoneName - name of timezone\n */\nexport const timezoneNameToDate = (\n    timeZoneName: string | undefined\n): DateTZ | undefined => {\n    let zone: DateTZ | undefined;\n    if (timeZoneName) {\n        try {\n            zone = DateNow(new Date()).toZone(timeZoneName);\n        } catch (e) {\n            // invalid timezone. Suppress logs here.\n            // console.error(e);\n        }\n    }\n    return zone;\n};\n\nexport const timezoneDisplay = (date: DateTZ) =>\n    !!date ? `${date.formatDate('ZZZZ')}` : '';\nexport const gmtOffsetDisplay = (date: DateTZ) =>\n    !!date ? `(GMT${date.formatDate('ZZ')})` : '';\n\n/**\n * Returns a full time with timezone.\n * @param date\n */\nexport function timeWithZoneFormatString(date: DateTZ): string {\n    return `${date\n        .formatDate(timeFormatString())\n        .toLocaleLowerCase()} ${timezoneDisplay(date)}`;\n}\n\nexport function timeWithGmtOffsetFormatString(date: DateTZ): string {\n    return `${date\n        .formatDate(timeFormatString())\n        .toLocaleLowerCase()} ${gmtOffsetDisplay(date)}`;\n}\n\n/**\n * Returns a full start end range.\n *\n * Start and end both use lowercase am/pm markers (c.f. timeFormatString).\n * @param startDateTz start time DateTZ object\n * @param endDateTz end time DateTZ object\n */\nexport function startEndTimeFormatString(\n    startDateTz: DateTZ,\n    endDateTz: DateTZ\n): string {\n    return `${startDateTz\n        .formatDate(timeFormatString())\n        .toLocaleLowerCase()}-${endDateTz\n        .formatDate(timeFormatString())\n        .toLocaleLowerCase()}`;\n}\n\n/**\n * Returns a full start end range with timezone.\n *\n * Start and end both use lowercase am/pm markers (c.f. timeFormatString).\n * @param startDateTz start time DateTZ object\n * @param endDateTz end time DateTZ object\n */\nexport function startEndTimeWithZoneFormatString(\n    startDateTz: DateTZ,\n    endDateTz: DateTZ\n): string {\n    return `${startDateTz\n        .formatDate(timeFormatString())\n        .toLocaleLowerCase()}-${endDateTz\n        .formatDate(timeFormatString())\n        .toLocaleLowerCase()} ${gmtOffsetDisplay(startDateTz)}`;\n}\n\n/**\n * Returns a full date with weekday day month year.\n * @param date\n * @param comma optional boolean to display a comma after the month\n */\nexport function dateLocalFormatString(date: DateTZ, comma?: boolean): string {\n    if (comma) {\n        return date.formatLocalDate('cccc d MMMM, yyyy');\n    }\n    return date.formatLocalDate('cccc d MMMM yyyy');\n}\n\nexport function dateBuildingFormatString(\n    date: DateTZ,\n    comma?: boolean\n): string {\n    if (comma) {\n        return date.formatDate('cccc d MMMM, yyyy');\n    }\n    return date.formatDate('cccc d MMMM yyyy');\n}\n\nexport function shorterLocalDateFormatString(\n    date: DateTZ,\n    comma?: boolean\n): string {\n    if (comma) {\n        return date.formatLocalDate('ccc d MMM, yyyy');\n    }\n    return date.formatLocalDate('ccc d MMM yyyy');\n}\n\nexport function shorterBuildingDateFormatString(\n    date: DateTZ,\n    comma?: boolean\n): string {\n    if (comma) {\n        return date.formatDate('ccc d MMM, yyyy');\n    }\n    return date.formatDate('ccc d MMM yyyy');\n}\n\n/** Whether locale string is displayed in 24 hour time */\nexport function is24HourTime(): boolean {\n    const date = new Date();\n    const localeString = date\n        .toLocaleTimeString(\n            document.querySelector('html').getAttribute('lang') ||\n                navigator.language\n        )\n        .toLowerCase();\n    return localeString.indexOf('am') < 0 && localeString.indexOf('pm') < 0;\n}\n\n/* istanbul ignore next */\n/**\n * Downloads a file to the users computer with the given filename and contents\n * @param filename Name of the file to download\n * @param contents Contents of the file to download\n */\nexport function downloadFile(filename: string, contents: string) {\n    const element = document.createElement('a');\n    element.setAttribute(\n        'href',\n        'data:text/plain;charset=utf-8,' +\n            encodeURIComponent('\\uFEFF' + contents)\n    );\n    element.setAttribute('download', filename);\n\n    element.style.display = 'none';\n    document.body.appendChild(element);\n\n    element.click();\n\n    document.body.removeChild(element);\n}\n\n/**\n * Parse raw CSV data into a JSON object\n * @param csv CSV data to parse\n */\nexport function csvToJson(csv: string) {\n    const lines = csv.split('\\n');\n    let fields = lines.splice(0, 1)[0].split(',');\n    fields = fields.map((v) => v.replace('\\r', ''));\n    const list: any[] = [];\n    for (const line of lines) {\n        let parts = line.split(',');\n        parts = parts.map((v) => v.replace('\\r', ''));\n        /* istanbul ignore else */\n        if (parts.length >= fields.length) {\n            const item: any = {};\n            for (let i = 0; i <= parts.length; i++) {\n                let part = null;\n                part = parts[i];\n                /* istanbul ignore else */\n                if (part !== undefined) {\n                    item[(fields[i] || '').split(' ').join('_').toLowerCase()] =\n                        part;\n                }\n            }\n            list.push(item);\n        }\n    }\n\n    return list;\n}\n\n/**\n * Convert javascript array to CSV string\n * @param json Javascript array to convert\n */\nexport function jsonToCsv(json: HashMap[]) {\n    /* istanbul ignore else */\n    if (json instanceof Array && json.length > 0) {\n        const keys = Object.keys(json[0]);\n        const valid_keys = keys.filter((key) => json[0].hasOwnProperty(key));\n        return `${valid_keys.join(',')}\\n${json\n            .map((item) =>\n                valid_keys\n                    .map((key) => {\n                        return typeof item[key] !== 'boolean'\n                            ? `\"${item[key] || ''}\"`\n                            : item[key];\n                    })\n                    .join(',')\n            )\n            .join('\\n')}`;\n    }\n    return '';\n}\n\n/* istanbul ignore next */\n/**\n * detect IE\n * returns version of IE or false, if browser is not Internet Explorer\n */\nexport function detectIE() {\n    var ua = window.navigator.userAgent;\n\n    var msie = ua.indexOf('MSIE ');\n    if (msie > 0) {\n        // IE 10 or older => return version number\n        return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\n    }\n\n    var trident = ua.indexOf('Trident/');\n    if (trident > 0) {\n        // IE 11 => return version number\n        var rv = ua.indexOf('rv:');\n        return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\n    }\n\n    var edge = ua.indexOf('Edge/');\n    if (edge > 0) {\n        // Edge (IE 12+) => return version number\n        return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\n    }\n\n    // other browser\n    return false;\n}\n\n/**\n * Grab point details from mouse or touch event\n * @param event Event to grab details from\n */\nexport function eventToPoint(event: MouseEvent | TouchEvent): Point {\n    if (!event) {\n        return { x: -1, y: -1 };\n    }\n    if (event instanceof MouseEvent) {\n        return { x: event.clientX, y: event.clientY };\n    } else {\n        return event.touches && event.touches.length > 0\n            ? { x: event.touches[0].clientX, y: event.touches[0].clientY }\n            : { x: -1, y: -1 };\n    }\n}\n\n/* istanbul ignore next */\n/**\n * Flatten nested array\n * @param an_array Array to flatten\n */\nexport function flatten<T = any>(an_array: T[]) {\n    const stack = [...an_array];\n    const res = [];\n    while (stack.length) {\n        // pop value from stack\n        const next = stack.pop();\n        if (Array.isArray(next)) {\n            // push back array items, won't modify the original input\n            stack.push(...next);\n        } else {\n            res.push(next);\n        }\n    }\n    // reverse to restore input order\n    return res.reverse();\n}\n\nconst seed = xmur3('PlaceOS');\nconst rand = sfc32(0x9e3779b9, 0x243f6a88, 0xb7e15162, seed());\n\nexport function predictableRandomInt(ceil: number = 100, floor: number = 0) {\n    return Math.floor(rand() * (ceil - floor)) + floor;\n}\n\n// https://stackoverflow.com/questions/521295/seeding-the-random-number-generator-in-javascript\nfunction xmur3(str) {\n    for (var i = 0, h = 1779033703 ^ str.length; i < str.length; i++)\n        (h = Math.imul(h ^ str.charCodeAt(i), 3432918353)),\n            (h = (h << 13) | (h >>> 19));\n    return function () {\n        h = Math.imul(h ^ (h >>> 16), 2246822507);\n        h = Math.imul(h ^ (h >>> 13), 3266489909);\n        return (h ^= h >>> 16) >>> 0;\n    };\n}\n\nfunction sfc32(a, b, c, d) {\n    return function () {\n        a >>>= 0;\n        b >>>= 0;\n        c >>>= 0;\n        d >>>= 0;\n        var t = (a + b) | 0;\n        a = b ^ (b >>> 9);\n        b = (c + (c << 3)) | 0;\n        c = (c << 21) | (c >>> 11);\n        d = (d + 1) | 0;\n        t = (t + d) | 0;\n        c = (c + t) | 0;\n        return (t >>> 0) / 4294967296;\n    };\n}\n\nexport function isLessThanBreakpoint(breakpoint: number): boolean {\n    if (window) {\n        return window.innerWidth < breakpoint;\n    }\n    return false;\n}\n\nexport function toTitleCase(str: string): string {\n    return typeof str === 'string'\n        ? str\n              .toLowerCase()\n              .split(' ')\n              .map(function (word) {\n                  return word.replace(word[0], word[0].toUpperCase());\n              })\n              .join(' ')\n        : '';\n}\n","\nimport { Directive, OnDestroy } from '@angular/core';\nimport { BaseClass } from './base.class';\nimport { SpaceImageObject } from '@mckinsey-converge/base';\nimport { BehaviorSubject } from 'rxjs';\n\n@Directive({\n    selector: 'a-very-basic-component-image-that-should-not-be-used'\n})\nexport class ImageDirective extends BaseClass implements OnDestroy {\n    public foundImages?: SpaceImageObject[];\n    public loadImages?: BehaviorSubject<SpaceImageObject[]>\n    public ngOnDestroy(): void {\n        this.destroy();\n    }\n}","import {\n    Directive,\n    ElementRef,\n    HostListener\n} from '@angular/core';\n\n@Directive({\n    selector: 'input[type=number], input[numbersOnly]'\n})\nexport class NumbersOnlyDirective {\n\n    constructor(private _el: ElementRef) {\n    }\n\n    @HostListener('input', ['$event']) onInputChange(event) {\n        const initalValue = this._el.nativeElement.value;\n        this._el.nativeElement.value = initalValue.replace(/[^0-9]*/g, '');\n        if (initalValue !== this._el.nativeElement.value) {\n            event.stopPropagation();\n        }\n    }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'replace'\n})\nexport class ReplacePipe implements PipeTransform {\n\n    transform(value: string, from: string = '_', to: string = ' '): string {\n        return (value|| '').split(from).join(to);\n    }\n}\n","export * from './lib/bookings.module';\nexport * from './lib/bookings.actions'\nexport * from './lib/bookings.reducer'\nexport * from './lib/bookings.types'\nexport * from './lib/bookings.utils'\n","\nimport { IBookingQueryOptions, PaginatedBooking } from '@mckinsey-converge/data-common';\nimport { \n    createLoadingAction\n} from '../../../loading/src/lib/loading.actions';\n\nimport {\n    MyBookingsState,\n    MyBookingsStoreState,\n} from './bookings.types';\nimport {\n    createAction,\n    props\n} from '@ngrx/store';\n\nexport const bookingStateSelector = (state: MyBookingsStoreState) => state.bookings;\n\nexport const loadBookingsWithQuery = createAction('[Bookings] Load Bookings with query', props<IBookingQueryOptions>());\n\nexport const loadHomepageBookingsResults = createLoadingAction<MyBookingsState, PaginatedBooking, IBookingQueryOptions>('HomepageBookings', 'homepage');\n\nexport const loadUpcomingBookingsResults = createLoadingAction<MyBookingsState, PaginatedBooking, IBookingQueryOptions>('UpcomingBookings', 'upcoming');\n\nexport const loadPastBookingsResults = createLoadingAction<MyBookingsState, PaginatedBooking, IBookingQueryOptions>('PastBookings', 'past');\n\nexport const loadCancelledBookingsResults = createLoadingAction<MyBookingsState, PaginatedBooking, IBookingQueryOptions>('CancelledBookings', 'cancelled');\n\nexport const loadBookingByIdResults = createLoadingAction<MyBookingsState, PaginatedBooking, IBookingQueryOptions>('BookingById', 'bookingById');\n\nexport const clearBookingByIdResults = createAction('[BookingById] Clear Booking Data');\n","import { Injectable } from '@angular/core';\nimport {\n    Actions,\n    Effect,\n    ofType\n} from '@ngrx/effects';\nimport {\n    IBookingQueryOptions,\n    BookingsPaginatedService\n} from '../../../data-common/src/lib/bookings';\nimport {\n    createLoadingEffect,\n    LoadingAction\n} from '@mckinsey-converge/loading';\nimport {\n    loadHomepageBookingsResults,\n    loadPastBookingsResults,\n    loadUpcomingBookingsResults,\n    loadCancelledBookingsResults,\n    loadBookingsWithQuery,\n    loadBookingByIdResults\n} from './bookings.actions';\nimport { mergeMap } from 'rxjs/operators';\nimport {\n\n} from './bookings.utils';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\n\n@Injectable()\nexport class BookingsEffects {\n    constructor(private actions: Actions,\n                private bookingService: BookingsPaginatedService) {\n    }\n\n    @Effect()\n    public afterBookingsRequestResultsLoadOthersEffect = this.actions.pipe(\n        ofType(loadBookingsWithQuery),\n        mergeMap((action: LoadingAction<IBookingQueryOptions>) => {\n            const date = new DateTZ({date: action.from})\n            const yourBookingsRequest = {\n                email: action.email,\n                pagination: true,\n                limit: 4,\n                offset: action.offset,\n                show_cancelled: false,\n                sort: 'start_epoch asc',\n                filters: {\n                    end_epoch: `>=${date.subtractValue({ minutes: 5 }).seconds}`,\n                },\n                include_rooms: true\n            };\n            const upcomingRequest = {\n                email: action.email,\n                pagination: true,\n                limit: 4,\n                offset: action.offset,\n                show_cancelled: false,\n                sort: 'start_epoch asc',\n                filters: {\n                    end_epoch: `>=${date.seconds}`,\n                },\n                include_rooms: true\n            };\n            const pastRequest = {\n                email: action.email,\n                pagination: true,\n                limit: 4,\n                offset: action.offset,\n                show_cancelled: false,\n                sort: 'start_epoch desc',\n                filters: {\n                    start_epoch: `>${date.subtractValue({ hours: 48 }).seconds}`,\n                    end_epoch: `<${date.seconds}`,\n                },\n                include_rooms: true\n            };\n            const cancelledRequest = {\n                email: action.email,\n                pagination: true,\n                limit: 4,\n                offset: action.offset,\n                show_cancelled: true,\n                sort: 'start_epoch desc',\n                filters: {\n                    start_epoch: `>${date.subtractValue({ hours: 48 }).seconds}`,\n                },\n                include_rooms: true\n            };\n            const byIdRequest = {\n                email: action.email,\n                id: action.id,\n                pagination: true,\n                limit: 1,\n                include_rooms: true\n            };\n\n            const effects = [];\n            switch(action.target) {\n                case 'upcoming':\n                    effects.push(loadUpcomingBookingsResults.request(upcomingRequest));\n                    break;\n                case 'past':\n                    effects.push(loadPastBookingsResults.request(pastRequest));\n                    break;\n                case 'cancelled':\n                    effects.push(loadCancelledBookingsResults.request(cancelledRequest));\n                    break;\n                case 'bookingById':\n                    effects.push(loadBookingByIdResults.request(byIdRequest));\n                    break\n                case 'homepage':\n                    effects.push(loadHomepageBookingsResults.request(yourBookingsRequest));\n                    effects.push(loadPastBookingsResults.request(pastRequest));\n                    break\n                default:\n            }\n            return effects;\n        })\n    );\n\n    @Effect()\n    public loadHomepageBookingsResultsEffect = createLoadingEffect(this.actions, loadHomepageBookingsResults,\n        (action) => this.bookingService.userBookings(action, `homepage-${action.filters?.start_epoch || ''}${action.filters?.end_epoch || ''}`));\n\n    @Effect()\n    public loadUpcomingBookingsResultsEffect = createLoadingEffect(this.actions, loadUpcomingBookingsResults,\n        (action) => this.bookingService.userBookings(action, `upcoming-${action.filters?.start_epoch || ''}${action.filters?.end_epoch || ''}`));\n            \n    @Effect()\n    public loadPastBookingsResultsEffect = createLoadingEffect(this.actions, loadPastBookingsResults,\n        (action) =>\n            this.bookingService.userBookings(action, `past-${action.filters?.start_epoch || ''}${action.filters?.end_epoch || ''}`));\n\n    @Effect()\n    public loadCancelledBookingsResultsEffect = createLoadingEffect(this.actions, loadCancelledBookingsResults,\n        (action) =>\n            this.bookingService.userBookings(action, `cancelled-${action.filters?.start_epoch || ''}${action.filters?.end_epoch || ''}`));\n\n    @Effect()\n    public loadBookingByIdResultsEffect = createLoadingEffect(this.actions, loadBookingByIdResults,\n        (action) => \n            this.bookingService.userBookings(action, `bookingById-${action.id}`));\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { bookingsReducer } from './bookings.reducer';\nimport { BookingsEffects } from './bookings.effects';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        EffectsModule.forFeature([BookingsEffects]),\n        StoreModule.forFeature('bookings', bookingsReducer)\n    ]\n})\nexport class BookingsModule {\n}\n","import { LoadingModel } from '@mckinsey-converge/loading';\nimport {\n    createReducer,\n    on\n} from '@ngrx/store';\nimport {\n    loadHomepageBookingsResults,\n    loadUpcomingBookingsResults,\n    loadPastBookingsResults,\n    loadCancelledBookingsResults,\n    loadBookingByIdResults,\n    clearBookingByIdResults,\n} from './bookings.actions';\nimport { MyBookingsState } from './bookings.types';\n   \nimport { \n    BookingFormState,\n    clearBookingFormData,\n    clearRoomFilters,\n    openBookingSurvey,\n    storeBookingFormData,\n    storeRoomFilters\n} from '@mckinsey-converge/data-common';\n\n\nexport const initialBookingsState: MyBookingsState = {\n    query: LoadingModel.empty(),\n    homepage: LoadingModel.empty(),\n    upcoming: LoadingModel.empty(),\n    past: LoadingModel.empty(),\n    cancelled: LoadingModel.empty(),\n    bookingById: LoadingModel.empty(),\n};\n\nexport const bookingsReducer = createReducer(initialBookingsState,\n    on(clearBookingByIdResults, (state: MyBookingsState) => ({\n        ...state,\n        bookingById: LoadingModel.empty(),\n    }) as MyBookingsState),\n    ...loadHomepageBookingsResults.ons,\n    ...loadUpcomingBookingsResults.ons,\n    ...loadPastBookingsResults.ons,\n    ...loadCancelledBookingsResults.ons,\n    ...loadBookingByIdResults.ons,\n    );\n\n\n\n    export const initialBookingFormState: BookingFormState = {\n        activeFormFilters: []\n    };\n    \n    export const bookingFormReducer = createReducer(initialBookingFormState,\n        on(storeBookingFormData, (state: BookingFormState, action) => {\n            return {\n                ...state,\n                activeForm: {\n                    ...state.activeForm,\n                    ...action.payload\n                }\n            } as BookingFormState;\n        }),\n        on(clearBookingFormData, state => ({\n            ...state,\n            activeForm: undefined\n        }) as BookingFormState),\n        on(openBookingSurvey, state => ({\n            ...state,\n            bookingCompleted: new Date()\n        }) as BookingFormState),\n        on(storeRoomFilters, (state: BookingFormState, action) => {\n            return {\n                ...state,\n                activeFormFilters: action.payload\n            } as BookingFormState;\n        }),\n        on(clearRoomFilters, (state: BookingFormState) => ({\n            ...state,\n            activeFormFilters: initialBookingFormState.activeFormFilters\n        }) as BookingFormState)\n    );\n    \n","import { Booking } from '@mckinsey-converge/data-common';\nimport { SelectOption } from '@mckinsey-converge/ui';\n\nexport const mapBookingToSelectOption = (booking?: Booking): SelectOption<any> => booking ? ({\n    value: booking.id,\n    display: booking.name\n}) : undefined;\n","import { \n    createLoadingAction,\n} from '../../../loading/src/lib/loading.actions';\nimport {\n    Building,\n    BuildingCity,\n} from '../../../data-common/src/lib/organisation/building.class';\nimport {\n    BuildingLevel,\n} from '../../../data-common/src/lib/organisation/level.class'\nimport {\n    Organisation,\n} from '../../../data-common/src/lib/organisation/organisation.class'\nimport { createSelector } from '@ngrx/store';\nimport {\n    BuildingState,\n    BuildingStoreState\n} from './buildings.types';\n\nexport const loadBuildings = createLoadingAction<BuildingState, Building[], Organisation>('Buildings', 'data');\n\nexport const buildingStateSelector = (state: BuildingStoreState) => state.buildings;\n\nexport const selectLoadBuildingsSuccess = createSelector(buildingStateSelector, loadBuildings.selectors.optionalSuccess);\n\n/**\n * Groups buildings by city\n */\nexport const selectBuildingOptionsGroupedByCity = createSelector(loadBuildings.selectors.optionalSuccess, (success) => {\n    if (success) {\n        const mapped = new Map<BuildingCity, Building[]>();\n        success.forEach(s => {\n            const found = Array.from(mapped.keys()).find(c => c.name === s.city);\n            let list = found ? mapped.get(found) : undefined;\n            if (!list) {\n                list = [];\n                mapped.set({\n                    name: s.city,\n                    timezone: s.timezone\n                }, list);\n            }\n            list.push(s);\n        });\n        return mapped;\n    }\n    return new Map<BuildingCity, Building[]>();\n});\n\nexport const selectLevelByZoneId = createSelector(selectLoadBuildingsSuccess,\n    (buildings, param: string) => {\n        if (buildings) {\n            return buildings.map(b => b.levels.find((l: BuildingLevel) => l.id === param))\n                ?.[0] ?? undefined;\n        }\n        return undefined;\n    });\n","export * from './lib/data-common.module';\nexport * from './lib/booking';\nexport * from './lib/bookings';\nexport * from './lib/catering';\nexport * from './lib/location';\nexport * from './lib/organisation';\nexport * from './lib/spaces';\nexport * from './lib/users';\nexport * from './lib/app.service';\nexport * from './lib/hotkeys.service';\nexport * from './lib/base.service';\nexport * from './lib/base-api.class';\nexport * from './lib/reports'\nexport * from './lib/service-manager.class';\nexport * from './lib/settings.service';\nexport * from './lib/spec-helpers';\nexport * from './lib/settings.interfaces';\nexport * from './lib/validation.utilities';\nexport * from './lib/status.interfaces';\nexport * from './lib/recurrence/recurrence.utils';\nexport * from './lib/validation.utilities'","import { HashMap } from '@mckinsey-converge/base';\n\n/**\n * Convert map into a query string\n * @param map Key value pairs to convert\n */\nexport function toQueryString(map: HashMap) {\n  let str = '';\n  if (map) {\n    for (const key in map) {\n      if (map.hasOwnProperty(key) && map[key] !== undefined && map[key] !== null) {\n        str += `${(str ? '&' : '')}${key}=${map[key]}`;\n      }\n    }\n  }\n  return str;\n}\n","import {\n    ApplicationRef,\n    Injectable,\n    NgZone,\n} from '@angular/core';\nimport { Title } from '@angular/platform-browser';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { take, first } from 'rxjs/operators';\n\nimport { ComposerService } from '@placeos/composer';\nimport { PlaceOSOptions } from '@placeos/ts-client';\nimport { HeapIoService } from '@acaprojects/ngx-heap-io';\n\nimport {\n    BehaviorSubject,\n    Observable,\n    Subject\n} from 'rxjs';\n\nimport {\n    ApplicationLoadingState,\n    BaseClass,\n    ConsoleStream,\n    log\n} from '@mckinsey-converge/base';\nimport { SettingsService } from './settings.service';\n\nimport { HotkeysService } from './hotkeys.service';\nimport {\n    ApplicationIcon,\n    ComposerSettings\n} from './settings.interfaces';\nimport { EnvironmentService } from '../../../environment/src/lib/environment.service'; // '@mckinsey-converge/environment';\nimport {\n    Store\n} from '@ngrx/store';\nimport { selectCurrentUser } from '../../../user/src/lib/user.actions';\nimport { UserStoreState } from '../../../user/src/lib/user.types';\nimport { Booking } from './bookings';\nimport { filter } from 'rxjs/operators';\n\n\ndeclare global {\n    interface Window {\n        application: ApplicationService;\n        mock: {\n            enabled: boolean;\n            backend: any;\n        };\n    }\n}\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class ApplicationService extends BaseClass {\n    /** Map of state variables for Service */\n    protected _subjects: {\n        [key: string]: BehaviorSubject<any> | Subject<any>;\n    } = {};\n    /** Map of observables for state variables */\n    protected _observers: { [key: string]: Observable<any> } = {};\n    _kioskFormFilter: boolean;\n\n    constructor(\n        public store: Store<UserStoreState>,\n        public analytics: HeapIoService,\n        private _app_ref: ApplicationRef,\n        private _zone: NgZone,\n        private _title: Title,\n        private _settings: SettingsService,\n        private _hotkeys: HotkeysService,\n        private _composer: ComposerService,\n        private _snackbar: MatSnackBar,\n        private _environment: EnvironmentService\n    ) {\n        super();\n        this.set('system', null);\n        this.set('title', 'Home');\n        this.set('loading', {});\n        this.set('CONCIERGE.day_view.viewing', null);\n        this.set('undo', new BehaviorSubject<{\n            action: 'series' | 'booking',\n            booking: Booking\n        } | null>(null));\n\n        this.set('APP.breakdown', false);\n\n        this._app_ref.isStable.pipe(first(_ => _)).subscribe(() => {\n            this._zone.run(() => {\n                this.log('APP', `Application has stablised.`);\n                this.waitForSettings();\n            });\n        });\n    }\n\n    public set kioskFormFilter(isIt: boolean) {\n        this._kioskFormFilter = isIt;\n    }\n\n    public get kioskFormFilter():boolean {\n        return this._kioskFormFilter \n    }\n\n    /** Analytics service */\n    public get Analytics() {\n        return {};\n    }\n\n    /** Hotkeys service */\n    public get Hotkeys() {\n        return this._hotkeys;\n    }\n\n    /**\n     * Get a setting from the settings service\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n     */\n    public setting(key: string): any {\n        return this._settings.get(key);\n    }\n\n    /**\n     * Title of the page\n     */\n    public set title(value: string) {\n        const title_suffix = this.setting('app.title');\n        this.set('title', value);\n        this._title.setTitle(`${value ? value + ' | ' : ''}${title_suffix}`);\n    }\n\n    /**\n     * Title of the page\n     */\n    public get title(): string {\n        return this._title.getTitle();\n    }\n\n    /** Root API Endpoint */\n    public get endpoint() {\n        return `/api/staff/`;\n    }\n\n    /** Root API Endpoint for engine */\n    public get engine_endpoint() {\n        return this._composer.auth.api_endpoint + '/';\n    }\n\n    /** Whether settings has been loaded */\n    public get has_settings(): boolean {\n        return this._settings.is_initialised;\n    }\n\n    /**\n     * Create notification popup\n     * @param type CSS Class to add to the notification\n     * @param message Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     * @param icon Icon to render to the left of the notification message\n     */\n    public notify(\n        type: string,\n        message: string,\n        action: string = 'OK',\n        on_action?: () => void,\n        icon: ApplicationIcon = {\n            type: 'icon',\n            class: 'material-icons',\n            content: 'info'\n        }\n    ): void {\n        const snackbar_ref = this._snackbar.open(message, action, {\n            panelClass: [type],\n            duration: 5000\n        });\n        this.subscription(\n            'snackbar_close',\n            snackbar_ref.afterDismissed().subscribe(() => {\n                this.unsub('snackbar_close');\n                this.unsub('notify');\n            })\n        );\n        if (action) {\n            on_action = on_action || (() => snackbar_ref.dismiss());\n            this.subscription(\n                'notify',\n                snackbar_ref.onAction().subscribe(() => on_action())\n            );\n        }\n    }\n\n    /**\n     * Create success notification popup\n     * @param msg Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     */\n    public notifySuccess(msg: string, action?: string, on_action?: () => void): void {\n        const icon: ApplicationIcon = {\n            type: 'icon',\n            class: 'material-icons',\n            content: 'done'\n        };\n        this.notify('success', msg, action, on_action, icon);\n    }\n\n    /**\n     * Create error notification popup\n     * @param msg Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     */\n    public notifyError(msg: string, action?: string, on_action?: () => void): void {\n        const icon: ApplicationIcon = {\n            type: 'icon',\n            class: 'material-icons',\n            content: 'error'\n        };\n        this.notify('error', msg, action, on_action, icon);\n    }\n\n    /**\n     * Create warning notification popup\n     * @param msg Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     */\n    public notifyWarn(msg: string, action?: string, on_action?: () => void): void {\n        const icon: ApplicationIcon = {\n            type: 'icon',\n            class: 'material-icons',\n            content: 'warning'\n        };\n        this.notify('warn', msg, action, on_action, icon);\n    }\n\n    /**\n     * Create info notification popup\n     * @param msg Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     */\n    public notifyInfo(msg: string, action?: string, on_action?: () => void): void {\n        this.notify('info', msg, action, on_action);\n    }\n\n    /**\n     * Log data to the browser console\n     * @param type Type of message\n     * @param msg Message body\n     * @param args array of argments to log to the console\n     * @param stream Stream to emit the console on. 'debug', 'log', 'warn' or 'error'\n     * @param force Whether to force message to be emitted when debug is disabled\n     */\n    public log(\n        type: string,\n        msg: string,\n        args?: any,\n        stream: ConsoleStream = 'debug',\n        force: boolean = false\n    ): void {\n        log(type, msg, args, stream, force);\n    }\n\n    /**\n     * Get the current value of the named property\n     * @param name Property name\n     */\n    public get<U = any>(name: string): U {\n        return this._subjects[name] && this._subjects[name] instanceof BehaviorSubject\n            ? (this._subjects[name] as BehaviorSubject<U>).getValue()\n            : null;\n    }\n\n    /**\n     * Listen to value change of the named property\n     * @param name Property name\n     * @param next Callback for value changes\n     */\n    public listen<U = any>(name: string): Observable<U> {\n        if (!this._observers[name]) {\n            this.set<U>(name, null);\n        }\n        return this._observers[name];\n    }\n\n    /**\n     * Update the value of the named property\n     * @param name Property name\n     * @param value New value\n     */\n    public set<U = any>(name: string, value: U): void {\n        if (!this._subjects[name]) {\n            this._subjects[name] = new BehaviorSubject<U>(value);\n            this._observers[name] = this._subjects[name].asObservable();\n        } else {\n            this._subjects[name].next(value);\n        }\n    }\n\n    /** Wait for settings to be initialised before setting up the application */\n    private waitForSettings() {\n        // Wait until the settings have loaded before initialising\n        this._settings.initialised.pipe(first(_ => _)).subscribe(() => this.init());\n    }\n\n    /**\n     * Initialise application services\n     */\n    private init(): void {\n        this.setupComposer();\n        this.subscription('currentUser', this.store.select(selectCurrentUser)\n            .pipe( filter(user => user !== undefined) )\n            .pipe(take(1))\n            .subscribe((user: any) => {\n                // Once we know we have the user loaded.\n                this.setupAnalytics(user?.fmno);\n            })\n        );\n        this._composer.initialised.pipe(first(_ => _)).subscribe(() => {\n            this._initialised.next(true);\n        });\n        // Add service to window if in debug mode\n        if (window.debug) {\n            window.application = this;\n        }\n    }\n\n    /**\n     * Initialise the composer library comms\n     */\n    private setupComposer(): void {\n        this.log('SYSTEM', 'Setup up composer...');\n        const loading: ApplicationLoadingState = this.get('loading');\n        loading.composer = {\n            message: 'Initialising service connection',\n            state: 'loading'\n        };\n        this.set('loading', loading);\n        // Get application settings\n        const settings: ComposerSettings = this._settings.get('composer') || {};\n        const protocol = settings.protocol || location.protocol;\n        const host = settings.domain || location.hostname;\n        const port = settings.port || location.port;\n        const url = settings.use_domain ? `${protocol}//${host}:${port}` : location.origin;\n        const route = host.includes('localhost') && port === '4200' ? '' : settings.route || '';\n        const mock =\n            this._settings.get('mock') ||\n            location.href.includes('mock=true') ||\n            localStorage.getItem('mock') === 'true';\n        // Generate configuration object\n        const config: PlaceOSOptions = {\n            scope: 'public',\n            host: `${host}:${port}`,\n            auth_uri: `${url}/auth/oauth/authorize`,\n            token_uri: `${url}/auth/token`,\n            redirect_uri: `${location.origin}${route}/oauth-resp.html`,\n            handle_login: !settings.local_login,\n            mock\n        };\n        this._composer.setup(config);\n        loading.composer = {\n            message: 'Initialising service connection',\n            state: 'complete'\n        };\n        this.set('loading', loading);\n    }\n\n    private setupAnalytics(fmno: string) {\n        this.log('HEAP', `Loading heap ${this._environment?.heap_io_id}`);\n        // Default Heap app ID via the default setting\n        const heapIo = this._settings.get('app.heap_io');\n        if (this._environment?.heap_io_id) {\n            // Apply Heap app ID via the environmental setting\n            heapIo.app_id = this._environment.heap_io_id;\n        }\n        if (heapIo) {\n            this.analytics.load(heapIo);\n            if (fmno) {\n                this.analytics.identify(fmno);\n            }\n        } else {\n            this.log('HEAP', `Heap could not be found for the current frontend ${this._settings.frontend}`);\n        }\n    }\n\n}\n","import { Subject } from 'rxjs';\n\nimport {\n  BaseClass,\n  HashMap\n} from '@mckinsey-converge/base';\nimport {\n  ServiceLike,\n  ServiceManager\n} from './service-manager.class';\n\nexport type ApiEventType = 'value_change' | 'item_saved' | 'reset' | 'other';\n\nexport interface ApiEvent<T = HashMap> {\n  type: ApiEventType;\n  metadata: T;\n}\n\n\nexport class BaseDataClass extends BaseClass {\n  /** Subject for emitting events on the object */\n  protected readonly event_subject = new Subject<ApiEvent>();\n  /** Observable for events on this object */\n  public readonly events = this.event_subject.asObservable();\n  /** Unique Identifier of the object */\n  public readonly id: string;\n  /** Human readable name of the object */\n  public readonly name: string;\n  /** Email address associated with the object */\n  public readonly email: string;\n  /** Map of local property names to server ones */\n  protected _server_names: HashMap<string> = {};\n\n  /** Service for managing model on the server */\n  protected get _service(): ServiceLike {\n    return ServiceManager.serviceFor(BaseDataClass);\n  }\n\n  constructor(raw_data: HashMap) {\n    super();\n    this.id = raw_data.id || raw_data.zone_id || raw_data.email || '';\n    this.name = raw_data.name || '';\n    this.email = `${raw_data.email || ''}`.toLowerCase();\n  }\n\n  /**\n   * Save pending changes to server\n   */\n  public save(): Promise<BaseDataClass> {\n    if (this._service) {\n      const form = this.toJSON();\n      return new Promise((resolve, reject) => {\n        const promise = this.id\n          ? this._service.update(this.id, form)\n          : this._service.add(form);\n        promise.then(\n          (d) => {\n            this.event_subject.next({ type: 'item_saved', metadata: d });\n            resolve(d);\n          },\n          (_) => reject(_)\n        );\n      });\n    } else {\n      Promise.reject('No service to process request');\n    }\n  }\n\n  /**\n   * Delete this item from the server\n   */\n  public delete(): Promise<void> {\n    if (this.id) {\n      return this._service.delete(this.id);\n    }\n  }\n\n  /**\n   * Run task for this item on the service\n   * @param task_name Name of the task\n   * @param parameters Parameters to pass to the task request\n   */\n  public runTask(task_name: string, parameters: HashMap): Promise<void> {\n    if (this.id) {\n      return this._service.task(this.id, task_name, parameters);\n    }\n  }\n\n  /**\n   * Convert object into plain object\n   */\n  public toJSON(this: BaseDataClass): HashMap {\n    const obj: any = { ...this };\n    // Remove local private members\n    delete obj._service;\n    delete obj._changes;\n    delete obj.event_subject;\n    delete obj.events;\n    // Remove parent private members\n    delete obj._timers;\n    delete obj._intervals;\n    delete obj._subscriptions;\n    delete obj._server_names;\n    delete obj._initialised;\n    // Convert remaining members to be public\n    const keys = Object.keys(obj);\n    for (const key of keys) {\n      if (key[0] === '_') {\n        const new_key = this._server_names[key.substring(1)] || key.substring(1);\n        obj[new_key] = obj[key];\n        delete obj[key];\n      } else if (obj[key] === undefined) {\n        delete obj[key];\n      }\n    }\n    return obj;\n  }\n\n  /**\n   * Make a copy of this object\n   */\n  public clone(): BaseDataClass {\n    return new BaseDataClass(this);\n  }\n\n  /**\n   * Make a copy of this object without identification data\n   */\n  public duplicate(): BaseDataClass {\n    return new BaseDataClass({ ...this, id: null, email: null });\n  }\n}\n","import { ComposerService } from '@placeos/composer';\nimport { BehaviorSubject, Observable, of, Subject, Subscriber } from 'rxjs';\n\nimport { BaseDataClass } from './base-api.class';\nimport { BaseClass, HashMap } from '@mckinsey-converge/base';\nimport { ApplicationService } from './app.service';\nimport { toQueryString } from './api.utilities';\nimport { SettingsService } from './settings.service';\nimport { catchError, map } from 'rxjs/operators';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\n\nexport interface IEngineResponse {\n  results: HashMap[];\n  total: number;\n}\n\nexport class BaseAPIService<T extends {} = BaseDataClass> extends BaseClass {\n  /** Application service */\n  public parent: ApplicationService;\n  /** Display name of the service */\n  protected _name: string;\n  /** API Route of the service */\n  protected _api_route: string;\n  /** Map of state variables for Service */\n  protected _subjects: { [key: string]: BehaviorSubject<any> | Subject<any> } = {};\n  /** Map of observables for state variables */\n  protected _observers: { [key: string]: Observable<any> } = {};\n  /** Map of poll subscribers for API endpoints */\n  protected _subscribers: { [key: string]: Subscriber<any> } = {};\n  /** Map of promises for Service */\n  protected _promises: { [key: string]: Promise<any> } = {};\n  /** Comparison function for service items */\n  protected _compare: (a: T, b: T) => boolean = (a, b) =>\n    a === b || (a as any).id === (b as any).id;\n  /** Default filter function for list method */\n  protected _list_filter: (a: T) => boolean = (a) => !!a;\n\n  /** Http Client */\n  protected get http() {\n    return this._composer.http;\n  }\n  constructor(protected _composer: ComposerService,\n              protected settingsService: SettingsService) {\n    super();\n    this._name = 'Base';\n    this._api_route = 'base';\n    this.set('list', []);\n  }\n\n  /**\n   * Injects concierge into form_data.\n   */\n  private injectConcierge(form_data: HashMap) {\n      // we only send it over when concierge, since the BE may check for presence rather than\n      // if its true or not.\n      if (this.settingsService.concierge) {\n          return { ...form_data, concierge: true }\n      }\n      return form_data;\n  }\n\n  /**\n   * Initailise service\n   */\n  public init() {\n    this.load().then(\n      (_) => this._initialised.next(true),\n      (err) => this.timeout('init', () => this.init(), 1000)\n    );\n  }\n\n  /**\n   * Get API route for the service\n   * @param engine Whether endpoint is using the application API or engine API\n   */\n  public route(engine: boolean = false) {\n    const endpoint = engine\n      ? this._composer.auth.api_endpoint\n      : '/api/staff';\n    return `${endpoint}/${this._api_route}`;\n  }\n\n  /** API Route of the service */\n  public get api_route() {\n    return this._api_route;\n  }\n\n  /**\n   * Get the current value of the named property\n   * @param name Property name\n   */\n  public get<U = any>(name: string): U {\n    if (!this._observers[name]) {\n      this.set<U>(name, null);\n    }\n    return (this._subjects[name] as BehaviorSubject<U>).getValue();\n  }\n\n  /**\n   * Listen to value change of the named property\n   * @param name Property name\n   * @param next Callback for value changes\n   */\n  public listen<U = any>(name: string): Observable<U> {\n    if (!this._observers[name]) {\n      this.set<U>(name, null);\n    }\n    return this._observers[name];\n  }\n\n  /**\n   * Update the value of the named property\n   * @param name Property name\n   * @param value New value\n   */\n  protected set<U = any>(name: string, value: U): void {\n    if (!this._subjects[name]) {\n      this._subjects[name] = new BehaviorSubject<U>(value);\n      this._observers[name] = this._subjects[name].asObservable();\n    } else {\n      this._subjects[name].next(value);\n    }\n  }\n\n  /**\n   * Get list of loaded items\n   * @param predicate Function for filtering the list\n   */\n  public filter(predicate: (a: T) => boolean = this._list_filter): T[] {\n        const list: T[] = this.get('list');\n        return list.filter(predicate);\n  }\n\n  /**\n   * Get item with the given id from the loaded items\n   * @param id ID of the item\n   */\n  public find(id: string): T {\n    const list = this.get('list');\n    return list.find((i) => i.id === id || (i.email?.toLowerCase() === id?.toLowerCase()));\n  }\n\n  /**\n   * Query the index of the API route associated with this service\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public query(query_params: HashMap = {}): Promise<T[]> {\n    let engine = false;\n    let cache = 1000;\n    /* istanbul ignore else */\n    if (query_params) {\n      engine = !!query_params.engine;\n      delete query_params.engine;\n      cache = typeof query_params.cache !== 'boolean' ? query_params.cache || 1000 : 1000;\n      typeof query_params.cache !== 'boolean' && delete query_params.cache;\n    }\n    let query = toQueryString(query_params);\n    const key = `query|${query}`;\n    if (!this._promises[key]) {\n      // Bring back once implemented in the API\n      // if (this.settingsService.concierge) {\n      //   query = query + '&check_access=true';\n      // }\n      this._promises[key] = new Promise((resolve, reject) => {\n        const url = `${this.route(engine)}${query ? '?' + query : ''}`;\n        let result: T[] | HashMap[] = [];\n        this.http.get(url).subscribe(\n          (d: IEngineResponse | HashMap[]) => {\n            result =\n              d && d instanceof Array\n                ? d.map((i) => this.process(i))\n                : d && !(d instanceof Array) && d.results\n                ? (d.results as HashMap[])\n                : d && !(d instanceof Array) && !d.results \n                ? [d]\n                : [];\n          },\n          (e) => {\n            reject(e);\n            this._promises[key] = null;\n          },\n          () => {\n            resolve(result);\n            this.timeout(key, () => (this._promises[key] = null), cache);\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n  /**\n   * query function version -2 - returns observable instead of promise...\n   * Query the index of the API route associated with this service\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n   public queryObsr(query_params: HashMap = {}):Observable<any>{\n    let engine = false;\n    let cache = 1000;\n    /* istanbul ignore else */\n    if (query_params) {\n      engine = !!query_params.engine;\n      delete query_params.engine;\n    }\n    let query = toQueryString(query_params);\n    const key = `query|${query}`;\n    const url = `${this.route(engine)}${query ? '?' + query : ''}`;\n    return this.http.get(url).pipe(\n      map((d: IEngineResponse | HashMap[]) =>  this.processApiResult(d) ),\n      catchError(<T>(error: any, result?: T) => {\n        console.log(error);\n        return of(result as T);\n        })\n    );;\n  }\n\n\n  /**\n   * \n   * @param d \n   * @returns \n   */\n   processApiResult(d: IEngineResponse | HashMap[]): IEngineResponse | HashMap[]{\n    let result: IEngineResponse | HashMap[] =\n        d && d instanceof Array\n          ? d.map((i) => this.process(i))\n          : d && !(d instanceof Array) && d.results\n          ? (d.results as HashMap[])\n          : d && !(d instanceof Array) && !d.results \n          ? [d]\n          : [];\n    return result;\n  }\n\n  /**\n   * query function version -2 - returns observable instead of promise...\n   * Query the index of the API route associated with this service\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public queryRoomsForQR(query_params: HashMap = {}):Observable<any>{\n    let engine = false;\n    let cache = 1000;\n    /* istanbul ignore else */\n    if (query_params) {\n      engine = !!query_params.engine;\n      delete query_params.engine;\n    }\n    let query = toQueryString(query_params);\n    const key = `query|${query}`;\n    const url = `${this.route(engine)}${query ? '?' + query : ''}`;\n    return this.http.get(url);\n  }\n  \n  /**\n   * Query the API route for a sepecific item\n   * @param id ID of the item\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public show(id: string, query_params: HashMap = {}): Promise<T> {\n    let engine = false;\n    /* istanbul ignore else */\n    if (query_params) {\n      engine = !!query_params.engine;\n      delete query_params.engine;\n    }\n    const query = toQueryString(query_params);\n    const key = `show|${id}|${query}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<T>((resolve, reject) => {\n        const url = `${this.route(engine)}/${id}${query ? '?' + query : ''}`;\n        let result: T = null;\n        this.http.get(url).subscribe(\n          (d) => (result = this.process(d)),\n          (e) => {\n            reject(e);\n            this._promises.new_item = null;\n          },\n          () => {\n            resolve(result);\n            this.timeout(key, () => (this._promises[key] = null), 1000);\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n  /**\n   * Make post request for a new item to the service\n   * @param form_data Data to post to the server\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public add(form_data: HashMap, query_params: HashMap = {}): Promise<T> {\n    /* istanbul ignore else */\n    if (!this._promises.new_item) {\n      this._promises.new_item = new Promise<T>((resolve, reject) => {\n        const query = toQueryString(query_params);\n        const url = `${this.route(query_params.engine)}${query ? '?' + query : ''}`;\n        let result: T = null;\n        this.http.post(url, this.injectConcierge(form_data)).subscribe(\n          (d) => (result = this.process(d)),\n          (e) => {\n            reject(e);\n            this.analyticsEvent(`create-${this._name.toLowerCase()}-failed`);\n            this._promises.new_item = null;\n          },\n          () => {\n            resolve(result);\n            this.set('list', this.updateList(this.get('list'), [result]));\n            this.analyticsEvent(`create-${this._name.toLowerCase()}-success`);\n            this._promises.new_item = null;\n          }\n        );\n      });\n    }\n    return this._promises.new_item;\n  }\n\n  /**\n   * Perform API task for the given item ID\n   * @param id ID of the item\n   * @param task_name Name of the task\n   * @param form_data Map of data to pass to the API\n   * @param method Verb to use for request\n   */\n  public \n  task<U = any>(\n    id: string,\n    task_name: string,\n    form_data: HashMap = {},\n    method: 'post' | 'get' = 'post'\n  ): Promise<U> {\n    const query =  toQueryString(this.injectConcierge(form_data));\n    const key = `task|${id}|${task_name}|${query}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<U>((resolve, reject) => {\n        const post_data = { ...form_data, id, _task: task_name };\n        const url = `${this.route(false)}/${id}/${task_name}`;\n        let result: any;\n        const request =\n          method === 'post'\n            ? this.http.post(url, post_data)\n            : this.http.get(`${url}${query ? '?' + query : ''}`);\n        request.subscribe(\n          (d) => (result = d),\n          (e) => {\n            reject(e);\n            this.analyticsEvent(\n              `${this._name.toLowerCase()}-task-${task_name}-failed`,\n              id\n            );\n            delete this._promises[key];\n          },\n          () => {\n            resolve(result as U);\n            this.analyticsEvent(\n              `${this._name.toLowerCase()}-task-${task_name}-success`,\n              id\n            );\n            this.timeout(key, () => delete this._promises[key], 1000);\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n\n  /**\n   * V-2\n   * Perform API task for the given item ID\n   * @param id ID of the item\n   * @param task_name Name of the task\n   * @param form_data Map of data to pass to the API\n   * @param method Verb to use for request\n   */\n   public taskObsr<U = any>( \n    id: string, \n    task_name: string, \n    form_data: HashMap = {}, \n    method: 'post' | 'get' = 'post' ):Observable<any>{\n    const query =   toQueryString(this.injectConcierge(form_data));\n    let engine = false;\n    let cache = 1000;\n    const post_data = { ...form_data, id, _task: task_name };\n    const url = `${this.route(false)}/${id}/${task_name}`;\n    let result: any;\n\n    const request = method === 'post'\n      ? this.http.post(url, post_data)\n      : this.http.get(`${url}${query ? '?' + query : ''}`);\n    \n      return request;\n  }\n\n\n  /**\n   * Make put request for changes to the item with the given id\n   * @param id ID of the item being updated\n   * @param form_data New values for the item\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public update(id: string, form_data: HashMap, query_params: HashMap = {}): Promise<T> {\n    const key = `update|${id}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<T>((resolve, reject) => {\n        const query = toQueryString(this.injectConcierge(query_params));\n        const url = `${this.route(query_params.engine)}/${id}${query ? '?' + query : ''}`;\n        let result: T = null;\n        this.http.put(url, this.injectConcierge(form_data)).subscribe(\n          (d) => (result = this.process(d)),\n          (e) => {\n            reject(e);\n            this.analyticsEvent(`update-${this._name.toLowerCase()}-failed`, id);\n            this._promises[key] = null;\n          },\n          () => {\n            resolve(result);\n            this.set(\n              'list',\n              this.updateList(this.removeItem(this.get('list'), { id } as any), [\n                result\n              ])\n            );\n            this.analyticsEvent(`update-${this._name.toLowerCase()}-success`, id);\n            this._promises[key] = null;\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n\n  /**\n   * update function version -2 - returns observable instead of promise...\n   * @param id url id with respect to update api\n   * @param form_data data to be update \n   * @param should_inject_concierge common value to be set to add concierge: true to the query url and body\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n   public updateObsr(id: string, form_data: HashMap, should_inject_concierge: Boolean = false, query_params: HashMap = {}):Observable<any>{\n    const query = should_inject_concierge ? toQueryString(this.injectConcierge(query_params)) : false;\n    const url = `${this.route(query_params.engine)}/${id}${query ? '?' + query : ''}`;\n    const body = should_inject_concierge ? this.injectConcierge(form_data) : form_data;\n    \n    return this.http.put(url, body)\n      .pipe(\n          map((d: IEngineResponse | HashMap[]) =>  this.processApiResult(d) \n        ),\n        catchError(<T>(error: any, result?: T) => {\n          console.log(error);\n          this.analyticsEvent(`update-${this._name.toLowerCase()}-failed`, id);\n          return of(error as T);\n        })\n      );\n\n  }\n\n  /**\n   * update function version -2 - returns observable instead of promise...\n   * @param form_data data to be update \n   * @param should_inject_concierge common value to be set to add concierge: true to the query url and body\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n   public uploadSpacePhotos(apiSubRoute: string, form_data: HashMap, should_inject_concierge: Boolean = false, query_params: HashMap = {}):Observable<any>{\n    const query = should_inject_concierge ? toQueryString(this.injectConcierge(query_params)) : false;\n    const url = `${this.route(query_params.engine)}/${apiSubRoute}${query ? '?' + query : ''}`;\n    const body = should_inject_concierge ? this.injectConcierge(form_data) : form_data;\n\n    const token = sessionStorage.length ? JSON.parse(sessionStorage.getItem('OAUTH.params')).access_token : '';\n\n    const headers = new HttpHeaders({\n      'Authorization': `Bearer ${token}`,\n    });\n    \n  const requestOptions = { headers: headers };\n\n    // return this.httpClient.post(url, body, {\n    //       ...requestOptions \n    //   });\n\n    return this.http.post(url, body);\n\n  }\n\n  /**\n   * Make delete request for the given item\n   * @param id ID of item\n   */\n  public delete(id: string, q: HashMap = {}): Promise<void> {\n    const key = `delete|${id}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<void>((resolve, reject) => {\n        const query = toQueryString(q);\n        const url = `${this.route()}/${id}${query ? '?' + query : ''}`;\n        this.http.delete(url).subscribe(\n          (_) => null,\n          (e) => {\n            reject(e);\n            this._promises[key] = null;\n          },\n          () => {\n            this.set('list', this.removeItem(this.get('list'), { id } as any));\n            this._promises[key] = null;\n            resolve();\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n  /**\n   * Load initial data for the service\n   */\n  protected async load(): Promise<void> {\n  }\n\n  /**\n   * Post analytics event for this service\n   * @param action Name of the action to post\n   */\n  protected analyticsEvent(action: string, label?: string) {\n    // if (this.parent && this.parent.Analytics) {\n    //     this.parent.Analytics.track(this._name, { desc: `${this.parent.name.toLowerCase()}-${action}`, label });\n    // }\n  }\n\n  /**\n   * Convert raw API data into a valid API Object\n   * @param raw_item Raw API data\n   */\n  protected process(raw_item: HashMap): T {\n    return raw_item as T;\n  }\n\n  /**\n   * Update recorded list of items\n   * @param old_list Old list of items\n   * @param list List of updated items\n   * @param compareFn Function to compare items to remove duplicates\n   */\n  public updateList(\n    old_list: T[],\n    list: T[],\n    compareFn: (a: T, b: T) => boolean = this._compare\n  ): T[] {\n    /* istanbul ignore else */\n    if (!list || list.length === 0) {\n      return old_list;\n    }\n    const new_list: T[] = [];\n    const mixed_list = [...list, ...old_list];\n    /* istanbul ignore else */\n    if (!compareFn) {\n      compareFn = this._compare;\n    }\n    for (const item of mixed_list) {\n      const found = new_list.find((i) => compareFn(i, item));\n      /* istanbul ignore else */\n      if (!found) {\n        new_list.push(item);\n      }\n    }\n    return new_list;\n  }\n\n  /**\n   * Remove the given item from the given list\n   * @param list List of items\n   * @param item Item to remove\n   * @param compareFn Function to compare items\n   */\n  protected removeItem(list: T[], item: T, compareFn?: (a: T, b: T) => boolean) {\n    const new_list = [];\n    /* istanbul ignore else */\n    if (!compareFn) {\n      compareFn = this._compare;\n    }\n    list.forEach((i) => (compareFn(item, i) ? null : new_list.push(i)));\n    return new_list;\n  }\n}\n","import { SelectOption } from '../../../../ui/src/lib/options/select-option';\nimport { Building } from '../organisation/building.class';\nimport { Booking } from '../bookings/booking.class';\nimport { User } from '../users';\nimport { Space } from '../spaces';\nimport { SpaceBookingRuleOptions } from '../spaces/space.class';\nimport {\n    BookingFormData,\n} from './booking.form.data';\nimport { statusFromBookings } from '../bookings/booking.utilities';\nimport { rulesForSpace } from '../bookings/space.utilities';\nimport { SpaceStatus } from '../bookings/space.types';\nimport { SpaceFeatures } from '../spaces/space.class';\nimport { HashMap } from 'libs/base/src/lib/types.utilities';\n\nexport const spaceExtraFeatureToDisplayName = (feature: SpaceFeatures) => {\n    switch (feature) {\n        case SpaceFeatures.VideoConference:\n            return 'Video conference (VC)';\n        case SpaceFeatures.ConferencePhone:\n            return 'Conference phone';\n        case SpaceFeatures.WirelessContentSharing:\n            return 'Wireless content sharing';\n        case SpaceFeatures.FlipChart:\n            return 'Flip chart';\n        case SpaceFeatures.Glassboard:\n            return 'Glassboard';\n        case SpaceFeatures.ElectronicWhiteboard:\n            return 'Whiteboard';\n        case SpaceFeatures.ConferenceRoom:\n            return 'Conference';\n        case SpaceFeatures.TeamRoom:\n            return 'Team';\n        case SpaceFeatures.PartnerOffice:\n            return 'Partner';\n        case SpaceFeatures.PhoneBooth:\n            return 'Phone booth';\n        case SpaceFeatures.NaturalLight:\n            return 'Room with window only (natural light)';\n        case SpaceFeatures.BoardRoom:\n            return 'Boardroom room style';\n        case SpaceFeatures.CocktailRoom:\n            return 'Cocktail room style';\n        case SpaceFeatures.TheatreRoom:\n            return 'Theatre room style';\n        case SpaceFeatures.WorkshopRoom:\n            return 'Workshop room style';\n        case SpaceFeatures.UShapeRoom:\n            return 'U Shape room style';\n        case SpaceFeatures.Miscellaneous:\n            return 'Miscellaneous room style'\n        case SpaceFeatures.Catering:\n            return 'Rooms with catering';\n        // TODO: add any special display handling here.\n        default:\n            return feature;\n    }\n};\n\n\nexport const instantBookOption: SelectOption<any> = {\n    value: 'instant-book',\n    display: 'Listing you can book without waiting for a host approval',\n    shortDisplay: 'Instant book'\n};\nexport const instantBookOptions: SelectOption<any>[] = [\n    instantBookOption\n];\n\nexport const mapSpaceFeaturesToSelectOption = (f: SpaceFeatures): SelectOption<any> => {\n    const display = spaceExtraFeatureToDisplayName(f);\n    return ({\n        value: f,\n        display,\n        // Useful for long text, like that of the instant-book\n        // option.\n        //\n        // We do not expect this option object to be modified\n        // at any further point before it appears on screen -\n        // although that may change in future releases.\n        shortDisplay: display\n    });\n};\n\nexport const roomEquipmentRequiredOptions: SelectOption<any>[] = [\n    SpaceFeatures.VideoConference,\n    SpaceFeatures.ConferencePhone,\n    SpaceFeatures.WirelessContentSharing,\n    SpaceFeatures.FlipChart,\n    SpaceFeatures.Glassboard,\n    SpaceFeatures.ElectronicWhiteboard\n].map(mapSpaceFeaturesToSelectOption);\n\nexport const internalRoomTypeRequiredOptions: SelectOption<any>[] = [\n    SpaceFeatures.PartnerOffice,\n    SpaceFeatures.ConferenceRoom,\n    SpaceFeatures.TeamRoom,\n    SpaceFeatures.PhoneBooth\n].map(mapSpaceFeaturesToSelectOption);\n\nexport const externalRoomTypeRequiredOptions: SelectOption<any>[] = [\n    SpaceFeatures.ConferenceRoom,\n    SpaceFeatures.TeamRoom\n].map(mapSpaceFeaturesToSelectOption);\n\nexport const roomDetailsRequired: SelectOption<any>[] = [\n    SpaceFeatures.NaturalLight,\n    SpaceFeatures.BoardRoom,\n    SpaceFeatures.CocktailRoom,\n    SpaceFeatures.TheatreRoom,\n    SpaceFeatures.WorkshopRoom,\n    SpaceFeatures.UShapeRoom,\n    SpaceFeatures.Miscellaneous\n].map(mapSpaceFeaturesToSelectOption);\n\nexport const roomCateringAvailable: SelectOption<any>[] = [\n    SpaceFeatures.Catering,\n].map(mapSpaceFeaturesToSelectOption);\n\n/**\n * Defines the reason by which spaces are filtered out / missing.\n */\nexport enum SpaceFilterReason {\n    /**\n     * Spaces were shown and not all filtered out.\n     */\n    None = 'None',\n\n    /**\n     * If room filters are applied to the set of rooms,\n     * and rooms are available if not applied by filtering.\n     */\n    Filters = 'Filters',\n\n    /**\n     * We check office rules first to determine if its been filtered.\n     */\n    OfficeRules = 'OfficeRules',\n\n    /**\n     * Fallback as the end case if no results are found.\n     */\n    DateTime = 'DateTime',\n\n    /**\n     * If room is non-bookable in the system\n     */\n    NonBookable = 'NonBookable'\n}\n\nexport interface FilteredSpaces {\n    spaces: Space[] | undefined;\n    reason: SpaceFilterReason;\n    statusMap: HashMap<SpaceStatus>;\n    specificReason?:SpaceFilterReason;\n}\n\n/**\n * Filter spaces by filters locally. TBD in the future for real API pagination.\n *\n * @param formFilters - the set of filters to apply on the list of spaces.\n * @param spaces - the list of spaces to filter\n * @param activeForm - the landing page set of filters.\n * @param buildings - the list of buildings loaded, used to retrieve building-specific booking rules.\n * @param currentUser - the current user\n */\nexport const filterSpacesByAppliedFilters = (\n    formFilters: SelectOption<any>[],\n    spaces: Space[] | undefined, // the resultshere are raw JSON Spaces, not an array of the Space class\n    activeForm: BookingFormData,\n    buildings: Building[] = [],\n    currentUser: User | undefined): FilteredSpaces => {\n    const instantBook: boolean = formFilters.some(f => f.value === instantBookOption.value);\n    const onlyCatering: boolean  = formFilters.some(f => f.value === SpaceFeatures.Catering);\n    // Drop incompatible spaces. If no filters were given, just return the array unchanged.\n    const featureFilters = formFilters.filter(filter => ![instantBookOption.value, SpaceFeatures.Catering].includes(filter.value));\n    const formFiltersEmpty = featureFilters.length === 0;\n    \n    // R--- refactor activeForm? Only after forms can handle dateTz\n    // Blocked by date time input refactor\n    const options: SpaceBookingRuleOptions = {\n        duration: activeForm.duration,\n        host: currentUser,\n        dateTz: activeForm.dateTz,\n    };\n    let rulesCount = 0;\n    let ruleReason = '';\n    let excludedByFiltersCount = 0;\n    const statusMap: HashMap<SpaceStatus> = {};\n    console.group();\n    const filteredSpaces = spaces?.map(space => space instanceof Space ? space : new Space(space)).filter(raw_space => {\n        const space = new Space(raw_space); // Construct the full fledged space\n        const building = buildings.find(b => space.zones.includes(b.id));\n        const rules = rulesForSpace({\n            time: options.dateTz.ms,\n            duration: options.duration,\n            user: options.host,\n            rules: building?.booking_rules,\n            space\n        });\n        ruleReason = rules.reason;\n        let valid = !rules.hide;\n        if (!valid) {\n            rulesCount++;\n            return false;\n        }\n        \n\n        // Check for all the form filters ( except 'catering' )\n        const hasAllFeatures = featureFilters.every(f => space.featuresArray.includes(f.value));\n        const canBook = instantBook ? space.bookable : true;\n        const matchesType = activeForm?.bookingType?.value === 'allRooms' \n                            ? true \n                            : space?.internal_or_external?.length \n                            ? space.internal_or_external === activeForm?.bookingType?.value \n                            : true;\n        valid = valid && matchesType && (formFiltersEmpty || hasAllFeatures) && canBook;\n        let hasCatering = building?.has_catering;\n        if (space?.has_catering === false) {\n            hasCatering = false;\n        }      \n        // need the room catering to override. \n        if (onlyCatering && !hasCatering) {\n            valid = false;\n            console.log('Excluded by Catering');\n        }\n\n        // count this space if the only reason it can't be shown is because one of the filters excluded it\n        if (!hasAllFeatures) {\n            valid = false;\n            console.log('Excluded by Status');\n        }\n\n        const status = statusFromBookings(\n            space.bookings.length ? space.bookings.map(b => new Booking(b)) : space.settings.bookings.map(b => new Booking(b)),\n            space.bookable && !rules.hide,\n            !rules.auto_approve,\n            activeForm.dateTz,\n            space\n        );\n\n        // only compute room availability here right now if instant book option is chosen and room still valid.\n        if (instantBook && valid) {\n            valid = status.status === SpaceStatus.Available;\n            if (!valid) console.group('Excluded by Status');\n        }\n\n        // cache space status\n        if (valid) {\n            statusMap[space.id] = status.status;\n        } else {\n            excludedByFiltersCount++;\n        }\n        console.log('Valid:', valid);\n        return valid;\n    });\n\n    console.groupEnd();\n    let reason, specificReason = SpaceFilterReason.None;\n    console.log('Spaces:', filteredSpaces?.length, excludedByFiltersCount, rulesCount, ruleReason)\n    if (filteredSpaces?.length === 0) {\n        if (excludedByFiltersCount > 0 && (!formFiltersEmpty || onlyCatering)) {\n            reason = SpaceFilterReason.Filters;\n        } else if (rulesCount > 0) {\n            reason = SpaceFilterReason.OfficeRules;\n        }\n        else {\n            reason = SpaceFilterReason.DateTime;\n        }\n\n        if (ruleReason === SpaceFilterReason.OfficeRules) {\n            specificReason = SpaceFilterReason.OfficeRules;\n        } \n    }\n\n    return { spaces: filteredSpaces, reason, statusMap, specificReason };\n};\n","import { BookingFormData } from './booking.form.data';\nimport {\n    createAction,\n    props\n} from '@ngrx/store';\nimport { Payload } from '../../../../loading/src/lib/loading.actions';;\nimport { SelectOption } from '../../../../ui/src/lib/options/select-option';\n\n\nexport const storeBookingFormData = createAction('[BookingForm] Store Form Data',\n    props<Payload<Partial<BookingFormData>>>());\n\nexport const clearBookingFormData = createAction('[BookingForm] Clear Form Data');\n\nexport const storeRoomFilters = createAction('[BookingForm] Store Room Filters',\n    props<Payload<SelectOption<any>[]>>());\n\nexport const clearRoomFilters = createAction('[BookingForm] Clear Room Filters');\n\nexport const openBookingSurvey = createAction('[BookingSurvey] Open Survey Modal');\n","import { SelectOption } from '../../../../ui/src/lib/options/select-option';\nimport { RoomQueryOptions } from '../../../../rooms/src/lib/rooms.types';\nimport { User } from '../users/user.class';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\nimport { DaysOfWeek, RecurrencePeriod } from '../recurrence/recurrence.utils';\nimport { Building } from '../organisation';\n\nexport const DEFAULT_BOOKING_DURATION = 30;\n\nexport const internalBookingTypeOption = {\n    value: 'internal',\n    display: 'Internal',\n};\n\nexport const allBookingTypeOption = {\n    value: 'allRooms',\n    display: 'All Rooms',\n};\n\nexport const bookingTypeOptions: SelectOption<string>[] = [\n    internalBookingTypeOption,\n    {\n        value: 'external',\n        display: 'External',\n    }\n];\n\nexport const defaultRoomSizeOption = {\n    value: '2',\n    display: '3-9 People',\n};\n\nexport const roomSizeOptions: SelectOption<string>[] = [\n    {\n        value: '1',\n        display: '1-2 People',\n    },\n    defaultRoomSizeOption,\n    {\n        value: '3',\n        display: '10+ People',\n    }\n];\n\nexport const roomSizeOptionsKiosk: SelectOption<string>[] = [\n   ...roomSizeOptions,\n    {\n        value: '4',\n        display: 'All Rooms',\n    },\n];\n\nexport const roomCapacityToValue = (roomSize: string): number => {\n    switch (roomSize) {\n        case '1':\n            return 1;\n        case '2':\n            return 3;\n        case '3':\n            return 10;\n        case '4':\n            return 3;\n    }\n};\n\nexport const roomMaxCapacityToValue = (roomSize: string): number => {\n    switch (roomSize) {\n        case '1':\n            return 2;\n        case '2':\n            return 9;\n        default:\n            return null;\n    }\n};\n\nexport interface BookingFormData {\n    // R--- off the rails, define these \"any's\"\n    id?: string;\n    location: SelectOption<string>[];\n    dateTz: DateTZ;\n    /**\n     * Duration, in minutes.\n     */\n    duration: number;\n    bookingType: SelectOption<any>;\n    roomSize: SelectOption<any>;\n    selectedRoom?: any;\n    organiser?: SelectOption<string>;\n    title?: string;\n    attendees?: any[];\n    code?: string;\n    notes?: string;\n    head_count?: number;\n    creator?: User;\n    company?: any[];\n    //Recurrence fields\n    recurrence_period?: RecurrencePeriod;\n    recurrence_interval?: number;\n    recurrence_endTz?: DateTZ;\n    recurrence_count?: number;\n    recurrence_starts?: Array<DateTZ>;\n    recurrence_exceptions?: Array<number>; //SHOULD BE DATETZ\n    recurrence_days?: Array<DaysOfWeek>;\n    timezone?: string;\n    offset?: number;\n    buildings?: Building[];\n}\n\n/**\n * Converts form data into API query parameters.\n */\nexport const roomFormDataToQuery = (\n    data: BookingFormData\n): RoomQueryOptions => {\n    // remove all buildings chip from query\n    const filteredLocationIds = data?.location\n        .filter((l) => l.groupChild)\n        .map((l) => l.value)\n        .join(',');\n    return {\n        dateTz: data?.dateTz,\n        duration: data?.duration,\n        locations: filteredLocationIds,\n        capacity: roomCapacityToValue(data?.roomSize?.value),\n        capacity_max: roomMaxCapacityToValue(data?.roomSize?.value),\n    };\n};\n","import { BookingFormState } from './booking.form.types';\nimport {\n    DEFAULT_BOOKING_DURATION,\n    defaultRoomSizeOption,\n    internalBookingTypeOption\n} from './booking.form.data';\nimport { DateNow } from '@mckinsey-converge/date-tz';\n\nconst now = DateNow(new Date())\n\nexport const defaultTestBookingForm = (): BookingFormState => ({\n    activeForm: {\n        dateTz: now,\n        duration: 2 * DEFAULT_BOOKING_DURATION,\n        location: [],\n        bookingType: internalBookingTypeOption,\n        roomSize: defaultRoomSizeOption\n    },\n    activeFormFilters: []\n});\n","import { createSelector } from '@ngrx/store';\nimport {\n    RoomStoreState\n}  from '../../../../rooms/src/lib/rooms.types';\nimport {\n    loadLaterThatDayResults,\n    loadNextDayResults,\n    loadRoomsForResults,\n    roomStateSelector,\n    loadByIdResults,\n    loadDiffSizeResults,\n    loadRoomsForResultsMap\n} from '../../../../rooms/src/lib/rooms.actions';\nimport {\n    loadHomepageBookingsResults,\n    loadUpcomingBookingsResults,\n    loadPastBookingsResults,\n    loadCancelledBookingsResults,\n    loadBookingByIdResults,\n    bookingStateSelector\n} from '../../../../bookings/src/lib/bookings.actions';\nimport { Building } from '../organisation/building.class';\nimport { BuildingStoreState } from '../../../../buildings/src/lib/buildings.types';\nimport { selectLoadBuildingsSuccess } from '../../../../buildings/src/lib/buildings.actions';\nimport { Space } from '../spaces/space.class';\nimport { User } from '../users/user.class';\nimport { selectCurrentUser } from '../../../../user/src/lib/user.actions';\nimport { UserStoreState } from '../../../../user/src/lib/user.types';\nimport { LoadingModel } from '../../../../loading/src/lib/loading.model';\nimport { SelectOption } from '../../../../ui/src/lib/options/select-option';\n\nimport {\n    SpaceFilterReason,\n    filterSpacesByAppliedFilters,\n    FilteredSpaces\n} from './booking-filter.utils';\nimport {\n    BookingFormData,\n    internalBookingTypeOption,\n} from './booking.form.data';\nimport {\n    BookingFormState,\n    BookingStoreState,\n} from './booking.form.types';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\n\n\n\nexport const selectBookingFormsData =\n    (state: BookingStoreState | RoomStoreState | BuildingStoreState | UserStoreState) =>\n        (state as any).bookingForm as BookingFormState;\n\nexport const selectActiveForm = createSelector(selectBookingFormsData, state => {\n    // Recreate because serialized form dateTz doesn't have DateTZ class methods\n    if (!state.activeForm?.dateTz) {\n        return state.activeForm\n    }\n    const { date, is_local_tz, building_tz} = state.activeForm?.dateTz;\n    return {\n        ...state.activeForm,\n        dateTz: new DateTZ({ date: date.valueOf(), is_local_tz, building_tz }),\n    }\n});\n\nexport const selectBookingType = createSelector(selectActiveForm,\n    (form) => form?.bookingType);\n\nexport const selectBookingLocations = createSelector(selectActiveForm,\n    (form) => (form?.location || []).filter(f => !f.groupHeader));\n\nexport const selectIsInternal = createSelector(selectBookingType,\n    (type) => type?.value === internalBookingTypeOption.value);\n\nexport const selectFormFilters = createSelector(selectBookingFormsData,\n    (state) => state.activeFormFilters || []);\n\nconst selectRoomResultsFromState = createSelector(roomStateSelector,\n    loadRoomsForResults.selectors.model);\n    \nconst selectRoomResultsFromState_map = createSelector(roomStateSelector,\n    loadRoomsForResultsMap.selectors.model);\n\nconst selectLaterThatDayResultsFromState = createSelector(roomStateSelector,\n    loadLaterThatDayResults.selectors.model);\nconst selectNextDayResultsFromState = createSelector(roomStateSelector,\n    loadNextDayResults.selectors.model);\nconst selectByIdResultsFromState = createSelector(roomStateSelector,\n    loadByIdResults.selectors.model);\nconst selectDiffSizeResultsFromState = createSelector(roomStateSelector,\n    loadDiffSizeResults.selectors.model);\n\nexport const selectHomepageBookingsResultsFromState = createSelector(bookingStateSelector,\n        loadHomepageBookingsResults.selectors.model);\nexport const selectUpcomingBookingsResultsFromState = createSelector(bookingStateSelector,\n    loadUpcomingBookingsResults.selectors.model);\nexport const selectPastBookingsResultsFromState = createSelector(bookingStateSelector,\n        loadPastBookingsResults.selectors.model);\nexport const selectCancelledBookingsResultsFromState = createSelector(bookingStateSelector,\n        loadCancelledBookingsResults.selectors.model);\nexport const selectBookingByIdResultsFromState = createSelector(bookingStateSelector,\n        loadBookingByIdResults.selectors.model);\n\n/**\n * Wraps {@link filterSpacesByAppliedFilters} with {@link LoadingModel} interop.\n * This will only filter data if there is data to filter, and returns a success {@link LoadingModel}.\n */\nconst filterSpacesByAppliedFiltersIfSuccess = (\n    results: LoadingModel<Space[]>,\n    formFilters: SelectOption<any>[],\n    activeForm: BookingFormData,\n    buildings: Building[] | undefined,\n    currentUser: User | undefined): LoadingModel<FilteredSpaces> => {\n    const data = results.optionalSuccess;\n\n    // don't filter model if no success found\n    return !activeForm ? results.mutate({\n        spaces: data, // the result here is a raw JSON Space, not the Space class\n        reason: SpaceFilterReason.None,\n        statusMap: {}\n    }) : results.mutate(\n        filterSpacesByAppliedFilters(formFilters, data, activeForm, buildings || activeForm.buildings, currentUser));\n};\n\nexport const selectFilteredResults = createSelector(selectRoomResultsFromState,\n    selectFormFilters,\n    selectActiveForm,\n    selectLoadBuildingsSuccess,\n    selectCurrentUser,\n    filterSpacesByAppliedFiltersIfSuccess);\n\nexport const selectMapFilteredResults = createSelector(selectRoomResultsFromState_map,\n    selectActiveForm,\n    selectLoadBuildingsSuccess,\n    selectCurrentUser,\n    (results, activeForm, buildings, currentUser) => filterSpacesByAppliedFiltersIfSuccess(results, [], activeForm, buildings, currentUser));\n\nexport const selectFilteredLaterDayResults = createSelector(selectLaterThatDayResultsFromState,\n    selectFormFilters,\n    selectActiveForm,\n    selectLoadBuildingsSuccess,\n    selectCurrentUser,\n    filterSpacesByAppliedFiltersIfSuccess);\n\nexport const selectFilteredNextDayResults = createSelector(selectNextDayResultsFromState,\n    selectFormFilters,\n    selectActiveForm,\n    selectLoadBuildingsSuccess,\n    selectCurrentUser,\n    filterSpacesByAppliedFiltersIfSuccess);\n\n    \nexport const selectFilteredByIdResults = createSelector(selectByIdResultsFromState,\n    selectActiveForm,\n    selectLoadBuildingsSuccess,\n    selectCurrentUser,\n    (results, activeForm, buildings, currentUser) => filterSpacesByAppliedFiltersIfSuccess(results, [], activeForm, buildings, currentUser));\n\nexport const selectFilteredDiffSizeResults = createSelector(selectDiffSizeResultsFromState,\n    selectFormFilters,\n    selectActiveForm,\n    selectLoadBuildingsSuccess,\n    selectCurrentUser,\n    filterSpacesByAppliedFiltersIfSuccess);\n    \n/**\n * Maps selected options by loaded buildings.\n */\nexport const selectSelectedBuildingOptions = createSelector(\n    selectBookingLocations,\n    selectLoadBuildingsSuccess,\n    (locations, buildings) => (locations\n        .map(l => buildings?.find(b => b.id === l.value))\n        .filter(f => !!f) as Building[])\n);\n\n","import { Building, BuildingCity } from '../organisation/building.class';\nimport { Booking } from '../bookings/booking.class';\nimport { BuildingLevel } from '../organisation/level.class';\nimport { Space } from '../spaces/space.class';\nimport { SpacesService } from '../spaces/spaces.service';\nimport {\n    timezoneDisplay,\n    timezoneNameToDate,\n    unique,\n    ImageDirective,\n} from '@mckinsey-converge/base';\nimport { SelectOption } from '../../../../ui/src/lib/options/select-option';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n/**\n * If more than 3 are selected, we truncate location display.\n */\nconst MAX_ABBREV_LOCATIONS = 3;\n\nexport const mapBuildingToSelectOption = (\n    city: string,\n    building: Building\n): SelectOption<any> => ({\n    display: `${building.name} ${timezoneDisplay(\n        timezoneNameToDate(building.timezone)\n    )}`,\n    dropdownOverride: `${building.code}-${building.name}, ${building.address}`,\n    value: building.id,\n    groupId: city,\n    groupChild: true,\n    shortDisplay: `${building.name} ${timezoneDisplay(\n        timezoneNameToDate(building.timezone)\n    )}`,\n    meta: { building, city },\n});\n\nexport const mapCityToAllSelectOption = (\n    city: BuildingCity\n): SelectOption<any> => ({\n    display: `${city.name} (All Offices) ${timezoneDisplay(\n        timezoneNameToDate(city.timezone)\n    )}`,\n    value: city.name,\n    groupHeader: true,\n    groupId: city.name,\n    shortDisplay: `${city.name} (All Offices) ${timezoneDisplay(\n        timezoneNameToDate(city.timezone)\n    )}`,\n    meta: { city },\n});\n\n/**\n * Flattens a map of {@link BuildingCity} to {@link Building} array into a list of {@link SelectOption}.\n * @param grouped The grouping\n */\nexport const flattenDisplayOffices = (\n    grouped: Map<BuildingCity, Building[]>\n) => {\n    const options: SelectOption<any>[] = [];\n    grouped.forEach((value, key) => {\n        options.push(mapCityToAllSelectOption(key));\n        value.forEach((b) =>\n            options.push(mapBuildingToSelectOption(key.name, b))\n        );\n    });\n    return options;\n};\n\n/**\n * This method will either add or remove a selected option from the selectedOptions list based on\n * these conditions:\n * 1. If the option EXISTS in the list AND is a groupHeader, de-select all of its children.\n * 2. If the option EXISTS in the list AND is a groupChild, remove it and its associated header from the list.\n * 3. If the option does NOT EXIST in the list AND is a groupHeader, select all other children.\n * 4. If the option does NOT EXIST in the list AND is a groupChild, add it to the list.\n *\n * Special note regarding item 4:\n * 4a. If that selection completes the children selection, select its associated header as well.\n */\nexport const toggleSelectedByGroup = (\n    options: SelectOption<any>[],\n    selectedOptions: SelectOption<any>[],\n    option: SelectOption<any>\n) => {\n    if (selectedOptions.find((s) => s.value === option.value)) {\n        return selectedOptions.filter((s) => {\n            let filter = s.value !== option.value;\n            // if group header, also remove any option that is the child of it.\n            if (option.groupHeader) {\n                filter =\n                    filter &&\n                    (!s.groupChild ||\n                        (s.groupChild && s.groupId !== option.groupId));\n            } else if (option.groupChild) {\n                // if child removing, remove the associated header.\n                filter =\n                    filter &&\n                    (!s.groupHeader ||\n                        (s.groupHeader && s.groupId !== option.groupId));\n            }\n            return filter;\n        });\n    }\n    // option does NOT EXIST\n    // if adding header, add the other children to the selected list, ensuring no dupes.\n    if (option.groupHeader) {\n        const toSelect = options.filter(\n            (v) =>\n                v.groupChild &&\n                v.groupId === option.value &&\n                !selectedOptions.find((selected) => selected.value === v.value)\n        );\n        return [...selectedOptions, option, ...toSelect];\n    }\n    // add group child, add the group header if all satisfied\n    const newGroup = [...selectedOptions, option];\n\n    // check if we have selected all children from options by filtering down by city and checking if\n    // they're in the selected options list.\n    const remainingChildrenInGroup = options.filter(\n        (o) =>\n            o.groupChild &&\n            o.groupId === option.groupId &&\n            !newGroup.find((ng) => ng.value === o.value)\n    );\n    // if we dont have remaining children, add the group\n    if (remainingChildrenInGroup.length === 0) {\n        return [\n            ...newGroup,\n            options.find((o) => o.groupHeader && o.groupId === option.groupId),\n        ];\n    }\n    return newGroup;\n};\n\n/**\n * If the list of locations are larger than {@link MAX_ABBREV_LOCATIONS}, then truncate\n * and display the remaining count.\n */\nexport const truncateLocationList = (\n    locations: readonly SelectOption<any>[]\n): string => {\n    // comma separate the locations\n    let truncatedLocations = [...locations];\n    const shouldTruncate = locations.length > MAX_ABBREV_LOCATIONS;\n    if (shouldTruncate) {\n        truncatedLocations = truncatedLocations.splice(0, MAX_ABBREV_LOCATIONS);\n    }\n    let display = truncatedLocations\n        .map((l) => l.shortDisplay || l.display)\n        .join(', ');\n    if (shouldTruncate) {\n        display += `...(${locations.length})`;\n    }\n    return display;\n};\n\nexport const mapBuildingLevelToOption = (\n    level?: BuildingLevel\n): SelectOption<any> =>\n    level\n        ? {\n              value: level.id,\n              display: level.name,\n          }\n        : undefined;\n\n/**\n * Returns all levels included with the building, deduped.\n * @param buildings\n */\nexport const flattenBuildingsWithLevels = (buildings: Building[]) => {\n    const flattenedLevels = unique(\n        buildings.reduce((next: BuildingLevel[], building: Building) => {\n            next.push(...building.levels);\n            return next;\n        }, []),\n        'id'\n    );\n    return {\n        flattenedLevels,\n        buildings,\n    };\n};\n\n/** Gets route to image placeholder if room image isn't found */\n\nexport const placeholderRoute = (num: number): string => {\n    let index: number;\n    if (num <= 3) {\n        index = num;\n    } else if (num % 3 === 0) {\n        index = 3;\n    } else {\n        index = 1;\n    }\n    return `assets/img/rooms/placeholder-${index}.png`;\n};\n\n/**\n * Method takes the rootFolderURL and fileSlug to create an array of three images\n * that should exist.  If a room image exists, it replaces the placehoder image.\n */\nexport const setupRoomImages = (\n    componentReference: ImageDirective,\n    image_positions: number[],\n    rootFolderURL: string,\n    fileSlug: string,\n    imagesLoaded: boolean = false\n): void => {\n    let foundImages: any[] = image_positions.map((i) =>\n        i ? { path: placeholderRoute(i) } : false\n    );\n    image_positions.forEach((n) => {\n        const desiredImageName = `${rootFolderURL}${fileSlug}-part-${n}.png`;\n        const desiredImage = location.pathname.includes('concierge') ?  `${location.origin}/staff/${desiredImageName}` : desiredImageName;\n        if (!imagesLoaded) {\n            const tester = new Image();\n            tester.onload = () => {\n                // Will never run on unit test\n                foundImages[n - 1] = { path: desiredImage };\n                componentReference.foundImages = [...foundImages.slice()];\n                componentReference?.loadImages && componentReference?.loadImages.next([...foundImages.slice()]);\n            };\n            tester.src = desiredImage;\n        }\n\n        // Force valid image output on unit test\n        if (imagesLoaded) {\n            foundImages[n - 1] = { path: desiredImage };\n            componentReference.foundImages = foundImages.slice();\n        }\n    });\n};\n\nexport const bookingStatusDetails = (booking: Booking) => {\n    const now = DateNow(new Date());\n    let image = '';\n    let text = '';\n    let title = '';\n\n    if (booking?.status) {\n        const status = now > booking.endDateTz ? 'expired' : booking.status;\n        switch (status) {\n            case 'unavailable':\n                image = 'assets/icon/booking_cancelled.svg';\n                title = 'Unavailable';\n                text = 'Unavailable';\n                break;\n            case 'declined':\n                image = 'assets/icon/booking_cancelled.svg';\n                title = 'Cancelled';\n                text = 'Cancelled';\n                break;\n            case 'cancelled':\n                image = 'assets/icon/booking_cancelled.svg';\n                title = 'Cancelled';\n                text = 'Cancelled';\n                break;\n            case 'expired':\n                image = 'assets/icon/booking_expired.svg';\n                title = 'Expired';\n                text = 'Expired';\n                break;\n            case 'tentative':\n                image = 'assets/icon/booking_pending.svg';\n                title = 'Requested';\n                text = 'Pending';\n                break;\n            case 'accepted':\n                image = 'assets/icon/booking_confirmed.svg';\n                title = 'Confirmed';\n                text = 'Confirmed';\n                break;\n            case 'approved':\n                image = 'assets/icon/booking_confirmed.svg';\n                title = 'Confirmed';\n                text = 'Confirmed';\n                break;\n            default:\n                // TODO\n                image = 'assets/icon/booking_expired.svg';\n                title = 'Expired';\n                text = 'Expired';\n                break;\n        }\n    }\n    return { text, title, image };\n};\n\nexport const roomHasCateringHours = (building: Building, space: Space) => {\n    let hasCatering = building\n        ? building.has_catering && building.catering_hours\n        : false;\n    // Room catering status as false overrides building status\n    if (space?.has_catering === false) {\n        hasCatering = false;\n    }\n    return hasCatering;\n};\n\nexport const cateringAllowed = (booking: Booking, building: Building) => {\n    const status = bookingStatusDetails(booking);\n    const disallowedStatus = ['declined', 'cancelled', 'expired'].includes(\n        status.text\n    );\n    const opens = building?.catering_hours?.start;\n    const closed = building?.catering_hours?.end;\n\n    if (disallowedStatus) {\n        return false;\n    }\n\n    if (typeof opens === 'undefined' || typeof closed === 'undefined') {\n        return false;\n    }\n\n    // Catering time could be a decimal so convert to a date\n    const openMinutes = opens * 60;\n    const closeMinutes = closed * 60;\n\n    const startOfDay = booking.startDateTz.startOfValue('day');\n    const cateringOpenTime = startOfDay.addValue({ minutes: openMinutes });\n    const cateringCloseTime = startOfDay.addValue({ minutes: closeMinutes });\n\n    if (\n        cateringOpenTime.ms <= booking.startDateTz.ms ||\n        cateringCloseTime.ms > booking.startDateTz.ms\n    ) {\n        // Booking ends before catering opens\n        if (booking.endDateTz.ms <= cateringOpenTime.ms) {\n            return false;\n        }\n        // Booking starts after catering closes\n        if (booking.startDateTz.ms > cateringCloseTime.ms) {\n            return false;\n        }\n\n        // Start time is OK\n        if (booking.startDateTz.ms > DateNow(new Date()).ms) {\n            // Due to COVID, no orders are available once a meeting begins.\n            return true;\n        }\n    }\n\n    return false;\n};\n\nexport const checkCollisions = (\n    service: SpacesService,\n    booking: Booking\n): Promise<boolean> => {\n    return new Promise((resolve, reject) => {\n        service\n            .available(\n                {\n                    room_ids: booking.space.id,\n                    dateTz: booking.startDateTz,\n                    duration: booking.duration,\n                    setup: booking.setup[booking.space.email],\n                    breakdown: booking.breakdown[booking.space.email],\n                    hide_bookings: false,\n                },\n                null,\n                false\n            )\n            .then(\n                (list) => {\n                    const space = list.length ? list[0] : null;\n                    if (space) {\n                        if (!space.bookable) return reject('Has conflict');\n                        const setup = booking?.setup[space?.email] || 0;\n                        const breakdown = booking?.breakdown[space?.email] || 0;\n                        const start_time = booking?.startDateTz.seconds - setup;\n                        const end_time = booking.endDateTz.seconds + breakdown;\n\n                        const bookings = space.settings.bookings;\n                        console.log('Bookings:', bookings);\n                        // Compare the existing bookings to see if any truely conflict.\n                        if (bookings.length) {\n                            const has_conflict = bookings.find(bkn => {\n                                const b_setup = bkn.setup[space.email] || 0;\n                                const b_breakdown = bkn.setup[space.email] || 0;\n                                const start = (bkn.start_epoch || bkn.start) - b_setup;\n                                const end = (bkn.end_epoch || bkn.end) + b_breakdown;\n                                return (\n                                    (end_time > start && end_time <= end) || // Booking ends during the meeting\n                                    (start_time >= start && start_time < end) || // Booking starts during a meeting\n                                    (start_time <= start && end_time >= end) // Booking overlaps entire meeting\n                                ) && bkn.id !== booking.id\n\n                            });\n                            // Conflicts found, reject\n                            if (has_conflict) return reject('has booking conflict');\n                        }\n                        return resolve(space.bookable);\n                    }\n                    reject('space not found');\n                },\n                () => reject('available error')\n            );\n    });\n};\n\nexport const getStatusErrorMessage = (status?: number) => {\n    let msg = '';\n    switch (status) {\n        case 403:\n            msg = 'Your do not have permission to update this booking.';\n            break;\n        case 409:\n            msg = 'Sorry, your booking time conflicts with another booking.';\n            break;\n        default:\n            msg = 'Your booking failed to update, please try again';\n    }\n    return msg;\n};\n","export * from './room-results/room-results.viewmodel'\nexport * from './booking-filter.utils'\nexport * from './booking.form.actions'\nexport * from './booking.form.data'\nexport * from './booking.form.spec-helpers'\nexport * from './booking.form.types'\nexport * from './booking.selectors'\nexport * from './booking.utils'","import { Space } from '../../spaces/space.class';\nimport { BuildingLevel } from '../../organisation/level.class';\nimport { Building } from '../../organisation/building.class';\n\nexport class RoomResultsViewModel {\n\n    public levelDisplay: string;\n    public title: string;\n    public office: string;\n    public capacity: string;\n\n    constructor(public space: Space,\n                public level?: BuildingLevel,\n                public building?: Building) {\n\n        this.levelDisplay = `Level ${this.level?.short_name}`;\n        this.title = this.space.local_name;\n        this.office = this.building ? `(${this.building?.code}) ${this.building?.name}` : '';\n        this.capacity = `Capacity: ${this.space.capacity} people`;\n    }\n}\n\n/**\n * For each result from results, we find its level and building from the lists.\n */\nexport const mapResultsToViewModels = (results: Space[],\n                                       flattenedLevels: BuildingLevel[],\n                                       buildings: Building[]): RoomResultsViewModel[] =>\n    results.map((r: Space) => {\n        const level = flattenedLevels.find(l => r.zones.includes(l.id));\n        const building = buildings.find(b => r.zones.includes(b.id));\n        return new RoomResultsViewModel(\n            r,\n            level,\n            building\n        );\n    });\n","import { Injectable, NgZone } from '@angular/core';\nimport { BehaviorSubject, combineLatest, of, Observable } from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    filter,\n    first,\n    map,\n    shareReplay,\n    switchMap,\n} from 'rxjs/operators';\nimport { BaseClass } from '@mckinsey-converge/base';\nimport { replaceBookings, timePeriodsIntersect } from './booking.utilities';\nimport { SpacesService } from '../spaces/spaces.service';\nimport { Booking } from '../bookings/booking.class';\nimport { Space } from '../spaces/space.class';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { OrganisationService } from '../organisation/organisation.service';\n\nexport type BookingType =\n    | 'internal'\n    | 'client'\n    | 'external'\n    | 'setup'\n    | 'training'\n    | 'interview'\n    | 'declined';\n\nexport interface BookingFilters {\n    /** List of zone ids to get bookings for */\n    zone_ids?: string[];\n    space_emails?: string[];\n    hide_type?: BookingType[];\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class BookingStateService extends BaseClass {\n    /** List of bookings */\n    private _poll = new BehaviorSubject<boolean>(false);\n    /** List of bookings */\n    private _long_poll = new BehaviorSubject<'month' | ''>('');\n    private _long_poll_week = new BehaviorSubject<'week' | ''>('');\n    /** List of bookings */\n    private _bookings = new BehaviorSubject<Booking[]>([]);\n    /** List of meeting count per date */\n    public _noOfMeetings = new BehaviorSubject<{}>({});\n    /** Filter details for bookings */\n    private _filters = new BehaviorSubject<BookingFilters>({});\n    /** Currently active date */\n    private _dateTz = new BehaviorSubject<DateTZ>(DateNow(new Date()));\n    /** Currently displayed zone */\n    private _zone = new BehaviorSubject<string>(' ');\n    /** Whether booking data is being loaded */\n    private _loading = new BehaviorSubject<boolean>(false);\n    /** Observable for filter and booking list changes */\n    private _state = combineLatest(\n        this._bookings,\n        this._filters,\n        this._dateTz,\n        this._zone\n    );\n\n    /** Observable for list of bookings */\n    public readonly bookings = this._bookings.asObservable();\n    /** Observable for active date */\n    public readonly dateTz = this._dateTz.asObservable();\n    /** Observable for active zone */ // R-- zone was this._date.asObservable(); this looks like a mistake but it exists from the beginning of time\n    public readonly zone = this._dateTz.asObservable();\n    /** Observable for loading state of bookings */\n    public readonly loading = this._loading.asObservable();\n\n    public get booking_date() {\n        // When this class is initialized this._dateTz is local timezone\n        return this._dateTz.value;\n    }\n\n    public get timezone() {\n        return localStorage.getItem('CONCIERGE.timezone');\n    }\n\n    /** Obsevable for filtered list of bookings */\n    public readonly filtered = this._state.pipe(\n        map((state) => {\n            const bdTz = this.timezone\n                ? new DateTZ({\n                      date: this.booking_date.ms,\n                      is_local_tz: false,\n                      building_tz: this.timezone,\n                  })\n                : this.booking_date;\n            const startTz = bdTz.startOfValue('day');\n            const endTz = startTz.addValue({}).endOfValue('day');\n            return this.filterBookings(startTz, endTz);\n        }),\n        shareReplay(1)\n    );\n\n    /** Obsevable for filtered list of bookings of the active week */\n    public readonly filtered_week = this._state.pipe(\n        map(() => {\n            // Tested to be valid in building time now.\n            const bd = this.timezone\n            ? new DateTZ({\n                  date: this.booking_date.ms,\n                  is_local_tz: false,\n                  building_tz: this.timezone,\n              })\n            : this.booking_date;\n            const start = bd.startOfValue('week').startOfValue('day');\n            const end = this.getEndOfWeek(bd);\n            return this.filterBookings(start, end);\n        })\n    );\n\n    /** Obsevable for filtered list of bookings for active month */\n    public readonly filtered_month = this._state.pipe(\n        map(() => {\n            const start = this.booking_date.startOfValue('month');\n            const end = this.booking_date.endOfValue('month');\n            return this.filterBookings(start, end);\n        })\n    );\n\n    /** Active filters */\n    public get filters() {\n        return this._filters.getValue();\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _spaces: SpacesService,\n        private ngZone: NgZone,\n    ) {\n        super();\n\n        this._org.initialised.pipe(first((_) => _)).subscribe(() => {\n            // Just to get the timezone correct\n            this._dateTz.next(\n                new DateTZ({\n                    date: this._dateTz.value.ms,\n                    is_local_tz: false,\n                    building_tz: this._org.building?.timezone,\n                })\n            );\n        });\n\n        /** Generate observable for updating bookings */\n        const search = combineLatest(this._poll, this._zone, this._dateTz).pipe(\n            filter((i) => !!i[0]),\n            debounceTime(500),\n            switchMap(() => {\n                const fzone = this._zone.getValue();\n                if (!fzone) {\n                    return of([]);\n                }\n                this._loading.next(true);\n                const start = this.booking_date.startOfValue('day');\n                const end = start.endOfValue('day');\n                return this._spaces.queryBooking({\n                    zone_ids: fzone,\n                    available_from: start.seconds,\n                    available_to: end.seconds,\n                });\n            }),\n            catchError(() => of([]))\n        );\n\n        const search_long_week = combineLatest(\n            this._long_poll_week,\n            this._zone,\n            this._dateTz\n        ).pipe(\n            filter((i) => !!i[0]),\n            debounceTime(500),\n            switchMap((props) => {\n                const type = props[0];\n                const fzone = props[1];\n                const dateTz = props[2];\n                if (!fzone) {\n                    return of([]);\n                }\n                this._loading.next(true);\n                return this.querySpace(type, fzone, dateTz, false);\n            }),\n            catchError((e) => { \n                return of([]);\n             })\n        );\n\n        /** Subscribe to update observable */\n        search.subscribe((space_list) => {\n            this.processBookings(space_list);\n            this._loading.next(false);\n        });\n        search_long_week.subscribe((space_list) => {\n            this.processBookings(space_list, this._long_poll_week.getValue() as any);\n            this._loading.next(false);\n        });\n    }\n\n    /**\n     * Function to build\n     */\n    private buildSpaceLongQuery(dailyCount: boolean = false): Observable<any> {\n        return combineLatest(\n            this._long_poll,\n            this._zone,\n            this._dateTz\n        ).pipe(\n            filter((i) => !!i[0]),\n            debounceTime(500),\n            switchMap((props) => {\n                const type = props[0];\n                const fzone = dailyCount ? this._org.building.id : props[1];\n                const dateTz = props[2];\n                if (!fzone) {\n                    return of([]);\n                }\n                this._loading.next(true);\n                return this.querySpace(type, fzone, dateTz, dailyCount);\n            }),\n            catchError((e) => { \n                return of([]);\n             })\n        );\n    }\n\n    private querySpace(type: string, fzone: string, dateTz: DateTZ, dailyCount: boolean = false) : Observable<Space[]> | Observable<any>{\n        const start = () => {\n            const s = dateTz;\n            if (type === 'week') {\n                return s.startOfValue('week');\n            } else {\n                return s.startOfValue('month');\n            }\n        };\n\n        const end = () => {\n            const e = start();\n            if (type === 'week') {\n                /**\n                 *  To Do: date-tz.class.ts endOfValue subtracts 1 day from end of week for 7 days a week type which returns Friday instead of Saturday\n                 *  below is the adjustment -\n                 */\n                return e.addValue({ days: 1 }).endOfValue('week');\n            } else {\n                return e.endOfValue('month');\n            }\n            /**\n             * R--- when testing March 2022 London offices, the month is an hour short.\n             * Is this a Luxon bug or London DST?\n             */\n        };\n\n        // dates here are ok\n        return this._spaces.queryBooking({\n            zone_ids: fzone,\n            available_from: start().seconds,\n            available_to: end().seconds,\n            ...(dailyCount) ? { daily_count: true } : ''\n        });\n    }\n\n\n    public getDailyMeetingCount() : void {\n        this._long_poll.next('month');\n        this.buildSpaceLongQuery(true).subscribe((counts) => {\n            this._noOfMeetings.next(counts);\n            this._loading.next(false);\n        });\n    }\n\n    /**\n     * Update the booking filters\n     * @param details\n     */\n    public setFilters(details: BookingFilters) {\n        this._filters.next(details);\n    }\n\n    /**\n     * Update the booking date\n     * @param details\n     */\n    public setDate(dateTz: DateTZ) {\n        this._dateTz.next(dateTz);\n    }\n\n    /**\n     * Update the booking's zone\n     * @param details\n     */\n    public setZone(zone: string) {\n        this._zone.next(zone);\n    }\n\n    /**\n     * Start polling to update bookings\n     * @param delay Duration between polling events in milliseconds\n     */\n    public startPolling(delay: number = 30 * 1000) {\n        this._poll.next(true);\n        this.ngZone.runOutsideAngular(() => {\n            this.interval('polling', () => this._poll.next(true), delay);\n        });\n    }\n\n    /**\n     * Start polling to update bookings\n     * @param delay Duration between polling events in milliseconds\n     */\n    public startPollingWeek(delay: number = 4 * 30 * 1000 ) {\n        this._long_poll_week.next('week');\n        this.ngZone.runOutsideAngular(() => {\n            this.interval(\n                'polling_long',\n                () => this._long_poll_week.next('week'),\n                delay\n            );\n        });\n    }\n    /**\n     * Start polling to update bookings\n     * @param delay Duration between polling events in milliseconds\n     */\n    public startPollingEveryFiveMin(delay: number =  60 * 1000) {\n        this._poll.next(true);\n        this.ngZone.runOutsideAngular(() => {\n            this.interval('polling', () => this._poll.next(true), delay);\n        });\n    }\n    \n    /**\n     * Start polling to update bookings\n     * @param delay Duration between polling events in milliseconds\n     */\n    public startPollingMonth(delay: number = 5 * 60 * 1000) {\n        this._long_poll.next('month');\n        this.ngZone.runOutsideAngular(() => {\n            this.interval(\n                'polling_long',\n                () => this._long_poll.next('month'),\n                delay\n            );\n        });\n    }\n\n\n    /**\n     * Stop polling to update bookings;\n     */\n    public stopPolling() {\n        this._poll.next(false);\n        this.clearInterval('polling');\n        this._long_poll.next('');\n        this.clearInterval('polling_long');\n    }\n\n    /**\n     * Add booking to bookings listing\n     * @param booking\n     */\n    public add(booking: Booking) {\n        const bookings = this._bookings.getValue();\n        const new_bookings = bookings.concat([booking]);\n        this._bookings.next(new_bookings);\n    }\n\n    /**\n     * Update booking in the bookings list\n     * @param booking\n     */\n    public replace(booking: Booking) {\n        const bookings = this._bookings.getValue();\n        const new_bookings = bookings\n            .filter(\n                (bkn) =>\n                    bkn.icaluid !== booking.icaluid && bkn.id !== booking.id\n            )\n            .concat([booking]);\n        this._bookings.next(new_bookings);\n    }\n\n    /**\n     * Remove booking in the bookings list\n     * @param booking\n     */\n    public remove(booking: Booking) {\n        const bookings = this._bookings.getValue();\n        const new_bookings = bookings.filter(\n            (bkn) => bkn.icaluid !== booking.icaluid\n        );\n        this._bookings.next(new_bookings);\n    }\n\n    public attentToDelete(\n        booking: Booking,\n        action: 'series' | 'booking' = 'booking',\n        undo: boolean = false\n    ) {\n        const bookings = this._bookings.getValue();\n        const attempted_to_delete = ((action) => {\n            return (bkg: Booking) => {\n                switch (action) {\n                    case 'booking': {\n                        const booking_master = bookings.find(\n                            (bkn) => bkn.icaluid === booking.icaluid\n                        );\n                        if (!booking_master) return false;\n                        return bkg.id === booking.id;\n                    }\n                    case 'series': {\n                        const booking_master = bookings.find(\n                            (bkg) =>\n                                bkg.id ===\n                                (booking.recurrence_type === 'occurrence'\n                                    ? booking.recurrence_master_id\n                                    : booking.id)\n                        );\n                        if (!booking_master) return false;\n                        return (\n                            booking_master.id === bkg.id ||\n                            bkg.recurrence_master_id === booking_master.id\n                        );\n                    }\n                    default:\n                        false;\n                }\n            };\n        })(action);\n\n        const new_bookings = [...bookings].map((bkg) => {\n            if (!undo && attempted_to_delete(bkg)) {\n                bkg.attempted_to_delete = action;\n            }\n\n            if (undo && attempted_to_delete(bkg)) {\n                bkg.attempted_to_delete = null;\n            }\n\n            return bkg;\n        });\n\n        this._bookings.next(new_bookings);\n    }\n\n    private processBookings(\n        space_list: Space[],\n        period: 'day' | 'week' | 'month' = 'day'\n    ) {\n        const start = () => {\n            switch (period) {\n                case 'month':\n                    return this.booking_date.startOfValue('month');\n                case 'week':\n                    return this.booking_date.startOfValue('week');\n                default:\n                    return this.booking_date.startOfValue('day');\n            }\n        };\n        const end = () => {\n            const s = start();\n            switch (period) {\n                case 'month':\n                    return s.endOfValue('month');\n                case 'week':\n                    return s.endOfValue('week');\n                default:\n                    return s.endOfValue('day');\n            }\n        };\n\n        let bookings = this._bookings.getValue();\n        space_list.forEach((space) => {\n            return (bookings = replaceBookings(\n                bookings,\n                space.bookings.map((bkn) => new Booking(bkn)),\n                {\n                    room_email: space.email,\n                    fromTz: start(),\n                    toTz: end(),\n                }\n            ));\n        });\n        this._bookings.next(bookings);\n    }\n\n    private filterBookings(startTz: DateTZ, endTz: DateTZ) {\n        const filters = this._filters.getValue();\n        const bookings = this._bookings.getValue();\n        const fzone = this._zone.getValue();\n        return bookings.filter((bkn) => {\n            const intersects = timePeriodsIntersect(\n                startTz.ms,\n                endTz.ms,\n                bkn.startDateTz.ms,\n                bkn.endDateTz.ms\n            );\n            const in_zone = bkn.room.zones.includes(fzone);\n            const has_space =\n                !filters.space_emails?.length ||\n                filters.space_emails.includes(bkn.room.email);\n            const in_zones =\n                !filters.zone_ids?.length ||\n                !!bkn.room.zones.find((zone) =>\n                    filters.zone_ids.includes(zone)\n                );\n            const type = bkn.declined ? 'declined' : bkn.getType();\n\n            const show =\n                !filters.hide_type?.length ||\n                !filters.hide_type.includes(type as any);\n            return intersects && has_space && in_zone && in_zones && show;\n        });\n    }\n\n    /**If Sunday add one day to get Saturday as end of week */\n    private getEndOfWeek(date: DateTZ): DateTZ {\n        return date.dateWeekday === 7\n            ? date.addValue({ days: 1 }).endOfValue('week').endOfValue('day')\n            : date.endOfValue('week').endOfValue('day');\n    }\n}\n","import { BaseDataClass } from '../base-api.class';\nimport { CateringOrder } from '../catering';\nimport { User } from '../users';\nimport {\n    flatten,\n    HashMap,\n    humaniseDuration,\n    shorterLocalDateFormatString,\n    toTitleCase,\n    unique\n} from '@mckinsey-converge/base';\nimport { Space } from '../spaces/space.class';\nimport { ServiceManager } from '../service-manager.class';\nimport { SettingsService } from '../settings.service';\nimport {\n    BookingNote,\n} from './booking.types';\nimport { convertLocalTimestampToTimezonedDateTz, DateNow, DateTZ, getTimezoneOffsetString } from '@mckinsey-converge/date-tz';\nimport { DaysOfWeek, getLastDateFromList, handleRecurrenceFields, RecurrencePeriod } from '../recurrence/recurrence.utils';\nimport { findSpace } from '../spaces';\nimport { DateTime } from 'luxon';\n\n\nexport interface IBookingQueryOptions {\n    /** booking ID */\n    id?: string;\n    email?: string;\n    target?: string;\n    from?: number; // R--- depreciate\n    until?: number; // R--- depreciate\n    fromTz?: DateTZ;\n    untilTz?: DateTZ;\n    show_cancelled?: boolean;\n    pagination?: boolean;\n    limit?: number;\n    offset?: number;\n    sort?: string,\n    filters?: any;\n    include_rooms?: boolean;\n    building_zone?: string;\n}\n\nexport class Booking extends BaseDataClass {\n    /** Unique calendar event ID */\n    // public readonly icaluid: string;\n    /** Subject or title of the booking */\n    public title: string;\n    /** Luxon based date class of the booking start time */\n    public startDateTz: DateTZ;\n    /** Luxon based date class of the booking start time */\n    public endDateTz: DateTZ;\n    /** Description or details of the booking */\n    public readonly body: string;\n    /** Type of booking */\n    public readonly booking_type: string;\n    /** List of catering orders for the booking */\n    public catering: readonly CateringOrder[];\n    /** Whether booking's duration covers all day */\n    public readonly all_day: boolean;\n    /** Mapping of emails to approval statuses */\n    public approval_status: HashMap<string>;\n    /**\n     * New booking approval status set in constructor\n     * \n     * timeBasedStatusLabel is a getter calculated via current time, some parts of the application\n     * may use status when it should use timeBasedStatusLabel\n     */\n    public status: 'tentative' | 'accepted' | 'approved' | 'declined' | 'cancelled' | 'expired' | 'unavailable';\n    /** Host/Organiser of the booking */\n    public organiser: User;\n    /** List of people invited to attend the booking */\n    public attendees: User[];\n    /** Author of the booking */\n    public readonly creator: User;\n\n    /** List of notes associated with the booking */\n    public notes: readonly BookingNote[];\n    /** Mapping of spaces to equipment charge codes */\n    public equipment_codes: HashMap<string>;\n    /** Mapping of spaces to expected number of attendees */\n    public expected_attendees: HashMap<number>;\n    /** Map of space emails to the setup time before the meeting in minutes */\n    public setup: HashMap<number>;\n    /** List of checked in attendees */\n    public check_ins: object;\n    /** Map of space emails to the breakdown time before the meeting in minutes */\n    public breakdown: HashMap<number>;\n    /** List of fields edited since creation */\n    public readonly edits: string[];\n    /** List of users to be notified on visitor arrivals */\n    public readonly notify_users: readonly string[];\n    /** Whether the time or duration has changed */\n    public time_changed = false;\n    /** \n     * Booking Space \n     * Bookings only have one room on MCK\n     */\n    public room: Space;\n    /** building_zone */\n    public building_zone: string;\n    /** Initialized Timezone */\n    public timezone: string;\n    /** Array of company names */ \n    public company?: string[];\n    /** Type of recurrence,  Shows whether this is a master or an occurence in the series. */\n    public readonly recurrence_type: string;\n    /** The frequency of the recurring booking. */\n    public readonly recurrence_period: RecurrencePeriod;\n    /** The interval time between each period. Defaults to 1. For example, with a period of \"weekly\" and an interval of 2, the recurrencd happen every 2 weeks. */\n    public readonly recurrence_interval: number;\n    /** Unix epoch in seconds of the recurrence end date */\n    private _recurrence_endTz: DateTZ;\n    /** The number of times to repeat the recurring booking. */\n    public readonly recurrence_count: number;\n    /** ID of the booking considered the master */\n    public readonly recurrence_master_id: string;\n    /** An array of booking IDs which belong to this recurring series. This INCLUDES the master booking ID. */\n    public readonly occurrence_ids: string[];\n    /** A list of INDIVIDUAL edits to any of the bookings in the series. This is so we can prompt the user if they are going to override previously updated bookings with a whole-series update. */\n    public readonly occurrence_edits: string[];\n    /** A list of Ocurrences */\n    public readonly occurrence_details: { id: string, start_epoch: number }[];\n    /** When the booking was created */\n    public created_epoch: number;\n    /** Is the Application concierge */\n    public is_concierge: boolean;\n    /**helper to know if recurring toggle is on */\n    public is_recurrent: boolean;\n    /**array of start dates of each ocurrence in the series */\n    public recurrence_starts: Array<DateTZ>\n    /**array of conflicting dates not to be included in the recurrence series */\n    public recurrence_exceptions: Array<number>\n\n    public recurrence_days?: Array<DaysOfWeek>\n\n    /** Master recurrence start */\n    public recurrence_start: number;\n\n    /** Start Epoch */\n    public start_epoch: number;\n    public end_epoch: number;\n    level_zone: string;\n\n    /** Currently back-end is not properly setting the recurrence_end property, this is a workaround */\n    public get recurrence_endTz(): DateTZ {\n        return this._recurrence_endTz;\n    }\n\n    public set recurrence_endTz(date: DateTZ) {\n        this._recurrence_endTz = date;\n    }\n    \n    /** Mark a booking for deleting */\n    public attempted_to_delete?: 'series' | 'booking' | null;\n\n    // No specific reason to set readonly but canm be change if needed to update in future\n    public readonly booked_by : string | { name: string };\n    public readonly booker: Object;\n    public readonly booker_concierge: Object\n\n    constructor(raw_data: HashMap = {}) {\n        super(raw_data);\n        // Needed to check if the current app is Concierge or Staff\n        const settingsService = ServiceManager.serviceFor(SettingsService) as unknown as SettingsService;\n        this.is_concierge = settingsService.concierge;\n\n        /** \n         * Setup Defaults when raw_data values are not provided\n         */\n        const nowTz = new DateTZ();\n\n        const defaultTitle = ''; // Blank since the create booking form will init with test values.\n        const defaultLocalTimezone = Intl?.DateTimeFormat()?.resolvedOptions()?.timeZone;\n        const defaultBuildingZone = null // R --- no idea, should be a building.id but which and how\n        const defaultOrgainiser = User.active_user || new User(); // meh, non American use.\n        const defaultBookingType = 'internal';\n\n        /** \n        * Process the simple raw_data with defaults mixed in\n        */\n        this.title = raw_data.title || defaultTitle;\n        this.timezone = raw_data.timezone || defaultLocalTimezone;\n        // Used by components to get the building details\n        this.building_zone = raw_data.building_zone || defaultBuildingZone;\n        this.body = raw_data.body || '';\n        // Provided booking type\n        this.booking_type = raw_data.booking_type || defaultBookingType;\n        // Attendees provided in API booking data\n        this.attendees = (raw_data.attendees || []).map((i) => new User(i));\n        // Provided organiser, active user, or empty user?\n        this.organiser = raw_data.organiser ? new User(raw_data.organiser) : defaultOrgainiser;\n        // Creator is provided or defaults to the organizer\n        this.creator = (raw_data.booked_by ? new User(raw_data.booked_by) : defaultOrgainiser) || this.organiser;\n        // Setup and breakdown times can conflict but not the true event start and end times\n        this.setup = raw_data.setup || {};\n        this.breakdown = raw_data.breakdown || {};\n        // Notes are assigned by room but we only support a single room\n        this.notes = raw_data.notes || [];\n        this.equipment_codes = raw_data.equipment_codes || {};\n        this.expected_attendees = raw_data.expected_attendees || {};\n        this.check_ins = raw_data.check_ins || {};\n        this.notify_users = raw_data.notify_users?.length ? raw_data.notify_users : [this.organiser?.name];\n        this.company = raw_data.company || [];\n        // retain booked by if there : helps to get correct creator above\n        this.booked_by = raw_data.booked_by;\n        this.booker = raw_data.booker;\n        this.booker_concierge = raw_data.booker_concierge;\n        this.level_zone = raw_data.level_zone;\n\n        /** \n         * Setup Defaults when raw_data values are not provided\n         * \n         * all room_ids and space_list inputs can be refactored into just room like an API booking\n         * \n         * raw_data.room can be provides as the Space class or JSON object\n         */\n        this.room = raw_data.room ? new Space(raw_data.room) : new Space();\n\n        const room_id = raw_data.room_id || raw_data.room_ids // Not sure why we have room_id and room_ids\n        if (!this.room.id && room_id?.length) {\n            this.room = findSpace(room_id[0]) || this.room;\n        }\n        /**\n         * Setup the booking start and end time\n         * \n         * \n         * Booking defaults to now if start is not defined.\n         * Booking durration is now a getter\n         */\n        // now rounded to the next 5 minute increment\n        const defaultStartTz = new DateTZ({ date: nowTz.ms, is_local_tz: false, building_tz: this.timezone }).setValue({ minute: Math.ceil(nowTz.minutes / 5) * 5 });\n\n        /**\n         * When saving a booking the BaseDataClass doens't know to use the toAPIJson\n         * so startDateTz isn't being convert to the epoch timestamp\n         * \n         * I'm not testing for the end time values because we can assume those follow the same pattern.\n         */\n        const startEpochProvided = !!(raw_data.start_epoch || raw_data.start);\n        const startDateTzProvided = !!raw_data.startDateTz;\n\n        /**\n         * Not trying to be fancy here, just clear.\n         */\n        if (!startEpochProvided && startDateTzProvided) {\n            /**\n             * Once a booking is saved the BaseDataClass recreates the Booking\n             * but doesn't use the toApiJSON method adapt the class input, mainly the\n             * startDateTz isn't converted to the start_epoch timestamp.\n             */ \n            this.startDateTz = raw_data.startDateTz;\n            this.endDateTz = raw_data.endDateTz;\n        } else if (startEpochProvided) {\n            /**\n             * A Booking created from the API responses arrives with the booking \n             * start_epoch and end_epoch timestamps.\n             */\n            this.startDateTz = new DateTZ({\n                date: ((raw_data.start_epoch || raw_data.start) * 1000),\n                is_local_tz: false,\n                building_tz: this.timezone\n            });\n            this.endDateTz = new DateTZ({\n                date: ((raw_data.end_epoch || raw_data.end)* 1000),\n                is_local_tz: false,\n                building_tz: this.timezone\n            });\n        } else {\n            /**\n             * And there are uses of new Booking where there are no inputs\n             * and defaults are necessary.\n             */\n            this.startDateTz = defaultStartTz;\n            this.endDateTz = defaultStartTz.addValue({ minutes: 60 });;\n        }\n\n        /**\n         * End time was by design ending at one minute before, IE 4:00PM is 3:59PM, \n         * because of calendar and conflcit checking\n         * \n         * Check and finesse it. \n         * Not sure why but some booking endtime added extra seconds \n         */\n        if ((this.endDateTz.minutes % 5) !== 0 || this.endDateTz.second > 0) {\n            // Not sure of the source but some bookings do not conform.\n            this.endDateTz = this.endDateTz.setValue({ second: 0, minute: Math.round(this.endDateTz.minutes / 5) * 5 });\n        }\n\n\n\n        /**\n         * Setup the booking created_date\n         * \n         * if it exists as a key, use the value directly.\n         * if we initialize without a value, switch to checking duration.\n         * Ref: MCK-826\n         */\n        this.created_epoch = raw_data.created_epoch || nowTz.seconds;\n\n\n        /**\n         * Setup the booking all_day boolean\n         * \n         * if it exists as a key, use the value directly.\n         * if we initialize without a value, switch to checking duration.\n         * Ref: MCK-826\n         */\n        if ('all_day' in raw_data) {\n            this.all_day = raw_data.all_day;\n        } else {\n            this.all_day = !!raw_data.all_day || this.duration > 23 * 60;\n        }\n\n\n        // R--- TODO Concierge will use startDateTz so i'm not sure if this is needed. \n        if (!this.is_concierge && this.all_day && this.timezone) {\n            /**\n             * Concierge has a all_day form field, I can see it may need this for that, does it really?\n             */\n            this.startDateTz = this.startDateTz.startOfValue('day')\n        }\n\n        /**\n         * Setup the booking approval status\n         */\n         let status = raw_data.status;\n         // If not provided default to approved.\n         if (!raw_data.status) {\n            status = 'accepted';\n         }\n         // \"show_as\" is a special rule to override how the applications display the status\n         if (raw_data.show_as && raw_data.show_as === 'cancelled') {\n            status = 'declined';\n         }\n         const approvalStatus = {};\n         approvalStatus[this.room.email] = status;\n         // Tracking new \"status\" and legacy \"approval_status\" from raw_data.status.\n         this.status = status;\n         this.approval_status = raw_data.approval_status || {};\n\n        /**\n         * Catering setup\n         * \n         * Bring in and sort the catering order by delivery time\n         */\n\n        this.catering = (raw_data.catering instanceof Array ? raw_data.catering : []).map(\n            (i) => new CateringOrder(i)\n        );\n        \n\n\n        /**\n         * Edited fields setup\n         * \n         * Bring in and sort the catering order by delivery time\n         * \n         * cateringOrders can return the order sorted\n         */\n        const edited_fields = Array.isArray(raw_data.edits)\n            ? raw_data.edits\n            : unique(\n                flatten(\n                    Object.keys(raw_data.edits || {}).map((room) => {\n                        return flatten(Object.values(raw_data.edits[room]));\n                    })\n                )\n            );\n        this.edits = edited_fields;\n\n        /**\n         * New Recurring booking feilds\n         * \n         * New fields do not match the BookingRecurrenceDetails type\n         * and are simpler to manage this way\n         */\n        this.recurrence_count = raw_data.recurrence_count || null;\n        this.recurrence_days = raw_data.recurrence_days || null;\n        this.occurrence_edits = raw_data.occurrence_edits || null;\n        this.recurrence_endTz = raw_data.recurrence_end ? new DateTZ({date: raw_data.recurrence_end * 1000, is_local_tz: false, building_tz: this.timezone}) : null;\n        this.recurrence_exceptions = raw_data.recurrence_exceptions || null;\n        this.occurrence_ids = raw_data.occurrence_ids || null;\n        this.recurrence_interval = raw_data.recurrence_interval || null;\n        this.recurrence_period = raw_data.recurrence_period || null;\n        this.recurrence_type = raw_data.recurrence_type || null;\n        this.recurrence_master_id = raw_data.recurrence_master_id\n        this.occurrence_details = raw_data.occurrence_details\n        this.is_recurrent = raw_data.is_recurrent || (!!this.recurrence_type && !!this.recurrence_period) || null;\n        this.recurrence_starts = raw_data.recurrence_starts || []\n        this.start_epoch = raw_data.start_epoch\n        this.end_epoch = raw_data.end_epoch\n         \n        /**\n         * I'm not clear why, but the booking body, aka description is copied into the notes.\n         * R--- In concerge data description is only a key when saving, also in the note array?\n         */\n        if (raw_data.body && !this.notes.find((i) => i.type === 'description')) {\n            this.notes = [\n                ...this.notes,\n                {\n                    type: 'description',\n                    date: 0,\n                    message: raw_data.body,\n                    author: this.organiser.email\n                }\n            ];\n        }\n\n        /**\n         * In case there is a cancellation in progress the property attempted_to_delete is set to false\n         * And it is persisted until the booking is gone\n         */\n        this.attempted_to_delete = raw_data.attempted_to_delete || null;\n    }\n\n\n    /** Service for managing Bookings */\n    protected get _service() {\n        return ServiceManager.serviceFor(Booking);\n    }\n\n    /** Alias to approval_status */\n    public get auto_approve(): boolean {\n        // if concierge we auto_approve always.\n        if (this.is_concierge) {\n            return true;\n        }\n        return !this.room.byRequest({\n            dateTz: this.startDateTz,\n            duration: this.duration,\n            host: this.organiser\n        });\n    }\n\n    /** Whether booking has been approved */\n    public get approved(): boolean {\n        return !this.declined && !this.tentative;\n    }\n\n    /** All of the booking attendees including the organizer */\n    public get allAttendees(): User[] {\n        return unique([this.organiser].concat(this.attendees), 'email');\n    }\n\n    /** Computer format for booking type */\n    public get bookingTypeId(): string {\n        return this.booking_type.toLowerCase();\n    }\n\n    /** Human format for booking type */\n    public get bookingTypeLabel(): string {\n        return toTitleCase(this.booking_type);\n    }\n\n    /** Get accessor for the check in object, app expect array */\n    public get checkInsArray(): string[] {\n        return Object.keys(this.check_ins || {})\n    }\n\n    /** Legacy getter for \"class\" */ // R-- TODO remove\n    public get class(): string {\n        return this.booking_type;\n    }\n\n    /**  */\n    public get displayEndDateTz(): DateTZ {\n        if ((this.endDateTz.minutes % 5) !== 0) {\n            // All the bookings should end in 59 seconds\n            return this.endDateTz.addValue({ seconds: 1 });\n        }\n        // but if not they return 00\n        return this.endDateTz;\n    }\n\n    /** Whether booking has been declined */\n    public get declined(): boolean {\n        /**\n         * I'm not sure, nor is Cam if this is ever used to decline\n         * all booking for a specific room\n         */\n        if (this.room.name.toLowerCase().includes('decline')) {\n            return true;\n        }\n\n        if (this.status.includes('decline')) {\n            return true;\n        }\n\n        return false;\n    }\n\n    /** Description of the booking purpose */\n    public get description(): string {\n        const note = (this.notes || []).find((i) => i.type === 'description');\n        return note ? note.message : '';\n    }\n\n    /** Catering getter */\n    public get cateringOrders() {\n        // Return the catering orders sorted by delivery time\n        return this.catering ? this.catering.slice().sort((a, b) => {\n            if (a?.delivery_time > b?.delivery_time) return 1;\n            if (b?.delivery_time > a?.delivery_time) return -1;\n          \n            return 0;\n        }) : [];\n    }\n\n    /** Get the created date as DateTz */\n    public get creationDateTz() {\n        return new DateTZ({ date: this.created_epoch * 1000, is_local_tz: false, building_tz: this.timezone })\n    }\n\n    public get tz_offset() {\n        return getTimezoneOffsetString(this.timezone);\n    }\n\n    /** Display value for the date */\n    public get date_string(): string {\n        return this.startDateTz.formatDate('dd MMM yyyy');\n    }\n\n    /**\n     * Get the booking durration based on start and end times\n     */\n     public get duration(): number {\n        return Math.abs(this.startDateTz.startOfValue('minute').dateDiff(this.displayEndDateTz, 'minutes'));\n    }\n\n    /** Unix timestamp of the booking start */\n    public get date() {  // R--- remove if not necessary\n        return this.startDateTz.ms;\n    }\n\n    /** Whether booking contains external visitors in the attendee list */\n    public get has_visitors(): boolean {\n        return this.attendees.reduce((a, v) => a || v.external, false);\n    }\n\n    /** Does the booking have catering orders */\n    public get has_catering(): boolean {\n        return !!this.catering.length;\n    }\n\n    /** \n     * Unique calendar event ID\n     * same as this.id, used to support existing component usage \n     */\n    public get icaluid(): string {\n        return this.id;\n    }\n\n    /**\n     * Get the booking room id\n     */\n    public get room_id(): string {\n        return this.room.id;\n    }\n\n    /** Legacy getter of room, aka space */\n    public get space(): Space {\n        return this.room;\n    }\n\n    /** Status of the booking */\n    public get timeBasedStatusLabel(): 'future' | 'upcoming' | 'done' | 'started' | 'in_progress' | 'expired_yesterday' {\n        const  buildingTzDt = DateNow(new Date()).toZone(this.timezone) ;  // building time\n\n        if (DateNow(new Date()).isBeforeDate(this.startDateTz.subtractValue({ minutes: 15 }))) {\n            return 'future';\n        } else if (DateNow(new Date()).isBeforeDate(this.startDateTz)) {\n            return 'upcoming';\n        } else if (DateNow(new Date()).isBeforeDate(this.startDateTz.addValue({ minutes: 15 }))) {\n            return 'started';\n        } else if (DateNow(new Date()).isBeforeDate(this.startDateTz.addValue({ minutes: this.duration }))) {\n            return 'in_progress';\n        }\n        // if current time is 12 AM (as per timezone) and booking expired yesterday\n        else if(buildingTzDt.startOfValue('day').addValue({ minutes: 1 }).isAfterDate(this.startDateTz, 'day') ) {\n            return 'expired_yesterday'\n        }\n        \n        return 'done';\n    }\n\n    /** Whether booking is tentative */\n    public get tentative(): boolean {\n        if (\n            this.status &&\n            this.status.indexOf('tentative') >= 0\n        ) {\n            return true;\n        }\n\n        return false;\n    }\n\n    /** Display valuie for the start and end times of the booking */\n    public get time_period(): string {\n        return `${this.startDateTz.formatDate('h:mma')} - ${this.displayEndDateTz.formatDate('h:mma')}`;\n    }\n\n    /** Display value for the start time of the booking */\n    public get start_time(): string {\n        return this.startDateTz.formatDate('h:mma');\n    }\n\n    /** Display value for the end time of the booking */\n    public get end_time(): string {\n        return this.endDateTz.formatDate('h:mma');\n    }\n\n    /** Display value for the duration of the booking */\n    public get length_string(): string {\n        return humaniseDuration(this.duration);\n    }\n\n    /** Display value for the location of the booking */\n    public get local_room_name(): string {\n        return this.room?.local_name || 'No location';\n    }\n\n    /** Display value for the level of the first space in the booking */\n    public get level(): string {\n        return this.space.level.name;\n    }\n\n    /**\n     * Make a copy of this object\n     */\n    public clone(): Booking {\n        return new Booking(this.toJSON());\n    }\n\n    /**\n     * Make a copy of this object without identification data\n     */\n    public duplicate(isEdit = false): Booking {\n        return new Booking({\n            ...this.toJSON(),\n            id: isEdit ? this.id : null,\n        });\n    }\n\n    /**\n     * \n     * @param status\n     * @returns void\n     */\n    public undo(status?: 'accept' | 'decline', opts: { series?: boolean } = {}): Promise<void> {\n        return this._service.undo(\n            this.id, status || 'accept',\n            opts\n        );\n    }\n\n    /**\n     * Delete booking from the server\n     */\n    public delete(opts: { series?: boolean } = {}): Promise<void> {\n        if (this.id) {\n            return this._service.delete(this.id, { ...opts });\n\n            // R-- ask Cam again is he's positive these extra params are not needed for anything\n            // return this._service.delete(this.id, {\n            //     concierge: this.is_concierge,\n            //     host: this.organiser.email,\n            //     room_id: this.space?.id,\n            //     icaluid: this.icaluid,\n            //     start: json.start,\n            //     end: json.end\n            // });\n        }\n    }\n\n    /**\n     * Convert object into plain object\n     */\n    public toJSON(this: Booking): HashMap {\n        let data = super.toJSON();\n        // Remove the description from the notes\n        data.notes = data.notes.filter((note) => note.type !== 'description');\n        // Encode the nested objects\n        data.room = data.room.toJSON();\n \n\n        data.organiser = data.organiser.toJSON();\n        data.creator = data.creator?.toJSON ? data.creator.toJSON(): data.creator;\n        // Map the attendees User objects\n        data.attendees = data.attendees.map((i: User) => i.toJSON());\n\n        // New recurring booking\n        data = handleRecurrenceFields(data)\n\n        if(data.recurrence_list){\n            data.recurrence_starts = [...data.recurrence_list]\n            delete data.recurrence_list\n        }\n        \n        return data;\n    }\n\n    /**\n     * Convert object into plain object\n     */\n    public toApiJSON(this: Booking): HashMap {\n        let data = super.toJSON();\n\n        // Update booking payload contains additional fields\n        data.icaluid = \"\";\n        if (data.id) {\n            data.icaluid = data.id;\n            data.location_name = this.room.local_name;\n            data.from_room = this.room.email;\n            data.building_zone = this.room.building?.id;\n        }\n\n        /**\n         * These fields are rather in flux\n         * According to Cam \"approve\" will be the prefered field\n         * and auto_approve and approval_status can be removed.\n         */\n        data.approve = this.auto_approve; // this value appear incorrect on update\n        data.auto_approve = [this.auto_approve]; // Needed to update approval status until BE accepts \"approve\"\n        delete data.approval_status;\n\n        // Booking start and end data\n        delete data.startDateTz;\n        delete data.endDateTz;        \n        data.start = this.startDateTz.seconds;\n        data.end = this.endDateTz.seconds;\n        data.old_start = this.startDateTz.seconds; // remove is not necessary\n        data.old_end = this.endDateTz.seconds; // remove is not necessary\n\n        // Creation date value\n        delete data.created_epoch;\n        data.creation_date = this.creationDateTz.seconds;\n\n        // Catering fields\n        // data.catering = data.catering.toJSON();\n        data.catering = this.cateringOrders;\n        data.has_catering = this.has_catering;\n        delete data.cateringOrders\n        \n        // Attendees appear quite incomplete\n        // Map the attendees User objects\n        data.attendees = this.allAttendees.map((i: User) => i.toJSON ? i.toJSON() : i);\n\n        // Orgainizer and Creator data\n        data.organiser = data.organiser.toJSON ? data.organiser.toJSON() : data.organiser;\n        data.creator = data.creator.toJSON ? data.creator.toJSON() : data.creator;\n\n        //  Convert check_ins to checked_in array\n        delete data.check_ins;\n        data.checked_in = this.checkInsArray;\n\n        // edits - edit booking is showing all fields even w/o an edit :(\n\n        // Room data\n        data.room_ids = [this.room.email];\n        delete data.room;\n\n        // New recurring booking\n        data = handleRecurrenceFields(data)\n\n        \n        if(data.recurrence_list){\n            data.recurrence_starts = [...data.recurrence_list]\n            delete data.recurrence_list\n        }\n\n        // Not found in dev data\n        delete data.name;\n        delete data.email;\n        delete data.is_concierge;\n        delete data.building_zone;\n        delete data.status;\n\n        return data;\n    }\n    \n    public getType(): string {\n        if (!this || this.status?.includes('decline')) {\n            return 'cancelled';\n        }\n        const booking_type = this.booking_type;\n        if (booking_type === 'internal' && this.has_visitors) {\n            return 'external';\n        }\n        return booking_type;\n    }\n\n    /** fallback for a booking when the recurrence_end is null but it's a series booking */\n    public recurrenEndFromOcurrences(occurrence_details: { id: string, start_epoch: number }[]): DateTZ {\n        const date = occurrence_details.map(occurence => occurence)\n        .sort((a, b) => new Date(a.start_epoch * 1000).getTime() - new Date(b.start_epoch * 1000).getTime())\n        .reverse()\n        .shift()\n        .start_epoch * 1000\n        return new DateTZ({date, is_local_tz: false, building_tz: this.timezone});\n    }\n\n    // public get dateString() {\n    //     return shorterLocalDateFormatString(this.startDateTz);\n    // }\n\n    // public get endDateString(): string {\n    //     return shorterLocalDateFormatString(this.recurrenEndFromOcurrences(this.occurrence_details));\n    // }\n}\n\n/**\n * Merge catering orders with same time and location\n * @param order_list List of catering orders\n */\nexport function mergeCateringOrders(order_list: CateringOrder[]) {\n    // R--- investigate when this is used. Staff doesn't use it when adding catering orders.\n    for (let i = 0; i < order_list.length; i++) {\n        const orders = order_list.filter(\n            (order) =>\n                order.location_id === order_list[i].location_id &&\n                order.delivery_time === order_list[i].delivery_time\n        );\n        if (orders.length > 1) {\n            const new_list = order_list.filter(\n                (order) =>\n                    !(order.location_id === order_list[i].location_id &&\n                        order.delivery_time === order_list[i].delivery_time)\n            );\n            new_list.push(new CateringOrder({\n                ...order_list[i],\n                items: flatten(orders.map(order => order.items)),\n                booking_date: this.startDateTz.ms,\n                booking_timezone: this.booking_timezone,\n            }));\n            order_list = new_list;\n            i = 0;\n        }\n    }\n    return order_list;\n}\n","import { DateTZ } from \"@mckinsey-converge/date-tz\";\n\nexport interface SpaceRules {\n    auto_approve: boolean;\n    hide: boolean;\n    max_length?: number;\n    min_length?: number;\n    reason?: string // specially for non-bookable rooms\n}\n\nexport interface BookingNote {\n    /** Type of note */\n    type: 'equipment' | 'catering' | 'description' | 'private' | 'other' | 'catering-private';\n    /** Name of the note's author */\n    author: string;\n    /** Contents of the note */\n    message: string;\n    /** Time the note was added to the booking */\n    date: number;\n    /** Display value for the time */\n    time?: string;\n    /** ID of the space associated with the note */\n    space?: string;\n    /** ID of the catering order associated with the note */\n    order_id?: string;\n}\n\nexport interface DateDurationData {\n    dateTz: DateTZ,\n    duration: number,\n    mobile: boolean,\n    save?: boolean,\n}\n\nexport enum BOOKING_STATUS {\n    approved = 'approved',\n    declined = 'declined',\n    tentative = 'tentative',\n    unavailable = 'unavailable'\n}","import {\n    AbstractControl,\n    FormControl,\n    FormGroup,\n    Validators\n} from '@angular/forms';\n\nimport { AvailableBookingFields } from '../settings.interfaces';\nimport {\n    HashMap,\n    humaniseDuration,\n    mockDate as mockDateBase,\n    resetDate as resetDateBase,\n    timeFormatString,\n    unique\n} from '@mckinsey-converge/base';\nimport { CateringOrder } from '../catering/catering-order.class';\nimport { ServiceManager } from '../service-manager.class';\nimport { User } from '../users/user.class';\nimport { Booking, IBookingQueryOptions } from './booking.class';\nimport {\n    BookingRule,\n    SpaceStatus\n} from './space.types';\nimport { validateEndTime } from '../validation.utilities';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { BookingAction, RecurrencePeriod, SeriesAction } from '../recurrence/recurrence.utils';\nimport { Space } from '../spaces';\n\nconst MINUTE = 1;\nconst HOUR = 60;\nconst DAY = 24 * HOUR;\nconst WEEK = 7 * DAY;\nconst MONTH = 30 * DAY;\n\nconst DURATION_MAP: { [duration: string]: number } = {\n    month: MONTH,\n    months: MONTH,\n    week: WEEK,\n    weeks: WEEK,\n    day: DAY,\n    days: DAY,\n    hour: HOUR,\n    hours: HOUR,\n    minute: MINUTE,\n    minutes: MINUTE\n};\n\n/**\n * Deprecated. Use @mckinsey-converge/base's import.\n */\nexport const mockDate = mockDateBase;\n\n/**\n * Deprecated. Use @mckinsey-converge/base's import.\n */\nexport const resetDate = resetDateBase;\n\nexport interface IBookingSlot {\n    start: number;\n    end: number;\n}\n\n\nexport function bookingOptionsToQuery(options: IBookingQueryOptions): HashMap {\n    let query: HashMap = {};\n    if (options) {\n        query = { ...options };\n        delete query.type;\n        if (options.filters) {\n            delete query.filters;\n            for (const property in options.filters) {\n                if (!query[property]) {\n                    query[property] = options.filters[property]\n                }\n            }\n        }\n\n        // id?: string;\n        // cancelled?: boolean;\n        if (options.until) {\n            query.to = options.until;\n            delete query.until;\n        }\n        \n    }\n    return query;\n}\n\n\n/**\n * Generate a list of free time slots between the given bookings\n * @param list List of bookings to find slots between\n * @param min_size Minimum length of a free slot in minutes\n */\nexport function getFreeBookingSlots(list: Booking[], min_size: number = 30): IBookingSlot[] {\n    /* istanbul ignore else */\n    if (!list) {\n        return [\n            {\n                start: 0,\n                end: DateNow(new Date()).startOfValue('minute').ms * 10\n            }\n        ];\n    }\n    const slots: IBookingSlot[] = [];\n    let start = new DateTZ({ date: 0 });\n    list.sort((a, b) => a.date - b.date);\n    for (const booking of list) {\n        const bkn_start = booking.startDateTz;\n        const bkn_end = booking.endDateTz;\n        if (bkn_start.isAfterDate(start)) {\n            const diff = Math.abs(bkn_start.dateDiff(start, 'minutes'));\n            /* istanbul ignore else */\n            if (diff >= min_size) {\n                slots.push({ start: start.ms, end: bkn_start.ms });\n            }\n            start = bkn_end;\n        } else if (start.startOfValue('minute').ms === bkn_start.startOfValue('minute').ms) {\n            start = bkn_end;\n        }\n    }\n    slots.push({\n        start: start.ms,\n         // R--- these X 10's make no sense. why not + 2 years?\n        end: DateNow(new Date()).startOfValue('minute').ms * 10\n    });\n\n    return slots;\n}\n\n/**\n * Get the next free time slot from the given bookings\n * @param list List of bookings to find the next slot\n * @param date Date to find next slot after in ms since UTC epoch\n * @param min_size Minimum length of the free slot in minutes\n * \n * R--- Possibly depreciate, I don't see it used anywhere except for its own test\n */\nexport function getNextFreeBookingSlot(\n    list: Booking[],\n    date: number = DateNow(new Date()).ms,\n    min_size: number = 30\n): IBookingSlot {\n    const slots = getFreeBookingSlots(list, min_size);\n    const date_ = new DateTZ({date})\n    const time = date_.startOfValue('minute').setValue({ second: 1 });\n    for (const block of slots) {\n        const start = new DateTZ({date: block.start});\n        const end = new DateTZ({date: block.end});\n        if (start.startOfValue('minute').isAfterDate(time)) {\n            return block;\n        } else if (time.isBeforeDate(end.startOfValue('minute'))) {\n            const duration = end.startOfValue('minute').dateDiff(time, 'minutes');\n            /* istanbul ignore else */\n            if (duration >= min_size) {\n                return block;\n            }\n        }\n    }\n    return slots[slots.length - 1];\n}\n\n/**\n * Generate form fields for the given booking\n * @param booking Booking to generate form for\n * @param current_user Current user of the system to default as the host\n */\nexport function generateBookingForm(\n    booking: Booking,\n    use_fields: AvailableBookingFields[],\n    isConcierge: boolean = false,\n    manualTimezone?: string,\n    action?: SeriesAction | BookingAction | null\n    ): FormGroup {\n    if (!booking) {\n        throw Error('No booking passed');\n    }\n\n    const user_service = ServiceManager.serviceFor(User);\n    const current_user =\n        user_service.current ||\n        new User({ id: 'local-user', name: 'Local User', email: 'local@place.tech' });\n\n    const fields: HashMap<FormControl> = {\n        id: new FormControl(booking.id || ''),\n        space_list: new FormControl([booking.room], []),\n        room: new FormControl(booking.room, {}),\n        dateTz: new FormControl({ value: booking.startDateTz || DateNow(), disabled: false }, [Validators.required]),\n        duration: new FormControl({ value: booking.duration, disabled: false }),\n        organiser: new FormControl(booking.organiser || current_user, [Validators.required]),\n        attendees: new FormControl(booking.attendees, []),\n        title: new FormControl(booking.title || '', { validators: [ Validators.required, Validators.minLength(1) ], updateOn: 'blur' }), //Validators.pattern(\"[^=`~!@#$%*{};:'\\\",_.<>]*\")\n        booking_type: new FormControl(booking.booking_type),\n        body: new FormControl(booking.body),\n        notes: new FormControl(booking.notes),\n        equipment_codes: new FormControl(booking.equipment_codes),\n        expected_attendees: new FormControl(booking.expected_attendees),\n        catering: new FormControl(\n            booking.cateringOrders.map(\n                (order) => new CateringOrder({\n                    ...order,\n                    booking_date: booking.startDateTz.ms,\n                    booking_timezone: booking.timezone,\n                })\n            )\n        ),\n        all_day: new FormControl(!!booking.all_day),\n        has_catering: new FormControl(!!booking.has_catering),\n        needs_space: new FormControl(true),\n        action: new FormControl(''),\n        timezone: new FormControl(manualTimezone || \"\"),\n        is_before_date: new FormControl(false)\n    };\n    if (!isConcierge) {\n        fields.duration.setValidators([Validators.required, validateEndTime(fields.dateTz)]);\n    }\n    /* istanbul ignore else */\n    if (booking.id && booking.id !== 'ad-hoc') {\n        fields.organiser.disable();\n        /* istanbul ignore else */\n        if (booking.endDateTz.ms < DateNow(new Date()).ms) {\n            fields.dateTz.disable();\n        }\n    } else {\n        const dateValidators = [Validators.required];\n        if (!isConcierge) {\n            dateValidators.push(isFuture);\n        }\n        dateValidators.push(validDateTZ)\n        fields.dateTz.setValidators(dateValidators);\n        fields.dateTz.updateValueAndValidity();\n    }\n    let list_length = -1;\n    fields.space_list.valueChanges.subscribe((list) => {\n        const expected = fields.expected_attendees.value || {};\n        const matches = Object.keys(expected).filter((key) =>\n            list.find((space) => space.email === key)\n        ).length;\n        if (list && list.length && matches === 0) {\n            const codes = fields.equipment_codes.value || {};\n            if (Object.keys(expected).length >= 0 || Object.keys(codes).length >= 0) {\n                const key = Object.keys(expected)[0] || Object.keys(codes)[0];\n                const new_expected = {};\n                const new_codes = {};\n                const notes = fields.notes.value;\n                notes.forEach((note) => (note.space === key ? (note.space = list[0].email) : ''));\n                new_expected[list[0].email] = expected[key];\n                new_codes[list[0].email] = codes[key];\n                fields.expected_attendees.setValue(new_expected);\n                fields.equipment_codes.setValue(new_codes);\n            }\n        }\n        list_length = list.length;\n    });\n    fields.dateTz.valueChanges.subscribe((_) => {\n        fields.duration.updateValueAndValidity();\n    });\n    fields.needs_space.valueChanges.subscribe((space_needed) => {\n        if (!space_needed) {\n            fields.space_list.setValue([]);\n        }\n    });\n    fields.has_catering.valueChanges.subscribe((has_catering) => {\n        if (!has_catering) {\n            fields.catering.setValue([]);\n        }\n    });\n    const simplified_fields: HashMap<FormControl> = [\n        'id',\n        'space_list',\n        'space_ids',\n        'notes',\n        'dateTz',\n        'booking_type',\n        'equipment_codes',\n        'expected_attendees',\n        'timezone',\n        'is_before_date',\n        ...use_fields\n    ].reduce((map, key) => {\n        /* istanbul ignore else */\n        if (fields[key]) {\n            map[key] = fields[key];\n        }\n        return map;\n    }, {});\n    \n    if (simplified_fields.all_day) {\n        const handleAllDay = (value) => {\n            if (value) {\n                let startOfDay = simplified_fields.dateTz.value.clone();\n                // When the booking space isn't set we still need a way to determine midnight\n                // and here we use the current concierge building selection's timezone.\n                if (manualTimezone) {\n                    startOfDay = startOfDay.toZone(manualTimezone);\n                }\n\n                simplified_fields.dateTz.setValidators([Validators.required]);\n                simplified_fields.dateTz.setValue(simplified_fields.all_day.value\n                            ? startOfDay.startOfValue('day')\n                            : simplified_fields.dateTz.value);\n                simplified_fields.duration.setValue(simplified_fields.all_day.value\n                    ? 24 * 60\n                    : simplified_fields.duration.value);\n                simplified_fields.dateTz.updateValueAndValidity();\n                simplified_fields.duration.disable();\n                // simplified_fields.dateTz.disable();\n            } else {\n                const dateValidators = [Validators.required];\n                if (!isConcierge) {\n                    dateValidators.push(isFuture);\n                }\n                dateValidators.push(validDateTZ)\n                simplified_fields.dateTz.setValidators(dateValidators);\n                simplified_fields.duration.setValue(booking.duration || 30);\n                simplified_fields.dateTz.updateValueAndValidity();\n                simplified_fields.duration.enable();\n                simplified_fields.dateTz.enable();\n            }\n        };\n        simplified_fields.all_day.valueChanges.subscribe(handleAllDay);\n        handleAllDay(simplified_fields.all_day.value);\n    }\n\n    const occurrences = booking.occurrence_details || [];\n\n    //Add recurrence fields\n    if(action && booking.recurrence_period  === RecurrencePeriod.LIST){\n        booking.recurrence_starts = occurrences\n            .filter(occurrence => occurrence.id !== booking.recurrence_master_id)\n            .map((occurrence) => new DateTZ({date: occurrence.start_epoch * 1000, is_local_tz: false, building_tz: booking.timezone})\n        ) \n    }\n    /**If series exists then set the start and end dates from the first and last bookings in the occurrences array\n     * this prevents prefilled form errors due to individual edits\n     */\n    if(action && action !== SeriesAction.CLONE && action !== BookingAction.CLONE && occurrences && occurrences.length && !booking.id){\n        const start_dateTz = new DateTZ({\n            date: occurrences.sort((d1, d2) => d1.start_epoch - d2.start_epoch)[0].start_epoch * 1000, \n            is_local_tz: false, building_tz: booking.timezone\n        })\n        simplified_fields.dateTz.setValue(start_dateTz)\n        const end = occurrences.sort((d1, d2) => d2.start_epoch - d1.start_epoch)[0].start_epoch * 1000\n        booking.recurrence_endTz =  new DateTZ({date: end, is_local_tz: false, building_tz: booking.timezone})  \n    }\n\n    // R-- needs TZ aware fields\n    const _recurr_end = simplified_fields.dateTz?.value || new DateTZ({ date: 1 }); // new DateTZ({date: simplified_fields.date?.value}) \n    const fields_with_recurrence = {\n        ...simplified_fields,\n        recurrence_period: new FormControl(booking.recurrence_period || RecurrencePeriod.WEEKLY),\n        recurrence_interval: new FormControl(booking.recurrence_interval || 1),\n        recurrence_endTz: new FormControl(booking.recurrence_endTz || _recurr_end.addValue({days: 1})),\n        recurrence_count: new FormControl(booking.recurrence_count || 0),\n        is_recurrent: new FormControl(booking.is_recurrent),\n        recurrence_starts: new FormControl(booking.recurrence_starts || []),\n        recurrence_exceptions: new FormControl([]),\n        recurrence_pattern: new FormControl(RecurrencePeriod.WEEKLY), //Helper value to store the last selected pattern (daily, weekly, monthly),\n        recurrence_days: new FormControl(booking.recurrence_days || [])\n    }\n\n    if(booking.is_recurrent && action !== BookingAction.CLONE){\n        fields_with_recurrence.recurrence_starts.setValidators([arrayWithValues])\n        fields_with_recurrence.recurrence_starts.updateValueAndValidity()\n        fields_with_recurrence.recurrence_endTz.setValidators([Validators.required, validDateTZ]);\n    }\n    // Generate form group for booking item\n    const form = new FormGroup(fields_with_recurrence);\n    return form;\n}\n\n/**\n * Validate whether date is in the future\n * @param control Control to check value\n */\nexport function isFuture(control: AbstractControl) {\n    const dateTz = control.value; // new DateTZ({date: control.value});\n    return dateTz.isBeforeDate(DateNow(new Date()).subtractValue({ minutes: 5 }))\n        ? { dateTz: 'Date needs to be in the future' }\n        : null;\n}\n\n/**\n * Validate whether an array has values\n * @param control Control to check value\n */\nexport function arrayWithValues (control: AbstractControl) {\n    return control.value.length !== 0 ? null : { field: 'Needs at least one value'}\n}\n\n/**\n * Validate whether a date has a valid value (future or current date)\n * @param control Control to check value\n */\n export function validDate (control: AbstractControl) {\n     if(!control.value){\n         return { date: 'Needs a valid date'}\n     }\n    const date = new DateTZ({date: control.value})\n    const now = DateNow(new Date())\n    const isValid = now.isBeforeDate(date, 'day') || now.isSameDate(date, 'day')\n    return isValid ? null : { date: 'Needs a valid date'}\n}\n\n/**\n * Validate whether a date has a valid DateTZ value (future or current date)\n * @param control Control to check value\n */\n export function validDateTZ (control: AbstractControl) {\n    if(!control.value){\n        return { date: 'Needs a valid date'}\n    }\n   const date = DateNow(control.value.JSDate);\n   const now = DateNow(new Date());\n   const isValid = now.isBeforeDate(date, 'day') || now.isSameDate(date, 'day')\n   return isValid ? null : { date: 'Needs a valid date'}\n}\n\n/**\n * Get minimum duration from ruleset in minutes\n * Default to 5min\n */\nexport function getMinLength(rule_list: HashMap<BookingRule[]>): number {\n    return Object.values(rule_list).reduce((min, block) => {\n        const min_block = block.reduce((min_length, el) => {\n            if (el.conditions.min_length && stringToMinutes(el.conditions.min_length) > min) {\n                return stringToMinutes(el.conditions.min_length);\n            } else {\n                return min_length;\n            }\n        }, 5);\n        if (min_block > min) {\n            return min_block;\n        } else {\n            return min;\n        }\n    }, 5) as number;\n}\n\n/**\n * Whether the first input is greater than the last. Converts duration strings into minutes\n * @param duration_1 First input can be a number in minutes or a duration string e.g. `1 hour`\n * @param duration_2 Second input can be a number in minutes or a duration string e.g. `30 minutes`\n */\nexport function durationGreaterThanOrEqual(\n    duration_1: string | number,\n    duration_2: string | number\n) {\n    const first: number = typeof duration_1 === 'string' ? stringToMinutes(duration_1) : duration_1;\n    const second: number =\n        typeof duration_2 === 'string' ? stringToMinutes(duration_2) : duration_2;\n    return first >= second;\n}\n\n/**\n * Conver time string into minutes\n * @param str timestring e.g. `'1 day'`, `'15 minutes'`, `'2 weeks'`\n */\nexport function stringToMinutes(str: string): number {\n    const parts = str.split(' ');\n    return +parts[0] * DURATION_MAP[parts[1]];\n}\n\n/**\n * Get current status within bookings\n * @param bookings List of bookings\n * @param host Host of the new event\n * @param date Datetime of the new event\n */\nexport function statusFromBookings(\n    bookings: Booking[] = [],\n    bookable: boolean = true,\n    requestable: boolean = false,\n    dateTz: DateTZ = DateNow(),\n    space?: Space\n) {\n    const free_slots = getFreeBookingSlots(bookings.filter((bkn) => !bkn.declined));\n    const now = DateNow() // new DateTZ({date}); // now should be now\n    // commeted bellow piece as correct way to get next free booking slot is at line- 488\n    // const next_free_slot = free_slots.find((slot) => {\n    //     return slot && (slot.start > now.ms || now.ms > slot.start - slot.start % 1000 || now.ms < slot.end - slot.end % 60 * 1000);\n    //     // const start = new DateTZ({date: slot?.start || 0 });\n    //     // const end = new DateTZ({date: slot?.end || 0}); // slot end isn't late enough? or after now/\n    //     // return start.isAfterDate(now) || (now.isAfterDate(start.startOfValue('second')) && now.isBeforeDate(end.startOfValue('minute')))\n    // });\n\n    const next_free_slot = getNextFreeBookingSlot(bookings.filter((bkn) => !bkn.declined));\n    \n    const start = new DateTZ({date: next_free_slot?.start || 0});\n    const end = new DateTZ({date: next_free_slot?.end || 0});\n    const currently_free = now.isAfterDate(start.startOfValue('second')) && now.isBeforeDate(end.startOfValue('minute'));\n    const time_until_next_block = humaniseDuration(\n        currently_free ? end.dateDiff(now, 'minutes') : start.dateDiff(now, 'minutes'),\n        'short'\n    );\n\n    const free_tomorrow = !currently_free && !start.isSameDate(now, 'day');\n    const free_today = currently_free && !end.isSameDate(now, 'day');\n    \n    return {\n        status: (!bookable\n            ? SpaceStatus.NotBookable\n            : currently_free\n                ? requestable\n                    ? SpaceStatus.Requestable\n                    : SpaceStatus.Available\n                : SpaceStatus.InProgress) as SpaceStatus,\n        available_until: free_today\n            ? 'No meetings today'\n            : currently_free\n                ? `Free until ${end.formatDate(timeFormatString())}(${time_until_next_block})`\n                : free_tomorrow\n                    ? 'Unavailable today'\n                    : `Free at ${start.formatDate(timeFormatString())}(${time_until_next_block})`\n    };\n}\n\n/**\n * V1 version display.\n */\nexport const spaceStatusToDisplay = (status: SpaceStatus): string => {\n    switch (status) {\n        case SpaceStatus.NotBookable:\n            return 'Not Bookable';\n        case SpaceStatus.Requestable:\n            return 'Available by Request';\n        case SpaceStatus.Unavailable:\n            return 'Unavailable';\n        case SpaceStatus.InProgress:\n            return 'Meeting in Progress';\n        case SpaceStatus.Available:\n        default:\n            return 'Available';\n    }\n};\n\nexport function replaceBookings(\n    list: Booking[],\n    new_bookings: Booking[],\n    filter_options: { room_email: string; fromTz: DateTZ; toTz: DateTZ }\n) {\n    const filtered_list = list.filter((booking) => {\n        return (\n            !(booking.room?.email === filter_options.room_email) ||\n            !timePeriodsIntersect(filter_options.fromTz.ms, filter_options.toTz.ms, booking.startDateTz.ms, booking.endDateTz.ms)\n        );\n    });\n    const updated_list = filtered_list.concat(new_bookings);\n    updated_list.sort((a, b) => a.date - b.date);\n    return unique(updated_list, 'icaluid');\n}\n\nexport function timePeriodsIntersect(\n    start1: number,\n    end1: number,\n    start2: number,\n    end2: number,\n    type = ''\n) {\n    return (\n        (start1 >= start2 && start1 < end2) ||\n        (end1 > start2 && end1 <= end2) ||\n        (start2 >= start1 && start2 < end1) ||\n        (end2 > start1 && end2 <= end1)\n    );\n}\n\nexport function formatWhen({\n    all_day,\n    startTZ,\n    endTZ,\n    displayEndTZ\n}): string {\n    if (all_day) {\n        return `${startTZ.formatDate('dd MMM yyyy')} - All Day`;\n    } else {\n        if (startTZ.isSameDate(endTZ, 'day')) {\n            return `${startTZ.formatDate('dd MMM yyyy, h:mma')} - ${displayEndTZ.formatDate('h:mma')}`;\n        } else {\n            return `${startTZ.formatDate('dd MMM yyyy, h:mma')} - ${displayEndTZ.formatDate('dd MMM yyyy, h:mma')}`;\n        }\n    }\n}\n","\nimport { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\nimport { BaseAPIService } from '../base.service';\nimport { Booking, IBookingQueryOptions } from './booking.class';\nimport { bookingOptionsToQuery } from './booking.utilities';\nimport {\n    HashMap\n} from '@mckinsey-converge/base';\nimport { ServiceManager } from '../service-manager.class';\nimport { SettingsService } from '../settings.service';\nimport { BookingCheckinParams } from './space.types';\nimport { DateNow } from \"@mckinsey-converge/date-tz\";\nimport { Observable } from 'rxjs/internal/Observable';\nimport { forkJoin } from 'rxjs';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class BookingsService extends BaseAPIService<Booking> {\n    constructor(protected _composer: ComposerService,\n        settingsService: SettingsService,\n    ) {\n        super(_composer, settingsService);\n        ServiceManager.setService(Booking, this);\n        this._name = 'Bookings';\n        this._api_route = 'bookings';\n        this._compare = (a, b) => !(a.id || '').localeCompare(b.id) || !(a.icaluid || '').localeCompare(b.icaluid);\n    }\n\n    /**\n * Get user bookings\n * @param options\n */\n    public userBookings(options: IBookingQueryOptions,\n        uniqueId?: string): Promise<Booking[]> {\n        if (!options) {\n            throw new Error('Booking avilability requires request options');\n        }\n        const now = DateNow(new Date())\n        if (!options.from) {\n            options.from = now\n                .startOfValue('day')\n                .subtractValue({ days: 2 })\n                .ms;\n        }\n        if (!options.until) {\n            options.until = null;\n        }\n\n        const key = `bookings|${options.id ? options.id : ''}|${uniqueId ?? ''}`;\n        if (!this._promises[key]) {\n            this._promises[key] = new Promise((resolve, reject) => {\n                const respond = (list: Booking[]) => {\n                    delete this._promises[key];\n                    resolve(list);\n                };\n                const error = e => {\n                    reject(e);\n                    delete this._promises[key];\n                };\n                const query = bookingOptionsToQuery(options);\n                if (options.id) {\n                    this.show(options.id, query).then(i => respond([i]), error);\n                } else {\n                    this.query(query).then(respond, error);\n                }\n            });\n        }\n        return this._promises[key];\n    }\n\n\n    /**\n     * Save changes to the booking\n     * @param booking Booking update or add to the database\n     */\n    public save(booking: Booking, series?: boolean): Promise<Booking> {\n        const body = booking.toApiJSON()\n        if(series){\n            body.series = true\n        }\n        return booking.id ? this.update(booking.id, body) : this.add(body);\n    }\n\n    /**\n     * Checkin atteendee of a booking\n     * @param id ID of the booking\n     * @param fields Fields associated with the booking and attendee\n     */\n    public checkin(id: string, fields: BookingCheckinParams) {\n        return  this.task(id, 'checkin', fields);\n    }\n    public checkinIndividualVisitor(id: string, fields: BookingCheckinParams) {\n        return  this.taskObsr(id, 'checkin', fields); \n    }\n\n    public accept(id: string, fields?: HashMap) {\n        return this.task(id, 'accept', fields);\n    }\n\n    public undo(id: string, status: 'accept' | 'decline', fields?: HashMap) {\n        return this.task(id, status, fields);\n    }\n\n    public decline(id: string, fields?: HashMap) {\n        return this.task(id, this.settingsService.concierge ? 'concierge_decline' : 'decline', fields);\n    }\n\n    protected process(raw_data: HashMap): Booking {\n        return new Booking(raw_data);\n    }\n\n    public declineMultiple(bookings: Booking[]): Observable<any[]> {\n        const requests = [];\n        bookings.forEach(bkg => {\n            const booking = bkg.toJSON();\n            const id = booking.id;\n            const fields = {\n                booking_id: booking.id,\n                organiser: booking.organiser.email,\n                room_email: booking.space?.email,\n                icaluid: booking.icaluid,\n                start: booking.startDateTz.formatDate('h:mm a').toLocaleLowerCase(),\n                end: booking.endDateTz.formatDate('h:mm a').toLocaleLowerCase(),\n            };\n            requests.push(this.taskObsr(id, 'concierge_decline', fields) ); \n        });\n        return forkJoin(requests);\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\nimport { PaginatedAPIService } from '../paginated.service';\nimport { Booking, IBookingQueryOptions,  } from './booking.class';\nimport { bookingOptionsToQuery } from './booking.utilities';\nimport {\n    HashMap\n} from '@mckinsey-converge/base';\nimport { ServiceManager } from '../service-manager.class';\nimport { SettingsService } from '../settings.service';\nimport { BookingCheckinParams } from './space.types';\nimport { Observable } from 'rxjs';\n\nexport interface PaginatedBooking {\n    results: Booking[];\n    total: number;\n}\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class BookingsPaginatedService extends PaginatedAPIService<Booking> {\n    constructor(protected _composer: ComposerService,\n        settingsService: SettingsService,\n    ) {\n        super(_composer, settingsService);\n        ServiceManager.setService(Booking, this);\n        this._name = 'Bookings';\n        this._api_route = 'bookings';\n        this._compare = (a, b) => !(a.id || '').localeCompare(b.id) || !(a.icaluid || '').localeCompare(b.icaluid);\n    }\n\n    /**\n * Get user bookings\n * @param options\n */\n    public userBookings(options: IBookingQueryOptions,\n        uniqueId?: string): Promise<PaginatedBooking> {\n        if (!options) {\n            throw new Error('Booking avilability requires request options');\n        }\n\n        const key = `bookingsPaginated|${options.id ? options.id : ''}|${uniqueId ?? ''}`;\n        if (!this._promises[key]) {\n            this._promises[key] = new Promise((resolve, reject) => {\n                const respond = (response: any) => {\n                    delete this._promises[key];\n                    resolve(response);\n                };\n                const error = e => {\n                    reject(e);\n                    delete this._promises[key];\n                };\n                const query = bookingOptionsToQuery(options);\n                if (options.id) {\n                    this.show(options.id, query).then(i => respond([i]), error);\n                } else {\n                    this.query(query).then(respond, error);\n                }\n            });\n        }\n\n        return this._promises[key];\n    }\n\n\n    /**\n     * Save changes to the booking\n     * @param booking Booking update or add to the database\n     */\n    public save(booking: Booking): Promise<Booking> {\n        return booking.id ? this.update(booking.id, booking.toJSON()) : this.add(booking.toJSON());\n    }\n\n    /**\n     * Checkin atteendee of a booking\n     * @param id ID of the booking\n     * @param fields Fields associated with the booking and attendee\n     */\n    public checkin(id: string, fields: BookingCheckinParams) {\n        return this.task(id, 'checkin', fields);\n    }\n\n    public accept(id: string, fields?: HashMap) {\n        return this.task(id, 'accept', fields);\n    }\n\n    public decline(id: string, fields?: HashMap) {\n        return this.task(id, this.settingsService.concierge ? 'concierge_decline' : 'decline', fields);\n    }\n\n    public undo(id: string, status: 'accept' | 'decline', fields?: HashMap) {\n        return this.task(id, status, fields);\n    }\n\n    protected process(raw_data: HashMap): Booking {\n        return new Booking(raw_data);\n    }\n\n    // public getHoldingBay(query: IBookingQueryOptions): Promise<PaginatedBooking> {\n    //     const key = `bookingsPaginated|holding-bay`;\n    //     if (!this._promises[key]) {\n    //         this._promises[key] = new Promise((resolve, reject) => {\n    //             const respond = (response: any) => {\n    //                 delete this._promises[key];\n    //                 resolve(response);\n    //             };\n    //             const error = e => {\n    //                 reject(e);\n    //                 delete this._promises[key];\n    //             };         \n    //                 this.query(query, { url: '/api/staff/bookings/holding_bay' }).then(respond, error);\n    //         });\n    //     }\n\n    //     return this._promises[key];\n    // }\n\n    public getHoldingBay = (query: IBookingQueryOptions): Observable<HashMap> => this.queryHoldingBay(query, { url: '/api/staff/bookings/holding_bay' });\n}\n","export * from './booking.class'\nexport * from './space.types'\nexport * from './bookings.service'\nexport * from './bookingsPaginated.service'\nexport * from './booking.utilities'\nexport * from './booking-state.service'\nexport * from './space.utilities'\nexport * from './booking.types'\n","import { SpaceRules } from './booking.types';\n\nimport {\n    durationGreaterThanOrEqual,\n    stringToMinutes\n} from './booking.utilities';\nimport {\n    SpaceCheckOptions,\n    SpaceRuleOptions\n} from './space.types';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n/**\n * Get booking rules for the given user and space\n * @param options\n */\nexport function rulesForSpace(options: SpaceRuleOptions): SpaceRules {\n    if (!options) {\n        throw Error('Options are needed to check for rule matches');\n    }\n    const space_rules_for_user: SpaceRules = {\n        auto_approve: true,\n        hide: true,\n        reason: ''\n    };\n    let match = false;\n    /* istanbul ignore else */\n    if (options.space) {\n        for (const type in options.rules) {\n            if (\n                options.rules.hasOwnProperty(type) &&\n                options.rules[type] instanceof Array &&\n                options.space.zones.find((zone) => zone === type)\n            ) {\n                for (const rule_block of options.rules[type]) {\n                    /* istanbul ignore else */\n                    if (\n                        checkRules({\n                            user: options.user,\n                            space: options.space,\n                            time: options.time,\n                            duration: options.duration,\n                            rules: rule_block.conditions\n                        })\n                    ) {\n                        const ruleset = rule_block.rules;\n                        const conditions = rule_block.conditions;\n                        space_rules_for_user.hide = false;\n                        /* istanbul ignore else */\n                        if (conditions.max_length) {\n                            space_rules_for_user.max_length = stringToMinutes(\n                                conditions.max_length as string\n                            );\n                        }\n                        /* istanbul ignore else */\n                        if (conditions.min_length) {\n                            space_rules_for_user.min_length = stringToMinutes(\n                                conditions.min_length as string\n                            );\n                        }\n                        // NOTE: use max_length in conditions instead of book_length in rules\n                        // if (ruleset.book_length) {\n                        //     space_rules_for_user.max_length = stringToMinutes(ruleset.book_length as string);\n                        // }\n                        /* istanbul ignore else */\n                        if (ruleset.auto_approve !== undefined) {\n                            space_rules_for_user.auto_approve = ruleset.auto_approve;\n                        }\n                        match = true;\n                        space_rules_for_user.reason = '';\n                        break;\n                    }\n                    else {\n                        space_rules_for_user.reason = 'OfficeRules';\n                    }\n                }\n            }\n            \n            /* istanbul ignore else */\n            if (!space_rules_for_user.hide) {\n                break;\n            }\n        }\n    }\n    if (!match) {\n        space_rules_for_user.hide = true;\n    }\n    return space_rules_for_user;\n}\n\n\n/**\n * Check if user matches the given ruleset\n * @param options\n */\nfunction checkRules(options: SpaceCheckOptions): boolean {\n    /* istanbul ignore else */\n    if (options.rules) {\n        const time = new DateTZ({date: options.time});\n        const count = Object.keys(options.rules).length;\n        let matches = 0;\n        Object.keys(options.rules).forEach((key) => {\n            let counter = 0;\n            const condition: string[] =\n                options.rules[key] instanceof Array\n                    ? (options.rules[key] as [])\n                    : [options.rules[key] as string];\n            switch (key) {\n                case 'groups':\n                    /* istanbul ignore else */\n                    if (options.user && options.user.groups) {\n                        counter = 0;\n                        condition.forEach((i) =>\n                            options.user.groups.find((j) => j === i) ? counter++ : null\n                        );\n                        /* istanbul ignore else */\n                        if (counter > 0) {\n                            matches++;\n                        }\n                    }\n                    break;\n                case 'locations':\n                    /* istanbul ignore else */\n                    if (options.user && options.user.location) {\n                        counter = 0;\n                        condition.forEach((i) =>\n                            (options.user.last_location.name || '').indexOf(i) >= 0\n                                ? counter++\n                                : null\n                        );\n                        /* istanbul ignore else */\n                        if (counter >= options.rules[key].length) {\n                            matches++;\n                        }\n                    }\n                    break;\n                case 'is_before':\n                    /* istanbul ignore else */\n                    if (options.time) {\n                        const duration = stringToMinutes(condition[0]);\n                        const check = DateNow(new Date()).addValue({ minutes: duration });\n                        let match = time.isBeforeDate(check);\n                        /* istanbul ignore else */\n                        matches += match ? 1 : 0;\n                    }\n                    break;\n                case 'is_after':\n                    /* istanbul ignore else */\n                    if (options.time) {\n\n                        const duration = stringToMinutes(condition[0]);\n                        const check = DateNow(new Date());\n                        time.isAfterDate(check.addValue({ minutes: duration })) ? matches++ : '';\n                    }\n                    break;\n                case 'min_length':\n                    /* istanbul ignore else */\n                    if (\n                        options.duration &&\n                        durationGreaterThanOrEqual(options.duration, condition[0])\n                    ) {\n                        matches++;\n                    }\n                    break;\n                case 'max_length':\n                    /* istanbul ignore else */\n                    if (\n                        options.duration &&\n                        durationGreaterThanOrEqual(condition[0], options.duration)\n                    ) {\n                        matches++;\n                    }\n                    break;\n            }\n        });\n        return matches >= count;\n    }\n    return false;\n}\n","\nimport { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\nimport { CateringCategory } from './catering-category.class';\nimport { BaseAPIService } from '../base.service';\nimport { SettingsService } from '../settings.service';\nimport { ServiceManager } from '../service-manager.class';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class CateringCategoriesService extends BaseAPIService<CateringCategory> {\n\n    constructor(protected _composer: ComposerService,\n                settingsService: SettingsService) {\n        super(_composer, settingsService);\n        ServiceManager.setService(CateringCategory, this);\n        this._name = 'catering category/group';\n        this._api_route = 'catering/category';\n    }\n\n    public query(): never {\n        throw Error('No index endpoint for catering categories. Use catering menu service.');\n    }\n\n    public show(): never {\n        throw Error('No show endpoint for catering categories. Use catering menu service.');\n    }\n\n    public processItem(raw_item: any) {\n        return new CateringCategory(raw_item);\n    }\n\n    public format(item: CateringCategory) {\n        return { ...item };\n    }\n}\n","import { CateringItem } from \"./catering-item.class\";\nimport { HashMap } from '@mckinsey-converge/base';\n\nexport class CateringCategory extends CateringItem {\n    /** Whether item is a category */\n    public is_category = true;\n\n    constructor(data: HashMap) {\n        super(data);\n        this.is_category = true;\n        (this as any).must_select = this.must_select || 0;\n        (this as any).order_anytime = !!data.order_anytime && this.package;\n    }\n\n    /**\n     * Convert class object into plain object\n     */\n    public toJSON(this: CateringItem): HashMap {\n        const obj = super.toJSON();\n        obj.order_anytime = !!obj.order_anytime && obj.package;\n        return obj;\n    }\n}\n","import { HashMap } from '@mckinsey-converge/base';\n\nexport interface CateringAvailability {\n    /** Month of the year that the item starts being available */\n    readonly from_month: number;\n    /** Month of the year that the item ends being available */\n    readonly to_month: number;\n}\n\nexport class CateringItem {\n    /** Unique ID of the catering item */\n    public readonly id: string;\n    /** Display name of the catering item */\n    public readonly name: string;\n    /** Description of the item */\n    public readonly description: string;\n    /** URL to the image associated with the item */\n    public readonly image_path: string;\n    /** Type of catering item */\n    public readonly catering_type: string;\n    /** Availability of the item */\n    public readonly available: CateringAvailability;\n    /** Time in hours that is needed to prepare the item beforehand */\n    public readonly prior_notice: number;\n    /** Cost of the item without decimals */\n    private unit_price: number;\n    /** Cost of the item without decimals */\n    public readonly supplier_cost: number;\n    /** Minimum number this item allowed in an order */\n    public readonly minimum_quantity: number;\n    /** Maximum number this item allowed in an order */\n    public readonly maximum_quantity: number;\n    /** List of categories that the item is contained in */\n    public readonly parent_categories: readonly string[];\n    /** Allegen information associated with the item */\n    public readonly allergy: string;\n    /** Whether the supply of this item has run out */\n    public readonly out_of_stock: boolean;\n    /** Whether item can be ordered within the time limit set by the building */\n    public readonly order_anytime: boolean;\n    /** Number of child items that must be selected as part of the package */\n    public readonly must_select: number;\n    /** List of associated items */\n    public readonly items: CateringItem[];\n    public readonly availableItems: CateringItem[];\n    /** Whether child items are part of a package */\n    public readonly package: boolean;\n    /** List of zone ids associated with the category */\n    public readonly zones: readonly string[];\n    /** Number of this item in the assoicated order */\n    private _amount = 0;\n    /** Unique ID of the catering item */\n    private instance_id: string;\n    /** Whether item is a category */\n    public is_category: boolean = false;\n\n    public get can_order_anytime(): boolean {\n        return (\n            this.order_anytime ||\n            !this.package && this.items.reduce(\n                (anytime, item) => anytime || item.can_order_anytime,\n                false,\n            )\n        );\n    }\n\n    /** Number of this item in the assoicated order */\n    public get amount(): number {\n        return this._amount || 0;\n    }\n\n     /** Unit price in the assoicated order */\n     public get price(): number {\n        return this.unit_price || 0;\n    }\n\n    /** Total cost of the amount of items set */\n    public get total(): number {\n        return (this._amount * this.unit_price) || 0;\n    }\n\n    constructor(data: HashMap) {\n        this.instance_id = `item-${Math.floor(Math.random() * 999_999_999)}`;\n        this.id = data.id || '';\n        this.name = data.name || '';\n        this.is_category = this.id.includes('category-');\n        this.available = {\n            from_month: (data.available ? data.available.from_month : data.available_from) || -1,\n            to_month: (data.available ? data.available.to_month : data.available_to) || -1,\n        };\n        this.description = data.description || '';\n        this.prior_notice = data.prior_notice || data.notice;\n        this.unit_price = data.unit_price || data.price || 0;\n        this.supplier_cost = data.supplier_cost;\n        this.minimum_quantity = Math.max(0, data.minimum_quantity || 0);\n        this.maximum_quantity = Math.max(1, data.maximum_quantity || 999);\n        this.parent_categories = data.category_ids || data.parent_categories || data.categories;\n        this.order_anytime = !!data.order_anytime;\n        this.image_path = data.image_path || '';\n        this.catering_type = data.catering_type;\n        this.must_select = data.must_select ?? 0;\n        this._amount = data._amount || data.amount || 0;\n        this.allergy = data.allergy || '';\n        const cateringItems: CateringItem[] = (data.items || []).map(item => new CateringItem(item));\n        this.items = cateringItems;\n        const filteredCateringItems = cateringItems.filter(c => !c.out_of_stock);\n        this.availableItems = filteredCateringItems;\n        this.out_of_stock = !!data.out_of_stock ||\n            // if original items are empty, we hit the bottom, so if we filter out items then its out of stock.\n            (cateringItems.length > 0 && filteredCateringItems.length === 0);\n        this.package = data.package === 'true' || data.package === true;\n        this.zones = data.zones && data.zones.length ? [...data.zones] : [];\n    }\n\n    public setAmount(amount: number = 0): void {\n        if (amount <= this._amount) {\n            if (amount < this.minimum_quantity) {\n                amount = 0;\n            }\n        } else {\n            if (amount < this.minimum_quantity) {\n                amount = this.minimum_quantity;\n            }\n        }\n        this._amount = Math.max(0, Math.min(this.maximum_quantity, amount));\n    }\n\n    /**\n     * Updates the unit_price in the assoicated order if necessary\n     * @param price value to compare to unit_price\n     */\n    public setPrice(price: number = 0): void {\n        if(this.unit_price !== price) this.unit_price = price;\n    }\n\n    /**\n     * Increase amount of the item the order\n     * @param amount Amount to increase by\n     */\n    public addToOrder(amount: number = 1) {\n        amount = Math.max(1, amount);\n        this._amount += amount;\n        if (this._amount < 0) {\n            this._amount = 0;\n        } else if (this._amount < this.minimum_quantity) {\n            this._amount = this.minimum_quantity;\n        } else if (this._amount > this.maximum_quantity) {\n            this._amount = this.maximum_quantity;\n        }\n    }\n\n    /**\n     * Decrease amount of the item the order\n     * @param amount Amount to decrease by\n     */\n    public removeFromOrder(amount: number = 1) {\n        amount = Math.max(1, amount);\n        this._amount -= amount;\n        if (this._amount < 0) {\n            this._amount = 0;\n        } else if (this._amount < this.minimum_quantity) {\n            this._amount = 0;\n        }\n    }\n\n    /**\n     * Convert class object into plain object\n     */\n    public toJSON(this: CateringItem): HashMap {\n        const obj: any = { ...this };\n        // Remove local private members\n        delete obj._changes;\n        delete obj._server_names;\n        // Convert remaining members to be public\n        obj.price = obj.unit_price;\n        obj.categories = obj.parent_categories;\n        const keys = Object.keys(obj);\n        for (const key of keys) {\n            if (key[0] === '_') {\n                const new_key = key.substr(1);\n                obj[new_key] = obj[key];\n                delete obj[key];\n            } else if (obj[key] === undefined) {\n                delete obj[key];\n            }\n        }\n        obj.items = obj.items.map((item: CateringItem) => item.toJSON());\n        return obj;\n    }\n}\n","\nimport { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\nimport { BaseAPIService } from '../base.service';\nimport { CateringItem } from './catering-item.class';\nimport { SettingsService } from '../settings.service';\nimport { ServiceManager } from '../service-manager.class';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class CateringItemsService extends BaseAPIService<CateringItem> {\n    constructor(protected _composer: ComposerService,\n                settingsService: SettingsService) {\n        super(_composer, settingsService);\n        ServiceManager.setService(CateringItem, this);\n        this._name = 'Catering Menu';\n        this._api_route = 'catering/item';\n    }\n\n    public query(): never {\n        throw Error('No index endpoint for catering items. Use menu service.');\n    }\n\n    public show(): never {\n        throw Error('No show endpoint for catering items. Use menu service.');\n    }\n\n    public processItem(raw_item: any) {\n        return new CateringItem(raw_item);\n    }\n\n    public format(item: CateringItem) {\n        return item instanceof CateringItem ? item.toJSON() : item;\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\n\nimport { CateringItem } from './catering-item.class';\nimport { CateringCategory } from './catering-category.class';\nimport { BaseAPIService } from '../base.service';\nimport { HashMap } from '@mckinsey-converge/base';\nimport { SettingsService } from '../settings.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class CateringMenuService extends BaseAPIService<CateringItem | CateringCategory> {\n    constructor(protected _composer: ComposerService,\n                settingsService: SettingsService) {\n        super(_composer, settingsService);\n        this._name = 'Catering Menu';\n        this._api_route = 'menu';\n    }\n\n    /**\n     * Convert user data to local format\n     * @param user User data\n     */\n    protected processItem(item: HashMap) {\n        return item.items ? new CateringCategory(item) : new CateringItem(item);\n    }\n}\n","\nimport { Injectable } from '@angular/core';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class CateringNotesService {\n\n    public cateringNotes = [];\n\n    \n    public setNotes(notes) {\n        this.cateringNotes = notes;\n    }\n\n    public getNotes() {\n        return this.cateringNotes;\n    }\n}","import { CateringItem } from './catering-item.class';\nimport { HashMap } from '@mckinsey-converge/base';\n\nimport { CateringCategory } from './catering-category.class';\nimport { Booking } from '../bookings';\n\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\nexport type CateringOrderMutableProperties =\n  | 'items'\n  | 'location_id'\n  | 'location'\n  | 'delivery_time'\n  | 'charge_code'\n  | 'notes'\n  | 'status';\n\nexport type CateringOrderStatus = 'accepted' | 'preparing' | 'ready' | 'delivered' | 'cancelled';\n\nconst now = DateNow(new Date());\n\n// R--- refactor booking date to be dateTz\nexport class CateringOrder {\n  /**\n   * Booking fields\n   * \n   * The app handles booking data inconsisently.  Ususally these booking fields are provided\n   * for related booking data, but on occasion the full Booking class is used.\n   */\n\n  /** Unique Booking ID for the catering order */\n  readonly booking_id: string;\n  /** \n   * Timestamp based booking time of the booking associated with the order\n   * \n   * Must be provide as the true Booking startDateTz or as a new DateTZ with \n   * the correct date: timestamp, local_tz = false and bulding_tz values\n   */\n  readonly booking_date: number;\n  /**\n   * Timezone of the booking associated with the order\n   */\n  readonly booking_timezone: string;\n  /** ID of the location to deliver the items to */\n  location_id: string = '';\n  /** Display text for the location to deliver the items to */\n  location: string = '';\n  /**\n   * Smart timezone aware catering datetime with timezone\n   */\n  readonly bookingDateTz: DateTZ;\n\n  /** \n   * Booking associated with the order \n   * \n   * The booking attached to the CateringOrder is a special case used \n   * mainly on the Concierge catering reports because someone created \n   * a bad pattern to save catering changes to the booking.  \n   * \n   * Avoid when possible.\n   */\n  public booking: Booking = null;\n\n  /**\n   * Catering specific fields\n   * \n   * The app handles booking data inconsisently.  Ususally these booking fields are provided\n   * for related booking data, but on occasion the full Booking class is used.\n   */\n\n  /** Whether the order status change is loading */\n  public loading: boolean;\n  /** Unique ID for the catering order */\n  readonly id: string;\n  /** Number of minutes after the start of the associated meeting to delivery the order */\n  readonly delivery_time: number = 0;\n  /** Status of the catering order */\n  readonly status: CateringOrderStatus;\n  /** Whether items in the order need to be prepared in the kitchen */\n  readonly kitchen: boolean;\n  /** Whether items in the order are in the pantry */\n  readonly pantry: boolean;\n  /** List of items */\n  readonly items: readonly (CateringItem | CateringCategory)[] = [];\n  /** Creation time of the order */\n  readonly created_at: number;\n  /** Charge code associated with the order */\n  readonly charge_code: string;\n  /** Notes associated with the order */\n  readonly notes: string;\n  // /** Mapping of properties to their changes */\n  // private _changes: HashMap = {};\n  /** Map of local property names to server ones */\n  protected _server_names: HashMap<string> = {};\n  /** Currency code for the location of the order */\n  public symbol: string;\n  /** Whether the is an error with the order */\n  public error: boolean;\n\n\n  constructor(data: HashMap) {\n    /** \n     * Setup Defaults when raw_data values are not provided\n     */\n    const nowTz = DateNow(new Date());\n    // now rounded to the next 5 minute increment\n    const defaultStartTz = nowTz.setValue({ minute: Math.ceil(nowTz.minutes / 5) * 5 });\n    const defaultLocalTimezone = Intl?.DateTimeFormat()?.resolvedOptions()?.timeZone;\n\n    this.id = data.id || `order-${Math.floor(Math.random() * 999_999_999)}`;\n\n    // If the booking is provided default the booking values to the true booking values\n    this.booking = data.booking || null;\n\n    \n    // Has a booking so init with those values\n    if (this.hasBookingAttached) {\n      this.booking_date = this.booking.startDateTz.ms;\n      this.booking_timezone = this.booking.timezone;\n      this.bookingDateTz = this.booking.startDateTz;\n      this.location_id = data.location_id || '';\n      this.location = data.location || '';\n    } else {\n      this.booking_date = data.booking_date || defaultStartTz.ms;\n      this.booking_timezone = data.booking_timezone || defaultLocalTimezone;\n      this.bookingDateTz = new DateTZ({ date: this.booking_date, is_local_tz: false, building_tz: this.booking_timezone });\n      this.location_id = data.location_id || '';\n      this.location = data.location || '';\n    }\n    \n    this.delivery_time = typeof data.delivery_time === 'number' ? data.delivery_time : 0;\n    this.status = data.status || 'accepted';\n    this.charge_code = data.charge_code || data.code;\n    this.notes = data.notes;\n    this.kitchen = data.kitchen instanceof Array ? !!data.kitchen.length : data.kitchen;\n    this.pantry = data.pantry instanceof Array ? !!data.pantry.length : data.pantry;\n    this.symbol = data.symbol || 'USD';\n    this.items = (data.items || [])\n      .map(item => (item.items ? new CateringCategory(item) : new CateringItem(item)))\n      .filter(item => !!item.amount);\n  }\n\n  /** Special Case, check if a full booking is attached */\n  public get hasBookingAttached(): boolean {\n    return !!this.booking;\n  }\n\n  /** Display string for the types of items in the order */\n  public get type(): string {\n    let type = '';\n    /* istanbul ignore else */\n    if (this.kitchen) type += 'Kitchen';\n    /* istanbul ignore else */\n    if (this.pantry) {\n      /* istanbul ignore else */\n      if (type) type += ' + ';\n      type += 'Pantry';\n    }\n    return type;\n  }\n\n  /** Total cost of the order */\n  public get total(): number {\n    return this.items.reduce((total, item) => total + (item.total || 0), 0);\n  }\n\n  /** Total number of items in the order */\n  public get item_count(): number {\n    return this.items.reduce((total, item) => total + (item.amount || 0), 0);\n  }\n\n  public get deliver_date(): DateTZ {\n    return (this.bookingDateTz || this.booking?.startDateTz).addValue({ minutes: this.delivery_time })\n  }\n\n  /** Display string for the delivery time of the order (short version) */\n  public get deliver_at(): string {\n    return this.deliver_date.formatDate('h:mm a');\n  }\n\n  /** Display string for the delivery time of the order */\n  public get deliver_at_time(): string {\n    return this.deliver_date.formatDate('h:mma').toLocaleLowerCase();\n  }\n\n  /** Display string for the delivery date of the order */\n  public get deliver_on_date(): string {\n    return this.deliver_date.formatDate('dd MMM yyyy');\n  }\n\n  /**\n   * Make a copy of this object\n   */\n  public clone(): CateringOrder {\n      return new CateringOrder(this.toJSON());\n  }\n\n  /**\n   * Convert class object into plain object\n   */\n  public toJSON(this: CateringOrder): HashMap {\n    const obj: any = { ...this };\n    // Remove local private members\n    delete obj._server_names;\n    // Remove local public members\n    delete obj.booking;\n    delete obj.loading;\n    delete obj.bookingDateTz;\n\n    // Convert remaining members to be public\n    const keys = Object.keys(obj);\n    for (const key of keys) {\n      if (key[0] === '_') {\n        const new_key = this._server_names[key.substr(1)] || key.substr(1);\n        obj[new_key] = obj[key];\n        delete obj[key];\n      } else if (obj[key] === undefined) {\n        delete obj[key];\n      }\n    }\n    obj.items = obj.items.map((item: CateringItem) => item.toJSON());\n\n    return obj;\n  }\n}\n","import { CateringItem } from './catering-item.class';\n\nexport const mergeCateringItemWithFormData = (existing: CateringItem, override: any) =>\n    new CateringItem({\n        ...(existing instanceof CateringItem ? existing.toJSON() : existing),\n        ...override\n    });\n","export * from './catering-item.class';\nexport * from './catering-category.class';\nexport * from './catering-menu.service';\nexport * from './catering-order.class';\nexport * from './catering-categories.service';\nexport * from './catering-items.service';\nexport * from './catering.utilities';\nexport * from './catering-notes.service';\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n  imports: [CommonModule],\n})\nexport class DataCommonModule {}\n","import { Injectable } from '@angular/core';\nimport {\n  BehaviorSubject,\n  Observable,\n  Subscription\n} from 'rxjs';\n\nimport {\n  HashMap,\n  unique\n} from '@mckinsey-converge/base';\n\n/** List of keys that cannot be in a combination by themselves or with each other */\nconst INVALID_STANDALONE_KEYS: string[] = ['control', 'shift', 'alt', 'meta', 'os'];\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class HotkeysService {\n  /** Map of subjects which store press states of keys */\n  private keydown_states: HashMap<BehaviorSubject<number>> = {};\n  /** Map of obserers for key state subjects */\n  private keydown_observers: HashMap<Observable<number>> = {};\n  /** List of keys at the end of a combination */\n  private combo_end: string[] = [];\n  /** List of registered hotkey combinations */\n  private registered_combos: string[][] = [];\n  /** Counter for the number of keydown events. Used for checking order of key presses */\n  private counter: number = 0;\n  /** Last key code to be pressed */\n  private last_down: string;\n\n  constructor() {\n    window.addEventListener('keydown', (event: KeyboardEvent) => {\n      const code = this.mapKey((event.code || '').toLowerCase());\n      /* istanbul ignore else */\n      if (this.last_down !== code) {\n        /* istanbul ignore else */\n        if (!this.keydown_states[code]) {\n          this.keydown_states[code] = new BehaviorSubject(null);\n          this.keydown_observers[code] = this.keydown_states[code].asObservable();\n        }\n        this.keydown_states[code].next(++this.counter);\n        /* istanbul ignore else */\n        if (this.combo_end.indexOf(code) >= 0) {\n          event.preventDefault();\n        }\n        this.last_down = code;\n      }\n    });\n\n    window.addEventListener('keyup', (event: KeyboardEvent) => {\n      const code = this.mapKey((event.code || '').toLowerCase());\n      /* istanbul ignore else */\n      if (this.keydown_states[code]) {\n        this.keydown_states[code].next(null);\n      }\n      /* istanbul ignore else */\n      if (this.last_down === code) {\n        this.last_down = null;\n      }\n    });\n  }\n\n  /**\n   * Listen to the given key combination\n   * @param combo Array of key codes to listen to or a hotkey string e.g. `Alt+Shift+KeyK`\n   * @param next Callback for combination presses\n   */\n  public listen(combo: string | string[], next: () => void): Subscription {\n    combo = (combo instanceof Array ? combo : combo.split('+'));\n    const combination: string[] = combo.map(i => this.mapKey(i.toLowerCase()));\n    /* istanbul ignore else */\n    if (combination.length > 0 && this.validCombination(combination)) {\n      this.registered_combos.push(combination);\n      const last_key = combination[combination.length - 1];\n      /* istanbul ignore else */\n      if (!this.keydown_states[last_key]) {\n        this.keydown_states[last_key] = new BehaviorSubject(null);\n        this.keydown_observers[last_key] = this.keydown_states[last_key].asObservable();\n      }\n      this.updateCombinationEndList();\n      return this.keydown_observers[last_key].subscribe((count) => {\n        /* istanbul ignore else */\n        if (count) {\n          const presses: number[] = [];\n          /* istanbul ignore else */\n          if (combination.length > 0) {\n            // Check that keys are pressed\n            for (const key of combination) {\n              const state = this.keydown_states[key];\n              presses.push(state ? state.getValue() || -1 : -1);\n            }\n            // Check that keys are pressed in the correct order\n            for (let i = 0; i < combination.length - 1; i++) {\n              if (presses[i] > presses[i + 1]) {\n                return;\n              }\n            }\n          }\n          const total = presses.reduce((a, v) => a + (v > 0 ? 1 : -1), 0);\n          /* istanbul ignore else */\n          if (total >= combination.length) {\n            next();\n          }\n        }\n      });\n    }\n    return null;\n  }\n\n  /**\n   * Map key codes with multiple versions to simple form\n   * @param code Code to transform\n   */\n  private mapKey(code: string): string {\n    /* istanbul ignore else */\n    if (code.indexOf('alt') >= 0 || code.indexOf('shift') >= 0 || code.indexOf('control') >= 0) {\n      return code.replace('left', '').replace('right', '');\n    }\n    return code;\n  }\n\n  /**\n   * Update the list of the last keys in combinations to allow for prevent default actions on pre-existing hotkeys\n   */\n  private updateCombinationEndList(): void {\n    const key_list = [];\n    for (const combo of this.registered_combos) {\n      this.combo_end.push(combo[combo.length - 1]);\n    }\n    this.combo_end = unique(key_list);\n  }\n\n  /**\n   * Checks if the given hotkey combination is allowed and valid\n   * @param combo Array of key codes\n   */\n  private validCombination(combo: string[]): boolean {\n    let non_meta = 0;\n    for (const key of combo) {\n      /* istanbul ignore else */\n      if (INVALID_STANDALONE_KEYS.indexOf(key) < 0) {\n        non_meta++;\n      }\n    }\n    return non_meta > 0;\n  }\n}\n","export * from './location.class';\nexport * from './location.service';\n","import { HashMap } from '@mckinsey-converge/base';\n\nimport { Organisation } from '../organisation/organisation.class';\nimport {\n    ServiceLike,\n    ServiceManager\n} from '../service-manager.class';\nimport { BuildingLevel } from '../organisation/level.class';\n\nexport class MapLocation {\n  /** ID of the element on the associated map */\n  public readonly id?: string;\n  /** Name of the location */\n  public readonly name?: string;\n  /** X coordinate of the location */\n  public readonly x?: number;\n  /** Y coordinate of the location */\n  public readonly y?: number;\n  /** Level details for the location */\n  public readonly level: BuildingLevel;\n  /** Whether the position is fixed */\n  public readonly fixed: boolean;\n  /** Accuracy of the location when not fixed */\n  public readonly confidence?: number;\n  /** Whether location is at a desk */\n  public readonly at_desk?: boolean;\n  /** Whether location is set */\n  public readonly empty: boolean;\n\n  /** Service for managing model on the server */\n  protected get _service(): ServiceLike {\n    return ServiceManager.serviceFor(MapLocation);\n  }\n\n  /** Display string for the building and level of the location */\n  public get display(): string {\n    const service = ServiceManager.serviceFor(Organisation);\n    if (!service) {\n      return this.level.name;\n    }\n    const bld = service.buildings.find((bld) => bld.id === this.level.building_id);\n    return bld ? `${bld.name}, ${this.level.name}` : this.level.name;\n  }\n\n  /** Whether location is in a different building from the active one */\n  public get in_another_building(): boolean {\n    const service = ServiceManager.serviceFor(Organisation);\n    return service && service.building.id !== this.level.building_id;\n  }\n\n  constructor(raw_data: HashMap) {\n    this.id = raw_data.id || raw_data.map_id || raw_data.desk_id;\n    this.name = raw_data.name || '';\n    this.x = raw_data.x\n      ? Math.floor(this.normalise(raw_data.x, raw_data.x_max || 10000) * 10000)\n      : null;\n    this.y = raw_data.y\n      ? Math.floor(this.normalise(raw_data.y, raw_data.x_max || 10000) * 10000)\n      : null;\n    const service = ServiceManager.serviceFor(Organisation);\n    this.level =\n      raw_data.level instanceof BuildingLevel\n        ? raw_data.level\n        : service\n        ? service.levelWithID(raw_data.level)\n        : new BuildingLevel(raw_data.level);\n    this.fixed = this.x === null && this.y === null;\n    this.confidence = Math.max(5, Math.min(15, raw_data.confidence || 0));\n    this.at_desk = this.id && this.id.indexOf('area-') === 0;\n    this.empty = !(this.name && this.level && (this.id || this.x || this.y));\n  }\n\n  /** Normalise the given value within the max */\n  private normalise(value: number, max: number): number {\n    return value / (max * 1.0);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\n\nimport { BaseAPIService } from '../base.service';\nimport { MapLocation } from './location.class';\nimport { HashMap } from '@mckinsey-converge/base';\nimport { ServiceManager } from '../service-manager.class';\nimport { SettingsService } from '../settings.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class LocationService extends BaseAPIService {\n    constructor(protected _composer: ComposerService,\n                settingsService: SettingsService) {\n        super(_composer, settingsService);\n        ServiceManager.setService(MapLocation, this);\n        this._name = 'Location';\n        this._api_route = 'people';\n    }\n\n    public add(...args): never {\n        throw new Error('Create not allowed for location service')\n    }\n\n    public update(...args): never {\n        throw new Error('Update not allowed for location service')\n    }\n\n    public delete(...args): never {\n        throw new Error('Delete not allowed for location service')\n    }\n\n    public process(item: HashMap) {\n        return new MapLocation(item) as any;\n    }\n}\n","import { BaseDataClass } from '../base-api.class';\nimport {\n    getItemWithKeys,\n    HashMap,\n    Identity\n} from '@mckinsey-converge/base';\nimport { BuildingLevel } from './level.class';\nimport { BookingRule } from '../bookings';\nimport { ServiceManager } from '../service-manager.class';\n\nexport interface BuildingCity {\n    timezone: string\n    name: string\n}\n\nexport interface IBuildingRoleUser {\n    name: string;\n    email: string;\n    phone: string;\n}\n\nexport interface LockerMap {\n    [zone: string]: {\n        [area: string]: {\n            [type: string]: (string | boolean)[][];\n        };\n    };\n}\n\nexport interface ICoordinates {\n    longitude: number;\n    latitude: number;\n}\n\nexport interface LevelFeature {\n    id: string;\n    level_id: string;\n    name: string;\n}\n\nexport interface BookingRuleDetails {\n    /** List of booking rules details for the building */\n    readonly rules: readonly string[];\n    /** Custom booking rules for the map */\n    readonly map_rules?: readonly string[];\n    /** Custom booking rules for the map */\n    readonly other_rules?: readonly string[];\n    /** Contact email address for the building */\n    readonly contact?: string;\n    /** Information string to display before the rule listings */\n    readonly info?: string;\n    /** Link for more details */\n    readonly link?: { url?: string, name?: string };\n    /**\n     * Allow buildings to define their own rules formats where needed or for special messages.\n     */\n    readonly custom_html?: string;\n}\n\nexport class Building extends BaseDataClass {\n    /** Service for managing buildings */\n    protected get _service() {\n        return ServiceManager.serviceFor(Building);\n    }\n\n    /** Engine Zone ID for the building */\n    public readonly zone_id: string;\n    /** Organisation Code for the building */\n    public readonly code: string;\n    /** Geographical address of the building */\n    public readonly address: string;\n    /** Details about the booking rules for the building */\n    public readonly booking_details: BookingRuleDetails;\n    /** Details about the booking rules for the building */\n    public readonly booking_rules: HashMap<readonly BookingRule[]>;\n    /** Number of hour before a booking catering is restricted */\n    public readonly catering_restricted_from: number;\n    /** Currency code for the country assoicated with the building */\n    public readonly currency: string;\n    /** Map of fields that are required on the form */\n    public readonly required: HashMap<boolean>;\n    /** IANA timezone database string for the location the building resides  */\n    public readonly timezone: string;\n    /** Whether catering is available in this building */\n    public readonly has_catering: boolean;\n    /** ID of the system used for the holding bay */\n    public readonly holding_bay: string;\n    /** ID of the system used for standalone visitors bookings */\n    public readonly visitor_space: string;\n    /** List of zones to determine sort order spaces */\n    public readonly sort_order: readonly string[];\n    /** Searchable map features */\n    public readonly searchables: readonly LevelFeature[];\n    /** List of available extras for the building */\n    public readonly extras: readonly Identity[];\n    /** List of available extra equipment for loan at the building */\n    public readonly loan_items: readonly Identity[];\n    /** List of available levels for the building */\n    public readonly levels: readonly BuildingLevel[];\n    /** The city the building belongs in **/\n    public readonly city: string;\n\n    public readonly catering_hours: { readonly start: number, readonly end: number };\n    /** Map of custom settings for the building */\n    private _settings: HashMap;\n    /** Map of roles and list of the associated users */\n    private _roles: HashMap<IBuildingRoleUser[]>;\n    /** Map of the locker ID arrays */\n    private _lockers: LockerMap;\n    /** Map of important system ids for the building */\n    private _systems: HashMap<string>;\n    /** Map of important phone numbers for the building */\n    private _phone_numbers: HashMap<string>;\n    /** Globe coordiates for the build */\n    private _location: ICoordinates;\n    /** List of zones associated with the building */\n    public readonly zones: readonly string[];\n\n    constructor(raw_data: HashMap) {\n        super(raw_data);\n        const settings = raw_data.settings || {};\n        const disc_info = settings.discovery_info || {};\n        this.zone_id = raw_data.zone_id || raw_data.zone;\n        this.extras = (raw_data.extras || disc_info.extras || []).map(i => ({\n            id: i.extra_id || i.id,\n            name: i.extra_name || i.name\n        }));\n        this.loan_items = (raw_data.loan_items || disc_info.loan_items || []).map(i => ({\n            id: i.extra_id || i.id,\n            name: i.extra_name || i.name\n        }));\n        this.levels = (raw_data.levels || disc_info.levels || []).map(i => new BuildingLevel({\n            ...i,\n            building_id: this.id\n        }));\n        this._roles = raw_data.roles || disc_info.roles || {};\n        this._lockers = raw_data.lockers || raw_data.locker_structure || disc_info.locker_structure || {};\n        this._systems = raw_data.systems || disc_info.systems || {};\n        this._settings = settings;\n        this._phone_numbers = raw_data.phone_numbers || disc_info.phone_numbers || {};\n        this._location = raw_data.location || disc_info.location || { longitude: null, latitude: null };\n        this.catering_hours = raw_data.catering_hours || disc_info.catering_hours || settings.catering_hours || {\n            start: 7,\n            end: 20\n        };\n        const searchables = [];\n        if (raw_data.neighbourhoods) {\n            for (const lvl in raw_data.neighbourhoods) {\n                if (raw_data.neighbourhoods.hasOwnProperty(lvl)) {\n                    const lvl_features = raw_data.neighbourhoods[lvl] || {};\n                    for (const feature in lvl_features) {\n                        if (lvl_features.hasOwnProperty(feature)) {\n                            searchables.push({\n                                id: lvl_features[feature],\n                                name: feature,\n                                level_id: lvl\n                            });\n                        }\n                    }\n                }\n            }\n        }\n        this.searchables = searchables;\n        this.code = raw_data.code || disc_info.code || settings.code || '';\n        this.address = raw_data.address || disc_info.address || settings.address || '';\n        this.booking_details = raw_data.booking_details || disc_info.booking_details || settings.booking_details || {};\n        this.booking_rules = raw_data.booking_rules || disc_info.booking_rules || settings.booking_rules || {};\n        this.catering_restricted_from = raw_data.catering_restricted_from || disc_info.catering_restricted_from || settings.catering_restricted_from || 0;\n        this.currency = raw_data.currency || disc_info.currency || settings.currency || 'USD';\n        this.required = raw_data.required || disc_info.required || settings.required || {};\n        if (disc_info.requires_equipment_code) {\n            this.required.equipment_code = true;\n        }\n        if (disc_info.requires_expected_attendees) {\n            this.required.expected_attendees = true;\n        }\n        this.timezone = raw_data.timezone || disc_info.timezone || settings.timezone || '';\n        this.has_catering = raw_data.has_catering || disc_info.has_catering || settings.has_catering || false;\n        this.holding_bay = raw_data.holding_bay || disc_info.holding_bay || settings.holding_bay || '';\n        this.visitor_space = raw_data.visitor_space || disc_info.visitor_space || settings.visitor_space || '';\n        this.sort_order = raw_data.sort_order || disc_info.sort_order || settings.sort_order || [];\n        this.city = raw_data.city || disc_info.city || 'No City';\n    }\n\n    /**\n     * Get a custom building setting\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n     */\n    public setting(key: string): any {\n        const keys = key.split('.');\n        const value = getItemWithKeys(keys, this._settings) || getItemWithKeys(['discovery_info', ...keys], this._settings);\n        return value;\n    }\n\n    /**\n     * Get list of users with the associated role\n     * @param name Role to find users for\n     */\n    public role(name: string): IBuildingRoleUser[] {\n        return [...(this._roles[name] || [])];\n    }\n\n    /**\n     * Get list of the names of available user role lists\n     */\n    public get role_names(): string[] {\n        return Object.keys(this._roles).filter(i => this._roles.hasOwnProperty(i));\n    }\n\n    /** Map of the locker ID arrays */\n    public get lockers(): LockerMap {\n        return { ...(this._lockers || {}) };\n    }\n\n    /** Map of important system ids for the building */\n    public get systems(): HashMap<string> {\n        return { ...(this._systems || {}) };\n    }\n\n    /** Map of important phone numbers for the building */\n    public get phone_numbers(): HashMap<string> {\n        return { ...(this._phone_numbers || {}) };\n    }\n\n    /** Real coordinates */\n    public get location(): ICoordinates {\n        return { ...this._location };\n    }\n\n    /**\n     * Get search map feature for the given level ID\n     * @param level_id ID of level to grab features for\n     */\n    public featuresForLevel(level_id: string): LevelFeature[] {\n        return (this.searchables || []).filter(i => i.level_id === level_id);\n    }\n\n    /**\n     * Building objects are readonly and cannot be changed\n     */\n    public async save(): Promise<Building> {\n        throw new Error('Building objects are readonly and cannot be changed');\n    }\n\n    /**\n     * Building objects are readonly and cannot be deleted\n     */\n    public async delete(): Promise<void> {\n        throw new Error('Building objects are readonly and cannot be deleted');\n    }\n}\n","export * from './building.class';\nexport * from './level.class';\nexport * from './organisation.class';\nexport * from './organisation.service';\n","import { HashMap } from 'libs/base/src/lib/types.utilities';\n\n/** Building Level data */\nexport class BuildingLevel {\n    /** ID of the building level zone */\n    readonly id: string;\n    /** ID of the building zone associated with the level */\n    readonly building_id: string;\n    /** Name of the level */\n    readonly name: string;\n    /** Number or short identifier of the level */\n    readonly short_name: string;\n    /** Map URL for the level */\n    readonly map_url: string;\n    /** Usage type for the level */\n    readonly type: 'staff' | 'client' | 'any';\n    /** Setting for the level */\n    readonly settings: HashMap;\n\n    constructor(_data: HashMap = {}) {\n        this.id = _data.id || _data.level_id || '';\n        this.building_id = _data.bld_id || _data.building_id || '';\n        this.name = _data.name || _data.level_name || '';\n        const lower_name = this.name.toLowerCase();\n        const num = lower_name.indexOf('level') >= 0 ? lower_name.replace(/ ?level ?/gi, '') : lower_name.substr(0, 1).toUpperCase();\n        this.short_name = _data.short_name || num || '';\n        this.map_url = _data.map_url || '';\n        this.type = _data.type || _data.floor_type || 'any';\n        this.settings = _data.settings;\n    }\n}\n","import { BaseDataClass } from '../base-api.class';\nimport {\n  getItemWithKeys,\n  HashMap\n} from '@mckinsey-converge/base';\n\n/* istanbul ignore next */\n\nexport class Organisation extends BaseDataClass {\n  /** List of available building zone ids for the organisation */\n  public readonly available_buildings: readonly string[];\n  /** Map of custom settings for the building */\n  private _settings: HashMap;\n\n  constructor(raw_data: HashMap = {}) {\n    super(raw_data);\n    this._settings = raw_data.settings || {};\n    this.available_buildings = (raw_data.settings?.discovery_info?.buildings || []).map(\n      (bld) => bld.zone_id\n    );\n  }\n\n  /**\n   * Get a custom building setting\n   * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n   */\n  public setting(key: string): any {\n    const keys = key.split('.');\n    const value = getItemWithKeys(keys, this._settings);\n    return value;\n  }\n}\n","import { Injectable } from '@angular/core';\n\nimport { ComposerService } from '@placeos/composer';\n\nimport { BaseAPIService } from '../base.service';\nimport { Organisation } from './organisation.class';\nimport { Building } from './building.class';\nimport {\n  ApplicationLoadingState,\n  HashMap,\n  Identity\n} from '@mckinsey-converge/base';\nimport { BuildingLevel } from './level.class';\nimport { first } from 'rxjs/operators';\nimport { ApplicationService } from '../app.service';\nimport { ServiceManager } from '../service-manager.class';\nimport { UsersService } from '../users';\nimport { SettingsService } from '../settings.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class OrganisationService extends BaseAPIService {\n  /** Organisation data for the application */\n  private _organisation: Organisation;\n  /** Actively displayed building */\n  private _active_building: string;\n\n  constructor(\n    protected _composer: ComposerService,\n    private _service: ApplicationService,\n    private _users: UsersService,\n    settingsService: SettingsService,\n  ) {\n      super(_composer, settingsService);\n    ServiceManager.setService(Organisation, this);\n    ServiceManager.setService(Building, this);\n    this._name = 'Organisation';\n    this._api_route = 'zones';\n    this.set('buildings', []);\n    this.set('active_building', null);\n    this._users.initialised.pipe(first((_) => _)).subscribe(() => this.init());\n  }\n\n  /**\n   * Add is not available on organisation service\n   */\n  public async add(form_data: HashMap, query_params?: HashMap): Promise<Organisation> {\n    throw new Error('Add is not available on the organisation service');\n  }\n\n  /**\n   * Update is not available on organisation service\n   */\n  public async update(\n    id: string,\n    form_data: HashMap,\n    query_params?: HashMap\n  ): Promise<Organisation> {\n    throw new Error('Update is not available on the organisation service');\n  }\n\n  /**\n   * Delete is not available on organisation service\n   */\n  public async delete(id: string): Promise<void> {\n    throw new Error('Delete is not available on the organisation service');\n  }\n\n  /**\n   * Get list of levels for the given building ID\n   * @param bld_id Building ID\n   */\n  public levels(bld_id: string): readonly BuildingLevel[] {\n    return (this.buildings.find((i) => i.id === bld_id) || ({} as Building)).levels;\n  }\n\n  /**\n   * Get a setting from the organisation or active building\n   * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n   */\n  public setting(key: string) {\n    return this.building.setting(key) || this._organisation.setting(key);\n  }\n\n  /** Active building */\n  public get building(): Building {\n    return this.buildings.find((i) => i.id === this._active_building);\n  }\n\n  /** List of types of spaces */\n  public get space_types(): Identity[] {\n    return this.get('space_types') || [];\n  }\n\n  public set building(bld: Building) {\n    if (bld instanceof Building) {\n      this._active_building = bld.id;\n    } else {\n      this._active_building = bld;\n    }\n    this.set('active_building', this.building);\n    localStorage.setItem('PlaceOS.building', this._active_building);\n    localStorage.setItem('CONCIERGE.timezone', bld.timezone);\n  }\n\n  /** List of buildings for the organisation */\n  public get buildings(): Building[] {\n    return this.get<Building[]>('buildings') || [];\n  }\n\n  /**\n   * Get list of available equipment\n   * @param id ID of the building to get the list from. i.e. Defaults to the active building\n   */\n  public getExtras(id: string, bld_id?: string) {\n    const bld = this.buildings.find((i) => i.id === bld_id) || this.building;\n    if (bld && id) {\n      return bld.extras.filter((i) => `${i.id}`.indexOf(id) >= 0);\n    }\n    return [];\n  }\n\n  /**\n   * Get the first level matching the list of given IDs\n   * @param ids List of ID to search with\n   */\n  public levelWithID(ids: string | string[]): BuildingLevel {\n    const list = ids instanceof Array ? ids : [ids];\n    const bld_list = this.buildings;\n    for (const id of list) {\n      for (const bld of bld_list) {\n        for (const lvl of bld.levels) {\n          if (lvl.id === id) {\n            return lvl;\n          }\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Initialise service data\n   */\n  protected async load(): Promise<void> {\n    /* istanbul ignore else */\n    if (localStorage) {\n      this._active_building = localStorage.getItem(`${this.settingsService.frontend.toUpperCase()}.building`);\n    }\n    const loading: ApplicationLoadingState = this._service.get('loading') || {};\n    loading.organisation = { message: 'Loading organisation data', state: 'loading' };\n    await this.loadOrganisation();\n    loading.organisation = { message: 'Loading organisation data', state: 'complete' };\n    loading.buildings = { message: 'Loading building data', state: 'loading' };\n    this._service.set('loading', loading);\n    await this.loadBuildings();\n    loading.buildings = { message: 'Loading building data', state: 'complete' };\n    loading.levels = { message: 'Loading building floor data', state: 'loading' };\n    this._service.set('loading', loading);\n    await this.loadLevels();\n    loading.levels = { message: 'Loading building floor data', state: 'complete' };\n    this._service.set('loading', loading);\n    loading.space_types = { message: 'Loading space type data', state: 'loading' };\n    this._service.set('loading', loading);\n    await this.loadSpaceTypes();\n    loading.space_types = { message: 'Loading space type data', state: 'complete' };\n    this._service.set('loading', loading);\n    const user = this._users.current;\n\n    if (user) {\n      const id = localStorage.getItem('PlaceOS.building');\n      const building = this.buildings.find(bld => id && bld.id === id) || this.buildings.find((bld) => bld.code === user.location);\n      if (building) {\n        this._active_building = building.id;\n        this.set('active_building', building);\n      } else if(this.building) {\n        // This conditional solves a problem of infinite loop when user building doesn't exist.\n        this._active_building = this.building.id;\n        this.set('active_building', this.building);\n      }\n    }\n  }\n\n  /**\n   * Load organisation data for application\n   */\n  public async loadOrganisation(): Promise<Organisation> {\n    const org_data = await this.query({ tags: 'org', engine: true });\n    this._organisation = new Organisation(org_data[0]);\n    this.set('organisation', this._organisation);\n    return this._organisation;\n  }\n\n  /**\n   * Load building data for the organisation already stored in the service..\n   */\n  public async loadBuildings(): Promise<Building[]> {\n    return this.loadBuildingsWithOrg(this._organisation);\n  }\n\n  /**\n   * Load building data for the organisation passed.\n   */\n  public async loadBuildingsWithOrg(organisation: Organisation): Promise<Building[]> {\n    const bld_data = await this.query({ tags: 'building', engine: true, limit: 1000 });\n    const buildings = (bld_data as HashMap[])\n      .map((i) => new Building(i))\n      .filter((bld) => organisation.available_buildings.includes(bld.id));\n    this.set('buildings', buildings);\n    /* istanbul ignore else */\n    if (!this._active_building && buildings && buildings.length > 0) {\n      this._active_building = buildings[0].id;\n    }\n    return buildings;\n  }\n\n  /**\n   * Load level data for the buildings\n   */\n  public async loadLevels(): Promise<BuildingLevel[]> {\n    const lvl_data = await this.query({ tags: 'level', engine: true, limit: 1000 });\n    const levels = (lvl_data as HashMap[]).map((i) => new BuildingLevel(i));\n    this.set('levels', levels);\n    return levels;\n  }\n\n  /**\n   * Load space type data for the buildings\n   */\n  public async loadSpaceTypes(): Promise<void> {\n    const type_data = await this.query({ tags: 'room', engine: true, limit: 1000 });\n    const types = (type_data as HashMap[]).map((i) => ({ id: i.id, name: i.name }));\n    this.set('space_types', types);\n  }\n\n  public getOrganizationFiltersByRoomType(key: string) {\n    if (!this._organisation) {\n      return {}\n    }\n    const discovery_info = this._organisation.setting('discovery_info')\n\n    return discovery_info && discovery_info[key] ? discovery_info[key] : {}\n  }\n\n  public getRoomTypeSubsetDDOptions(type:string) {\n    const filters = this.getOrganizationFiltersByRoomType(type) || {}\n    return [...Object.keys(filters).map((key) => {\n        const display = filters[key].toString();\n        return {\n            display,\n            value: key,\n            meta: {}\n        }\n    }) ];\n  }\n\n}\n","import { ComposerService } from '@placeos/composer';\nimport { BehaviorSubject, Observable, of, Subject, Subscriber } from 'rxjs';\n\nimport { BaseAPIService } from './base.service';\nimport { BaseClass, HashMap } from '@mckinsey-converge/base';\nimport { ApplicationService } from './app.service';\nimport { toQueryString } from './api.utilities';\nimport { SettingsService } from './settings.service';\nimport { catchError, map } from 'rxjs/operators';\n\nexport interface IEngineResponse {\n  results: HashMap[];\n  total: number;\n}\n\nexport class PaginatedAPIService<T extends {} = BaseAPIService> extends BaseClass {\n  /** Application service */\n  public parent: ApplicationService;\n  /** Display name of the service */\n  protected _name: string;\n  /** API Route of the service */\n  protected _api_route: string;\n  /** Map of state variables for Service */\n  protected _subjects: { [key: string]: BehaviorSubject<any> | Subject<any> } = {};\n  /** Map of observables for state variables */\n  protected _observers: { [key: string]: Observable<any> } = {};\n  /** Map of poll subscribers for API endpoints */\n  protected _subscribers: { [key: string]: Subscriber<any> } = {};\n  /** Map of promises for Service */\n  protected _promises: { [key: string]: Promise<any> } = {};\n  /** Comparison function for service items */\n  protected _compare: (a: T, b: T) => boolean = (a, b) =>\n    a === b || (a as any).id === (b as any).id;\n  /** Default filter function for list method */\n  protected _list_filter: (a: T) => boolean = (a) => !!a;\n\n  /** Http Client */\n  protected get http() {\n    return this._composer.http;\n  }\n\n  constructor(protected _composer: ComposerService,\n              protected settingsService: SettingsService) {\n    super();\n    this._name = 'Base';\n    this._api_route = 'base';\n    this.set('list', []);\n  }\n\n  /**\n   * Injects concierge into form_data.\n   */\n  private injectConcierge(form_data: HashMap) {\n      // we only send it over when concierge, since the BE may check for presence rather than\n      // if its true or not.\n      if (this.settingsService.concierge) {\n          return { ...form_data, concierge: true }\n      }\n      return form_data;\n  }\n\n  /**\n   * Initailise service\n   */\n  public init() {\n    this.load().then(\n      (_) => this._initialised.next(true),\n      (err) => this.timeout('init', () => this.init(), 1000)\n    );\n  }\n\n  /**\n   * Get API route for the service\n   * @param engine Whether endpoint is using the application API or engine API\n   */\n  public route(engine: boolean = false) {\n    const endpoint = engine\n      ? this._composer.auth.api_endpoint\n      : '/api/staff';\n    return `${endpoint}/${this._api_route}`;\n  }\n\n  /** API Route of the service */\n  public get api_route() {\n    return this._api_route;\n  }\n\n  /**\n   * Get the current value of the named property\n   * @param name Property name\n   */\n  public get<U = any>(name: string): U {\n    if (!this._observers[name]) {\n      this.set<U>(name, null);\n    }\n    return (this._subjects[name] as BehaviorSubject<U>).getValue();\n  }\n\n  /**\n   * Listen to value change of the named property\n   * @param name Property name\n   * @param next Callback for value changes\n   */\n  public listen<U = any>(name: string): Observable<U> {\n    if (!this._observers[name]) {\n      this.set<U>(name, null);\n    }\n    return this._observers[name];\n  }\n\n  /**\n   * Update the value of the named property\n   * @param name Property name\n   * @param value New value\n   */\n  protected set<U = any>(name: string, value: U): void {\n    if (!this._subjects[name]) {\n      this._subjects[name] = new BehaviorSubject<U>(value);\n      this._observers[name] = this._subjects[name].asObservable();\n    } else {\n      this._subjects[name].next(value);\n    }\n  }\n\n  /**\n   * Get list of loaded items\n   * @param predicate Function for filtering the list\n   */\n  public filter(predicate: (a: T) => boolean = this._list_filter): T[] {\n        const list: T[] = this.get('list');\n        return list.filter(predicate);\n  }\n\n  /**\n   * Get item with the given id from the loaded items\n   * @param id ID of the item\n   */\n  public find(id: string): T {\n    const list = this.get('list');\n    return list.find((i) => i.id === id || (i.email?.toLowerCase() === id?.toLowerCase()));\n  }\n\n  /**\n   * Query the index of the API route associated with this service\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public query(query_params: HashMap = {}, config: { url?: string } = {}): Promise<T> {\n    let engine = false;\n    let cache = 1000;\n    /* istanbul ignore else */\n    if (query_params) {\n      engine = !!query_params.engine;\n      delete query_params.engine;\n      cache = query_params.cache || 1000;\n      delete query_params.cache;\n    }\n    const query = toQueryString(query_params);\n    const key = `query|${query}`;\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise((resolve, reject) => {\n        const url = config && config.url ? `${config.url}${query ? '?' + query : ''}` : `${this.route(engine)}${query ? '?' + query : ''}`;\n        let result: IEngineResponse;\n        this.http.get(url).subscribe(\n          (d: IEngineResponse | HashMap[]) => {\n            if (d && d instanceof Array) {\n              const results = d.map((i) => this.process(i));\n              result = {\n                results,\n                total: results.length,\n              }\n            } else if (d && !(d instanceof Array) && d.results && d.total) {\n              const results = d.results.map((i) => this.process(i));\n              result = {\n                results,\n                total: d.total,\n              }\n            } else if (d && !(d instanceof Array) && d.results) {\n              const results = d.results.map((i) => this.process(i));\n              result = {\n                results,\n                total: results.length,\n              }\n            } else {\n              result = {\n                results: [],\n                total: 0,\n              }\n            }\n          },\n          (e) => {\n            reject(e);\n            this._promises[key] = null;\n          },\n          () => {\n            resolve(result);\n            this.timeout(key, () => (this._promises[key] = null), cache);\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n  /**\n   * \n   * @param query_params \n   * @param config \n   * @returns \n   */\n  queryHoldingBay(query_params: HashMap = {}, config: { url?: string } = {}):Observable<any> {\n    const query = toQueryString(query_params);\n    const url =  `${config.url}${query ? '?' + query : ''}`;\n    return this.http.get(url).pipe(\n      map((d: IEngineResponse | HashMap[]) =>  this.processApiResult(d) ),\n      catchError(<T>(error: any, result?: T) => {\n        console.log(error);\n        return of(result as T);\n        })\n    );\n  }\n\n  /**\n   * \n   * @param d \n   * @returns \n   */\n  processApiResult(d: IEngineResponse | HashMap[]): IEngineResponse{\n    let result: IEngineResponse;\n    if (d && d instanceof Array) {\n      const results = d.map((i) => this.process(i));\n      result = {\n        results,\n        total: results.length,\n      }\n    } else if (d && !(d instanceof Array) && d.results && d.total) {\n      const results = d.results.map((i) => this.process(i));\n      result = {\n        results,\n        total: d.total,\n      }\n    } else if (d && !(d instanceof Array) && d.results) {\n      const results = d.results.map((i) => this.process(i));\n      result = {\n        results,\n        total: results.length,\n      }\n    } else {\n      result = {\n        results: [],\n        total: 0,\n      }\n    }\n    return result;\n  }\n  \n\n  /**\n   * Query the API route for a sepecific item\n   * @param id ID of the item\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public show(id: string, query_params: HashMap = {}): Promise<T> {\n    let engine = false;\n    /* istanbul ignore else */\n    if (query_params) {\n      engine = !!query_params.engine;\n      delete query_params.engine;\n    }\n    const query = toQueryString(query_params);\n    const key = `show|${id}|${query}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<T>((resolve, reject) => {\n        const url = `${this.route(engine)}/${id}${query ? '?' + query : ''}`;\n        let result: T = null;\n        this.http.get(url).subscribe(\n          (d) => {\n            result = this.process(d);            \n          },\n          (e) => {\n            reject(e);\n            this._promises.new_item = null;\n          },\n          () => {\n            resolve(result);\n            this.timeout(key, () => (this._promises[key] = null), 1000);\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n  /**\n   * Make post request for a new item to the service\n   * @param form_data Data to post to the server\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public add(form_data: HashMap, query_params: HashMap = {}): Promise<T> {\n    /* istanbul ignore else */\n    if (!this._promises.new_item) {\n      this._promises.new_item = new Promise<T>((resolve, reject) => {\n        const query = toQueryString(query_params);\n        const url = `${this.route(query_params.engine)}${query ? '?' + query : ''}`;\n        let result: T = null;\n        this.http.post(url, this.injectConcierge(form_data)).subscribe(\n          (d) => (result = this.process(d)),\n          (e) => {\n            reject(e);\n            this.analyticsEvent(`create-${this._name.toLowerCase()}-failed`);\n            this._promises.new_item = null;\n          },\n          () => {\n            resolve(result);\n            this.set('list', this.updateList(this.get('list'), [result]));\n            this.analyticsEvent(`create-${this._name.toLowerCase()}-success`);\n            this._promises.new_item = null;\n          }\n        );\n      });\n    }\n    return this._promises.new_item;\n  }\n\n  /**\n   * Perform API task for the given item ID\n   * @param id ID of the item\n   * @param task_name Name of the task\n   * @param form_data Map of data to pass to the API\n   * @param method Verb to use for request\n   */\n  public task<U = any>(\n    id: string,\n    task_name: string,\n    form_data: HashMap = {},\n    method: 'post' | 'get' = 'post'\n  ): Promise<U> {\n    const query = toQueryString(this.injectConcierge(form_data));\n    const key = `task|${id}|${task_name}|${query}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<U>((resolve, reject) => {\n        const post_data = { ...form_data, id, _task: task_name };\n        const url = `${this.route(false)}/${id}/${task_name}`;\n        let result: any;\n        const request =\n          method === 'post'\n            ? this.http.post(url, post_data)\n            : this.http.get(`${url}${query ? '?' + query : ''}`);\n        request.subscribe(\n          (d) => (result = d),\n          (e) => {\n            reject(e);\n            this.analyticsEvent(\n              `${this._name.toLowerCase()}-task-${task_name}-failed`,\n              id\n            );\n            delete this._promises[key];\n          },\n          () => {\n            resolve(result as U);\n            this.analyticsEvent(\n              `${this._name.toLowerCase()}-task-${task_name}-success`,\n              id\n            );\n            this.timeout(key, () => delete this._promises[key], 1000);\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n\n  /**\n   * Make put request for changes to the item with the given id\n   * @param id ID of the item being updated\n   * @param form_data New values for the item\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public update(id: string, form_data: HashMap, query_params: HashMap = {}): Promise<T> {\n    const key = `update|${id}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<T>((resolve, reject) => {\n        const query = toQueryString(this.injectConcierge(query_params));\n        const url = `${this.route(query_params.engine)}/${id}${query ? '?' + query : ''}`;\n        let result: T = null;\n        this.http.put(url, this.injectConcierge(form_data)).subscribe(\n          (d) => (result = this.process(d)),\n          (e) => {\n            reject(e);\n            this.analyticsEvent(`update-${this._name.toLowerCase()}-failed`, id);\n            this._promises[key] = null;\n          },\n          () => {\n            resolve(result);\n            this.set(\n              'list',\n              this.updateList(this.removeItem(this.get('list'), { id } as any), [\n                result\n              ])\n            );\n            this.analyticsEvent(`update-${this._name.toLowerCase()}-success`, id);\n            this._promises[key] = null;\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n  /**\n   * Make delete request for the given item\n   * @param id ID of item\n   */\n  public delete(id: string, q: HashMap = {}): Promise<void> {\n    const key = `delete|${id}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<void>((resolve, reject) => {\n        const query = toQueryString(q);\n        const url = `${this.route()}/${id}${query ? '?' + query : ''}`;\n        this.http.delete(url).subscribe(\n          (_) => null,\n          (e) => {\n            reject(e);\n            this._promises[key] = null;\n          },\n          () => {\n            this.set('list', this.removeItem(this.get('list'), { id } as any));\n            this._promises[key] = null;\n            resolve();\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n  /**\n   * Load initial data for the service\n   */\n  protected async load(): Promise<void> {\n  }\n\n  /**\n   * Post analytics event for this service\n   * @param action Name of the action to post\n   */\n  protected analyticsEvent(action: string, label?: string) {\n    // if (this.parent && this.parent.Analytics) {\n    //     this.parent.Analytics.track(this._name, { desc: `${this.parent.name.toLowerCase()}-${action}`, label });\n    // }\n  }\n\n  /**\n   * Convert raw API data into a valid API Object\n   * @param raw_item Raw API data\n   */\n  protected process(raw_item: HashMap): T {\n    return raw_item as T;\n  }\n\n  /**\n   * Update recorded list of items\n   * @param old_list Old list of items\n   * @param list List of updated items\n   * @param compareFn Function to compare items to remove duplicates\n   */\n  public updateList(\n    old_list: T[],\n    list: T[],\n    compareFn: (a: T, b: T) => boolean = this._compare\n  ): T[] {\n    /* istanbul ignore else */\n    if (!list || list.length === 0) {\n      return old_list;\n    }\n    const new_list: T[] = [];\n    const mixed_list = [...list, ...old_list];\n    /* istanbul ignore else */\n    if (!compareFn) {\n      compareFn = this._compare;\n    }\n    for (const item of mixed_list) {\n      const found = new_list.find((i) => compareFn(i, item));\n      /* istanbul ignore else */\n      if (!found) {\n        new_list.push(item);\n      }\n    }\n    return new_list;\n  }\n\n  /**\n   * Remove the given item from the given list\n   * @param list List of items\n   * @param item Item to remove\n   * @param compareFn Function to compare items\n   */\n  protected removeItem(list: T[], item: T, compareFn?: (a: T, b: T) => boolean) {\n    const new_list = [];\n    /* istanbul ignore else */\n    if (!compareFn) {\n      compareFn = this._compare;\n    }\n    list.forEach((i) => (compareFn(item, i) ? null : new_list.push(i)));\n    return new_list;\n  }\n}\n","import { FormGroup } from \"@angular/forms\";\nimport { HashMap } from \"@mckinsey-converge/base\"\nimport { DateNow, DateTZ } from \"@mckinsey-converge/date-tz\"\n\nexport enum RecurrencePeriod {\n    LIST = 'list',\n    DAILY = 'daily',\n    WEEKLY = 'weekly',\n    //RELATIVE_MONTHLY = 'relativeMonthly', for the moment we will only support absoluteMonthly\n    ABSOLUTE_MONTHLY = 'monthly'\n}\n\nexport enum DaysOfWeek {\n    SUNDAY = 'sunday',\n    MONDAY = 'monday',\n    TUESDAY = 'tuesday',\n    WEDNESDAY = 'wednesday',\n    THURSDAY = 'thursday',\n    FRIDAY = 'friday',\n    SATURDAY = 'saturday'\n\n}\n\nexport enum SeriesAction {\n    EDIT = 'edit',\n    CLONE = 'clone'\n}\n\nexport enum BookingAction {\n    CLONE = 'booking_clone',\n    EDIT = 'booking_edit'\n}\n\nexport interface WeekDays {\n    id: string;\n    active: boolean;\n    day_index: number;\n    full_name: string;\n}\n\nexport interface RepeatPeriod {\n    id: RecurrencePeriod;\n    label: string\n}\n\nexport enum RepeatsOn {\n    PATTERN = 'pattern',\n    DATE = 'date'\n}\n\nexport interface RecurrenceType {\n    type: RepeatsOn;\n    label: string;\n}\n\nexport interface RecurrenceDetails {\n    period: RecurrencePeriod,\n    end: DateTZ,\n    list: Array<DateTZ>\n    interval: number\n}\n\nexport interface RecurrenceRecurringDetails extends RecurrenceDetails {\n    start: number\n}\n\nexport const recurrencePeriodToDurationType = (period: RecurrencePeriod) =>{\n    switch (period) {\n        case RecurrencePeriod.DAILY:\n            return 'days'\n        case RecurrencePeriod.WEEKLY:\n            return 'weeks' \n        case RecurrencePeriod.ABSOLUTE_MONTHLY:\n            return 'months' \n        default:\n            return 'days'\n    }\n}\n\n/**\n * Generate weekdays from monday to saturday\n */\nexport const generateWeekDays = (date: number, params: { building_tz?: string } = {}): Array<WeekDays>=> {\n    const { building_tz } = params;\n    let start_week = DateNow(new Date()).startOfValue('week').addValue({days : 1}); //set monday as start of week\n    const week_days: Array<WeekDays> = []\n    for (let i = 1; i <= 7; i++) {\n        const activeDate = new DateTZ({date, building_tz, is_local_tz: false })\n        const active = activeDate.dateWeekday === i\n        const full_name = start_week.formatDate('EEEE')\n        const day_index = i === 7 ? 0 : i //Sunday must be indexed as day 0\n        week_days.push({id: full_name.substring(0, 1), active, day_index, full_name: full_name.toLocaleLowerCase()});\n        start_week = start_week.addValue({ days : 1 });\n    }\n    return week_days\n}\n\nexport const getFirstDateFromList = (list: Array<DateTZ>) => {\n    return list.reduce((a, b) => { return a.isBeforeDate(b) ? a : b; });\n}\n\nexport const getLastDateFromList = (list: Array<DateTZ>) => {\n    return list.reduce((a, b) => { return a.isAfterDate(b) ? a : b; });\n}\n\nexport const recurrenceDetails = (recurr: RecurrenceDetails): string => {\n    const end = getLastDateFromList(recurr.list).formatDate('ccc dd MMM yyyy')\n    const getPeriod = (period: string) => {\n        if(recurr.interval === 1){\n            return `Occurs Every ${period} until ${end}`\n        }else{\n            return `Occurs Every ${recurr.interval} ${period}s until ${end}`\n        }\n    } \n    \n    switch (recurr.period) {\n        case RecurrencePeriod.DAILY:\n            return getPeriod('Day')\n        case RecurrencePeriod.WEEKLY:\n            return getPeriod('Week')\n        case RecurrencePeriod.ABSOLUTE_MONTHLY:\n            return getPeriod('Month')\n        case RecurrencePeriod.LIST:\n            return `Occurs on Specific Dates until ${getLastDateFromList(recurr.list).formatDate('ccc dd MMM yyyy')}`\n        default:\n            return ''\n    }\n}\n\nexport const recurrenceRecurringDetails = (recurr: RecurrenceRecurringDetails): string => {\n    const end = recurr.end\n    const start = new DateTZ({ date: recurr.start })\n\n    const getPeriod = (period: string) => {\n        if(recurr.interval === 1){\n            return `occurs every ${period} effective ${start.formatDate('dd MMM yyyy')} until ${end.formatDate('dd MMM yyyy')}`\n        }else{\n            return `occurs every ${recurr.interval} ${period}s effective ${start.formatDate('dd MMM yyyy')} until ${end.formatDate('dd MMM yyyy')}`\n        }\n    }\n\n    switch (recurr.period) {\n        case RecurrencePeriod.DAILY:\n            return getPeriod('Day')\n        case RecurrencePeriod.WEEKLY:\n            return getPeriod('Week')\n        case RecurrencePeriod.ABSOLUTE_MONTHLY:\n            return getPeriod('Month')\n        case RecurrencePeriod.LIST:\n            return `occurs on Specific Dates`\n        default:\n            return ''\n    }\n}\n\nexport const handleRecurrenceFields = (data: HashMap) => {\n    if(data.is_recurrent){\n        if(data.recurrence_period !== RecurrencePeriod.LIST){\n            delete data.recurrence_starts\n            delete data.recurrence_endTz\n            if(data.recurrence_period !== RecurrencePeriod.WEEKLY){\n                delete data.recurrence_days\n            }\n        } else if(data.recurrence_period){\n            data.recurrence_list = [...(data.recurrence_starts || []).map((date: DateTZ) => date.startOfValue('minute').seconds)]\n            delete data.recurrence_interval;\n            delete data.recurrence_endTz;\n            delete data.recurrence_count;\n            delete data.recurrence_starts\n            delete data.recurrence_days\n        }\n        delete data.is_recurrent\n    }else{\n        delete data.recurrence_period;\n        delete data.recurrence_interval;\n        delete data.recurrence_endTz;\n        delete data.recurrence_count;\n        delete data.recurrence_starts\n        delete data.is_recurrent\n        delete data.recurrence_exceptions\n        delete data.recurrence_days\n    }\n\n    return data\n}\n\n/** Removes expired occurrences and updates start and end dates when cloning a series */\nexport const removeExpiredOcurrences = (form: FormGroup) =>{\n    if(form.controls.action?.value === SeriesAction.CLONE ){\n        const tz = form.controls.space_list.value[0].timezone\n        const date_now = new DateTZ({ is_local_tz: false, building_tz: tz });\n        const occurrences = form.controls.recurrence_starts.value.filter((date: DateTZ) =>\n            date_now.isBeforeDate(date, 'day') || date_now.isSameDate(date, 'day')\n        )\n        form.controls.recurrence_starts.setValue(occurrences)\n        const { start, end } = setStartAndEndDateFromArray(occurrences, tz)\n        form.controls.dateTz.setValue(start)\n        form.controls.recurrence_endTz.setValue(end)\n    }\n}\n\n/** \n * Returns starts and end dates from an array of dates in milliseconds \n **/\n export const setStartAndEndDateFromArray = (dates: Array<DateTZ>, tz: string): {start: DateTZ, end: DateTZ} =>{\n    if(dates.length !== 0){\n        return {\n            start: dates.sort((d1, d2) => d1.ms - d2.ms)[0] ,\n            end: dates.sort((d1, d2) => d2.ms - d1.ms)[0]\n        }\n    }\n    //if the dates array is empty set the start and end dates as the current and next day\n    const now = DateNow(new Date()).toZone(tz)\n    return {start: now, end: now.addValue({days: 1})}\n}\n\nexport const setRecurrenceStartsTime = (form: FormGroup) => {\n    const { recurrence_starts, dateTz } = form.value\n    const list = (recurrence_starts || []).map((date: DateTZ) => date.setValue({hour: dateTz.dateHour, minute: dateTz.minutes}))\n    form.controls.recurrence_starts.setValue(list)\n}","export * from './report.class'\nexport * from './reports.service'\n","import { CurrencyPipe } from '@angular/common';\n\nimport {\n    csvToJson,\n    downloadFile,\n    HashMap,\n    humaniseDuration,\n    jsonToCsv,\n} from '@mckinsey-converge/base';\n\nimport { ServiceManager } from '../service-manager.class';\nimport { Space } from '../spaces';\nimport { Organisation } from '../organisation';\n\nexport class Report<T extends {} = HashMap> {\n    /** Type of report */\n    public readonly type: string;\n    /** List of data associated with the report */\n    public readonly data: T[];\n\n    constructor(raw_data: HashMap = {}) {\n        this.type = raw_data.type || '';\n        this.data = this.cleanData(raw_data.data);\n    }\n\n    /** Create report data structure from CSV */\n    public static fromCSV(type: string, data: string): Report {\n        const csv_json = csvToJson(data);\n        return new Report({ type, data: csv_json });\n    }\n\n    /** Download report data as CSV format */\n    public downloadCSV(name: string = 'unnamed.csv'): void {\n        downloadFile(name, jsonToCsv(this.data));\n    }\n\n    /** Download report data as JSON format */\n    public downloadJSON(name: string = 'unnamed.json'): void {\n        downloadFile(name, JSON.stringify(this.data, undefined, 4));\n    }\n\n    public formatCancelledBy(email: string) {\n        if (email !== null && email !== undefined) {\n            let name = email.split('@')[0];\n            name = name.split('_').join(' '); //get name from email and convert it to title case\n            name = name.replace(/\\w\\S*/g, function (txt) {\n                return `${txt\n                    .charAt(0)\n                    .toUpperCase()}${txt.substr(1).toLowerCase()}`;\n            });\n            return name;\n        } else {\n            return email;\n        }\n    }\n\n    private cleanData(data: T[] = []) {\n        if (data.length > 0 && this.type === 'day') {\n            console.log(data);\n            for (let i = 0; i < data.length; i++) {\n                data[i]['booker'] = data[i]['booker'].name;\n                data[i]['expected_attendees'] = Object.values(data[i]['expected_attendees'])[0];\n            }\n        } else if (data.length > 0 && this.type === 'catering') {\n            for (let i = 0; i < data.length; i++) {\n                data[i]['Cancelled By'] = this.formatCancelledBy(\n                    data[i]['Cancelled By']\n                );\n            }\n            const fields = Object.keys(data[0]);\n            const room_field = fields.find(\n                (key) =>\n                    key.toLowerCase().includes('room') &&\n                    key.toLowerCase().includes('email')\n            );\n            const price_field = fields.find((key) =>\n                key.toLowerCase().includes('price')\n            );\n\n            for (let row of data) {\n                /* istanbul ignore else */\n                const space_service = ServiceManager.serviceFor(Space);\n                if (room_field && price_field && space_service) {\n                    const room = space_service.find(\n                        row[room_field].toLowerCase()\n                    );\n                    const org_service = ServiceManager.serviceFor(Organisation);\n                    const bld = org_service.buildings.find(\n                        (bld: { id: any }) =>\n                            bld.id === room?.level?.building_id\n                    );\n                    row[price_field] = new CurrencyPipe('en_us').transform(\n                        row[price_field] / 100,\n                        bld?.currency\n                    );\n                }\n                /* istanbul ignore else */\n                for (let field of fields) {\n                    row[field] =\n                        typeof row[field] === 'string'\n                            ? row[field].replace(/\\,/g, '')\n                            : row[field];\n                }\n            }\n        } else if (this.type === 'bookings') {\n            data = data.map((i: HashMap) => {\n                const booking = i;\n                try {\n                    if (booking.setup instanceof Object) {\n                        booking.setup = booking.setup[booking.room_email];\n                    }\n                    if (booking.breakdown instanceof Object) {\n                        booking.breakdown =\n                            booking.breakdown[booking.room_email];\n                    }\n                    booking.setup = humaniseDuration((booking.setup || 0) / 60);\n                    booking.breakdown = humaniseDuration(\n                        (booking.breakdown || 0) / 60\n                    );\n                    booking.description = (booking.description || '')\n                        .replace(/<[^>]*>?/gm, '')\n                        .replace(/\\,/g, '')\n                        .replace(/\\r?\\n|\\r/g, ' ');\n                    booking['Meeting Host'] =\n                        booking.organizer?.name || booking.organizer;\n                    booking['Booked By'] =\n                        booking.booked_by?.name ||\n                        booking.booked_by?.email ||\n                        '';\n                    booking.charge_code =\n                        booking.equipment_codes[booking.room_email] || '';\n                    //    booking.expected_attendees = Object.keys(booking.expected_attendees).map(key => booking.expected_attendees[key]).join(', ');\n                    booking.attendees = (booking.attendees || [])\n                        .map((person) => person.name || person.email || person)\n                        .join(' ');\n                    booking.notes = (booking.notes || [])\n                        .map((note) =>\n                            note.author &&\n                            (note.type === 'description' ||\n                                note.type === 'private')\n                                ? `[${note.author}|${note.type}]${note.message\n                                      .replace(/<[^>]*>?/gm, '')\n                                      .replace(/\\,/g, '')\n                                      .replace(/\\r?\\n|\\r/g, ' ')}`\n                                : ''\n                        )\n                        .join(' | ');\n                    booking.cancelled = booking.isCancelled;\n                    booking.status = booking.status[booking.room_email] || '';\n                    booking.company = booking.company.join(', ');\n                    if (booking.cancelled_by) {\n                        booking.cancelled_by = this.formatCancelledBy(\n                            booking.cancelled_by\n                        );\n                    }\n                    if (booking.isCancelled) {\n                        booking.cancelled_at_epoch = new Date(\n                            booking.cancelled_at_epoch * 1000\n                        ).toLocaleString();\n                    }\n                    booking.cancelled_date = booking.cancelled_at_epoch;\n                } catch (e) {}\n                const remove_fields = [\n                    'id',\n                    'icaluid',\n                    'accepted_at',\n                    'accepted_by',\n                    'check_ins',\n                    'changeKey',\n                    'created',\n                    'booking_type',\n                    'edit_history',\n                    'end_epoch',\n                    'old_attendees',\n                    'start_epoch',\n                    'expected_attendees',\n                    'isAllDay',\n                    'isCancelled',\n                    'body',\n                    'is_free',\n                    'lastModifiedDateTime',\n                    'locationType',\n                    'locations',\n                    'organizer',\n                    'booked_by',\n                    'originalEndTimeZone',\n                    'originalStartTimeZone',\n                    'room_booking_status',\n                    'room_email',\n                    'room_emails',\n                    'room_id',\n                    'sensitivity',\n                    'seriesMasterId',\n                    'show_as',\n                    'notes',\n                    'subject',\n                    'type',\n                    'previous_booking',\n                    'catering',\n                    'responseStatus',\n                    'equipment_codes',\n                    'cancelled_at_epoch',\n                ];\n                for (const field of remove_fields) {\n                    if (booking[field] !== undefined) {\n                        delete booking[field];\n                    }\n                }\n                const output = {};\n                const order = [\n                    'title',\n                    'start',\n                    'end',\n                    'location',\n                    'Meeting Host',\n                    'Booked By',\n                    'all_day',\n                    'attendees',\n                    'company',\n                    'description',\n                    'cancelled',\n                    'cancelled_by',\n                    'cancelled_date',\n                ];\n                const keys = Object.keys(booking);\n                keys.sort((a, b) => {\n                    const idx_a = order.indexOf(a);\n                    const idx_b = order.indexOf(b);\n                    return (\n                        (idx_a === -1 ? keys.length : idx_a) -\n                        (idx_b === -1 ? keys.length : idx_b)\n                    );\n                });\n                for (const key of keys) {\n                    output[key] = booking[key];\n                }\n                return output;\n            }) as any;\n        }\n        return data;\n    }\n}\n","import { Injectable } from '@angular/core';\n\nimport { ComposerService } from '@placeos/composer';\n\nimport { Report } from './report.class';\nimport { BaseAPIService } from '../base.service';\nimport { SettingsService } from '../settings.service';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class ReportsService extends BaseAPIService<Report> {\n    constructor(protected _composer: ComposerService,\n                settingsService: SettingsService) {\n        super(_composer, settingsService);\n        this._name = 'Reports';\n        this._api_route = 'reports';\n    }\n\n    protected process(raw_data: any): Report {\n        return raw_data instanceof Array\n            ? new Report({ data: raw_data })\n            : Report.fromCSV('', raw_data);\n    }\n}\n","import { Type } from '@angular/core';\nimport { Observable } from 'rxjs';\n\nimport { HashMap } from '@mckinsey-converge/base';\n\n\nexport interface ServiceLike<T = any> extends HashMap {\n    parent: any;\n    add: (_: HashMap) => Promise<T>;\n    update: (id: string, _: HashMap) => Promise<T>;\n    delete: (id: string, params?: HashMap) => Promise<void>;\n    task: (id: string, name: string, data: HashMap) => Promise<void>;\n    listen: <U = any>(prop: string) => Observable<U>;\n}\n\nexport interface ServiceProvider<T extends ServiceLike> {\n    provideFor: Type<any>;\n    useValue: T;\n}\n\nexport class ServiceManager {\n    /** Map of available services for child classes */\n    private static _service_list: ServiceProvider<any>[] = [];\n\n    /** Set the services used to handle data model requests */\n    public static setService(type: Type<any>, service: any): void {\n        if (window.debug) {\n            (window as any).ServiceManager = this._service_list;\n        }\n        const index = ServiceManager._service_list.findIndex(provider => provider.provideFor === type);\n        if (index >= 0) {\n            ServiceManager._service_list.splice(index, 1, { provideFor: type, useValue: service });\n        } else {\n            ServiceManager._service_list.push({ provideFor: type, useValue: service });\n        }\n    }\n\n    /** Get the services used to handle data model requests */\n    public static serviceFor(type: Type<any>): ServiceLike<any> {\n        const provider = ServiceManager._service_list.find(provider => provider.provideFor === type) || { useValue: null };\n        return provider.useValue;\n    }\n\n    constructor() {\n        throw new Error('ServiceMananger is static class');\n    }\n}\n","import {\n    Inject,\n    Injectable\n} from '@angular/core';\nimport { Title } from '@angular/platform-browser';\nimport {\n    BehaviorSubject,\n    Observable\n} from 'rxjs';\n\nimport { VERSION } from '@mckinsey-converge/environment';\nimport {\n    BaseClass,\n    getItemWithKeys,\n    HashMap,\n    log\n} from '@mckinsey-converge/base';\nimport { ServiceManager } from './service-manager.class';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\ndeclare global {\n    interface Window {\n        debug: boolean;\n    }\n}\n\nexport const SETTINGS_TOKEN = 'settings_service_data';\n\ntype SettingsAppData<T> = T & {\n    title: string;\n    description: string;\n    short_name: string;\n    logo_light: {\n        type: string;\n        src: string;\n        background: string;\n    }\n    logo_dark: {\n        type: string;\n        src: string;\n        background: string;\n    }\n    heap_io: {\n        app_id: number;\n        force_ssl: boolean;\n        secure_cookie: boolean;\n        disable_text_capture: boolean;\n        cookie_path: string;\n    }\n}\n\nexport interface SettingsData<TApp> {\n    debug: boolean;\n    mock: boolean;\n    frontend: 'staff' | 'concierge' | 'booking';\n    composer: {\n        domain: string;\n        route: string;\n        protocol: string;\n        port: string;\n        use_domain: boolean;\n        local_login: boolean;\n    }\n    app: SettingsAppData<TApp>;\n}\n\nexport class SettingsObject {\n    constructor(public data: SettingsData<any>) {\n    }\n}\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class SettingsService extends BaseClass {\n    /** Name of the application */\n    private _app_name = 'PlaceOS';\n    /** List of override settings in order of priority */\n    private _overrides = new BehaviorSubject<HashMap[]>([]);\n    /** Mapping of behaviour subjects */\n    private _subjects: HashMap<BehaviorSubject<any>> = {};\n    /** Mapping of observables */\n    private _observables: HashMap<Observable<any>> = {};\n    /** Which frontend we're in. staff, concierge, or bookings **/\n    public readonly frontend: string;\n\n    /**\n     * @hidden\n     */\n    public set overrides(value: HashMap[]) {\n        this._overrides.next(value);\n    }\n\n    /** Get observable for key */\n    public listen<T = any>(name: string): Observable<T> {\n        if (!this._observables[name]) {\n            this._subjects[name] = new BehaviorSubject<T>(null);\n            this._observables[name] = this._subjects[name].asObservable();\n        }\n        return this._observables[name];\n    }\n\n    /** Update observable value for key */\n    public post<T>(name: string, value: T): void {\n        if (!this._observables[name]) {\n            this._subjects[name] = new BehaviorSubject<T>(null);\n            this._observables[name] = this._subjects[name].asObservable();\n        }\n        this._subjects[name].next(value);\n    }\n\n    public value<T = any>(name: string): T {\n        return !this._observables[name] ? null : this._subjects[name].getValue();\n    }\n\n    /** Page title */\n    public get title() {\n        return this._title.getTitle();\n    }\n\n    public set title(value: string) {\n        this._title.setTitle(`${value} | ${this._app_name}`);\n    }\n\n    constructor(private _title: Title,\n                @Inject(SETTINGS_TOKEN)\n                private settings: SettingsObject) {\n        super();\n        ServiceManager.setService(SettingsService, this);\n        const time = new DateTZ({date: VERSION.time});\n        const built = DateNow(new Date()).isSameDate(time, 'day')\n            ? `Today at ${time.formatDate('h:mma')}`\n            : time.formatDate('do MMM yyyy, h:mma');\n        const frontend = this.get('frontend') || 'Unknown';\n        this.frontend = frontend;\n        log('CORE', `${VERSION.semver}`, null, 'debug', true, frontend?.toUpperCase());\n        log('APP', `${VERSION.hash} | Built: ${built}`, null, 'debug', true, frontend?.toUpperCase());\n        this.init();\n    }\n\n    /**\n     * Initialise the settings\n     */\n    public async init() {\n        if (this.get('debug')) {\n            window.debug = true;\n        }\n        if (this.get('app')?.name) {\n            this._app_name = this.get('app').name;\n        }\n        log('Settings', 'Successfully loaded settings');\n        this._initialised.next(true);\n    }\n\n    /** Whether settings service has initialised */\n    public get app_name() {\n        return this._app_name;\n    }\n\n    public get concierge() {\n        return this.frontend === 'concierge';\n    }\n\n    /**\n     * Get a setting\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n     */\n    public get(key: string): any {\n        const keys = key.split('.');\n        if (keys[0] !== 'app') {\n            return getItemWithKeys(keys, this.settings.data);\n        }\n        const override_settings = this._overrides.getValue();\n        for (const override of override_settings) {\n            const value = getItemWithKeys(keys.slice(1), override);\n            if (value != null) {\n                return value;\n            }\n        }\n        return getItemWithKeys(keys, this.settings.data);\n    }\n}\n","export * from './space.class';\nexport * from './spaces.service';\nexport * from './space.utilities';\n","import { BaseDataClass } from '../base-api.class';\nimport {\n    HashMap,\n} from '@mckinsey-converge/base';\nimport {\n    Building,\n    BuildingLevel,\n    Organisation\n} from '../organisation';\nimport { User } from '../users';\nimport { ServiceManager } from '../service-manager.class';\nimport { SettingsService } from '../settings.service';\nimport { SpaceRules } from '../bookings/booking.types';\nimport { rulesForSpace } from '../bookings/space.utilities';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\nimport { DaysOfWeek, RecurrencePeriod } from '../recurrence/recurrence.utils';\nimport { DateTime } from 'luxon';\n\nexport interface ISpaceAvailabilityOptions {\n    /** Start date and time of the availability block */\n    dateTz?: DateTZ;\n    /** Length of the availability block */\n    duration: number;\n    /**  */\n    id?: string;\n    /** List of spaces to look at the availability for */\n    room_ids?: string;\n    /** Whether the spaces looked at should be bookable */\n    bookable?: boolean;\n    /** List of spaces or zones to ignore */\n    ignore?: string;\n    /** List of zones to look at the availability for */\n    zone_ids?: string | string[];\n    /** Whether space bookings should not be returned */\n    hide_bookings?: boolean;\n    /** Min capacity on the room **/\n    capacity?: number\n    clear?: boolean;\n    /** Length of the setup */\n    setup?: number;\n    /** Length of the breakdown */\n    breakdown?: number;\n    /** Hide declined bookings */\n    hide_declined?: boolean;\n    /** Max capacity on the room **/\n    capacity_max?: number\n\n    diff_capacity?: boolean\n\n    /** Fields to include recurrence in the availability search */\n    recurrence_period?: RecurrencePeriod;\n    recurrence_interval?: number;\n    recurrence_endTz?: DateTZ;\n    recurrence_count?: number;\n    recurrence_starts?: Array<DateTZ>\n    is_recurrent?: boolean\n    recurrence_days?: Array<DaysOfWeek>\n}\n\nexport interface SpaceBookingRuleOptions {\n    dateTz: DateTZ;\n    duration: number;\n    host: User;\n}\n\nexport const OPTION_DEFAULTS: ISpaceAvailabilityOptions = {\n    duration: 60\n};\n\nexport interface RecurrenceAvailability {\n    /** Unix epoch in seconds */\n    readonly date: number;\n    /** Whetehr space is available at this time */\n    readonly available: boolean;\n}\n\n/**\n * Room Settings Type\n * \n * Exmaple: \n * available: true\n * available_until: 1644344999\n * bookings: []\n * catering: false\n * charge_code: false\n * extra_features: \"meeting_room boardroom\"\n * internal_or_external: \"internal\"\n * map_id: \"08.8.15\"\n * natural_light: false\n * room_booking_screen: true\n * room_name: \"8.15 Meeting\"\n * vc: false\n * recurrence_availability: {\n *    date: \"1642596300\",\n *    available: false,\n * }\n */\nexport interface RoomSettings {\n    // Local room name is required.\n    room_name?: string\n    // TBD if anything else should be required\n    available?: boolean\n    available_until?: number\n    bookings?: HashMap[]\n    catering?: boolean\n    charge_code?: boolean\n    extra_features?: string\n    internal_or_external?: string\n    map_id?: string\n    natural_light?: boolean\n    room_booking_screen?: boolean\n    vc?: boolean\n    recurrence_availability?: RecurrenceAvailability[]\n    equipment_code?: boolean\n    external?: boolean\n}\n\n/**\n * List of space features that come from settings.\n *\n * Im sure this list will grow. It is not the most comprehensive list.\n */\nexport enum SpaceFeatures {\n    BoardRoom = 'boardroom',\n    Catering = 'catering',\n    CocktailRoom = 'cocktail',\n    ConferencePhone = 'conference_phone',\n    ConferenceRoom = 'conference',\n    ElectronicWhiteboard = 'whiteboard',\n    FlipChart = 'flipchart',\n    Glassboard = 'glassboard',\n    PartnerOffice = 'partner',\n    PhoneBooth = 'phone_booth',\n    TheatreRoom = 'theatre',\n    TeamRoom = 'team_room',\n    VideoConference = 'vc',\n    NaturalLight = 'natural_light',\n    WirelessContentSharing = 'wireless_content_sharing',\n    WorkshopRoom = 'workshop',\n    UShapeRoom = 'u_shape',\n    Miscellaneous = 'miscellaneous'\n}\n\nexport enum SpaceEquipments {\n    conference_phone,\n    whiteboard,\n    vc,\n    flipchart,\n    glassboard,\n    wireless_content_sharing\n}\nexport enum SpaceStyles {\n    boardroom,\n    cocktail,\n    conference,\n    partner,\n    theatre,\n    team_room,\n    // natural_light,\n    workshop,\n    u_shape,\n    miscellaneous\n}\n\nconst EMPTY_ARRAY = [];\n\nexport class Space extends BaseDataClass {\n    /** Whether space can be booked by users */\n    public readonly bookable: boolean;\n    /** People capacity of the space */\n    public readonly capacity: number;\n    /** Index to force order when sorting multiple spaces */\n    public readonly sort_priority: number;\n    /** Settings has extensive info displayed in the app. */\n    public readonly settings: RoomSettings;\n    /** URL for the control interface of the space */\n    public readonly support_url: string;\n    /** Engine zones associated with the space */\n    public readonly zones: readonly string[];\n    /** Is the Application concierge */\n    public is_concierge: boolean = false;\n\n    /** Simple name == local name being using in seeting.room_name \n\t\t * \n\t\t*/\n    public simple_name: string;\n\n    /** Room style set of all room style one room has\n    * [\"boardroom\", \"cocktail\", \"miscellaneous\", \"natural_light\", \"theatre\", \"u-shape\", \"workshop\"]   */\n    public room_style: string[] = [];\n\n    /** Equipment set of all room equipment one room has\n    * [\"conference_phone\", \"whiteboard\", \"vc\", \"flipchart\", \"glassboard\", \"whiteboard\", \"wireless_content_sharing\"] */\n    public equipment: string[] = [];\n\n    /** Filters has charge code settings for booking and catering */\n    public filters: RoomSettings;\n\n    /** room_type subset of internal or external rooms */\n    public room_type: string[] | string;\n    /** \n     * Features used in identifying room types.\n     * \n     * Both features and extra_features are space delimited strings.\n     * \n     * There is a getter featuresArray that returns the\n     * combination of the two as an array.\n     */\n    public readonly features: string;\n    public readonly extra_features: string;\n    public map_id: string;\n\n\n    /** Service for managing spaces */\n    protected get _service() {\n        return ServiceManager.serviceFor(Building);\n    }\n\n    /** Return the rooms' building */\n    public get building() {\n        return this._service?.buildings.find((bld) => {\n            return this.zones.includes(bld.id);\n        });\n    }\n\n    /** Return building timezone */\n    public get timezone() {\n        return this.building?.timezone;\n    }\n\n    constructor(raw_data: HashMap = {}) {\n        super(raw_data);\n        \n        // Needed to check if the current app is Concierge or Staff\n        const settingsService = ServiceManager.serviceFor(SettingsService) as unknown as SettingsService;\n        this.is_concierge = !!settingsService?.concierge;\n\n        const defaultGlobalName = raw_data.name || raw_data.email || 'Meeting Room';\n        const defaultSettings = {\n            room_name: defaultGlobalName\n        }\n        /**\n         * Duplicate of base-api.class just for readability\n         * .name is the full, mckinsey standardised name of the room.\n         * You can think of it was what people would call the room when \n         * considering every office and room globally.\n         * \n         * this.name = raw_data.name;\n         */        \n        /**\n         * Settings has extensive info displayed in the app.\n         * setting.room_name is always used when displaying the room name in the applications\n         * setting.room_name is the more office-specific room name, you can think of this as \n         * the one people in that office would refer to the room as.\n         * \n         */\n        this.settings = raw_data.settings || defaultSettings;\n        this.filters = raw_data?.filters;\n        // Room fields\n        this.bookable = raw_data.bookable || false;\n        this.capacity = raw_data.capacity || 0;\n        this.support_url = raw_data.support_url;\n        this.zones = raw_data.zones instanceof Array ? raw_data.zones : [];\n        // Feature fields\n        this.features = raw_data.features || '';\n        this.extra_features = raw_data.settings?.extra_features || '';\n\n\t\tthis.room_type = raw_data?.room_type;\n        this.simple_name = raw_data?.simple_name;\n        this.map_id = raw_data?.map_id || raw_data.settings?.map_id || '';\n        this.room_style = raw_data?.room_style || [];\n        this.equipment = raw_data?.equipment || [];\n\n    }\n\n    /** \n     * Return the global room name\n     * IE LDN-4-408-06\n     */\n    public get global_name(): string {\n        return this.name || ''\n    }\n\n    /** \n     * Return the local room name\n     * i.e. 4.08\n     * TO DO: ROOM-DATA-STRUCTURE-REFACTOR - stop using/remove seetings.room_name\n     */\n    public get local_name(): string {\n        return this.simple_name || this.settings?.room_name || this.name || ''\n    }\n\n    public get street_and_city(): string {\n        return this.building ? `${this.building.address}, ${this.building.city}` : '';\n    }\n\n    /** \n     * Return the map_id from settings\n     * TO DO: ROOM-DATA-STRUCTURE-REFACTOR - stop using/remove seetings.map_id and use map_id from space modal( after testing over prod)\n     */\n    // public get map_id(): string {\n    //     return this?.map_id || this.settings?.map_id || '';\n    // }\n\n    /** Internal / External status */\n    public get internal_or_external(): string {\n        const  external  = this.filters?.external;\n        return ( external ? 'external' : this.settings?.internal_or_external ) || 'internal';\n    }\n\n    /** \n     * Works in conjunction with available_until. \n     * \n     * If a room is bookable that only means you can make a booking but not when.\n     * Available indicates that is is available to be booked durring the queried times. \n     */\n    public get available(): boolean {\n        return this.settings?.available ?? false;\n    }\n\n    public get currently_in_use(): boolean {\n        const nowMs = new DateTZ({ date: DateTime.now(), is_local_tz: false, building_tz: this.timezone }).ms;\n        const runningBookings = this.settings?.bookings?.filter( bks => {\n            const startEpoch = new DateTZ({ date: bks.start_epoch * 1000, is_local_tz: false, building_tz: bks.timezone}).ms;\n            const endEpoch = new DateTZ({ date: bks.end_epoch * 1000, is_local_tz: false, building_tz: bks.timezone}).ms;\n             return startEpoch <= nowMs && endEpoch >= nowMs;\n        })\n        // console.log(raw_data.settings.room_name+' : '+ nowMs.ms);\n        // console.log('IS IN USER CURRENTLY : ', isinUsernow);\n        return !!runningBookings.length;\n    }\n\n    /** Last returned availability time */\n    public get available_until(): number {\n        return this.settings?.available_until;\n    }\n\n    /** Bookings associated with the space */\n    public get bookings(): HashMap[] {\n        // We should need to care if a room as bookings in Staff\n        if (!this.is_concierge) {\n            return EMPTY_ARRAY;\n        }\n\n        if (this.settings?.bookings?.length) {\n            /**\n             * When we're dealing with Concierge the API data arriving is rooms, and those rooms contain booking,\n             * but those bookings don't contain a room since the room is the root. \n             * In order for Concierge to filter bookings by room we need to reattach this room\n             * to each of the bookings, with it's own bookings.  \n             * \n             * It's loopy and kooky but correcting for this pattern is beyond the scope of this refactor.\n             */\n            const spaceWithBookings =  new Space(this.toJSON());\n            return this.settings?.bookings.map(b => {\n                b.room = spaceWithBookings;\n                return b;\n            });\n        }\n        return EMPTY_ARRAY;\n    }\n\n    /** \n\t\t * Whether space has catering\n     * TO DO: ROOM-DATA-STRUCTURE-REFACTOR - stop using/remove seetings.catering and use filters?.catering instead\n\t\t */\n    public get has_catering(): boolean {\n        return this.filters?.catering || this.settings?.catering || false;\n    }\n\n     /** Returns an array of the space delimited feature and extra_feature strings.\n     * TO DO: ROOM-DATA-STRUCTURE-REFACTOR - stop using/remove features, extra_features\n     */\n    public get featuresArray(): (SpaceFeatures | string)[] {\n        // (this.simple_name === \"Entresol M-06\" ) && console.log('raw_data : ', this)\n        const roomType = Array.isArray(this.room_type) ?  this.room_type : [this.room_type]\n        const features = [\n                ...this.features.split(' '),\n                ...this.extra_features?.split(' '),\n\n                ...roomType, // required to work with staff>result>filters\n                ...this?.room_style,\n                ...this?.equipment,\n\n                (this.filters?.natural_light || this.settings?.natural_light) && SpaceFeatures.NaturalLight || undefined,\n                this.settings?.natural_light && SpaceFeatures.NaturalLight || undefined,\n                this.settings?.vc && SpaceFeatures.VideoConference || undefined,\n            ].filter(f => !!f).map(f => f.toLowerCase());\n        //will be an array... new Set() turns it into a set, but [... ] turns it back into an array again \n        return [ ...new Set(features) ];\n    }\n\n    /** Level in which the space is associated */\n    public get level(): BuildingLevel {\n        const service = ServiceManager.serviceFor(Organisation);\n        return (service ? service.levelWithID(this.zones as any) : null) || new BuildingLevel({});\n    }\n\n    /** \n     * Return the new recurrence_availability from settings\n     */\n    public get recurrence_availability(): RecurrenceAvailability[] {\n        return this.settings?.recurrence_availability || [];\n    }\n\n    // public get availableOccurrences(): number {\n    //     if(this?.recurrence_availability) {\n    //         return this?.recurrence_availability?.filter(recurr => recurr.available).length;\n    //     }\n    // }\n\n    // public get totalOccurrences(): number {\n    //     return this?.recurrence_availability.length;\n    // }\n\n    /**\n     * Make a copy of this object\n     */\n    public clone(): Space {\n        return new Space(this);\n    }\n\n    /**\n     * Make a copy of this object without identification data\n     */\n    public duplicate(): Space {\n        const space = { ...this };\n        space.settings.bookings = []; // clear out bookings\n        return new Space({ ...space, id: null, email: null });\n    }\n\n    /**\n     * Generate the booking rules for space with given options\n     * @param options Conditions for generating the space rules\n     */\n    public rulesFor(options: SpaceBookingRuleOptions): SpaceRules {\n        if (!this._service || !this.level) {\n            return { auto_approve: true, hide: false };\n        }\n\n        const building = this.is_concierge ? this.level.building_id : this.building\n\n        if (!building) {\n            return { auto_approve: true, hide: false };\n        }\n        const { dateTz, duration, host } = options;\n        const rules: SpaceRules = rulesForSpace({\n            time: dateTz.ms,\n            duration,\n            space: this,\n            user: host,\n            rules: building.booking_rules\n        });\n        return rules;\n    }\n\n    /**\n     * Whether space can only be booked by request\n     * @param options Conditions for checking the space rules\n     */\n    public byRequest(options: SpaceBookingRuleOptions) {\n        const rules = this.rulesFor(options);\n        return !rules.auto_approve;\n    }\n\n    /**\n     * Convert object into plain object\n     */\n    public toJSON(this: Space): HashMap {\n        return { ...super.toJSON(), settings: { ...this.settings, bookings: [] }, filters: { ...this.filters }, equipment: [ ...this.equipment] };\n    }\n}\n","import { HashMap } from '@mckinsey-converge/base';\nimport {\n    ISpaceAvailabilityOptions,\n    Space\n} from './space.class';\nimport { Building } from '../organisation/building.class';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\nimport { handleRecurrenceFields, RecurrencePeriod } from '../recurrence/recurrence.utils';\n\nexport function availabilityOptionsToQuery(options: ISpaceAvailabilityOptions): HashMap {\n    let query: HashMap = {};\n    if (options) {\n        query = { ...options };\n        if (options.dateTz) {\n            const date = options.dateTz.startOfValue('minute');\n            query.available_from = date.seconds; // Add one second or API will not allow end to end booking\n            query.available_to = date.addValue({ minutes: options.duration || 60 }).subtractValue({ seconds: 1 }).seconds;\n\n            if (options.setup) query.setup = options.setup ;\n            if (options.breakdown) query.breakdown = options.breakdown;\n \n            delete query.dateTz;\n            delete query.duration;\n        }\n\n        if (!options.capacity_max) delete query.capacity_max\n\n        if (options.hide_declined) query.hide_declined = options.hide_declined;\n        query = handleRecurrenceFields(query)\n    }\n    return query;\n}\n\n/**\n * Compare two spaces to determine order\n * @param first\n * @param second\n */\nexport function sort(first: Space, second: Space, blds: Building[] = []) {\n    const bld = blds.find(bld => first.zones.includes(bld.id));\n    const bld_b = blds.find(bld => second.zones.includes(bld.id));\n    if (bld) {\n        if (bld !== bld_b) {\n            return (bld.name).localeCompare(bld_b?.name);\n        }\n        const sort_order = [...bld.sort_order].reverse();\n        for (const zone_id of sort_order) {\n            if (zone_id === '*') {\n                continue;\n            }\n            const a_has_zone = first.zones.indexOf(zone_id) >= 0;\n            const b_has_zone = second.zones.indexOf(zone_id) >= 0;\n            if (a_has_zone && !b_has_zone) {\n                return 1;\n            } else if (b_has_zone && !a_has_zone) {\n                return -1;\n            }\n        }\n    }\n    return first.name.localeCompare(second.name);\n}\n","import { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\nimport { first } from 'rxjs/operators';\n\nimport { BaseAPIService } from '../base.service';\nimport { ISpaceAvailabilityOptions, Space } from './space.class';\nimport { ApplicationLoadingState, HashMap } from '@mckinsey-converge/base';\nimport { availabilityOptionsToQuery } from './space.utilities';\nimport { ServiceManager } from '../service-manager.class';\nimport { OrganisationService } from '../organisation';\nimport { ApplicationService } from '../app.service';\nimport { SettingsService } from '../settings.service';\nimport { DateNow } from '@mckinsey-converge/date-tz';\nimport { Observable } from 'rxjs';\nimport { HttpClient } from '@angular/common/http';\n\nlet SPACE_LIST = [];\n\nexport function findSpace(id: string) {\n    return SPACE_LIST.find((_) => _.id === id || _.email === id);\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class SpacesService extends BaseAPIService<Space> {\n    constructor(\n        protected _composer: ComposerService,\n        private _org: OrganisationService,\n        private _service: ApplicationService,\n        settingsService: SettingsService\n    ) {\n        \n        super(_composer, settingsService);\n        ServiceManager.setService(Space, this);\n        this._name = 'Space';\n        this._api_route = 'rooms';\n        this._compare = (a, b) =>\n            !a.id.localeCompare(b.id) || !a.email.localeCompare(b.email);\n        this._list_filter = (a: Space) => {\n            const bld = this._org.building;\n            return a.level.building_id === bld.id;\n        };\n        this._org.initialised\n            .pipe(first((_) => _))\n            .subscribe(() => this.init());\n    }\n\n    public async query(query: HashMap = {}) {\n        const list = await super.query(query);\n        if ( (query.hasOwnProperty('cache') && query.cache === false) || !Object.keys(query).length) {\n            this.set('list', list);\n            SPACE_LIST = list;\n        }\n        return list;\n    }\n\n    public filterAvailableSpaces(list: Space[]) {\n        return list.filter((i) => {\n            if (i.recurrence_availability?.length) return i; //if recurrence, send the space regardless of availability (needed for edit and cloning series)\n            return i.available;\n        });\n    }\n\n    /**\n     * Get available spaces\n     * @param options\n     */\n    public available(\n        options: ISpaceAvailabilityOptions,\n        uniqueId?: string,\n        filter: boolean = true\n    ): Promise<Space[]> {\n        if (!options) {\n            throw new Error('Space avilability requires request options');\n        }\n\n        const now = DateNow(new Date());\n        if (!options.dateTz) {\n            options.dateTz = now.startOfValue('minute');\n        }\n\n        if (options.hide_declined === undefined) {\n            options.hide_declined = true;\n        }\n\n        const key = `available|${options.id ? options.id : ''}|${\n            uniqueId ?? ''\n        }`;\n        if (!this._promises[key]) {\n            this._promises[key] = new Promise((resolve, reject) => {\n                const respond = (list: Space[]) => {\n                    delete this._promises[key];\n                    resolve(filter ? this.filterAvailableSpaces(list) : list);\n                };\n                const error = (e) => {\n                    reject(e);\n                    delete this._promises[key];\n                };\n                const query = availabilityOptionsToQuery(options);\n                if (options.id) {\n                    this.show(options.id, query).then(\n                        (i) => respond([i]),\n                        error\n                    );\n                } else {\n                    this.query(query).then(respond, error);\n                }\n            });\n        }\n\n        return this._promises[key];\n    }\n\n    /**\n     * Load initial data for the service\n     */\n    protected async load(): Promise<void> {\n        const loading: ApplicationLoadingState =\n            this._service.get('loading') || {};\n        if (!loading.spaces) {\n            loading.spaces = {\n                message: 'Loading space data',\n                state: 'loading',\n            };\n            this._service.set('loading', loading);\n        }\n        await this.query().catch(() => {\n            loading.spaces = { message: 'Loading space data', state: 'failed' };\n            this._service.set('loading', loading);\n        });\n        loading.spaces = { message: 'Loading space data', state: 'complete' };\n        this._service.set('loading', loading);\n    }\n\n    /**\n     * Convert raw data into API object\n     * @param raw_data Raw API data\n     */\n    public process(raw_data: HashMap): Space {\n        return new Space(raw_data);\n    }\n    /**\n     * \n     * Special observable function to make http call for rooms\n     * @param query \n     * @returns observable\n     */\n    public queryRooms = (query: HashMap = {}): Observable<HashMap> => super.queryRoomsForQR(query);\n\n    public setSpaceList(list) {\n        this.set('list', list);\n        SPACE_LIST = list;\n    }\n\n    public queryBooking = (query: HashMap = {}) : Observable<Space[]> | Observable<any>  => super.queryObsr(query);\n    public updateSpace = (id: string, form_data: HashMap, should_inject_concierge: Boolean = false, query_params: HashMap = {}) : Observable<Space[]> | Observable<any>  => super.updateObsr(id, form_data, should_inject_concierge, query_params);\n    public uploadSpacePhotos = (apiSubRoute: string, form_data: HashMap, should_inject_concierge: Boolean = false, query_params: HashMap = {}) : Observable<any> | Observable<any>  => super.uploadSpacePhotos(apiSubRoute, form_data, should_inject_concierge, query_params);\n    \n}\n","import {\n    BehaviorSubject,\n    of\n} from 'rxjs';\nimport {\n    Building,\n    Organisation\n} from './organisation';\nimport { BaseDataClass } from './base-api.class';\nimport { MapLocation } from './location';\nimport { User } from './users';\nimport { Booking } from './bookings';\nimport {\n    RoomSettings,\n    Space,\n    SpaceFeatures\n} from './spaces';\nimport { ServiceManager } from './service-manager.class';\nimport {\n    CateringCategory,\n    CateringItem\n} from './catering';\nimport {\n    HashMap,\n    padZero,\n    predictableRandomInt,\n    unique\n} from '@mckinsey-converge/base';\n\nimport * as faker from 'faker';\n\nimport {\n    SETTINGS_TOKEN,\n    SettingsData,\n    SettingsObject,\n    SettingsService\n} from './settings.service';\nimport { Report } from './reports';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\nfaker.seed(2560);\n\nlet SERVICE: any;\n\ndeclare global {\n    interface Jest {\n        fn: () => any\n    }\n}\n\n\ndeclare let jest: Jest;\n\n/* istanbul ignore file */\n\nexport function generateMockOrganisationService(): HashMap {\n    return {\n        levelWithID: jest.fn(),\n        listen: jest.fn(),\n        loadOrganisation: jest.fn(),\n        initialised: of(true),\n        building: new Building(generateMockBuilding({ id: 'bld-01' })),\n        loadBuildingsWithOrg: jest.fn(),\n        getOrganizationFiltersByRoomType: jest.fn(),\n        getRoomTypeSubsetDDOptions: jest.fn(),\n        ...generateMockDataService('OrganisationService')\n    };\n}\n\nexport const generateMockSpacesService = (): HashMap => ({\n    available: jest.fn(),\n    ...generateMockDataService('SpacesService')\n});\n\nexport const generateMockUsersService = (): HashMap => ({\n    loadCurrentUser: jest.fn(),\n    ...generateMockDataService('UsersService')\n});\n\nexport const bookingState = () => ({\n    bookings: of([]),\n    filtered: of([]),\n    filtered_week: of([]),\n    filtered_month: of([]),\n    setZone: jest.fn(),\n    setDate: jest.fn(),\n    setFilters: jest.fn(),\n    add: jest.fn(),\n    replace: jest.fn(),\n    remove: jest.fn(),\n    startPolling: jest.fn(),\n    startPollingMonth: jest.fn(),\n    startPollingWeek: jest.fn(),\n    startPollingEveryFiveMin: jest.fn(),\n    _noOfMeetings: of([])\n});\n\nconst test_app = {\n    title: 'McKinsey & Company',\n    description: 'McKinsey & Company Staff UI written with Angular Framework',\n    short_name: 'STAFF',\n    logo_light: {\n        type: 'img',\n        src: 'assets/img/logo.svg',\n        background: ''\n    },\n    logo_dark: {\n        type: 'img',\n        src: 'assets/img/logo-inverse.svg',\n        background: ''\n    },\n    heap_io: {\n        app_id: 3540602199,\n        force_ssl: true,\n        secure_cookie: true,\n        disable_text_capture: true,\n        cookie_path: '/staff/'\n    }\n};\n\nexport const TEST_SETTINGS: SettingsData<typeof test_app> = {\n    debug: true,\n    composer: {\n        domain: '',\n        route: '/test',\n        protocol: '',\n        port: '',\n        use_domain: false,\n        local_login: false\n    },\n    app: test_app,\n    mock: false,\n    frontend: 'staff'\n};\n\nexport const generateMockSettingsService = (overrides: Partial<SettingsData<any>> = {}) => new SettingsService({ getTitle: () => jest.fn() } as any,\n    new SettingsObject({\n        ...TEST_SETTINGS,\n        ...overrides\n    }));\n\n/**\n * Provides an injectable instance for settings.\n */\nexport const provideMockSettingsObject = (settings: Partial<SettingsData<any>> = {}) => ({\n    provide: SETTINGS_TOKEN,\n    useValue: new SettingsObject({\n        ...TEST_SETTINGS,\n        ...settings\n    })\n});\n\n/**\n * Generate a mocked version of the application service\n */\nexport function generateMockAppService(settingsOverrides: Partial<SettingsData<any>> = {}) {\n    SERVICE = {\n        setting: jest.fn(),\n        notify: jest.fn(),\n        notifyInfo: jest.fn(),\n        notifyWarn: jest.fn(),\n        notifySuccess: jest.fn(),\n        notifyError: jest.fn(),\n        log: jest.fn(),\n        navigate: jest.fn(),\n        navigateBack: jest.fn(),\n        get: jest.fn(),\n        listen: jest.fn(),\n        set: jest.fn(),\n        Composer: { auth: { token: 'test' } },\n        Hotkeys: { listen: jest.fn() },\n        Users: generateMockUsersService(),\n        Organisation: generateMockOrganisationService(),\n        Locations: generateMockDataService('LocationsService'),\n        Base: generateMockDataService('BaseService'),\n        Menu: generateMockDataService('CateringMenuService'),\n        Spaces: generateMockSpacesService(),\n        Bookings: generateMockDataService('BookingsService'),\n        Reports: generateMockDataService('ReportsService'),\n        CateringItems: generateMockDataService('CateringItemsService'),\n        CateringCategories: generateMockDataService('CateringCategoriesService'),\n        Settings: generateMockSettingsService(settingsOverrides),\n        initialised: of(true)\n    };\n    ServiceManager.setService(BaseDataClass, SERVICE.Base);\n    ServiceManager.setService(Organisation, SERVICE.Organisation);\n    ServiceManager.setService(Building, SERVICE.Organisation);\n    ServiceManager.setService(User, SERVICE.Users);\n    ServiceManager.setService(Booking, SERVICE.Bookings);\n    ServiceManager.setService(Space, SERVICE.Spaces);\n    ServiceManager.setService(MapLocation, SERVICE.Locations);\n    ServiceManager.setService(Report, SERVICE.Reports);\n    ServiceManager.setService(CateringItem, SERVICE.CateringItems);\n    ServiceManager.setService(CateringCategory, SERVICE.CateringCategories);\n    SERVICE.Organisation.buildings = [SERVICE.Organisation.building];\n    SERVICE.Users.current = new User(generateMockUser());\n    SERVICE.Users.initialised = of(true);\n    SERVICE.Bookings.booking_list = new BehaviorSubject(new Array(10).fill(0).map(_ => new Booking(generateMockBooking())));\n    SERVICE.listen.mockReturnValue(of(null, []));\n    return SERVICE;\n}\n\nexport function generateMockDataService(name: string) {\n    const service = {\n        find: jest.fn(),\n        filter: jest.fn(),\n        listen: jest.fn(),\n        get: jest.fn(),\n        set: jest.fn(),\n        setting: jest.fn(),\n        query: jest.fn(),\n        show: jest.fn(),\n        add: jest.fn(),\n        save: jest.fn(),\n        remove: jest.fn(),\n        delete: jest.fn(),\n        update: jest.fn(),\n        addFrom: jest.fn(),\n        removeFrom: jest.fn(),\n        task: jest.fn(),\n        available: jest.fn(),\n        process: jest.fn(),\n        updateList: jest.fn(),\n        clearList: jest.fn(),\n        removeFromList: jest.fn(),\n        accept: jest.fn(),\n        decline: jest.fn(),\n        checkin: jest.fn(),\n        is_logged_in: false,\n        initialised: of(true),\n        getHoldingBay: jest.fn(),\n        name,\n        queryRooms: of(true),\n        queryRoomsForQR: of([]),\n        queryObsr: of([]),\n        queryBooking: of(true),\n        checkinIndividualVisitor: jest.fn(),\n        taskObsr: of(true),\n        updateSpace: jest.fn(),\n        updateObsr: of([]),\n        uploadSpacePhotos: of([])\n\n    };\n\n    service.getHoldingBay.mockImplementation(_ => Promise.resolve([new Booking({})]));\n    service.save.mockImplementation(_ => Promise.resolve(new Booking({})));\n\n    service.listen.mockReturnValue(of(null));\n    service.filter.mockReturnValue([]);\n    return service;\n}\n\nlet SPACE_COUNT: number = 0;\n\nexport function generateMinimalRoomDetails(count: number) {\n    return {\n        name: `space-0${count}`,\n        email: `space-0${count}@test.com`,\n        settings: {\n            name: `localname-0${count}`,\n            catering: true\n        }\n    }\n}\n\nexport function generateMockSpace(overrides: HashMap = {}, space_id: number = null, recurring_search: boolean = false ): Space {\n    const id = `space-${space_id || SPACE_COUNT++}`;\n    const name = overrides.name || `${faker.name} ${faker.name.lastName()} Space`;\n    const startOfDay = DateNow(new Date()).startOfValue('day');\n    let settings: RoomSettings = {\n        available: true,\n        available_until: startOfDay.addValue({ days: 1 }).seconds, // (Date.now() / 1000) + (60 * 60 * 24), // now plus 24 hrs\n        bookings: Array(10).fill(0).map(i => generateMockBooking()),\n        catering: true,\n        charge_code: true,\n        extra_features: \"meeting_room boardroom\",\n        internal_or_external: \"internal\",\n        map_id: \"1\",\n        natural_light: false,\n        room_booking_screen: true,\n        room_name: `${name} - Local Name`,\n        vc: false,\n    }\n    if (overrides.settings) {\n        settings = { ...settings, ...overrides.settings };\n        delete overrides.settings;\n    }\n    if (recurring_search) {\n        settings.recurrence_availability = [\n            {\n                date: startOfDay.seconds,\n                available: false,\n            },\n            {\n                date: startOfDay.addValue({ days: 1 }).seconds,\n                available: false,\n            },\n            {\n                date: startOfDay.addValue({ days: 2 }).seconds,\n                available: false,\n            },\n            {\n                date: startOfDay.addValue({ days: 3 }).seconds,\n                available: false,\n            },\n        ]\n    }\n\n    const linked = Math.floor(predictableRandomInt(99999)) % 2 === 0 && SPACE_COUNT > 1;\n    return new Space({\n        id,\n        name: `${name} - Global Name`,\n        map_id: `${space_id || SPACE_COUNT}`,\n        type: faker.commerce.productName(),\n        searchable: Math.floor(predictableRandomInt(99999)) % 2 === 0,\n        controlable: Math.floor(predictableRandomInt(99999)) % 2 === 0,\n        hourly_rate: Math.floor(predictableRandomInt(300)) * 100,\n        bookable: Math.floor(predictableRandomInt(99999)) % 2 === 0,\n        capacity: 15,\n        sort_priority: 0,\n        setup: Math.floor(predictableRandomInt(6)) * 5,\n        breakdown: Math.floor(predictableRandomInt(6)) * 5,\n        support_url: `/control/#/${id}`,\n        image: faker.image.business(),\n        zones: ['zone_lvl-0'],\n        features: `${SpaceFeatures.BoardRoom} ${SpaceFeatures.ElectronicWhiteboard}`,\n        email: `${name.toLowerCase().split(' ').join('.')}@${USER_DOMAIN}`,\n        settings,\n        ...overrides\n    });\n}\n\nlet BOOKING_COUNT = 0;\nlet BOOKING_DATE =  DateNow(new Date()).setValue({ hour: 6 }).setValue({minute: 0}).subtractValue({ days: 10 }).startOfValue('minute');\n\n/**\n * Set the initial time used for generating mock bookings\n * @param time New initial time as ms from UTC epoch\n */\nexport function setMockBookingStartDatetime(time: number) {\n    const date = new DateTZ({date: time})\n    BOOKING_DATE = date.startOfValue('minute');\n}\n\n/**\n * Create mock raw API data for a booking\n * @param override Overrides the properties of the generated booking with it's own\n */\nexport function generateMockBooking(override: HashMap = {}) {\n    const id = `booking-${BOOKING_COUNT++}`;\n    BOOKING_DATE = BOOKING_DATE.addValue({ minutes: Math.floor(predictableRandomInt(4) + 2) * 15 });\n    const start = BOOKING_DATE.ms;\n    const duration = Math.floor(predictableRandomInt(4) + 2) * 15;\n    BOOKING_DATE = BOOKING_DATE.addValue({ minutes: Math.floor(predictableRandomInt(4)) * 15 });\n    const organiser = generateMockUser({ external: false, visitor: false });\n    const orders = Array(Math.floor(predictableRandomInt(5)))\n        .fill(0)\n        .map(_ => generateMockCateringOrder({ booking_date: start }, override.room_ids, override.menu));\n    const hasCatering = Math.floor(predictableRandomInt(34567)) % 3 === 0;\n    const date_start = new DateTZ({date: start})\n    return {\n        id,\n        title: `${faker.commerce.productName()} Meeting`,\n        attendees: Array(Math.floor(predictableRandomInt(5) + 2))\n            .fill(0)\n            .map((_, i) => generateMockUser(override.users)),\n        organiser,\n        start_epoch: date_start.seconds,\n        end_epoch: date_start.addValue({ minutes: duration }).seconds,\n        body: faker.lorem.paragraph(),\n        notes: [{ type: 'other', message: faker.lorem.paragraph() }],\n        location: faker.address.city(),\n        // Mckinsey only has internal or external meetings\n        booking_type: ['internal', 'external'][predictableRandomInt(2)],\n        setup: { 'space-01': Math.max(0, (predictableRandomInt(12) - 6) * 5) },\n        breakdown: { 'space-01': Math.max(0, (predictableRandomInt(12) - 6) * 5) },\n        status: 'accepted',\n        catering: hasCatering ? orders : [],\n        room: new Space(generateMinimalRoomDetails(1)), // returns space-01 type values\n        equipment_codes: {},\n        company:[],\n        ...override\n    };\n}\n\nlet BLD_COUNT = 0;\nlet LVL_COUNT = 0;\n\n/**\n * Generate raw mock data for creating a building\n * @param id Forced ID for the mock\n * @param overrides Supply object value overrides in place. Supports a levelGenerator function\n * to stabilize level ids for testing.\n */\nexport function generateMockBuilding(overrides: HashMap = {}): HashMap {\n    const id = `zone_bld-${BLD_COUNT++}`;\n    const levels = Array(10)\n        .fill(0)\n        .map((_, i) => generateMockLevel(undefined, overrides.levelGenerator?.(i)));\n    const features: any = {};\n    for (const lvl of levels) {\n        const count = Math.floor(predictableRandomInt(3) + 2);\n        features[lvl.level_id] = {};\n        for (let i = 0; i < count; i++) {\n            features[lvl.level_id][faker.commerce.productName()] = `feature-${i + 1}`;\n        }\n    }\n    return {\n        id,\n        zone_id: id,\n        extras: Array(10)\n            .fill(0)\n            .map(i => {\n                const name = faker.commerce.productName();\n                return {\n                    extra_id: name\n                        .split(' ')\n                        .join('-')\n                        .toLowerCase(),\n                    extra_name: name\n                };\n            }),\n        code: 'NYO',\n        name: faker.name.firstName(),\n        address: 'building address field',\n        city: 'building city',\n        loan_items: Array(10)\n            .fill(0)\n            .map(i => {\n                const name = faker.commerce.productName();\n                return {\n                    extra_id: name\n                        .split(' ')\n                        .join('-')\n                        .toLowerCase(),\n                    extra_name: name\n                };\n            }),\n        levels,\n        roles: {\n            'first-aiders': Array(10)\n                .fill(0)\n                .map(i => generateMockUser())\n        },\n        neighbourhoods: features,\n        settings: {\n            test: {\n                nested: {\n                    level2: true,\n                    org: false\n                }\n            },\n            city: faker.address.city()\n        },\n        timezone: 'America/Chicago',\n        ...overrides\n    };\n}\n\n/**\n * Generate raw mock data for a building level\n * @param id Forced ID for the mock\n * @param overrides value overrides\n */\nexport function generateMockLevel(id?: string, overrides: HashMap = {}): HashMap {\n    if (!id) {\n        id = `zone_lvl-${LVL_COUNT++}`;\n    }\n    return {\n        id,\n        level_id: id,\n        level_name: `Level ${LVL_COUNT}`,\n        short_name: `L ${LVL_COUNT}`,\n        ...overrides\n    };\n}\n\nlet USER_COUNT = 0;\n\nexport let USER_DOMAIN = 'acaprojects.com';\n\nconst USER_EMAILS: string[] = [];\n\n/**\n * Generate raw mock data for a user\n * @param id Forced ID for the mock\n * @param name Forced name for the user\n * @param external Whether user is external of the organisation\n */\nexport function generateMockUser(override: HashMap = {}): HashMap {\n    const id = `user-${USER_COUNT++}`;\n    const name = `${faker.name.firstName()} ${faker.name.lastName()}`;\n    const external = override.external || !(predictableRandomInt(99999) % 2);\n    const organisation = external ? faker.company.companyName() : USER_DOMAIN.split('.')[0];\n    let delegates: string[] = [];\n    const delegate_count = Math.min(predictableRandomInt(4) + 1, USER_EMAILS.length);\n    for (let i = 0; i < delegate_count; i++) {\n        delegates.push(USER_EMAILS[Math.floor(predictableRandomInt(USER_EMAILS.length))]);\n    }\n    delegates = unique(delegates);\n    const email = `${name\n        .split(' ')\n        .join('.')\n        .toLowerCase()}@${external ? 'not-' : ''}${USER_DOMAIN}`;\n    USER_EMAILS.push(email);\n    return {\n        id,\n        name,\n        first_name: name.split(' ')[0],\n        last_name: name.split(' ')[1],\n        email,\n        phone: faker.phone.phoneNumber(),\n        visitor: external,\n        organisation: {\n            id: organisation\n                .split(' ')\n                .join('.')\n                .toLowerCase(),\n            name: organisation\n        },\n        department: faker.commerce.department(),\n        staff_code: padZero(Math.floor(predictableRandomInt(99999)), 5),\n        delegates,\n        image: faker.image.avatar(),\n        ...override\n    };\n}\n\nexport function generateMockCateringOrder(overrides: HashMap = {}, room_id: string = '', menu: HashMap<HashMap[]> = {}) {\n    return {\n        id: `order-${predictableRandomInt(9999_9999)}`,\n        delivery_time: predictableRandomInt(6) * 5,\n        location_id: room_id, // R--- could be undefined\n        items: new Array(predictableRandomInt(5, 1)).fill(0).map(i => pickMenuItem(menu)),\n        ...overrides\n    };\n}\n\nfunction pickMenuItem(menu_map: HashMap<HashMap[]> = {}) {\n    const zones = Object.keys(menu_map);\n    const menu = menu_map[zones[predictableRandomInt(zones.length)]] || [];\n    const category = menu[predictableRandomInt(menu.length)] || { items: [] };\n    const group = { ...(category.items[predictableRandomInt(category.items.length)] || {}) };\n    if (!group.package && group.items?.length) {\n        const item = { ...group.items[predictableRandomInt(group.items.length)] };\n        item.amount = predictableRandomInt(5, 1);\n        return item;\n    }\n    group.amount = predictableRandomInt(5, 1);\n    return group;\n}\n\nexport function generateMockLocation(overrides: HashMap, fixed_locations: string[], maps: string[]): HashMap {\n    const fixed = predictableRandomInt(999_999_999) % 2 === 0;\n    if (fixed && (!overrides || overrides.fixed)) {\n        return {\n            map_id: fixed_locations[predictableRandomInt(fixed_locations.length)],\n            level: maps[predictableRandomInt(maps.length)],\n            ...overrides\n        };\n    } else {\n        return {\n            x: predictableRandomInt(900, 100),\n            x_max: 1000,\n            y: predictableRandomInt(500, 100),\n            level: maps[predictableRandomInt(maps.length)],\n            confidence: predictableRandomInt(30),\n            ...overrides\n        };\n    }\n}\n\nlet ORG_COUNT = 0;\n\nexport function generateMockOrganisation(): HashMap {\n    const buildings = Array(3).fill(0).map(i => generateMockBuilding());\n    return {\n        id: `zone_org-${ORG_COUNT++}`,\n        name: `Organisation ${ORG_COUNT}`,\n        buildings,\n        settings: {\n            discovery_info: {\n                buildings\n            },\n            test: {\n                nested: {\n                    org: true\n                }\n            }\n        }\n    };\n}\n\n\nexport const generateMockBuildingSetByCity = () => {\n    const buildings: Building[] = Array(10).fill(0)\n        .map(() => new Building(generateMockBuilding()));\n    buildings.push(...Array(2).fill(0).map(() => new Building(generateMockBuilding({\n        settings: {\n            city: 'Auckland'\n        },\n        city: 'Auckland'\n    }))));\n    buildings.push(...Array(5).fill(0).map(() => new Building(generateMockBuilding({\n        settings: {\n            city: 'NYC'\n        },\n        city: 'NYC'\n    }))));\n    return buildings;\n};\n\nexport function generateMockModalData(data: HashMap<any> = null) : HashMap  {\n    if (data) {\n        return data;\n    }\n    return {\n        pendingDate: new Date(1603087100 + (1000 * 60 * 15)),\n        pendingDuration: 60,\n        date: 1603087100,\n        duration: 30,\n    }\n}\n\nexport const mockDateToBuildingTz = (date?: number) =>{\n    return new DateTZ({date, building_tz: 'America/Chicago', is_local_tz: false})\n}","export * from './user.class'\nexport * from './user.utilities'\nexport * from './users.service'\n","import { BaseDataClass } from '../base-api.class';\nimport {\n  HashMap,\n  Identity\n} from '@mckinsey-converge/base';\nimport { MapLocation } from '../location';\nimport { ServiceManager } from '../service-manager.class';\n\nexport class User extends BaseDataClass {\n  /** Currently logged in user */\n  public static get active_user(): User {\n    const service = ServiceManager.serviceFor(User);\n    return service ? service.current : null;\n  }\n\n  /** First name of the user */\n  public readonly first_name: string;\n  /** Last name of the user */\n  public readonly last_name: string;\n  /** Windows user ID */\n  public readonly windows_id: string;\n  /** FMNO */\n  public readonly fmno: string;\n  /** Type of user */\n  public readonly type: 'partner' | 'external' | 'internal';\n  /** Contact phone number of the user */\n  public readonly phone: string;\n  /** Organisational department the user is part of */\n  public readonly business_unit: string;\n  /** Whether user is external from the application's organisation */\n  public readonly external: boolean;\n  /** Whether user is a visitor */\n  public readonly visitor: boolean;\n  /** Organisational Identifier for the user */\n  public readonly staff_code: string;\n  /** Basic location descriptor for the user */\n  public readonly location: string;\n  /** List of users that this user can act on behalf */\n  public readonly delegates: readonly string[];\n  /** URL of the user's avatar image */\n  public readonly image: string;\n  /** List of user groups associated with this user */\n  public readonly groups: readonly string[];\n  /** Organisation the user is associated with */\n  private _organisation: Identity;\n\n  /** Map location of the user */\n  private _location: MapLocation;\n  /** List of desk bookings */\n  // private _desk_bookings: HashMap = {}; // R--- can't explain why this is here.\n\n  constructor(raw_data: HashMap = {}) {\n    super(raw_data);\n    this.first_name = raw_data.first_name || '';\n    this.last_name = raw_data.last_name || '';\n    this.windows_id = raw_data.email || '';\n    this.fmno = raw_data.fmno;\n    this.external = raw_data.external || false;\n    this.visitor = raw_data.visitor || false;\n\n\n    this.type = this.visitor ? 'external' : 'internal';\n    this.phone = raw_data.phone || raw_data.mobile || '';\n    this.business_unit = raw_data.business_unit || raw_data.department || '';\n    this._organisation = raw_data.organisation || {\n      id: raw_data.organisation_id,\n      name: raw_data.organisation_name\n    };\n\n    this._location = null;\n    this.image = raw_data.image || '';\n    this.staff_code = raw_data.staff_code || raw_data.fmno || '';\n    this.delegates = raw_data.delegates || [];\n    this._location = new MapLocation(\n      raw_data.location && raw_data.location instanceof Object\n        ? raw_data.location\n        : { name: raw_data.location }\n    );\n    this.groups = raw_data.groups || [];\n    this.location = raw_data.location || raw_data.officeLocation || '';\n  }\n\n  /** Organisation the user is associated with */\n  public get organisation() {\n    return this._organisation;\n  }\n\n  /** Map location of the user */\n  public get last_location(): MapLocation {\n    return new MapLocation(this._location || {});\n  }\n\n  /**\n   * Ask the server for the users current location\n   */\n  public locate(): Promise<MapLocation> {\n    const service: any = ServiceManager.serviceFor(MapLocation);\n    return new Promise((resolve, reject) => {\n      if (service) {\n        service.show(this.id, { desk: this.email }).then(\n          l => {\n            this._location = l;\n            resolve(l);\n          },\n          e => reject(e)\n        );\n      } else {\n        resolve(null);\n      }\n    });\n  }\n\n  /**\n   * Whether user is available during the given period\n   * @param start Start time as a unix timestamp with milliseconds\n   * @param end End time as a unix timestamp with milliseconds\n   */\n  public available(start?: number, end?: number): Promise<boolean> {\n    return new Promise<boolean>(resolve => {\n      this._service.query({ email: this.email, start, end }).then(\n        l => resolve(l && l.length > 0),\n        _ => resolve(false)\n      );\n    });\n  }\n\n  /**\n   * Make a copy of this object\n   */\n  public clone(): User {\n    return new User(this);\n  }\n\n  /**\n   * Make a copy of this object without identification data\n   */\n  public duplicate(): User {\n    return new User({ ...this, id: null, email: null });\n  }\n\n  /**\n   * Convert object into plain object\n   */\n  public toJSON(this: User): HashMap {\n    const data = super.toJSON();\n    delete data.location;\n    return data;\n  }\n}\n\n// R--- Might need an toApiJSON due to visitor field.","import {\n  FormControl,\n  FormGroup,\n  Validators\n} from '@angular/forms';\n\nimport { HashMap } from '@mckinsey-converge/base';\nimport { User } from './user.class';\n\n/**\n * Generate form fields for the given user\n * @param user User to generate form for\n */\nexport function generateUserForm(user: User): FormGroup {\n  if (!user) {\n    throw Error('No user passed');\n  }\n  const fields: HashMap<FormControl> = {\n    id: new FormControl(user.id || ''),\n    name: new FormControl(user.name || ''),\n    first_name: new FormControl(user.first_name || '', [Validators.required, Validators.pattern(/^(?![\\d\\s]+$)[^\\d]+$/)]),\n    last_name: new FormControl(user.last_name || '', [Validators.required, Validators.pattern(/^(?![\\d\\s]+$)[^\\d]+$/)]),\n    email: new FormControl(user.email || '', [Validators.email])\n  };\n  // Generate form group for booking item\n    return new FormGroup(fields);\n}\n","import { Injectable } from '@angular/core';\nimport { Location } from '@angular/common';\nimport {\n    HttpClient,\n    HttpHeaders\n} from '@angular/common/http';\nimport { ComposerService } from '@placeos/composer';\nimport { first } from 'rxjs/operators';\n\nimport { Md5 } from 'ts-md5/dist/md5';\n\nimport { BaseAPIService } from '../base.service';\nimport { User } from './user.class';\nimport {\n    ApplicationLoadingState,\n    HashMap,\n    unique\n} from '@mckinsey-converge/base';\n\nimport { ApplicationService } from '../app.service';\nimport { ServiceManager } from '../service-manager.class';\nimport { SettingsService } from '../settings.service';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\nexport interface ILoginOptions {\n    /** URL to post login request to */\n    url?: string;\n    /** Whether form data is passed in the body of the request */\n    form?: boolean;\n    /** Custom headers to pass into the post request */\n    headers?: HashMap<string>;\n}\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class UsersService extends BaseAPIService<User> {\n    constructor(\n        protected _composer: ComposerService,\n        protected uhttp: HttpClient,\n        protected location: Location,\n        private _service: ApplicationService,\n        settingsService: SettingsService\n    ) {\n        super(_composer, settingsService);\n        ServiceManager.setService(User, this);\n        this._name = 'Users';\n        this._api_route = 'users';\n        this._compare = (a, b) => !a.id.localeCompare(b.id) || !a.email.localeCompare(b.email);\n        this.set('list', []);\n        this.set('current_user', new User({ id: 'local_user', name: 'Local User' }));\n        this.set('delegates', null);\n        this._composer.initialised.pipe(first((_) => _)).subscribe(() => this.init());\n    }\n\n    /** Currently logged in user */\n    public get current(): User {\n        return this.get('current_user');\n    }\n\n    /** Whether the user has properly logged in */\n    public get is_logged_in(): boolean {\n        return this.current && this.current.id !== 'local_user';\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Sets the access token and expiry for the user\n     * @param token OAuth bearer token\n     * @param expiry Expiry epoch timestamp in ms\n     * @param reload Whether to reload the page after setting tokens\n     */\n    public setToken(token: string, expiry?: number, reload: boolean = true) {\n        if (!expiry) {\n            const now = DateNow(new Date())\n            expiry = now.addValue({ days: 7 }).endOfValue('day').ms;\n        }\n        const path = `${location.origin}${\n            this._service.setting('composer.route') || ''\n        }/oauth-resp.html`;\n        const client_id = Md5.hashStr(path);\n        if (sessionStorage) {\n            sessionStorage.setItem(`${client_id}_access_token`, token);\n            sessionStorage.setItem(`${client_id}_expires_at`, `${expiry}`);\n        }\n        if (localStorage) {\n            localStorage.setItem(`${client_id}_access_token`, token);\n            localStorage.setItem(`${client_id}_expires_at`, `${expiry}`);\n        }\n        if (reload) {\n            this.location.go(this.location.path());\n        }\n        return path;\n    }\n\n    /**\n     * Post login request to the API\n     * @param query_params Key value pairs to pass into\n     * @param options Options for the login request\n     */\n    public async login(query_params: HashMap, options: ILoginOptions = {}): Promise<void> {\n        if (this.settingsService.concierge) {\n            if (!this._promises['login']) {\n                this._promises['login'] = new Promise<void>((resolve, reject) => {\n                    this.set('status', 'loading');\n                    let headers = new HttpHeaders();\n                    if (!options || options.form !== false) {\n                        headers = headers.append('Content-Type', 'application/x-www-form-urlencoded');\n                    }\n                    const url = (options ? options.url : '') || '/auth/signin';\n                    this.uhttp.post(url, query_params, { headers }).subscribe(\n                        (_) => null,\n                        (e) => reject(e),\n                        () => {\n                            this._composer.auth.authorise();\n                            resolve();\n                        }\n                    );\n                });\n            }\n            return this._promises['login'];\n        }\n    }\n\n\n    /**\n     * Logout of user and redirect to logout URL\n     */\n    public logout() {\n        this._composer.auth.logout();\n    }\n\n    /**\n     * Loads current user from API. This diverges from {@link load} in order to simply return\n     * the user object instead of setting it on the service.\n     */\n    public async loadCurrentUser(): Promise<User> {\n        return this.show('current')\n    }\n\n    /**\n     * Load initial data for the service\n     */\n    protected load(tries: number = 0): Promise<void> {\n        const loading: ApplicationLoadingState = this._service.get('loading') || {};\n        loading.user = { message: 'Loading user credentials', state: 'loading' };\n        this._service.set('loading', loading);\n        this.set('status', 'loading');\n        return new Promise<void>((resolve) => {\n            // this is due to unclear nature of the merge between concierge and staff\n            // concierge has the retries enabled, while staff continuously retries.\n            if (this.settingsService.concierge && tries > 4) {\n                this.set('status', 'invalid');\n                loading.user = { message: 'Loading user credentials', state: 'failed' };\n                this._service.set('loading', loading);\n                return resolve();\n            }\n            this.show('current').then(\n                async (current_user) => {\n                    this.set('status', 'available');\n                    this.set('current_user', current_user);\n                    this._initialised.next(true);\n                    if (this._service && this._service.setting('app.user.grab_api_details')) {\n                        this.show(current_user.email).then(\n                            async (user) => {\n                                this.set('current_user', user);\n                                if (this._service.setting('app.user.update_location')) {\n                                    this.interval('location', () => user.locate(), 5000);\n                                }\n                                await this.loadDelegates().catch(_ => null);\n                                resolve();\n                                loading.user = {\n                                    message: 'Loading user credentials',\n                                    state: 'complete'\n                                };\n                                this._service.set('loading', loading);\n                            },\n                            () => this.timeout('load', () => this.load(++tries).then(() => resolve()), Math.min(3000, 300 * tries))\n                        );\n                    } else {\n                        \n                        // is after process\n                        if (this._service.setting('app.user.update_location')) {\n                            this.interval('location', () => current_user.locate(), 5000);\n                        }\n                        await this.loadDelegates().catch(_ => null);\n                        resolve();\n                        loading.user = { message: 'Loading user credentials', state: 'complete' };\n                        this._service.set('loading', loading);\n                    }\n                },\n                () => this.timeout('load', () => this.load(++tries).then(() => resolve()), Math.min(3000, 300 * tries))\n            );\n        });\n    }\n\n    private async loadDelegates() {\n        const delegates = this.current.delegates;\n        if (!delegates || !delegates.length) {\n            return [];\n        }\n        const promises: Promise<User>[] = [];\n        for (const email of delegates) {\n            promises.push(this.show(email));\n        }\n        const list = await Promise.all(promises);\n        this.set('delegates', list);\n        this.set('list', unique((this.get('list') || []).concat(list)));\n        return list;\n    }\n\n    /**\n     * Convert raw API data into a valid User Object\n     * @param raw_item Raw API data\n     */\n    protected process(raw_data: any): User {\n        return new User(raw_data);\n    }\n}","import { AbstractControl } from '@angular/forms';\n\nimport { User } from './users';\n\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n\nconst HAS_ERROR = true;\n\n/**\n * Build start time validation function\n * @param date Date of the time to check\n */\nexport function buildValidateDate(date?: number) {\n  const from = new DateTZ({ date });\n  return (c) => validateDate(c, date);\n}\n\n/**\n * Check that control value is a date that is the same or after from date\n * @param control Angular form control\n * @param is_from Comparison date(ms from UTC epoch). Defaults to the current time\n */\nexport function validateDate(control: AbstractControl, is_from?: number) {\n  const from = new DateTZ({date: is_from})\n  const date = new DateTZ({date: control.value})\n  return date.isBeforeDate(from) ? { date: HAS_ERROR, message: 'Booking needs to be made in the future' } : null;\n}\n\n/**\n * Build start time validation function\n * @param date Date of the time to check\n * @param is_from Comparison date(ms from UTC epoch). Defaults to the current time\n */\nexport function buildValidateStartTime(date: number, is_from?: number) {\n  const from = new DateTZ({date: is_from})\n  return (c) => validateStartTime(c, date, from.ms);\n}\n\n/**\n * Check that control value time is after the comparison date time\n * @param control Angular form control\n * @param date Date of the time to check\n * @param is_from Comparison date(ms from UTC epoch). Defaults to the current time\n */\nexport function validateStartTime(control: AbstractControl, date: number, is_from?: number) {\n  const now = new DateTZ({date: is_from});\n  const parts = control.value.split(':');\n  const date_obj = new DateTZ({date});\n  return date_obj.setValue({ hour: +parts[0], minute: +parts[1] }).isBeforeDate(now) ? {\n    start: HAS_ERROR,\n    message: 'Booking time needs to be made in the future'\n  } : null;\n}\n\nexport function buildValidateDuration(min: number = 30, max: number = 240) {\n  return (c) => validateDuration(c, min, max);\n}\n\nexport function validateDuration(control: AbstractControl, min: number = 30, max: number = 240) {\n  if (control.value < (min || 30)) {\n    return { duration: HAS_ERROR, message: `Minimum booking duration is ${min} minute${min === 1 ? 's' : ''}` };\n  } else if (control.value > (max || 480)) {\n    return { length: HAS_ERROR, message: `Maximum booking duration is ${max} minute${max === 1 ? 's' : ''}` };\n  }\n  return null;\n}\n\nexport function buildValidateAttendees(host: User, min: number = 0) {\n  return (c) => validateAttendees(c, host, min);\n}\n\nexport function validateAttendees(control: AbstractControl, host: User, min: number = 0) {\n  if (!control || !(control.value instanceof Array)) {\n    return min > 0\n      ? { invalid: true, message: `Minimum of ${min} attendee${min === 1 ? ' is' : 's are'} required other than you` }\n      : null;\n  }\n  const list: User[] = control.value;\n  if (host) {\n    const result = list.find(a => a.email === host.email);\n    if (result) {\n      list.splice(list.indexOf(result), 1);\n    }\n  }\n  return list.length >= min ? null : {\n    count: true,\n    message: `Minimum of ${min} attendee${min === 1 ? ' is' : 's are'} required other than you`\n  };\n}\n\nexport function validateEndTime(dateControlTz: AbstractControl) {\n  return (control: AbstractControl) => {\n    // const date = new DateTZ({date: date_control ? date_control.value : undefined})\n    const now = DateNow(new Date())\n    return dateControlTz.value.addValue({ minutes: control.value || 60 }).isBeforeDate(now)? { end_time: true } : null;\n  };\n}\n\nexport function noWhitespaceValidator(control: AbstractControl) {\n  const value = control?.value;\n  if ( value === '') {\n      return null; // Return null if control value is undefined or null\n  }\n  const isWhitespace = value.trim().length === 0;\n  // const isValid = !isWhitespace;\n  return !isWhitespace ? null : { whitespace: true };\n}\n\n","export * from './lib/date-tz.class'","import { DateObjectUnits, DateTime, DateTimeUnit, DurationLike, DurationUnits } from 'luxon';\nimport { getTimezoneOffset } from 'date-fns-tz';\n\nfunction padZero(value: number, length: number): string {\n    let str = `${value}`;\n    while (str.length < length) str = `0${str}`;\n    return str;\n}\n\ninterface DateTZParams {\n    date?: number | DateTime\n    building_tz?: string\n    is_local_tz?: boolean\n    all_day?: boolean\n}\n\nconst now = new Date()\n\nexport class DateTZ {\n    date: DateTime\n    date_org: DateTime\n    building_tz: string\n    is_local_tz: boolean = true\n    all_day: boolean\n    local_tz: string\n    valid: boolean\n\n    constructor(data?: DateTZParams) { \n        this.date_org = typeof data?.date === 'number' ? DateTime.fromMillis(data?.date) : data?.date ? data?.date : DateTime.fromMillis(now.valueOf())\n        this.is_local_tz = data?.is_local_tz === false ? data?.is_local_tz : true\n        this.all_day = data?.all_day || false\n        this.local_tz = DateTime.now().zoneName\n        this.building_tz = data?.building_tz || this.local_tz\n        this.date = !this.is_local_tz ? this.date_org.setZone(this.building_tz) : this.date_org\n        this.valid = this.date.isValid\n    }\n\n    //get epoch milliseconds\n    public get ms(): number {\n        return this.date.valueOf()\n    }\n\n    //get epoch seconds\n    public get seconds(): number {\n        return Math.trunc(this.date.toSeconds())\n    }\n\n    //get the second of the minute\n    public get second(): number {\n        return this.date.second\n    }\n\n    //get the minutes of the hour\n    public get minutes(): number {\n        return this.date.minute\n    }\n\n    //get the minutes of the hour\n    public get hours(): number {\n        return this.date.hour\n    }\n\n    public get utc(): number {\n        const newDate = new DateTZ({...this, date: this.date.toUTC()})\n        return newDate.seconds\n    }\n\n    public get dateDay(): number {\n        return this.date.day\n    }\n\n    public get dateHour(): number {\n        return this.date.hour\n    }\n\n    public get dateYear(): number {\n        return this.date.year\n    }\n\n    public get dateWeekday(): number {\n        try {\n            return this.date.weekday;\n        } catch (e) {\n            return this.date.toJSDate().getDay();\n        }\n    }\n\n    public get dateMonth(): number {\n        return this.date.month\n    }\n\n    public dateDiff (compare_to: DateTZ, unit: DurationUnits, ans_unit = 'minutes'): number {\n        return this.date.diff(compare_to.date, unit)[ans_unit]\n    }\n\n    //set the date to the begining of the given unit\n    public startOfValue (unit: DateTimeUnit) {\n        // All the luxon start of values work as needed except for week\n        let newDate = new DateTZ({...this, date: this.date.startOf(unit)})\n        // Special week logic\n        if (unit === 'week') {\n            if (this.dateWeekday === 7) {\n                // Don't change, we want sunday as the start of the week even though luxon thinks it is Monday\n                newDate =  new DateTZ({ ...this, date: this.date })\n            } else if (this.dateWeekday === 1) {\n                // If this.date is monday, just subtract one more day to make it Sunday\n                const monday =  new DateTZ({ ...this, date: this.date })\n                newDate = monday.subtractValue({ days: 1 });\n            } else {\n                // If later than monday, startOfWeek back to monday and then subtact another day to get to Sunday.\n                const monday = new DateTZ({...this, date: this.date.startOf(unit)})\n                newDate = monday.subtractValue({ days: 1 })\n            }\n        }\n\n        return newDate\n    }\n\n    //set the date to the end of the given unit\n    public endOfValue (unit: DateTimeUnit) : DateTZ {\n        // All the luxon start of values work as needed except for week\n        let newDate = new DateTZ({...this, date: this.date.startOf(unit)})\n        // Special week logic\n        if (unit === 'week') {\n            if (this.dateWeekday === 6) {\n                // Don't change, we want saturday as the end of the week even though luxon thinks it is Sunday\n                newDate =  new DateTZ({ ...this, date: this.date })\n            } else if (this.dateWeekday === 7) {\n                // If this.date is Sunday, this alone is the luxon end of week so add a day\n                // to get to monday, then endOfWeek to Sunday, and subtract 1 day to Saturday\n                const sunday =  new DateTZ({ ...this, date: this.date }).addValue({ days: 1 })\n                newDate = sunday.endOfValue(unit).subtractValue({ days: 1 }); // return next saturday\n            } else {\n                // If not saturday or sunday\n                // endOfWeek to Sunday and then subtact a day to get to Saturday.\n                const later = new DateTZ({...this, date: this.date.endOf(unit)})\n                newDate = later.subtractValue({ days: 1 })\n            }\n        } else {\n            newDate =  new DateTZ({...this, date: this.date.endOf(unit)})\n        }\n\n        return newDate\n    }\n    \n    public startEpoch (): number {\n        const org = new DateTZ({date: this.date_org})\n        return this.all_day\n        ? this.startOfValue('day').ms - this.dateDiff(org, 'minutes')\n        : this.ms\n    }\n\n    //clone the given value and unit to the date\n    public clone (): DateTZ {\n        // return new DateTZ({...this})\n        return this.addValue({ seconds: 0 })\n    }\n\n    //adds the given value and unit to the date\n    public addValue (duration: DurationLike, isLastDayOfMonth?: boolean): DateTZ {\n        return new DateTZ({...this, date: isLastDayOfMonth ? this.date.plus(duration).endOf('month') : this.date.plus(duration)});\n    }\n\n    //subtracts the given value and unit to the date\n    public subtractValue (duration: DurationLike): DateTZ {\n        const newDate = new DateTZ({...this, date: this.date.minus(duration)})\n        return newDate\n    }\n\n    public setValue (obj: DateObjectUnits): DateTZ {\n        const newDate = new DateTZ({...this, date: this.date.set(obj)})\n        return newDate\n    }\n\n    public formatDate (format: string): string {\n        // Return new immuatable via \"plus\" to prevent \n        // TypeError: Cannot assign to read only property 'weekData' of object\n        // https://github.com/moment/luxon/issues/601\n        return this.date.plus({ seconds: 0 }).toFormat(format)\n    }\n\n    public formatLocalDate (format: string): string {\n        // setZone already returns new immutable so it doesn't have the formatDate issue.\n        return this.date.plus({ seconds: 0 }).setZone(this.local_tz).toFormat(format)\n    }\n\n    public isSameDate(compare_to: DateTZ, value: DateTimeUnit): boolean {\n        return this.date.hasSame(compare_to.date, value)\n    }\n\n    public isAfterDate(compare_to: DateTZ, unit?: DateTimeUnit): boolean {\n        switch (unit) {\n            case 'year':\n                return this.dateYear > compare_to.dateYear\n            case 'month':\n                if(this.isAfterDate(compare_to, 'year')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'year')){\n                    return false\n                }else{\n                    return this.dateMonth > compare_to.dateMonth\n                }\n            case 'day':\n                if(this.isAfterDate(compare_to, 'month')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'month')){\n                    return false\n                }else{\n                    return this.dateDay > compare_to.dateDay\n                }\n            case 'hour':\n                if(this.isAfterDate(compare_to, 'day')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'day')){\n                    return false\n                }else{\n                    return this.dateHour > compare_to.dateHour\n                }\n            case 'minute':\n                if(this.isAfterDate(compare_to, 'hour')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'hour')){\n                    return false\n                }else{\n                    return this.minutes > compare_to.minutes\n                }\n            default:\n                return this.ms > compare_to.ms;\n        }\n    }\n\n    public isBeforeDate(compare_to: DateTZ, unit?: DateTimeUnit): boolean {\n        switch (unit) {\n            case 'year':\n                return this.dateYear < compare_to.dateYear\n            case 'month':\n                if(this.isBeforeDate(compare_to, 'year')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'year')){\n                    return false\n                }else{\n                    return this.dateMonth < compare_to.dateMonth\n                }\n            case 'day':\n                if(this.isBeforeDate(compare_to, 'month')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'month')){\n                    return false\n                }else{\n                    return this.dateDay < compare_to.dateDay\n                }\n            case 'hour':\n                if(this.isBeforeDate(compare_to, 'day')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'day')){\n                    return false\n                }else{\n                    return this.dateHour < compare_to.dateHour\n                }\n            case 'minute':\n                if(this.isBeforeDate(compare_to, 'hour')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'hour')){\n                    return false\n                }else{\n                    return this.minutes < compare_to.minutes\n                }\n            default:\n                return this.ms < compare_to.ms;\n        }\n    }\n\n    public toZone(tz: string): DateTZ {\n        const newDate = new DateTZ({\n            ...this, \n            date: this.date.setZone(tz), \n            building_tz: tz, \n            is_local_tz: false\n        })\n        return newDate\n    }\n\n    public setTimestamp(timestamp: number): DateTZ {\n        const newDate = new DateTZ({\n            ...this, \n            date: timestamp,\n        })\n        return newDate\n    }\n\n    public get JSDate(): Date {\n        return this.date.toJSDate()\n    }\n\n    // helper to log out the dateTZ values\n    public logDateTz (label: string = ''): void {\n        console.log(`${label} local tz/date/time`, this.addValue({ seconds: 0 }).formatLocalDate(\"cccc d MMMM,yyyy h:mma\"), this.local_tz)\n        console.log(`${label} building tz/date/time`, this.addValue({ seconds: 0 }).formatDate(\"cccc d MMMM,yyyy h:mma\"), this.building_tz)\n    }\n}\n\nexport const DateNow = (date: Date = new Date()) => {\n    return new DateTZ({date: date.valueOf()})\n} \n\n// input the local time and the building timezone\nexport const convertLocalTimestampToTimezonedDateTz = (timestamp: number, buildingTimezone: string): DateTZ => {\n    const date = new Date(timestamp);\n    return new DateTZ({ date: timestamp, building_tz: buildingTimezone, is_local_tz: false }).setValue({\n        day: date.getDate(),\n        hour: date.getHours(),\n        minute: date.getMinutes()\n    });\n}\n\n// input the building time and the building timezone\nexport const convertTimezonedTimestampToLocalDateTz = (timestamp: number, buildingTimezone: string): DateTZ => {\n    const local_tz = DateTime.now().zoneName;\n    const localOffset = getTimezoneOffset(local_tz, new Date(timestamp));\n    const desiredOffset = getTimezoneOffset(buildingTimezone, new Date(timestamp));\n    if (localOffset > desiredOffset) {\n        const eleA = timestamp + (localOffset - desiredOffset);\n        return  new DateTZ({date: eleA, building_tz: buildingTimezone, is_local_tz: false});\n    } else {\n        const eleA = timestamp + (desiredOffset - localOffset);\n        return  new DateTZ({date: eleA, building_tz: buildingTimezone, is_local_tz: false});\n    }\n}\n\nexport const localTimezone = () => {\n    return Intl.DateTimeFormat().resolvedOptions().timeZone;\n}\n\nexport const getTimezoneOffsetString = (tz: string) => {\n    const offset_minutes = Math.floor(getTimezoneOffset(tz) / 1000 / 60);\n    const hours = Math.floor(offset_minutes/60);\n    const minutes = offset_minutes % 60;\n    return `${offset_minutes > 0 ? '+' : '-'}${padZero(Math.abs(hours), 2)}${padZero(minutes, 2)}`;\n}\n\nexport function toMiddayUTC(value: DateTZ = DateNow()) {\n    // exclude Auckland from rouding up timezone as it has 12+ hours UTC timezone difference\n    return value.building_tz.includes('Auckland') ? value :  new DateTZ({\n        date: value.setValue({ hour: 12, minute: 0 }).ms,\n        is_local_tz: false,\n        building_tz: 'UTC',\n    }).setValue({ hour: 12, minute: 0 });\n}\n\n/**returns the offset between two timezones in minutes and hours */\nexport function timezoneOffset(tz: string){\n    const nowTz = DateNow(new Date())\n    const offset = nowTz.date.offset - nowTz.toZone(tz).date.offset\n    return {minutes: offset, hours: offset/60}\n}\n\nexport function isToday (date, timezone) {\n\n    return new DateTZ({\n        date: toMiddayUTC(date).ms,\n        is_local_tz: false,\n        building_tz: timezone\n    }).isSameDate(\n        new DateTZ({\n            date: Date.now(),\n            is_local_tz: false,\n            building_tz: timezone,\n        }),\n        'day'\n    );\n}\n","export * from './lib/environment.module';\nexport * from './lib/version';\nexport * from './lib/environment.service'\nexport * from './lib/types'\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n    imports: [CommonModule],\n    providers: []\n})\nexport class EnvironmentModule {\n}\n","import {\n    Inject,\n    Injectable\n} from '@angular/core';\nimport { EnvironmentData } from './types';\n\nexport const ENVIRONMENT_TOKEN = 'environments_service_data';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class EnvironmentService {\n\n    public get production(): boolean {\n        return this.environment.production;\n    }\n\n    public get heap_io_id(): number {\n        return this.environment.heap_io_id;\n    }\n\n    constructor(@Inject(ENVIRONMENT_TOKEN) private environment: EnvironmentData) {\n    }\n}\n","// IMPORTANT: THIS FILE IS AUTO GENERATED! DO NOT MANUALLY EDIT OR CHECKIN!\n/* tslint:disable */\nexport const VERSION = {\n    \"dirty\": false,\n    \"raw\": \"4725c03f5\",\n    \"hash\": \"4725c03f5\",\n    \"distance\": null,\n    \"tag\": null,\n    \"semver\": null,\n    \"suffix\": \"4725c03f5\",\n    \"semverString\": null,\n    \"version\": \"0.0.0\",\n    \"time\": 1694028339214\n};\n/* tslint:enable */\n","export * from './lib/legacy-overlays.module';\nexport * from './lib/space-select-modal/space-select-modal.component';\nexport * from './lib/new-user-modal/new-user-modal.component';\nexport * from './lib/confirm-modal/confirm-modal.component';\nexport * from './lib/catering-confirm-modal/catering-confirm-modal.component';\nexport * from './lib/catering-details-modal/catering-details-modal.component';\nexport * from './lib/requirement-details-modal/requirement-details-modal.component';\nexport * from './lib/booking-confirm/booking-confirm.component';\nexport * from './lib/user-form/user-form.component'\nexport * from './lib/booking-form/booking-form.component'\n","import {\n    Component,\n    EventEmitter,\n    Inject,\n    OnInit,\n    Output\n} from '@angular/core';\nimport {\n    MAT_DIALOG_DATA,\n    MatDialogRef\n} from '@angular/material/dialog';\nimport { Router } from '@angular/router';\n\nimport {\n    ApplicationService,\n    Booking,\n    BookingsService,\n    BookingStateService,\n    CateringOrder,\n    getFirstDateFromList,\n    OrganisationService,\n    rulesForSpace,\n    recurrenceDetails,\n    SeriesAction,\n    SettingsService,\n    Space,\n    SpacesService,\n    User,\n    UsersService,\n    formatWhen,\n    BOOKING_STATUS\n} from '@mckinsey-converge/data-common';\nimport {\n    BaseDirective,\n    DialogEvent,\n    HashMap,\n    humaniseDuration\n} from '@mckinsey-converge/base';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ConflictsModalComponent, ConflictsModalComponentData } from '@mckinsey-converge/ui';\n\n\nexport interface BookingConfirmModalData {\n    old_booking: Booking;\n    booking: Booking;\n    action?: SeriesAction\n}\n\nexport interface BookingDetailInfo {\n    bookedBy: {\n        display:boolean,\n        value: string\n    }\n}\n\n@Component({\n    selector: 'a-booking-confirm-modal',\n    templateUrl: './booking-confirm.component.html',\n    styleUrls: ['./booking-confirm.component.scss']\n})\nexport class BookingConfirmComponent extends BaseDirective implements OnInit{\n    /** Emitter for user actions on the modal */\n    @Output() public event = new EventEmitter();\n    /** Display string for changes are being processed */\n    public loading: string;\n    /** Whether space availability is being checked */\n    public checking_available: boolean;\n    /** Whether to show all attendees */\n    public show_attendees: boolean;\n    /** Whether to show all attendees */\n    public show_locations: boolean;\n    /** Whether to show all catering orders */\n    public show_orders: boolean;\n    /** Whether booking has succeeded */\n    public success: boolean;\n    /** Whether booking needs to be accepted */\n    public readonly is_request: boolean;\n\n    public approved: boolean;\n    public declined: boolean;\n    public bookingDetails: BookingDetailInfo;\n    lastMomentConflict: boolean = false;\n    \n    /** Booking to confirm changes to */\n    public get old_booking(): Booking {\n        return this._data.old_booking;\n    }\n\n    /** Booking to confirm changes to */\n    public get booking(): Booking {\n        return this._data.booking;\n    }\n\n    /** Active user */\n    public get user(): User {\n        return this._users.current;\n    }\n\n    /** Title of the displayed event */\n    public get title(): string {\n        return this.booking.title;\n    }\n\n    /** Display string of when the event will occur */\n    public get when(): string {\n        const duration_value = this.booking.duration;\n        const all_day = this.booking.all_day && duration_value < 25 * 60;\n        if(this.booking.is_recurrent && this.booking.recurrence_starts && this.booking.recurrence_starts.length){\n            return formatWhen({all_day, ...this.recurrenceDates })\n        }\n        return formatWhen({\n            all_day,\n            startTZ: this.booking.startDateTz,\n            endTZ: this.booking.endDateTz,\n            displayEndTZ: this.booking.displayEndDateTz})\n    }\n\n    public get recurrenceDates(){\n        const startTZ = getFirstDateFromList(this.booking.recurrence_starts)\n        const endTZ = startTZ.addValue({minutes: this.booking.duration})\n        return {startTZ, endTZ, displayEndTZ: endTZ}\n    }\n\n    /** Display string for the recurrence value of the booking */\n    public get recurrence(): string {\n        return recurrenceDetails({\n            period: this.booking.recurrence_period,\n            end: this.booking.recurrence_endTz,\n            list: this.booking.recurrence_starts,\n            interval: this.booking.recurrence_interval\n        });\n    }\n\n    /** Display string for the event's duration */\n    public get duration(): string {\n        const duration_value = this.booking.duration;\n        return this.booking.all_day ? 'All Day' : humaniseDuration(duration_value);\n    }\n\n    /** List of spaces associated with the event */\n    public get spaces(): Space[] {\n        return [this.booking.room];\n    }\n\n    /** List of attendees associated with the event not including the host */\n    public get attendees(): User[] {\n        const attendees = this.booking.attendees;\n        return attendees.filter((i) => i.email !== this.organiser.email);\n    }\n\n    /** Host of the event */\n    public get organiser(): User {\n        return this.booking.organiser || this._users.current;\n    }\n\n    /** Host of the event */\n    public get equipment_codes(): HashMap<string> {\n        return this.booking.equipment_codes || {};\n    }\n\n    /** Host of the event */\n    public get catering_codes(): HashMap<string> {\n        const catering = this.catering;\n        const codes = {};\n        for (const order of this.catering) {\n            codes[order.location_id] = order.charge_code;\n        }\n        return codes;\n    }\n\n    /** Host of the event */\n    public get equipment_notes(): HashMap<string> {\n        return this.booking.notes\n            .filter((note) => note.type === 'equipment')\n            .reduce((map, notes) => {\n                map[notes.space] = notes.message;\n                return map;\n            }, {});\n    }\n\n    /** Details about the event */\n    public get notes(): string {\n        return this.booking.body;\n    }\n\n    /** List of catering orders in the booking */\n    public get catering(): CateringOrder[] {\n        return (this.booking.catering || []).map((order) => {\n            const space: any = this.spaces.find(\n                (a_space) => a_space.email === order.location_id\n            ) || {\n                level: {}\n            };\n            const building: any =\n                this._org.buildings.find((bld) => bld.id === space.level.building_id) || {};\n            return new CateringOrder({\n                ...order,\n                location: space.local_name,\n                symbol: building.currency,\n                booking_date: this.booking.startDateTz.ms,\n                booking_timezone: this.booking.timezone,\n            });\n        });\n    }\n\n    /** Map of changes to the booking */\n    public get changes(): HashMap<boolean> {\n        return {};\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _users: UsersService,\n        private _org: OrganisationService,\n        private _bookings: BookingsService,\n        private _booking_state_service: BookingStateService,\n        private _spaces: SpacesService,\n        private _router: Router,\n        private _dialog: MatDialog,\n        private _dialog_ref: MatDialogRef<BookingConfirmComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: BookingConfirmModalData,\n        public settings: SettingsService\n    ) {\n        super();\n        this.booking.time_changed =\n            this.old_booking &&\n            (this.old_booking.startDateTz.ms !== this.booking.startDateTz.ms ||\n                this.old_booking.duration !== this.booking.duration);\n        // in concierge, all bookings are acceptable without explicit approval.\n\n        const rules = rulesForSpace({ user: this.user, space: this.booking.room, duration: 60 });\n        this.is_request = this.settings.concierge ? false : rules.auto_approve;\n    }\n\n    ngOnInit(): void {\n        this.approved = this.booking.status === BOOKING_STATUS.approved;\n        this.declined = this.booking.status === BOOKING_STATUS.declined; \n        // test comment\n        const {creator, organiser, booker_concierge} = this.booking;\n        this.bookingDetails = {\n            bookedBy: {\n                display: creator && ( creator.email !== organiser.email || (creator.email === organiser.email && (booker_concierge !== null && booker_concierge !==undefined ) && organiser.email !==booker_concierge['email']) ),\n                value: (creator.email === organiser.email && booker_concierge !== null && organiser.email !==booker_concierge['email']) ?  booker_concierge['name'] || booker_concierge['email']  :  creator?.name || creator.email\n            }\n        }\n    }\n\n    /**\n     * Save booking changes\n     */\n    public saveChanges() {\n        this.loading = 'Checking availability of selected spaces';\n        this._dialog_ref.disableClose = true;\n        this.checkSpaceAvailability().then(\n            () => {\n                this.loading = 'Processing booking request...';\n                // Change the unchanged settings to the selected room\n                const newEmail = this.booking.space.email;\n                const replaceObjects = ['setup', 'breakdown', 'approval_status']\n                replaceObjects.forEach(key => {\n                    const obj = this.booking[key];\n                    if (obj && obj.constructor === Object) {\n                        const keys = Object.keys(obj);\n                        if (keys.length > 0) {\n                            const replacement = {};\n                            keys.forEach(nk => {\n                                replacement[newEmail] = obj[nk];\n                            })\n                            this.booking[key] = replacement;\n                        }\n                    }\n                });\n\n                // if notes or catering exist? add 15 min buffer setup and breakdown to booking\n                const has_note_buffer = (this.booking.notes && this.booking.notes?.length) || (this.booking.catering && this.booking.catering?.length) ? {[this.booking?.space?.email]: 900} :  null; // 900 seconds = 15 min\n                if (has_note_buffer) {\n                  this.booking.setup = has_note_buffer;\n                  this.booking.breakdown = has_note_buffer;      \n                }\n\n                this._bookings.save(this.booking, this._data.action === SeriesAction.EDIT).then(\n                    async (bkn) => {\n                        this.loading = null;\n                        this.success = true;\n                        this._dialog_ref.disableClose = false;\n                        const updated = new Booking({ ...this.booking, ...bkn.toApiJSON() });\n                        this._booking_state_service.replace(updated);\n                        \n                        /**\n                         * update the master booking in case of recurring to have latest updated in the system\n                         */\n                        if(updated.recurrence_master_id !== null)\n                        { \n                            const master_booking = await this._bookings.show(updated.recurrence_master_id);\n                            this._booking_state_service.replace(master_booking);\n                        }\n\n                        localStorage.removeItem('ACA_STAFF.booking_form_data');\n                        this.event.emit({ reason: 'done' });\n                        this._service.notifySuccess(\n                            `Successfully ${this.booking.id ? 'updated' : 'created'} booking`\n                        );\n                    },\n                    (err) => {\n                        this.lastMomentConflict = err.status === 409;\n                        //this.loading = null;\n                        this._dialog_ref.disableClose = false;\n                        const erroMessage = err.status === 409 ? 'Apologies, this room has been booked recently by another user, please try another one.' : err.message\n                        this.loading = erroMessage;\n                        this._service.notifyError(\n                            `Error ${this.booking.id ? 'updating' : 'creating'} booking: ${erroMessage}`\n                        );\n                       setTimeout(()=> {\n                        this.loading = null;\n                        this.event.emit({ reason: 'last-moment-conflict' });\n                       }, 4000) ;\n                    }\n                );\n            },\n            (err) => {\n                // this.loading = null;\n                // this._dialog_ref.disableClose = false;\n                // this._service.notifyError(`Error checking space availability: ${err}`);\n                // this.event.emit({ reason: 'last-moment-conflict' });\n\n                this.lastMomentConflict = true;\n                this._dialog_ref.disableClose = false;\n                const erroMessage = 'Apologies, this room has been booked recently by another user, please try another one.';\n                this.loading = erroMessage;\n                this._service.notifyError(\n                    `Error ${this.booking.id ? 'updating' : 'creating'} booking: ${erroMessage}`\n                );\n               setTimeout(()=> {\n                this.loading = null;\n                this.event.emit({ reason: 'last-moment-conflict' });\n               }, 4000) ;\n            }\n        );\n    }\n\n    /**\n     * Staff only\n     */\n    public newBooking() {\n        this._router.navigate(['/book', 'spaces']);\n        this._dialog_ref.close();\n    }\n\n    /**\n     * Staff only\n     */\n    public toSchedule() {\n        this._router.navigate(['/schedule'], {\n            queryParams: { email: this.booking.organiser.email }\n        });\n        this._dialog_ref.close();\n    }\n\n    /**\n     * Check whether the selected spaces are available for the selected time period\n     */\n    public checkSpaceAvailability(): Promise<void> {\n        const spaces: Space[] = this.spaces;\n        if (\n            (this.booking.id &&\n                (this.booking.startDateTz.ms === this.old_booking.startDateTz.ms &&\n                    this.booking.duration === this.old_booking.duration)) ||\n            (spaces && spaces.length <= 0)\n        ) {\n            return Promise.resolve();\n        }\n        return new Promise((resolve, reject) => {\n            // Use of this.booking.timezone is unreliable, use booking space instead.\n            const all_day = this.booking.all_day;\n            // R--- should be nothing to do with date as a timestamp getter\n            this._spaces\n                .available({\n                    room_ids: spaces.map((space) => space.id).join(','),\n                    dateTz: this.booking.startDateTz,\n                    duration: all_day ? 24 * 60 : this.booking.duration,\n                    ignore: this.booking.icaluid,\n                    recurrence_count: this.booking.recurrence_count,\n                    recurrence_period: this.booking.recurrence_period,\n                    recurrence_endTz: this.booking.recurrence_endTz,\n                    recurrence_interval: this.booking.recurrence_interval,\n                    recurrence_starts: this.booking.recurrence_starts,\n                    is_recurrent: this.booking.is_recurrent,\n                    recurrence_days: this.booking.recurrence_days\n                })\n                .then(\n                    (space_list) => {\n                        for (const space of space_list) {\n                            if (!space.bookable) {\n                                this.lastMomentConflict = true;\n                                return reject(\n                                    `${space.name} is not available at the select time period.`\n                                );\n                            }\n                        }\n                        if (space_list.length < spaces.length) {\n                            this.lastMomentConflict = true;\n                            return reject(\n                                `${spaces[0].name} is not available at the select time period.`\n                            );\n                        }\n                        resolve();\n                    },\n                    (err) => reject(err)\n                );\n        });\n    }\n\n    public openConflictsModal(){\n        const ref = this._dialog.open<ConflictsModalComponent,\n        ConflictsModalComponentData>(ConflictsModalComponent, {\n        maxWidth: '95vw',\n        width: '32em',\n        data: {\n            room_name: this.booking.room.local_name,\n            conflicts: this.booking.recurrence_exceptions,\n            copy_conflicts: true,\n            timezone: this.booking.timezone\n        }\n        });\n\n        this.subscription(\n        'modal_events',\n        ref.componentInstance.event.subscribe((event: DialogEvent) => {\n            if(event.reason === 'close'){\n                ref.close();\n            }else if(event.reason  === 'action'){\n                navigator.clipboard.writeText(this.conflictsText)\n            }\n            \n        })\n        );\n        ref.afterClosed().subscribe(() => this.unsub('modal_events'));\n    }\n\n    public get conflictsText(){\n        let text = ''\n        this.booking.recurrence_exceptions.map((date)=>{\n            const dateTZ = new DateTZ({date: date*1000});\n            const display = dateTZ.formatDate('ccc dd MMM yyyy');\n            text = `${text}\\n${display}${dateTZ.isSameDate(DateNow(new Date()), 'day') ? ' (Today)' : ''}`;\n        })\n        return text\n    }\n}\n","<mat-dialog-content *ngIf=\"!loading; else load_state\">\n    <main>\n        <button name=\"close\" mat-icon-button mat-dialog-close>\n            <app-icon\n                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"\n            ></app-icon>\n        </button>\n        <div class=\"details\">\n            <img\n                [src]=\"\n                    success\n                        ? is_request\n                            ? 'assets/img/requested.svg'\n                            : 'assets/img/confirmed.svg'\n                        : 'assets/img/edit.svg'\n                \"\n            />\n            <div class=\"text\">\n                Booking Details\n                <span *ngIf=\"success && !is_request\">Confirmed!</span>\n                <span class=\"request\" *ngIf=\"success && is_request\">Requested!</span>\n            </div>\n            <div class=\"info\" *ngIf=\"success && is_request\">Please await confirmation of room</div>\n        </div>\n        <div class=\"field\" name=\"title\">\n            <label>Title<span *ngIf=\"changes.title\">*</span>:</label>\n            <div class=\"value\">{{ title || 'No title' }}</div>\n        </div>\n        <div class=\"field\" name=\"when\">\n            <label>When<span *ngIf=\"changes.date\">*</span>:</label>\n            <div class=\"value\">{{ when }}</div>\n        </div>\n        <div class=\"field\" name=\"when\" *ngIf=\"booking.is_recurrent\">\n            <label>Recurrence<span *ngIf=\"changes.recurrence\">*</span>:</label>\n            <div class=\"value\">{{ recurrence }}</div>\n            <div\n                class=\"tooltip\"\n                *ngIf=\"booking.recurrence_exceptions && booking.recurrence_exceptions.length > 0\"\n                (click)=\"openConflictsModal()\"\n            >\n                Conflicts\n            </div>\n        </div>\n        <div class=\"field\" name=\"duration\">\n            <label>Duration<span *ngIf=\"changes.duration\">*</span>:</label>\n            <div class=\"value\">{{ duration }}</div>\n        </div>\n        <div class=\"field multi\" name=\"location\">\n            <label\n                >Locations({{ spaces.length || '0' }})<span *ngIf=\"changes.location\">*</span\n                >:</label\n            >\n            <div class=\"value\">\n                <div class=\"list\" [class.shown]=\"show_locations\">\n                    <div class=\"list-item\" *ngFor=\"let item of spaces\">\n                        <div class=\"text\" [title]=\"item?.name\">{{ item?.local_name }}</div>\n                        <div\n                            class=\"tooltip\"\n                            *ngIf=\"equipment_notes[item.email]\"\n                            [matTooltip]=\"equipment_notes[item.email]\"\n                        >\n                            Notes\n                        </div>\n                        <div\n                            class=\"tooltip\"\n                            *ngIf=\"equipment_codes[item.email]\"\n                            [matTooltip]=\"\n                                (equipment_codes[item.email]\n                                    ? 'Equipment ~ ' + equipment_codes[item.email]\n                                    : '') +\n                                (catering_codes[item.email] && equipment_codes[item.email]\n                                    ? '\\n'\n                                    : '') +\n                                (catering_codes[item.email]\n                                    ? 'Catering ~ ' + catering_codes[item.email]\n                                    : '')\n                            \"\n                        >\n                            Code\n                        </div>\n                    </div>\n                    <div class=\"list-item\" *ngIf=\"!spaces.length\">No Locations</div>\n                </div>\n                <button\n                    class=\"show\"\n                    *ngIf=\"spaces.length > 5\"\n                    (click)=\"show_locations = !show_locations\"\n                >\n                    {{ show_locations ? 'Hide' : 'Show' }} Locations\n                </button>\n            </div>\n        </div>\n        <div class=\"field\" name=\"host\">\n            <label>Host<span *ngIf=\"changes.organiser\">*</span>:</label>\n            <div class=\"value\">{{ organiser?.name || organiser?.email }}</div>\n        </div>\n        <div class=\"field\" name=\"host\" *ngIf=\"bookingDetails?.bookedBy?.display\" >\n            <label>Booked by<span *ngIf=\"changes.organiser\">*</span>:</label>\n            <div class=\"value\" [title]=\"'Booked By: ' + (bookingDetails.bookedBy.value)\">\n                {{ bookingDetails.bookedBy.value }}\n            </div>\n        </div>\n        <div class=\"field\" name=\"attendees\">\n            <label\n                >Attendees({{ attendees.length || '0' }})<span *ngIf=\"changes.attendees\">*</span\n                >:</label\n            >\n            <div class=\"value\">\n                <span *ngIf=\"!attendees || !attendees.length\">&lt;No Attendees&gt;</span>\n                <div class=\"list\" [class.shown]=\"show_attendees\">\n                    <div\n                        class=\"list-item\"\n                        *ngFor=\"let item of attendees\"\n                        [title]=\"item?.name + (item?.email ? '\\n' + item.email : '')\"\n                    >\n                        <div class=\"text\">\n                            <div class=\"name\">{{ item.name }}</div>\n                            <div class=\"email\" *ngIf=\"item.email\">\n                                <a [href]=\"'mailto:' + item.email + '?subject=' + booking.title\">{{\n                                    item.email\n                                }}</a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <button\n                    class=\"show\"\n                    *ngIf=\"attendees.length > 5\"\n                    (click)=\"show_attendees = !show_attendees\"\n                >\n                    {{ show_attendees ? 'Hide' : 'Show' }} Attendees\n                </button>\n            </div>\n        </div>\n        <div class=\"field\" name=\"notes\">\n            <label>Notes<span *ngIf=\"changes.body\">*</span>:</label>\n            <div class=\"value\" [innerHTML]=\"notes || 'No notes'\"></div>\n        </div>\n        <div class=\"field\" name=\"catering\">\n            <label\n                >Catering Orders({{ catering.length || '0' }})<span *ngIf=\"changes.catering\">*</span\n                >:</label\n            >\n            <div class=\"value\">\n                <div class=\"list\" [class.shown]=\"show_orders\">\n                    <div class=\"list-item\" *ngFor=\"let order of catering\">\n                        <div class=\"text\">\n                            <div class=\"name\">{{ order.location || '&lt;Removed&gt;' }}</div>\n                            <div class=\"email\">\n                                {{ order.item_count }} item{{ order.item_count === 1 ? '' : '' }} |\n                                {{ order.total / 100 | currency: order.symbol }}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <button\n                    class=\"show\"\n                    *ngIf=\"attendees.length > 5\"\n                    (click)=\"show_orders = !show_orders\"\n                >\n                    {{ show_orders ? 'Hide' : 'Show' }} Catering orders\n                </button>\n            </div>\n        </div>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions *ngIf=\"!loading\">\n    <footer>\n        <ng-container *ngIf=\"!success; else success_actions\">\n            <button mat-button class=\"inverse\" [disabled]=\"lastMomentConflict\" mat-dialog-close>Edit</button>\n            <button mat-button name=\"save\" [disabled]=\"lastMomentConflict\" (click)=\"saveChanges()\">Save</button>\n        </ng-container>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main>\n        <div class=\"info-block center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">\n                {{ loading }}\n            </div>\n        </div>\n    </main>\n</ng-template>\n<ng-template #success_actions>\n    <button mat-button mat-dialog-close *ngIf=\"settings.concierge\">Close</button>\n    <ng-container *ngIf=\"!settings.concierge\">\n        <button mat-button class=\"inverse\" name=\"new\" (click)=\"newBooking()\">New Booking</button>\n        <a button mat-button mat-dialog-close (click)=\"toSchedule()\">My Day</a>\n    </ng-container>\n</ng-template>\n","import {\n    Component,\n    Input,\n    OnInit, ChangeDetectionStrategy, ChangeDetectorRef\n} from '@angular/core';\nimport { FormGroup, Validators } from '@angular/forms';\nimport { MatDialog } from '@angular/material/dialog';\nimport { distinctUntilChanged, first, skip } from 'rxjs/operators';\n\nimport {\n    BaseDirective,\n    closestToTimeSlotTz,\n    Identity,\n    unique\n} from '@mckinsey-converge/base';\nimport {\n    ApplicationService,\n    arrayWithValues,\n    BookingAction,\n    CateringOrder,\n    SeriesAction,\n    SettingsService,\n    User,\n    UsersService\n} from '@mckinsey-converge/data-common';\n\nimport { NewUserModalComponent } from '../new-user-modal/new-user-modal.component';\nimport {\n    SpaceSelectModalComponent,\n    SpaceSelectModalData\n} from '../space-select-modal/space-select-modal.component';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { DateTime } from 'luxon';\n\n\n@Component({\n    selector: 'a-booking-form',\n    templateUrl: './booking-form.component.html',\n    styleUrls: ['./booking-form.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class BookingFormComponent extends BaseDirective implements OnInit {\n    /** Form fields for booking */\n    @Input() public form: FormGroup;\n    /** List of available users to host bookings */\n    public user_list: User[] = [];\n    public nowTz: DateTZ = DateNow(new Date());\n    /** From date input for date field */\n    public fromDateTz: DateTZ = this.nowTz.setValue({ minute: Math.ceil(this.nowTz.minutes / 5) * 5 });\n    /** Last bookable date, concierge only */\n    public readonly untilDateTz = DateNow(new Date()).addValue({ days: 365 }).endOfValue('day');\n    public isConcierge: boolean;\n    public localTimezone = DateNow(new Date()).building_tz;\n    public localStart = \"\";\n    public localEnd = \"\";\n\n    constructor(\n        private _service: ApplicationService,\n        private _users: UsersService,\n        private _dialog: MatDialog,\n        private settingsService: SettingsService,\n        private cdRef: ChangeDetectorRef\n    ) {\n        super();\n        this.isConcierge = this.settingsService.concierge;\n    }\n\n    public ngOnInit(): void {\n        // Trim title \n        // this.form.get('title').setValue(this.form.get('title').value.trim());\n        this.localTimezone = DateNow(new Date()).building_tz;\n        const building_tz = (\n            this.form.controls.action &&\n            (\n                this.form.controls.action.value === 'booking_clone' ||\n                this.form.controls.action.value === 'clone' ||\n                this.form.controls.action.value === 'edit' ||\n                this.form.controls.action.value === 'booking_edit'\n            ) &&\n            this.form.controls.dateTz &&\n            this.form.controls.dateTz.value\n        ) ? this.form.controls.dateTz.value.building_tz : this.localTimezone;\n\n        this.nowTz = new DateTZ({ date: Date.now(), is_local_tz: false, building_tz });\n        this.fromDateTz = closestToTimeSlotTz(this.nowTz, 15);\n\n        this._users.initialised.pipe(first((_) => _)).subscribe(() => {\n            const user: User = this._users.current;\n            const delegates = user.delegates.map(\n                (email) => this._users.find(email) || new User({ email, name: email.split('@')[0] })\n            );\n            this.user_list = [user].concat(delegates);\n        });\n\n        this.updateCoachmarkTimes(this.form.controls.timezone.value);\n        this.subscription('formChanges',  this.form.valueChanges\n            .pipe(\n                skip(1), // initial form changes\n                distinctUntilChanged())\n            .subscribe(() => {\n                this.timeout('update_coachmark', () => {\n                    this.updateCoachmarkTimes(this.form.controls.timezone.value);\n                }, 500);\n            })\n        );\n\n        this.subscription('isRecurrentChanges',  this.form.controls.is_recurrent.valueChanges\n            .subscribe(() => {\n                const recurrenceStarts = this.form.controls.recurrence_starts\n                if(!this.form.controls.is_recurrent.value){\n                    recurrenceStarts.clearValidators()     \n                }else{\n                    const arrayValidators = [Validators.required];\n                    arrayValidators.push(arrayWithValues);\n                    recurrenceStarts.setValidators(arrayValidators);\n                }\n                recurrenceStarts.updateValueAndValidity()\n            })\n        );     \n\n        /**Disable Inputs */\n        this.disableInputs();\n\n        /**turn is_recurrent to false if editing or cloning a stand-alone/occurrence */\n        if(this.form.controls.id?.value && !this.form.controls.action?.value){\n            this.form.controls.is_recurrent.setValue(false)\n        }\n    }\n\n    /**\n     * \n     * @param key : formcontrol name \n     * Function trim value being submitted with only spaces/beginning/end \n     */\n    public trim(key: string): void {\n        this.form.get(key).setValue(this.form.get(key).value.trim());\n    }\n\n    /** Whether notes and description should use the HTML editor */\n    public get use_html(): boolean {\n        return this._service.setting('app.booking.html_body') || false;\n    }\n\n    /** List of available types for bookings */\n    public get booking_types(): Identity[] {\n        return this._service.setting('app.booking.booking_types') || [];\n    }\n\n    /** Display string for the list of active spaces */\n    public get spaces(): string {\n        const spaces = this.form.controls.space_list.value;\n        return spaces.length === 1\n            ? spaces[0].local_name\n            : spaces.length > 1\n                ? `${spaces.length} spaces selected`\n                : 'No Spaces selected';\n    }\n\n    public disableInputs() {\n        const { id, action, needs_space, is_recurrent } = this.form.value;\n        const has_id = !!id;\n        const is_edit = action === BookingAction.EDIT;\n        if (has_id) {\n            this.form.get('is_recurrent')?.disable();\n        }\n\n        if (!this.isConcierge && !needs_space) {\n            this.form.get('has_catering')?.disable();\n        }\n        if(has_id && is_edit && is_recurrent){\n            this.form.get('dateTz')?.disable()\n            this.form.patchValue({ action: null });\n        }\n    }\n\n    /**\n     * Open modal to change the space details for the booking\n     */\n    public openSpacesModal(): void {\n        const ref = this._dialog.open<SpaceSelectModalComponent, SpaceSelectModalData>(\n            SpaceSelectModalComponent,\n            {\n                width: 'auto',\n                height: 'auto',\n                maxWidth: '95vw',\n                data: {\n                    spaces: this.form.controls.space_list.value,\n                    dateTz: this.form.controls.dateTz.value,\n                    duration: this.form.controls.duration.value,\n                    host: this.form.controls.organiser.value,\n                    multiple: true,\n                    needsCatering: !!this.form.controls.catering?.value?.length,\n                }\n            }\n        );\n        this.subscription(\n            'new_spaces',\n            ref.componentInstance.event.subscribe((event) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    let space_list = this.form.controls.space_list.value;\n                    space_list = event.metadata;\n                    this.form.controls.space_list.setValue(unique(space_list, 'id'));\n                    const catering = this.form.controls?.catering?.value.map((order: CateringOrder) => {\n                        order.location = space_list[0].name;\n                        order.location_id = space_list[0].email;\n                        return order;\n                    })\n                    this.form.controls.catering?.setValue(catering || [])\n                    ref.close();\n                    this.unsub('new_spaces');\n                }\n                if (event.reason === 'close') {\n                    ref.close();\n                    this.unsub('new_spaces');\n                }\n            })\n        );\n    }\n\n    /**\n     * Open modal to change the recurrence details for the booking\n     */\n    public openNewUserModal() {\n        const ref = this._dialog.open<NewUserModalComponent>(NewUserModalComponent, {\n            width: 'auto',\n            height: 'auto'\n        });\n        this.subscription(\n            'new_user',\n            ref.componentInstance.event.subscribe((event) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    const attendees = this.form.controls.attendees.value;\n                    attendees.push(event.metadata);\n                    this.form.controls.attendees.setValue(unique(attendees, 'email'));\n                    ref.close();\n                    this.unsub('new_user');\n                    this.cdRef.detectChanges();\n                }\n            })\n        );\n    }\n\n    private updateCoachmarkTimes(timezone: string) {\n        if (!timezone) timezone = this.localTimezone;\n        // Resolve the problem that locally I might have the same TZ offset but the names don't match.\n        const localTzOffset = DateTime.now().setZone(this.localTimezone).offset;\n        const buildingTzOffset = DateTime.now().setZone(timezone).offset;\n        const dateTz = this.form.controls.dateTz.value;\n        if (dateTz && localTzOffset !== buildingTzOffset) {\n            const startDate = dateTz.clone();\n            this.localStart = startDate.formatLocalDate(\"h:mma\");\n            this.localEnd = startDate.addValue({ minutes: this.form.value.duration }).formatLocalDate(\"h:mma\");\n        } else {\n            // No location is selected so coachmark is hidden\n            this.localStart = \"\";\n            this.localEnd = \"\";\n        }\n        this.cdRef.detectChanges();\n    }\n\n    public get isSeriesAction(){\n        return this.form.value.action === SeriesAction.CLONE || this.form.value.action === SeriesAction.EDIT\n    }\n}\n","<div class=\"booking-form\" *ngIf=\"form\" [formGroup]=\"form\">\n    <div\n        class=\"field\"\n        *ngIf=\"form.value.id && form.controls.space_list && !isSeriesAction\"\n    >\n        <label for=\"spaces\" i18n=\"Booking form spaces label\">Spaces: </label>\n        <an-action-field\n            name=\"spaces\"\n            [placeholder]=\"spaces\"\n            (onAction)=\"openSpacesModal()\"\n        ></an-action-field>\n    </div>\n    <div class=\"field\" name=\"title\" *ngIf=\"form.controls.title\">\n        <label\n            for=\"title\"\n            [class.error]=\"form.controls.title.invalid && form.controls.title.touched\"\n            i18n=\"Booking form title label\"\n        >\n            Title<span>*</span>:\n        </label>\n        <mat-form-field appearance=\"outline\">\n            <input matInput name=\"title\" placeholder=\"Meeting Title\" i18n-placeholder formControlName=\"title\" (blur)=\"trim('title')\" />\n\n            <mat-error *ngIf=\"form.controls.title.invalid\" i18n=\"Booking form title error\"\n            >\n            {{ ( form?.get('title').errors && form?.get('title').hasError('pattern')) \n                ? 'Some special characters (^=`~!@#$%*{};:\\'_\\\",.\\<>) are not allowed' : 'Title is required'}} \n            </mat-error\n            >\n        </mat-form-field>\n    </div>\n\n    <div class=\"group date\" *ngIf=\"!form.get('is_recurrent')?.value\">\n        <!-- this is our regular booking date input -->\n        <div class=\"date-field\" name=\"date\" *ngIf=\"form.controls.dateTz\">\n            <label for=\"date\" i18n=\"Booking form date label\">Date: </label>\n            <date-tz-date-picker\n                [error]=\"form.controls.dateTz.touched && form.controls.dateTz.invalid && form.controls.dateTz.errors.date\"\n                [class.full-width]=\"form.controls.action.value === 'booking_clone'\" \n                name=\"date\" \n                class=\"time-inputs\"\n                [fromDateTz]=\"fromDateTz\"\n                [untilDateTz]=\"isConcierge ? untilDateTz : null\"\n                formControlName=\"dateTz\"\n                [invalid]=\"form.controls.dateTz.invalid\"\n                [can_pick_today]=\"false\"\n            ></date-tz-date-picker>\n            <div class=\"error info\" *ngIf=\"form.controls.dateTz.touched && form.controls.dateTz.invalid && form.controls.dateTz.errors.date\">\n                Date and time must be in the future\n            </div>\n        </div>\n    </div>\n    <div class=\"group time\">\n        <div class=\"field\" name=\"start-time\" *ngIf=\"form.controls.dateTz\">\n            <label for=\"start-time\" i18n=\"Booking form start time label\">Start Time: </label>\n            <date-tz-time-field\n                class=\"time-inputs\"\n                [required]=\"true\"\n                name=\"start-time\"\n                [fromDateTz]=\"fromDateTz\"\n                [startFromDateTz]=\"(form.controls.is_before_date && form.controls.is_before_date.value === true) &&\n                    (\n                        form.controls.action.value === 'booking_clone' ||\n                        form.controls.action.value === 'clone' ||\n                        form.controls.action.value === 'booking_edit' ||\n                        form.controls.action.value === 'edit'\n                    )\"\n                [all_day]=\"form.controls.all_day?.value\"\n                [ngModel]=\"form.controls.dateTz.value\"\n                [disabled]=\"form.value.all_day\"\n                (ngModelChange)=\"form.controls.dateTz.setValue($event)\"\n                [ngModelOptions]=\"{ standalone: true }\"\n                [show_current]=\"form.controls.id && form.controls.id.value\"\n            ></date-tz-time-field>\n            <div class=\"error info\" *ngIf=\"form.controls.dateTz.touched && form.controls.dateTz.invalid && !form.controls.is_recurrent && form.controls.dateTz.errors.start\">\n                Date and time must be in the future\n            </div>\n        </div>\n        <div class=\"field\" name=\"duration\" *ngIf=\"form.controls.duration\">\n            <div class=\"label-group\">\n                <label for=\"duration\" i18n=\"Booking form duration label\">Duration: </label>\n                <mat-checkbox\n                    name=\"all-day\"\n                    formControlName=\"all_day\"\n                    *ngIf=\"form.controls.all_day\"\n                    i18n=\"Booking form all day label\"\n                >All day booking\n                </mat-checkbox\n                >\n            </div>\n            <date-tz-duration-field\n                class=\"time-inputs\"\n                name=\"duration\"\n                [startDateTz]=\"form.controls.dateTz.value\"\n                [required]=\"true\"\n                [all_day]=\"form.controls.all_day?.value\"\n                formControlName=\"duration\"\n            ></date-tz-duration-field>\n            <div class=\"error info\" *ngIf=\"form.controls.duration.touched && form.controls.duration.invalid\">\n                Duration is invalid. End time must be in the future\n            </div>\n        </div>\n        <div *ngIf=\"localStart && localEnd\" class=\"coachmark\">\n            Please be aware that this booking starts at {{localStart}} and ends at {{localEnd}} in your local timezone.\n        </div>\n    </div>\n    <div class=\"recurrence-siwch\">\n        <mat-slide-toggle\n        class=\"mck-slide-toggle\"\n        labelPosition=\"after\"\n        name=\"recurrence\"\n        formControlName=\"is_recurrent\"\n        >Recurring booking</mat-slide-toggle>\n    </div>\n    <!-- this is recurring booking form that appears when the above recurrence toggle is enabled -->\n    <recurrence-booking-form *ngIf=\"form.get('is_recurrent')?.value\" [form]=\"form\"></recurrence-booking-form>\n    <div class=\"field\" name=\"organiser\" *ngIf=\"form.controls.organiser\">\n        <label for=\"organiser\" i18n=\"Booking form organiser label\">Host: </label>\n        <a-user-search-field name=\"organiser\" formControlName=\"organiser\"\n                             *ngIf=\"isConcierge\"></a-user-search-field>\n        <mat-form-field appearance=\"outline\" *ngIf=\"!isConcierge\">\n            <mat-select\n                name=\"organiser\"\n                formControlName=\"organiser\"\n                [placeholder]=\"form.controls.organiser.value.name || form.controls.organiser.value.email\"\n            >\n                <mat-option *ngFor=\"let user of user_list\" [value]=\"user\">\n                    {{ user.name || user.email }}\n                </mat-option>\n            </mat-select>\n        </mat-form-field>\n    </div>\n    <div class=\"field\" name=\"attendees\" *ngIf=\"form.controls.attendees\">\n        <label for=\"attendees\" i18n=\"Booking form attendees label\">Attendees: </label>\n        <a-user-list-field\n            name=\"attendees\"\n            formControlName=\"attendees\"\n            (newUser)=\"openNewUserModal()\"\n        ></a-user-list-field>\n    </div>\n    <div class=\"field\" name=\"booking-type\" *ngIf=\"form.controls.booking_type && booking_types.length > 1\">\n        <label for=\"booking-type\" i18n=\"Booking form booking type label\">Booking Type: </label>\n        <mat-form-field appearance=\"outline\">\n            <mat-select name=\"booking-type\" formControlName=\"booking_type\">\n                <mat-option *ngFor=\"let type of booking_types\" [value]=\"type.id\">\n                    {{ type.name }}\n                </mat-option>\n            </mat-select>\n        </mat-form-field>\n    </div>\n    <div class=\"field\" name=\"need-space\" *ngIf=\"!isConcierge && form.controls.needs_space\">\n        <mat-checkbox formControlName=\"needs_space\" i18n=\"Booking form need space label\"\n        >Need a meeting space?\n        </mat-checkbox\n        >\n    </div>\n    <div class=\"field\" name=\"has-catering\" *ngIf=\"form.controls.has_catering\">\n        <!-- [disabled]=\"!isConcierge && !form.controls.needs_space.value\" -->\n        <mat-checkbox\n            name=\"catering\"\n            formControlName=\"has_catering\"\n            i18n=\"Booking form need catering label\"\n        >\n            Need catering?\n        </mat-checkbox>\n    </div>\n    <div class=\"field\" name=\"body\" *ngIf=\"form.controls.body\">\n        <label for=\"body\" i18n=\"Booking form notes label\">Notes: </label>\n        <mat-form-field name=\"body\" appearance=\"outline\" *ngIf=\"!use_html; else html_editor\">\n            <textarea\n                matInput\n                name=\"description\"\n                placeholder=\"Meeting Description\"\n                i18n-placeholder\n                formControlName=\"body\"\n                (blur)=\"trim('body')\"\n            ></textarea>\n        </mat-form-field>\n        <ng-template #html_editor>\n            <editor formControlName=\"body\"></editor>\n        </ng-template>\n    </div>\n</div>\n","import {\n    Component,\n    EventEmitter,\n    Inject,\n    OnInit,\n    Output\n} from '@angular/core';\nimport {\n    MAT_DIALOG_DATA,\n    MatDialogRef\n} from '@angular/material/dialog';\nimport {\n    FormControl,\n    FormGroup\n} from '@angular/forms';\n\nimport {\n    ApplicationService,\n    CateringItem,\n    OrganisationService,\n    Space,\n    SpacesService\n} from '@mckinsey-converge/data-common';\nimport {\n    BaseDirective,\n    DialogEvent\n} from '@mckinsey-converge/base';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\n\n\nexport interface CateringConfirmModalData {\n    all_day: boolean;\n    form: FormGroup;\n    dateTz: DateTZ;\n}\n\n@Component({\n    selector: 'a-catering-confirm-modal',\n    templateUrl: './catering-confirm-modal.component.html',\n    styleUrls: ['./catering-confirm-modal.component.scss']\n})\nexport class BookingCateringConfirmModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user actions on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** List of selected items for the order */\n    public item_list: CateringItem[] = [];\n\n    /** Space selected for delivery */\n    public get space(): Space {\n        return this._spaces.find(this._data.form?.controls?.location_id?.value);\n    }\n\n    /** Delivery time for the order */\n    public get delivery_time(): string {\n        let date = this._data.dateTz;\n        if (this._data.form && this._data.form.controls.delivery_time) {\n            date = date.addValue({ minutes: this._data.form.controls.delivery_time.value });\n        }\n        return date.formatDate('h:mma').toLocaleLowerCase();\n    }\n\n    /** Form field for order items */\n    public get item_field(): FormControl {\n        return this._data.form.controls.items as any;\n    }\n\n    /** Total cost of the order */\n    public get order_cost(): number {\n        return this.item_list.reduce((amount, item) => {\n            const price = item.price\n            return amount + item.amount * price\n        }, 0);\n    }\n\n    /** Currency symbol for the selected space */\n    public get symbol(): string {\n        /* istanbul ignore else */\n        if (!this.space || !this.space.level) {\n            return 'USD';\n        }\n        const building = this._org.buildings.find(\n            (bld) => bld.id === this.space.level.building_id\n        ) || { currency: 'USD' };\n        return building.currency;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _org: OrganisationService,\n        private _spaces: SpacesService,\n        private _dialog_ref: MatDialogRef<BookingCateringConfirmModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: CateringConfirmModalData\n    ) {\n        super();\n        if (!this._data.form) {\n            this._service.notifyError('No form data for order');\n            this._dialog_ref.close();\n        }\n    }\n\n    public ngOnInit(): void {\n        /* istanbul ignore else */\n        if (this._data.form.controls.items) {\n            this.subscription(\n                'item_list',\n                this._data.form.controls.items.valueChanges.subscribe((items) => {\n                    /* istanbul ignore else */\n                    if (!items || items.length <= 0) {\n                        this._dialog_ref.close();\n                    }\n                })\n            );\n        }\n        this.item_list = this._data.form.controls.items.value.map((item) => new CateringItem(item.toJSON()));\n    }\n}\n","<header class=\"heading\">\n    <div i18n=\"Catering confirm order header\">Confirm Catering Order</div>\n    <button mat-icon-button mat-dialog-close >\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main>\n        <div class=\"details\">\n            Delivering to <span>{{ space?.local_name || '&lt;Unset&gt;' }}</span> at <span>{{ delivery_time }}</span>\n        </div>\n        <div class=\"list\">\n            <a-catering-menu-item\n                *ngFor=\"let item of item_list\"\n                [field]=\"item_field\"\n                [subitem]=\"true\"\n                [item]=\"item\"\n                [symbol]=\"symbol\"\n            ></a-catering-menu-item>\n        </div>\n        <div class=\"total\">\n            <label>Order Total:</label>\n            <div class=\"value\">{{ order_cost / 100 | currency:symbol }}</div>\n        </div>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button (click)=\"event.emit({ reason: 'done' })\" i18n=\"Catering confirm save action\">Save Order</button>\n    </footer>\n</mat-dialog-actions>\n","import {\n    Component,\n    ElementRef,\n    EventEmitter,\n    Inject,\n    OnInit,\n    Output,\n    ViewChild\n} from '@angular/core';\nimport {\n    AbstractControl,\n    FormControl,\n    FormGroup,\n    Validators\n} from '@angular/forms';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport {\n    OrganisationService,\n    BookingNote,\n    CateringOrder,\n    Space,\n    UsersService,\n    CateringNotesService,\n    Booking\n} from '@mckinsey-converge/data-common';\nimport {\n    DialogEvent,\n    HashMap\n} from '@mckinsey-converge/base';\n\nimport { DateNow } from '@mckinsey-converge/date-tz';\n\n\nexport interface CateringDetailsModalData {\n    spaces: Space[];\n    notes_field: AbstractControl;\n    catering: AbstractControl;\n    booking: Booking\n}\n\n@Component({\n    selector: 'a-catering-details-modal',\n    templateUrl: './catering-details-modal.component.html',\n    styleUrls: ['./catering-details-modal.component.scss']\n})\nexport class CateringDetailsModalComponent implements OnInit {\n    /** Emitter for modal events */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Mapping of spaces to notes */\n    public notes: HashMap<string> = {};\n    /** Mapping of spaces to cost codes */\n    public codes: HashMap<string> = {};\n    /** Mapping of spaces to estimated head count */\n    public head_counts: HashMap<string> = {};\n    /** Mapping of spaces to form fields */\n    public form: HashMap<FormGroup> = {};\n    /** Map of spaces to whether they need a charge code */\n    public needs_charge_code: HashMap<boolean> = {};\n    /** Index of the active space */\n    public active_space: number = 0;\n\n    @ViewChild('content', { static: true }) private _content_el: ElementRef<HTMLElement>;\n\n    /** List of selected spaces */\n    public get space_list(): Space[] {\n        return (this._data.spaces || []).filter((space) =>\n            this._data.catering.value.find((order) => order.location_id === space.email)\n        );\n    }\n\n    public get active_form(): FormGroup {\n        return this.form[this.space_list[this.active_space].email];\n    }\n\n    public get invalid_charge_code(): boolean {\n        return this.active_form.controls.code.errors?.pattern || this.active_form.controls.code.errors?.minlength;\n    }\n\n    /** Whether form fields are valid */\n    public get is_valid(): boolean {\n        return this.space_list.reduce(\n            (valid, space) => valid && this.form[space.email].valid,\n            true\n        );\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _users: UsersService,\n        private _cateringNotesService: CateringNotesService,\n        @Inject(MAT_DIALOG_DATA) private _data: CateringDetailsModalData\n    ) {\n    }\n\n    public ngOnInit(): void {\n        const note_list = this._data.notes_field.value.filter(\n            (note: BookingNote) => note.type === 'catering'\n        );\n        this.notes = note_list.reduce((map, note) => {\n            map[note.space] = note.message;\n            return map;\n        }, {});\n        this.codes = this._data.catering.value.reduce((map, order: CateringOrder) => {\n            map[order.location_id] = order.charge_code;\n            return map;\n        }, {});\n        this.generateFormFields();\n    }\n\n    public submit(): void {\n        this.space_list.forEach((space) => this.form[space.email].markAllAsTouched());\n        /* istanbul ignore else */\n        if (this.is_valid) {\n            // Update notes\n            const notes = this._data.notes_field.value.filter(\n                (note: BookingNote) => note.type !== 'catering'\n            );\n            const new_notes = this.space_list.map(\n                (space) =>\n                    ({\n                        author: this._data.booking.booked_by ? this._data.booking.booked_by['name'] : this._users.current.name,\n                        type: 'catering',\n                        message: this.form[space.email].controls.notes.value,\n                        space: space.email,\n                        date: DateNow(new Date()).ms\n                    } as BookingNote)\n            );\n            this._cateringNotesService.setNotes(new_notes);\n            this._data.notes_field.setValue(notes.concat(new_notes).filter((note) => note.message));\n            // Save the notes\n            const orders = this._data.catering.value.map(\n                (order) =>\n                    new CateringOrder({\n                        ...order,\n                        charge_code: this.form[order.location_id]\n                            ? this.form[order.location_id].controls.code.value\n                            : ''\n                    })\n            );\n\n            this._data.catering.setValue(orders);\n            // This should go to the next\n            this.event.emit({ reason: 'done' });\n        } else {\n            this._scrollToBottom();\n        }\n    }\n\n    /** Generate form fields for each space */\n    private generateFormFields(): void {\n        for (const space of this.space_list) {\n            const building = this._org.buildings.find(\n                bld => bld.id === space.level.building_id\n            );\n            \n            this.needs_charge_code[space.email] = space?.filters?.charge_code || space?.settings?.charge_code || false;\n            this.form[space.email] = new FormGroup({\n                notes: new FormControl(this.notes[space.email] || ''),\n                code: new FormControl(this.codes[space.email] || '',\n                    this.needs_charge_code[space.email] ?\n                        [Validators.pattern(/^[a-zA-Z0-9]{4,}$/), Validators.minLength(4),  Validators.required ] : [Validators.pattern(/^[a-zA-Z0-9]{4,}$/), Validators.minLength(4)])\n            });\n        }\n    }\n\n    /** Scroll the content container to the bottom */\n    private _scrollToBottom(): void {\n        this._content_el?.nativeElement.scrollTo({\n            top: this._content_el.nativeElement.scrollHeight,\n            left: 0,\n            behavior: 'smooth'\n        });\n    }\n}\n","<div class=\"header\">\n    <div class=\"tabs\">\n        <mat-tab-group [(selectedIndex)]=\"active_space\">\n            <mat-tab\n                *ngFor=\"let space of space_list\"\n                [label]=\"space.local_name + (form[space.email].invalid && form[space.email].touched ? '*' : '')\"\n            ></mat-tab>\n        </mat-tab-group>\n    </div>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</div>\n<mat-dialog-content>\n    <main>\n        <div class=\"details\">\n            <img src=\"assets/img/food-notes.svg\" />\n            <div class=\"text\">Please specify any allergies or gluten intolerances</div>\n        </div>\n        <form *ngIf=\"space_list[active_space] && active_form\" [formGroup]=\"active_form\">\n            <div class=\"field\">\n                <label for=\"equipment-notes\" i18n=\"Catering details equipment notes label\">\n                    (eg - allergies, in tolerances, no ice in drinks etc) Additional requests are\n                    handled in confidence.\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"equipment-notes\"\n                        formControlName=\"notes\"\n                        placeholder=\"Add notes here...\"\n                        i18n-placeholder\n                    ></textarea>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label\n                    for=\"charge-code\"\n                    [class.error]=\"\n                        active_form.controls.code.touched && active_form.controls.code.invalid\n                    \"\n                    i18n=\"Catering details charge code label\"\n                >\n                    Charge Code\n                    <span *ngIf=\"needs_charge_code[space_list[active_space].email]\">*</span>\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"charge-code\"\n                        formControlName=\"code\"\n                        placeholder=\"Charge Code\"\n                        i18n-placeholder\n                    />\n                    <mat-hint i18n=\"Catering details charge code hint\">\n                        <span>Note:</span> Your booking will be confirmed before you are charged.\n                    </mat-hint>\n                    <mat-error i18n=\"Catering details charge code error\">\n                        {{ invalid_charge_code ? 'Valid Charge Code Required' : 'Charge Code is required'}}\n                    </mat-error>\n                </mat-form-field>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button name=\"next\" (click)=\"submit()\" i18n=\"Catering details save action\">\n            Add to booking\n        </button>\n    </footer>\n</mat-dialog-actions>\n","import {\n    Component,\n    EventEmitter,\n    Inject,\n    Output\n} from '@angular/core';\nimport {\n    MAT_DIALOG_DATA,\n    MatDialogRef\n} from '@angular/material/dialog';\n\nimport { ApplicationIcon } from '@mckinsey-converge/data-common';\nimport {\n    BaseDirective,\n    DialogEvent\n} from '@mckinsey-converge/base';\n\nexport interface ConfirmModalData {\n    /** Title of the modal */\n    title: string;\n    /** Contents of the modal */\n    content: string;\n    /** Text displaed on the confirmation button */\n    action?: string;\n    /** Icon to display on the modal */\n    icon: ApplicationIcon;\n}\n\nexport const CONFIRM_METADATA = {\n    height: 'auto',\n    width: '24em',\n    maxHeight: 'calc(100vh - 2em)',\n    maxWidth: 'calc(100vw - 2em)'\n};\n\n@Component({\n    selector: 'confirm-modal',\n    templateUrl: './confirm-modal.component.html',\n    styleUrls: ['./confirm-modal.component.scss']\n})\nexport class ConfirmModalComponent extends BaseDirective {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Loading state */\n    public loading: string;\n\n    /** Title of the confirm modal */\n    public get title(): string {\n        return (this._data ? this._data.title : null) || 'Confirm';\n    }\n\n    /** Body of the confirm modal */\n    public get content(): string {\n        return (this._data ? this._data.content : null) || 'Are you sure?';\n    }\n\n    /** Display text on the confirm button */\n    public get action(): string {\n        return (this._data ? this._data.action : null) || 'Ok';\n    }\n\n    /** Display icon properties */\n    public get icon(): ApplicationIcon {\n        return (this._data ? this._data.icon : null) || null;\n    }\n\n    constructor(\n        private _dialog: MatDialogRef<ConfirmModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: ConfirmModalData\n    ) {\n        super();\n    }\n\n    /**\n     * User confirmation of the content of the modal\n     */\n    public accept() {\n        this.event.emit({ reason: 'done' });\n    }\n}\n","<header>\n    <h3 mat-dialog-title>{{ title || 'Confirm' }}</h3>\n</header>\n<mat-dialog-content>\n    <div class=\"body\" *ngIf=\"!loading; else load_state\">\n        <app-icon *ngIf=\"icon\" [icon]=\"icon\"></app-icon>\n        <div class=\"content\">\n            <p [innerHTML]=\"content || 'Are you sure?'\"></p>\n        </div>\n    </div>\n</mat-dialog-content>\n<mat-dialog-actions *ngIf=\"!loading\">\n    <footer>\n        <button mat-button class=\"inverse\" mat-dialog-close i18n=\"Close confirm modal\">Cancel</button>\n        <button mat-button name=\"accept\" (click)=\"accept()\">{{ action || 'Ok' }}</button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <div class=\"body\">\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </div>\n</ng-template>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { LegacyUiModule } from '@mckinsey-converge/legacy-ui';\nimport { UiModule } from '@mckinsey-converge/ui';\nimport {\n    FormsModule,\n    ReactiveFormsModule\n} from '@angular/forms';\nimport { SpaceSelectModalComponent } from './space-select-modal/space-select-modal.component';\nimport { NewUserModalComponent } from './new-user-modal/new-user-modal.component';\nimport { ConfirmModalComponent } from './confirm-modal/confirm-modal.component';\nimport { NoCateringModalComponent } from './no-catering-modal/no-catering-modal.component';\nimport { BookingCateringConfirmModalComponent } from './catering-confirm-modal/catering-confirm-modal.component';\nimport { CateringDetailsModalComponent } from './catering-details-modal/catering-details-modal.component';\nimport { RequirementDetailsModalComponent } from './requirement-details-modal/requirement-details-modal.component';\nimport { BookingConfirmComponent } from './booking-confirm/booking-confirm.component';\nimport { BaseModule } from '@mckinsey-converge/base';\nimport { UserFormComponent } from './user-form/user-form.component';\nimport { BookingFormComponent } from './booking-form/booking-form.component';\nimport { EditorModule } from '@tinymce/tinymce-angular';\n\nconst DECLARATIONS = [\n    SpaceSelectModalComponent,\n    NewUserModalComponent,\n    ConfirmModalComponent,\n    NoCateringModalComponent,\n    BookingCateringConfirmModalComponent,\n    CateringDetailsModalComponent,\n    RequirementDetailsModalComponent,\n    BookingConfirmComponent,\n    UserFormComponent,\n    BookingFormComponent,\n];\n\n@NgModule({\n    imports: [\n        LegacyUiModule,\n        FormsModule,\n        ReactiveFormsModule,\n        CommonModule,\n        UiModule,\n        BaseModule,\n        EditorModule,\n    ],\n    declarations: [\n        ...DECLARATIONS\n    ],\n    exports: [\n        ...DECLARATIONS,\n        BaseModule\n    ]\n})\nexport class LegacyOverlaysModule {\n}\n","import { Component, EventEmitter, OnInit, Output } from '@angular/core';\nimport { FormBuilder, FormControl, FormGroup, Validators } from '@angular/forms';\n\nimport { BaseDirective, DialogEvent } from '@mckinsey-converge/base';\nimport { generateUserForm, User } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'new-user-modal',\n    templateUrl: './new-user-modal.component.html',\n    styleUrls: ['./new-user-modal.component.scss'],\n})\nexport class NewUserModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form fields for the new user */\n    public form: FormGroup;\n    /** New user data store */\n    public user: User;\n    /** Whether user details are being saved */\n    public loading: boolean;\n\n    public ngOnInit(): void {\n        this.user = new User();\n        this.form = generateUserForm(this.user);\n    }\n\n    public saveChanges() {\n        this.form.markAllAsTouched();\n        if (this.form.valid) {\n            if (!this.form.controls.email.value) {\n                this.form.controls.email.setValue(\n                    `${Math.floor(Math.random() * 99999)}@guest.mckinsey.com`\n                );\n            }\n            const new_user = new User({\n                ...this.form.value,\n                name: `${this.form.value.first_name} ${this.form.value.last_name}`,\n                type: 'external',\n                external: true,\n                visitor: true,\n            });\n            this.event.emit({ reason: 'done', metadata: new_user });\n        }\n    }\n}\n","<header>\n    <h3 mat-dialog-title>Add External Attendee</h3>\n    <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<div class=\"body\" *ngIf=\"!loading; else load_state\">\n    <user-form [form]=\"form\"></user-form>\n</div>\n<footer *ngIf=\"!loading\">\n    <button mat-button name=\"previous\" class=\"inverse\" mat-dialog-close>Cancel</button>\n    <button mat-button name=\"next\" (click)=\"saveChanges()\">Save</button>\n</footer>\n<ng-template #load_state>\n    <div class=\"body\">\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">\n                Saving attendee...\n            </div>\n        </div>\n    </div>\n</ng-template>\n\n","import {\n    Component,\n    Output,\n    EventEmitter\n} from '@angular/core';\nimport {\n    MatDialogRef,\n} from '@angular/material/dialog';\nimport {\n    BaseDirective,\n    DialogEvent\n} from '@mckinsey-converge/base';\n\n@Component({\n    selector: 'no-catering-modal',\n    templateUrl: './no-catering-modal.component.html',\n    styleUrls: ['./no-catering-modal.component.scss']\n})\nexport class NoCateringModalComponent extends BaseDirective {\n    constructor(\n        private _dialog_ref: MatDialogRef<NoCateringModalComponent>,\n    ) {\n        super();\n    }\n\n    // /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n\n    // Submit the Survey in it's current state.\n    public confirm() {\n        this.event.emit({ reason: 'done' });\n        this._dialog_ref.close();\n    }\n\n    // Close the modal\n    public cancel() {\n        this.event.emit({ reason: 'close' });\n        this._dialog_ref.close();\n    }\n}\n","<div>\n    <mat-dialog-content>\n        <div class=\"nc-modal\">\n            <div class=\"mck-column modal-heading\">\n                <div class=\"header\">\n                    <img src=\"assets/img/no-catering-room.svg\" />\n                    <p>Catering is not available for your new room selection. \n                    <br>Are you sure you want to change rooms?</p>\n                </div>\n            </div>\n            <mat-dialog-actions>\n                <mck-modal-button-row\n                    primaryLabel=\"Yes, proceed\" (primarySubmit)=\"confirm()\"\n                    secondaryLabel=\"Cancel\" (secondarySubmit)=\"cancel()\"\n                ></mck-modal-button-row>\n            </mat-dialog-actions>            \n        </div>\n    </mat-dialog-content>\n</div>","import {\n    Component,\n    ElementRef,\n    EventEmitter,\n    Inject,\n    OnInit,\n    Output,\n    ViewChild\n} from '@angular/core';\nimport {\n    AbstractControl,\n    FormControl,\n    FormGroup,\n    Validators\n} from '@angular/forms';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport {\n    BookingNote,\n    OrganisationService,\n    SettingsService,\n    Space,\n    UsersService\n} from '@mckinsey-converge/data-common';\nimport {\n    DialogEvent,\n    HashMap\n} from '@mckinsey-converge/base';\n\nimport { DateNow } from '@mckinsey-converge/date-tz';\n\n\nexport interface RequirementDetailsModalData {\n    spaces: Space[];\n    notes_field: AbstractControl;\n    codes_field: AbstractControl;\n    head_counts_field: AbstractControl;\n    standalone?: boolean;\n}\n\n@Component({\n    selector: 'a-requirement-details-modal',\n    templateUrl: './requirement-details-modal.component.html',\n    styleUrls: ['./requirement-details-modal.component.scss']\n})\nexport class RequirementDetailsModalComponent implements OnInit {\n    /** Emitter for modal events */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Mapping of spaces to notes */\n    public notes: HashMap<string> = {};\n    /** Mapping of spaces to cost codes */\n    public codes: HashMap<string> = {};\n    /** Mapping of spaces to estimated head count */\n    public head_counts: HashMap<string> = {};\n    /** Mapping of spaces to form fields */\n    public form: HashMap<FormGroup> = {};\n    /** Map of spaces to whether they need a charge code */\n    public needs_charge_code: HashMap<boolean> = {};\n    /** Index of the active space */\n    public active_space: number = 0;\n\n    @ViewChild('content', { static: true }) private _content_el: ElementRef<HTMLElement>;\n\n    /** List of selected spaces */\n    public get space_list(): Space[] {\n        return this._data.spaces;\n    }\n\n    public get has_recurrence(): boolean {\n        return false\n    }\n\n    public get active_form(): FormGroup {\n        return this.form[this.space_list[this.active_space].email];\n    }\n\n    public get invalid_charge_code(): boolean {\n        return this.active_form.controls.code.errors?.minlength || this.active_form.controls.code.errors?.pattern;\n    }\n\n    /** Whether form fields are valid */\n    public get is_valid(): boolean {\n        return this.space_list.reduce((valid, space) => valid && this.form[space.email].valid, true);\n    }\n\n    public isConcierge: boolean;\n    public frontend: string;\n\n    constructor(\n        private _org: OrganisationService,\n        private _users: UsersService,\n        @Inject(MAT_DIALOG_DATA) private _data: RequirementDetailsModalData,\n        private _settings: SettingsService,\n    ) {\n        this.isConcierge = _settings.concierge;\n        this.frontend = _settings.frontend;\n    }\n\n    public ngOnInit(): void {\n        const note_list = this._data.notes_field.value\n            .filter((note: BookingNote) => note.type === 'equipment');\n        this.notes = note_list.reduce((map, note) => {\n            map[note.space] = note.message;\n            return map;\n        }, {});\n        this.codes = { ...this._data.codes_field.value };\n        this.head_counts = { ...this._data.head_counts_field.value };\n        this.generateFormFields();\n    }\n\n    public submit(): void {\n        this.space_list.forEach(space => this.form[space.email].markAllAsTouched());\n        /* istanbul ignore else */\n        if (this.is_valid) {\n            // Update notes \n            const notes = this._data.notes_field.value\n                .filter((note: BookingNote) => note.type !== 'equipment');\n            const new_notes = this.space_list.map(space => ({\n                author: this._users.current.name,\n                type: 'equipment',\n                message: this.form[space.email].controls.notes.value.trim(),\n                space: space.email,\n                date: DateNow(new Date()).ms\n            } as BookingNote));\n            this._data.notes_field.setValue(notes.concat(new_notes).filter(note => note.message));\n            this._data.codes_field.setValue(this.space_list.reduce((map, space) => {\n                map[space.email] = this.form[space.email].controls.code.value;\n                return map;\n            }, {}));\n            this._data.head_counts_field.setValue(this.space_list.reduce((map, space) => {\n                map[space.email] = this.form[space.email].controls.head_count.value;\n                return map;\n            }, {}));\n            this.event.emit({ reason: 'done' });\n        } else {\n            this._content_el.nativeElement.scrollTo({\n                top: this._content_el.nativeElement.scrollHeight,\n                left: 0,\n                behavior: 'smooth'\n            });\n        }\n    }\n\n    /** Generate form fields for each space */\n    private generateFormFields(): void {\n        for (const space of this.space_list) {\n            const building = this._org.buildings.find(\n                bld => bld.id === space.level.building_id\n            );\n            // this.needs_charge_code[space.email] = space?.settings?.equipment_code || building?.required?.equipment_code || false;\n            const { filters, settings } = space;\n            const roomBasedEqCode = filters?.equipment_code || settings?.equipment_code;\n            const officeBasedEqCode = building?.required?.equipment_code;\n            this.needs_charge_code[space.email] = roomBasedEqCode !== undefined ? roomBasedEqCode : officeBasedEqCode !== undefined ? officeBasedEqCode: false;\n\n            this.form[space.email] = new FormGroup({\n                notes: new FormControl(this.notes[space.email] || ''),\n                code: new FormControl(\n                    this.codes[space.email] || '',\n                    this.needs_charge_code[space.email] ?\n                        [Validators.pattern(/^[a-zA-Z0-9]*$/), Validators.minLength(4),  Validators.required] : [Validators.minLength(4), Validators.pattern(/^[a-zA-Z0-9]*$/)]\n                ),\n                head_count: new FormControl(this.head_counts[space.email] || '', [Validators.required, Validators.pattern(/^(?!0+$)/)])\n            });\n        }\n    }\n}\n","<div class=\"header\">\n    <div class=\"tabs\">\n        <mat-tab-group [(selectedIndex)]=\"active_space\">\n            <mat-tab *ngFor=\"let space of space_list\">\n                <ng-template mat-tab-label>\n                    <span [class.error]=\"form[space.email].invalid && form[space.email].touched\">\n                        {{\n                        space.local_name +\n                        (form[space.email].invalid && form[space.email].touched ? '*' : '')\n                        }}\n                    </span>\n                </ng-template>\n            </mat-tab>\n        </mat-tab-group>\n    </div>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</div>\n<mat-dialog-content #content>\n    <main class=\"{{frontend}}\">\n        <div class=\"details\">\n            <img src=\"assets/img/equipment.svg\" />\n            <div class=\"text {{frontend}}\" i18n=\"Booking equipment information\">\n                {{\n                has_recurrence && !isConcierge\n                    ? 'To update headcount information, add equipment or catering, please edit individual meeting occurences in My Day'\n                    : \"Would you like to add equipment to your booking's spaces?\"\n                }}\n            </div>\n        </div>\n        <form *ngIf=\"space_list[active_space] && active_form\" [formGroup]=\"active_form\">\n            <div class=\"field\" *ngIf=\"!has_recurrence || isConcierge\">\n                <label for=\"equipment-notes\" i18n=\"Booking equipment notes label\">\n                    (eg - particular room configurations or specific equipment etc) Additional\n                    requests are handled in confidence\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"equipment-notes\"\n                        formControlName=\"notes\"\n                        placeholder=\"Add notes here...\"\n                        i18n-placeholder\n                    ></textarea>\n                </mat-form-field>\n            </div>\n            <div class=\"fieldset\">\n                <div\n                    class=\"field\"\n                    name=\"charge-code\"\n                    *ngIf=\"!has_recurrence || needs_charge_code[space_list[active_space].email] || isConcierge\"\n                >\n                    <label\n                        for=\"charge-code\"\n                        [class.error]=\"\n                            active_form.controls.code.touched && active_form.controls.code.invalid\n                        \"\n                        i18n=\"Booking equipment charge code label\"\n                    >\n                        Charge Code<span *ngIf=\"needs_charge_code[space_list[active_space].email]\"\n                    >*</span\n                    >\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"charge-code\"\n                            formControlName=\"code\"\n                            placeholder=\"Charge Code\"\n                            i18n-placeholder\n                        />\n                        <mat-hint i18n=\"Booking equipment charge code hint\">\n                            <span>Note:</span> Your booking will be confirmed before you are\n                            charged.\n                        </mat-hint>\n                        <mat-error i18n=\"Catering details charge code error\">\n                            {{ invalid_charge_code ? 'Valid Charge Code Required' : 'Charge Code is required'}}\n                        </mat-error>\n                    </mat-form-field>\n                </div>\n                <div class=\"field\" name=\"head-count\">\n                    <label\n                        for=\"head-count\"\n                        [class.error]=\"\n                            active_form.controls.head_count.touched &&\n                            active_form.controls.head_count.invalid\n                        \"\n                        i18n=\"Booking equipment headcount label\"\n                    >\n                        Headcount Estimate<span>*</span>\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"head-count\"\n                            formControlName=\"head_count\"\n                            type=\"number\"\n                            placeholder=\"e.g. 12\"\n                            i18n-placeholder\n                            numbersOnly\n                        />\n                        <mat-hint i18n=\"Booking equipment headcount hint\">\n                            <span>Note:</span> This estimate is used to calculate catering and/or\n                            assign rooms. Please keep updated of any changes.\n                        </mat-hint>\n                        <mat-error i18n=\"Booking equipment headcount error\">\n                            Headcount Estimate is required\n                        </mat-error>\n                    </mat-form-field>\n                </div>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button name=\"next\" (click)=\"submit()\">Add to booking</button>\n    </footer>\n</mat-dialog-actions>\n","import {\n    Component,\n    EventEmitter,\n    Inject,\n    OnInit,\n    Output,\n} from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport {\n    BehaviorSubject,\n    Observable,\n    of,\n    Subject\n} from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    distinctUntilChanged,\n    first,\n    map,\n    switchMap,\n    take,\n    withLatestFrom\n} from 'rxjs/operators';\nimport {\n    Building,\n    mapBuildingToSelectOption,\n    mapCityToAllSelectOption,\n    OrganisationService,\n    SettingsService,\n    Space,\n    SpaceBookingRuleOptions,\n    SpacesService,\n    toggleSelectedByGroup,\n    User,\n    UsersService\n} from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport {\n    DialogEvent,\n    HashMap,\n    Identity,\n    unique\n} from '@mckinsey-converge/base';\nimport { NoCateringModalComponent } from '../no-catering-modal/no-catering-modal.component'\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { SelectOption } from '@mckinsey-converge/ui';\n\nexport interface SpaceSelectModalData {\n    /** List of selected spaces */\n    spaces: Space[];\n    /** Start time for availability of spaces */\n    dateTz: DateTZ;\n    /** Duration of the availability block to look for */\n    duration: number;\n    /** Host of the booking being made */\n    host: User;\n    /** Whether multiple spaces can be selected */\n    multiple: boolean;\n    /** Force zone ids */\n    zone_ids?: string;\n    /** Booking needs catering */\n    needsCatering?: boolean,\n}\n\n@Component({\n    selector: 'a-space-select-modal',\n    templateUrl: './space-select-modal.component.html',\n    styleUrls: ['./space-select-modal.component.scss']\n})\nexport class SpaceSelectModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Whether space list is being loaded */\n    public loading: boolean;\n    /** List of available spaces to select from */\n    public spaces: Space[] = [];\n    /** Active building to filter spaces on */\n    public active_building: Building;\n    /** Active building to filter spaces on */\n    public active_type: Identity;\n    /** List of items from an API search */\n    public search_results$: Observable<Space[]>;\n    /** Subject holding the value of the search */\n    public readonly change$ = new Subject<string | string[]>();\n    /** List of currently selected spaces */\n    public selected_spaces: Space[] = [];\n    /** Mapping as to whether a space is by request */\n    public request_map: HashMap<boolean> = {};\n    /** Whether selected list should be shown on mobile */\n    public show_list: boolean;\n\n    /** host to load (only in staff) **/\n    public host: User;\n\n    /** List of available buildings */\n    public types: Identity[] = [];\n\n    public isConcierge: boolean;\n    public frontend: string;\n\n    /** List of available buildings */\n    public get buildings(): Building[] {\n        return this._org.buildings;\n    }\n\n    /** Whether multiple spaces can be selected */\n    public get multiple(): boolean {\n        return false;\n    }\n\n    public get has_zone(): boolean {\n        return !!this._data.zone_ids;\n    }\n\n    public formGroup = new FormGroup({\n        location: new FormControl([]),\n    });\n\n    public options = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public selectedOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n\n\n    public noCateringDialogRef: MatDialogRef<NoCateringModalComponent, any>;\n\n    /** List of zones to filter the spaces on */\n    public zone_ids: string[] = [];\n\n\n    public get initialBuildingIds(): string[] {\n        return this._org.building ? [this._org.building.id] : [];\n    }\n\n    public savedSelection\n\n    constructor(\n        private _org: OrganisationService,\n        private _users: UsersService,\n        private _spaces: SpacesService,\n        private _settings: SettingsService,\n        private _dialog: MatDialog,\n        @Inject(MAT_DIALOG_DATA) private _data: SpaceSelectModalData\n    ) {\n        super();\n        this.isConcierge = _settings.concierge;\n        this.frontend = _settings.frontend;\n    }\n\n    public ngOnInit(): void {\n        this._spaces.initialised.pipe(first((_) => _)).subscribe(() => {\n            let request_id = 0;\n            // Listen for input changes\n            this.search_results$ = this.change$.pipe(\n                debounceTime(400),\n                distinctUntilChanged(),\n                switchMap((bld) => {\n                    this.loading = true;\n                    const zone_ids: string[] = [];\n                    /* istanbul ignore else */\n                    if (this.active_building) {\n                        zone_ids.push(this.active_building.id);\n                    }\n\n                    if (bld?.includes('|')) {\n                        bld = this.savedSelection\n                    }\n\n                    const id = request_id;\n                    return this._spaces.available({\n                        zone_ids: bld?.length ? bld : this._data.spaces[0].building.id || zone_ids.join(','),\n                        dateTz: this._data.dateTz,\n                        duration: this._data.duration\n                    }).then(async (list) => ({ id, list }));\n                }),\n                catchError((_) => of({ id: request_id, list: [], error: _ })),\n                map((resp: { id: number, list: Space[] }) => {\n                    this.loading = false;\n                    const filtered_list = resp.list.filter((space: Space) => {\n                        // if concierge skip rules check.\n                        if (this._settings.concierge) {\n                            return (this.active_type && this.active_type.id ? space.zones.includes(`${this.active_type.id}`) : true) &&\n                                !this.selected_spaces.find((s) => s.id === space.id);\n                        }\n\n                        const rules = space.rulesFor({\n                            dateTz: this._data.dateTz,\n                            duration: this._data.duration,\n                            host: this.host || this._data.host\n                        });\n                        return (\n                            rules.hide !== true &&\n                            (this.active_type && this.active_type.id\n                                ? space.zones.includes(`${this.active_type.id}`)\n                                : true) &&\n                            !this.selected_spaces.find((_space) => _space.id === space.id)\n                        );\n                    });\n                    return resp.id === request_id ? filtered_list : this.spaces;\n                })\n            );\n            // Process API results\n            this.subscription(\n                'search_results',\n                this.search_results$.subscribe((list) => {\n                    this.spaces = list.filter((space) => {\n                        if (!space.available) {\n                            return false;\n                        }\n                        for (const zone of this.zone_ids) {\n                            if (space.zones.includes(zone)) {\n                                return true;\n                            }\n                        }\n                        return !this.zone_ids.length;\n                    });\n                    this.spaces.sort((a, b) => this.sort(a, b));\n                    if (!this.selectedOptions.value.length) {\n                        this.setDefaultBuilding()\n                    }\n                })\n            );\n            this.active_building = this._data.spaces?.length\n                ? this._org.buildings.find((i) => i.id === this._data.spaces[0].level.building_id)\n                : this._org.building;\n            this.types = [{ id: '', name: 'Any Space Type' } as any].concat(\n                this._org.space_types || []\n            );\n            this.active_type = this.types[0];\n            this.change$.next('');\n        });\n\n        this.subscription('buildings', this._org.listen('buildings').subscribe((bld_list) => {\n            const city = this._org.building.city\n            const timezone = this._org.building.timezone\n            const grouped_by_city = {\n                key: { name: city, timezone },\n                value: bld_list?.filter((bld) => bld.city === city) || []\n            }\n            const city_buildings = grouped_by_city.value.map(\n                (bld) => mapBuildingToSelectOption(grouped_by_city.key.name, bld)\n            )\n            const buildings = [\n                mapCityToAllSelectOption(grouped_by_city.key),\n                ...city_buildings\n            ]\n            this.options.next(buildings)\n        }));\n\n    }\n\n    /** Add space to selected list */\n    public addSpace(space: Space) {\n        this.selected_spaces.push(space);\n        this.selected_spaces = unique(this.selected_spaces, 'id');\n    }\n\n    /** Remove space from selected list */\n    public removeSpace(space: Space) {\n        this.selected_spaces = this.selected_spaces.filter((a_space) => a_space.id !== space.id);\n    }\n\n    /** Emit current state of the selected list */\n    public save(list: Space[]) {\n        if (!this._data.needsCatering) {\n            // No catering order to warn about\n            this.event.emit({ reason: 'done', metadata: list });\n            return;\n        }\n        // Check if the room has catering \n        if (list[0].has_catering) {\n            this.event.emit({ reason: 'done', metadata: list });\n            return;\n        }\n        // If not warn that the room doesn't have catering\n        this.noCateringDialogRef = this._dialog.open(NoCateringModalComponent, {\n            panelClass: 'mck-modal-mini',\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n        this.subscription(\n            'no-catering-modal',\n            this.noCateringDialogRef.componentInstance.event.subscribe((event) => {\n                if (event.reason === 'done') {\n                    this.event.emit({ reason: 'done', metadata: list });\n                }\n                if (event.reason === 'close') {\n                    this.event.emit({ reason: 'close' });\n                }\n            })\n        );\n    }\n\n    private update() {\n        const map = {};\n        const options: SpaceBookingRuleOptions = {\n            dateTz: this._data.dateTz,\n            duration: this._data.duration,\n            host: this._data.host\n        };\n        this.selected_spaces.forEach((space) => (map[space.id] = space.byRequest(options)));\n        this.spaces.forEach((space) => (map[space.id] = space.byRequest(options)));\n        this.request_map = map;\n    }\n\n    public setDefaultBuilding() {\n        const defaultBld = this.options.value.filter(opt => opt.value === this._org.building.id)\n        this.selectedOptions.next(defaultBld)\n    }\n\n    /**\n     * Compare two spaces to determine order\n     * @param space_a\n     * @param space_b\n     */\n    public sort(space_a: Space, space_b: Space) {\n        const bld = this._org.buildings.find((bld) => space_a.zones.includes(bld.id)) || { name: '', sort_order: [] };\n        const bld_b = this._org.buildings.find((bld) => space_b.zones.includes(bld.id));\n        if (bld && bld !== bld_b) {\n            return bld.name.localeCompare(bld_b?.name);\n        }\n        const sort_order = [...bld.sort_order].reverse();\n        for (const zone_id of sort_order) {\n            if (zone_id === '*') {\n                continue;\n            }\n            const a_has_zone = space_a.zones.indexOf(zone_id) >= 0;\n            const b_has_zone = space_b.zones.indexOf(zone_id) >= 0;\n            if (a_has_zone && !b_has_zone) {\n                return 1;\n            } else if (b_has_zone && !a_has_zone) {\n                return -1;\n            }\n        }\n        return space_a.name.localeCompare(space_b.name);\n    }\n\n    public toggle(option: SelectOption<any>) {\n        // update the selected value\n        this.selectedOptions.pipe(\n            take(1),\n            withLatestFrom(this.options),\n            map(([selectedOptions, options]) => {\n                return toggleSelectedByGroup(options, selectedOptions, option);\n            })\n        ).subscribe(next => {\n            const formData = this.formGroup.value;\n            this.formGroup.setValue({\n                location: formData.location,\n            });\n            this.selectedOptions.next(next);\n            this.savedSelection = next.map((bld) => bld.value)\n\n        });\n    }\n\n    /**\n     * Update the selected space list\n     * @param space Space to add/toggle in the selected list\n     */\n    public selectSpace(space: Space) {\n        const list = this.spaces;\n        if (list.find((item) => item.id === space.id)) {\n            this.spaces = list.filter((item) => item.id !== space.id);\n        } else {\n            this.spaces = [space];\n        }\n    }\n\n    public clearList() {\n        this.spaces = []\n        this.savedSelection = []\n    }\n\n    public triggerSearch = () => {\n        if (this.savedSelection.length) {\n            this.change$.next(this.savedSelection)\n        } else {\n            this.spaces = []\n        }\n    }\n\n}\n","<header>\n    <div class=\"heading\">Select meeting space{{ multiple ? 's' : '' }}</div>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main>\n        <div class=\"block available {{frontend}}\" [formGroup]=\"formGroup\">\n            <ng-container *ngIf=\"!has_zone\">\n                <mck-autocomplete-chip-select-item\n                    errorMessage=\"Location and office must be selected\"\n                    label=\"Location and office\"\n                    [required]=\"true\"\n                    [selectOnlyOneGroup]=\"true\"\n                    placeHolder=\"Start typing to filter location or office...\"\n                    formControlName=\"location\"\n                    [options]=\"options\"\n                    [selectedOptions]=\"selectedOptions\"\n                    (optionSelected)=\"toggle($event)\"\n                    [displayCTA]=\"true\"\n                    (chipsCleared)=\"clearList()\"\n                    [useCTAs]=\"true\"\n                    (onClickConfirm)=\"triggerSearch()\"\n                ></mck-autocomplete-chip-select-item>\n                <mck-label *ngIf=\"types && types.length > 1\">Type</mck-label>\n                <mat-form-field appearance=\"outline\" *ngIf=\"types && types.length > 1\">\n                    <mat-select\n                        #select\n                        [(value)]=\"active_type\"\n                        (valueChange)=\"change$.next(active_building.id + '|' + active_type.id)\"\n                    >\n                        <mat-option *ngFor=\"let type of types\" [value]=\"type\">\n                            {{ type?.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </ng-container>\n            <div class=\"list\">\n                <ng-container *ngIf=\"!loading; else load_state\">\n                    <ng-container *ngIf=\"spaces && spaces.length; else empty_state\">\n                        <div class=\"item\" *ngFor=\"let space of spaces\">\n                            <div class=\"details\">\n                                <div class=\"name\">{{ space.local_name }}</div>  \n                                <div class=\"info\">{{ space.level.name }}</div>\n                            </div>\n                            <div class=\"has-catering\" *ngIf=\"space.has_catering\">\n                                <app-icon\n                                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'restaurant' }\"\n                                    title=\"Catering Available\"\n                                ></app-icon>\n                            </div>\n                            <div class=\"capacity\">\n                                <app-icon\n                                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'account_circle' }\"\n                                    title=\"Room Capacity\"\n                                ></app-icon>\n                                <div class=\"text\">{{ space.capacity || '0' }}</div>\n                            </div>\n                            <div class=\"actions {{frontend}}\">\n                                <button\n                                    [class.request]=\"!isConcierge && request_map[space.id]\"\n                                    name=\"add\"\n                                    mat-button\n                                    (click)=\"multiple ? addSpace(space) : save([space])\"\n                                >\n                                    {{ (!isConcierge && request_map[space.id]) ? 'Request' : 'Select' }}\n                                </button>\n                            </div>\n                        </div>\n                    </ng-container>\n                </ng-container>\n            </div>\n        </div>\n        <div class=\"block selected {{frontend}}\" *ngIf=\"multiple\" [class.show]=\"show_list\">\n            <h3>Selected spaces</h3>\n            <div class=\"list\">\n                <ng-container\n                    *ngIf=\"selected_spaces && selected_spaces.length; else empty_select_state\"\n                >\n                    <div class=\"item\" *ngFor=\"let space of selected_spaces\">\n                        <div\n                            class=\"icon\"\n                            [class.request]=\"request_map[space.id]\"\n                            [matTooltip]=\"\n                                request_map[space.id]\n                                    ? 'Bookings in this space need to be approved by a member of the concierge team'\n                                    : ''\n                            \"\n                        >\n                            <app-icon\n                                [icon]=\"{\n                                    class: 'material-icons',\n                                    content: request_map[space.id] ? 'warning' : 'done'\n                                }\"\n                            ></app-icon>\n                        </div>\n                        <div class=\"details\">\n                            <div class=\"name\">{{ space.name }}</div>\n                            <div class=\"info\">{{ space.level.name }}</div>\n                        </div>\n                        <div class=\"capacity\">\n                            <app-icon\n                                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'account_circle' }\"\n                            ></app-icon>\n                            <div class=\"text\">{{ space.capacity || '0' }}</div>\n                        </div>\n                        <div class=\"actions {{frontend}}\">\n                            <button mat-icon-button name=\"remove\" (click)=\"removeSpace(space)\">\n                                <app-icon\n                                    [icon]=\"{ class: 'material-icons', content: 'close' }\"\n                                ></app-icon>\n                            </button>\n                        </div>\n                    </div>\n                </ng-container>\n            </div>\n            <footer>\n                <button mat-button name=\"next\" (click)=\"save(this.selected_spaces)\">Add to booking</button>\n            </footer>\n            <button mat-icon-button [class.close]=\"true\" [class.mobile-only]=\"true\" (click)=\"show_list = false\">\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n            </button>\n            <div class=\"tag mobile-only\">\n                <button mat-icon-button (click)=\"show_list = true\">\n                    <app-icon [icon]=\"{ class: 'material-icons', content: 'list' }\"></app-icon>\n                </button>\n            </div>\n        </div>\n    </main>\n</mat-dialog-content>\n<ng-template #load_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <mat-spinner diameter=\"48\"></mat-spinner>\n        </div>\n        <div class=\"text\">Loading available spaces...</div>\n    </div>\n</ng-template>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No results available, please select another office. </div>\n    </div>\n</ng-template>\n<ng-template #empty_select_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No selected spaces</div>\n    </div>\n</ng-template>\n","import { Component, Input } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\n\n@Component({\n  selector: 'user-form',\n  templateUrl: './user-form.component.html',\n  styleUrls: ['./user-form.component.scss']\n})\nexport class UserFormComponent {\n    /** Group of form fields used for creating the system */\n    @Input() public form: FormGroup;\n}\n","<div class=\"user form\" *ngIf=\"form\">\n    <form [formGroup]=\"form\">\n        <div class=\"field\" *ngIf=\"form.controls.name\">\n            <label\n                for=\"first-name\"\n                [class.error]=\"\n                    form.controls.first_name.invalid &&\n                    form.controls.first_name.touched\n                \"\n                i18n=\"User form first name label\"\n                >First Name:</label\n            >\n            <mat-form-field appearance=\"outline\">\n                <input\n                    matInput\n                    name=\"first-name\"\n                    placeholder=\"First name\"\n                    i18n-placeholder\n                    formControlName=\"first_name\"\n                />\n                <mat-error i18n=\"User form first name error\"\n                    >First name is required\n                </mat-error>\n            </mat-form-field>\n        </div>\n        <div class=\"field\" *ngIf=\"form.controls.name\">\n            <label\n                for=\"system-name\"\n                [class.error]=\"\n                    form.controls.last_name.invalid &&\n                    form.controls.last_name.touched\n                \"\n                i18n=\"User form last name label\"\n                >Last Name:</label\n            >\n            <mat-form-field appearance=\"outline\">\n                <input\n                    matInput\n                    name=\"last-name\"\n                    placeholder=\"Last name\"\n                    i18n-placeholder\n                    formControlName=\"last_name\"\n                />\n                <mat-error i18n=\"User form last name error\"\n                    >Last name is required</mat-error\n                >\n            </mat-form-field>\n        </div>\n        <div class=\"field\" *ngIf=\"form.controls.email\">\n            <label\n                for=\"email\"\n                [class.error]=\"\n                    form.controls.email.invalid && form.controls.email.touched\n                \"\n                i18n=\"User form email label\"\n                >Email:</label\n            >\n            <mat-form-field appearance=\"outline\">\n                <input\n                    matInput\n                    name=\"email\"\n                    placeholder=\"Email Address\"\n                    i18n-placeholder\n                    formControlName=\"email\"\n                />\n                <mat-error i18n=\"User form email error\"\n                    >A valid email is required</mat-error\n                >\n            </mat-form-field>\n        </div>\n    </form>\n</div>\n","export * from './lib/legacy-ui.module';\nexport * from './lib/custom-fields';\nexport * from './lib/icon/icon.component';\nexport * from './lib/feedback/feedback.component';\nexport * from './lib/action-icon/action-icon.component'\nexport * from './lib/user-avatar/user-avatar.component'\nexport * from './lib/bookings/catering/item/item.component'\n","import { Component, OnInit, Input } from '@angular/core';\nimport { ApplicationIcon } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'action-icon',\n    templateUrl: './action-icon.component.html',\n    styleUrls: ['./action-icon.component.scss']\n})\nexport class ActionIconComponent implements OnInit {\n    /** Icon to display */\n    @Input() public icon: ApplicationIcon;\n    /** Whether action is being processed */\n    @Input() public loading: boolean;\n    /** State of the action */\n    @Input() public state: 'success' | 'error' | '' = '';\n\n    constructor() {}\n\n    ngOnInit(): void {}\n}\n","<div class=\"action-icon\" [class.fade]=\"state || loading\">\n    <app-icon [icon]=\"icon\"></app-icon>\n    <div class=\"'state center ' + state\" *ngIf=\"!loading && state\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: state === 'success' ? 'done' : 'close' }\"></app-icon>\n    </div>\n    <div class=\"loader center\" *ngIf=\"loading\">\n        <mat-spinner [diameter]=\"16\"></mat-spinner>\n    </div>\n</div>\n","import {\n    Component,\n    Input,\n    OnChanges,\n    SimpleChanges\n} from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { FormControl } from '@angular/forms';\n\nimport {\n    ApplicationService,\n    CateringCategory,\n    CateringItem,\n    SettingsService\n} from '@mckinsey-converge/data-common';\nimport { ANIMATION_SHOW_CONTRACT_EXPAND } from '@mckinsey-converge/animations';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { PackageOptionsModalComponent } from '../package-options-modal/package-options-modal.component';\n\nfunction hasSelectionRequirements(category: CateringCategory) {\n    return (\n        category.must_select < category.items.length ||\n        (category.must_select === category.items.length &&\n            category.items.find((item: any) => item.items && item.must_select < item.items.length))\n    );\n}\n\nfunction getActiveList(category: CateringCategory) {\n    const items = category.items || [];\n    let list = items.filter((item) => item.amount > 0).map((item) => item.id);\n    for (const item of items) {\n        if ((item as any).items && (item as any).items.length) {\n            list = list.concat(getActiveList(item as any));\n        }\n    }\n    return list;\n}\n\n@Component({\n    selector: 'a-catering-menu-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss'],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND]\n})\nexport class CateringMenuItemComponent extends BaseDirective implements OnChanges {\n    /** Whether item is a child of another */\n    @Input() public subitem: boolean;\n    /** Item to display */\n    @Input() public item: CateringCategory;\n    /** Field for storing items */\n    @Input() public field: FormControl;\n    /** Current symbol for the selected space */\n    @Input() public symbol: string;\n    /** Whether item should be disabled if not available anytime */\n    @Input() public disabled: boolean;\n    /** Whether to show smaller version of component */\n    @Input() public compact: boolean;\n    /** Whether to show children items */\n    public show_children: boolean;\n    public initial_state = null;\n\n    /** List of contents of the package */\n    public get contents(): string {\n        return this.item.items\n            ? this.item.items.reduce((list, item) => {\n                /* istanbul ignore else */\n                if (list) {\n                    list += '\\n\\n';\n                }\n                return (list += `${item.name}${\n                    (item as any).items\n                        ? (item as any).items.reduce(\n                        (a_list, an_item) =>\n                            (a_list += `\\n ${an_item.amount ? '' : ''} ${an_item.name} `),\n                        ''\n                        )\n                        : ''\n                } ${item.amount ? '' : ''}`);\n            }, '')\n            : '';\n    }\n\n    constructor(private _service: ApplicationService, private _dialog: MatDialog,\n                public settings: SettingsService) {\n        super();\n        // on the item selection set the revert/close state\n        this.initial_state = this.item;\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.field && this.field) {\n            const list = this.field.value;\n            // check the category\n            let item = list.find((an_cat) => an_cat.id === this.item.id);\n            if (item) {\n                // update the category level amount\n                this.item.setAmount(item ? item.amount : 0);\n            } else {\n                // find a category item\n                for (var cat of list) {\n                    item = cat?.items.find((an_item) => an_item.id === this.item.id);\n                    if (item) {\n                        this.item.setAmount(item ? item.amount : 0);\n                        break;\n                    }\n                };                \n            } \n\n            // On the confirm catering order modal set the revert/close state\n            if (!this.initial_state && this.item.amount) {\n                this.initial_state = this.item;\n            }\n\n            this.subscription(\n                'field_change',\n                this.field.valueChanges.subscribe((list) => {\n                    const item = list.find((an_item) => an_item.id === this.item.id);\n                    this.item.setAmount(item ? item.amount : 0);\n                    this.updatePackageSelection();\n                })\n            );\n        }\n    }\n\n    /**\n     * Update the amount of the item in the order\n     * @param value New amount\n     */\n    public updateAmount(value: number) {\n        /* istanbul ignore else */\n        if (this.field) {\n            const list: CateringItem[] = this.field.value;\n            const item = list.find((an_item) => an_item.id === this.item.id);\n            if (item) {\n                this.item.setAmount(value);\n                item.setAmount(value);\n                // MCK-1550 fix\n                const price = this.item.price;\n                item.setPrice(price)\n            } else {\n                const amount = this.item.amount;\n                this.item.setAmount(value);\n                if (\n                    this.item.package &&\n                    amount < value &&\n                    this.item.items &&\n                    this.item.items.length &&\n                    hasSelectionRequirements(this.item)\n                ) {\n                    this.selectPackageOptions().then(\n                        (confirmed_item) => {\n                            list.push(new CateringCategory(confirmed_item));\n                            this.field.setValue(list.filter((an_item) => an_item.amount));\n                        },\n                        () => {\n                            this.item.setAmount(999);\n                            this.timeout('amount', () => this.item.setAmount(0), 5);\n                            this._service.notifyWarn(\n                                'Package options not selected. Item removed from order'\n                            );\n                        }\n                    );\n                } else {\n                    list.push(new CateringItem(this.item));\n                }\n            }\n            this.field.setValue(list.filter((an_item) => an_item.amount));\n        }\n    }\n\n    public updatePackageSelection() {\n        const cart_item = this.field.value.find((item) => item.id === this.item.id);\n        if (cart_item) {\n            const active_items = getActiveList(cart_item);\n            this.timeout(\n                'update_package',\n                () => {\n                    this.item.items.forEach((item) => {\n                        item.setAmount(active_items.includes(item.id) ? 1 : 0);\n                        if ((item as any).items) {\n                            (item as any).items.forEach((item) => {\n                                item.setAmount(active_items.includes(item.id) ? 1 : 0);\n                            });\n                        }\n                    });\n                },\n                5\n            );\n        }\n    }\n\n    /** Reselect package options */\n    public updatePackageOptions(): void {\n        let updatedList: CateringItem[] = [];\n        this.selectPackageOptions().then(\n            (confirmed_item) => {\n                // Update the existing category package\n                this.field.value.forEach((category: CateringCategory) => {\n                    if (category.id === confirmed_item.id) {\n                        updatedList.push(new CateringCategory(confirmed_item))\n                    } else {\n                        updatedList.push(category)\n                    }\n                })\n                this.field.setValue(updatedList.filter((an_item) => an_item.amount));\n            },\n            () => {\n                this.item.setAmount(999);\n                this.timeout('amount', () => this.item.setAmount(0), 5);\n                this._service.notifyWarn(\n                    'Package options not selected. Item removed from order'\n                );\n            }\n        );\n    }\n\n    /**\n     * Open modal for user to select package options\n     */\n    private selectPackageOptions(): Promise<CateringCategory> {\n        return new Promise((resolve, reject) => {\n            const ref = this._dialog.open(PackageOptionsModalComponent, {\n                maxWidth: '95vw',\n                data: {\n                    item: new CateringCategory(this.item)\n                },\n                autoFocus: false,\n                backdropClass: 'mck-modal-backdrop',\n            });\n            let done = false;\n            ref.componentInstance.event.subscribe((event) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    done = true;\n                    resolve(ref.componentInstance.item);\n                    this.initial_state = this.item;\n                    ref.close();\n                }\n            });\n            ref.afterClosed().subscribe(() => {\n                /* istanbul ignore else */\n                if (!done) {\n                    if (this.initial_state) {\n                        resolve(this.initial_state);\n                    } else {\n                        reject();\n                    }\n                }\n            });\n        });\n    }\n}\n","<div\n    class=\"catering-item\"\n    *ngIf=\"item && (!item.out_of_stock || settings.concierge)\"\n    [class.compact]=\"compact\"\n    [class.subitem]=\"subitem\"\n    [attr.disabled]=\"disabled && !item.can_order_anytime\"\n>\n    <div\n        class=\"image\"\n        *ngIf=\"!subitem\"\n        [style.background-image]=\"'url(' + item.image_path + ')' | safe:'style'\"\n    ></div>\n    <div class=\"details\">\n        <div class=\"name\">{{ item.name }}</div>\n        <div class=\"description\">{{ item.package ? '[Package] ' : '' }}{{ item.description }}</div>\n        <div class=\"options\">\n            <div class=\"option price mobile-only\" *ngIf=\"item.unit_price\">\n                {{ item.unit_price / 100 | currency: symbol }}\n            </div>\n            <div\n                class=\"option\"\n                *ngIf=\"item.package && item.availableItems.length && !item.must_select\"\n                [matTooltip]=\"contents\"\n                i18n=\"Catering order item available options label\"\n            >\n                { item.availableItems.length, plural, =1 { Contains {{ item.availableItems.length }} item } other {\n                Contains {{ item.availableItems.length }} items } }\n            </div>\n            <div\n                class=\"option\"\n                *ngIf=\"item.package && item.must_select && item.amount > 0\"\n                [matTooltip]=\"contents\"\n            >\n                {{ item.must_select }}\n                <span class=\"not-mobile\" i18n=\"Catering order item selected options label\">\n                    Selected\n                </span>\n            </div>\n            <button\n                mat-button\n                *ngIf=\"item.package && item.must_select && item.amount > 0\"\n                (click)=\"updatePackageOptions()\"\n                i18n=\"Catering order item options change action\"\n            >\n                Customise\n            </button>\n        </div>\n    </div>\n    <div class=\"option price not-mobile\" *ngIf=\"item.unit_price\">\n        {{ item.unit_price / 100 | currency: symbol }}\n    </div>\n    <a-counter\n        *ngIf=\"!item.availableItems.length || item.package\"\n        [useInput]=\"item.must_select === 0 || item.availableItems.length === 0\"\n        [max]=\"item.maximum_quantity\"\n        [ngModel]=\"item.amount\"\n        (ngModelChange)=\"updateAmount($event)\"\n    ></a-counter>\n    <button\n        mat-icon-button\n        *ngIf=\"item.availableItems && item.availableItems.length && !item.package\"\n        (click)=\"show_children = !show_children\"\n    >\n        <app-icon\n            [icon]=\"{\n                class: 'material-icons',\n                content: show_children ? 'keyboard_arrow_up' : 'keyboard_arrow_down'\n            }\"\n        ></app-icon>\n    </button>\n</div>\n<div class=\"children\" [@show]=\"show_children ? 'show' : 'hide'\">\n    <a-catering-menu-item\n        *ngFor=\"let sub_item of item.availableItems\"\n        [compact]=\"compact\"\n        [subitem]=\"true\"\n        [symbol]=\"symbol\"\n        [item]=\"sub_item\"\n        [disabled]=\"!settings.concierge && disabled\"\n        [field]=\"field\"\n    ></a-catering-menu-item>\n</div>\n","import {\n    Component,\n    EventEmitter,\n    Inject,\n    Output\n} from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport {\n    DialogEvent,\n    HashMap\n} from '@mckinsey-converge/base';\nimport {\n    CateringCategory,\n    CateringItem\n} from '@mckinsey-converge/data-common';\n\nexport interface PackageOptionsModalData {\n    item: CateringCategory;\n}\n\nexport function checkItemRequirements(category: CateringCategory): boolean {\n    const items = category.items || [];\n    return category.must_select >= items.length\n        ? items.reduce((valid, item) => valid && checkItemRequirements(item as any), true)\n        : items.reduce((amount, item) => amount + (item.amount ? 1 : 0), 0) ===\n        category.must_select;\n}\n\nexport function getActiveItems(category: CateringCategory): HashMap<string> {\n    let map = {};\n    if (category.items) {\n        const item = category.items.find(item => item.amount > 0);\n        if (item) {\n            map[category.id] = item.id;\n        }\n        category.items.forEach(item => map = { ...map, ...getActiveItems(item as any) });\n    }\n    return map;\n}\n\n@Component({\n    selector: 'a-package-options-modal',\n    templateUrl: './package-options-modal.component.html',\n    styleUrls: ['./package-options-modal.component.scss']\n})\nexport class PackageOptionsModalComponent {\n    /** Emitter for user actions on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n\n    /** Item to select options for */\n    public get item(): CateringCategory {\n        return this._data.item;\n    }\n\n    /** Whether package requirements have been met */\n    public get requirements_met(): boolean {\n        return checkItemRequirements(this.item);\n    }\n\n    public get active_items(): HashMap<string> {\n        return getActiveItems(this.item);\n    }\n\n    constructor(@Inject(MAT_DIALOG_DATA) private _data: PackageOptionsModalData) {\n    }\n\n    /**\n     * Update the list of selected items\n     */\n    public updateAmount(a_package: CateringCategory, option: CateringItem, state: boolean) {\n        if (state) {\n            const needed = a_package.must_select;\n            const active = a_package.items.filter(an_item => an_item.amount > 0).length;\n            if (active >= needed) {\n                const item = a_package.items.find(an_item => an_item.amount > 0);\n                item.setAmount(0);\n            }\n            option.setAmount(1);\n        } else {\n            option.setAmount(0);\n        }\n    }\n}\n","<header>\n    <h3 i18n=\"Catering package options header\">Package Options</h3>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content class=\"package-options\">\n    <main>\n        <ng-container *ngTemplateOutlet=\"item_display; context: { package: item }\"></ng-container>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button [disabled]=\"!requirements_met\" (click)=\"event.emit({ reason: 'done' })\" i18n=\"Catering package options save action\">\n            Confirm Options\n        </button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #item_display let-package=\"package\">\n    <ng-container *ngIf=\"package.availableItems && package.availableItems.length\">\n        <mat-radio-group [ngModel]=\"active_items[package.id]\">\n            <div class=\"item\" *ngFor=\"let option of package.availableItems\" [attr.to-select]=\"option.must_select\">\n            <ng-container\n                *ngIf=\"\n                    package.must_select &&\n                    package.must_select < package.items.length &&\n                    !option.must_select\n                \"\n            >\n                <mat-checkbox\n                    *ngIf=\"package.must_select > 1\"\n                    [checked]=\"!!option.amount\"\n                    (change)=\"updateAmount(package, option, $event.checked)\"\n                >\n                    {{ option.name }}\n                </mat-checkbox>\n                <mat-radio-button\n                    *ngIf=\"package.must_select === 1\"\n                    [value]=\"option.id\"\n                    (change)=\"updateAmount(package, option, true)\"\n                >\n                    {{ option.name }}\n                </mat-radio-button>\n            </ng-container>\n            <ng-container *ngIf=\"package.must_select >= package.items.length || option.must_select\">\n                {{ option.name }}\n            </ng-container>\n            <ng-container\n                *ngTemplateOutlet=\"item_display; context: { package: option }\"\n            ></ng-container>\n        </div>\n    </mat-radio-group>\n    </ng-container>\n</ng-template>\n","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\n\n@Component({\n  selector: 'an-action-field',\n  templateUrl: './action-field.component.html',\n  styleUrls: ['./action-field.component.scss']\n})\nexport class ActionFieldComponent extends BaseDirective {\n    /** Name of the field */\n    @Input() public name: string;\n    /** Value to display on the field */\n    @Input() public placeholder: string;\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Emitter for user interaction events */\n    @Output('onAction') public on_action = new EventEmitter();\n    /** Whether to show tooltip */\n    public show_tooltip = false;\n\n    /**\n     * Emit that the user has performed an action on the field\n     */\n    public performAction() {\n        this.show_tooltip = !this.show_tooltip;\n        this.on_action.emit();\n    }\n}\n","<div\n    class=\"action-field\"\n    role=\"button\"\n    [attr.disabled]=\"disabled\"\n    form-field\n    tabindex=\"0\"\n    (keydown.enter)=\"performAction()\"\n    (click)=\"performAction()\"\n>\n    <div class=\"display\">{{ placeholder }}</div>\n    <div class=\"icon\">\n        <app-icon\n            [icon]=\"{\n                type: 'icon',\n                class: 'material-icons',\n                content: show_tooltip ? 'arrow_drop_up' : 'arrow_drop_down'\n            }\"\n        ></app-icon>\n    </div>\n</div>\n","import { Component, forwardRef, Input } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\n\n@Component({\n    selector: 'a-counter',\n    templateUrl: './counter.component.html',\n    styleUrls: ['./counter.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            /* istanbul ignore next */\n            useExisting: forwardRef(() => CounterComponent),\n            multi: true,\n        },\n    ],\n})\nexport class CounterComponent implements ControlValueAccessor {\n    /** Maximum amount for the counter */\n    @Input() public max: number = 10;\n    /** Minimum amount for the counter */\n    @Input() public min: number = 0;\n\n    @Input() public useInput = false;\n\n    /** Current value of the counter */\n    public value: number;\n    public previous_value: number = 0;\n    /** Whether shift key is being held by the user */\n    public shift_key: boolean;\n    /** Whether control key is being held by the user */\n    public ctrl_key: boolean;\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    /**\n     * Add the `step` to the current value\n     */\n    public add() {\n        if (!this.value) {\n            this.value = this.min || 0;\n        }\n        const step = this.ctrl_key ? 100 : this.shift_key ? 10 : 1;\n        this.value += step;\n        if (this.value > this.max) {\n            this.value = this.max || 10;\n        }\n        this.setValue(this.value);\n    }\n\n    /** Remove the `step` from the current value */\n    public remove() {\n        if (!this.value) {\n            this.value = this.min || 0;\n        }\n        const step = this.ctrl_key ? 100 : this.shift_key ? 10 : 1;\n        this.value -= step;\n        if (this.value < this.min) {\n            this.value = this.min || 0;\n        }\n        this.setValue(this.value);\n    }\n\n    public handleTimeout = null;\n\n    public onInputChange(new_value: string) {\n        if (this.handleTimeout) {\n            clearTimeout(this.handleTimeout);\n            this.handleTimeout = null;\n        }\n        this.handleTimeout = setTimeout(() => this.changeInput(new_value), 500);\n    }\n\n    public changeInput(new_value: string) {\n        let value = Number(new_value);\n        if (isNaN(value)) {\n            value = this.previous_value;\n        }\n        if (value < this.min) {\n            value = this.min || 0;\n        }\n        if (value > this.max) {\n            value = this.max || 10;\n        }\n        this.setValue(value);\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number): void {\n        this.previous_value = new_value;\n        this.value = new_value;\n        /* istanbul ignore else */\n        if (this._onChange) {\n            this._onChange(new_value);\n        }\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.value = value;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n}\n","<div\n    class=\"counter\"\n    (window:keydown.shift)=\"shift_key = true\"\n    (window:keydown.control)=\"ctrl_key = true\"\n    (window:keydown.meta)=\"ctrl_key = true\"\n    (window:keyup.shift)=\"shift_key = false\"\n    (window:keyup.control)=\"ctrl_key = false\"\n    (window:keyup.meta)=\"ctrl_key = false\"\n>\n    <button mat-icon-button name=\"remove\" [disabled]=\"!value || value === min\" (click)=\"remove()\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'remove' }\"></app-icon>\n    </button>\n    <input\n        #inputValue\n        aria-label=\"value input\"\n        *ngIf=\"useInput\"\n        (keyup.enter)=\"onInputChange(inputValue.value)\"\n        (blur)=\"onInputChange(inputValue.value)\"\n        (ngModelChange)=\"onInputChange($event)\"\n        [(ngModel)]=\"value\"\n        class=\"value\"/>\n    <div class=\"value\" *ngIf=\"!useInput\" aria-label=\"value\">\n        {{value || '0'}}\n    </div>\n    <button mat-icon-button name=\"add\" [disabled]=\"value === max\" (click)=\"add()\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'add' }\"></app-icon>\n    </button>\n</div>\n","import { Component, OnInit, forwardRef, Input, ViewChild, Output, EventEmitter } from '@angular/core';\nimport { NG_VALUE_ACCESSOR, ControlValueAccessor } from '@angular/forms';\nimport { MatMenuTrigger } from '@angular/material/menu';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'a-date-field',\n    templateUrl: './date-field.component.html',\n    styleUrls: ['./date-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DateFieldComponent),\n            multi: true\n        }\n    ]\n})\nexport class DateFieldComponent extends BaseDirective implements OnInit, ControlValueAccessor {\n    /** Earliest date available the user is allowed to pick */\n    @Input('from') public _from: number = DateNow(new Date()).ms;\n    /** Latest date available the user is allowed to pick */\n    @Input('to') public _to: number;\n    /** Position of the tooltip */\n    @Input() public position: 'right' | 'left' = 'right';\n    /** Offset of the tooltip */\n    @Input() public offset: 'top' | 'bottom' = 'bottom';\n    /** Whether form control is disabled */\n    @Input() public disabled: boolean;\n    /** Whether form control is invalid, touched and contains errors */\n    @Input() public error?: boolean;\n    /** Optional event emitter for changes */\n    @Output() public onChange = new EventEmitter();\n    /** Whether to show the calendar tooltip */\n    public show_tooltip: boolean;\n    /** Currently selected date */\n    public date: number;\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    @ViewChild(MatMenuTrigger, { static: true }) private _trigger: MatMenuTrigger;\n\n    /** First allowed date on the calendar */\n    public get from(): number {\n        return this._from || DateNow(new Date()).startOfValue('day').ms;\n    }\n    /** Current date value */\n    public get until(): number {\n        return this._to || DateNow(new Date()).endOfValue('day').addValue({ years: 1 }).ms;\n    }\n    /** Display value for the current date */\n    public get date_string(): string {\n        // R--- Needs TZ aware inputs\n        const date = new DateTZ({date: this.date})\n        return date.formatDate('dd MMM yyyy');\n    }\n\n    /** Whether date picker is open */\n    public get is_open(): boolean {\n        return this._trigger.menuOpen;\n    }\n\n    public ngOnInit() {\n        this.date = DateNow(new Date()).ms;\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number) {\n        // Keep hours and minutes of the old date\n        const old_date = new DateTZ({date: this.date });\n        const new_d = new DateTZ({date: new_value})\n        let new_date = new_d\n            .setValue({ hour: old_date.dateHour, minute: old_date.minutes })\n            .ms;\n        // Check that new date is before from\n        if (new_date < this.from) {\n            new_date = this.from;\n        }\n        this.date = new_date;\n        if (this._onChange) {\n            this._onChange(new_date);\n            this.onChange.emit(new_date);\n        }\n        this.show_tooltip = false;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.date = value;\n        this.show_tooltip = false;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /** Set the state of the tooltip to closed after delay */\n    public closeDatePicker() {\n        this._trigger.closeMenu();\n    }\n\n    /** Set the state of the tooltip to closed after delay */\n    public openDatePicker() {\n        this._trigger.openMenu();\n    }\n}\n","<div\n    class=\"date-field\"\n    role=\"button\"\n    form-field\n    tabindex=\"0\"\n    [class.active]=\"is_open\"\n    [class.error]=\"error\"\n    [attr.disabled]=\"disabled\"\n    (keydown.enter)=\"openDatePicker()\"\n    [matMenuTriggerFor]=\"appMenu\"\n>\n    <div class=\"display\">{{ date_string }}</div>\n    <div class=\"icon\">\n        <app-icon\n            [icon]=\"{\n                type: 'icon',\n                class: 'material-icons',\n                content: is_open ? 'arrow_drop_up' : 'arrow_drop_down'\n            }\"\n        ></app-icon>\n    </div>\n</div>\n<mat-menu #appMenu=\"matMenu\">\n    <div mat-menu-item class=\"date-picker\" (click)=\"$event.stopPropagation()\">\n        <aca-date-picker\n            [ngModel]=\"date\"\n            [options]=\"{ from: from, to: until }\"\n            (ngModelChange)=\"setValue($event); closeDatePicker()\"\n        ></aca-date-picker>\n    </div>\n</mat-menu>\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\n\nimport {\n    humaniseDuration,\n    Identity,\n    timeFormatString\n} from '@mckinsey-converge/base';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'a-duration-field',\n    templateUrl: './duration-field.component.html',\n    styleUrls: ['./duration-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DurationFieldComponent),\n            multi: true\n        }\n    ]\n})\nexport class DurationFieldComponent extends BaseDirective\n    implements OnInit, OnChanges, ControlValueAccessor {\n    /** Maximum duration option available */\n    @Input() public max: number = 240;\n    /** Minimum duration option available */\n    @Input() public min: number = 15;\n    /** Step value between options */\n    @Input() public step: number = 15;\n    /** Reference time for displaying next to durations */\n    @Input() public time: number;\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Special case prepopulation i.e. out of step options */\n    @Input() public specialPreprops: Array<number> = [];\n    /** Whether form all_day is enabled. */\n    @Input() public all_day: boolean = false;\n\n    public duration: number = 60;\n    /** List of available duration options */\n    public duration_options: Identity[];\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    public ngOnInit(): void {\n        this.duration_options = this.generateDurationOptions(this.max, this.min, this.step, this.all_day);\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.max || changes.min || changes.step || changes.time || changes.all_day) {\n            this.duration_options = this.generateDurationOptions(this.max, this.min, this.step, this.all_day);\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number): void {\n        this.duration = new_value;\n        /* istanbul ignore else */\n        if (this._onChange) {\n            this._onChange(+new_value);\n        }\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.duration = value;\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n\n    private generateDurationOptions(max: number, min: number, step: number, all_day: boolean = false): Identity[] {\n        const blocks: Identity[] = [];\n        let time = min;\n        // R--- Change input to dateTz\n        let date = this.time ? new DateTZ({date: this.time}) : null;\n\n        // Add special case for 10min duration/prepropulation\n        for (const option of this.specialPreprops) {\n            blocks.push({\n                id: option,\n                name: date\n                    ? `${date.addValue({ minutes: option }).formatDate(timeFormatString()).toLocaleLowerCase()} (${humaniseDuration(option)})`\n                    : `${humaniseDuration(option)}`\n            });\n        }\n\n\n        while (time <= max) {\n            blocks.push({\n                id: time,\n                name: date\n                    ? `${date.addValue({ minutes: time }).formatDate(timeFormatString()).toLocaleLowerCase()} (${humaniseDuration(time)})`\n                    : `${humaniseDuration(time)}`\n            });\n            time += step;\n        }\n        if (all_day) {\n           blocks.push({ id: 24 * 60, name: 'All Day' }); \n        }\n        blocks.push({ id: 7 * 24 * 60, name: '1 week' });\n        return blocks;\n    }\n}\n","<div class=\"duration-field\" [attr.disabled]=\"disabled\">\n    <mat-form-field appearance=\"outline\">\n        <mat-select #select [value]=\"duration\" [disabled]=\"disabled\" (valueChange)=\"setValue($event)\">\n            <mat-option *ngFor=\"let option of duration_options\" [value]=\"option.id\">\n                {{ option.name }}\n            </mat-option>\n        </mat-select>\n    </mat-form-field>\n</div>\n","export * from './action-field/action-field.component'\nexport * from './counter/counter.component'\nexport * from './date-field/date-field.component'\nexport * from './duration-field/duration-field.component'\nexport * from './time-field/time-field.component'\nexport * from './user-search-field/user-search-field.component'\nexport * from './user-list-field/user-list-field.component'\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n    ViewChild\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\nimport { MatSelect } from '@angular/material/select';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport {\n    Identity,\n    timeFormatString\n} from '@mckinsey-converge/base';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'a-time-field',\n    templateUrl: './time-field.component.html',\n    styleUrls: ['./time-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => TimeFieldComponent),\n            multi: true\n        }\n    ]\n})\nexport class TimeFieldComponent extends BaseDirective implements OnInit, OnChanges, ControlValueAccessor {\n    /** Time step between each allowed time option */\n    @Input() public step: number = 15;\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Whether past times are allowed */\n    @Input() public no_past_times: boolean = true;\n    /** String representing the currently set time */\n    public date: number = DateNow(new Date()).ms;\n    /** String representing the currently set time */\n    public time: string = DateNow(new Date()).formatDate('HH:mm');\n    /** Available time blocks for the selected date */\n    public _time_options: Identity[];\n    /** Whether select field should be shown */\n    public show_select: boolean;\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    /** Select field for selecting the time */\n    @ViewChild('select') private select_field: MatSelect;\n\n    // R--- This is the form input that needs to be TZ active.\n    public ngOnInit(): void {\n        this.show_select = true;\n        this._time_options = this.generateAvailableTimes(this.date, !this.no_past_times, this.step);\n        this.timeout('hide', () => this.show_select = false);\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.no_past_times || changes.step) {\n            this._time_options = this.generateAvailableTimes(this.date, !this.no_past_times, this.step);\n        }\n    }\n\n    public get date_(){\n        return new DateTZ({date: this.date})\n    }\n\n    /** Available time blocks for the selected date */\n    public get time_options() {\n        const time = (this.time || '00:00').split(':');\n        const date = this.date_.setValue({ hour: +time[0], minute: +time[1] });\n        if (date.minutes % 15 !== 0 && !this._time_options.find(time => time.id === date.formatDate('HH:mm'))) {\n            this._time_options.push({\n                name: `${date.formatDate(timeFormatString())}`,\n                id: date.formatDate('HH:mm')\n            });\n            this._time_options.sort((a, b) => `${a.id}`.localeCompare(`${b.id}`));\n        }\n        return this._time_options;\n    }\n\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: string): void {\n        this.time = new_value;\n        if (this._onChange) {\n            const time = (this.time || '00:00').split(':');\n            const date = this.date_.setValue({ hour: +time[0], minute: +time[1] }).startOfValue('minute');\n            this._onChange(date.ms);\n        }\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        if (!value) {\n            return;\n        }\n        this.date = value;\n        let date = this.date_.startOfValue('minute');\n        date = date.setValue({ minute: Math.ceil(date.minutes / 5) * 5 });\n        this.time = date.formatDate('HH:mm');\n        this._time_options = this.generateAvailableTimes(this.date, !this.no_past_times, this.step);\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n\n    /**\n     * Show select field for time options\n     */\n    public showSelect() {\n        this.show_select = true;\n        this.timeout('on_shown', () => {\n            if (this.select_field) {\n                this.select_field.focus();\n                this.select_field.open();\n                this.subscription('listen_close', this.select_field.openedChange.subscribe((state) => {\n                    if (!state) {\n                        this.show_select = false;\n                    }\n                }));\n            }\n        });\n    }\n\n    /**\n     * Generate a list of time options for the given date\n     * @param datestamp Date to generate options for\n     * @param show_past Whether past times should be options\n     */\n    private generateAvailableTimes(datestamp: number, show_past: boolean, step: number = 15): Identity[] {\n        let date = new DateTZ({date: datestamp});\n        const blocks = [];\n        if (show_past || date.isAfterDate(DateNow(new Date()))) {\n            date = date.startOfValue('day');\n        } else if (date.isAfterDate(DateNow(new Date()))) {\n            date = DateNow(new Date());\n        }\n        date = date.setValue({ minute: Math.ceil(date.minutes / step) * step });\n        const end = date.endOfValue('day');\n        // Add options for the rest of the day\n        while (date.isBeforeDate(end)) {\n            blocks.push({\n                name: `${date.formatDate(timeFormatString()).toLocaleLowerCase()}`,\n                id: date.formatDate('HH:mm')\n            });\n            date = date.addValue({ minutes: step });\n        }\n        return blocks;\n    }\n}\n","<div\n    class=\"time-field\"\n    role=\"button\"\n    [style.display]=\"show_select ? 'none' : ''\"\n    [attr.disabled]=\"disabled\"\n    form-field\n    tabindex=\"0\"\n    (keydown.enter)=\"showSelect()\"\n>\n    <div class=\"display\">\n        <input\n            matInput\n            type=\"time\"\n            [disabled]=\"disabled\"\n            [ngModel]=\"time\"\n            (ngModelChange)=\"setValue($event)\"\n        />\n    </div>\n    <div class=\"icon\" (click)=\"showSelect()\">\n        <app-icon\n            [icon]=\"{\n                type: 'icon',\n                class: 'material-icons',\n                content: show_select ? 'arrow_drop_up' : 'arrow_drop_down'\n            }\"\n        ></app-icon>\n    </div>\n</div>\n<mat-form-field appearance=\"outline\" *ngIf=\"show_select\">\n    <mat-select #select [value]=\"time\" [disabled]=\"disabled\" (valueChange)=\"setValue($event)\">\n        <mat-option *ngFor=\"let option of time_options\" [value]=\"option.id\">\n            {{ option.name }}\n        </mat-option>\n    </mat-select>\n</mat-form-field>\n","import {\n    ChangeDetectorRef,\n    Component,\n    EventEmitter,\n    forwardRef,\n    Input,\n    OnInit,\n    Output,\n    ViewChild\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\nimport {\n    Observable,\n    of,\n    Subject\n} from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    distinctUntilChanged,\n    tap,\n    map,\n    switchMap,\n    finalize\n} from 'rxjs/operators';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport {\n    ApplicationService,\n    User,\n    UsersService\n} from '@mckinsey-converge/data-common';\nimport {\n    csvToJson,\n    downloadFile,\n    filterList,\n    matchToHighlight\n} from '@mckinsey-converge/base';\nimport { MatAutocompleteTrigger } from '@angular/material/autocomplete';\n\n@Component({\n    selector: 'a-user-list-field',\n    templateUrl: './user-list-field.component.html',\n    styleUrls: ['./user-list-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => UserListFieldComponent),\n            multi: true\n        }\n    ]\n})\nexport class UserListFieldComponent extends BaseDirective implements OnInit, ControlValueAccessor {\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Number of characters needed before a search will start */\n    @Input() public limit: number = 3;\n    /** Emitter for action to make a new user */\n    @Output('newUser') public new_user = new EventEmitter<void>();\n\n    /** User list to display */\n    public user_list: User[];\n    /** List of active selected users on the list */\n    public active_list: User[];\n    /** Whether user list is loading */\n    public loading: boolean;\n    /** String  */\n    public search_str: string;\n    /** List of users from an API search */\n    public search_results$: Observable<User[]>;\n    /** Subject holding the value of the search */\n    public search$ = new Subject<string>();\n\n    /** Form control on change handler */\n    private _onChange: (_: User[]) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: User[]) => void;\n\n    @ViewChild(MatAutocompleteTrigger, {read: MatAutocompleteTrigger}) inputAutoComplete: MatAutocompleteTrigger;\n\n    constructor(private _service: ApplicationService, private _users: UsersService,  private cdRef: ChangeDetectorRef) {\n        super();\n    }\n\n    ngOnInit() {\n        // Listen for input changes\n        this.search_results$ = this.search$.pipe(\n            debounceTime(100),\n            distinctUntilChanged(),\n            switchMap((query) => {\n                this.loading = true;\n                return query.length >= this.limit\n                    ? this._users.query({\n                        q: query.slice(0, Math.max(this.limit, 3)),\n                        cache: 60 * 1000\n                    })\n                    : Promise.resolve([]);\n            }),\n            catchError((_) => of([])),\n            map((list: User[]) => {\n                this.loading = false;\n                return filterList(this.search_str, list, ['name', 'email']);\n            })\n        );\n        // Process API results\n        this.subscription(\n            'search_results',\n            this.search_results$.subscribe((list) => {\n                this.user_list = list;\n                this.user_list.forEach((i: any) => {\n                    i.match_name = matchToHighlight(i.match_name);\n                    i.match_email = matchToHighlight(i.match_email);\n                    return i;\n                });\n                this.user_list.length ? this.inputAutoComplete.openPanel() : this.inputAutoComplete.closePanel();\n            })\n        );\n    }\n\n    /**\n     * Add user to the user list\n     * @param user\n     */\n    public addUser(user: User) {\n        /* istanbul ignore else */\n        if (!this.active_list) {\n            this.active_list = [];\n        }\n        const index = this.active_list.findIndex((a_user) => a_user.id === user.id);\n        /* istanbul ignore else */\n        if (index < 0) {\n            this.active_list = [...this.active_list, user];\n        }\n        this.setValue(this.active_list);\n        this.search_str = '';\n    }\n\n    /**\n     * Remove user from the user list\n     * @param user\n     */\n    public removeUser(user: User) {\n        this.active_list = this.active_list.filter((a_user) => a_user.id !== user.id);\n        this.setValue(this.active_list);\n    }\n\n    /**\n     * Load CSV file and populate the user list with the contents\n     * @param event File input field event\n     */\n    public addUsersFromFile(event) {\n        /* istanbul ignore else */\n        if (event.target) {\n            const file = event.target.files[0];\n            /* istanbul ignore else */\n            if (file) {\n                const reader = new FileReader();\n                reader.readAsText(file, 'UTF-8');\n                reader.addEventListener('load', (evt) => {\n                    this.processCsvData((evt.srcElement as any).result);\n                    event.target.value = '';\n                    this.cdRef.detectChanges();\n                });\n                reader.addEventListener('error', (_) =>\n                    this._service.notifyError('Error reading file.')\n                );\n            }\n        }\n    }\n\n    /**\n     * Process raw CSV data and save user data to attendee list\n     * @param data CSV data\n     */\n    private processCsvData(data: string) {\n        const list = csvToJson(data) || [];\n        const id = this._users.current.staff_code;\n        list.forEach((el) => {\n            el.name = el.name || `${el.first_name} ${el.last_name}`;\n            const display = (el.name || `${Math.floor(Math.random() * 9999_9999)}`)\n                .split(' ')\n                .join('_')\n                .toLowerCase();\n            /* istanbul ignore else */\n            if (!el.email) {\n                el.email = `${display}+${id}@guest.mckinsey.com`;\n            }\n            el.type = 'external';\n            el.external = !el.email.endsWith(\"@mckinsey.com\") && !el.email.endsWith(\"@external.mckinsey.com\");\n            this.addUser(new User(el));\n        });\n    }\n\n    /* istanbul ignore next */\n    /** Download template CSV file */\n    public downloadCSVTemplate() {\n        const template = `Organisation Name,First Name,Last Name,Email,Phone\\nFake Org,John,Smith,john.smith@example.com,01234567898`;\n        downloadFile('template.csv', template);\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: User[]): void {\n        this.active_list = new_value;\n        if (this._onChange) {\n            this._onChange(new_value);\n        }\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: User[]) {\n        this.active_list = value;\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: User[]) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: User[]) => void): void {\n        this._onTouch = fn;\n    }\n}\n","<div class=\"user-list-field\" form-field [attr.disabled]=\"disabled\">\n    <mat-form-field appearance=\"outline\">\n        <input\n            matInput\n            name=\"user-search\"\n            type=\"text\"\n            [(ngModel)]=\"search_str\"\n            (ngModelChange)=\"search$.next($event.trim())\"\n            [disabled]=\"disabled\"\n            placeholder=\"Search for user...\"\n            i18n-placeholder\n            [matAutocomplete]=\"auto\"\n            #trigger=\"matAutocompleteTrigger\"  \n        />\n        <div class=\"prefix\" matPrefix>\n            <app-icon\n                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'search' }\"\n            ></app-icon>\n        </div>\n        <div class=\"suffix\" matSuffix *ngIf=\"loading\">\n            <mat-spinner diameter=\"16\"></mat-spinner>\n        </div>\n    </mat-form-field>\n    <mat-autocomplete #auto=\"matAutocomplete\" (optionSelected)=\"addUser($event.option.value)\">\n        <mat-option *ngFor=\"let option of user_list\" [value]=\"option\">\n            <div class=\"name\">{{ option.name }}</div>\n            <div class=\"email\">{{ option.email }}</div>\n        </mat-option>\n    </mat-autocomplete>\n    <div class=\"actions\">\n        <button type=\"button\" name=\"new-contact\" matRipple (click)=\"new_user.emit()\" i18n=\"Add new external attendee\">\n            Add External\n        </button>\n        <button type=\"button\" name=\"upload-csv\" matRipple i18n=\"Upload attendee list from CSV file\">\n            Upload CSV\n            <input type=\"file\" (change)=\"addUsersFromFile($event)\" />\n        </button>\n        <button type=\"button\" name=\"download-template\" matRipple (click)=\"downloadCSVTemplate()\" i18n=\"Download template CSV file\">\n            CSV Template\n        </button>\n    </div>\n    <div class=\"user-list\">\n        <mat-chip-list\n            aria-label=\"User List\"\n            *ngIf=\"active_list && active_list.length; else empty_state\"\n        >\n            <mat-chip\n                *ngFor=\"let user of active_list\"\n                [id]=\"user.email\"\n                [color]=\"user.external ? 'accent' : 'primary'\"\n                [removable]=\"true\"\n                (removed)=\"removeUser(user)\"\n            >\n                {{ user.name }}\n                <app-icon\n                    matChipRemove\n                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"\n                ></app-icon>\n            </mat-chip>\n        </mat-chip-list>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div i18n=\"Attendee empty state\">No attendees</div>\n</ng-template>\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnInit,\n    ViewChild\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\nimport {\n    Observable,\n    of,\n    Subject\n} from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    distinctUntilChanged,\n    map,\n    switchMap\n} from 'rxjs/operators';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport {\n    User,\n    UsersService\n} from '@mckinsey-converge/data-common';\nimport {\n    filterList,\n    matchToHighlight\n} from '@mckinsey-converge/base';\nimport { MatAutocompleteTrigger } from '@angular/material/autocomplete';\n\n@Component({\n    selector: 'a-user-search-field',\n    templateUrl: './user-search-field.component.html',\n    styleUrls: ['./user-search-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => UserSearchFieldComponent),\n            multi: true\n        }\n    ]\n})\nexport class UserSearchFieldComponent extends BaseDirective implements OnInit, ControlValueAccessor {\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Limit available options to these */\n    @Input() public options: User[];\n    /** Currently selected user */\n    public active_user: User;\n    /** User list to display */\n    public user_list: User[];\n    /** Whether user list is loading */\n    public loading: boolean;\n    /** Current display value of the search input field  */\n    public search_str: string;\n    /** List of users from an API search */\n    public search_results$: Observable<User[]>;\n    /** Subject holding the value of the search */\n    public search$ = new Subject<string>();\n\n    /** Form control on change handler */\n    private _onChange: (_: User) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: User) => void;\n    @ViewChild(MatAutocompleteTrigger, {read: MatAutocompleteTrigger}) inputAutoComplete: MatAutocompleteTrigger;\n    \n    constructor(private _users: UsersService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n\n        // Listen for input changes\n        this.search_results$ = this.search$.pipe(\n            debounceTime(400),\n            distinctUntilChanged(),\n            switchMap(query => {\n                this.loading = true;\n                return this.options && this.options.length > 0\n                    ? Promise.resolve(this.options)\n                    : query.length >= 3\n                        ? (this._users.query({ q: query, cache: 60 * 1000 }) as Promise<User[]>)\n                        : Promise.resolve([]);\n            }),\n            catchError((err) => of([])),\n            map((list: User[]) => {\n                this.loading = false;\n                return filterList(this.search_str, list, ['name', 'email']);\n            })\n        );\n        // Process API results\n        this.subscription('search_results', this.search_results$.subscribe(list => {\n            this.user_list = list;\n            this.user_list.forEach((i: any) => {\n                i.match_name = matchToHighlight(i.match_name);\n                i.match_email = matchToHighlight(i.match_email);\n                return i;\n            });\n            this.user_list.length ? this.inputAutoComplete.openPanel() : this.inputAutoComplete.closePanel();\n        }));\n    }\n\n    /**\n     * Reset the search string back to the name of the active user\n     */\n    public resetSearchString() {\n        if (this.active_user) {\n            this.search_str = this.active_user.name;\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: User): void {\n        this.active_user = new_value;\n        if (this._onChange) {\n            this._onChange(new_value);\n        }\n        this.resetSearchString();\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: User) {\n        this.active_user = value;\n        this.resetSearchString();\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: User) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: User) => void): void {\n        this._onTouch = fn;\n    }\n}\n","<div class=\"user-search-field\" form-field>\n    <mat-form-field appearance=\"outline\">\n        <input\n            matInput\n            name=\"user-search\"\n            [(ngModel)]=\"search_str\"\n            (ngModelChange)=\"search$.next($event)\"\n            [disabled]=\"disabled\"\n            placeholder=\"Search for user...\"\n            i18n-placeholder\n            [matAutocomplete]=\"auto\"\n            (blur)=\"resetSearchString()\"\n            #trigger=\"matAutocompleteTrigger\"  \n        />\n        <div class=\"prefix\" matPrefix>\n            <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'search' }\"></app-icon>\n        </div>\n        <div class=\"suffix\" matSuffix *ngIf=\"loading\">\n            <mat-spinner diameter=\"16\"></mat-spinner>\n        </div>\n    </mat-form-field>\n    <mat-autocomplete #auto=\"matAutocomplete\" (optionSelected)=\"setValue($event.option.value)\">\n        <mat-option *ngFor=\"let option of user_list\" [value]=\"option\">\n            <div class=\"name\">{{ option.name }}</div>\n            <div class=\"email\">{{ option.email }}</div>\n        </mat-option>\n    </mat-autocomplete>\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { NavigationEnd, Router } from '@angular/router';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\n\n@Component({\n    selector: 'feedback',\n    templateUrl: './feedback.component.html',\n    styleUrls: ['./feedback.component.scss'],\n})\nexport class FeedbackComponent extends BaseDirective implements OnInit {\n    /** Name of the currently active page */\n    public current_page: string;\n\n    constructor(private _router: Router) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.timeout('Getting Title', () => this.updateRoute(document.title), 1000);\n        this._router.events.subscribe((event: NavigationEnd) => {\n            /* istanbul ignore else */\n            if (event instanceof NavigationEnd) {\n                this.timeout('Getting Title', () => this.updateRoute(document.title));\n            }\n        });\n    }\n\n    public updateRoute(location) {\n        location = location.substr(0, location.indexOf(' |'));\n        this.current_page = location;\n    }\n}\n","<a [href]=\"'mailto:converge_feedback@mckinsey.com?subject=Feedback for page: ' + current_page\">\n    <div class=\"feedback-button\">\n        <span class=\"text\" i18n>Feedback</span>\n        <span class=\"icon\">\n            <app-icon [icon]=\"{class:'material-icons', content: 'feedback'}\"></app-icon>\n        </span>\n    </div>\n</a>\n","import {\n    Component,\n    Input\n} from '@angular/core';\nimport { ApplicationIcon } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\n@Component({\n    selector: 'app-icon',\n    templateUrl: './icon.component.html',\n    styleUrls: ['./icon.component.scss']\n})\nexport class IconComponent extends BaseDirective {\n    @Input() public icon: ApplicationIcon;\n}\n","<div class=\"app-icon\" *ngIf=\"icon\">\n    <i *ngIf=\"icon.type !== 'img'\" [class]=\"icon.class\">{{ icon.content }}</i>\n    <img *ngIf=\"icon.type === 'img'\" [src]=\"icon.src | safe:'resource'\" />\n</div>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport {\n    ActionFieldComponent,\n    CounterComponent,\n    DateFieldComponent,\n    DurationFieldComponent,\n    TimeFieldComponent,\n    UserListFieldComponent,\n    UserSearchFieldComponent\n} from './custom-fields';\nimport { IconComponent } from './icon/icon.component';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatRippleModule } from '@angular/material/core';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\nimport { ACA_PIPES_MODULE } from '@acaprojects/ngx-pipes';\nimport {\n    FormsModule,\n    ReactiveFormsModule\n} from '@angular/forms';\nimport { FeedbackComponent } from './feedback/feedback.component';\nimport { ActionIconComponent } from './action-icon/action-icon.component';\nimport { PopoutMenuComponent } from './popout-menu/popout-menu.component';\nimport { SearchbarComponent } from './searchbar/searchbar.component';\nimport { UserAvatarComponent } from './user-avatar/user-avatar.component';\nimport { CateringMenuItemComponent } from './bookings/catering/item/item.component';\nimport { PackageOptionsModalComponent } from './bookings/catering/package-options-modal/package-options-modal.component';\nimport { BaseModule } from '@mckinsey-converge/base';\nimport { UiModule } from '@mckinsey-converge/ui';\n\nconst DECLARATIONS = [\n    ActionFieldComponent,\n    IconComponent,\n    CounterComponent,\n    DateFieldComponent,\n    DurationFieldComponent,\n    TimeFieldComponent,\n    UserSearchFieldComponent,\n    UserListFieldComponent,\n    FeedbackComponent,\n    ActionIconComponent,\n    PopoutMenuComponent,\n    SearchbarComponent,\n    UserAvatarComponent,\n    CateringMenuItemComponent,\n    PackageOptionsModalComponent\n];\n\nconst MATERIAL_MODULES: any[] = [\n    MatButtonModule,\n    MatSnackBarModule,\n    MatDialogModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatProgressSpinnerModule,\n    MatProgressBarModule,\n    MatAutocompleteModule,\n    MatSelectModule,\n    MatChipsModule,\n    MatRippleModule,\n    MatMenuModule,\n    MatCheckboxModule,\n    MatTooltipModule,\n    MatRadioModule,\n    MatTabsModule,\n    MatSlideToggleModule\n];\n\n@NgModule({\n    imports: [\n        CommonModule,\n        ACA_PIPES_MODULE,\n        FormsModule,\n        ReactiveFormsModule,\n        ...MATERIAL_MODULES,\n        BaseModule,\n        UiModule\n    ],\n    declarations: [\n        ...DECLARATIONS\n    ],\n    exports: [\n        ACA_PIPES_MODULE,\n        ...DECLARATIONS,\n        ...MATERIAL_MODULES,\n        BaseModule,\n    ]\n})\nexport class LegacyUiModule {\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output\n} from '@angular/core';\nimport { ApplicationIcon } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\nexport interface PopoutAction extends ApplicationIcon {\n    /** ID of the action */\n    id: string;\n}\n\n@Component({\n    selector: 'a-popout-menu',\n    templateUrl: './popout-menu.component.html',\n    styleUrls: ['./popout-menu.component.scss']\n})\nexport class PopoutMenuComponent extends BaseDirective {\n    /** List of available actions */\n    @Input() public actions: PopoutAction[] = [];\n    /** Emitter for user actions */\n    @Output() public action = new EventEmitter<string>();\n    /** Whether actions should show */\n    public show: boolean;\n\n    public close() {\n        this.timeout('close', () => {\n            this.show = false;\n        });\n    }\n}\n","<button\n    mat-icon-button\n    [class.small]=\"true\"\n    name=\"action\"\n    *ngFor=\"let item of actions; let i = index\"\n    [style.top]=\"show ? (-110 * i - 60) + '%' : ''\"\n    (click)=\"action.emit(item.id); show = false\"\n>\n    <app-icon [icon]=\"item\"></app-icon>\n</button>\n<button mat-icon-button name=\"menu\" [class.show]=\"show\" (click)=\"show = !show\" (window:click)=\"show ? close() : ''\">\n    <app-icon [icon]=\"{ class: 'material-icons', content: show ? 'add' : 'more_vert' }\"></app-icon>\n</button>\n","import { Component, OnInit, Input, EventEmitter, Output, ViewChild, ElementRef, SimpleChanges, OnChanges } from '@angular/core';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\n@Component({\n    selector: 'a-searchbar',\n    templateUrl: './searchbar.component.html',\n    styleUrls: ['./searchbar.component.scss']\n})\nexport class SearchbarComponent extends BaseDirective implements OnChanges {\n    /** Current contents of the searchbar input */\n    @Input('value') public value: string;\n    /** Current contents of the searchbar input */\n    @Input() public placeholder: string;\n    /** Whether external changes are being processed */\n    @Input() public loading: boolean;\n    /** Whether external changes are being processed */\n    @Input() public autofocus: boolean;\n    /** Emitter for changes to the searchbar value */\n    @Output() public valueChange = new EventEmitter<string>();\n    /** Input field reference */\n    @ViewChild('input', { static: true }) private input_field: ElementRef<HTMLInputElement>;\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.autofocus && this.autofocus) {\n            this.focusField()\n        }\n    }\n\n    public focusField() {\n        /* istanbul ignore else */\n        if (this.input_field && this.input_field.nativeElement) {\n            this.input_field.nativeElement.focus();\n        }\n    }\n}\n","<div class=\"searchbar\" tabindex=\"0\" (focus)=\"focusField()\" (click)=\"focusField()\">\n    <div class=\"prefix\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'search' }\"></app-icon>\n    </div>\n    <div class=\"input\">\n        <input #input\n            type=\"text\"\n            [(ngModel)]=\"value\"\n            (ngModelChange)=\"valueChange.emit($event)\"\n            [placeholder]=\"placeholder || 'Search...'\"\n            i18n-placeholder\n        />\n    </div>\n    <div class=\"suffix\" *ngIf=\"loading\">\n        <mat-spinner diameter=\"32\"></mat-spinner>\n    </div>\n</div>\n","import { Component, Input } from '@angular/core';\nimport { User } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-user-avatar',\n    templateUrl: './user-avatar.component.html',\n    styleUrls: ['./user-avatar.component.scss']\n})\nexport class UserAvatarComponent {\n    /** User to display avatar for */\n    @Input() public user: User;\n\n    public get initials(): string {\n        if (!this.user) {\n            return 'NA';\n        }\n        const parts = this.user.name.split(' ');\n        return parts.length > 1\n            ? `${parts[0][0]}${parts[parts.length - 1][0]}`\n            : this.user.name.slice(0, 2);\n    }\n}\n","<div class=\"user-avatar\" *ngIf=\"user\" [attr.user-id]=\"user.id\">\n    <div class=\"initials\" *ngIf=\"!user.image; else image_state\">{{ initials }}</div>\n</div>\n<ng-template #image_state>\n    <img [src]=\"user.image | safe: 'resource'\" />\n</ng-template>\n","export * from './lib/loading.actions'\nexport * from './lib/loading.model'\nexport * from './lib/loading.effects'\nexport * from './lib/loading.selectors'\nexport * from '../testing'\n","import {\n    createAction,\n    createSelector,\n    on,\n    On,\n    props\n} from '@ngrx/store';\nimport {\n    LoadingModel,\n    wrapLoading\n} from './loading.model';\nimport {\n    selectIsLoading,\n    selectOptionalError,\n    selectOptionalSuccess,\n    selectSuccess\n} from './loading.selectors';\nimport { MemoizedSelector } from '@ngrx/store/src/selector';\nimport {\n    ActionCreator,\n    NotAllowedCheck,\n    TypedAction\n} from '@ngrx/store/src/models';\nimport { HashMap } from '@mckinsey-converge/base';\n\nexport interface Payload<T> {\n    payload: T\n}\n\nexport type LoadingAction<T> = T & TypedAction<string>\nexport type LoadingActionCreator<T extends null | undefined | object> = T extends null | undefined ?\n    ActionCreator<string, () => TypedAction<string>>\n    : ActionCreator<string, (props: T & NotAllowedCheck<T>) => LoadingAction<T>>\n\ntype ClearAction = ActionCreator<string, () => TypedAction<string>>\n\ninterface Selectors<TState, TRequest, TSuccess> {\n    success: MemoizedSelector<TState, TSuccess>\n    optionalSuccess: MemoizedSelector<TState, TSuccess | undefined>\n    error: MemoizedSelector<TState, Error | undefined>\n    loading: MemoizedSelector<TState, boolean>\n    model: (TState) => LoadingModel<TSuccess>\n}\n\nexport interface LoadingActionObject<TState, TRequest extends object | undefined, TSuccess> {\n    request: LoadingActionCreator<TRequest>\n    success: LoadingActionCreator<Payload<TSuccess>>\n    error: LoadingActionCreator<Payload<Error>>\n    clear: ClearAction,\n    ons: On<TState>[],\n    selectors: Selectors<TState, TRequest, TSuccess>\n}\n\n/**\n * Creates a {@link LoadingActionObject} that contains a set of ActionCreators\n * for request, success, error, loading, and clear data. Also, it contains\n * the necessary On reducers and selectors in order to properly connect them in\n * a standardized way to data in the application.\n *\n * `TState` is the type of data on your reducer, not global store.\n * `TRequest` is an object type to use in request methods.\n * `TSuccess` is the object type of the T parameter on `LoadingModel`.\n *\n * This assumes you have state represented by:\n * ```typescript\n * interface SomeState {\n *   stateKey: LoadingModel<TSuccess>\n * }\n * ```\n *\n * To dispatch an action:\n * ```typescript\n *\n * // request parameters depend on the object type used as second type parameter\n * // in createLoadingAction\n * this.store.dispatch(someLoadingAction.request())\n *\n * // action created with createLoadingAction<SomeState, { name: string, age: int }>\n * this.store.dispatch(someLoadingAction.request({\n *   name: 'Andrew G',\n *   age: 24\n * }))\n *\n * ```\n *\n * The generated selectors only select data from its fractured state, not the global\n * store. In order to use them, make sure you {@link select} the global state\n * before using them:\n *\n * ```typescript\n *\n * this.store.pipe(\n *   select(selectSomeState),\n *   select(someLoadingAction.selectors.success)\n * ).subscribe(next => {\n *\n * })\n *\n * ```\n *\n * @param actionPrefix - Prefixes actions to uniquely identify them.\n * @param stateKey -  The field within the reducer state to set data on.\n */\nexport const createLoadingAction = <TState, TSuccess extends object = {}, TRequest extends object | undefined = undefined>(\n    actionPrefix: string,\n    stateKey: keyof TState\n): LoadingActionObject<TState, TRequest, TSuccess> => {\n    const buildAction = (postfix: string) => `[${actionPrefix}] ${postfix}`;\n    // @ts-ignore\n    const request = createAction(buildAction('request'), props<TRequest>());\n    const success = createAction(buildAction('success'), props<Payload<TSuccess>>());\n    const error = createAction(buildAction('error'), props<Payload<Error>>());\n    const clear = createAction(buildAction('clear'));\n    const ons: On<TState>[] = [\n        on(request, (state: TState & HashMap<LoadingModel<TSuccess>>, action: LoadingAction<TRequest>) =>\n            ({\n                ...state,\n                [stateKey]: wrapLoading<TSuccess>(state[stateKey]).loading()\n            })),\n        on(success, (state: TState & HashMap<LoadingModel<TSuccess>>, action: LoadingAction<Payload<TSuccess>>) => ({\n            ...state,\n            [stateKey]: LoadingModel.success(action.payload)\n        })),\n        // some reason specifying state like in success and request does not work.\n        on(error, (state: any, action: LoadingAction<Payload<Error>>) => ({\n            ...state,\n            [stateKey]: LoadingModel.error<TSuccess>(action.payload)\n        })),\n        on(clear, () => ({\n            ...this.state,\n            [stateKey]: LoadingModel.empty()\n        }))\n    ];\n    const selectData = (state: TState) => {\n        if (!state) {\n            console.warn('[LoadingActions] State is empty for key', stateKey);\n        }\n        return wrapLoading<TSuccess>(state?.[stateKey] as unknown as LoadingModel<TSuccess>);\n    };\n    const selSuccess = createSelector<TState, LoadingModel<TSuccess>, TSuccess>(\n        selectData,\n        selectSuccess\n    );\n    const selOptionalSuccess = createSelector(\n        selectData,\n        selectOptionalSuccess\n    );\n    const selError = createSelector(\n        selectData,\n        selectOptionalError\n    );\n    const selLoading = createSelector(\n        selectData,\n        selectIsLoading\n    );\n    return {\n        request,\n        success,\n        error,\n        clear,\n        ons,\n        selectors: {\n            success: selSuccess,\n            optionalSuccess: selOptionalSuccess,\n            error: selError,\n            loading: selLoading,\n            model: selectData\n        }\n    };\n};\n","import {\n  Actions,\n  ofType\n} from '@ngrx/effects';\n\nimport { \n  LoadingAction,\n  LoadingActionObject\n} from '../../../loading/src/lib/loading.actions';\n\nimport {\n  catchError,\n  flatMap,\n  map\n} from 'rxjs/operators';\nimport {\n  Observable,\n  of\n} from 'rxjs';\nimport { TypedAction } from '@ngrx/store/src/models';\n\n/**\n * This creates an effect to use in Effects classes. This coordinates a simple\n * success and error payload effect.\n * @param actions - The actions object\n * @param actionObject - The created createLoadingAction object.\n * @param caller - Define what API method or asynchronous operation is needed to\n * run this. Return TSuccess.\n */\nexport const createLoadingEffect = <TState, TSuccess = {}, TRequest extends object | undefined = {}>(\n  actions: Actions, actionObject: LoadingActionObject<TState, TRequest, TSuccess>,\n  caller: (action: LoadingAction<TRequest>) => Promise<TSuccess>): Observable<TypedAction<string>> => actions.pipe(\n  ofType(actionObject.request),\n  flatMap((action) => caller(action as LoadingAction<TRequest>)),\n  map((response: TSuccess) => actionObject.success({ payload: response })),\n  catchError(err => {\n    return of(actionObject.error({ payload: err }));\n  })\n);\n","/* eslint-disable no-underscore-dangle,no-useless-constructor */\n/**\n * Wraps around the typical data objects we write for success, error, loading, and empty state. This convenience\n * wrapper consolidates all of that logic into a handy wrapper.\n */\nexport class LoadingModel<T = {}> {\n    static empty = <T>() => new LoadingModel<T>(false, false, false, undefined);\n\n    static success = <T>(success?: T): LoadingModel<T> =>\n        new LoadingModel(false, false, true, success);\n\n    static error = <T>(error?: Error, optionalSuccess?: T): LoadingModel<T> =>\n        new LoadingModel<T>(false, true, false, optionalSuccess, error);\n\n    /**\n     * Mutates the model with a success state, preserving other state fields.\n     * @param success - override success state.\n     */\n    mutate = <T2 = T>(\n        success: T2 | null) => new LoadingModel(\n        this.isLoading,\n        this.hasError,\n        !!success,\n        !success ? undefined : success\n    );\n\n    loading = (success: T | null = this.success) =>\n        new LoadingModel(\n            true,\n            false,\n            !!success && this.hasSuccess,\n            !success ? undefined : success\n        );\n\n    public get success(): T {\n        return this._success as T;\n    }\n\n    public get optionalSuccess(): T | undefined {\n        return this._success;\n    }\n\n    constructor(\n        public isLoading: boolean,\n        private hasError: boolean,\n        private hasSuccess: boolean,\n        private _success?: T,\n        public error?: Error\n    ) {\n    }\n\n    isEmpty = () => !this.isSuccess() && !this.isError();\n\n    hasLoaded = () => !this.isEmpty() && !this.isLoading;\n\n    isSuccess = () => this.hasSuccess;\n\n    isError = () => this.hasError;\n\n    shouldLoad = () => !this.isSuccess() && !this.isLoading;\n\n    public toString = () =>\n        `Loading: ${this.isLoading}, Success: ${this.hasSuccess}:**${this._success}**, ` +\n        `Error: ${this.hasError}:${this.error}`;\n}\n\n/**\n * Wraps an object that conforms to LoadingModel to restore object loss from\n * hydrating state during development.\n */\nexport const wrapLoading = <T extends any>(loading: any): LoadingModel<T> => {\n    if (loading instanceof LoadingModel) {\n        return loading;\n    } else {\n        if (!loading) {\n            return LoadingModel.empty();\n        } else {\n            return new LoadingModel(\n                loading.isLoading || false,\n                loading.hasError || false,\n                loading.hasSuccess || false,\n                loading._success,\n                loading.error\n            );\n        }\n    }\n};\n","import { LoadingModel, wrapLoading } from './loading.model';\n\nexport const selectSuccess = <T>(state: LoadingModel<T>) =>\n  wrapLoading<T>(state).success;\nexport const selectOptionalSuccess = <T>(state: LoadingModel<T>) =>\n  wrapLoading<T>(state).optionalSuccess;\nexport const selectIsLoading = <T>(state: LoadingModel<T>) =>\n  wrapLoading<T>(state).isLoading;\nexport const selectIsSuccess = <T>(state: LoadingModel<T>) =>\n  wrapLoading<T>(state).isSuccess();\nexport const selectOptionalError = (state: LoadingModel<any>) =>\n  wrapLoading<any>(state).error;\nexport const selectIsError = <T>(state: LoadingModel<T>) =>\n  wrapLoading<T>(state).isError();\nexport const selectHasLoaded = <T>(state: LoadingModel<T>) =>\n  wrapLoading<T>(state).hasLoaded();\nexport const selectIsEmpty = <T>(state: LoadingModel<T>) =>\n  wrapLoading<T>(state).isEmpty();\n\n","import {\n  Observable,\n  Subject\n} from 'rxjs';\nimport { Action } from '@ngrx/store';\nimport { Actions } from '@ngrx/effects';\nimport { TypedAction } from '@ngrx/store/src/models';\nimport { take } from 'rxjs/operators';\nimport {\n  LoadingActionObject\n} from '../src/lib/loading.actions';\n\nexport const generateMockActions = () => {\n  const dispatcher = new Subject<Action>();\n  return {\n    dispatcher,\n    actions: new Actions(dispatcher)\n  };\n};\n\n/**\n * Simple verifier that checks if the request action results in a success returned.\n */\nexport const verifyActionSuccess = <TState, TSuccess, TRequest extends object | undefined = {}>(\n  action: LoadingActionObject<TState, TRequest, TSuccess>,\n  effect: Observable<TypedAction<string>>,\n  dispatcher: Subject<Action>,\n  options: {\n    data: TSuccess,\n    payload?: TRequest,\n  }) => {\n  let result: TypedAction<string>;\n  effect\n    .pipe(take(1))\n    .subscribe(next => {\n      result = next;\n    });\n  // payload has type issues, just ignore them since we specify TRequest as type param already.\n  dispatcher.next(action.request((options.payload || {}) as never));\n\n  expect(result).toBeDefined();\n  expect(result).toStrictEqual(action.success({ payload: options.data }));\n};\n\n/**\n * Simple verifier that checks if the request action results in a failure returned.\n */\nexport const verifyActionError = <TState, TRequest extends object, TSuccess>(\n  action: LoadingActionObject<TState, TRequest, TSuccess>,\n  effect: Observable<TypedAction<string>>,\n  dispatcher: Subject<Action>,\n  options: {\n    error: Error,\n    payload?: TRequest\n  }) => {\n  let result: TypedAction<string>;\n  effect\n    .pipe(take(1))\n    .subscribe(next => {\n      result = next;\n    });\n  // payload has type issues, just ignore them since we specify TRequest as type param already.\n  dispatcher.next(action.request((options.payload || {}) as never));\n\n  expect(result).toBeDefined();\n  expect(result).toStrictEqual(action.error({ payload: options.error }));\n};\n","export * from './effects.testing'\n","import { createLoadingAction } from '../../../loading/src/lib/loading.actions';\nimport { Space } from '../../../data-common/src/lib/spaces/space.class';\nimport {\n    RoomQueryOptions,\n    RoomState,\n    RoomStoreState\n} from './rooms.types';\nimport {\n    createAction,\n    createSelector,\n    props\n} from '@ngrx/store';\n\nexport const roomStateSelector = (state: RoomStoreState) => state.rooms;\n\nexport const loadRoomsWithQuery = createAction('[Rooms] Load Rooms with query', props<RoomQueryOptions>());\n\nexport const loadRoomsForResults = createLoadingAction<RoomState, Space[], RoomQueryOptions>('Rooms', 'query');\n\nexport const loadRoomsForResultsMap = createLoadingAction<RoomState, Space[], RoomQueryOptions>('Rooms for map', 'query');\n\n\nexport const loadLaterThatDayResults = createLoadingAction<RoomState, Space[], RoomQueryOptions>('Later Rooms', 'later');\n\nexport const loadNextDayResults = createLoadingAction<RoomState, Space[], RoomQueryOptions>('Next Day Rooms', 'next');\n\nexport const loadByIdResults = createLoadingAction<RoomState, Space[], RoomQueryOptions>('By Id Rooms', 'byid');\n\nexport const selectRoomResultsSuccess = createSelector(roomStateSelector,\n    loadRoomsForResults.selectors.optionalSuccess);\n\nexport const loadDiffSizeResults = createLoadingAction<RoomState, Space[], RoomQueryOptions>('Different Size Rooms', 'size');\n","export * from './lib/storage.module';\nexport * from './lib/localstorage.wrapper'\n","export class LocalStorageWrapper {\n\n  constructor(private prefix: string) {\n  }\n\n  protected setValue(key: string, value: string) {\n    localStorage.setItem(`${this.prefix}.${key}`, value);\n  }\n\n  protected getValue<T>(key: string): string | null {\n    return localStorage.getItem(`${this.prefix}.${key}`) as string | null;\n  }\n\n  protected removeValue(key: string) {\n    localStorage.removeItem(`${this.prefix}.${key}`);\n  }\n}\n","import { NgModule } from '@angular/core';\n\n@NgModule({\n  imports: []\n})\nexport class StorageModule {\n}\n","export * from './lib/ui.module';\nexport * from './lib/types';\nexport * from './lib/base-template.component';\nexport * from './lib/recurrence-pattern-form/recurrence-pattern-form.component';\nexport * from './lib/recurrence-booking-form/recurrence-booking-form.component';\nexport * from './lib/conflicts-modal/conflicts-modal.component'\nexport * from './lib/override-changes-modal/override-changes-modal.component'\nexport * from './lib/date-tz-calendar-widget/date-tz-calendar-widget.component';\nexport * from './lib/date-tz-date-picker/date-tz-date-picker.component';\nexport * from './lib/date-tz-duration-field/date-tz-duration-field.component';\nexport * from './lib/date-tz-time-field/date-tz-time-field.component';\nexport * from './lib/aca-date-picker/aca-date-picker.component';\nexport * from './lib/conflict-alert-modal/conflict-alert-modal.component';","import { Component, OnInit, Input, Output, OnChanges, SimpleChanges, forwardRef, EventEmitter } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\nexport interface IDatePickerOptions {\n    /** Unix timestamp with millisecond. First selectable date */\n    from?: number;\n    /** Unix timestamp with millisecond. Last selectable date */\n    to?: number;\n    /** Luxon format string for formatting days of the week. Defaults to `DDD` */\n    day_format?: string;\n    /** Luxon format string for formatting active month. Defaults to `MMMM yyyy` */\n    month_format?: string;\n}\n\ninterface IDateBlock {\n    /** Timestamp value of the date */\n    value: number;\n    /** Day of the month to display */\n    display: string;\n    /** Whether block is the selected date */\n    active: boolean;\n    /** Whether block not selectable */\n    disabled: boolean;\n    /** Whether block outside the active month */\n    non_month: boolean;\n    /** Whether the block is today */\n    today: boolean;\n    /** Number of events on this block */\n    count?: number;\n}\n\n@Component({\n    selector: 'aca-date-picker',\n    templateUrl: './aca-date-picker.component.html',\n    styleUrls: ['./aca-date-picker.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => AcaDatePickerComponent),\n            multi: true\n        }\n    ]\n})\nexport class AcaDatePickerComponent implements OnInit, OnChanges, ControlValueAccessor {\n    /** CSS class to add to the root element of the component */\n    @Input() public klass = 'default';\n    /** Counters of the events on given dates. Key format is `yyyy-MM-dd` */\n    @Input() public counters: { [date: string]: number };\n    /** Settings for the date picker component */\n    @Input() public options: IDatePickerOptions;\n    /** Offset of the display month from the current month */\n    @Output() public month = new EventEmitter<number>();\n    /** Display the last selected day as active */\n    @Input() public show_last_selection?: boolean = true\n\n    public date: number = DateNow(new Date()).ms;\n\n    // R--- this is the date picker that needs to be TZ aware\n    /** Offset of the month displayed from the current month */\n    public offset = 0;\n    /** Minimum offset for changing the month */\n    public min_offset = -999999;\n    /** Maximum offset for changing the month */\n    public max_offset = 999999;\n    /** Blocks representing the rendering details of the display days of the month */\n    public date_list: IDateBlock[] = [];\n    /** Name of the actively displayed month */\n    public month_name = DateNow(new Date()).formatDate('MMMM yyyy');\n    /** Name of the days of the week to display */\n    public days_of_week = [];\n    /** First selectable date */\n    private from: DateTZ;\n    /** Last selectable date */\n    private to: DateTZ;\n    /** Luxon format string for formatting days of the week. Defaults to `dd` */\n    private day_format = 'EEE';\n    /** Luxon format string for formatting active month. Defaults to `MMMM yyyy` */\n    private month_format = 'MMMM yyyy';\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n    /** ID of the timer used for changing the month */\n    private _change_timer: number;\n\n    public ngOnInit(): void {\n        this.generateMonth();\n        this.generateDaysOfTheWeek();\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.options) {\n            this.updateOptions();\n        }\n        if (changes.counters) {\n            this.generateMonth();\n        }\n    }\n\n    /** Change date using the given block */\n    public setDate(item: IDateBlock) {\n        this.date = item.value;\n        if (this._onChange) {\n            this._onChange(this.date);\n        }\n        this.generateMonth();\n    }\n\n    /**\n     * Update offset to show the selected date\n     */\n    public updateDate(): void {\n        \n        if (!this.date) {\n            return;\n        }\n        const now = DateNow(new Date()).startOfValue('month');\n        const date_ = new DateTZ({date: this.date})\n        const date = date_.startOfValue('month');\n        if (date.valid) {\n            const difference = date.dateDiff(now, 'months', 'months');\n            if (this.offset !== difference) {\n                this.offset = difference;\n                this.month.emit(this.offset);\n            }\n            this.generateMonth();\n        }\n    }\n\n    /**\n     * Update local properties based off changes to settings\n     */\n    public updateOptions(): void {\n        if (this.options) {\n            // Setup from date\n            if (this.options.from) {\n                const date_ = new DateTZ({date: this.options.from})\n                this.from = date_.startOfValue('day');;\n                const today = DateNow(new Date()).startOfValue('month');\n                const date = this.from.startOfValue('month');\n                this.min_offset = date.dateDiff(today, 'months', 'months');\n            } else if (this.from) {\n                this.from = null;\n                this.min_offset = -999999;\n            }\n            // Setup to date\n            if (this.options.to) {\n                const date_ = new DateTZ({date: this.options.to})\n                this.to = date_.startOfValue('day');\n                const today = DateNow(new Date()).startOfValue('month');\n                const date = this.to.startOfValue('month');\n                this.max_offset = date.dateDiff(today, 'months', 'months');\n            } else if (this.to) {\n                this.to = null;\n                this.max_offset = 999999;\n            }\n            if (this.options.month_format) {\n                this.month_format = this.options.month_format || 'MMMM yyyy';\n            }\n            if (this.options.day_format) {\n                this.day_format = this.options.day_format || 'EEE';\n                this.generateDaysOfTheWeek();\n            }\n            // Update date blocks\n            this.generateMonth();\n        }\n    }\n\n    /**\n     * Generate the display blocks for the days of the active month\n     */\n    private generateMonth(): void {\n        if (!this.date) {\n            return;\n        }\n        const date = DateNow(new Date()).addValue({ months : this.offset });\n        const active = new DateTZ({date: this.date});\n        let start = date.setValue({ day: 1 }).setValue({ weekday: 7 }).subtractValue({ weeks: 1 });\n        const end_ = new DateTZ({date: start.ms})\n        const end = end_.addValue({ weeks: 1 }).endOfValue('month').addValue({ days: 2 }).endOfValue('week');\n        this.date_list = [];\n        while (start.isBeforeDate(end) || start.isSameDate(end, 'day')) {\n            this.date_list.push({\n                value: start.ms,\n                display: start.formatDate('d'),\n                active:  this.show_last_selection && active.isSameDate(start, 'day'),\n                non_month: !date.isSameDate(start, 'month'),\n                count: this.counters ? this.counters[start.formatDate('yyyy-MM-dd')] || 0 : 0,\n                disabled: (this.from ? start.isBeforeDate(this.from, 'day') : false) || (this.to ? start.isAfterDate(this.to, 'day') : false),\n                today: DateNow(new Date()).isSameDate(start, 'day')\n            });\n            start = start.addValue({ days : 1 });\n        }\n        this.month_name = date.formatDate(this.month_format);\n    }\n\n    /**\n     * Generate this weekdays to display in the header of the calendar\n     */\n    private generateDaysOfTheWeek() {\n        let date = DateNow(new Date()).startOfValue('week');\n        this.days_of_week = [];\n        for (let i = 0; i < 7; i++) {\n            this.days_of_week.push(date.formatDate(this.day_format));\n            date = date.addValue({ days : 1 });\n        }\n    }\n\n    /**\n     * Changes the month offset by the given value.\n     * Does nothing if the new month is not available to be selected\n     * @param value Number of months to change the offset by\n     */\n    public changeMonth(value: number): void {\n        if (this._change_timer) {\n            clearTimeout(this._change_timer);\n        }\n        this._change_timer = <any>setTimeout(() => {\n            const new_offset = this.offset + value;\n            const now = DateNow(new Date())\n            const date = now.addValue({ months : new_offset, days: now.dateMonth === 2 ? 2 : 0 }); //add 2 days if month is february to avoid calc errors\n            if (this.from && date.isBeforeDate(this.from, 'month')) { return; }\n            if (this.to && date.isAfterDate(this.to, 'month')) { return; }\n            this.offset = new_offset;\n            this.month.emit(this.offset);\n            this.generateMonth();\n            this._change_timer = null;\n        }, 100);\n    }\n\n    /**\n     * Reset the month offset to the month of the selected date\n     */\n    public reset() {\n        const date = new DateTZ({date: this.date});\n        const offset = this.offset;\n        this.offset = DateNow(new Date()).dateDiff(date, 'months', 'months');\n        if (offset !== this.offset) {\n            this.generateMonth();\n        }\n        this.month.emit(this.offset);\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.date = value;\n        this.updateDate();\n        this.generateMonth();\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n}\n","<div [class]=\"'date-picker' + (klass ? ' ' + klass : '')\" widget>\n    <div class=\"header\">\n        <div class=\"arrow previous\" [class.disabled]=\"offset <= min_offset\" (click)=\"changeMonth(-1)\" (touchend)=\"changeMonth(-1)\">\n            <div class=\"previous icon\"></div>\n        </div>\n        <div class=\"month\" (dblclick)=\"reset()\">{{month_name}}</div>\n        <div class=\"arrow next\" [class.disabled]=\"offset >= max_offset\" (click)=\"changeMonth(1)\" (touchend)=\"changeMonth(1)\">\n            <div class=\"next icon\"></div>\n        </div>\n    </div>\n    <div class=\"week\">\n        <div class=\"block\" *ngFor=\"let item of days_of_week\">{{item}}</div>\n    </div>\n    <div class=\"body\">\n        <div class=\"block\" *ngFor=\"let item of date_list\">\n            <div class=\"date\" \n                (click)=\"item.disabled ? null : setDate(item)\"\n                (touchend)=\"item.disabled ? null : setDate(item)\"\n                [class.non-month]=\"item.non_month\"\n                [class.active]=\"item.active\"\n            >\n                {{item.display}}\n                <div class=\"dot\" *ngIf=\"item.today\"></div>\n                <div class=\"count\" *ngIf=\"item.count\">{{item.count > 9 ? '+9' : item.count}}</div>\n            </div>\n        </div>\n    </div>\n</div>","import {\n    Component,\n    EventEmitter,\n    Input,\n    OnChanges,\n    OnInit,\n    Output,\n    SimpleChanges\n} from '@angular/core';\n\nexport enum AlertMode {\n    Warning = 'warning',\n    Coachmark = 'coachmark',\n    BlueCoachmark = 'blue-coachmark',\n    Error = 'error'\n}\n\nexport enum AlertBannerDisplay {\n    /**\n     * New UI\n     */\n    V2 = 'v2',\n\n    /**\n     * Default, legacy ui.\n     */\n    V1 = 'v1',\n}\n\n@Component({\n    selector: 'mck-alert-banner',\n    template: `\n        <div class=\"alert-container {{mode}}\">\n            <div class=\"alert-icon-container {{mode}}\">\n                <img [src]=\"iconPath\">\n            </div>\n            <div class=\"content-wrap\">\n                <div name=\"message\" class=\"message {{mode}} {{display}}\" [innerHTML]=\"message | sanitize\"></div>\n                <div class=\"actions-button-container {{display}}\" *ngIf=\"buttonText\">\n                    <button name=\"action-button\"\n                            color=\"{{materialColor}}\"\n                            class=\"{{materialColor}} {{display}}\"\n                            [class.mck-stroked-button]=\"display === 'v2'\"\n                            [class.mck-short]=\"display === 'v2'\"\n                            type=\"button\" mat-stroked-button\n                            (click)=\"action.emit($event)\">{{buttonText}}</button>\n                </div>\n            </div>\n            <button\n                *ngIf=\"showClose\"\n                mat-icon-button name=\"close-button\" class=\"close-button\"\n                aria-label=\"Close\"\n                color=\"{{materialColor}}\"\n                (click)=\"close.emit($event)\">\n                <img [attr.src]=\"'assets/img/' + closeIcon\">\n            </button>\n        </div>\n    `,\n    styleUrls: ['./alert-banner.component.scss']\n})\nexport class AlertBannerComponent implements OnInit, OnChanges {\n\n    @Input()\n    public mode: AlertMode = AlertMode.Warning;\n\n    @Output()\n    public close = new EventEmitter<MouseEvent>();\n\n    @Output()\n    public action = new EventEmitter<MouseEvent>();\n\n    @Input()\n    public message: string;\n\n    @Input()\n    public buttonText: string;\n\n    @Input()\n    public showClose = true;\n\n    @Input()\n    public display: AlertBannerDisplay = AlertBannerDisplay.V1;\n\n    public iconPath: string = 'assets/icon/warning-yellow.svg';\n    public materialColor: string = 'black';\n    public closeIcon: string = 'close_outline.svg';\n\n    public ngOnInit(): void {\n        this._onModeChange();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.mode) {\n            this._onModeChange();\n        }\n    }\n\n    private _onModeChange() {\n        this.iconPath = 'assets/icon/warning-yellow.svg';\n        this.closeIcon = 'close_outline.svg';\n        switch (this.mode) {\n            case AlertMode.Warning:\n                this.materialColor = 'black';\n                break;\n            case AlertMode.Coachmark:\n                this.materialColor = 'coachmark';\n                this.closeIcon = 'close_outline_coachmark.svg';\n                break;\n            case AlertMode.BlueCoachmark:\n                this.iconPath = 'assets/icon/info-bg-dark.svg'\n                this.materialColor = 'blue-coachmark'\n                break;\n            case AlertMode.Error:\n                this.iconPath = 'assets/img/error-icon.svg'\n                this.materialColor = 'white'\n                break;\n            default:\n                this.materialColor = 'black';\n        }\n    }\n\n}\n","import {\n    Component,\n    Directive,\n    EventEmitter,\n    Input,\n    OnChanges,\n    OnDestroy,\n    OnInit,\n    Optional,\n    Output,\n    Self,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    NgControl\n} from '@angular/forms';\nimport { SelectOption } from '../types';\nimport {\n    BehaviorSubject,\n    combineLatest,\n    from,\n    Subject\n} from 'rxjs';\nimport {\n    COMMA,\n    ENTER\n} from '@angular/cdk/keycodes';\nimport { MatChipInputEvent } from '@angular/material/chips';\nimport {\n    distinctUntilChanged,\n    map,\n    take\n} from 'rxjs/operators';\nimport { MatCheckboxChange } from '@angular/material/checkbox';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { MatAutocompleteTrigger } from '@angular/material/autocomplete';\n\n@Component({\n    selector: 'mck-autocomplete-chip-select-item',\n    template: `\n        <div class=\"mck-column mck-form-input\" [ngClass]=\"mobileFullScreen ? 'mobile-select' : ''\">\n            <button *ngIf=\"mobileFullScreen\" name=\"CloseButton\" class=\"close-button\" mat-icon-button (click)=\"loseFocus()\">\n                <div class=\"close-image\"></div>\n            </button>\n            <mck-label [required]=\"required\">{{label}}</mck-label>\n            <mat-form-field\n                appearance=\"outline\"\n                floatLabel=\"never\"\n                [ngClass]=\"showError ? 'mck-error' : ''\"\n                matAutocompleteOrigin\n                #origin=\"matAutocompleteOrigin\">\n                <div class=\"mck-row input-container\">\n                    <input\n                        matInput\n                        #componentInput=\"matInput\"\n                        #trigger=\"matAutocompleteTrigger\"\n                        [style.width]=\"'100%'\"\n                        [style.margin]=\"'0'\"\n                        [formControl]=\"filterFormControl\"\n                        placeholder=\"{{placeHolder}}\"\n                        type=\"text\"\n                        (focusin)=\"onFocus(true)\"\n                        (input)=\"keyedInput($event.target.value)\"\n                        [matAutocomplete]=\"auto\"\n                        [matAutocompleteConnectedTo]=\"origin\"\n                        [matChipInputFor]=\"chipList\"\n                        (matChipInputTokenEnd)=\"add($event)\"\n                    >\n                    <div class=\"mck-row\">\n                        <div class=\"suffix\" matSuffix *ngIf=\"loading\">\n                            <mat-spinner diameter=\"16\"></mat-spinner>\n                        </div>\n                        <mck-selected-chip-count\n                            (close)=\"clearSelections()\"\n                            *ngIf=\"hasChips\"\n                            [count]=\"(chipOptions | async).length\"></mck-selected-chip-count>\n                        <div class=\"mck-column icon-container {{focused ? '' : 'not-clickable'}}\"\n                             (click)=\"onClickArrow()\" *ngIf=\"!hideDropdownCarret\">\n                            <mck-chevron-icon [up]=\"focused\"\n                                              fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n                        </div>\n                    </div>\n                </div>\n                <mck-spacer size=\"4px\" *ngIf=\"hasChips\"></mck-spacer>\n                <mat-chip-list #chipList>\n                    <!-- empty chip useful for padding -->\n                    <mat-chip *ngIf=\"focused && !hasChips\"\n                              [style.visibility]=\"'collapse'\"></mat-chip>\n                    <mat-chip *ngFor=\"let selected of (chipOptions | async)\" removable\n                              (removed)=\"removeOption(selected)\" class=\"{{selected.meta?.color ? selected.meta?.color : ''}}\">{{selected.shortDisplay}}\n                        <mck-close-icon matChipRemove [fillClass]=\"iconFillClass(selected.meta?.color)\">close</mck-close-icon>\n                    </mat-chip>\n                </mat-chip-list>\n                <mck-spacer size=\"4px\" *ngIf=\"hasChips\"></mck-spacer>\n                <mat-autocomplete\n                    class=\"{{!!mobileFullScreen && 'mobile-select'}} mck-checkbox-panel\"\n                    #auto=\"matAutocomplete\"\n                    (opened)=\"onPanelFocusChange(true)\"\n                    (closed)=\"onPanelFocusChange(false)\"\n                    (optionSelected)=\"selectOption($event.option.value)\"\n                    multiple>\n                    <div class='checkbox-container'>\n                        <mat-option\n                            [disabled]=\"!option.enabled\"\n                            class=\"mck-truncated {{(option.groupHeader || option.displayAsHeader) && 'mck-checkbox-group-header'}} {{option.groupChild && !option.displayAsHeader && 'mck-checkbox-group-child'}}\"\n                            (click)=\"$event.stopPropagation()\"\n                            *ngFor=\"let option of filteredAutocompleteOptions | async | groupHeaderPatch\"\n                            [value]=\"option.value\">\n                            <mat-checkbox\n                                [ngClass]=\"!option.enabled && 'mck-checkbox-disabled'\"\n                                [disabled]=\"!option.enabled\"\n                                [style.display]=\"'block'\"\n                                [checked]=\"option.selected\"\n                                (change)=\"onChanged(option, $event)\"\n                                (click)=\"$event.stopPropagation()\">\n                                {{option.dropdownOverride || option.display}}\n                            </mat-checkbox>\n                        </mat-option>\n                    </div>\n                    <div class='checkbox-cta-container' *ngIf='displayCTA'>\n                        <button\n                            mat-stroked-button class=\"mck-secondary-button\"\n                            (click)=\"clearSelections()\"\n                            [disabled]=\"!enableCTAs\"\n                        >\n                            Clear\n                        </button>\n                        <button\n                            mat-button class=\"mck-primary-button\"\n                            (click)=\"onFocus(false)\"\n                            [disabled]=\"!enableCTAs\"\n                        >\n                            Confirm\n                        </button>\n                    </div>\n                </mat-autocomplete>\n            </mat-form-field>\n            <mck-error-message *ngIf=\"showError\">{{errorMessage}}</mck-error-message>\n        </div>\n    `,\n    styleUrls: ['./auto-complete-chip-select-item.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class AutoCompleteChipSelectItemComponent extends BaseDirective implements OnInit, OnChanges, ControlValueAccessor, OnDestroy {\n\n    @ViewChild('trigger')\n    trigger: MatAutocompleteTrigger;\n\n    @ViewChild('componentInput')\n    componentInput: HTMLInputElement;\n\n    @Input()\n    label: string;\n\n    @Input()\n    required?: boolean;\n\n    @Input()\n    feedbackInput?: boolean;\n\n    @Input()\n    loading?: boolean;\n\n    @Input()\n    placeHolder: string;\n\n    @Input()\n    options: Subject<SelectOption<any>[]>;\n\n    @Input()\n    selectedOptions: Subject<SelectOption<any>[]>;\n\n    @Input()\n    useCTAs?: boolean;\n\n    @Output()\n    optionSelected = new EventEmitter<SelectOption<any>>();\n\n    @Output()\n    feedbackOutput = new EventEmitter<any>();\n\n    @Output()\n    chipsCleared: EventEmitter<void> = new EventEmitter<void>();\n\n    @Output()\n    onClickConfirm: EventEmitter<void> = new EventEmitter<void>();\n\n    /**\n     * If true, only allow 1 group at a time to get selected. Show others as disabled.\n     */\n    @Input()\n    selectOnlyOneGroup = false;\n\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n\n    @Input() public localFilter: boolean = true;\n\n    /**\n     * If error exists, a message.\n     */\n    @Input()\n    errorMessage?: string;\n\n    @Input()\n    hideDropdownCarret?: boolean;\n\n    @Input()\n    displayCTA?: boolean;\n\n    private selectOnlyOneGroupChange = new BehaviorSubject(false);\n\n    separatorKeysCodes = [ENTER, COMMA];\n\n    public filterFormControl: FormControl = new FormControl();\n\n    public focused = false;\n    public mobileFullScreen = false;\n\n    public autocompleteOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n    public filteredAutocompleteOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    /** List shown to user, filters children if a group header is added **/\n    public chipOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    /** Form control on change handler */\n    private _onChange?: (_: SelectOption<any>[]) => void;\n    /** Form control on touch handler */\n    private _onTouch?: (_: string) => void;\n\n    private value = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public enableCTAs: boolean = false\n\n    public hasChips: boolean = false;\n\n    constructor(@Self() @Optional() private control: NgControl) {\n        super();\n        if (this.control) {\n            this.control.valueAccessor = this;\n        }\n    }\n\n    public get invalid(): boolean {\n        return this.control ? this.control.invalid : false;\n    }\n\n    public get showError(): boolean {\n        if (!this.control) {\n            return false;\n        }\n\n        const { dirty, touched } = this.control;\n\n        return this.invalid ? (dirty && touched) : false;\n    }\n\n    public iconFillClass(color?: string): string {\n        return color === 'external' ? 'mck-icon-fill-gray' : 'mck-icon-fill-white'\n    }\n\n    ngOnInit() {\n        this.subscription('autoCompleteOptions', combineLatest([\n            this.options,\n            this.selectedOptions,\n            this.selectOnlyOneGroupChange\n        ])\n            .pipe(\n                map(([options, selectedOptions, selectOnlyOneGroup]) => {\n                    this.hasChips = !!selectedOptions.length;\n                    return options.map(option => {\n                        const selected = !!selectedOptions.find(s => s.value === option.value);\n                        let enabled = true;\n                        if (selectOnlyOneGroup) {\n                            // find first group item in selection\n                            const selectedGroupHeader = selectedOptions.find(s => s.groupHeader || s.groupId === option.groupId);\n\n                            // if no options chosen, enable it, otherwise only allow selections from other options.\n                            enabled =\n                                selectedOptions.length === 0 ||\n                                (selectedGroupHeader ? selectedGroupHeader.groupId === option.groupId : false);\n                            this.enableCTAs = selectedOptions.length !== 0\n                        }\n\n                        return {\n                            ...option,\n                            enabled,\n                            selected\n                        } as SelectOption<any>;\n                    });\n                })\n            ).subscribe(next => {\n                const options = next.sort((a, b) => {\n                    if (a.groupId === b.groupId) {\n                        return b.display > a.display ? -1 : 1;\n                    }\n                    return b.groupId > a.groupId ? -1 : 1;\n                });\n                this.autocompleteOptions.next(options);\n                this.filteredAutocompleteOptions.next(this.getFilteredAutocompleteOptions(this.filterFormControl.value?.trim()));\n            }));\n        this.subscription('filterFormControlChanges',\n            this.filterFormControl.valueChanges.subscribe(value => {\n                if (this.localFilter && value.length) {\n                    this.filteredAutocompleteOptions.next(this.getFilteredAutocompleteOptions(value));\n                } else {\n                    this.filteredAutocompleteOptions.next(this.getFilteredAutocompleteOptions());\n                }\n            }));\n        this.subscription('chipOptions', this.selectedOptions\n            .pipe(map(selectedOptions => {\n                // find group headers and check if children are part of that group.\n                // if part of group, filter them out as redundant.\n                const groupHeaders = selectedOptions.filter(s => s.groupHeader) || [];\n                return selectedOptions.filter(s => s.groupHeader || s.groupChild && !(groupHeaders.find(g => g.groupId === s.groupId)));\n            }))\n            .subscribe(next => {\n                this.chipOptions.next(next);\n            }));\n\n        this.subscription('formData', this.selectedOptions\n            .pipe(map(selected => {\n                // group headers always contain children, so only pick out children for data\n                return selected;\n            }))\n            .subscribe(next => {\n                this.value.next(next);\n            }));\n\n        // tie value changes to change.\n        this.subscription('valueChanges', this.value\n            .pipe(distinctUntilChanged())\n            .subscribe(next => {\n                if (this._onChange) {\n                    // rewrote this to avoid read only error\n                    const values = [];\n                    next.forEach((v, i) => {\n                        const value = { ...v };\n                        if (v.meta?.user) {\n                            value.display = v.meta.user.name;\n                        }\n                        values.push(value);\n                    });\n                    this._onChange(values);\n                }\n            }));\n\n        window.addEventListener('scroll', this.scrollEvent, true);\n    }\n\n    getFilteredAutocompleteOptions(searchString: string = '') {\n        // Exact matches of the groupId or display value\n        const exactMatches = this.autocompleteOptions.value.filter(o => {\n            if (searchString && searchString.length) {\n                return o.groupId.toLowerCase().indexOf(searchString.toLowerCase()) === 0 || o.display.toLowerCase().indexOf(searchString.toLowerCase()) === 0;\n            }\n            return o.groupId && o.display;\n        });\n        // Fuzzier search of the dropdownOverride field\n        const moreOptions = this.autocompleteOptions.value.filter(o => {\n            if (o?.dropdownOverride?.length && searchString) {\n                const match = o.dropdownOverride?.toLowerCase().indexOf(searchString.toLowerCase()) > -1;\n                // only return found locations that don't exist in exactMatches.\n                return match && !exactMatches.find(e => {\n                    return e.value === o.value\n                });\n            }\n            return false;\n        });\n\n        // Merge the two result sets\n        let joinedOptions = exactMatches.concat(moreOptions).sort((a, b) => {\n            if (a.groupId === b.groupId) {\n                return b.display > a.display ? -1 : 1;\n            }\n            return b.groupId > a.groupId ? -1 : 1;\n        });\n\n        // Create a 1D array of the groupId\n        const groupIds = joinedOptions.map(o => o.groupId);\n        // Get a deduped list of the group parents\n        const parents = this.autocompleteOptions.value.filter(o => {\n            return o?.groupHeader && groupIds.indexOf(o.groupId) !== -1;\n        });\n\n        // Remove the parents from the joinedOptions and merge with the reduced parents set, and then sort by groupId.\n        // Resulting array sets the parents first in order so the widget renders properly.\n        const filteredAutocompleteOptions = parents.concat(joinedOptions.filter(jo => !!jo.dropdownOverride)).sort((a, b) => {\n            return b.groupId > a.groupId ? -1 : 1;\n        });\n        return filteredAutocompleteOptions;\n    }\n\n    loseFocus(): void {\n        this.mobileFullScreen = false;\n        this.focused = false;\n    }\n\n    ngOnChanges(changes: SimpleChanges): void {\n        if (changes.selectOnlyOneGroup) {\n            this.selectOnlyOneGroupChange.next(this.selectOnlyOneGroup);\n        }\n    }\n\n    keyedInput(matInput: string) {\n        if (this.feedbackInput) {\n            this.feedbackOutput.emit(matInput);\n        }\n    }\n\n    selectOption(value: string) {\n        this.options.pipe(\n            take(1),\n            map((options: SelectOption<any>[]) => options.find(o => o.value === value))\n        ).subscribe(next => {\n            if (next) {\n                this.optionSelected.emit(next);\n            }\n        });\n    }\n\n    removeOption(value: SelectOption<any>) {\n        this.optionSelected.emit(value);\n        if (this.useCTAs) {\n            this.onClickConfirm.emit();\n        }\n\n    }\n\n    clearSelections() {\n        this.selectedOptions.next([]);\n        this.chipsCleared.emit();\n    }\n\n    onClickArrow() {\n        // only close events we allow arrow to close panel.\n        if (this.focused) {\n            this.onFocus(false);\n        }\n    }\n\n    onPanelFocusChange(focusIn: boolean) {\n        this.onFocus(focusIn, true);\n    }\n\n    onFocus(focusIn: boolean, fromPanel?: boolean) {\n        if (!focusIn && this.useCTAs) {\n            this.onClickConfirm.emit();\n        }\n        // Only for location input???\n        if (this.localFilter && fromPanel && focusIn) {\n            // open on focus, mobile needs a refocus\n            this.mobileFullScreen = true;\n            this.timeout('showDefaults', () => {\n                // All results do not show as expected unless I focus again.\n                // Something about the mobile styles.\n                this.onFocus(true);\n            }, 100)\n        }\n\n        if (this.feedbackInput && !fromPanel) {\n            // clear input when input creates options\n            this.componentInput.value = '';\n            this.filterFormControl.setValue('');\n            this.feedbackOutput.emit('');\n        }\n\n        if (this.focused !== focusIn) {\n            this.focused = focusIn;\n            // clear on close\n            if (!focusIn) {\n                this.componentInput.value = '';\n                this.filterFormControl.setValue('');\n            }\n            if (!fromPanel) {\n                if (focusIn) {\n                    this.trigger.openPanel();\n                } else {\n                    this.trigger.closePanel();\n                    // close the mobile full screen\n                    this.loseFocus();\n                }\n            }\n        }\n    }\n\n    onChanged(value: SelectOption<any>, event: MatCheckboxChange) {\n        this.optionSelected.emit(value);\n    }\n\n    add(event: MatChipInputEvent) {\n        // reset\n        if (event.input) {\n            event.input.value = '';\n        }\n        this.filterFormControl.setValue('');\n    }\n\n    registerOnChange(fn: any): void {\n        this._onChange = fn;\n    }\n\n    registerOnTouched(fn: any): void {\n        this._onTouch = fn;\n    }\n\n    setDisabledState(isDisabled: boolean): void {\n        // TODO: disabled not implemented yet.\n        this.disabled = isDisabled;\n    }\n\n    writeValue(obj: SelectOption<any>[] | undefined): void {\n        // update selected options when this value is written\n        this.options?.pipe(\n            take(1),\n            map((options: SelectOption<any>[]) => {\n                return options.filter(o => !!obj.find(spl => o.value === spl.value));\n            })\n        ).subscribe(next => {\n            this.selectedOptions.next(next);\n        });\n    }\n\n    private scrollEvent = (event): void => {\n        if (this.trigger === null) {\n          return;\n        }\n        /**\n         * IF - to confirm user not scrolling from autocomplete opened panel and close panel if scroll event triggers from outside of panel\n         */\n        if (this.trigger.panelOpen && event.target.closest('.mat-autocomplete-panel') === null ) {\n            this.onFocus(false);\n            this.trigger['_element'].nativeElement.blur();\n        }\n      }\n      public ngOnDestroy(): void {\n        window.removeEventListener('scroll', this.scrollEvent, true);\n      }\n}\n\n\n","import {\n    Pipe,\n    PipeTransform\n} from '@angular/core';\nimport { SelectOption } from '../types';\n\n/**\n * Patch orphaned SelectOption children into acting as their own group headers.\n *\n * This intends to help in the common scenario where filters have (for whatever\n * reason) prevented the child's usual group header from appearing.\n */\n@Pipe({\n    name: 'groupHeaderPatch',\n})\nexport class GroupHeaderPipe implements PipeTransform {\n    transform(items: SelectOption<any>[]): SelectOption<any>[] {\n        if (!items) {\n            return [];\n        }\n\n        return items.map(v => {\n            const hasHeader = !!items.find(i => i.groupHeader && i.groupId === v.groupId);\n            return {\n                ...v,\n                displayAsHeader: !hasHeader,\n            }\n        })\n    }\n\n}\n","import { Component, Input, Output, forwardRef, SimpleChanges, OnChanges, OnInit, EventEmitter, ViewChild, OnDestroy } from '@angular/core';\nimport { ControlValueAccessor, FormControl, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { Observable } from 'rxjs';\nimport { map, startWith } from 'rxjs/operators';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { MatAutocompleteTrigger } from '@angular/material/autocomplete';\nimport {\n  BehaviorSubject\n} from 'rxjs';\n\n/**\n * @title Autocomplete filtering select of a single option via text search.\n */\n@Component({\n  selector: 'mck-autocomplete-select-option',\n  templateUrl: 'auto-complete-select-option.component.html',\n  styleUrls: ['auto-complete-select-option.component.scss'],\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => AutoCompleteSelectOptionComponent),\n      multi: true\n    }\n  ],\n})\nexport class AutoCompleteSelectOptionComponent implements OnInit, OnChanges, ControlValueAccessor, OnDestroy{\n  @Input()\n  public label: string;\n\n  @Input()\n  public required: boolean;\n\n  @Input()\n  public options: SelectOption<any>[] = [];\n\n  @Input()\n  public selectedValue: SelectOption<any> | undefined;\n\n  @Input()\n  public resetInput: number | undefined;\n\n  @Input()\n  public placeholder: string;\n\n  @Input()\n  public noEntriesFoundLabel: string;\n\n  @Output()\n  public filteredOptionsChange = new EventEmitter<SelectOption<any>[]>();\n\n  @Output()\n  public inputTextChange = new EventEmitter<string>();\n\n  @Output() emptyBoxEvent = new EventEmitter();\n\n  /** Form control on change handler */\n  private _onChange: (_: SelectOption<any>) => void;\n  /** Form control on touch handler */\n  private _onTouch: (_: SelectOption<any>) => void;\n\n  filterFormControl = new FormControl();\n  filteredOptions: Observable<SelectOption<any>[]>;\n\n  /** The selected value */\n  public value = new BehaviorSubject<any | undefined>('');\n\n  /** Available options to search / select from */\n  public _options = new BehaviorSubject<SelectOption<any>[]>(this.options);\n  @ViewChild('trigger')\n    trigger: MatAutocompleteTrigger;\n\n  ngOnInit() {\n    this.updateFilteredOptions();\n    window.addEventListener('scroll', this.scrollEvent, true);\n  }\n\n  public ngOnChanges(changes: SimpleChanges): void {\n    // Watch and apply changes from the parent component.\n    if (changes.options || changes.selectedValue) {\n      if (changes.options && !changes.selectedValue) {\n        this.filterFormControl.setValue('')\n      }\n      this.updateFilteredOptions();\n    }\n    if (changes.resetInput) {\n      this.filterFormControl.setValue('');\n      this.updateFilteredOptions();\n    }\n    \n  }\n\n  private updateFilteredOptions() {\n    this.filteredOptions = this.filterFormControl.valueChanges\n      .pipe(\n        startWith(''),\n        map(value => typeof value === 'string' ? value : value && value?.display ? value.display : ''),\n        map(name => name ? this._filter(name) : this.options.slice())\n      );\n  }\n\n  displayFn(data: SelectOption<any>): string {\n    return data && data?.display ? data.display : '';\n  }\n\n  private _filter(display: string): SelectOption<any>[] {\n    const filterValue = display.toLowerCase();\n    // return all the matches found\n    const filtered = this.options.filter(option => {\n      // split this input and index both, if both\n      // match return true.\n      if (filterValue.includes(' ')) {\n        const filterValues =filterValue.split(' ');\n        let matchesAll = true;\n        for (let x = 0; x < filterValues.length; x++) {\n          if (option.display.toLowerCase().indexOf(filterValues[x]) === -1) {\n            matchesAll = false;\n          }\n        }\n        if (matchesAll) {\n          return true;\n        }\n      }\n      // match the whole string\n      return option.display.toLowerCase().indexOf(filterValue) > -1;\n    });\n    this.inputTextChange.emit(filterValue);\n    this.filteredOptionsChange.emit(filtered);\n    return filtered;\n  }\n\n  /**\n   * Update the form field value\n   * @param new_value New value to set on the form field\n   */\n  public setValue(new_value: SelectOption<any>): void {\n    this.value.next(new_value);\n    if (this._onChange) {\n      this._onChange(this.options.find(f => f.value === new_value.value));\n    }\n  }\n\n  /**\n * Update local value when form control value is changed\n * @param value The new value for the component\n */\n  public writeValue(value: SelectOption<any> | null) {\n    if (value != null) {\n      this.value.next(value.value);\n    }\n  }\n\n  /**\n   * Registers a callback function that is called when the control's value changes in the UI.\n   * @param fn The callback function to register\n   */\n  public registerOnChange(fn: (_: SelectOption<any>) => void): void {\n    this._onChange = fn;\n  }\n\n  /**\n   * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n   * @param fn The callback function to register\n   */\n  public registerOnTouched(fn: (_: SelectOption<any>) => void): void {\n    this._onTouch = fn;\n  }\n\n  public onChangeInput() {\n    if (this.filterFormControl.value === '') {\n      this.emptyBoxEvent.emit(true);\n    }\n  }\n\n  private scrollEvent = (event): void => {\n    if (this.trigger === null) {\n      return;\n    }\n    /**\n     * IF - to confirm user not scrolling from autocomplete opened panel and close panel if scroll event triggers from outside of panel\n     */\n    if (this.trigger.panelOpen && event.target.closest('.mat-autocomplete-panel') === null ) {\n      this.trigger.closePanel();\n        this.trigger['_element'].nativeElement.blur();\n    }\n  }\n  public ngOnDestroy(): void {\n    window.removeEventListener('scroll', this.scrollEvent, true);\n  }\n\n}","<div class=\"mck-column mck-form-input\">\n    <mck-label *ngIf=\"label\" [required]=\"required\">{{label}}</mck-label>\n    <mat-form-field\n                appearance=\"outline\"\n                class=\"mck-center-suffix\">\n      <input\n        type=\"text\"\n        autocomplete=\"off\"\n        matInput\n        #trigger=\"matAutocompleteTrigger\"\n        [formControl]=\"filterFormControl\"\n        [matAutocomplete]=\"auto\"\n        [placeholder]=\"placeholder\"\n        value={{selectedValue?.display}}\n        (keyup)=\"onChangeInput();\"\n      >\n      <mat-autocomplete\n        #auto=\"matAutocomplete\"\n        [displayWith]=\"displayFn\"\n        (optionSelected)=\"setValue($event.option.value)\"\n      >\n        <mat-option *ngFor=\"let option of filteredOptions | async\" [value]=\"option\">\n          {{option.shortDisplay || option.display}}\n        </mat-option>\n      </mat-autocomplete>\n    </mat-form-field>\n</div>","import {\n    AfterViewInit,\n    OnDestroy,\n    OnInit,\n    TemplateRef,\n    ViewChild,\n    ViewContainerRef,\n} from '@angular/core';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\n/**\n * A helper class for rendering embedded views (ng-template) as standalone components.\n *\n * If the view is lazy and does not render upon initialization,\n * it attempts embedding view again later.\n *\n * When testing a component directly that extends this class, its best to wrap the component\n * in a wrapper component for testing so that it can render itself.\n */\nexport class BaseTemplateComponent extends BaseDirective implements AfterViewInit, OnInit, OnDestroy {\n    @ViewChild(TemplateRef, { static: true })\n    public template: TemplateRef<any>;\n\n    private isRendered = false;\n\n    constructor(private vcRef: ViewContainerRef) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        // try early rendering\n        this.attemptViewEmbed();\n    }\n\n    public attemptViewEmbed() {\n        if (this.template && !this.isRendered) {\n            this.isRendered = true;\n            this.vcRef.createEmbeddedView(this.template);\n            return true;\n        }\n        return false;\n    }\n\n    public ngAfterViewInit(): void {\n        if (!this.isRendered) {\n            console.log('View not rendered yet, attempting to post initialization');\n            setTimeout(() => {\n                console.log('Timeout ended, trying again', this.template);\n                if (!this.attemptViewEmbed()) {\n                    console.log('Attempting render in after view initialization');\n                    setTimeout(() => {\n                        if (!this.attemptViewEmbed()) {\n                            console.error('FAILED TO LOAD TEMPLATE');\n                        }\n                    }, 1000);\n                }\n            });\n        }\n    }\n\n    public ngOnDestroy(): void {\n        super.ngOnDestroy();\n        this.isRendered = false;\n    }\n}\n","import {\n    Component,\n    Output,\n    TemplateRef,\n    ViewChild,\n    EventEmitter,\n    Input\n  } from \"@angular/core\";\n  import { DropdownPanel } from \"./dropdown-panel\";\n  \n  @Component({\n    selector: \"cng-select-options\",\n    templateUrl: \"./cng-select-options.component.html\",\n    styleUrls: [\"./cng-select-options.component.scss\"]\n  })\n  export class CngSelectOptionsComponent implements DropdownPanel {\n    @ViewChild(TemplateRef) templateRef: TemplateRef<any>;\n    @Output() closed = new EventEmitter<void>();\n    @Input() ddWidth: string;\n  \n    constructor() {}\n  }\n  ","<ng-template>\n    <div (click)=\"closed.emit()\" class=\"dropdown-content flex-column\" [ngStyle]=\"{'width': ddWidth}\" >\n      <ng-content></ng-content>\n    </div>\n  </ng-template>","import {\n    Component,\n    Output,\n    TemplateRef,\n    ViewChild,\n    EventEmitter,\n    Input,\n    OnInit\n  } from \"@angular/core\";\n  import { DropdownPanel, DropdownOpion } from \"./dropdown-panel\";\n  \n  @Component({\n    selector: \"cng-select\",\n    templateUrl: \"./cng-select.component.html\",\n    styleUrls: [\"./cng-select.component.scss\"]\n  })\n  export class CngSelectComponent implements OnInit {\n    @Input() data: any;\n    public isClosed: boolean = false;\n    public selected: DropdownOpion;\n    constructor() {\n\n    }\n    ngOnInit(): void {\n      this.selected = this.data.defaultSelected;\n    }\n\n    public optionSelected(item: DropdownOpion) {\n      // this.selected = item;\n      this.data.defaultSelected = item;\n      this.data?.onChangeCallback && this.data?.onChangeCallback(item);\n    }\n  }\n  ","\n\n<div name=\"level\" [dropdownTriggerFor]=\"dropdown\" class=\"cng-select flex-row\" [class]=\"data?.ddBoxClass\" [ngClass]=\"{'focus': isClosed, 'disabled': data?.disabled }\" matRipple (isPanelOpened)=\"isClosed = !isClosed\">\n  <span class=\"selecte-sort\" style=\"flex: 1 1 auto ;\">{{data?.defaultSelected?.display}}</span>\n  <div class=\"mck-column select-chevron\">\n      <mck-chevron-icon [up]=\"isClosed\" matSuffix fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n  </div>\n</div>\n<cng-select-options #dropdown ddWidth >\n    <div matRipple *ngFor=\"let item of data?.options\" (click)=\" optionSelected(item)\" class=\"dropdown-item flex-row\" [class]=\"data?.optionBoxClass\" [ngClass]=\"{'selected' : data?.defaultSelected?.value === item?.value }\">{{item?.display}}</div>\n</cng-select-options>","import {\n  AfterViewInit,\n    Directive,\n    ElementRef,\n    EventEmitter,\n    Input,\n    OnDestroy,\n    OnInit,\n    Output,\n    Renderer2,\n    ViewContainerRef\n  } from '@angular/core';\n  import { DropdownPanel } from './dropdown-panel';\n  import { Overlay, OverlayRef } from '@angular/cdk/overlay';\n  import { TemplatePortal } from '@angular/cdk/portal';\n  import { merge, Observable, Subscription } from 'rxjs';\n  \n  @Directive({\n    selector: '[dropdownTriggerFor]',\n    host: {\n      '(click)': 'toggleDropdown()'\n    }\n  })\n  export class DropdownTriggerForDirective implements OnDestroy, AfterViewInit, OnInit {\n    private isDropdownOpen = false;\n    private overlayRef: OverlayRef;\n    private dropdownClosingActionsSub = Subscription.EMPTY;\n  \n    @Input('dropdownTriggerFor') public dropdownPanel: DropdownPanel;\n    @Output() isPanelOpened = new EventEmitter<boolean>();\n    constructor(\n      private overlay: Overlay,\n      private elementRef: ElementRef<HTMLElement>,\n      private viewContainerRef: ViewContainerRef,\n      private renderer: Renderer2\n    ) {\n     \n    }\n    ngOnInit(): void {\n      // const cngSelectEl = this.elementRef.nativeElement.nextElementSibling; \n      // const parentWidth = this.elementRef.nativeElement.offsetWidth; \n      // this.renderer.setStyle(cngSelectEl, 'width', `${parentWidth}px`);\n    }\n    ngAfterViewInit(): void {\n      \n    }\n\n  \n    toggleDropdown(): void {\n      this.isDropdownOpen ? this.destroyDropdown() : this.openDropdown();\n      \n    }\n  \n    openDropdown(): void {\n      let {ddWidth} = this.dropdownPanel;\n      this.dropdownPanel.ddWidth = ddWidth !=='' ? ddWidth : `${this.elementRef.nativeElement.offsetWidth}px`;\n      this.isDropdownOpen = true;\n      this.isPanelOpened.emit(this.isDropdownOpen);\n      this.overlayRef = this.overlay.create({\n        hasBackdrop: true,\n        backdropClass: 'cdk-overlay-transparent-backdrop',\n        scrollStrategy: this.overlay.scrollStrategies.close(),\n        positionStrategy: this.overlay\n          .position()\n          .flexibleConnectedTo(this.elementRef)\n          .withPositions([\n            {\n              originX: 'end',\n              originY: 'bottom',\n              overlayX: 'end',\n              overlayY: 'top',\n              offsetY: 8\n            }\n          ])\n      });\n  \n      const templatePortal = new TemplatePortal(\n        this.dropdownPanel.templateRef,\n        this.viewContainerRef\n      );\n      this.overlayRef.attach(templatePortal);\n  \n      this.dropdownClosingActionsSub = this.dropdownClosingActions().subscribe(\n        () => this.destroyDropdown()\n      );\n    }\n  \n    private dropdownClosingActions(): Observable<MouseEvent | void> {\n      const backdropClick$ = this.overlayRef.backdropClick();\n      const detachment$ = this.overlayRef.detachments();\n      const dropdownClosed = this.dropdownPanel.closed;\n  \n      return merge(backdropClick$, detachment$, dropdownClosed);\n    }\n  \n    private destroyDropdown(): void {\n      if (!this.overlayRef || !this.isDropdownOpen) {\n        return;\n      }\n  \n      this.dropdownClosingActionsSub.unsubscribe();\n      this.isDropdownOpen = false;\n      this.isPanelOpened.emit(this.isDropdownOpen);\n      this.overlayRef.detach();\n    }\n  \n    ngOnDestroy(): void {\n      if (this.overlayRef) {\n        this.overlayRef.dispose();\n      }\n    }\n  }\n  ","import {\n    Component,\n    Input,\n    OnInit,\n    ViewEncapsulation\n} from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\n\n@Component({\n    selector: 'mck-collapse-header',\n    template: `\n        <mat-expansion-panel\n            [disabled]=\"isLoading\"\n            name=\"expansion-panel\"\n            class=\"mck-expansion-panel {{(isExpanded | async) && 'mck-expanded'}}\"\n            (opened)=\"isExpanded.next(true)\"\n            (closed)=\"isExpanded.next(false)\" hideToggle>\n            <mat-expansion-panel-header *ngIf=\"!isLoading\" name=\"expansion-panel-header\">\n                <mat-panel-title>{{title}}</mat-panel-title>\n                <div class=\"mck-collapse-icon\" [class.expanded]=\"isExpanded | async\"></div>\n            </mat-expansion-panel-header>\n            <mat-expansion-panel-header *ngIf=\"isLoading\">\n                <div class=\"mck-row mck-center\">\n                    <ngx-skeleton-loader class=\"mck-skeleton-header\"></ngx-skeleton-loader>\n                </div>\n            </mat-expansion-panel-header>\n            <mat-panel-description *ngIf=\"description && (isExpanded | async)\">{{description}}</mat-panel-description>\n            <ng-template matExpansionPanelContent>\n                <ng-content></ng-content>\n            </ng-template>\n        </mat-expansion-panel>\n    `,\n    styleUrls: ['./collapse-header.component.scss'],\n})\nexport class CollapseHeaderComponent implements OnInit {\n\n    @Input()\n    title: string;\n\n    @Input()\n    description: string;\n\n    /**\n     * If true, show skeleton.\n     */\n    @Input()\n    isLoading = false;\n\n    public isExpanded = new BehaviorSubject(false);\n\n    constructor() {\n    }\n\n    ngOnInit(): void {\n    }\n\n}\n","import { ChangeDetectionStrategy, Component, Inject, OnInit, ViewEncapsulation } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nexport interface RoomAvaibilityModalData {\n\theaderText: string,\n\tmessage: string,\n\tbuttonLabel: string,\n\tcallback: Function,\n    shouldClose: boolean\n}\n\n@Component({\n    selector: 'conflict-alert-modal',\n    templateUrl: 'conflict-alert-modal.component.html',\n    styleUrls: ['./conflict-alert-modal.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n})\nexport class ConflictAlertModalComponent implements OnInit {\n    constructor(public dialogRef: MatDialogRef<ConflictAlertModalComponent>,\n        @Inject(MAT_DIALOG_DATA) public dialogData: RoomAvaibilityModalData) {\n    }\n    ngOnInit(): void {}\n\n    public done() {\n        this.dialogData?.callback(); this.dialogRef.close()\n    }\n}\n","<div>\n    <mck-modal [shouldClose]=\"dialogData?.shouldClose\">\n        <div class=\"nc-modal\">\n\t\t\t\t\t<div class=\"mck-column modal-heading\">\n\t\t\t\t\t\t\t<div class=\"header mck-column\">\n\t\t\t\t\t\t\t\t\t<img src=\"assets/icon/room-not-available.svg\" />\n\t\t\t\t\t\t\t\t\t<span>{{dialogData?.headerText}}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"alert-message\">{{dialogData?.message}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</mck-modal>\n\t\t\t<mat-dialog-actions>\n\t\t\t\t\t <mck-modal-button-row [primaryLabel]=\"dialogData?.buttonLabel\" (primarySubmit)=\"done()\"></mck-modal-button-row>\n\t\t\t</mat-dialog-actions>\n</div>","import {Component, EventEmitter, Inject, Input, OnInit, Output} from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport {DialogEvent} from '@mckinsey-converge/base';\nimport {DateTZ, isToday} from '@mckinsey-converge/date-tz';\n\nexport interface ConflictsModalComponentData {\n  room_name: string;\n  conflicts: number[];\n  copy_conflicts?: boolean;\n  timezone: string;\n}\n\n@Component({\n  selector: 'app-conflicts-modal',\n  templateUrl: './conflicts-modal.component.html',\n  styleUrls: ['./conflicts-modal.component.scss']\n})\nexport class ConflictsModalComponent implements OnInit{\n  public room_name: string;\n  public conflicts: number[];\n  public copy_conflicts: boolean;\n  public timezone;\n\n\n  @Output() public event = new EventEmitter<DialogEvent>();\n\n  constructor(@Inject(MAT_DIALOG_DATA) private _data: ConflictsModalComponentData){\n\n  }\n\n  public ngOnInit(){\n    this.timezone = this._data.timezone;\n    this.room_name = this._data.room_name\n    this.conflicts = this._data.conflicts\n    this.copy_conflicts = this._data.copy_conflicts\n  }\n\n  public formatDate(date: number) {\n    const dateTZ = new DateTZ({date: date*1000,  is_local_tz: false, building_tz: this._data.timezone});\n    const dateIsToday = isToday(dateTZ, this.timezone);\n    const display = dateTZ.formatDate('ccc dd MMM yyyy');\n    return `${display}${dateIsToday ? ' (Today)' : ''}`;\n  }\n\n  public continue(): void {\n    this.event.emit({ reason: 'done' });\n  }\n\n  public close(): void {\n    this.event.emit({ reason: 'close' });\n  }\n\n  public copy(): void {\n    this.event.emit({ reason: 'action' });\n  }\n\n\n}\n","<div class=\"header\">\n    <button mat-icon-button mat-dialog-close name=\"close\">\n        <div class=\"close-image\"></div>\n    </button>\n</div>\n<mat-dialog-content #content>\n    <div class=\"conflicts-content-header\">\n        <h2>Conflicts ({{conflicts.length}})</h2>\n        <div class=\"info\" *ngIf=\"!copy_conflicts\">\n            The {{room_name}} room is not available on the following dates.\n            Do you want to proceed <span>without booking</span> these days?\n        </div>\n        <div class=\"info\" *ngIf=\"copy_conflicts\">\n            The {{room_name}} room is not available on the following dates.\n            You need to make individual bookings to cover these days, please.\n        </div>\n    </div>\n    <div class=\"conflicts-list\">\n        <div class=\"conflicts-list--header\">\n            Date\n        </div>\n        <div class=\"items\">\n            <div class=\"item\" *ngFor=\"let conflict of conflicts\">\n                {{formatDate(conflict)}}\n            </div>\n        </div>\n    </div>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <button\n            mat-button\n            class=\"inverse\"\n            i18n=\"Booking spaces cancel action\"\n            (click)=\"copy_conflicts ? copy() : close()\"\n            [class.copy]=\"copy_conflicts\"\n    >\n       {{copy_conflicts ? 'Copy to clipboard' : 'Close'}}\n    </button>\n    <button\n            mat-button\n            name=\"next\"\n            i18n=\"Booking spaces continue action\"\n            (click)=\"copy_conflicts ? close() : continue()\"\n            [class.copy]=\"copy_conflicts\"\n    >\n    {{copy_conflicts ? 'Close' : 'Continue'}}\n    </button>\n</mat-dialog-actions>\n","import {\n    Component,\n    OnInit,\n    Input,\n    Output,\n    OnChanges,\n    SimpleChanges,\n    forwardRef,\n    EventEmitter,\n} from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { BaseClass } from '@mckinsey-converge/base';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\nexport interface IDateTzPickerOptions {\n    /** DateTZ object. First selectable date */\n    fromDateTz?: DateTZ;\n    /** DateTZ object. Last selectable date */\n    untilDateTz?: DateTZ;\n    /** Luxon format string for formatting days of the week. Defaults to `DDD` */\n    day_format?: string;\n    /** Luxon format string for formatting active month. Defaults to `MMMM yyyy` */\n    month_format?: string;\n}\n\ninterface IDateBlock {\n    /** Timestamp value of the date */\n    value: DateTZ;\n    /** Day of the month to display */\n    display: string;\n    /** Whether block is the selected date */\n    active: boolean;\n    /** Whether block not selectable */\n    disabled: boolean;\n    /** Whether block outside the active month */\n    non_month: boolean;\n    /** Whether the block is today */\n    today: boolean;\n    /** Number of events on this block */\n    count?: number;\n}\n\n@Component({\n    selector: 'date-tz-calendar-widget',\n    templateUrl: './date-tz-calendar-widget.component.html',\n    styleUrls: ['./date-tz-calendar-widget.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DateTzCalendarWidgetComponent),\n            multi: true,\n        },\n    ],\n})\nexport class DateTzCalendarWidgetComponent\n    extends BaseClass\n    implements OnInit, OnChanges, ControlValueAccessor\n{\n    /** CSS class to add to the root element of the component */\n    @Input() public className = 'default';\n    /** Counters of the events on given dates. Key format is `yyyy-MM-dd` */\n    @Input() public counters: { [date: string]: number };\n    /** Settings for the date picker component */\n    @Input() public options: IDateTzPickerOptions;\n    /** Offset of the display month from the current month */\n    @Output() public month = new EventEmitter<number>();\n\n    public readonly weeks = new Array(6).fill(0);\n    public selectedDateTz: DateTZ = DateNow();\n\n    // R--- this is the date picker that needs to be TZ aware\n    /** Offset of the month displayed from the current month */\n    public offset = 0;\n    /** Minimum offset for changing the month */\n    public min_offset = -999999;\n    /** Maximum offset for changing the month */\n    public max_offset = 999999;\n    /** Blocks representing the rendering details of the display days of the month */\n    public date_list: IDateBlock[] = [];\n    /** Name of the actively displayed month */\n    public month_name = DateNow(new Date()).formatDate('MMMM yyyy');\n    /** Name of the days of the week to display */\n    public days_of_week = [];\n    /** First selectable date */\n    private fromTz: DateTZ;\n    /** Last selectable date */\n    private toTz: DateTZ;\n    /** Luxon format string for formatting days of the week. Defaults to `dd` */\n    private day_format = 'EEE';\n    /** Luxon format string for formatting active month. Defaults to `MMMM yyyy` */\n    private month_format = 'MMMM yyyy';\n    /** Form control on change handler */\n    private _onChange: (_: DateTZ) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: DateTZ) => void;\n\n    private _today = DateNow();\n\n    public get timezone() {\n        return this.selectedDateTz?.building_tz || '';\n    }\n\n    public ngOnInit(): void {\n        this.generateMonth();\n        this.generateDaysOfTheWeek();\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.options) {\n            this.updateOptions();\n        }\n        if (changes.counters) {\n            this.generateMonth();\n        }\n    }\n\n    /** Change date using the given block */\n    public setDate(item: IDateBlock) {\n        this.selectedDateTz = item.value;\n        if (this._onChange) {\n            this._onChange(this.selectedDateTz);\n        }\n        this.generateMonth();\n    }\n\n    /**\n     * Update offset to show the selected date 2\n     */\n    public updateDate(): void {\n        if (!this.selectedDateTz) {\n            return;\n        }\n        const now = this._today.startOfValue('month');\n        const startOfMonthDateTz = this.selectedDateTz.startOfValue('month');\n        if (startOfMonthDateTz.valid) {\n            const difference = startOfMonthDateTz.dateDiff(\n                now,\n                'months',\n                'months'\n            );\n            if (this.offset !== difference) {\n                this.offset = Math.round(difference);\n                this.month.emit(this.offset);\n            }\n            this.generateMonth();\n        }\n    }\n\n    /**\n     * Update local properties based off changes to settings\n     */\n    public updateOptions(): void {\n        if (this.options) {\n            // Setup from date\n            if (this.options.fromDateTz) {\n                const today = this._today.startOfValue('month');\n                this.fromTz = this.options.fromDateTz.startOfValue('day');\n                this.min_offset = Math.round(\n                    this.fromTz\n                        .startOfValue('month')\n                        .dateDiff(today, 'months', 'months')\n                );\n            } else if (this.fromTz) {\n                this.fromTz = null; // R-- check if ok\n                this.min_offset = -999999;\n            }\n            // Setup to date\n            if (this.options.untilDateTz) {\n                const today = this._today.startOfValue('month');\n                this.toTz = this.options.untilDateTz.startOfValue('day');\n                this.max_offset = this.toTz\n                    .startOfValue('month')\n                    .dateDiff(today, 'months', 'months');\n            } else if (this.toTz) {\n                this.toTz = null;\n                this.max_offset = 999999;\n            }\n            if (this.options.month_format) {\n                this.month_format = this.options.month_format || 'MMMM yyyy';\n            }\n            if (this.options.day_format) {\n                this.day_format = this.options.day_format || 'EEE';\n                this.generateDaysOfTheWeek();\n            }\n            // Update date blocks\n            this.generateMonth();\n        }\n    }\n\n    /**\n     * Generate the display blocks for the days of the active month\n     */\n    private generateMonth(): void {\n        this._today = new DateTZ({ date: Date.now(), is_local_tz: !this.timezone, building_tz: this.timezone });\n        const startOfMonthDateTz = this._today.addValue({ months: this.offset });\n        const active = this.selectedDateTz || DateNow();\n        let startDate = startOfMonthDateTz\n            .setValue({ day: 1 })\n            .setValue({ weekday: 7 })\n            .subtractValue({ weeks: 1 });\n        this.date_list = [];\n        for (let i = 0; i < 42; i++) {\n            this.date_list.push({\n                value: startDate,\n                display: startDate.formatDate('d'),\n                active: active.isSameDate(startDate, 'day'),\n                non_month: !startOfMonthDateTz.isSameDate(startDate, 'month'),\n                count: this.counters\n                    ? this.counters[startDate.formatDate('yyyy-MM-dd')] || 0\n                    : 0,\n                disabled:\n                    (this.fromTz ? startDate.ms < this.fromTz.ms : false) ||\n                    (this.toTz ? startDate.ms > this.toTz.ms : false),\n                today: this._today.isSameDate(startDate, 'day'),\n            });\n            startDate = startDate.addValue({ days: 1 });\n        }\n        this.month_name = startOfMonthDateTz.formatDate(this.month_format);\n    }\n\n    /**\n     * Generate this weekdays to display in the header of the calendar\n     */\n    private generateDaysOfTheWeek() {\n        let date = this._today.startOfValue('week');\n        this.days_of_week = [];\n        for (let i = 0; i < 7; i++) {\n            this.days_of_week.push(date.formatDate(this.day_format));\n            date = date.addValue({ days: 1 });\n        }\n    }\n\n    /**\n     * Changes the month offset by the given value.\n     * Does nothing if the new month is not available to be selected\n     * @param value Number of months to change the offset by\n     */\n    public changeMonth(value: number): void {\n        const new_offset = Math.min(\n            this.max_offset,\n            Math.max(this.min_offset, this.offset + value)\n        );\n        this.offset = Math.round(new_offset);\n        this.generateMonth();\n        this.month.emit(this.offset);\n    }\n\n    /**\n     * Reset the month offset to the month of the selected date\n     */\n    public reset() {\n        const offset = this.offset;\n        this.offset = Math.round(\n            this._today.dateDiff(this.selectedDateTz, 'months', 'months')\n        );\n        if (offset !== this.offset) this.generateMonth();\n        this.month.emit(this.offset);\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: DateTZ) {\n        if (value) {\n            this.selectedDateTz = value;\n            this.updateDate();\n            this.generateMonth();\n        }\n    }\n\n    public readonly registerOnChange = (fn: (_: DateTZ) => void) => this._onChange = fn;\n    public readonly registerOnTouched = (fn: (_: DateTZ) => void) => this._onTouch = fn;\n}\n","<div [class]=\"'date-picker' + (className ? ' ' + className : '')\" widget>\n    <div class=\"header\">\n        <button\n            matRipple\n            class=\"arrow previous\"\n            [disabled]=\"offset <= min_offset\"\n            (click)=\"changeMonth(-1)\"\n        >\n            <div class=\"previous icon\"></div>\n        </button>\n        <div class=\"month\" (dblclick)=\"reset()\">{{ month_name }}</div>\n        <button\n            matRipple\n            class=\"arrow next\"\n            [disabled]=\"offset >= max_offset\"\n            (click)=\"changeMonth(1)\"\n        >\n            <div class=\"next icon\"></div>\n        </button>\n    </div>\n    <table>\n        <thead>\n            <td *ngFor=\"let item of days_of_week\">{{ item }}</td>\n        </thead>\n        <tbody>\n            <tr *ngFor=\"let week of weeks; let i = index\">\n                <td *ngFor=\"let item of date_list | slice: i * 7:i * 7 + 7\">\n                    <button\n                        matRipple\n                        class=\"date\"\n                        (click)=\"setDate(item)\"\n                        [disabled]=\"item.disabled\"\n                        [class.non-month]=\"item.non_month\"\n                        [class.active]=\"item.active\"\n                    >\n                        {{ item.display }}\n                        <div class=\"dot\" *ngIf=\"item.today\"></div>\n                        <div class=\"count\" *ngIf=\"item.count\">{{item.count > 9 ? '+9' : item.count}}</div>\n                    </button>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n</div>\n","import {\n    Component,\n    EventEmitter,\n    forwardRef,\n    Input,\n    Output,\n    ViewChild,\n    OnInit\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\n\nimport { MatMenuTrigger } from '@angular/material/menu';\nimport {\n    BehaviorSubject,\n    Observable\n} from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { DateTzCalendarWidgetComponent } from '../date-tz-calendar-widget/date-tz-calendar-widget.component';\n\n@Component({\n    selector: 'date-tz-date-picker',\n    template: `\n        <div\n            [class.icon-only]=\"icon_only\"\n            [class.mck-form-input]=\"!icon_only\"\n            [class.mck-column]=\"!icon_only\"\n            [class.error]=\"error\"\n        >\n            <mck-label [required]=\"true\" *ngIf=\"!icon_only && label\">{{label}}</mck-label>\n                <div\n                    [class.mck-date-display]=\"!icon_only\"\n                    [class.mck-input]=\"!icon_only\"\n                    role=\"button\"\n                    form-field\n                    tabindex=\"0\"\n                    [class.active]=\"is_open\"\n                    [attr.disabled]=\"disabled\"\n                    (keydown.enter)=\"openDatePicker()\"\n                    [matMenuTriggerFor]=\"appMenu\"\n                    [class.date-error]=\"invalid || error\"\n                    \n                >\n                <div class=\"display\" *ngIf=\"!icon_only\">{{ dateString | async }}</div>\n                <div class=\"icon\">\n                    <mck-calendar-icon\n                        [fillClass]=\"is_open ? 'mck-icon-fill-open' : 'mck-icon-fill-black'\"></mck-calendar-icon>\n                </div>\n            </div>\n            \n            <mat-menu #appMenu=\"matMenu\" xPosition=\"before\" (close)=\"onDatePickerClose()\">\n                <div class=\"date-picker\" (click)=\"$event.stopPropagation()\">\n                    <date-tz-calendar-widget\n                        className=\"mck-date-picker\"\n                        [counters]=\"counters\"\n                        [ngModel]=\"selectedDateTzValue | async\"\n                        [options]=\"{ fromDateTz: fromDateTz, untilDateTz: untilDateTz, day_format: 'EEE' }\"\n                        (ngModelChange)=\"setValue($event); closeDatePicker()\"\n                    ></date-tz-calendar-widget>\n                    <button\n                        mat-stroked-button\n                        color=\"primary\"\n                        class=\"mck-stroked-button today-button\"\n                        *ngIf=\"can_pick_today\"\n                        (click)=\"goToToday()\"\n                    >Today\n                    </button>\n                </div>\n            </mat-menu>\n        </div>\n    `,\n    styleUrls: ['./date-tz-date-picker.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DateTzDatePickerComponent),\n            multi: true\n        }\n    ]\n})\nexport class DateTzDatePickerComponent extends BaseDirective implements OnInit, ControlValueAccessor {\n    @Input() public label?: string;\n    /** Earliest date available the user is allowed to pick */\n    @Input() public fromDateTz: DateTZ = DateNow(new Date());\n    /** Latest date available the user is allowed to pick */\n    @Input() public untilDateTz: DateTZ = DateNow(new Date()).endOfValue('day').addValue({ years: 1 });\n    /** Position of the tooltip */\n    @Input() public position: 'right' | 'left' = 'right';\n    /** Offset of the tooltip */\n    @Input() public offset: 'top' | 'bottom' = 'bottom';\n    /** Whether form control is disabled */\n    @Input() public disabled: boolean;\n    // R-- possible TODO, address all_day that disables this input and displays \"Add Day for the value like the time picker\"\n    @Input() public all_day: boolean = false;\n    /** Whether to show the calendar tooltip */\n    @Input() public icon_only: boolean = false;\n\n    @Input() public counters: any;\n\n    @Input() public initialDateSelectionTz?: DateTZ;\n\n    @Output() public onSelect = new EventEmitter();\n\n    @Input() public invalid?: boolean;\n\n    @Input() public timezone?: string;\n\n    @Input() public can_pick_today: boolean = true;\n\n    /** Whether form control is invalid, touched and contains errors */\n    @Input() public error?: boolean;\n\n    public ngOnInit(): void {\n        if (this.initialDateSelectionTz) {\n            this.writeValue(this.initialDateSelectionTz)\n        }\n    }\n\n    /** Whether to show the calendar tooltip */\n    public show_tooltip: boolean;\n    /** Form control on change handler */\n    private _onChange: (_: DateTZ) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: DateTZ) => void;\n\n    @ViewChild(MatMenuTrigger, { static: true }) private _trigger: MatMenuTrigger;\n    @ViewChild(DateTzCalendarWidgetComponent, {static: true }) private _acaDatePicker: DateTzCalendarWidgetComponent;\n    /** Currently selected date */\n    public selectedDateTzValue = new BehaviorSubject<DateTZ>(DateNow(new Date()));\n\n    /** Display value for the current date */\n    public get dateString(): Observable<string> {\n        return this.selectedDateTzValue.pipe(map(d => {\n            const display = d.formatDate('ccc dd MMM yyyy');\n            return `${display}${d.isSameDate(new DateTZ({ is_local_tz: false, building_tz: d.building_tz }), 'day') ? ' (Today)' : ''}`;\n        }));\n    }\n\n    /** Whether date picker is open */\n    public get is_open(): boolean {\n        return this._trigger.menuOpen;\n    }\n\n    // date\n    public get dateTzObservable(): Observable<DateTZ> {\n        return this.selectedDateTzValue.pipe(map(d => {\n            return d \n        }));\n\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(newValueTz: DateTZ) {\n        // Keep hours and minutes of the old date\n        const old_date = this.selectedDateTzValue.value;\n        let newDateTz = newValueTz.setValue({ hour: old_date.dateHour, minute: old_date.minutes, second: old_date.second });\n\n        // Check that new date is before from\n        if (newDateTz.ms < this.fromDateTz.ms) {\n            newDateTz = this.fromDateTz;\n        }\n\n        this.selectedDateTzValue.next(newDateTz);\n        if (this._onChange) {\n            this._onChange(newDateTz);\n        }\n\n        this.onSelect.emit(newDateTz);\n        this.show_tooltip = false;\n    }\n\n    public goToToday() {\n        const building_tz = this.timezone || this.fromDateTz.building_tz\n        const is_local_tz = DateNow(new Date()).building_tz === building_tz\n        this.setValue(new DateTZ({ is_local_tz, building_tz }));\n    }\n\n    public resetToLastSelection = () => this._acaDatePicker.updateDate();\n\n    public onDatePickerClose() {\n        this.resetToLastSelection();\n    }\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(selectedDateTz: DateTZ) {\n        this.selectedDateTzValue.next(selectedDateTz);\n        this.show_tooltip = false;\n    }\n\n    public readonly registerOnChange = (fn: (_: DateTZ) => void) => this._onChange = fn;\n    public readonly registerOnTouched = (fn: (_: DateTZ) => void) => this._onTouch = fn;\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /** Set the state of the tooltip to closed after delay */\n    public closeDatePicker() {\n        this._trigger.closeMenu();\n    }\n\n    /** Set the state of the tooltip to closed after delay */\n    public openDatePicker() {\n        this._trigger.openMenu();\n    }\n}\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport {\n    BaseDirective,\n    DurationGroup,\n    nearestDurationToInput,\n} from '@mckinsey-converge/base';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\nimport {\n    BehaviorSubject,\n    combineLatest\n} from 'rxjs';\n\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { map } from 'rxjs/operators'; \nimport {\n    DEFAULT_DURATION,\n    defaultDurationGroups,\n    generateDurationOptionsFromGroups\n} from '../utils/time.utils';\nimport { MatSelect } from '@angular/material/select';\nimport { convertLocalTimestampToTimezonedDateTz, convertTimezonedTimestampToLocalDateTz, DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'date-tz-duration-field',\n    template: `\n        <div class=\"mck-column mck-form-input\">\n            <mck-label *ngIf=\"label\" [required]=\"required\">{{label}}</mck-label>\n            <mat-form-field appearance=\"outline\" class=\"mck-center-suffix\">\n                <mat-select\n                    #select\n                    [placeholder]=\"(placeHolderOption | async)?.display\"\n                    panelClass=\"mck-select-panel\"\n                    [disabled]=\"all_day\"\n                    [value]=\"value | async\"\n                    (valueChange)=\"setValue($event)\"\n                    disableOptionCentering>\n                    <mat-option>\n                        <ngx-mat-select-search\n                            noEntriesFoundLabel=\"No timeslots found for current search. Try selecting one in the dropdown.\"\n                            [placeholderLabel]=\"(selectedOption | async)?.display\"\n                            [formControl]=\"filterFormControl\"></ngx-mat-select-search>\n                    </mat-option>\n                    <mat-option\n                        *ngFor=\"let option of options | async | filter: (nearestStep | async): 'display'\"\n                        [value]=\"option.value\"\n                        [disabled]=\"isDisabled(option)\">\n                        <mck-select-option\n                            [option]=\"option\"\n                            [selected]=\"isSelected(option) | async\"\n                        ></mck-select-option>\n                    </mat-option>\n                </mat-select>\n                <div class=\"mck-column\">\n                    <mck-chevron-icon [up]=\"isOpen\" matSuffix fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n                </div>\n            </mat-form-field>\n        </div>\n    `,\n    styleUrls: ['./date-tz-duration-field.component.css'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DateTzDurationFieldComponent),\n            multi: true\n        }\n    ],\n    encapsulation: ViewEncapsulation.None\n})\nexport class DateTzDurationFieldComponent extends BaseDirective implements OnInit, ControlValueAccessor, OnChanges {\n    @Input() public label?: string;\n    @Input() public required: boolean;\n    @Input() max_length?: number;\n\n    // /** Whether form field is disabled */\n    // @Input() public disabled: boolean;\n    /** Start date value to count from */\n    @Input() public startDateTz: DateTZ;\n    /** Set to limit the duration options */\n    @Input() public extended?: boolean;\n    /** Whether form all_day is enabled. */\n    // R-- need to address all_day that disables this input and displays \"Add Day for the value\"\n    @Input() public all_day: boolean = false;\n\n    /**\n     * Specify the slice of durations to use when generating options.\n     */\n    @Input() public durationGroups: DurationGroup[] = defaultDurationGroups;\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    /** Select field for selecting the time */\n    @ViewChild('select') private select_field: MatSelect;\n\n    /** Component will return a number of minutes */\n    public value = new BehaviorSubject<number>(DEFAULT_DURATION);\n\n    public currentStartDateTz = new BehaviorSubject(DateNow(new Date()));\n\n    public filterFormControl: FormControl = new FormControl();\n\n    public nearestStep = combineLatest([this.filterFormControl.valueChanges, this.currentStartDateTz]).pipe(\n            \n            map(([value, currentStartDate]) => { \n                /**\n                 * convert current start date/time to building time zone first\n                 *  \n                 */\n                const ms = convertTimezonedTimestampToLocalDateTz(currentStartDate.ms, currentStartDate.building_tz).ms;\n                return nearestDurationToInput(this.durationGroups, ms, value); \n            }\n        ));\n\n    public options = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public placeHolderOption = this.options.pipe(\n        map(options => options.find(o => o.value === DEFAULT_DURATION))\n    );\n\n    public selectedOption = combineLatest([this.options, this.value]).pipe(\n        map(([options, value]) => options.find(o => o.value === value))\n    );\n\n    public isSelected(option: SelectOption<any>) {\n        return this.value.pipe(map(t => t === option.value));\n    }\n\n    public isDisabled(option: SelectOption<any>) {\n        return this.max_length ? option.value > this.max_length : false;\n    }\n\n    public get isOpen() {\n        return this.select_field?.panelOpen ?? false;\n    }\n\n    ngOnInit(): void {\n        this.subscription('OptionsCalculation',\n            this.currentStartDateTz.pipe(\n                map(d => generateDurationOptionsFromGroups(d, this.durationGroups, this.extended))\n            ).subscribe(next => {\n                this.options.next(next);\n            }));\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.timezone) {\n            const dopt = generateDurationOptionsFromGroups(this.currentStartDateTz.value, this.durationGroups, this.extended);\n            this.options.next(dopt);\n        }\n        if (changes.startDateTz) {\n            this.currentStartDateTz.next(changes.startDateTz.currentValue);\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number): void {\n        this.writeValue(new_value);\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    writeValue(obj: number): void {\n        this.value.next(obj);\n        if (this._onChange) {\n            this._onChange(obj);\n        }\n    }\n\n    // public setDisabledState(disabled: boolean) {\n    //     this.disabled = disabled;\n    // }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n}\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation,\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    NG_VALUE_ACCESSOR,\n} from '@angular/forms';\nimport { MatSelect } from '@angular/material/select';\n\nimport {\n    BaseDirective,\n    closestToTimeSlotTz,\n    nearestStepToInput,\n    timeWithGmtOffsetFormatString,\n} from '@mckinsey-converge/base';\n\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport {\n    generateAvailableTimes,\n    generateAvailableTimesTz,\n} from '../utils/time.utils';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { filter, map, withLatestFrom } from 'rxjs/operators';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { DateTime } from 'luxon';\n\n@Component({\n    selector: 'date-tz-time-field',\n    template: `\n        <div class=\"mck-column mck-form-input\">\n            <mck-label *ngIf=\"label\" [required]=\"required\">{{\n                label\n            }}</mck-label>\n            <mat-form-field appearance=\"outline\" class=\"mck-center-suffix\">\n                <mat-select\n                    #select\n                    [placeholder]=\"(placeHolderOption | async)?.display\"\n                    panelClass=\"mck-select-panel\"\n                    [disabled]=\"all_day\"\n                    [value]=\"selectedTimeString | async\"\n                    (valueChange)=\"setValue($event)\"\n                    disableOptionCentering\n                >\n                    <mat-option>\n                        <ngx-mat-select-search\n                            noEntriesFoundLabel=\"No timeslots found for current search. Try selecting one in the dropdown.\"\n                            [placeholderLabel]=\"\n                                (selectedOption | async)?.display ||\n                                (placeHolderOption | async)?.display ||\n                                ''\n                            \"\n                            [formControl]=\"filterFormControl\"\n                        ></ngx-mat-select-search>\n                    </mat-option>\n                    <mat-option\n                        *ngFor=\"\n                            let option of options\n                                | async\n                                | filter: (nearestStep | async):'shortDisplay'\n                        \"\n                        [value]=\"option.display\"\n                    >\n                        <mck-select-option\n                            [option]=\"option\"\n                            [selected]=\"isSelected(option)\"\n                        ></mck-select-option>\n                    </mat-option>\n                </mat-select>\n                <div class=\"mck-column\">\n                    <mck-chevron-icon\n                        [up]=\"isOpen\"\n                        matSuffix\n                        fillClass=\"mck-icon-fill-black\"\n                    ></mck-chevron-icon>\n                </div>\n            </mat-form-field>\n        </div>\n    `,\n    styleUrls: ['./date-tz-time-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DateTzTimeFieldComponent),\n            multi: true,\n        },\n    ],\n    encapsulation: ViewEncapsulation.None,\n})\nexport class DateTzTimeFieldComponent\n    extends BaseDirective\n    implements OnInit, OnChanges, ControlValueAccessor\n{\n    @Input() public label?: string;\n    @Input() public required: boolean;\n    /** Time step between each allowed time option */\n    @Input() public step = 15;\n    /** Whether form field is disabled */\n    // @Input() public disabled: boolean;\n    /** Whether past times are allowed */\n    @Input() public noPastTimes = true;\n    /** Representing the DateTZ object datetime to start time options from **/\n    @Input() public fromDateTz: DateTZ = DateNow(new Date());\n    // Disables this input and displays R--- \"All Day\" for the value\n    @Input() public all_day: boolean = false;\n    @Input() public show_current: boolean = false;\n    @Input() public startFromDateTz: boolean = false;\n\n    /** Form control on change handler */\n    private _onChange: (_: DateTZ) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: DateTZ) => void;\n\n    /** Select field for selecting the time */\n    @ViewChild('select') private select_field: MatSelect;\n    /** DateTZ object representing the currently set datetime */\n    public selectedDateTz = new BehaviorSubject(\n        closestToTimeSlotTz(DateNow(new Date()), this.step)\n    );\n\n    /** string representing the currently set datetime display value, needed for the input to display the slected value */\n    public selectedTimeString = new BehaviorSubject(\n        timeWithGmtOffsetFormatString(this.selectedDateTz.value)\n    );\n\n    public filterFormControl: FormControl = new FormControl();\n\n    /** Available time blocks for the selected date */\n    public options = new BehaviorSubject<SelectOption<any>[]>(\n        generateAvailableTimesTz(\n            DateNow(),\n            !this.noPastTimes,\n            this.step,\n            this.timezone,\n            this.all_day,\n            this.show_current\n                ? [generateOptionForDateTz(DateNow())]\n                : [],\n            this.startFromDateTz\n        )\n    );\n\n    public ngOnInit(): void {\n        // Generate the time input options for the booking date\n        this.options.next(\n            generateAvailableTimesTz(\n                this.selectedDateTz.value,\n                !this.noPastTimes,\n                this.step,\n                this.timezone,\n                this.all_day,\n                this.show_current\n                    ? [generateOptionForDateTz(this.selectedDateTz.value)]\n                    : [],\n                this.startFromDateTz\n            )\n        );\n        // Subscribe to selected option changes\n        this.subscription(\n            'dateTimeChanges',\n            combineLatest([this.selectedDateTz])\n                .pipe(\n                    map(([selectedDateTz]) => {\n                        /**\n                         * The selectedDateTz should already be pegged to the closest time slot, but\n                         * if the selected time rolls into the past this can correct it.  // R--- verify this statement\n                         */\n                        return closestToTimeSlotTz(selectedDateTz, this.step);\n                    }),\n                    withLatestFrom(this.options),\n                    filter(\n                        ([date, timeOptions]: [\n                            DateTZ,\n                            SelectOption<any>[]\n                        ]) => {\n                            // if new time slot opened up when date / time changes, add it here.\n                            return !timeOptions.find(\n                                (t) => t.value === date.formatDate('HH:mm')\n                            );\n                        }\n                    ),\n                    map(([dateTz, timeOptions]) => {\n                        // TODO probably an issue here with going from a future date and time earlier than now back to day showing null\n                        // Push the current date option in\n                        timeOptions.push({\n                            display: timeWithGmtOffsetFormatString(dateTz),\n                            shortDisplay: dateTz.formatDate('hh:mma'),\n                            value: dateTz,\n                        });\n\n                        // Sort the time options\n                        timeOptions.sort((a, b) =>\n                            `${a.value}`.localeCompare(`${b.value}`)\n                        );\n                        return timeOptions;\n                    })\n                )\n                .subscribe((next) => {\n                    return this.options.next(next);\n                })\n        );\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (\n            changes.no_past_times ||\n            changes.step ||\n            changes.fromDateTz ||\n            changes.all_day\n        ) {\n            // If there's a new date value then update the time options\n            this.options.next(\n                generateAvailableTimesTz(\n                    this.selectedDateTz.value,\n                    !this.noPastTimes,\n                    this.step,\n                    this.timezone,\n                    this.all_day,\n                    this.show_current\n                        ? [generateOptionForDateTz(this.selectedDateTz.value)]\n                        : [],\n                    this.startFromDateTz\n                )\n            );\n            // If today and all day goes from on to off the selected value isn't going to be available.\n            if (\n                changes.all_day &&\n                !changes.all_day.currentValue &&\n                changes.all_day.previousValue\n            ) {\n                this.setValue(this.options.value[0].display);\n            }\n        }\n    }\n\n    /**\n     * Getter if the time picker options are visiable or not\n     */\n    public get isOpen() {\n        return this.select_field?.panelOpen ?? false;\n    }\n\n    /**\n     * Getter to return the current form timestamp from the from date object\n     */\n    public get timezone(): string {\n        return this.fromDateTz.building_tz;\n    }\n\n    /**\n     * A filter for finding a matching value when using the input text search\n     */\n    public nearestStep = combineLatest([\n        this.filterFormControl.valueChanges,\n        this.selectedDateTz,\n    ]).pipe(\n        map(([value, selectedDateTz]) => {\n            return nearestStepToInput(\n                this.step,\n                value,\n                DateTime.now().valueOf()\n            );\n        })\n    );\n\n    /**\n     * Default text displayed in the search field when the component initializes\n     */\n    public placeHolderOption = this.options.pipe(\n        map((os) => os.length > 0 && os[0])\n    );\n\n    /**\n     * Returns the selected option object by matching the selectedDateTz formated string with the option.display string\n     */\n    public selectedOption = combineLatest([\n        this.options,\n        this.selectedDateTz,\n    ]).pipe(\n        map(([options, selectedDateTz]) =>\n            options.find(\n                (o) =>\n                    o.display === timeWithGmtOffsetFormatString(selectedDateTz)\n            )\n        )\n    );\n\n    /**\n     * Determines the visually selected value when the options list is visible.\n     *\n     * @param option DateTZ\n     * @returns boolean\n     */\n    public isSelected(option: SelectOption<DateTZ>) {\n        return this.selectedTimeString.value === option.display;\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: DateTZ) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: DateTZ) => void): void {\n        this._onTouch = fn;\n    }\n\n    /**\n     * Method just used in unit tests to test disabling the input\n     * @param disabled\n     */\n    // public setDisabledState(disabled: boolean) {\n    //     this.disabled = disabled;\n    // }\n\n    /**\n     * Update the selected values\n     * @param dateTz the DateTz object for the new time\n     */\n    public setSelectedValues(dateTz: DateTZ) {\n        // Update the selected DateTz and string representations\n        this.selectedTimeString.next(timeWithGmtOffsetFormatString(dateTz));\n        this.selectedDateTz.next(dateTz);\n        if (this._onChange) {\n            this._onChange(dateTz);\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param displayString The \"display\" value of this.options set by the time picker\n     */\n    public setValue(displayString: string): void {\n        // Convert the display time string to the actual option object via an array find.\n        const newTimeTz = this.options.value.find(\n            (opt) => opt.display === displayString\n        ).value;\n        // Update the selected DateTz and string representations\n        this.setSelectedValues(newTimeTz);\n        // Send the\n        if (newTimeTz) {\n            if (this._onChange) {\n                this._onChange(newTimeTz);\n            }\n        }\n    }\n\n    /**\n     * Fires when the form control value is changed\n     * @param dateTz The new value for the component\n     */\n    public writeValue(dateTz: DateTZ | null) {\n        // Init is null ?\n        if (dateTz != null) {\n            // Update the selected DateTz and string representations\n            this.setSelectedValues(dateTz);\n            // Update the available options\n            this.options.next(\n                generateAvailableTimesTz(\n                    dateTz,\n                    !this.noPastTimes,\n                    this.step,\n                    dateTz.building_tz,\n                    this.all_day,\n                    this.show_current\n                        ? [generateOptionForDateTz(dateTz)]\n                        : [],\n                    this.startFromDateTz\n                )\n            );\n        }\n    }\n}\n\nfunction generateOptionForDateTz(dateTz: DateTZ): SelectOption<DateTZ> {\n    return {\n        display: timeWithGmtOffsetFormatString(dateTz),\n        shortDisplay: dateTz.formatDate('hh:mma'),\n        value: dateTz, \n    }\n}\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport {\n    BaseDirective,\n    nearestDurationToInput,\n    DurationGroup,\n} from '@mckinsey-converge/base';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\nimport {\n    BehaviorSubject,\n    combineLatest\n} from 'rxjs';\n\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport {\n    map\n} from 'rxjs/operators';\nimport {\n    DEFAULT_DURATION,\n    defaultDurationGroups,\n    generateDurationOptionsFromGroups\n} from '../utils/time.utils';\nimport { MatSelect } from '@angular/material/select';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'mck-duration-field',\n    template: `\n        <div class=\"mck-column mck-form-input\">\n            <mck-label [required]=\"required\">{{label}}</mck-label>\n            <mat-form-field appearance=\"outline\" class=\"mck-center-suffix\">\n                <mat-select\n                    #select\n                    [placeholder]=\"(placeHolderOption | async)?.display\"\n                    panelClass=\"mck-select-panel\"\n                    [value]=\"value | async\"\n                    [disabled]=\"disabled\"\n                    (valueChange)=\"setValue($event)\"\n                    disableOptionCentering>\n                    <mat-option>\n                        <ngx-mat-select-search\n                            noEntriesFoundLabel=\"No timeslots found for current search. Try selecting one in the dropdown.\"\n                            [placeholderLabel]=\"(selectedOption | async)?.display\"\n                            [formControl]=\"filterFormControl\"></ngx-mat-select-search>\n                    </mat-option>\n                    <mat-option\n                        *ngFor=\"let option of options | async | filter: (nearestStep | async): 'display'\"\n                        [value]=\"option.value\"\n                        [disabled]=\"isDisabled(option)\">\n                        <mck-select-option\n                            [option]=\"option\"\n                            [selected]=\"isSelected(option) | async\"\n                        ></mck-select-option>\n                    </mat-option>\n                </mat-select>\n                <div class=\"mck-column\">\n                    <mck-chevron-icon [up]=\"isOpen\" matSuffix fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n                </div>\n            </mat-form-field>\n        </div>\n    `,\n    styleUrls: ['./duration-field.component.css'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DurationFieldComponent),\n            multi: true\n        }\n    ],\n    encapsulation: ViewEncapsulation.None\n})\nexport class DurationFieldComponent extends BaseDirective implements OnInit, ControlValueAccessor, OnChanges {\n    @Input()\n    public label: string;\n    @Input()\n    public required: boolean;\n    @Input() max_length?: number;\n\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Start date value to count from */\n    @Input() public startDate: number;\n    /** Set to limit the duration options */\n    @Input() public extended?: boolean;\n    /** Representing desired timezone **/\n    @Input() public timezone?: string = new DateTZ({ date: Date.now() }).local_tz;\n\n    /**\n     * Specify the slice of durations to use when generating options.\n     */\n    @Input() public durationGroups: DurationGroup[] = defaultDurationGroups;\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    /** Select field for selecting the time */\n    @ViewChild('select') private select_field: MatSelect;\n\n    public value = new BehaviorSubject<number>(DEFAULT_DURATION);\n\n    public currentStartDate = new BehaviorSubject(DateNow(new Date()));\n\n    public filterFormControl: FormControl = new FormControl();\n\n    public nearestStep = combineLatest([this.filterFormControl.valueChanges, this.currentStartDate]).pipe(\n        map(([value, currentStartDate]) => nearestDurationToInput(this.durationGroups, currentStartDate.ms, value)\n    ));\n\n    public options = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public placeHolderOption = this.options.pipe(\n        map(options => options.find(o => o.value === DEFAULT_DURATION))\n    );\n\n    public selectedOption = combineLatest([this.options, this.value]).pipe(\n        map(([options, value]) => options.find(o => o.value === value))\n    );\n\n    public isSelected(option: SelectOption<any>) {\n        return this.value.pipe(map(t => t === option.value));\n    }\n\n    public isDisabled(option: SelectOption<any>) {\n        return this.max_length ? option.value > this.max_length : false;\n    }\n\n    public get isOpen() {\n        return this.select_field?.panelOpen ?? false;\n    }\n\n    ngOnInit(): void {\n        this.subscription('OptionsCalculation',\n            this.currentStartDate.pipe(\n                map(d => generateDurationOptionsFromGroups(d.toZone(this.timezone), this.durationGroups, this.extended))\n            ).subscribe(next => {\n                this.options.next(next);\n            }));\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.timezone) {\n            const dopt = generateDurationOptionsFromGroups(this.currentStartDate.value.toZone(this.timezone), this.durationGroups, this.extended);\n            this.options.next(dopt);\n        }\n        if (changes.startDate) {\n            // R--- refactor input param\n            const date = new DateTZ({date: this.startDate})\n            this.currentStartDate.next(date);\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number): void {\n        this.writeValue(new_value);\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    writeValue(obj: number): void {\n        this.value.next(obj);\n        if (this._onChange) {\n            this._onChange(obj);\n        }\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n}\n","import { Component } from '@angular/core';\n\n@Component({\n    selector: 'mck-error-message',\n    template: `\n        <div class=\"mck-row\">\n            <div class=\"mck-row mck-center content\">\n                <div class=\"error-icon\"></div>\n                <span>\n                    <ng-content></ng-content>\n                </span>\n            </div>\n        </div>\n    `,\n    styleUrls: ['./error-message.component.scss']\n})\nexport class ErrorMessageComponent {\n\n    constructor() {\n    }\n\n}\n","import {\n    Component,\n    Input,\n    ViewContainerRef\n} from '@angular/core';\nimport { BaseTemplateComponent } from '../../base-template.component';\n\n@Component({\n    selector: 'mck-calendar-icon',\n    template: `\n        <ng-template>\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n                      [ngClass]=\"fillClass\"\n                      d=\"M4 0.5V2H1.5C0.671858 2 0 2.67186 0 3.5V5.5V14.5C0 15.3281 0.671858 16 1.5 16H14.5C15.3281 16 16 15.3281 16 14.5V5.5V3.5C16 2.67186 15.3281 2 14.5 2H12V0.5C12 0.223858 11.7761 0 11.5 0C11.2239 0 11 0.223858 11 0.5V2H5V0.5C5 0.223858 4.77614 0 4.5 0C4.22386 0 4 0.223858 4 0.5ZM11.5 3H4.5H1.5C1.22414 3 1 3.22414 1 3.5V5H15V3.5C15 3.22414 14.7759 3 14.5 3H11.5ZM1 6V14.5C1 14.7759 1.22414 15 1.5 15H14.5C14.7759 15 15 14.7759 15 14.5V6H1Z\"\n                />\n            </svg>\n        </ng-template>\n    `,\n})\nexport class CalendarIconComponent extends BaseTemplateComponent {\n\n    @Input()\n    fillClass?: string;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n}\n","import {\n    Component,\n    Input,\n    ViewContainerRef\n} from '@angular/core';\nimport { BaseTemplateComponent } from '../../base-template.component';\n\n@Component({\n    selector: 'mck-chevron-icon',\n    template: `\n        <ng-template>\n            <ng-container>\n                <div class=\"mck-chevron-icon\" [class.turn-up]=\"up\">\n                    <svg width=\"24\" height=\"24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n                            d=\"M11.957 10.664l4 4 .707-.707-4.707-4.707-4.707 4.707.707.707 4-4z\"\n                            [ngClass]=\"fillClass\"\n                            \n                        />\n                    </svg>\n                </div>\n            </ng-container>\n            <!-- <ng-container *ngIf=\"!up\">\n                <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                    <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n                          d=\"M11.9571 13.25L7.95711 9.25L7.25 9.95711L11.9571 14.6642L16.6642 9.95711L15.9571 9.25L11.9571 13.25Z\"\n                          [ngClass]=\"fillClass\" />\n                </svg>\n            </ng-container> -->\n        </ng-template>\n    `\n})\nexport class ChevronIconComponent extends BaseTemplateComponent {\n\n    @Input()\n    fillClass?: string;\n\n    @Input()\n    up?: boolean;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n}\n","import {\n    Component,\n    Input,\n    OnInit\n} from '@angular/core';\n\n@Component({\n    selector: 'mck-close-icon',\n    template: `\n        <svg width=\"9\" height=\"9\" viewBox=\"0 0 9 9\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n                  d=\"M7.50209 1.08543L1.08543 7.50209C0.971524 7.616 0.971524 7.80067 1.08543 7.91457C1.19933 8.02848 1.384 8.02848 1.49791 7.91457L7.91457 1.49791C8.02848 1.384 8.02848 1.19933 7.91457 1.08543C7.80067 0.971524 7.616 0.971524 7.50209 1.08543Z\"\n                  [ngClass]=\"fillClass\" />\n            <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n                  d=\"M1.08543 1.49791L7.50209 7.91457C7.616 8.02848 7.80067 8.02848 7.91457 7.91457C8.02848 7.80067 8.02848 7.616 7.91457 7.50209L1.49791 1.08543C1.384 0.971524 1.19933 0.971524 1.08543 1.08543C0.971524 1.19933 0.971524 1.384 1.08543 1.49791Z\"\n                  [ngClass]=\"fillClass\"\n            />\n        </svg>\n    `\n})\nexport class CloseIconComponent implements OnInit {\n\n    @Input()\n    fillClass?: string;\n\n    constructor() {\n    }\n\n    ngOnInit(): void {\n    }\n\n}\n","import {\n    Component,\n    Input,\n    ViewContainerRef,\n    ViewEncapsulation\n} from '@angular/core';\nimport { BaseTemplateComponent } from '../base-template.component';\n\n@Component(\n    {\n        selector: 'mck-informational-image',\n        template: `\n            <ng-template>\n                <div class=\"body\">\n                    <div class=\"info-block full\">\n                        <div class=\"image-wrapper full\">\n                            <img src=\"{{src}}\">\n                        </div>\n                    </div>\n                </div>\n            </ng-template>\n        `,\n        styleUrls: ['./informational-image.component.scss'],\n        encapsulation: ViewEncapsulation.None\n    }\n)\nexport class InformationalImageComponent extends BaseTemplateComponent {\n\n    @Input()\n    public src: string;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n}\n","import {\n    Component,\n    Input,\n    OnInit,\n    ViewContainerRef\n} from '@angular/core';\nimport { BaseTemplateComponent } from '../base-template.component';\n\n@Component({\n    selector: 'mck-label',\n    template: `\n        <ng-template>\n            <mat-label>\n                <ng-content></ng-content>\n                <span class=\"required-star\" *ngIf=\"required\">*</span>\n            </mat-label>\n        </ng-template>\n    `,\n    styleUrls: ['./label.component.scss']\n})\nexport class LabelComponent extends BaseTemplateComponent implements OnInit {\n\n    @Input()\n    required = false;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n\n}\n","import {\n    Component,\n    Input,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport { MatSelect } from '@angular/material/select';\nimport { SelectOption } from '../options/select-option';\n\n@Component({\n    selector: 'mck-legend-dropdown',\n    template: `\n        <div class=\"mck-column mck-form-input legend-container\">\n            <mat-form-field\n                appearance=\"outline\"\n                class=\"mck-center-suffix mck-select-dropdown-button\">\n                <mat-select\n                    class=\"legend-select\"\n                    #select\n                    panelClass=\"mck-select-panel select-panel-position\"\n                    disableOptionCentering>\n                    <mat-option\n                        [disabled]=\"true\"\n                        *ngFor=\"let option of options\"\n                        [value]=\"option.value\">\n                        <mck-select-option\n                            [ignoreDisabled]=\"true\"\n                            [option]=\"option\"\n                            [selected]=\"false\">\n                            <div class=\"legend-color-{{option.value}}\"></div>\n                        </mck-select-option>\n                    </mat-option>\n                </mat-select>          \n                <span class=\"legend-placeholder\">{{ buildPlaceholder() }}</span>\n                <mck-spacer\n                    size=\"1px\"\n                    [mode]=\"'vertical'\"\n                    spacerClass=\"legend-divider\"></mck-spacer>\n                <div class=\"mck-column chevron-container\">\n                    <mck-chevron-icon [up]=\"isOpen\" matSuffix fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n                </div>              \n            </mat-form-field>\n        </div>\n    `,\n    styleUrls: ['./legend-dropdown.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class LegendDropdownComponent {\n\n    @Input()\n    public placeholder: string;\n\n    @Input()\n    public options: SelectOption<any>[] = [];\n\n    @Input()\n    public placeholderOpen?: string\n\n    /** Select field for selecting the value */\n    @ViewChild('select') private select_field: MatSelect;\n\n    public get isOpen() {\n        return this.select_field?.panelOpen ?? false;\n    }\n\n    public buildPlaceholder(){\n        return this.isOpen && this.placeholderOpen ? this.placeholderOpen : this.placeholder\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    forwardRef,\n    Input,\n    Output,\n    ViewChild,\n    OnInit\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\n\nimport { MatMenuTrigger } from '@angular/material/menu';\nimport {\n    BehaviorSubject,\n    Observable\n} from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { AcaDatePickerComponent } from '../aca-date-picker/aca-date-picker.component';\n\n@Component({\n    selector: 'mck-date-picker',\n    template: `\n        <div\n            [class.icon-only]=\"icon_only\"\n            [class.mck-form-input]=\"!icon_only\"\n            [class.mck-column]=\"!icon_only\"\n        >\n            <mck-label [required]=\"true\" *ngIf=\"!icon_only\">Date</mck-label>\n            <div\n                [class.mck-date-display]=\"!icon_only\"\n                [class.mck-input]=\"!icon_only\"\n                [class.date-error]=\"invalid\"\n                role=\"button\"\n                form-field\n                tabindex=\"0\"\n                [class.active]=\"is_open\"\n                [attr.disabled]=\"disabled\"\n                (keydown.enter)=\"openDatePicker()\"\n                [matMenuTriggerFor]=\"appMenu\"\n                \n            >\n                <div class=\"display\" *ngIf=\"!icon_only\">{{ dateString | async }}</div>\n                <div class=\"icon\">\n                    <mck-calendar-icon\n                        [fillClass]=\"is_open ? 'mck-icon-fill-open' : 'mck-icon-fill-black'\"></mck-calendar-icon>\n                </div>\n            </div>\n            \n            <mat-menu #appMenu=\"matMenu\" xPosition=\"before\" (close)=\"onDatePickerClose()\">\n                <div mat-menu-item class=\"date-picker mck-column\" (click)=\"$event.stopPropagation()\">\n                    <date-tz-calendar-widget\n                        klass=\"mck-date-picker\"\n                        [ngModel]=\"date | async\"\n                        [options]=\"{ from: from, to: until, day_format: 'EEE' }\"\n                        (ngModelChange)=\"setValue($event); closeDatePicker()\"\n                    ></date-tz-calendar-widget>\n                    <button\n                        mat-stroked-button\n                        color=\"primary\"\n                        class=\"mck-stroked-button today-button\"\n                        (click)=\"goToToday()\"\n                    >Today\n                    </button>\n                </div>\n            </mat-menu>\n        </div>\n    `,\n    styleUrls: ['./mck-date-picker.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => MckDatePickerComponent),\n            multi: true\n        }\n    ]\n})\nexport class MckDatePickerComponent extends BaseDirective implements OnInit, ControlValueAccessor {\n    /** Earliest date available the user is allowed to pick */\n    @Input('from') public _from: number = DateNow(new Date()).ms;\n    /** Latest date available the user is allowed to pick */\n    @Input('to') public _to: number;\n    /** Position of the tooltip */\n    @Input() public position: 'right' | 'left' = 'right';\n    /** Offset of the tooltip */\n    @Input() public offset: 'top' | 'bottom' = 'bottom';\n    /** Whether form control is disabled */\n    @Input() public disabled: boolean;\n    /** Whether to show the calendar tooltip */\n    @Input() public icon_only: boolean = false;\n\n    @Input() public initialDateSelection?: number;\n\n    @Input() public invalid?: boolean;\n\n    @Output() public onSelect = new EventEmitter();\n\n    // R--- or is this the date picker to refactor. too tired.\n    public ngOnInit(): void {\n        if (this.initialDateSelection) {\n            this.writeValue(this.initialDateSelection)\n        }\n    }\n\n    /** Whether to show the calendar tooltip */\n    public show_tooltip: boolean;\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    @ViewChild(MatMenuTrigger, { static: true }) private _trigger: MatMenuTrigger;\n    @ViewChild(AcaDatePickerComponent, {static: true }) private _acaDatePicker: AcaDatePickerComponent;\n\n    /** Currently selected date */\n    public dateValue = new BehaviorSubject<DateTZ>(DateNow(new Date()));\n\n    /** First allowed date on the calendar */\n    public get from(): number {\n        return this._from || DateNow(new Date()).startOfValue('day').ms;\n    }\n\n    /** Current date value */\n    public get until(): number {\n        return this._to || DateNow(new Date()).endOfValue('day').addValue({ years: 1 }).ms;\n    }\n\n    /** Display value for the current date */\n    public get dateString(): Observable<string> {\n        return this.dateValue.pipe(map(d => {\n            const display = d.formatDate('ccc dd MMM yyyy');\n            return `${display}${d.isSameDate(DateNow(new Date()), 'day') ? ' (Today)' : ''}`;\n        }));\n    }\n\n    /** Whether date picker is open */\n    public get is_open(): boolean {\n        return this._trigger.menuOpen;\n    }\n\n    public get date(): Observable<DateTZ> {\n        return this.dateValue;\n\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number) {\n        // Keep hours and minutes of the old date\n        const old_date = this.dateValue.value;\n        const d = new DateTZ({date: new_value})\n        let new_date = d\n            .setValue({ hour: old_date.dateHour, minute: old_date.minutes })\n            .ms;\n        // Check that new date is before from\n        if (new_date < this.from) {\n            new_date = this.from;\n        }\n        const new_d = new DateTZ({ date: new_date })\n        this.dateValue.next(new_d);\n        if (this._onChange) {\n            this._onChange(new_date);\n        }\n        this.onSelect.emit(new_date);\n        this.show_tooltip = false;\n    }\n\n    public goToToday() {\n        this.setValue(DateNow(new Date()).ms);\n    }\n\n    public resetToLastSelection = () => this._acaDatePicker.updateDate();\n\n    public onDatePickerClose() {\n        this.resetToLastSelection();\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        const date = new DateTZ({date: value})\n        this.dateValue.next(date);\n        this.show_tooltip = false;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /** Set the state of the tooltip to closed after delay */\n    public closeDatePicker() {\n        this._trigger.closeMenu();\n    }\n\n    /** Set the state of the tooltip to closed after delay */\n    public openDatePicker() {\n        this._trigger.openMenu();\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output,\n    ViewContainerRef\n} from '@angular/core';\nimport { BaseTemplateComponent } from '../base-template.component';\n\n@Component({\n    selector: 'mck-modal-button-row',\n    template: `\n        <ng-template>\n            <div\n                class=\"button-wrapper\"\n                [class.has-fixed]=\"!disableFixed\">\n                <mck-spacer\n                    [autoSize]=\"true\"\n                    spacerClass=\"mck-spacer-content-expand-mobile mck-spacer-content-divider\"\n                    size=\"1px\">\n                </mck-spacer>\n                <div class=\"mck-row mck-center button-row\" [class.small-buttons]=\"smallButtons\">\n                    <button\n                        *ngIf=\"secondaryLabel\"\n                        mat-stroked-button class=\"mck-secondary-button mck-modal-secondary-button\"\n                        type=\"submit\"\n                        (click)=\"secondarySubmit.emit()\"\n                        [disabled]=\"secondaryDisabled\"\n                    >\n                        {{secondaryLabel}}\n                    </button>\n                    <button\n                        *ngIf=\"primaryLabel\"\n                        mat-button class=\"mck-primary-button mck-modal-primary-button\"\n                        type=\"submit\"\n                        (click)=\"primarySubmit.emit()\"\n                        [disabled]=\"primaryDisabled\"\n                    >\n                        {{primaryLabel}}\n\n                    </button>\n                </div>\n            </div>\n        </ng-template>\n    `,\n    styleUrls: ['./modal-button-row.component.scss']\n})\nexport class ModalButtonRowComponent extends BaseTemplateComponent {\n\n    @Input()\n    primaryLabel?: string;\n\n    /**\n     * Specify if you want to disable the primary button\n     */\n    @Input()\n    primaryDisabled?: boolean = false;\n\n    /**\n     * Used only if primaryLabel is specified.\n     */\n    @Output()\n    public primarySubmit = new EventEmitter();\n\n    /**\n     * Specify if you want to show a secondary label button\n     */\n    @Input()\n    secondaryLabel?: string;\n\n    @Input()\n    disableFixed: boolean = false;\n\n    /**\n     * Specify if you want to disable the secondary button\n     */\n    @Input()\n    secondaryDisabled?: boolean = false;\n\n    /**\n     * Used only if secondaryLabel is specified.\n     */\n    @Output()\n    public secondarySubmit = new EventEmitter();\n\n    @Input()\n    smallButtons?: boolean = false;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n\n}\n","import {\n    Component,\n    Input\n} from '@angular/core';\nimport { MatDialogRef } from '@angular/material/dialog';\n\n@Component({\n    selector: 'mck-modal',\n    template: `\n        <mat-dialog-content class=\"mck-column modal-container\">\n            <div class=\"mck-column modal-top mck-content-expand-width mck-stretch\">\n                <div class=\"button-row\">\n                    <button *ngIf=\"shouldClose\" name=\"CloseButton\" mat-icon-button (click)=\"close()\">\n                        <div class=\"close-image\"></div>\n                    </button>\n                </div>\n                <div class=\"mck-column mck-center\">\n                    <h1 name=\"ModalHeader\" class=\"modal-header\" *ngIf=\"header\">{{header}}</h1>\n                </div>\n            </div>\n            <ng-content></ng-content>\n        </mat-dialog-content>\n    `,\n    styleUrls: ['./modal.component.scss']\n})\nexport class ModalComponent {\n\n    @Input()\n    header?: string;\n    @Input() shouldClose?: boolean = true;\n\n    constructor(private dialogRef: MatDialogRef<ModalComponent>) {\n    }\n\n    public close() {\n        this.dialogRef.close();\n    }\n}\n","import { Component, EventEmitter, Inject, OnInit, Output } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { DialogEvent } from '@mckinsey-converge/base';\nimport { DateTZ, isToday } from '@mckinsey-converge/date-tz';\n\n\n@Component({\n  selector: 'override-changes-modal',\n  templateUrl: './override-changes-modal.component.html',\n  styleUrls: ['./override-changes-modal.component.scss']\n})\nexport class OverrideChangesModalComponent implements OnInit{\n\n  public edits;\n  public timezone;\n\n  @Output() public event = new EventEmitter<DialogEvent>();\n\n  constructor(@Inject(MAT_DIALOG_DATA) private _data: OverrideChangesModalComponent){\n\n  }\n\n  public ngOnInit(){\n      this.edits = this._data.edits.sort((a, b) =>  a - b);\n  }\n\n  public formatDate(date: number) {\n    const dateTZ = new DateTZ({date: date*1000, is_local_tz: false, building_tz: this._data.timezone });\n    const dateIsToday = isToday(dateTZ, this._data.timezone);\n    const display = dateTZ.formatDate('ccc dd MMM yyyy');\n    return `${display}${dateIsToday ? ' (Today)' : ''}`;\n  }\n\n  public continue(): void {\n    this.event.emit({ reason: 'done' });\n  }\n\n  public close(): void {\n    this.event.emit({ reason: 'close' });\n  }\n}","<header class=\"override-header\">\n    <button class=\"hidden\">button3</button>\n    <button mat-icon-button mat-dialog-close>\n        <i [class]=\"\">\n            <svg style=\"width:24px;height:24px\" viewBox=\"0 0 24 24\">\n                <path fill=\"currentColor\" d=\"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z\" />\n            </svg>\n        </i>\n    </button>\n</header>\n<mat-dialog-content #content class=\"mck-column modal-container\">\n    <svg class=\"red-icon\" width=\"48\" height=\"48\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M24 1C11.3 1 1 11.3 1 24C1 36.7 11.3 47 24 47C36.7 47 47 36.7 47 24C47 11.3 36.7 1 24 1ZM32.7 31.3C33.1 31.7 33.1 32.3 32.7 32.7C32.5 32.9 32.3 33 32 33C31.7 33 31.5 32.9 31.3 32.7L24 25.4L16.7 32.7C16.5 32.9 16.3 33 16 33C15.7 33 15.5 32.9 15.3 32.7C14.9 32.3 14.9 31.7 15.3 31.3L22.6 24L15.3 16.7C14.9 16.3 14.9 15.7 15.3 15.3C15.7 14.9 16.3 14.9 16.7 15.3L24 22.6L31.3 15.3C31.7 14.9 32.3 14.9 32.7 15.3C33.1 15.7 33.1 16.3 32.7 16.7L25.4 24L32.7 31.3Z\" fill=\"#D51F31\"/>\n    </svg>\n\n    <h2>Overriding Changes</h2>\n    <p>Editing the series here will override all previous changes made to individual occurrences. Are you sure you want to proceed?</p>\n\n    <table class=\"table\">\n        <thead>\n            <tr>\n                <th>Dates</th>\n            </tr>\n        </thead>\n        <tbody>\n            <tr *ngFor=\"let edit of edits\">\n                <td>{{formatDate(edit)}}</td>\n            </tr>\n        </tbody>\n    </table>\n</mat-dialog-content>\n\n<mat-dialog-actions>\n    <button mat-stroked-button (click)=\"close()\"><span>Back</span></button>\n    <button mat-button (click)=\"continue()\"><span>Yes, Override</span></button>\n</mat-dialog-actions>","import {\n    Pipe,\n    PipeTransform\n} from '@angular/core';\n\n/**\n * Transforms input by returning a subset of items based on if the\n * any items include the search text based on passed objectKey.\n *\n * objectKey can be pipe separated keys. e.g: 'name|age'. Then it will check against all.\n */\n@Pipe({\n    name: 'filter'\n})\nexport class FilterPipe implements PipeTransform {\n    transform(items: any[], searchText: string, objectKey?: string): any[] {\n        if (!items) return [];\n        if (!searchText) return items;\n        searchText = searchText.toLowerCase();\n        const splitKeys = objectKey?.split('|') ?? [];\n        return items.filter(it => {\n            let included = false;\n            splitKeys.forEach((key) => {\n                if (it[key]?.toLowerCase().includes(searchText)) {\n                    included = true;\n                }\n            });\n            if (splitKeys.length === 0) {\n                return it.toLowerCase().includes(searchText);\n            }\n            return included;\n        });\n    }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport {\n    DomSanitizer,\n    SafeHtml,\n    SafeResourceUrl,\n    SafeScript,\n    SafeStyle,\n} from '@angular/platform-browser';\n\nexport enum SecurityContext {\n    NONE = 0,\n    HTML = 1,\n    STYLE = 2,\n    SCRIPT = 3,\n    URL = 4,\n    RESOURCE_URL = 5,\n}\n\n@Pipe({\n    name: 'sanitize',\n})\nexport class SanitizePipe implements PipeTransform {\n    constructor(private sanitizer: DomSanitizer) {}\n\n    transform(\n        value: string,\n        type: 'resource' | 'url' | 'script' | 'style' | 'html' = 'html'\n    ): SafeHtml | SafeResourceUrl | SafeScript | SafeStyle {\n        switch (type) {\n            case 'resource':\n                return (\n                    this.sanitizer.sanitize(\n                        SecurityContext.RESOURCE_URL,\n                        value\n                    ) || ''\n                );\n            case 'url':\n                return (\n                    this.sanitizer.sanitize(SecurityContext.URL, value) || ''\n                );\n            case 'script':\n                return (\n                    this.sanitizer.sanitize(SecurityContext.SCRIPT, value) || ''\n                );\n            case 'style':\n                return (\n                    this.sanitizer.sanitize(SecurityContext.STYLE, value) || ''\n                );\n        }\n        return this.sanitizer.sanitize(SecurityContext.HTML, value) || '';\n    }\n}\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnInit,\n    ViewContainerRef\n} from '@angular/core';\nimport { SelectOption } from '../types';\nimport {\n    ControlValueAccessor,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\nimport { BaseTemplateComponent } from '../base-template.component';\nimport { BehaviorSubject } from 'rxjs';\n\n@Component({\n    selector: 'mck-radio-select',\n    template: `\n        <ng-template>\n            <div class=\"mck-column mck-form-input mck-radio-select\">\n                <mck-label [required]=\"required\">{{label}}</mck-label>\n                <mat-radio-group [disabled]=\"disabled\"\n                                 [value]=\"(value | async).value\"\n                                 (change)=\"setValue($event.value)\">\n                    <mat-radio-button *ngFor=\"let option of options\"\n                                      [value]=\"option.value\">{{option.display}}</mat-radio-button>\n                </mat-radio-group>\n            </div>\n        </ng-template>\n    `,\n    styleUrls: ['./radio-select.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => RadioSelectComponent),\n            multi: true\n        }\n    ]\n})\nexport class RadioSelectComponent extends BaseTemplateComponent implements OnInit, ControlValueAccessor {\n\n    @Input()\n    label: string;\n\n    @Input()\n    required?: boolean;\n\n    @Input()\n    options: SelectOption<any>[];\n\n    public value = new BehaviorSubject<SelectOption<any> | undefined>(undefined);\n\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Form control on change handler */\n    private _onChange: (_: SelectOption<any>) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: SelectOption<any>) => void;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n\n    registerOnChange(fn: any): void {\n        this._onChange = fn;\n    }\n\n    registerOnTouched(fn: any): void {\n        this._onTouch = fn;\n    }\n\n    setDisabledState(isDisabled: boolean): void {\n        this.disabled = isDisabled;\n    }\n\n    public setValue(value: string) {\n        const obj = this.options.find(o => o.value === value);\n        this.writeValue(obj);\n        if (this._onChange) {\n            this._onChange(obj)\n        }\n    }\n\n    writeValue(obj: SelectOption<any>): void {\n        this.value.next(obj);\n    }\n}\n","import { Component, Input, OnInit, ViewChild } from \"@angular/core\";\nimport { FormGroup } from \"@angular/forms\";\nimport { OrganisationService, RecurrencePeriod, RecurrenceType, removeExpiredOcurrences, RepeatsOn } from \"@mckinsey-converge/data-common\";\nimport { DateTZ } from \"@mckinsey-converge/date-tz\";\nimport { first } from \"rxjs/operators\";\nimport { RecurrencePatternForm } from \"../recurrence-pattern-form/recurrence-pattern-form.component\";\n\n@Component({\n    selector: 'recurrence-booking-form',\n    templateUrl: './recurrence-booking-form.component.html',\n    styleUrls: ['./recurrence-booking-form.component.scss']\n})\n\nexport class RecurringBookingForm implements OnInit {\n    /** Form fields for booking */\n    @Input() public form: FormGroup;\n\n    public current_type: RecurrenceType; \n    public recurrence_types: Array<RecurrenceType> = [\n        {type: RepeatsOn.PATTERN, label: 'Repeats on'},\n        {type: RepeatsOn.DATE, label: 'Repeats on specific date'}\n    ]\n\n    public building_tz = \"\";\n\n    @ViewChild(RecurrencePatternForm) pattern_form: RecurrencePatternForm;\n\n    constructor(\n        private _org: OrganisationService,\n    ) {}\n\n    public get recurrencePeriod(){\n        return this.form.get('recurrence_period')\n    }\n\n    public ngOnInit(): void {\n        this._org.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.building_tz = this._org?.building?.timezone || 'America/Chicago';\n        })\n        if(this.recurrencePeriod.value === RecurrencePeriod.LIST){\n            this.current_type = this.recurrence_types[1];\n            removeExpiredOcurrences(this.form)\n        }else{\n            this.current_type = this.recurrence_types[0];\n        }\n    }\n\n    public onChangeType(value: string) {\n        this.current_type = this.recurrence_types.filter((type) => type.type === value)[0]\n        if(this.current_type.type === RepeatsOn.PATTERN){\n            this.recurrencePeriod.setValue(this.pattern_form.recurrencePatternFormControl.value)\n        }else{\n            this.recurrencePeriod.setValue(RecurrencePeriod.LIST)\n        }\n    }\n\n    public dateToBuildingTz(date?: number){\n        return new DateTZ({date, building_tz: this.building_tz, is_local_tz: false})\n    }\n\n    public get error(){\n        const recurrence_starts = this.form.controls.recurrence_starts\n        const recurrence_days = this.form.controls.recurrence_days\n        return recurrence_starts.invalid || recurrence_days.invalid\n    }\n\n}\n","<div class=\"recurrence-form-container\" [class.error-state]=\"error\">\n    <mat-radio-group [value]=\"current_type.type\" (change)=\"onChangeType($event.value)\">\n        <div class=\"type-container\">\n            <!-- the repeats on button -->\n            <mat-radio-button [value]=\"recurrence_types[0].type\">\n                {{recurrence_types[0].label}}\n            </mat-radio-button>\n            <recurrence-pattern-form \n                [disabled]=\"current_type.type !== recurrence_types[0].type\" \n                [form]=\"form\">\n            </recurrence-pattern-form>\n        </div>\n        <div class=\"type-container\">\n            <!-- the repeats on specific date button -->\n            <mat-radio-button [value]=\"recurrence_types[1].type\">\n                {{recurrence_types[1].label}}\n            </mat-radio-button>\n            <recurrence-date-form\n                [disabled]=\"current_type.type !== recurrence_types[1].type\" \n                [form]=\"form\">\n            </recurrence-date-form>\n        </div>\n    </mat-radio-group>\n</div>\n<mck-error-message *ngIf=\"error\">The recurrence pattern is not valid.</mck-error-message>","import { Component, Input, OnInit, ViewChild } from \"@angular/core\";\nimport { FormGroup } from \"@angular/forms\";\nimport { MatMenuTrigger } from \"@angular/material/menu\";\nimport { BaseDirective, closestToTimeSlotTz } from \"@mckinsey-converge/base\";\nimport { OrganisationService } from \"@mckinsey-converge/data-common\";\nimport { DateNow, DateTZ,toMiddayUTC } from \"@mckinsey-converge/date-tz\";\n\n@Component({\n    selector: 'recurrence-date-form',\n    templateUrl: './recurrence-date-form.component.html',\n    styleUrls: ['./recurrence-date-form.component.scss']\n})\n\nexport class RecurrenceDateForm extends BaseDirective implements OnInit {\n    /** Form fields for booking */\n    @Input() public form: FormGroup;\n    @Input() disabled: boolean;\n    @ViewChild(MatMenuTrigger, { static: true }) private _trigger: MatMenuTrigger;\n\n    public selected_dates: Array<DateTZ> = []\n    public timezone: string = '';\n    public nowTz: DateTZ = DateNow(new Date());\n    public fromDateTz: DateTZ = this.nowTz.clone();\n    public untilDateTz: DateTZ = this.fromDateTz.endOfValue('day').addValue({ years: 1 });\n    public dateTz: DateTZ = DateNow(new Date());\n\n    public get recurrenceStarts(){\n        return this.form.get('recurrence_starts');\n    }\n\n    public get formDateTz(){\n        return this.form.get('dateTz');\n    }\n\n    constructor (private _org: OrganisationService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        // Setup some data to only run once, the previous giters were hogs\n        this.timezone = this.form.get('timezone').value;\n        this.nowTz = new DateTZ({ date: Date.now(), is_local_tz: false, building_tz: this.timezone });\n        // R--- The fromDateTz is curious, would it make sense to be based on the form dateTz?\n        this.fromDateTz = this.nowTz.clone()\n        this.untilDateTz = this.fromDateTz.endOfValue('day').addValue({ years: 1 });\n\n        if(this.recurrenceStarts.value){\n            this.selected_dates = this.recurrenceStarts.value.sort((d1: DateTZ, d2: DateTZ) => d1.ms - d2.ms)\n        }\n        this.subscription('ocurrenceChanges',  this.recurrenceStarts.valueChanges\n            .subscribe(() => {\n                this.selected_dates = [...this.recurrenceStarts.value]\n            })\n        ); \n    }\n\n    /**\n     * Add value to the list of selected dates\n     * @param newDateTz\n     */\n    public addDate(newDateTz: DateTZ) {\n        const d = newDateTz.clone();\n        const start_date = this.formDateTz.value;\n        let new_date = d.setValue({hour: start_date.dateHour, minute: start_date.minutes})\n        \n        /**  Prevent user from selecting past dates */\n        if (new_date.isBeforeDate(this.fromDateTz)) {\n            new_date = this.fromDateTz;\n        }\n\n        /** Prevent user from selecting the same date more than once */\n        const is_selected = this.selected_dates.filter((date: DateTZ)=> new_date.isSameDate(date, 'day'))\n        if(is_selected.length){\n            return\n        }\n       \n        this.selected_dates.push(new_date);\n        this.recurrenceStarts.setValue(this.selected_dates.sort((d1, d2) => d1.ms - d2.ms));\n        this.setDateTzForm();\n    }\n\n    /**\n     * \n     * @param dateMsValue: number\n     * @returns  \n     */\n     public setPickerToGivenDate(dateTsValue: DateTZ) {\n        this.fromDateTz = dateTsValue.clone();\n    }\n\n    /**\n     * Function calls on close of date picker without date selection\n     */\n    public onDatePickerClose = () => {\n        this.setPickerToGivenDate(this.nowTz)\n    };\n\n    public goToToday() {\n        this.addDate(this.nowTz);\n        this.setPickerToGivenDate(this.nowTz);\n    }\n\n    public closeDatePicker() {\n        this._trigger.closeMenu();\n    }\n\n    public openDatePicker() {\n        this._trigger.openMenu();\n    }\n\n    public deleteDate(date: DateTZ) {\n        const index = this.selected_dates.map((d: DateTZ) => d.ms).indexOf(date.ms)\n        this.selected_dates.splice(index, 1)\n        this.recurrenceStarts.setValue(this.selected_dates)\n        this.setDateTzForm()\n    }\n\n    public isToday(date) {\n        return new DateTZ({\n            date: toMiddayUTC(date).ms,\n            is_local_tz: false,\n            building_tz: this.timezone,\n        }).isSameDate(\n            new DateTZ({\n                date: Date.now(),\n                is_local_tz: false,\n                building_tz: this.timezone,\n            }),\n            'day'\n        );\n    }\n\n    public formatDate(date: DateTZ){\n        const isToday = this.isToday(date);\n        const display = date.formatDate('ccc dd MMM yyyy');\n\n        return  `${display}${isToday ? ' (Today)' : ''}`;\n    }\n\n    private setDateTzForm(): void {\n        if (this.selected_dates.length === 0)\n            return;\n\n        const tz = this._org.building.timezone;\n        const date_now = DateNow(new Date()).toZone(tz);\n        let dateTz = this.selected_dates[0].clone();\n\n        dateTz = dateTz.setValue({\n            hour: (this.formDateTz.value as DateTZ).hours,\n            minute: (this.formDateTz.value as DateTZ).minutes\n         });\n\n        if (this.selected_dates[0].isSameDate(this.nowTz, \"day\") && dateTz.hours < date_now.hours) {\n            const { minutes: minute, hours: hour } = closestToTimeSlotTz(this.nowTz, 15);\n            dateTz = dateTz.setValue({ minute, hour, second: 0 });\n        }\n\n        this.formDateTz.setValue(dateTz);\n    }\n}\n","<div class=\"type-form\" [class.disabled]=\"disabled\">\n    <table [cellSpacing]=\"0\">\n        <tr>\n            <th>Date</th>\n            <th>Action</th>\n        </tr>\n        <tr *ngFor=\"let date of selected_dates\">\n            <td>{{formatDate(date)}}</td>\n            <td class=\"cell-centered pointer\" (click)=\"deleteDate(date)\">Delete</td>\n        </tr>\n        <tr>\n            <td class=\"underlined pointer\">\n                <div (keydown.enter)=\"openDatePicker()\"\n                [matMenuTriggerFor]=\"appMenu\">[+] Add another date</div>\n                <mat-menu #appMenu=\"matMenu\" xPosition=\"before\"  (closed)=\"onDatePickerClose()\">\n                    <div mat-menu-item class=\"date-picker mck-column\" (click)=\"$event.stopPropagation()\">\n                        <date-tz-calendar-widget\n                            className=\"mck-date-picker\"\n                            [ngModel]=\"fromDateTz\"\n                            [options]=\"{ fromDateTz: fromDateTz, untilDateTz: untilDateTz, day_format: 'EEE' }\"\n                            (ngModelChange)=\"addDate($event); closeDatePicker()\"\n                        ></date-tz-calendar-widget>\n                        <button\n                            mat-stroked-button\n                            color=\"primary\"\n                            class=\"mck-stroked-button today-button\"\n                            (click)=\"goToToday()\"\n                        >Today\n                        </button>\n                    </div>\n                </mat-menu>\n            </td>\n            <td></td>\n        </tr>\n    </table>\n</div>","import { Component, Input, OnInit } from \"@angular/core\";\nimport { FormGroup, Validators } from \"@angular/forms\";\nimport { BaseDirective, closestToTimeSlotTz } from \"@mckinsey-converge/base\";\nimport { arrayWithValues, generateWeekDays, RecurrencePeriod, recurrencePeriodToDurationType, RepeatPeriod, validDateTZ, WeekDays } from \"@mckinsey-converge/data-common\";\nimport { DateNow, DateTZ } from \"@mckinsey-converge/date-tz\";\n\n@Component({\n    selector: 'recurrence-pattern-form',\n    templateUrl: './recurrence-pattern-form.component.html',\n    styleUrls: ['./recurrence-pattern-form.component.scss']\n})\n\nexport class RecurrencePatternForm extends BaseDirective implements OnInit {\n    /** Form fields for booking */\n    @Input() public form: FormGroup;\n    @Input() disabled: boolean;\n\n    /** Range of dates for the Start Date Picker*/\n    public nowTz: DateTZ = DateNow(new Date());\n    public fromStartTz: DateTZ = this.nowTz.setValue({ minute: Math.ceil(this.nowTz.minutes / 5) * 5 });\n    public untilTz: DateTZ = this.nowTz.addValue({ years: 1 }).endOfValue('day');\n    public timezone: string = '';\n    \n\n    /** Range of dates for the End Date Picker*/\n    public fromEndTz: DateTZ;\n\n    public repeat_period_options: Array<RepeatPeriod> = [\n        {label: 'Day', id: RecurrencePeriod.DAILY},\n        {label: 'Week',id: RecurrencePeriod.WEEKLY},\n        {label: 'Month', id: RecurrencePeriod.ABSOLUTE_MONTHLY}\n    ]\n    public week_days: Array<WeekDays> = []\n\n    public repeat_every_options\n\n\n    public get recurrenceDateStartTzFormControl() {\n        return this.form.get('dateTz')\n    }\n\n    public get recurrenceEndFormControl(){\n        return this.form.get('recurrence_endTz')\n    }\n\n    public get recurrencePeriodFormControl(){\n        return this.form.get('recurrence_period')\n    }\n\n    public get recurrenceIntervalFormControl(){\n        return this.form.get('recurrence_interval')\n    }\n\n    public get recurrencePatternFormControl(){\n        return this.form.get('recurrence_pattern')\n    }\n\n    public get recurrenceDaysFormControl(){\n        return this.form.get('recurrence_days')\n    }\n\n    public ngOnInit(): void {\n        // Setup some data to only run once, the previous giters were hogs\n        this.timezone = this.form.get('timezone').value;\n        this.nowTz = new DateTZ({ date: Date.now(), is_local_tz: false, building_tz: this.timezone });\n        // R--- The from date is curious, why isn't it based on the form dateTz?\n        this.repeat_every_options = new Array(1)\n        this.fromStartTz = closestToTimeSlotTz(this.nowTz, 15)\n        this.untilTz = this.nowTz.addValue({ years: 1 }).endOfValue('day');\n        this.fromEndTz = this.fromStartTz.addValue({days: 1})\n\n        this.setEndDateFromStartDate(this.recurrenceDateStartTzFormControl.value) //make sure end date is after start date\n\n        if(!this.recurrencePeriodFormControl.value){\n            this.recurrencePeriodFormControl.setValue(RecurrencePeriod.WEEKLY)\n        }\n\n        if(this.recurrencePeriodFormControl.value !== RecurrencePeriod.LIST){\n            this.recurrencePatternFormControl.setValue(this.recurrencePeriodFormControl.value)\n        }\n\n        this.week_days = generateWeekDays(this.recurrenceDateStartTzFormControl.value.ms, { building_tz: this.fromStartTz.building_tz })\n        this.generateMaxIntervals()\n\n        if(this.recurrenceDaysFormControl.value.length > 0){\n            this.week_days = this.week_days.map((day) => \n                ({...day, active: this.recurrenceDaysFormControl.value.includes(day.full_name)})\n            )\n        }\n\n        if(!this.recurrenceDaysFormControl.value.length && this.recurrencePeriodFormControl.value === RecurrencePeriod.WEEKLY){\n            const current_days = this.week_days.filter((day) => day.active).map((day)=>day.full_name)\n            this.recurrenceDaysFormControl.setValue(current_days)\n        }\n\n        this.generateOcurrenceList()\n\n        this.subscription('startTimeChanges',  this.recurrenceDateStartTzFormControl.valueChanges\n            .subscribe((next) => {\n                this.setEndDateFromStartDate(next)               \n            })\n        );\n\n        this.subscription('endTimeChanges',  this.recurrenceEndFormControl.valueChanges\n            .subscribe(() => {\n                this.generateMaxIntervals();\n            })\n        );\n        \n        this.subscription('recurrencePeriodFormControlChanges',  this.recurrencePeriodFormControl.valueChanges\n            .subscribe(() => {\n                this.generateMaxIntervals();\n            })\n        );  \n    }\n\n    public setEndDateFromStartDate(startDateTz: DateTZ){\n        let end_date = this.recurrenceEndFormControl.value.setValue({hour: startDateTz.dateHour, minute: startDateTz.minutes})\n\n        /**Update the End date picker range */\n        this.fromEndTz = startDateTz.isSameDate(this.untilTz,'day') ? startDateTz : startDateTz.addValue({days: 1})\n\n        if(end_date.isBeforeDate(this.fromEndTz)){\n            end_date = this.fromEndTz\n        }\n\n        this.recurrenceEndFormControl.setValue(end_date)\n\n        this.generateMaxIntervals()\n        this.updateActiveWeekday() \n    }\n\n    public setRepeatPeriod(value: RecurrencePeriod){\n        this.updateValidators(value)\n        this.recurrencePeriodFormControl.setValue(value);\n        this.recurrencePatternFormControl.setValue(value);\n        this.recurrenceIntervalFormControl.setValue(1)\n        this.generateOcurrenceList();\n    }\n\n    public setRepeatEvery(value: number){\n        this.recurrenceIntervalFormControl.setValue(value)\n        this.generateOcurrenceList()\n    }\n\n    public repeatTimeString(value: string){\n        return this.recurrenceIntervalFormControl.value !== 1 ? `${value}(s)` : value\n    }\n\n    public get displayWeekdays(){\n        return this.recurrencePatternFormControl.value === RecurrencePeriod.WEEKLY\n    }\n\n    /* Check if selected interval is valid and reset to 1 if not*/\n    private validateRecurrenceInterval = () => {\n        if(this.repeat_every_options.length < this.recurrenceIntervalFormControl.value){\n            this.recurrenceIntervalFormControl.setValue(1)\n        }    \n    };\n\n    /**\n     * Generate max value for dorpdown interval\n     */\n    public generateMaxIntervals(){\n        const start = this.recurrenceDateStartTzFormControl.value;\n        const date_diff = this.recurrenceEndFormControl.value.dateDiff(start, this.periodToDurationType, this.periodToDurationType)\n        //If no diff default to 1\n        this.repeat_every_options = new Array(Math.round(date_diff) || 1)\n        this.validateRecurrenceInterval();\n        if(this.recurrencePeriodFormControl.value !== RecurrencePeriod.LIST){\n            this.generateOcurrenceList()\n        }\n    }\n\n    /**\n     * Generate ocurrence list base on the selected interval\n     */\n    public generateOcurrenceList() {\n\n        /**If selected period is list then we don't want \n         * to generate a list based on the repeats on selections*/\n        if(this.recurrencePeriodFormControl.value === RecurrencePeriod.LIST){\n            return\n        }\n\n        const occurrence = []\n        const first_date = this.recurrenceDateStartTzFormControl.value;\n        let start = first_date\n        const end = this.recurrenceEndFormControl.value;\n        const interval = this.recurrenceIntervalFormControl.value\n        const recurr_days = this.week_days.filter(day => day.active)\n        /**\n         * isLastDayOfMonth : Boolean\n         *  flag - to generate last day of every month in case of day or month reccuring booking if start date is last day of month\n         */\n        //  const isLastDayOfMonth = first_date.date.day === first_date.date.daysInMonth && this.recurrencePeriodFormControl.value === RecurrencePeriod.ABSOLUTE_MONTHLY;\n        const isLastDayOfMonth = first_date.dateDay === 31 && this.recurrencePeriodFormControl.value === RecurrencePeriod.ABSOLUTE_MONTHLY ;\n        \n        if(this.recurrencePeriodFormControl.value === RecurrencePeriod.WEEKLY){\n            start = start.startOfValue('week')\n        }\n\n        while (end.dateDiff(start.startOfValue('day'), this.periodToDurationType, this.periodToDurationType) >= 0) {\n            \n            if(this.recurrencePeriodFormControl.value !== RecurrencePeriod.WEEKLY){\n                occurrence.push(start) \n                start = start.addValue({[this.periodToDurationType]: interval}, isLastDayOfMonth);\n               /**\n                * IF - should only consider resetting start under mentioned condition of ticket - https://acaprojects.atlassian.net/browse/MCK-2085\n                *  In summery - If user select any date except 31st, other months in the series (no matter 30 or 31 day month) should have same date select as start date.\n                *  If user select 31st as an start date, other month in the seleries should have select last day of the month (30th/31st/28th/29th).\n                *  Exception for February - February should select 28th or 29th  If in above both selection includes date between 28th - 31st.\n                * \n                */\n                if(start.dateDay !== first_date.dateDay && start.dateDay !== start.date.daysInMonth && this.recurrencePeriodFormControl.value === RecurrencePeriod.ABSOLUTE_MONTHLY) {\n                    start = start.setValue({day: first_date.dateDay});\n                }   \n            }else {\n                recurr_days.forEach((day)=>{\n                    const date = start.addValue({days: day.day_index})\n                    if((date.isAfterDate(first_date) || date.isSameDate(first_date, 'day')) && \n                      (date.isBeforeDate(end) || date.isSameDate(end, 'day'))){\n                        occurrence.push(date)\n                    }\n                })\n                start = start.addValue({[this.periodToDurationType]: interval})\n            }\n        }\n\n        this.form.controls.recurrence_count.setValue(occurrence.length)\n        this.form.controls.recurrence_starts.setValue(occurrence.sort((d1, d2) => d1.ms - d2.ms))\n        \n    }\n\n    public get periodToDurationType(){\n        const period = this.recurrencePeriodFormControl.value\n        return recurrencePeriodToDurationType(period)\n    }\n\n    /**\n     * Update active weekday in the weekdays array\n     */\n     private updateActiveWeekday() {\n        const _week_days = this.week_days.map((day)=>{\n            if(this.recurrenceDaysFormControl.value.includes(day.full_name)){\n                return {...day, active: true}\n            }else{\n                return {...day, active: false}\n            }\n        })\n        this.week_days = [..._week_days]         \n    }\n\n    public setWeekDays(new_day: WeekDays){\n        const days = this.recurrenceDaysFormControl.value\n        if(this.disabled){\n            return\n        }\n\n        if(!new_day.active){\n            days.push(new_day.full_name)\n        }else{\n            const current_index = days.indexOf(new_day.full_name)\n            days.splice(current_index,1)\n        }\n        this.recurrenceDaysFormControl.setValue([...days])\n        this.updateActiveWeekday()\n        this.generateOcurrenceList()\n    }\n\n    /**Update the recurrence days validator if period changes */\n    public updateValidators(value: RecurrencePeriod){\n        if(value === RecurrencePeriod.WEEKLY && this.recurrencePeriodFormControl.value !== RecurrencePeriod.WEEKLY){\n            const arrayValidators = [Validators.required];\n            arrayValidators.push(arrayWithValues);\n            this.recurrenceDaysFormControl.setValidators(arrayValidators);\n            this.recurrenceDaysFormControl.updateValueAndValidity();\n        }else if(value !== RecurrencePeriod.WEEKLY && this.recurrencePeriodFormControl.value === RecurrencePeriod.WEEKLY){\n            this.recurrenceDaysFormControl.clearValidators();\n            this.recurrenceDaysFormControl.updateValueAndValidity();\n        }\n    }\n}\n","<div class=\"type-form\" [formGroup]=\"form\" [class.disabled]=\"disabled\">\n    <div class=\"date-field\">\n        <label i18n=\"Booking form start date label\">Start date<span>*</span> </label>\n        <date-tz-date-picker\n            class=\"mck-form-input time-inputs-calendar\"\n            formControlName=\"dateTz\"\n            [fromDateTz]=\"fromStartTz\"\n            [untilDateTz]=\"untilTz\"\n            [disabled]=\"disabled\"\n            [invalid]=\"recurrenceDateStartTzFormControl.invalid\">\n        </date-tz-date-picker>\n        <mck-error-message *ngIf=\"recurrenceDateStartTzFormControl.invalid\">Date and time must be in the future</mck-error-message>\n    </div>\n    <div class=\"date-field\">\n        <label i18n=\"Booking form end date label\">End date<span>*</span> </label>\n        <date-tz-date-picker\n            class=\"mck-form-input time-inputs-calendar\"\n            formControlName=\"recurrence_endTz\"\n            [fromDateTz]=\"fromEndTz\"\n            [untilDateTz]=\"untilTz\"\n            [disabled]=\"disabled\"\n            [invalid]=\"recurrenceEndFormControl.invalid\">\n        </date-tz-date-picker>\n        <mck-error-message *ngIf=\"recurrenceEndFormControl.invalid\">Date and time must be in the future</mck-error-message>\n    </div>\n    <div class=\"pattern-container\">\n        <div class=\"flex-column repeat-every\">\n            <label i18n=\"Booking form repeat time label\">Repeats every<span>*</span> </label>\n            <div class=\"flex-row\">\n                <mat-form-field appearance=\"outline\">\n                    <mat-select #select [value]=\"recurrenceIntervalFormControl.value\" [disabled]=\"disabled\" (valueChange)=\"setRepeatEvery($event)\">\n                        <mat-option *ngFor=\"let in of repeat_every_options;let i = index\" [value]=\"i + 1\">\n                            {{ i + 1}}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select #select [value]=\"recurrencePatternFormControl.value\" [disabled]=\"disabled\" (valueChange)=\"setRepeatPeriod($event)\">\n                        <mat-option *ngFor=\"let option of repeat_period_options\" [value]=\"option.id\">\n                            {{ repeatTimeString(option.label) }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n        </div>\n        <div class=\"flex-column repeat-on\" *ngIf=\"displayWeekdays\">\n            <label i18n=\"Booking form repeat on label\">On</label>\n            <div class=\"flex-row\">\n                <div \n                class=\"week-day\" \n                *ngFor=\"let day of week_days\" \n                [class.active-weekday]='day.active'\n                (click)=\"setWeekDays(day)\">\n                    {{day.id}}\n                </div>    \n            </div>\n        </div>\n    </div>\n</div>","import {\n    Component,\n    Input,\n    ViewContainerRef\n} from '@angular/core';\nimport { BaseTemplateComponent } from '../base-template.component';\nimport { SelectOption } from '../types';\n\n@Component({\n    selector: 'mck-select-option',\n    template: `\n        <ng-template>\n            <div\n                *ngIf=\"option\"\n                [ngClass]=\"{ 'mck-ignore-disabled': ignoreDisabled }\"\n                class=\"mck-row mck-select-option-{{selected ? 'selected' : 'unselected'}} mck-select-option mck-center-align\">\n                <mck-spacer\n                    [autoSize]=\"true\"\n                    size=\"5px\"\n                    class=\"mck-select-option-bar\"\n                    [mode]=\"'vertical'\"></mck-spacer>\n                <ng-content></ng-content>\n                {{ option.display }}\n            </div>\n        </ng-template>\n    `,\n    styleUrls: ['./select-option.component.css']\n})\nexport class SelectOptionComponent extends BaseTemplateComponent {\n\n    @Input()\n    option: SelectOption<any>;\n\n    @Input()\n    selected: boolean;\n\n    /**\n     * If true, we still display as if it wasn't disabled.\n     */\n    @Input()\n    ignoreDisabled = false;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n\n}\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport {\n    BehaviorSubject,\n    combineLatest\n} from 'rxjs';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { map } from 'rxjs/operators';\nimport { MatSelect } from '@angular/material/select';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\n\n@Component({\n    selector: 'mck-select',\n    templateUrl: './select.component.html',\n    styleUrls: ['./select.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => SelectComponent),\n            multi: true\n        }\n    ],\n    encapsulation: ViewEncapsulation.None\n})\nexport class SelectComponent implements OnInit, OnChanges, ControlValueAccessor {\n\n    @Input()\n    public label: string;\n\n    @Input()\n    public required: boolean;\n\n    @Input()\n    public options: SelectOption<any>[] = [];\n\n    @Input()\n    public selectedValue: SelectOption<any> | undefined;\n\n    /**\n     * When true, can filter by searching on the input.\n     */\n    @Input()\n    public searchEnabled = false;\n\n    @Input()\n    public splitDisplay = false;\n\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n\n    @Input()\n    public noEntriesFoundLabel: string;\n\n    @Input()\n    public showDivider: boolean = false\n\n    /** Form control on change handler */\n    private _onChange: (_: SelectOption<any>) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: SelectOption<any>) => void;\n\n    public filterFormControl: FormControl = new FormControl();\n\n    public value = new BehaviorSubject<string | undefined>(this.selectedValue || this.options[0]?.value);\n\n    /** Available time blocks for the selected date */\n    public _options = new BehaviorSubject<SelectOption<any>[]>(this.options);\n\n    /** Select field for selecting the value */\n    @ViewChild('select') private select_field: MatSelect;\n\n    public selectedOption = combineLatest([this._options, this.value]).pipe(\n        map(([options, value]) => options.find(o => o.value === value))\n    );\n\n    public placeHolderOption = this._options.pipe(\n        map(os => os.length > 0 && os[0])\n    );\n\n    public isSelected(option: SelectOption<any>) {\n        return this.value.pipe(map(t => t === option.value));\n    }\n\n    public get isOpen() {\n        return this.select_field?.panelOpen ?? false;\n    }\n\n\n    constructor() {\n    }\n\n    public ngOnInit(): void {\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.options) {\n            this._options.next(this.options);\n            this.value.next(this.selectedValue || this.options?.[0]?.value);\n        }\n        if (changes.selectedValue) {\n            this.value.next(this.selectedValue?.value);\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: string): void {\n        this.value.next(new_value);\n        if (this._onChange) {\n            this._onChange(this.options.find(f => f.value === new_value));\n        }\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: SelectOption<any> | null) {\n        if (value != null) {\n            this.value.next(value.value);\n        }\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: SelectOption<any>) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: SelectOption<any>) => void): void {\n        this._onTouch = fn;\n    }\n\n}\n","<div class=\"mck-column mck-form-input\" [class.disabled]=\"disabled\">\n    <mck-label [required]=\"required\">{{label}}</mck-label>\n    <mat-form-field\n        appearance=\"outline\"\n        class=\"mck-center-suffix\">\n        <mat-select\n            #select\n            [placeholder]=\"(placeHolderOption | async)?.display\"\n            panelClass=\"mck-select-panel\"\n            [value]=\"value | async\"\n            [disabled]=\"disabled\"\n            (valueChange)=\"setValue($event)\"\n            disableOptionCentering>\n            <mat-option *ngIf=\"searchEnabled\">\n                <ngx-mat-select-search\n                    noEntriesFoundLabel=\"{{noEntriesFoundLabel}}\"\n                    [placeholderLabel]=\"(selectedOption | async)?.display\"\n                    [formControl]=\"filterFormControl\"></ngx-mat-select-search>\n            </mat-option>\n            <mat-option\n                *ngFor=\"let option of _options | async | filter: (filterFormControl.valueChanges | async): 'display'\"\n                [value]=\"option.value\">\n                <mck-select-option\n                    [option]=\"option\"\n                    [selected]=\"isSelected(option) | async\"\n                ></mck-select-option>\n            </mat-option>\n        </mat-select>\n        <mck-spacer\n            *ngIf=\"showDivider\"\n            size=\"1px\"\n            [mode]=\"'vertical'\"\n            spacerClass=\"legend-divider select-divider\"></mck-spacer>\n        <div class=\"mck-column select-chevron\">\n            <mck-chevron-icon [up]=\"isOpen\" matSuffix fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n        </div>\n    </mat-form-field>\n</div>\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output\n} from '@angular/core';\n\n@Component({\n    selector: 'mck-selected-chip-count',\n    template: `\n        <div\n            (click)=\"close.emit()\"\n            class=\"mck-row mck-center selected-count-chip\">\n            <span>{{count}}</span>\n            <mck-close-icon fillClass=\"mck-icon-fill-black\"></mck-close-icon>\n        </div>\n    `,\n    styleUrls: ['./selected-chip-count.component.scss']\n})\nexport class SelectedChipCountComponent {\n\n    @Input()\n    count: number;\n\n    @Output()\n    close = new EventEmitter<void>();\n\n}\n","import {\n    Component,\n    Input,\n    OnInit,\n    ViewContainerRef\n} from '@angular/core';\nimport { BaseTemplateComponent } from '../base-template.component';\n\nexport enum SpacerMode {\n    /**\n     * If vertical, it expands in the vertical direction. Size is width.\n     */\n    Vertical = 'vertical',\n    /**\n     * If horizontal, it expands in the horizontal direction. Size is height.\n     */\n    Horizontal = 'horizontal',\n}\n\n@Component({\n    selector: 'mck-spacer',\n    template: `\n        <ng-template>\n            <div class=\"mck-spacer-content {{spacerClass}}\"\n                 *ngIf=\"mode === SpacerMode.Vertical\"\n                 [ngStyle]=\"{ width: size, height: autoSize ? 'auto' : '100%'}\">\n            </div>\n            <div class=\"mck-spacer-content {{spacerClass}}\"\n                 *ngIf=\"mode === SpacerMode.Horizontal\"\n                 [ngStyle]=\"{ height: size, width: autoSize ? 'auto' : '100%'}\">\n            </div>\n        </ng-template>\n    `,\n    styleUrls: ['./spacer.component.css'],\n})\nexport class SpacerComponent extends BaseTemplateComponent implements OnInit {\n    SpacerMode = SpacerMode;\n\n    @Input()\n    size: string;\n\n    @Input()\n    mode: SpacerMode = SpacerMode.Horizontal;\n\n    @Input()\n    autoSize?: boolean;\n\n    @Input()\n    spacerClass?: string;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n\n\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    OnInit,\n    Output\n} from '@angular/core';\nimport { SelectOption } from '@mckinsey-converge/ui';\n\n@Component({\n    selector: 'mck-switch-group',\n    template: `\n        <div class=\"mck-column mck-content-expand-width mck-stretch switch-container\">\n            <span\n                id=\"{{title}}\"\n                class=\"switch-title\">{{title}}</span>\n            <mat-slide-toggle\n                class=\"mck-slide-toggle\"\n                labelPosition=\"before\"\n                name=\"{{title}} - toggle - {{option.display}}\"\n                *ngFor=\"let option of options\"\n                (change)=\"onCheckedChange(option)\"\n                [checked]=\"isSelected(option)\">{{option.display}}</mat-slide-toggle>\n        </div>\n    `,\n    styleUrls: ['./switch-group.component.scss']\n})\nexport class SwitchGroupComponent implements OnInit {\n\n    @Input()\n    title: string;\n\n    @Input()\n    options: SelectOption<any>[];\n\n    @Input()\n    selectedOptions: SelectOption<any>[] = [];\n\n    @Output()\n    optionChecked = new EventEmitter<SelectOption<any>>();\n\n    constructor() {\n    }\n\n    ngOnInit(): void {\n    }\n\n    public onCheckedChange(option: SelectOption<any>) {\n        this.optionChecked.emit(option);\n    }\n\n    public isSelected(option: SelectOption<any>) {\n        return !!this.selectedOptions.find(s => s.value === option.value);\n    }\n}\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\nimport { MatSelect } from '@angular/material/select';\n\nimport {\n    BaseDirective,\n    closestToTimeSlot,\n    nearestStepToInput,\n    timeWithGmtOffsetFormatString\n} from '@mckinsey-converge/base';\n\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { generateAvailableTimes } from '../utils/time.utils';\nimport {\n    BehaviorSubject,\n    combineLatest\n} from 'rxjs';\nimport {\n    filter,\n    map,\n    withLatestFrom\n} from 'rxjs/operators';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { DateTime } from 'luxon';\n\n@Component({\n    selector: 'mck-time-field',\n    template: `\n        <div class=\"mck-column mck-form-input\">\n            <mck-label [required]=\"required\">{{label}}</mck-label>\n            <mat-form-field\n                appearance=\"outline\"\n                class=\"mck-center-suffix\">\n                <mat-select\n                    #select\n                    [placeholder]=\"(placeHolderOption | async)?.display\"\n                    panelClass=\"mck-select-panel\"\n                    [value]=\"value | async\"\n                    [disabled]=\"disabled\"\n                    (valueChange)=\"setValue($event)\"\n                    disableOptionCentering>\n                    <mat-option>\n                        <ngx-mat-select-search\n                            noEntriesFoundLabel=\"No timeslots found for current search. Try selecting one in the dropdown.\"\n                            [placeholderLabel]=\"(selectedOption | async)?.display\"\n                            [formControl]=\"filterFormControl\"></ngx-mat-select-search>\n                    </mat-option>\n                    <mat-option\n                        *ngFor=\"let option of options | async | filter: (nearestStep | async): 'shortDisplay'\"\n                        [value]=\"option.value\">\n                        <mck-select-option\n                            [option]=\"option\"\n                            [selected]=\"isSelected(option) | async\"\n                        ></mck-select-option>\n                    </mat-option>\n                </mat-select>\n                <div class=\"mck-column\">\n                    <mck-chevron-icon [up]=\"isOpen\" matSuffix fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n                </div>\n            </mat-form-field>\n        </div>\n    `,\n    styleUrls: ['./time-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => TimeFieldComponent),\n            multi: true\n        }\n    ],\n    encapsulation: ViewEncapsulation.None\n})\nexport class TimeFieldComponent extends BaseDirective implements OnInit, OnChanges, ControlValueAccessor {\n    @Input()\n    public label: string;\n    @Input()\n    public required: boolean;\n    /** Time step between each allowed time option */\n    @Input() public step = 15;\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Whether past times are allowed */\n    @Input() public noPastTimes = true;\n    /** Representing the date from start **/\n    @Input() public from: number;\n    /** Representing desired timezone **/\n    @Input() public timezone?: string = new DateTZ({ date: Date.now() }).local_tz;\n\n    // R-- Which time field is going to be used, there's too many\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    /** Select field for selecting the time */\n    @ViewChild('select') private select_field: MatSelect;\n\n    /** String representing the currently set date */\n    public date = new BehaviorSubject(DateNow(new Date()).ms);\n\n    public filterFormControl: FormControl = new FormControl();\n\n    public nearestStep = combineLatest([\n        this.filterFormControl.valueChanges,\n        this.date]).pipe(\n        map(([value, date]) => nearestStepToInput(this.step, value, DateTime.now().valueOf()))\n    );\n\n    /** String representing the currently set time */\n    public value = new BehaviorSubject<string>(closestToTimeSlot(DateTime.now(), this.step).toFormat('HH:mm'));\n\n    /** Available time blocks for the selected date */\n    public options = new BehaviorSubject<SelectOption<any>[]>(generateAvailableTimes(DateNow(new Date()).ms, !this.noPastTimes, this.step, this.timezone));\n\n    public selectedOption = combineLatest([this.options, this.value]).pipe(\n        map(([options, value]) => options.find(o => o.value === value))\n    );\n\n    public placeHolderOption = this.options.pipe(\n        map(os => os.length > 0 && os[0])\n    );\n\n    public isSelected(option: SelectOption<any>) {\n        return this.value.pipe(map(t => t === option.value));\n    }\n\n    public get isOpen() {\n        return this.select_field?.panelOpen ?? false;\n    }\n\n    public ngOnInit(): void {\n        // Generate the time input options for the booking date\n        this.options.next(generateAvailableTimes(this.date.value, !this.noPastTimes, this.step, this.timezone));\n\n        // Subscribe to selected option changes\n        this.subscription('dateTimeChanges',\n            combineLatest([\n                this.date\n            ]).pipe(\n                map(([date]) => {\n                    // R--- The time input needing to be TZ aware.\n                    const closestTimeSlot = closestToTimeSlot(DateTime.fromMillis(date.valueOf()), this.step);\n                    // Need to return the date with building timezone or the HH:mm representation will no match the option values\n                    return new DateTZ({date: closestTimeSlot.valueOf(), is_local_tz:false, building_tz: this.timezone});\n                }),\n                withLatestFrom(this.options),\n                filter(([date, timeOptions]: [DateTZ, SelectOption<any>[]]) => {\n                    // if new time slot opened up when date / time changes, add it here.\n                    return !timeOptions.find(t => t.value === date.formatDate('HH:mm'));\n                }),\n                map(([date, timeOptions]) => {\n                    // TODO probably an issue here with going from a future date and time earlier than now back to day showing null\n                    // Push the current date option in\n                    timeOptions.push({\n                        display: timeWithGmtOffsetFormatString(date),\n                        value: date.formatDate('HH:mm')\n                    });\n                    // Sort the time options\n                    timeOptions.sort((a, b) => `${a.value}`.localeCompare(`${b.value}`));\n                    return timeOptions;\n                })\n            ).subscribe(next => this.options.next(next)));\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.no_past_times || changes.step || changes.timezone) {\n            // If there's a new date value then update the time options\n            this.options.next(generateAvailableTimes(this.date.value, !this.noPastTimes, this.step, this.timezone));\n            const buildingDate = new DateTZ({date: this.from, is_local_tz: false, building_tz: this.timezone}).startOfValue('minute');\n            this.value.next(buildingDate.formatDate('HH:mm'));\n        }\n        if (changes.from) {\n            // When the from input param changes update the date value\n            this.date.next(this.from);\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: string): void {\n        // value comes in as a HH:mm string\n        const newTime = (new_value.indexOf(':') > 0 ? new_value : '00:00').split(':');\n        // need the date with the building timezone so the hour set is relative to there and not local.\n        const d = new DateTZ({ date: this.date.value, is_local_tz: false, building_tz: this.timezone });\n        const date = d.setValue({ hour: parseInt(newTime[0]), minute: parseInt(newTime[1]) });\n        if (date) {\n            if (this._onChange) {\n                this._onChange(date.ms);\n            }\n        }\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number | null) {\n        if (value != null) {\n            // Time input value in building time milliseconds\n            this.date.next(value);\n            // Get the closest time to slot in case the browser was idle and elapse the valid times\n            const date = closestToTimeSlot(DateTime.fromMillis(value).startOf('minute'), this.step);\n            // Need the building time so HH:mm is correct\n            const buildingDate = new DateTZ({date: date.valueOf(), is_local_tz: false, building_tz: this.timezone}).startOfValue('minute');\n            this.options.next(generateAvailableTimes(buildingDate.ms, !this.noPastTimes, this.step, this.timezone));\n        }\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output\n} from '@angular/core';\nimport { SelectOption } from '@mckinsey-converge/ui';\n\n@Component({\n    selector: 'mck-toggle',\n    template: `\n        <div class=\"mck-row toggle-container\">\n            <button\n                name=\"{{option.display}}\"\n                class=\"mck-toggle-button {{isSelected(option) ? 'mck-toggle-button-selected' : ''}}\"\n                mat-ripple\n                (click)=\"onTapOption(option)\"\n                *ngFor=\"let option of options\">{{option.display}}</button>\n        </div>\n    `,\n    styleUrls: ['./toggle.component.scss']\n})\nexport class ToggleComponent {\n\n    @Input()\n    options: SelectOption<any>[];\n\n    @Input()\n    selected: SelectOption<any>;\n\n    @Output()\n    selectedChange = new EventEmitter<SelectOption<any>>();\n\n    public onTapOption(option: SelectOption<any>) {\n        this.selectedChange.emit(option);\n    }\n\n    isSelected(option: SelectOption<any>) {\n        return this.selected === option;\n    }\n}\n","export { AlertMode, AlertBannerDisplay } from './alert-banner/alert-banner.component';\nexport { SelectOption } from './options/select-option';\nexport * from './cng-select/dropdown-panel';","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatSelectModule } from '@angular/material/select';\nimport { AutoCompleteChipSelectItemComponent } from './auto-complete-chip-select-item/auto-complete-chip-select-item.component';\nimport { AutoCompleteSelectOptionComponent } from './auto-complete-select-option/auto-complete-select-option.component';\nimport {\n    FormsModule,\n    ReactiveFormsModule\n} from '@angular/forms';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { NgxMatSelectSearchModule } from 'ngx-mat-select-search';\nimport { RadioSelectComponent } from './radio-select/radio-select.component';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatRippleModule } from '@angular/material/core';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\nimport { FilterPipe } from './pipes/filter.pipe';\nimport { MatIconModule } from '@angular/material/icon';\nimport { TimeFieldComponent } from './time-field/time-field.component';\nimport { DateTzTimeFieldComponent } from './date-tz-time-field/date-tz-time-field.component';\nimport { SpacerComponent } from './spacer/spacer.component';\nimport { DurationFieldComponent } from './duration-field/duration-field.component';\nimport { DateTzDurationFieldComponent } from './date-tz-duration-field/date-tz-duration-field.component';\nimport { AcaDatePickerComponent } from './aca-date-picker/aca-date-picker.component'; // the old widget\nimport { MckDatePickerComponent } from './mck-date-picker/mck-date-picker.component'; // the old form field \nimport { DateTzCalendarWidgetComponent } from './date-tz-calendar-widget/date-tz-calendar-widget.component'; // the new widget\nimport { DateTzDatePickerComponent } from './date-tz-date-picker/date-tz-date-picker.component'; // the new form field \nimport { CalendarIconComponent } from './icons/calendar/calendar-icon.component';\nimport { ChevronIconComponent } from './icons/calendar/chevron-icon.component';\nimport { SelectOptionComponent } from './select-option/select-option.component';\nimport { CloseIconComponent } from './icons/close/close-icon.component';\nimport { SelectedChipCountComponent } from './selected-chip-count/selected-chip-count.component';\nimport { AlertBannerComponent } from './alert-banner/alert-banner.component';\nimport { ErrorMessageComponent } from './error-message/error-message.component';\nimport { ToggleComponent } from './toggle/toggle.component';\nimport { LabelComponent } from './label/label.component';\nimport { ModalComponent } from './modal/modal.component';\nimport { CollapseHeaderComponent } from './collapse-header/collapse-header.component';\nimport { MatExpansionModule } from '@angular/material/expansion';\nimport { SwitchGroupComponent } from './switch-group/switch-group.component';\nimport { ModalButtonRowComponent } from './modal-button-row/modal-button-row.component';\nimport { InformationalImageComponent } from './informational-image/informational-image.component';\nimport { GroupHeaderPipe } from './auto-complete-chip-select-item/groupHeader.pipe';\nimport { SelectComponent } from './select/select.component';\nimport { LegendDropdownComponent } from './legend-dropdown/legend-dropdown.component';\nimport { NgxSkeletonLoaderModule } from 'ngx-skeleton-loader';\nimport { RecurrencePatternForm } from './recurrence-pattern-form/recurrence-pattern-form.component'; \nimport { RecurrenceDateForm } from './recurrence-date-form/recurrence-date-form.component';\nimport { ConflictsModalComponent } from './conflicts-modal/conflicts-modal.component';\nimport { RecurringBookingForm } from './recurrence-booking-form/recurrence-booking-form.component';\nimport { OverrideChangesModalComponent } from './override-changes-modal/override-changes-modal.component';\nimport { SanitizePipe } from './pipes/sanitise.pipe';\nimport { ConflictAlertModalComponent } from './conflict-alert-modal/conflict-alert-modal.component';\nimport { CngSelectComponent } from './cng-select/cng-select.component';\nimport { OverlayModule } from '@angular/cdk/overlay';\nimport { DropdownTriggerForDirective } from './cng-select/dropdown-trigger-for.directive';\nimport { CngSelectOptionsComponent } from './cng-select/cng-select-options.component';\n\nexport const MATERIAL_MODULES: any[] = [\n    MatButtonModule,\n    MatSnackBarModule,\n    MatDialogModule,\n    MatFormFieldModule,\n    MatIconModule,\n    MatInputModule,\n    MatProgressSpinnerModule,\n    MatProgressBarModule,\n    MatAutocompleteModule,\n    MatSelectModule,\n    MatChipsModule,\n    MatRippleModule,\n    MatMenuModule,\n    MatCheckboxModule,\n    MatTooltipModule,\n    MatRadioModule,\n    MatTabsModule,\n    MatSlideToggleModule,\n    MatExpansionModule,\n    OverlayModule\n];\n\n@NgModule({\n    imports: [CommonModule,\n        ...MATERIAL_MODULES,\n        ReactiveFormsModule,\n        FormsModule,\n        NgxMatSelectSearchModule, NgxSkeletonLoaderModule],\n    declarations: [\n        AutoCompleteChipSelectItemComponent,\n        AutoCompleteSelectOptionComponent,\n        AcaDatePickerComponent,\n        MckDatePickerComponent,\n        DateTzCalendarWidgetComponent,\n        DateTzDatePickerComponent,\n        TimeFieldComponent,\n        DateTzTimeFieldComponent,\n        DurationFieldComponent,\n        DateTzDurationFieldComponent,\n        GroupHeaderPipe,\n        RadioSelectComponent,\n        FilterPipe,\n        SanitizePipe,\n        SpacerComponent,\n        CalendarIconComponent,\n        ChevronIconComponent,\n        SelectOptionComponent,\n        CloseIconComponent,\n        SelectedChipCountComponent,\n        AlertBannerComponent,\n        ErrorMessageComponent,\n        ToggleComponent,\n        LabelComponent,\n        ModalComponent,\n        CollapseHeaderComponent,\n        SwitchGroupComponent,\n        ModalButtonRowComponent,\n        InformationalImageComponent,\n        SelectComponent,\n        LegendDropdownComponent,\n        RecurrencePatternForm,\n        RecurrenceDateForm,\n        RecurringBookingForm,\n        ConflictsModalComponent,\n        OverrideChangesModalComponent,\n        ConflictAlertModalComponent,\n        CngSelectComponent, \n        DropdownTriggerForDirective,\n        CngSelectOptionsComponent\n    ],\n    exports: [\n        AutoCompleteChipSelectItemComponent,\n        AutoCompleteSelectOptionComponent,\n        AcaDatePickerComponent,\n        MckDatePickerComponent,\n        DateTzCalendarWidgetComponent,\n        DateTzDatePickerComponent,\n        TimeFieldComponent,\n        DateTzTimeFieldComponent,\n        DurationFieldComponent,\n        DateTzDurationFieldComponent,\n        RadioSelectComponent,\n        FilterPipe,\n        SanitizePipe,\n        SpacerComponent,\n        CalendarIconComponent,\n        ChevronIconComponent,\n        AlertBannerComponent,\n        ReactiveFormsModule,\n        FormsModule,\n        ToggleComponent,\n        LabelComponent,\n        ModalComponent,\n        CollapseHeaderComponent,\n        SwitchGroupComponent,\n        ModalButtonRowComponent,\n        InformationalImageComponent,\n        SelectComponent,\n        LegendDropdownComponent,\n        RecurrencePatternForm,\n        RecurrenceDateForm,\n        RecurringBookingForm,\n        ConflictsModalComponent,\n        OverrideChangesModalComponent,\n        ConflictAlertModalComponent,\n        CngSelectComponent, DropdownTriggerForDirective,\n        CngSelectOptionsComponent\n    ]\n})\nexport class UiModule {\n}\n","/**\n * Generate a list of time options for the given date\n * @param datestamp Date to generate options for\n * @param show_past Whether past times should be options\n */\n\nimport {\n    closestToTimeSlot,\n    closestToTimeSlotTz,\n    DurationGroup,\n    durationHumanized,\n    timeFormatString,\n    timeWithGmtOffsetFormatString,\n    unique\n} from '@mckinsey-converge/base';\nimport { SelectOption } from '../types';\nimport { DateTZ } from \"@mckinsey-converge/date-tz\";\nimport { DateTime } from 'luxon';\n\n// 24 hours\nexport const ALL_DAY_BOOKING_VALUE = 60 * 24;\n\nexport const DEFAULT_DURATION = 30;\n\n// R--- depreciate.\nexport const generateAvailableTimes = (\n    datestamp: number,\n    showPast: boolean,\n    step: number = 15,\n    timezone: string = new DateTZ({ date: Date.now() }).local_tz\n): SelectOption<any>[] => {\n    // R--- refactor to only used dateTz input and drop timezone param.\n    // now needs the building timezone for isAfter to work correctly\n    const now = new DateTZ({ date: Date.now(), is_local_tz: false, building_tz: timezone });\n    // date needs the building timezone for isAfter to work correctly\n    let date = new DateTZ({ date: datestamp, is_local_tz: false, building_tz: timezone });\n    // Check if we're today or a future date\n    const blocks: SelectOption<any>[] = [];\n    if (showPast || date.isAfterDate(now, 'day')) {\n        // later than today\n        date = date.startOfValue('day');\n    } else {\n        // today\n        date = now;\n    }\n    // Get the closest timeslot to the start time\n    const inputDate = DateTime.fromMillis(date.ms);\n    const closestDate = closestToTimeSlot(inputDate, step);\n    // Date changed to the closest time\n    date = new DateTZ({ date: closestDate.valueOf(), is_local_tz: false, building_tz: timezone });\n    const end = date.endOfValue('day');\n    // Add options for the rest of the day\n    while (date.isBeforeDate(end)) {\n        blocks.push({\n            display: timeWithGmtOffsetFormatString(date),\n            shortDisplay: date.formatDate('hh:mma'),\n            value: date.formatDate('HH:mm')\n        });\n        date = date.addValue({ minutes: step });\n    }\n    return blocks;\n};\n\n\nexport const generateAvailableTimesTz = (\n    fromDateTz: DateTZ,\n    showPast: boolean,\n    step: number = 15,\n    timezone: string = new DateTZ({ date: Date.now() }).local_tz,\n    all_day: boolean = false,\n    extras: SelectOption<DateTZ>[] = [],\n    startFromDateTz: boolean = false\n): SelectOption<DateTZ>[] => {\n    // now needs the building timezone for isAfter to work correctly\n    const now = new DateTZ({ date: Date.now(), is_local_tz: false, building_tz: timezone });\n    // date needs the building timezone for isAfter to work correctly\n    let dateTz = fromDateTz.clone();\n    // Check if we're today or a future date\n    const blocks: SelectOption<DateTZ>[] = [];\n    if (showPast || dateTz.isAfterDate(now, 'day')) {\n        // later than today\n        dateTz = dateTz.startOfValue('day');\n    } else {\n        // today/fromDateTz using the flag\n        dateTz = startFromDateTz ? dateTz : now;\n    }\n    // Get the closest timeslot to the start time\n    dateTz = closestToTimeSlotTz(dateTz, step);\n    // Date changed to the closest time\n    const end = dateTz.endOfValue('day');\n    // Add the all day option for today\n    if (all_day && dateTz.isSameDate(now, 'day')) {\n        const startOfDay = dateTz.startOfValue('day');\n        blocks.push({\n            display: timeWithGmtOffsetFormatString(startOfDay),\n            shortDisplay: startOfDay.formatDate('hh:mma'),\n            value: startOfDay\n        })\n    }\n    // Add options for the rest of the day\n    while (dateTz.isBeforeDate(end)) {\n        blocks.push({\n            display: timeWithGmtOffsetFormatString(dateTz),\n            shortDisplay: dateTz.formatDate('hh:mma'),\n            value: dateTz, \n        });\n        \n        dateTz = dateTz.addValue({ minutes: step });\n    }\n\n    return unique(extras.concat(blocks), 'shortDisplay');\n};\n\n/**\n * Generates list of duration options for new booking flow.\n * @param date - The start dateTime\n * @param max - The max number of minutes to go to from the date param.\n * @param min - The min number of minutes to display first time from.\n * @param step - The number of minutes to step up by for timeslots.\n */\nexport const generateDurationOptions = (\n    date: DateTZ,\n    max: number,\n    min: number,\n    step: number,\n    extended: boolean): SelectOption<any>[] => {\n    const blocks: SelectOption<any>[] = [];\n    let value = min;\n    while (value <= max) {\n        let duration: string;\n        if (extended) {\n            const d = durationHumanized(value - min, true);\n            duration = d ? `+${d}` : 'Current';\n        } else {\n            duration = durationHumanized(value, true);\n        }\n\n        blocks.push({\n            value,\n            display: `${date.addValue({ minutes: value }).formatDate(timeFormatString()).toLocaleLowerCase()} (${duration})`,\n        });\n        value += step;\n    }\n    return blocks;\n};\n\nexport const allDayOption: SelectOption<any> = ({\n    value: ALL_DAY_BOOKING_VALUE,\n    display: 'All Day'\n});\n\nexport const oneWeekOption: SelectOption<any> = ({\n    value: 60 * 24 * 7, // 1 week\n    display: 'One Week'\n});\n\nexport const defaultDurationGroups: DurationGroup[] = [\n    {\n        start: 15,\n        step: 15,\n        max: 60 * 24\n    }\n    // , {\n    //     start: 60,\n    //     step: 30,\n    //     max: (60 * 8) - 1  // 8 hours\n    // }, {\n    //     start: 60 * 8,\n    //     step: 60,\n    //     max: 60 * 24 // 24 hours\n    // }\n];\n\n/**\n * Maps the {@link DurationGroup} to {@link SelectOption} and appends the default all day and week options.\n */\nexport const generateDurationOptionsFromGroups = (date: DateTZ, durationGroups: DurationGroup[], extended: boolean): SelectOption<any>[] => [\n    ...(durationGroups.map(duration => generateDurationOptions(date, duration.max, duration.start, duration.step, extended)).reduce(((previousValue, currentValue) => {\n        previousValue.push(...currentValue);\n        return previousValue;\n    }), [])),\n        // allDayOption,\n        // oneWeekOption\n    ];\n","export * from './lib/user.module';\nexport * from './lib/user.actions'\nexport * from './lib/user.types'\nexport * from './lib/user.reducer'\n","import { \n    createLoadingAction\n  } from '../../../loading/src/lib/loading.actions';\nimport {\n    UserState,\n    UserStoreState\n} from './user.types';\nimport { User } from '../../../data-common/src/lib/users/user.class';\nimport { createSelector } from '@ngrx/store';\n\nexport const loadUser = createLoadingAction<UserState, User>('CurrentUser', 'current');\n\nexport const selectUserState = ({ user }: UserStoreState) => user;\n\nexport const selectHasUserData = createSelector(createSelector(selectUserState, loadUser.selectors.model), (state) => !!state.optionalSuccess);\n\nexport const selectCurrentUser = createSelector(selectUserState, loadUser.selectors.optionalSuccess);\n","import { Injectable } from '@angular/core';\nimport {\n    Actions,\n    Effect\n} from '@ngrx/effects';\nimport { createLoadingEffect } from '@mckinsey-converge/loading';\nimport { loadUser } from './user.actions';\nimport { UsersService } from '../../../data-common/src/lib/users/users.service';\n\n\n@Injectable()\nexport class UserEffects {\n\n    constructor(private actions: Actions,\n                private userService: UsersService) {\n    }\n\n    @Effect()\n    loadUser = createLoadingEffect(this.actions, loadUser, () => this.userService.loadCurrentUser());\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { StoreModule } from '@ngrx/store';\nimport { userReducer } from './user.reducer';\nimport { EffectsModule } from '@ngrx/effects';\nimport { UserEffects } from './user.effects';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        StoreModule.forFeature('user', userReducer),\n        EffectsModule.forFeature([UserEffects])\n    ]\n})\nexport class UserModule {\n}\n","import { createReducer } from '@ngrx/store';\nimport { UserState } from './user.types';\nimport { LoadingModel } from '@mckinsey-converge/loading';\nimport { loadUser } from './user.actions';\n\n\nexport const initialUserState: UserState = {\n    current: LoadingModel.empty()\n};\n\nexport const userReducer = createReducer(initialUserState,\n    ...loadUser.ons);\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ShellWrapperComponent } from './shell/shell.component';\n\nconst routes: Routes = [\n    {\n        path: '',\n        component: ShellWrapperComponent,\n        children: [\n            {\n                path: 'day-view',\n                loadChildren: () =>\n                    import('./calendar/day-view/day-view.module').then(m => m.DayViewModule)\n            },\n            {\n                path: 'week-view',\n                loadChildren: () =>\n                    import('./calendar/week-view/week-view.module').then(m => m.WeekViewModule)\n            },\n            {\n                path: 'catering',\n                loadChildren: () =>\n                    import('./catering/catering.module').then(m => m.CateringModule)\n            },\n            {\n                path: 'visitors',\n                loadChildren: () =>\n                    import('./visitors/visitors.module').then(m => m.VisitorsModule)\n            },\n            {\n                path: 'reports',\n                loadChildren: () =>\n                    import('./reports/reports.module').then(m => m.ReportsModule)\n            },\n            {\n                path: 'room-admin',\n                loadChildren: () =>\n                import('./room-admin/room-admin.module').then(m => m.RoomAdminModule)\n            },\n            { path: '**', redirectTo: 'day-view' }\n        ]\n    },\n    { path: '**', redirectTo: 'day-view' }\n];\n\n@NgModule({\n    imports: [RouterModule.forRoot(routes, { useHash: true })],\n    exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n","import { Component, ViewEncapsulation } from '@angular/core';\nimport { UploadManager, Amazon, Md5Workers } from '@acaprojects/ngx-uploads';\nimport { ComposerService } from '@placeos/composer';\n\nimport { detectIE } from '@mckinsey-converge/base';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'app-root',\n    templateUrl: './app.component.html',\n    styleUrls: [\n        './styles/app.component.scss',\n        './styles/custom-element.styles.scss',\n        './styles/native-element.styles.scss',\n    ],\n    encapsulation: ViewEncapsulation.None,\n})\nexport class AppComponent extends BaseDirective {\n    constructor(\n        private _composer: ComposerService,\n        private _uploads: UploadManager,\n        private _md5_workers: Md5Workers,\n        private _service: ApplicationService\n    ) {\n        super();\n        /* istanbul ignore if */\n        if (detectIE() && detectIE() < 12) {\n            location.href = `${location.origin}${location.pathname}assets/not-supported.html`;\n            return;\n        }\n        // CONCIERGE.date: If invalid, reset the localstorage date and timezone when reloading pages.\n        const timezoneString = localStorage.getItem('CONCIERGE.timezone') || null;\n        localStorage.removeItem('CONCIERGE.date');\n        if (!timezoneString) {\n            localStorage.removeItem('CONCIERGE.timezone');            \n        }\n\n        this._md5_workers.setup('assets/md5_worker.js');\n        this.initUploads();\n    }\n\n    private initUploads() {\n        this.subscription(\n            'composer',\n            this._service.initialised.subscribe((state) => {\n                /* istanbul ignore else */\n                if (state) {\n                    this.timeout('init_uploads', () => {\n                        const token = this._composer.auth.token;\n                        if (!token) {\n                            return setTimeout(() => this.initUploads(), 300);\n                        }\n                        this._uploads.token = token;\n                        this._uploads.autoStart = true;\n                        this._uploads.endpoint = '/api/staff/uploads';\n                        UploadManager.addProvider(Amazon);\n                    });\n                    this.unsub('composer');\n                }\n            })\n        );\n    }\n}\n","<div class=\"app\">\n    <router-outlet></router-outlet>\n</div>\n","import { BrowserModule } from '@angular/platform-browser';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\nimport { NgModule } from '@angular/core';\nimport { HttpClientModule } from '@angular/common/http';\nimport { FormsModule } from '@angular/forms';\nimport { MAT_LABEL_GLOBAL_OPTIONS } from '@angular/material/core';\n\nimport { ComposerModule } from '@placeos/composer';\n\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\nimport { environment } from '../environments/environment';\nimport { SharedContentModule } from './shared/shared.module';\nimport {\n    ActionReducer,\n    MetaReducer,\n    StoreModule\n} from '@ngrx/store';\nimport { localStorageSync } from 'ngrx-store-localstorage';\nimport { ShellWrapperComponent } from './shell/shell.component';\nimport { provideMockSettingsObject } from '@mckinsey-converge/data-common';\nimport { DEFAULT_SETTINGS } from 'src/environments/settings';\nimport { ENVIRONMENT_TOKEN } from '@mckinsey-converge/environment';\nimport { LegacyOverlaysModule } from '@mckinsey-converge/legacy-overlays';\nimport { BookingsModule } from 'src/app/bookings/bookings.module';\nimport { BookingsModule as BookingModuleStaff } from '@mckinsey-converge/bookings';\nimport { CalendarModule } from 'src/app/calendar/calendar.module';\nimport { EffectsModule } from '@ngrx/effects';\n\ndeclare global {\n    interface Window {\n        app_loaded: boolean;\n    }\n}\n\n/**\n * Cache some state in local storage. Not for use in production.\n */\n export function localStorageSyncReducer(reducer: ActionReducer<any>): ActionReducer<any> {\n    // Keys needed to fix prod reloading.  MCK-1229\n    let keys = [\n        'buildings',\n        'bookingForm',\n        'rooms',\n    ];\n\n    if (!environment.production) {\n        keys = [\n            'bookings',\n            'buildings',\n            'organisation',\n            'bookingForm',\n            'rooms',\n            'user'\n        ];\n    }\n\n    return localStorageSync({\n        keys,\n        rehydrate: true,\n    })(reducer);\n}\n\nconst metaReducers: Array<MetaReducer<any, any>> = [localStorageSyncReducer];\n\n@NgModule({\n    declarations: [\n        AppComponent,\n        ShellWrapperComponent\n    ],\n    imports: [\n        BrowserModule,\n        BrowserAnimationsModule,\n        AppRoutingModule,\n        HttpClientModule,\n        FormsModule,\n        ComposerModule,\n        BookingsModule,\n        CalendarModule,\n        LegacyOverlaysModule,\n        SharedContentModule,\n        StoreModule.forRoot({}, { metaReducers }),\n        BookingModuleStaff,\n        EffectsModule.forRoot(),\n    ],\n    providers: [\n        { provide: MAT_LABEL_GLOBAL_OPTIONS, useValue: { float: 'nevet' } },\n        provideMockSettingsObject(DEFAULT_SETTINGS),\n        { provide: ENVIRONMENT_TOKEN, useValue: environment }\n    ],\n    bootstrap: [AppComponent]\n})\nexport class AppModule {\n    constructor() {\n        window.app_loaded = true;\n    }\n}\n","import {Component, OnInit, Inject, Output, EventEmitter} from '@angular/core';\nimport {FormControl, FormGroup, Validators} from '@angular/forms';\nimport {MatDialog, MAT_DIALOG_DATA, MatDialogRef} from '@angular/material/dialog';\nimport {first} from 'rxjs/operators';\nimport {BaseDirective, closestToTimeSlotTz} from '@mckinsey-converge/base';\nimport {\n  Booking,\n  BookingAction,\n  generateBookingForm, OrganisationService, RecurrencePeriod, removeExpiredOcurrences, SeriesAction, validDateTZ\n} from '@mckinsey-converge/data-common';\nimport {AvailableBookingFields} from '@mckinsey-converge/data-common';\nimport {ApplicationService} from '@mckinsey-converge/data-common';\nimport {HashMap, DialogEvent} from '@mckinsey-converge/base';\nimport {CateringDetailsModalComponent, CateringDetailsModalData} from '@mckinsey-converge/legacy-overlays';\nimport {BookingConfirmComponent} from '@mckinsey-converge/legacy-overlays';\nimport {RequirementDetailsModalComponent, RequirementDetailsModalData} from '@mckinsey-converge/legacy-overlays';\nimport {SpacesService} from '@mckinsey-converge/data-common';\nimport { ConflictsModalComponent, ConflictsModalComponentData, OverrideChangesModalComponent } from '@mckinsey-converge/ui';\nimport { DateNow, DateTZ } from \"@mckinsey-converge/date-tz\";\nimport { I } from '@angular/cdk/keycodes';\n\n\nexport interface BookingFlowEvent {\n  /** Type of flow event */\n  type: 'previous' | 'next' | 'reset' | 'close' | 'error';\n  /** Step which the event was emitted from */\n  step: string;\n  /** Additional metadata for the event */\n  metadata?: HashMap;\n}\n\nexport interface BookingModalData {\n  /** Booking to create/edit */\n  booking: Booking;\n  /** Whether to edit only catering */\n  only_catering?: boolean;\n  /** Pass in timezone for new bookings */\n  timezone?: string;\n  /**Type of action on a series */\n  action?: SeriesAction | BookingAction\n}\n\n@Component({\n  selector: 'a-booking-modal',\n  templateUrl: './booking-modal.component.html',\n  styleUrls: ['./booking-modal.component.scss'],\n})\nexport class BookingModalComponent extends BaseDirective implements OnInit {\n  \n  /** Range of dates for the Start Date Picker*/\n  public from_start: DateTZ;\n  public to: DateTZ;\n\n  /** Range of dates for the Start Date Picker*/\n  public from_end: DateTZ;\n\n  /** Form fields */\n  public form: FormGroup;\n  /** Form data store */\n  public booking: Booking;\n  /** Step of the booking flow that is currently active */\n  public flow_step: string;\n  public modalTitle: string;\n\n  public iscloning: SeriesAction | BookingAction | null = null;\n\n  public edit_recurrence: boolean\n\n  /** Whether to edit only catering */\n  public get only_catering(): boolean {\n    return !!this._data.only_catering;\n  }\n\n  @Output() public event = new EventEmitter<DialogEvent>();\n\n  /** List of available booking fields for the form */\n  public get available_fields(): AvailableBookingFields[] {\n    return this._service.setting('app.booking.show_fields') || [];\n  }\n\n  constructor(\n    private _service: ApplicationService,\n    private _spaces: SpacesService,\n    private _org: OrganisationService,\n    private _dialog: MatDialog,\n    private _dialog_ref: MatDialogRef<BookingModalComponent>,\n    @Inject(MAT_DIALOG_DATA) private _data: BookingModalData\n  ) {\n    super();\n  }\n\n  public ngOnInit(): void {\n    this.getModalTitle();\n    this._dialog_ref.disableClose = true;\n    this._spaces.initialised.pipe(first(_ => _)).subscribe(() => {\n      this.flow_step = this._data.only_catering ? 'catering' : 'form';\n      this.loadFormData();\n    });\n  }\n\n  public getModalTitle() {\n    switch (this._data.action) {\n      case BookingAction.EDIT:\n        this.modalTitle = 'Edit Booking';\n        break;\n      case SeriesAction.CLONE:\n        this.modalTitle = 'Clone Recurring Series';\n        break;\n      case BookingAction.CLONE:\n        this.modalTitle = 'Clone Booking';\n        break;\n      case SeriesAction.EDIT:\n        this.modalTitle = 'Edit Series';\n        break;\n      default:\n        this.modalTitle = 'New Booking';\n        break;\n    }\n  }\n\n  /**\n   * Handle events from child components\n   * @param event Booking flow event\n   */\n  public handleFlowEvent(event: BookingFlowEvent) {\n    /* istanbul ignore else */\n    if (event.type === 'next') {\n      this.toNextFlowStep(event);\n    } else if (event.type === 'previous') {\n      this.toPreviousFlowStep(event);\n    } else if (event.type === 'reset') {\n      this.resetForm();\n    }\n  }\n\n  public close() {\n    this._dialog_ref.close();\n  }\n\n\n  private toNextFlowStep(event: BookingFlowEvent) {\n    const space_list = this.form.controls.space_list.value;\n    switch (event.step) {\n      case 'recurrence':\n        this.openRecurrenceConflictsModal();\n        break\n      case 'search':\n        if (\n          space_list &&\n          space_list.length &&\n          (!event.metadata || !event.metadata.ref || event.metadata.ref !== 'equipment')\n        ) {\n          this.openEquipmentDetailsModal();\n        } else {\n          if (this.form.controls.has_catering && this.form.controls.has_catering.value) {\n            this.navigate('catering');\n          } else {\n            this.navigate('form');\n            this.confirmBooking();\n          }\n        }\n        break;\n      case 'catering':\n        const order_list = this.form.controls.catering.value;\n        if (\n          order_list.find(order => this.form.controls.space_list.value.find(space => space.email === order.location_id)) &&\n          order_list &&\n          order_list.length &&\n          (!event.metadata || !event.metadata.ref || event.metadata.ref !== 'details')\n        ) {\n          this.openCateringDetailsModal();\n        } else {\n          this.navigate('form');\n          this.confirmBooking();\n        }\n        break;\n      case 'changes':\n        this.overrideChanges();\n      break;\n      default:\n        this.form.markAsDirty();\n        //const is_recurr_series_edit = this.booking.id && this.form.controls.is_recurrent.value && this._data.action\n        const is_recurr_series_edit = this.booking.id && (\n          this._data.action === SeriesAction.CLONE || this._data.action === SeriesAction.EDIT || this._data.action === BookingAction.CLONE\n        )\n        if (!space_list || !space_list.length || !this.booking.id || is_recurr_series_edit) {\n          this.navigate('search');\n        } else if (this.booking.id && space_list && space_list.length) {\n          this.openEquipmentDetailsModal();\n        } else {\n          this.confirmBooking();\n        }\n        break;\n    }\n  }\n\n  private toPreviousFlowStep(event: BookingFlowEvent) {\n    switch (event.step) {\n      case 'search':\n        this.navigate('form');\n        break;\n      case 'catering':\n        /* istanbul ignore else */\n        if (!this._data.only_catering) {\n          this.navigate('search');\n        }\n        else {\n          this.close();\n        }\n        break;\n    }\n  }\n\n  private navigate(route: string) {\n    this.flow_step = route;\n  }\n\n  /** Clear user changes to the form data */\n  private resetForm() {\n    delete this.form;\n    // Pass in the desired location timezone\n    this.form = generateBookingForm(\n      this.booking,\n      this.available_fields,\n      true,\n      this._data?.timezone,\n      this._data.action\n    );\n\n    this.form.addControl('action', new FormControl(this._data.action))\n  }\n\n  /**\n   * Load existing form data or generate a new booking form\n   * \n   * It fires when the modal first opens.\n   * this._data.booking is an empty {} when creating a booking but set when editing\n   */\n  private loadFormData(): void {\n    const form_data: HashMap = this._data.booking ? this._data.booking.toJSON() : {};\n    form_data.duration = form_data.duration || form_data?.startDateTz?.dateDiff(form_data?.endDateTz, 'minutes') || 0\n    // \n    /**\n     * Set the desired timezone in the booking creation.\n     * this._data?.timezone is when creating a new booking\n     *  this._data.booking?.timezone is when editing a booking\n     * \n     * R-- refactor to make consistent atm _data.timezone is defined everywhere \n     * but generateBookingForm could use form_data.timezone\n     */\n    form_data.timezone = this._data.booking?.timezone || this._data?.timezone;\n    // start a new booking out with a start end time.\n\n    const is_cloning_or_edit = this._data.action === SeriesAction.CLONE ||\n      this._data.action === BookingAction.CLONE ||\n      this._data.action === BookingAction.EDIT ||\n      this._data.action === SeriesAction.EDIT;\n\n    if (\n        (!form_data.startDateTz || form_data.startDateTz.isBeforeDate(DateNow()))\n        && !this._data.only_catering && !is_cloning_or_edit\n      ) {\n      form_data.startDateTz = closestToTimeSlotTz(new DateTZ({ date: Date.now(), is_local_tz: false, building_tz: form_data.timezone }), 15);\n      form_data.start_epoch = form_data.startDateTz.seconds;\n      form_data.endDateTz = form_data.startDateTz.addValue({ minutes: form_data.duration });\n      form_data.end_epoch = form_data.endDateTz.seconds;\n    }\n    this.booking = new Booking(form_data);\n    \n    if(this.booking.is_recurrent && (\n        this._data.action === SeriesAction.CLONE || this._data.action === SeriesAction.EDIT\n    )){ //if it's series get the recurrence_end from the occurences \n      this.booking.recurrence_endTz = this.booking.recurrenEndFromOcurrences(this.booking.occurrence_details)\n    }\n\n\n    // An empty booking here is when creating a new booking, edit booking will populate all the values\n    this.form = generateBookingForm(\n      this.booking,\n      this.available_fields,\n      true,\n      this._data?.timezone, // MUST be defined in dialog.open(BookingModalComponent or booking will revert to a local timezone\n      this._data.action\n    );\n\n    this.form.addControl('action', new FormControl(this._data.action))\n\n    // localize the booking form start time\n    /* istanbul ignore else */\n    if (form_data && form_data.room_ids && this.form.controls.space_list) {\n      this.form.controls.space_list.setValue(\n        form_data.room_ids.map(id => this._spaces.find(id) || {id, name: id})\n      );\n    }\n\n    this.edit_recurrence = this.booking?.id\n      && (this.form.controls.action?.value === SeriesAction.EDIT || this.form.controls.action?.value === SeriesAction.CLONE);\n\n    if (this._data.action === SeriesAction.CLONE || this._data.action === BookingAction.CLONE) {\n      \n      this.iscloning = this._data.action === SeriesAction.CLONE ? SeriesAction.CLONE : BookingAction.CLONE;\n\n      this._data.action === BookingAction.CLONE\n        ? this.form.get('title').setValue(`Clone ${this.booking.title}`)\n        : this.form.get('title').setValue(`Series Clone ${this.booking.title}`);\n\n      this.form.get('id').setValue('');\n      this.form.get('organiser').enable();\n\n      if (this._data.action === BookingAction.CLONE) {\n        this.form.get('is_recurrent').setValue(false);\n        this.form.get('is_recurrent').disable();\n      }\n      const tz = this._org.building.timezone;\n      this.form.patchValue({ timezone: tz });\n\n      // Check if the booking is a list, if so then updates the value for start and end date fields.\n      if (form_data.recurrence_period === RecurrencePeriod.LIST) { \n        removeExpiredOcurrences(this.form)\n      }\n\n      // cloning individual occurrence set tup\n      const start_time = form_data.recurrence_period === RecurrencePeriod.LIST ? this.form.controls.dateTz.value : new DateTZ({ date: this.booking.start_epoch * 1000, is_local_tz: false, building_tz: tz });\n      const date_now = DateNow(new Date()).toZone(tz);\n\n      // case 1: past booking\n      if (start_time.isBeforeDate(date_now, \"day\")) {\n        if (form_data.recurrence_period !== RecurrencePeriod.LIST) {\n          this.form.controls.dateTz.setValidators([\n            Validators.required,\n            validDateTZ\n          ]);\n          this.form.controls.dateTz.updateValueAndValidity();\n          this.form.controls.dateTz.markAsTouched();\n          this.form.controls.is_before_date.setValue(true);\n\n          if(this._data.action === BookingAction.CLONE && this.form.controls.all_day.value === true) {\n            this.form.get('dateTz').enable();\n          }\n        }\n      }\n\n      // case 2: booking is in the same day but but the start time has already passed\n      if (\n        start_time.isSameDate(date_now, \"day\") && start_time.startEpoch() < date_now.startEpoch()\n      ) {\n        this.form.controls.dateTz.setValue(closestToTimeSlotTz(date_now, 15));\n      }\n    \n      // case 3: future booking nothing to do\n      //Nothing to do\n    }\n\n    if (\n      this.form.controls.action?.value === SeriesAction.EDIT || this.form.controls.action?.value === BookingAction.EDIT\n    ) {\n      const tz = this._org.building.timezone;\n      const start_time = form_data.recurrence_period === RecurrencePeriod.LIST ? this.form.controls.dateTz.value : new DateTZ({ date: this.booking.start_epoch * 1000, is_local_tz: false, building_tz: tz });\n      const date_now = DateNow(new Date()).toZone(tz);\n\n      if (\n        start_time.isSameDate(date_now, \"day\") && (\n          start_time.startEpoch() <= date_now.startEpoch() &&\n          start_time.addValue({ minutes: this.booking.duration}).startEpoch() >= date_now.startEpoch())\n       ) {\n        this.form.controls.is_before_date.setValue(true);\n      }\n\n      if (start_time.isSameDate(date_now, \"day\") && start_time.addValue({ minutes: this.booking.duration}).startEpoch() < date_now.startEpoch()) {\n        this.form.controls.dateTz.setValue(closestToTimeSlotTz(date_now, 15));\n      }\n    }\n\n    if (!this.booking.catering.length) {\n      const notes = this.booking.notes.filter(note => note.type !== 'catering');\n\n      this.form.get('notes').setValue(notes);\n    }\n  } \n\n  /** Open modal for adding equipment requirements to booking */\n  private openEquipmentDetailsModal() {\n    const equipment_ref = this._dialog.open<RequirementDetailsModalComponent,\n      RequirementDetailsModalData>(RequirementDetailsModalComponent, {\n      maxWidth: '95vw',\n      width: '32em',\n      data: {\n        spaces: this.form.controls.space_list.value,\n        notes_field: this.form.controls.notes,\n        codes_field: this.form.controls.equipment_codes,\n        head_counts_field: this.form.controls.expected_attendees\n      }\n    });\n    this.subscription(\n      'equipments_modal_events',\n      equipment_ref.componentInstance.event.subscribe((event: DialogEvent) => {\n        /* istanbul ignore else */\n        if (event.reason === 'done') {\n          this.toNextFlowStep({\n            type: 'next',\n            step: 'search',\n            metadata: {ref: 'equipment'}\n          });\n          equipment_ref.close();\n        }\n      })\n    );\n    equipment_ref.afterClosed().subscribe(() => this.unsub('equipments_modal_events'));\n  }\n\n  /** Open modal for adding equipment requirements to booking */\n  private openCateringDetailsModal() {\n    const catering_ref = this._dialog.open<CateringDetailsModalComponent, CateringDetailsModalData>(\n      CateringDetailsModalComponent,\n      {\n        maxWidth: '95vw',\n        width: '32em',\n        data: {\n          spaces: this.form.controls.space_list.value,\n          notes_field: this.form.controls.notes,\n          catering: this.form.controls.catering,\n          booking: this.booking\n        }\n      }\n    );\n    this.subscription(\n      'catering_modal_events',\n      catering_ref.componentInstance.event.subscribe((event: DialogEvent) => {\n        /* istanbul ignore else */\n        if (event.reason === 'done') {\n          this.toNextFlowStep({\n            type: 'next',\n            step: 'catering',\n            metadata: { ref: 'details' }\n          });\n          catering_ref.close();\n        }\n      })\n    );\n    catering_ref.afterClosed().subscribe(() => this.unsub('catering_modal_events'));\n  }\n\n  /*\n    Open overriding changes modal \n  */\n  private overrideChanges() {\n    const ref = this._dialog.open<OverrideChangesModalComponent>(OverrideChangesModalComponent, {\n        width: '576px',\n        data: {\n          edits: this.booking.occurrence_edits,\n          timezone: this.booking.timezone\n        }\n    });\n    ref.componentInstance.event.subscribe(event => {\n      if (event.reason === 'done') {\n        this.toNextFlowStep({\n          type: 'next',\n          step: 'search',\n        });\n        ref.close();\n      } else if (event.reason === 'close') {\n        ref.close();\n      }\n    });\n  }\n  \n  /**\n   * Open modal to confirm the booking details\n   */\n  private confirmBooking() {\n    /* Clear recurrence validator if only catering is being edited */\n    if(this.only_catering){\n      this.clearRecurrenceValidators()\n    }\n\n    /* istanbul ignore else */\n    if (this.form.valid || this.only_catering) {\n      const formValues = this.form.value;\n      // this.booking is the booking being edited, not much to it on a new booking\n      // having an empty booking is used in determining changes I assume.\n      const startDateTz = this.form.controls.dateTz.value\n      const endDateTz = startDateTz.addValue({ minutes: formValues.duration })\n      const booking = {\n        ...(\n          this._data.action === BookingAction.CLONE || this._data.action === BookingAction.EDIT || this._data.only_catering ? this.sanitizeBookingFromCloning(this.booking) : this.booking.toJSON()),\n        ...(\n          this._data.action === BookingAction.CLONE || this._data.action === BookingAction.EDIT  || this._data.only_catering ? this.sanitizeBookingFromCloning(formValues) : formValues),\n        startDateTz,\n        endDateTz,\n        start_epoch: startDateTz.seconds,\n        end_epoch: endDateTz.seconds,\n        room: formValues.space_list[0],\n      };\n\n      const dialog_ref = this._dialog.open(BookingConfirmComponent, {\n        width: '32em',\n        maxWidth: '95vw',\n        maxHeight: '95vh',\n        data: {\n          old_booking: this.booking,\n          booking: new Booking(booking),\n          action: this._data.action\n        },\n        autoFocus: false,\n        backdropClass: 'mck-modal-backdrop',\n      });\n      dialog_ref.componentInstance.event.subscribe(event => {\n        /* istanbul ignore else */\n        if (event.reason === 'done') {\n          this.close();\n          this.event.emit({ reason: 'done', metadata: this.form});\n        } else if (event.reason === 'action') {\n          this.resetForm();\n        }\n        else if(event.reason === 'last-moment-conflict') {\n          this.form.patchValue({space_list: []}, {emitEvent: true});\n          // this.handleFlowEvent({ type: 'reset', step: 'search' })\n          dialog_ref.close();\n        }\n      });\n    }\n  }\n\n  private sanitizeBookingFromCloning(booking: Booking | Object): Object {\n    const obj = booking instanceof Booking ? booking.toJSON() : booking;\n    return {...Object.keys(obj).reduce((acc, key) => {\n          if(\n            key.search(/^recurrence_/) === -1\n            && key.search(/^occurrence_/) === -1\n          ) {\n            acc[key] = obj[key]\n          };\n\n          return acc;\n      }, {}),\n      is_recurrent: false\n    }\n  }\n\n  /** Open modal for adding equipment requirements to booking */\n  private openRecurrenceConflictsModal() {\n    const recurr_ref = this._dialog.open<ConflictsModalComponent,\n      ConflictsModalComponentData>(ConflictsModalComponent, {\n      maxWidth: '95vw',\n      width: '32em',\n      data: {\n        room_name: this.form.controls.space_list.value[0].name,\n        conflicts: this.form.controls.recurrence_exceptions.value,\n        timezone: this.booking.timezone\n      }\n    });\n    this.subscription(\n      'conflicts_modal_events',\n      recurr_ref.componentInstance.event.subscribe((event: DialogEvent) => {\n        if(this.booking.occurrence_edits && this.booking.occurrence_edits.length && event.reason === 'done') {\n          this.toNextFlowStep({\n            type: 'next',\n            step: 'changes',\n          });\n        } else {\n          /* istanbul ignore else */\n          if (event.reason === 'done') {\n            this.toNextFlowStep({\n              type: 'next',\n              step: 'search',\n            });\n          } \n        }\n        recurr_ref.close();\n      })\n    );\n    recurr_ref.afterClosed().subscribe(() => this.unsub('conflicts_modal_events'));\n  }\n\n  public get title(){\n    const type = this.booking?.id ? 'Edit' : 'New'\n    return `${type} ${this.edit_recurrence ? 'recurring' : ''} booking` \n  }\n\n   private clearRecurrenceValidators() {\n      const recurrenceStarts = this.form.controls.recurrence_starts\n      recurrenceStarts.clearValidators()\n      recurrenceStarts.updateValueAndValidity()     \n  }\n}\n","<header>\n    <div class=\"heading\">\n        <app-icon *ngIf=\"edit_recurrence\" [icon]=\"{ class: 'material-icons', content: 'autorenew' }\"></app-icon>\n        {{ modalTitle }}\n    </div>\n    <button mat-icon-button mat-dialog-close (click)=\"close()\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main>\n        <ng-container [ngSwitch]=\"flow_step\">\n            <ng-container *ngSwitchCase=\"'search'\">\n                <booking-find-space\n                    *ngIf=\"form\"\n                    [spaces]=\"form.controls.space_list\"\n                    [form]=\"form\"\n                    [isCloning]=\"iscloning\"\n                    [booking]=\"booking\"\n                    (event)=\"handleFlowEvent($event)\"\n                ></booking-find-space>\n            </ng-container>\n            <ng-container *ngSwitchCase=\"'catering'\">\n                <booking-catering\n                    *ngIf=\"form\"\n                    [form]=\"form\"\n                    [only]=\"only_catering\"\n                    (event)=\"handleFlowEvent($event)\"\n                ></booking-catering>\n            </ng-container>\n            <ng-container *ngSwitchDefault>\n                <booking-spaces-form\n                    *ngIf=\"form\"\n                    [form]=\"form\"\n                    (event)=\"handleFlowEvent($event)\"\n                ></booking-spaces-form>\n            </ng-container>\n        </ng-container>\n    </main>\n</mat-dialog-content>\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\n\nimport { Space } from '@mckinsey-converge/data-common';\nimport { BookingFlowEvent } from '../booking-modal.component';\nimport { CateringOrder } from '@mckinsey-converge/data-common';\n\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n\n@Component({\n    selector: 'booking-catering',\n    templateUrl: './catering.component.html',\n    styleUrls: ['./catering.component.scss'],\n})\nexport class BookingCateringComponent {\n    /** Form fields for the booking */\n    @Input() public form: FormGroup; // R-- maybe add booking timezone has hidden form field since the date timestamp is from here \n    /** Whether catering is the only action in the flow */\n    @Input() public only: boolean;\n    /** Emitter for flow update events */\n    @Output() public event = new EventEmitter<BookingFlowEvent>();\n    /** Active order to display details for */\n    public active_order: CateringOrder;\n\n    /** Field for storing catering details */\n    public get catering_field() {\n        return this.form && this.form.controls.catering ? this.form.controls.catering : null;\n    }\n\n    /** List of spaces selected for the booking */\n    public get space_list(): Space[] {\n        return this.form && this.form.controls.space_list\n            ? this.form.controls.space_list.value\n            : [];\n    }\n\n    /** Date of the booking */\n    public get dateTz(): DateTZ {\n        const now = DateNow(new Date())\n        return this.form && this.form.controls.dateTz\n            ? this.form.controls.dateTz.value\n            : now.startOfValue('minute');\n    }\n\n    /** Duration of the booking */\n    public get duration(): number {\n        return this.form && this.form.controls.duration ? this.form.controls.duration.value : 60;\n    }\n\n    /** Whether booking is all day */\n    public get all_day(): boolean {\n        return this.form && this.form.controls.all_day && this.form.controls.all_day.value;\n    }\n\n    /** Create a new catering order */\n    public newOrder(): void {\n        const order = new CateringOrder({\n            booking_timezone: this.dateTz.building_tz,\n        });\n        this.active_order = order;\n    }\n\n    /** Handle changes to catering order */\n    public handleOrderEvent(order: CateringOrder) {\n        // active_order = null\n        if (!order) {\n            this.active_order = null;\n        }\n        /* istanbul ignore else */\n        if (order) {\n            let orders = this.form.controls.catering.value;\n            const index = orders.findIndex((an_order) => order.id === an_order.id);\n            // Tack on or replace the order\n            if (index < 0) {\n                orders.push(order);\n            } else {\n                orders.splice(index, 1, order);\n            }\n            // Sort by delivery_time\n            orders = orders.sort((a,b) => {\n                if ( a.delivery_time < b.delivery_time) {\n                    return -1;\n                }\n                if ( a.delivery_time < b.delivery_time) {\n                    return 1;\n                }\n                return 0\n            });\n            this.form.controls.catering.setValue(orders);\n            this.form.markAsDirty();\n        }\n        this.active_order = null;\n    }\n}\n","<div class=\"catering\">\n    <ng-container *ngIf=\"!active_order; else order_display\">\n        <a-catering-order-list\n            [space_list]=\"space_list\"\n            [catering]=\"catering_field\"\n            [date]=\"dateTz\"\n            [all_day]=\"all_day\"\n            [only_catering]=\"only\"\n            (order)=\"$event ? (active_order = $event) : newOrder()\"\n            (event)=\"event.emit($event)\"\n        ></a-catering-order-list>\n    </ng-container>\n</div>\n<ng-template #order_display>\n    <a-catering-order-details\n        [space_list]=\"space_list\"\n        [order]=\"active_order\"\n        [dateTz]=\"dateTz\"\n        [duration]=\"duration\"\n        [all_day]=\"all_day\"\n        (event)=\"handleOrderEvent($event)\"\n    ></a-catering-order-details>\n</ng-template>\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { FormControl } from '@angular/forms';\n\nimport { CateringCategory } from '@mckinsey-converge/data-common';\nimport { CateringItem } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-category-display',\n    templateUrl: './category.component.html',\n    styleUrls: ['./category.component.scss']\n})\nexport class CateringMenuCategoryComponent {\n    /** Category to display details for */\n    @Input() public category: CateringCategory;\n    /** Form control for the list of order items */\n    @Input() public items: FormControl;\n    /** Currency symbol for the active space */\n    @Input() public symbol: string;\n    /** Whether item should be disabled if not available anytime */\n    @Input() public disabled: boolean;\n    /** Whether to show smaller version of component */\n    @Input() public compact: boolean;\n    /** Emitter for close events */\n    @Output() public close = new EventEmitter<void>();\n}\n","<div class=\"header\">\n    <div class=\"content\">\n        <button mat-icon-button (click)=\"close.emit()\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'arrow_back' }\"></app-icon>\n        </button>\n        <div class=\"name\">{{ category?.name }}</div>\n    </div>\n</div>\n<ng-container *ngIf=\"category.availableItems && category.availableItems.length; else empty_state\">\n    <div class=\"item\" *ngFor=\"let item of category.availableItems\">\n        <a-catering-menu-item\n            [compact]=\"compact\"\n            [disabled]=\"disabled\"\n            [symbol]=\"symbol\"\n            [item]=\"item\"\n            [field]=\"items\"\n        ></a-catering-menu-item>\n    </div>\n</ng-container>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\" i18n=\"Catering category empty label\">\n            Category contains no available items\n        </div>\n    </div>\n</ng-template>\n","import {\n    Component,\n    OnInit,\n    Input,\n    SimpleChanges,\n    Output,\n    EventEmitter,\n    ViewChild,\n    ElementRef,\n} from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { FormGroup, FormControl } from '@angular/forms';\n\nimport { CateringCategory } from '@mckinsey-converge/data-common';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { Building } from '@mckinsey-converge/data-common';\nimport { Identity, DialogEvent } from '@mckinsey-converge/base';\nimport { CateringItem } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { CateringOrder } from '@mckinsey-converge/data-common';\nimport {\n    BookingCateringConfirmModalComponent,\n    CateringConfirmModalData,\n} from '@mckinsey-converge/legacy-overlays';\n\nimport { OrganisationService } from '@mckinsey-converge/data-common';\nimport { CateringMenuService } from '@mckinsey-converge/data-common';\nimport { BehaviorSubject } from 'rxjs';\nimport {  map } from 'rxjs/operators';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\ninterface StartEndResponse {\n    timezone: string, \n    start: DateTZ;\n    end: DateTZ\n}\n\n@Component({\n    selector: 'a-catering-order-details',\n    templateUrl: './order-details.component.html',\n    styleUrls: ['./order-details.component.scss'],\n})\nexport class BookingCateringOrderDetailsComponent extends BaseDirective implements OnInit {\n    /** Catering order to edit details of */\n    @Input() public order: CateringOrder;\n    /** Booking date */\n    @Input() public dateTz: DateTZ;\n    /** Booking duration */\n    @Input() public duration: number;\n    /** Booking duration */\n    @Input() public space_list: Space[];\n    /** Whether booking is all day */\n    @Input() public all_day: boolean;\n    /** Whether top header details should be shown */\n    @Input() public hide_details: boolean;\n    /** Whether to show smaller version of component */\n    @Input() public compact: boolean;\n    /** Emitter for changes to the catering order */\n    @Output() public event = new EventEmitter<CateringOrder>();\n    /** Form controls for order */\n    public form: FormGroup;\n    /** List of available catering item categories */\n    public category_list: CateringCategory[] = [];\n    /** Active category to display details for */\n    public active_category: CateringCategory;\n    /** List of available times for delivering catering */\n    public available_times: Identity[] = [];\n    /** Whether the menu is loading */\n    public loading: boolean;\n    /** Whether the search input should be shown */\n    public show_search: boolean;\n    /** Current search string for filtering */\n    public readonly search$ = new BehaviorSubject('');\n    /** List of menu items that match the search string */\n    public matched_items: CateringItem[] = [];\n\n    @ViewChild('input') private _input_el: ElementRef<HTMLInputElement>;\n\n    /** Whether user is able to order from the currently selected space */\n    public get can_order(): boolean {\n        return (\n            (this.active_building.has_catering || this.category_list.length) &&\n            (this.has_available_items) &&\n            !this.out_of_hours\n        );\n    }\n\n    /** Whether booking is with the restricted ordering period */\n    // R--- different in staff, but should it be?\n    public get within_restricted_time(): boolean {\n        return false;\n    }\n\n    /** Building associated with the selected space */\n    public get active_building(): Building {\n        const form = this.form || { controls: { location_id: { value: '' } } };\n        const form_controls = (form).controls;\n        const space: Space =\n            this.space_list.find((space) => space.email == form_controls.location_id.value) ||\n            ({ level: {} } as any);\n        return (\n            this._org.buildings.find((bld) => space.level.building_id === bld.id) ||\n            ({ catering_restricted_from: 0 } as any)\n        );\n    }\n\n    /** Currency code for the active building */\n    public get symbol(): string {\n        return this.active_building.currency || 'USD';\n    }\n\n    /** Number of items in the order */\n    public get item_count(): number {\n        return this.form\n            ? this.form?.controls?.items?.value.reduce((total, item) => total + item.amount, 0)\n            : 0;\n    }\n\n    /* istanbul ignore next */\n    /** Whether booking time is outside of catering hours */\n    public get out_of_hours(): boolean {\n        return this.form?.controls?.delivery_time.value < 0;\n    }\n\n    /** Whether items are available for order at anytime */\n    public get has_available_items(): boolean {\n        return this.category_list.reduce(\n            (available, category) => available || category.can_order_anytime,\n            true\n        );\n    }\n\n    constructor(\n        private _menu: CateringMenuService,\n        private _org: OrganisationService,\n        private _dialog: MatDialog,\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.generateAvailableTimes();\n        this.subscription(\n            'search',\n            this.search$\n                .pipe(\n                    map((str) => {\n                        const search = str.toLowerCase();\n                        const items = [];\n                        for (const category of this.category_list) {\n                            if (category.items) {\n                                for (const group of category.items) {\n                                    if ((group as any).items.length) {\n                                        if (\n                                            (group as any).package &&\n                                            (group.name.toLowerCase().includes(search) ||\n                                                (group as any).items.find((item) =>\n                                                    item.name.toLowerCase().includes(search)\n                                                ))\n                                        ) {\n                                            items.push(group);\n                                        } else {\n                                            for (const item of (group as any).items) {\n                                                if (item.name.toLowerCase().includes(search)) {\n                                                    items.push(item);\n                                                }\n                                            }\n                                        }\n                                    } else {\n                                        if (group.name.toLowerCase().includes(search)) {\n                                            items.push(group);\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                        return items;\n                    })\n                )\n                .subscribe((items) => (this.matched_items = items))\n        );\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.dateTz || changes.duration) {\n            this.generateAvailableTimes();\n            /* istanbul ignore else */\n            if (\n                this.form &&\n                !this.available_times.find(\n                    (time) => time.id === this.form.controls.delivery_time.value\n                )\n            ) {\n                this.form.controls.delivery_time.setValue(this.available_times[0]?.id);\n            }\n        }\n        /* istanbul ignore else */\n        if (changes.space_list) {\n            /* istanbul ignore else */\n            if (this.form && this.space_list && !this.form.controls.location_id.value) {\n                this.form.controls.location_id.setValue(this.space_list[0].email);\n            }\n        }\n        /* istanbul ignore else */\n        if (changes.order && this.order) {\n            this.initForm();\n        }\n    }\n\n    public focusSearch() {\n        if (this._input_el && this.show_search) {\n            this._input_el.nativeElement.focus();\n        }\n    }\n\n    public initForm() {\n        this.form = new FormGroup({\n            id: new FormControl(this.order.id),\n            booking_date: new FormControl(this.dateTz.ms), // R-- different in staff\n            location_id: new FormControl(this.order.location_id || this.space_list[0].email),\n            delivery_time: new FormControl(this.order.delivery_time || this.available_times[0]?.id),\n            items: new FormControl(this.order.items.map((item) => new CateringItem(item))),\n        });\n        this.subscription(\n            'space_change',\n            this.form.controls.location_id.valueChanges.subscribe((space) => {\n                this.generateAvailableTimes();\n                if (\n                    !this.available_times.find(\n                        (time) => time.id === this.form.controls.delivery_time.value\n                    )\n                ) {\n                    this.form.controls.delivery_time.setValue(this.available_times[0]?.id);\n                }\n                this.form.controls.items.setValue([]);\n                this.loadMenu();\n            })\n        );\n        this.loadMenu();\n        this.generateAvailableTimes();\n        if (\n            this.form &&\n            !this.available_times.find((time) => time.id === this.form.controls.delivery_time.value)\n        ) {\n            this.form.controls.delivery_time.setValue(this.available_times[0]?.id);\n        }\n    }\n\n    public confirmOrder() {\n        const ref = this._dialog.open<\n            BookingCateringConfirmModalComponent,\n            CateringConfirmModalData\n        >(BookingCateringConfirmModalComponent, {\n            maxWidth: '95vw',\n            data: {\n                all_day: this.all_day,\n                dateTz: this.dateTz,\n                form: this.form,\n            },\n        });\n        this.subscription(\n            'confirm_event',\n            ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    // R--- add booking_date and timezone\n                    // this.order bookingDateTz is missing correct timezone.\n                    const order = new CateringOrder({ ...this.order, ...this.form.value });\n                    this.event.emit(order);\n                    ref.close();\n                }\n            })\n        );\n        ref.afterClosed().subscribe(() => this.unsub('confirm_event'));\n    }\n\n    private loadMenu() {\n        const space = this.space_list.find(\n            (space) => space.email === this.form.controls.location_id.value\n        );\n        this.loading = true;\n        this._menu\n            .query({ zone_id: this._org.buildings.find((bld) => space.zones.includes(bld.id))?.id })\n            .then(\n                (list) => {\n                    this.loading = false;\n                    this.category_list = list\n                        .map((i) => new CateringCategory(i))\n                        .filter(c => !c.out_of_stock);\n                },\n                () => (this.loading = false)\n            );\n    }\n\n    /** Generate a list of available delivery times for the given booking time */\n    private generateAvailableTimes() {\n        let { timezone, start, end } = this.generateStartAndEndTimes();\n        start = start.setValue({ minute: Math.ceil(start.minutes / 5) * 5 });\n        // will be different from staff in these commonly named methods.\n        // R--- Form Controls TBD\n        // R--- The timezone here doesn't seem legit, back to putting into a form hidden field\n        let start_date = this.dateTz; // new DateTZ({ date: this.date, building_tz: timezone, is_local_tz: false});\n        start_date.logDateTz('start date')\n        this.available_times = [];\n        while (start.isBeforeDate(end)) {\n            this.available_times.push({\n                id: Math.abs(start_date.dateDiff(start, 'minutes')),\n                name: start.formatDate('h:mma').toLocaleLowerCase(),\n            });\n            start = start.addValue({ minutes : 5});\n        }\n        /* istanbul ignore else */\n        if (this.available_times.length === 0) {\n            this.available_times.push({ id: -1, name: 'Out of hours' });\n        }\n    }\n\n    private generateStartAndEndTimes(): StartEndResponse {\n        const now = DateNow(new Date())\n        let timezone = now.local_tz;\n        const space_email = this.space_list[0]?.email;\n        let catering_hours = { start: 7, end: 20 };\n        // R--- change date input to dateTz input.\n        // R--- Same issue as the above generateAvailableTimes\n        const date_ = this.dateTz; // new DateTZ({date: this.date, building_tz: timezone, is_local_tz: false})\n        let building_time = date_.startOfValue('day');\n        let cat_start_time = building_time.addValue({ hours: catering_hours.start });\n        let cat_end_time = building_time.addValue({ hours: catering_hours.end });\n\n        if (space_email) {\n            // Fetch the Space and Building\n            const space = this.space_list.find((space) => space.email === space_email);\n            const building = this._org.buildings.find((bld) => space?.zones.includes(bld.id));\n            if (building?.timezone) {\n                // Update to the building timezone if defined.\n                timezone = building.timezone;\n                building_time = date_.toZone(timezone).startOfValue('day');\n            }\n            if (building?.catering_hours) {\n                // Update to the building catering hours if defined.\n                catering_hours = building?.catering_hours;\n            }\n            // Update the hours with the currently defined timezone.\n            cat_start_time = building_time.addValue({ hours: catering_hours.start });\n            cat_end_time = building_time.addValue({ hours: catering_hours.end });\n        }\n\n        // Start Time of the Booking\n        let start = date_.toZone(timezone);\n        let end = date_.toZone(timezone).addValue({ minutes: this.duration });\n\n        // Do the booking start and end time coincide with the catering hours?\n        if (start.isBeforeDate(cat_start_time)) {\n            // booking start before catering opens'\n            if (cat_end_time.isAfterDate(start)) {\n                // catering closes after booking starts'\n                start = cat_start_time.addValue({});\n            } else {\n                // were just closed, catering closes before booking start'\n                start = cat_end_time.addValue({});\n                end = cat_end_time.addValue({});\n                return { timezone, start, end };\n            }\n        } else {\n            // booking starts after catering is open'\n            if (cat_end_time.isBeforeDate(start)) {\n                // were just closed, catering closed before booking start'\n                start = cat_end_time.addValue({});\n                end = cat_end_time.addValue({});\n                return { timezone, start, end };\n            }\n        }\n\n        if (end.isBeforeDate(cat_end_time)) {\n            // booking ends before catering closes'\n            \n            if (cat_start_time.isAfterDate(end)) {\n                // were just closed, catering opens is after booking ends'\n                start = cat_start_time.addValue({});\n                end = cat_start_time.addValue({});\n                return { timezone, start, end };\n            }\n        } else {\n            // booking ends after catering closes'\n            // set the booking end to the catering close time.'\n            end = cat_end_time.addValue({});\n        }\n\n        return { timezone, start, end };\n    }\n}\n","<div class=\"catering order-details\" [class.compact]=\"compact\">\n    <div class=\"header\" *ngIf=\"form\">\n        <form [formGroup]=\"form\">\n            <div class=\"field\" *ngIf=\"!hide_details\">\n                <label i18n=\"Catering order location label\">Deliver to:</label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select formControlName=\"location_id\">\n                        <mat-option *ngFor=\"let space of space_list\" [value]=\"space.email\">\n                            {{ space.local_name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class=\"field\" *ngIf=\"!hide_details\">\n                <label for=\"start\" i18n=\"Catering order delivery time label\">At:</label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select name=\"start\" formControlName=\"delivery_time\">\n                        <mat-option *ngFor=\"let time of available_times\" [value]=\"time.id\">\n                            {{ time.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class=\"search\" [class.min]=\"hide_details\">\n                <button\n                    mat-icon-button\n                    [disabled]=\"!can_order\"\n                    (click)=\"\n                        show_search = !show_search;\n                        !show_search ? search$.next('') : '';\n                        focusSearch()\n                    \"\n                >\n                    <app-icon\n                        [icon]=\"{\n                            class: 'material-icons',\n                            content: show_search ? 'close' : 'search'\n                        }\"\n                    ></app-icon>\n                </button>\n                <div class=\"search-input\" [class.show]=\"show_search || compact\">\n                    <div class=\"input\">\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                #input\n                                matInput\n                                [ngModel]=\"search$ | async\"\n                                (ngModelChange)=\"search$.next($event)\"\n                                [ngModelOptions]=\"{ standalone: true }\"\n                                placeholder=\"Search for items...\"\n                            />\n                        </mat-form-field>\n                    </div>\n                </div>\n            </div>\n        </form>\n    </div>\n    <div class=\"body\" [class.is-search]=\"search$ | async\" *ngIf=\"!loading; else load_state\">\n        <ng-container *ngIf=\"search$ | async; else menu\">\n            <div class=\"item\" *ngFor=\"let item of matched_items\">\n                <a-catering-menu-item\n                    [compact]=\"compact\"\n                    [disabled]=\"within_restricted_time && !item.can_order_anytime\"\n                    [symbol]=\"symbol\"\n                    [item]=\"item\"\n                    [field]=\"form.controls.items\"\n                ></a-catering-menu-item>\n            </div>\n        </ng-container>\n        <ng-template #menu>\n            <ng-container *ngIf=\"!active_category; else category_display\">\n                <div class=\"contents\" *ngIf=\"can_order && category_list.length; else empty_state\">\n                    <button\n                        mat-button\n                        class=\"category\"\n                        *ngFor=\"let item of category_list\"\n                        [style.background-image]=\"'url(' + item.image_path + ')'\"\n                        [disabled]=\"within_restricted_time && !item.can_order_anytime\"\n                        (click)=\"active_category = item\"\n                    >\n                        <div class=\"overlay\"></div>\n                        <div class=\"name\">{{ item.name }}</div>\n                    </button>\n                </div>\n            </ng-container>\n        </ng-template>\n    </div>\n    <div class=\"footer\">\n        <button\n            mat-button\n            name=\"previous\"\n            class=\"inverse\"\n            (click)=\"event.emit()\"\n            i18n=\"Catering order cancel action\"\n        >\n            Back\n        </button>\n        <button\n            mat-button\n            name=\"next\"\n            [disabled]=\"!item_count || out_of_hours\"\n            (click)=\"confirmOrder()\"\n            i18n=\"Catering order confirm action\"\n        >\n            Confirm Order({{ item_count || '0' }})\n        </button>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div class=\"empty-state center\">\n        <div class=\"icon\">\n            <img alt=\"No Catering Available\" src=\"assets/img/no-catering.svg\" />\n        </div>\n        <p i18n=\"Catering order unavailable\">\n            Catering is <span class=\"bold\">not available</span> for this booking.<br />\n            Catering must be ordered within business hours at {{ active_building?.name }}.\n        </p>\n    </div>\n</ng-template>\n<ng-template #load_state>\n    <div class=\"body\">\n        <div class=\"info-block center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"48\"></mat-spinner>\n            </div>\n            <div class=\"text\" i18n=\"Catering order loading label\">\n                Loading menu for {{ active_building?.name }}...\n            </div>\n        </div>\n    </div>\n</ng-template>\n<ng-template #category_display>\n    <a-category-display\n        [compact]=\"compact\"\n        [category]=\"active_category\"\n        [symbol]=\"symbol\"\n        [items]=\"form.controls.items\"\n        [disabled]=\"within_restricted_time\"\n        (close)=\"active_category = null\"\n    ></a-category-display>\n</ng-template>\n","import { Component, Input, Output, EventEmitter, OnInit } from '@angular/core';\n\nimport { CateringOrder } from '@mckinsey-converge/data-common';\nimport { SpacesService } from '@mckinsey-converge/data-common';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'catering-order-list-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss'],\n})\nexport class CateringOrderListItemComponent implements OnInit {\n    /** Catering order to display */\n    @Input() order: CateringOrder;\n    /**  */\n    @Input() public space_list: Space[];\n    /** Selected datetime */\n    @Input() date: number;\n    /** Emitter for edit events */\n    @Output() public edit = new EventEmitter<void>();\n    /** Emitter for delete events */\n    @Output() public delete = new EventEmitter<void>();\n\n    public room: Space;\n\n    public ngOnInit(): void {\n        this.room = (this.space_list || []).find(space => space.email === this.order.location_id);\n    }\n\n    public get space_in_booking(): boolean {\n        return !!this.room;\n    }\n\n    /** Space selected for delivery */\n    public get local_space_name(): string {\n        return this.room?.local_name || '<No Location>';\n    }\n\n    /** Delivery time for the order */\n    public get delivery_time(): string {\n        /* istanbul ignore else */\n        if (!this.order) {\n            return '<Meeting Start>';\n        }\n        return this.order.bookingDateTz.addValue({ minutes: this.order.delivery_time || 0}).formatDate('h:mma').toLocaleLowerCase();\n    }\n\n\n    /** Total cost of the order */\n    public get order_cost(): number {\n        const items = (this.order || { items: [] }).items as any;\n        return items.reduce((amount, item) => amount + item.amount * item.unit_price, 0);\n    }\n\n    /** Number of items in the order */\n    public get item_count(): number {\n        const items = (this.order || { items: [] }).items as any;\n        return items.reduce((amount, item) => amount + item.amount, 0);\n    }\n\n    /** Currency symbol for the selected space */\n    public get symbol(): string {\n        const space = this._spaces.find((this.order || {}).location_id);\n        /* istanbul ignore else */\n        if (!space || !space.level) {\n            return 'USD';\n        }\n        const building = this._org.buildings.find((bld) => bld.id === space.level.building_id) || {\n            currency: 'USD',\n        };\n        return building.currency;\n    }\n\n    constructor(private _spaces: SpacesService, private _org: OrganisationService) {}\n}\n","<div class=\"details\" i18n=\"Catering order item delivery details\">\n    Deliver to <span>{{ local_space_name }}</span> at <span>{{ delivery_time }}</span>\n</div>\n<div class=\"group\">\n    <div class=\"cost\">\n        {{ item_count }}\n        <span i18n=\"Items\">{ item_count, plural, =1 { item } other { items } }</span>\n    </div>\n    <div class=\"cost\">{{ order_cost / 100 | currency: symbol }}</div>\n</div>\n<div class=\"actions\">\n    <button\n        mat-icon-button\n        name=\"edit\"\n        (click)=\"edit.emit()\"\n    >\n    <app-icon\n        [icon]=\"{ class: 'material-icons', content: 'edit' }\"\n    ></app-icon>\n</button>\n    <button mat-icon-button name=\"delete\" class=\"inverse\" (click)=\"delete.emit()\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'delete' }\"></app-icon>\n    </button>\n</div>\n","import { Component, Input, Output, EventEmitter, OnInit } from '@angular/core';\nimport { FormControl } from '@angular/forms';\n\nimport { BookingFlowEvent } from '../../booking-modal.component';\nimport { CateringOrder } from '@mckinsey-converge/data-common';\nimport { Space } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-catering-order-list',\n    templateUrl: './order-list.component.html',\n    styleUrls: ['./order-list.component.scss']\n})\nexport class BookingCateringOrderListComponent implements OnInit{\n    /** Form field for storing catering orders */\n    @Input() public catering: FormControl;\n    /** Selected datetime for the booking */\n    @Input() public date: number;\n    /** Whether booking is all day */\n    @Input() public all_day: boolean;\n    /**  */\n    @Input() public space_list: Space[];\n    /** Whether catering is the only action in the flow */\n    @Input() public only_catering: boolean;\n    /** Emitter for flow update events */\n    @Output() public event = new EventEmitter<BookingFlowEvent>();\n    /** Emiiter for order events */\n    @Output() public order = new EventEmitter<CateringOrder>();\n\n    public ngOnInit(): void {\n        if(this.space_list && this.space_list.length) {\n            this.catering.value.forEach(catering => {\n                catering.location = this.space_list[0].name; \n                catering.location_id = this.space_list[0].email;\n                catering.bookingDateTz = this.date;\n            });\n        }\n    }\n\n    /** List of orders in the booking */\n    public get orders(): CateringOrder[] {\n        /* istanbul ignore else */\n        if (!this.catering) {\n            return [];\n        }\n        return this.catering.value;\n    }\n\n    /** Emit event for a new catering order */\n    public newOrder() {\n        this.order.emit();\n    }\n\n    /** Emit event for editing existing order */\n    public editOrder(order: CateringOrder) {\n        this.order.emit(order);\n    }\n\n    /** Remove order from the list */\n    public deleteOrder(order: CateringOrder) {\n        const orders = this.orders;\n        const index = orders.findIndex(an_order => order.id === an_order.id);\n        /* istanbul ignore else */\n        if (index >= 0) {\n            orders.splice(index, 1);\n            this.catering.setValue(orders);\n        }\n    }\n\n    /**\n     * Proceed to the next step in the space booking flow\n     */\n    public next(): void {\n        this.event.emit({ type: 'next', step: 'catering' });\n    }\n\n    /** Move flow to previous step */\n    public previous(): void {\n        this.event.emit({ type: 'previous', step: 'catering' });\n    }\n}\n","<div class=\"catering order-list\">\n    <div class=\"header\">\n        <h3 i18n=\"Catering order list header\">Catering Orders</h3>\n    </div>\n    <div class=\"body\">\n        <ng-container *ngIf=\"orders && orders.length; else empty_state\">\n            <div class=\"list\">\n                <catering-order-list-item\n                    *ngFor=\"let order of orders\"\n                    [space_list]=\"space_list\"\n                    [order]=\"order\"\n                    [date]=\"date\"\n                    (edit)=\"editOrder(order)\"\n                    (delete)=\"deleteOrder(order)\"\n                ></catering-order-list-item>\n            </div>\n            <button mat-button name=\"new\" (click)=\"newOrder()\" i18n=\"Catering order list add action\">\n                Add Order\n            </button>\n        </ng-container>\n    </div>\n    <div class=\"footer\">\n        <button\n            mat-button\n            class=\"inverse\"\n            name=\"previous\"\n            (click)=\"previous()\"\n            i18n=\"Catering order list cancel action\"\n        >\n            Back\n        </button>\n        <button mat-button name=\"next\" (click)=\"next()\" i18n=\"Catering order list continue action\">\n            Next\n        </button>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\" i18n=\"Catering order list empty label\">No catering orders</div>\n        <button mat-button name=\"new\" (click)=\"newOrder()\" i18n=\"Catering order list add action\">\n            Add Order\n        </button>\n    </div>\n</ng-template>\n","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\nimport { FormControl } from '@angular/forms';\n\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { Building } from '@mckinsey-converge/data-common';\nimport { unique } from '@mckinsey-converge/base';\n\nimport { ANIMATION_SHOW_CONTRACT_EXPAND } from '@mckinsey-converge/animations';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\nimport { HashMap } from '@mckinsey-converge/base';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'booking-space-filters',\n    templateUrl: './filters.component.html',\n    styleUrls: ['./filters.component.scss'],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND]\n})\nexport class BookingSpaceFiltersComponent extends BaseDirective implements OnInit {\n    /** Date selected for the booking */\n    @Input() public date: FormControl;\n    /** List of location IDs being filtered on */\n    @Input() public locations: string[] = [];\n    /** Preselected buildings */\n    @Input() public initBuildings: string[] = [];\n    /** Emitter for changes to location filter */\n    @Output() public locationsChange = new EventEmitter<string[]>();\n    /** List of available buildings */\n    public building_list: Building[] = [];\n    /** Whether to show the location list */\n    public show_locations: boolean;\n\n    public get date_() {\n        // R--- another instance, can the form control date be TZ aware\n        return new DateTZ({date: this.date.value}) \n    }\n\n    /** Whether active date is current day */\n    public get is_today(): boolean {\n        const now = DateNow(new Date())\n        return now.isSameDate(this.date_, 'day');\n    }\n\n    /** Display string for the selected date */\n    public get date_display(): string {\n        // R--- needs to be TZ aware because of day is relative\n        return this.is_today ? 'Today' : this.date_.formatDate('dd MMM yyyy');\n    }\n\n    /** List of filtered location */\n    public get location_list(): Building[] {\n        return this.locations.map(id => this.building_list.find(bld => bld.id === id));\n    }\n\n    public get building_selected(): HashMap<boolean> {\n        const map = {};\n        for (const id of this.locations) {\n            map[id] = true;\n        }\n        return map;\n    }\n\n    constructor(private _org: OrganisationService) {\n        super();\n    }\n\n    public changeDate(amount: number) {\n        let date = this.date_.addValue({ 'days': amount });\n        const now_ = DateNow(new Date())\n        const now = now_.startOfValue('minute');\n        if (date.isBeforeDate(now)) {\n            date = now;\n        }\n        this.date.setValue(date.ms);\n    }\n\n    public ngOnInit(): void {\n        this.subscription('buildings', this._org.listen('buildings').subscribe((bld_list) => {\n            this.building_list = bld_list;\n            if (Array.isArray(this.initBuildings)) {\n                this.locations = unique(this.initBuildings);\n            }        \n        }));\n    }\n\n    /**\n     * Update location filter to include the given building\n     * @param building Building to add\n     */\n    public addLocationFilter(building: Building): void {\n        this.locations.push(building.id);\n        this.locations = unique(this.locations);\n        this.locationsChange.emit(this.locations);\n    }\n\n    /**\n     * Remove location from the active filters\n     * @param building Building to remove\n     */\n    public removeLocationFilter(building: Building) {\n        this.locations.splice(\n            this.locations.findIndex(id => building.id === id),\n            1\n        );\n        this.locationsChange.emit([...this.locations]);\n    }\n}\n","<div class=\"space-filters\" *ngIf=\"date\">\n    <div class=\"actions\">\n        <div class=\"date\">\n            <button mat-icon-button [disabled]=\"is_today\" (click)=\"changeDate(-1)\">\n                <app-icon\n                    [icon]=\"{ class: 'material-icons', content: 'keyboard_arrow_left' }\"\n                ></app-icon>\n            </button>\n            <div class=\"text\">{{ date_display }}</div>\n            <button mat-icon-button (click)=\"changeDate(1)\">\n                <app-icon\n                    [icon]=\"{ class: 'material-icons', content: 'keyboard_arrow_right' }\"\n                ></app-icon>\n            </button>\n        </div>\n        <div class=\"location-list\" [matMenuTriggerFor]=\"locationMenu\">\n            <div class=\"inner\" (click)=\"show_locations = !show_locations\">\n                <img src=\"assets/img/location-img.svg\" />\n                <div class=\"text\" i18n=\"Booking space filters locations label\">\n                    Select locations(s)\n                </div>\n                <app-icon\n                    [icon]=\"{\n                        class: 'material-icons',\n                        content: 'keyboard_arrow_' + (show_locations ? 'up' : 'down')\n                    }\"\n                ></app-icon>\n            </div>\n        </div>\n    </div>\n    <div class=\"filters\" *ngIf=\"location_list && location_list.length\">\n        <mat-chip-list aria-label=\"Location Filters\">\n            <mat-chip\n                *ngFor=\"let building of location_list\"\n                [id]=\"building.id\"\n                color=\"primary\"\n                [removable]=\"true\"\n                (removed)=\"removeLocationFilter(building)\"\n            >\n                {{ building.name }}\n                <app-icon\n                    matChipRemove\n                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"\n                ></app-icon>\n            </mat-chip>\n        </mat-chip-list>\n    </div>\n</div>\n<mat-menu #locationMenu=\"matMenu\" class=\"dark-mode\" xPosition=\"before\">\n    <button mat-menu-item (click)=\"$event.stopPropagation()\" *ngFor=\"let building of building_list\">\n        <mat-checkbox\n            [ngModel]=\"building_selected[building.id]\"\n            (change)=\"$event.checked ? addLocationFilter(building) : removeLocationFilter(building)\"\n        >\n            <div class=\"building-name\">\n                <div class=\"code\">{{ building.code }}</div>\n                <div class=\"name\">{{ building.name }}</div>\n                <div class=\"address\">{{ building.address }}</div>\n            </div>\n        </mat-checkbox>\n    </button>\n</mat-menu>\n","import {\n    Component,\n    OnInit,\n    Input,\n    SimpleChanges,\n    EventEmitter,\n    Output,\n    OnChanges\n} from '@angular/core';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport {\n    debounceTime,\n    distinctUntilChanged,\n    switchMap,\n    catchError,\n    map,\n    first,\n    take,\n    withLatestFrom,\n} from 'rxjs/operators';\nimport { BehaviorSubject, Observable, of, Subject } from 'rxjs';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { ApplicationService, Booking, BookingAction, BookingStateService, ISpaceAvailabilityOptions, mapBuildingToSelectOption, mapCityToAllSelectOption, SeriesAction, toggleSelectedByGroup } from '@mckinsey-converge/data-common';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { BookingFlowEvent } from '../booking-modal.component';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\nimport { SpacesService } from '@mckinsey-converge/data-common';\nimport { randomInt } from '@mckinsey-converge/base';;\nimport { DateTZ } from '@mckinsey-converge/date-tz';\nimport { SelectOption } from '@mckinsey-converge/ui';\n\n\n@Component({\n    selector: 'booking-find-space',\n    templateUrl: './find-space.component.html',\n    styleUrls: ['./find-space.component.scss'],\n})\nexport class BookingFindSpaceComponent extends BaseDirective implements OnInit, OnChanges {\n    /** Form control for setting the active space */\n    @Input() public spaces: FormControl;\n    /** Form group for booking */\n    @Input() public form: FormGroup;\n\n    @Input() public isCloning: SeriesAction | BookingAction | null;\n\n    @Input() public booking: Booking;\n    /** Emitter for flow update events */\n    @Output() public event = new EventEmitter<BookingFlowEvent>();\n\n    /** List of spaces available during the required period */\n    public space_list: Space[] = [];\n    /** List of users from an API search */\n    public search_results$: Observable<Space[]>;\n    /** Whether space list is loading */\n    public loading: boolean;\n    /** List of zones to filter the spaces on */\n    public zone_ids: string[] = [];\n    /** Subject holding the value of the search */\n    public readonly change$ = new Subject<string | string[]>();\n\n    public formGroup = new FormGroup({\n        location: new FormControl([]),\n    });\n\n    public options = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public selectedOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public savedSelection = [];\n\n    public selectedSpace: Array<Space & { unavailable?: boolean }> = [];\n\n    public oldSpace = [];\n\n    /**  Whether multiple spaces are allowed to be selected */\n    public get multiple(): boolean {\n        return this._service.setting('app.booking.multiple_spaces');\n    }\n\n    public get has_valid_space() {\n        return this.spaces?.value?.some(_ => _.id && _.bookable);\n    }\n\n    public get initialBuildingIds(): string[] {\n        return this._org.building ? [this._org.building.id] : [];\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _spaces: SpacesService,\n        private _org: OrganisationService,\n        private _booking_state: BookingStateService,\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._spaces.initialised.pipe(first((_) => _)).subscribe(() => {\n            let request_id = 0;\n            // Listen for input changes\n            this.search_results$ = this.change$.pipe(\n                debounceTime(400),\n                distinctUntilChanged(),\n                switchMap((bld = []) => {\n                    this.loading = true;\n                    request_id = randomInt(9999_9999);\n                    const dateTz = this.form.controls.dateTz.value;\n\n                    const ignore = this.form.controls.action?.value === SeriesAction.EDIT ? this.form.controls.id.value : null\n\n                    // R--- need to pass on the all day param and let libs/data-common/src/lib/spaces/spaces.service.ts \n                    // availability do the math.\n                    let query: ISpaceAvailabilityOptions = {\n                        dateTz: this.form.controls.all_day.value\n                        ? dateTz.startOfValue('day').startOfValue('minute').startOfValue('second')\n                        : dateTz.startOfValue('minute').startOfValue('second'),\n                        duration: this.form.controls.all_day.value\n                            ? 24 * 60\n                            : this.form.controls.duration.value,\n                        zone_ids: bld.length ? bld : this._org.building.id,\n                        bookable: true,\n                        recurrence_count: this.form.controls.recurrence_count.value,\n                        recurrence_period: this.form.controls.recurrence_period.value,\n                        recurrence_endTz: this.form.controls.recurrence_endTz.value,\n                        recurrence_interval: this.form.controls.recurrence_interval.value,\n                        recurrence_starts: this.form.controls.recurrence_starts.value,\n                        is_recurrent: this.form.controls.is_recurrent.value,\n                        recurrence_days: this.form.controls.recurrence_days.value,\n                        ignore\n                    };\n\n                    /* istanbul ignore else */\n                    if (this.zone_ids && this.zone_ids.length) {\n                        query.zone_ids = this.zone_ids.join(',');\n                    }\n                    const id = request_id;\n                    return this._spaces.available(query).then(async (list) => ({ id, list }));\n                }),\n                catchError((_) => of({ id: request_id, list: [], error: _})),\n                map((resp: { id: number, list: Space[]}) => {\n                    this.loading = false;\n                    return resp.id === request_id ? resp.list : this.space_list;\n                })\n            );\n\n            // Process API results\n            this.subscription(\n                'search_results',\n                this.search_results$.subscribe((list) => {\n                    this.space_list = list.filter((space) => {\n                        if (!space.available && !this.form.controls.action?.value) {\n                            return false;\n                        }\n\n                        for (const zone of this.zone_ids) {\n                            if (space.zones.includes(zone)) {\n                                return true;\n                            }\n                        }\n                        return !this.zone_ids.length;\n                    }).filter(space => space.available);\n\n                    this.space_list.sort((a, b) => this.sort(a, b));\n                    if(!this.selectedOptions.value.length){\n                        this.setDefaultBuilding()\n                    }\n                    this.space_list.map((space)=>{\n                        if(space.id === this.spaces.value[0]?.id){\n                            this.spaces.setValue([space])\n                            const spaceConflicts = space.recurrence_availability.filter(recurr => !recurr.available);\n                            this.form.controls.recurrence_exceptions.setValue(spaceConflicts.map((recurr)=> recurr.date))\n                        }\n                    })\n\n                    if (\n                        this.isCloning === BookingAction.CLONE\n                        || this.isCloning === SeriesAction.CLONE\n                    ) {\n\n                        const space = this.space_list.find(space => space.id === this.booking.room.id);\n                        const bookable = space !== undefined;\n                        this.space_list = bookable && this.space_list.filter(space => space.id !== this.booking.room.id) || this.space_list;\n\n                        const original_space = new Space({\n                            ...this.booking.room,\n                            ...(space || {\n                                settings: {\n                                    ...this.booking.room.settings,\n                                    recurrence_availability: []\n                                }\n                            } as any),\n                            bookable\n                        });\n\n                        this.oldSpace = [original_space];\n                        this.spaces.value.some(space => space.id === original_space.id) && this.spaces.setValue([original_space]);\n                        this.selectedSpace.push(original_space);\n                    }\n\n                    if(this.form.controls.is_recurrent.value){\n                        this.sortByRecurrenceAvailability();\n                    }\n\n                    const booking_space_list = this.form.controls.space_list.value\n                    if(booking_space_list.length !== 0){\n                        this.spaces.setValue(booking_space_list)\n                    }\n                })\n            );\n            \n            this.change$.next('');\n        });\n\n        this.subscription('buildings', this._org.listen('buildings').subscribe((bld_list) => {\n            const city = this._org.building.city\n            const timezone = this._org.building.timezone\n            const grouped_by_city = {\n                key: {name: city, timezone},\n                value: bld_list?.filter((bld)=> bld.city === city) || []\n            }\n            const city_buildings = grouped_by_city.value.map(\n                (bld)=>mapBuildingToSelectOption(grouped_by_city.key.name, bld)\n            )\n            const buildings  = [\n                mapCityToAllSelectOption(grouped_by_city.key),\n                ...city_buildings\n            ] \n            this.options.next(buildings)\n        }));\n        \n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.form) {\n            const onChange = (_) => this.change$.next(_);\n            /* istanbul ignore else */\n            if (this.form.controls.dateTz) {\n                this.subscription(\n                    'date_field',\n                    this.form.controls.dateTz.valueChanges.subscribe(onChange)\n                );\n            }\n            /* istanbul ignore else */\n            if (this.form.controls.duration) {\n                this.subscription(\n                    'duration_field',\n                    this.form.controls.duration.valueChanges.subscribe(onChange)\n                );\n            }\n        }\n    }\n\n    /**\n     * Update the selected space list\n     * @param space Space to add/toggle in the selected list\n     */\n    public selectSpace(space: Space) {\n        const list = this.spaces.value;\n        if (list.find((item) => item.id === space.id)) {\n            this.spaces.setValue(list.filter((item) => item.id !== space.id));\n        } else {\n            this.spaces.setValue([space]);\n        }\n    }\n\n    /**\n     * Proceed to the next step in the space booking flow\n     */\n    public next(): void {\n        if(this.form.controls.is_recurrent.value && \n            this.form.controls.recurrence_exceptions.value.length){\n            const id = this.form.controls.id.value\n            if(id && this.form.controls.action?.value === 'edit'){ \n                this.handleEditConflicts(id)\n            }else{\n                this.event.emit({ type: 'next', step: 'recurrence' });\n            }          \n        }else{\n            if(this.booking && this.booking.occurrence_edits && this.booking.occurrence_edits.length) {\n                this.event.emit({ type: 'next', step: 'changes' });\n            } \n            else {\n                this.event.emit({ type: 'next', step: 'search' });\n            }\n        }\n        \n    }\n\n    /** Move flow to previous step */\n    public previous(): void {\n        this.event.emit({ type: 'previous', step: 'search' });\n    }\n\n    /**\n     * Compare two spaces to determine order\n     * @param space_a\n     * @param space_b\n     */\n    public sort(space_a: Space, space_b: Space) {\n        const bld = this._org.buildings.find((bld) => space_a.zones.includes(bld.id));\n        const bld_b = this._org.buildings.find((bld) => space_b.zones.includes(bld.id));\n        if (bld && bld !== bld_b) {\n            return bld.name.localeCompare(bld_b?.name);\n        }\n        const sort_order = [...bld.sort_order].reverse();\n        for (const zone_id of sort_order) {\n            if (zone_id === '*') {\n                continue;\n            }\n            const a_has_zone = space_a.zones.indexOf(zone_id) >= 0;\n            const b_has_zone = space_b.zones.indexOf(zone_id) >= 0;\n            if (a_has_zone && !b_has_zone) {\n                return 1;\n            } else if (b_has_zone && !a_has_zone) {\n                return -1;\n            }\n        }\n        return space_a.name.localeCompare(space_b.name);\n    }\n\n    public sortByRecurrenceAvailability() {\n        this.space_list.sort((a, b)=>{\n            const a_availability = (a.recurrence_availability?.filter(recurr => recurr.available)?.length*100)/a.recurrence_availability.length\n            const b_availability = (b.recurrence_availability?.filter(recurr => recurr.available)?.length*100)/b.recurrence_availability.length\n            return b_availability - a_availability\n        })\n    }\n    public toggle(option: SelectOption<any>) {\n        // update the selected value\n        this.selectedOptions.pipe(\n            take(1),\n            withLatestFrom(this.options),\n            map(([selectedOptions, options]) => {\n                return toggleSelectedByGroup(options, selectedOptions, option);\n            })\n        ).subscribe(next => {\n            const formData = this.formGroup.value;\n            this.formGroup.setValue({\n                location: formData.location,\n            });\n            this.selectedOptions.next(next);\n            this.savedSelection = next.map((bld)=>bld.value)     \n            \n        });\n    }\n\n    public setDefaultBuilding(){\n        const defaultBld = this.options.value.filter(opt => opt.value === this._org.building.id)\n        this.selectedOptions.next(defaultBld)\n    }\n\n    public clearList(){\n        this.space_list = []\n        this.savedSelection = []\n    }\n\n    public triggerSearch = () =>{\n        if(this.savedSelection.length){\n            this.change$.next(this.savedSelection)\n        }else{\n            this.space_list = []\n        }\n    }\n\n    public handleEditConflicts = (id: string) =>{\n        /** When editing, compare exceptions with the original ocurrence list */\n        const recurrence_exceptions = this.form.controls.recurrence_exceptions;\n        let occurrences_org: Array<number>\n        let booking_org: Booking;\n\n        this._booking_state.bookings.subscribe(bookings => {\n            booking_org = bookings.filter((booking) => booking.id === id)[0]\n            occurrences_org = booking_org.occurrence_details.map((ocurr)=>\n                ocurr.start_epoch\n            )\n        })\n\n        const { hours, minutes } = new DateTZ({ date: booking_org.start_epoch * 1000, is_local_tz: false, building_tz: booking_org.timezone});\n        const { hours: to_hours, minutes: to_minutes } = this.form.controls.dateTz.value;\n        const new_conflicts = hours === to_hours && minutes === to_minutes\n            ? recurrence_exceptions.value.filter((date: number)=> occurrences_org.includes(date))\n            : recurrence_exceptions.value.filter((date: number)=> !occurrences_org.includes(date));\n\n        if(new_conflicts.length){\n            recurrence_exceptions.setValue([...new_conflicts])\n            this.event.emit({ type: 'next', step: 'recurrence' });\n        }else{\n            this.event.emit({ type: 'next', step: 'search' });\n        }\n    }\n}\n","<div class=\"find-space\" [formGroup]=\"formGroup\">\n    <div class=\"background\"></div>\n    <div class=\"header\">\n        <mck-autocomplete-chip-select-item\n        errorMessage=\"Location and office must be selected\"\n        label=\"Location and office\"\n        [required]=\"true\"\n        [selectOnlyOneGroup]=\"true\"\n        placeHolder=\"Start typing to filter location or office...\"\n        formControlName=\"location\"\n        [options]=\"options\"\n        [selectedOptions]=\"selectedOptions\"\n        (optionSelected)=\"toggle($event)\"\n        [displayCTA]=\"true\"\n        (chipsCleared)=\"clearList()\"\n        [useCTAs]=\"true\"\n        (onClickConfirm)=\"triggerSearch()\"\n    ></mck-autocomplete-chip-select-item>\n    </div>\n    <ng-container *ngIf=\"!loading; else load_state\">\n        <cdk-virtual-scroll-viewport\n            *ngIf=\"space_list && space_list.length; else empty_state\"\n            [itemSize]=\"130\"\n            minBufferPx=\"900\" maxBufferPx=\"1200\"\n        >\n            <div *ngIf=\"isCloning\">\n                <h3>Original Selection</h3>\n    \n                <div *ngFor=\"let space of selectedSpace\">\n                    <a-booking-space-item\n                        [form]=\"form\"\n                        [space]=\"space\"\n                        [multi]=\"multiple\"\n                        [isCloning]=\"isCloning\"\n                        (select)=\"selectSpace(space)\"\n                    ></a-booking-space-item>\n                </div>\n            </div>\n\n\n            <h3 *ngIf=\"isCloning\">All Available Rooms</h3>\n            <ng-container *cdkVirtualFor=\"let space of space_list\">\n                <a-booking-space-item\n                    [form]=\"form\"\n                    [space]=\"space\"\n                    [multi]=\"multiple\"\n                    [isCloning]=\"isCloning\"\n                    (select)=\"selectSpace(space)\"\n                ></a-booking-space-item>\n            </ng-container>\n        </cdk-virtual-scroll-viewport>\n    </ng-container>\n    <div class=\"footer\">\n        <div class=\"box\">\n            <button\n                mat-button\n                class=\"inverse\"\n                name=\"previous\"\n                [disabled]=\"loading\"\n                (click)=\"previous()\"\n                i18n=\"Booking spaces cancel action\"\n            >\n                Back\n            </button>\n            <button\n                mat-button\n                *ngIf=\"multiple\"\n                name=\"next\"\n                [disabled]=\"!has_valid_space || loading\"\n                (click)=\"next()\"\n                i18n=\"Booking spaces continue action\"\n            >\n                Next\n            </button>\n        </div>\n    </div>\n</div>\n<ng-template #load_state>\n    <div class=\"body\">\n        <div class=\"info-block center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"48\"></mat-spinner>\n            </div>\n            <div class=\"text\" i18n=\"Booking spaces loading label\">\n                Checking space availability...\n            </div>\n        </div>\n    </div>\n</ng-template>\n<ng-template #empty_state>\n    <div class=\"body\">\n        <div class=\"info-block center\">\n            <div class=\"icon\">\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n            </div>\n            <div class=\"text\" i18n=\"Booking spaces empty label\">\n                No results available, please select another office\n            </div>\n        </div>\n    </div>\n</ng-template>\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\n\nimport { BookingAction, SeriesAction, Space } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-booking-space-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss'],\n})\nexport class BookingSpaceItemComponent extends BaseDirective {\n    /** Space to display */\n    @Input() public space: Space;\n    /** Form fields for booking */\n    @Input() public form: FormGroup;\n    /** Whether multiple spaces are able to be selected */\n    @Input() public multi: boolean;\n\n    @Input() isCloning: boolean;\n    /** Emitter for select actions on the */\n    @Output() public select = new EventEmitter<void>();\n\n    /** Whether space image should be displayed */\n    public get show_image() {\n        return this._service.setting('app.space_display.show_images');\n    }\n\n    /** Whether this space is selected */\n    public get selected(): boolean {\n        /* istanbul ignore else */\n        if (!this.form && this.space) {\n            return false;\n        }\n\n        return (this.form.controls.space_list && !!(this.form.controls.space_list.value || []).find((space) => space.id === this.space.id));\n    }\n\n    public get is_hidden(): boolean {\n        return false;\n    }\n\n    /** Whether space is booked by request */\n    public get is_request(): boolean {\n        return false;\n    }\n\n    public get availableOccurrences(): number {\n        if(this.space && this.space.recurrence_availability) {\n            return this.space.recurrence_availability.filter(recurr => recurr.available).length;\n        }\n    }\n\n    public get totalOccurrences(): number {\n        return this.space.recurrence_availability.length;\n    }\n\n    /** Display location of the space */\n    public get location(): string {\n        /* istanbul ignore else */\n        if (!this.space) {\n            return 'Unable to determine location';\n        }\n        const level = this.space.level;\n        const bld = this._org.buildings.find((building) => building.id === level.building_id);\n        return `${bld ? bld.name + ', ' : ''}${level.name}`;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _org: OrganisationService,\n    ) {\n        super();\n    }\n\n    public selectSpace() {\n        if(this.form.controls.is_recurrent.value){\n            const spaceConflicts = this.space.recurrence_availability.filter(recurr => !recurr.available);\n            this.form.controls.recurrence_exceptions.setValue(spaceConflicts.map((recurr)=> recurr.date))\n        }\n        this.select.emit();\n    }\n\n    public disableSelect(): boolean {\n        if (\n            this.form.controls.action.value === SeriesAction.CLONE\n            && this.availableOccurrences === 0\n        ) {\n            return true;\n        }\n\n        if (\n            this.form.controls.action.value === BookingAction.CLONE\n            && (this.space as any).bookable === false\n        ) {\n            return true;\n        }\n\n        return false;\n    }\n}\n","<div class=\"space-details\" *ngIf=\"space && !is_hidden\" [class.with-image]=\"show_image\">\n    <div class=\"details\">\n        <div\n            class=\"image\"\n            *ngIf=\"space.image\"\n            [style.background-image]=\"'url(' + space.image + ')'\"\n        ></div>\n        <div class=\"overlay\"></div>\n        <div class=\"name\">{{ space.local_name }}</div>\n        <div class=\"info\">\n            <div class=\"location\">{{ location }}</div>\n            <div class=\"capacity\">\n                <app-icon\n                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'account_circle' }\"\n                ></app-icon>\n                {{ space.capacity || '0' }}\n            </div>\n        </div>\n        <div\n            class=\"info occurrence_availability\"\n            [class.warning]=\"availableOccurrences === 0\"\n            *ngIf=\"this.form.controls.is_recurrent.value && space.recurrence_availability\"\n            i18n=\"Booking space availability label\"\n        >\n            Available for {{ availableOccurrences }} out of {{ totalOccurrences }} occurrences\n        </div>\n    </div>\n    <div class=\"actions\">\n        <button\n            mat-button\n            name=\"select\"\n            [disabled]=\"disableSelect()\"\n            [class.inverse]=\"multi && !selected\"\n            (click)=\"selectSpace()\"\n        >\n            {{ multi ? (selected ? 'Remove' : 'Select') : is_request ? 'Request' : 'Book' }}\n        </button>\n    </div>\n</div>\n","import { Component, Input, Output, EventEmitter, ViewChild, ElementRef } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport { setRecurrenceStartsTime } from '@mckinsey-converge/data-common';\nimport { BookingFlowEvent } from '../booking-modal.component';\n\n@Component({\n    selector: 'booking-spaces-form',\n    templateUrl: './form.component.html',\n    styleUrls: ['./form.component.scss']\n})\nexport class BookingSpaceFlowFormComponent {\n    /** Booking form fields */\n    @Input() public form: FormGroup;\n    /** Whether form is not the first page in the flow */\n    @Input() public can_return: boolean = false;\n    /** Emitter for flow update events */\n    @Output() public event = new EventEmitter<BookingFlowEvent>();\n\n    @ViewChild('container', { static: true }) private container: ElementRef<HTMLDivElement>;\n\n    /** Move flow to next step */\n    public next(): void {\n        if(this.form.controls?.is_recurrent?.value){\n            setRecurrenceStartsTime(this.form)\n        }\n\n        this.form.markAllAsTouched();\n        this.form.updateValueAndValidity();\n        /* istanbul ignore else */\n        if (this.form.valid) {\n            this.event.emit({ type: 'next', step: 'form' });\n        } else if (this.container) {\n            this.container.nativeElement.scrollIntoView({\n                behavior: 'smooth',\n                block: 'start',\n                inline: 'nearest'\n            });\n        }\n    }\n\n    /** Move flow to previous step */\n    public previous(): void {\n        this.event.emit({ type: 'previous', step: 'form' });\n    }\n\n    /** Reset form to initial state */\n    public resetForm(): void {\n        this.event.emit({ type: 'reset', step: 'form' });\n    }\n}\n","<div class=\"booking-form\" #container>\n    <form [formGroup]=\"form\" (ngSubmit)=\"next()\">\n        <div class=\"body\">\n            <a-booking-form [form]=\"form\"></a-booking-form>\n        </div>\n        <div class=\"footer\">\n            <button\n                mat-button\n                type=\"button\"\n                name=\"return\"\n                *ngIf=\"can_return\"\n                class=\"inverse\"\n                (click)=\"previous()\"\n                i18n=\"Booking form cancel action\"\n            >\n                Back\n            </button>\n            <button mat-button type=\"submit\" name=\"next\" i18n=\"Booking form continue action\">\n                Next\n            </button>\n        </div>\n    </form>\n</div>\n","import { NgModule } from '@angular/core';\nimport { BookingSpaceFlowFormComponent } from './booking-modal/form/form.component';\nimport { BookingCateringComponent } from './booking-modal/catering/catering.component';\nimport { BookingFindSpaceComponent } from './booking-modal/find-space/find-space.component';\nimport { BookingSpaceFiltersComponent } from './booking-modal/find-space/filters/filters.component';\nimport { BookingSpaceItemComponent } from './booking-modal/find-space/item/item.component';\nimport { BookingCateringOrderListComponent } from './booking-modal/catering/order-list/order-list.component';\nimport { BookingModalComponent } from './booking-modal/booking-modal.component';\nimport { BookingCateringOrderDetailsComponent } from './booking-modal/catering/order-details/order-details.component';\nimport { CateringOrderListItemComponent } from './booking-modal/catering/order-list/item/item.component';\nimport { CateringMenuCategoryComponent } from './booking-modal/catering/order-details/category/category.component';\nimport { DeleteConfirmModalComponent } from './delete-confirm-modal/delete-confirm-modal.component';\nimport { CommonModule } from '@angular/common';\nimport { SharedContentModule } from '../shared/shared.module';\nimport {\n    FormsModule,\n    ReactiveFormsModule\n} from '@angular/forms';\nimport { LegacyOverlaysModule } from '@mckinsey-converge/legacy-overlays';\nimport { UiModule } from '@mckinsey-converge/ui';\n\n\n@NgModule({\n    declarations: [\n        BookingSpaceFlowFormComponent,\n        BookingCateringComponent,\n        BookingFindSpaceComponent,\n        BookingSpaceFiltersComponent,\n        BookingSpaceItemComponent,\n        BookingCateringComponent,\n        BookingCateringOrderListComponent,\n        BookingModalComponent,\n        BookingCateringOrderDetailsComponent,\n        CateringOrderListItemComponent,\n        CateringMenuCategoryComponent,\n        DeleteConfirmModalComponent,\n    ],\n    imports: [\n        CommonModule,\n        SharedContentModule,\n        FormsModule,\n        ReactiveFormsModule,\n        LegacyOverlaysModule,\n        UiModule\n    ],\n    exports: [\n        BookingCateringOrderDetailsComponent\n    ]\n})\nexport class BookingsModule {\n}\n","import { Component, OnInit, Output, EventEmitter } from '@angular/core';\nimport { DialogEvent } from '@mckinsey-converge/base';\n\n@Component({\n  selector: 'app-delete-confirm-modal',\n  templateUrl: './delete-confirm-modal.component.html',\n  styleUrls: ['./delete-confirm-modal.component.scss']\n})\nexport class DeleteConfirmModalComponent {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Loading state */\n    public loading: boolean;\n    /** Whether delete action succeeded */\n    public success: boolean;\n}\n","<mat-dialog-content>\n    <main *ngIf=\"!loading; else load_state\">\n        <div class=\"icon\">\n            <img [src]=\"'assets/img/delete' + (success ? '-success' : '') + '.svg'\" />\n        </div>\n        <div class=\"contents\" *ngIf=\"!success; else success_state\">\n            <p>Are you sure you want to delete this meeting?</p>\n            <p class=\"error\">\n                This will permanently delete the booking and all details from the host and attendees\n                calendars.\n            </p>\n        </div>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions *ngIf=\"!loading && !success\">\n    <footer>\n        <button mat-button mat-dialog-close class=\"inverse\">Cancel</button>\n        <button mat-button class=\"delete\" (click)=\"event.emit({ reason: 'action' })\">\n            Yes, permanently delete\n        </button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main>\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">Deleting meeting...</div>\n        </div>\n    </main>\n</ng-template>\n<ng-template #success_state>\n    <div class=\"contents\">\n        <p>Booking <span class=\"error\">Permanently deleted</span></p>\n    </div>\n</ng-template>\n","import { NgModule } from '@angular/core';\nimport { MeetingDetailsModalComponent } from './meeting-details-modal/meeting-details-modal.component';\nimport { PrivateDetailsModalComponent } from './meeting-details-modal/private-details-modal/private-details-modal.component';\nimport { CommonModule } from '@angular/common';\nimport { SharedContentModule } from '../shared/shared.module';\nimport {\n    FormsModule,\n    ReactiveFormsModule\n} from '@angular/forms';\nimport { LegacyOverlaysModule } from '@mckinsey-converge/legacy-overlays';\nimport { MeetingDetailsDisplayComponent } from './meeting-details-modal/details/details.component';\nimport { MeetingRecurringDetailsDisplayComponent } from './meeting-details-modal/recurring-details/recurring-details.component';\nimport { MeetingDetailsRequirementsComponent } from './meeting-details-modal/requirements/requirements.component';\nimport { MeetingCateringDetailsComponent } from './meeting-details-modal/catering/catering.component';\nimport { MeetingPrivateDetailsComponent } from './meeting-details-modal/private-details/private-details.component';\nimport { ScrollingModule } from '@angular/cdk/scrolling';\n\n\n@NgModule({\n    declarations: [\n        MeetingDetailsModalComponent,\n        PrivateDetailsModalComponent,\n        MeetingDetailsDisplayComponent,\n        MeetingRecurringDetailsDisplayComponent,\n        MeetingDetailsRequirementsComponent,\n        MeetingCateringDetailsComponent,\n        MeetingPrivateDetailsComponent,\n    ],\n    imports: [\n        CommonModule,\n        SharedContentModule,\n        FormsModule,\n        ReactiveFormsModule,\n        LegacyOverlaysModule,\n        ScrollingModule\n    ],\n    exports: []\n})\nexport class CalendarModule {\n}\n","import { Component, OnInit, OnDestroy, ChangeDetectionStrategy, NgZone, ChangeDetectorRef } from '@angular/core';\nimport { first, map, take, takeWhile } from 'rxjs/operators';\n\nimport { Booking, BookingsPaginatedService, BookingsService, OrganisationService, User } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { UserStoreState, selectCurrentUser } from '@mckinsey-converge/user';\nimport { Store } from '@ngrx/store';\nimport * as cloneDeep from 'lodash/cloneDeep';\nimport { getListOfDateFormat, formatDateWithSuffix } from '@mckinsey-converge/base';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n@Component({\n\tselector: 'day-view-approvals-view',\n\ttemplateUrl: './approvals-view.component.html',\n\tstyleUrls: ['./approvals-view.component.scss'],\n\tchangeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class DayViewApprovalsComponent extends BaseDirective implements OnInit, OnDestroy {\n\t/** List of spaces to check for pending approvals */\n\t// public space_list: string[] = [];\n\t/** Whether the pending bookings are being loaded */\n\tpublic loading: boolean = true;\n\t/** Whether an event action is in progress */\n\t// public waiting_on_event: boolean;\n\t/** Observable for tentative events */\n\n\tpublic inputText: string = '';\n\n\tpublic incommingRequests: Booking[] = [];\n\tpublic sortOrderByOptions: { display: string; value: string; meta: {}; }[];\n\tpublic selectedSort: { display: string; value: string; meta: {}; } = { display: 'Soonest booking', value: 'Soonest booking', meta: {} };\n\n\tpublic isClosed: boolean = false;\n\tpublic updatedRequest: Booking[] = [];\n\n\t/** Display value for the active date */\n\t// public get date_display(): string {\n\t// \treturn 'Today';\n\t// }\n\n\tpublic currentUser: User;\n\n\tconstructor(\n\t\tprivate _org: OrganisationService,\n\t\tprivate _bookings_service: BookingsPaginatedService,\n\t\tprivate store: Store<UserStoreState>,\n\t\tprivate _bookings: BookingsService,\n\t\tprivate _zone: NgZone,\n\t\tprivate cdRef: ChangeDetectorRef) {\n\t\tsuper();\n\t}\n\n\tpublic ngOnInit(): void {\n\t\tthis.subscription('currentUser', this.store.select(selectCurrentUser)\n\t\t\t.pipe(take(1))\n\t\t\t.subscribe((user: User) => {\n\t\t\t\t// Once we know we have the user loaded\n\t\t\t\tthis.currentUser = new User(user);\n\t\t\t\tthis.getHoldingBay();\n\t\t\t})\n\t\t);\n\n\t\tthis.subscription(\n\t\t\t'building',\n\t\t\tthis._org.listen('active_building').subscribe((_) => this.currentUser && this.getHoldingBay() )\n\t\t);\n\n\t\tthis._zone.runOutsideAngular(() => {\n\t\t\tthis.interval('holdingBay', () => {\n\t\t\t\t// update every 30 seconds.\n\t\t\t\tthis.getHoldingBay();\n\t\t\t}, 30 * 1000);\n\t\t});\n\n\t\tthis.sortOrderByOptions = [\n\t\t\t{ display: 'Soonest booking', value: 'soonest', meta: {} },\n\t\t\t{ display: 'Latest booking', value: 'latest', meta: {} },\n\t\t\t{ display: 'Newest request creation date', value: 'newest_date', meta: {} },\n\t\t\t{ display: 'Oldest request creation date', value: 'oldest_date', meta: {} }\n\t\t];\n\n\t\tthis.selectedSort = { display: 'Soonest booking', value: 'Soonest booking', meta: {} };\n\t}\n\n\tpublic getHoldingBay() {\n\t\tif (!this._org.building || !this.currentUser) {\n\t\t\treturn;\n\t\t}\n\n\t\t\n\n\t\tthis.subscription('holdingBay', this._bookings_service.getHoldingBay(\n\t\t\t{\n\t\t\t\t'email': this.currentUser.email,\n\t\t\t\t'building_zone': this._org.building.id,\n\t\t\t}\n\t\t\t).subscribe((res) => {\n\t\t\t// this.incommingRequests = cloneDeep(res.results); // [...res.results];\n\t\t\tlet expiredBkngs = [];\n\t\t\tconst pendingBkngs = res.results?.filter(bkng => (bkng.timeBasedStatusLabel !== 'expired_yesterday') ? true : !expiredBkngs.push(bkng) ) || [];\n\t\t\texpiredBkngs.length && this.declineExpiredBookings(expiredBkngs);\n\t\t\t\n\t\t\t this.updatedRequest = cloneDeep(pendingBkngs);\n\t\t\t//  const request = cloneDeep(this.updatedRequest);\n\t\t\t this.searchRequest();\n\t\t\t// this.applyOrderBy(request);\n\t\t\tthis.loading = false;\n\t\t\tthis.cdRef.detectChanges();\n\t\t\t},\n\t\t\t(error) => {\n\t\t\t\tconsole.log(error);\n\t\t\t\tthis.incommingRequests = [];\n\t\t\t\tthis.loading = false;\n\t\t\t\tthis.cdRef.detectChanges();\n\t\t\t})\n\t\t);\n\t}\n\n\t/* istanbul ignore next */\n\t/**\n\t * Track by function for ngFor optimisation\n\t * @param index Index of the item\n\t * @param item Data associated with the item at the given index\n\t */\n\tpublic trackByFn(index: number, item: Booking) {\n\t\treturn item.id || index;\n\t}\n\n\t/**\n\t * store selected border by sorting method and apply to \n\t * @param sortingValue \n\t */\n\tpublic selectOrderBy(sortingValue: { display: string; value: string; meta: {}; }) {\n\t\tthis.selectedSort = sortingValue;\n\t\t// this.applyOrderBy(this.incommingRequests);\n\t\tthis.searchRequest();\n\t}\n\n\t/**\n\t * Function apply order by sorting method to incomming requests for approval\n\t * @param requests \n\t */\n\tpublic applyOrderBy(requests: Booking[]): void {\n\t\tconst items = cloneDeep(requests);\n\t\tswitch (this.selectedSort.value) {\n\t\t\tcase 'soonest':\n\t\t\t\titems.sort((a, b) => a.start_epoch - b.start_epoch );\n\t\t\t\tbreak;\n\t\t\tcase 'latest':\n\t\t\t\titems.sort((a, b) => b.start_epoch - a.start_epoch );\n\t\t\t\tbreak\n\t\t\tcase 'newest_date':\n\t\t\t\titems.sort((a, b) => b.created_epoch - a.created_epoch )\n\t\t\t\tbreak;\n\t\t\tcase 'oldest_date':\n\t\t\t\titems.sort((a, b) => a.created_epoch - b.created_epoch )\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\titems.sort((a, b) => a.start_epoch - b.start_epoch );\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.incommingRequests = items;\n\t\tthis.cdRef.detectChanges();\n\t}\n\n\tpublic totalCateringItems(booking: Booking) {\n\t\tlet num = 0;\n\t\tbooking.catering.forEach(el =>  el?.items.forEach(item => num += item.amount ) );\n\t\treturn num;\n\t}\n\n\tpublic searchRequest(value?: string) {\n\t\t// console.log(value);\n\t\tconst searchText = this.inputText.toLowerCase();\n\t\t\n\t\t\tconst filtered  = this.updatedRequest.filter( (el) => {\n\t\t\tconst { room, organiser, booked_by, booker, booking_type, attendees, date_string, startDateTz, start_time, end_time, creationDateTz } = el;\n\n\t\t\treturn room?.name?.toLowerCase().includes(searchText) ||            /// input text inlcudes room name\n\t\t\t\troom?.local_name?.toLowerCase().includes(searchText) ||            /// input text inlcudes room local name\n\t\t\t\troom?.street_and_city?.toLowerCase().includes(searchText) ||       /// input text inlcudes room address\n\t\t\t\troom?.building?.address?.toLowerCase().includes(searchText) ||     /// input text inlcudes room address\n\t\t\t\troom?.level.name?.toLowerCase().includes(searchText) ||              /// input text inlcudes room level\n\n\t\t\t\torganiser?.name?.toLowerCase().includes(searchText) ||               ///input text inlcudes host name\n\t\t\t\t(booked_by && booked_by['name']?.toLowerCase().includes(searchText)) ||             ///input text inlcudes booked by name\n\t\t\t\t(booker && booker['name']?.toLowerCase().includes(searchText)) ||                ///input text inlcudes booker name\n\t\t\t\tbooking_type?.toLowerCase().includes(searchText)\t||\n\t\t\t\tattendees?.some(att => att?.name?.toLowerCase().includes(searchText)) ||  ///input text inlcudes attendees name\n\n\t\t\t\tdate_string?.toLowerCase().includes(searchText) ||                         /// date_string == '06 Mar 2023'\n\t\t\t\tformatDateWithSuffix(date_string).toLowerCase().includes(searchText) ||      /// date_string == '06th Mar 2023'  \n\t\t\t\tformatDateWithSuffix(creationDateTz.formatDate('dd MMM yyyy')).toLowerCase().includes(searchText) ||      /// date_string == '06th Mar 2023'              \n\t\t\t\t//searchText.includes(startDateTz?.date?.day?.toString()) ||   /// day 06/6\n\t\t\t\t//searchText.includes(startDateTz?.date?.monthLong) ||         /// monthLong == 'March'\n\t\t\t\t//searchText.includes(startDateTz?.date?.monthShort) ||        /// monthShort == 'Mar'\n\t\t\t\tsearchText.includes(startDateTz?.date?.weekdayLong.toLowerCase()) ||       /// weekdayLong == 'Monday'\n\t\t\t\tsearchText.includes(startDateTz?.date?.weekdayShort.toLowerCase()) ||        /// weekdayShort == 'Mon'\n\t\t\t\t\n\n\t\t\t\tgetListOfDateFormat().some(format => startDateTz?.formatDate(format).toLowerCase().includes(searchText) ) ||\n\t\t\t\tgetListOfDateFormat().some(format => creationDateTz?.formatDate(format).toLowerCase().includes(searchText) ) ||\n\n\t\t\t\tstart_time?.toLowerCase().includes(searchText) ||\n\t\t\t\tend_time?.toLowerCase().includes(searchText)\n\n\t\t\t\n\t\t\t}); \n\t\t\t\n\t\t\tthis.applyOrderBy(filtered);\n\t}\n\t\n\tpublic declineExpiredBookings(expiredBkngs: Booking[] ) {\n\t\t// console.log(expiredBkngs);\n\t\tthis._bookings.declineMultiple(expiredBkngs).subscribe(resArray => this.cdRef.detectChanges(),\n\t\t(error) => {\n\t\t\tconsole.log(error);\n\t\t\tthis.cdRef.detectChanges();\n\t\t});\n\n\t}\n\n}\n","<div class=\"approvals-view\">\n    <div class=\"flex-column head\" >\n        <div  class=\"holding-bay-search flex-row\" matRipple >\n            <input type=\"text\" matInput [(ngModel)]=\"inputText\" (keyup)=\"searchRequest(inputText)\"\n\t\t\t\t\t\t\tplaceholder=\"Type to search (level, number or name) ...\" >\n\t\t\t\t\t<button  class=\"close-button mck-short mck-short-height mck-form-input\" [hidden]=\"!inputText\">\n\t\t\t\t\t\t<div matRipple class=\"close-button-icon\" (click)=\"$event.stopPropagation(); inputText=''; searchRequest(inputText)\"></div>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button class=\"search-button mck-short mck-short-height mck-form-input\" \t>\n\t\t\t\t\t\t<div class=\"search-button-icon\"></div>\n\t\t\t\t\t</button>\n        </div>\n\n        <div [dropdownTriggerFor]=\"dropdown\" class=\"holding-bay-select flex-row\" matRipple (isPanelOpened)=\"isClosed = !isClosed\">\n            <span class=\"selecte-sort\" style=\"flex: 1 1 auto ;\">Order by: {{selectedSort.display}}</span>\n            <div class=\"mck-column select-chevron\">\n                <mck-chevron-icon [up]=\"isClosed\" matSuffix fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n            </div>\n        </div>\n\n        <cng-select-options #dropdown ddWidth=\"382px\" >\n            <div matRipple *ngFor=\"let sorting of sortOrderByOptions\" (click)=\"selectOrderBy(sorting)\" class=\"dropdown-item flex-row\">{{sorting.display}}</div>\n        </cng-select-options>\n    </div>\n    <cdk-virtual-scroll-viewport\n        *ngIf=\"incommingRequests?.length; else empty_state\"\n        [itemSize]=\"80\"\n        appendOnly\n        orientation=\"vertical\"\n        class=\"viewport\"\n    >\n        <ng-container *cdkVirtualFor=\"let item of incommingRequests; trackBy: trackByFn\">\n            <approvals-event [event]=\"item\" [totalCateringItems]=\"totalCateringItems(item)\" (acting)=\"waiting_on_event = $event\"></approvals-event>\n        </ng-container>\n    </cdk-virtual-scroll-viewport>\n    <div class=\"load-state\" *ngIf=\"loading\">\n        <div class=\"no-item center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n        </div>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block center\" *ngIf=\"!loading\">\n        <div class=\"icon\">\n            <i class=\"material-icons\">close</i>\n        </div>\n        <div class=\"text\">No meetings pending approval</div>\n    </div>\n</ng-template>\n","import { Component, Input, Output, EventEmitter, NgZone, ChangeDetectorRef, ChangeDetectionStrategy, OnInit, ViewEncapsulation, SimpleChanges } from '@angular/core';\nimport { trigger, style, animate, transition } from '@angular/animations';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { Booking, CateringCategory, CateringItem, SpacesService } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { CateringOrder } from '@mckinsey-converge/data-common';\nimport { DialogEvent } from '@mckinsey-converge/base';\nimport { ConfirmModalComponent } from '@mckinsey-converge/legacy-overlays';\nimport { MeetingDetailsModalComponent } from 'src/app/calendar/meeting-details-modal/meeting-details-modal.component';\nimport { BookingsService } from '@mckinsey-converge/data-common';\nimport { BookingStateService, BOOKING_STATUS } from '@mckinsey-converge/data-common';\nimport {  formatDateWithSuffix } from '@mckinsey-converge/base';\n\nconst STATES: { [id: string]: string } = {};\n\n@Component({\n    selector: 'approvals-event',\n    templateUrl: './event.component.html',\n    styleUrls: ['./event.component.scss'],\n\t\t// encapsulation: ViewEncapsulation.None,\n    animations: [\n        trigger('show', [\n            transition(':enter', [\n                style({ opacity: 0, height: 0 }),\n                animate(200, style({ opacity: 1, height: '*' })),\n            ]),\n            transition(':leave', [\n                style({ opacity: 1, height: '*' }),\n                animate(200, style({ opacity: 0, height: 0 })),\n            ]),\n        ]),\n    ],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class DayViewApprovalsEventComponent extends BaseDirective implements OnInit {\n    /** Event to display */\n    @Input() event: Booking;\n    @Input() totalCateringItems: number;\n    /** Event emitter for event actions */\n    @Output() acting = new EventEmitter<boolean>();\n\n    /** Whether approval action is being processed */\n    public loading: boolean;\n    /** Whether event details are shown */\n    public shown: boolean;\n    /* Booking type : Internal, External, Interview... */\n    public bookingType: string;\n    /* Booking date */\n    public date: string;\n    /* Booking creation date */\n    public creationDate: string;\n    /* Office address */\n    public officeAddress: string;\n\n    public showCateringNote: boolean = false;\n\n    public showEquipmentNote: boolean = false;\n\n\t\t /** Whether the meeting has catering attached */\n    public has_catering: boolean;\n    public cateringNote: string = '';\n    public equipmentNote: string = '';\n    public cateringOrderItems: number = 0;\n\n   \n    /** Type of event */\n    public get start(): string {\n        return this.event.startDateTz.formatDate('h:mm a').toLocaleLowerCase();\n    }\n\n    /** Type of event */\n    public get end(): string {\n        return this.event.endDateTz.formatDate('h:mm a').toLocaleLowerCase();\n    }\n\n    /** View booking details */\n    public view() {\n        const room_id = Object.keys(this.event.approval_status)[0] || '';\n        const space = this._spaces.find(room_id) || this.event.room\n        this.timeout(\n            'view',\n            () => {\n                this._dialog.open(MeetingDetailsModalComponent, {\n                    data: {\n                        space,\n                        booking: new Booking({ ...this.event.toApiJSON(), room_id, room: space }),\n                    },\n                    autoFocus: false,\n                    backdropClass: 'mck-modal-backdrop',\n                });\n                this._service.set('CONCIERGE.day_view.viewing', this.event);\n            },\n            50\n        );\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _bookings: BookingsService,\n        private _booking_state_sevice: BookingStateService,\n        private _dialog: MatDialog,\n        private _spaces: SpacesService,\n        private _zone: NgZone,\n        private cdRef: ChangeDetectorRef,\n    ) {\n        super();\n    }\n    ngOnInit(): void {\n        this.cateringOrderItems = 0\n       this.updateData();\n    }\n\n    public updateData() {\n        const type = this.event.booking_type;\n        this.bookingType = `${type.charAt(0).toUpperCase()}${type.slice(1)}`;\n        const catering: readonly CateringOrder[] = this.event.catering;\n        this.has_catering = !!catering.find((order) => this.event.space.email === order.location_id);\n        this.cateringNote = this.event.notes.filter(el => el.type === 'catering')[0]?.message || '';\n        this.equipmentNote = this.event.notes.filter(el => el.type === 'equipment')[0]?.message || '';\n\n        const createdDate = this.event.creationDateTz.formatDate('dd MMM yyyy');\n        const createdTime = this.event.creationDateTz.formatDate('h:mm a').toLocaleLowerCase();\n        this.creationDate = `${ formatDateWithSuffix(createdDate) },  ${ createdTime }`;\n        this.date =  formatDateWithSuffix(this.event.date_string);\n        this.officeAddress = `${this.event.room.building?.name} ${this.event.room.level.name} ${this.event.space.building?.city}`;\n        this.cdRef.detectChanges();\n    }\n\n      \n    /**\n     * Approve the meeting for the set room\n     */\n    public accept(event: Event) {\n\t\t\t\tevent.stopPropagation();\n        this.acting.emit(true);\n        const ref = this._dialog.open(ConfirmModalComponent, {\n            data: {\n                title: 'Approve Meeting',\n                content: `Approve ${this.event.organiser.name}'s meeting in \"${this.event.space.name}\" at ${this.event.start_time} for ${this.event.length_string} on ${this.event.date_string}`,\n                icon: { type: 'icon', class: 'material-icons', content: 'event_available' },\n                action: 'Ok',\n            },\n            autoFocus: false,\n      backdropClass: 'mck-modal-backdrop',\n        });\n        ref.componentInstance.event.subscribe((event: DialogEvent) => {\n            /* istanbul ignore else */\n            if (event.reason === 'done') {\n                this.loading = true;\n                const event = this.event.toJSON();\n                this._bookings\n                    .accept(this.event.id, {\n                        concierge: true,\n                        host: this.event.organiser.email,\n                        room_email: this.event.space?.email,\n                        icaluid: this.event.icaluid,\n                        start: event.start,\n                        end: event.end\n                    })\n                    .then(\n                        (acceptedBooking) => {\n                            this._service.notifySuccess('Meeting approved.');\n                            this.event.status = BOOKING_STATUS.approved;\n                            STATES[this.event.id] = BOOKING_STATUS.approved;\n                            this._booking_state_sevice.replace(this.event);\n                            this._service.set('BOOKING.states', STATES);\n                            this.loading = false;\n                            this.acting.emit(false);\n                            this.cdRef.detectChanges();\n                        },\n                        () => {\n                            this.acting.emit(false);\n                            this._service.notifyError('Error approving meeting.');\n                            this.loading = false;\n                            this.cdRef.detectChanges();\n                        }\n                    );\n            }\n            ref.close();\n        });\n    }\n\n    /**\n     * Decline meeting for the set room\n     */\n    public decline(event: Event) {\n\t\t\tevent.stopPropagation();\n        this.acting.emit(true);\n        const ref = this._dialog.open(ConfirmModalComponent, {\n            data: {\n                title: 'Decline Meeting',\n                content: `Decline ${\n                    this.event.organiser.name || this.event.organiser\n                }'s meeting in \"${this.event.space.name}\" at ${this.event.start_time} for ${\n                    this.event.length_string\n                } on ${this.event.date_string}`,\n                icon: { type: 'icon', class: 'material-icons', content: 'event_busy' },\n                action: 'Ok',\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n        ref.componentInstance.event.subscribe((event: DialogEvent) => {\n            /* istanbul ignore else */\n            if (event.reason === 'done') {\n                this.loading = true;\n                const booking = this.event.toJSON();\n                this.loading = true;\n                this._bookings\n                    .decline(booking.id, {\n                        booking_id: booking.id,\n                        organiser: booking.organiser.email,\n                        room_email: this.event.space?.email,\n                        icaluid: booking.icaluid,\n                        start: booking.start,\n                        end: booking.end,\n                        \n                    })\n                    .then(\n                        () => {\n                            this._service.notifySuccess('Meeting declined.');\n                            this.event.status = BOOKING_STATUS.declined;\n                            STATES[this.event.id] = BOOKING_STATUS.declined;\n                            this._booking_state_sevice.replace(this.event);\n                            this._service.set('BOOKING.states', STATES);\n                            this.loading = false;\n                            this.acting.emit(false);\n                            this.cdRef.detectChanges();\n                        },\n                        () => {\n                            this.acting.emit(false);\n                            this._service.notifyError('Error declining meeting.');\n                            this.loading = false;\n                            this.cdRef.detectChanges();\n                        }\n                    );\n            }\n            ref.close();\n        });\n    }\n\n\n\t\tngOnChanges(changes: SimpleChanges) {\n\t\t\t// console.log('CHANGES: ',changes);\n\t\t\tthis.updateData();\n\t\t\tthis.cdRef.detectChanges();\n\t\t}\n}\n","<div class=\"approval-card flex-column\" >\n\t<div class=\"card-header flex-row\" (click)=\"view()\" name=\"view\" >\n\t\t<!-- {{ event.title }} -->\n\t\t<div class=\"room-detail flex-column\">\n\t\t\t<div class=\"rm-name\">{{ event.space?.global_name ? event.space.local_name : '' }}</div>\n\t\t\t<div class=\"flex-row booking-details\">\n\t\t\t\t<div *ngIf=\"equipmentNote\">\n\t\t\t\t\t<!--  (mouseenter)=\"$event.stopPropagation(); showEquipmentNote = !showEquipmentNote\"  (mouseleave)=\"$event.stopPropagation(); showEquipmentNote = !showEquipmentNote\"  -->\n\t\t\t\t\t<app-icon [icon]=\"{ class: 'material-icons', type: 'img', src : './assets/img/Document-Content.svg'  }\" (click)=\"$event.stopPropagation(); showCateringNote = false; showEquipmentNote = !showEquipmentNote\"   ></app-icon>\n\t\t\t\t\t<div class=\"hint\" *ngIf=\"showEquipmentNote\">\n\t\t\t\t\t\t<div class=\"triangle equipment\"></div>\n\t\t\t\t\t\t<div class=\"hint-wrapper\">\n\t\t\t\t\t\t\t\t<div >{{equipmentNote}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div  *ngIf=\"has_catering\">\n\t\t\t\t\t<!--  (mouseenter)=\"$event.stopPropagation(); showCateringNote = !showCateringNote\" (mouseleave)=\"$event.stopPropagation(); showCateringNote = !showCateringNote\" -->\n\t\t\t\t\t<app-icon [icon]=\"{ class: 'material-icons', type: 'img', src : './assets/img/small.svg' }\"  (click)=\"$event.stopPropagation(); showEquipmentNote = false; showCateringNote = !showCateringNote\" ></app-icon>\n\t\t\t\t\t<!--  -->\n\t\t\t\t\t<div class=\"hint\" *ngIf=\"showCateringNote \" >\n\t\t\t\t\t\t<div class=\"triangle \" [ngStyle]=\"{left: equipmentNote ? '55px' : '24px' }\"></div>\n\t\t\t\t\t\t<div class=\"hint-wrapper\">\n\t\t\t\t\t\t\t\t<!-- <div *ngFor=\"let catItem of catering; let i = index\" class=\"flex-column\" > -->\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<!-- Order {{i+0}} -->\n\t\t\t\t\t\t\t\t\t\t{{totalCateringItems}} items in catering order\n\t\t\t\t\t\t\t\t\t<!-- <span *ngFor=\"let item of catItem.items\">{{item.name}}</span> -->\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<!-- <ul class=\"a\" style=\"list-style-type: circle; margin: 0px;\">\n\t\t\t\t\t\t\t\t\t\t<li *ngFor=\"let item of catItem.items\">{{item.name}}</li>\n\t\t\t\t\t\t\t\t\t  </ul> -->\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\t<div class=\"booking-type flex-center\" [ngClass]=\"{'external': bookingType === 'External'}\">{{ bookingType }}</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"booking-date-details flex-row\">\n\t\t\t<!-- for normal booking -->\n\t\t\t<div class=\"flex-column flex-end\">\n\t\t\t\t<span> {{ date }} </span>\n\t\t\t\t<span> {{ event.all_day ? 'All Day' : start + ' - ' + end }} </span>\n\t\t\t\t<span></span>\n\t\t\t</div>\n\t\t\t<!-- for rucurring booking  -->\n\t\t</div>\n\t</div>\n\t<div class=\"card-content flex-column\" (click)=\"view()\" name=\"view\" >\n\t\t<div class=\"flex-row content-row\">\n\t\t\t<span class=\"icon\">\n\t\t\t\t<app-icon [icon]=\"{ class: 'material-icons', type: 'img', src : './assets/img/Pin.svg' }\" ></app-icon>\n\t\t\t</span>\n\t\t\t<span class=\"info\">{{ officeAddress }}</span>\n\t\t</div>\n\n\t\t<div class=\"flex-row content-row\">\n\t\t\t<span class=\"icon\">\n\t\t\t\t<app-icon [icon]=\"{ class: 'material-icons', type: 'img', src : './assets/img/User (single).svg' }\" ></app-icon>\n\t\t\t</span>\n\t\t\t<span class=\"info\">\n\t\t\t\t<label for=\"name\">Host:</label>\n\t\t\t\t <span name=\"host\"> {{ event.organiser?.name }}</span>\n\t\t\t\t</span>\n\t\t</div>\n\n\t\t<div class=\"flex-row content-row\">\n\t\t\t<span class=\"icon\">\t\t\t<app-icon [icon]=\"{ class: 'material-icons', type: 'img', src : './assets/img/User (multiple).svg' }\" ></app-icon></span>\n\t\t\t<span class=\"info\" >{{ event.attendees.length }}<label for=\"attendees\"> attendees</label> </span>\n\t\t</div>\n\n\t\t<div class=\"flex-row content-row format-attendee\" >\n\t\t\t<span class=\"icon\"><app-icon [icon]=\"{ class: 'material-icons', type: 'img', src : './assets/img/User (single).svg' }\" ></app-icon></span>\n\t\t\t<div class=\"info flex-row \" name=\"attendees\">\n\t\t\t\t<div class=\"attendee-wrapper\" *ngFor=\"let item of event.attendees\">\n\t\t\t\t\t<div class=\"attendees flex-center\" [ngClass]=\" {'external': item.external }\">{{ item.name }}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"flex-row content-row\"  *ngIf=\"\n\t\t\tevent.creator &&\n\t\t\tevent.organiser &&\n\t\t\tevent.organiser.email !== event.creator.email\" >\n\n\t\t\t<span class=\"icon\">\n\t\t\t\t<app-icon [icon]=\"{ class: 'material-icons', type: 'img', src : './assets/img/User (single).svg' }\" ></app-icon>\n\t\t\t</span>\n\t\t\t<span class=\"info\"> \n\t\t\t\t<label for=\"bookee\">Booked by:</label>\n\t\t\t\t<span name=\"bookee\"> {{ event.creator?.name }}</span>\n\t\t\t</span>\n\t\t</div>\n\n\t\t<div class=\"flex-row content-row\">\n\t\t\t<span class=\"info requested-on\"> Requested on {{ creationDate }}</span>\n\t\t</div>\n\t</div>\n\t<div class=\"card-footer flex-row flex-center\">\n\t\t<button mat-button class=\"primary\" name=\"accept\"  (click)=\"accept($event)\"> Accept </button>\n\t\t<button mat-button  class=\"secondary\" name=\"decline\"  (click)=\"decline($event)\" > Decline </button>\n\t</div>\n</div>\n\n","import {\n    Component,\n    OnDestroy,\n    OnInit\n} from '@angular/core';\nimport {\n    ActivatedRoute,\n    Router\n} from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { first, take } from 'rxjs/operators';\n\nimport {\n    BaseDirective,\n    HashMap,\n    Identity\n} from '@mckinsey-converge/base';\nimport { BookingModalComponent } from 'src/app/bookings/booking-modal/booking-modal.component';\nimport {\n    ApplicationService,\n    BookingStateService,\n    BookingStoreState,\n    BuildingLevel,\n    OrganisationService,\n    selectBookingByIdResultsFromState,\n    User\n} from '@mckinsey-converge/data-common';\n\nimport {\n    AlertMode,\n} from '@mckinsey-converge/ui';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { MeetingDetailsModalComponent } from '../meeting-details-modal/meeting-details-modal.component';\nimport { MatSlideToggleChange } from '@angular/material/slide-toggle';\nimport { selectCurrentUser, UserStoreState } from '@mckinsey-converge/user';\nimport { select, Store } from '@ngrx/store';\nimport { BuildingStoreState } from 'libs/buildings/src';\nimport { clearBookingByIdResults, loadBookingsWithQuery, MyBookingsStoreState } from '@mckinsey-converge/bookings';\n\n\nexport type RoomBookingStoreState = BookingStoreState & BuildingStoreState & MyBookingsStoreState & UserStoreState;\n\n@Component({\n    selector: 'a-day-view',\n    templateUrl: './day-view.component.html',\n    styleUrls: ['./day-view.component.scss']\n})\nexport class DayViewComponent extends BaseDirective implements OnInit {\n    /** Currently selected date, starts out with no timezone data, gets updated later */\n    public dateTz: DateTZ = DateNow(new Date());\n    /** ID of the currently selected level */\n    public active_level: string = '';\n    /** ID of the currently selected type */\n    public active_type: string = '';\n    /** List of levels available for the active building */\n    public levels: BuildingLevel[] = [];\n    /** List of space types available for the active building */\n    public space_types: Identity[] = [];\n    /** Whether to show only items with a setup and/or breakdown time */\n    public only_overflow: boolean;\n    /** List of legend keys to show */\n    public legend: HashMap<boolean> = {};\n    /** List of legend keys to show */\n    public legend_list: string[] = [];\n    /** List of available legend keys */\n    public readonly legend_keys: readonly Identity[] = [\n        { name: 'Internal', id: 'internal', color: '#E69FC7', active: true },\n        { name: 'Client', id: 'client', color: '#1F40E6', active: true },\n        { name: 'External', id: 'external', color: '#8C5AC8', active: true },\n        { name: 'Setup', id: 'setup', color: '#d32f2f', active: true },\n        { name: 'Training', id: 'training', color: '#F0E700', active: true },\n        { name: 'Interview', id: 'interview', color: '#348D02', active: true },\n        { name: 'Declined', id: 'declined', color: '#617288', active: true }\n    ];\n\n    public banner_mode = AlertMode.Warning\n    public showBanner = true;\n    public undo_banner_mode = AlertMode.Error;\n    public has_access: boolean;\n    public undo_action: 'series' | 'booking';\n    private _undo_timer: any;\n\n    constructor(\n        private _service: ApplicationService,\n        private _org: OrganisationService,\n        private _dialog: MatDialog,\n        private _router: Router,\n        private _route: ActivatedRoute,\n        private _booking_state_service: BookingStateService,\n        private store: Store<RoomBookingStoreState>,\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._service.title = 'Day View';\n        this._org.initialised.pipe(first((_) => _)).subscribe(() => {\n            // Init dateTz here once the organization data is loaded.\n            this.dateTz = new DateTZ({ date: this.dateTz.ms, is_local_tz: false, building_tz: this.timezone });\n            this.legend_list = this.legend_keys.map((item) => `${item.id}`);\n            this.subscription(\n                'route.params',\n                this._route.paramMap.subscribe((params) => {\n                    /* istanbul ignore else */\n                    if (params.has('level') && this.active_level !== params.get('level')) {\n                        const level = this._org.levelWithID(params.get('level'));\n                        /* istanbul ignore else */\n                        if (level) {\n                            const building = this._org.buildings.find(\n                                (bld) => bld.id === level.building_id\n                            );\n                            /* istanbul ignore else */\n                            if (building) {\n                                this.active_level = level.id;\n                                this._org.building = building;\n                                this._booking_state_service.setZone(this.active_level || this._org.building.id);\n                            }\n                        }\n                    }\n                })\n            );\n            this.subscription(\n                'building',\n                this._org.listen('active_building').subscribe(() => {\n                    // Update dateTz here when the building is changed.\n                    this.dateTz = new DateTZ({ date: this.dateTz.ms, is_local_tz: false, building_tz: this.timezone });\n                    const building = this._org.building;\n                    this.has_access = building ? true : false;\n                    if(!this.has_access) {\n                        return;\n                    }\n\n                    /* istanbul ignore else */\n                    if (!building.levels.find((lvl) => lvl.id === this.active_level)) {\n                        this.active_level = building?.levels[0]?.id;\n                        this.updateLevel();\n                    }\n                    this.levels = [{ id: '', name: 'All Levels' } as any].concat(building.levels);\n                    this.levels.sort((a, b) => b.name.localeCompare(a.name, undefined, {\n                        numeric: true,\n                        ignorePunctuation: true,\n                    }));\n                    this.space_types = [{ id: '', name: 'All Space Types' } as any].concat(\n                        this._org.space_types\n                    );\n                })\n            );\n            this.subscription(\n                'day_view_undo',\n                this._service.get('undo').subscribe(undo => {\n                    if (!undo)\n                        return;\n\n                    if (this.undo_action) {\n                        this.undo_action = null;\n                        clearTimeout(this._undo_timer);\n                    }\n\n                    this._booking_state_service.attentToDelete(undo.booking, undo.action);\n                    this.undo_action = undo.action;\n                    this._undo_timer = setTimeout(() => {\n                        this._service.get('undo').next(null);\n                        this.undo_action = null;\n                    }, 15000);\n                })\n            );\n        });\n\n        this.configureIfLinksFromEmail();\n    }\n\n    public configureIfLinksFromEmail() {\n        /**\n         * https://acaprojects.atlassian.net/browse/MCK-2055\n         * Load booking with id received from email link to concierge and setup configuration to open booking detail dialog on day view\n         * Will work with both formatted URL's\n         * http://localhost:4200/#/day-view?view=booking-1edd3a4f-45fa-43cd-960d-5ae6ee5b1e36\n         * http://localhost:4200/#/day-view/zone-1FUT0pxu12s?view=booking-1edd3a4f-45fa-43cd-960d-5ae6ee5b1e36\n         */\n         const bookingId = this._route.snapshot.queryParams['view'];\n         if(bookingId) {\n             this.subscription('currentUser', this.store.select(selectCurrentUser).pipe(take(1))\n             .subscribe((user: User | undefined) => {\n                 // Once we know we have the user loaded.\n                this.store.dispatch(loadBookingsWithQuery({ 'id': bookingId,  'target': 'bookingById', 'offset': 0 }));\n             }));\n \n             this.store.dispatch(clearBookingByIdResults())\n             \n             this.subscription('bookingResults', this.store.pipe( select(selectBookingByIdResultsFromState) ).pipe(first(_ => !!_ && !!_.success))\n             .subscribe(next => {\n                 const booking = next.success ? next.success?.[0] : null;\n                 if (booking && booking.room) {\n                     const levelId = this._route.snapshot.params.hasOwnProperty('level');\n                     \n                     localStorage.setItem('CONCIERGE.view_booking', JSON.stringify(booking.toJSON()));\n                     localStorage.setItem('CONCIERGE.view_booking_space', JSON.stringify(booking.space.toJSON()));\n                     localStorage.setItem('CONCIERGE.date', `${booking.startDateTz.ms}`);\n                     localStorage.setItem('CONCIERGE.timezone', `${booking.startDateTz.building_tz}`);\n \n                     this.updateDateTz(booking.startDateTz)\n                     this._booking_state_service.setDate(booking.startDateTz);\n                     this._booking_state_service.setZone(booking.level_zone);\n                     if(!levelId ) {\n                         this._router.navigate(['/day-view', booking.level_zone], { queryParams: { view: bookingId }, replaceUrl: true });\n                     }\n                 }\n             }));\n         }\n    }\n\n    public ngOnDestroy(): void {\n        if (this._service.get('undo').getValue()) {\n            this._service.get('undo').next(null);\n        }\n    }\n\n\n    // Fires for the big blue new booking button\n    public newMeeting() {\n        this._dialog.open(BookingModalComponent, {\n            data: { timezone: this.timezone },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n    }\n\n    // R--- surely these 2 methods are not DRY and all the main tabs need a base class\n    // that encapsulates the common elements.\n    public get timezone() {\n        return this._org.building?.timezone || localStorage.getItem('CONCIERGE.timezone');\n    }\n\n    public updateDateTz(dateTz: DateTZ) {\n        this.dateTz = dateTz;\n    }\n\n    public updateLevel() {\n        this._booking_state_service.setZone(this.active_level || this._org.building.id);\n        this._router?.url?.includes('/day-view') && this._router.navigate(['/day-view', this.active_level]);\n    }\n\n    public updateLegend(mobile: boolean = false) {\n        if (mobile) {\n            this.legend_list = this.legend_keys.reduce((list, key) => {\n                if (key.active) list.push(key.id);\n                return list;\n            }, []);\n        }\n        this.legend = this.legend_keys.reduce((map, key) => {\n            map[key.id] = this.legend_list.includes(`${key.id}`);\n            return map;\n        }, {});\n\n        this._booking_state_service.setFilters({\n            ...this._booking_state_service.filters,\n            hide_type: Object.keys(this.legend).filter((i) => this.legend[i] === false) as any\n        });\n    }\n\n    public onOnlySetupBreakdownChanged(toggle: MatSlideToggleChange): void {\n        this._service.set('APP.breakdown', toggle.checked)\n    }\n\n    public async undoBooking(): Promise<void> {\n        const { action, booking } = this._service.get('undo').getValue();\n        if (!booking)\n            return;\n\n        await booking.undo('accept', action === 'series' ? { series: true } : {});\n        this._service.get('undo').next(null);\n        this._booking_state_service.attentToDelete(booking, action, true);\n        this.undo_action = null;\n        clearTimeout(this._undo_timer);\n        this._undo_timer = null;\n\n        this._dialog.open(MeetingDetailsModalComponent, {\n            maxWidth: 'calc(100vw - 2em)',\n            data: {\n                space: booking.space,\n                booking: booking\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n    }\n\n    public hideBanner() {\n        this.showBanner = false;\n    }\n\n    public hideUndo() {\n        this.undo_action = null;\n        clearTimeout(this._undo_timer);\n    }\n}\n","<div class=\"day-view\">\n    <a-sidebar></a-sidebar>\n    <div class=\"group\" *ngIf=\"!has_access\">\n        <access-denied></access-denied>\n    </div>\n    <div class=\"group\" *ngIf=\"has_access\">\n        <div class=\"header\" *ngIf=\"showBanner\">\n            <mck-alert-banner\n            [mode]=\"banner_mode\"\n            (close)=\"hideBanner()\"\n            message=\"This current version of Converge does not support multiroom bookings.\"\n            ></mck-alert-banner>\n        </div>\n        <div class=\"header\" *ngIf=\"undo_action\">\n            <mck-alert-banner\n                [mode]=\"undo_banner_mode\"\n                (action)=\"undoBooking()\"\n                (close)=\"hideUndo()\"\n                buttonText=\"Undo\"\n                message=\"Canceling {{undo_action === 'series' ? 'series' : 'booking'}}\">\n            </mck-alert-banner>\n        </div>\n        <a-topbar-header\n            [(dateTz)]=\"dateTz\"\n            [timezone]=\"timezone\"\n            [zone]=\"active_level\"\n            [show_events]=\"true\"\n            [show_add_item]=\"true\"\n            (event)=\"newMeeting()\"\n            (dateChangeTz)=\"updateDateTz($event)\"\n        >\n            <div class=\"topbar\">\n                <button mat-icon-button class=\"not-desktop\" [matMenuTriggerFor]=\"menu\">\n                    <app-icon [icon]=\"{ class: 'material-icons', content: 'more_vert' }\"></app-icon>\n                </button>\n                <mat-form-field\n                    [class.desktop-only]=\"true\"\n                    *ngIf=\"levels && levels.length > 1\"\n                    appearance=\"outline\"\n                >\n                    <mat-select\n                        name=\"level\"\n                        [(ngModel)]=\"active_level\"\n                        (ngModelChange)=\"updateLevel()\"\n                    >\n                        <mat-option *ngFor=\"let level of levels\" [value]=\"level?.id\">\n                            {{ level?.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <mat-form-field\n                    [class.desktop-only]=\"true\"\n                    *ngIf=\"space_types && space_types.length > 1\"\n                    appearance=\"outline\"\n                >\n                    <mat-select name=\"space-type\" [(ngModel)]=\"active_type\">\n                        <mat-option *ngFor=\"let type of space_types\" [value]=\"type?.id\">\n                            {{ type?.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <mat-form-field [class.desktop-only]=\"true\" appearance=\"outline\">\n                    <mat-select\n                        name=\"legend\"\n                        [(ngModel)]=\"legend_list\"\n                        (ngModelChange)=\"updateLegend()\"\n                        multiple\n                        placeholder=\"No items shown\"\n                    >\n                        <mat-select-trigger>Legend</mat-select-trigger>\n                        <mat-option *ngFor=\"let key of legend_keys\" [value]=\"key?.id\">\n                            <div class=\"key\">\n                                <div class=\"text\">{{ key?.name }}</div>\n                                <div class=\"colour\">\n                                    <div class=\"blob\" [style.backgroundColor]=\"key.color\"></div>\n                                </div>\n                            </div>\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <mat-slide-toggle\n                    name=\"overflow\"\n                    [class.desktop-only]=\"true\"\n                    [(ngModel)]=\"only_overflow\"\n                    (change)=\"onOnlySetupBreakdownChanged($event)\"\n                    labelPosition=\"before\"\n                    title=\"Only show meetings with setup and breakdown times\"\n                >\n                    Only Setup/Breakdown\n                </mat-slide-toggle>\n            </div>\n        </a-topbar-header>\n        <main [style.height]=\"showBanner ? 'calc(100% - 7.5em)' : ''\">\n            <day-view-timeline\n                [dateTz]=\"dateTz\"\n                [level]=\"active_level\"\n                [overflow_only]=\"only_overflow\"\n                [space_type]=\"active_type\"\n                [undo_action]=\"undo_action\"\n            ></day-view-timeline>\n        </main>\n    </div>\n</div>\n<mat-menu #menu=\"matMenu\">\n    <button mat-menu-item [matMenuTriggerFor]=\"level_list\">Level</button>\n    <button mat-menu-item [matMenuTriggerFor]=\"space_type_list\">Space Type</button>\n    <button mat-menu-item [matMenuTriggerFor]=\"legend_listing\">Legend</button>\n    <div mat-menu-item (click)=\"$event.stopPropagation()\">\n        <mat-slide-toggle\n            [(ngModel)]=\"only_overflow\"\n            labelPosition=\"before\"\n            title=\"Only show meetings with setup and breakdown times\"\n        >\n            Only Setup/Breakdown\n        </mat-slide-toggle>\n    </div>\n</mat-menu>\n<mat-menu #level_list=\"matMenu\">\n    <button\n        mat-menu-item\n        *ngFor=\"let level of levels\"\n        [class.selected]=\"level && active_level === level.id\"\n        (click)=\"active_level = level.id; updateLevel()\"\n    >\n        {{ level?.name }}\n    </button>\n</mat-menu>\n<mat-menu #space_type_list=\"matMenu\">\n    <button\n        mat-menu-item\n        *ngFor=\"let type of space_types\"\n        [class.selected]=\"type && active_type === type.id\"\n        (click)=\"active_type = type.id\"\n    >\n        {{ type?.name }}\n    </button>\n</mat-menu>\n<mat-menu #legend_listing=\"matMenu\">\n    <div mat-menu-item *ngFor=\"let key of legend_keys\">\n        <mat-checkbox\n            [(ngModel)]=\"key.active\"\n            (ngModelChange)=\"updateLegend(true)\"\n            (click)=\"$event.stopPropagation()\"\n        >\n            <div class=\"key\">\n                <div class=\"text\">{{ key?.name }}</div>\n                <div class=\"colour\">\n                    <div class=\"blob\" [style.backgroundColor]=\"key.color\"></div>\n                </div>\n            </div>\n        </mat-checkbox>\n    </div>\n</mat-menu>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { DayViewComponent } from './day-view.component';\nimport { DayViewTimelineComponent } from './timeline/timeline.component';\nimport { DayViewApprovalsComponent } from './approvals-view/approvals-view.component';\nimport { DayViewApprovalsEventComponent } from './approvals-view/event/event.component';\nimport { DayViewSpaceComponent } from './space/space.component';\nimport { DayViewSpaceEventComponent } from './space/event/event.component';\n\nimport { SharedContentModule } from 'src/app/shared/shared.module';\nimport { FormsModule } from '@angular/forms';\nimport { UiModule } from '@mckinsey-converge/ui';\n\nconst ROUTES: Route[] = [\n    { path: '', component: DayViewComponent },\n    { path: ':level', component: DayViewComponent },\n    { path: '**', redirectTo: '' }\n];\n\n@NgModule({\n    declarations: [\n        DayViewComponent,\n        DayViewTimelineComponent,\n        DayViewApprovalsComponent,\n        DayViewApprovalsEventComponent,\n        DayViewSpaceComponent,\n        DayViewSpaceEventComponent\n    ],\n    imports: [CommonModule, FormsModule, RouterModule.forChild(ROUTES), SharedContentModule, UiModule]\n})\nexport class DayViewModule {}\n","import {\n    Component,\n    OnInit,\n    Input,\n    OnChanges,\n    SimpleChanges,\n    Output,\n    EventEmitter,\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n} from '@angular/core';\nimport { Router } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { Space, BOOKING_STATUS } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { CateringOrder } from '@mckinsey-converge/data-common';\nimport { MeetingDetailsModalComponent } from 'src/app/calendar/meeting-details-modal/meeting-details-modal.component';\n\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n/** Details about the associated event overlapping with other events */\nexport interface IEventOverlap {\n    /** Index of this item with the overlapping items */\n    index: number;\n    /** Total number of items overlapping with this one */\n    total: number;\n}\nexport interface BookingDetailInfo {\n    bookedBy: {\n        display:boolean,\n        value: string\n    }\n}\n@Component({\n    selector: 'day-view-space-event',\n    templateUrl: './event.component.html',\n    styleUrls: ['./event.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class DayViewSpaceEventComponent extends BaseDirective implements OnInit, OnChanges {\n    /** Event to display */\n    @Input() public booking: Booking;\n    /** Date to display bookings for */\n    @Input() public dateTz: DateTZ = DateNow(new Date());\n    /** Space associated with the booking */\n    @Input() public space: Space;\n    /** Whether the item is a fixed size */\n    @Input() public fixed: boolean;\n    /** Overlap details for the booking */\n    @Input() public overlap: IEventOverlap;\n    /** Whether an action is being processed for this booking */\n    @Input() public loading: boolean;\n    /** Emitter for the current position of the booking within the timeline */\n    @Output() public position = new EventEmitter<{ top: number; height: number }>();\n\n    /** Position of the booking start time in the day */\n    public top: number;\n    /** Position of the booking relative to overlapping bookings */\n    public left: number;\n    /** Height based of the duration of the booking */\n    public height: number;\n    /** Size of the booking when overlapping with other bookings */\n    public width: number;\n    /** Offset from the booking's top that the setup time starts */\n    public overflow_top: number;\n    /** Offset from the booking's bottom that the breakdown time ends */\n    public overflow_bottom: number;\n    \n    public approved: boolean;\n    public declined: boolean;\n    public bookingDetails: BookingDetailInfo;\n    constructor(\n        private _service: ApplicationService,\n        private _dialog: MatDialog,\n        private _router: Router,\n        private cdRef: ChangeDetectorRef\n    ) {\n        super();\n    }\n\n    ngOnInit(): void {\n        this.approved = this.booking.status === BOOKING_STATUS.approved;\n        this.declined = this.booking.status === BOOKING_STATUS.declined; \n        // test comment\n        const {creator, organiser, booker_concierge} = this.booking;\n        this.bookingDetails = {\n            bookedBy: {\n                display: creator && ( creator.email !== organiser.email || (creator.email === organiser.email && booker_concierge !== null && organiser.email !==booker_concierge['email']) ),\n                value: (creator.email === organiser.email && booker_concierge !== null && organiser.email !==booker_concierge['email']) ?  booker_concierge['name'] || booker_concierge['email']  :  creator?.name || creator.email\n            }\n        }\n    }\n\n    public get local_id(): string {\n        return this.booking.icaluid.substr(0, 6);\n    }\n\n    /** Type of booking */\n    public get type(): string {\n        return this.booking.getType();\n    }\n\n    /** Period that the booking will occur during the day */\n    public get period(): string {\n        // the booking time is being pass in as the local timezone version.\n        return this.booking.time_period;\n    }\n\n    /** Number attendees expected to turn up to the booking */\n    public get expected(): number {\n        const expected = this.booking.expected_attendees;\n        return this.space ? expected[this.space.email] || 0 : 0;\n    }\n\n    /** Whether the meeting has catering attached */\n    public get has_catering(): boolean {\n        return !!this.order;\n    }\n\n    public get order(): CateringOrder {\n        return this.booking.catering.find((order) => order.location_id === this.space.email);\n    }\n\n    /** View booking details */\n    public view() {\n       const dialogRef =  this._dialog.open(MeetingDetailsModalComponent, {\n            maxHeight: '95vh',\n            maxWidth: '95vw',\n            data: {\n                space: this.space,\n                booking: this.booking,\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n        dialogRef.afterClosed().subscribe(_ => {\n            this.calculatePosition();\n            this.cdRef.detectChanges();\n        })\n    }\n\n    /** Whether booking is active */\n    public get active(): boolean {\n        const booking = this._service.get('CONCIERGE.day_view.viewing');\n        return !booking || booking.id === this.booking.id;\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.booking || changes.overlap || changes.dateTz) {\n            this.calculatePosition();\n            this.approved = this.booking.status === BOOKING_STATUS.approved;\n            this.declined = this.booking.status === BOOKING_STATUS.declined; \n        }\n    }\n\n    /** Store the order details for viewing in another component */\n    public storeOrder(order: CateringOrder) {\n        const booking_details = this.booking.toApiJSON();\n        localStorage.setItem('CONCIERGE.view_order', JSON.stringify(order.toJSON()));\n        localStorage.setItem('CONCIERGE.view_booking', JSON.stringify(booking_details));\n        localStorage.setItem('CONCIERGE.date', `${this.booking.startDateTz.ms}`);\n        localStorage.setItem('CONCIERGE.timezone', `${this.booking.startDateTz.building_tz}`);\n    }\n\n    /**\n     * View catering order for the booking\n     */\n    public viewOrder(order: CateringOrder) {\n        /* istanbul ignore else */\n        if (this.booking && this.booking.catering) {\n            /* istanbul ignore else */\n            if (localStorage) {\n                this.storeOrder(order);\n            }\n            this._router.navigate(['/catering', 'orders'], {\n                queryParams: { booking: this.booking.id, view: order.id },\n            });\n        }\n    }\n\n    /** Calculate the position */\n    private calculatePosition() {\n        /* istanbul ignore else */\n        if (this.booking) {\n            const overlap = this.overlap || { index: 0, total: 1 };\n            const shown_date = this.dateTz.startOfValue('day');\n            const date = this.booking.startDateTz.startOfValue('minute');\n            const end = this.booking.endDateTz.startOfValue('minute');\n            const from_previous_day = !date.isSameDate(shown_date, 'day');\n            if (end.isBeforeDate(shown_date, 'day')) { // Hide booking if not on shown date\n                this.top = -100;\n                this.height = 1;\n                return;\n            }\n\n            //R-- Stragest thing, but one time this was logging bookings form different timezones?\n            // this.dateTz.logDateTz('calculatePosition this.dateTz')\n            // this.booking.startDateTz.logDateTz('calculatePosition this.booking.startDateTz')\n\n            const start = from_previous_day ? 0 : Math.abs(+date.dateDiff(shown_date, 'hours', 'hours').toFixed(3));\n            const duration = Math.min(\n                this.booking.duration,\n                Math.abs(shown_date.dateDiff(date.addValue({ minutes: this.booking.duration }), 'minutes'))\n            );\n            this.top = Math.max(0, (start / 24) * 100);\n            this.height = Math.min(\n                100 - this.top,\n                this.fixed ? duration / 60 : (duration / 60 / 24) * 100\n            );\n            this.position.emit({ top: this.top, height: (duration / 60 / 24) * 100 });\n            this.width = Math.min(100, 100 / overlap.total + 5);\n            this.left = Math.min(100 - this.width, this.width * overlap.index - 5 * overlap.index);\n            this.overflow_top =\n                (this.booking.setup[this.space.email]\n                    ? (this.booking.setup[this.space.email] / 60) / duration\n                    : -0.1) * 100;\n            this.overflow_bottom =\n                (this.booking.breakdown[this.space.email]\n                    ? (this.booking.breakdown[this.space.email] / 60) / duration\n                    : -0.1) * 100;\n            if (this.booking.all_day) {\n                this.top = 0;\n                this.height = 100;\n            }\n        }\n    }\n}\n","<div\n    class=\"event-container\"\n    [id]=\"'event-' + local_id\"\n    *ngIf=\"booking\"\n    [class.fixed]=\"fixed\"\n    [class.inactive]=\"!active\"\n    [style.top]=\"top + '%'\"\n    [style.left]=\"left + '%'\"\n    [style.width]=\"fixed ? '15rem' : width + '%'\"\n    [style.height]=\"fixed ? height * 3 + 'rem' : height + '%'\"\n>\n    <div\n        [class]=\"'overflow' + (type ? ' concierge-' + type : '')\"\n        [style.top]=\"-overflow_top + '%'\"\n        [style.bottom]=\"-overflow_bottom + '%'\"\n    ></div>\n    <div\n        [class]=\"'event' + (type ? ' concierge-' + type : '') + (top > 50 ? ' low' : '')\"\n        [style.z-index]=\"(overlap?.index || 0) + 2\"\n        (click)=\"view()\"\n    >\n        <div class=\"header\">\n            <div class=\"text\">{{ booking.all_day ? 'All Day' : period }}</div>\n            <div class=\"handle\">\n                <app-icon\n                    *ngIf=\"!loading && (declined || approved)\"\n                    [icon]=\"{\n                        class: 'material-icons',\n                        content: approved ? 'done' : declined ? 'event_busy' : ''\n                    }\"\n                >\n                \n                </app-icon>\n                <mat-spinner *ngIf=\"loading\" diameter=\"16\"></mat-spinner>\n            </div>\n        </div>\n        <div class=\"body\">\n            <div class=\"field host\">\n                <div class=\"label\">Host:&nbsp;</div>\n                <div class=\"value\" [title]=\"'Host: ' + (booking.organiser?.name || booking.organiser)\">\n                    {{ booking.organiser?.name || booking.organiser }}\n                </div>\n            </div>\n            <div\n                class=\"field booked-by\" *ngIf=\"bookingDetails?.bookedBy?.display\" >\n                <div class=\"label\">Booked by:&nbsp;</div>\n                <div class=\"value\" [title]=\"'Booked By: ' + (bookingDetails.bookedBy.value)\">\n                    {{ bookingDetails.bookedBy.value }}\n                </div>\n            </div>\n            <div class=\"field\">\n                <!-- <div class=\"label\">Event:</div> -->\n                <div class=\"value\" [title]=\"'Title: ' + booking.title\">{{ booking.title }}</div>\n            </div>\n            <div class=\"field\">\n                <div class=\"value\">\n                    {{ booking.attendees ? booking.attendees.length || 'No' : 'No' }} Attendee{{\n                        booking.attendees?.length === 1 ? '' : 's'\n                    }}{{ expected ? '(' + expected + ' Expected)' : '' }}\n                </div>\n            </div>\n            <div class=\"field\" *ngIf=\"booking.company.length > 0\">\n                <div class=\"value\">\n                    Company: {{ booking.company.length }}\n                </div>\n            </div>\n            <div\n                class=\"field\"\n                *ngIf=\"booking.organiser?.name || booking.organiser\"\n                [title]=\"'Welcomed by: ' + booking.organiser.name || booking.organiser\"\n            >\n                <div class=\"value\">Welcomed by: {{ booking.organiser?.name || booking.organiser }}</div>\n            </div>\n            <div class=\"field\" *ngIf=\"has_catering\">\n                <div class=\"value\">Catered</div>\n            </div>\n        </div>\n    </div>\n    <button\n        class=\"catering-icon\"\n        mat-icon-button\n        name=\"view-catering\"\n        *ngIf=\"has_catering\"\n        (click)=\"viewOrder(order)\"\n    >\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'restaurant' }\"></app-icon>\n    </button>\n</div>\n","import {\n    Component,\n    OnChanges,\n    Input,\n    SimpleChanges,\n    Output,\n    EventEmitter,\n    ViewChild,\n    ElementRef,\n    OnInit,\n    ChangeDetectorRef,\n} from '@angular/core';\nimport { CdkDragMove, CdkDragDrop } from '@angular/cdk/drag-drop';\nimport { MatDialog } from '@angular/material/dialog';\nimport { first } from 'rxjs/operators';\n\nimport { IEventOverlap } from './event/event.component';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { ConfirmModalComponent } from '@mckinsey-converge/legacy-overlays';\nimport { DialogEvent, HashMap } from '@mckinsey-converge/base';\nimport { DayViewSettings } from '@mckinsey-converge/data-common';\nimport { SpacesService } from '@mckinsey-converge/data-common';\nimport { BookingsService } from '@mckinsey-converge/data-common';\n\nimport { BookingStateService } from '@mckinsey-converge/data-common';\nimport { convertTimezonedTimestampToLocalDateTz, DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'day-view-space',\n    templateUrl: './space.component.html',\n    styleUrls: ['./space.component.scss'],\n})\nexport class DayViewSpaceComponent extends BaseDirective implements OnInit, OnChanges {\n    /** List of space dropzones connected to */\n    @Input() public space_list: string[];\n    /** Date to display events for */\n    @Input() public dateTz: DateTZ;\n    /** Space to display events for */\n    @Input() public space: Space;\n    /** Scroll value of the day view */\n    @Input() public scroll: number;\n    /** Only show events with setup and/or breakdown times */\n    @Input() public overflow_only: boolean;\n    /** Mapping of whether to show events with a given legend id */\n    @Input() public legend: HashMap<boolean> = {};\n    /** Scroll value to add to drop placeholders */\n    @Input('scrollTop') public scroll_top: number;\n    /** Last update time of the displayed bookings */\n    @Input('lastUpdate') public last_update: number;\n    /** Emitter for whether the space column is in view */\n    @Output() public inView = new EventEmitter<boolean>();\n    /** Emitter for whether an event is being dragged */\n    @Output() public dragging = new EventEmitter<boolean>();\n    /** List of bookings for the current date and space */\n    public event_list: Booking[] = [];\n    /** Mapping of event IDs to overlap details */\n    public overlap_details: HashMap<IEventOverlap> = {};\n    /** Mapping of positions of event in the day */\n    public position_list: HashMap<{ top: number; height: number }> = {};\n    /** Override for mapped position */\n    public top: number;\n    /** Client Rectangle for the container element box */\n    public box: ClientRect;\n    /** Whether the space list is in view */\n    public in_view: boolean;\n    /** ID of the booking with an action processing */\n    public override_state: string;\n    /** Map of bookings to whether they are loading */\n    public loading: HashMap<boolean> = {};\n    /** Settings for day view */\n    public settings: DayViewSettings = {} as any;\n\n    /** Container element for the component contents */\n    @ViewChild('view', { static: true }) private view: ElementRef<HTMLDivElement>;\n\n    constructor(\n        private _service: ApplicationService,\n        private _spaces: SpacesService,\n        private _booking_state_service: BookingStateService,\n        private _bookings: BookingsService,\n        private _dialog: MatDialog,\n        private cdr: ChangeDetectorRef,\n    ) {\n        super();\n    }\n\n    /** Events to display for the active date */\n    public  events: Booking[]  = []\n\n    public ngOnInit(): void {\n        this.events = this.filterEvents();\n        this._service.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.settings = this._service.setting('app.day_view') || {};\n            this.subscription(\n                'breakdown',\n                this._service\n                    .listen('APP.breakdown')\n                    .subscribe((state) => {\n                        this.overflow_only = state;\n                        this.events = [...this.filterEvents()];\n                    })\n            );\n            this.subscription(\n                'legend',\n                this._service\n                    .listen('CONCIERGE.legend')\n                    .subscribe((state) => (this.legend = state || {}))\n            );\n            this.subscription(\n                'bookings',\n                this._booking_state_service.filtered.subscribe((list) => {\n                    this.event_list = [...list];\n                    this.events = [...this.filterEvents()];\n                    this.cdr.detectChanges();\n                })\n            );\n            this.checkInView();\n        });\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.scroll) {\n            this.checkInView();\n        }\n        if (changes.space) {\n            this.event_list = [...this.event_list];\n            this.timeout('in_view', () => this.checkInView(), 100);\n        }\n        /* istanbul ignore else */\n        if (changes.last_update) {\n            this.timeout('update_overlaps', () => this.calculateOverlaps(), 1000);\n        }\n    }\n\n    private filterEvents(): Booking[] {\n        if (this.space) {\n            const bookings = this.event_list;\n            const list = bookings.filter((event) => {\n                if (this.override_state && this.override_state === event.icaluid) {\n                    this.loading[event.id] = true;\n                }\n\n                const ignore = event.is_recurrent && event.recurrence_type === 'master';\n\n                return (\n                    !ignore &&\n                    event.room.email === this.space.email &&\n                    (!this.overflow_only ||\n                        event.setup[event.room.email] ||\n                        event.breakdown[event.room.email])\n                );\n            }).map(e => new Booking({...e.toJSON()})  );\n\n            return list;\n        }\n        return [];\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Track by function for ngFor optimisation\n     * @param index Index of the item\n     * @param item Data associated with the item at the given index\n     */\n    public trackByFn(index: number, item: Booking) {\n        return item.id || index;\n    }\n\n    /**\n     * Calculate to overlap details for the booking events on the space\n     */\n    private calculateOverlaps() {\n        const events = this.events.sort(\n            (a, b) =>\n                a.startDateTz.ms - b.startDateTz.ms ||\n                a.duration - b.duration ||\n                (a.title || '').localeCompare(b.title || '')\n        );\n        events.forEach((i) => (this.overlap_details[i.id] = { index: 0, total: 1 }));\n        for (const bkn of events) {\n            const bkn_start = bkn.startDateTz.startOfValue('minute');\n            const bkn_end = bkn.endDateTz.startOfValue('minute');\n            let count = 1;\n            let index = 0;\n            const collisions: Booking[] = [];\n            for (const cmp of events) {\n                /* istanbul ignore else */\n                if (bkn.id !== cmp.id) {\n                    const cmp_start = cmp.startDateTz.startOfValue('minute');\n                    const cmp_end = cmp.endDateTz.startOfValue('minute');\n                    /* istanbul ignore else */\n                    if (\n                        bkn_start.isSameDate(cmp_start, 'minute') ||\n                        (bkn_start.isAfterDate(cmp_start)  && bkn_start.isBeforeDate(cmp_end)) ||\n                        bkn_end.isSameDate(cmp_end, 'minute') ||\n                        (bkn_end.isAfterDate(cmp_start) && bkn_end.isBeforeDate(cmp_end))\n                    ) {\n                        count++;\n                        collisions.push(bkn);\n                        /* istanbul ignore else */\n                        if (\n                            events.findIndex((i) => i.id === bkn.id) >\n                            events.findIndex((i) => i.id === cmp.id)\n                        ) {\n                            index++;\n                        }\n                    }\n                }\n            }\n            this.overlap_details[bkn.id] = { index: Math.max(0, index), total: count };\n        }\n    }\n\n    /**\n     * Check whether the space column is with the view of the\n     */\n    private checkInView() {\n        /* istanbul ignore else */\n        if (this.view && this.view.nativeElement) {\n            const el = this.view.nativeElement;\n            this.in_view =\n                el.offsetLeft + this.scroll >= -240 &&\n                el.offsetLeft + this.scroll <= window.innerWidth;\n            this.inView.emit(this.in_view);\n        }\n    }\n\n    /**\n     * Initialise drag events\n     */\n    public initDrag() {\n        this.box = this.view.nativeElement.getBoundingClientRect();\n        this.dragging.emit(true);\n    }\n\n    /**\n     * Cleanup after drag\n     */\n    public endDrag() {\n        this.timeout('end_drag', () => (this.top = 0), 10);\n        this.dragging.emit(false);\n    }\n\n    /**\n     * Update top position of the dragged event placeholder\n     * @param booking Booking being dragged\n     * @param event Drag event\n     */\n    public updateDragTop(event: CdkDragMove<Booking>) {\n        /* istanbul ignore else */\n        if (event.delta.y) {\n            const y = event.pointerPosition.y;\n            const top = (y - this.box.top - this.scroll_top) / this.box.height;\n            const top_minutes = (Math.round((top * 24 * 60) / 15) * 15) / 60;\n            this.top = (top_minutes / 24) * 100;\n        }\n    }\n\n    /**\n     * Handle drop event\n     * @param event\n     */\n    public drop(event: CdkDragDrop<{ top: number; list: Booking[] }>): void {\n        const id = event.item.element.nativeElement.id;\n        const booking = event.previousContainer.data.list.find((i) => i.id === id);\n        /* istanbul ignore else */\n        if (!booking) {\n            return;\n        }\n        const top = event.previousContainer.data.top;\n        const new_start = Math.round(((top || 0) / 100) * 24 * 60);\n        const old_date = booking.startDateTz;\n        const new_date = old_date.startOfValue('day').setValue({ minute: new_start });\n        const now = DateNow(new Date());\n        /* istanbul ignore else */\n        // Prevent moving event into past\n        if (now.startOfValue('minute') > new_date) {\n            this.handleDropError(booking.id, 'Meetings cannot be moved into the past');\n            return;\n        }\n        // Check for collisions\n        this.loading[booking.id] = true;\n        this.override_state = booking.icaluid;\n        let room = booking.space;\n        let message = `Update ${booking.organiser.name}'s meeting in \"${\n            booking.space.name\n        }\" from ${old_date.formatDate('h:mma')} to ${new_date.formatDate('h:mma')}`;\n        let success = `Successfully updated meeting time from ${old_date.formatDate(\n            'h:mma'\n        )} to ${new_date.formatDate('h:mma')}`;\n        /* istanbul ignore else */\n        if (event.container !== event.previousContainer) {\n            // Same room\n            room = this._spaces.find(event.container.id.replace('space-col-', '')) || room;\n            message = `Move ${booking.organiser.name}'s meeting in \"${booking.space.name}\" to \"${\n                room.name\n            }\" at ${new_date.formatDate('h:mma')}`;\n            success = `Successfully moved booking to \"${room.name}\" at ${new_date.formatDate('h:mma')}`;\n        }\n        /* istanbul ignore else */\n        // Check if booking has a change\n        if (room === booking.space && new_date.isSameDate(old_date, 'month')) {\n            this.handleDropError(booking.id, 'The meeting is already in this room');\n            return;\n        }\n        const room_list = [room];\n        // Check if booking is already in the room\n        const room_count = room_list.reduce((a, v) => a.add(v.id), new Set()).size;\n        /* istanbul ignore else */\n        if (room_count < room_list.length) {\n            this.handleDropError(booking.id, 'The meeting is already in this room');\n            return;\n        }\n        const new_booking = new Booking({\n            ...booking.toJSON(),\n            room: room_list[0], // R--- messy\n        });\n        this.checkCollisions(\n            room_list,\n            new_date,\n            new_booking.duration,\n            new_booking.icaluid\n        ).then(\n            () => {\n                this.moveBooking(message, new_booking).then(\n                    (_) => {\n                        this.override_state = null;\n                        this._service.notifySuccess(success);\n                    },\n                    (err) => this.handleDropError(new_booking.id, `Error: ${err}`)\n                );\n            },\n            () => this.handleDropError(new_booking.id, 'Updated meeting time clashes with another')\n        );\n    }\n\n    /**\n     * Check if there are any booking collisions with the new booking time\n     * @param spaces\n     * @param dateTz\n     * @param duration\n     */\n    private checkCollisions(\n        spaces: Space[],\n        dateTz: DateTZ,\n        duration: number,\n        ignore?: string\n    ): Promise<void> {\n        return new Promise((resolve, reject) => {\n            this._spaces\n                .available({\n                    room_ids: spaces.map((i) => i.id).join(','),\n                    dateTz,\n                    duration,\n                    ignore,\n                    hide_bookings: true,\n                })\n                .then(\n                    (list) => {\n                        list.length === spaces.length ? resolve() : reject();\n                    },\n                    () => reject()\n                );\n        });\n    }\n\n    /**\n     * Handle errors from drop move logic\n     * @param id Booking ID\n     * @param message Error description\n     */\n    private handleDropError(id: string, message: string) {\n        this.loading[id] = false;\n        this.override_state = null;\n        this._service.notifyError(message);\n    }\n\n    /**\n     * Update booking\n     * @param confirm_msg\n     * @param new_booking\n     */\n    private moveBooking(confirm_msg: string, new_booking: Booking): Promise<Booking> {\n        return new Promise((resolve, reject) => {\n            const ref = this._dialog.open<ConfirmModalComponent>(ConfirmModalComponent, {\n                data: {\n                    title: 'Update meeting',\n                    content: confirm_msg,\n                    icon: { type: 'icon', class: 'material-icons', content: 'event_available' },\n                    action: 'Ok',\n                },\n            });\n            this.subscription(\n                'confirm',\n                ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                    /* istanbul ignore else */\n                    if (event.reason === 'done') {\n                        this._bookings.save(new_booking).then(\n                            (bkn: Booking) => {\n                                this._booking_state_service.replace(bkn);\n                                resolve(bkn);\n                            },\n                            (err) => reject(err)\n                        );\n                    }\n                    ref.close();\n                })\n            );\n        });\n    }\n}\n","<div\n    class=\"space-display\"\n    #view\n    cdkDropList\n    cdkDropListSortingDisabled\n    [cdkDropListConnectedTo]=\"space_list || []\"\n    [cdkDropListData]=\"{ top: top, list: events }\"\n    (cdkDropListDropped)=\"drop($event)\"\n    scrollContainer=\"#day-view-scroll\"\n    [id]=\"'space-col-' + space?.id\"\n>\n    <div class=\"drop-zone\" cdkDrag></div>\n    <div\n        [style.display]=\"in_view !== false ? '' : 'none'\"\n        *ngFor=\"let item of events; trackBy: trackByFn\"\n        cdkDrag\n        (cdkDragStarted)=\"initDrag()\"\n        (cdkDragMoved)=\"updateDragTop($event)\"\n        (cdkDragReleased)=\"endDrag()\"\n        [cdkDragDisabled]=\"\n            item.status !== 'upcoming' || item.declined || !settings.dragdrop\n        \"\n    >\n        <day-view-space-event\n            [space]=\"space\"\n            [dateTz]=\"dateTz\"\n            [booking]=\"item\"\n            [loading]=\"loading ? loading[item.id] : null\"\n            [overlap]=\"overlap_details ? overlap_details[item.id] : null\"\n            (position)=\"position_list ? position_list[item.id] = $event : ''\"\n        ></day-view-space-event>\n        <div class=\"event-preview\" *cdkDragPreview>\n            <div class=\"content\">\n                <day-view-space-event\n                    [fixed]=\"true\"\n                    [space]=\"space\"\n                    [booking]=\"item\"\n                ></day-view-space-event>\n            </div>\n        </div>\n        <div\n            class=\"event-placeholder\"\n            *cdkDragPlaceholder\n            [style.top]=\"(top || (position_list[item.id] ? position_list[item.id].top : 0)) + '%'\"\n            [style.height]=\"(position_list[item.id] ? position_list[item.id].height : 100) + '%'\"\n        ></div>\n    </div>\n</div>\n<div class=\"moving\" *ngIf=\"override_state\">\n    <div class=\"text\">Moving meeting</div>\n    <div class=\"spinner\">\n        <mat-spinner diameter=\"32\"></mat-spinner>\n    </div>\n</div>\n","import {\n    Component,\n    ElementRef,\n    HostListener,\n    Input,\n    OnChanges,\n    OnDestroy,\n    OnInit,\n    Renderer2,\n    SimpleChanges,\n    ViewChild, NgZone, DoCheck, ChangeDetectionStrategy, ChangeDetectorRef\n} from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { first } from 'rxjs/operators';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { HashMap, Identity } from '@mckinsey-converge/base';\nimport { MeetingDetailsModalComponent } from 'src/app/calendar/meeting-details-modal/meeting-details-modal.component';\nimport { SpacesService } from '@mckinsey-converge/data-common';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\nimport { DateNow, DateTZ, toMiddayUTC } from '@mckinsey-converge/date-tz';\nimport { isToday } from 'date-fns';\nimport { CdkVirtualScrollViewport } from '@angular/cdk/scrolling';\n\n\n\nconst UPDATE_INTERVAL = 10;\n\n@Component({\n    selector: 'day-view-timeline',\n    templateUrl: './timeline.component.html',\n    styleUrls: ['./timeline.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class DayViewTimelineComponent\n    extends BaseDirective\n    implements OnInit, OnChanges, OnDestroy\n{\n    /** DateTZ object of the active date */\n    @Input() public dateTz: DateTZ = DateNow(new Date());\n    /** ID of the active level */\n    @Input() public level: string;\n    /** ID of the room type to filter displayed spaces by */\n    @Input() public space_type: string;\n    /** List of shown legend items */\n    @Input() public legend: HashMap<boolean> = {};\n    /** Whether to show only items with a setup and/or breakdown time */\n    @Input() public overflow_only: boolean;\n    /** Whether space bookings are being loaded */\n    @Input() public loading: boolean;\n\n    @Input() undo_action;\n    \n    /** List of timeblocks to display */\n    public time_blocks: Identity[] = this.generateTimeBlocks();\n    /** Top value of the content scroll */\n    public scroll_top: number = 0;\n    /** Left value of the content scroll */\n    public scroll_left: number = 0;\n    /** Offset of the scroll value when starting a drag */\n    public scroll_offset: number = 0;\n    /** List of spaces to display for  */\n    public spaces: Space[] = [];\n    /** List of spaces to display for  */\n    public filtered_spaces: Space[] = [];\n    /** Mapping of space ids to whether they are in view */\n    public in_view: { [id: string]: boolean } = {};\n    /** Percent of the day that is now */\n    public now: number;\n    /** Currently active hour of the day */\n    public active_hour: string;\n    /** Mapping of spaces loading booking date */\n    public loading_space: { [id: string]: boolean } = {};\n    /** Booking ID to open modal for */\n    public view_id: string;\n    /** Last update time for the space bookings */\n    public last_update: number = 0;\n    /** Whether an event is being dragged */\n    public is_dragging: boolean;\n    /** Client rectangle for the scroll area */\n    public box: ClientRect;\n    /** Whether to show the holding bay */\n    public show_holding_bay: boolean = true;\n\n    public space_zones: string[] = [];\n\n    public is_today: boolean = this.isToday();\n    public modalInitialized = false;\n\n    /** Scrollable area of the day view */\n    @ViewChild('scroll_area', { static: true }) private scroll_area: ElementRef<HTMLDivElement>;\n\n    @ViewChild(CdkVirtualScrollViewport) virtualScroll: CdkVirtualScrollViewport;\n\n    /** Update scroll box when the window is resized */\n    @HostListener('window:resize')\n    public onResize() {\n        if (this.scroll_area.nativeElement) {\n            this.box = this.scroll_area.nativeElement.getBoundingClientRect();\n        }\n    }\n\n    public get is_loading() {\n        return this._booking_state_service.loading;\n    }\n\n    public isToday() {\n        return new DateTZ({\n            date: toMiddayUTC(this.dateTz).ms,\n            is_local_tz: false,\n            building_tz: this._org.building?.timezone || localStorage.getItem('CONCIERGE.timezone'),\n        }).isSameDate(\n            new DateTZ({\n                date: Date.now(),\n                is_local_tz: false,\n                building_tz: this._org.building?.timezone || localStorage.getItem('CONCIERGE.timezone'),\n            }),\n            'day'\n        );\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _spaces: SpacesService,\n        private _booking_state_service: BookingStateService,\n        private _org: OrganisationService,\n        private _route: ActivatedRoute,\n        private _renderer: Renderer2,\n        private _dialog: MatDialog,\n        private _zone: NgZone,\n        private cdr: ChangeDetectorRef,\n    ) {\n        super();\n    }\n\n    public get holding_bay(): Space {\n        const bld = this._org.building;\n        /* istanbul ignore else */\n        if (bld && bld.holding_bay) {\n            return this._spaces.find(bld.holding_bay);\n        }\n        return null;\n    }\n\n    public ngOnInit(): void {\n        this._spaces.initialised.pipe(first((_) => _)).subscribe(() => {\n            this._org.initialised.pipe(first((_) => _)).subscribe(() => {\n                this._booking_state_service.startPollingEveryFiveMin();\n                const zone_id = !this.level ? this._org.building.id : this.level;\n                this.spaces = this._spaces.filter((_) => _.zones.indexOf(zone_id) >= 0);\n                this.init();\n                this.initSpaces();\n                // Update time\n                this.updateTime();\n                this._zone.runOutsideAngular(() => {\n                    this.interval('time', () => this.updateTime(), 15 * 1000);\n                });\n                // R--- return to see if the booking service needs updating\n                this.subscription(\n                    'dateTz',\n                    this._booking_state_service.dateTz.subscribe((dateTz) => {\n                        // const dateTz = new DateTZ({date});\n                        this.dateTz = dateTz;\n                    })\n                );\n            });\n        });\n        this.is_today = this.isToday();\n\n        // this.virtualScroll.elementScrolled()\n        //     .subscribe(event => {\n        //         console.log('scrolled');\n        //     });\n\n       \n    }\n\n    ngAfterViewInit() {\n        const d2 = this._renderer.createElement('div');\n        this._renderer.addClass(d2, 'adjustable-room-block-2');\n        this.virtualScroll.elementRef && this._renderer.appendChild(this.virtualScroll.elementRef.nativeElement, d2);\n      }\n\n      \n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.level && this._org.building) {\n            const zone_id = !this.level ? this._org.building.id : this.level;\n            this.spaces = this._spaces.filter((_) => _.zones.indexOf(zone_id) >= 0);\n            this.updateTime();\n            // this._zone.runOutsideAngular(() => {\n            //  this.interval('time', () => this.updateTime(), 15 * 1000);\n            // });\n            this.initSpaces();\n        }\n        if (changes.space_type) {\n            this.initSpaces();\n        }\n    }\n\n    public ngOnDestroy() {\n        if (this._booking_state_service?.stopPolling) this._booking_state_service?.stopPolling();\n    }\n\n    public init() {\n        this._service.title = 'Day View';\n        this.subscription(\n            'viewing',\n            this._service\n                .listen('CONCIERGE.day_view.viewing')\n                .subscribe((event) => this.scrollIntoView(event))\n        );\n        // Subscribe to route query changes\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                /* istanbul ignore else */\n                if (params.has('view') || localStorage.getItem('CONCIERGE.view_booking')) {\n                    this.view_id = params.get('view');\n                    const details = localStorage.getItem('CONCIERGE.view_booking');\n                    const spaceJson = localStorage.getItem('CONCIERGE.view_booking_space');\n                    /* istanbul ignore else */\n                    if (details) {\n                        const space: Space | undefined = spaceJson\n                            ? new Space(JSON.parse(spaceJson))\n                            : undefined;\n                        const booking = new Booking({ ...JSON.parse(details), room: space });\n                        if(!this.modalInitialized) { \n                            this.modalInitialized = true;\n                            this.view(booking, space);\n                            localStorage.removeItem('CONCIERGE.view_booking');\n                            localStorage.removeItem('CONCIERGE.view_booking_space');\n                        }\n                    }\n                }\n            })\n        );\n        // this._zone.runOutsideAngular(() => {\n        // this.interval(\n        //     'scroll',\n        //     () => {\n        //         /* istanbul ignore else */\n        //         if (this.scroll_area && this.scroll_area.nativeElement) {\n        //             this.updateScroll({ target: this.scroll_area.nativeElement });\n        //         }\n        //     },\n        //     1000\n        //     );\n        // });\n        /* istanbul ignore else */\n        if (this.scroll_area.nativeElement) {\n            this.box = this.scroll_area.nativeElement.getBoundingClientRect();\n        }\n    }\n\n    /**\n     * Update scroll parameters to match the change in the scroll position\n     * @param event\n     */\n    public updateScroll(event) {\n        this.scroll_top = event.target.scrollTop;\n        this.scroll_left = event.target.scrollLeft;\n        // console.log('update scroll called')\n        this.cdr.detectChanges();\n    }\n\n    \n\n    /** Generate time blocks to display on the day view */\n    private generateTimeBlocks(): Identity[] {\n        const blocks: Identity[] = [];\n        const date = DateNow(new Date()).startOfValue('hour');\n        for (let i = 0; i < 24; i++) {\n            blocks.push({\n                id: date.setValue({ hour: i }).formatDate('HH:mm'),\n                name: date.setValue({ hour: i }).formatDate('h:mma').toLocaleLowerCase(),\n            });\n        }\n        return blocks;\n    }\n\n    /** Update the now line position */\n    private updateTime() {\n        const now = new DateTZ({\n            date: Date.now(),\n            is_local_tz: false,\n            building_tz: this._org.building?.timezone || localStorage.getItem('CONCIERGE.timezone'),\n        });\n        this.now = (now.dateHour + now.minutes / 60) / 24;\n        this.active_hour = now.startOfValue('hour').formatDate('HH:mm');\n        this.is_today = this.isToday();\n        this.cdr.detectChanges();\n    }\n\n    /**\n     * View booking details\n     * @param booking Booking to view the details of\n     * @param space Space that's selected.\n     */\n    private view(booking: Booking, space?: Space) {\n        this._dialog.open(MeetingDetailsModalComponent, {\n            data: {\n                space: space || booking.space,\n                booking,\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n        this.view_id = null;\n    }\n\n\n    /**\n     * Scroll booking to the event on the day view\n     * @param booking Booking to scroll into view\n     */\n    private scrollIntoView(booking: Booking) {\n        if (booking && booking.space && this.scroll_area && this.scroll_area.nativeElement) {\n            const element: HTMLDivElement = this.scroll_area.nativeElement.querySelector(\n                `#space-col-${booking.space.id}`\n            );\n            /* istanbul ignore else */\n            if (element) {\n                const scroll_box = this.scroll_area.nativeElement.getBoundingClientRect();\n                const date_percent =\n                    Math.abs(\n                        booking.startDateTz.dateDiff(\n                            booking.startDateTz.startOfValue('day'),\n                            'minutes'\n                        )\n                    ) /\n                    (24 * 60);\n                const box = element.getBoundingClientRect();\n                this.scroll_area.nativeElement.scrollTo({\n                    left:\n                        box.left - scroll_box.left + this.scroll_area.nativeElement.scrollLeft - 10,\n                    top: this.scroll_area.nativeElement.scrollHeight * date_percent - 10,\n                    behavior: 'smooth',\n                });\n            }\n        }\n    }\n\n    /**\n     * Setup an auto-scroll for the display view\n     * @param x\n     * @param y\n     */\n    public scrollView(x: number, y: number) {\n        /* istanbul ignore else */\n        if (x || y) {\n            this.scroll_area.nativeElement.scrollTop += y || 0;\n            this.scroll_area.nativeElement.scrollLeft += x || 0;\n            /* istanbul ignore else */\n            if (\n                (y &&\n                    this.scroll_area.nativeElement.scrollTop >=\n                        this.scroll_area.nativeElement.scrollHeight) ||\n                (x &&\n                    this.scroll_area.nativeElement.scrollLeft >=\n                        this.scroll_area.nativeElement.scrollWidth) ||\n                (y && this.scroll_area.nativeElement.scrollTop <= 0) ||\n                (x && this.scroll_area.nativeElement.scrollLeft <= 0)\n            ) {\n                this.clearInterval('auto_scroll');\n            }\n            this.updateScroll({ target: this.scroll_area.nativeElement });\n        }\n    }\n\n    public clearSelected() {\n        this._service.set('CONCIERGE.day_view.viewing', null);\n    }\n\n    public cancelScroll() {\n        this.clearInterval('auto_scroll');\n    }\n\n    public dragChange(is_dragging: boolean) {\n        if (is_dragging) {\n            this.scroll_offset = this.scroll_area.nativeElement.scrollTop;\n            this.subscription(\n                'listen_move',\n                this._renderer.listen('window', 'mousemove', (event: MouseEvent) => {\n                    const position = { x: event.clientX, y: event.clientY };\n                    const y =\n                        position.y > this.box.bottom - this.box.height * 0.05\n                            ? 1\n                            : position.y < this.box.top + this.box.height * 0.05\n                            ? -1\n                            : 0;\n                    const x =\n                        position.x > this.box.right - this.box.width * 0.05\n                            ? 1\n                            : position.x < this.box.left + this.box.height * 0.05\n                            ? -1\n                            : 0;\n                    this.scrollView(x * 5, y * 5);\n                    this._zone.runOutsideAngular(() => {\n                        this.interval('auto_scroll', () => this.scrollView(x * 10, y * 10), 10);\n                    });\n                })\n            );\n            this.clearInterval('bookings');\n        } else {\n            this.cancelScroll();\n            this.unsub('listen_move');\n        }\n    }\n\n    private initSpaces() {\n        const holding_bay = this.holding_bay;\n        this.filtered_spaces = this.spaces.filter(\n            (i) =>\n                (!this.space_type || i.zones.indexOf(this.space_type) >= 0) &&\n                (!holding_bay || i.id !== holding_bay.id) &&\n                i.bookable\n        );\n        this.filtered_spaces.sort((a, b) => a.local_name.localeCompare(b.local_name));\n        this.space_zones = this.spaces.map((i) => `space-col-${i.id}`);\n    }\n}\n\n","<div class=\"timeline\">\n    <div class=\"loader\" *ngIf=\"is_loading | async\">\n        <mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>\n    </div>\n    <!-- <div class=\"header\" style=\"place-content: end;\"> -->\n        <!-- <div class=\"time-blocks\"><div class=\"text\">Time</div></div>\n        <div class=\"flex\">\n            <div class=\"group\" [style.left]=\"-scroll_left + 'px'\">\n                <div class=\"space-header\" *ngFor=\"let room of filtered_spaces\" [title]=\"room.local_name\">\n                    <div class=\"details\">\n                        <div class=\"text\">{{ room.local_name }}</div>\n                        <div class=\"icon\"></div>\n                    </div>\n                    <div class=\"capacity\">\n                        Capacity - {{ room.capacity || '0' }}\n                        {{ room.capacity === 1 ? 'person' : 'people' }}\n                    </div>\n                </div>\n            </div>\n        </div> -->\n        <!-- <div class=\"sidebar\" *ngIf=\"holding_bay\" [class.show]=\"show_holding_bay\">\n            <div class=\"space-header\" [title]=\"holding_bay.name\">\n                <div class=\"text\">Incoming Requests</div>\n                <div class=\"icon\"></div>\n            </div>\n            <div class=\"tag\" (click)=\"show_holding_bay = !show_holding_bay\">\n                <app-icon\n                    [icon]=\"{\n                        class: 'material-icons',\n                        content: show_holding_bay ? 'close' : 'list'\n                    }\"\n                ></app-icon>\n            </div>\n        </div> -->\n    <!-- </div> -->\n    <div class=\"body\" (click)=\"clearSelected()\">\n        <!-- <div class=\"time-blocks\">\n            <div class=\"text\">Time</div>\n            <div class=\"group\" [style.top]=\"-scroll_top + 'px'\">\n                <div class=\"block\" *ngFor=\"let timeslot of time_blocks\">\n                    <div div class=\"hour\" [class.active]=\"is_today && timeslot.id === active_hour\">\n                        {{ timeslot.name }}\n                    </div>\n                </div>\n            </div>\n        </div> -->\n       \n\n        <div class=\"flex content\" [class.is_banner_shown]=\"undo_action\"  id=\"day-view-scroll\" >\n            <cdk-virtual-scroll-viewport\n                #scroll_area\n                itemSize=\"50\"\n                class=\"viewport\"\n                orientation=\"horizontal\"\n                minBufferPx=\"200\" maxBufferPx=\"1000\"\n                (scroll)=\"updateScroll($event)\" >\n\n                <div class=\"time-blocks\" >\n                    <div class=\"group\">\n                        <div class=\"text\">Time</div>\n                        <div class=\"block\" *ngFor=\"let timeslot of time_blocks\">\n                            <div div class=\"hour\" [class.active]=\"is_today && timeslot.id === active_hour\"> {{ timeslot.name }} </div>\n                        </div>\n                    </div>\n                </div> \n\n\n                <div class=\"room-blocks\">\n                    <div class=\"space-header\" *ngFor=\"let room of filtered_spaces\" [title]=\"room.local_name\">\n                        <div class=\"details\">\n                            <div class=\"text\">{{ room.local_name }}</div>\n                            <div class=\"icon\"></div>\n                        </div>\n                        <div class=\"capacity\">\n                            Capacity - {{ room.capacity || '0' }}\n                            {{ room.capacity === 1 ? 'person' : 'people' }}\n                        </div>\n                    </div>\n                </div>\n                <div class=\"adjustable-room-block\"></div>\n\n                <div class=\"time-grid-container\" >\n                    <div class=\"container-space\">\n                        <div class=\"time-lines\" [style.min-width]=\"filtered_spaces.length * 15 + 'rem'\">\n                            <div class=\"block\" *cdkVirtualFor=\"let item of time_blocks\">\n                                <div class=\"line\"></div>\n                            </div>\n                        </div>\n                        <div class=\"space-day\" >\n                            <!-- <ng-container *cdkVirtualFor=\"let event of booking_list | async; trackBy: trackByFn\"> -->\n                                <div class=\"space\" [style.min-height]=\"time_blocks.length * 3 + 'rem'\"\n                                    *ngFor=\"let item of filtered_spaces\"\n                                    cdkDropListGroup\n                                >\n                                <!-- // R--- not sure if it's necessary to update this components date fomat -->\n                                    <day-view-space\n                                        [space_list]=\"space_zones\"\n                                        [dateTz]=\"dateTz\"\n                                        [space]=\"item\"\n                                        [legend]=\"legend\"\n                                        [overflow_only]=\"overflow_only\"\n                                        [scroll]=\"-scroll_left\"\n                                        [scrollTop]=\"scroll_offset - scroll_top\"\n                                        [lastUpdate]=\"last_update\"\n                                        (dragging)=\"dragChange($event)\"\n                                        (inView)=\"in_view[item.id] = $event\"\n                                    ></day-view-space>\n                                </div>\n                            <!-- </ng-container> -->\n                        </div>\n                    </div>\n                </div>\n            </cdk-virtual-scroll-viewport>\n            \n        </div>\n        \n        <div class=\"now-line\" *ngIf=\"is_today\"  [style.top]=\" 'calc(' + now * time_blocks.length * 3 + 'rem - ' + (scroll_top - 48 ) + 'px)' | safe: 'style' \" >\n            <div class=\"knob\"></div>\n        </div>\n\n        <div class=\"sidebar\" *ngIf=\"holding_bay\" [class.show]=\"show_holding_bay\" >\n            <div class=\"space-header\" [title]=\"holding_bay.name\">\n                <div class=\"text\">Incoming Booking Requests</div>\n                <!-- <div class=\"icon\"></div> -->\n            </div>\n            <div class=\"tag\" (click)=\"show_holding_bay = !show_holding_bay\">\n                <app-icon [icon]=\"{ class: 'material-icons', content: show_holding_bay ? 'close' : 'list' }\"  ></app-icon>\n            </div>\n            <div class=\"approval-cards-view\">\n                <day-view-approvals-view></day-view-approvals-view>\n            </div>\n        </div>\n    </div>\n</div>","import { Component, Input, Output, EventEmitter, SimpleChanges } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Router } from '@angular/router';\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { CateringOrder } from '@mckinsey-converge/data-common';\nimport { BookingModalComponent } from '../../../bookings/booking-modal/booking-modal.component';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { DialogEvent, BaseDirective  } from '@mckinsey-converge/base';\n\n@Component({\n    selector: 'meeting-catering',\n    templateUrl: './catering.component.html',\n    styleUrls: ['./catering.component.scss'],\n})\nexport class MeetingCateringDetailsComponent extends BaseDirective {\n    /** Booking to display details */\n    @Input() public booking: Booking;\n    /** Space to display details */\n    @Input() public space: Space;\n\n    @Output() updateBooking = new EventEmitter();\n\n    public orders = [];\n\n    /** Total cost of all the orders */\n    public get total(): number {\n        let total = 0;\n        this.orders.forEach((order) => (total += order.total));\n        return total;\n    }\n\n    public get total_edited(): boolean {\n        return this.booking.edits.some((_) => this.orders.some((o) => o.id === _));\n    }\n\n    /** Charge code for orders in the active space */\n    public get charge_code(): string {\n        return (this.orders.length ? this.orders[0].charge_code : '') || '<No Charge code>';\n    }\n\n    /** Currency symbol for orders in active space */\n    public get symbol(): string {\n        const space = this.space || { level: { building_id: '' } };\n        const building = this._org.buildings.find((bld) => bld.id === space.level.building_id) || {\n            currency: 'USD',\n        };\n        return building.currency;\n    }\n\n    /** Notes for orders in active space */\n    public get notes(): string {\n        if (this.orders.length) {\n            const note = this.booking.notes.find(\n                (note) =>\n                    note.type === 'catering' &&\n                    note.space === this.space.email &&\n                    note.author === this.booking.creator.name\n            );\n            return note ? note.message : '<No Notes>';\n        } else {\n            return '<No Notes>';\n        }\n    }\n\n    /** Whether booking has been declined or ended */\n    public get expired(): boolean {\n        return this.booking.timeBasedStatusLabel === 'done' || this.booking.declined;\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _dialog: MatDialog,\n        private _router: Router\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this._updateOrders();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.booking) {\n            this._updateOrders();\n        }\n    }\n\n    /** Store the order details for viewing in another component */\n    public storeOrder(order: CateringOrder) {\n        const booking = this.booking || order.booking;\n        localStorage.setItem('CONCIERGE.view_order', JSON.stringify(order.toJSON()));\n        localStorage.setItem('CONCIERGE.view_booking', JSON.stringify(booking.toApiJSON()));\n        localStorage.setItem('CONCIERGE.date', `${booking.startDateTz.ms}`);\n        localStorage.setItem('CONCIERGE.timezone', `${booking.startDateTz.building_tz}`);\n    }\n\n    /** Open modal to edit catering details for booking */\n    public editMeetingCatering() {\n        const dialogRef = this._dialog.open(BookingModalComponent, {\n            data: {\n                timezone: this.booking.timezone,\n                booking: this.booking,\n                only_catering: true,\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n        this.subscription(\n            'modal_events',\n            dialogRef.componentInstance.event.subscribe(async (event: DialogEvent) => {\n                if (event.reason === 'done') {\n                    dialogRef.close();\n                    this.updateBooking.emit(event.metadata);\n                }\n            })\n        );\n    }\n\n    /**\n     * View catering order for the event\n     */\n    public viewOrder(order: CateringOrder) {\n        const booking = this.booking || order.booking;\n        if (!booking || !order) return;\n        /* istanbul ignore else */\n        if (localStorage) this.storeOrder(order);\n        this._router.navigate(['/catering', 'orders'], {\n            queryParams: { booking: booking.id, view: order.id },\n        });\n        this._dialog.closeAll();\n    }\n\n    /** List of orders for this booking and space */\n    private _updateOrders() {\n        let orders = this.booking.catering.filter(\n            (order) => order.location_id === this.space.email\n        );\n        orders = orders.map((order) => {\n            let ord = order.toJSON();\n            ord.booking = this.booking; // R--- check this change works\n            return new CateringOrder(ord);\n        });\n        this.orders = orders;\n    }\n}\n","<div class=\"heading\">Catering</div>\n<div class=\"content\" *ngIf=\"booking\">\n    <div class=\"field\" [class.edited]=\"total_edited\">\n        <label for=\"orders\">Orders:</label>\n        <div class=\"value\" name=\"orders\" *ngIf=\"orders.length; else no_orders\">\n            <button matRipple *ngFor=\"let order of orders\" (mousedown)=\"viewOrder(order)\">\n                <div class=\"details\" [class.edited]=\"booking.edits.includes(order.id)\">\n                    <div class=\"time\">At {{ order.deliver_at_time }}</div>\n                    <div class=\"count\">\n                        {{ order.item_count }} item{{ order.item_count === 1 ? '' : 's' }}\n                    </div>\n                    <div class=\"total\">{{ order.total / 100 | currency: symbol }}</div>\n                </div>\n            </button>\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"total_edited\">\n        <label for=\"total\">Total:</label>\n        <div class=\"value\" name=\"total\">\n            {{ total / 100 | currency: symbol }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"booking.edits.includes('charge_code|' + space.email)\">\n        <label for=\"charge-code\">Charge Code:</label>\n        <div class=\"value\" name=\"charge-code\">\n            {{ charge_code }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"booking.edits.includes('catering_note|' + space.email)\">\n        <label for=\"notes\">Notes:</label>\n        <div class=\"value\" name=\"notes\">\n            {{ notes }}\n        </div>\n    </div>\n</div>\n<button class=\"footer\" mat-button name=\"edit\" (click)=\"editMeetingCatering()\">Edit Catering</button>\n<ng-template #no_orders>\n    <div class=\"value\" name=\"orders\">&lt;No Catering Orders&gt;</div>\n</ng-template>\n","import { Component, Input, OnInit, Output, EventEmitter } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\nimport { Booking, BookingAction, generateBookingForm } from '@mckinsey-converge/data-common';\nimport { humaniseDuration } from '@mckinsey-converge/base';;\nimport { BookingModalComponent } from '../../../bookings/booking-modal/booking-modal.component';\nimport { HashMap } from '@mckinsey-converge/base';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { DialogEvent } from '@mckinsey-converge/base';\n\nexport interface BookingDetailInfo {\n    bookedBy: {\n        display:boolean,\n        value: string\n    }\n}\n@Component({\n    selector: 'meeting-details',\n    templateUrl: './details.component.html',\n    styleUrls: ['./details.component.scss'],\n})\nexport class MeetingDetailsDisplayComponent extends BaseDirective implements OnInit {\n    /** Booking to display details */\n    @Input() public booking: Booking;\n    /** Space to display details */\n    @Input() public space: Space;\n    /** Mapping of edited fields */\n\n    @Output() updateBooking = new EventEmitter();\n\n    @Output() public event = new EventEmitter();\n\n    public edited: HashMap<boolean> = {};\n\n    /** Display string for the locations in the booking */\n    public get location() {\n        return (this.booking.room || this.space).local_name;\n    }\n    /** Display string for the booking duration */\n    public get duration() {\n        return this.booking ? humaniseDuration(this.booking.duration) : '1 hour';\n    }\n\n    /** Display string for attendees in booking */\n    public get start_and_duration_time() {\n        const end_ = this.booking.startDateTz.addValue({minutes: this.booking.duration});\n        return `${this.start_time} - ${end_.formatDate('h:mma').toLocaleLowerCase()}`;\n    }\n\n    /** Display string for attendees in booking */\n    public get start_time() {\n        return `${this.booking.startDateTz.formatDate('dd MMM yyyy')} ${this.booking.startDateTz.formatDate('h:mma').toLocaleLowerCase()}`;\n    }\n    /** Display string for attendees in booking */\n    public get end_time() {\n        const end_ = this.booking.startDateTz.addValue({minutes: this.booking.duration})\n        return `${end_.formatDate('dd MMM yyyy,')} ${end_.formatDate('h:mma').toLocaleLowerCase()}`;\n    }\n    /** Display string for attendees in booking */\n    public get attendees() {\n        return this.booking.attendees.map((person) => person.name).join('\\n');\n    }\n\n    /** Whether booking has been declined or ended */\n    public get expired(): boolean {\n        return this.booking.timeBasedStatusLabel === 'done';\n    }\n\n    public bookingDetails: BookingDetailInfo;\n    constructor(private _dialog: MatDialog) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        Object.values(this.booking.edits || []).forEach(i => {\n            this.edited[i] = true;\n        });\n        this.setDetails();\n    }\n\n    /**\n     * Function to set details of the booking, can take advantage to one time assignment and set tmeplate properties to avoid template conditions and function calls\n     */\n    setDetails() {\n        const {creator, organiser, booker_concierge} = this.booking;\n        this.bookingDetails = {\n            bookedBy: {\n                display: creator && ( creator.email !== organiser.email || (creator.email === organiser.email && booker_concierge !== null && organiser.email !==booker_concierge['email']) ),\n                value: (creator.email === organiser.email && booker_concierge !== null && organiser.email !==booker_concierge['email']) ?  booker_concierge['name'] || booker_concierge['email']  :  creator?.name || creator.email\n            }\n        }\n    }\n\n    public editMeeting() {\n        const dialogRef = this._dialog.open<BookingModalComponent>(BookingModalComponent, {\n            data: {\n                timezone: this.booking.timezone,\n                booking: this.booking,\n                action: BookingAction.EDIT\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n        this.subscription(\n            'modal_events',\n            dialogRef.componentInstance.event.subscribe(async (event: DialogEvent) => {\n                const form = generateBookingForm(this.booking, ['space_list'], true);\n                if (event.reason === 'done') {\n                    dialogRef.close();\n                    this.updateBooking.emit(event.metadata);\n                }\n            })\n        );\n    }\n}\n","<div class=\"heading\">\n    Booking Details\n</div>\n<div class=\"content\" *ngIf=\"booking\">\n    <div class=\"field\" [class.edited]=\"false\">\n        <label for=\"host\">Host:</label>\n        <div class=\"value\" name=\"host\">\n            {{ booking.organiser?.name || booking.organiser.email }}\n        </div>\n        <div class=\"actions\">\n            <a\n                mat-icon-button\n                target=\"_blank\"\n                [href]=\"'mailto:' + booking.organiser.email + '?subject=' + booking.title\"\n            >\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'mail' }\"></app-icon>\n            </a>\n            <a\n                mat-icon-button\n                [disabled]=\"!booking.organiser?.phone\"\n                target=\"_blank\"\n                [href]=\"'tel:' + booking.organiser?.phone\"\n            >\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'call' }\"></app-icon>\n            </a>\n        </div>\n    </div>\n    <div class=\"field\" *ngIf=\"bookingDetails?.bookedBy?.display\" [class.edited]=\"edited.organiser\">\n        <label for=\"host\">Booked By:</label>\n        <div class=\"value\" name=\"host\">\n            {{ bookingDetails.bookedBy.value }}\n        </div>\n        <div class=\"actions\">\n            <a\n                mat-icon-button\n                target=\"_blank\"\n                [href]=\"'mailto:' + booking.creator.email + '?subject=' + booking.title\"\n            >\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'mail' }\"></app-icon>\n            </a>\n            <a\n                mat-icon-button\n                [attr.disabled]=\"!booking.creator?.phone\"\n                target=\"_blank\"\n                [href]=\"'tel:' + booking.creator?.phone\"\n            >\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'call' }\"></app-icon>\n            </a>\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"edited.room_email\">\n        <label for=\"location\">Location(s):</label>\n        <div class=\"value\" name=\"location\">\n            {{ location }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"edited.start_epoch\">\n        <label for=\"start-time\">Date:</label>\n        <div class=\"value\" name=\"start-time\">\n            {{ start_and_duration_time }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"edited.duration\">\n        <label for=\"duration\">Duration:</label>\n        <div class=\"value\" name=\"duration\">\n            {{ duration }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"edited.attendees\">\n        <label for=\"attendees\">Attendees:</label>\n        <div class=\"value\" name=\"attendees\">\n            {{ attendees }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"edited.company\" *ngIf=\"this.booking.company.length > 0\">\n        <label for=\"company\">Company:</label>\n        <div class=\"value\" name=\"company\">\n            {{ this.booking.company.join(', ') }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"false\">\n        <label for=\"vc-equipment\">VC Equipment:</label>\n        <div class=\"value\" name=\"vc-equipment\">\n            No\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"edited.body || edited.notes || edited.description\">\n        <label for=\"notes\">Notes:</label>\n        <div class=\"value html\" name=\"notes\" [innerHTML]=\"booking.body | sanitize:'html'\"></div>\n    </div>\n</div>\n<button class=\"footer\" *ngIf=\"!expired\" mat-button (click)=\"editMeeting()\">\n    Edit Booking\n</button>\n","import { Component, EventEmitter, Inject, OnInit, Output } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material/dialog';\nimport { FormGroup } from '@angular/forms';\n\nimport { Booking, BookingAction } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { DialogEvent } from '@mckinsey-converge/base';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { BookingsService, BOOKING_STATUS } from '@mckinsey-converge/data-common';\nimport { DeleteConfirmModalComponent } from '../../bookings/delete-confirm-modal/delete-confirm-modal.component';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\nimport { BookingModalComponent } from 'src/app/bookings/booking-modal/booking-modal.component';\n\nexport interface MeetingDetailsModalData {\n    space: Space;\n    booking: Booking;\n}\n\n@Component({\n    selector: 'a-meeting-details-modal',\n    templateUrl: './meeting-details-modal.component.html',\n    styleUrls: ['./meeting-details-modal.component.scss'],\n})\nexport class MeetingDetailsModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Display string for the loading state */\n    public loading: string;\n    /** Handler for request errors */\n    private _on_error = (message) => (err) => {\n        this._service.notifyError(`${message}. Error: ${err.message || err}`);\n        this.setLoading(null);\n    };\n\n    /** Booking to view details */\n    public get booking(): Booking {\n        return this._data.booking;\n    }\n\n    public set booking(booking: Booking) {\n        this._data.booking = booking;\n        // if space selected no longer exists on booking change, pick first one.\n        if (this._data.booking.room?.id && this._data.booking.room.id !== this._data.space?.id) {\n            this._data.space = this._data.booking.room;\n        }\n    }\n\n    /** Space to display booking details for */\n    public get space(): Space {\n        return this._data.space;\n    }\n\n    /** Type of meeting */\n    public get type(): string {\n        return this.booking.getType();\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _bookings: BookingsService,\n        private _booking_state_service: BookingStateService,\n        private _dialog_ref: MatDialogRef<MeetingDetailsModalComponent>,\n        private _dialog: MatDialog,\n        @Inject(MAT_DIALOG_DATA) private _data: MeetingDetailsModalData,\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        if (!this.booking) {\n            this._dialog_ref.close();\n            return;\n        };\n    }\n\n    public setLoading(state: string) {\n        this.loading = state;\n        this._dialog_ref.disableClose = !!this.loading;\n    }\n\n    public acceptMeeting() {\n        this.setLoading('Accepting meeting...');\n        const event = this.booking.toJSON();\n        this._bookings\n            .accept(this.booking.id, {\n                concierge: true,\n                host: this.booking.organiser.email,\n                room_email: this.space.email,\n                icaluid: this.booking.icaluid,\n                start: event.start,\n                end: event.end,\n            })\n            .then(() => {\n                this._service.notifySuccess('Meeting approved.');\n                this.booking.status = BOOKING_STATUS.approved;\n                this._booking_state_service.replace(this.booking);\n                this.setLoading(null);\n                this.event.emit({ reason: 'action', metadata: BOOKING_STATUS.approved });\n            }, this._on_error('Unable to approving meeting'));\n    }\n\n    public declineMeeting() {\n        this.setLoading('Declining meeting...');\n        this._bookings\n            .decline(this.booking.id, {\n                booking_id: this.booking.id,\n                organiser: this.booking.organiser.email,\n                icaluid: this.booking.icaluid,\n                start: this.booking.startDateTz.seconds,\n                end: this.booking.endDateTz.seconds,\n                room_email: this.space.email,\n            })\n            .then(() => {\n                this._service.notifySuccess('Meeting declined.');\n                this.booking.status = BOOKING_STATUS.declined;\n                this._booking_state_service.replace(this.booking);\n                this.setLoading(null);\n                this.event.emit({ reason: 'action', metadata: BOOKING_STATUS.declined });\n            }, this._on_error('Unable to declining meeting'));\n    }\n\n    /** Open modal to confirm deletion of booking */\n    public confirmDeleteMeeting() {\n        const ref = this._dialog.open<DeleteConfirmModalComponent>(DeleteConfirmModalComponent);\n        this.subscription(\n            'confirm',\n            ref.componentInstance.event.subscribe(async (event: DialogEvent) => {\n                /* istanbul ignore else */\n                if (event.reason === 'action') {\n                    ref.componentInstance.loading = true;\n                    const success = await this.deleteMeeting().catch(\n                        this._on_error('Error deleting booking'),\n                    );\n                    ref.componentInstance.loading = false;\n                    ref.componentInstance.success = !!success;\n                    setTimeout(() => {\n                        ref.close()\n                    }, 3000);\n                }\n            }),\n        );\n    }\n\n    /** Open model to cloning a booking */\n    public cloningMeeting():void {\n        this._dialog.open(BookingModalComponent, {\n            data: {\n                booking: this.booking,\n                action: BookingAction.CLONE\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop'\n        });\n    }\n\n    /** Delete booking */\n    private async deleteMeeting(opts: { series?: boolean } = {}) {\n        this.setLoading('Deleting meeting...');\n        await this.booking.delete(opts);\n        this._service.notifySuccess('Successfully deleted booking');\n        this.event.emit({ reason: 'action', metadata: 'removed' });\n        this._dialog_ref.afterClosed().subscribe(_ => this.setLoading(null));\n        this._dialog_ref.close();\n        this._service.get('undo').next({ action: opts && opts.series ? 'series' : 'booking', booking: this.booking });\n        return true;\n    }\n\n    /** Update booking requirements */\n    public async updateRequirements(form: FormGroup) {\n        this.setLoading('Updating requirements...');\n        const value = form.value;\n        const booking_data = this.booking.toJSON();\n        const booking = new Booking({\n            ...booking_data,\n            ...value,\n            room: value.space_list[0], // R--- not ideal\n        });\n         // if notes or catering exist? add 15 min buffer setup and breakdown to booking\n         const has_note_buffer = (booking.notes && booking.notes?.length) || (booking.catering && booking.catering?.length) ? {[booking?.space?.email]: 900} :  null; // 900 seconds = 15 min\n         if (has_note_buffer) {\n            booking.setup = has_note_buffer;\n            booking.breakdown = has_note_buffer;      \n         }\n        const new_booking: Booking = (await this._bookings\n            .save(booking)\n            .catch(this._on_error(`Error updating requirements`))) as any;\n        if (new_booking) {\n            const bkn = new Booking({ ...booking_data, ...new_booking.toApiJSON() });\n            this._data.booking = bkn;\n            this._booking_state_service.replace(bkn);\n            this._service.notifySuccess('Successfully updated requirements');\n        }\n        this.setLoading(null);\n    }\n\n    public async updateBooking(form) {\n        this.setLoading('Updating booking...');\n        const value = form.value;\n        const booking_data = this.booking.toJSON();\n        const startDateTz = form.controls.dateTz.value\n        const endDateTz = startDateTz.addValue({ minutes: value.duration })\n        const booking = new Booking({\n            ...booking_data,\n            ...value,\n            startDateTz,\n            endDateTz,\n            start_epoch: startDateTz.seconds,\n            end_epoch: endDateTz.seconds,\n            room: value.space_list[0], // R--- not ideal\n        });\n         // if notes or catering exist? add 15 min buffer setup and breakdown to booking\n         const has_note_buffer = (booking.notes && booking.notes?.length) || (booking.catering && booking.catering?.length) ? {[booking?.space?.email]: 900} :  null; // 900 seconds = 15 min\n         if (has_note_buffer) {\n            booking.setup = has_note_buffer;\n            booking.breakdown = has_note_buffer;      \n         }\n        const new_booking: Booking = (await this._bookings\n            .save(booking)\n            .catch(this._on_error(`Error updating booking`))) as any;\n        if (new_booking) {\n            this._booking_state_service.bookings.subscribe(res =>{\n                const booking = res.find(book => this.booking.id === book.id);\n                this.booking = booking; // if space selected no longer exists on booking change, this will pick first one.\n            })\n            this._service.notifySuccess('Successfully updated booking');\n        }\n        this.setLoading(null);\n    }\n\n    public async updateBreakdown(event) {\n        this.setLoading('Updating requirements...');\n        const booking_data = this.booking.toJSON();\n        const _booking = new Booking({\n            ...booking_data,\n            setup: event.setup,\n            breakdown: event.breakdown,\n            notes: event.notes,\n        });\n        const new_booking: Booking = (await this._bookings\n            .save(_booking)\n            .catch(this._on_error(`Error updating requirements`))) as any;\n        if (new_booking) {\n            const bkn = new Booking({ ...booking_data, ...new_booking.toApiJSON() });\n            this._data.booking = bkn;\n            this._booking_state_service.replace(bkn);\n            this._service.notifySuccess('Successfully updated requirements');\n        }\n        this.setLoading(null);\n    }\n}\n","<header [class]=\"'concierge-' + type\">\n    <div class=\"time\">{{ booking.time_period }}</div>\n    <div class=\"heading\" [class.edited]=\"booking.edits.includes('title')\">{{ booking?.title }}</div>\n    <div class=\"actions\">\n        <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n            <app-icon\n                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"\n            ></app-icon>\n        </button>\n    </div>\n</header>\n<ng-container *ngIf=\"booking.recurrence_type && booking.recurrence_period && !loading\">\n    <meeting-recurring-details [ngClass]=\"{ 'declined': type === 'cancelled'}\"\n        [booking]=\"booking\"\n        (confirmDelete)=\"deleteMeeting($event)\"\n    ></meeting-recurring-details>\n</ng-container>\n<mat-dialog-content [class]=\"'concierge-' + type\">\n    <main *ngIf=\"!loading; else load_state\">\n        <section>\n            <div class=\"block\">\n                <meeting-details [booking]=\"booking\" [space]=\"space\" (updateBooking)=\"updateBooking($event)\"></meeting-details>\n            </div>\n            <div class=\"block\">\n                <meeting-details-requirements\n                    [booking]=\"booking\"\n                    [space]=\"space\"\n                    (event)=\"updateRequirements($event)\"\n                ></meeting-details-requirements>\n            </div>\n            <div class=\"block\">\n                <meeting-catering [booking]=\"booking\" [space]=\"space\" (updateBooking)=\"updateBooking($event)\"></meeting-catering>\n            </div>\n            <div class=\"block\">\n                <meeting-private-details [booking]=\"booking\" [space]=\"space\" (updateBooking)=\"updateBreakdown($event)\"></meeting-private-details>\n            </div>\n        </section>\n        <section>\n            <button name=\"accept\" (click)=\"acceptMeeting()\">\n                <div class=\"group\">\n                    <div class=\"app-icon calendar-confirm\"></div>\n                    Accept booking\n                </div>\n            </button>\n            <button name=\"decline\" (click)=\"declineMeeting()\">\n                <div class=\"group\">\n                    <div class=\"app-icon circle-close\"></div>\n                    Decline booking\n                </div>\n            </button>\n            <button [class.error]=\"true\" name=\"clone\" (click)=\"cloningMeeting()\">\n                <div class=\"group\">\n                    <div class=\"app-icon document-copy\"></div>\n                    Clone booking\n                </div>\n            </button>\n            <button [class.error]=\"true\" name=\"delete\" (click)=\"deleteMeeting()\" [attr.disabled]=\"booking.attempted_to_delete ? 'disabled' : null\">\n                <div class=\"group\">\n                    <div class=\"app-icon trash\"></div>\n                    Cancel booking\n                </div>\n            </button>\n        </section>\n    </main>\n</mat-dialog-content>\n<ng-template #load_state>\n    <main class=\"loading\">\n        <div class=\"info-block center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </main>\n</ng-template>\n","import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { FormGroup, FormControl } from '@angular/forms';\n\nimport { UsersService } from '@mckinsey-converge/data-common';\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { Identity, DialogEvent } from '@mckinsey-converge/base';\nimport { humaniseDuration } from '@mckinsey-converge/base';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { ApplicationService, BookingNote } from '@mckinsey-converge/data-common';\n\nimport { BookingsService } from '@mckinsey-converge/data-common';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\n\nexport interface PrivateDetailsModalData {\n    space: Space;\n    booking: Booking;\n}\n\n@Component({\n    selector: 'a-private-details-modal',\n    templateUrl: './private-details-modal.component.html',\n    styleUrls: ['./private-details-modal.component.scss'],\n})\nexport class PrivateDetailsModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form Fields for private details */\n    public form: FormGroup;\n    /** Whether changes are being saved */\n    public loading: boolean;\n    /** List of available durations for setup and breakdown */\n    public available_durations: Identity[] = new Array(5)\n        .fill(0)\n        .map((_, i) => ({ id: i * 15 * 60, name: humaniseDuration(i * 15) || '0 minutes' }));\n\n    public get booking(): Booking {\n        return this._data.booking;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _users: UsersService,\n        private _bookings: BookingsService,\n        private _booking_state: BookingStateService,\n        private _dialog_ref: MatDialogRef<PrivateDetailsModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: PrivateDetailsModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        const note = this.booking.notes.find(\n            (note) => note.type === 'private' && note.space === this._data.space.email\n        ) || { message: '' };\n        this.form = new FormGroup({\n            setup: new FormControl(this.booking.setup[this._data.space.email] || 0),\n            breakdown: new FormControl(this.booking.breakdown[this._data.space.email] || 0),\n            notes: new FormControl(note.message),\n        });\n    }\n\n    public saveChanges() {\n        const now = new DateTZ();\n        if (this.form.dirty) {\n            const old_notes = this.booking.notes.filter(\n                (note) => !(note.type === 'private' && note.space === this._data.space.email)\n            );\n            const notes = [\n                ...old_notes,\n                {\n                    type: 'private',\n                    date: now.ms,\n                    message: this.form.value.notes,\n                    author: this._users.current.name,\n                    space: this._data.space.email,\n                } as BookingNote,\n            ];\n            const value = this.form.value;\n            const setup = { ...this.booking.setup };\n            setup[this._data.space.email] = value.setup;\n            const breakdown = { ...this.booking.breakdown };\n            breakdown[this._data.space.email] = value.breakdown;\n            const new_booking = new Booking({\n                ...this.booking.toJSON(),\n                setup,\n                breakdown,\n                notes,\n            });\n            this.loading = true;\n            this._dialog_ref.disableClose = true;\n            this._bookings.save(new_booking).then(\n                (booking) => {\n                    this.event.emit({ reason: 'done', metadata: {setup, breakdown, notes} });\n                    this._dialog_ref.close();\n                },\n                (err) => {\n                    this._dialog_ref.disableClose = false;\n                    this.loading = false;\n                }\n            );\n        } else {\n            this._dialog_ref.close();\n        }\n    }\n}\n","<header>\n    <div class=\"heading\">Edit Private Details</div>\n    <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main *ngIf=\"!loading; else load_state\">\n        <form *ngIf=\"form\" [formGroup]=\"form\">\n            <div class=\"field\">\n                <label for=\"setup\">Setup:</label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select name=\"setup\" formControlName=\"setup\" placeholder=\"None\">\n                        <mat-option *ngFor=\"let duration of available_durations\" [value]=\"duration.id\">\n                            {{ duration.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"breakdown\">Breakdown:</label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select name=\"breakdown\" formControlName=\"breakdown\" placeholder=\"None\">\n                        <mat-option *ngFor=\"let duration of available_durations\" [value]=\"duration.id\">\n                            {{ duration.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"notes\">Notes:</label>\n                <mat-form-field name=\"notes\" appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"notes\"\n                        placeholder=\"Private Notes\"\n                        formControlName=\"notes\"\n                    ></textarea>\n                </mat-form-field>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions *ngIf=\"!loading\">\n    <footer>\n        <button mat-button (click)=\"saveChanges()\">Save</button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main>\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div classs=\"text\">Updating private details...</div>\n        </div>\n    </main>\n</ng-template>\n","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { Booking, generateBookingForm } from '@mckinsey-converge/data-common';\nimport { humaniseDuration, BaseDirective, DialogEvent } from '@mckinsey-converge/base';;\nimport { PrivateDetailsModalComponent } from '../private-details-modal/private-details-modal.component';\nimport { Space } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'meeting-private-details',\n    templateUrl: './private-details.component.html',\n    styleUrls: ['./private-details.component.scss'],\n})\nexport class MeetingPrivateDetailsComponent extends BaseDirective implements OnInit {\n    /** Booking to display details */\n    @Input() public booking: Booking;\n    /** Space to display details */\n    @Input() public space: Space;\n\n    @Output() updateBooking = new EventEmitter();\n\n    public get setup(): string {\n        let setup = this.booking.setup[this.space.email];\n        return setup ? humaniseDuration(setup / 60) : '<No Setup time>';\n    }\n\n    public get breakdown(): string {\n        let breakdown = this.booking.breakdown[this.space.email];\n        return breakdown ? humaniseDuration(breakdown / 60) : '<No Breakdown time>';\n    }\n\n    public get notes() {\n        return (this.booking.notes.find(note => note.type === 'private' && note.space === this.space.email) || {}).message;\n    }\n\n    constructor(private _dialog: MatDialog) {\n        super();\n    }\n\n    ngOnInit(): void {}\n\n    public openPrivateDetailsModal() {\n        const dialogRef = this._dialog.open<PrivateDetailsModalComponent>(PrivateDetailsModalComponent, {\n            data: {\n                space: this.space,\n                booking: this.booking,\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n\n        this.subscription(\n            'modal_events',\n            dialogRef.componentInstance.event.subscribe(async (event: DialogEvent) => {\n                const form = generateBookingForm(this.booking, ['space_list'], true);\n                if (event.reason === 'done') {\n                    dialogRef.close();\n                    this.updateBooking.emit(event.metadata);\n                }\n            })\n        );\n    }\n}\n","<div class=\"heading\">\n    Private Details\n</div>\n<div class=\"content\">\n    <div class=\"field\" [class.edited]=\"booking.edits.includes('setup|' + space.email)\">\n        <label for=\"setup\">Setup:</label>\n        <div class=\"value\" name=\"setup\">\n            {{ setup }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"booking.edits.includes('breakdown|' + space.email)\">\n        <label for=\"breakdown\">Breakdown:</label>\n        <div class=\"value\" name=\"breakdown\">\n            {{ breakdown }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"booking.edits.includes('private_note|' + space.email)\">\n        <label for=\"notes\">Private Notes:</label>\n        <div class=\"value\" name=\"notes\">\n            {{ notes || '&lt;No Notes&gt;' }}\n        </div>\n    </div>\n</div>\n<button class=\"footer\" mat-button (click)=\"openPrivateDetailsModal()\">\n    Edit Private Details\n</button>\n","import { Component, Input, OnInit, Output, EventEmitter } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\nimport { Booking, BookingStateService, SeriesAction, RecurrencePeriod, BookingsService } from '@mckinsey-converge/data-common';\nimport { DateNow, DateTZ } from \"@mckinsey-converge/date-tz\"\nimport { BookingModalComponent } from 'src/app/bookings/booking-modal/booking-modal.component';\n\n@Component({\n    selector: 'meeting-recurring-details',\n    templateUrl: './recurring-details.component.html',\n    styleUrls: ['./recurring-details.component.scss'],\n})\nexport class MeetingRecurringDetailsDisplayComponent extends BaseDirective implements OnInit {\n    /** Booking to display details */\n    @Input() public booking: Booking;\n    /** helper for setLoading state of the parent modal */\n    @Output() public confirmDelete: EventEmitter<{ series?: boolean}> = new EventEmitter<{}>();\n\n    private _recurrence_endTz: DateTZ;\n    private _recurrence_startTz: DateTZ;\n    private _recurrence_period: RecurrencePeriod;\n    private _recurrence_interval: number;\n    private _occurrence_details: { id: string, start_epoch: number, dateTz?: DateTZ }[];\n    private _specific_dates: boolean = false;\n    private _master_booking: Booking;\n    public expired_ocurrences: Array<Booking> = [];\n\n    constructor(\n        private _booking_state: BookingStateService,\n        private _dialog: MatDialog,\n        private _bookings: BookingsService\n    ) {\n        super()\n    }\n\n    public ngOnInit(): void {\n        this.subscription(\n            'detail_bookings',\n            this._booking_state.bookings.subscribe(async (bookings) => {\n\n                const booking = bookings.find(bkn => bkn.icaluid === this.booking.icaluid);\n                if (!booking) {\n                    return;\n                }\n\n                this.master_booking = (this.booking.recurrence_type === 'occurrence'\n                    ? bookings.filter(bkg => bkg.id === booking.recurrence_master_id)\n                    : [booking]\n                ).shift();\n\n                if (!this.master_booking) {\n                    this.master_booking = await this._bookings.show(booking.recurrence_master_id);\n                    this._booking_state.add(this.master_booking);\n                }\n\n                this.recurrence_endTz = this.master_booking.recurrenEndFromOcurrences(this.master_booking.occurrence_details);\n                this.recurrence_startTz = new DateTZ({date: this.master_booking.start_epoch * 1000, is_local_tz: false, building_tz: this.master_booking.timezone});\n                this.recurrence_period = this.master_booking.recurrence_period;\n                this.recurrence_interval = this.master_booking.recurrence_interval;\n                this.occurrence_details = this.master_booking.occurrence_details && this.master_booking.occurrence_details\n                    .filter(ocurrence => ocurrence.id !== this.master_booking.id)\n                    .map(ocurrence => ({ ...ocurrence, start_epoch:  ocurrence.start_epoch * 1000, dateTz: new DateTZ({ date: ocurrence.start_epoch * 1000, is_local_tz: false, building_tz: this.master_booking.timezone }) }));\n                const occurrence_ids = this.master_booking?.occurrence_details.map(ocurr => ocurr.id) || []\n                this.expired_ocurrences = bookings.filter(booking => {\n                    if(occurrence_ids.includes(booking.id)){\n                        const building_tz = this.master_booking.timezone\n                        const date = (booking.start_epoch * 1000) + (booking.duration * 60000)\n                        const start = new DateTZ({date, is_local_tz: false, building_tz})\n                        const now = DateNow(new Date()).toZone(building_tz)\n                        return now.isAfterDate(start, 'minute')\n                    }\n                    return false\n                })\n            })\n        );\n    }\n\n    public set recurrence_startTz(date: DateTZ)  {\n        this._recurrence_startTz = date\n    }\n\n    public get recurrence_startTz():DateTZ  {\n        return this._recurrence_startTz\n    }\n\n    public set recurrence_endTz(date: DateTZ)  {\n        this._recurrence_endTz = date\n    }\n\n    public get recurrence_endTz(): DateTZ  {\n        return this._recurrence_endTz\n    }\n\n    public set recurrence_period(period: RecurrencePeriod)  {\n        this._recurrence_period = period;\n    }\n\n    public get recurrence_period():RecurrencePeriod  {\n        return this._recurrence_period;\n    }\n\n    public set recurrence_interval(interval: number)  {\n        this._recurrence_interval = interval;\n    }\n\n    public get recurrence_interval():number  {\n        return this._recurrence_interval;\n    }\n\n    public set occurrence_details(occurrences: { id: string, start_epoch: number }[]) {\n        this._occurrence_details = occurrences;\n    }\n\n    public get occurrence_details(): { id: string, start_epoch: number }[]  {\n        return this._occurrence_details;\n    }\n\n    public set specific_dates(val: boolean) {\n        this._specific_dates = val;\n    }\n\n    public get specific_dates(): boolean {\n        return this._specific_dates;\n    }\n\n    public set master_booking(bkng: Booking)  {\n        this._master_booking = bkng;\n    }\n\n    public get master_booking():Booking  {\n        return this._master_booking;\n    }\n\n    public toggleSpecificDates() {\n        this.specific_dates = !this.specific_dates;\n    }\n\n    public async editSeries() {\n        this._dialog.open(BookingModalComponent, {\n            data: {\n                booking: this.master_booking.duplicate(true), //we want to send the master booking since it's the one with all of the series data\n                action: SeriesAction.EDIT,\n                timezone: localStorage.getItem('CONCIERGE.timezone')\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });  \n    }\n\n    public async cloneSeries() {\n        this._dialog.open(BookingModalComponent, {\n            data: {\n                booking: this.master_booking.duplicate(),\n                action: SeriesAction.CLONE\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n    }\n\n    public async cancelSeries() {\n        this.confirmDelete.emit({ series: true });\n    }\n}\n","<div class=\"banner\">\n    <div class=\"banner-info\">\n        <div class=\"app-icon status\"></div>\n        <div class=\"banner-info-txt\" [ngSwitch]=\"recurrence_period\">\n            <ng-template [ngSwitchCase]=\"'daily'\">\n                This is one occurrence in a recurring series which occurs every {{recurrence_interval > 1 ? recurrence_interval + ' Days' : 'Day'}} effective {{recurrence_startTz.formatDate('dd MMM yyyy')}} until {{recurrence_endTz.formatDate('dd MMM yyyy')}}\n            </ng-template>\n            <ng-template [ngSwitchCase]=\"'weekly'\">\n                This is one occurrence in a recurring series which occurs every {{recurrence_interval > 1 ? recurrence_interval + ' Weeks' : 'Week'}} effective {{recurrence_startTz.formatDate('dd MMM yyyy')}} until {{recurrence_endTz.formatDate('dd MMM yyyy')}}\n            </ng-template>\n            <ng-template [ngSwitchCase]=\"'monthly'\">\n                This is one occurrence in a recurring series which occurs every {{recurrence_interval > 1 ? recurrence_interval + ' Months' : 'Month'}} effective {{recurrence_startTz.formatDate('dd MMM yyyy')}} until {{recurrence_endTz.formatDate('dd MMM yyyy')}}\n            </ng-template>\n            <ng-template ngSwitchDefault>\n                This is one occurrence in a recurring series which occurs on<button name=\"specificdates\" type=\"button\" (click)=\"toggleSpecificDates()\">Specific Dates.</button>\n                <div class=\"hint\" *ngIf=\"specific_dates\">\n                    <div class=\"triangle\"></div>\n                    <div class=\"hint-wrapper\">\n                        <div *ngFor=\"let occurrence of occurrence_details\">{{ occurrence.dateTz.formatDate('dd MMM yyyy') }}</div>\n                    </div>\n                </div>\n            </ng-template>\n        </div>\n    </div>\n    <div class=\"banner-actions\">\n        <button mat-button name=\"menu\" [matMenuTriggerFor]=\"seriesActionsMenu\">\n            <div class=\"group\">\n                Series Actions\n                <app-icon\n                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'expand_more' }\"\n                ></app-icon>\n            </div>\n        </button>\n    </div>\n</div>\n<mat-menu #seriesActionsMenu=\"matMenu\">\n    <button mat-menu-item name=\"edit\" (click)=\"editSeries()\" [disabled]=\"expired_ocurrences.length > 0\">\n        <div class=\"group\">\n            <div class=\"app-icon edit\"></div>\n            Edit series\n        </div>\n    </button>\n    <button mat-menu-item name=\"clone\" (click)=\"cloneSeries()\">\n        <div class=\"group\">\n            <div class=\"app-icon clone\"></div>\n            Clone series\n        </div>\n    </button>\n    <button mat-menu-item name=\"cancel\" (click)=\"cancelSeries()\" [disabled]=\"booking.attempted_to_delete && booking.attempted_to_delete === 'series'\">\n        <div class=\"group\">\n            <div class=\"app-icon cancel\"></div>\n            Cancel series\n        </div>\n    </button>\n</mat-menu>\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport {\n    Booking,\n    generateBookingForm\n} from '@mckinsey-converge/data-common';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { RequirementDetailsModalComponent, RequirementDetailsModalData } from '@mckinsey-converge/legacy-overlays';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { DialogEvent } from '@mckinsey-converge/base';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { Space } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'meeting-details-requirements',\n    templateUrl: './requirements.component.html',\n    styleUrls: ['./requirements.component.scss'],\n})\nexport class MeetingDetailsRequirementsComponent extends BaseDirective {\n    /** Booking to display details */\n    @Input() public booking: Booking;\n    /** Space to display details */\n    @Input() public space: Space;\n    /** Emitter for changes to the booking */\n    @Output() public bookingChange = new EventEmitter<Booking>();\n    /** Emitter for updating booking */\n    @Output() public event = new EventEmitter();\n\n    /** Requirement notes */\n    public get notes(): string {\n        const note = this.booking.notes.find(\n            (note) => note.type === 'equipment' && this.space.email === note.space\n        );\n        return (note ? note.message : '') || '<No Notes>';\n    }\n\n    /** Whether booking has been declined or ended */\n    public get expired(): boolean {\n        return this.booking.timeBasedStatusLabel === 'done' || this.booking.declined;\n    }\n\n    constructor(private _dialog: MatDialog, private _service: ApplicationService) {\n        super();\n    }\n\n\n    /** Open modal for adding equipment requirements to booking */\n    public openEquipmentDetailsModal() {\n        const form = generateBookingForm(this.booking, ['space_list'], true);\n        const ref = this._dialog.open<\n            RequirementDetailsModalComponent,\n            RequirementDetailsModalData\n        >(RequirementDetailsModalComponent, {\n            maxWidth: '95vw',\n            width: '32em',\n            data: {\n                spaces: form.controls.space_list.value,\n                notes_field: form.controls.notes,\n                codes_field: form.controls.equipment_codes,\n                head_counts_field: form.controls.expected_attendees,\n                standalone: true\n            }\n        });\n        this.subscription(\n            'modal_events',\n            ref.componentInstance.event.subscribe(async (event: DialogEvent) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    ref.close();\n                    this.event.emit(form);\n                }\n            })\n        );\n    }\n}\n","<div class=\"heading\">\n    Room Requirements\n</div>\n<div class=\"content\" *ngIf=\"booking\">\n    <div class=\"field\" [class.edited]=\"booking.edits.includes('room_email')\">\n        <label for=\"location\">Location:</label>\n        <div class=\"value\" name=\"location\">\n            {{ booking.room.local_name || space.local_name }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"booking.edits.includes('expected_attendees|' + space.email)\">\n        <label for=\"expected\">Expected Attendees:</label>\n        <div class=\"value\" name=\"expected\">\n            {{\n                (booking.expected_attendees || {})[\n                    space.email || booking.room.email\n                ] || '0'\n            }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"booking.edits.includes('equipment_code')\">\n        <label for=\"charge-code\">Charge Code:</label>\n        <div class=\"value\" name=\"charge-code\">\n            {{\n                (booking.equipment_codes || {})[\n                    space.email || booking.room.email\n                ] || 'No Charge Code'\n            }}\n        </div>\n    </div>\n    <div class=\"field\" [class.edited]=\"booking.edits.includes('equipment_note|' + space.email)\">\n        <label for=\"notes\">Private Notes:</label>\n        <div class=\"value\" name=\"notes\">\n            {{ notes }}\n        </div>\n    </div>\n</div>\n<button class=\"footer\" mat-button (click)=\"openEquipmentDetailsModal()\">\n    Edit Requirements\n</button>\n","import { Component, Input, SimpleChanges, ChangeDetectionStrategy } from '@angular/core';\nimport { map } from 'rxjs/operators';\n\nimport { Booking, Space } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\n\nimport { timePeriodsIntersect } from '@mckinsey-converge/data-common';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'week-view-day-display',\n    templateUrl: './day-display.component.html',\n    styleUrls: ['./day-display.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class WeekViewDayDisplayComponent extends BaseDirective {\n    /** Date to display bookings for */\n    @Input() public dateTz: DateTZ = DateNow(new Date());\n    /** List of spaces to display bookings for */\n    @Input() public spaces: Space[];\n    /** Whether the date set is today */\n    public isToday: boolean = false;\n    /** List of bookings for this date */\n    public readonly booking_list = this._booking_state_service.filtered_week.pipe(\n        map((bookings) => {\n            const date = this.dateTz.startOfValue('day');\n            /**\n             * Before the dateTz refactor timePeriodsIntersect would show bookings on the wrong day\n             * because this.dateTz did not have the building timezone\n             */\n            return bookings.filter((booking) => {\n                const ignore = booking.is_recurrent && booking.recurrence_type === 'master';\n                return (\n                    !ignore &&\n                    this.spaces.find((space: Space) => space.email === booking.room.email) &&\n                    timePeriodsIntersect(\n                        date.ms,\n                        date.endOfValue('day').ms,\n                        booking.startDateTz.ms,\n                        booking.endDateTz.ms\n                    )\n                );\n            });\n        })\n    );\n\n    /** Display string for the set date */\n    public get date_display(): string {\n        return this.dateTz.formatDate('EEE, dd MMM yyyy');\n    }\n\n    constructor(private _booking_state_service: BookingStateService) {\n        super();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.dateTz) {\n            const now = new DateTZ({ date: Date.now(), is_local_tz: false, building_tz: this.dateTz.building_tz })\n            this.isToday = this.dateTz.isSameDate(now, 'day');\n        }\n        if (changes.spaces) {\n            this.timeout('changed', () => this._booking_state_service.setFilters(this._booking_state_service.filters), 100);\n        }\n    }\n\n     /**\n     * Track by function for ngFor optimisation\n     * @param index Index of the item\n     * @param item Data associated with the item at the given index\n     */\n      public trackByFn(index: number, item: Booking) {\n        return item.id || index;\n    }\n}\n","<div class=\"heading\">\n    <div class=\"text\">{{ date_display }}</div>\n    <div class=\"info\" *ngIf=\"isToday\">Today</div>\n</div>\n<div class=\"list\">\n    <cdk-virtual-scroll-viewport *ngIf=\"(booking_list | async).length; else empty_state\" appendOnly [itemSize]=\"100\" orientation=\"vertical\"\n     class=\"viewport\">\n        <ng-container *cdkVirtualFor=\"let event of booking_list | async; trackBy: trackByFn\">\n            <week-view-item [event]=\"event\"></week-view-item>\n         </ng-container>\n    </cdk-virtual-scroll-viewport>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No events for {{ date_display }}</div>\n    </div>\n</ng-template>\n","import { Component, Input, ChangeDetectionStrategy, OnInit, ChangeDetectorRef} from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { MeetingDetailsModalComponent } from 'src/app/calendar/meeting-details-modal/meeting-details-modal.component';\n\n@Component({\n    selector: 'week-view-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class WeekViewItemComponent implements OnInit{\n    @Input() public event: Booking;\n\n    public type: string = '';\n\n    constructor(private _dialog: MatDialog) {}\n\n    public ngOnInit() {\n        this.type = this.event.getType();\n    }\n\n    /**\n     * Open modal to view bookings details\n     */\n    public viewMeetingDetails() {\n        this._dialog.open(MeetingDetailsModalComponent, {\n            maxWidth: 'calc(100vw - 2em)',\n            data: {\n                space: this.event.space,\n                booking: this.event\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        })\n    }\n}\n","<div\n    [class]=\"\n        'event' +\n        (type ? ' concierge-' + type : '') +\n        (event.timeBasedStatusLabel === 'done' ? ' ended' : '') +\n        (event.timeBasedStatusLabel === 'in_progress' ? ' in-progress' : '')\n    \"\n    *ngIf=\"event\"\n    [attr.id]=\"event?.id\"\n    (click)=\"viewMeetingDetails()\"\n>\n    <div class=\"heading\">\n        <div class=\"text\">{{ event.all_day ? 'All Day' : event.time_period }}</div>\n        <div class=\"handle\">\n            <app-icon\n                *ngIf=\"event.declined || event.approved\"\n                [icon]=\"{\n                    class: 'material-icons',\n                    content: event.approved ? 'done' : 'event_busy'\n                }\"\n            >\n            </app-icon>\n        </div>\n    </div>\n    <div class=\"details\">\n        <div class=\"field\" [title]=\"event.organiser?.name\">\n            <label for=\"host\">Host:</label>\n            <div class=\"value\" name=\"host\">{{ event.organiser?.name }}</div>\n        </div>\n        <div class=\"field\" [title]=\"event.space?.name || event.local_room_name\">\n            <label for=\"location\">Location:</label>\n            <div class=\"value\" name=\"location\">\n                {{ event.space?.local_name || event.local_room_name }}\n            </div>\n        </div>\n        <div class=\"field\">\n            <label for=\"attendees\">Attendees:</label>\n            <div class=\"value\" name=\"attendees\">{{ event.attendees?.length || '0' }}</div>\n        </div>\n        <div class=\"field\" *ngIf=\"event.company.length > 0\">\n            <label for=\"company\">Company:</label>\n            <div class=\"value\" name=\"company\">{{ event.company.length }}</div>\n        </div>\n    </div>\n</div>\n","import { Component, OnInit, Input, SimpleChanges } from '@angular/core';\nimport { first } from 'rxjs/operators';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { SpacesService } from '@mckinsey-converge/data-common';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'week-view-timeline',\n    templateUrl: './timeline.component.html',\n    styleUrls: ['./timeline.component.scss'],\n})\nexport class WeekViewTimelineComponent extends BaseDirective implements OnInit {\n    /** Timestamp of the active date */\n    @Input() public dateTz: DateTZ = DateNow(new Date());\n    /** ID of the active level */\n    @Input() public level: string;\n    /** ID of the room type to filter displayed spaces by */\n    @Input() public space_type: string;\n    /** Whether weekends are displayed */\n    @Input() public weekends: boolean;\n    /** Whether space bookings are being loaded */\n    @Input() public loading: boolean;\n    /** List of dates to display */\n    public dateListTz: DateTZ[] = [];\n    /** List of spaces to display bookings for */\n    public space_list: Space[] = [];\n\n    constructor(private _spaces: SpacesService, private _booking_state_service: BookingStateService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._spaces.initialised.pipe(first((_) => _)).subscribe(() => {\n            this._booking_state_service.startPollingWeek();\n            this.dateListTz = this.generateDatesTz(this.dateTz, this.weekends);\n            this.space_list = this._spaces.filter(\n                (space) =>\n                    space.zones.includes(this.level) &&\n                    (!this.space_type || space.zones.includes(this.space_type))\n            );\n        });\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.dateTz || changes.weekends || changes.level || changes.space_type) {\n            this.dateListTz = this.generateDatesTz(this.dateTz, this.weekends);\n            this.space_list = this._spaces.filter(\n                (space) =>\n                    space.zones.includes(this.level) &&\n                    (!this.space_type || space.zones.includes(this.space_type))\n            );\n        }\n    }\n\n    public ngOnDestroy() {\n        if (this._booking_state_service?.stopPolling) this._booking_state_service?.stopPolling();\n    }\n\n    /**\n     * Generate list of dates to display\n     * @param dateTz Currently selected date\n     * @param weekends Whether weekends should be included\n     */\n    private generateDatesTz(dateTz: DateTZ, weekends: boolean = false): DateTZ[] {\n        const list: DateTZ[] = [];\n        // start of day takes midnight to the previous day issue\n        let day = dateTz.addValue({ minutes: 5 }).startOfValue('day');\n        let start = day.startOfValue('week');\n        let end = start.endOfValue('week').addValue({ minutes: 15 });\n        while (start.isBeforeDate(end)) {\n            if ((start.dateWeekday !== 6 && start.dateWeekday !== 7) || weekends) {\n                list.push(start);\n            }\n            start = start.addValue({ days: 1 });\n        }\n\n        return list;\n    }\n    \n}\n","<div class=\"week-timeline\">\n    <div class=\"loader\" *ngIf=\"loading\">\n        <mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>\n    </div>\n    <week-view-day-display\n        *ngFor=\"let listDateTz of dateListTz\"\n        [dateTz]=\"listDateTz\"\n        [spaces]=\"space_list\"\n    ></week-view-day-display>\n</div>\n","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { first } from 'rxjs/operators';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { Identity } from '@mckinsey-converge/base';\nimport { BookingModalComponent } from 'src/app/bookings/booking-modal/booking-modal.component';\nimport { Booking, BookingsService, OrganisationService } from '@mckinsey-converge/data-common';\nimport { ApplicationService, BuildingLevel } from '@mckinsey-converge/data-common';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { AlertMode } from '@mckinsey-converge/ui';\nimport { MeetingDetailsModalComponent } from '../meeting-details-modal/meeting-details-modal.component';\n\n@Component({\n    selector: 'a-week-view',\n    templateUrl: './week-view.component.html',\n    styleUrls: ['./week-view.component.scss'],\n})\nexport class WeekViewComponent extends BaseDirective implements OnInit {\n    /** Currently selected date, starts out with no timezone data, gets updated later */\n    public dateTz: DateTZ = DateNow(new Date());\n    /** Whether weekends are displayed */\n    public weekend: boolean;\n    /** ID of the currently selected level */\n    public active_level: string = '';\n    /** ID of the currently selected level */\n    public active_type: string = '';\n    /** List of levels available for the active building */\n    public levels: BuildingLevel[] = [];\n    /** List of space types available for the active building */\n    public space_types: Identity[] = [];\n\n    public banner_mode = AlertMode.Error;\n    public undo_action: 'series' | 'booking';\n    private _undo_timer: any;\n\n    public get building() {\n        return this._org.building;\n    }\n\n    public has_access: boolean;\n\n    constructor(\n        private _service: ApplicationService,\n        private _org: OrganisationService,\n        private _booking_state_service: BookingStateService,\n        private _dialog: MatDialog,\n        private _router: Router,\n        private _route: ActivatedRoute\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._service.title = 'Week View';\n        this._org.initialised.pipe(first((_) => _)).subscribe(() => {\n            // Init dateTz here once the organization data is loaded.\n            this.dateTz = new DateTZ({ date: this.dateTz.ms, is_local_tz: false, building_tz: this.timezone });\n            this.subscription(\n                'route.params',\n                this._route.paramMap.subscribe((params) => {\n                    /* istanbul ignore else */\n                    if (params.has('level') && this.active_level !== params.get('level')) {\n                        const level = this._org.levelWithID(params.get('level'));\n                        /* istanbul ignore else */\n                        if (level) {\n                            const building = this._org.buildings.find(\n                                (bld) => bld.id === level.building_id\n                            );\n                            /* istanbul ignore else */\n                            if (building) {\n                                this.active_level = level.id;\n                                this._org.building = building;\n                                this._booking_state_service.setZone(this.active_level || this._org.building.id);\n                            }\n                        }\n                    }\n                })\n            );\n            this.subscription(\n                'building',\n                this._org.listen('active_building').subscribe(() => {\n                    // Update dateTz here when the building is changed.\n                    this.dateTz = new DateTZ({ date: this.dateTz.ms, is_local_tz: false, building_tz: this.timezone });\n                    const building = this._org.building;\n                    this.has_access = building ? true : false;\n                    if(!this.has_access) return\n                    /* istanbul ignore else */\n                    if (!building.levels.find((lvl) => lvl.id === this.active_level)) {\n                        this.active_level = (building.levels[0] || { id: '' }).id;\n                        this.updateLevel();\n                    }\n                    this.levels = [{ id: '', name: 'All Levels' } as any].concat(building.levels);\n                    this.levels.sort((a, b) => b.name.localeCompare(a.name, undefined, {\n                        numeric: true,\n                        ignorePunctuation: true,\n                    }));\n                    this.space_types = [{ id: '', name: 'All Space Types' } as any].concat(\n                        this._org.space_types\n                    );\n                })\n            );\n            this.subscription(\n                'week_view_undo',\n                this._service.get('undo').subscribe(undo => {\n                    if (!undo)\n                        return\n\n                    if (this.undo_action) {\n                        this.undo_action = null;\n                        clearTimeout(this._undo_timer);\n                    }\n\n                    this._booking_state_service.attentToDelete(undo.booking, undo.action);\n                    this.undo_action = undo.action;\n\n                    this._undo_timer = setTimeout(() => {\n                        this._service.get('undo').next(null);\n                        this.undo_action = null;\n                    }, 15000);\n                })\n            );\n        });\n    }\n\n    public ngOnDestroy(): void {\n        if (this._service.get('undo').getValue()) {\n            this._service.get('undo').next(null);\n        }\n    }\n\n    public newMeeting() {\n        this._dialog.open(BookingModalComponent, {\n            data: { timezone: this.timezone },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n    }\n\n    public updateLevel() {\n        this._booking_state_service.setZone(this.active_level || this._org.building.id);\n        this._router?.url?.includes('/week-view') && this._router.navigate(['/week-view', this.active_level]);\n    }\n\n    // R--- surely these 2 methods are not DRY and all the main tabs need a base class\n    // that encapsulates the common elements.\n    public get timezone() {\n        return this._org.building.timezone;\n    }\n\n    public updateDateTz(dateTz: DateTZ) {\n        this.dateTz = dateTz;\n    }\n\n    public hideBanner() {\n        this.undo_action = null;\n    }\n\n    public async undoBooking(): Promise<void> {\n        const { action, booking } = this._service.get('undo').getValue();\n        if (!booking)\n            return;\n\n        await booking.undo('accept', action === 'series' ? { series: true } : {});\n        this._booking_state_service.attentToDelete(booking, action, true);\n        this._service.get('undo').next(null);\n        this.undo_action = null;\n        this._undo_timer = null;\n\n        this._dialog.open(MeetingDetailsModalComponent, {\n            maxWidth: 'calc(100vw - 2em)',\n            data: {\n                space: booking.space,\n                booking: booking\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n    }\n}\n","<div class=\"week-view\">\n    <a-sidebar></a-sidebar>\n    <div class=\"group\" *ngIf=\"!has_access\">\n        <access-denied></access-denied>\n    </div>\n    <div class=\"group\" *ngIf=\"has_access\">\n        <div class=\"header\" *ngIf=\"undo_action\">\n            <mck-alert-banner\n                [mode]=\"banner_mode\"\n                (action)=\"undoBooking()\"\n                (close)=\"hideBanner()\"\n                buttonText=\"Undo\"\n                message=\"Canceling {{ undo_action }}\">\n            </mck-alert-banner>\n        </div>\n        <a-topbar-header\n            [(dateTz)]=\"dateTz\"\n            [timezone]=\"timezone\"\n            [show_add_item]=\"true\"\n            (event)=\"newMeeting()\"\n            [zone]=\"active_level\"\n            [show_events]=\"true\"\n            (dateChangeTz)=\"updateDateTz($event)\"\n        >\n            <div class=\"topbar\">\n                <mat-form-field *ngIf=\"levels && levels.length > 1\" appearance=\"outline\">\n                    <mat-select [(ngModel)]=\"active_level\" (ngModelChange)=\"updateLevel()\">\n                        <mat-option *ngFor=\"let level of levels\" [value]=\"level?.id\">\n                            {{ level?.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <mat-form-field *ngIf=\"space_types && space_types.length > 1\" appearance=\"outline\">\n                    <mat-select [(ngModel)]=\"active_type\">\n                        <mat-option *ngFor=\"let type of space_types\" [value]=\"type?.id\">\n                            {{ type?.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <mat-slide-toggle\n                    name=\"weekends\"\n                    [(ngModel)]=\"weekend\"\n                    labelPosition=\"before\"\n                    title=\"Only show meetings with setup and breakdown times\"\n                >\n                    Show Weekends\n                </mat-slide-toggle>\n            </div>\n        </a-topbar-header>\n        <main>\n            <week-view-timeline\n                [dateTz]=\"dateTz\"\n                [level]=\"active_level || building?.id\"\n                [space_type]=\"active_type\"\n                [weekends]=\"weekend\"\n            ></week-view-timeline>\n        </main>\n    </div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { RouterModule, Route } from '@angular/router';\n\nimport { WeekViewComponent } from './week-view.component';\nimport { WeekViewTimelineComponent } from './timeline/timeline.component';\nimport { SharedContentModule } from 'src/app/shared/shared.module';\nimport { WeekViewDayDisplayComponent } from './day-display/day-display.component';\nimport { WeekViewItemComponent } from './day-display/item/item.component';\nimport { UiModule } from '@mckinsey-converge/ui';\n\nconst ROUTES: Route[] = [\n    { path: '', component: WeekViewComponent },\n    { path: ':level', component: WeekViewComponent },\n    { path: '**', redirectTo: '' }\n];\n\n@NgModule({\n    declarations: [WeekViewComponent, WeekViewTimelineComponent, WeekViewDayDisplayComponent, WeekViewItemComponent],\n    imports: [CommonModule, FormsModule, ReactiveFormsModule, RouterModule.forChild(ROUTES), SharedContentModule, UiModule]\n})\nexport class WeekViewModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\nimport { first } from 'rxjs/operators';\nimport { BehaviorSubject } from 'rxjs';\nimport { CateringStorage } from 'src/app/catering/catering.storage';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'app-catering',\n    templateUrl: './catering.component.html',\n    styleUrls: ['./catering.component.scss']\n})\nexport class CateringComponent extends BaseDirective implements OnInit {\n    /** Currently selected date */\n    public dateTz: DateTZ = DateNow(new Date());\n    /** Name of the page to display */\n    public page: string;\n    /** Filter string for searching */\n    public search_str: string;\n    /** Toggle for new category modal */\n    public category: number = 0;\n    /** Toggle for new package modal */\n    public package: number = 0;\n    /** Number of categories being displayed */\n    public length: number;\n    /** Order type to filter by */\n    public order_type: string = '';\n\n    public orderDetailsExpanded = new BehaviorSubject<boolean>(false);\n\n    public has_access: boolean;\n\n    constructor(\n        private _route: ActivatedRoute,\n        private _router: Router,\n        private _service: ApplicationService,\n        private _org: OrganisationService,\n        private cateringStorage: CateringStorage\n    ) {\n        super();\n        this.orderDetailsExpanded.next(cateringStorage.orderDetails);\n    }\n\n    public ngOnInit(): void {\n        this.subscription('orderDetailsExpand', this.orderDetailsExpanded.subscribe(value => {\n            this.cateringStorage.orderDetails = value;\n        }));\n        this._org.initialised.pipe(first(_ => _)).subscribe(() => {\n            // Init dateTz here once the organization data is loaded.\n            this.dateTz = new DateTZ({ date: this.dateTz.ms, is_local_tz: false, building_tz: this.timezone });\n            this.category = 0;\n            this._service.title = 'Catering';\n            this.subscription(\n                'route.params',\n                this._route.paramMap.subscribe((params) => {\n                    if (params.has('page')) {\n                        this.page = params.get('page');\n                    }\n                })\n            );\n            this.subscription(\n                'route.query_params',\n                this._route.queryParamMap.subscribe((params) => {\n                    if (params.has('zone') && params.get('zone') !== this._org.building.id) {\n                        const id = params.get('zone');\n                        const bld = this._org.buildings.find((building) => building.id === id);\n                        if (bld) {\n                            this._org.building = bld;\n                        }\n                    }\n                })\n            );\n            this.subscription(\n                'building',\n                this._org.listen('active_building').subscribe(() => {\n                    // Update dateTz here when the building is changed.\n                    this.dateTz = new DateTZ({ date: this.dateTz.ms, is_local_tz: false, building_tz: this.timezone });\n                    this.has_access = this._org.building ? true : false;\n                    if(!this.has_access) return\n                    \n                    this._router.navigate([], {\n                        relativeTo: this._route,\n                        queryParams: { zone: this._org.building.id }\n                    });\n                })\n            );\n        });\n    }\n\n    public get timezone() {\n        return this._org.building.timezone;\n    }\n}\n","<div class=\"catering\">\n    <a-sidebar></a-sidebar>\n    <div class=\"group\" *ngIf=\"!has_access\">\n        <access-denied></access-denied>\n    </div>\n    <div class=\"group\" *ngIf=\"has_access\">\n        <a-topbar-header [(dateTz)]=\"dateTz\" timezone=\"timezone\">\n            <div class=\"input-wrapper\" *ngIf=\"page\">\n                <mat-form-field [class.rounded]=\"true\" appearance=\"outline\">\n                    <app-icon [icon]=\"{ class: 'material-icons', content: 'search' }\" matPrefix></app-icon>\n                    <input matInput [(ngModel)]=\"search_str\" name=\"visitor-name\" placeholder=\"Search...\" />\n                    <button mat-icon-button matSuffix *ngIf=\"search_str\" (click)=\"search_str = ''\">\n                        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n                    </button>\n                </mat-form-field>\n                <mat-form-field *ngIf=\"page === 'orders'\" [class.other-field]=\"true\" appearance=\"outline\">\n                    <mat-select [(ngModel)]=\"order_type\">\n                        <mat-option [value]=\"''\">All Orders</mat-option>\n                        <mat-option [value]=\"'Pantry'\">Pantry Only</mat-option>\n                        <mat-option [value]=\"'Kitchen'\">Kitchen Only</mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <mat-slide-toggle\n                    *ngIf=\"page === 'orders'\" labelPosition=\"before\" class=\"order-details\"\n                    [checked]=\"orderDetailsExpanded | async\"\n                    (change)=\"orderDetailsExpanded.next($event.checked)\">\n                    Order Details\n                </mat-slide-toggle>\n            </div>\n            <button mat-button *ngIf=\"page === 'menu'\" name=\"add-category\" (click)=\"category = category + 1\">Add\n                Category\n            </button>\n            <button mat-button *ngIf=\"page === 'menu' && length\" name=\"add-package\" (click)=\"package = package + 1\">Add\n                Sub-Category/Package\n            </button>\n        </a-topbar-header>\n        <main>\n            <ng-container [ngSwitch]=\"page\">\n                <ng-container *ngSwitchCase=\"'menu'\">\n                    <a-catering-menu [search]=\"search_str\" [category]=\"category\" [package]=\"package\"\n                                     (length)=\"length=$event\"></a-catering-menu>\n                </ng-container>\n                <ng-container *ngSwitchCase=\"'orders'\">\n                    <a-catering-orders [orderDetailsExpanded]=\"orderDetailsExpanded | async\" [date]=\"date\" [search]=\"search_str\" [type]=\"order_type\"></a-catering-orders>\n                </ng-container>\n                <ng-container *ngSwitchDefault>\n                    <div class=\"options\">\n                        <a class=\"card\" name=\"menu\" mat-button [routerLink]=\"['/catering', 'menu']\"\n                           queryParamsHandling=\"preserve\">\n                            <div class=\"content\">\n                                <div\n                                    class=\"img\"\n                                    [style.background]=\"\n                                        'linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(assets/img/menus.jpg)'\n                                            | safe: 'style'\n                                    \"\n                                >\n                                    <h2>Menus and Pricing</h2>\n                                </div>\n                                <div class=\"desc\">View and edit menus and pricing</div>\n                            </div>\n                        </a>\n                        <a class=\"card\" name=\"orders\" mat-button [routerLink]=\"['/catering', 'orders']\"\n                           queryParamsHandling=\"preserve\">\n                            <div class=\"content\">\n                                <div\n                                    class=\"img\"\n                                    [style.background]=\"\n                                        'linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(assets/img/orders.jpg)'\n                                            | safe: 'style'\n                                    \"\n                                >\n                                    <h2>Catering Orders</h2>\n                                </div>\n                                <div class=\"desc\">\n                                    View catering orders and their statuses upon arrival\n                                </div>\n                            </div>\n                        </a>\n                    </div>\n                </ng-container>\n            </ng-container>\n        </main>\n    </div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport {\n    Route,\n    RouterModule\n} from '@angular/router';\nimport {\n    FormsModule,\n    ReactiveFormsModule\n} from '@angular/forms';\n\nimport { CateringComponent } from './catering.component';\nimport { SharedContentModule } from '../shared/shared.module';\nimport { CateringOrdersComponent } from './orders/orders.component';\nimport { CateringMenuComponent } from './menu/menu.component';\nimport { CateringMenuItemListComponent } from './menu/item-list/item-list.component';\nimport { CateringCategoryModalComponent } from './overlays/category-modal/category-modal.component';\nimport { CateringGroupModalComponent } from './overlays/group-modal/group-modal.component';\nimport { CateringItemModalComponent } from './overlays/item-modal/item-modal.component';\nimport { CateringOrdersItemComponent } from './orders/item/item.component';\nimport { OrderDetailsModalComponent } from './overlays/order-details-modal/order-details-modal.component';\nimport { OrderDetailsItemsComponent } from './overlays/order-details-modal/items/items.component';\nimport { OrderBookingDetailsComponent } from './overlays/order-details-modal/booking-details/booking-details.component';\nimport { OrderDetailsNotesComponent } from './overlays/order-details-modal/messages/messages.component';\nimport { CateringStorage } from './catering.storage';\nimport { CateringMenuOrderComponent } from './menu/item/item.component';\nimport { LegacyOverlaysModule } from '@mckinsey-converge/legacy-overlays';\nimport { BaseModule } from '@mckinsey-converge/base';\nimport { BookingsModule } from '../bookings/bookings.module';\n\nconst ROUTES: Route[] = [\n    { path: '', component: CateringComponent },\n    { path: ':page', component: CateringComponent },\n    { path: '**', redirectTo: '' }\n];\n\n@NgModule({\n    declarations: [\n        CateringComponent,\n        CateringOrdersComponent,\n        CateringMenuComponent,\n        CateringMenuItemListComponent,\n        CateringCategoryModalComponent,\n        CateringGroupModalComponent,\n        CateringItemModalComponent,\n        CateringOrdersItemComponent,\n        OrderDetailsModalComponent,\n        OrderDetailsItemsComponent,\n        OrderBookingDetailsComponent,\n        OrderDetailsNotesComponent,\n        CateringMenuOrderComponent,\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        RouterModule.forChild(ROUTES),\n        SharedContentModule,\n        LegacyOverlaysModule,\n        BaseModule,\n        BookingsModule,\n    ],\n    providers: [CateringStorage],\n    exports: [BaseModule]\n})\nexport class CateringModule {\n}\n","import { LocalStorageWrapper } from '@mckinsey-converge/storage';\n\nexport class CateringStorage extends LocalStorageWrapper {\n\n    private static orderDetailsKey = 'order-details';\n\n    constructor() {\n        super('CATERING');\n    }\n\n    public set orderDetails(value: boolean) {\n        this.setValue(CateringStorage.orderDetailsKey, value + '');\n    }\n\n    public get orderDetails(): boolean {\n        const value = this.getValue(CateringStorage.orderDetailsKey);\n        return value === 'true';\n    }\n\n    public removeOrderDetails() {\n        this.removeValue(CateringStorage.orderDetailsKey);\n    }\n}\n","import { Component, Input, SimpleChanges, OnChanges } from '@angular/core';\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\n\nimport { CateringCategory } from '@mckinsey-converge/data-common';\nimport { CateringGroupModalComponent } from '../../overlays/group-modal/group-modal.component';\nimport { Building } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { DialogEvent } from '@mckinsey-converge/base';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-catering-menu-item-list',\n    templateUrl: './item-list.component.html',\n    styleUrls: ['./item-list.component.scss'],\n})\nexport class CateringMenuItemListComponent extends BaseDirective implements OnChanges {\n    /** Category to display details for */\n    @Input() public category: CateringCategory;\n    /** Toggle for new groups */\n    @Input() public package: number;\n\n    /** Currently active building */\n    public get building(): Building {\n        return this._org.building;\n    }\n\n    constructor(private _dialog: MatDialog, private _org: OrganisationService) {\n        super();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.package && this.package) {\n            this.openGroupModal();\n        }\n    }\n\n    public openGroupModal(group?: CateringCategory) {\n        /* istanbul ignore else */\n        if (!group) {\n            group = new CateringCategory({\n                parent_id: this.category.id,\n                zones: [this.building.id],\n            });\n        }\n        const ref = this._dialog.open(CateringGroupModalComponent, {\n            data: { group, parent: this.category },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n        this.subscription(\n            'category_modal',\n            ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    const index = this.category.items.findIndex(\n                        (item) => event.metadata.id === item.id\n                    );\n                    if (index >= 0) {\n                        (this.category.items as any[]).splice(index, 1, event.metadata);\n                    } else {\n                        (this.category.items as any[]).push(event.metadata);\n                    }\n                }\n            })\n        );\n    }\n}\n","<div class=\"list\">\n    <ng-container *ngIf=\"category && category.items && category.items.length; else empty_state\">\n        <div class=\"item\" *ngFor=\"let item of category.items\">\n            <a-catering-order-item [parent]=\"category\" [item]=\"item\"></a-catering-order-item>\n        </div>\n    </ng-container>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No packages or sub-categories for {{ category.name }}</div>\n    </div>\n</ng-template>\n","import { Component, OnInit, Input, SimpleChanges } from '@angular/core';\n\nimport { CateringCategory } from '@mckinsey-converge/data-common';\nimport { ANIMATION_SHOW_CONTRACT_EXPAND } from '@mckinsey-converge/animations';\nimport { MatDialog } from '@angular/material/dialog';\nimport { CateringGroupModalComponent } from '../../overlays/group-modal/group-modal.component';\nimport { CateringItem } from '@mckinsey-converge/data-common';\nimport { ConfirmModalComponent } from '@mckinsey-converge/legacy-overlays';\nimport { CateringComponent } from '../../catering.component';\nimport { DialogEvent, HashMap } from '@mckinsey-converge/base';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { Building } from '@mckinsey-converge/data-common';\nimport { CateringItemModalComponent } from '../../overlays/item-modal/item-modal.component';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\nimport { CateringCategoriesService } from '@mckinsey-converge/data-common';\nimport { CateringItemsService } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-catering-order-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss'],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND],\n})\nexport class CateringMenuOrderComponent extends BaseDirective {\n    /** Whether item is a child of another */\n    @Input() public subitem: boolean;\n    /** Item to display */\n    @Input() public item: CateringCategory;\n    /** Parent of the item being displayed */\n    @Input() public parent: CateringCategory;\n    /** Whether item should be disabled if not available anytime */\n    @Input() public disabled: boolean;\n    /** Whether to show children items */\n    public show_children: boolean;\n\n    /** Currently active building */\n    public get building(): Building {\n        return this._org.building;\n    }\n\n    public get symbol(): string {\n        return this.building.currency;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _dialog: MatDialog,\n        private _org: OrganisationService,\n        private _menu_items: CateringItemsService,\n        private _menu_categories: CateringCategoriesService\n    ) {\n        super();\n    }\n\n    public openGroupModal(group?: CateringCategory) {\n        /* istanbul ignore else */\n        if (!group) {\n            group = new CateringCategory({ parent_id: this.item.id, zones: [this.building.id] });\n        }\n        const ref = this._dialog.open(CateringGroupModalComponent, {\n            data: { group, parent: group.id ? this.parent : this.item },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n        this.subscription(\n            'item-modal',\n            ref.componentInstance.event.subscribe((event) => {\n                if (event.reason === 'done' && event.metadata) {\n                    this.updateItemList(group, event.metadata);\n                }\n            })\n        );\n    }\n\n    public openItemModal(item?: CateringItem) {\n        /* istanbul ignore else */\n        if (!item) {\n            item = new CateringItem({ parent_id: this.item.id });\n        }\n        const ref = this._dialog.open(CateringItemModalComponent, {\n            data: { item, parent: item.id ? this.parent : this.item },\n            autoFocus: false,\n      backdropClass: 'mck-modal-backdrop',\n        });\n        this.subscription(\n            'item-modal',\n            ref.componentInstance.event.subscribe((event) => {\n                if (event.reason === 'done' && event.metadata) {\n                    this.updateItemList(item, event.metadata);\n                }\n            })\n        );\n    }\n\n    private updateItemList(old_item: CateringItem | CateringCategory, new_item: HashMap) {\n        const item =\n            old_item instanceof CateringCategory\n                ? new CateringCategory(new_item)\n                : new CateringItem(new_item);\n        if (old_item.id) {\n            const index = this.parent.items.findIndex((itm) => itm.id === old_item.id);\n            (this.parent.items as any[]).splice(index, 1, item);\n            (this.parent as any).items = [...this.parent.items];\n        } else {\n            (this.item.items as any[]).push(item);\n        }\n    }\n\n    public deleteItem() {\n        const type =\n            this.item.is_category\n                ? this.item.package\n                    ? 'Package'\n                    : 'Sub-category'\n                : 'Item';\n        const ref = this._dialog.open(ConfirmModalComponent, {\n            data: {\n                title: `Delete catering ${type}`,\n                content: `Are you sure you want to delete the catering ${type} \"${\n                    this.item.name\n                }\"?<br />${\n                    this.item instanceof CateringCategory\n                        ? 'Any children items or groups will be <strong>immediately</strong> deleted'\n                        : ''\n                }`,\n                icon: { type: 'icon', class: 'material-icons', content: 'delete' },\n                action: 'Ok',\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n        ref.componentInstance.event.subscribe(async (event: DialogEvent) => {\n            /* istanbul ignore else */\n            if (event.reason === 'done') {\n                ref.componentInstance.loading = `Deleting ${type}...`;\n                let e = null;\n                let service =\n                    this.item.is_category\n                        ? this._menu_categories\n                        : this._menu_items;\n                await service.delete(this.item.id).catch((err) => e = err || 'Error');\n                ref.close();\n                if (!e) {\n                    this._service.set('DELETED.menu', this.item.id);\n                } else {\n                    this._service.notifyError(`Error deleting ${type}.`);\n                }\n            }\n        });\n    }\n}\n","<div class=\"catering-item\" *ngIf=\"item\" [class.subitem]=\"subitem\">\n    <div\n        class=\"image\"\n        *ngIf=\"!subitem\"\n        [style.background-image]=\"'url(' + item.image_path + ')'\"\n    ></div>\n    <div class=\"details\">\n        <div class=\"name\">{{ item.name }}</div>\n        <div class=\"description\">{{ item.package ? '[Package] ' : '' }}{{ item.description }}</div>\n        <div class=\"options\">\n            <div class=\"option price mobile-only\" *ngIf=\"item.unit_price\">\n                {{ item.unit_price / 100 | currency: symbol }}\n            </div>\n        </div>\n    </div>\n    <div class=\"option price not-mobile\" *ngIf=\"item.unit_price\">\n        {{ item.unit_price / 100 | currency: symbol }}\n    </div>\n    <button mat-icon-button name=\"more\" [matMenuTriggerFor]=\"appMenu\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'more_vert' }\"></app-icon>\n    </button>\n    <button\n        mat-icon-button\n        name=\"show-children\"\n        [class.hide]=\"!(item.items && item.items.length)\"\n        (click)=\"show_children = !show_children\"\n    >\n        <app-icon\n            [icon]=\"{\n                class: 'material-icons',\n                content: show_children ? 'keyboard_arrow_up' : 'keyboard_arrow_down'\n            }\"\n        ></app-icon>\n    </button>\n</div>\n<div class=\"children\" [@show]=\"show_children ? 'show' : 'hide'\">\n    <a-catering-order-item\n        *ngFor=\"let sub_item of item.items\"\n        [subitem]=\"true\"\n        [parent]=\"item\"\n        [item]=\"sub_item\"\n    ></a-catering-order-item>\n</div>\n<mat-menu #appMenu=\"matMenu\">\n    <ng-container *ngIf=\"item.items.length || item.is_category\">\n        <button mat-menu-item name=\"add-group\" *ngIf=\"!subitem\" (click)=\"openGroupModal()\">\n            <div class=\"group\">\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'add' }\"></app-icon>\n                <div class=\"text\">Add Group</div>\n            </div>\n        </button>\n        <button mat-menu-item name=\"add-item\" (click)=\"openItemModal()\">\n            <div class=\"group\">\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'add' }\"></app-icon>\n                <div class=\"text\">Add Item</div>\n            </div>\n        </button>\n    </ng-container>\n    <button\n        mat-menu-item\n        name=\"edit\"\n        (click)=\"item.items.length || item.is_category ? openGroupModal(item) : openItemModal(item)\"\n    >\n        <div class=\"group\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'edit' }\"></app-icon>\n            <div class=\"text\">\n                Edit\n                {{\n                    item.items.length || item.is_category\n                        ? subitem\n                            ? 'Group'\n                            : item.package\n                            ? 'Package'\n                            : 'Sub-category'\n                        : 'Item'\n                }}\n            </div>\n        </div>\n    </button>\n    <button mat-menu-item name=\"delete\" class=\"delete\" (click)=\"deleteItem()\">\n        <div class=\"group\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'delete' }\"></app-icon>\n            <div class=\"text\">\n                Delete\n                {{\n                    item.items.length || item.is_category\n                        ? subitem\n                            ? 'Group'\n                            : item.package\n                            ? 'Package'\n                            : 'Sub-category'\n                        : 'Item'\n                }}\n            </div>\n        </div>\n    </button>\n</mat-menu>\n","import { Component, OnInit, Input, SimpleChanges, EventEmitter, Output } from '@angular/core';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { Building } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { CateringCategory } from '@mckinsey-converge/data-common';\nimport { MatDialog } from '@angular/material/dialog';\nimport { CateringCategoryModalComponent } from '../overlays/category-modal/category-modal.component';\nimport { HashMap, DialogEvent } from '@mckinsey-converge/base';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\nimport { CateringMenuService } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-catering-menu',\n    templateUrl: './menu.component.html',\n    styleUrls: ['./menu.component.scss'],\n})\nexport class CateringMenuComponent extends BaseDirective implements OnInit {\n    /** Filter string for catering items */\n    @Input() public search: string;\n    /** Opens new category modal on change */\n    @Input() public category: number;\n    /** Opens new category modal on change */\n    @Input() public package: number;\n    /** Emitter for changes to the length of catering categories */\n    @Output() public length = new EventEmitter<number>();\n    /** List of top level catering categories */\n    public catering_menu: CateringCategory[] = [];\n    /** Filtered list of top level catering categories */\n    public filtered_menu: CateringCategory[] = [];\n    /** Whether menu details are being loaded */\n    public loading: boolean;\n    /** Index of the active tab */\n    public index: number = 0;\n    /** Map of indexes to package open state */\n    public state: HashMap<number> = {};\n\n    /** Currently active building */\n    public get building(): Building {\n        return this._org.building;\n    }\n\n    constructor(private _service: ApplicationService, private _org: OrganisationService, private _menu: CateringMenuService, private _dialog: MatDialog) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._service.set('DELETED.menu', '');\n        this.subscription('deleted', this._service.listen('DELETED.menu').subscribe(id => this.removeFromMenu(id)));\n        this.subscription(\n            'building',\n            this._org.listen('active_building').subscribe((_) => {\n                this.index = 0;\n                this.catering_menu = [];\n                this.filtered_menu = [];\n                this.loadCateringMenu();\n            })\n        );\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.search) {\n            this.filtered_menu = this.filter(this.catering_menu);\n        }\n        if (changes.category && this.category) {\n            this.openCategoryModal();\n        }\n        if (changes.package) {\n            this.state[this.index] = this.package;\n        }\n    }\n\n    public openCategoryModal(category?: CateringCategory) {\n        /* istanbul ignore else */\n        if (!category) {\n            category = new CateringCategory({ zones: [this.building.id] });\n        }\n        const ref = this._dialog.open(CateringCategoryModalComponent, { \n            data: { category }, \n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop', \n        });\n        this.subscription('category_modal', ref.componentInstance.event.subscribe((event: DialogEvent) => {\n            /* istanbul ignore else */\n            if (event.reason === 'done') {\n                const index = this.catering_menu.findIndex(item => event.metadata.id === item.id);\n                if (index >= 0) {\n                    this.catering_menu.splice(index, 1, event.metadata);\n                    this.index = index;\n                } else {\n                    this.index = this.catering_menu.length;\n                    this.catering_menu.push(event.metadata);\n                }\n            }\n        }));\n    }\n\n    /**\n     * Remove item from the menu\n     * @param id ID of the item to remove\n     * @param list Menu items and categories\n     */\n    private removeFromMenu(id: string, list: CateringCategory[] = this.catering_menu, depth: number = 0) {\n        if (list.length === 0 || depth > 4) { return false; }\n        const found = list.findIndex(item => item.id === id);\n        if (found >= 0) {\n            list.splice(found, 1);\n            return true;\n        } else {\n            for (const item of list) {\n                if (this.removeFromMenu(id, item.items as any, depth + 1)) { return true; }\n            }\n        }\n        return false;\n    }\n\n    private loadCateringMenu(): void {\n        /* istanbul ignore else */\n        if (this.building) {\n            this.loading = true;\n            this._menu.query({ zone_id: this.building.id }).then(\n                (menu: any[]) => {\n                    this.catering_menu = (menu || []).map((item) => new CateringCategory(item));\n                    this.length.emit(this.catering_menu.length);\n                    this.filtered_menu = this.filter(this.catering_menu);\n                    this.loading = false;\n                },\n                (err) => {\n                    this._service.notifyError(\n                        `Error loading menu for ${this.building.name}. Error: ${err.message | err}`,\n                        'Retry',\n                        () => this.loadCateringMenu()\n                    );\n                    this.loading = false;\n                }\n            );\n        }\n    }\n\n    /** Filter the list of catering items */\n    private filter(list: CateringCategory[]) {\n        return list;\n    }\n}\n","<div class=\"menu page dark-mode\">\n    <ng-container *ngIf=\"!loading; else load_state\">\n        <mat-tab-group *ngIf=\"filtered_menu && filtered_menu.length; else empty_state\" [(selectedIndex)]=\"index\">\n            <mat-tab *ngFor=\"let category of filtered_menu; let i = index\">\n                <ng-template mat-tab-label>\n                    <div class=\"tab-label\">\n                        <div class=\"label\">{{category?.name}}</div>\n                        <button mat-icon-button name=\"edit\" (click)=\"$event.stopPropagation()\" (click)=\"openCategoryModal(category)\">\n                            <app-icon [icon]=\"{ class: 'material-icons', content: 'edit' }\"></app-icon>\n                        </button>\n                    </div>\n                </ng-template>\n                <a-catering-menu-item-list [package]=\"state[i]\" [category]=\"category\"></a-catering-menu-item-list>\n            </mat-tab>\n        </mat-tab-group>\n    </ng-container>\n</div>\n<ng-template #load_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <mat-spinner diameter=\"32\"></mat-spinner>\n        </div>\n        <div class=\"text\">Loading menu for {{ building?.name }}</div>\n    </div>\n</ng-template>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No menu categories for {{ building?.name }}</div>\n    </div>\n</ng-template>\n","import { Component, Input, SimpleChanges, OnChanges } from '@angular/core';\n\nimport {\n    CateringOrder,\n    CateringOrderStatus,\n} from '@mckinsey-converge/data-common';\nimport { ANIMATION_SHOW_CONTRACT_EXPAND } from '@mckinsey-converge/animations';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { Identity, HashMap } from '@mckinsey-converge/base';\nimport { MatDialog } from '@angular/material/dialog';\nimport { OrderDetailsModalComponent } from '../../overlays/order-details-modal/order-details-modal.component';\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { SpacesService } from '@mckinsey-converge/data-common';\nimport { BookingsService } from '@mckinsey-converge/data-common';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\nimport { getTimezoneOffsetString } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'a-catering-orders-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss'],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND]\n})\nexport class CateringOrdersItemComponent implements OnChanges {\n    /** Catering order details to display */\n    @Input() public order: CateringOrder;\n    /** Search filter string */\n    @Input() public search: string;\n    /** Whether order items should be shown */\n    @Input()\n    public show_items: boolean;\n    /** Actively selected status */\n    public active_status: CateringOrderStatus;\n    /** Whether status is being updated */\n    public loading: boolean;\n    /** Mapping of items to the option selections */\n    public readonly item_details: HashMap<{ amount: number, details: string }> = {};\n\n    public showIndividualItem : boolean = false;\n\n    public get search_matches(): HashMap<boolean> {\n        const map = {};\n        const filter = this.search.toLowerCase();\n        this.order.items.forEach((item) => {\n            map[item.id] = item.name.toLowerCase().indexOf(filter) >= 0;\n        });\n        return map;\n    }\n\n    public statuses: Identity[] = [\n        { id: 'accepted', name: 'Accepted', icon: { class: 'custom-accepted' }, colour: '#3996B6' },\n        {\n            id: 'preparing',\n            name: 'Preparing',\n            icon: { class: 'custom-preparing' },\n            colour: '#E7536B',\n        },\n        { id: 'ready', name: 'Ready', icon: { class: 'custom-ready' }, colour: '#FFD028' },\n        {\n            id: 'delivered',\n            name: 'Delivered',\n            icon: { class: 'custom-delivered' },\n            colour: '#75BB43',\n        },\n        {\n            id: 'cancelled',\n            name: 'Cancelled',\n            icon: { class: 'custom-cancelled' },\n            colour: '#747474',\n        },\n    ];\n\n    public get timezone() {\n        return getTimezoneOffsetString(localStorage.getItem('CONCIERGE.timezone'));\n    }\n\n    /** Details for the active status */\n    public get status_details(): Identity {\n        return this.statuses.find((status) => status.id === this.active_status) || ({} as any);\n    }\n\n    public get space(): Space {\n        return this._spaces.find(this.order.location_id);\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _spaces: SpacesService,\n        private _bookings: BookingsService,\n        private _booking_state_service: BookingStateService,\n        private _dialog: MatDialog\n    ) {}\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.order && this.order) {\n            this.active_status = this.order.status;\n            this.updateItemDetails();\n        }\n        this.showIndividualItem = this.show_items;\n    }\n\n    /** Update the status of the order in the booking */\n    public async updateStatus(): Promise<void> {\n        const booking = this.order.booking;\n        /* istanbul ignore else */\n        if (booking) {\n            this.loading = true;\n            const catering = [...booking.catering];\n            catering.splice(\n                catering.findIndex((order) => order.id === this.order.id),\n                1,\n                new CateringOrder({ ...this.order, status: this.active_status })\n            );\n            const new_booking = new Booking({ ...booking.toJSON(), catering });\n            const updated_booking = await this._bookings.save(new_booking).catch((err) => {\n                this._service.notifyError(\n                    `Error updating order status. Error: ${err.message || err}`\n                );\n                this.active_status = this.order.status;\n            });\n            if (updated_booking) {\n                this._booking_state_service.replace(updated_booking);\n            }\n            this.loading = false;\n        }\n    }\n\n    /** Open modal to view catering order details */\n    public viewOrderDetails(): void {\n        const dialogRef = this._dialog.open(OrderDetailsModalComponent, {\n            maxHeight: '95vh',\n            maxWidth: '95vw',\n            data: {\n                order: this.order,\n                booking: this.order.booking,\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n    }\n\n    private updateItemDetails() {\n        for (const item of this.order.items) {\n            if ((item as any).items) {\n                const items = [];\n                for (const sub_item of (item as any).items) {\n                    if (!sub_item.items.length && sub_item.amount) {\n                        items.push(sub_item)\n                    } else {\n                        for (const sub_sub_item of sub_item.items) {\n                            if (sub_sub_item.amount) {\n                                items.push(sub_sub_item)\n                            }\n                        }\n                    }\n                }\n                this.item_details[item.id] = {\n                    amount: items.length,\n                    details: `[${items.map(i => i.name).join(']\\n[')}]`\n                };\n            }\n        }\n    }\n\n    public expandMore() {\n        this.showIndividualItem = !this.showIndividualItem\n    }\n}\n","<div class=\"order\" [class.showing]=\"show_items || search\">\n    <div class=\"details\" [class.showing]=\"show_items\" [class.not-match]=\"search\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'room_service' }\"></app-icon>\n        </div>\n        <div class=\"time\">{{ order.deliver_at }}</div>\n        <div class=\"location\">{{ order.location || space?.name }}&nbsp;({{ space?.local_name}})</div>\n        <div class=\"host\">{{ order.booking?.organiser.name }}</div>\n        <div class=\"package-type\">\n            <ng-container *ngIf=\"order.kitchen\"><span>(K)</span> Kitchen<br /></ng-container>\n            <ng-container *ngIf=\"order.pantry\"><span>(P)</span> Pantry</ng-container>\n        </div>\n        <div class=\"status\">\n            <mat-form-field\n                class=\"rounded visible\"\n                appearance=\"outline\"\n                *ngIf=\"statuses && statuses.length > 1\"\n            >\n                <mat-select\n                    #select\n                    [(value)]=\"active_status\"\n                    (valueChange)=\"updateStatus()\"\n                    placeholder=\"New Order\"\n                    [disabled]=\"loading\"\n                >\n                    <mat-select-trigger>\n                        <div class=\"group\">\n                            <div class=\"icon\">\n                                <div\n                                    class=\"wrapper\"\n                                    [style.backgroundColor]=\"\n                                        loading ? '#eee' : status_details?.colour\n                                    \"\n                                >\n                                    <app-icon\n                                        *ngIf=\"!loading\"\n                                        [icon]=\"status_details?.icon\"\n                                    ></app-icon>\n                                    <mat-spinner *ngIf=\"loading\" diameter=\"16\"></mat-spinner>\n                                </div>\n                            </div>\n                            <div class=\"text\">{{ status_details?.name }}</div>\n                        </div>\n                    </mat-select-trigger>\n                    <mat-option *ngFor=\"let status of statuses\" [value]=\"status.id\">\n                        <div class=\"group\">\n                            <div class=\"text\">{{ status.name }}</div>\n                            <div class=\"colour\" [style.backgroundColor]=\"status.colour\"></div>\n                        </div>\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n        </div>\n        <button mat-icon-button name=\"view\" (click)=\"viewOrderDetails()\">\n            <app-icon\n                [icon]=\"{\n                    class: 'material-icons',\n                    content: 'visibility'\n                }\"\n            ></app-icon>\n        </button>\n        <div class=\"more\">\n            <button mat-icon-button name=\"more\" (click)=\"expandMore()\">\n                <app-icon\n                    [icon]=\"{\n                        class: 'material-icons',\n                        content: showIndividualItem ? 'keyboard_arrow_down' : 'keyboard_arrow_right'\n                    }\"\n                ></app-icon>\n            </button>\n        </div>\n    </div>\n    <div class=\"list\" *ngIf=\"showIndividualItem || search \" [ngClass]=\"showIndividualItem || search ? 'show' : 'hide'\">\n\n        <div class=\"bar\"></div>\n        <div\n            class=\"item\"\n            *ngFor=\"let item of order.items\"\n            [class.not-match]=\"search && !search_matches[item.id]\"\n        >\n            <div class=\"icon\">\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'local_pizza' }\"></app-icon>\n            </div>\n            <div class=\"item-details\">\n                <div class=\"name\">{{ item.name }}</div>\n                <div\n                    class=\"options\"\n                    *ngIf=\"item_details[item.id]?.amount\"\n                    [matTooltip]=\"item_details[item.id].details\"\n                >\n                    {{ item_details[item.id]?.amount }}\n                    { item_details[item.id]?.amount, plural, =1 { Option } other { Options } }\n                </div>\n                <div class=\"quanity\">x {{ item.amount }}</div>\n            </div>\n            <div class=\"bar\"></div>\n        </div>\n    </div>\n</div>\n","import { Component, Input, OnChanges, OnInit, SimpleChanges } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { combineLatest, Subject } from 'rxjs';\nimport { filter, first, map } from 'rxjs/operators';\n\nimport { CateringOrder } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { Building } from '@mckinsey-converge/data-common';\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { CateringCategory } from '@mckinsey-converge/data-common';\nimport { OrderDetailsModalComponent } from '../overlays/order-details-modal/order-details-modal.component';\nimport { SpacesService } from '@mckinsey-converge/data-common';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\n\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n\n@Component({\n    selector: 'a-catering-orders',\n    templateUrl: './orders.component.html',\n    styleUrls: ['./orders.component.scss'],\n})\nexport class CateringOrdersComponent extends BaseDirective implements OnInit, OnChanges {\n    /** Search filter string */\n    @Input() public search: string = '';\n    /** Currently selected date */\n    @Input() public date: number;\n    /** Type of order to show */\n    @Input() public type: '' | 'Pantry' | 'Kitchen';\n    @Input() public orderDetailsExpanded: boolean;\n    /** Subject holding the value of the search */\n    public readonly search$ = new Subject<string>();\n    /** List of catering orders for the selected date */\n    public orders = this._booking_state_service.filtered.pipe(\n        map((bookings) => {\n            let list: CateringOrder[] = [];\n            bookings.forEach((booking, i) => {\n                const catering = [...booking.catering]\n                    .map((order) => new CateringOrder({\n                        ...order,\n                        booking_date: booking.date,\n                        booking\n                    }));\n                list = list.concat(catering);\n            });\n            list.sort((a, b) => a.booking_date - b.booking_date);\n            return list;\n        })\n    );\n    /** List of catering orders for the selected date */\n    public filtered_orders = combineLatest([this.search$, this.orders]).pipe(\n        map(([search, orders]) => this.filter(orders || [], search || ''))\n    );\n\n    public display_orders: CateringOrder[] = [];\n    /** Whether catering orders are loading */\n    public readonly loading = this._booking_state_service.loading;\n\n    /** Display string for the currenly selected date */\n    public get date_display(): string {\n        // R--- check if input can be changed since there is isSameDate calculations\n        const date = new DateTZ({date: this.date});\n        const now = DateNow(new Date())\n        return now.isSameDate(date, 'day') ? 'Today' : date.formatDate('dd MMM yyyy');\n    }\n\n    /** Active building */\n    public get building(): Building {\n        return this._org.building;\n    }\n\n    constructor(\n        private _spaces: SpacesService,\n        private _booking_state_service: BookingStateService,\n        private _org: OrganisationService,\n        private _route: ActivatedRoute,\n        private _dialog: MatDialog\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._spaces.initialised.pipe(first((_) => _)).subscribe(() => {\n            this._booking_state_service.startPollingEveryFiveMin();\n            this.subscription(\n                'building',\n                this._org\n                    .listen('active_building')\n                    .pipe(filter((bld) => !!bld))\n                    .subscribe(() => {\n                        this._booking_state_service.setZone(this._org.building.id);\n                    })\n            );\n            this.subscription(\n                'orders',\n                this.filtered_orders.subscribe((orders) => {\n                    this.display_orders = orders.sort((a ,b) => {\n                        const date = new DateTZ({date: a.booking.date}).formatDate('yyyy/MM/dd');\n\n                        return Date.parse(`${date} ${a.deliver_at_time.slice(0, -2)} ${a.deliver_at_time.slice(-2)}`) - Date.parse(`${date} ${b.deliver_at_time.slice(0, -2)} ${b.deliver_at_time.slice(-2)}`)\n                    }\n                )})\n            )\n            this.subscription(\n                'route.query',\n                this._route.queryParamMap.subscribe((params) => {\n                    /* istanbul ignore else */\n                    if (params.has('view')) {\n                        const view_id = params.get('view');\n                        const details = localStorage.getItem('CONCIERGE.view_order');\n                        const booking_details = localStorage.getItem('CONCIERGE.view_booking');\n                        /* istanbul ignore else */\n                        if (details) {\n                            const booking = new Booking(JSON.parse(booking_details));\n                            const order = new CateringOrder(JSON.parse(details));\n                            order.booking = booking;\n                            this.viewOrderDetails(order);\n                            localStorage.removeItem('CONCIERGE.view_order');\n                            localStorage.removeItem('CONCIERGE.view_booking');\n                        }\n                    }\n                })\n            );\n            this.search$.next(this.search);\n        });\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.search || changes.type) {\n            this.search$.next(this.search);\n        }\n    }\n\n    /* istanbul ignore next */\n    public trackByFn(index: number, order: CateringOrder) {\n        return order ? order.id : index;\n    }\n\n    /** Open modal to view catering order details */\n    public viewOrderDetails(order: CateringOrder): void {\n        this._dialog.open(OrderDetailsModalComponent, {\n            maxHeight: '95vh',\n            maxWidth: '95vw',\n            data: {\n                order: order,\n                booking: order.booking\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n    }\n\n    /**\n     * Filter list to find matching items\n     * @param list List of orders to filter\n     * @param search Filter string\n     */\n    private filter(list: CateringOrder[], search: string = '') {\n        const filter = search.toLowerCase();\n        return list.filter((order) => {\n            return (\n                (!this.type ||\n                    (this.type === 'Pantry' && order.pantry) ||\n                    (this.type === 'Kitchen' && order.kitchen)) &&\n                order.items.find(\n                    (item: CateringCategory) =>\n                        item.name.toLowerCase().indexOf(filter) >= 0 ||\n                        (item.items &&\n                            item.items.find((sub_item: CateringCategory) => {\n                                return (\n                                    sub_item.name.toLowerCase().indexOf(filter) >= 0 ||\n                                    (sub_item.items &&\n                                        sub_item.items.find((sub_sub_item) => {\n                                            return (\n                                                sub_sub_item.name.toLowerCase().indexOf(filter) >= 0\n                                            );\n                                        }))\n                                );\n                            }))\n                )\n            );\n        });\n    }\n}\n","<div class=\"loader\" *ngIf=\"loading | async\">\n    <mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>\n</div>\n<div class=\"heading\">\n    <div class=\"icon\"></div>\n    <div class=\"time\">Time</div>\n    <div class=\"location\">Location</div>\n    <div class=\"host\">Host</div>\n    <div class=\"types\">Package Types</div>\n    <div class=\"state\">Status</div>\n</div>\n<div class=\"list\">\n    <ng-container *ngIf=\"display_orders.length; else empty_state\">\n        <div class=\"top-row\"></div>\n        <cdk-virtual-scroll-viewport [itemSize]=\"display_orders.length\" class=\"viewport\">\n            <ng-container *cdkVirtualFor=\"let order of display_orders; trackBy: trackByFn\">\n                <a-catering-orders-item [order]=\"order\" [search]=\"search\"\n                                        [show_items]=\"orderDetailsExpanded\"></a-catering-orders-item>\n            </ng-container>\n        </cdk-virtual-scroll-viewport>\n    </ng-container>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No catering orders for {{ date_display }}</div>\n    </div>\n</ng-template>\n","import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA, MatDialogRef, MatDialog } from '@angular/material/dialog';\nimport { UploadManager, Amazon } from '@acaprojects/ngx-uploads';\n\nimport { CateringCategory } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { DialogEvent } from '@mckinsey-converge/base';\n\nimport * as blobUtil from 'blob-util';\nimport { CateringCategoriesService } from '@mckinsey-converge/data-common';\nimport { ConfirmModalComponent, CONFIRM_METADATA } from '@mckinsey-converge/legacy-overlays';\n\nexport interface CateringCategoryModalData {\n    /** Category to edit */\n    category: CateringCategory;\n}\n\n@Component({\n    selector: 'a-catering-category-modal',\n    templateUrl: './category-modal.component.html',\n    styleUrls: ['./category-modal.component.scss'],\n})\nexport class CateringCategoryModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form controls for editing category */\n    public form: FormGroup;\n    /** Display string for current loading state */\n    public loading: string;\n    /** Whether image is being uploaded */\n    public uploading: boolean;\n\n    public get category(): CateringCategory {\n        return this._data.category;\n    }\n\n    public get image(): string {\n        return this.form.controls.image_path.value;\n    }\n\n    public disabled: boolean = true\n\n    constructor(\n        private _service: ApplicationService,\n        private _menu_categories: CateringCategoriesService,\n        private _upload_manager: UploadManager,\n        private _dialog: MatDialog,\n        private _dialog_ref: MatDialogRef<CateringCategoryModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: CateringCategoryModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.form = new FormGroup({\n            name: new FormControl(this.category.name, [Validators.required]),\n            description: new FormControl(this.category.description),\n            image_path: new FormControl(this.category.image_path),\n        });\n\n        if (!this.category.id) {         \n            this.disabled = false\n        } else {\n            this.form.valueChanges.subscribe(val => {\n                for(let key of Object.keys(val)){\n                    if(this.category[key] !== val[key]){\n                        this.disabled = false\n                        return\n                    }\n                    this.disabled = true\n                }\n            });\n        }\n\n    }\n\n    public delete() {\n        const ref = this._dialog.open(ConfirmModalComponent, {\n            ...CONFIRM_METADATA,\n            data: {\n                title: `Delete Category`,\n                content: `Are you sure you want to delete this Category? Deleting it will also remove all it's children`,\n                icon: { type: 'icon', class: 'material-icons', content: 'delete' },\n                action: 'Ok',\n            },\n            autoFocus: false,\n      backdropClass: 'mck-modal-backdrop',\n        });\n        ref.componentInstance.event.subscribe(async (event: DialogEvent) => {\n            /* istanbul ignore else */\n            if (event.reason === 'done') {\n                ref.componentInstance.loading = `Deleting Category...`;\n                let e = null;\n                await this._menu_categories.delete(this.category.id).catch((err) => e === err);\n                ref.close();\n                if (!e) {\n                    this._service.set('DELETED.menu', this.category.id);\n                    this._dialog_ref.close();\n                }\n            }\n        });\n    }\n\n    public submit() {\n        this.form.markAllAsTouched();\n        /* istanbul ignore else */\n        if (this.form.valid) {\n            const category = new CateringCategory(this.category);\n            const data = { ...category.toJSON(), ...this.form.value };\n            const request = category.id\n                ? this._menu_categories.update(category.id, data)\n                : this._menu_categories.add(data);\n            request.then(\n                (item) => {\n                    (item as any).items = category.items\n                    this.event.emit({ reason: 'done', metadata: item });\n                    this._dialog_ref.close();\n                },\n                (err) =>\n                    this._service.notifyError(\n                        `Error ${this.category.id ? 'updating' : 'creating'} category. Error: ${\n                            err.message || err\n                        }`\n                    )\n            );\n        }\n    }\n\n    /** Upload the image to the cloud */\n    public uploadImage(event) {\n        /* istanbul ignore else */\n        if (event && event.target && event.target.files) {\n            const files: FileList = event.target.files;\n            /* istanbul ignore else */\n            if (files.length) {\n                const fileReader = new FileReader();\n                fileReader.addEventListener('loadend', (e: any) => {\n                    this.uploading = true;\n                    const arrayBuffer = e.target.result;\n                    const blob = blobUtil.arrayBufferToBlob(arrayBuffer, 'image/png');\n                    this._upload_manager.upload([blob], { file_name: files[0].name });\n                    const upload = this._upload_manager.uploads[\n                        this._upload_manager.uploads.length - 1\n                    ];\n                    this.interval('upload', () => {\n                        /* istanbul ignore else */\n                        if (upload.complete || upload.error) {\n                            /* istanbul ignore else */\n                            if (upload.access_url && upload.complete) {\n                                this.form.controls.image_path.setValue(upload.access_url);\n                            }\n                            this.uploading = false;\n                            this.clearInterval('upload');\n                        }\n                    });\n                });\n                fileReader.readAsArrayBuffer(files[0]);\n            }\n        }\n    }\n}\n","<header>\n    <div class=\"heading\">{{ category.id ? 'Edit' : 'Add' }} category</div>\n    <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main *ngIf=\"!loading; else load_state\">\n        <form [formGroup]=\"form\" *ngIf=\"form\">\n            <div class=\"field\">\n                <div\n                    class=\"image\"\n                    [style.background]=\"\n                        'linear-gradient(rgba(0,0,0,.35),rgba(0,0,0,.35)), url(' + image + ')'\n                            | safe: 'style'\n                    \"\n                >\n                    <app-icon\n                        *ngIf=\"!uploading\"\n                        [icon]=\"{ class: 'material-icons', content: 'cloud_upload' }\"\n                    ></app-icon>\n                    <mat-spinner *ngIf=\"uploading\" diameter=\"48\"></mat-spinner>\n                    <input type=\"file\" (change)=\"uploadImage($event)\" />\n                </div>\n            </div>\n            <div class=\"field\">\n                <label\n                    for=\"name\"\n                    [class.error]=\"form.controls.name.errors && form.controls.name.touched\"\n                    >Name<span>*</span></label\n                >\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"name\"\n                        placeholder=\"Category Name\"\n                        formControlName=\"name\"\n                    />\n                    <mat-error>A valid name is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"description\">Description</label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"description\"\n                        placeholder=\"Category Description\"\n                        formControlName=\"description\"\n                    ></textarea>\n                </mat-form-field>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button *ngIf=\"category.id\" name=\"delete\" [class.error]=\"true\" (click)=\"delete()\">Delete</button>\n        <button mat-button name=\"save\" [disabled]=\"uploading || disabled\" (click)=\"submit()\">Save</button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main>\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </main>\n</ng-template>\n","import { Component, OnInit, Inject, EventEmitter, Output } from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { MatDialogRef, MAT_DIALOG_DATA, MatDialog } from '@angular/material/dialog';\nimport { UploadManager } from '@acaprojects/ngx-uploads';\n\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { CateringCategory } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { DialogEvent, Identity } from '@mckinsey-converge/base';\n\nimport * as blobUtil from 'blob-util';\nimport { CateringCategoriesService } from '@mckinsey-converge/data-common';\nimport {\n    ConfirmModalComponent,\n    CONFIRM_METADATA,\n} from '@mckinsey-converge/legacy-overlays';\n\nexport interface CateringGroupModalData {\n    group: CateringCategory;\n    parent: CateringCategory;\n}\n\n@Component({\n    selector: 'a-catering-group-modal',\n    templateUrl: './group-modal.component.html',\n    styleUrls: ['./group-modal.component.scss'],\n})\nexport class CateringGroupModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form controls for editing category */\n    public form: FormGroup;\n    /** Display string for current loading state */\n    public loading: string;\n    /** Whether image is being uploaded */\n    public uploading: boolean;\n    /** List of available catering types */\n    public readonly types: Identity[] = [\n        { id: 'kitchen', name: 'Kitchen' },\n        { id: 'pantry', name: 'Pantry' },\n        { id: 'none', name: 'Other' },\n    ];\n\n    /** Category being edit/created */\n    public get category(): CateringCategory {\n        return this._data.group;\n    }\n\n    /** Parent category of the catergory being created/edited */\n    public get parent(): CateringCategory {\n        return this._data.parent;\n    }\n\n    /** Image URL for the category */\n    public get image(): string {\n        return this.form.controls.image_path.value;\n    }\n\n    /** Whether category is a package */\n    public get package(): boolean {\n        return this.form.controls.package.value;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _menu_categories: CateringCategoriesService,\n        private _upload_manager: UploadManager,\n        private _dialog: MatDialog,\n        private _dialog_ref: MatDialogRef<CateringGroupModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: CateringGroupModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        const price = this.category.price\n        this.form = new FormGroup({\n            name: new FormControl(this.category.name, [Validators.required]),\n            description: new FormControl(this.category.description),\n            image_path: new FormControl(this.category.image_path),\n            catering_type: new FormControl(this.category.catering_type, [Validators.required]),\n            package: new FormControl(this.category.package || false),\n            must_select: new FormControl(this.category.must_select),\n            unit_price: new FormControl(price),\n            minimum_quantity: new FormControl(this.category.minimum_quantity),\n            maximum_quantity: new FormControl(this.category.maximum_quantity),\n            order_anytime: new FormControl(this.category.order_anytime),\n            out_of_stock: new FormControl(this.category.out_of_stock),\n        });\n    }\n\n    public delete() {\n        const ref = this._dialog.open(ConfirmModalComponent, {\n            ...CONFIRM_METADATA,\n            data: {\n                title: `Delete ${this.category.package ? 'Package' : 'Sub-Category'}`,\n                content: `Are you sure you want to delete this ${\n                    this.category.package ? 'Package' : 'Sub-Category'\n                }? Deleting it will also remove all it's children`,\n                icon: { type: 'icon', class: 'material-icons', content: 'delete' },\n                action: 'Ok',\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n        ref.componentInstance.event.subscribe(async (event: DialogEvent) => {\n            /* istanbul ignore else */\n            if (event.reason === 'done') {\n                ref.componentInstance.loading = `Deleting ${\n                    this.category.package ? 'Package' : 'Sub-Category'\n                }...`;\n                let e = null;\n                await this._menu_categories.delete(this.category.id).catch((err) => e === err);\n                ref.close();\n                if (!e) {\n                    this._service.set('DELETED.menu', this.category.id);\n                    this._dialog_ref.close();\n                }\n            }\n        });\n    }\n\n    public submit() {\n        this.form.markAllAsTouched();\n        /* istanbul ignore else */\n        if (this.form.valid) {\n            const data = {\n                ...(this.category instanceof CateringCategory\n                    ? this.category.toJSON()\n                    : this.category),\n                ...this.form.value,\n                parent_categories: [this.parent.id],\n            };\n            data.price = data.unit_price;\n            const request = this.category.id\n                ? this._menu_categories.update(this.category.id, data)\n                : this._menu_categories.add(data);\n            request.then(\n                (item) => {\n                    (item as any).items = this.category.items\n                    this.event.emit({ reason: 'done', metadata: new CateringCategory(item) });\n                    this._dialog_ref.close();\n                },\n                (err) =>\n                    this._service.notifyError(\n                        `Error ${this.category.id ? 'updating' : 'creating'} category. Error: ${\n                            err.message || err\n                        }`\n                    )\n            );\n        }\n    }\n\n    /** Upload the image to the cloud */\n    public uploadImage(event) {\n        /* istanbul ignore else */\n        if (event && event.target && event.target.files) {\n            const files: FileList = event.target.files;\n            /* istanbul ignore else */\n            if (files.length) {\n                const fileReader = new FileReader();\n                fileReader.addEventListener('loadend', (e: any) => {\n                    this.uploading = true;\n                    const arrayBuffer = e.target.result;\n                    const blob = blobUtil.arrayBufferToBlob(arrayBuffer, 'image/png');\n                    this._upload_manager.upload([blob], { file_name: files[0].name });\n                    const upload = this._upload_manager.uploads[\n                        this._upload_manager.uploads.length - 1\n                    ];\n                    this.interval('upload', () => {\n                        /* istanbul ignore else */\n                        if (upload.complete || upload.error) {\n                            /* istanbul ignore else */\n                            if (upload.access_url && upload.complete) {\n                                this.form.controls.image_path.setValue(upload.access_url);\n                            }\n                            this.uploading = false;\n                            this.clearInterval('upload');\n                        }\n                    });\n                });\n                fileReader.readAsArrayBuffer(files[0]);\n            }\n        }\n    }\n}\n","<header>\n    <div class=\"heading\">\n        {{ category.id ? 'Edit' : 'Add' }} {{ package ? 'package' : 'sub-category' }}\n    </div>\n    <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main *ngIf=\"!loading; else load_state\">\n        <form [formGroup]=\"form\">\n            <div class=\"field\">\n                <div\n                    class=\"image\"\n                    [style.background]=\"\n                        'linear-gradient(rgba(0,0,0,.35),rgba(0,0,0,.35)), url(' + image + ')'\n                            | safe: 'style'\n                    \"\n                >\n                    <app-icon\n                        *ngIf=\"!uploading\"\n                        [icon]=\"{ class: 'material-icons', content: 'cloud_upload' }\"\n                    ></app-icon>\n                    <mat-spinner *ngIf=\"uploading\" diameter=\"48\"></mat-spinner>\n                    <input type=\"file\" (change)=\"uploadImage($event)\" />\n                </div>\n            </div>\n            <div class=\"field padded\">\n                <label for=\"name\">Parent Category</label>\n                <div class=\"value\">{{ parent.name }}</div>\n            </div>\n            <div class=\"field padded\">\n                <mat-checkbox name=\"package\" formControlName=\"package\">Package</mat-checkbox>\n            </div>\n            <div class=\"field\">\n                <label\n                    for=\"name\"\n                    [class.error]=\"form.controls.name.errors && form.controls.name.touched\"\n                    >Name<span>*</span></label\n                >\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"name\"\n                        [placeholder]=\"(form.value.package ? 'Package' : 'Sub-category') + ' Name'\"\n                        formControlName=\"name\"\n                    />\n                    <mat-error>A valid name is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label\n                    for=\"type\"\n                    [class.error]=\"\n                        form.controls.catering_type.errors && form.controls.catering_type.touched\n                    \"\n                    >Type<span>*</span></label\n                >\n                <mat-form-field appearance=\"outline\">\n                    <mat-select\n                        name=\"type\"\n                        formControlName=\"catering_type\"\n                        placeholder=\"Select type\"\n                    >\n                        <mat-option *ngFor=\"let type of types\" [value]=\"type.id\">\n                            {{ type.name }}\n                        </mat-option>\n                    </mat-select>\n                    <mat-error>Type is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"description\">Description</label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"description\"\n                        [placeholder]=\"(form.value.package ? 'Package' : 'Sub-category') + ' Description'\"\n                        formControlName=\"description\"\n                    ></textarea>\n                </mat-form-field>\n            </div>\n            <ng-container *ngIf=\"package\">\n                <div class=\"field padded\">\n                    <mat-checkbox formControlName=\"out_of_stock\">Out of Stock</mat-checkbox>\n                </div>\n                <div class=\"field padded\">\n                    <mat-checkbox formControlName=\"order_anytime\">Can order anytime</mat-checkbox>\n                </div>\n                <div class=\"field\">\n                    <label for=\"unit-price\">Unit Price</label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"unit-price\"\n                            type=\"number\"\n                            placeholder=\"Price for one unit of the item without decimal places\"\n                            formControlName=\"unit_price\"\n                            numbersOnly\n                        />\n                    </mat-form-field>\n                </div>\n            </ng-container>\n            <div class=\"field\">\n                <label for=\"must-select\"\n                    >Items to select from {{ package ? 'package' : 'sub-category' }}</label\n                >\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"must-select\"\n                        type=\"number\"\n                        placeholder=\"Must select X items from grouping\"\n                        formControlName=\"must_select\"\n                        numbersOnly\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"min-quanity\">Minimum Quantity</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"min-quanity\"\n                        type=\"number\"\n                        placeholder=\"Minimum Quantity\"\n                        formControlName=\"minimum_quantity\"\n                        numbersOnly\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"max-quanity\">Maximum Quantity</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"max-quanity\"\n                        type=\"number\"\n                        placeholder=\"Maximum Quantity\"\n                        formControlName=\"maximum_quantity\"\n                        numbersOnly\n                    />\n                </mat-form-field>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button name=\"delete\" *ngIf=\"category.id\" [class.error]=\"true\" (click)=\"delete()\">Delete</button>\n        <button mat-button name=\"save\" [disabled]=\"uploading\" (click)=\"submit()\">Save</button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main>\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </main>\n</ng-template>\n","import { Component, EventEmitter, Inject, OnInit, Output } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material/dialog';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { CateringItem } from '@mckinsey-converge/data-common';\nimport { CateringCategory } from '@mckinsey-converge/data-common';\nimport { DialogEvent, Identity } from '@mckinsey-converge/base';\nimport { CateringItemsService } from '@mckinsey-converge/data-common';\nimport {\n    CONFIRM_METADATA, ConfirmModalComponent,\n} from '@mckinsey-converge/legacy-overlays';\nimport { mergeCateringItemWithFormData } from '@mckinsey-converge/data-common';\n\nexport interface CateringItemModalData {\n    item: CateringItem;\n    parent: CateringCategory;\n}\n\n@Component({\n    selector: 'a-catering-item-modal',\n    templateUrl: './item-modal.component.html',\n    styleUrls: ['./item-modal.component.scss'],\n})\nexport class CateringItemModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form controls for editing category */\n    public form: FormGroup;\n    /** Display string for current loading state */\n    public loading: string;\n    /** Whether image is being uploaded */\n    public uploading: boolean;\n    /** List of available catering types */\n    public readonly types: Identity[] = [\n        { id: 'kitchen', name: 'Kitchen' },\n        { id: 'pantry', name: 'Pantry' },\n    ];\n\n    /** Category being edit/created */\n    public get item(): CateringItem {\n        return this._data.item;\n    }\n\n    /** Parent category of the catergory being created/edited */\n    public get parent(): CateringCategory {\n        return this._data.parent;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _menu_items: CateringItemsService,\n        private _dialog: MatDialog,\n        private _dialog_ref: MatDialogRef<CateringItemModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: CateringItemModalData,\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        const price = this.item.price\n        this.form = new FormGroup({\n            name: new FormControl(this.item.name, [Validators.required]),\n            description: new FormControl(this.item.description),\n            catering_type: new FormControl(this.item.catering_type, [Validators.required]),\n            supplier_cost: new FormControl(this.item.supplier_cost),\n            unit_price: new FormControl(price),\n            minimum_quantity: new FormControl(this.item.minimum_quantity),\n            maximum_quantity: new FormControl(this.item.maximum_quantity),\n            order_anytime: new FormControl(this.item.order_anytime),\n            out_of_stock: new FormControl(this.item.out_of_stock),\n            allergy: new FormControl(this.item.allergy),\n            parent_categories: new FormControl([this._data.parent.id]),\n        });\n    }\n\n    public delete() {\n        const ref = this._dialog.open(ConfirmModalComponent, {\n            ...CONFIRM_METADATA,\n            data: {\n                title: `Delete Item`,\n                content: `Are you sure you want to delete this item?`,\n                icon: { type: 'icon', class: 'material-icons', content: 'delete' },\n                action: 'Ok',\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n        ref.componentInstance.event.subscribe(async (event: DialogEvent) => {\n            /* istanbul ignore else */\n            if (event.reason === 'done') {\n                ref.componentInstance.loading = `Deleting item...`;\n                let e = null;\n                await this._menu_items.delete(this.item.id).catch((err) => e === err);\n                ref.close();\n                if (!e) {\n                    this._service.set('DELETED.menu', this.item.id);\n                    this._dialog_ref.close();\n                }\n            }\n        });\n    }\n\n    public submit() {\n        this.form.markAllAsTouched();\n        /* istanbul ignore else */\n        if (this.form.valid) {\n            const data = mergeCateringItemWithFormData(this.item, this.form.value).toJSON();\n            const request = this.item.id\n                ? this._menu_items.update(this.item.id, data)\n                : this._menu_items.add(data);\n            request.then(\n                (item) => {\n                    this.event.emit({ reason: 'done', metadata: item });\n                    this._dialog_ref.close();\n                },\n                (err) =>\n                    this._service.notifyError(\n                        `Error ${this.item.id ? 'updating' : 'creating'} item. Error: ${\n                            err.message || err\n                        }`,\n                    ),\n            );\n        }\n    }\n}\n","<header>\n    <div class=\"heading\">{{ item.id ? 'Edit' : 'Add' }} catering item</div>\n    <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main *ngIf=\"!loading; else load_state\">\n        <form [formGroup]=\"form\">\n            <div class=\"field padded\">\n                <label for=\"name\">Parent Category</label>\n                <div class=\"value\">{{ parent.name }}</div>\n            </div>\n            <div class=\"field\">\n                <label\n                    for=\"name\"\n                    [class.error]=\"form.controls.name.errors && form.controls.name.touched\"\n                    >Name<span>*</span></label\n                >\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"name\"\n                        placeholder=\"Item Name\"\n                        formControlName=\"name\"\n                    />\n                    <mat-error>A valid name is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label\n                    for=\"type\"\n                    [class.error]=\"\n                        form.controls.catering_type.errors && form.controls.catering_type.touched\n                    \"\n                    >Type<span>*</span></label\n                >\n                <mat-form-field appearance=\"outline\">\n                    <mat-select\n                        name=\"type\"\n                        formControlName=\"catering_type\"\n                        placeholder=\"Select type\"\n                    >\n                        <mat-option *ngFor=\"let type of types\" [value]=\"type.id\">\n                            {{ type.name }}\n                        </mat-option>\n                    </mat-select>\n                    <mat-error>Type is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"description\">Description</label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"description\"\n                        placeholder=\"Item Description\"\n                        formControlName=\"description\"\n                    ></textarea>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"allergy\">Allegen Information</label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"allergy\"\n                        placeholder=\"Allergy details about the item\"\n                        formControlName=\"allergy\"\n                    ></textarea>\n                </mat-form-field>\n            </div>\n            <div class=\"field padded\">\n                <mat-checkbox formControlName=\"out_of_stock\">Out of Stock</mat-checkbox>\n            </div>\n            <div class=\"field padded\">\n                <mat-checkbox formControlName=\"order_anytime\">Can order anytime</mat-checkbox>\n            </div>\n            <div class=\"field\">\n                <label for=\"supplier-price\">Supplier Price</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"supplier-price\"\n                        type=\"number\"\n                        placeholder=\"Price for one unit of the item from the supplier\"\n                        formControlName=\"supplier_cost\"\n                        numbersOnly\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"unit-price\">Unit Price</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"unit-price\"\n                        type=\"number\"\n                        placeholder=\"Price for one unit of the item without decimal places\"\n                        formControlName=\"unit_price\"\n                        numbersOnly\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"min-quanity\">Minimum Quantity</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"min-quanity\"\n                        type=\"number\"\n                        placeholder=\"Minimum Quantity\"\n                        formControlName=\"minimum_quantity\"\n                        numbersOnly\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label for=\"max-quanity\">Maximum Quantity</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"max-quanity\"\n                        type=\"number\"\n                        placeholder=\"Maximum Quantity\"\n                        formControlName=\"maximum_quantity\"\n                        numbersOnly\n                    />\n                </mat-form-field>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button name=\"delete\" *ngIf=\"item.id\" [class.error]=\"true\" (click)=\"delete()\">Delete</button>\n        <button mat-button name=\"save\" [disabled]=\"uploading\" (click)=\"submit()\">Save</button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main>\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </main>\n</ng-template>\n","import { Component, Input } from '@angular/core';\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { getTimezoneOffsetString } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'order-booking-details',\n    templateUrl: './booking-details.component.html',\n    styleUrls: ['./booking-details.component.scss'],\n})\nexport class OrderBookingDetailsComponent {\n    /** Email of the order space */\n    @Input() public space: Space;\n    /** Booking details to display */\n    @Input() public booking: Booking;\n\n    public get timezone() {\n        return getTimezoneOffsetString(localStorage.getItem('CONCIERGE.timezone'));\n    }\n\n    /** Display startDateTZ and endDateTZ time only time */\n    public get start_and_duration_time() {\n        const end_ = this.booking.startDateTz.addValue({minutes: this.booking.duration});\n        return `${this.start_time} - ${end_.formatDate('h:mm a')}`;\n    }\n\n    /** Display startDateTZ time only time */\n    public get start_time() {\n        return `${this.booking.startDateTz.formatDate('h:mm a')}`;\n    }\n\n    /** Store booking details to be used in another component */\n    public storeBooking() {\n        localStorage.setItem('CONCIERGE.view_booking', JSON.stringify(this.booking.toJSON()));\n        localStorage.setItem('CONCIERGE.view_booking_space', JSON.stringify(this.space.toJSON()));\n        localStorage.setItem('CONCIERGE.date', `${this.booking.startDateTz.ms}`);\n        localStorage.setItem('CONCIERGE.timezone', `${this.booking.startDateTz.building_tz}`);\n    }\n}\n","<div class=\"heading\">\n    Meeting Details\n</div>\n<div class=\"content\">\n    <div class=\"field\">\n        <label for=\"host\">Host:</label>\n        <div class=\"value\" name=\"host\">\n            {{ booking.organiser?.name }}\n        </div>\n    </div>\n    <div class=\"field\">\n        <label for=\"space\">Room:</label>\n        <div class=\"value\" name=\"space\">\n            {{ space?.name }}\n        </div>\n    </div>\n    <div class=\"field\">\n        <label for=\"period\">Period:</label>\n        <div class=\"value\" name=\"period\">\n            {{ start_and_duration_time }}\n        </div>\n    </div>\n    <div class=\"field\">\n        <label for=\"attendees\">Attendees:</label>\n        <div class=\"value\" name=\"attendees\">\n            {{ booking.attendees?.length || '0' }}({{ booking.expected_attendees[space?.email] || 0 }} expected)\n        </div>\n    </div>\n</div>\n<a\n    class=\"footer\"\n    name=\"view-meeting\"\n    button\n    mat-button\n    [routerLink]=\"['/day-view', space?.level.id]\"\n    [queryParams]=\"{ view: booking.id.slice(0, 10) }\"\n    (click)=\"storeBooking()\"\n    mat-dialog-close\n>\n    View on Day View\n</a>\n","import { Component, Input } from '@angular/core';\n\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { CateringOrder } from '@mckinsey-converge/data-common';\nimport { CateringCategory } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { BookingsService } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'order-details-items',\n    templateUrl: './items.component.html',\n    styleUrls: ['./items.component.scss'],\n})\nexport class OrderDetailsItemsComponent extends BaseDirective {\n    /** Booking details to display */\n    @Input() public booking: Booking;\n    /** Catering order to display notes for */\n    @Input() public order: CateringOrder;\n    /** Whether order is being edited */\n    public editing: boolean;\n    /** Whether order is being updated */\n    public loading: boolean;\n\n    /** List of items in the order */\n    public get items(): CateringCategory[] {\n        return this.order.items as any;\n    }\n\n    constructor(\n        private _service: ApplicationService, \n        private _bookings: BookingsService,\n        private _booking_state_service: BookingStateService,) {\n        super();\n    }\n\n    public editOrder() {\n        this.editing = true;\n    }\n\n    /** Handle changes to catering order */\n    public async handleOrderEvent(order: CateringOrder) {\n        /* istanbul ignore else */\n        if (order) {\n            const orders = [...this.booking.catering];\n            const index = orders.findIndex((an_order) => order.id === an_order.id);\n            if (index < 0) {\n                orders.push(order);\n            } else {\n                orders.splice(index, 1, order);\n            }\n            this.loading = true;\n            const new_booking = new Booking({ ...this.booking.toJSON(), catering: orders });\n            const booking = await this._bookings\n                .save(new_booking)\n                .catch((err) =>\n                    this._service.notifyError(\n                        `Error unable to update order. Error: ${err.message || err}`\n                    )\n                );\n            if (booking) {\n                this._booking_state_service.replace(booking);\n                this.booking = booking;\n                this.order = order;\n                this.editing = false;\n            }\n            this.loading = false;\n        }\n    }\n}\n","<div class=\"heading\">\n    {{ editing ? 'Edit Order' : 'Order Details' }}\n</div>\n<div class=\"content padded\" *ngIf=\"!editing; else edit_state\">\n    <ng-container *ngIf=\"order && items && items.length; else empty_state\">\n        <div class=\"item\" *ngFor=\"let item of items\">\n            <div class=\"details\">\n                <div class=\"name\">{{ item.name }}</div>\n                <div class=\"amount\">x{{ item.amount }}</div>\n            </div>\n            <ng-container *ngIf=\"item.items\">\n                <ng-container *ngFor=\"let sub_item of item.items\">\n                    <div class=\"sub-item\" *ngIf=\"sub_item.amount || sub_item.items.length\">\n                        <div class=\"name\">{{ sub_item.name }}</div>\n                        <ng-container *ngIf=\"sub_item.items\">\n                            <ng-container *ngFor=\"let sub_sub_item of sub_item.items\">\n                                <div class=\"sub-item\" *ngIf=\"sub_sub_item.amount\">\n                                    <div class=\"name\">{{ sub_sub_item.name }}</div>\n                                </div>\n                            </ng-container>\n                        </ng-container>\n                    </div>\n                </ng-container>\n            </ng-container>\n        </div>\n    </ng-container>\n</div>\n<ng-template #edit_state>\n    <div class=\"content\">\n        <a-catering-order-details\n            *ngIf=\"!loading; else load_state\"\n            [space_list]=\"[booking.space]\"\n            [order]=\"this.order\"\n            [dateTz]=\"booking.startDateTz\"\n            [duration]=\"booking.duration\"\n            [all_day]=\"booking.all_day\"\n            [hide_details]=\"true\"\n            [compact]=\"true\"\n            (event)=\"$event ? handleOrderEvent($event) : (editing = false)\"\n        ></a-catering-order-details>\n    </div>\n</ng-template>\n<button class=\"footer\" name=\"edit\" *ngIf=\"!editing\" mat-button (click)=\"editOrder()\">\n    Edit Order\n</button>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">\n            No items in order\n        </div>\n    </div>\n</ng-template>\n<ng-template #load_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <mat-spinner diameter=\"32\"></mat-spinner>\n        </div>\n        <div class=\"text\">\n            Updating order\n        </div>\n    </div>\n</ng-template>\n","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\n\nimport { CateringOrder } from '@mckinsey-converge/data-common';\nimport { Booking } from '@mckinsey-converge/data-common';\n\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { UsersService, BookingNote } from '@mckinsey-converge/data-common';\nimport { BookingsService } from '@mckinsey-converge/data-common';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'order-details-notes',\n    templateUrl: './messages.component.html',\n    styleUrls: ['./messages.component.scss'],\n})\nexport class OrderDetailsNotesComponent implements OnInit {\n    /** Booking details to display */\n    @Input() public booking: Booking;\n    /** Catering order to display notes for */\n    @Input() public order: CateringOrder;\n    /** Emitter for changes to the active booking */\n    @Output() public bookingChange = new EventEmitter<Booking>();\n    /** Contents of the new private note */\n    public new_note: string;\n    /** Whether a note is being added */\n    public loading: boolean;\n\n    /** List of notes for catering order space */\n    public get notes(): BookingNote[] {\n        const notes = this.booking.notes.filter((note) => {\n            return (\n                (note.type === 'catering' || note.type === 'catering-private') &&\n                note.space === this.order.location_id &&\n                (!note.order_id || note.order_id === this.order.id)\n            );\n        });\n        notes.forEach((note) => {\n            // Use the booking timezone to make the note date TZ aware since the native format is not.\n            const date = new DateTZ({date: note.date, is_local_tz: false, building_tz: this.booking.timezone })\n            note.time = date.formatDate('dd MMM, h:mma');\n        });\n        return notes;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _bookings: BookingsService,\n        private _booking_state: BookingStateService,\n        private _users: UsersService\n    ) {}\n\n    ngOnInit(): void {}\n\n    /**\n     * Add note for catering order\n     */\n    public async addNote() {\n        /* istanbul ignore else */\n        if (this.booking && this.new_note) {\n            const user = this._users.current;\n            const notes = this.booking.notes;\n            const now = new DateTZ({ date: Date.now(), is_local_tz: false, building_tz: this.booking.timezone })\n            const date = now.startOfValue('minute');\n            const new_notes = [\n                ...notes,\n                {\n                    type: 'catering-private',\n                    date: date.ms,\n                    author: user.name,\n                    order_id: this.order.id,\n                    space: this.order.location_id,\n                    message: this.new_note,\n                    time: date.formatDate('h:mma'),\n                },\n            ];\n            const pending_booking = new Booking({ ...this.booking.toJSON(), notes: new_notes });\n            this.loading = true;\n            const new_booking: Booking = (await this._bookings\n                .save(pending_booking)\n                .catch((err) => {\n                    this._service.notifyError(\n                        `Failed to add note to order meeting. Error: ${err.message || err}`\n                    );\n                    this.loading = false;\n                    throw err;\n                })) as any;\n            this.booking = new_booking;\n            if (new_booking) {\n                this._booking_state.replace(new_booking);\n            }\n            this.order.booking = new_booking;\n            this.bookingChange.emit(new_booking);\n            this.loading = false;\n            this.new_note = '';\n        }\n    }\n}\n","<div class=\"heading\">\n    Private Notes\n</div>\n<div class=\"content\">\n    <ng-container *ngIf=\"notes && notes.length; else empty_state\">\n        <div class=\"note\" *ngFor=\"let item of notes\">\n            <div class=\"text\">{{ item.message }}</div>\n            <div class=\"details\">\n                <div class=\"author\">{{ item.author }}</div>\n                <div class=\"fill\"></div>\n                <div class=\"time\">{{ item.time }}</div>\n            </div>\n        </div>\n    </ng-container>\n</div>\n<div class=\"footer\">\n    <mat-form-field appearance=\"none\">\n        <input matInput [(ngModel)]=\"new_note\" [disabled]=\"loading\" placeholder=\"Type to add notes\" (keyup.enter)=\"addNote()\"/>\n        <button mat-icon-button matSuffix name=\"add-note\" [disabled]=\"!new_note || loading\" (click)=\"addNote()\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'send' }\"></app-icon>\n        </button>\n    </mat-form-field>\n    <div class=\"loader center\" *ngIf=\"loading\">\n        <mat-spinner diameter=\"32\"></mat-spinner>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">\n            No private notes for order\n        </div>\n    </div>\n</ng-template>\n","import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport { CateringOrder, CateringOrderStatus } from '@mckinsey-converge/data-common';\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { DialogEvent, Identity } from '@mckinsey-converge/base';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { SpacesService } from '@mckinsey-converge/data-common';\n\nimport { BookingsService } from '@mckinsey-converge/data-common';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\nimport { DateTZ, getTimezoneOffsetString } from '@mckinsey-converge/date-tz';\n\nexport interface OrderDetailsModalData {\n    /** Order to display details for */\n    order: CateringOrder;\n    /** Booking associated with catering order */\n    booking: Booking;\n}\n\n@Component({\n    selector: 'a-order-details-modal',\n    templateUrl: './order-details-modal.component.html',\n    styleUrls: ['./order-details-modal.component.scss'],\n})\nexport class OrderDetailsModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Whether status is being updated */\n    public loading: boolean;\n    /** Actively selected status */\n    public active_status: CateringOrderStatus;\n    /** List of available order statuses */\n    public statuses: Identity[] = [\n        { id: 'accepted', name: 'Accepted', icon: { class: 'custom-accepted' }, colour: '#3996B6' },\n        {\n            id: 'preparing',\n            name: 'Preparing',\n            icon: { class: 'custom-preparing' },\n            colour: '#E7536B',\n        },\n        { id: 'ready', name: 'Ready', icon: { class: 'custom-ready' }, colour: '#FFD028' },\n        {\n            id: 'delivered',\n            name: 'Delivered',\n            icon: { class: 'custom-delivered' },\n            colour: '#75BB43',\n        },\n        {\n            id: 'cancelled',\n            name: 'Cancelled',\n            icon: { class: 'custom-cancelled' },\n            colour: '#747474',\n        },\n    ];\n    public booking: Booking;\n\n    /** Order to display */\n    public get order(): CateringOrder {\n        return this._data.order;\n    }\n\n    /** Details for the active status */\n    public get status_details(): Identity {\n        return this.statuses.find((status) => status.id === this.active_status);\n    }\n\n    /** Space associated with the order */\n    public get space(): Space {\n        return this._spaces.find(this._data.order.location_id);\n    }\n\n    /** Details about the delivery time */\n    public get delivery_date(): DateTZ {\n        return this.booking.startDateTz.addValue({ minutes: this._data.order.delivery_time });\n    }\n\n    /** Details about the delivery_at time */\n    public get delivery_at(): string {\n        return this.booking.startDateTz.addValue({ minutes: this._data.order.delivery_time }).formatDate('h:mm a');\n    }\n\n    public get timezone() {\n        return getTimezoneOffsetString(localStorage.getItem('CONCIERGE.timezone'));\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _spaces: SpacesService,\n        private _bookings: BookingsService,\n        private _booking_state_service: BookingStateService,\n        @Inject(MAT_DIALOG_DATA) private _data: OrderDetailsModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.active_status = this._data.order.status;\n        this.booking = new Booking(this._data.booking)\n    }\n\n    /** Update the status of the order in the booking */\n    public async updateStatus(): Promise<void> {\n        const booking = this._data.booking;\n        /* istanbul ignore else */\n        if (booking) {\n            this.loading = true;\n            const catering = [...booking.catering];\n            catering.splice(\n                catering.findIndex((order) => order.id === this._data.order.id),\n                1,\n                new CateringOrder({ ...this._data.order, status: this.active_status })\n            );\n            const new_booking = new Booking({ ...booking.toJSON(), catering });\n            const updated_booking: any = await this._bookings.save(new_booking).catch((err) => {\n                this._service.notifyError(\n                    `Error updating order status. Error: ${err.message || err}`\n                );\n                this.active_status = this._data.order.status;\n            });\n            if (updated_booking) {\n                this._booking_state_service.replace(updated_booking);\n                this.booking = updated_booking;\n            }\n            this.loading = false;\n\n        }\n    }\n}\n","\n<mat-dialog-content>\n    <main>\n        <div class=\"details\">\n            <div class=\"burger-icon\"></div>\n            <div class=\"location\">{{ space?.name }}&nbsp;({{ space?.local_name}})</div>\n            <div class=\"time\">({{delivery_date?.ms | date:'mediumDate':timezone }}) To be delivered at {{ delivery_at }}</div>\n            <div class=\"status\">\n                <mat-form-field\n                    class=\"rounded visible\"\n                    appearance=\"outline\"\n                    *ngIf=\"statuses && statuses.length > 1\"\n                >\n                    <mat-select\n                        #select\n                        [(value)]=\"active_status\"\n                        (valueChange)=\"updateStatus()\"\n                        placeholder=\"New Order\"\n                        [disabled]=\"loading\"\n                    >\n                        <mat-select-trigger>\n                            <div class=\"group\">\n                                <div class=\"icon\">\n                                    <div\n                                        class=\"wrapper\"\n                                        [style.backgroundColor]=\"loading ? '#eee' : status_details?.colour\"\n                                    >\n                                        <app-icon *ngIf=\"!loading\" [icon]=\"status_details?.icon\"></app-icon>\n                                        <mat-spinner *ngIf=\"loading\" diameter=\"16\"></mat-spinner>\n                                    </div>\n                                </div>\n                                <div class=\"text\">{{ status_details?.name }}</div>\n                            </div>\n                        </mat-select-trigger>\n                        <mat-option *ngFor=\"let status of statuses\" [value]=\"status.id\">\n                            <div class=\"group\">\n                                <div class=\"text\">{{ status.name }}</div>\n                                <div class=\"colour\" [style.backgroundColor]=\"status.colour\"></div>\n                            </div>\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n        </div>\n        <div class=\"content\">\n            <div class=\"block\">\n                <order-booking-details [space]=\"space\" [booking]=\"booking\"></order-booking-details>\n            </div>\n            <div class=\"block\">\n                <order-details-items [booking]=\"booking\" [order]=\"order\"></order-details-items>\n            </div>\n            <div class=\"block\">\n                <order-details-notes [(booking)]=\"booking\" [order]=\"order\"></order-details-notes>\n            </div>\n        </div>\n        <button class=\"close\" mat-icon-button mat-dialog-close>\n            <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n        </button>\n    </main>\n</mat-dialog-content>\n","import { Component } from '@angular/core';\n\n@Component({\n    selector: 'access-denied',\n    templateUrl: './access-denied.component.html',\n    styleUrls: ['./access-denied.component.scss']\n})\nexport class AccessDenied {\n\n    constructor() {}\n\n}\n","<div class=\"access-denied-container\">\n    <img src=\"assets/img/access-denied.svg\">\n    <h4>Oooops - sorry! You dont have access to this page.</h4>\n    <p>Please <a href=\"mailto:global_helpdesk@mckinsey.com\">contact help desk</a> or continue to <a href=\"/staff/\">Converge</a> for room booking.</p>\n</div>\n","import { Component, OnInit } from '@angular/core';\n\nimport { Building } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { ApplicationLinkInternal, ApplicationIcon } from '@mckinsey-converge/data-common';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-sidebar',\n    templateUrl: './sidebar.component.html',\n    styleUrls: ['./sidebar.component.scss']\n})\nexport class SidebarComponent implements OnInit {\n\n    /** Currently active building */\n    public get active_building(): Building {\n        return this._org.building;\n    }\n    public set active_building(building: Building) {\n        this._org.building = building;\n    }\n\n    /** List of available menu items */\n    public get menu_items(): ApplicationLinkInternal[] {\n        return this._service.setting('app.general.menu.items') || [];\n    }\n\n    /** Logo for the application organisation */\n    public get logo(): ApplicationIcon {\n        return this._service.setting('app.logo_light');\n    }\n\n    /** List of available buildings */\n    public get buildings(): Building[] {\n        return this._org.buildings || [];\n    }\n\n    constructor(private _service: ApplicationService, private _org: OrganisationService) {}\n\n    ngOnInit(): void {}\n}\n","<div class=\"logo\">\n    <i *ngIf=\"logo?.type === 'icon'\" [class]=\"logo.class\">{{ logo.content }}</i>\n    <img *ngIf=\"logo?.type === 'img'\" [src]=\"logo.src | safe: 'resource'\" />\n</div>\n<div class=\"menu\">\n    <a\n        mat-button\n        [id]=\"'link-' + (item.id || i)\"\n        class=\"item\"\n        *ngFor=\"let item of menu_items; let i = index\"\n        [routerLink]=\"[item.route]\"\n        routerLinkActive=\"active\"\n    >\n        <div class=\"content\">\n            <div class=\"bar\"></div>\n            <div class=\"icon\">\n                <app-icon [icon]=\"item.icon\"></app-icon>\n            </div>\n            <div class=\"text\">{{ item.name }}</div>\n        </div>\n    </a>\n</div>\n<div class=\"building dark-mode\" *ngIf=\"buildings && buildings.length > 1\">\n    <mat-form-field appearance=\"outline\">\n        <mat-select [(ngModel)]=\"active_building\">\n            <mat-option *ngFor=\"let building of buildings\" [value]=\"building\">\n                {{ building.name }}\n            </mat-option>\n        </mat-select>\n    </mat-form-field>\n</div>\n","import { Component, OnInit, Input, Output, EventEmitter, ViewChild } from '@angular/core';\nimport { MatMenuTrigger } from '@angular/material/menu';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\nimport { BookingStateService, OrganisationService } from '@mckinsey-converge/data-common';\nimport { DateNow, DateTZ, getTimezoneOffsetString, toMiddayUTC } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'a-topbar-header',\n    templateUrl: './topbar-header.component.html',\n    styleUrls: ['./topbar-header.component.scss'],\n})\nexport class TopbarHeaderComponent extends BaseDirective implements OnInit {\n    /** Currently selected date */\n    @Input() public dateTz: DateTZ = DateNow(new Date());\n    /** Currently building timezone */\n    @Input() public timezone: string;\n    /** Currently active zone */\n    @Input() public zone: string;\n    /** Whether to show new item button */\n    @Input() public show_add_item = false;\n    /** Whether to show the events for the active month */\n    @Input() public show_events: boolean = false;\n    /** Emitter for changes selected date */\n    @Output() public dateChangeTz = new EventEmitter<DateTZ>();\n    /** Emitter for add item button */\n    @Output() public event = new EventEmitter();\n    /** Counters of the events on given dates. Key format is `yyyy-MM-dd` */\n    public event_map: { [date: string]: number };\n\n    public fromDateTz = DateNow().subtractValue({ months: 6 });\n\n    public get now() {\n        return DateNow();\n    }\n\n    /** Display string for the currently selected date */\n    public get tz(): string {\n        return getTimezoneOffsetString(this.timezone_value);\n    }\n\n    public get timezone_value() {\n        return localStorage.getItem('CONCIERGE.timezone') || this.timezone || this.now.building_tz;\n    }\n\n    public get is_today() {\n        return new DateTZ({\n            date: toMiddayUTC(this.dateTz).ms,\n            is_local_tz: false,\n            building_tz: this.timezone_value,\n        }).isSameDate(\n            new DateTZ({\n                date: Date.now(),\n                is_local_tz: false,\n                building_tz: this.timezone_value,\n            }),\n            'day'\n        );\n    }\n\n    constructor(private _bookings: BookingStateService, private _org: OrganisationService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        // CONCIERGE.date: Get the localstorage date and timezone when changing pages.\n        const date = +localStorage.getItem('CONCIERGE.date') || this.now.ms;\n        \n        /* istanbul ignore else */\n        if (date && (date !== this.dateTz.ms || this.timezone_value !== this.dateTz.building_tz)) {\n            // CONCIERGE.date Reapply the localstorage date and timezone when changing pages.\n            this.timeout(\n                'init',\n                () => {\n                    this.dateTz = new DateTZ({\n                        date,\n                        is_local_tz: false,\n                        building_tz: this.timezone_value,\n                    });\n                    this.dateChangeTz.emit(this.dateTz);\n                    this.updateDate();\n                },\n                10\n            );\n        }\n        this.subscription(\n            'events',\n            this._bookings._noOfMeetings.subscribe((list) => {\n                this.event_map = {};\n                this.event_map = list[0];\n            })\n        );\n    }\n\n    public noOfCount(event) {\n       // Disabling bellow until find more reliable way to call as it is been called multiple times on hover/click\n        // this._bookings.getDailyMeetingCount();\n        // event.stopPropogation();\n    }\n\n    /**\n     * Change the selected date with the arrow controls\n     *\n     */\n    public changeDate(value: number) {\n        let date = new DateTZ({\n            date: toMiddayUTC(this.dateTz).ms,\n            is_local_tz: false,\n            building_tz: this.timezone_value,\n        });\n        date = date.addValue({ days: value });\n        this.dateTz = date;\n        this.dateChangeTz.emit(this.dateTz);\n        localStorage.setItem('CONCIERGE.date', `${this.dateTz.ms}`);\n        localStorage.setItem('CONCIERGE.timezone', `${this.timezone_value}`);\n        this.updateDate();\n    }\n\n    /**\n     * Change the selected date with the calendar widget\n     *\n     */\n    public applyDatePickerValue(dateInputTz: DateTZ) {\n        this.dateTz = new DateTZ({\n            date: toMiddayUTC(dateInputTz).ms,\n            is_local_tz: false,\n            building_tz: this.timezone_value,\n        });\n        this.dateChangeTz.emit(this.dateTz);\n        localStorage.setItem('CONCIERGE.date', `${this.dateTz.ms}`);\n        localStorage.setItem('CONCIERGE.timezone', `${this.timezone_value}`);\n        this.updateDate();\n        this.closeDatePicker();\n    }\n\n    public updateDate() {\n        this.timeout('update_date', () => this._bookings.setDate(this.dateTz));\n    }\n\n    /** Reset date to the current date */\n    public resetDate() {\n        this.dateTz = new DateTZ({\n            date: toMiddayUTC(this.now).ms,\n            is_local_tz: false,\n            building_tz: this.timezone_value,\n        });\n        this.dateChangeTz.emit(this.dateTz);\n        localStorage.setItem('CONCIERGE.date', `${this.dateTz.ms}`);\n        localStorage.setItem('CONCIERGE.timezone', `${this.timezone_value}`);\n        this.updateDate();\n    }\n\n    public closeDatePicker() {\n        this.updateDate();\n    }\n\n    /** New Item button click */\n    public newItem(): void {\n        this.event.emit('new_item');\n    }\n}\n","<div class=\"topbar-header\">\n    <div class=\"content\">\n        <ng-content></ng-content>\n    </div>\n    <div *ngIf=\"show_add_item\" class=\"add-item\">\n        <button mat-mini-fab class=\"new-item\" name=\"new\" (click)=\"newItem()\">\n            <i class=\"material-icons\">add</i>\n        </button>\n    </div>\n    <div class=\"date\">\n        <div class=\"picker\">\n            <button mat-icon-button name=\"previous\" (click)=\"changeDate(-1)\">\n                <app-icon\n                    [icon]=\"{ class: 'material-icons', content: 'keyboard_arrow_left' }\"\n                ></app-icon>\n            </button>\n            <div class=\"text\" (dblclick)=\"resetDate()\">\n                <p small *ngIf=\"is_today\">Today</p>\n                <p [class.medium]=\"is_today\">{{ dateTz.ms | date: 'mediumDate':tz }}</p>\n            </div>\n            <button mat-icon-button name=\"next\" (click)=\"changeDate(1)\">\n                <app-icon\n                    [icon]=\"{ class: 'material-icons', content: 'keyboard_arrow_right' }\"\n                ></app-icon>\n            </button>\n        </div>\n        <div class=\"divide\" (click)=\"noOfCount($event)\">\n            <date-tz-date-picker\n                class=\"time-inputs-calendar\"\n                [icon_only]=\"true\"\n                [counters]=\"show_events ? event_map : {}\"\n                [(ngModel)]=\"dateTz\"\n                [fromDateTz]=\"fromDateTz\"\n                [can_pick_today]=\"false\"\n                [timezone]=\"timezone_value\"\n                (onSelect)=\"applyDatePickerValue($event)\"\n            >\n            </date-tz-date-picker>\n        </div>\n    </div>\n</div>\n","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { first } from 'rxjs/operators';\n\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { ApplicationIcon } from '@mckinsey-converge/data-common';\nimport { UsersService } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'app-login',\n    templateUrl: './login.component.html',\n    styleUrls: ['./login.component.scss'],\n})\nexport class LoginComponent extends BaseDirective implements OnInit {\n    /** Logo of the application organisation */\n    public logo: ApplicationIcon;\n    /** Whether the user credentials are being checked */\n    public loading: boolean;\n    /** Form fields for the login form */\n    public form: FormGroup;\n\n    /** Password field element */\n    @ViewChild('pass_field', { static: true }) private pwd_field: ElementRef<HTMLInputElement>;\n\n    constructor(private _service: ApplicationService, private _users: UsersService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.loading = true;\n        this.form = new FormGroup({\n            username: new FormControl('', [Validators.required]),\n            password: new FormControl('', [Validators.required]),\n        });\n        this._service.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.loading = false;\n            this.logo = this._service.setting('app.logo_light') || { type: 'icon' };\n        });\n    }\n\n    /** Perform user login */\n    public login() {\n        this.loading = true;\n        const form = this.form.value;\n        this._users\n            .login(\n                {\n                    username: form.username,\n                    password: form.password,\n                },\n                { form: true }\n            )\n            .then(\n                () => this.loading = false,\n                () => {\n                    this.loading = false;\n                    this.form.controls.password.setErrors({ check: true });\n                }\n            );\n    }\n}\n","<div class=\"login\" *ngIf=\"!loading; else loading_state\">\n    <div class=\"login-form\">\n        <form [formGroup]=\"form\">\n            <div class=\"header\" [style.background-color]=\"logo?.background\">\n                <div class=\"logo\">\n                    <i *ngIf=\"logo?.type === 'icon'\" [class]=\"logo.class\">{{ logo.content }}</i>\n                    <img *ngIf=\"logo?.type === 'img'\" [src]=\"logo.src | safe: 'resource'\" />\n                </div>\n            </div>\n            <div class=\"body\">\n                <ng-container>\n                    <div class=\"field\">\n                        <label\n                            for=\"username\"\n                            [class.error]=\"\n                                form.controls.username.invalid && form.controls.username.touched\n                            \"\n                            i18n=\"Login form username label\"\n                        >\n                            Username:\n                        </label>\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                matInput\n                                name=\"username\"\n                                placeholder=\"Username/Email\"\n                                i18n-placeholder\n                                formControlName=\"username\"\n                            />\n                            <mat-error i18n=\"Login form username error\"\n                                >Username is required</mat-error\n                            >\n                        </mat-form-field>\n                    </div>\n                    <div class=\"field\">\n                        <label\n                            for=\"password\"\n                            [class.error]=\"\n                                form.controls.password.invalid && form.controls.password.touched\n                            \"\n                            i18n=\"Login form password label\"\n                        >\n                            Password:\n                        </label>\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                matInput\n                                name=\"password\"\n                                placeholder=\"Password\"\n                                i18n-placeholder\n                                formControlName=\"password\"\n                                (keyup.enter)=\"login()\"\n                            />\n                            <mat-error i18n=\"Login form password error\"\n                                >Invalid username or password</mat-error\n                            >\n                        </mat-form-field>\n                    </div>\n                </ng-container>\n            </div>\n            <div class=\"footer\">\n                <button mat-button (click)=\"login()\" i18n=\"Login action\">Login</button>\n            </div>\n        </form>\n    </div>\n</div>\n<ng-template #loading_state>\n    <div class=\"info-block center\">\n        <div class=\"spinner\">\n            <img src=\"assets/img/loader.gif\" />\n        </div>\n        <div class=\"text\" i18n=\"Checking login status\">Converge is loading</div>\n    </div>\n</ng-template>\n","import { Component, OnInit, Input, SimpleChanges, OnChanges, EventEmitter, Output } from '@angular/core';\nimport { first } from 'rxjs/operators';\nimport { Router } from '@angular/router';\n\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { Building } from '@mckinsey-converge/data-common';\nimport { ReportDetails } from '../reports.component';\nimport { Report } from '@mckinsey-converge/data-common';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\nimport { ReportsService } from '@mckinsey-converge/data-common';\n\nimport { DateNow, DateTZ, toMiddayUTC } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'a-report-display',\n    templateUrl: './report-display.component.html',\n    styleUrls: ['./report-display.component.scss'],\n})\nexport class ReportDisplayComponent implements OnInit, OnChanges {\n    /** Details about the report being requested */\n    @Input() public report: ReportDetails;\n    /** Start date for the generated report */\n    public start_date: number;\n    /** End date for the generated report */\n    public end_date: number;\n    /** List of report data entries */\n    public report_data: Report;\n    /** Whether report data is loading */\n    public loading: boolean;\n    /** List of selected locations */\n    public locations: Building[] = [{} as any];\n    /** Multiple Locations? */\n    public multipleLocations: boolean = false;\n\n    /** List of available buildings */\n    public get buildings(): Building[] {\n        return this._org.buildings;\n    }\n\n    @Output() locationChanged = new EventEmitter<Building>();\n\n\n    constructor(\n        private _service: ApplicationService,\n        private _org: OrganisationService,\n        private _reports: ReportsService,\n        private _router: Router\n    ) {}\n\n    public ngOnInit(): void {\n        // R--- TODO no prams present for timezone\n        const now = DateNow();\n        this.start_date = now.startOfValue('day').ms;\n        this.end_date = now.endOfValue('day').ms;\n        this._org.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.locations = [this._org.building];\n        });\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.report) {\n            this.report_data = null;\n        }\n        if (this.locations.length > 1) {\n            this.locations = [this.locations[0]];\n        }\n    }\n\n    /* function runs on location change from on-page dropdown(not from sidebar) */\n    public onLocationChange(data: any) {\n        this.locationChanged.emit(this.locations[0]);\n    }\n\n    /**\n     * Ensure Space Time Continuum\n     */\n    public checkDates(new_date: number) {\n        if (this.start_date > this.end_date) {\n            // R--- TODO no prams present for timezone\n            const date = new DateTZ({ date: new_date });\n            this.start_date = date.startOfValue('day').ms;\n            this.end_date = date.endOfValue('day').ms;\n        }\n    }\n\n    /**\n     * Generate report\n     */\n    public generateReport() {\n        /* istanbul ignore else */\n        if (this.report) {\n            this.loading = true;\n            this.report_data = null;\n            const date = toMiddayUTC(new DateTZ({ date: this.start_date })).toZone(\n                this.locations[0]?.timezone\n            );\n            const end_date = toMiddayUTC(new DateTZ({ date: this.end_date })).toZone(\n                this.locations[0]?.timezone\n            );\n            this._reports\n                .show(this.report.id, {\n                    date: date.formatDate('yyyy-MM-dd'),\n                    start_date: date.startOfValue('day').seconds,\n                    end_date: end_date.endOfValue('day').seconds,\n                    zone_ids: this.locations.map((i) => i.id).join(','),\n                })\n                .then(\n                    (report) => {\n                        const zone_ids = this.locations.map((i) => i.id).join(',');\n                        if (this.report.id === 'day' && this.locations[0]?.city !== 'Dallas') {\n                            this.loading = false;\n                            this._service.notifyError(\n                                `Day View is currently available for Dallas only`\n                            );\n                        } else {\n                            this.loading = false;\n                            this.report_data = new Report({ ...report, type: this.report.id });\n                        }\n                    },\n                    (err) => {\n                        this.loading = false;\n                        this._service.notifyError(\n                            `Error generating report. Error: ${err.message || err}`\n                        );\n                    }\n                );\n        }\n    }\n\n    public downloadReport() {\n        /* istanbul ignore else */\n        if (this.report_data) {\n            const date = new DateTZ({ date: this.start_date });\n            this.report_data.downloadCSV(\n                `${this.report.name.split(' ').join('_').toLowerCase()}+${date.formatDate(\n                    'yyyy-MM-dd'\n                )}.csv`\n            );\n        }\n    }\n}\n","<div class=\"header\">\n    <div class=\"period\">\n        <div class=\"field\">\n            <label for=\"start-date\" [hidden]=\"this.report?.id === 'day'\">Start Date</label>\n            <label for=\"start-date\" [hidden]=\"this.report?.id !== 'day'\">Date</label>\n            <a-date-field\n                name=\"start-date\"\n                [(ngModel)]=\"start_date\"\n                [from]=\"end_date / 10\"\n                [to]=\"end_date * 10\"\n                (onChange)=\"checkDates($event)\"\n            ></a-date-field>\n        </div>\n        <div class=\"gap\" [hidden]=\"this.report?.id === 'day'\">to</div>\n        <div class=\"field\" [hidden]=\"this.report?.id === 'day'\">\n            <label for=\"end-date\">End Date</label>\n            <a-date-field\n                name=\"end-date\"\n                [(ngModel)]=\"end_date\"\n                [from]=\"start_date / 10\"\n                [to]=\"start_date * 10\"\n                (onChange)=\"checkDates($event)\"\n            ></a-date-field>\n        </div>\n    </div>\n    <div class=\"location dark-mode\">\n        <mat-form-field appearance=\"outline\" *ngIf=\"buildings && buildings.length > 1\">\n            <!-- Single Location Select -->\n            <mat-select *ngIf=\"!multipleLocations\" name=\"locations\" [(ngModel)]=\"locations[0]\" (ngModelChange)=\"onLocationChange($event)\">\n                <mat-select-trigger>\n                    {{ locations ? locations[0]?.name : '' }}\n                    <span *ngIf=\"locations?.length > 1\" class=\"selection\">\n                        (+{{ locations.length - 1 }}\n                        {{ locations?.length === 2 ? 'other' : 'others' }})\n                    </span>\n                </mat-select-trigger>\n                <mat-option *ngFor=\"let building of buildings\" [value]=\"building\">\n                    <div class=\"option\">\n                        <div class=\"code\">{{ building.code }}</div>\n                        <div class=\"name\">{{ building.name }}</div>\n                    </div>\n                </mat-option>\n            </mat-select>\n            <!-- Multi Location Select - Could be wrapped to make directives conditional -->     \n            <mat-select *ngIf=\"multipleLocations\" name=\"locations\" [(ngModel)]=\"locations\" multiple>\n                <mat-select-trigger>\n                    {{ locations ? locations[0]?.name : '' }}\n                    <span *ngIf=\"locations?.length > 1\" class=\"selection\">\n                        (+{{ locations.length - 1 }}\n                        {{ locations?.length === 2 ? 'other' : 'others' }})\n                    </span>\n                </mat-select-trigger>\n                <mat-option *ngFor=\"let building of buildings\" [value]=\"building\">\n                    <div class=\"option\">\n                        <div class=\"code\">{{ building.code }}</div>\n                        <div class=\"name\">{{ building.name }}</div>\n                    </div>\n                </mat-option>\n            </mat-select>\n\n        </mat-form-field>\n    </div>\n    <div class=\"actions\">\n        <button mat-button name=\"generate\" [disabled]=\"loading\" (click)=\"generateReport()\">\n            <span *ngIf=\"!loading; else gen_loader\">Generate</span>\n            <ng-template #gen_loader><mat-spinner diameter=\"32\"></mat-spinner></ng-template>\n        </button>\n        <button mat-button name=\"download\" [disabled]=\"!report_data\" (click)=\"downloadReport()\">Download</button>\n    </div>\n</div>\n<div class=\"display\">\n    <ng-container *ngIf=\"!loading; else load_state\">\n        <ng-container *ngIf=\"report_data && report_data.data.length; else empty_state\">\n            <a-report-table [list]=\"report_data.data || []\" [details]=\"report\"></a-report-table>\n        </ng-container>\n    </ng-container>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'arrow_upward' }\"></app-icon>\n        </div>\n        <div class=\"text\">\n            {{\n                report_data ? 'No entries for selected date' : 'Press generate above to view report'\n            }}\n        </div>\n    </div>\n</ng-template>\n<ng-template #load_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <mat-spinner diameter=\"32\"></mat-spinner>\n        </div>\n        <div class=\"text\">Loading report...</div>\n    </div>\n</ng-template>\n","import { Component, Input, SimpleChanges, OnChanges } from '@angular/core';\nimport { HashMap } from '@mckinsey-converge/base';\nimport { ReportDetails } from '../reports.component';\n\n@Component({\n    selector: 'a-report-table',\n    templateUrl: './report-table.component.html',\n    styleUrls: ['./report-table.component.scss'],\n})\nexport class ReportTableComponent implements OnChanges {\n    /** List of report table data */\n    @Input() public list: HashMap[] = [];\n    /** Map of details for report */\n    @Input() public details: ReportDetails;\n\n    public fields: string[] = [];\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.list && this.list && this.list.length) {\n            this.fields = Object.keys(this.list[0]).filter(i => this.details.hide_fields.indexOf(i) < 0);\n        }\n    }\n}\n","<table cdk-table [dataSource]=\"list\">\n    <!-- Position Column -->\n    <ng-container *ngFor=\"let key of fields\" [cdkColumnDef]=\"key\">\n        <th cdk-header-cell [attr.name]=\"key\" *cdkHeaderCellDef>{{ key | replace }}</th>\n        <td cdk-cell [attr.name]=\"key\" *cdkCellDef=\"let element\">{{ element[key] }}</td>\n    </ng-container>\n\n    <tr cdk-header-row *cdkHeaderRowDef=\"fields; sticky: true\" ></tr>\n    <tr cdk-row *cdkRowDef=\"let row; columns: fields\"></tr>\n</table>\n","import { Component, OnInit } from '@angular/core';\nimport { ApplicationIcon, OrganisationService } from '@mckinsey-converge/data-common';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { first } from 'rxjs/operators';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\nexport interface ReportDetails {\n    /** ID associated with the report */\n    id: string;\n    /** Name of the report */\n    name: string;\n    /** Shortened name of the report */\n    short_name: string;\n    /** More details about the report */\n    description: string;\n    /** Fields to hide on the UI */\n    hide_fields: string[];\n    /** Icon to display for report */\n    icon: ApplicationIcon;\n    /** Multiselect Locations */\n    multi_locations: boolean;\n}\n\n@Component({\n    selector: 'a-reports',\n    templateUrl: './reports.component.html',\n    styleUrls: ['./reports.component.scss'],\n})\nexport class ReportsComponent extends BaseDirective implements OnInit {\n    /** Currently selected date */\n    public dateTz: DateTZ = DateNow(new Date());\n    /** ID of the active report */\n    public active_report: string;\n\n    public has_access: boolean;\n\n    public location: any;\n\n    /** List of available reports to display */\n    public reports: ReportDetails[] = [\n        {\n            id: 'bookings',\n            name: 'Aggregate Bookings Report',\n            short_name: 'Bookings',\n            description: 'Generate comprehensive reports on various aspects of bookings',\n            hide_fields: ['room_email'],\n            icon: { type: 'img', src: 'assets/img/report-booking.svg' },\n            multi_locations: false,\n        },\n        {\n            id: 'catering',\n            name: 'Aggregate Charge Back Report',\n            short_name: 'Catering',\n            description: 'View confirmed catering report or mark up unconfirmed catering',\n            hide_fields: ['room_email'],\n            icon: { type: 'icon', class: 'material-icons', content: 'room_service' },\n            multi_locations: true,\n        },\n        {\n            id: 'day',\n            name: 'Day View Report',\n            short_name: 'day-view',\n            description: ' ',\n            hide_fields: [' '],\n            icon: { type: 'icon', class: 'material-icons', content: 'room_service' },\n            multi_locations: true,\n        },\n    ];\n\n    public get the_report(): ReportDetails {\n        return this.reports.find((report) => report.id === this.active_report);\n    }\n\n    constructor(\n        private _route: ActivatedRoute,\n        private _router: Router,\n        private _service: ApplicationService,\n        private _org: OrganisationService\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._service.title = 'Reports';\n        this.subscription(\n            'route.params',\n            this._route.paramMap.subscribe((params) => {\n                if (params.has('report')) {\n                    this.active_report = params.get('report');\n                }\n            })\n        );\n\n        this._org.initialised.pipe(first((_) => _)).subscribe(() => {\n            // Init dateTz here once the organization data is loaded.\n            this.dateTz = new DateTZ({\n                date: this.dateTz.ms,\n                is_local_tz: false,\n                building_tz: this.timezone,\n            });\n            this.subscription(\n                'building',\n                this._org.listen('active_building').subscribe(() => {\n                    // Update dateTz here when the building is changed.\n                    this.dateTz = new DateTZ({\n                        date: this.dateTz.ms,\n                        is_local_tz: false,\n                        building_tz: this.timezone,\n                    });\n                    const building = this._org.building;\n                    this.location = this._org.building;\n                    this.has_access = building ? true : false;\n\n                    //check for Dallas\n                    if (this.location.city != 'Dallas') {\n                        // remove day view from reports array\n                        this.reports = this.reports.filter(function (reports) {\n                            return reports.id !== 'day';\n                        });\n                    }\n                })\n            );\n        });\n    }\n\n    public updateReport() {\n        this._router.navigate(['/reports', this.active_report]);\n    }\n\n    // R--- surely these 2 methods are not DRY and all the main tabs need a base class\n    // that encapsulates the common elements.\n    public get timezone() {\n        return this._org.building.timezone;\n    }\n\n    public updateDateTz(dateTz: DateTZ) {\n        this.dateTz = dateTz;\n    }\n\n    public onLocationChanged(location: any) {\n        this.location = location;\n        //check for Dallas\n        if (this.location.city != 'Dallas') {\n            // remove day view from reports array\n            this.reports = this.reports.filter(function (reports) {\n                return reports.id !== 'day';\n            });\n            this._router.navigate(['/reports/bookings']);\n        } else {\n            // add day view to reports array\n            this.reports = [\n                ...this.reports,\n                {\n                    id: 'day',\n                    name: 'Day View Report',\n                    short_name: 'day-view',\n                    description: ' ',\n                    hide_fields: [' '],\n                    icon: { type: 'icon', class: 'material-icons', content: 'room_service' },\n                    multi_locations: true,\n                },\n            ];\n        }\n    }\n}\n","<div class=\"reports\">\n    <a-sidebar></a-sidebar>\n    <div class=\"group\" *ngIf=\"!has_access\">\n        <access-denied></access-denied>\n    </div>\n    <div class=\"group\" *ngIf=\"has_access\">\n        <div class=\"topbar\" *ngIf=\"active_report\">\n            <mat-form-field *ngIf=\"reports && reports.length > 1\" appearance=\"outline\">\n                <mat-select\n                    name=\"report-type\"\n                    [(ngModel)]=\"active_report\"\n                    (ngModelChange)=\"updateReport()\"\n                >\n                    <mat-option *ngFor=\"let report of reports\" [value]=\"report.id\">\n                        {{ report.name }}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n        </div>\n        <main>\n            <div class=\"options\" *ngIf=\"!active_report; else report_display\">\n                <a\n                    class=\"card\"\n                    [name]=\"report.id + '-report'\"\n                    mat-button\n                    *ngFor=\"let report of reports\"\n                    [routerLink]=\"['/reports', report.id]\"\n                >\n                    <div class=\"content\">\n                        <div class=\"icon\">\n                            <app-icon [icon]=\"report.icon\"></app-icon>\n                        </div>\n                        <h3>{{ report.short_name }}</h3>\n                        <div class=\"details\">\n                            <div class=\"desc\">{{ report.description }}</div>\n                            <app-icon\n                                [icon]=\"{\n                                    class: 'material-icons',\n                                    content: 'keyboard_arrow_right'\n                                }\"\n                            ></app-icon>\n                        </div>\n                    </div>\n                </a>\n            </div>\n        </main>\n    </div>\n</div>\n<ng-template #report_display>\n    <a-report-display (locationChanged)=\"onLocationChanged($event)\" [report]=\"the_report\">\n    </a-report-display>\n</ng-template>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Route, RouterModule } from '@angular/router';\n\nimport { ReportsComponent } from './reports.component';\nimport { SharedContentModule } from '../shared/shared.module';\nimport { ReportDisplayComponent } from './report-display/report-display.component';\nimport { ReportTableComponent } from './report-table/report-table.component';\n\nconst ROUTES: Route[] = [\n    { path: '', component: ReportsComponent },\n    { path: ':report', component: ReportsComponent },\n    { path: '**', redirectTo: '' }\n];\n\n@NgModule({\n  declarations: [ReportsComponent, ReportDisplayComponent, ReportTableComponent],\n  imports: [CommonModule, FormsModule, RouterModule.forChild(ROUTES), SharedContentModule]\n})\nexport class ReportsModule { }\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\n\n@Component({\n    selector: 'app-bulk-qr-overlay',\n    templateUrl: './bulk-qr-overlay.component.html',\n    styleUrls: ['./bulk-qr-overlay.component.scss'],\n})\nexport class BulkQrOverlayComponent implements OnInit {\n    @Input() itemsCheckboxes: any[];\n    @Input() qrCodeUrls: any[];\n    @Output() selectItemChange: EventEmitter<any> = new EventEmitter<any>();\n    @Output() selectAllChange: EventEmitter<boolean> = new EventEmitter<boolean>();\n    @Input() isOpen: boolean;\n    @Input() selectAll: boolean;\n    @Output() downloadQrCodeRequested: EventEmitter<void> = new EventEmitter<void>();\n    @Output() cancelClick: EventEmitter<void> = new EventEmitter<void>();\n    @Input() newArr: any[];\n    @Input() allLevels: any;\n    @Output() qrCodeUrlsChange: EventEmitter<any[]> = new EventEmitter<any[]>();\n\n    constructor() {}\n\n    ngOnInit(): void {}\n\n    public onSubmit(str: string) {\n        this.qrCodeUrlsChange.emit(this.qrCodeUrls); // Emit the updated qrCodeUrls array\n        this.downloadQrCodeRequested.emit();\n        if (str === 'room') {\n            this.qrTabClick({ index: 0 });\n        } else if (str === 'level') {\n            this.qrTabClick({ index: 1 });\n        }\n    }\n\n    public onCancel(str: string) {\n        // Handle cancel button logic for rooms here (reset the form)\n        if (str === 'level') {\n            this.itemsCheckboxes = this.newArr.map((item) => {\n                return { ...item, ...{ checked: false }, ...{ isLevel: false } };\n            });\n        }\n        this.itemsCheckboxes.forEach((checkbox) => (checkbox.checked = false));\n        this.selectAll = false;\n        this.qrCodeUrls = [];\n        this.qrCodeUrlsChange.emit(this.qrCodeUrls);\n        this.cancelClick.emit();\n    }\n\n    public onSelectAllChange(str: string) {\n        for (const checkbox of this.itemsCheckboxes) {\n            checkbox.checked = this.selectAll;\n        }\n        if (str === 'room') {\n            this.qrCodeUrls = this.itemsCheckboxes\n                .filter((checkbox) => checkbox.checked)\n                .map(({ id, roomname, level }) => ({\n                    url: window.location.origin + '/staff/#/home?id=' + id,\n                    roomname: roomname,\n                    level: level\n                }));\n        } else if (str === 'level') {\n            this.qrCodeUrls = this.itemsCheckboxes\n                .filter((checkbox) => checkbox.checked)\n                .map(({ id, building_id, name }) => ({\n                    url: window.location.origin + '/staff/#/home?zone_id=' + building_id + '&floor=' + id,\n                    name: name,\n                }));\n        }\n        this.qrCodeUrlsChange.emit(this.qrCodeUrls);\n    }\n\n    public onSelectItemChange(e: any, item: any) {\n        if (e.checked && !item.isLevel) {\n            //If room selected, push it to qrCodeUrls array\n            let checkedRoomObj = {\n                url: window.location.origin + '/staff/#/home?id=' + item.id,\n                roomname: item.roomname,\n                level: item.level,\n            };\n            this.qrCodeUrls.push(checkedRoomObj);\n            this.qrCodeUrlsChange.emit(this.qrCodeUrls);\n        } else if (e.checked && item.isLevel) {\n            //If levels selected, push it to qrCodeUrls array\n            let checkedLevelObj = {\n                url:\n                    window.location.origin +\n                    '/staff/#/home?zone_id=' +\n                    item.building_id +\n                    '&floor=' +\n                    item.id,\n                name: item.name,\n            };\n            this.qrCodeUrls.push(checkedLevelObj);\n            this.qrCodeUrlsChange.emit(this.qrCodeUrls);\n        } else {\n            // If unselected, find the index of the checked Obj in qrCodeUrls array based on room/level name\n            const index = item.isLevel\n                ? this.qrCodeUrls.findIndex((obj) => obj.name === item.name)\n                : this.qrCodeUrls.findIndex((obj) => obj.roomname === item.roomname);\n            // If the object is found, remove it from the array using splice\n            if (index !== -1) {\n                this.qrCodeUrls.splice(index, 1);\n                this.qrCodeUrlsChange.emit(this.qrCodeUrls);\n            }\n        }\n    }\n\n    isAnyItemSelected(): boolean {\n        return this.itemsCheckboxes.some((checkbox) => checkbox.checked);\n    }\n\n    public qrTabClick(e: any) {\n        let checkedFlag = { checked: false };\n        this.qrCodeUrls = [];\n        this.qrCodeUrlsChange.emit(this.qrCodeUrls);\n        this.itemsCheckboxes = [];\n        this.selectAll = false;\n\n        if (e.index === 0) {\n            //rooms tab\n            this.itemsCheckboxes = this.newArr.map((item) => {\n                return { ...item, ...checkedFlag, ...{ isLevel: false } };\n            });\n        } else if (e.index === 1) {\n            //levels tab\n            Object.assign(this.itemsCheckboxes, this.allLevels);\n            this.itemsCheckboxes = this.itemsCheckboxes.map((item) => {\n                return { ...item, ...checkedFlag, ...{ isLevel: true } };\n            });\n        }\n    }\n}\n","\n<div class=\"qr-heading\">Print QR codes</div>\n\n<mat-tab-group\n    fitInkBarToContent\n    animationDuration=\"0ms\"\n    (selectedTabChange)=\"qrTabClick($event)\"\n>\n    <mat-tab label=\"Rooms\">\n        <div>\n            <form (ngSubmit)=\"onSubmit('room')\">\n                <div class=\"checkbox-wrapper\">\n                    <div class=\"select-all-wrapper\">\n                        <label>\n                            <mat-checkbox\n                                [(ngModel)]=\"selectAll\"\n                                (change)=\"onSelectAllChange('room')\"\n                                [ngModelOptions]=\"{ standalone: true }\"\n                            ></mat-checkbox>\n                            Select All\n                        </label>\n                    </div>\n                    <div class=\"room-list\">\n                        <div *ngFor=\"let checkbox of itemsCheckboxes\">\n                            <label>\n                                <mat-checkbox\n                                    [(ngModel)]=\"checkbox.checked\"\n                                    [ngModelOptions]=\"{ standalone: true }\"\n                                    name=\"{{ checkbox.roomname }}\"\n                                    (change)=\"\n                                        onSelectItemChange($event, checkbox)\n                                    \"\n                                ></mat-checkbox>\n                                {{ checkbox.roomname }}\n                            </label>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-buttons\">\n                    <button type=\"button\" (click)=\"onCancel('room')\">\n                        Cancel\n                    </button>\n                    <button type=\"submit\" [disabled]=\"!isAnyItemSelected()\">\n                        Download\n                    </button>\n                </div>\n            </form>\n        </div>\n    </mat-tab>\n\n    <mat-tab label=\"Levels\">\n        <div>\n            <form (ngSubmit)=\"onSubmit('level')\">\n                <div class=\"checkbox-wrapper\">\n                    <div class=\"select-all-wrapper\">\n                        <label>\n                            <mat-checkbox\n                                [(ngModel)]=\"selectAll\"\n                                (change)=\"onSelectAllChange('level')\"\n                                [ngModelOptions]=\"{ standalone: true }\"\n                            ></mat-checkbox>\n                            Select All\n                        </label>\n                    </div>\n                    <div *ngFor=\"let checkbox of itemsCheckboxes\">\n                        <label>\n                            <mat-checkbox\n                                [(ngModel)]=\"checkbox.checked\"\n                                name=\"{{ checkbox.name }}\"\n                                [ngModelOptions]=\"{ standalone: true }\"\n                                (change)=\"\n                                    onSelectItemChange($event, checkbox)\n                                \"\n                            ></mat-checkbox>\n                            {{ checkbox.name }}\n                        </label>\n                    </div>\n                </div>\n                <div class=\"form-buttons\">\n                    <button type=\"button\" (click)=\"onCancel('level')\">\n                        Cancel\n                    </button>\n                    <button type=\"submit\" [disabled]=\"!isAnyItemSelected()\">\n                        Download\n                    </button>\n                </div>\n            </form>\n        </div>\n    </mat-tab>\n</mat-tab-group>\n","import {\n    AfterViewInit,\n    Component,\n    OnInit,\n    ViewChild,\n    Input,\n    ViewEncapsulation,\n    ChangeDetectionStrategy,\n    Output,\n    EventEmitter,\n    ChangeDetectorRef,\n    Inject,\n} from '@angular/core';\nimport { BaseDirective, DialogEvent, HashMap } from '@mckinsey-converge/base';\nimport { OrganisationService, SpacesService } from '@mckinsey-converge/data-common';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport {  ResizeService,  ReadLocalPicService } from '../services/';\nimport { RequiredFileType, RoomPhotoDiamension } from '../util/room-admin-utility';\nimport { HttpEventType, HttpHeaders, HttpClient} from '@angular/common/http';\nimport * as cloneDeep from 'lodash/cloneDeep';\n// import { UploadManager, Amazon } from '@acaprojects/ngx-uploads';\nimport { of, Observable, forkJoin } from \"rxjs\";\nimport { catchError, tap, toArray } from 'rxjs/operators';\nimport { ComposerService } from '@placeos/composer';\nimport { IconComponent } from '@mckinsey-converge/legacy-ui';\n\n@Component({\n    selector: 'app-manage-photos',\n    templateUrl: './manage-photos.component.html',\n    styleUrls: ['./manage-photos.component.scss'],\n\t\tchangeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ManagePhotosComponent extends BaseDirective implements OnInit {\n     /** Emitter for modal events */\n     @Output() public event = new EventEmitter<any>();\n\n\t\t public canvas: HTMLCanvasElement;\n\t\t public context: any;\n\t\t public imageInitial = null;\n\t\t public imageToModify = null;\n\n\t\t public photoArray: Array<any> = []; // array hold images to display (uploaded or to be upload)\n\t\t public photoUploadArray: Array<any> = []; // array hold image to upload\n\n\t\t public uploadProgress:number;\n\t\t public uploadError: boolean = false;\n\t\t public uploadingStatus: string = 'Uploading...';\n\t\t public room: any;\n\t\t public resizedFiles = [];\n\t\t public requiredFileType = RequiredFileType;\n\t\t public count: any = 0;\n\t\t public total: number = 0;\n\t\t public failedNo: string;\n\t\t//  isImageToModify: boolean;\n\n\n    constructor(\n\t\t\tprivate _composer: ComposerService,\n\t\t\t@Inject(MAT_DIALOG_DATA) private _data: any,\n\t\t\tpublic resizeService: ResizeService,\n\t\t\tprivate readLocalPicService: ReadLocalPicService,\n\t\t\tprivate _spaces: SpacesService,\n\t\t\tprivate cdRef: ChangeDetectorRef,\n\t\t\tprivate httpClient?: HttpClient,\n\t\t\t) {\n\t\t\tsuper();\n    }\n  \n\n    public ngOnInit() {\n       this.photoArray =  cloneDeep(this._data?.photos);\n\t\t\t this.room = this._data?.room\n    }\n\n\t\t\n\n\t\tpublic\tonFileSelected (event , indexToReplace?) {\n\t\t\tthis.uploadError = false;\n\t\t\tthis.canvas = document.createElement('canvas');\n\t\t\tthis.context = this.canvas.getContext('2d');\n\t\t\tconst ext = RequiredFileType.split(',');\n\t\t\tconst files = event instanceof Array ? event : [...new Set(event.target.files)].filter((f:File) => ext.includes(f.type));\n\t\t\tconst unusedIdx = indexToReplace!==undefined ? 1 : (3 - this.photoArray.length);\n\t\t\tfiles.splice(0,unusedIdx).forEach( file => {\n\n\t\t\t\tthis.readLocalPicService.readFileInput(file).then((base64Img) => {\n\n\t\t\t\t\tsetTimeout(\n\t\t\t\t\t\tasync function (that) {\n\n\t\t\t\t\t\t\tawait that.resizeService.resizeImage(base64Img, {width: RoomPhotoDiamension.width, height: RoomPhotoDiamension.height,  outputFormat: 'image/png', })\n\t\t\t\t\t\t\t\t\t\t.then(function (imgResized) {\n\n\t\t\t\t\t\t\t\t\t\t\tthat.resizeService.createImage(imgResized).then(function (image) {\n\n\t\t\t\t\t\t\t\t\t\t\t\tthat.context.clearRect(0, 0, image.width, image.height );\n\t\t\t\t\t\t\t\t\t\t\t\tthat.canvas.width = image.width;\n\t\t\t\t\t\t\t\t\t\t\t\tthat.canvas.height = image.height;\n\t\t\t\t\t\t\t\t\t\t\t\tthat.context.drawImage(  image,  0,  0,  image.width,  image.height );\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tconst dataURL: string | HTMLCanvasElement | HTMLImageElement = that.canvas.toDataURL('image/png');\n\t\t\t\t\t\t\t\t\t\t\t\tif(indexToReplace!==undefined) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tthat.photoArray.splice(indexToReplace, 1, { path : dataURL, index: indexToReplace+1 } )\n\t\t\t\t\t\t\t\t\t\t\t\t\tthat.photoUploadArray.splice(indexToReplace, 1, { path : dataURL, index: indexToReplace+1 } )\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst index = that.photoArray.length+1;\n\t\t\t\t\t\t\t\t\t\t\t\t\tthat.photoArray.push({ path: dataURL, index: index });\n\t\t\t\t\t\t\t\t\t\t\t\t\tthat.photoUploadArray.push({ path: dataURL, index: index });\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tthat.cdRef.detectChanges();\n\n\t\t\t\t\t\t\t\t\t\t\t\t// indexToReplace!==undefined ? that.photoArray.splice(indexToReplace, 1, { path : dataURL} ) : that.photoArray.push({ path: dataURL });\n\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('ERROR while creating image : ', error);\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('ERROR while resizing image : ', error);\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}, 0, this );\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.log('ERROR while Read local pic :', error);\n\t\t\t\t});\n\n\t\t\t})\n\n\t\t}\n\n\n\t\tupload() {\n\t\t\tthis.uploadError = false;\n\t\t\tthis.uploadProgress = 1;\n\t\t\tlet obs: Observable<any>[] = [];\n\t\t\tthis.count = 0;\n\t\t\tthis.total = this.photoUploadArray.length;\n\t\t\t\n\t\t\t// for (var i = 0; i < this.photoUploadArray.length; i++)\n\t\t\tthis.photoUploadArray.forEach(( img, i) =>{ \n\t\t\t\tconst formData = new FormData();\n\t\t\t\tconst file = this.readLocalPicService.b64toFile(img.path);\n\n\t\t\t\tformData.append( \"file\", file, `${this.room.email.split('@')[0]}-part-${img.index}.png`);\n\t\t\t\t\n\t\t\t\tobs.push(this.uploadSpacePhotos('photos', formData).pipe( catchError(err => of(err.status))) ) ;\n\n\t\t\t}) \n\n\t\t\t\n\n\t\t\tthis.subscription(`uploadPhotosSub$`, forkJoin(obs.map(o => o.pipe( \n\t\t\t\t\ttap(item => this.updateProgressMeter(item)),  \n\t\t\t\t\t// toArray() \n\t\t\t\t)))\n\t\t\t\t.subscribe(event => {\n\n\t\t\t\t\t\t\tthis._data.photos = [];\n\t\t\t\t\t\t\tevent.forEach((res ,i ) => {\n\t\t\t\t\t\t\t\tif(res?.message === 'File uploaded successfully!')  {\n\n\t\t\t\t\t\t\t\t\tthis.uploadError = false;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse  {\n\t\t\t\t\t\t\t\t\tconst suffixes = ['', 'st','nd','rd'];\n\t\t\t\t\t\t\t\t\tthis.failedNo = `${i+1}${suffixes[i+1]}`;\n\t\t\t\t\t\t\t\t\tthis.reset();\n\t\t\t\t\t\t\t\t\tthis.uploadError = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(i === (this.photoUploadArray.length-1)) {\n\t\t\t\t\t\t\t\t\tthis.photoUploadArray = [];\n\t\t\t\t\t\t\t\t\tthis.uploadingStatus =  'Complete';\n\t\t\t\t\t\t\t\t\tthis.event.emit(this._data.photos);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tthis.cdRef.detectChanges();\n\t\t\t\t\t\t\n\t\t\t\t\t\t},\n\t\t\t\t\t\terror => {\n\t\t\t\t\t\t\tthis._data.photos = [];\n\t\t\t\t\t\t\tthis.reset();\n\t\t\t\t\t\t\tthis.uploadError = true;\n\t\t\t\t\t\t\tconsole.log('Error while uploadig room photos: ', error) ;\n\t\t\t\t\t\t\tthis.cdRef.detectChanges();\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tprivate updateProgressMeter(item) {\n\t\t\tif(item?.message === 'File uploaded successfully!')  {\n\t\t\t\tthis.count++;\n\t\t\t\tthis.uploadProgress = this.total > 0 ? Math.round((this.count / this.total) * 100) : 0;\n\t\t\t\tthis.cdRef.detectChanges();\n\t\t\t}\n\t\t}\n\t\n\t\n\t\treset() {\n\t\t\tthis.uploadProgress = null;\n\t\t\tthis.cdRef.detectChanges();\n\t\t}\n\n\t\tpublic timestamp (photo) {\n\t\t\treturn photo?.index ? '' : `?${(new Date()).getTime()}`;\n\t\t}\n\n\n\t\t/**\n   * update function version -2 - returns observable instead of promise...\n   * @param form_data data to be update \n   * @param should_inject_concierge common value to be set to add concierge: true to the query url and body\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n\t\t public uploadSpacePhotos(apiSubRoute: string, form_data: HashMap, should_inject_concierge: Boolean = false, query_params: HashMap = {}):Observable<any>{\n\t\t\tconst url = `/api/staff/rooms/${apiSubRoute}`;\n\t\t\tconst body = form_data;\n\t\n\t\t\tconst token = this._composer.auth.token; //sessionStorage.length ? JSON.parse(sessionStorage.getItem('OAUTH.params')).access_token : '';\n\t\n\t\t\tconst headers = new HttpHeaders({\n\t\t\t\t'Authorization': `Bearer ${token}`,\n\t\t\t});\n\t\t\t\n\t\tconst requestOptions = { headers: headers };\n\t\n\t\t\treturn this.httpClient.post(url, body, {\n\t\t\t\t\t\t...requestOptions \n\t\t\t\t});\n\t\n\t\t\t// return this.http.post(url, body);\n\t\n\t\t}\n\n}\n","<div class=\"manage-photos-main flex-column\" >\n    <div class=\"header flex-row\">\n      <div class=\"flex flex-grow header-title\"> {{ room?.roomname }} </div>\n\t\t\t<div class=\"flex-row-end\">\n\t\t\t\t<button mat-icon-button mat-dialog-close >\n\t\t\t\t\t<app-icon\t[icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n\t\t\t</button>\n\t\t\t</div>\n    </div>\n\n\t\t<div class=\"container flex-column\">\n\t\t\t<div class=\"selected-photos-count flex-row\">\n\t\t\t\t<div class=\" flex-column\" >\n\t\t\t\t\t<span class=\"label-2\"> Selected photos ({{ photoArray.length }}/3)</span>\n\t\t\t\t\t<span class=\"img-specification\">Required photo parameters: landscape orientation, W 400x H 225 pixels, format PNG or WEBP</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"uploaded-photos flex-row\">\n\t\t\t\t<div class=\"flex-column\" *ngFor=\"let photo of  photoArray; let i = index;\">\n\t\t\t\t\t<div class=\"image flex-row\" >\n\t\t\t\t\t\t<img class=\"\" [src]=\"photo.path + timestamp(photo)\" style=\"width: 283px;height: 200px;\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"image-details flex-column\">\n\t\t\t\t\t\t<span class=\"label-2\">Room photo #{{i+1}}</span>\n\t\t\t\t\t\t<span >{{ room.email.split('@')[0] }}-part-{{i+1}}.png </span>\n\t\t\t\t\t\t<span >Ratio: 400x225</span>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex-row img-action\">\n\t\t\t\t\t\t<input type=\"file\" class=\"file-input\" (change)=\"onFileSelected($event, i)\" #fileUpload style=\"display: none;\" [accept]=\"requiredFileType\" >\n\t\t\t\t\t\t<button mat-icon-button (click)=\"fileUpload.click()\">\n\t\t\t\t\t\t\t<img  src=\"assets/icon/reload.svg\" />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button mat-icon-button name=\"deletePhoto\" (click)=\"photoArray.splice(i, 1); photoUploadArray.splice(i, 1)\">\n\t\t\t\t\t\t\t<img src=\"assets/icon/delete-photo.svg\" />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div *ngIf=\"photoArray.length < 3\" class=\"flex-column flex-center drag-drop-placeholder\" fileDragDrop (filesChangeEmiter)=\"onFileSelected($event)\">\n\t\t\t\t\t\n\t\t\t\t\t<div class=\"flex-row flex-center label-3\">\n\t\t\t\t\t\tDrag & drop or\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex-row flex-center\">\n\t\t\t\t\t\t<input type=\"file\" class=\"file-input\" (change)=\"onFileSelected($event)\" #fileUpload style=\"display: none;\" multiple [accept]=\"requiredFileType\">\n\t\t\t\t\t\t<button mat-button class=\"transparent-btns \" name=\"drag-drop-photos\"  (click)=\"fileUpload.click()\">Choose files</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t\t<div class=\"footer flex-column\">\n\t\t\t\t<div class=\"uploading-progress flex-column\" [ngClass]=\"{'uploading-error' : uploadError }\"  >\n\t\t\t\t\t<div class=\" flex-column status\" *ngIf=\"uploadProgress\">\n\t\t\t\t\t\t<span>{{uploadingStatus}}</span>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<mat-progress-bar class=\"progress-bar\" mode=\"determinate\" [value]=\"uploadProgress\" *ngIf=\"uploadProgress\"></mat-progress-bar>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\n\t\t\t\t\t<div class=\"flex-row\" *ngIf=\"uploadError\">\n\t\t\t\t\t\t<img class=\"\" src=\"assets/icon/S-ban.svg\" />\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{{failedNo}} Photo failed to upload successfully. Please try again.\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\t\t\t\t\n\n\t\t\t\t<div class=\"flex-row flex-row-end\">\n\t\t\t\t\t<button mat-button  class=\"primary\" name=\"upload\" [disabled]=\"photoUploadArray.length < 1\"  (click)=\"upload()\"> Upload </button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n   \n</div>","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { RoomAdminComponent } from './room-admin.component';\nimport { RoomDetailsWrapperComponent } from './room-details/room-details-wrapper.component';\n\nconst routes: Routes = [\n  { path: '',\n    children: [\n      { path: '', component: RoomAdminComponent },\n      {\n        path: 'room-details', \n        component: RoomDetailsWrapperComponent\n      }\n    ]\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class RoomAdminRoutingModule { }\n\n\n","import {\n    Component,\n    Input,\n    OnInit,\n    ChangeDetectionStrategy,\n    ViewEncapsulation,\n    ChangeDetectorRef,\n} from '@angular/core';\nimport { Router } from '@angular/router';\nimport {\n    DEFAULT_BOOKING_DURATION,\n    rulesForSpace,\n    SpacesService,\n    User,\n} from '@mckinsey-converge/data-common';\nimport {\n    OrganisationService,\n    ApplicationService,\n    BuildingLevel,\n} from '@mckinsey-converge/data-common';\nimport { DateNow, DateTZ, toMiddayUTC } from '@mckinsey-converge/date-tz';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { first, take } from 'rxjs/operators';\nimport { Identity, BaseDirective, closestToTimeSlotTz } from '@mckinsey-converge/base';\nimport { Store } from '@ngrx/store';\nimport { selectCurrentUser, UserStoreState } from '@mckinsey-converge/user';\nimport { RoomAdminService } from './services/room-admin.service';\nimport jsPDF, { RGBAData } from 'jspdf';\nimport { Hash } from 'crypto';\n\n@Component({\n    selector: 'app-room-admin',\n    templateUrl: './room-admin.component.html',\n    styleUrls: ['./room-admin.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class RoomAdminComponent extends BaseDirective implements OnInit {\n    public spaces: Space[] = [];\n    public newArr: any[];\n    public location: string;\n    public isOpen = false;\n\n    public itemsCheckboxes = [\n        {\n            label: '',\n            checked: false,\n            id: '',\n            building_id: '',\n            name: '',\n            email: '',\n            roomname: '',\n            isLevel: false,\n        },\n    ];\n\n    public qrCodeUrls = [];\n\n    public selectAll: boolean = false;\n\n    public allLevels: any; //need this for populating levels in bulk-qr-overlay component\n\n    /** DateTZ object of the active date */\n    @Input() public dateTz: DateTZ = DateNow(new Date());\n\n    /** ID of the active level */\n    @Input() public level: string;\n\n    /** List of levels available for the active building */\n    public levels: BuildingLevel[] = [];\n\n    /** List of space types available for the active building */\n    public space_types: Identity[] = [];\n\n    /** ID of the currently selected level */\n    public active_level = '';\n\n    /** List of legend keys to show */\n    public legend_list: string[] = [];\n\n    /** List of available legend keys */\n    public readonly legend_keys: readonly Identity[] = [\n        { name: 'Internal', id: 'internal', color: '#E69FC7', active: true },\n        { name: 'Client', id: 'client', color: '#1F40E6', active: true },\n        { name: 'External', id: 'external', color: '#8C5AC8', active: true },\n        { name: 'Setup', id: 'setup', color: '#d32f2f', active: true },\n        { name: 'Training', id: 'training', color: '#F0E700', active: true },\n        { name: 'Interview', id: 'interview', color: '#348D02', active: true },\n        { name: 'Declined', id: 'declined', color: '#617288', active: true },\n    ];\n\n    public detailsViewIndex = 0;\n\n    public rowInfo = [];\n\n    public has_access: boolean;\n    currentUser: User;\n    public enableOverlay = false;\n    constructor(\n        private _service: ApplicationService,\n        private _spaces: SpacesService,\n        private _org: OrganisationService,\n        private _router: Router,\n        private _booking_state_service: BookingStateService,\n        private store: Store,\n        private cdref: ChangeDetectorRef,\n        private roomAdminService: RoomAdminService\n    ) {\n        super();\n    }\n\n    public eventFromChild(data: number) {\n        this.detailsViewIndex = data;\n    }\n\n    public passRowToDetailsView(data: []) {\n        this.rowInfo = data;\n    }\n\n    public returnToRoomAdmin(data: number) {\n        this.detailsViewIndex = data;\n        this.updatePayload();\n        this.cdref.detectChanges();\n    }\n\n    public ngOnInit(): void {\n        this._service.title = 'Room Administration';\n\n        this._spaces.initialised.pipe(first((_) => _)).subscribe(() => {\n            this._org.initialised.pipe(first((_) => _)).subscribe(() => {\n                // Init dateTz here once the organization data is loaded.\n                this.dateTz = new DateTZ({\n                    date: this.dateTz.ms,\n                    is_local_tz: false,\n                    building_tz: this.timezone,\n                });\n                this.legend_list = this.legend_keys.map((item) => `${item.id}`);\n                this.subscription(\n                    'building',\n                    this._org.listen('active_building').subscribe(() => {\n                        // Update dateTz here when the building is changed.\n                        this.dateTz = new DateTZ({\n                            date: this.dateTz.ms,\n                            is_local_tz: false,\n                            building_tz: this.timezone,\n                        });\n                        const building = this._org.building;\n                        this.has_access = building ? true : false;\n                        if (!this.has_access) {\n                            return;\n                        }\n\n                        /* istanbul ignore else */\n                        if (!building.levels.find((lvl) => lvl.id === this.active_level)) {\n                            this.active_level = building?.levels[0]?.id;\n                            this.updateLevel();\n                        }\n                        this.updateLevel();\n                        this.levels = [{ id: '', name: 'All Levels' } as any].concat(\n                            building.levels\n                        );\n                        this.levels.sort((a, b) =>\n                            b.name.localeCompare(a.name, undefined, {\n                                numeric: true,\n                                ignorePunctuation: true,\n                            })\n                        );\n                        this.space_types = [{ id: '', name: 'All Space Types' } as any].concat(\n                            this._org.space_types\n                        );\n                    })\n                );\n            });\n        });\n    }\n\n    public updateLevel() {\n        this._booking_state_service.setZone(this.active_level || this._org.building.id);\n        this.enableOverlay = true;\n        this._spaces.queryRooms({zone_ids: this._org.building.id }).subscribe(\n            (res) => { \n                const list = res.map((i) => this._spaces.process(i));\n                this._router.navigate(['/room-admin']);\n                this.detailsViewIndex = 0;\n                this.updatePayload([...list]);\n            });\n    }\n\n    public updatePayload(spaces?) {\n        const zone_id = !this.level ? this._org.building.id : this.level;\n        /** TO DO : remove _space.filter use  */\n        this.spaces =  spaces ? [...spaces] : this._spaces.filter((_) => _.zones.indexOf(zone_id) >= 0);\n        this.location = this._org.building.name;\n        const roomDataSource = [];\n        for (let i = 0; i < this.spaces.length; i++) {\n            if (this.spaces[i].map_id) {\n                \n                roomDataSource.push({\n                    roomname: this.spaces[i].local_name,\n                    roomnum: this.spaces[i].map_id,\n                    level: this.spaces[i].level.short_name,\n                    capacity: this.spaces[i].capacity,\n                    roomtype: this.spaces[i].internal_or_external,\n                    bookable: this.spaces[i].bookable,\n                    settings: this.spaces[i].settings,\n                    equipment: this.spaces[i]?.equipment,\n                    room_style: this.spaces[i]?.room_style,\n                    email: this.spaces[i].email,\n                    roomobject: this.spaces[i],\n                    id: this.spaces[i].id,\n                    building: this.spaces[i].building,\n                });\n            }\n        }\n\n        this.newArr = [...roomDataSource]; // to make sure tabe is up to date\n\n        let checkedFlag = { checked: false };\n        this.itemsCheckboxes = this.newArr.map((item) => {\n            return { ...item, ...checkedFlag };\n        });\n        this.allLevels = this._org.building.levels;\n\n        this.enableOverlay = false;\n        this.cdref.detectChanges();\n    }\n\n    public get timezone() {\n        return this._org.building?.timezone || localStorage.getItem('CONCIERGE.timezone');\n    }\n\n    public bg_click_close() {\n        this.isOpen = false;\n        this.qrCodeUrls = [];\n        this.itemsCheckboxes.forEach((checkbox) => (checkbox.checked = false));\n        this.cdref.detectChanges();\n    }\n\n    public onQrCodeUrlsChange(newUrls: any[]) {\n        this.qrCodeUrls = newUrls;\n    }\n\n    public downloadQrCode() {\n        /**\n         * Use the same array of selected rooms/levels for qr code to iterate\n         */\n        this.roomAdminService.doc = new jsPDF();\n        let isRoom: boolean;\n        this.qrCodeUrls.forEach((item, i) => {\n            // Get the generated QR code img and modifiy as per design\n            const qrcode = document.querySelector(`.qr-code${i} img`);\n            let imageData: any = null;\n            if (item.roomname) {\n                isRoom = true;\n                imageData = this.roomAdminService.drawCanvas(qrcode, item.roomname, false, item.level); // roomname should be room name for rooms or [Level <no>] for levels\n            } else if (item.name) {\n                isRoom = false;\n                imageData = this.roomAdminService.drawCanvas(qrcode, item.name, true, ''); // roomname should be room name for rooms or [Level <no>] for levels\n            }\n            // Add generated qr code image to the pdf\n            switch ((i + 1) % 4) {\n                case 1:\n                    this.roomAdminService.doc.addImage(imageData, 'JPEG', 3, 5, 100, 100);\n                    break;\n                case 2:\n                    this.roomAdminService.doc.addImage(imageData, 'JPEG', 107, 5, 100, 100);\n                    break;\n                case 3:\n                    this.roomAdminService.doc.addImage(imageData, 'JPEG', 3, 130, 100, 100);\n                    break;\n                case 0:\n                    this.roomAdminService.doc.addImage(imageData, 'JPEG', 107, 130, 100, 100);\n                    this.roomAdminService.doc.addPage();\n                    break;\n            }\n        });\n        this.roomAdminService.doc.save(`${this.location} - ${isRoom ? `rooms.pdf` : `levels.pdf`}`);\n    }\n}\n","<div class=\"room-admin\">\n    <a-sidebar></a-sidebar>\n    <div class=\"group\" *ngIf=\"!has_access\">\n        <access-denied></access-denied>\n    </div>\n    <div class=\"group\" *ngIf=\"has_access\">\n        <div class=\"right-panel\">\n            <div class=\"overflow-bg\">\n                <div class=\"white-bg\">\n                    <div class=\"backoffice\">\n                        <img class=\"backoffice-img\" src=\"assets/img/backoffice-converge.svg\" />\n                    </div>\n                    <p class=\"heading\">Room Administration</p>\n                    <div>\n                        <hr class=\"hr\" />\n                    </div>\n                </div>\n            </div>\n            <div class=\"showing-rooms-and-qr\">\n                <p class=\"description\">Showing {{ this.location }} Rooms ({{ newArr?.length }})</p>\n                <!-- This button triggers the overlay and is it's origin -->\n                <button\n                    (click)=\"isOpen = !isOpen\"\n                    type=\"button\"\n                    cdkOverlayOrigin\n                    #trigger=\"cdkOverlayOrigin\"\n                    class=\"qr-button\"\n                >\n                    <ng-container *ngIf=\"isOpen; else closedState\">\n                        <img src=\"assets/img/bulk-qr-selected.svg\" />\n                    </ng-container>\n                    <ng-template #closedState>\n                        <img src=\"assets/img/bulk-qr-unselected.svg\" />\n                    </ng-template>\n                </button>\n                <!-- This template displays the overlay content and is connected to the above button -->\n                <ng-template\n                    cdkConnectedOverlay\n                    [cdkConnectedOverlayOrigin]=\"trigger\"\n                    [cdkConnectedOverlayOpen]=\"isOpen\"\n                    [cdkConnectedOverlayHasBackdrop]=\"isOpen\"\n                    [cdkConnectedOverlayBackdropClass]=\"'cdk-overlay-transparent-backdrop-cs'\"\n                    (backdropClick)=\"bg_click_close()\"\n                >\n                    <div class=\"qr-overlay\">\n                        <app-bulk-qr-overlay\n                            [isOpen]=\"isOpen\"\n                            [itemsCheckboxes]=\"itemsCheckboxes\"\n                            [qrCodeUrls]=\"qrCodeUrls\"\n                            [selectAll]=\"selectAll\"\n                            (selectItemChange)=\"onSelectItemChange($event)\"\n                            (selectAllChange)=\"onSelectAllChange($event)\"\n                            (downloadQrCodeRequested)=\"downloadQrCode()\"\n                            (cancelClick)=\"bg_click_close()\"\n                            [newArr]=\"newArr\"\n                            [allLevels]=\"allLevels\"\n                            (qrCodeUrlsChange)=\"onQrCodeUrlsChange($event)\"\n                            ></app-bulk-qr-overlay>\n                    </div>\n                </ng-template>\n            </div>\n            <app-rooms-table\n                *ngIf=\"newArr\"\n                [inputValue]=\"newArr\"\n                (onDetailsClick)=\"eventFromChild($event)\"\n                (rowClicked)=\"passRowToDetailsView($event)\"\n            ></app-rooms-table>\n        </div>\n    </div>\n\n    <div class=\"spinner-overlay\" [ngClass]=\"{ 'enable-overlay': enableOverlay }\"></div>\n\t<mat-spinner class=\"spinner-admin\" [ngClass]=\"{ 'enable-overlay': enableOverlay }\"></mat-spinner>\n\n</div>\n\n<div class=\"qrcodeImage flex-row\" *ngFor=\"let item of qrCodeUrls; let i = index\">\n    <qrcode\n        [qrdata]=\"item.url\"\n        [allowEmptyString]=\"true\"\n        [alt]=\"'A custom alt attribute'\"\n        [ariaLabel]=\"'QR Code image with the following content...'\"\n        [cssClass]=\"'qr-code' + i + ' unique-class'\"\n        [colorDark]=\"'#051C2C'\"\n        [colorLight]=\"'#FFFFFF'\"\n        [elementType]=\"'img'\"\n        [errorCorrectionLevel]=\"'M'\"\n        [margin]=\"3\"\n        [scale]=\"1\"\n        [title]=\"'A custom title attribute'\"\n        [width]=\"225\"\n        [ngStyle]=\"{ display: 'none' }\"\n    ></qrcode>\n</div>","import {  NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RoomAdminRoutingModule } from './room-admin-routing.module';\nimport { RoomAdminComponent } from './room-admin.component';\nimport { SharedContentModule } from '../shared/shared.module';\nimport { RoomsTableComponent } from './rooms-table/rooms-table.component';\nimport { MatTableModule } from '@angular/material/table';\nimport { MatPaginatorModule } from '@angular/material/paginator';\nimport { MatSortModule } from '@angular/material/sort';\nimport { RoomDetailsComponent } from './room-details/room-details.component';\nimport { MatExpansionModule } from '@angular/material/expansion';\nimport { FormsModule } from '@angular/forms';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { QRCodeModule } from 'angularx-qrcode';\nimport { OverlayModule} from '@angular/cdk/overlay';\nimport { MatTabsModule} from '@angular/material/tabs';\nimport { RoomAdminService } from './services/room-admin.service';\nimport { BulkQrOverlayComponent } from './bulk-qr-overlay/bulk-qr-overlay.component';\nimport { IconComponent, LegacyUiModule } from '@mckinsey-converge/legacy-ui';\nimport { UiModule } from '@mckinsey-converge/ui';\nimport { RoomDetailsWrapperComponent } from './room-details/room-details-wrapper.component';\nimport { ManagePhotosComponent } from './manage-photos/manage-photos.component';\nimport {  ResizeService, ReadLocalPicService } from './services/';\nimport { LegacyOverlaysModule } from '@mckinsey-converge/legacy-overlays';\nimport { ComposerModule } from '@placeos/composer';\nimport { FileDragNDropDirective } from './util/file-drag-n-drop.directive';\n\n\n\n@NgModule({\n  declarations: [RoomAdminComponent, RoomsTableComponent, RoomDetailsComponent, RoomDetailsWrapperComponent, BulkQrOverlayComponent, ManagePhotosComponent, FileDragNDropDirective],\n  imports: [\n    CommonModule,\n    RoomAdminRoutingModule,\n    SharedContentModule,\n    MatTableModule,\n    MatPaginatorModule,\n    MatSortModule,\n    MatExpansionModule,\n    FormsModule,\n    ReactiveFormsModule,\n    MatSnackBarModule,\n    QRCodeModule,\n    LegacyUiModule,\n    OverlayModule,\n    MatTabsModule,\n    UiModule,\n    LegacyOverlaysModule,\n    MatProgressBarModule,\n    ComposerModule\n  ],\n  providers: [\n    ResizeService,\n    ReadLocalPicService,\n    RoomAdminService\n  ],\n})\nexport class RoomAdminModule { }\n","import {\n    Component,\n    OnInit,\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n} from '@angular/core';\nimport { Router } from '@angular/router';\n\n@Component({\n    selector: 'room-details-wrapper',\n    template: `\n                <div class=\"room-admin\">\n                    <a-sidebar></a-sidebar>\n    \n                    <div class=\"right-panel details-view\" >\n                        <div class=\"overflow-bg\">\n                            <div class=\"white-bg\">\n                                <div class=\"backoffice\">\n                                    <img class=\"backoffice-img\" src=\"assets/img/backoffice-converge.svg\"/>\n                            </div>\n                            <p class=\"breadcrumb\"><a (click)=\"getToRoomList()\">Room Administration</a> > Room Detail</p>\n                            <p class=\"heading\">Room detail</p>\n                            <div>\n                                <hr class=\"hr\"/>\n                            </div>\n                        </div>\n                            <app-room-details [rowInfo]=\"rowInfo\" ></app-room-details>\n                        </div>\n                    </div>\n                </div>  \n                `,\n    styleUrls: ['./room-details-wrapper.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class RoomDetailsWrapperComponent implements OnInit {\n    public rowInfo: any;\n   \n\n\n    constructor(\n        private cd: ChangeDetectorRef,\n        private _router: Router,\n    ) {\n        if(this._router.getCurrentNavigation() !== null && this._router.getCurrentNavigation().extras['state']?.details) {\n           this.rowInfo = this._router.getCurrentNavigation().extras['state']?.details;\n        }\n        else {\n            this._router.navigate(['room-admin']);\n        }\n    }\n\n    public ngOnInit(): void {\n       this.cd.detectChanges();\n    }\n\n    public getToRoomList() {\n        this._router.navigate(['room-admin'])\n    }\n\n}","import {\n    Component,\n    OnInit,\n    Input,\n    Output,\n    EventEmitter,\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n} from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { SpacesService, noWhitespaceValidator, OrganisationService, SpaceEquipments, SpaceStyles, setupRoomImages } from '@mckinsey-converge/data-common';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { DropdownOpion, CngSelectData } from '@mckinsey-converge/ui';\nimport { roomTypeOptions, roomSubsetOptions, roomVisibilityOptions, canteringAvailabilityOptions, room, RoomSubset } from '../util/room-admin-utility';\nimport jsPDF from 'jspdf';\nimport { Router } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ManagePhotosComponent } from '../manage-photos/manage-photos.component';\nimport { BaseDirective, DialogEvent, SpaceImageObject } from '@mckinsey-converge/base';\nimport { BehaviorSubject } from 'rxjs';\n\n\n\n@Component({\n    selector: 'app-room-details',\n    templateUrl: './room-details.component.html',\n    styleUrls: ['./room-details.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class RoomDetailsComponent extends BaseDirective  implements OnInit {\n    public reactiveForm: FormGroup;\n    public room: room;\n    public rowInfoData: any;\n    public doc: jsPDF;\n    public cityname: string;\n\n    public roomTypeDD: CngSelectData;\n    public roomSubsetDD: CngSelectData;\n    public roomVisibilityDD: CngSelectData;\n    public canteringAvailabilityDD: CngSelectData;\n\t\tpublic givenRoomType: any = 'internal';\n\t\tpublic givenRoomSubType: any = 'conference';\n\t\tpublic givenCateringAvailability: any;\n\t\tpublic uploadedPhotos : Array<any> = [];\n\t\tpublic roomSubsetOptions:RoomSubset;\n\n    @Input() set rowInfo(value: any) {\n        this.rowInfoData = value;\n    }\n    @Input() set location(value: string) {\n        this.cityname = value;\n    }\n\n    @Output('parentFun') parentFun: EventEmitter<any> = new EventEmitter<any>();\n\t\tpublic loadImages = new BehaviorSubject<SpaceImageObject[]>([]);\n\t\t\n    public disableButtons = false;\n    public enableOverlay = false;\n    public windowLocation = location;\n\n\n\t\t// Set to a config once we know where the files are hosted.\n    public rootFolderURL = 'assets/img/rooms/';\n\t\tpublic foundImages: SpaceImageObject[] = [];\n\t\tpublic roomImages: SpaceImageObject[] = [];\n\n\n\t\tpublic get roomImagesFileSlug(): string {\n\t\t\treturn this.rowInfoData.email.split('@')[0];\n\t\t}\n    \n    constructor(\n        private _spaces: SpacesService,\n        private cd: ChangeDetectorRef,\n        private _snackBar: MatSnackBar,\n        private _router: Router,\n\t\t\t\tprivate _dialog: MatDialog,\n\t\t\t\tprivate cdRef: ChangeDetectorRef,\n\t\t\t\tprivate _org:OrganisationService\n    ) {\n\t\t\t\tsuper();\n        this.room = {} as room;\n    }\n\n    public ngOnInit(): void {\n        this.doc = new jsPDF();\n        history.pushState({}, '');\n\t\t\n        this.cityname = this?.rowInfoData?.building?.city;\n\n\t\t\t\tconst internalSubSet: DropdownOpion[] = this._org.getRoomTypeSubsetDDOptions('internal_room_types');\n\t\t\t\tconst externalSubset: DropdownOpion[] = this._org.getRoomTypeSubsetDDOptions('external_room_types');\n\t\t\t\tthis.roomSubsetOptions = {internal: internalSubSet, external: externalSubset};\n\n\t\t\t\tconst internal_or_external = this.rowInfoData?.roomobject?.internal_or_external; // ( this.rowInfoData?.roomobject?.filters?.external ? 'external' : 'internal') || this.rowInfoData?.settings;\n\n\t\t\t\tif(internal_or_external) {\n\t\t\t\t\tthis.givenRoomType =    typeof(internal_or_external) === 'string'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? internal_or_external \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: typeof(internal_or_external.value) === 'string'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? internal_or_external.value \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: internal_or_external.value.value;  // temporary fix\n\t\t\t\t}\n\t\t\t\tconst roomSubType = this.rowInfoData?.roomobject?.room_type;\n\t\t\t\tthis.givenRoomSubType = Array.isArray(roomSubType) && roomSubType.length \n\t\t\t\t\t\t\t\t\t\t?  roomSubType[0] \n\t\t\t\t\t\t\t\t\t\t: Array.isArray(roomSubType) && !roomSubType.length\n\t\t\t\t\t\t\t\t\t\t? 'conference'\n\t\t\t\t\t\t\t\t\t\t: roomSubType  || 'conference';\n\t\t\t\tthis.givenCateringAvailability = this.rowInfoData?.roomobject?.filters?.catering ? 'yes-onsite' : 'no';\n\t\t\t\t\n\n\t\t\t\tthis.rowInfoData && this.setAllDropdowns(this.rowInfoData);\n\n\n        this.reactiveForm = new FormGroup({\n           \n            roomname: new FormControl(this.rowInfoData.roomname, [\n                Validators.required,\n                Validators.maxLength(250),\n                Validators.minLength(1),\n                Validators.pattern('[^=`~!#$%*{};\\'\"]*'),\n                noWhitespaceValidator,\n            ]),\n\n            city: new FormControl({ value: this.cityname, disabled: true }, []),\n            level: new FormControl({ value: this.rowInfoData.level, disabled: true }, []),\n            roomnumber: new FormControl({ value: this.rowInfoData.roomnum, disabled: true }, []),\n\n          \n           \n           \n            internal_or_external: new FormControl( this.givenRoomType , []), \n\t\t\t\t\t\troom_type: new FormControl( this.givenRoomSubType, [] ),\n\n            capacity: new FormControl(this.rowInfoData.capacity.toString(), [\n                Validators.required,\n                Validators.maxLength(250),\n                Validators.pattern(/^(?!0+$)[0-9]{1,10}$/),\n            ]),\n\n\n            roomvisibility: new FormControl(this.rowInfoData.bookable),\n\t\t\t\t\t\tcatering: new FormControl(this.rowInfoData?.roomobject?.filters?.catering || false),\n\n\t\t\t\t\t\t// equipment_code === booking charge code ! if possible change equipment_code key to booking_charge_code \n\t\t\t\t\t\tequipment_code: new FormControl( this.rowInfoData?.roomobject?.filters?.equipment_code || this.rowInfoData?.settings['equipment_code'] || false),\n\t\t\t\t\t\tcharge_code: new FormControl(this.rowInfoData?.roomobject?.filters?.charge_code || this.rowInfoData.settings.charge_code || false),\n\n            vc: new FormControl(this.isFeatureChecked('vc')),\n            conference_phone: new FormControl(this.isFeatureChecked('conference_phone')),\n            wireless_content_sharing: new FormControl( this.isFeatureChecked('wireless_content_sharing')),\n            flipchart: new FormControl(this.isFeatureChecked('flipchart')),\n            glassboard: new FormControl(this.isFeatureChecked('glassboard')),\n            whiteboard: new FormControl(this.isFeatureChecked('whiteboard')),\n            natural_light: new FormControl(this.isFeatureChecked('natural_light')),\n            boardroom: new FormControl(this.isFeatureChecked('boardroom')),\n            cocktail: new FormControl(this.isFeatureChecked('cocktail')),\n            theatre: new FormControl(this.isFeatureChecked('theatre')),\n            workshop: new FormControl(this.isFeatureChecked('workshop')),\n            u_shape: new FormControl(this.isFeatureChecked('u_shape')),\n            miscellaneous: new FormControl(this.isFeatureChecked('miscellaneous')),\n        });\n\n\n\t\t\t\t\tsetupRoomImages(this, [1,2,3], this.rootFolderURL, this.roomImagesFileSlug);\n\n\t\t\t\t\tthis.subscription(\n\t\t\t\t\t\t'found_images',\n\t\t\t\t\t\tthis.loadImages.subscribe((imgArr: SpaceImageObject[]) => {\n\t\t\t\t\t\t\tthis.roomImages = imgArr;\n\t\t\t\t\t\t\tthis.cdRef.detectChanges();\n\t\t\t\t\t\t}));\n\t\t\t\t\n    }\n\n    \n\n    public isFeatureChecked(param: string) {\n        switch (param) {\n            case 'vc': {\n                return this.rowInfoData['equipment']?.vc || this.rowInfoData['settings']?.vc;\n            }\n            case 'natural_light': {\n                return this.rowInfoData['room_style']?.natural_light || this.rowInfoData['settings']?.natural_light;\n            }\n            default: {\n                const { extra_features } = this.rowInfoData['settings'];\n                return extra_features && extra_features?.includes(param) || this.rowInfoData['equipment']?.includes(param) || this.rowInfoData['room_style']?.includes(param);\n            }\n        }\n    }\n\n    get capacity() {\n\t\t\treturn this.reactiveForm.get('capacity');\n    }\n\n    get roomname() {\n\t\t\treturn this.reactiveForm.get('roomname');\n    }\n\n    public onSubmit(formValue: any) {\n\t\t\tlet roomObject = Object.assign({}, this.rowInfoData.roomobject);\n\n\t\t\tconst allowed_keys = [\n\t\t\t\t\t'edge_id',\n\t\t\t\t\t'name',\n\t\t\t\t\t'description',\n\t\t\t\t\t'email',\n\t\t\t\t\t'equipment',\n\t\t\t\t\t'capacity',\n\t\t\t\t\t'filters',\n\t\t\t\t\t'features',\n\t\t\t\t\t'bookable',\n\t\t\t\t\t'installed_ui_devices',\n\t\t\t\t\t'zones',\n\t\t\t\t\t'modules',\n\t\t\t\t\t'room_type',\n\t\t\t\t\t'room_style',\n\t\t\t\t\t'settings',\n\t\t\t\t\t'created_at',\n\t\t\t\t\t'support_url',\n\t\t\t\t\t'version',\n\t\t\t\t\t'id',\n\t\t\t];\n\n\t\t\t// this is to filter unwanted keys and make the request body match room model\n\t\t\troomObject = Object.keys(roomObject)\n\t\t\t\t\t.filter((key) => allowed_keys.includes(key))\n\t\t\t\t\t.reduce((obj, key) => {\n\t\t\t\t\t\t\tobj[key] = roomObject[key];\n\t\t\t\t\t\t\treturn obj;\n\t\t\t\t\t}, {});\n\n\n\t\t\troomObject.settings.room_name = formValue.roomname;\n\t\t\troomObject.simple_name = formValue.roomname;\n\n\t\t\tif(formValue.internal_or_external) {\n\t\t\t\troomObject.settings.internal_or_external = formValue.internal_or_external;\n\t\t\t\troomObject.filters['external'] = formValue.internal_or_external === 'external';\n\t\t\t}\n\t\t\troomObject.room_type = formValue.room_type;\n\t\t\troomObject.capacity = parseInt(formValue.capacity);\n\n\t\t\troomObject.bookable = formValue.roomvisibility;\n\t\t\troomObject.settings['equipment_code'] = formValue.equipment_code;\n\t\t\troomObject.filters['equipment_code'] = formValue.equipment_code;\n\n\t\t\troomObject.settings['catering'] = formValue.catering\n\t\t\troomObject.filters['catering'] = formValue.catering;\n\t\t\troomObject.settings['charge_code'] = formValue.charge_code;\n\t\t\troomObject.filters['charge_code'] = formValue.charge_code;\n\n\n\t\t\t\n\t\t\t// roomObject.features = getExtraFeatures();\n\t\t\troomObject.settings.extra_features = getExtraFeatures();\n\t\t\troomObject.settings.vc = formValue.vc;\n\t\t\troomObject.settings.natural_light = formValue.natural_light;\n\t\t\troomObject.filters['natural_light'] = formValue.natural_light;\n\n\t\t\tfunction getExtraFeatures() {\n\t\t\t\t\tconst excludeFromExtraFeatures = ['capacity','charge_code','internal_or_external', 'roomvisibility', 'roomname', 'vc', 'natural_light', 'equipment_code', 'catering', 'room_type'];\n\t\t\t\t\tlet features = '';\n\n\t\t\t\t\tObject.keys(formValue).forEach((element) => {\n\t\t\t\t\t\t\tconst isEqAndDetail = formValue[element];\n\t\t\t\t\t\t\t// console.log(SpaceEquipments[element]);\n\t\t\t\t\t\t\tif (!excludeFromExtraFeatures.includes(element) && isEqAndDetail) {\n\t\t\t\t\t\t\t\t\tfeatures += ` ${element}`;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif(SpaceEquipments[element]!==undefined && !roomObject?.equipment.includes(element) ) {\n\t\t\t\t\t\t\t\t\t\troomObject?.equipment.push(element);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t else if( SpaceStyles[element]!==undefined && !roomObject?.room_style.includes(element) ){\n\t\t\t\t\t\t\t\t\t\t  roomObject.room_style.push(element);\n\t\t\t\t\t\t\t\t\t } \n\t\t\t\t\t\t\t} else if(!isEqAndDetail) {\n\t\t\t\t\t\t\t\troomObject.features = roomObject.features.replace(element, '');\n\t\t\t\t\t\t\t\troomObject.equipment = SpaceEquipments[element]!==undefined ? roomObject.equipment.filter((value)=>value!=element) : roomObject.equipment; \n\t\t\t\t\t\t\t\troomObject.room_style = SpaceStyles[element]!==undefined ? roomObject.room_style.filter((value)=>value!=element) : roomObject.room_style; \n\t\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn features;\n\t\t\t}\n\n\t\t\tconst body = roomObject;\n\n\t\t\tif (this.reactiveForm.invalid) {\n\t\t\t\t\tfor (const control of Object.keys(this.reactiveForm.controls)) {\n\t\t\t\t\t\t\tthis.reactiveForm.controls[control].markAsTouched();\n\t\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t\tthis.disableButtons = true;\n\t\t\t\t\tthis.enableOverlay = true;\n\n\t\t\t\t\tthis._spaces.updateSpace(this.rowInfoData.id, body).subscribe(\n\t\t\t\t\t\t\t(data: any) => {\n\t\t\t\t\t\t\t\t\tthis.updateAllRooms(); // TO DO: this call enabled to pull all updated rooms to use on day/week view, In future remove this call here and day/week view should handle it there\n\t\t\t\t\t\t\t\t\tthis.disableButtons = false;\n\t\t\t\t\t\t\t\t\tthis.enableOverlay = false;\n\t\t\t\t\t\t\t\t\tthis.reactiveForm.markAsPristine();\n\t\t\t\t\t\t\t\t\tthis.cd.markForCheck();\n\t\t\t\t\t\t\t\t\tthis._snackBar.open('Operation Successful!', 'Close', {\n\t\t\t\t\t\t\t\t\t\tduration: 3000,\n\t\t\t\t\t\t\t\t\t\tpanelClass: ['room-admin-toast'],\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t(err: any) => {\n\t\t\t\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\t\t\t\tthis._snackBar.open('There was an error', 'Close', { duration: 3000 });\n\t\t\t\t\t\t\t\t\tthis.disableButtons = false;\n\t\t\t\t\t\t\t\t\tthis.enableOverlay = false;\n\t\t\t\t\t\t\t\t\tthis.cd.markForCheck();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t}\n\t\t\tthis.room = this.reactiveForm.value;\n    }\n\n    public updateAllRooms(): void {\n        this._spaces.query().then(() => { }).catch(() => {});\n    }\n\n    public onCancel() {\n\t\t\tthis._router.navigate(['room-admin']);\n    }\n\n\n\n\n\t\tpublic setAllDropdowns(rowInfoData) {\n\t\t\t// const {internal_or_external} = rowInfoData?.settings; \n\t\t\t// const roomType =  typeof(internal_or_external) === 'string' ? internal_or_external : internal_or_external.value;\n\n\t\t\tthis.roomTypeDD = {\n\t\t\t\tddBoxClass: 'room-type',\n\t\t\t\toptions: roomTypeOptions,\n\t\t\t\tdefaultSelected: roomTypeOptions.filter(el => el.value ===  this.givenRoomType )[0],\n\t\t\t\tonChangeCallback: this.roomTypeChanged.bind(this)\n\t\t\t};\n\t\t\t\n\t\t\tthis.roomSubsetDD = {\n\t\t\t\t\tdisabled: false,\n\t\t\t\t\tddBoxClass: 'room-subset',\n\t\t\t\t\toptions: this.roomSubsetOptions[this.roomTypeDD?.defaultSelected?.value.toString()],\n\t\t\t\t\tdefaultSelected: this.roomSubsetOptions[this.roomTypeDD?.defaultSelected?.value.toString()].filter(el => el.value === this.givenRoomSubType )[0],\n\t\t\t\t\tonChangeCallback: this.roomTypeSubsetChanged.bind(this)\n\t\t\t};\n\n\t\t\tthis.roomVisibilityDD = {\n\t\t\t\t\tddBoxClass: 'room-visibility',\n\t\t\t\t\toptions: roomVisibilityOptions,\n\t\t\t\t\tdefaultSelected: roomVisibilityOptions.filter(el => el.value === rowInfoData?.bookable.toString())[0],\n\t\t\t\t\tonChangeCallback: this.roomVisibilityChanged.bind(this)\n\t\t\t};\n\n\t\t\tthis.canteringAvailabilityDD = {\n\t\t\t\t\tdisabled: false,\n\t\t\t\t\tddBoxClass: 'catering-availability',\n\t\t\t\t\toptions: canteringAvailabilityOptions,\n\t\t\t\t\tdefaultSelected: canteringAvailabilityOptions.filter(el => el.value === this.givenCateringAvailability )[0],\n\t\t\t\t\tonChangeCallback: this.roomCateringChanged.bind(this)\n\t\t\t};\n\t\t}\n\n    /**\n\t * store selected border by sorting method and apply to \n\t * @param sortingValue \n\t */\n\tpublic roomTypeChanged(type: DropdownOpion) {\n\t\t\tthis.reactiveForm.controls.internal_or_external.setValue(type.value);\n\t\t\tthis.reactiveForm.markAsDirty();\n\n\t\t\tif(!this.roomSubsetDD.disabled) {\n\t\t\t\tthis.roomSubsetDD.options = this.roomSubsetOptions[type.value.toString()];\n        this.roomSubsetDD.defaultSelected = type.value === this.givenRoomType ? this.roomSubsetDD.options.filter(el => el.value ===  this.givenRoomSubType )[0] : this.roomSubsetOptions[type.value.toString()][0];\n\t\t\t\tthis.reactiveForm.controls.room_type.setValue(this.roomSubsetDD.defaultSelected.value);\n\t\t\t}\n\t\t\tthis.reactiveForm.markAsDirty();\n\t\t\tthis.cdRef.detectChanges();\n\t}\n\tpublic roomTypeSubsetChanged(subset: DropdownOpion ) {\n\t\t\t// console.log(subset);\n\t\t\tthis.reactiveForm.controls.room_type.setValue(subset.value);\n\t\t\tthis.reactiveForm.markAsDirty();\n\t}\n\n\tpublic roomVisibilityChanged(visibility: DropdownOpion) {\n\t\tthis.reactiveForm.controls.roomvisibility.setValue(visibility.value==='true');\n\t\tthis.reactiveForm.markAsDirty();\n\t}\n\n\tpublic roomCateringChanged(isCatering: DropdownOpion) {\n\t\tthis.reactiveForm.controls.catering.setValue(!(isCatering.value==='no'));\n\t\tthis.reactiveForm.markAsDirty();\n\t}\n\n    /**\n     * Function drawCanvas - Generate canvas as per required design for QR code\n     * https://mckinsey.atlassian.net/browse/CNG-10\n     * @param img\n     * @returns canvas image\n     */\n    drawCanvas(img): string | HTMLCanvasElement | HTMLImageElement {\n\t\t\t// TO DO : move to enum/utility file, while room detail more editable field developement \n\t\t\tconst width = 500;\n\t\t\tconst height = 550;\n\t\t\tconst arcY = 300;\n\t\t\tconst arc_X_Center = width/2;\n\t\t\tconst otrRadius = arc_X_Center - 2 ;\n\t\t\tconst whtRadius = otrRadius - 12;\n\t\t\tconst innrRadius = otrRadius - 15;\n\n\t\t\tconst canvas: HTMLCanvasElement = document.createElement('canvas');\n\t\t\tcanvas.setAttribute('width', width.toString());\n\t\t\tcanvas.setAttribute('height', height.toString());\n\t\t\tconst ctx = canvas.getContext('2d');\n\n\t\t\tctx.strokeStyle = \"transparent\";\n\t\t\tctx.moveTo(arc_X_Center, 0);\n\t\t\tctx.lineTo(arc_X_Center, height);\n\t\t\tctx.stroke(); \n\n\t\t\tctx.font = '14px McKinsey Sans, Helvetica Neue, Arial, sans-serif';\n\t\t\tctx.textAlign = \"center\";      \n\t\t\tctx.fillText(this.rowInfoData?.roomname , arc_X_Center, 20);  \n\n\t\t\t//oputer arc\n\t\t\tctx.beginPath();\n\t\t\tctx.arc(arc_X_Center, arcY, otrRadius, 0, 2 * Math.PI);\n\t\t\tctx.fillStyle = '#051C2C';\n\t\t\tctx.fill();\n\t\t\tctx.stroke();\n\n\t\t\t//inner white arc\n\t\t\tctx.beginPath();\n\t\t\tctx.arc(arc_X_Center, arcY, whtRadius, 0, 2 * Math.PI);\n\t\t\tctx.fillStyle = '#FFFFFF';\n\t\t\tctx.fill();\n\t\t\tctx.stroke();\n\n\t\t\t//second inner arc\n\t\t\tctx.beginPath();\n\t\t\tctx.arc(arc_X_Center, arcY, innrRadius, 0, 2 * Math.PI);\n\t\t\tctx.fillStyle = '#051C2C';\n\t\t\tctx.fill();\n\t\t\tctx.stroke();\n\n\t\t\t// header text\n\t\t\tctx.fillStyle = '#FFFFFF';\n\t\t\tctx.font = '44px Bower';\n\t\t\tctx.fillText('Book Me', arc_X_Center, 166);\n\n\t\t\t//centeral rectangle\n\t\t\tctx.fillRect(137, 187, 225, 225);\n\t\t\t//fill central rectangle with color\n\t\t\tctx.fillStyle = '#FFFFFF';\n\t\t\t\n\t\t\t// fill text at the bottom\n\t\t\tctx.font = '29px McKinsey Sans, Helvetica Neue, Arial, sans-serif';\n\t\t\tctx.fillText('in Converge', arc_X_Center, 470);\n\n\t\t\t// draw QR code image into center of canvas\n\t\t\timg !== null && ctx.drawImage(img, 137, 187);\n\n\t\t\t// create data url\n\t\t\tconst dataURL: string | HTMLCanvasElement | HTMLImageElement =\n\t\t\tcanvas.toDataURL('image/png');\n\t\t\treturn dataURL;\n    }\n\n    /**\n     * Function downloadQRPdf\n     * download generated QR code to the local system\n     */\n    public downloadQRPdf(roomid?: string): void {\n        // Get the generated QR code img and modifiy as per design\n        const qrcode = document.querySelector('.qr-code img');\n        let imageData = this.drawCanvas(qrcode);\n        // Add generated qr code image to the pdf\n        this.doc.addImage(imageData, 'JPEG', 3, 5, 100, 100);\n        \n\t\t\t\t// this.doc.addImage(imageData, \"JPEG\", 107, 5, 100, 100);\n\t\t\t\t// this.doc.addImage(imageData, \"JPEG\", 3, 130, 100, 100);\n\t\t\t\t// this.doc.addImage(imageData, \"JPEG\", 107, 130, 100, 100);\n        // this.doc.addImage(imageData, \"JPEG\", 10, 10);   // left commented for alignment reference later in future\n        // doc.addPage();\n\t\t\t\t// this.openQRInConverge();\n        this.doc.save(`${this.rowInfoData.id}.pdf`);\n    }\n\n    /**\n     * Not in use but keeping for future use\n     * Function openQRInConverge\n     * Open QR code in seperate tab\n     */\n    public openQRInConverge(): void {\n        const qrcode = document.querySelector('.qr-code img');\n        const dataURL = this.drawCanvas(qrcode);\n        const win = window.open();\n        win &&\n            win.document.write(\n                '<div style=\" height: 100%; flex-direction: row; box-sizing: border-box; display: flex; place-content: flex-start; align-items: flex-start; flex-flow: row wrap; box-sizing: border-box; display: flex;\" >\\\n\t\t\t\t\t\t\t<iframe src=\"' +\n                    dataURL +\n                    '\" frameborder=\"0\" style=\"border:0; width:500px; height:550px; margin:10px 10px 0 0 \" allowfullscreen> </iframe>\\\n\t\t\t\t\t\t</div>'\n            );\n    }\n\n\t\t/** Open modal for adding equipment requirements to booking */\n\t\tpublic openManagePhotosModal() {\n\t\t\tconst equipment_ref = this._dialog.open<ManagePhotosComponent>(ManagePhotosComponent, {\n\t\t\t\tmaxWidth: '95vw',\n\t\t\t\twidth: '70em',\n\t\t\t\tdata: {\n\t\t\t\t\tphotos: this.roomImages,\n\t\t\t\t\troom: this.rowInfoData\n\t\t\t\t\t}\n\t\t\t});\n\t\t\tthis.subscription(\n\t\t\t\t'equipments_modal_events',\n\t\t\t\tequipment_ref.componentInstance.event.subscribe((event: any) => {\n\t\t\t\t\t/* istanbul ignore else */\n\t\t\t\t\t\n\t\t\t\t\t\t// this.uploadedPhotos = event;\n\t\t\t\t\t\tsetupRoomImages(this, [1,2,3], this.rootFolderURL, this.roomImagesFileSlug);\n\t\t\t\t\t\t//equipment_ref.close();\n\t\t\t\t\t\n\t\t\t\t})\n\t\t\t);\n\t\t\tequipment_ref.afterClosed().subscribe(() => { \n\t\t\t\tthis.cdRef.detectChanges();\n\t\t\t\tthis.unsub('equipments_modal_events') \n\t\t\t});\n\t\t}\n\n\n\t\tpublic get timestamp () {\n\t\t\treturn (new Date()).getTime()\n\t\t}\n\n\n}\n","<form *ngIf=\"reactiveForm\" [formGroup]=\"reactiveForm\" #form=\"ngForm\" (submit)=\"onSubmit(form.value)\">\n\n\t<div class=\"flex-row\">\n\t\t<div class=\"flex-column details\" >\n\t\t\t<div class=\"flex-column form-elements\" >\n\t\t\t\t<label for=\"roomname\">Room name</label>\n\t\t\t\t<input type=\"text\" id=\"roomname\" name=\"roomname\" formControlName=\"roomname\"\n\t\t\t\t\t[class.is-invalid]=\"roomname.invalid && (roomname.dirty || roomname.touched)\" />\n\t\n\t\t\t\t\t<div class=\"roomname-suffix-msg flex-row\">\n\t\t\t\t\t\t<span  [class.err-msg]=\"roomname.invalid && (roomname.dirty || roomname.touched)\" >\n\t\t\t\t\t\t\t{{ \troomname.errors?.required \n\t\t\t\t\t\t\t\t\t\t\t\t? 'This field is required'\n\t\t\t\t\t\t\t\t\t\t\t\t: roomname.errors?.maxlength \n\t\t\t\t\t\t\t\t\t\t\t\t? 'This field must have at most 250 characters' \n\t\t\t\t\t\t\t\t\t\t\t\t: roomname.errors?.pattern \n\t\t\t\t\t\t\t\t\t\t\t  ? 'Some special characters and are not allowed'\n\t\t\t\t\t\t\t\t\t\t\t\t:\troomname.errors?.whitespace\n\t\t\t\t\t\t\t\t\t\t\t\t? 'Only spaces are not allowed'\n\t\t\t\t\t\t\t\t\t\t\t\t: 'System generated name '+ roomname.value + ' (can not be changed)' }} \t\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"section-group3\">\n\t\t\t\t<div class=\"flex-row form-elements grp3\" >\n\t\t\t\t\t<div class=\"flex-column\">\n\t\t\t\t\t\t<label for=\"city\" [class.disabled]=\"reactiveForm?.controls?.city?.disabled\">City</label>\n\t\t\t\t\t\t<input type=\"text\" id=\"city\" name=\"city\" formControlName=\"city\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex-column\">\n\t\t\t\t\t\t<label for=\"level\" [class.disabled]=\"reactiveForm?.controls?.level?.disabled\">Level</label>\n\t\t\t\t\t\t<input formControlName=\"level\" type=\"text\" id=\"level\" name=\"level\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex-column room-no flex\">\n\t\t\t\t\t\t<label for=\"roomnumber\" [class.disabled]=\"reactiveForm?.controls?.roomnumber?.disabled\">Room no.</label>\n\t\t\t\t\t\t<input type=\"text\" id=\"roomnumber\" name=\"roomnumber\" formControlName=\"roomnumber\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\n\t\t\t\t<div class=\"flex-row form-elements grp3\" >\n\t\t\t\t\t<div class=\"flex-column\">\n\t\t\t\t\t\t<label for=\"level\">Room type</label>\n\t\t\t\t\t\t<cng-select [data]=\"roomTypeDD\" ></cng-select>\n\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex-column\">\n\t\t\t\t\t\t<label for=\"level\">Room subset</label>\t\t\n\t\t\t\t\t\t<cng-select [data]=\"roomSubsetDD\" ></cng-select>\n\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex-column room-capacity flex\">\n\t\t\t\t\t\t<label for=\"capacity\">Capacity</label>\n\t\t\t\t\t\t<input formControlName=\"capacity\" required minlength=\"1\" maxlength=\"250\" type=\"text\" id=\"capacity\" name=\"capacity\"\n\t\t\t\t\t\t\t[class.is-invalid]=\"capacity.invalid && (capacity.dirty || capacity.touched)\" />\n\t\t\t\t\t\t<div *ngIf=\"capacity.invalid && (capacity.dirty || capacity.touched)\" class=\"err-msg flex-row\">\n\t\t\t\t\t\t\t<span > {{\n\t\t\t\t\t\t\t\t\t\t\t\tcapacity.errors?.required \n\t\t\t\t\t\t\t\t\t\t\t\t? 'This field is required'\n\t\t\t\t\t\t\t\t\t\t\t\t: capacity.errors?.maxlength\n\t\t\t\t\t\t\t\t\t\t\t\t? 'This field must have at most 250 characters'\n\t\t\t\t\t\t\t\t\t\t\t\t: capacity.errors?.pattern \n\t\t\t\t\t\t\t\t\t\t\t\t? 'Zero, letters and special characters are not allowed'\n\t\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\n\t\t\t<div class=\"section-group2 flex-column\">\n\t\t\t\t<div class=\"flex-row form-elements grp2\" >\n\t\t\t\t\t<div class=\"flex-column\">\n\t\t\t\t\t\t<label for=\"level\">Room visibility</label>\n\t\t\t\t\t\t<cng-select [data]=\"roomVisibilityDD\" ></cng-select>\n\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex-column\">\n\t\t\t\t\t\t<label for=\"level\">Catering availability</label>\t\t\n\t\t\t\t\t\t<cng-select [data]=\"canteringAvailabilityDD\" ></cng-select>\n\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"flex-row form-elements grp2\" >\n\t\t\t\t\t<div class=\"flex-row\">\n\t\t\t\t\t\t<mat-slide-toggle  name=\"equipment_code\"  formControlName=\"equipment_code\" ></mat-slide-toggle> <!-- name=\"bookingChargeCode\" -->\n\t\t\t\t\t\t<span class=\"label\" for=\"equipment_code\"> &nbsp; Booking charge code required</span> \n\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex-row\">\n\t\t\t\t\t\t<mat-slide-toggle name=\"cateringChargeCode\" formControlName=\"charge_code\" ></mat-slide-toggle>\n\t\t\t\t\t\t<span class=\"label\" for=\"cateringChargeCode\"> &nbsp; Catering charge code required</span> \n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t\t\n\t\t\t<div class=\"section-group-accordion\">\n\t\t\t\t<mat-accordion>\n\t\t\t\t\t<mat-expansion-panel>\n\t\t\t\t\t\t<mat-expansion-panel-header>\n\t\t\t\t\t\t\t<mat-panel-title> Room equipment and detail </mat-panel-title>\n\t\t\t\t\t\t</mat-expansion-panel-header>\n\t\t\t\t\t\t<p class=\"mat-panel-heading\">Room Equipment</p>\n\t\t\t\t\t\t<div class=\"accordion-row\">\n\t\t\t\t\t\t\t<p>Video Conference (VC)</p>\n\t\t\t\t\t\t\t<mat-slide-toggle name=\"vc\" formControlName=\"vc\"></mat-slide-toggle>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"accordion-row\">\n\t\t\t\t\t\t\t<p>Conference phone</p>\n\t\t\t\t\t\t\t<mat-slide-toggle name=\"conference_phone\" formControlName=\"conference_phone\"></mat-slide-toggle>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"accordion-row\">\n\t\t\t\t\t\t\t<p>Wireless content sharing</p>\n\t\t\t\t\t\t\t<mat-slide-toggle name=\"wireless_content_sharing\" formControlName=\"wireless_content_sharing\"></mat-slide-toggle>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"accordion-row\">\n\t\t\t\t\t\t\t<p>Flipchart</p>\n\t\t\t\t\t\t\t<mat-slide-toggle name=\"flipchart\" formControlName=\"flipchart\"></mat-slide-toggle>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"accordion-row\">\n\t\t\t\t\t\t\t<p>Glassboard</p>\n\t\t\t\t\t\t\t<mat-slide-toggle name=\"glassboard\" formControlName=\"glassboard\"></mat-slide-toggle>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"accordion-row\">\n\t\t\t\t\t\t\t<p>Whiteboard</p>\n\t\t\t\t\t\t\t<mat-slide-toggle name=\"whiteboard\" formControlName=\"whiteboard\"></mat-slide-toggle>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p class=\"mat-panel-heading\">Room Detail</p>\n\t\t\t\t\t\t<div class=\"accordion-row\">\n\t\t\t\t\t\t\t<p>Room with window only (natural light)</p>\n\t\t\t\t\t\t\t<mat-slide-toggle name=\"natural_light\" formControlName=\"natural_light\"></mat-slide-toggle>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"accordion-row\">\n\t\t\t\t\t\t\t<p>Boardroom room style</p>\n\t\t\t\t\t\t\t<mat-slide-toggle name=\"boardroom\" formControlName=\"boardroom\"></mat-slide-toggle>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"accordion-row\">\n\t\t\t\t\t\t\t<p>Cocktail room style</p>\n\t\t\t\t\t\t\t<mat-slide-toggle name=\"cocktail\" formControlName=\"cocktail\"></mat-slide-toggle>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"accordion-row\">\n\t\t\t\t\t\t\t<p>Theatre room style</p>\n\t\t\t\t\t\t\t<mat-slide-toggle name=\"theatre\" formControlName=\"theatre\"></mat-slide-toggle>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"accordion-row\">\n\t\t\t\t\t\t\t<p>Workshop room style</p>\n\t\t\t\t\t\t\t<mat-slide-toggle name=\"workshop\" formControlName=\"workshop\"></mat-slide-toggle>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"accordion-row\">\n\t\t\t\t\t\t\t<p>U shape room style</p>\n\t\t\t\t\t\t\t<mat-slide-toggle name=\"u_shape\" formControlName=\"u_shape\"></mat-slide-toggle>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"accordion-row\">\n\t\t\t\t\t\t\t<p>Miscellaneous</p>\n\t\t\t\t\t\t\t<mat-slide-toggle name=\"miscellaneous\" formControlName=\"miscellaneous\"></mat-slide-toggle>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</mat-expansion-panel>\n\t\t\t\t</mat-accordion>\n\t\t\t</div>\n\t\t\t\n\t\n\t\t</div>\n\t</div>\n\n\t<button mat-button type=\"submit\"  class=\"primary submit-button\"  [disabled]=\"disableButtons || !reactiveForm.dirty || reactiveForm.invalid\"> Save changes </button>\n\t<button mat-button type=\"button\"  class=\"primary cancel-button\" [disabled]=\"disableButtons || !reactiveForm.dirty || reactiveForm.invalid\" (click)=\"onCancel()\"> Discard changes </button>\n\n\t<div class=\"overlay\" [ngClass]=\"{ 'enable-overlay': enableOverlay }\"></div>\n\t<mat-spinner class=\"spinner\" [ngClass]=\"{ 'enable-overlay': enableOverlay }\"></mat-spinner>\n</form>\n\n<div class=\"qr-section flex-column\">\n\t<div class=\"sub-row srqr\">\n\t\t<span class=\"name\" for=\"roomname\">Room URL</span>\n\t\t<div class=\"staff-url flex-row\">\n\t\t\t<span id=\"roomUrl\">{{ windowLocation.origin }}/staff/#/home?id={{ rowInfoData.id }}</span>\n\t\t\t<a class=\"flex-row\" [href]=\"windowLocation.origin + '/staff/#/home?id=' + rowInfoData.id\" target=\"_blank\"\n\t\t\t\trel=\"noopener noreferrer\">\n\t\t\t\t<app-icon [icon]=\"{ class: 'material-icons', type: 'img', src: './assets/img/Arrow.svg' }\"></app-icon>\n\t\t\t</a>\n\t\t</div>\n\t\t<label class=\"flex-row disabled\" for=\"roomname\" >Room URL is generated automatically and cannot be changed</label>\n\t</div>\n\t<div class=\"qr-footer flex-row\">\n\t\t<button mat-button class=\"qr-inverse\" name=\"PDF\" (click)=\"downloadQRPdf()\">\n\t\t\tDownload QR Code (PDF)\n\t\t</button>\n\t\t<!-- keeping this for future use -->\n\t\t<!-- <button mat-button class=\"qr-inverse\" name=\"tab\" (click)=\"openQRInConverge()\">\n            Open the Room Detail in Converge\n        </button> -->\n\t</div>\n\t<div class=\"qrcodeImage flex-row\">\n\t\t<qrcode [qrdata]=\"windowLocation.origin + '/staff/#/home?id=' + rowInfoData.id\" [allowEmptyString]=\"true\"\n\t\t\t[alt]=\"'A custom alt attribute'\" [ariaLabel]=\"'QR Code image with the following content...'\"\n\t\t\t[cssClass]=\"'qr-code'\" [colorDark]=\"'#051C2C'\" [colorLight]=\"'#FFFFFF'\" [elementType]=\"'img'\"\n\t\t\t[errorCorrectionLevel]=\"'M'\" [margin]=\"3\" [scale]=\"1\" [title]=\"'A custom title attribute'\" [width]=\"225\"\n\t\t\t[ngStyle]=\"{ display: 'none' }\"></qrcode>\n\t</div>\n</div>\n\n<div class=\" main room-photos\" >\n\t<div class=\"section-group4 flex-column \">\n\t\t<div class=\"flex-row\" >\n\t\t\t<div class=\"flex-column \">\n\t\t\t\t<label for=\"level\">Room Photos</label>\n\t\t\t\t<div class=\"flex-row \" *ngIf=\"roomImages.length\" [ngStyle]=\"{'margin-bottom': '15px'}\">\n\t\t\t\t\t\t<div class=\"image flex-row\" *ngFor=\"let photos of roomImages\">\n\t\t\t\t\t\t\t<img class=\"\" [src]=\"photos.path +'?'+ timestamp\" style=\"width: 375px;height: 200px;\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t<button mat-button class=\"admn-btns manage-photos\" [ngClass]=\"{'showing-photos' : uploadedPhotos.length}\" name=\"room-photos\" (click)=\"openManagePhotosModal()\" >Manage Photos</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n","import { DataSource } from '@angular/cdk/collections';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { MatSort } from '@angular/material/sort';\nimport { map } from 'rxjs/operators';\nimport { Observable, of as observableOf, merge } from 'rxjs';\nimport { Component, OnInit, Input, Injectable } from '@angular/core';\n\n\n// data model \nexport interface RoomsTableItem {\n  roomname: string;\n  roomnum: string;\n  level: string;\n  capacity: number;\n  roomtype: string;\n  bookable: boolean;\n}\n\n// sample data\nconst EXAMPLE_DATA: RoomsTableItem[] = [\n  {\n    roomname: 'test',\n    roomnum: '02',\n    level: '01',\n    capacity: 4,\n    roomtype: 'internal',\n    bookable: true,\n}\n];\n\n/**\n * Data source for the RoomsTable view. This class should\n * encapsulate all logic for fetching and manipulating the displayed data\n * (including sorting, pagination, and filtering).\n */\n\n// convert this class into service and use provider:root\n@Injectable({\n  providedIn: 'root',\n})\nexport class RoomsTableDataSource extends DataSource<RoomsTableItem> {\n  data: RoomsTableItem[] = EXAMPLE_DATA;\n  paginator: MatPaginator;\n  sort: MatSort;\n\n\n  constructor(public datatwo: RoomsTableItem[],\n    ) {\n    super();\n    this.data = datatwo;\n  }\n\n  /**\n   * Connect this data source to the table. The table will only update when\n   * the returned stream emits new items.\n   * @returns A stream of the items to be rendered.\n   */\n  \n    \n  connect(): Observable<RoomsTableItem[]> {\n    // Combine everything that affects the rendered data into one update\n    // stream for the data-table to consume.\n\n    const dataMutations = [\n      observableOf(this.data),\n      this.paginator.page,\n      this.sort.sortChange\n    ];\n\n    return merge(...dataMutations).pipe(map(() => {\n      return this.getPagedData(this.getSortedData([...this.data]));\n    }));\n  }\n\n  /**\n   *  Called when the table is being destroyed. Use this function, to clean up\n   * any open connections or free any held resources that were set up during connect.\n   */\n  disconnect() {}\n\n  /**\n   * Paginate the data (client-side). If you're using server-side pagination,\n   * this would be replaced by requesting the appropriate data from the server.\n   */\n  private getPagedData(data: RoomsTableItem[]) {\n    const startIndex = this.paginator.pageIndex * this.paginator.pageSize;\n    return data.splice(startIndex, this.paginator.pageSize);\n  }\n\n  /**\n   * Sort the data (client-side). If you're using server-side sorting,\n   * this would be replaced by requesting the appropriate data from the server.\n   */\n  private getSortedData(data: RoomsTableItem[]) {\n    if (!this.sort.active || this.sort.direction === '') {\n      return data;\n    }\n\n    return data.sort((a, b) => {\n      const isAsc = this.sort.direction === 'asc';\n      switch (this.sort.active) {\n        case 'roomname': return compare(a.roomname, b.roomname, isAsc);\n        case 'roomnum': return compare(+a.roomnum, +b.roomnum, isAsc);\n        case 'level': return compare(+a.level, +b.level, isAsc);\n        case 'capacity': return compare(+a.capacity, +b.capacity, isAsc);\n        case 'roomtype': return compare(a.roomtype, b.roomtype, isAsc);\n        case 'bookable': return compare(+a.bookable, +b.bookable, isAsc);\n        default: return 0;\n      }\n    });\n  }\n}\n\n\n/** Simple sort comparator for example ID/Name columns (for client-side sorting). */\nfunction compare(a: string | number, b: string | number, isAsc: boolean) {\n  return (a < b ? -1 : 1) * (isAsc ? 1 : -1);\n}\n","import {\n    AfterViewInit,\n    Component,\n    OnInit,\n    ViewChild,\n    Input,\n    ViewEncapsulation,\n    ChangeDetectionStrategy,\n    Output,\n    EventEmitter,\n    ChangeDetectorRef,\n    SimpleChanges,\n} from '@angular/core';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { MatSort } from '@angular/material/sort';\nimport { MatTable } from '@angular/material/table';\nimport { RoomsTableDataSource, RoomsTableItem } from './rooms-table-datasource';\nimport { first } from 'rxjs/operators';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\nimport { ActivatedRoute, Router } from '@angular/router';\n\n@Component({\n    selector: 'app-rooms-table',\n    templateUrl: './rooms-table.component.html',\n    styleUrls: ['./rooms-table.component.scss'],\n})\nexport class RoomsTableComponent extends BaseDirective implements AfterViewInit, OnInit {\n    @ViewChild(MatPaginator) paginator: MatPaginator;\n    @ViewChild(MatSort) sort: MatSort;\n    @ViewChild(MatTable) table: MatTable<RoomsTableItem>;\n    dataSource: RoomsTableDataSource;\n\n    constructor(private _org: OrganisationService, \n        private _router: Router,\n        private route: ActivatedRoute,\n        private cdref: ChangeDetectorRef,) {\n        super();\n    }\n\n    public formattedInputValue: [];\n\n    @Input() set inputValue(value: []) {\n        this.formattedInputValue = value;\n    }\n\n    @Output() private onDetailsClick = new EventEmitter<number>();\n\n    @Output() public rowClicked = new EventEmitter<[]>();\n\n    /** Columns displayed in the table. Columns IDs can be added, removed, or reordered. */\n    // tslint:disable-next-line: max-line-length\n    public displayedColumns = [\n        'roomname',\n        'roomnum',\n        'level',\n        'capacity',\n        'roomtype',\n        'bookable',\n        'details',\n    ];\n\n    public detailsViewIndex = 0;\n\n    public _onDetailsClick(index: number) {\n        this.onDetailsClick.emit(index);\n    }\n\n    public ngOnInit() {\n        this.dataSource = new RoomsTableDataSource(this.formattedInputValue);\n    }\n    public ngOnChanges(changes: SimpleChanges): void {\n    //    console.log(changes);\n       this.dataSource = new RoomsTableDataSource(this.formattedInputValue);\n        if(!changes.inputValue.firstChange)    {\n            this.dataSource.sort = this.sort;\n            this.dataSource.paginator = this.paginator;\n            this.table.dataSource = this.dataSource;\n            this.paginator.firstPage();\n            this.cdref.detectChanges();\n        }\n   \n    }\n\n    // ngAfterViewInit heavy on performance, figure out api\n    // function that gives callback after html loads\n    // eg, onchange, check mat table documentation\n\n    public ngAfterViewInit() {\n    //     this.dataSource.sort = this.sort;\n    //     this.dataSource.paginator = this.paginator;\n    //     this.table.dataSource = this.dataSource;\n    //     this.paginator.firstPage();\n    }\n\n    public getRecord(row: []) {\n        const navigationExtras = {\n            relativeTo:this.route,\n            skipLocationChange: true ,\n            state: {\n                details: { ...row }\n            }\n        }\n        this._router.navigate(['room-details'], navigationExtras)\n    }\n}\n","<div class=\"mat-elevation-z8 table\">\n    <table mat-table class=\"full-width-table\" matSort aria-label=\"Elements\">\n        <!-- Column -->\n        <ng-container matColumnDef=\"roomname\">\n            <th mat-header-cell *matHeaderCellDef mat-sort-header>Room Name</th>\n            <td mat-cell *matCellDef=\"let row\">{{ row.roomname }}</td>\n        </ng-container>\n\n        <!-- Column -->\n        <ng-container matColumnDef=\"roomnum\">\n            <th mat-header-cell *matHeaderCellDef mat-sort-header>Room Number</th>\n            <td mat-cell *matCellDef=\"let row\">{{ row.roomnum }}</td>\n        </ng-container>\n\n        <!-- Column -->\n        <ng-container matColumnDef=\"level\">\n            <th mat-header-cell *matHeaderCellDef mat-sort-header>Level</th>\n            <td mat-cell *matCellDef=\"let row\">{{ row.level }}</td>\n        </ng-container>\n\n        <!-- Column -->\n        <ng-container matColumnDef=\"capacity\">\n            <th mat-header-cell *matHeaderCellDef mat-sort-header>Capacity</th>\n            <td mat-cell *matCellDef=\"let row\">{{ row.capacity }}</td>\n        </ng-container>\n\n        <!-- Column -->\n        <ng-container matColumnDef=\"roomtype\">\n            <th mat-header-cell *matHeaderCellDef mat-sort-header>Room Type</th>\n            <td mat-cell *matCellDef=\"let row\">\n                <span *ngIf=\"row.roomtype == 'internal'; else elseBlock\">Internal</span>\n                <ng-template #elseBlock>External</ng-template>\n            </td>\n        </ng-container>\n\n        <!-- Column -->\n        <ng-container matColumnDef=\"bookable\">\n            <th mat-header-cell *matHeaderCellDef mat-sort-header>Room visibility</th>\n            <td mat-cell *matCellDef=\"let row\">\n                <span *ngIf=\"row.bookable; else elseBlock\">Bookable</span>\n                <ng-template #elseBlock>Non Bookable</ng-template>\n            </td>\n        </ng-container>\n\n        <!-- Column -->\n        <ng-container matColumnDef=\"details\">\n            <th mat-header-cell *matHeaderCellDef mat-sort-header></th>\n            <td mat-cell *matCellDef=\"let row\">\n                <button mat-stroked-button (click)=\"_onDetailsClick(1)\" (click)=\"getRecord(row)\">\n                    View Details\n                </button>\n            </td>\n        </ng-container>\n\n        <tr mat-header-row *matHeaderRowDef=\"displayedColumns; sticky: true\"></tr>\n        <tr mat-row *matRowDef=\"let row; columns: displayedColumns\"></tr>\n    </table>\n\n    <mat-paginator\n        #paginator\n        [length]=\"dataSource?.data?.length\"\n        [pageIndex]=\"0\"\n        [pageSize]=\"10\"\n        [pageSizeOptions]=\"[10, 20, 30]\"\n    >\n    </mat-paginator>\n</div>\n","export * from './resize.service';\nexport * from './read-local-pic.service';\n// export * from './room-admin.service';","import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root',\n})\n\nexport class ReadLocalPicService {\n  /**\n   * eventErrorDecoder\n   * @param event \n   * @returns errorMessage\n   */\n  private eventErrorDecoder(event: any): string {\n    let errorMessage = null;\n\n    switch (event.target.error.code) {\n      case event.target.error.NOT_FOUND_ERR:\n        errorMessage = 'NOT_FOUND_ERR';\n        break;\n      case event.target.error.SECURITY_ERR:\n        errorMessage = 'SECURITY_ERR';\n        break;\n      case event.target.error.ABORT_ERR:\n        errorMessage = 'ABORT_ERR';\n        break;\n      case event.target.error.NOT_READABLE_ERR:\n        errorMessage = 'NOT_READABLE_ERR';\n        break;\n      case event.target.error.ENCODING_ERR:\n        errorMessage = 'ENCODING_ERR';\n        break;\n      case event.target.error.NO_MODIFICATION_ALLOWED_ERR:\n        errorMessage = 'NO_MODIFICATION_ALLOWED_ERR';\n        break;\n      case event.target.error.INVALID_STATE_ERR:\n        errorMessage = 'INVALID_STATE_ERR';\n        break;\n      case event.target.error.SYNTAX_ERR:\n        errorMessage = 'SYNTAX_ERR';\n        break;\n      case event.target.error.INVALID_MODIFICATION_ERR:\n        errorMessage = 'INVALID_MODIFICATION_ERR';\n        break;\n      case event.target.error.QUOTA_EXCEEDED_ERR:\n        errorMessage = 'QUOTA_EXCEEDED_ERR';\n        break;\n      case event.target.error.TYPE_MISMATCH_ERR:\n        errorMessage = 'TYPE_MISMATCH_ERR';\n        break;\n      case event.target.error.PATH_EXISTS_ERR:\n        errorMessage = 'PATH_EXISTS_ERR';\n        break;\n      default:\n        errorMessage = 'Unknown Error: ' + event.target.error.code;\n        break;\n    }\n    return errorMessage;\n  }\n\n  /**\n   * \n   * @param inputFile \n   * @returns \n   */\n  async readFileInput(inputFile: any): Promise<string> {\n    return new Promise<string>((resolve, reject) => {\n      if (!inputFile ) {\n        reject('No file selected');\n      } else {\n        if (\n          !(window.File && window.FileReader && window.FileList && window.Blob)\n        ) {\n          reject('Your browser does not support reading files');\n        }\n\n        const reader = new FileReader();\n        reader.onload = (e: any) => {\n          resolve(e.target.result);\n        };\n        reader.onabort = (e: any) => {\n          reject(\n            'Failed to convert file to base64img, aborted: ' +\n              this.eventErrorDecoder(e)\n          );\n        };\n        reader.onerror = (e: any) => {\n          reject(\n            'Failed to convert file to base64img, error: ' +\n              this.eventErrorDecoder(e)\n          );\n        };\n\n        reader.readAsDataURL(inputFile);\n      }\n    });\n  }\n\n\n  b64toFile(dataURI): File {\n    // convert the data URL to a byte string\n    const byteString = atob(dataURI.split(',')[1]);\n\n    // pull out the mime type from the data URL\n    const mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0]\n\n    // Convert to byte array\n    const ab = new ArrayBuffer(byteString.length);\n    const ia = new Uint8Array(ab);\n    for (let i = 0; i < byteString.length; i++) {\n        ia[i] = byteString.charCodeAt(i);\n    }\n\n    // new File\n    // Create a blob that looks like a file.\n    const blob = new File([ab],'room-photo.png', { 'type': mimeString });\n    // blob['lastModifiedDate'] = (new Date()).toISOString();\n    // blob['name'] = 'file';\n        \n    // Figure out what extension the file should have\n    // switch(blob.type) {\n    //     case 'image/jpeg':\n    //         blob['name'] += '.jpg';\n    //         break;\n    //     case 'image/png':\n    //         blob['name'] += '.png';\n    //         break;\n    // }\n    // cast to a File\n    return <File>blob;\n  }\n\n}\n","import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class ResizeService {\n  private mainCanvas: HTMLCanvasElement;\n\n  private isCanvasSupported(): boolean {\n    const canvas = document.createElement('canvas');\n    return !!(canvas.getContext && canvas.getContext('2d'));\n  }\n\n  /**\n   * Create image on the fly using Image class \n   * @param src \n   * @param crossOrigin \n   * @returns image\n   */\n  async createImage(\n    src: string,\n    crossOrigin?: string\n  ): Promise<HTMLImageElement> {\n    return new Promise<HTMLImageElement>((resolve, reject) => {\n      const img = new Image();\n      if (crossOrigin) {\n        img.crossOrigin = crossOrigin;\n      }\n\n      img.onload = () => {\n        resolve(img);\n      };\n\n      img.onerror = (err) => {\n        reject(err);\n      };\n\n      img.src = src;\n    });\n  }\n\n  /**\n   * Resize canvas - create canvas on the fly draw image with given diamension\n   * @param cnv \n   * @param width \n   * @param height \n   * @returns temp canvas instance\n   */\n  resizeCanvas(\n    cnv: HTMLCanvasElement,\n    width: number,\n    height: number\n  ): HTMLCanvasElement {\n    if (!width || !height) {\n      return cnv;\n    }\n\n    const tmpCanvas = document.createElement('canvas');\n    tmpCanvas.width = width;\n    tmpCanvas.height = height;\n    const cnx = tmpCanvas.getContext('2d');\n    cnx.drawImage(cnv, 0, 0, tmpCanvas.width, tmpCanvas.height);\n    return tmpCanvas;\n  }\n\n  /**\n   * Resize image \n   * @param src <base64Img or blob>\n   * @param options <e.g. width, height, sizeScale, step, crossOrigin>\n   * @returns \n   */\n  async resizeImage(src: string, options: any): Promise<string> {\n    if (!this.isCanvasSupported()) {\n      throw new Error('Canvas is not supported on your browser');\n    }\n    if (!options || !src) {\n      throw new Error('Missing argument when calling resizeImage function');\n    }\n    //Config options\n    options = {\n      height: options.height\n        ? options.height\n        : options.width\n        ? null\n        : options.size\n        ? null\n        : 1024,\n      width: options.width\n        ? options.width\n        : options.height\n        ? null\n        : options.size\n        ? null\n        : 1024,\n      size: options.size ? options.size : 500,\n      sizeScale: options.sizeScale ? options.sizeScale : 'ko',\n      step: options.step ? options.step : 3,\n      outputFormat: options.outputFormat ? options.outputFormat : 'image/jpeg',\n      crossOrigin: options.crossOrigin ? options.crossOrigin : null,\n    };\n\n    try {\n      const img = await this.createImage(src, options.crossOrigin); // read image first by given base64 or blob image\n\n      if (options.height || options.width) {\n        // resize image as per height and width\n        return this.resizeImageWidthHeight(\n          img,\n          options.width,\n          options.height,\n          options.step,\n          options.outputFormat\n        );\n      } else if (options.size) {\n        if (typeof options.sizeScale === 'string') {\n          switch (options.sizeScale.toLowerCase()) {\n            case 'ko':\n              options.size *= 1024;\n              break;\n            case 'mo':\n              options.size *= 1024 * 1024;\n              break;\n            case 'go':\n              options.size *= 1024 * 1024 * 1024;\n              break;\n          }\n        }\n        return this.resizeImageBySize(img, options.size, options.outputFormat); //resize by size in diamension ration\n      } else {\n        throw new Error('Missing option to resize the image');\n      }\n    } catch (err) {\n      throw new Error(err);\n    }\n  }\n\n  /**\n   * ResizeImageWidthHeight - Create canvas - draw image if given height and with OR use image original diamensions\n   * and draw image data url\n   * @param image \n   * @param width \n   * @param height \n   * @param step \n   * @param outputFormat \n   * @returns \n   */\n  resizeImageWidthHeight(\n    image: HTMLImageElement,\n    width: number,\n    height: number,\n    step: number,\n    outputFormat: string\n  ): string {\n    if (!image) {\n      return null;\n    }\n    if (!outputFormat) {\n      outputFormat = 'image/jpeg';\n    }\n\n    this.mainCanvas = document.createElement('canvas');\n\n    if (!width && !height) {\n      width = image.width;\n      height = image.height;\n    } else if (!width && height) {\n      width = (height / image.height) * image.width;\n    } else if (width && !height) {\n      height = (width / image.width) * image.height;\n    }\n\n    const pixelStepWidth = image.width === width || !step ? 0 : (image.width - width) / step;\n    const pixelStepHeight = image.height === height || !step ? 0 : (image.height - height) / step;\n    this.mainCanvas.width = image.width;\n    this.mainCanvas.height = image.height;\n\n    this.mainCanvas\n      .getContext('2d')\n      .drawImage(image, 0, 0, this.mainCanvas.width, this.mainCanvas.height);\n    for (let i = 1; i < step; i++) {\n      const newWidth = image.width - pixelStepWidth * i;\n      const newHeight = image.height - pixelStepHeight * i;\n      this.mainCanvas = this.resizeCanvas(this.mainCanvas, newWidth, newHeight);\n    }\n    this.mainCanvas = this.resizeCanvas(this.mainCanvas, width, height);\n\n    return this.mainCanvas.toDataURL(outputFormat);\n  }\n\n  /**\n   * resizeImageBySize - resize image by given size in ration \n   *  \n   * @param image \n   * @param targetSize \n   * @param outputFormat \n   * @returns \n   */\n  resizeImageBySize(\n    image: HTMLImageElement,\n    targetSize: number,\n    outputFormat: string\n  ): string {\n    if (!image) {\n      return null;\n    }\n    if (!outputFormat) {\n      outputFormat = 'image/jpeg';\n    }\n\n    this.mainCanvas = document.createElement('canvas');\n    this.mainCanvas.width = image.width;\n    this.mainCanvas.height = image.height;\n    this.mainCanvas\n      .getContext('2d')\n      .drawImage(image, 0, 0, this.mainCanvas.width, this.mainCanvas.height);\n\n    let tmpResult = this.mainCanvas.toDataURL(outputFormat);\n    let result = tmpResult;\n\n    const sizeOfTheImage = this.calulateImageSize(tmpResult, outputFormat);\n    let divideStrategy = Math.max(\n      1,\n      Math.min(sizeOfTheImage / targetSize, 200)\n    );\n\n    let iteratorLimit = 20;\n    while (sizeOfTheImage > targetSize && iteratorLimit !== 0) {\n      iteratorLimit--;\n\n      const newImageSize = {\n        width: this.mainCanvas.width / divideStrategy,\n        height: this.mainCanvas.height / divideStrategy,\n      };\n      const canvas = this.resizeCanvas(\n        this.mainCanvas,\n        newImageSize.width,\n        newImageSize.height\n      );\n\n      tmpResult = canvas.toDataURL(outputFormat);\n      const sizeOfTheImageTmp = this.calulateImageSize(tmpResult, outputFormat);\n\n      if (sizeOfTheImageTmp / targetSize < 0.5 || sizeOfTheImageTmp === 0) {\n        divideStrategy = divideStrategy / 2;\n        if (divideStrategy < 1) {\n          iteratorLimit = 0;\n        }\n      } else {\n        this.mainCanvas = canvas;\n        result = tmpResult;\n      }\n\n      this.mainCanvas = canvas;\n    }\n\n    return result;\n  }\n\n  calulateImageSize(imgString: string, outputFormat: string): number {\n    switch (outputFormat) {\n      case 'image/jpeg':\n        outputFormat = 'image/jpg';\n        break;\n      default:\n        outputFormat = 'image/jpg';\n        break;\n    }\n    return Math.max(\n      0,\n      Math.round(\n         ((imgString.length - ('data:' + outputFormat + ';base64,').length) *3) / 4  \n        )\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport jsPDF from 'jspdf';\n@Injectable({  \n  providedIn: 'root'  \n})  \nexport class RoomAdminService { \n    \n    public doc = new jsPDF();\n\n     /**\n     * Function drawCanvas - Generate canvas as per required design for QR code\n     * https://mckinsey.atlassian.net/browse/CNG-10\n     * @param img\n     * @returns canvas image\n     */\n      drawCanvas(img, name, isForLevels = false, level): string | HTMLCanvasElement | HTMLImageElement {\n        // TO DO : move to enum/utility file, while room detail more editable field developement \n        const width = 500;\n        const height = 550;\n        const arcY = 300;\n        const arc_X_Center = width/2;\n        const otrRadius = arc_X_Center - 2 ;\n        const whtRadius = otrRadius - 12;\n        const innrRadius = otrRadius - 15;\n  \n        const canvas: HTMLCanvasElement = document.createElement('canvas');\n        canvas.setAttribute('width', width.toString());\n        canvas.setAttribute('height', height.toString());\n        const ctx = canvas.getContext('2d');\n  \n        ctx.strokeStyle = \"transparent\";\n        ctx.moveTo(arc_X_Center, 0);\n        ctx.lineTo(arc_X_Center, height);\n        ctx.stroke(); \n  \n        ctx.font = '14px McKinsey Sans, Helvetica Neue, Arial, sans-serif';\n        ctx.textAlign = \"center\";      \n        ctx.fillText( isForLevels ? name : name + ' (L-' + level + \")\", arc_X_Center, 20 );   \n\n        //oputer arc\n        ctx.beginPath();\n        ctx.arc(arc_X_Center, arcY, otrRadius, 0, 2 * Math.PI);\n        ctx.fillStyle = '#051C2C';\n        ctx.fill();\n        ctx.stroke();\n  \n        //inner white arc\n        ctx.beginPath();\n        ctx.arc(arc_X_Center, arcY, whtRadius, 0, 2 * Math.PI);\n        ctx.fillStyle = '#FFFFFF';\n        ctx.fill();\n        ctx.stroke();\n  \n        //second inner arc\n        ctx.beginPath();\n        ctx.arc(arc_X_Center, arcY, innrRadius, 0, 2 * Math.PI);\n        ctx.fillStyle = '#051C2C';\n        ctx.fill();\n        ctx.stroke();\n  \n        // header text\n        ctx.fillStyle = '#FFFFFF';\n        ctx.font = '44px Bower';\n        ctx.fillText( isForLevels ? 'Book a room' : 'Book Me', arc_X_Center, 166);\n  \n        //centeral rectangle\n        ctx.fillRect(137, 187, 225, 225);\n        //fill central rectangle with color\n        ctx.fillStyle = '#FFFFFF';\n        \n        // fill text at the bottom\n        ctx.font = '29px McKinsey Sans, Helvetica Neue, Arial, sans-serif';\n        ctx.fillText('in Converge', arc_X_Center, 470);\n  \n        // draw QR code image into center of canvas\n        img !== null && ctx.drawImage(img, 137, 187);\n  \n        // create data url\n        const dataURL: string | HTMLCanvasElement | HTMLImageElement =\n        canvas.toDataURL('image/png');\n        return dataURL;\n      }\n  \n}","import { Directive, HostListener, HostBinding, Output, EventEmitter, Input } from '@angular/core';\nimport { RequiredFileType } from './room-admin-utility';\n\n@Directive({\n  selector: '[fileDragDrop]'\n})\n\nexport class FileDragNDropDirective {\n  //@Input() private allowed_extensions : Array<string> = ['png', 'jpg', 'bmp'];\n  @Output() private filesChangeEmiter : EventEmitter<any[]> = new EventEmitter();\n  //@Output() private filesInvalidEmiter : EventEmitter<File[]> = new EventEmitter();\n  @HostBinding('style.background') private background = ''; //'#eee';\n  @HostBinding('style.border') private borderStyle = '2px solid'; //'2px dashed';\n  @HostBinding('style.border-color') private borderColor = '#E6E6E6';\n  @HostBinding('style.border-radius') private borderRadius = '1px';\n\n  constructor() { }\n\n  @HostListener('dragover', ['$event']) public onDragOver(evt){\n    evt.preventDefault();\n    evt.stopPropagation();\n    this.background = 'lightgray';\n    this.borderColor = 'cadetblue';\n    this.borderStyle = '1px dashed';\n  }\n\n  @HostListener('dragleave', ['$event']) public onDragLeave(evt){\n    evt.preventDefault();\n    evt.stopPropagation();\n    this.background = '#eee';\n    this.borderColor = '#696D7D';\n    this.borderStyle = '1px dashed';\n  }\n\n  @HostListener('drop', ['$event']) public onDrop(evt){\n    evt.preventDefault();\n    evt.stopPropagation();\n    const ext = RequiredFileType.split(',');\n    this.background = '#eee';\n    this.borderColor = '#696D7D';\n    this.borderStyle = '1px dashed';\n    // debugger;\n    let files = [...new Set(evt.dataTransfer.files)].filter((f:File) => ext.includes(f.type));  //evt.dataTransfer.files;\n    // let valid_files : Array<File> = files;\n    this.filesChangeEmiter.emit(files);\n  }\n}","import { DropdownOpion } from '@mckinsey-converge/ui';\n\nexport interface RoomSubset {\n\tinternal: DropdownOpion[];\n\texternal: DropdownOpion[];\n}\n\nexport interface room {\n\troomname: string;\n\troomnumber: number;\n\tcity: string;\n\tlevel: number;\n\tcapacity: number;\n\troomtype: string;\n\troomvisibility: boolean;\n\tvc: boolean;\n\tconference_phone: boolean;\n\twireless_content_sharing: boolean;\n\tflipchart: boolean;\n\tglassboard: boolean;\n\twhiteboard: boolean;\n\tnatural_light: boolean;\n\tboardroom: boolean;\n\tcocktail: boolean;\n\ttheatre: boolean;\n\tworkshop: boolean;\n\tushape: boolean;\n\tmiscellaneous: boolean;\n}\n\nexport const roomTypeOptions: DropdownOpion[] = [\n    { display: 'Internal', value: 'internal', meta: {} },\n    { display: 'External', value: 'external', meta: {} },\n\t]\n\nexport const roomSubsetOptions: RoomSubset = {\n\t'external': [\n\t\t{ display: 'Conference', value: 'conference', meta: {} },\n\t\t{ display: 'Team', value: 'team', meta: {} },\n\t],\n\t'internal': [\n\t\t{ display: 'Meeting', value: 'meeting', meta: {} },\n\t\t{ display: 'Partner', value: 'partner', meta: {} },\n\t\t{ display: 'Phonebooth', value: 'phonebooth', meta: {} },\n\t\t{ display: 'Team', value: 'team', meta: {} },\n\t\t{ display: 'Conference', value: 'conference', meta: {} },\n\t]\n}\n\nexport const roomVisibilityOptions: DropdownOpion[] = [\n\t{ display: 'Bookable', value: 'true', meta: {} },\n\t{ display: 'Non-bookable', value: 'false', meta: {} },\n]\n\nexport const canteringAvailabilityOptions: DropdownOpion[] = [\n\t{ display: 'Yes - Onsite', value: 'yes-onsite', meta: {} },\n\t// { display: 'Yes - Offsite', value: 'yes-offsite', meta: {} },\n\t{ display: 'No', value: 'no', meta: {} },\n]\n\nexport const RoomPhotoDiamension = {\n\twidth: 400,\n\theight: 225\n}\n\nexport const RequiredFileType = 'image/png,image/jpg,image/jpeg,image/webp';\n\nexport function timestamp(){ \n\treturn (new Date()).getTime(); \n} \n","import {\n    NgModule,\n    Type\n} from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport {\n    FormsModule,\n    ReactiveFormsModule\n} from '@angular/forms';\nimport { RouterModule } from '@angular/router';\nimport { EditorModule } from '@tinymce/tinymce-angular';\nimport { ComposerModule } from '@placeos/composer';\n\nimport { ScrollingModule } from '@angular/cdk/scrolling';\nimport { DragDropModule } from '@angular/cdk/drag-drop';\nimport { CdkTableModule } from '@angular/cdk/table';\n\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatRippleModule } from '@angular/material/core';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\n\nimport { APipesModule } from '@acaprojects/ngx-pipes';\nimport { ACustomEventsModule } from '@acaprojects/ngx-custom-events';\nimport { LoginComponent } from '../login/login.component';\nimport { TopbarHeaderComponent } from '../components/topbar-header/topbar-header.component';\n\nimport {\n    CdkDropListScrollContainer,\n    ReplacePipe\n} from '@mckinsey-converge/base';\nimport { SidebarComponent } from '../components/sidebar/sidebar.component';\nimport { LegacyUiModule } from '@mckinsey-converge/legacy-ui';\nimport { LegacyOverlaysModule } from '@mckinsey-converge/legacy-overlays';\nimport { AccessDenied } from '../components/access-denied/access-denied.component';\nimport { UiModule } from '@mckinsey-converge/ui';\n\nconst COMPONENTS: Type<any>[] = [\n    LoginComponent,\n    TopbarHeaderComponent,\n    SidebarComponent,\n    AccessDenied\n];\n\nconst DIRECTIVES: Type<any>[] = [\n    CdkDropListScrollContainer\n];\n\nconst MATERIAL_MODULES: any[] = [\n    MatButtonModule,\n    MatSnackBarModule,\n    MatDialogModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatProgressSpinnerModule,\n    MatProgressBarModule,\n    MatAutocompleteModule,\n    MatSelectModule,\n    MatChipsModule,\n    MatRippleModule,\n    MatMenuModule,\n    MatCheckboxModule,\n    MatTooltipModule,\n    MatRadioModule,\n    MatTabsModule,\n    MatSlideToggleModule\n];\n\nconst CDK_MODULES: any[] = [\n    ScrollingModule,\n    DragDropModule,\n    CdkTableModule\n];\n\n@NgModule({\n    declarations: [\n        ...COMPONENTS,\n        ...DIRECTIVES,\n        ReplacePipe\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        APipesModule,\n        ACustomEventsModule,\n        RouterModule,\n        EditorModule,\n        ComposerModule,\n        LegacyUiModule,\n        LegacyOverlaysModule,\n        ...MATERIAL_MODULES,\n        ...CDK_MODULES,\n        UiModule\n    ],\n    exports: [\n        APipesModule,\n        ACustomEventsModule,\n        LegacyUiModule,\n        LegacyOverlaysModule,\n        ...COMPONENTS,\n        ...DIRECTIVES,\n        ...MATERIAL_MODULES,\n        ...CDK_MODULES,\n        ReplacePipe\n    ]\n})\nexport class SharedContentModule {\n}\n","import { Component, OnInit } from '@angular/core';\nimport { first } from 'rxjs/operators';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { ApplicationLoadingState, LoadingState } from '@mckinsey-converge/base';\nimport { ApplicationIcon } from '@mckinsey-converge/data-common';\nimport { UsersService } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'app-shell-wrapper',\n    templateUrl: './shell.component.html',\n    styleUrls: ['./shell.component.scss'],\n})\nexport class ShellWrapperComponent extends BaseDirective implements OnInit {\n    /** Loading state of the application */\n    public loading_state: ApplicationLoadingState;\n    /** Logo of the application organisation */\n    public logo: ApplicationIcon;\n\n    constructor(private _service: ApplicationService, private _users: UsersService) {\n        super();\n    }\n\n    /** Whether the user needs to login */\n    public get show_login(): boolean {\n        return !this._users.is_logged_in;\n    }\n\n    /** Whether a module is still loading data */\n    public get is_loading(): boolean {\n        if (this.loading_state) {\n            for (const mod in this.loading_state) {\n                if (this.loading_state[mod] && this.loading_state[mod].state === 'loading') {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n\n    /** List of modules with a loading state */\n    public get loading_state_list(): LoadingState[] {\n        const list: LoadingState[] = [];\n        for (const mod in this.loading_state) {\n            if (this.loading_state[mod]) {\n                list.push(this.loading_state[mod]);\n            }\n        }\n        return list;\n    }\n\n    public ngOnInit(): void {\n        this.subscription(\n            'loading',\n            this._service.listen<ApplicationLoadingState>('loading').subscribe((loading) => {\n                this.loading_state = loading;\n            })\n        );\n        this._service.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.logo = this._service.setting('app.logo_dark') || { type: 'icon' };\n        });\n    }\n}\n","\n<div class=\"shell\">\n    <div class=\"view\" *ngIf=\"!show_login\">\n        <router-outlet></router-outlet>\n        <feedback></feedback>\n    </div>\n    <div class=\"login-module\" *ngIf=\"show_login\">\n        <app-login></app-login>\n    </div>\n    <div class=\"loading-block\" *ngIf=\"is_loading\">\n        <div class=\"info-block\">\n            <div class=\"spinner\">\n                <img src=\"assets/img/loader.gif\" />\n            </div>\n            <div class=\"text\">Converge is loading</div>\n        </div>\n    </div>\n</div>\n","import { Component, Input, SimpleChanges, OnChanges, EventEmitter, Output } from '@angular/core';\nimport { FormArray, FormControl, FormGroup, Validators } from '@angular/forms';\n\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { User } from '@mckinsey-converge/data-common';\nimport { BaseClass, Identity } from '@mckinsey-converge/base';\n\n@Component({\n    selector: 'a-event-form',\n    templateUrl: './event-form.component.html',\n    styleUrls: ['./event-form.component.scss'],\n})\nexport class EventFormComponent extends BaseClass implements OnChanges {\n    /** Booking details to display */\n    @Input() public event: Booking;\n    /** Booking details to display */\n    @Input() public form: FormGroup;\n\n    /** List of attendees in the booking */\n    public attendees: User[] = [];\n\n    constructor() {\n        super();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.event || changes.form) {\n            this.attendees = this.form?.value.attendees || [];\n            this.subscription(\n                'attendees',\n                this.form\n                    .get('attendees')\n                    ?.valueChanges.subscribe((l) => (this.attendees = l || []))\n            );\n        }\n    }\n\n    public addVisitor() {\n        const list = this.form.controls.attendees.value;\n        const visitor = new User({ visitor: true, external: true, email: '' })\n        list.push(visitor);\n        //** Create visitor form group */\n        const visitorFG = this.createVisitor(visitor);\n        //** Push to visitor form array */\n        this.getVisitors.push(visitorFG);\n        this.form.controls.attendees.setValue(list);\n        this.form.markAsDirty();\n    }\n\n    /**\n     * Create visitor form group\n     */\n    createVisitor(visitor) {\n        return new FormGroup({\n            name: new FormControl(visitor.name, {validators: [Validators.required, Validators.minLength(2)], updateOn: 'blur' }),\n            email: new FormControl(visitor.email, { validators: [Validators.required, Validators.email], updateOn: 'blur' }),\n        });\n    }\n\n    /** Replace visitor with updated values */\n    public replaceVisitor(item: User, index: number) {\n        const attendees = this.attendees;\n        attendees.splice(index, 1, item);\n        this.form.controls.attendees.setValue(attendees);\n        this.form.markAsDirty();\n    }\n\n\n    /** Remove visitor from attendee list */\n    public removeVisitor(item: User, index: number) {\n        const attendees = [...this.attendees];\n        attendees.splice(index, 1);\n        this.form.controls.attendees.setValue(attendees);\n        // (<FormArray>this.form.controls.visitors).removeAt(index);\n        this.getVisitors.removeAt(index-1);\n        this.form.markAsDirty();\n    }\n\n    /**\n     * Get the visitor form array \n     */\n    public get getVisitors() {\n        return this.form.get(\"visitors\") as FormArray;\n    }\n\n    public trackByFn(index: number, item: Identity) {\n        return index;\n    }\n}\n","<form *ngIf=\"form\" [formGroup]=\"form\">\n    <div class=\"visitor-booking\" *ngIf=\"event\">\n        <div class=\"details\">\n            <div class=\"icon\">\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'event' }\"></app-icon>\n            </div>\n            <div class=\"time\">{{ event.start_time }} <span> - {{ event.duration > 0 ? event.end_time : '' }}</span></div>\n            <div class=\"host\">\n                <div class=\"staff\">S</div>\n                <div class=\"name\">{{ event.organiser?.name }}</div>\n            </div>\n            <div class=\"title\">\n                <label for=\"title\">Title</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"title\"\n                        placeholder=\"Meeting Title\"\n                        formControlName=\"title\"\n                    />\n                    <mat-error>Title is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"actions\"></div>\n        </div>\n        <div class=\"attendees\" formArrayName=\"visitors\">\n            <div class=\"bar\"></div>\n            <ng-container *ngFor=\"let item of attendees; let i = index; trackBy: trackByFn\">\n                <div class=\"visitor\" *ngIf=\"item.external || item.visitor\">\n                    <a-visitor-form\n                        [event]=\"event\"\n                        [person]=\"item\"\n                        [form]=\"form.controls.visitors.controls[i-1]\"\n                        (personChange)=\"replaceVisitor($event, i)\"\n                    ></a-visitor-form>\n                    <button mat-icon-button name=\"remove\" (click)=\"removeVisitor(item, i)\">\n                        <app-icon [icon]=\"{ class: 'material-icons', content: 'delete' }\">delete</app-icon>\n                    </button>\n                </div>\n            </ng-container>\n            <button mat-button type=\"button\" name=\"add\" [class.add]=\"true\" (click)=\"addVisitor()\">\n                <div class=\"content\">\n                    <div class=\"icon\">\n                        <app-icon [icon]=\"{ class: 'material-icons', content: 'add' }\"></app-icon>\n                    </div>\n                    <div class=\"text\">Add visitor</div>\n                    <div class=\"bar\"></div>\n                </div>\n            </button>\n        </div>\n    </div>\n</form>\n","import { Component, OnInit, Input, SimpleChanges, OnChanges, EventEmitter, Output } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\n\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { User } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-visitor-form',\n    templateUrl: './visitor-form.component.html',\n    styleUrls: ['./visitor-form.component.scss'],\n})\nexport class VisitorFormComponent extends BaseDirective {\n    /** Booking that the user is assoicated with */\n    @Input() public event: Booking;\n    /** User details to display */\n    @Input() public person: User;\n    /** Emitter for changes to the person */\n    @Output() public personChange = new EventEmitter<User>();\n    /** Form fields for visitor details */\n    // public form: FormGroup;\n    @Input() public form: FormGroup\n\n    constructor(private _service: ApplicationService) {\n        super();\n    }\n\n    public ngOnInit(): void { \n        this.form.valueChanges.subscribe( values => {\n            this.person = new User({ ...values, visitor: true, external: true });\n            this.personChange.emit(this.person);\n        })\n    }\n\n    \n}\n","<div class=\"icon\">\n    <app-icon [icon]=\"{ class: 'material-icons', content: 'face' }\"></app-icon>\n</div>\n<form  [formGroup]=\"form\">\n    <div class=\"details\">\n        <div class=\"name\">\n            <label for=\"name\">Name</label>\n            <mat-form-field appearance=\"outline\">\n                <input matInput name=\"name\" placeholder=\"Name\" formControlName=\"name\"  />\n                <mat-error>Name is required</mat-error>\n            </mat-form-field>\n        </div>\n        <div class=\"email\">\n            <label for=\"email\">Email Address</label>\n            <mat-form-field appearance=\"outline\">\n                <input matInput name=\"email\" type=\"email\" placeholder=\"Email Address\" formControlName=\"email\"  />\n                <mat-error>A valid email address is required</mat-error>\n            </mat-form-field>\n        </div>\n    </div>\n</form>\n<div class=\"bar\"></div>\n","import { Component, OnInit, Inject, Output, EventEmitter } from '@angular/core';\nimport { FormGroup, Validators, FormControl, FormBuilder, FormArray } from '@angular/forms';\nimport { MAT_DIALOG_DATA, MatDialogRef, MatDialog } from '@angular/material/dialog';\n\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { DialogEvent } from '@mckinsey-converge/base';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport {\n    ConfirmModalComponent,\n    CONFIRM_METADATA,\n} from '@mckinsey-converge/legacy-overlays';\nimport { BookingsService } from '@mckinsey-converge/data-common';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\n\nexport interface VisitorsFormModalData {\n    /** Details of visitor listing */\n    booking: Booking;\n}\n\n@Component({\n    selector: 'a-visitors-form-modal',\n    templateUrl: './visitors-form-modal.component.html',\n    styleUrls: ['./visitors-form-modal.component.scss'],\n})\nexport class VisitorsFormModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form fields for visitor booking */\n    public form: FormGroup;\n    /** Display string for the loading state */\n    public loading: string;\n    attendeesStatus: boolean = true;\n\n    /** Visitor booking data */\n    public get booking(): Booking {\n        return this._data.booking;\n    }\n\n    /** Whether form fields contain an attendee */\n    public get has_attendees() {\n        return (\n            this.form &&\n            this.form.controls.attendees.value &&\n            this.form.controls.attendees.value.length\n        );\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _bookings: BookingsService,\n        private _booking_state: BookingStateService,\n        private _dialog_ref: MatDialogRef<VisitorsFormModalComponent>,\n        private _dialog: MatDialog,\n        private fb: FormBuilder,\n        @Inject(MAT_DIALOG_DATA) private _data: VisitorsFormModalData\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n\n        this.form = new FormGroup({\n            title: new FormControl(this.booking.title, [Validators.required]),\n            attendees: new FormControl([...this.booking.attendees], [Validators.minLength(1)]),\n            visitors: this.fb.array([])\n        });\n        if (this.booking.id) {\n            this.form.controls.title.disable();\n        }\n\n        /** \n         * Create visitor form for existing visitors\n        */\n        this.booking.attendees.forEach( (el) => {\n            if(el.external || el.visitor) {\n                const visitorFG = this.createVisitor(el.name, el.email);\n                this.getVisitors.push(visitorFG);\n                // (<FormArray>this.form.controls.visitors).markAsTouched();\n            }\n        });\n    }\n\n    createVisitor(name, email) {\n        return new FormGroup({\n            name: new FormControl(name, { validators: [Validators.required, Validators.minLength(2)], updateOn: 'blur' }),\n            email: new FormControl(email, {validators: [Validators.required, Validators.email], updateOn: 'blur' }),\n        });\n    }\n\n    public get getVisitors() {\n        return this.form.get(\"visitors\") as FormArray;\n    }\n\n    /** Delete visitor booking */\n    public delete() {\n        const ref = this._dialog.open(ConfirmModalComponent, {\n            ...CONFIRM_METADATA,\n            data: {\n                title: 'Delete meeting',\n                content: 'Are you sure you wish to delete this meeting?',\n                icon: { type: 'icon', class: 'material-icons', content: 'delete' },\n                action: 'Ok',\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n        this.subscription(\n            'confirm',\n            ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    /* istanbul ignore else */\n                    if (this.booking.id) {\n                        this.loading = 'Deleting visitor booking...';\n                        this._dialog_ref.disableClose = true;\n                        this.booking.delete().then(\n                            () => {\n                                this.event.emit({ reason: 'done' });\n                                this._service.notifySuccess('Successfully removed visitors.');\n                                this._dialog_ref.close();\n                            },\n                            (err) => {\n                                this.loading = null;\n                                this._service.notifyError(\n                                    `Failed to remove visitors. Error: ${err.message || err}`\n                                );\n                                this._dialog_ref.disableClose = false;\n                            }\n                        );\n                    }\n                }\n                ref.close();\n            })\n        );\n    }\n\n    /** Save changes to visitor booking */\n    public save() {\n        this.timeout('save', () => {\n            this.loading = 'Saving visitor booking...';\n            this.form.markAllAsTouched();\n            this._dialog_ref.disableClose = true;\n            /* istanbul ignore else */\n            if (this.form.dirty && this.form.valid) {\n                const attendees = this.form.controls.attendees.value;\n                for (const attendee of attendees) {\n                    if (!attendee.email) {\n                        attendee.email = `${Math.floor(Math.random() * 99999)}@guest.mckinsey.com`;\n                    }\n                }\n                const new_booking = new Booking({ ...this.booking.toJSON(), ...this.form.value });\n                this._bookings.save(new_booking).then(\n                    (bkn) => {\n                        this.event.emit({ reason: 'done', metadata: bkn });\n                        this._service.notifySuccess(\n                            this.booking.id\n                                ? 'Successfully updated visitors.'\n                                : 'Successfully added visitors.'\n                        );\n                        this._booking_state.replace(new Booking({ ...this.booking, ...bkn.toApiJSON() }));\n                        this._dialog_ref.close();\n                    },\n                    (err) => {\n                        this.loading = null;\n                        this._service.notifyError(\n                            `Failed to ${this.booking.id ? 'update' : 'add'} visitors. Error: ${\n                                err.message || err\n                            }`\n                        );\n                        this._dialog_ref.disableClose = false;\n                    }\n                );\n            }\n            else {\n                this.loading = null;\n                this._dialog_ref.disableClose = false;\n                this._dialog_ref.close();\n            }\n        });\n    }\n}\n","<header>\n    <div class=\"heading\">{{ booking.id ? 'Edit' : 'New' }} Visitors</div>\n    <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main *ngIf=\"!loading; else load_state\">\n        <a-event-form [form]=\"form\" [event]=\"booking\" ></a-event-form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions *ngIf=\"!loading\">\n    <footer>\n        <button mat-button name=\"save\" [disabled]=\"!form.valid\" (click)=\"save()\">Save</button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main style=\"min-height: 12em;\">\n        <div class=\"info-block center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </main>\n</ng-template>\n","import { Component, Input, SimpleChanges, OnChanges, Output, EventEmitter } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { ANIMATION_SHOW_CONTRACT_EXPAND } from '@mckinsey-converge/animations';\nimport {\n    VisitorsFormModalComponent,\n    VisitorsFormModalData,\n} from '../../overlays/visitors-form-modal/visitors-form-modal.component';\nimport { BaseClass, unique } from '@mckinsey-converge/base';;\nimport { BookingsService } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-visitor-booking',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss'],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND],\n})\nexport class VisitorBookingItemComponent extends BaseClass implements OnChanges {\n    /** Booking details to display */\n    @Input() public event: Booking;\n    /** Search filter string */\n    @Input() public search: string;\n    /** Emitter for changed to the checked in status */\n    @Output() public checked = new EventEmitter<void>();\n    /** Whether attendee list should be shown */\n    public show_attendees: boolean;\n    /** Whether all the attendees have checked in */\n    public checked_in: boolean = false;\n    /** Whether all attendees are being checked in */\n    public loading: boolean;\n\n    public matched_attendees = [];\n\n    /** Whether event will start soon or has started */\n    public get upcoming() {\n        const status = this.event.timeBasedStatusLabel;\n        return status === 'upcoming' || status === 'in_progress';\n    }\n\n    /** Display string for checkin statuses of all attendees */\n    public get status(): string {\n        const { checked_in, count } = this.checkedInStatus();\n        return `${checked_in} / ${count}`;\n    }\n\n\n    /** Whether user is a match for  */\n    public is_match(person: any): boolean {\n        const search = (this.search || '').toLowerCase();\n        return (\n            !search ||\n            person.name.toLowerCase().indexOf(search) >= 0 ||\n            person.email.toLowerCase().indexOf(search) >= 0\n        );\n    }\n\n    constructor(private _service: ApplicationService, private _bookings: BookingsService, private _dialog: MatDialog) {\n        super();\n    }\n\n    public checkedInStatus() {\n        const checked_in_users = this.event.checkInsArray;\n        return this.event.attendees.reduce(\n            (counts, user) => {\n                /* istanbul ignore else */\n                if (user.external) {\n                    counts.count++;\n                    /* istanbul ignore else */\n                    if (checked_in_users.indexOf(user.email) >= 0) {\n                        counts.checked_in++;\n                    }\n                }\n                return counts;\n            },\n            { checked_in: 0, count: 0 }\n        );\n    }\n\n    /**\n     * Checkin the attendee\n     */\n    public async checkin() {\n        this.loading = true;\n        const value = await this._bookings\n            .checkin(this.event.id, {\n                host_email: this.event.organiser.email,\n                attendees: unique(this.event.attendees.map(user => ({ name: user.name, email: user.email }))),\n                booking_id: this.event.id,\n                icaluid: this.event.icaluid,\n                id: this.event.id,\n                notify_users: [...this.event.notify_users],\n                response_type: 'accepted',\n                room_id: this.event.space.id,\n            })\n            .catch((err) => {\n                this._service.notifyError(`Error checking in all attendees for booking. Error: ${err.message || err}`);\n            });\n        if (value) {\n            this.event = new Booking({\n                ...this.event.toJSON(),\n                check_ins: value.check_ins\n            });\n            this.checked.emit();\n        }\n        this.loading = false;\n    }\n\n    /** URL for mailing all attendees of the event */\n    public get mail_url(): string {\n        const subject = encodeURIComponent(\n            `${this.event.title}\" at ${this.event.start_time}, ${this.event.date_string}`\n        );\n        return `mailto:${this.event.attendees.filter(user => !user.email.includes('@guest'))\n            .map((user) => user.email)\n            .join(',')}?Subject=${subject}\"`;\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.search) {\n            if (!this.search) this.show_attendees = false;\n            this.matched_attendees = this.event?.attendees.filter(_ => this.is_match(_));\n            this.timeout('on_search', () => this.show_attendees = !!this.search, 50);\n        }\n        if (changes.event) {\n            const { checked_in, count } = this.checkedInStatus();\n            this.checked_in = checked_in >= count;\n            this.matched_attendees = this.event?.attendees.filter(_ => this.is_match(_));\n        }\n    }\n\n    public openEditModal() {\n        this._dialog.open<VisitorsFormModalComponent, VisitorsFormModalData>(\n            VisitorsFormModalComponent,\n            {\n                data: {\n                    booking: this.event,\n                },\n            }\n        );\n    }\n}\n","<div class=\"visitor-booking\" *ngIf=\"event\" [class.showing]=\"show_attendees\">\n    <div class=\"details\" [class.blur]=\"search\">\n        <div class=\"icon\" [class.upcoming]=\"upcoming\" [class.all-checked-in]=\"checked_in\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'event' }\"></app-icon>\n        </div>\n        <div class=\"time\">\n            <ng-container *ngIf=\"!event.all_day\">\n                {{ event.start_time }}\n                <span> - {{ event.duration > 0 ? event.end_time : '' }}</span>\n            </ng-container>\n            <ng-container *ngIf=\"event.all_day\">All Day</ng-container>\n        </div>\n        <div class=\"host\">\n            <div class=\"name\">{{ event.organiser?.name }}</div>\n        </div>\n        <div class=\"company\">{{ event.company.length }}</div>\n        <div class=\"title\">{{ event.title }}</div>\n        <div class=\"location\">{{ event.space?.name || event.local_room_name }}</div>\n        <div class=\"status\">{{ status }}</div>\n        <div class=\"actions\">\n            <a\n                mat-icon-button\n                matTooltip=\"Phone Host\"\n                [disabled]=\"!event.organiser.phone\"\n                [href]=\"'tel:' + event.organiser.phone | safe: 'url'\"\n            >\n                <action-icon [icon]=\"{ class: 'material-icons', content: 'call' }\"></action-icon>\n            </a>\n            <a\n                mat-icon-button\n                matTooltip=\"Email Attendees\"\n                name=\"email-all\"\n                [href]=\"mail_url | safe: 'url'\"\n            >\n                <action-icon [icon]=\"{ class: 'material-icons', content: 'mail' }\"></action-icon>\n            </a>\n            <button\n                mat-icon-button\n                name=\"checkin-all\"\n                matTooltip=\"Checkin All Visitors\"\n                (click)=\"checkin()\"\n            >\n                <action-icon\n                    [loading]=\"loading\"\n                    [icon]=\"{ class: 'material-icons', content: 'event_available' }\"\n                ></action-icon>\n            </button>\n            <button\n                mat-icon-button\n                matTooltip=\"Edit Visitors\"\n                name=\"edit\"\n                (click)=\"openEditModal()\"\n            >\n                <action-icon [icon]=\"{ class: 'material-icons', content: 'edit' }\"></action-icon>\n            </button>\n        </div>\n        <div class=\"toggle\">\n            <button\n                mat-icon-button\n                name=\"show-attendees\"\n                (click)=\"show_attendees = !show_attendees\"\n            >\n                <app-icon\n                    [icon]=\"{\n                        class: 'material-icons',\n                        content: show_attendees ? 'keyboard_arrow_down' : 'keyboard_arrow_right'\n                    }\"\n                ></app-icon>\n            </button>\n        </div>\n    </div>\n    <div class=\"attendees\" [@show]=\"show_attendees ? 'show' : 'hide'\">\n        <div class=\"bar\"></div>\n        <a-visitor\n            *ngFor=\"let item of event.attendees\"\n            [event]=\"event\"\n            [person]=\"item\"\n            [search]=\"search\"\n            (checked)=\"checked.emit()\"\n        ></a-visitor>\n    </div>\n</div>\n","import { Component, OnInit, Input, SimpleChanges } from '@angular/core';\nimport { Observable, Subject } from 'rxjs';\nimport { first } from 'rxjs/operators';\n\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\nimport { SpacesService } from '@mckinsey-converge/data-common';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\nimport { DateNow, DateTZ, convertTimezonedTimestampToLocalDateTz} from '@mckinsey-converge/date-tz';\n\n\n@Component({\n    selector: 'visitor-timeline',\n    templateUrl: './timeline.component.html',\n    styleUrls: ['./timeline.component.scss'],\n})\nexport class VisitorTimelineComponent extends BaseDirective implements OnInit {\n    /** Currently selected date */\n    @Input() public dateTz: DateTZ = DateNow(new Date());\n    /** Filter string */\n    @Input() public search: string;\n    /** Whether all bookings should be shown */\n    @Input() public show_all: boolean;\n    /** List of visitor bookings for the current date */\n    public bookings: Booking[] = [];\n    /** List of filtered bookings */\n    public filtered_bookings: Booking[] = [];\n    /** Whether visitor list is loading */\n    public loading: boolean;\n    /** List of items from an API search */\n    public search_results$: Observable<Booking[]>;\n    /** Subject holding the value of the search */\n    public readonly search$ = new Subject<string>();\n\n    public get nowTz(){\n        return DateNow(new Date())\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _spaces: SpacesService,\n        private _bookings: BookingStateService\n    ) {\n        super();\n    }\n\n    ngOnInit(): void {\n        this._spaces.initialised.pipe(first((_) => _)).subscribe(() => {\n            this._bookings.startPollingEveryFiveMin();\n            this.subscription(\n                'building',\n                this._org\n                    .listen('active_building')\n                    .subscribe((_) => {\n                        this.search$.next(`${this.dateTz.ms}|${_.id}`);\n                        this._bookings.setZone(_.id);\n                    })\n            );\n            this.subscription(\n                'bookings',\n                this._bookings.filtered.subscribe((list) => this.updateEvents(list))\n            );\n        });\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.dateTz) {\n            this.search$.next(`${this.dateTz.ms}`);\n        }\n        /* istanbul ignore else */\n        if (changes.search || changes.show_all) {\n            this.filtered_bookings = this.filter(this.search);\n        }\n    }\n\n    /* istanbul ignore next */\n    public trackByFn(index: number, booking: Booking) {\n        return booking.id;\n    }\n\n    public resetPolling() {\n        this.interval(\n            'update_bookings',\n            () => this.search$.next(`${this.dateTz.ms}|${this.nowTz.ms}`),\n            30 * 1000\n        );\n    }\n\n    /** Filter the visitor bookings */\n    public filter(str: string = '') {\n        const search = str.toLowerCase();\n        return this.bookings\n            .filter((booking) => {\n                return booking.attendees.find(\n                    (user) =>\n                        user.name.toLowerCase().indexOf(search) >= 0 ||\n                        user.email.toLowerCase().indexOf(search) >= 0\n                );\n            })\n            .filter((bkn) => (this.show_all ? true : bkn.has_visitors));\n    }\n\n    private updateEvents(list: Booking[]) {\n        const unsorted_bookings = list.filter(\n            (bkn) =>\n                !bkn.declined &&\n                bkn.room.zones.includes(this._org.building.id)\n        );\n        const bookings = unsorted_bookings.sort((a, b) => {\n            if (a.date === b.date) {\n                if (a.creator.name === b.creator.name) {\n                    return a.space.name > b.space.name ? 1 : -1;\n                }\n                return a.creator.name > b.creator.name ? 1 : -1;\n            }\n            return a.date > b.date ? 1 : -1;\n        })\n        this.bookings = bookings;\n        this.filtered_bookings = this.filter(this.search);\n    }\n}\n","<div class=\"visitor-timeline\">\n    <div class=\"loader\" *ngIf=\"loading\">\n        <mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>\n    </div>\n    <div class=\"heading\">\n        <div class=\"icon\"></div>\n        <div class=\"time\">Time</div>\n        <div class=\"host\">Host</div>\n        <div class=\"company\">Company</div>\n        <div class=\"title\">Title</div>\n        <div class=\"location\">Location</div>\n        <div class=\"state\">Status</div>\n    </div>\n    <div class=\"list\">\n        <ng-container *ngIf=\"filtered_bookings && filtered_bookings.length; else empty_state\">\n            <ng-container  *ngFor=\"let booking of filtered_bookings; let i = index; trackBy: trackByFn\" >\n                <a-visitor-booking [event]=\"booking\" [search]=\"search\" (checked)=\"resetPolling()\"></a-visitor-booking>\n            </ng-container>\n        </ng-container>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">\n            No visitors {{ search ? 'matching ' + '\"' + search + '\"' : '' }} for {{ date_display }}\n        </div>\n    </div>\n</ng-template>\n","import { Component, Input, SimpleChanges, Renderer2, ElementRef, OnChanges, Output, EventEmitter} from '@angular/core';\n\nimport { BookingCheckinParams, User } from '@mckinsey-converge/data-common';\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { BookingsService } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-visitor',\n    templateUrl: './visitor.component.html',\n    styleUrls: ['./visitor.component.scss'],\n})\nexport class VisitorComponent implements OnChanges {\n    /** Booking that the user is assoicated with */\n    @Input() public event: Booking;\n    /** User details to display */\n    @Input() public person: User;\n    /** Search filter string */\n    @Input() public search: string;\n    /** Emitter for changed to the checked in status */\n    @Output() public checked = new EventEmitter<void>();\n    /** Status of the visitor */\n    public status: string;\n    /** Whether attendee is being checked in */\n    public loading: boolean;\n\n    /** Whether attendee is late */\n    public get late() {\n        return this.event.timeBasedStatusLabel === 'in_progress' && this.person.external;\n    }\n\n    /** Whether attendee has checked in */\n    public get approved() {\n        return this.event.checkInsArray.includes(this.person.email);\n    }\n\n    /** Whether user is a match for  */\n    public get is_match(): boolean {\n        const search = (this.search || '').toLowerCase();\n        return (\n            this.person.name.toLowerCase().indexOf(search) >= 0 ||\n            this.person.email.toLowerCase().indexOf(search) >= 0\n        );\n    }\n\n    public get invalid_email(): boolean {\n        return !this.person.email || this.person.email.includes('@guest.mckinsey.com');\n    }\n\n    /** URL for mailing all attendees of the event */\n    public get mail_url(): string {\n        return `mailto:${this.person.email}?subject=\"${this.event.title}\"%20at%20${\n            this.event.start_time\n        },%20${this.event.date_string}${\n            this.event.organiser.email.toLowerCase() !== this.person.email\n                ? '&cc=' + this.event.organiser.email\n                : ''\n        }`;\n    }\n\n    constructor(\n        private _element: ElementRef<HTMLElement>,\n        private _renderer: Renderer2,\n        private _bookings: BookingsService,\n        private _service: ApplicationService\n    ) {}\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.search) {\n            if (this.search && !this.is_match) {\n                this._renderer.addClass(this._element.nativeElement, 'not-match');\n            } else {\n                this._renderer.removeClass(this._element.nativeElement, 'not-match');\n            }\n        }\n    }\n\n    /**\n     * Checkin the attendee\n     */\n     public  checkin() {\n        this.loading = true;\n        const fields: BookingCheckinParams= {\n            host_email: this.event.organiser.email,\n            attendees: [{ name: this.person.name, email: this.person.email }],\n            booking_id: this.event.id,\n            icaluid: this.event.icaluid,\n            id: this.event.id,\n            notify_users: [...this.event.notify_users],\n            response_type: 'accepted',\n            room_id: this.event.space.id,\n        };\n        this._bookings.checkinIndividualVisitor(this.event.id, fields).subscribe(result => {\n                const check_ins = {...result.check_ins};\n                check_ins[this.person.email] = true;\n                this.event.check_ins = result.check_ins;\n                this.event = new Booking({\n                    ...this.event.toJSON(),\n                    check_ins,\n                });\n                this.checked.emit();\n                this.loading = false;\n            }); \n    }\n\n\n    public get companyString(){\n        return this.person.external ? this.event.company.join(',') : 'Mckinsey'\n    }\n}\n","<div\n    class=\"icon\"\n    [class.approved]=\"approved || !person.external\"\n    [class.late]=\"late\"\n    [matTooltip]=\"\n        person.external ? (approved ? 'Checked In' : late ? 'Late' : 'Upcoming') : 'Staff'\n    \"\n    matTooltipPosition=\"right\"\n>\n    <app-icon\n        [icon]=\"{ class: 'material-icons', content: person.external ? 'face' : 'assignment_ind' }\"\n    ></app-icon>\n</div>\n<div class=\"details\">\n    <div class=\"user\" [class.approved]=\"approved || !person.external\">\n        <div class=\"name\">{{ person?.name || person?.email }}</div>\n    </div>\n    <div class=\"company\">{{ companyString }}</div>\n    <div class=\"title\"></div>\n    <div class=\"status\" *ngIf=\"person.external\">{{ status }}</div>\n    <div class=\"actions\">\n        <a\n            mat-icon-button\n            *ngIf=\"!person.external\"\n            matTooltip=\"Phone Staff Member\"\n            [disabled]=\"!person.phone\"\n            [href]=\"'tel:' + person.phone | safe: 'url'\"\n        >\n            <action-icon [icon]=\"{ class: 'material-icons', content: 'call' }\"></action-icon>\n        </a>\n        <a\n            mat-icon-button\n            [matTooltip]=\"!person.external ? 'Email Staff Member' : 'Email Visitor'\"\n            [disabled]=\"invalid_email\"\n            [href]=\"mail_url | safe: 'url'\"\n        >\n            <action-icon [icon]=\"{ class: 'material-icons', content: 'mail' }\"></action-icon>\n        </a>\n        <button\n            name=\"checkin\"\n            mat-icon-button\n            matTooltip=\"Checkin Visitor\"\n            [disabled]=\"loading || !person.external\"\n            (click)=\"checkin()\"\n        >\n            <action-icon\n                *ngIf=\"person.external\"\n                [loading]=\"loading\"\n                [icon]=\"{ class: 'material-icons', content: 'event_available' }\"\n            ></action-icon>\n        </button>\n        <button mat-icon-button [disabled]=\"true\"></button>\n    </div>\n    <div class=\"empty\"></div>\n</div>\n<div class=\"bar\"></div>\n","import { Component, OnInit } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { first } from 'rxjs/operators';\nimport { Booking } from '@mckinsey-converge/data-common';\nimport {\n    VisitorsFormModalComponent,\n    VisitorsFormModalData,\n} from './overlays/visitors-form-modal/visitors-form-modal.component';\nimport { SpacesService } from '@mckinsey-converge/data-common';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'app-visitors',\n    templateUrl: './visitors.component.html',\n    styleUrls: ['./visitors.component.scss'],\n})\nexport class VisitorsComponent extends BaseDirective implements OnInit {\n    /** Currently selected date */\n    public dateTz: DateTZ = DateNow(new Date());\n    /** Search filter string */\n    public search_str: string;\n    /** Whether all bookings should be listed */\n    public show_all: boolean;\n\n    public get has_visitor_space(): boolean {\n        const building = this._org.building;\n        return building && !!this._spaces.find(building.visitor_space || building.holding_bay);\n    }\n\n    public has_access: boolean;\n\n    constructor(\n        private _route: ActivatedRoute,\n        private _router: Router,\n        private _service: ApplicationService,\n        private _dialog: MatDialog,\n        private _spaces: SpacesService,\n        private _org: OrganisationService\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._service.title = 'Visitors';\n        this._org.initialised.pipe(first(_ => _)).subscribe(() => {\n            // Init dateTz here once the organization data is loaded.\n            this.dateTz = new DateTZ({ date: this.dateTz.ms, is_local_tz: false, building_tz: this.timezone });\n            this.subscription(\n                'route.query_params',\n                this._route.queryParamMap.subscribe((params) => {\n                    if (params.has('zone') && params.get('zone') !== this._org.building.id) {\n                        const id = params.get('zone');\n                        const bld = this._org.buildings.find((building) => building.id === id);\n                        if (bld) {\n                            this._org.building = bld;\n                        }\n                    }\n                })\n            );\n            this.subscription(\n                'building',\n                this._org.listen('active_building')?.subscribe(() => {\n                    // Update dateTz here when the building is changed.\n                    this.dateTz = new DateTZ({ date: this.dateTz.ms, is_local_tz: false, building_tz: this.timezone });\n                    this.has_access = this._org.building ? true : false;\n                    if(!this.has_access) return\n                    this._router.navigate([], {\n                        relativeTo: this._route,\n                        queryParams: { zone: this._org.building.id },\n                    });\n                })\n            );\n        })\n    }\n\n    public newVisitorMeeting() {\n        const now = DateNow(new Date());\n        const date = now.setValue({ minute: Math.ceil(now.minutes / 5) * 5 });\n        const building = this._org.building;\n        const space = this._spaces.find(building.visitor_space || building.holding_bay);\n        const booking = new Booking({ \n            start_epoch: date.seconds,\n            end_epoch: date.addValue({ minutes: 60 }),\n            room: space\n        });\n        this._dialog.open<VisitorsFormModalComponent, VisitorsFormModalData>(\n            VisitorsFormModalComponent,\n            {\n                data: {\n                    booking,\n                },\n            }\n        );\n    }\n\n    // R--- surely these 2 methods are not DRY and all the main tabs need a base class\n    // that encapsulates the common elements.\n    public get timezone() {\n        return this._org.building.timezone;\n    }\n\n    public updateDateTz(dateTz: DateTZ) {\n        this.dateTz = dateTz;\n    }\n}\n","<div class=\"visitors\">\n    <a-sidebar></a-sidebar>\n    <div class=\"group\" *ngIf=\"!has_access\">\n        <access-denied></access-denied>\n    </div>\n    <div class=\"group\" *ngIf=\"has_access\">\n        <a-topbar-header\n            [(dateTz)]=\"dateTz\"\n            (dateChange)=\"search_str = ''\"\n            [show_add_item]=\"false\"\n            (event)=\"newVisitorMeeting()\"\n            (dateChangeTz)=\"updateDateTz($event)\"\n        >\n            <div class=\"input-wrapper\">\n                <mat-form-field [class.rounded]=\"true\" appearance=\"outline\">\n                    <app-icon\n                        [icon]=\"{ class: 'material-icons', content: 'search' }\"\n                        matPrefix\n                    ></app-icon>\n                    <input\n                        matInput\n                        [(ngModel)]=\"search_str\"\n                        name=\"visitor-name\"\n                        placeholder=\"Search...\"\n                    />\n                    <button mat-icon-button matSuffix *ngIf=\"search_str\" (click)=\"search_str = ''\">\n                        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n                    </button>\n                </mat-form-field>\n            </div>\n            <mat-slide-toggle\n                name=\"show-all\"\n                [(ngModel)]=\"show_all\"\n                labelPosition=\"before\"\n                title=\"Show all meetings\"\n            >\n                All meetings\n            </mat-slide-toggle>\n        </a-topbar-header>\n        <main>\n            <visitor-timeline [show_all]=\"show_all\" [dateTz]=\"dateTz\" [search]=\"search_str\"></visitor-timeline>\n        </main>\n    </div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Route, RouterModule } from '@angular/router';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { VisitorsComponent } from './visitors.component';\nimport { SharedContentModule } from '../shared/shared.module';\nimport { VisitorTimelineComponent } from './timeline/timeline.component';\nimport { VisitorBookingItemComponent } from './timeline/item/item.component';\nimport { VisitorComponent } from './timeline/visitor/visitor.component';\nimport { VisitorsFormModalComponent } from './overlays/visitors-form-modal/visitors-form-modal.component';\nimport { EventFormComponent } from './overlays/visitors-form-modal/event-form/event-form.component';\nimport { VisitorFormComponent } from './overlays/visitors-form-modal/visitor-form/visitor-form.component';\n\nconst ROUTES: Route[] = [\n    { path: '', component: VisitorsComponent },\n    { path: ':level', component: VisitorsComponent },\n    { path: '**', redirectTo: '' },\n];\n\n@NgModule({\n    declarations: [\n        VisitorsComponent,\n        VisitorTimelineComponent,\n        VisitorBookingItemComponent,\n        VisitorComponent,\n        VisitorsFormModalComponent,\n        EventFormComponent,\n        VisitorFormComponent,\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        RouterModule.forChild(ROUTES),\n        SharedContentModule,\n    ],\n})\nexport class VisitorsModule {}\n","import { EnvironmentData } from '@mckinsey-converge/environment';\n\nexport const environment: EnvironmentData = {\n    production: false,\n    hmr: false,\n    heap_io_id: 3540602199,\n};\n","/**\n * GENERAL APPLICATION SETTINGS\n */\nimport { SettingsData } from '@mckinsey-converge/data-common';\n\nconst general = {\n    menu: {\n        items: [\n            {\n                name: 'Day View',\n                route: '/day-view',\n                icon: {\n                    type: 'icon',\n                    class: 'material-icons',\n                    content: 'wb_sunny',\n                },\n            },\n            {\n                name: 'Week View',\n                route: '/week-view',\n                icon: {\n                    type: 'icon',\n                    class: 'material-icons',\n                    content: 'date_range',\n                },\n            },\n            {\n                name: 'Catering',\n                route: '/catering',\n                icon: {\n                    type: 'icon',\n                    class: 'material-icons',\n                    content: 'room_service',\n                },\n            },\n            {\n                name: 'Visitors',\n                route: '/visitors',\n                icon: {\n                    type: 'icon',\n                    class: 'material-icons',\n                    content: 'face',\n                },\n            },\n            {\n                name: 'Reports',\n                route: '/reports',\n                icon: {\n                    type: 'icon',\n                    class: 'material-icons',\n                    content: 'warning',\n                },\n            },\n            {\n                name: 'Room Admin',\n                route: '/room-admin',\n                icon: {\n                    type: 'icon',\n                    class: 'material-icons',\n                    content: 'settings',\n                }\n            },\n        ],\n        copyright: 'PlaceOS',\n    },\n};\n/*=========================*\\\n||  BOOKING FLOW SETTINGS  ||\n\\*=========================*/\nconst booking = {\n    booking_types: [\n        { name: 'Internal', id: 'internal' },\n        { name: 'External', id: 'external' },\n    ],\n    show_fields: [\n        'attendees',\n        'body',\n        'catering',\n        'dateTz',\n        'duration',\n        'organiser',\n        'title',\n        'type',\n        'all_day',\n        'has_catering',\n        'is_recurrent'\n    ],\n    html_body: true,\n    multiple_spaces: true,\n    desk_start: 9,\n};\n\n/*=========================*\\\n||    DAY VIEW SETTINGS    ||\n\\*=========================*/\nconst day_view = {\n    dragdrop: false,\n};\n\n/*=========================*\\\n||    VISITORS SETTINGS    ||\n\\*=========================*/\nconst visitors = {};\n\n/*=========================*\\\n||    REPORTS SETTINGS     ||\n\\*=========================*/\nconst reports = {};\n/**\n * ROOT APPLICATION SETTINGS\n */\nconst app = {\n    title: 'McKinsey Concierge',\n    description: 'McKinsey Concierge UI written with Angular Framework',\n    short_name: 'CONCIERGE',\n    logo_light: {\n        type: 'img',\n        src: 'assets/img/logo-inverse.svg',\n        background: '#0a0d2e',\n    },\n    logo_dark: {\n        type: 'img',\n        src: 'assets/img/logo.svg',\n        background: '',\n    },\n    heap_io: {\n        app_id: 3540602199,\n        force_ssl: true,\n        secure_cookie: true,\n        disable_text_capture: true,\n        cookie_path: '/concierge/'\n    },\n    general,\n    booking,\n    day_view,\n    visitors,\n    reports,\n};\n\n/**\n * ROOT SETTIGNS\n */\nexport const DEFAULT_SETTINGS: SettingsData<typeof app> = {\n    debug: true,\n    composer: {\n        domain: '',\n        route: '/concierge',\n        protocol: '',\n        port: '',\n        use_domain: false,\n        local_login: false,\n    },\n    app,\n    mock: false,\n    frontend: 'concierge',\n};\n","\nimport { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"]}