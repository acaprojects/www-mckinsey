(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"6DqT":function(e,n,t){"use strict";t.r(n);var i=t("ofXK"),o=t("3Pt+"),c=t("tyNb"),a=t("SxV6"),s=t("IWZj"),r=t("xUvU"),l=t("xhdr"),d=t("fXoL"),g=t("OaWH"),b=t("0IaG"),v=t("BAfr"),p=t("ocbO"),h=t("1jcm"),u=t("XNiG"),_=t("LRne"),f=t("Kj3r"),C=t("/uUt"),m=t("eIep"),O=t("JIr8"),M=t("Wgwc"),w=t("bv9b"),P=t("TnpO"),k=t("m6yr"),y=t("Qu3c"),x=t("0njA");const W=function(e){return{class:"material-icons",content:e}};function V(e,n){if(1&e&&d.Rb(0,"app-icon",10),2&e){const e=d.ic();d.oc("icon",d.qc(1,W,e.event.approved?"done":"event_busy"))}}let I=(()=>{class e{constructor(e){this._dialog=e}get type(){if(!this.event||!this.event.type)return"";if(this.event.declined)return"cancelled";const e=this.event.type;return"internal"===e&&this.event.has_visitors?"external":e}viewMeetingDetails(){this._dialog.open(P.a,{maxWidth:"calc(100vw - 2em)",data:{booking:this.event}})}}return e.\u0275fac=function(n){return new(n||e)(d.Qb(b.b))},e.\u0275cmp=d.Kb({type:e,selectors:[["week-view-item"]],inputs:{event:"event"},decls:22,vars:11,consts:[[3,"tapped"],[1,"heading"],[1,"text"],[1,"handle"],[3,"icon",4,"ngIf"],[1,"details"],[1,"field",3,"title"],[1,"value"],[1,"value",3,"matTooltip"],[1,"field"],[3,"icon"]],template:function(e,n){1&e&&(d.Wb(0,"div",0),d.ec("tapped",(function(){return n.viewMeetingDetails()})),d.Wb(1,"div",1),d.Wb(2,"div",2),d.Gc(3),d.Vb(),d.Wb(4,"div",3),d.Ec(5,V,1,3,"app-icon",4),d.Vb(),d.Vb(),d.Wb(6,"div",5),d.Wb(7,"div",6),d.Wb(8,"label"),d.Gc(9,"Host:"),d.Vb(),d.Wb(10,"div",7),d.Gc(11),d.Vb(),d.Vb(),d.Wb(12,"div",6),d.Wb(13,"label"),d.Gc(14,"Location:"),d.Vb(),d.Wb(15,"div",8),d.Gc(16),d.Vb(),d.Vb(),d.Wb(17,"div",9),d.Wb(18,"label"),d.Gc(19,"Attendees:"),d.Vb(),d.Wb(20,"div",7),d.Gc(21),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.Eb("event"+(n.type?" "+n.type:"")+("done"===n.event.status?" ended":"")+("in_progress"===n.event.status?"in-progress":"")),d.Db("id",null==n.event?null:n.event.id),d.Cb(3),d.Hc(n.event.all_day?"All Day":n.event.time_period),d.Cb(2),d.oc("ngIf",n.event.declined||n.event.approved),d.Cb(2),d.oc("title",(null==n.event.organiser?null:n.event.organiser.name)||n.event.organiser_email),d.Cb(4),d.Hc((null==n.event.organiser?null:n.event.organiser.name)||n.event.organiser_email),d.Cb(1),d.oc("title",(null==n.event.space?null:n.event.space.name)||n.event.location),d.Cb(3),d.oc("matTooltip",(null==n.event.space?null:n.event.space.name)||n.event.location),d.Cb(1),d.Ic(" ",(null==n.event.space?null:n.event.space.name)||n.event.location," "),d.Cb(5),d.Hc((null==n.event.attendees?null:n.event.attendees.length)||"0"))},directives:[k.c,i.t,y.a,x.a],styles:[".event[_ngcontent-%COMP%]{margin:.25em;border-radius:4px;overflow:hidden;max-width:calc(100% - .5em);transition:opacity .2s,background-color .2s;border:1px solid #1f40e6}.event[_ngcontent-%COMP%], .event[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{cursor:pointer}.event.in-progress[_ngcontent-%COMP%]{box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.event.ended[_ngcontent-%COMP%]{opacity:.35}.event[_ngcontent-%COMP%]:hover{opacity:1;background-color:#f8f8f8}.event[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:#1f40e6}.event[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{background-color:rgba(31,64,230,.2)}.event.pending[_ngcontent-%COMP%]{border-color:rgba(31,64,230,.4)}.event.pending[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:rgba(31,64,230,.4)}.event.internal[_ngcontent-%COMP%]{border-color:#e69fc7}.event.internal[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:#e69fc7}.event.internal[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{background-color:rgba(230,159,199,.2)}.event.internal.pending[_ngcontent-%COMP%]{border-color:rgba(230,159,199,.4)}.event.internal.pending[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:rgba(230,159,199,.4)}.event.external[_ngcontent-%COMP%]{border-color:#8c5ac8}.event.external[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:#8c5ac8}.event.external[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{background-color:rgba(140,90,200,.2)}.event.external.pending[_ngcontent-%COMP%]{border-color:rgba(140,90,200,.4)}.event.external.pending[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:rgba(140,90,200,.4)}.event.training[_ngcontent-%COMP%]{border-color:#f0e700}.event.training[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:#f0e700}.event.training[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{background-color:rgba(240,231,0,.2)}.event.training.pending[_ngcontent-%COMP%]{border-color:rgba(240,231,0,.4)}.event.training.pending[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:rgba(240,231,0,.4)}.event.interview[_ngcontent-%COMP%]{border-color:#348d02}.event.interview[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:#348d02}.event.interview[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{background-color:rgba(52,141,2,.2)}.event.interview.pending[_ngcontent-%COMP%]{border-color:rgba(52,141,2,.4)}.event.interview.pending[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:rgba(52,141,2,.4)}.event.setup[_ngcontent-%COMP%]{border-color:#d32f2f}.event.setup[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:#d32f2f}.event.setup[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{background-color:rgba(211,47,47,.2)}.event.setup.pending[_ngcontent-%COMP%]{border-color:rgba(211,47,47,.4)}.event.setup.pending[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:rgba(211,47,47,.4)}.event.cancelled[_ngcontent-%COMP%]{border-color:#617288}.event.cancelled[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:#617288}.event.cancelled[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{background-color:rgba(97,114,136,.2)}.event.cancelled.pending[_ngcontent-%COMP%]{border-color:rgba(97,114,136,.4)}.event.cancelled.pending[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:rgba(97,114,136,.4)}.heading[_ngcontent-%COMP%]{background-color:#999;display:flex;align-items:center}.heading[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1;padding:.25em .5em;min-width:50%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.handle[_ngcontent-%COMP%]{justify-content:center;height:1.6em;width:1.6em;color:#fff}.field[_ngcontent-%COMP%], .handle[_ngcontent-%COMP%]{display:flex;align-items:center}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.8em;font-weight:500;margin-right:.5em}.details[_ngcontent-%COMP%]{padding:.5em}.value[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),e})();function $(e,n){1&e&&(d.Wb(0,"div",6),d.Gc(1,"Today"),d.Vb())}function G(e,n){1&e&&d.Rb(0,"week-view-item",8),2&e&&d.oc("event",n.$implicit)}function E(e,n){if(1&e&&(d.Ub(0),d.Ec(1,G,1,1,"week-view-item",7),d.Tb()),2&e){const e=d.ic();d.Cb(1),d.oc("ngForOf",e.booking_list)}}const j=function(){return{class:"material-icons",content:"close"}};function F(e,n){if(1&e&&(d.Wb(0,"div",9),d.Wb(1,"div",10),d.Rb(2,"app-icon",11),d.Vb(),d.Wb(3,"div",1),d.Gc(4),d.Vb(),d.Vb()),2&e){const e=d.ic();d.Cb(2),d.oc("icon",d.pc(2,j)),d.Cb(2),d.Ic("No events for ",e.date_display,"")}}let D=(()=>{class e{constructor(){this.booking_list=[]}get date_display(){return M(this.date).format("ddd, DD MMM YYYY")}get is_today(){return M(this.date).isSame(M(),"d")}ngOnChanges(e){(e.date||e.spaces)&&this.updateBookings()}updateBookings(){let e=[];this.spaces.forEach(n=>{e=e.concat(n.bookingsFor(this.date)||[])}),e.sort((e,n)=>e.date-n.date),this.booking_list=e}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=d.Kb({type:e,selectors:[["week-view-day-display"]],inputs:{date:"date",spaces:"spaces"},features:[d.Ab],decls:8,vars:4,consts:[[1,"heading"],[1,"text"],["class","info",4,"ngIf"],[1,"list"],[4,"ngIf","ngIfElse"],["empty_state",""],[1,"info"],[3,"event",4,"ngFor","ngForOf"],[3,"event"],[1,"info-block"],[1,"icon"],[3,"icon"]],template:function(e,n){if(1&e&&(d.Wb(0,"div",0),d.Wb(1,"div",1),d.Gc(2),d.Vb(),d.Ec(3,$,2,0,"div",2),d.Vb(),d.Wb(4,"div",3),d.Ec(5,E,2,1,"ng-container",4),d.Vb(),d.Ec(6,F,5,3,"ng-template",null,5,d.Fc)),2&e){const e=d.tc(7);d.Cb(2),d.Hc(n.date_display),d.Cb(1),d.oc("ngIf",n.is_today),d.Cb(2),d.oc("ngIf",n.booking_list&&n.booking_list.length)("ngIfElse",e)}},directives:[i.t,i.s,I,x.a],styles:["[_nghost-%COMP%]{display:flex;align-items:center;flex-direction:column;height:100%;border-left:1px solid #ccc}[_nghost-%COMP%]:first-child{border:none}[_nghost-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.heading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;padding:.25em 1em;height:3em;border-bottom:1px solid #ccc;text-align:center}.info[_ngcontent-%COMP%]{font-size:.75em}.list[_ngcontent-%COMP%]{flex:1;min-height:50%;background-color:#fff;overflow:auto}.info-block[_ngcontent-%COMP%]{font-size:.8em;opacity:.6}"]}),e})();function z(e,n){1&e&&(d.Wb(0,"div",3),d.Rb(1,"mat-progress-bar",4),d.Vb())}function T(e,n){if(1&e&&d.Rb(0,"week-view-day-display",5),2&e){const e=n.$implicit,t=d.ic();d.oc("date",e)("spaces",t.space_list)}}let A=(()=>{class e extends s.a{constructor(e){super(),this._service=e,this.date_list=[],this.space_list=[],this.search$=new u.a}ngOnInit(){this.date_list=this.generateDates(this.date,this.weekends),this.initBookings(),this.search$.next(`${this.date}|${this.weekends}|${this.level}`),this.interval("update_booking",()=>this.search$.next(`${this.date}|${this.weekends}|${this.level}|${M().unix()}`),3e4)}ngOnChanges(e){(e.date||e.weekends||e.level)&&(this.date_list=this.generateDates(this.date,this.weekends),this.search$.next(`${this.date}|${this.weekends}|${this.level}`))}generateDates(e,n=!1){const t=[];let i=M(e).startOf("d").startOf("w");const o=i.endOf("w");for(;i.isBefore(o,"m");)(0!==i.day()&&6!==i.day()||n)&&t.push(i.valueOf()),i=i.add(1,"d");return t}initBookings(){this.search_results$=this.search$.pipe(Object(f.a)(100),Object(C.a)(),Object(m.a)(e=>{this.loading=!0;const n=M(this.date).startOf("w");return this._service.Spaces.query({zone_ids:`${this.level}${this.space_type?","+this.space_type:""}`,available_from:Math.floor(this.date_list[0]/1e3)||n.unix(),available_to:Math.floor(this.date_list[this.date_list.length-1]/1e3)||n.endOf("w").unix()})}),Object(O.a)(e=>Object(_.a)([]))),this.subscription("search_results",this.search_results$.subscribe(e=>{this.loading=!1,this.space_list=e}))}}return e.\u0275fac=function(n){return new(n||e)(d.Qb(g.a))},e.\u0275cmp=d.Kb({type:e,selectors:[["week-view-timeline"]],inputs:{date:"date",level:"level",space_type:"space_type",weekends:"weekends",loading:"loading"},features:[d.zb,d.Ab],decls:3,vars:2,consts:[[1,"week-timeline"],["class","loader",4,"ngIf"],[3,"date","spaces",4,"ngFor","ngForOf"],[1,"loader"],["mode","indeterminate"],[3,"date","spaces"]],template:function(e,n){1&e&&(d.Wb(0,"div",0),d.Ec(1,z,2,0,"div",1),d.Ec(2,T,1,2,"week-view-day-display",2),d.Vb()),2&e&&(d.Cb(1),d.oc("ngIf",n.loading),d.Cb(1),d.oc("ngForOf",n.date_list))},directives:[i.t,i.s,w.a,D],styles:[".week-timeline[_ngcontent-%COMP%]{position:relative;display:flex;height:100%;width:100%;background-color:#ecf1f5}.week-timeline[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:1;min-width:12.5%}.loader[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;height:4px;z-index:999}"]}),e})();var R=t("bTqV"),B=t("kmnG"),K=t("d3UM"),L=t("FKr1");function Q(e,n){if(1&e&&(d.Wb(0,"mat-option",14),d.Gc(1),d.Vb()),2&e){const e=n.$implicit;d.oc("value",e.id),d.Cb(1),d.Ic(" ",e.name," ")}}function H(e,n){if(1&e){const e=d.Xb();d.Wb(0,"mat-form-field",11),d.Wb(1,"mat-select",12),d.ec("ngModelChange",(function(n){return d.wc(e),d.ic().active_level=n}))("ngModelChange",(function(){return d.wc(e),d.ic().updateLevel()})),d.Ec(2,Q,2,2,"mat-option",13),d.Vb(),d.Vb()}if(2&e){const e=d.ic();d.Cb(1),d.oc("ngModel",e.active_level),d.Cb(1),d.oc("ngForOf",e.levels)}}function N(e,n){if(1&e&&(d.Wb(0,"mat-option",14),d.Gc(1),d.Vb()),2&e){const e=n.$implicit;d.oc("value",e.id),d.Cb(1),d.Ic(" ",e.name," ")}}function S(e,n){if(1&e){const e=d.Xb();d.Wb(0,"mat-form-field",11),d.Wb(1,"mat-select",12),d.ec("ngModelChange",(function(n){return d.wc(e),d.ic().active_type=n})),d.Ec(2,N,2,2,"mat-option",13),d.Vb(),d.Vb()}if(2&e){const e=d.ic();d.Cb(1),d.oc("ngModel",e.active_type),d.Cb(1),d.oc("ngForOf",e.space_types)}}let U=(()=>{class e extends s.a{constructor(e,n,t,i){super(),this._service=e,this._dialog=n,this._router=t,this._route=i,this.active_level="",this.active_type="",this.levels=[],this.space_types=[]}ngOnInit(){this._service.initialised.pipe(Object(a.a)(e=>e)).subscribe(()=>{this.subscription("route.params",this._route.paramMap.subscribe(e=>{if(e.has("level")&&this.active_level!==e.get("level")){const n=this._service.Organisation.levelWithID(e.get("level"));if(n){const e=this._service.Organisation.buildings.find(e=>e.id===n.building_id);e&&(this.active_level=n.id,this._service.Organisation.building=e)}}})),this.subscription("building",this._service.Organisation.listen("active_building").subscribe(()=>{const e=this._service.Organisation.building||{levels:[]};e.levels.find(e=>e.id===this.active_level)||(this.active_level=(e.levels[0]||{id:""}).id,this.updateLevel()),this.levels=[{id:"",name:"All Levels"}].concat(e.levels||[]),this.levels.sort((e,n)=>(e.name||"").localeCompare(n.name||"")),this.space_types=[{id:"",name:"All Space Types"}].concat(this._service.Organisation.space_types)}))})}newMeeting(){this._dialog.open(r.a,{data:{booking:new l.a(this._service.Bookings,{})}})}updateLevel(){this._router.navigate(["/week-view",this.active_level])}}return e.\u0275fac=function(n){return new(n||e)(d.Qb(g.a),d.Qb(b.b),d.Qb(c.c),d.Qb(c.a))},e.\u0275cmp=d.Kb({type:e,selectors:[["a-week-view"]],features:[d.zb],decls:17,vars:8,consts:[[1,"week-view"],[1,"group"],[3,"date","dateChange"],[1,"topbar"],["appearance","outline",4,"ngIf"],["labelPosition","before","title","Only show meetings with setup and breakdown times",3,"ngModel","ngModelChange"],[3,"date","level","space_type","weekends"],["mat-button","",1,"new-item",3,"touchrelease"],[1,"content"],[1,"material-icons"],[1,"text"],["appearance","outline"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,n){1&e&&(d.Wb(0,"div",0),d.Rb(1,"a-sidebar"),d.Wb(2,"div",1),d.Wb(3,"a-topbar-header",2),d.ec("dateChange",(function(e){return n.date=e})),d.Wb(4,"div",3),d.Ec(5,H,3,2,"mat-form-field",4),d.Ec(6,S,3,2,"mat-form-field",4),d.Wb(7,"mat-slide-toggle",5),d.ec("ngModelChange",(function(e){return n.weekend=e})),d.Gc(8," Show Weekends "),d.Vb(),d.Vb(),d.Vb(),d.Wb(9,"main"),d.Rb(10,"week-view-timeline",6),d.Vb(),d.Vb(),d.Wb(11,"button",7),d.ec("touchrelease",(function(){return n.newMeeting()})),d.Wb(12,"div",8),d.Wb(13,"div",9),d.Gc(14,"add"),d.Vb(),d.Wb(15,"div",10),d.Gc(16,"New Meeting"),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.Cb(3),d.oc("date",n.date),d.Cb(2),d.oc("ngIf",n.levels&&n.levels.length>1),d.Cb(1),d.oc("ngIf",n.space_types&&n.space_types.length>1),d.Cb(1),d.oc("ngModel",n.weekend),d.Cb(3),d.oc("date",n.date)("level",n.active_level)("space_type",n.active_type)("weekends",n.weekend))},directives:[v.a,p.a,i.t,h.a,o.r,o.u,A,R.b,k.c,B.b,K.a,i.s,L.g],styles:[".week-view[_ngcontent-%COMP%], [_nghost-%COMP%], main[_ngcontent-%COMP%]{height:100%;width:100%}.week-view[_ngcontent-%COMP%]{display:flex;height:100%}main[_ngcontent-%COMP%]{height:calc(100% - 3.5em)}.group[_ngcontent-%COMP%]{flex:1;min-width:12em}.topbar[_ngcontent-%COMP%]{padding:.1em 0 .1em .5em;height:3.5em}.topbar[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin-right:.5em}.new-item[_ngcontent-%COMP%]{position:absolute;bottom:1em;right:1em;z-index:999;cursor:pointer;height:1.5em;min-width:1.5em;padding:0;border-radius:.8em;font-size:1.75em;border:none;transition:padding .2s;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.new-item[_ngcontent-%COMP%], .new-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{align-items:center;justify-content:center}.new-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex}.new-item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{width:0;overflow:hidden;opacity:0;transition:width .2s,opacity .2s;font-size:1.2rem}.new-item[_ngcontent-%COMP%]:hover{padding:0 .5em}.new-item[_ngcontent-%COMP%]:hover   .text[_ngcontent-%COMP%]{width:7em;opacity:1}"]}),e})();var X=t("PCNd");t.d(n,"WeekViewModule",(function(){return Y}));const q=[{path:"",component:U},{path:":level",component:U},{path:"**",redirectTo:""}];let Y=(()=>{class e{}return e.\u0275mod=d.Ob({type:e}),e.\u0275inj=d.Nb({factory:function(n){return new(n||e)},imports:[[i.c,o.l,c.g.forChild(q),X.a]]}),e})()}}]);