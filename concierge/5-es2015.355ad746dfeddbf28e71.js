(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"A1+e":function(t,e,n){"use strict";n.r(e);var i=n("ofXK"),o=n("tyNb"),a=n("3Pt+"),c=n("IWZj"),r=n("fXoL"),s=n("BAfr"),d=n("ocbO"),b=n("kmnG"),g=n("0njA"),l=n("qFsG"),m=n("bTqV"),u=n("m6yr"),p=n("IRj4"),f=n("0IaG");function h(t,e){return function(t,e){t=t||[],"string"==typeof(e=e||{})&&(e={type:e});try{return new Blob(t,e)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<t.length;i+=1)n.append(t[i]);return n.getBlob(e.type)}}([t],e)}var C=n("OaWH"),_=n("Sa0K"),M=n("Xa2L"),v=n("q/DJ");const y=function(){return{type:"icon",class:"material-icons",content:"close"}};function O(t,e){1&t&&(r.Wb(0,"button",5),r.Rb(1,"app-icon",6),r.Vb()),2&t&&(r.Cb(1),r.oc("icon",r.pc(1,y)))}const I=function(){return{class:"material-icons",content:"cloud_upload"}};function w(t,e){1&t&&r.Rb(0,"app-icon",6),2&t&&r.oc("icon",r.pc(1,I))}function W(t,e){1&t&&r.Rb(0,"mat-spinner",18)}function P(t,e){if(1&t){const t=r.Xb();r.Wb(0,"main"),r.Wb(1,"form",7),r.Wb(2,"div",8),r.Wb(3,"div",9),r.jc(4,"safe"),r.Ec(5,w,1,2,"app-icon",10),r.Ec(6,W,1,0,"mat-spinner",11),r.Wb(7,"input",12),r.ec("change",(function(e){return r.wc(t),r.ic().uploadImage(e)})),r.Vb(),r.Vb(),r.Vb(),r.Wb(8,"div",8),r.Wb(9,"label",13),r.Gc(10,"Name"),r.Wb(11,"span"),r.Gc(12,"*"),r.Vb(),r.Vb(),r.Wb(13,"mat-form-field",14),r.Rb(14,"input",15),r.Wb(15,"mat-error"),r.Gc(16,"A valid name is required"),r.Vb(),r.Vb(),r.Vb(),r.Wb(17,"div",8),r.Wb(18,"label",16),r.Gc(19,"Description"),r.Vb(),r.Wb(20,"mat-form-field",14),r.Rb(21,"textarea",17),r.Vb(),r.Vb(),r.Vb(),r.Vb()}if(2&t){const t=r.ic();r.Cb(1),r.oc("formGroup",t.form),r.Cb(2),r.Dc("background",r.lc(4,7,"linear-gradient(rgba(0,0,0,.35),rgba(0,0,0,.35)), url("+t.image+")","style"),r.Jb),r.Cb(2),r.oc("ngIf",!t.uploading),r.Cb(1),r.oc("ngIf",t.uploading),r.Cb(3),r.Gb("error",t.form.controls.name.errors&&t.form.controls.name.touched)}}function x(t,e){if(1&t&&(r.Wb(0,"main"),r.Wb(1,"div",19),r.Wb(2,"div",20),r.Rb(3,"mat-spinner",21),r.Vb(),r.Wb(4,"div",22),r.Gc(5),r.Vb(),r.Vb(),r.Vb()),2&t){const t=r.ic();r.Cb(5),r.Hc(t.loading)}}let V=(()=>{class t extends c.a{constructor(t,e,n,i){super(),this._service=t,this._upload_manager=e,this._dialog_ref=n,this._data=i,this.event=new r.o}get category(){return this._data.category}get image(){return this.form?this.form.controls.image_path.value:""}ngOnInit(){this.form=new a.i({name:new a.f(this.category.name,[a.F.required]),description:new a.f(this.category.description),image_path:new a.f(this.category.image_path)})}submit(){if(this.form.markAllAsTouched(),console.log("Form:",this.form),this.form.valid){const t=Object.assign(Object.assign({},this.category.toJSON()),this.form.value);(this.category.id?this._service.CateringCategories.update(this.category.id,t):this._service.CateringCategories.add(t)).then(t=>{this.event.emit({reason:"done",metadata:t}),this._dialog_ref.close()},t=>this._service.notifyError(`Error ${this.category.id?"updating":"creating"} category. Error: ${t.message||t}`))}}uploadImage(t){if(t&&t.target&&t.target.files){const e=t.target.files;if(e.length){const t=new FileReader;t.onloadend=t=>{this.uploading=!0;const n=h(t.target.result,"image/png");this._upload_manager.upload([n],{file_name:e[0].name});const i=this._upload_manager.uploads[this._upload_manager.uploads.length-1];this.interval("upload",()=>{(i.complete||i.error)&&(i.access_url&&i.complete&&(console.log("Upload:",i),this.form.controls.image_path.setValue(i.access_url)),this.uploading=!1,this.clearInterval("upload"))})},t.readAsArrayBuffer(e[0])}}}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(C.a),r.Qb(_.c),r.Qb(f.h),r.Qb(f.a))},t.\u0275cmp=r.Kb({type:t,selectors:[["a-catering-category-modal"]],outputs:{event:"event"},features:[r.zb],decls:12,vars:5,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["mat-button","",3,"disabled","tapped"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[3,"formGroup"],[1,"field"],[1,"image"],[3,"icon",4,"ngIf"],["diameter","48",4,"ngIf"],["type","file",3,"change"],["for","name"],["appearance","outline"],["matInput","","name","name","placeholder","Category Name","formControlName","name"],["for","description"],["matInput","","name","description","placeholder","Category Description","formControlName","description"],["diameter","48"],[1,"info-block"],[1,"icon"],["diameter","32"],[1,"text"]],template:function(t,e){if(1&t&&(r.Wb(0,"header"),r.Wb(1,"div",0),r.Gc(2),r.Vb(),r.Ec(3,O,2,2,"button",1),r.Vb(),r.Wb(4,"mat-dialog-content"),r.Ec(5,P,22,10,"main",2),r.Vb(),r.Wb(6,"mat-dialog-actions"),r.Wb(7,"footer"),r.Wb(8,"button",3),r.ec("tapped",(function(){return e.submit()})),r.Gc(9,"Save"),r.Vb(),r.Vb(),r.Vb(),r.Ec(10,x,6,1,"ng-template",null,4,r.Fc)),2&t){const t=r.tc(11);r.Cb(2),r.Ic("",e.category.id?"Edit":"Add"," category"),r.Cb(1),r.oc("ngIf",!e.loading),r.Cb(2),r.oc("ngIf",!e.loading)("ngIfElse",t),r.Cb(3),r.oc("disabled",e.uploading)}},directives:[i.t,f.f,f.c,m.b,u.c,f.d,g.a,a.H,a.s,a.j,b.b,l.a,a.c,a.r,a.h,b.a,M.c],pipes:[v.b],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.field[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.heading[_ngcontent-%COMP%]{flex:1;min-width:50%}main[_ngcontent-%COMP%]{padding:1em;width:24em}label[_ngcontent-%COMP%]{min-width:100%;margin-right:1em;font-weight:700;font-size:.8em;width:100%;margin-top:0;margin-bottom:.5em}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ffb300}label.error[_ngcontent-%COMP%]{color:#e53935}.image[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:10em;width:10em!important;border-radius:4px;color:#fff;background-position:50%!important;background-size:cover!important;margin:auto auto 1em}.image[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;opacity:0}.image[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:3em}footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:8em}"]}),t})();var N=n("wZkO"),k=n("bSwM"),j=n("d3UM"),E=n("FKr1");const G=function(){return{type:"icon",class:"material-icons",content:"close"}};function z(t,e){1&t&&(r.Wb(0,"button",5),r.Rb(1,"app-icon",6),r.Vb()),2&t&&(r.Cb(1),r.oc("icon",r.pc(1,G)))}const S=function(){return{class:"material-icons",content:"cloud_upload"}};function D(t,e){1&t&&r.Rb(0,"app-icon",6),2&t&&r.oc("icon",r.pc(1,S))}function L(t,e){1&t&&r.Rb(0,"mat-spinner",31)}function T(t,e){if(1&t&&(r.Wb(0,"mat-option",32),r.Gc(1),r.Vb()),2&t){const t=e.$implicit;r.oc("value",t.id),r.Cb(1),r.Ic(" ",t.name," ")}}function A(t,e){1&t&&(r.Ub(0),r.Wb(1,"div",13),r.Wb(2,"mat-checkbox",33),r.Gc(3,"Out of Stock"),r.Vb(),r.Vb(),r.Wb(4,"div",13),r.Wb(5,"mat-checkbox",34),r.Gc(6,"Can order anytime"),r.Vb(),r.Vb(),r.Wb(7,"div",8),r.Wb(8,"label",35),r.Gc(9,"Unit Price"),r.Vb(),r.Wb(10,"mat-form-field",17),r.Rb(11,"input",36),r.Vb(),r.Vb(),r.Tb())}function Y(t,e){if(1&t){const t=r.Xb();r.Wb(0,"main"),r.Wb(1,"form",7),r.Wb(2,"div",8),r.Wb(3,"div",9),r.jc(4,"safe"),r.Ec(5,D,1,2,"app-icon",10),r.Ec(6,L,1,0,"mat-spinner",11),r.Wb(7,"input",12),r.ec("change",(function(e){return r.wc(t),r.ic().uploadImage(e)})),r.Vb(),r.Vb(),r.Vb(),r.Wb(8,"div",13),r.Wb(9,"label",14),r.Gc(10,"Parent Category"),r.Vb(),r.Wb(11,"div",15),r.Gc(12),r.Vb(),r.Vb(),r.Wb(13,"div",13),r.Wb(14,"mat-checkbox",16),r.Gc(15,"Package"),r.Vb(),r.Vb(),r.Wb(16,"div",8),r.Wb(17,"label",14),r.Gc(18,"Name"),r.Wb(19,"span"),r.Gc(20,"*"),r.Vb(),r.Vb(),r.Wb(21,"mat-form-field",17),r.Rb(22,"input",18),r.Wb(23,"mat-error"),r.Gc(24,"A valid name is required"),r.Vb(),r.Vb(),r.Vb(),r.Wb(25,"div",8),r.Wb(26,"label",19),r.Gc(27,"Type"),r.Wb(28,"span"),r.Gc(29,"*"),r.Vb(),r.Vb(),r.Wb(30,"mat-form-field",17),r.Wb(31,"mat-select",20),r.Ec(32,T,2,2,"mat-option",21),r.Vb(),r.Wb(33,"mat-error"),r.Gc(34,"Type is required"),r.Vb(),r.Vb(),r.Vb(),r.Wb(35,"div",8),r.Wb(36,"label",22),r.Gc(37,"Description"),r.Vb(),r.Wb(38,"mat-form-field",17),r.Rb(39,"textarea",23),r.Vb(),r.Vb(),r.Ec(40,A,12,0,"ng-container",24),r.Wb(41,"div",8),r.Wb(42,"label",25),r.Gc(43),r.Vb(),r.Wb(44,"mat-form-field",17),r.Rb(45,"input",26),r.Vb(),r.Vb(),r.Wb(46,"div",8),r.Wb(47,"label",27),r.Gc(48,"Minimum Quanity"),r.Vb(),r.Wb(49,"mat-form-field",17),r.Rb(50,"input",28),r.Vb(),r.Vb(),r.Wb(51,"div",8),r.Wb(52,"label",29),r.Gc(53,"Maximum Quanity"),r.Vb(),r.Wb(54,"mat-form-field",17),r.Rb(55,"input",30),r.Vb(),r.Vb(),r.Vb(),r.Vb()}if(2&t){const t=r.ic();r.Cb(1),r.oc("formGroup",t.form),r.Cb(2),r.Dc("background",r.lc(4,13,"linear-gradient(rgba(0,0,0,.35),rgba(0,0,0,.35)), url("+t.image+")","style"),r.Jb),r.Cb(2),r.oc("ngIf",!t.uploading),r.Cb(1),r.oc("ngIf",t.uploading),r.Cb(6),r.Hc(t.parent.name),r.Cb(5),r.Gb("error",t.form.controls.name.errors&&t.form.controls.name.touched),r.Cb(9),r.Gb("error",t.form.controls.catering_type.errors&&t.form.controls.catering_type.touched),r.Cb(6),r.oc("ngForOf",t.types),r.Cb(8),r.oc("ngIf",t.package),r.Cb(3),r.Ic("Items to select from ",t.package?"package":"sub-category","")}}function R(t,e){if(1&t&&(r.Wb(0,"main"),r.Wb(1,"div",37),r.Wb(2,"div",38),r.Rb(3,"mat-spinner",39),r.Vb(),r.Wb(4,"div",40),r.Gc(5),r.Vb(),r.Vb(),r.Vb()),2&t){const t=r.ic();r.Cb(5),r.Hc(t.loading)}}let F=(()=>{class t extends c.a{constructor(t,e,n,i){super(),this._service=t,this._upload_manager=e,this._dialog_ref=n,this._data=i,this.event=new r.o,this.types=[{id:"kitchen",name:"Kitchen"},{id:"pantry",name:"Pantry"}]}get category(){return this._data.group}get parent(){return this._data.parent}get image(){return this.form?this.form.controls.image_path.value:""}get package(){return!!this.form&&this.form.controls.package.value}ngOnInit(){this.form=new a.i({name:new a.f(this.category.name,[a.F.required]),description:new a.f(this.category.description),image_path:new a.f(this.category.image_path),catering_type:new a.f(this.category.catering_type,[a.F.required]),package:new a.f(this.category.package||!1),must_select:new a.f(this.category.must_select),unit_price:new a.f(this.category.unit_price),minimum_quantity:new a.f(this.category.minimum_quantity),maximum_quantity:new a.f(this.category.maximum_quantity),order_anytime:new a.f(this.category.order_anytime),out_of_stock:new a.f(this.category.out_of_stock)})}submit(){if(this.form.markAllAsTouched(),console.log("Form:",this.form),this.form.valid){const t=Object.assign(Object.assign({},this.category.toJSON()),this.form.value);(this.category.id?this._service.CateringCategories.update(this.category.id,t):this._service.CateringCategories.add(t)).then(t=>{this.event.emit({reason:"done",metadata:t}),this._dialog_ref.close()},t=>this._service.notifyError(`Error ${this.category.id?"updating":"creating"} category. Error: ${t.message||t}`))}}uploadImage(t){if(t&&t.target&&t.target.files){const e=t.target.files;if(e.length){const t=new FileReader;t.onloadend=t=>{this.uploading=!0;const n=h(t.target.result,"image/png");this._upload_manager.upload([n],{file_name:e[0].name});const i=this._upload_manager.uploads[this._upload_manager.uploads.length-1];this.interval("upload",()=>{(i.complete||i.error)&&(i.access_url&&i.complete&&(console.log("Upload:",i),this.form.controls.image_path.setValue(i.access_url)),this.uploading=!1,this.clearInterval("upload"))})},t.readAsArrayBuffer(e[0])}}}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(C.a),r.Qb(_.c),r.Qb(f.h),r.Qb(f.a))},t.\u0275cmp=r.Kb({type:t,selectors:[["a-catering-group-modal"]],outputs:{event:"event"},features:[r.zb],decls:12,vars:6,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["mat-button","",3,"disabled","tapped"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[3,"formGroup"],[1,"field"],[1,"image"],[3,"icon",4,"ngIf"],["diameter","48",4,"ngIf"],["type","file",3,"change"],[1,"field","padded"],["for","name"],[1,"value"],["formControlName","package"],["appearance","outline"],["matInput","","name","name","placeholder","Category Name","formControlName","name"],["for","type"],["name","type","formControlName","catering_type","placeholder","Select type"],[3,"value",4,"ngFor","ngForOf"],["for","description"],["matInput","","name","description","placeholder","Category Description","formControlName","description"],[4,"ngIf"],["for","must-select"],["matInput","","name","must-select","type","number","placeholder","Must select X items from grouping","formControlName","must_select"],["for","min-quanity"],["matInput","","name","min-quanity","type","number","placeholder","Minimum Quantity","formControlName","minimum_quantity"],["for","max-quanity"],["matInput","","name","max-quanity","type","number","placeholder","Maximum Quantity","formControlName","maximum_quantity"],["diameter","48"],[3,"value"],["formControlName","out_of_stock"],["formControlName","order_anytime"],["for","unit-price"],["matInput","","name","unit-price","type","number","placeholder","Price for one unit of the item without decimal places","formControlName","unit_price"],[1,"info-block"],[1,"icon"],["diameter","32"],[1,"text"]],template:function(t,e){if(1&t&&(r.Wb(0,"header"),r.Wb(1,"div",0),r.Gc(2),r.Vb(),r.Ec(3,z,2,2,"button",1),r.Vb(),r.Wb(4,"mat-dialog-content"),r.Ec(5,Y,56,16,"main",2),r.Vb(),r.Wb(6,"mat-dialog-actions"),r.Wb(7,"footer"),r.Wb(8,"button",3),r.ec("tapped",(function(){return e.submit()})),r.Gc(9,"Save"),r.Vb(),r.Vb(),r.Vb(),r.Ec(10,R,6,1,"ng-template",null,4,r.Fc)),2&t){const t=r.tc(11);r.Cb(2),r.Jc(" ",e.category.id?"Edit":"Add"," ",e.package?"package":"sub-category"," "),r.Cb(1),r.oc("ngIf",!e.loading),r.Cb(2),r.oc("ngIf",!e.loading)("ngIfElse",t),r.Cb(3),r.oc("disabled",e.uploading)}},directives:[i.t,f.f,f.c,m.b,u.c,f.d,g.a,a.H,a.s,a.j,k.a,a.r,a.h,b.b,l.a,a.c,b.a,j.a,i.s,a.x,M.c,E.g],pipes:[v.b],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.field[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.heading[_ngcontent-%COMP%]{flex:1;min-width:50%}main[_ngcontent-%COMP%]{padding:1em;width:24em}label[_ngcontent-%COMP%]{min-width:100%;margin-right:1em;font-weight:700;font-size:.8em;width:100%;margin-top:0;margin-bottom:.5em}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ffb300}label.error[_ngcontent-%COMP%]{color:#e53935}.padded[_ngcontent-%COMP%]{padding:0 0 1em}.image[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:10em;width:10em!important;border-radius:4px;color:#fff;background-position:50%!important;background-size:cover!important;margin:auto auto 1em}.image[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;opacity:0}.image[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:3em}footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:8em}"]}),t})();function U(t,e){if(1&t&&(r.Wb(0,"div",4),r.Rb(1,"a-catering-menu-item",5),r.Vb()),2&t){const t=e.$implicit,n=r.ic(2);r.Cb(1),r.oc("parent",n.category)("item",t)}}function Q(t,e){if(1&t&&(r.Ub(0),r.Ec(1,U,2,2,"div",3),r.Tb()),2&t){const t=r.ic();r.Cb(1),r.oc("ngForOf",t.category.items)}}const B=function(){return{class:"material-icons",content:"close"}};function Z(t,e){if(1&t&&(r.Wb(0,"div",6),r.Wb(1,"div",7),r.Rb(2,"app-icon",8),r.Vb(),r.Wb(3,"div",9),r.Gc(4),r.Vb(),r.Vb()),2&t){const t=r.ic();r.Cb(2),r.oc("icon",r.pc(2,B)),r.Cb(2),r.Ic("No packages or sub-categories for ",t.category.name,"")}}let H=(()=>{class t extends c.a{constructor(t,e){super(),this._dialog=t,this._service=e}get building(){return this._service.Organisation.building}ngOnChanges(t){t.package&&this.package&&this.openGroupModal()}openGroupModal(t){t||(t=new p.a({parent_id:this.category.id,zones:[this.building.id]}));const e=this._dialog.open(F,{data:{group:t,parent:this.category}});this.subscription("category_modal",e.componentInstance.event.subscribe(t=>{if("done"===t.reason){const e=this.category.items.findIndex(e=>t.metadata.id===e.id);e>=0?this.category.items.splice(e,1,t.metadata):this.category.items.push(t.metadata)}})),e.afterClosed().subscribe(()=>this.unsub("category_modal"))}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(f.b),r.Qb(C.a))},t.\u0275cmp=r.Kb({type:t,selectors:[["a-catering-menu-item-list"]],inputs:{category:"category",package:"package"},features:[r.zb,r.Ab],decls:4,vars:2,consts:[[1,"list"],[4,"ngIf","ngIfElse"],["empty_state",""],["class","item",4,"ngFor","ngForOf"],[1,"item"],[3,"parent","item"],[1,"info-block","center"],[1,"icon"],[3,"icon"],[1,"text"]],template:function(t,e){if(1&t&&(r.Wb(0,"div",0),r.Ec(1,Q,2,1,"ng-container",1),r.Vb(),r.Ec(2,Z,5,3,"ng-template",null,2,r.Fc)),2&t){const t=r.tc(3);r.Cb(1),r.oc("ngIf",e.category&&e.category.items&&e.category.items.length)("ngIfElse",t)}},styles:[".list[_ngcontent-%COMP%]{position:relative;height:100%;width:100%;overflow:auto;padding-top:1em;background-color:#ecf1f5;color:#000}.item[_ngcontent-%COMP%]{width:768px;min-height:4em;overflow:hidden;border-radius:8px;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);margin:auto auto 1em;max-width:calc(100% - 1em)}"]}),t})();const $=function(){return{class:"material-icons",content:"edit"}};function J(t,e){if(1&t){const t=r.Xb();r.Wb(0,"div",9),r.Wb(1,"div",10),r.Gc(2),r.Vb(),r.Wb(3,"button",11),r.ec("click",(function(e){return r.wc(t),e.stopPropagation()}))("tapped",(function(){r.wc(t);const e=r.ic().$implicit;return r.ic(3).openCategoryModal(e)})),r.Rb(4,"app-icon",12),r.Vb(),r.Vb()}if(2&t){const t=r.ic().$implicit;r.Cb(2),r.Hc(null==t?null:t.name),r.Cb(2),r.oc("icon",r.pc(2,$))}}function q(t,e){if(1&t&&(r.Wb(0,"mat-tab"),r.Ec(1,J,5,3,"ng-template",7),r.Rb(2,"a-catering-menu-item-list",8),r.Vb()),2&t){const t=e.$implicit,n=e.index,i=r.ic(3);r.Cb(2),r.oc("package",i.state[n])("category",t)}}function X(t,e){if(1&t){const t=r.Xb();r.Wb(0,"mat-tab-group",5),r.ec("selectedIndexChange",(function(e){return r.wc(t),r.ic(2).index=e})),r.Ec(1,q,3,2,"mat-tab",6),r.Vb()}if(2&t){const t=r.ic(2);r.oc("selectedIndex",t.index),r.Cb(1),r.oc("ngForOf",t.filtered_menu)}}function K(t,e){if(1&t&&(r.Ub(0),r.Ec(1,X,2,2,"mat-tab-group",4),r.Tb()),2&t){const t=r.ic(),e=r.tc(5);r.Cb(1),r.oc("ngIf",t.filtered_menu&&t.filtered_menu.length)("ngIfElse",e)}}function tt(t,e){if(1&t&&(r.Wb(0,"div",13),r.Wb(1,"div",14),r.Rb(2,"mat-spinner",15),r.Vb(),r.Wb(3,"div",16),r.Gc(4),r.Vb(),r.Vb()),2&t){const t=r.ic();r.Cb(4),r.Ic("Loading menu for ",t.building.name,"")}}const et=function(){return{class:"material-icons",content:"close"}};function nt(t,e){if(1&t&&(r.Wb(0,"div",13),r.Wb(1,"div",14),r.Rb(2,"app-icon",12),r.Vb(),r.Wb(3,"div",16),r.Gc(4),r.Vb(),r.Vb()),2&t){const t=r.ic();r.Cb(2),r.oc("icon",r.pc(2,et)),r.Cb(2),r.Ic("No menu categories for ",t.building.name,"")}}let it=(()=>{class t extends c.a{constructor(t,e){super(),this._service=t,this._dialog=e,this.length=new r.o,this.catering_menu=[],this.filtered_menu=[],this.index=0,this.state={}}get building(){return this._service.Organisation.building}ngOnInit(){this.subscription("building",this._service.Organisation.listen("active_building").subscribe(t=>{this.index=0,this.catering_menu=[],this.filtered_menu=[],this.loadCateringMenu()}))}ngOnChanges(t){t.search&&(this.filtered_menu=this.filter(this.catering_menu)),t.category&&this.category&&this.openCategoryModal(),t.package&&(this.state[this.index]=this.package)}openCategoryModal(t){t||(t=new p.a({zones:[this.building.id]}));const e=this._dialog.open(V,{data:{category:t}});this.subscription("category_modal",e.componentInstance.event.subscribe(t=>{if("done"===t.reason){const e=this.catering_menu.findIndex(e=>t.metadata.id===e.id);e>=0?(this.catering_menu.splice(e,1,t.metadata),this.index=e):(this.index=this.catering_menu.length,this.catering_menu.push(t.metadata))}})),e.afterClosed().subscribe(()=>this.unsub("category_modal"))}loadCateringMenu(){this.building&&(this.loading=!0,this._service.Menu.query({zone_id:this.building.id}).then(t=>{console.log("Menu:",t),this.catering_menu=(t||[]).map(t=>new p.a(t)),this.length.emit(this.catering_menu.length),this.filtered_menu=this.filter(this.catering_menu),this.loading=!1},t=>{this._service.notifyError(`Error loading menu for ${this.building.name}. Error: ${t.message|t}`,"Retry",()=>this.loadCateringMenu()),this.loading=!1}))}filter(t){return t}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(C.a),r.Qb(f.b))},t.\u0275cmp=r.Kb({type:t,selectors:[["a-catering-menu"]],inputs:{search:"search",category:"category",package:"package"},outputs:{length:"length"},features:[r.zb,r.Ab],decls:6,vars:2,consts:[[1,"menu","page","dark-mode"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[3,"selectedIndex","selectedIndexChange",4,"ngIf","ngIfElse"],[3,"selectedIndex","selectedIndexChange"],[4,"ngFor","ngForOf"],["mat-tab-label",""],[3,"package","category"],[1,"tab-label"],[1,"label"],["mat-icon-button","",3,"click","tapped"],[3,"icon"],[1,"info-block","center"],[1,"icon"],["diameter","32"],[1,"text"]],template:function(t,e){if(1&t&&(r.Wb(0,"div",0),r.Ec(1,K,2,2,"ng-container",1),r.Vb(),r.Ec(2,tt,5,1,"ng-template",null,2,r.Fc),r.Ec(4,nt,5,3,"ng-template",null,3,r.Fc)),2&t){const t=r.tc(3);r.Cb(1),r.oc("ngIf",!e.loading)("ngIfElse",t)}},directives:[i.t,N.c,i.s,N.a,N.d,H,m.b,u.c,g.a,M.c],styles:[".page[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%;width:100%}mat-tab-group[_ngcontent-%COMP%]{height:100%;background-color:#051c2c}.info-block[_ngcontent-%COMP%]{color:#000}.tab-label[_ngcontent-%COMP%]{display:flex;align-items:center;padding-left:2.75em}.tab-label[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:.5em}.tab-label[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{opacity:0}.tab-label[_ngcontent-%COMP%]:hover   button[_ngcontent-%COMP%]{opacity:1}"]}),t})();var ot=n("XNiG"),at=n("LRne"),ct=n("SxV6"),rt=n("Kj3r"),st=n("/uUt"),dt=n("eIep"),bt=n("JIr8"),gt=n("lJxs"),lt=n("7c/B"),mt=n("YxBP"),ut=n("Wgwc"),pt=n("mrSG");const ft=function(t){return["/day-view",t]},ht=function(t){return{view:t}};let Ct=(()=>{class t{storeBooking(){localStorage.setItem("CONCIERGE.view_booking",JSON.stringify(this.booking.toJSON())),localStorage.setItem("CONCIERGE.date",`${this.booking.date}`)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.Kb({type:t,selectors:[["order-booking-details"]],inputs:{booking:"booking"},decls:25,vars:11,consts:[[1,"heading"],[1,"content"],[1,"field"],["for","host"],["name","host",1,"value"],["for","space"],["name","space",1,"value"],["for","period"],["name","period",1,"value"],["button","","mat-button","","mat-dialog-close","",1,"footer",3,"routerLink","queryParams","click"]],template:function(t,e){1&t&&(r.Wb(0,"div",0),r.Gc(1," Meeting Details\n"),r.Vb(),r.Wb(2,"div",1),r.Wb(3,"div",2),r.Wb(4,"label",3),r.Gc(5,"Host:"),r.Vb(),r.Wb(6,"div",4),r.Gc(7),r.Vb(),r.Vb(),r.Wb(8,"div",2),r.Wb(9,"label",5),r.Gc(10,"Room:"),r.Vb(),r.Wb(11,"div",6),r.Gc(12),r.Vb(),r.Vb(),r.Wb(13,"div",2),r.Wb(14,"label",7),r.Gc(15,"Period:"),r.Vb(),r.Wb(16,"div",8),r.Gc(17),r.Vb(),r.Vb(),r.Wb(18,"div",2),r.Wb(19,"label",3),r.Gc(20,"Attendees:"),r.Vb(),r.Wb(21,"div",4),r.Gc(22),r.Vb(),r.Vb(),r.Vb(),r.Wb(23,"a",9),r.ec("click",(function(){return e.storeBooking()})),r.Gc(24," View on Day View\n"),r.Vb()),2&t&&(r.Cb(7),r.Ic(" ",(null==e.booking.organiser?null:e.booking.organiser.name)||e.booking.organiser_email," "),r.Cb(5),r.Ic(" ",null==e.booking.space?null:e.booking.space.name," "),r.Cb(5),r.Ic(" ",e.booking.time_period," "),r.Cb(5),r.Jc(" ",(null==e.booking.attendees?null:e.booking.attendees.length)||"0","(",e.booking.expected_attendees[e.booking.space.id]||0," expected) "),r.Cb(1),r.oc("routerLink",r.qc(7,ft,e.booking.space.level.id))("queryParams",r.qc(9,ht,e.booking.id.slice(0,10))))},directives:[m.a,o.f,f.d],styles:["[_nghost-%COMP%]{display:flex;align-items:center;flex-direction:column;height:100%}[_nghost-%COMP%], [_nghost-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.heading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:1em;font-weight:500;background-color:#ccc}.content[_ngcontent-%COMP%]{flex:1;min-height:50%;overflow:auto;padding:.5em 1em}.field[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:.8em;margin:.5em 0 1em}label[_ngcontent-%COMP%]{margin-right:1em;font-weight:500}.footer[_ngcontent-%COMP%]{width:100%;border-radius:0;padding:.35em}"]}),t})();function _t(t,e){if(1&t&&(r.Wb(0,"div",12),r.Wb(1,"div",8),r.Gc(2),r.Vb(),r.Vb()),2&t){const t=e.$implicit;r.Cb(2),r.Hc(t.name)}}function Mt(t,e){if(1&t&&(r.Ub(0),r.Ec(1,_t,3,1,"div",11),r.Tb()),2&t){const t=r.ic().$implicit;r.Cb(1),r.oc("ngForOf",t.items)}}function vt(t,e){if(1&t&&(r.Wb(0,"div",12),r.Wb(1,"div",8),r.Gc(2),r.Vb(),r.Ec(3,Mt,2,1,"ng-container",10),r.Vb()),2&t){const t=e.$implicit;r.Cb(2),r.Hc(t.name),r.Cb(1),r.oc("ngIf",t.items)}}function yt(t,e){if(1&t&&(r.Ub(0),r.Ec(1,vt,4,2,"div",11),r.Tb()),2&t){const t=r.ic().$implicit;r.Cb(1),r.oc("ngForOf",t.items)}}function Ot(t,e){if(1&t&&(r.Wb(0,"div",6),r.Wb(1,"div",7),r.Wb(2,"div",8),r.Gc(3),r.Vb(),r.Wb(4,"div",9),r.Gc(5),r.Vb(),r.Vb(),r.Ec(6,yt,2,1,"ng-container",10),r.Vb()),2&t){const t=e.$implicit;r.Cb(3),r.Hc(t.name),r.Cb(2),r.Ic("x",t.amount,""),r.Cb(1),r.oc("ngIf",t.items)}}function It(t,e){if(1&t&&(r.Ub(0),r.Ec(1,Ot,7,3,"div",5),r.Tb()),2&t){const t=r.ic();r.Cb(1),r.oc("ngForOf",t.items)}}const wt=function(){return{class:"material-icons",content:"close"}};function Wt(t,e){1&t&&(r.Wb(0,"div",13),r.Wb(1,"div",14),r.Rb(2,"app-icon",15),r.Vb(),r.Wb(3,"div",16),r.Gc(4," No items in order "),r.Vb(),r.Vb()),2&t&&(r.Cb(2),r.oc("icon",r.pc(1,wt)))}let Pt=(()=>{class t{constructor(){}get items(){return this.order.items||[]}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.Kb({type:t,selectors:[["order-details-items"]],inputs:{booking:"booking",order:"order"},decls:8,vars:2,consts:[[1,"heading"],[1,"content"],[4,"ngIf","ngIfElse"],["mat-button","",1,"footer"],["empty_state",""],["class","item",4,"ngFor","ngForOf"],[1,"item"],[1,"details"],[1,"name"],[1,"amount"],[4,"ngIf"],["class","sub-item",4,"ngFor","ngForOf"],[1,"sub-item"],[1,"info-block","center"],[1,"icon"],[3,"icon"],[1,"text"]],template:function(t,e){if(1&t&&(r.Wb(0,"div",0),r.Gc(1," Order Details\n"),r.Vb(),r.Wb(2,"div",1),r.Ec(3,It,2,1,"ng-container",2),r.Vb(),r.Wb(4,"button",3),r.Gc(5," Edit Order\n"),r.Vb(),r.Ec(6,Wt,5,2,"ng-template",null,4,r.Fc)),2&t){const t=r.tc(7);r.Cb(3),r.oc("ngIf",e.items&&e.items.length)("ngIfElse",t)}},directives:[i.t,m.b,i.s,g.a],styles:["[_nghost-%COMP%]{display:flex;align-items:center;flex-direction:column;height:100%}[_nghost-%COMP%], [_nghost-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.heading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:1em;font-weight:500;background-color:#ccc}.content[_ngcontent-%COMP%]{flex:1;min-height:50%;overflow:auto;padding:.5em}.item[_ngcontent-%COMP%]{font-size:.8em;border-radius:4px;transition:background-color .2s;padding:.5em}.item[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}.sub-item[_ngcontent-%COMP%]{padding:.5em 1em 0;font-size:.75rem}.details[_ngcontent-%COMP%]{display:flex;align-items:center}.name[_ngcontent-%COMP%]{flex:1;min-width:50%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.name[_ngcontent-%COMP%]:hover{white-space:normal}.amount[_ngcontent-%COMP%]{margin-left:1em}.footer[_ngcontent-%COMP%]{width:100%;border-radius:0;padding:.35em}"]}),t})();function xt(t,e){if(1&t&&(r.Wb(0,"div",11),r.Wb(1,"div",12),r.Gc(2),r.Vb(),r.Wb(3,"div",13),r.Wb(4,"div",14),r.Gc(5),r.Vb(),r.Rb(6,"div",15),r.Wb(7,"div",16),r.Gc(8),r.Vb(),r.Vb(),r.Vb()),2&t){const t=e.$implicit;r.Cb(2),r.Hc(t.message),r.Cb(3),r.Hc(t.author),r.Cb(3),r.Hc(t.time)}}function Vt(t,e){if(1&t&&(r.Ub(0),r.Ec(1,xt,9,3,"div",10),r.Tb()),2&t){const t=r.ic();r.Cb(1),r.oc("ngForOf",t.notes)}}function Nt(t,e){1&t&&(r.Wb(0,"div",17),r.Rb(1,"mat-spinner",18),r.Vb())}const kt=function(){return{class:"material-icons",content:"close"}};function jt(t,e){1&t&&(r.Wb(0,"div",19),r.Wb(1,"div",20),r.Rb(2,"app-icon",7),r.Vb(),r.Wb(3,"div",12),r.Gc(4," No private notes for order "),r.Vb(),r.Vb()),2&t&&(r.Cb(2),r.oc("icon",r.pc(1,kt)))}const Et=function(){return{class:"material-icons",content:"send"}};let Gt=(()=>{class t{constructor(t){this._service=t,this.bookingChange=new r.o}get notes(){const t=this.booking.notes.filter(t=>"catering"===t.type&&t.space===this.order.location_id&&(!t.order_id||t.order_id===this.order.id));return t.forEach(t=>{t.time=ut(t.date).format("DD MMM, h:mm A")}),t}ngOnInit(){}addNote(){return Object(pt.a)(this,void 0,void 0,(function*(){if(this.new_note){const t=this._service.Users.current,e=this.booking,n=e.notes||[],i=ut().startOf("m");e.storePendingChange("notes",[...n,{type:"catering",date:i.valueOf(),author:t.name,order_id:this.order.id,space:e.space.id,message:this.new_note,time:i.format("h:mm A")}]),this.loading=!0;const o=yield e.save().catch(t=>{throw this._service.notifyError(`Failed to add note to order meeting. Error: ${t.message||t}`),this.loading=!1,t});this.booking=o,this.order.booking=o,this.bookingChange.emit(o),this.loading=!1,this.new_note=""}}))}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(C.a))},t.\u0275cmp=r.Kb({type:t,selectors:[["order-details-notes"]],inputs:{booking:"booking",order:"order"},outputs:{bookingChange:"bookingChange"},decls:12,vars:8,consts:[[1,"heading"],[1,"content"],[4,"ngIf","ngIfElse"],[1,"footer"],["appearance","none"],["matInput","","placeholder","Type to add notes",3,"ngModel","disabled","ngModelChange","keyup.enter"],["mat-icon-button","","matSuffix","",3,"disabled","tapped"],[3,"icon"],["class","loader center",4,"ngIf"],["empty_state",""],["class","note",4,"ngFor","ngForOf"],[1,"note"],[1,"text"],[1,"details"],[1,"author"],[1,"fill"],[1,"time"],[1,"loader","center"],["diameter","32"],[1,"info-block","center"],[1,"icon"]],template:function(t,e){if(1&t&&(r.Wb(0,"div",0),r.Gc(1," Private Notes\n"),r.Vb(),r.Wb(2,"div",1),r.Ec(3,Vt,2,1,"ng-container",2),r.Vb(),r.Wb(4,"div",3),r.Wb(5,"mat-form-field",4),r.Wb(6,"input",5),r.ec("ngModelChange",(function(t){return e.new_note=t}))("keyup.enter",(function(){return e.addNote()})),r.Vb(),r.Wb(7,"button",6),r.ec("tapped",(function(){return e.addNote()})),r.Rb(8,"app-icon",7),r.Vb(),r.Vb(),r.Ec(9,Nt,2,0,"div",8),r.Vb(),r.Ec(10,jt,5,2,"ng-template",null,9,r.Fc)),2&t){const t=r.tc(11);r.Cb(3),r.oc("ngIf",e.notes&&e.notes.length)("ngIfElse",t),r.Cb(3),r.oc("ngModel",e.new_note)("disabled",e.loading),r.Cb(1),r.oc("disabled",!e.new_note||e.loading),r.Cb(1),r.oc("icon",r.pc(7,Et)),r.Cb(1),r.oc("ngIf",e.loading)}},directives:[i.t,b.b,l.a,a.c,a.r,a.u,m.b,b.i,u.c,g.a,i.s,M.c],styles:["[_nghost-%COMP%]{display:flex;align-items:center;flex-direction:column;height:100%}[_nghost-%COMP%], [_nghost-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.heading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:1em;font-weight:500;background-color:#ccc}.content[_ngcontent-%COMP%]{position:relative;flex:1;min-height:50%;overflow:auto;padding:.5em 1em}.note[_ngcontent-%COMP%]{font-size:.8em;margin:.5em 0}.note[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-weight:500;padding-bottom:.25em;border-bottom:1px solid #f0f0f0}.details[_ngcontent-%COMP%]{display:flex;align-items:center;color:rgba(0,0,0,.6);margin-top:.25em;font-size:.9em}.details[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]{flex:1;min-width:1px}.footer[_ngcontent-%COMP%]{position:relative;width:100%;border-radius:0;border-top:1px solid #ccc}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transform:translateY(.25em)}mat-form-field[_ngcontent-%COMP%]{height:3.25em;width:100%;padding:0 .5em}"]}),t})();function zt(t,e){if(1&t&&r.Rb(0,"app-icon",12),2&t){const t=r.ic(2);r.oc("icon",null==t.status_details?null:t.status_details.icon)}}function St(t,e){1&t&&r.Rb(0,"mat-spinner",23)}function Dt(t,e){if(1&t&&(r.Wb(0,"mat-option",24),r.Wb(1,"div",16),r.Wb(2,"div",21),r.Gc(3),r.Vb(),r.Rb(4,"div",25),r.Vb(),r.Vb()),2&t){const t=e.$implicit;r.oc("value",t.id),r.Cb(3),r.Hc(t.name),r.Cb(1),r.Dc("background-color",t.colour)}}function Lt(t,e){if(1&t){const t=r.Xb();r.Wb(0,"mat-form-field",13),r.Wb(1,"mat-select",14,15),r.ec("valueChange",(function(e){return r.wc(t),r.ic().active_status=e}))("valueChange",(function(){return r.wc(t),r.ic().updateStatus()})),r.Wb(3,"mat-select-trigger"),r.Wb(4,"div",16),r.Wb(5,"div",17),r.Wb(6,"div",18),r.Ec(7,zt,1,1,"app-icon",19),r.Ec(8,St,1,0,"mat-spinner",20),r.Vb(),r.Vb(),r.Wb(9,"div",21),r.Gc(10),r.Vb(),r.Vb(),r.Vb(),r.Ec(11,Dt,5,4,"mat-option",22),r.Vb(),r.Vb()}if(2&t){const t=r.ic();r.Cb(1),r.oc("value",t.active_status)("disabled",t.loading),r.Cb(5),r.Dc("background-color",t.loading?"#eee":null==t.status_details?null:t.status_details.colour),r.Cb(1),r.oc("ngIf",!t.loading),r.Cb(1),r.oc("ngIf",t.loading),r.Cb(2),r.Hc(null==t.status_details?null:t.status_details.name),r.Cb(1),r.oc("ngForOf",t.statuses)}}const Tt=function(){return{type:"icon",class:"material-icons",content:"close"}};let At=(()=>{class t{constructor(t,e){this._service=t,this._data=e,this.event=new r.o,this.statuses=[{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]}get booking(){return this._data.booking}set booking(t){this._data.booking=t}get order(){return this._data.order}get status_details(){return this.statuses.find(t=>t.id===this.active_status)||{}}get space(){return this._service.Spaces.item(this._data.order.location_id)}get time(){return`(${ut(this._data.booking.date).add(this._data.order.delivery_time,"m").format("DD MMM YYYY")}) To be delivered at ${this._data.order.deliver_at_time}`}ngOnInit(){this.active_status=this._data.order.status}updateStatus(){return Object(pt.a)(this,void 0,void 0,(function*(){const t=this._data.booking;if(t){this.loading=!0;const e=[...t.catering];e.splice(e.findIndex(t=>t.id===this._data.order.id),1,new lt.a(Object.assign(Object.assign({},this._data.order),{status:this.active_status}))),t.storePendingChange("catering",e),yield t.save().catch(t=>{this._service.notifyError(`Error updating order status. Error: ${t.message||t}`),this.active_status=this._data.order.status,this.loading=!1}),this.loading=!1}}))}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(C.a),r.Qb(f.a))},t.\u0275cmp=r.Kb({type:t,selectors:[["a-order-details-modal"]],outputs:{event:"event"},decls:19,vars:10,consts:[[1,"details"],[1,"burger-icon"],[1,"location"],[1,"time"],[1,"status"],["class","rounded visible","appearance","outline",4,"ngIf"],[1,"content"],[1,"block"],[3,"booking"],[3,"booking","order"],[3,"booking","order","bookingChange"],["mat-icon-button","","mat-dialog-close","",1,"close"],[3,"icon"],["appearance","outline",1,"rounded","visible"],["placeholder","New Order",3,"value","disabled","valueChange"],["select",""],[1,"group"],[1,"icon"],[1,"wrapper"],[3,"icon",4,"ngIf"],["diameter","16",4,"ngIf"],[1,"text"],[3,"value",4,"ngFor","ngForOf"],["diameter","16"],[3,"value"],[1,"colour"]],template:function(t,e){1&t&&(r.Wb(0,"mat-dialog-content"),r.Wb(1,"main"),r.Wb(2,"div",0),r.Rb(3,"div",1),r.Wb(4,"div",2),r.Gc(5),r.Vb(),r.Wb(6,"div",3),r.Gc(7),r.Vb(),r.Wb(8,"div",4),r.Ec(9,Lt,12,8,"mat-form-field",5),r.Vb(),r.Vb(),r.Wb(10,"div",6),r.Wb(11,"div",7),r.Rb(12,"order-booking-details",8),r.Vb(),r.Wb(13,"div",7),r.Rb(14,"order-details-items",9),r.Vb(),r.Wb(15,"div",7),r.Wb(16,"order-details-notes",10),r.ec("bookingChange",(function(t){return e.booking=t})),r.Vb(),r.Vb(),r.Vb(),r.Wb(17,"button",11),r.Rb(18,"app-icon",12),r.Vb(),r.Vb(),r.Vb()),2&t&&(r.Cb(5),r.Hc(null==e.space?null:e.space.name),r.Cb(2),r.Hc(e.time),r.Cb(2),r.oc("ngIf",e.statuses&&e.statuses.length>1),r.Cb(3),r.oc("booking",e.booking),r.Cb(2),r.oc("booking",e.booking)("order",e.order),r.Cb(2),r.oc("booking",e.booking)("order",e.order),r.Cb(2),r.oc("icon",r.pc(9,Tt)))},directives:[f.f,i.t,Ct,Pt,Gt,m.b,f.d,g.a,b.b,j.a,j.c,i.s,M.c,E.g],styles:["main[_ngcontent-%COMP%]{position:relative;width:64em;max-width:95vw;overflow:hidden auto}.burger-icon[_ngcontent-%COMP%]{height:8em;width:8em;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNjYuOTA0IiBoZWlnaHQ9IjE2MC44MjEiPjxkZWZzPjxyYWRpYWxHcmFkaWVudCBpZD0iYSIgY3g9Ii41IiBjeT0iLjUiIHI9Ii41IiBncmFkaWVudFVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLW9wYWNpdHk9Ii4zMDIiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNmZmYiIHN0b3Atb3BhY2l0eT0iLjMwMiIvPjwvcmFkaWFsR3JhZGllbnQ+PGNsaXBQYXRoIGlkPSJiIj48cGF0aCBkPSJNNjcuODIzIDE0Ny4xMDZDMzAuMzY2IDE0Ny4xMDYgMCAxNDAuMzg0IDAgMTAyLjg2MSAwIDk0LjM4NSAyLjQxMSAwIDIuNDExIDBoMTMzLjIzNXYxMDIuODYxYzAgMzcuNTIzLTMwLjM2NSA0NC4yNDUtNjcuODIzIDQ0LjI0NXoiIGZpbGw9Im5vbmUiLz48L2NsaXBQYXRoPjwvZGVmcz48ZyBkYXRhLW5hbWU9Ikdyb3VwIDQ4ODQiPjxlbGxpcHNlIGN4PSI3Ny4wNjkiIGN5PSIxNy41MjkiIHJ4PSI3Ny4wNjkiIHJ5PSIxNy41MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEyLjc2NyAxMjUuNzY0KSIgZmlsbD0idXJsKCNhKSIvPjxnIGRhdGEtbmFtZT0iR3JvdXAgNDg4MiI+PGcgY2xpcC1wYXRoPSJ1cmwoI2IpIj48cGF0aCBkYXRhLW5hbWU9IkJhY2tncm91bmQwOCIgZD0iTTEyOC4xOTYgOTEuMzk5YzAgMzIuMjUxLTI2LjEgMzguMDI5LTU4LjI5MyAzOC4wMjlTMTEuNjEgMTIzLjY1MSAxMS42MSA5MS4zOTlzMjYuMS00My4yNDggNTguMjkzLTQzLjI0OCA1OC4yOTMgMTEgNTguMjkzIDQzLjI0OCIgZmlsbD0iIzA1MWMyYyIvPjwvZz48ZyBkYXRhLW5hbWU9Ikdyb3VwIDQ4ODMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIyLjcxMiA2NC44MzUpIj48cmVjdCB3aWR0aD0iMzYuMjkxIiBoZWlnaHQ9IjQ3Ljg0MiIgcng9IjExIiB0cmFuc2Zvcm09InJvdGF0ZSgtMTcgMzUuNDk3IDUuMzA1KSIgZmlsbD0iI2ZmZiIvPjxyZWN0IGRhdGEtbmFtZT0iUmVjdGFuZ2xlIiB3aWR0aD0iMjYuMzkzIiBoZWlnaHQ9IjMuOTg3IiByeD0iMS45OTMiIHRyYW5zZm9ybT0icm90YXRlKC0xNyA1NC4xNDIgLTE0LjQwNykiIGZpbGw9IiMxZjQwZTYiLz48cGF0aCBkYXRhLW5hbWU9IkNvbWJpbmVkIFNoYXBlIiBkPSJNMTYuNjM1IDQ1LjgyNWEuNjY0LjY2NCAwIDExLS4zODgtMS4yN2wyMy45NjktNy4zMjhhLjY2NC42NjQgMCAxMS4zODggMS4yN3ptLS43NzctMi41NDJhLjY2NS42NjUgMCAwMS0uMzg4LTEuMjcxbDIzLjk2OC03LjMyOGEuNjY1LjY2NSAwIDExLjM4OSAxLjI3em0tLjc3Ny0yLjU0MmEuNjY1LjY2NSAwIDAxLS4zODktMS4yN2wyMy45Ny03LjMyOWEuNjY1LjY2NSAwIDExLjM4OCAxLjI3MXptLS43NzctMi41NDJhLjY2NS42NjUgMCAwMS0uMzg5LTEuMjdsMjMuOTctNy4zMjlhLjY2NS42NjUgMCAxMS4zODggMS4yNzF6bS0uNzc4LTIuNTQzYS42NjQuNjY0IDAgMTEtLjM4OC0xLjI3bDIzLjk2OS03LjMyOGEuNjY0LjY2NCAwIDExLjM4OCAxLjI3em0tLjc3Ny0yLjU0MmEuNjY0LjY2NCAwIDAxLS4zODgtMS4yN2wyMy45NjktNy4zMjhhLjY2NC42NjQgMCAxMS4zODggMS4yN3ptLS43NzctMi41NDFhLjY2NS42NjUgMCAwMS0uMzg4LTEuMjcxbDIzLjk2OC03LjMyOGEuNjY1LjY2NSAwIDExLjM4OSAxLjI3em0tLjc3Ny0yLjU0MmEuNjY1LjY2NSAwIDAxLS4zODgtMS4yNzFsMjMuOTY4LTcuMzI4YS42NjUuNjY1IDAgMTEuMzg5IDEuMjd6bS0uNzc3LTIuNTQyYS42NjUuNjY1IDAgMDEtLjM4OC0xLjI3bDIzLjk2OS03LjMyN2EuNjY1LjY2NSAwIDExLjM4OCAxLjI3eiIgZmlsbD0iI2U2ZTZlNiIvPjwvZz48ZyBkYXRhLW5hbWU9Ikdyb3VwIDQ4ODIiPjxwYXRoIGRhdGEtbmFtZT0iUGF0aCAxOTc5NiIgZD0iTTQ3LjY2NyAxMTAuNjA2djE5LjI0Nmg2OC4yMzd2LTIwLjAzM0w5OS4xMTggODkuODU0bC0zNC42NzQtLjk4NS0xNC44IDE1LjcwNnoiIGZpbGw9IiNmZmYiLz48ZyBkYXRhLW5hbWU9IkZpbGxlZCBJY29ucyI+PHBhdGggZGF0YS1uYW1lPSJQYXRoIDE5NzM0IiBkPSJNMTEyLjg5MiAxMTMuNzk5SDUwLjc0NGE0LjY3MSA0LjY3MSAwIDAwLTQuNjY0IDQuNjYxdjMuMTA3YTQuNjYzIDQuNjYzIDAgMDA0LjY2NCA0LjY2Mmg2Mi4xNDhhNC42NjUgNC42NjUgMCAwMDQuNjYxLTQuNjYxdi0zLjEwOGE0LjY3MyA0LjY3MyAwIDAwLTQuNjYxLTQuNjYxeiIgZmlsbD0iIzFmNDBlNiIvPjxwYXRoIGRhdGEtbmFtZT0iUGF0aCAxOTczNSIgZD0iTTExNiAxMTAuNjkydi0zLjA4OWEyMS43OCAyMS43OCAwIDAwLTIxLjc1Mi0yMS43NTJINjkuMzg5YTIxLjc3OCAyMS43NzggMCAwMC0yMS43NTUgMjEuNzUydjMuMDg5ek05Ny4zNTUgOTUuMTczYTEuNTU0IDEuNTU0IDAgMTEtMS41NTQgMS41NTQgMS41NTggMS41NTggMCAwMTEuNTU0LTEuNTU0em0tNy43NjgtMy4xMDdhMS41NTQgMS41NTQgMCAxMS0xLjU1MyAxLjU1MyAxLjU1OCAxLjU1OCAwIDAxMS41NTMtMS41NTN6bS03Ljc2OCAzLjEwN2ExLjU1NCAxLjU1NCAwIDExLTEuNTU0IDEuNTU0IDEuNTU4IDEuNTU4IDAgMDExLjU1My0xLjU1NHptLTcuNzY4LTMuMTA3YTEuNTU0IDEuNTU0IDAgMTEtMS41NTQgMS41NTQgMS41NTggMS41NTggMCAwMTEuNTUzLTEuNTU0em0tNy43NjggMy4xMDdhMS41NTQgMS41NTQgMCAxMS0xLjU1NCAxLjU1NCAxLjU1OCAxLjU1OCAwIDAxMS41NTItMS41NTR6IiBmaWxsPSIjMDBhOWY0Ii8+PHBhdGggZGF0YS1uYW1lPSJQYXRoIDE5NzM2IiBkPSJNNDcuNjM0IDEyOS4zMzZ2MS41NzJhNy43NTkgNy43NTkgMCAwMDcuNzY4IDcuNzVoNTIuODMyYTcuNzYxIDcuNzYxIDAgMDA3Ljc2OC03Ljc1di0xLjU3MnoiIGZpbGw9IiMwMGE5ZjQiLz48L2c+PC9nPjwvZz48L2c+PC9zdmc+);background-repeat:no-repeat;background-size:contain;background-position:50% 50%}.details[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;padding:.5em}.details[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-bottom:.25em}.location[_ngcontent-%COMP%]{font-weight:500}mat-dialog-content[_ngcontent-%COMP%]{max-height:95vh}.mat-active[_ngcontent-%COMP%]{color:#1937ea}.group[_ngcontent-%COMP%]{display:flex;align-items:center}.group[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1}.group[_ngcontent-%COMP%]   .colour[_ngcontent-%COMP%]{position:relative;left:-8px;height:8px;width:8px;border-radius:100%;transition:height .2s,width .2s;transform:translateX(50%)}.group[_ngcontent-%COMP%]:hover   .colour[_ngcontent-%COMP%]{height:16px;width:16px}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:1em;width:1em;margin-right:.75em;background-color:none;color:#fff}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{height:1.5em;min-width:1.5em;border-radius:100%;margin-top:4px}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:.8em}.content[_ngcontent-%COMP%]{display:flex;align-items:center;overflow:auto hidden;padding:0 2em 2em}.block[_ngcontent-%COMP%]{height:24em;flex:1;min-width:18em;margin:0 .75em;border:1px solid #ccc}.block[_ngcontent-%COMP%]:first-child{margin-left:0}.block[_ngcontent-%COMP%]:last-child{margin-right:0}.close[_ngcontent-%COMP%]{position:absolute;top:.5em;right:.5em}"]}),t})();var Yt=n("xhdr"),Rt=n("bv9b"),Ft=n("CbDI");function Ut(t,e){1&t&&(r.Ub(0),r.Wb(1,"span"),r.Gc(2,"(K)"),r.Vb(),r.Gc(3," Kitchen"),r.Rb(4,"br"),r.Tb())}function Qt(t,e){1&t&&(r.Ub(0),r.Wb(1,"span"),r.Gc(2,"(P)"),r.Vb(),r.Gc(3," Pantry"),r.Tb())}function Bt(t,e){if(1&t&&r.Rb(0,"app-icon",3),2&t){const t=r.ic(2);r.oc("icon",null==t.status_details?null:t.status_details.icon)}}function Zt(t,e){1&t&&r.Rb(0,"mat-spinner",25)}function Ht(t,e){if(1&t&&(r.Wb(0,"mat-option",26),r.Wb(1,"div",19),r.Wb(2,"div",23),r.Gc(3),r.Vb(),r.Rb(4,"div",27),r.Vb(),r.Vb()),2&t){const t=e.$implicit;r.oc("value",t.id),r.Cb(3),r.Hc(t.name),r.Cb(1),r.Dc("background-color",t.colour)}}function $t(t,e){if(1&t){const t=r.Xb();r.Wb(0,"mat-form-field",16),r.Wb(1,"mat-select",17,18),r.ec("valueChange",(function(e){return r.wc(t),r.ic().active_status=e}))("valueChange",(function(){return r.wc(t),r.ic().updateStatus()})),r.Wb(3,"mat-select-trigger"),r.Wb(4,"div",19),r.Wb(5,"div",2),r.Wb(6,"div",20),r.Ec(7,Bt,1,1,"app-icon",21),r.Ec(8,Zt,1,0,"mat-spinner",22),r.Vb(),r.Vb(),r.Wb(9,"div",23),r.Gc(10),r.Vb(),r.Vb(),r.Vb(),r.Ec(11,Ht,5,4,"mat-option",24),r.Vb(),r.Vb()}if(2&t){const t=r.ic();r.Cb(1),r.oc("value",t.active_status)("disabled",t.loading),r.Cb(5),r.Dc("background-color",t.loading?"#eee":null==t.status_details?null:t.status_details.colour),r.Cb(1),r.oc("ngIf",!t.loading),r.Cb(1),r.oc("ngIf",t.loading),r.Cb(2),r.Hc(null==t.status_details?null:t.status_details.name),r.Cb(1),r.oc("ngForOf",t.statuses)}}const Jt=function(){return{class:"material-icons",content:"local_pizza"}};function qt(t,e){if(1&t&&(r.Wb(0,"div",28),r.Wb(1,"div",2),r.Rb(2,"app-icon",3),r.Vb(),r.Wb(3,"div",29),r.Wb(4,"div",30),r.Gc(5),r.Vb(),r.Wb(6,"div",31),r.Gc(7),r.Vb(),r.Vb(),r.Rb(8,"div",14),r.Vb()),2&t){const t=e.$implicit,n=r.ic();r.Gb("not-match",n.search&&!n.search_matches[t.id]),r.Cb(2),r.oc("icon",r.pc(5,Jt)),r.Cb(3),r.Hc(t.name),r.Cb(2),r.Ic("x ",t.amount,"")}}const Xt=function(){return{class:"material-icons",content:"room_service"}},Kt=function(){return{class:"material-icons",content:"visibility"}},te=function(t){return{class:"material-icons",content:t}};let ee=(()=>{class t{constructor(t,e){this._service=t,this._dialog=e,this.statuses=[{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]}get search_matches(){const t={};return this.order.items.forEach(e=>{const n=(this.search||"").toLowerCase();t[e.id]=e.name.toLowerCase().indexOf(n)>=0}),t}get status_details(){return this.statuses.find(t=>t.id===this.active_status)||{}}get space(){return this._service.Spaces.item(this.order.location_id)}ngOnChanges(t){t.order&&this.order&&(this.active_status=this.order.status)}updateStatus(){return Object(pt.a)(this,void 0,void 0,(function*(){const t=this.order.booking;if(t){this.loading=!0;const e=[...t.catering];e.splice(e.findIndex(t=>t.id===this.order.id),1,new lt.a(Object.assign(Object.assign({},this.order),{status:this.active_status}))),t.storePendingChange("catering",e),yield t.save().catch(t=>{this._service.notifyError(`Error updating order status. Error: ${t.message||t}`),this.active_status=this.order.status,this.loading=!1}),this.loading=!1}}))}viewOrderDetails(){this._dialog.open(At,{maxHeight:"95vh",maxWidth:"95vw",data:{order:this.order,booking:this.order.booking}})}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(C.a),r.Qb(f.b))},t.\u0275cmp=r.Kb({type:t,selectors:[["a-catering-orders-item"]],inputs:{order:"order",search:"search"},features:[r.Ab],decls:23,vars:21,consts:[[1,"order"],[1,"details"],[1,"icon"],[3,"icon"],[1,"time"],[1,"location"],[1,"host"],[1,"package-type"],[4,"ngIf"],[1,"status"],["class","rounded visible","appearance","outline",4,"ngIf"],["mat-icon-button","",3,"tapped"],[1,"more"],[1,"list"],[1,"bar"],["class","item",3,"not-match",4,"ngFor","ngForOf"],["appearance","outline",1,"rounded","visible"],["placeholder","New Order",3,"value","disabled","valueChange"],["select",""],[1,"group"],[1,"wrapper"],[3,"icon",4,"ngIf"],["diameter","16",4,"ngIf"],[1,"text"],[3,"value",4,"ngFor","ngForOf"],["diameter","16"],[3,"value"],[1,"colour"],[1,"item"],[1,"item-details"],[1,"name"],[1,"quanity"]],template:function(t,e){1&t&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.Wb(2,"div",2),r.Rb(3,"app-icon",3),r.Vb(),r.Wb(4,"div",4),r.Gc(5),r.Vb(),r.Wb(6,"div",5),r.Gc(7),r.Vb(),r.Wb(8,"div",6),r.Gc(9),r.Vb(),r.Wb(10,"div",7),r.Ec(11,Ut,5,0,"ng-container",8),r.Ec(12,Qt,4,0,"ng-container",8),r.Vb(),r.Wb(13,"div",9),r.Ec(14,$t,12,8,"mat-form-field",10),r.Vb(),r.Wb(15,"button",11),r.ec("tapped",(function(){return e.viewOrderDetails()})),r.Rb(16,"app-icon",3),r.Vb(),r.Wb(17,"div",12),r.Wb(18,"button",11),r.ec("tapped",(function(){return e.show_items=!e.show_items})),r.Rb(19,"app-icon",3),r.Vb(),r.Vb(),r.Vb(),r.Wb(20,"div",13),r.Rb(21,"div",14),r.Ec(22,qt,9,6,"div",15),r.Vb(),r.Vb()),2&t&&(r.Gb("showing",e.show_items||e.search),r.Cb(1),r.Gb("showing",e.show_items)("not-match",e.search),r.Cb(2),r.oc("icon",r.pc(17,Xt)),r.Cb(2),r.Hc(e.order.deliver_at_time),r.Cb(2),r.Hc(e.order.location||(null==e.space?null:e.space.name)),r.Cb(2),r.Hc(e.order.booking.organiser.name),r.Cb(2),r.oc("ngIf",e.order.kitchen),r.Cb(1),r.oc("ngIf",e.order.pantry),r.Cb(2),r.oc("ngIf",e.statuses&&e.statuses.length>1),r.Cb(2),r.oc("icon",r.pc(18,Kt)),r.Cb(3),r.oc("icon",r.qc(19,te,e.show_items?"keyboard_arrow_down":"keyboard_arrow_right")),r.Cb(1),r.oc("@show",e.show_items||e.search?"show":"hide"),r.Cb(2),r.oc("ngForOf",e.order.items))},directives:[g.a,i.t,m.b,u.c,i.s,b.b,j.a,j.c,M.c,E.g],styles:[".order[_ngcontent-%COMP%], [_nghost-%COMP%]{width:100%;border-bottom:1px solid rgba(0,0,0,.1);background-color:#fff;transition:background-color .2s}.order.showing[_ngcontent-%COMP%], .showing[_nghost-%COMP%]{background-color:#f0f0f0}.details[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5em .25em}.details.showing[_ngcontent-%COMP%]   .more[_ngcontent-%COMP%]{color:#1937ea}.details[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:.5em}.details[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:relative;background-color:#ccc;border:none;z-index:2}.details[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{width:6rem}.details[_ngcontent-%COMP%]   .host[_ngcontent-%COMP%]{width:10rem}.details[_ngcontent-%COMP%]   .package-type[_ngcontent-%COMP%]{width:6.5rem}.details[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{width:11rem}.not-match[_ngcontent-%COMP%]{opacity:.35}.status[_ngcontent-%COMP%]{height:3.5em;padding:0!important;margin-right:.5em}.status[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{border-radius:100%}.status[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:.5em}mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-active[_ngcontent-%COMP%]{color:#1937ea}.group[_ngcontent-%COMP%]{display:flex;align-items:center}.group[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1}.group[_ngcontent-%COMP%]   .colour[_ngcontent-%COMP%]{position:relative;left:-8px;height:8px;width:8px;border-radius:100%;transition:height .2s,width .2s;transform:translateX(50%)}.group[_ngcontent-%COMP%]:hover   .colour[_ngcontent-%COMP%]{height:16px;width:16px}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:1em;width:1em;margin-right:.75em;background-color:none;color:#fff}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{height:1.5em;min-width:1.5em;border-radius:100%;margin-top:4px}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:.8em}.list[_ngcontent-%COMP%]{position:relative;z-index:1}.list[_ngcontent-%COMP%] > .bar[_ngcontent-%COMP%]{position:absolute;background-color:#aaa;width:2px;top:-1em;bottom:1.3em;left:1.7em}.location[_ngcontent-%COMP%]{flex:1;min-width:1em;font-weight:400}.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;font-size:.9em;padding-left:3em;margin-bottom:.5em}.item[_ngcontent-%COMP%]:last-child   .item-details[_ngcontent-%COMP%]{border:none}.item[_ngcontent-%COMP%] > .bar[_ngcontent-%COMP%]{position:absolute;background-color:#aaa;height:2px;top:50%;transform:translateY(-50%);left:1.9em;width:.75em;padding:0}.package-type[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#1937ea}.item-details[_ngcontent-%COMP%]{display:flex;align-items:center;flex:1;min-width:50%;border-bottom:1px solid rgba(0,0,0,.1);height:3em;padding-right:4.25em}.item-details[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:.5em .5em .5em 0}.name[_ngcontent-%COMP%]{flex:1;min-width:1em}.icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:2em;width:2em;margin-right:.5em;border-radius:100%;border:2px dotted rgba(0,0,0,.6);color:rgba(0,0,0,.6);font-size:1.5em}"],data:{animation:[Ft.a]}}),t})();function ne(t,e){1&t&&(r.Wb(0,"div",11),r.Rb(1,"mat-progress-bar",12),r.Vb())}function ie(t,e){if(1&t&&r.Rb(0,"a-catering-orders-item",15),2&t){const t=e.$implicit,n=r.ic(2);r.oc("order",t)("search",n.search)}}function oe(t,e){if(1&t&&(r.Ub(0),r.Rb(1,"div",13),r.Ec(2,ie,1,2,"a-catering-orders-item",14),r.Tb()),2&t){const t=r.ic();r.Cb(2),r.oc("ngForOf",t.filtered_orders)("ngForTrackBy",t.trackByFn)}}const ae=function(){return{class:"material-icons",content:"close"}};function ce(t,e){if(1&t&&(r.Wb(0,"div",16),r.Wb(1,"div",2),r.Rb(2,"app-icon",17),r.Vb(),r.Wb(3,"div",18),r.Gc(4),r.Vb(),r.Vb()),2&t){const t=r.ic();r.Cb(2),r.oc("icon",r.pc(2,ae)),r.Cb(2),r.Ic("No catering orders for ",t.date_display,"")}}let re=(()=>{class t extends c.a{constructor(t,e,n){super(),this._service=t,this._route=e,this._dialog=n,this.orders=[],this.filtered_orders=[],this.available_spaces=[],this.search$=new ot.a}get date_display(){const t=ut(this.date);return ut().isSame(t,"d")?"Today":t.format("DD MMM YYYY")}get building(){return this._service.Organisation.building}ngOnInit(){this._service.Spaces.initialised.pipe(Object(ct.a)(t=>t)).subscribe(()=>{this.subscription("building",this._service.Organisation.listen("active_building").subscribe(()=>{this.search$.next(`${this.date}|${this.building.id}`),this.available_spaces=this._service.Spaces.list(t=>t.zones.indexOf(this.building.id)>=0).map(t=>t.id)})),this.available_spaces=this._service.Spaces.list(t=>t.zones.indexOf(this.building.id)>=0).map(t=>t.id),this.initBookings(),this.interval("update_bookings",()=>this.search$.next(`${this.date}|${this.building.id}|${ut().unix()}`),3e4),this.search$.next(`${this.date}|${this.building.id}|${ut().unix()}`),this.subscription("route.query",this._route.queryParamMap.subscribe(t=>{if(t.has("view")){t.get("view");const e=localStorage.getItem("CONCIERGE.view_order"),n=localStorage.getItem("CONCIERGE.view_booking");if(e){const t=new Yt.a(this._service.Bookings,JSON.parse(n)),i=new lt.a(JSON.parse(e));i.booking=t,this.viewOrderDetails(i),localStorage.removeItem("CONCIERGE.view_order"),localStorage.removeItem("CONCIERGE.view_booking")}}}))})}ngOnChanges(t){t.date&&this.building&&this.search$.next(`${this.date}|${this.building.id}`),t.search&&(this.filtered_orders=this.filter(this.orders,this.search))}trackByFn(t,e){return e?e.id:void 0}viewOrderDetails(t){this._dialog.open(At,{maxHeight:"95vh",maxWidth:"95vw",data:{order:t,booking:t.booking}})}filter(t,e=""){const n=e.toLowerCase();return t.filter(t=>t.items.find(t=>t.name.toLowerCase().indexOf(n)>=0||t.items&&t.items.find(t=>t.name.toLowerCase().indexOf(n)>=0||t.items&&t.items.find(t=>t.name.toLowerCase().indexOf(n)>=0))))}initBookings(){this.search_results$=this.search$.pipe(Object(rt.a)(100),Object(st.a)(),Object(dt.a)(t=>{this.loading=!0;const e=ut(this.date).startOf("d");return this._service.Spaces.query({zone_ids:this.building.id,available_from:e.unix(),available_to:e.endOf("d").unix()})}),Object(bt.a)(t=>Object(at.a)([])),Object(gt.a)(t=>{let e=[];return t.forEach(t=>{t.bookings.forEach(t=>{t.catering.forEach(e=>{e.booking_date=t.date,e.booking=t}),e=e.concat(t.catering)})}),e=Object(mt.m)(e,"id"),e=e.filter(t=>this.available_spaces.indexOf(t.location_id)>=0),e.sort((t,e)=>t.booking_date+60*t.delivery_time*1e3-(e.booking_date+60*e.delivery_time*1e3)),e})),this.subscription("search_results",this.search_results$.subscribe(t=>{this.loading=!1,this.orders=t,this.filtered_orders=this.filter(t,this.search)}))}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(C.a),r.Qb(o.a),r.Qb(f.b))},t.\u0275cmp=r.Kb({type:t,selectors:[["a-catering-orders"]],inputs:{search:"search",date:"date"},features:[r.zb,r.Ab],decls:17,vars:3,consts:[["class","loader",4,"ngIf"],[1,"heading"],[1,"icon"],[1,"time"],[1,"location"],[1,"host"],[1,"types"],[1,"state"],[1,"list"],[4,"ngIf","ngIfElse"],["empty_state",""],[1,"loader"],["mode","indeterminate"],[1,"top-row"],[3,"order","search",4,"ngFor","ngForOf","ngForTrackBy"],[3,"order","search"],[1,"info-block","center"],[3,"icon"],[1,"text"]],template:function(t,e){if(1&t&&(r.Ec(0,ne,2,0,"div",0),r.Wb(1,"div",1),r.Rb(2,"div",2),r.Wb(3,"div",3),r.Gc(4,"Time"),r.Vb(),r.Wb(5,"div",4),r.Gc(6,"Location"),r.Vb(),r.Wb(7,"div",5),r.Gc(8,"Host"),r.Vb(),r.Wb(9,"div",6),r.Gc(10,"Package Types"),r.Vb(),r.Wb(11,"div",7),r.Gc(12,"Status"),r.Vb(),r.Vb(),r.Wb(13,"div",8),r.Ec(14,oe,3,2,"ng-container",9),r.Vb(),r.Ec(15,ce,5,3,"ng-template",null,10,r.Fc)),2&t){const t=r.tc(16);r.oc("ngIf",e.loading),r.Cb(14),r.oc("ngIf",e.filtered_orders&&e.filtered_orders.length)("ngIfElse",t)}},directives:[i.t,Rt.a,i.s,ee,g.a],styles:["[_nghost-%COMP%]{flex-direction:column;height:100%;font-size:.9em}.heading[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;align-items:center;width:100%}.heading[_ngcontent-%COMP%]{position:relative;font-weight:400;font-size:.8rem;border-bottom:1px solid rgba(0,0,0,.1);z-index:1}.heading[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:.25em 0;text-transform:capitalize}.heading[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:5em}.heading[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{width:6rem}.heading[_ngcontent-%COMP%]   .host[_ngcontent-%COMP%]{width:10rem}.heading[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%]{flex:1}.heading[_ngcontent-%COMP%]   .types[_ngcontent-%COMP%]{width:6.25rem}.heading[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{width:17.5rem}.list[_ngcontent-%COMP%]{position:relative;flex:1;min-height:50%;width:100%;overflow:auto}.top-row[_ngcontent-%COMP%]{display:flex;position:-webkit-sticky;position:sticky;align-items:center;top:0;width:100%}.loader[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;height:4px;z-index:999}"]}),t})();const se=function(){return{class:"material-icons",content:"close"}};function de(t,e){if(1&t){const t=r.Xb();r.Wb(0,"button",13),r.ec("tapped",(function(){return r.wc(t),r.ic(2).search_str=""})),r.Rb(1,"app-icon",14),r.Vb()}2&t&&(r.Cb(1),r.oc("icon",r.pc(1,se)))}const be=function(){return{class:"material-icons",content:"search"}};function ge(t,e){if(1&t){const t=r.Xb();r.Wb(0,"div",8),r.Wb(1,"mat-form-field",9),r.Rb(2,"app-icon",10),r.Wb(3,"input",11),r.ec("ngModelChange",(function(e){return r.wc(t),r.ic().search_str=e})),r.Vb(),r.Ec(4,de,2,2,"button",12),r.Vb(),r.Vb()}if(2&t){const t=r.ic();r.Cb(1),r.Gb("rounded",!0),r.Cb(1),r.oc("icon",r.pc(5,be)),r.Cb(1),r.oc("ngModel",t.search_str),r.Cb(1),r.oc("ngIf",t.search_str)}}function le(t,e){if(1&t){const t=r.Xb();r.Wb(0,"button",15),r.ec("tapped",(function(){r.wc(t);const e=r.ic();return e.category=e.category+1})),r.Gc(1,"New Category"),r.Vb()}}function me(t,e){if(1&t){const t=r.Xb();r.Wb(0,"button",15),r.ec("tapped",(function(){r.wc(t);const e=r.ic();return e.package=e.package+1})),r.Gc(1,"Add sub-category"),r.Vb()}}function ue(t,e){if(1&t){const t=r.Xb();r.Ub(0),r.Wb(1,"a-catering-menu",16),r.ec("length",(function(e){return r.wc(t),r.ic().length=e})),r.Vb(),r.Tb()}if(2&t){const t=r.ic();r.Cb(1),r.oc("search",t.search_str)("category",t.category)("package",t.package)}}function pe(t,e){if(1&t&&(r.Ub(0),r.Rb(1,"a-catering-orders",17),r.Tb()),2&t){const t=r.ic();r.Cb(1),r.oc("date",t.date)("search",t.search_str)}}const fe=function(){return["/catering","menu"]},he=function(){return["/catering","orders"]};function Ce(t,e){1&t&&(r.Ub(0),r.Wb(1,"div",18),r.Wb(2,"a",19),r.Wb(3,"div",20),r.Wb(4,"div",21),r.jc(5,"safe"),r.Wb(6,"h2"),r.Gc(7,"Menus and Pricing"),r.Vb(),r.Vb(),r.Wb(8,"div",22),r.Gc(9,"View and edit menus and pricing"),r.Vb(),r.Vb(),r.Vb(),r.Wb(10,"a",19),r.Wb(11,"div",20),r.Wb(12,"div",21),r.jc(13,"safe"),r.Wb(14,"h2"),r.Gc(15,"Catering Orders"),r.Vb(),r.Vb(),r.Wb(16,"div",22),r.Gc(17," View catering orders and their statuses upon arrival "),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Tb()),2&t&&(r.Cb(2),r.oc("routerLink",r.pc(12,fe)),r.Cb(2),r.Dc("background",r.lc(5,6,"linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(assets/img/menus.jpg)","style"),r.Jb),r.Cb(6),r.oc("routerLink",r.pc(13,he)),r.Cb(2),r.Dc("background",r.lc(13,9,"linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(assets/img/orders.jpg)","style"),r.Jb))}let _e=(()=>{class t extends c.a{constructor(t){super(),this._route=t,this.category=0,this.package=0}ngOnInit(){this.category=0,this.subscription("route.params",this._route.paramMap.subscribe(t=>{t.has("page")&&(this.page=t.get("page"))}))}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(o.a))},t.\u0275cmp=r.Kb({type:t,selectors:[["app-catering"]],features:[r.zb],decls:12,vars:7,consts:[[1,"catering"],[1,"group"],[3,"date","dateChange"],["class","input-wrapper",4,"ngIf"],["mat-button","",3,"tapped",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"input-wrapper"],["appearance","outline"],["matPrefix","",3,"icon"],["matInput","","name","visitor-name","placeholder","Search...",3,"ngModel","ngModelChange"],["mat-icon-button","","matSuffix","",3,"tapped",4,"ngIf"],["mat-icon-button","","matSuffix","",3,"tapped"],[3,"icon"],["mat-button","",3,"tapped"],[3,"search","category","package","length"],[3,"date","search"],[1,"options"],["mat-button","",1,"card",3,"routerLink"],[1,"content"],[1,"img"],[1,"desc"]],template:function(t,e){1&t&&(r.Wb(0,"div",0),r.Rb(1,"a-sidebar"),r.Wb(2,"div",1),r.Wb(3,"a-topbar-header",2),r.ec("dateChange",(function(t){return e.date=t})),r.Ec(4,ge,5,6,"div",3),r.Ec(5,le,2,0,"button",4),r.Ec(6,me,2,0,"button",4),r.Vb(),r.Wb(7,"main"),r.Ub(8,5),r.Ec(9,ue,2,3,"ng-container",6),r.Ec(10,pe,2,2,"ng-container",6),r.Ec(11,Ce,18,14,"ng-container",7),r.Tb(),r.Vb(),r.Vb(),r.Vb()),2&t&&(r.Cb(3),r.oc("date",e.date),r.Cb(1),r.oc("ngIf",e.page),r.Cb(1),r.oc("ngIf","menu"===e.page),r.Cb(1),r.oc("ngIf","menu"===e.page&&e.length),r.Cb(2),r.oc("ngSwitch",e.page),r.Cb(1),r.oc("ngSwitchCase","menu"),r.Cb(1),r.oc("ngSwitchCase","orders"))},directives:[s.a,d.a,i.t,i.x,i.y,i.z,b.b,g.a,b.h,l.a,a.c,a.r,a.u,m.b,b.i,u.c,it,re,m.a,o.f],pipes:[v.b],styles:[".catering[_ngcontent-%COMP%], [_nghost-%COMP%], main[_ngcontent-%COMP%]{height:100%;width:100%}.catering[_ngcontent-%COMP%]{display:flex;height:100%;background-color:#ecf1f5}main[_ngcontent-%COMP%]{position:relative;height:calc(100% - 3.5em)}.group[_ngcontent-%COMP%]{flex:1;min-width:12em}.options[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100%;width:100%}h2[_ngcontent-%COMP%]{font-weight:400}.input-wrapper[_ngcontent-%COMP%]{height:3.5em;padding:0 .5em}.input-wrapper[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.25em}.card[_ngcontent-%COMP%]{padding:0;border:1px solid #ccc;border-radius:4px;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);margin:1em;font-weight:300;background-color:#fff;height:16em;width:24em;overflow:hidden}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{flex-direction:column}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.card[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]{background-position:50%!important;background-size:cover!important;color:#fff;width:100%;height:13em}.card[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:3em;color:rgba(0,0,0,.6)}button[_ngcontent-%COMP%]{margin-right:.5em}"]}),t})();var Me=n("PCNd"),ve=n("aXH1"),ye=n("g+Po");const Oe=function(){return{type:"icon",class:"material-icons",content:"close"}};function Ie(t,e){1&t&&(r.Wb(0,"button",5),r.Rb(1,"app-icon",6),r.Vb()),2&t&&(r.Cb(1),r.oc("icon",r.pc(1,Oe)))}function we(t,e){if(1&t&&(r.Wb(0,"mat-option",31),r.Gc(1),r.Vb()),2&t){const t=e.$implicit;r.oc("value",t.id),r.Cb(1),r.Ic(" ",t.name," ")}}function We(t,e){if(1&t&&(r.Wb(0,"main"),r.Wb(1,"form",7),r.Wb(2,"div",8),r.Wb(3,"label",9),r.Gc(4,"Parent Category"),r.Vb(),r.Wb(5,"div",10),r.Gc(6),r.Vb(),r.Vb(),r.Wb(7,"div",11),r.Wb(8,"label",9),r.Gc(9,"Name"),r.Wb(10,"span"),r.Gc(11,"*"),r.Vb(),r.Vb(),r.Wb(12,"mat-form-field",12),r.Rb(13,"input",13),r.Wb(14,"mat-error"),r.Gc(15,"A valid name is required"),r.Vb(),r.Vb(),r.Vb(),r.Wb(16,"div",11),r.Wb(17,"label",14),r.Gc(18,"Type"),r.Wb(19,"span"),r.Gc(20,"*"),r.Vb(),r.Vb(),r.Wb(21,"mat-form-field",12),r.Wb(22,"mat-select",15),r.Ec(23,we,2,2,"mat-option",16),r.Vb(),r.Wb(24,"mat-error"),r.Gc(25,"Type is required"),r.Vb(),r.Vb(),r.Vb(),r.Wb(26,"div",11),r.Wb(27,"label",17),r.Gc(28,"Description"),r.Vb(),r.Wb(29,"mat-form-field",12),r.Rb(30,"textarea",18),r.Vb(),r.Vb(),r.Wb(31,"div",11),r.Wb(32,"label",19),r.Gc(33,"Allegen Information"),r.Vb(),r.Wb(34,"mat-form-field",12),r.Rb(35,"textarea",20),r.Vb(),r.Vb(),r.Wb(36,"div",8),r.Wb(37,"mat-checkbox",21),r.Gc(38,"Out of Stock"),r.Vb(),r.Vb(),r.Wb(39,"div",8),r.Wb(40,"mat-checkbox",22),r.Gc(41,"Can order anytime"),r.Vb(),r.Vb(),r.Wb(42,"div",11),r.Wb(43,"label",23),r.Gc(44,"Supplier Price"),r.Vb(),r.Wb(45,"mat-form-field",12),r.Rb(46,"input",24),r.Vb(),r.Vb(),r.Wb(47,"div",11),r.Wb(48,"label",25),r.Gc(49,"Unit Price"),r.Vb(),r.Wb(50,"mat-form-field",12),r.Rb(51,"input",26),r.Vb(),r.Vb(),r.Wb(52,"div",11),r.Wb(53,"label",27),r.Gc(54,"Minimum Quanity"),r.Vb(),r.Wb(55,"mat-form-field",12),r.Rb(56,"input",28),r.Vb(),r.Vb(),r.Wb(57,"div",11),r.Wb(58,"label",29),r.Gc(59,"Maximum Quanity"),r.Vb(),r.Wb(60,"mat-form-field",12),r.Rb(61,"input",30),r.Vb(),r.Vb(),r.Vb(),r.Vb()),2&t){const t=r.ic();r.Cb(1),r.oc("formGroup",t.form),r.Cb(5),r.Hc(t.parent.name),r.Cb(2),r.Gb("error",t.form.controls.name.errors&&t.form.controls.name.touched),r.Cb(9),r.Gb("error",t.form.controls.catering_type.errors&&t.form.controls.catering_type.touched),r.Cb(6),r.oc("ngForOf",t.types)}}function Pe(t,e){if(1&t&&(r.Wb(0,"main"),r.Wb(1,"div",32),r.Wb(2,"div",33),r.Rb(3,"mat-spinner",34),r.Vb(),r.Wb(4,"div",35),r.Gc(5),r.Vb(),r.Vb(),r.Vb()),2&t){const t=r.ic();r.Cb(5),r.Hc(t.loading)}}let xe=(()=>{class t extends c.a{constructor(t,e,n){super(),this._service=t,this._dialog_ref=e,this._data=n,this.event=new r.o,this.types=[{id:"kitchen",name:"Kitchen"},{id:"pantry",name:"Pantry"}]}get item(){return this._data.item}get parent(){return this._data.parent}ngOnInit(){this.form=new a.i({name:new a.f(this.item.name,[a.F.required]),description:new a.f(this.item.description),catering_type:new a.f(this.item.catering_type,[a.F.required]),supplier_cost:new a.f(this.item.supplier_cost),unit_price:new a.f(this.item.unit_price),minimum_quantity:new a.f(this.item.minimum_quantity),maximum_quantity:new a.f(this.item.maximum_quantity),order_anytime:new a.f(this.item.order_anytime),out_of_stock:new a.f(this.item.out_of_stock),allergy:new a.f(this.item.allergy)})}submit(){if(this.form.markAllAsTouched(),console.log("Form:",this.form),this.form.valid){const t=new ve.a(Object.assign(Object.assign({},this.item.toJSON()),this.form.value)).toJSON();(this.item.id?this._service.CateringItems.update(this.item.id,t):this._service.CateringItems.add(t)).then(t=>{this.event.emit({reason:"done",metadata:t}),this._dialog_ref.close()},t=>this._service.notifyError(`Error ${this.item.id?"updating":"creating"} item. Error: ${t.message||t}`))}}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(C.a),r.Qb(f.h),r.Qb(f.a))},t.\u0275cmp=r.Kb({type:t,selectors:[["a-catering-item-modal"]],outputs:{event:"event"},features:[r.zb],decls:12,vars:5,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["mat-button","",3,"disabled","tapped"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[3,"formGroup"],[1,"field","padded"],["for","name"],[1,"value"],[1,"field"],["appearance","outline"],["matInput","","name","name","placeholder","Category Name","formControlName","name"],["for","type"],["name","type","formControlName","catering_type","placeholder","Select type"],[3,"value",4,"ngFor","ngForOf"],["for","description"],["matInput","","name","description","placeholder","Category Description","formControlName","description"],["for","allergy"],["matInput","","name","allergy","placeholder","Allergy details about the item","formControlName","allergy"],["formControlName","out_of_stock"],["formControlName","order_anytime"],["for","supplier-price"],["matInput","","name","supplier-price","type","number","placeholder","Price for one unit of the item from the supplier","formControlName","supplier_cost"],["for","unit-price"],["matInput","","name","unit-price","type","number","placeholder","Price for one unit of the item without decimal places","formControlName","unit_price"],["for","min-quanity"],["matInput","","name","min-quanity","type","number","placeholder","Minimum Quantity","formControlName","minimum_quantity"],["for","max-quanity"],["matInput","","name","max-quanity","type","number","placeholder","Maximum Quantity","formControlName","maximum_quantity"],[3,"value"],[1,"info-block"],[1,"icon"],["diameter","32"],[1,"text"]],template:function(t,e){if(1&t&&(r.Wb(0,"header"),r.Wb(1,"div",0),r.Gc(2),r.Vb(),r.Ec(3,Ie,2,2,"button",1),r.Vb(),r.Wb(4,"mat-dialog-content"),r.Ec(5,We,62,7,"main",2),r.Vb(),r.Wb(6,"mat-dialog-actions"),r.Wb(7,"footer"),r.Wb(8,"button",3),r.ec("tapped",(function(){return e.submit()})),r.Gc(9,"Save"),r.Vb(),r.Vb(),r.Vb(),r.Ec(10,Pe,6,1,"ng-template",null,4,r.Fc)),2&t){const t=r.tc(11);r.Cb(2),r.Ic("",e.item.id?"Edit":"Add"," catering item"),r.Cb(1),r.oc("ngIf",!e.loading),r.Cb(2),r.oc("ngIf",!e.loading)("ngIfElse",t),r.Cb(3),r.oc("disabled",e.uploading)}},directives:[i.t,f.f,f.c,m.b,u.c,f.d,g.a,a.H,a.s,a.j,b.b,l.a,a.c,a.r,a.h,b.a,j.a,i.s,k.a,a.x,E.g,M.c],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.field[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.heading[_ngcontent-%COMP%]{flex:1;min-width:50%}main[_ngcontent-%COMP%]{padding:1em;width:24em}label[_ngcontent-%COMP%]{min-width:100%;margin-right:1em;font-weight:700;font-size:.8em;width:100%;margin-top:0;margin-bottom:.5em}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ffb300}label.error[_ngcontent-%COMP%]{color:#e53935}.padded[_ngcontent-%COMP%]{padding:0 0 1em}footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:8em}"]}),t})();var Ve=n("STbY");function Ne(t,e){if(1&t&&r.Rb(0,"div",21),2&t){const t=r.ic(2);r.Dc("background-image","url("+t.item.image_path+")",r.Jb)}}function ke(t,e){if(1&t&&(r.Wb(0,"div",22),r.Gc(1),r.jc(2,"currency"),r.Vb()),2&t){const t=r.ic(2);r.Cb(1),r.Ic(" ",r.lc(2,1,t.item.unit_price/100,t.symbol)," ")}}function je(t,e){if(1&t&&(r.Wb(0,"div",23),r.Gc(1),r.Vb()),2&t){const t=r.ic(2);r.Cb(1),r.Jc(" Contains ",t.item.items.length," item",1===t.item.items.length?"":"s"," ")}}function Ee(t,e){if(1&t&&(r.Wb(0,"div",23),r.Wb(1,"span",24),r.Gc(2,"Selected "),r.Vb(),r.Gc(3),r.Wb(4,"span",24),r.Gc(5,"ion"),r.Vb(),r.Gc(6),r.Vb()),2&t){const t=r.ic(2);r.Cb(3),r.Ic("",t.item.must_select," opt"),r.Cb(3),r.Ic("",1===t.item.items.length?"":"s"," ")}}function Ge(t,e){if(1&t&&(r.Wb(0,"div",25),r.Gc(1),r.jc(2,"currency"),r.Vb()),2&t){const t=r.ic(2);r.Cb(1),r.Ic(" ",r.lc(2,1,t.item.unit_price/100,t.symbol)," ")}}const ze=function(){return{class:"material-icons",content:"more_vert"}},Se=function(t){return{class:"material-icons",content:t}};function De(t,e){if(1&t){const t=r.Xb();r.Wb(0,"div",10),r.Ec(1,Ne,1,2,"div",11),r.Wb(2,"div",12),r.Wb(3,"div",13),r.Gc(4),r.Vb(),r.Wb(5,"div",14),r.Gc(6),r.Vb(),r.Wb(7,"div",15),r.Ec(8,ke,3,4,"div",16),r.Ec(9,je,2,2,"div",17),r.Ec(10,Ee,7,2,"div",17),r.Vb(),r.Vb(),r.Ec(11,Ge,3,4,"div",18),r.Wb(12,"button",19),r.Rb(13,"app-icon",7),r.Vb(),r.Wb(14,"button",20),r.ec("tapped",(function(){r.wc(t);const e=r.ic();return e.show_children=!e.show_children})),r.Rb(15,"app-icon",7),r.Vb(),r.Vb()}if(2&t){const t=r.ic(),e=r.tc(4);r.Gb("subitem",t.subitem),r.Cb(1),r.oc("ngIf",!t.subitem),r.Cb(3),r.Hc(t.item.name),r.Cb(2),r.Jc("",t.item.package?"[Package] ":"","",t.item.description,""),r.Cb(2),r.oc("ngIf",t.item.unit_price),r.Cb(1),r.oc("ngIf",t.item.package&&t.item.items.length&&!t.item.must_select),r.Cb(1),r.oc("ngIf",t.item.package&&t.item.must_select&&t.item.amount>0),r.Cb(1),r.oc("ngIf",t.item.unit_price),r.Cb(1),r.oc("matMenuTriggerFor",e),r.Cb(1),r.oc("icon",r.pc(15,ze)),r.Cb(1),r.Gb("hide",!(t.item.items&&t.item.items.length)),r.Cb(1),r.oc("icon",r.qc(16,Se,t.show_children?"keyboard_arrow_up":"keyboard_arrow_down"))}}function Le(t,e){if(1&t&&r.Rb(0,"a-catering-menu-item",26),2&t){const t=e.$implicit,n=r.ic();r.oc("subitem",!0)("symbol",n.symbol)("parent",n.item)("item",t)}}const Te=function(){return{class:"material-icons",content:"add"}};function Ae(t,e){if(1&t){const t=r.Xb();r.Ub(0),r.Wb(1,"button",27),r.Wb(2,"div",28),r.ec("tapped",(function(){return r.wc(t),r.ic().openGroupModal()})),r.Rb(3,"app-icon",7),r.Wb(4,"div",8),r.Gc(5,"Add Group"),r.Vb(),r.Vb(),r.Vb(),r.Wb(6,"button",5),r.ec("tapped",(function(){return r.wc(t),r.ic().openItemModal()})),r.Wb(7,"div",6),r.Rb(8,"app-icon",7),r.Wb(9,"div",8),r.Gc(10,"Add Item"),r.Vb(),r.Vb(),r.Vb(),r.Tb()}2&t&&(r.Cb(3),r.oc("icon",r.pc(2,Te)),r.Cb(5),r.oc("icon",r.pc(3,Te)))}const Ye=function(){return{class:"material-icons",content:"edit"}},Re=function(){return{class:"material-icons",content:"delete"}};let Fe=(()=>{class t{constructor(t,e){this._dialog=t,this._service=e}get has_items(){return!(!this.item.items||!this.item.items.length)}get building(){return this._service.Organisation.building}openGroupModal(t){t||(t=new p.a({parent_id:this.item.id,zones:[this.building.id]})),this._dialog.open(F,{data:{group:t,parent:t.id?this.parent:this.item}})}openItemModal(t){t||(t=new ve.a({parent_id:this.item.id})),this._dialog.open(xe,{data:{item:t,parent:t.id?this.parent:this.item}})}deleteItem(){const t=this.item instanceof _e?this.item.package?"Package":"Sub-category":"Item",e=this._dialog.open(ye.b,{data:{title:`Delete catering ${t}`,content:`Are you sure you want to delete the catering ${t} "${this.item.name}"?<br />${this.item instanceof p.a?"Any children items or groups will be <strong>immediately</strong> deleted":""}`,icon:{type:"icon",class:"material-icons",content:"delete"},action:"Ok"}});e.componentInstance.event.subscribe(n=>{"done"===n.reason&&(e.componentInstance.loading=`Deleting ${t}...`)})}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(f.b),r.Qb(C.a))},t.\u0275cmp=r.Kb({type:t,selectors:[["a-catering-menu-item"]],inputs:{subitem:"subitem",item:"item",parent:"parent",symbol:"symbol",disabled:"disabled"},decls:16,vars:10,consts:[["class","catering-item",3,"subitem",4,"ngIf"],[1,"children"],[3,"subitem","symbol","parent","item",4,"ngFor","ngForOf"],["appMenu","matMenu"],[4,"ngIf"],["mat-menu-item","",3,"tapped"],[1,"group"],[3,"icon"],[1,"text"],["mat-menu-item","",1,"delete",3,"tapped"],[1,"catering-item"],["class","image",3,"background-image",4,"ngIf"],[1,"details"],[1,"name"],[1,"description"],[1,"options"],["class","option price mobile-only",4,"ngIf"],["class","option",4,"ngIf"],["class","option price not-mobile",4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-icon-button","",3,"tapped"],[1,"image"],[1,"option","price","mobile-only"],[1,"option"],[1,"not-mobile"],[1,"option","price","not-mobile"],[3,"subitem","symbol","parent","item"],["mat-menu-item",""],[1,"group",3,"tapped"]],template:function(t,e){1&t&&(r.Ec(0,De,16,18,"div",0),r.Wb(1,"div",1),r.Ec(2,Le,1,4,"a-catering-menu-item",2),r.Vb(),r.Wb(3,"mat-menu",null,3),r.Ec(5,Ae,11,4,"ng-container",4),r.Wb(6,"button",5),r.ec("tapped",(function(){return e.item.items?e.openGroupModal(e.item):e.openItemModal(e.item)})),r.Wb(7,"div",6),r.Rb(8,"app-icon",7),r.Wb(9,"div",8),r.Gc(10),r.Vb(),r.Vb(),r.Vb(),r.Wb(11,"button",9),r.ec("tapped",(function(){return e.deleteItem()})),r.Wb(12,"div",6),r.Rb(13,"app-icon",7),r.Wb(14,"div",8),r.Gc(15),r.Vb(),r.Vb(),r.Vb(),r.Vb()),2&t&&(r.oc("ngIf",e.item),r.Cb(1),r.oc("@show",e.show_children?"show":"hide"),r.Cb(1),r.oc("ngForOf",e.item.items),r.Cb(3),r.oc("ngIf",e.item.items),r.Cb(3),r.oc("icon",r.pc(8,Ye)),r.Cb(2),r.Ic("Edit ",e.item.items?e.item.package?"Package":"Sub-category":"item",""),r.Cb(3),r.oc("icon",r.pc(9,Re)),r.Cb(2),r.Ic("Delete ",e.item.items?e.item.package?"Package":"Sub-category":"item",""))},directives:[i.t,i.s,Ve.e,Ve.b,u.c,g.a,m.b,Ve.d,t],pipes:[i.d],styles:[".catering-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem}.subitem[_ngcontent-%COMP%]{border-top:1px solid #ccc}.name[_ngcontent-%COMP%]{max-width:480px}.image[_ngcontent-%COMP%]{height:3em;width:3em;min-width:3em;border-radius:4px;background-color:rgba(0,0,0,.05);background-position:50%;background-size:cover;border:1px solid rgba(0,0,0,.05)}.details[_ngcontent-%COMP%]{flex:1;min-width:25%;padding:0 .5em;display:flex;flex-direction:column}.details[_ngcontent-%COMP%]   *[_ngcontent-%COMP%] > {white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.options[_ngcontent-%COMP%]{display:flex;align-items:center}.options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;font-size:.8em;height:1.5em;color:rgba(0,0,0,.85);line-height:1em;padding:0 .25em;text-decoration:underline}.option[_ngcontent-%COMP%]{padding:.25em .5em;border-radius:4px;color:#fff;font-size:.8rem;background-color:#1937ea;margin:.25em .4rem .25em 0;white-space:nowrap}.description[_ngcontent-%COMP%]{font-size:.75em;margin-top:.25em}.children[_ngcontent-%COMP%]{font-size:.9em;background-color:rgba(0,0,0,.05)}.group[_ngcontent-%COMP%]{display:flex;align-items:center}.hide[_ngcontent-%COMP%]{opacity:0;pointer-events:none}.delete[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{color:#e53935}"],data:{animation:[Ft.a]}}),t})();var Ue=n("Nuht"),Qe=n("DWOX"),Be=n("YoI9"),Ze=n("4Uey"),He=n("q/nq"),$e=n("4kJo"),Je=n("A+eD"),qe=n("4Man"),Xe=n("vJ8U"),Ke=n("1k4r"),tn=n("9Kh7"),en=n("5fZw"),nn=n("WE8N"),on=n("1DiH"),an=n("CTJb"),cn=n("opQU"),rn=n("zx1i"),sn=n("019G"),dn=n("cH1L"),bn=n("dNgK"),gn=n("ihCf"),ln=n("/1cH"),mn=n("A5z7"),un=n("Qu3c"),pn=n("QibW"),fn=n("1jcm"),hn=n("vxfF"),Cn=n("5+WD"),_n=n("f6nW");n.d(e,"CateringModule",(function(){return vn}));const Mn=[{path:"",component:_e},{path:":page",component:_e},{path:"**",redirectTo:""}];let vn=(()=>{class t{}return t.\u0275mod=r.Ob({type:t}),t.\u0275inj=r.Nb({factory:function(e){return new(e||t)},imports:[[i.c,a.l,a.B,o.g.forChild(Mn),Me.a]]}),t})();r.zc(H,[i.q,i.r,i.s,i.t,i.A,i.w,i.x,i.y,i.z,i.u,i.v,a.H,a.w,a.G,a.c,a.x,a.A,a.a,a.D,a.E,a.z,a.r,a.s,a.C,a.n,a.m,a.y,a.b,a.d,a.u,a.v,a.t,a.g,a.j,a.h,a.k,a.e,o.h,o.d,o.f,o.e,o.i,u.b,u.c,Ue.a,c.a,Qe.a,g.a,Be.a,d.a,Ze.a,He.a,$e.a,Je.a,qe.a,Xe.a,Ke.a,s.a,tn.a,en.a,nn.a,on.a,an.a,cn.a,rn.a,sn.a,m.b,m.a,dn.b,bn.b,f.e,f.d,f.i,f.f,f.c,b.a,b.b,b.e,b.f,b.g,b.h,b.i,gn.b,gn.c,l.a,l.c,M.a,M.c,Rt.a,ln.a,E.g,E.f,ln.d,ln.c,j.a,j.c,mn.d,mn.a,mn.c,mn.e,mn.b,mn.f,E.j,Ve.e,Ve.b,Ve.d,Ve.a,k.a,k.c,un.a,un.c,pn.b,pn.a,N.c,N.d,N.a,N.f,N.e,N.b,fn.c,fn.a,hn.a,hn.b,hn.c,hn.d,Cn.e,Cn.f,Cn.a,Cn.b,Cn.d,Cn.c,_n.o,_n.n,_n.b,_n.c,_n.j,_n.f,_n.d,_n.a,_n.m,_n.i,_n.e,_n.k,_n.l,_n.g,_n.h,_n.r,_n.t,_n.s,_n.q,_e,re,it,H,Fe,V,F,xe,ee,At,Pt,Ct,Gt],[i.b,i.G,i.p,i.k,i.E,i.g,i.C,i.F,i.d,i.f,i.i,i.j,i.l,v.b,v.c])}}]);