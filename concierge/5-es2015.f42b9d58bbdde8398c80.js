(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{O7Vg:function(n,l,e){"use strict";e.r(l);var t=e("8Y7J"),i=e("yw+2"),o=e("OaWH"),u=e("Wgwc");const s=15;class r extends i.a{constructor(n,l,e){super(),this._service=n,this._route=l,this._renderer=e,this.time_blocks=this.generateTimeBlocks(),this.scroll_top=0,this.scroll_left=0,this.scroll_offset=0,this.spaces=[],this.filtered_spaces=[],this.in_view={},this.loading={},this.last_update=0}onResize(){this.scroll_area.nativeElement&&(this.box=this.scroll_area.nativeElement.getBoundingClientRect())}get holding_bay(){const n=this._service.Buildings.current();return n.holding_bay?this._service.Rooms.item(n.holding_bay):null}ngOnInit(){if(!this._service.ready()||!this._service.Rooms.list(!0).length)return this.timeout("init",()=>this.ngOnInit());this.subscription("active_level",this._service.listen("APP.level",n=>{const l=-1===n?this._service.Buildings.current().id:n;this.spaces=this._service.Rooms.list(!0,[l])||[];const e=this.holding_bay;this.filtered_spaces=this.spaces.filter(n=>(!this.room_type||n.zones.indexOf(this.room_type)>=0)&&(!e||n.id!==e.id)&&n.bookable),this.updateBookings(),this.interval("bookings",()=>this.updateBookings(),1e3*s)})),this.subscription("date",this._service.listen("APP.date",n=>{this.date=n,this.is_today=u().isSame(u(n),"d"),this.updateBookings(),this.interval("bookings",()=>this.updateBookings(),1e3*s)})),this.subscription("room_type",this._service.listen("APP.room_type",n=>{this.room_type="string"==typeof n?n:null;const l=this.holding_bay;this.filtered_spaces=this.spaces.filter(n=>(!this.room_type||n.zones.indexOf(this.room_type)>=0)&&(!l||n.id!==l.id)&&n.bookable)})),this.subscription("viewing",this._service.listen("CONCIERGE.day_view.viewing",n=>this.scrollIntoView(n))),this.subscription("route.query",this._route.queryParamMap.subscribe(n=>{n.has("id")&&(this.view_id=n.get("id"))})),this.updateTime(),this.interval("time",()=>this.updateTime(),15e3),this.updateBookings(),this.interval("bookings",()=>this.updateBookings(),1e3*s),this.interval("scroll",()=>{this.scroll_area&&this.scroll_area.nativeElement&&this.updateScroll({target:this.scroll_area.nativeElement})},1e3),this.scroll_area.nativeElement&&(this.box=this.scroll_area.nativeElement.getBoundingClientRect())}get space_zones(){return this.spaces.map(n=>`space-col-${n.id}`)}updateScroll(n){this.scroll_top=n.target.scrollTop,this.scroll_left=n.target.scrollLeft}generateTimeBlocks(){const n=[],l=u().startOf("h");for(let e=0;e<24;e++)n.push({id:l.hour(e).format("HH:mm"),display:l.hour(e).format("h:mm A")});return n}updateTime(){const n=u();this.now=(n.hour()+n.minute()/60)/24,this.active_hour=n.startOf("h").format("HH:mm")}updateBookings(){const n=this.spaces.filter(n=>!1!==this.in_view[n.id]);if(n.length){n.forEach(n=>this.loading[n.id]=!0);const l=u(this.date).startOf("d"),e=l.endOf("d"),t=this._service.get("APP.level"),i=[-1===t?this._service.Buildings.current().id:t];this.room_type&&i.push(this.room_type),this._service.Rooms.query({zone_ids:i,available_from:l.unix(),available_to:e.unix()}).then(n=>{this._service.Rooms.clearTimeline(l.valueOf(),e.valueOf()),n.forEach(n=>{if(this.view_id){const l=n.bookings.find(n=>n.id===this.view_id);l&&this.view(l,n)}this._service.Rooms.updateTimeline(n.id,n.bookings)}),delete this.loading,this.last_update=u().valueOf(),this.loading={}})}}view(n,l){this._service.Bookings.view(n,l).then(n=>null,n=>null),this.view_id=null}scrollIntoView(n){if(n&&this.scroll_area&&this.scroll_area.nativeElement){const l=this.scroll_area.nativeElement.getBoundingClientRect(),e=this.scroll_area.nativeElement.scrollHeight+l.height,t=this.scroll_area.nativeElement.scrollWidth+l.width,i=u(n.date),o=i.hour()+i.minute()/60,s=this.spaces.findIndex(l=>l.id===n.room.id);s>=0&&this.scroll_area.nativeElement.scrollTo({top:e*(o/24)-l.height/2,left:t*(s/this.spaces.length),behavior:"smooth"})}}scrollView(n,l){(n||l)&&(this.scroll_area.nativeElement.scrollTop+=l||0,this.scroll_area.nativeElement.scrollLeft+=n||0,(l&&this.scroll_area.nativeElement.scrollTop>=this.scroll_area.nativeElement.scrollHeight||n&&this.scroll_area.nativeElement.scrollLeft>=this.scroll_area.nativeElement.scrollWidth||l&&this.scroll_area.nativeElement.scrollTop<=0||n&&this.scroll_area.nativeElement.scrollLeft<=0)&&this.clearInterval("auto_scroll"),this.updateScroll({target:this.scroll_area.nativeElement}))}clearSelected(){this._service.set("CONCIERGE.day_view.viewing",null)}cancelScroll(){this.clearInterval("auto_scroll")}dragChange(n){n?(this.scroll_offset=this.scroll_area.nativeElement.scrollTop,this.subscription("listen_move",this._renderer.listen("window","mousemove",n=>{const l=n.clientX,e=n.clientY,t=e>this.box.bottom-.05*this.box.height?1:e<this.box.top+.05*this.box.height?-1:0,i=l>this.box.right-.05*this.box.width?1:l<this.box.left+.05*this.box.height?-1:0;this.scrollView(5*i,5*t),this.interval("auto_scroll",()=>this.scrollView(10*i,10*t),10)})),this.clearInterval("bookings")):(this.interval("bookings",()=>this.updateBookings(),1e3*s),this.clearInterval("auto_scroll"),this.unsub("listen_move"))}}class a{}var c=e("pMnS"),d=e("tN88"),b=e("8fYl"),g=e("2t5/"),h=e("aiwB"),v=e("bPUX"),p=e("MIzx"),m=e("jtT9"),f=e("QoQi"),_=e("2cjq"),y=e("PnLf"),O=e("PfHN"),x=e("fBUd"),M=e("04GH"),C=e("/T1M"),P=e("Mc5n"),w=e("kTUd"),k=e("SVse");class I extends i.a{constructor(n){super(),this._service=n,this.position=new t.n}ngOnInit(){}get type(){return this.event?"cancelled"===this.event.state?"cancelled":this.event.booking_type:""}get period(){return this.event&&this.event.display?`${this.event.display.start} \u2013 ${this.event.display.end}`:""}get expected(){return this.space&&(this.event.expected_attendees||{})[this.space.id]||0}get has_catering(){return!!(this.event&&this.event.catering&&this.event.catering.items&&this.event.catering.items.length)}view(){this._service.Bookings.view(this.event,this.space).then(n=>{},n=>null)}get active(){const n=this._service.get("CONCIERGE.day_view.viewing");return!n||n.id===this.event.id}ngOnChanges(n){(n.event||n.overlap)&&this.calculatePosition()}viewOrder(){this.event&&this.event.catering&&(sessionStorage&&sessionStorage.setItem("CONCIERGE.view_order",JSON.stringify(Object.assign({},this.event,{room:Object.assign({},this.event.room,{bookings:[]})}))),this._service.navigate(["/catering","orders"],{id:this.event.id}))}calculatePosition(){if(this.event){const n=this.overlap||{index:0,total:1},l=u(this.event.date).startOf("m"),e=l.hour()+l.minute()/60;this.event.all_day?(this.top=0,this.height=100,this.position.emit({top:0,height:100})):(this.top=e/24*100,this.height=this.fixed?this.event.duration/60:this.event.duration/60/24*100,this.position.emit({top:this.top,height:this.event.duration/60/24*100})),this.width=Math.min(100,100/n.total+5),this.left=Math.min(100-this.width,this.width*n.index-5*n.index),this.overflow_top=100*(this.event.setup?this.event.setup/this.event.duration:-.1),this.overflow_bottom=100*(this.event.breakdown?this.event.breakdown/this.event.duration:-.1)}}}var S=t.wb({encapsulation:0,styles:[[".event-container[_ngcontent-%COMP%]{position:absolute;pointer-events:auto;transition:-webkit-filter .2s;transition:filter .2s;transition:filter .2s,-webkit-filter .2s}.event-container[_ngcontent-%COMP%]:hover{-webkit-filter:none;filter:none}.event-container[_ngcontent-%COMP%]:hover   .catering-icon[_ngcontent-%COMP%]{z-index:999}.event-container[_ngcontent-%COMP%]:hover   .event[_ngcontent-%COMP%]{z-index:999!important;bottom:auto;min-height:100%;left:5px;right:5px}.event-container[_ngcontent-%COMP%]:hover   .event.low[_ngcontent-%COMP%]{bottom:0;top:auto}.event-container.fixed[_ngcontent-%COMP%]:hover   .event[_ngcontent-%COMP%]{z-index:999!important;top:0;left:1px;right:1px;bottom:0}.overflow[_ngcontent-%COMP%]{position:absolute;top:2px;left:2px;right:2px;bottom:2px;border-radius:4px;background-color:rgba(31,64,230,.2)}.overflow.internal[_ngcontent-%COMP%]{background-color:rgba(230,159,199,.2)}.overflow.external[_ngcontent-%COMP%]{background-color:rgba(140,90,200,.2)}.overflow.training[_ngcontent-%COMP%]{background-color:rgba(240,231,0,.2)}.overflow.interview[_ngcontent-%COMP%]{background-color:rgba(52,141,2,.2)}.overflow.setup[_ngcontent-%COMP%]{background-color:rgba(211,47,47,.2)}.overflow.cancelled[_ngcontent-%COMP%]{background-color:rgba(97,114,136,.2)}.event[_ngcontent-%COMP%]{position:absolute;overflow:hidden;top:0;left:1px;right:1px;bottom:0;border-radius:4px;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);transition:bottom .2s,top .2s,left .2s,right .2s;border:1px solid #1f40e6}.event[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{background-color:#1f40e6}.event[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{background-color:rgba(31,64,230,.2)}.event.pending[_ngcontent-%COMP%]{border-color:rgba(31,64,230,.4)}.event.pending[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:rgba(31,64,230,.2)}.event.internal[_ngcontent-%COMP%]{border-color:#e69fc7}.event.internal[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{background-color:#e69fc7}.event.internal[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{background-color:rgba(230,159,199,.2)}.event.internal.pending[_ngcontent-%COMP%]{border-color:rgba(230,159,199,.4)}.event.internal.pending[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:rgba(230,159,199,.2)}.event.external[_ngcontent-%COMP%]{border-color:#8c5ac8}.event.external[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{background-color:#8c5ac8}.event.external[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{background-color:rgba(140,90,200,.2)}.event.external.pending[_ngcontent-%COMP%]{border-color:rgba(140,90,200,.4)}.event.external.pending[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:rgba(140,90,200,.2)}.event.training[_ngcontent-%COMP%]{border-color:#f0e700}.event.training[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{background-color:#f0e700}.event.training[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{background-color:rgba(240,231,0,.2)}.event.training.pending[_ngcontent-%COMP%]{border-color:rgba(240,231,0,.4)}.event.training.pending[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:rgba(240,231,0,.2)}.event.interview[_ngcontent-%COMP%]{border-color:#348d02}.event.interview[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{background-color:#348d02}.event.interview[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{background-color:rgba(52,141,2,.2)}.event.interview.pending[_ngcontent-%COMP%]{border-color:rgba(52,141,2,.4)}.event.interview.pending[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:rgba(52,141,2,.2)}.event.setup[_ngcontent-%COMP%]{border-color:#d32f2f}.event.setup[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{background-color:#d32f2f}.event.setup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{background-color:rgba(211,47,47,.2)}.event.setup.pending[_ngcontent-%COMP%]{border-color:rgba(211,47,47,.4)}.event.setup.pending[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:rgba(211,47,47,.2)}.event.cancelled[_ngcontent-%COMP%]{border-color:#617288}.event.cancelled[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{background-color:#617288}.event.cancelled[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{background-color:rgba(97,114,136,.2)}.event.cancelled.pending[_ngcontent-%COMP%]{border-color:rgba(97,114,136,.4)}.event.cancelled.pending[_ngcontent-%COMP%]   .handle[_ngcontent-%COMP%]{background-color:rgba(97,114,136,.2)}.inactive[_ngcontent-%COMP%]{-webkit-filter:blur(1px) grayscale(80%);filter:blur(1px) grayscale(80%)}.header[_ngcontent-%COMP%]{display:flex;align-items:center;height:1.5em}.header[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:.8em;padding:1em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1;min-width:50%}.icon[_ngcontent-%COMP%]{height:100%;width:1.8em;background-color:#1f40e6;color:#fff;display:flex;align-items:center;justify-content:center}.icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2em;width:1em}.body[_ngcontent-%COMP%]{padding:1em;font-size:.8em}.field[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:.5em}.field[_ngcontent-%COMP%]:last-child{margin:none}.host[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-style:italic}.catering-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;bottom:-4px;right:4px;height:1.5em;width:1.5em;border-radius:100%;background-color:#fff;border:1px solid #ccc;z-index:100}spinner[_ngcontent-%COMP%]{font-size:.3em}"]],data:{}});function E(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,1,"i",[["class","material-icons"]],null,null,null,null,null)),(n()(),t.Sb(1,null,[" "," "]))],null,function(n,l){var e=l.component;n(l,1,0,"busy"===e.event.state?"done":"cancelled"===e.event.state?"event_busy":"")})}function D(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,1,"spinner",[["color","#fff"],["type","circle-ring"]],null,null,null,d.C,d.p)),t.xb(1,770048,null,0,w.P,[t.h],{type:[0,"type"],color:[1,"color"]},null)],function(n,l){n(l,1,0,"circle-ring","#fff")},null)}function T(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,2,"div",[["class","field"]],[[8,"title",0]],null,null,null,null)),(n()(),t.yb(1,0,null,null,1,"div",[["class","value"]],null,null,null,null,null)),(n()(),t.Sb(2,null,["Welcomed by: ",""]))],null,function(n,l){var e=l.component;n(l,0,0,"Welcomed by: "+e.event.notify_users[0]),n(l,2,0,e.event.notify_users[0])})}function z(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,2,"div",[["class","field"]],null,null,null,null,null)),(n()(),t.yb(1,0,null,null,1,"div",[["class","value"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["Catered"]))],null,null)}function B(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,4,"div",[["class","field"]],null,null,null,null,null)),(n()(),t.yb(1,0,null,null,1,"div",[["class","label"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["Parking:"])),(n()(),t.yb(3,0,null,null,1,"div",[["class","value"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["Need Parking"]))],null,null)}function R(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,3,"div",[["class","catering-icon"]],null,[[null,"touchrelease"],[null,"mousedown"],[null,"touchstart"],[null,"mouseup"],[null,"touchend"]],function(n,l,e){var i=!0,o=n.component;return"mousedown"===l&&(i=!1!==t.Kb(n,1).mousestart(e)&&i),"touchstart"===l&&(i=!1!==t.Kb(n,1).touchstart(e)&&i),"mouseup"===l&&(i=!1!==t.Kb(n,1).mouse(e)&&i),"touchend"===l&&(i=!1!==t.Kb(n,1).touch(e)&&i),"touchrelease"===l&&(i=!1!==o.viewOrder()&&i),i},null,null)),t.xb(1,16384,null,0,w.vb,[],null,{event:"touchrelease"}),(n()(),t.yb(2,0,null,null,1,"i",[["class","material-icons"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["restaurant"]))],null,null)}function $(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,29,"div",[["class","event-container"]],[[2,"fixed",null],[2,"inactive",null],[4,"top",null],[4,"left",null],[4,"width",null],[4,"height",null]],null,null,null,null)),(n()(),t.yb(1,0,null,null,0,"div",[],[[8,"className",0],[4,"top",null],[4,"bottom",null]],null,null,null,null)),(n()(),t.yb(2,0,null,null,25,"div",[],[[8,"className",0],[4,"z-index",null]],[[null,"touchrelease"],[null,"mousedown"],[null,"touchstart"],[null,"mouseup"],[null,"touchend"]],function(n,l,e){var i=!0,o=n.component;return"mousedown"===l&&(i=!1!==t.Kb(n,3).mousestart(e)&&i),"touchstart"===l&&(i=!1!==t.Kb(n,3).touchstart(e)&&i),"mouseup"===l&&(i=!1!==t.Kb(n,3).mouse(e)&&i),"touchend"===l&&(i=!1!==t.Kb(n,3).touch(e)&&i),"touchrelease"===l&&(i=!1!==o.view()&&i),i},null,null)),t.xb(3,16384,null,0,w.vb,[],null,{event:"touchrelease"}),(n()(),t.yb(4,0,null,null,7,"div",[["class","header"]],null,null,null,null,null)),(n()(),t.yb(5,0,null,null,1,"div",[["class","text"]],null,null,null,null,null)),(n()(),t.Sb(6,null,["",""])),(n()(),t.yb(7,0,null,null,4,"div",[["class","icon"]],null,null,null,null,null)),(n()(),t.nb(16777216,null,null,1,null,E)),t.xb(9,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null),(n()(),t.nb(16777216,null,null,1,null,D)),t.xb(11,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null),(n()(),t.yb(12,0,null,null,15,"div",[["class","body"]],null,null,null,null,null)),(n()(),t.yb(13,0,null,null,2,"div",[["class","field host"]],null,null,null,null,null)),(n()(),t.yb(14,0,null,null,1,"div",[["class","value"]],[[8,"title",0]],null,null,null,null)),(n()(),t.Sb(15,null,[" "," "])),(n()(),t.yb(16,0,null,null,2,"div",[["class","field"]],null,null,null,null,null)),(n()(),t.yb(17,0,null,null,1,"div",[["class","value"]],[[8,"title",0]],null,null,null,null)),(n()(),t.Sb(18,null,["",""])),(n()(),t.yb(19,0,null,null,2,"div",[["class","field"]],null,null,null,null,null)),(n()(),t.yb(20,0,null,null,1,"div",[["class","value"]],null,null,null,null,null)),(n()(),t.Sb(21,null,[" "," Attendee",""," "])),(n()(),t.nb(16777216,null,null,1,null,T)),t.xb(23,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null),(n()(),t.nb(16777216,null,null,1,null,z)),t.xb(25,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null),(n()(),t.nb(16777216,null,null,1,null,B)),t.xb(27,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null),(n()(),t.nb(16777216,null,null,1,null,R)),t.xb(29,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null)],function(n,l){var e=l.component;n(l,9,0,"cancelled"===e.event.state||"busy"===e.event.state),n(l,11,0,"loading"===e.event.state),n(l,23,0,e.event.notify_users),n(l,25,0,e.has_catering),n(l,27,0,e.event.parking),n(l,29,0,e.event.catering&&e.event.catering.items&&e.event.catering.items.length)},function(n,l){var e=l.component;n(l,0,0,e.fixed,!e.active,e.top+"%",e.left+"%",e.fixed?"15rem":e.width+"%",e.fixed?3*e.height+"rem":e.height+"%"),n(l,1,0,"overflow"+(e.type?" "+e.type:""),0-e.overflow_top+"%",0-e.overflow_bottom+"%"),n(l,2,0,"event"+(e.type?" "+e.type:"")+(e.top>50?" low":""),((null==e.overlap?null:e.overlap.index)||0)+2),n(l,6,0,e.event.all_day?"All Day":e.period),n(l,14,0,"Host: "+((null==e.event.organiser?null:e.event.organiser.name)||e.event.organiser)),n(l,15,0,(null==e.event.organiser?null:e.event.organiser.name)||e.event.organiser),n(l,17,0,"Title: "+e.event.title),n(l,18,0,e.event.title),n(l,21,0,e.event.attendees&&e.event.attendees.length||"No",1===(null==e.event.attendees?null:e.event.attendees.length)?"":"s",e.expected?"("+e.expected+" Expected)":"")})}function K(n){return t.Ub(0,[(n()(),t.nb(16777216,null,null,1,null,$)),t.xb(1,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null)],function(n,l){n(l,1,0,l.component.event)},null)}var U=e("hOhj"),Y=e("IP0z"),F=e("9Kh7");class A extends i.a{constructor(n){super(),this._service=n,this.inView=new t.n,this.dragging=new t.n,this.overlap_details={},this.legend={},this.position_list={},this.settings={}}get events(){const n=u(this.date).format("DD MMM YYYY");return this.space?(this.space.timeline[n]||[]).filter(n=>(this.override_state&&this.override_state===n.icaluid&&(n.state="loading"),"cancelled"!==n.state?(!this.overflow_only||n.setup||n.breakdown)&&!1!==this.legend[n.booking_type]:(!this.overflow_only||n.setup||n.breakdown)&&!1!==this.legend.declined)):[]}ngOnInit(){if(!this._service.ready())return this.timeout("init",()=>this.ngOnInit());this.settings=this._service.Settings.get("app.day_view")||{},this.subscription("breakdown",this._service.listen("APP.breakdown",n=>{this.overflow_only=n})),this.subscription("legend",this._service.listen("CONCIERGE.legend",n=>{this.legend=n||{}}))}ngOnChanges(n){n.scroll&&this.checkInView(),n.last_update&&this.timeout("update_overlaps",()=>this.calculateOverlaps(),1e3)}trackByFn(n,l){return l.id||n}calculateOverlaps(){const n=this.events.sort((n,l)=>n.date-l.date||n.duration-l.duration||(n.title||"").localeCompare(l.title||""));n.forEach(n=>this.overlap_details[n.id]={index:0,total:1});for(const l of n){const e=u(l.date).startOf("m"),t=u(e).add(l.duration,"m").startOf("m");let i=1,o=0;const s=[];for(const r of n)if(l.id!==r.id){const a=u(r.date).startOf("m"),c=u(a).add(r.duration,"m").startOf("m");(e.isSame(a,"m")||e.isAfter(a,"m")&&e.isBefore(c,"m")||t.isSame(c,"m")||t.isAfter(a,"m")&&t.isBefore(c,"m"))&&(i++,s.push(l),n.findIndex(n=>n.id===l.id)>n.findIndex(n=>n.id===r.id)&&o++)}this.overlap_details[l.id]={index:Math.max(0,o),total:i}}}checkInView(){if(this.view&&this.view.nativeElement){const n=this.view.nativeElement;this.in_view=n.offsetLeft+this.scroll>=-240&&n.offsetLeft+this.scroll<=window.innerWidth,this.inView.emit(this.in_view)}}initDrag(){this.box=this.view.nativeElement.getBoundingClientRect(),console.log("Drag Start"),this.dragging.emit(!0)}endDrag(){this.timeout("end_drag",()=>this.top=0,10),console.log("Drag End"),this.dragging.emit(!1)}updateDragTop(n){if(n.delta.y){const l=15*Math.round((n.pointerPosition.y-this.box.top-this.scroll_top)/this.box.height*24*60/15)/60;this.top=l/24*100}}drop(n){const l=n.item.element.nativeElement.id,e=n.previousContainer.data.list.find(n=>n.id===l);if(!e)return;const t=e.state,i=Math.round((n.previousContainer.data.top||0)/100*24*60),o=u(e.date),s=o.startOf("d").minute(i);if(u().startOf("m").isAfter(s,"m"))return this._service.error("Meetings cannot be moved into the past");e.state="loading",this.override_state=e.icaluid;let r=e.room,a=`Update ${e.organiser.name}'s meeting in "${(e.room||{}).name}" from ${o.format("h:mm A")} to ${s.format("h:mm A")}`,c=`Successfully updated meeting time from ${o.format("h:mm A")} to ${s.format("h:mm A")}`,d=Object.assign({},e,{old_date:e.date,date:s.valueOf()});if(n.container!==n.previousContainer&&(r=this._service.Rooms.item(n.container.id.replace("space-col-","")),d.from_room=e.room.email,a=`Move ${e.organiser.name}'s meeting in "${(e.room||{}).name}" to "${r.name}" at ${s.format("h:mm A")}`,c=`Successfully moved booking to "${r.name}" at ${s.format("h:mm A")}`),r===e.room&&s.isSame(o,"m"))return e.state=t,void(this.override_state=null);const b=[r,...e.room_list.filter(n=>n.id!==e.room.id)];if(b.reduce((n,l)=>n.add(l.id),new Set).size<b.length)return e.state=t,this.override_state=null,this._service.error("The meeting is already in this room");d.room=b,this.checkCollisions(b,s.valueOf(),e.duration,e.icaluid).then(()=>{this.moveBooking(a,d).then(n=>{this._service.Rooms.removeFromTimeline(e.room.id,e.id),this._service.Rooms.addToTimeline(n),this.override_state=null,this._service.success(c)},n=>{e.state=t,this.override_state=null,"User cancelled"!==n&&this._service.error(`Error: ${n}`)})},()=>{e.state=t,this.override_state=null,this._service.error("Updated meeting time clashes with another")})}checkCollisions(n,l,e,t){return new Promise((i,o)=>{this._service.Rooms.available({room_ids:n.map(n=>n.id).join(","),date:l,duration:e,ignore:t,hide_bookings:!0}).then(l=>{l.length===n.length?i():o()},()=>o())})}moveBooking(n,l){return new Promise((e,t)=>{this._service.confirm({title:"Update meeting",message:n,icon:"event_available",accept:"Ok",cancel:!0},n=>{"Accept"===n.type?this._service.Bookings.updateItem(l.id,l).then(n=>e(n),n=>t(n)):t("User cancelled"),n.close()})})}}var N=t.wb({encapsulation:0,styles:[[".space-display[_ngcontent-%COMP%]{position:relative;height:100%;width:100%;overflow:hidden;pointer-events:auto}.event-preview[_ngcontent-%COMP%], .space-display[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{pointer-events:none}.event-placeholder[_ngcontent-%COMP%]{position:absolute;width:calc(100% - .5em);margin:0 .25em;border:3px dashed #969696;background-color:rgba(0,0,0,.2);border-radius:4px;transform:none!important;z-index:99999}.drop-zone[_ngcontent-%COMP%]{position:relative;height:100%;width:100%;pointer-events:none;transform:none!important}.cdk-drag[_ngcontent-%COMP%]{transform:none!important;cursor:-webkit-grab;cursor:grab}.cdk-drag-disabled[_ngcontent-%COMP%]{cursor:initial}.moving[_ngcontent-%COMP%]{position:fixed;bottom:1.5em;left:50%;transform:translateX(-50%);padding:.5em 1em;border-radius:1.5em;display:flex;align-items:center;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);z-index:999}.moving[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{margin-left:.5em}.moving[_ngcontent-%COMP%]   spinner[_ngcontent-%COMP%]{font-size:.25em}"]],data:{}});function j(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,3,"div",[["class","event-preview"]],null,null,null,null,null)),(n()(),t.yb(1,0,null,null,2,"div",[["class","content"]],null,null,null,null,null)),(n()(),t.yb(2,0,null,null,1,"day-view-space-event",[],null,null,null,K,S)),t.xb(3,770048,null,0,I,[o.a],{event:[0,"event"],space:[1,"space"],fixed:[2,"fixed"]},null)],function(n,l){n(l,3,0,l.parent.context.$implicit,l.component.space,!0)},null)}function V(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,0,"div",[["class","event-placeholder"]],[[4,"top",null],[4,"height",null]],null,null,null,null))],null,function(n,l){var e=l.component;n(l,0,0,(e.top||(e.position_list[l.parent.context.$implicit.id]?e.position_list[l.parent.context.$implicit.id].top:0))+"%",(e.position_list[l.parent.context.$implicit.id]?e.position_list[l.parent.context.$implicit.id].height:100)+"%")})}function G(n){return t.Ub(0,[(n()(),t.yb(0,16777216,null,null,11,"div",[["cdkDrag",""],["class","cdk-drag"]],[[4,"display",null],[8,"id",0],[2,"cdk-drag-disabled",null],[2,"cdk-drag-dragging",null]],[[null,"cdkDragStarted"],[null,"cdkDragMoved"],[null,"cdkDragReleased"]],function(n,l,e){var t=!0,i=n.component;return"cdkDragStarted"===l&&(t=!1!==i.initDrag()&&t),"cdkDragMoved"===l&&(t=!1!==i.updateDragTop(e)&&t),"cdkDragReleased"===l&&(t=!1!==i.endDrag()&&t),t},null,null)),t.Pb(6144,null,P.k,null,[P.c]),t.xb(2,4866048,[[2,4],[3,4]],3,P.c,[t.l,[3,P.b],k.d,t.B,t.S,U.i,P.j,P.a,[2,Y.b],P.h,t.h],{disabled:[0,"disabled"]},{started:"cdkDragStarted",released:"cdkDragReleased",moved:"cdkDragMoved"}),t.Qb(603979776,7,{_handles:1}),t.Qb(335544320,8,{_previewTemplate:0}),t.Qb(335544320,9,{_placeholderTemplate:0}),(n()(),t.yb(6,0,null,null,1,"day-view-space-event",[],null,[[null,"position"]],function(n,l,e){var t=!0;return"position"===l&&(t=!1!==(n.component.position_list[n.context.$implicit.id]=e)&&t),t},K,S)),t.xb(7,770048,null,0,I,[o.a],{event:[0,"event"],space:[1,"space"],overlap:[2,"overlap"]},{position:"position"}),(n()(),t.nb(0,null,null,1,null,j)),t.xb(9,16384,[[8,4]],0,P.e,[t.O],null,null),(n()(),t.nb(0,null,null,1,null,V)),t.xb(11,16384,[[9,4]],0,P.d,[t.O],null,null),(n()(),t.nb(0,null,null,0))],function(n,l){var e=l.component;n(l,2,0,"upcoming"!==l.context.$implicit.status||"cancelled"===l.context.$implicit.state||!e.settings.dragdrop),n(l,7,0,l.context.$implicit,e.space,e.overlap_details[l.context.$implicit.id])},function(n,l){n(l,0,0,!1!==l.component.inView?"":"none",l.context.$implicit.id,t.Kb(l,2).disabled,t.Kb(l,2)._dragRef.isDragging())})}function L(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,5,"div",[["class","moving"]],null,null,null,null,null)),(n()(),t.yb(1,0,null,null,1,"div",[["class","text"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["Moving meeting"])),(n()(),t.yb(3,0,null,null,2,"div",[["class","spinner"]],null,null,null,null,null)),(n()(),t.yb(4,0,null,null,1,"spinner",[["type","circle-ring"]],null,null,null,d.C,d.p)),t.xb(5,770048,null,0,w.P,[t.h],{type:[0,"type"]},null)],function(n,l){n(l,5,0,"circle-ring")},null)}function H(n){return t.Ub(0,[t.Qb(402653184,1,{view:0}),(n()(),t.yb(1,0,[[1,0],["view",1]],null,15,"div",[["cdkDropList",""],["cdkDropListSortingDisabled",""],["class","space-display cdk-drop-list"],["scrollContainer","#day-view-scroll"]],[[8,"id",0],[2,"cdk-drop-list-disabled",null],[2,"cdk-drop-list-dragging",null],[2,"cdk-drop-list-receiving",null]],[[null,"cdkDropListDropped"]],function(n,l,e){var t=!0;return"cdkDropListDropped"===l&&(t=!1!==n.component.drop(e)&&t),t},null,null)),t.xb(2,1196032,null,1,P.f,[t.l,P.j,t.h,[2,Y.b],[3,P.g],[2,k.d],P.h],{connectedTo:[0,"connectedTo"],data:[1,"data"],id:[2,"id"]},{dropped:"cdkDropListDropped"}),t.Qb(603979776,3,{_draggables:1}),t.Nb(4,{top:0,list:1}),t.xb(5,1720320,null,1,F.a,[P.f,t.G],{scrollContainer:[0,"scrollContainer"]},null),t.Qb(603979776,2,{items:1}),t.Pb(256,null,P.g,void 0,[]),t.Pb(2048,null,P.b,null,[P.f]),(n()(),t.yb(9,16777216,null,null,5,"div",[["cdkDrag",""],["class","drop-zone cdk-drag"]],[[2,"cdk-drag-disabled",null],[2,"cdk-drag-dragging",null]],null,null,null,null)),t.Pb(6144,null,P.k,null,[P.c]),t.xb(11,4866048,[[2,4],[3,4]],3,P.c,[t.l,[3,P.b],k.d,t.B,t.S,U.i,P.j,P.a,[2,Y.b],P.h,t.h],null,null),t.Qb(603979776,4,{_handles:1}),t.Qb(335544320,5,{_previewTemplate:0}),t.Qb(335544320,6,{_placeholderTemplate:0}),(n()(),t.nb(16777216,null,null,1,null,G)),t.xb(16,278528,null,0,k.k,[t.S,t.O,t.t],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),(n()(),t.nb(16777216,null,null,1,null,L)),t.xb(18,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null)],function(n,l){var e=l.component,i=e.space_list||t.hb,o=n(l,4,0,e.top,e.events);n(l,2,0,i,o,"space-col-"+(null==e.space?null:e.space.id)),n(l,5,0,"#day-view-scroll"),n(l,16,0,e.events,e.trackByFn),n(l,18,0,e.override_state)},function(n,l){n(l,1,0,t.Kb(l,2).id,t.Kb(l,2).disabled,t.Kb(l,2)._dropListRef.isDragging(),t.Kb(l,2)._dropListRef.isReceiving()),n(l,9,0,t.Kb(l,11).disabled,t.Kb(l,11)._dragRef.isDragging())})}var Q=e("NhFT"),q=e("PT0D"),W=e("cUpR");const X={};class J extends i.a{constructor(n){super(),this._service=n,this.acting=new t.n}get notifyee(){return this.event&&this.event.notify_users&&this.event.notify_users.length?this.event.notify_users[0]:"Concierge"}get description(){return this.event&&this.event.notes?(this.event.notes.find(n=>"description"===n.type)||{message:""}).message:""}get has_catering(){return!!(this.event&&this.event.catering&&this.event.catering.items&&this.event.catering.items.length)}view(){this.timeout("view",()=>{this._service.Bookings.view(this.event,this.event.room).then(n=>null,n=>null),this._service.set("CONCIERGE.day_view.viewing",this.event)},50)}accept(){this.event.organiser||(this.event.organiser={}),this.event.display||(this.event.display={}),this.acting.emit(!0),this._service.confirm({title:"Approve Meeting",message:`Approve ${this.event.organiser.name||this.event.organiser}'s meeting in "${(this.event.room||{}).name}" at ${this.event.display.start} for ${this.event.display.duration} on ${this.event.display.date}`,icon:"event_available",accept:"Ok",cancel:!0},n=>{"Accept"===n.type&&(this.loading=!0,this._service.Bookings.accept(this.event.id,{comment:"",room_id:this.event.room?this.event.room.id:this.event.room_id}).then(()=>{this._service.success("Meeting approved."),this.event.state="busy",this._service.Rooms.removeFromTimeline(this.event.room.id,this.event.id),this._service.Rooms.addToTimeline(this.event),X[this.event.id]=this.event.state,this._service.set("BOOKING.states",X),this.loading=!1,this.acting.emit(!1)},()=>{this.acting.emit(!1),this._service.error("Error approving meeting."),this.loading=!1})),n.close()})}decline(){this.event.organiser||(this.event.organiser={}),this.event.display||(this.event.display={}),this.acting.emit(!0),this._service.confirm({title:"Decline Meeting",message:`Decline ${this.event.organiser.name||this.event.organiser}'s meeting in "${(this.event.room||{}).name}" at ${this.event.display.start} for ${this.event.display.duration} on ${this.event.display.date}`,icon:"event_busy",accept:"Ok",cancel:!0},n=>{if("Accept"===n.type){this.loading=!0;const n=this.event;n.state="loading",this._service.Bookings.decline(n.id,{booking_id:n.id,organiser:n.organiser.email,icaluid:n.icaluid,start:Math.floor(n.date/1e3),end:Math.floor(n.date/1e3)+60*n.duration,room_id:n.room?n.room.id:n.room_id}).then(()=>{this._service.success("Meeting declined."),this.event.state="cancelled",this._service.Rooms.removeFromTimeline(this.event.room.id,this.event.id),this._service.Rooms.addToTimeline(this.event),X[this.event.id]=this.event.state,this._service.set("BOOKING.states",X),this.loading=!1,this.acting.emit(!1)},()=>{this.acting.emit(!1),this._service.error("Error declining meeting."),this.loading=!1})}n.close()})}}var Z=t.wb({encapsulation:0,styles:[[".approval-event[_ngcontent-%COMP%]{position:relative;width:100%;background-color:#fff;font-size:.8em;margin:.5em 0}.header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:1em}.avatar[_ngcontent-%COMP%]{font-size:1.2em}.details[_ngcontent-%COMP%]{padding:.5em}.footer[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;width:100%}.load-state[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(255,255,255,.85)}.control[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:0 1em;margin-bottom:.5em}.control[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]{height:1px;min-width:1px;flex:1;background-color:#ccc}.control[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:1em;width:1em;font-size:1.5em;margin:0 .5em;cursor:pointer}.contents[_ngcontent-%COMP%]{padding:0 1em 1em;overflow:hidden}.field[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:.5em}.field[_ngcontent-%COMP%]:last-child{margin-bottom:0}.field[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 .5em;flex:1;min-width:50%}.field[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1;min-width:50%}.field.multiline[_ngcontent-%COMP%]{align-items:flex-start}.field.multiline[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.no-item[_ngcontent-%COMP%]{font-size:.6em;color:#000}.no-item[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin:0;font-size:.75em}button[_ngcontent-%COMP%]{flex:1;min-width:30%;padding:.75em 1em;background-color:#f7f8ff;transition:color .2s,background-color .2s;border:1px solid #ccc;font-size:1em;cursor:pointer}button.accepted[_ngcontent-%COMP%], button.declined[_ngcontent-%COMP%]{pointer-events:none;color:#fff}button.accepted[_ngcontent-%COMP%]{background-color:#309b40}button.declined[_ngcontent-%COMP%]{background-color:#db291d}button[_ngcontent-%COMP%]:hover{background-color:#00adef;color:#fff}button[_ngcontent-%COMP%]::-moz-focus-inner{border:0}.search[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;top:.5em;right:.5em;border:1px solid #ccc;background-color:#f0f0f0;height:1.5em;width:1.5em;font-size:1.25em;border-radius:100%;cursor:pointer}.search[_ngcontent-%COMP%]:hover{background-color:#e6e6e6}"]],data:{animation:[{type:7,name:"show",definitions:[{type:1,expr:":enter",animation:[{type:6,styles:{opacity:0,height:0},offset:null},{type:4,styles:{type:6,styles:{opacity:1,height:"*"},offset:null},timings:200}],options:null},{type:1,expr:":leave",animation:[{type:6,styles:{opacity:1,height:"*"},offset:null},{type:4,styles:{type:6,styles:{opacity:0,height:0},offset:null},timings:200}],options:null}],options:{}}]}});function nn(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,16,"div",[["class","field"]],null,null,null,null,null)),(n()(),t.yb(1,0,null,null,1,"label",[],null,null,null,null,null)),(n()(),t.Sb(-1,null,["Booked by:"])),(n()(),t.yb(3,0,null,null,13,"div",[["class","value"]],null,null,null,null,null)),(n()(),t.yb(4,0,null,null,1,"div",[["class","text"]],null,null,null,null,null)),(n()(),t.Sb(5,null,["",""])),(n()(),t.yb(6,0,null,null,10,"div",[["class","actions"]],null,null,null,null,null)),(n()(),t.yb(7,0,null,null,4,"a",[],[[8,"href",4],[2,"no-event",null]],null,null,null,null)),(n()(),t.yb(8,0,null,null,3,"btn",[["format","mini-action"]],null,null,null,d.u,d.h)),t.xb(9,704512,null,0,w.c,[t.h],{disabled:[0,"disabled"],format:[1,"format"]},null),(n()(),t.yb(10,0,null,0,1,"i",[["class","material-icons"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["email"])),(n()(),t.yb(12,0,null,null,4,"a",[],[[8,"href",4],[2,"no-event",null]],null,null,null,null)),(n()(),t.yb(13,0,null,null,3,"btn",[["format","mini-action"]],null,null,null,d.u,d.h)),t.xb(14,704512,null,0,w.c,[t.h],{disabled:[0,"disabled"],format:[1,"format"]},null),(n()(),t.yb(15,0,null,0,1,"i",[["class","material-icons"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["call"]))],function(n,l){var e=l.component;n(l,9,0,!(null!=e.event.booked_by&&e.event.booked_by.email),"mini-action"),n(l,14,0,!(null!=e.event.booked_by&&e.event.booked_by.phone),"mini-action")},function(n,l){var e=l.component;n(l,5,0,null==e.event.booked_by?null:e.event.booked_by.name),n(l,7,0,"mailto:"+(null==e.event.booked_by?null:e.event.booked_by.email),!(null!=e.event.booked_by&&e.event.booked_by.email)),n(l,12,0,"tel:"+(null==e.event.booked_by?null:e.event.booked_by.phone),!(null!=e.event.booked_by&&e.event.booked_by.phone))})}function ln(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,1,"div",[["class","attendee"]],null,null,null,null,null)),(n()(),t.Sb(1,null,["",""]))],null,function(n,l){n(l,1,0,l.context.$implicit.name)})}function en(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,4,"div",[["class","field"]],null,null,null,null,null)),(n()(),t.yb(1,0,null,null,1,"label",[],null,null,null,null,null)),(n()(),t.Sb(-1,null,["Notes:"])),(n()(),t.yb(3,0,null,null,1,"div",[["class","value"]],[[8,"innerHTML",1]],null,null,null,null)),t.Ob(4,1)],null,function(n,l){var e=l.component,i=t.Tb(l,3,0,n(l,4,0,t.Kb(l.parent.parent.parent,0),e.description||""));n(l,3,0,i)})}function tn(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,37,"div",[["class","contents"]],[[24,"@show",0]],null,null,null,null)),(n()(),t.yb(1,0,null,null,16,"div",[["class","field"]],null,null,null,null,null)),(n()(),t.yb(2,0,null,null,1,"label",[],null,null,null,null,null)),(n()(),t.Sb(-1,null,["Host:"])),(n()(),t.yb(4,0,null,null,13,"div",[["class","value"]],null,null,null,null,null)),(n()(),t.yb(5,0,null,null,1,"div",[["class","text"]],null,null,null,null,null)),(n()(),t.Sb(6,null,["",""])),(n()(),t.yb(7,0,null,null,10,"div",[["class","actions"]],null,null,null,null,null)),(n()(),t.yb(8,0,null,null,4,"a",[],[[8,"href",4],[2,"no-event",null]],null,null,null,null)),(n()(),t.yb(9,0,null,null,3,"btn",[["format","mini-action"]],null,null,null,d.u,d.h)),t.xb(10,704512,null,0,w.c,[t.h],{disabled:[0,"disabled"],format:[1,"format"]},null),(n()(),t.yb(11,0,null,0,1,"i",[["class","material-icons"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["email"])),(n()(),t.yb(13,0,null,null,4,"a",[],[[8,"href",4],[2,"no-event",null]],null,null,null,null)),(n()(),t.yb(14,0,null,null,3,"btn",[["format","mini-action"]],null,null,null,d.u,d.h)),t.xb(15,704512,null,0,w.c,[t.h],{disabled:[0,"disabled"],format:[1,"format"]},null),(n()(),t.yb(16,0,null,0,1,"i",[["class","material-icons"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["call"])),(n()(),t.nb(16777216,null,null,1,null,nn)),t.xb(19,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null),(n()(),t.yb(20,0,null,null,5,"div",[["class","field multiline"]],null,null,null,null,null)),(n()(),t.yb(21,0,null,null,1,"label",[],null,null,null,null,null)),(n()(),t.Sb(-1,null,["Attendees:"])),(n()(),t.yb(23,0,null,null,2,"div",[["class","value"]],null,null,null,null,null)),(n()(),t.nb(16777216,null,null,1,null,ln)),t.xb(25,278528,null,0,k.k,[t.S,t.O,t.t],{ngForOf:[0,"ngForOf"]},null),(n()(),t.yb(26,0,null,null,4,"div",[["class","field"]],null,null,null,null,null)),(n()(),t.yb(27,0,null,null,1,"label",[],null,null,null,null,null)),(n()(),t.Sb(-1,null,["Welcomed by:"])),(n()(),t.yb(29,0,null,null,1,"div",[["class","value"]],null,null,null,null,null)),(n()(),t.Sb(30,null,["",""])),(n()(),t.yb(31,0,null,null,4,"div",[["class","field"]],null,null,null,null,null)),(n()(),t.yb(32,0,null,null,1,"label",[],null,null,null,null,null)),(n()(),t.Sb(-1,null,["Catering:"])),(n()(),t.yb(34,0,null,null,1,"div",[["class","value"]],null,null,null,null,null)),(n()(),t.Sb(35,null,["",""])),(n()(),t.nb(16777216,null,null,1,null,en)),t.xb(37,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null)],function(n,l){var e=l.component;n(l,10,0,!(null!=e.event.organiser&&e.event.organiser.email),"mini-action"),n(l,15,0,!(null!=e.event.organiser&&e.event.organiser.phone),"mini-action"),n(l,19,0,e.event.booked_by&&e.event.organiser&&e.event.organiser.email!==e.event.booked_by.email),n(l,25,0,e.event.attendees),n(l,37,0,e.description)},function(n,l){var e=l.component;n(l,0,0,void 0),n(l,6,0,null==e.event.organiser?null:e.event.organiser.name),n(l,8,0,"mailto:"+(null==e.event.organiser?null:e.event.organiser.email),!(null!=e.event.organiser&&e.event.organiser.email)),n(l,13,0,"tel:"+(null==e.event.organiser?null:e.event.organiser.phone),!(null!=e.event.organiser&&e.event.organiser.phone)),n(l,30,0,e.notifyee),n(l,35,0,e.event.has_catering?"Catered":"No Catering")})}function on(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,6,"div",[["class","load-state"]],null,null,null,null,null)),(n()(),t.yb(1,0,null,null,5,"div",[["class","no-item center"]],null,null,null,null,null)),(n()(),t.yb(2,0,null,null,2,"div",[["class","icon"]],null,null,null,null,null)),(n()(),t.yb(3,0,null,null,1,"spinner",[["type","circle-ring"]],null,null,null,d.C,d.p)),t.xb(4,770048,null,0,w.P,[t.h],{type:[0,"type"]},null),(n()(),t.yb(5,0,null,null,1,"div",[["class","text"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["Processing request..."]))],function(n,l){n(l,4,0,"circle-ring")},null)}function un(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,29,"div",[["class","approval-event"]],[[1,"event-id",0]],null,null,null,null)),(n()(),t.yb(1,0,null,null,9,"div",[["class","header"]],null,null,null,null,null)),(n()(),t.yb(2,0,null,null,2,"div",[["class","avatar"]],null,null,null,null,null)),(n()(),t.yb(3,0,null,null,1,"avatar",[],null,null,null,Q.b,Q.a)),t.xb(4,573440,null,0,q.a,[],{user:[0,"user"]},null),(n()(),t.yb(5,0,null,null,1,"div",[["class","details"]],null,null,null,null,null)),(n()(),t.Sb(6,null,[" "," "," "])),(n()(),t.yb(7,0,null,null,3,"div",[["class","search icon"]],null,[[null,"touchrelease"],[null,"mousedown"],[null,"touchstart"],[null,"mouseup"],[null,"touchend"]],function(n,l,e){var i=!0,o=n.component;return"mousedown"===l&&(i=!1!==t.Kb(n,8).mousestart(e)&&i),"touchstart"===l&&(i=!1!==t.Kb(n,8).touchstart(e)&&i),"mouseup"===l&&(i=!1!==t.Kb(n,8).mouse(e)&&i),"touchend"===l&&(i=!1!==t.Kb(n,8).touch(e)&&i),"touchrelease"===l&&(i=!1!==o.view()&&i),i},null,null)),t.xb(8,16384,null,0,w.vb,[],null,{event:"touchrelease"}),(n()(),t.yb(9,0,null,null,1,"i",[["class","material-icons"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["search"])),(n()(),t.yb(11,0,null,null,9,"div",[["class","body"]],null,null,null,null,null)),(n()(),t.yb(12,0,null,null,6,"div",[["class","control"]],null,null,null,null,null)),(n()(),t.yb(13,0,null,null,0,"div",[["class","bar"]],null,null,null,null,null)),(n()(),t.yb(14,0,null,null,3,"div",[["class","icon"]],null,[[null,"touchrelease"],[null,"mousedown"],[null,"touchstart"],[null,"mouseup"],[null,"touchend"]],function(n,l,e){var i=!0,o=n.component;return"mousedown"===l&&(i=!1!==t.Kb(n,15).mousestart(e)&&i),"touchstart"===l&&(i=!1!==t.Kb(n,15).touchstart(e)&&i),"mouseup"===l&&(i=!1!==t.Kb(n,15).mouse(e)&&i),"touchend"===l&&(i=!1!==t.Kb(n,15).touch(e)&&i),"touchrelease"===l&&(i=0!=(o.shown=!o.shown)&&i),i},null,null)),t.xb(15,16384,null,0,w.vb,[],null,{event:"touchrelease"}),(n()(),t.yb(16,0,null,null,1,"i",[["class","material-icons"]],null,null,null,null,null)),(n()(),t.Sb(17,null,["keyboard_arrow_",""])),(n()(),t.yb(18,0,null,null,0,"div",[["class","bar"]],null,null,null,null,null)),(n()(),t.nb(16777216,null,null,1,null,tn)),t.xb(20,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null),(n()(),t.yb(21,0,null,null,6,"div",[["class","footer"]],null,null,null,null,null)),(n()(),t.yb(22,0,null,null,2,"button",[],[[2,"accepted",null]],[[null,"touchrelease"],[null,"mousedown"],[null,"touchstart"],[null,"mouseup"],[null,"touchend"]],function(n,l,e){var i=!0,o=n.component;return"mousedown"===l&&(i=!1!==t.Kb(n,23).mousestart(e)&&i),"touchstart"===l&&(i=!1!==t.Kb(n,23).touchstart(e)&&i),"mouseup"===l&&(i=!1!==t.Kb(n,23).mouse(e)&&i),"touchend"===l&&(i=!1!==t.Kb(n,23).touch(e)&&i),"touchrelease"===l&&(i=!1!==o.accept()&&i),i},null,null)),t.xb(23,16384,null,0,w.vb,[],null,{event:"touchrelease"}),(n()(),t.Sb(24,null,[" Accept"," "])),(n()(),t.yb(25,0,null,null,2,"button",[],[[2,"declined",null]],[[null,"touchrelease"],[null,"mousedown"],[null,"touchstart"],[null,"mouseup"],[null,"touchend"]],function(n,l,e){var i=!0,o=n.component;return"mousedown"===l&&(i=!1!==t.Kb(n,26).mousestart(e)&&i),"touchstart"===l&&(i=!1!==t.Kb(n,26).touchstart(e)&&i),"mouseup"===l&&(i=!1!==t.Kb(n,26).mouse(e)&&i),"touchend"===l&&(i=!1!==t.Kb(n,26).touch(e)&&i),"touchrelease"===l&&(i=!1!==o.decline()&&i),i},null,null)),t.xb(26,16384,null,0,w.vb,[],null,{event:"touchrelease"}),(n()(),t.Sb(27,null,[" Decline"," "])),(n()(),t.nb(16777216,null,null,1,null,on)),t.xb(29,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null)],function(n,l){var e=l.component;n(l,4,0,e.event.organiser),n(l,20,0,e.shown),n(l,29,0,e.loading)},function(n,l){var e=l.component;n(l,0,0,e.event.id),n(l,6,0,(null==e.event.display?null:e.event.display.start)+" - "+(null==e.event.display?null:e.event.display.end),e.event.room?"in "+e.event.room.name:""),n(l,17,0,e.shown?"up":"down"),n(l,22,0,"busy"===e.event.state),n(l,24,0,"busy"===e.event.state?"ed":""),n(l,25,0,"cancelled"===e.event.state),n(l,27,0,"cancelled"===e.event.state?"d":"")})}function sn(n){return t.Ub(0,[t.Mb(0,w.L,[W.b]),(n()(),t.nb(16777216,null,null,1,null,un)),t.xb(2,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null)],function(n,l){n(l,2,0,l.component.event)},null)}class rn extends i.a{constructor(n){super(),this._service=n,this.events=[],this.space_list=[]}get date_display(){const n=u().startOf("d"),l=u(this.date).startOf("d");return n.isSame(l,"d")?"Today":1===l.diff(n,"d")?"Tomorrow":1===n.diff(l,"d")?"Yesterday":l.format("DD MMM YYYY")}ngOnInit(){this.subscription("building",this._service.listen("APP.level",n=>{this.space_list=this._service.Rooms.list(!0,[-1===n?this._service.Buildings.current().id:n]).map(n=>n.name),this.processMeetings(),this.getMonthlyPending()})),this.getMonthlyPending(),this.interval("monthly_pending",()=>this.getMonthlyPending(),6e4)}ngOnChanges(n){n.date&&(this.events=[],this.processMeetings(),this.interval("process_meetings",()=>this.processMeetings(),1e3))}trackByFn(n,l){return l.id||n}updateMeetings(){const n=this._service.get("APP.level"),l=-1===n?this._service.Buildings.current().id:n,e=u(this.date).startOf("d"),t=e.endOf("d");this.loading=!0,this._service.Rooms.query({zone_ids:l,available_from:e.unix(),available_to:t.unix()}).then(n=>{this.space_list=n.map(n=>n.id),this._service.Rooms.clearTimeline(e.valueOf(),t.valueOf(),this.space_list),n.forEach(n=>this._service.Rooms.updateTimeline(n.id,n.bookings)),this.processMeetings(),this.loading=!1})}processMeetings(){if(this.waiting_on_event)return;const n=u(this.date).format("DD MMM YYYY");this.events=this.process(n);const l=this._service.get("CONCIERGE.pending_bookings")||{};l[u(this.date).format("YYYY-MM-DD")]=this.events.length,this._service.set("CONCIERGE.pending_bookings",l)}process(n){const l=[];for(const e of this.space_list){const t=this._service.Rooms.item(e);if(t){const e=t.timeline[n]||[];for(const n of e)"tentative"!==n.type&&"tentative"!==n.state||l.push(n)}}return l.sort((n,l)=>n.date-l.date)}getMonthlyPending(){const n=u(this.date).startOf("M"),l=n.endOf("M"),e=this._service.get("APP.level"),t=(-1===e?null:e)||this._service.Buildings.current();console.log("Get Monthly:",n.format("MMMM YYYY")),this._service.Rooms.query({zone_ids:t,available_from:n.unix(),available_to:l.unix()}).then(e=>{this._service.Rooms.clearTimeline(n.valueOf(),l.valueOf(),e.map(n=>n.id)),e.forEach(n=>this._service.Rooms.updateTimeline(n.id,n.bookings));const t=this._service.get("CONCIERGE.pending_bookings")||{};for(let i=n;i.isBefore(l,"m");i=i.add(1,"d")){const n=this.process(i.format("DD MMM YYYY"));t[i.format("YYYY-MM-DD")]=n.length}this._service.set("CONCIERGE.pending_bookings",t)})}}var an=t.wb({encapsulation:0,styles:[[".approvals-view[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;overflow:auto;background-color:#eee}.no-item[_ngcontent-%COMP%]{font-size:.7em}.date[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;margin:.5em 0}.bar[_ngcontent-%COMP%]{height:1px;min-width:1px;flex:1;background-color:#707070}.display[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:.5em 1.5em;height:1.5em;border-radius:.8em;background-color:#707070;color:#fff;font-size:.8em}.load-state[_ngcontent-%COMP%]{position:absolute;left:50%;bottom:4px;transform:translateX(-50%);background-color:#fff;z-index:999;border-radius:4px;height:3em;width:3em;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.load-state[_ngcontent-%COMP%]   spinner[_ngcontent-%COMP%]{font-size:.4em}"]],data:{}});function cn(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,1,"approvals-event",[],null,[[null,"acting"]],function(n,l,e){var t=!0;return"acting"===l&&(t=!1!==(n.component.waiting_on_event=e)&&t),t},sn,Z)),t.xb(1,180224,null,0,J,[o.a],{event:[0,"event"]},{acting:"acting"})],function(n,l){n(l,1,0,l.context.$implicit)},null)}function dn(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,7,"div",[["class","content"]],null,null,null,null,null)),(n()(),t.yb(1,0,null,null,4,"div",[["class","date"]],null,null,null,null,null)),(n()(),t.yb(2,0,null,null,0,"div",[["class","bar"]],null,null,null,null,null)),(n()(),t.yb(3,0,null,null,1,"div",[["class","display"]],null,null,null,null,null)),(n()(),t.Sb(4,null,["",""])),(n()(),t.yb(5,0,null,null,0,"div",[["class","bar"]],null,null,null,null,null)),(n()(),t.nb(16777216,null,null,1,null,cn)),t.xb(7,278528,null,0,k.k,[t.S,t.O,t.t],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null)],function(n,l){var e=l.component;n(l,7,0,e.events,e.trackByFn)},function(n,l){n(l,4,0,l.component.date_display)})}function bn(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,4,"div",[["class","load-state"]],null,null,null,null,null)),(n()(),t.yb(1,0,null,null,3,"div",[["class","no-item center"]],null,null,null,null,null)),(n()(),t.yb(2,0,null,null,2,"div",[["class","icon"]],null,null,null,null,null)),(n()(),t.yb(3,0,null,null,1,"spinner",[["type","circle-ring"]],null,null,null,d.C,d.p)),t.xb(4,770048,null,0,w.P,[t.h],{type:[0,"type"]},null)],function(n,l){n(l,4,0,"circle-ring")},null)}function gn(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,5,"div",[["class","no-item center"]],null,null,null,null,null)),(n()(),t.yb(1,0,null,null,2,"div",[["class","icon"]],null,null,null,null,null)),(n()(),t.yb(2,0,null,null,1,"i",[["class","material-icons"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["close"])),(n()(),t.yb(4,0,null,null,1,"div",[["class","text"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["No meetings pending approval"]))],null,null)}function hn(n){return t.Ub(0,[(n()(),t.nb(16777216,null,null,1,null,gn)),t.xb(1,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null),(n()(),t.nb(0,null,null,0))],function(n,l){n(l,1,0,!l.component.loading)},null)}function vn(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,4,"div",[["class","approvals-view"]],null,null,null,null,null)),(n()(),t.nb(16777216,null,null,1,null,dn)),t.xb(2,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(n()(),t.nb(16777216,null,null,1,null,bn)),t.xb(4,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null),(n()(),t.nb(0,[["empty_state",2]],null,0,null,hn))],function(n,l){var e=l.component;n(l,2,0,e.events&&e.events.length,t.Kb(l,5)),n(l,4,0,e.loading)},null)}var pn=e("iInd"),mn=t.wb({encapsulation:0,styles:[[".day-view[_ngcontent-%COMP%]{position:relative;height:100%;width:100%;display:flex;align-items:center;flex-direction:column;background-color:#ecf1f5}.header[_ngcontent-%COMP%]{display:flex;align-items:center;border-bottom:1px solid #ccc;width:100%;height:3em}.header[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{overflow:hidden;height:100%}.header[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;top:0;left:0;bottom:0}.header[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-left:.5em}.header[_ngcontent-%COMP%]   spinner[_ngcontent-%COMP%]{font-size:.25em}.body[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;width:100%;flex:1;min-height:50%;overflow:hidden}.body[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;flex-direction:column;top:0;left:0;right:0}.time-blocks[_ngcontent-%COMP%]{position:relative;width:6em;border-right:1px solid #ccc;height:100%;overflow:hidden}.time-blocks[_ngcontent-%COMP%]   .block[_ngcontent-%COMP%]:first-child{opacity:0}.time-blocks[_ngcontent-%COMP%] > .text[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100%;width:100%}.flex[_ngcontent-%COMP%]{position:relative;flex:1;min-width:5em}.content[_ngcontent-%COMP%]{overflow:auto;background-color:#fff;height:100%}.time-lines[_ngcontent-%COMP%]{position:absolute;width:100%;pointer-events:none}.time-lines[_ngcontent-%COMP%]   .block[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.1)}.time-lines[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{position:absolute;top:50%;border-bottom:1px dashed rgba(0,0,0,.1);width:100%}.block[_ngcontent-%COMP%]{position:relative;width:100%;height:3rem;box-sizing:border-box;font-size:.8em}.hour[_ngcontent-%COMP%]{position:absolute;top:0;transform:translateY(-50%);text-align:center;width:100%;transition:color .2s}.hour.active[_ngcontent-%COMP%]{color:#00adef}.space-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;border-right:1px solid rgba(0,0,0,.1);height:100%;width:15rem;padding:.25em 1em}.space-header[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.space-header[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%]{font-size:.7em;text-align:center}.space-header[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:.9em}.space-day[_ngcontent-%COMP%]{display:flex}.space[_ngcontent-%COMP%]{border-right:1px solid rgba(0,0,0,.1);min-height:50vh;min-width:15rem;max-width:15rem;pointer-events:none}.now-line[_ngcontent-%COMP%]{position:absolute;left:6em;right:0;top:0;border:1px solid #00adef;pointer-events:none;z-index:101}.now-line[_ngcontent-%COMP%]   .knob[_ngcontent-%COMP%]{position:absolute;top:0;left:-1px;transform:translate(-50%,-50%);height:12px;width:12px;border-radius:100%;background-color:#00adef}.sidebar[_ngcontent-%COMP%]{position:relative;width:24em;border-left:1px solid #ccc;height:100%;background-color:rgba(0,0,0,.05);z-index:102}.sidebar[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{border:none}.sidebar[_ngcontent-%COMP%]   .space-header[_ngcontent-%COMP%]{width:100%}.auto-scroll[_ngcontent-%COMP%]{position:absolute;top:3em;left:6em;right:0;bottom:0;pointer-events:none}@media only screen and (orientation:portrait) and (max-width:450px){.auto-scroll[_ngcontent-%COMP%]{display:none}}@media only screen and (orientation:landscape) and (max-width:800px){.auto-scroll[_ngcontent-%COMP%]{display:none}}.auto-scroll[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{pointer-events:auto}.auto-scroll[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%], .auto-scroll[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]{position:absolute;left:0;right:0;height:32px}.auto-scroll[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]{top:0}.auto-scroll[_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]{bottom:0}.auto-scroll[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%], .auto-scroll[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;width:32px}.auto-scroll[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{top:0}.auto-scroll[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{bottom:0}"]],data:{}});function fn(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,6,"div",[["class","space-header"]],[[8,"title",0]],null,null,null,null)),(n()(),t.yb(1,0,null,null,3,"div",[["class","details"]],null,null,null,null,null)),(n()(),t.yb(2,0,null,null,1,"div",[["class","text"]],null,null,null,null,null)),(n()(),t.Sb(3,null,["",""])),(n()(),t.yb(4,0,null,null,0,"div",[["class","icon"]],null,null,null,null,null)),(n()(),t.yb(5,0,null,null,1,"div",[["class","capacity"]],null,null,null,null,null)),(n()(),t.Sb(6,null,["Capacity - "," ",""]))],null,function(n,l){n(l,0,0,l.context.$implicit.long_name),n(l,3,0,l.context.$implicit.name),n(l,6,0,l.context.$implicit.capacity||"0",1===l.context.$implicit.capacity?"person":"people")})}function _n(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,4,"div",[["class","sidebar"]],null,null,null,null,null)),(n()(),t.yb(1,0,null,null,3,"div",[["class","space-header"]],[[8,"title",0]],null,null,null,null)),(n()(),t.yb(2,0,null,null,1,"div",[["class","text"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["Holding Bay"])),(n()(),t.yb(4,0,null,null,0,"div",[["class","icon"]],null,null,null,null,null))],null,function(n,l){n(l,1,0,l.component.holding_bay.name)})}function yn(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,2,"div",[["class","block"]],null,null,null,null,null)),(n()(),t.yb(1,0,null,null,1,"div",[["class","hour"],["div",""]],[[2,"active",null]],null,null,null,null)),(n()(),t.Sb(2,null,["",""]))],null,function(n,l){var e=l.component;n(l,1,0,e.is_today&&l.context.$implicit.id===e.active_hour),n(l,2,0,l.context.$implicit.display)})}function On(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,1,"div",[["class","block"]],null,null,null,null,null)),(n()(),t.yb(1,0,null,null,0,"div",[["class","line"]],null,null,null,null,null))],null,null)}function xn(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,3,"div",[["cdkDropListGroup",""],["class","space"]],[[4,"min-height",null]],null,null,null,null)),t.xb(1,147456,null,0,P.g,[],null,null),(n()(),t.yb(2,0,null,null,1,"day-view-space",[],null,[[null,"dragging"],[null,"inView"]],function(n,l,e){var t=!0,i=n.component;return"dragging"===l&&(t=!1!==i.dragChange(e)&&t),"inView"===l&&(t=!1!==(i.in_view[n.context.$implicit.id]=e)&&t),t},H,N)),t.xb(3,770048,null,0,A,[o.a],{space_list:[0,"space_list"],date:[1,"date"],space:[2,"space"],scroll:[3,"scroll"],scroll_top:[4,"scroll_top"],last_update:[5,"last_update"]},{inView:"inView",dragging:"dragging"})],function(n,l){var e=l.component;n(l,3,0,e.space_zones,e.date,l.context.$implicit,0-e.scroll_left,e.scroll_offset-e.scroll_top,e.last_update)},function(n,l){n(l,0,0,3*l.component.time_blocks.length+"rem")})}function Mn(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,2,"div",[["class","now-line"]],[[4,"top",null]],null,null,null,null)),t.Ob(1,1),(n()(),t.yb(2,0,null,null,0,"div",[["class","knob"]],null,null,null,null,null))],null,function(n,l){var e=l.component,i=t.Tb(l,0,0,n(l,1,0,t.Kb(l.parent,0),"calc("+e.now*e.time_blocks.length*3+"rem - "+e.scroll_top+"px)"));n(l,0,0,i)})}function Cn(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,1,"day-view-space",[],null,[[null,"dragging"],[null,"inView"]],function(n,l,e){var t=!0,i=n.component;return"dragging"===l&&(t=!1!==i.dragChange(e)&&t),"inView"===l&&(t=!1!==(i.in_view[i.holding_bay.id]=e)&&t),t},H,N)),t.xb(1,770048,null,0,A,[o.a],{date:[0,"date"],space:[1,"space"],last_update:[2,"last_update"]},{inView:"inView",dragging:"dragging"})],function(n,l){var e=l.component;n(l,1,0,e.date,e.holding_bay,e.last_update)},null)}function Pn(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,4,"div",[["class","sidebar"]],null,null,null,null,null)),(n()(),t.nb(16777216,null,null,1,null,Cn)),t.xb(2,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null),(n()(),t.yb(3,0,null,null,1,"day-view-approvals-view",[],null,null,null,vn,an)),t.xb(4,770048,null,0,rn,[o.a],{date:[0,"date"]},null)],function(n,l){var e=l.component;n(l,2,0,e.holding_bay),n(l,4,0,e.date)},null)}function wn(n){return t.Ub(0,[t.Mb(0,w.M,[W.b]),t.Qb(402653184,1,{scroll_area:0}),(n()(),t.yb(2,0,null,null,27,"div",[["class","day-view"]],null,null,null,null,null)),(n()(),t.yb(3,0,null,null,9,"div",[["class","header"]],null,null,null,null,null)),(n()(),t.yb(4,0,null,null,2,"div",[["class","time-blocks"]],null,null,null,null,null)),(n()(),t.yb(5,0,null,null,1,"div",[["class","text"]],null,null,null,null,null)),(n()(),t.Sb(-1,null,["Time"])),(n()(),t.yb(7,0,null,null,3,"div",[["class","flex"]],null,null,null,null,null)),(n()(),t.yb(8,0,null,null,2,"div",[["class","group"]],[[4,"left",null]],null,null,null,null)),(n()(),t.nb(16777216,null,null,1,null,fn)),t.xb(10,278528,null,0,k.k,[t.S,t.O,t.t],{ngForOf:[0,"ngForOf"]},null),(n()(),t.nb(16777216,null,null,1,null,_n)),t.xb(12,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null),(n()(),t.yb(13,0,null,null,16,"div",[["class","body"]],null,[[null,"touchrelease"],[null,"mousedown"],[null,"touchstart"],[null,"mouseup"],[null,"touchend"]],function(n,l,e){var i=!0,o=n.component;return"mousedown"===l&&(i=!1!==t.Kb(n,14).mousestart(e)&&i),"touchstart"===l&&(i=!1!==t.Kb(n,14).touchstart(e)&&i),"mouseup"===l&&(i=!1!==t.Kb(n,14).mouse(e)&&i),"touchend"===l&&(i=!1!==t.Kb(n,14).touch(e)&&i),"touchrelease"===l&&(i=!1!==o.clearSelected()&&i),i},null,null)),t.xb(14,16384,null,0,w.vb,[],null,{event:"touchrelease"}),(n()(),t.yb(15,0,null,null,3,"div",[["class","time-blocks"]],null,null,null,null,null)),(n()(),t.yb(16,0,null,null,2,"div",[["class","group"]],[[4,"top",null]],null,null,null,null)),(n()(),t.nb(16777216,null,null,1,null,yn)),t.xb(18,278528,null,0,k.k,[t.S,t.O,t.t],{ngForOf:[0,"ngForOf"]},null),(n()(),t.yb(19,0,[[1,0],["scroll_area",1]],null,6,"div",[["class","flex content"],["id","day-view-scroll"]],null,[[null,"scroll"]],function(n,l,e){var t=!0;return"scroll"===l&&(t=!1!==n.component.updateScroll(e)&&t),t},null,null)),(n()(),t.yb(20,0,null,null,2,"div",[["class","time-lines"]],[[4,"min-width",null]],null,null,null,null)),(n()(),t.nb(16777216,null,null,1,null,On)),t.xb(22,278528,null,0,k.k,[t.S,t.O,t.t],{ngForOf:[0,"ngForOf"]},null),(n()(),t.yb(23,0,null,null,2,"div",[["class","space-day"]],null,null,null,null,null)),(n()(),t.nb(16777216,null,null,1,null,xn)),t.xb(25,278528,null,0,k.k,[t.S,t.O,t.t],{ngForOf:[0,"ngForOf"]},null),(n()(),t.nb(16777216,null,null,1,null,Mn)),t.xb(27,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null),(n()(),t.nb(16777216,null,null,1,null,Pn)),t.xb(29,16384,null,0,k.l,[t.S,t.O],{ngIf:[0,"ngIf"]},null)],function(n,l){var e=l.component;n(l,10,0,e.filtered_spaces),n(l,12,0,e.holding_bay),n(l,18,0,e.time_blocks),n(l,22,0,e.time_blocks),n(l,25,0,e.filtered_spaces),n(l,27,0,e.is_today),n(l,29,0,e.holding_bay)},function(n,l){var e=l.component;n(l,8,0,0-e.scroll_left+"px"),n(l,16,0,0-e.scroll_top+"px"),n(l,20,0,15*e.filtered_spaces.length+"rem")})}function kn(n){return t.Ub(0,[(n()(),t.yb(0,0,null,null,1,"app-day-view",[],null,[["window","resize"]],function(n,l,e){var i=!0;return"window:resize"===l&&(i=!1!==t.Kb(n,1).onResize()&&i),i},wn,mn)),t.xb(1,245760,null,0,r,[o.a,pn.a,t.G],null,null)],function(n,l){n(l,1,0)},null)}var In=t.ub("app-day-view",r,kn,{},{},[]),Sn=e("IheW"),En=e("s7LF"),Dn=e("/HVE"),Tn=e("crmZ"),zn=e("6B7d"),Bn=e("oapL"),Rn=e("Aftm"),$n=e("+EC0"),Kn=e("/X8Z"),Un=e("MkSN"),Yn=e("zQui"),Fn=e("xQn8");e.d(l,"DayViewModuleNgFactory",function(){return An});var An=t.vb(a,[],function(n){return t.Hb([t.Ib(512,t.k,t.fb,[[8,[c.a,d.a,d.g,d.d,d.e,d.f,d.t,d.G,d.H,d.b,d.c,b.a,g.a,h.a,v.a,p.a,m.a,f.a,_.a,y.a,O.a,x.a,M.a,C.a,In]],[3,t.k],t.z]),t.Ib(4608,k.n,k.m,[t.v,[2,k.C]]),t.Ib(4608,Sn.j,Sn.p,[k.d,t.D,Sn.n]),t.Ib(4608,Sn.q,Sn.q,[Sn.j,Sn.o]),t.Ib(5120,Sn.a,function(n){return[n]},[Sn.q]),t.Ib(4608,Sn.m,Sn.m,[]),t.Ib(6144,Sn.k,null,[Sn.m]),t.Ib(4608,Sn.i,Sn.i,[Sn.k]),t.Ib(6144,Sn.b,null,[Sn.i]),t.Ib(4608,Sn.f,Sn.l,[Sn.b,t.r]),t.Ib(4608,Sn.c,Sn.c,[Sn.f]),t.Ib(4608,En.w,En.w,[]),t.Ib(4608,En.e,En.e,[]),t.Ib(4608,P.h,P.h,[k.d,t.B,U.i,P.j]),t.Ib(1073742336,k.b,k.b,[]),t.Ib(1073742336,pn.p,pn.p,[[2,pn.u],[2,pn.l]]),t.Ib(1073742336,Sn.e,Sn.e,[]),t.Ib(1073742336,Sn.d,Sn.d,[]),t.Ib(1073742336,En.v,En.v,[]),t.Ib(1073742336,En.j,En.j,[]),t.Ib(1073742336,w.tb,w.tb,[]),t.Ib(1073742336,w.ub,w.ub,[]),t.Ib(1073742336,w.F,w.F,[]),t.Ib(1073742336,w.yb,w.yb,[]),t.Ib(1073742336,w.wb,w.wb,[]),t.Ib(1073742336,w.zb,w.zb,[]),t.Ib(1073742336,w.Ab,w.Ab,[]),t.Ib(1073742336,Y.a,Y.a,[]),t.Ib(1073742336,Dn.b,Dn.b,[]),t.Ib(1073742336,U.g,U.g,[]),t.Ib(1073742336,w.Bb,w.Bb,[]),t.Ib(1073742336,w.Cb,w.Cb,[]),t.Ib(1073742336,w.Db,w.Db,[]),t.Ib(1073742336,w.Eb,w.Eb,[]),t.Ib(1073742336,w.Fb,w.Fb,[]),t.Ib(1073742336,w.Hb,w.Hb,[]),t.Ib(1073742336,w.Ib,w.Ib,[]),t.Ib(1073742336,w.q,w.q,[]),t.Ib(1073742336,w.o,w.o,[]),t.Ib(1073742336,w.bb,w.bb,[]),t.Ib(1073742336,w.Jb,w.Jb,[]),t.Ib(1073742336,w.cb,w.cb,[]),t.Ib(1073742336,w.db,w.db,[]),t.Ib(1073742336,w.eb,w.eb,[]),t.Ib(1073742336,w.fb,w.fb,[]),t.Ib(1073742336,w.r,w.r,[]),t.Ib(1073742336,w.G,w.G,[]),t.Ib(1073742336,w.Y,w.Y,[]),t.Ib(1073742336,En.t,En.t,[]),t.Ib(1073742336,Tn.b,Tn.b,[]),t.Ib(1073742336,zn.b,zn.b,[]),t.Ib(1073742336,Bn.b,Bn.b,[]),t.Ib(1073742336,w.n,w.n,[]),t.Ib(1073742336,Rn.a,Rn.a,[]),t.Ib(1073742336,$n.b,$n.b,[]),t.Ib(1073742336,Kn.e,Kn.e,[]),t.Ib(1073742336,Un.c,Un.c,[]),t.Ib(1073742336,Yn.m,Yn.m,[]),t.Ib(1073742336,Fn.a,Fn.a,[]),t.Ib(1073742336,P.i,P.i,[]),t.Ib(1073742336,a,a,[]),t.Ib(256,Sn.n,"XSRF-TOKEN",[]),t.Ib(256,Sn.o,"X-XSRF-TOKEN",[]),t.Ib(1024,pn.j,function(){return[[{path:"",component:r}]]},[])])})}}]);