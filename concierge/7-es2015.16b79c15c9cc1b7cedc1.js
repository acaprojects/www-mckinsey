(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"zk/8":function(t,e,n){"use strict";n.r(e);var o=n("ofXK"),i=n("3Pt+"),c=n("tyNb"),a=n("IWZj"),r=n("fXoL");function s(t,e){if(1&t&&(r.Wb(0,"mat-option",11),r.Gc(1),r.Vb()),2&t){const t=e.$implicit;r.oc("value",t.id),r.Cb(1),r.Ic(" ",t.name," ")}}function d(t,e){if(1&t){const t=r.Xb();r.Wb(0,"mat-form-field",8),r.Wb(1,"mat-select",9),r.ec("ngModelChange",(function(e){return r.wc(t),r.ic(2).active_report=e}))("ngModelChange",(function(){return r.wc(t),r.ic(2).updateReport()})),r.Ec(2,s,2,2,"mat-option",10),r.Vb(),r.Vb()}if(2&t){const t=r.ic(2);r.Cb(1),r.oc("ngModel",t.active_report),r.Cb(1),r.oc("ngForOf",t.reports)}}function l(t,e){if(1&t&&(r.Wb(0,"div",6),r.Ec(1,d,3,2,"mat-form-field",7),r.Vb()),2&t){const t=r.ic();r.Cb(1),r.oc("ngIf",t.reports&&t.reports.length>1)}}const b=function(t){return["/reports",t]},g=function(){return{class:"material-icons",content:"keyboard_arrow_right"}};function p(t,e){if(1&t&&(r.Wb(0,"a",14),r.Wb(1,"div",15),r.Wb(2,"div",16),r.Rb(3,"app-icon",17),r.Vb(),r.Wb(4,"h3"),r.Gc(5),r.Vb(),r.Wb(6,"div",18),r.Wb(7,"div",19),r.Gc(8),r.Vb(),r.Rb(9,"app-icon",17),r.Vb(),r.Vb(),r.Vb()),2&t){const t=e.$implicit;r.oc("routerLink",r.qc(5,b,t.id)),r.Cb(3),r.oc("icon",t.icon),r.Cb(2),r.Hc(t.short_name),r.Cb(3),r.Hc(t.description),r.Cb(1),r.oc("icon",r.pc(7,g))}}function f(t,e){if(1&t&&(r.Wb(0,"div",12),r.Ec(1,p,10,8,"a",13),r.Vb()),2&t){const t=r.ic();r.Cb(1),r.oc("ngForOf",t.reports)}}function u(t,e){if(1&t&&r.Rb(0,"a-report-display",20),2&t){const t=r.ic();r.oc("report",t.the_report)}}let h=(()=>{class t extends a.a{constructor(t,e){super(),this._route=t,this._router=e,this.reports=[{id:"bookings",name:"Aggregate Bookings Report",short_name:"Bookings",description:"Generate comprehensive report on various aspects of bookings",hide_fields:["room_email"],icon:{type:"img",src:"assets/img/report-booking.svg"}},{id:"catering",name:"Aggregate Charge Back Report",short_name:"Catering",description:"View confirmed catering report or mark up unconfirmed catering",hide_fields:["room_email"],icon:{type:"icon",class:"material-icons",content:"room_service"}}]}get the_report(){return this.reports.find(t=>t.id===this.active_report)}ngOnInit(){this.subscription("route.params",this._route.paramMap.subscribe(t=>{t.has("report")&&(this.active_report=t.get("report"))}))}updateReport(){this._router.navigate(["/reports",this.active_report])}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(c.a),r.Qb(c.c))},t.\u0275cmp=r.Kb({type:t,selectors:[["a-reports"]],features:[r.zb],decls:9,vars:4,consts:[[1,"reports"],[1,"group"],[3,"date","dateChange"],["class","topbar",4,"ngIf"],["class","options",4,"ngIf","ngIfElse"],["report_display",""],[1,"topbar"],["appearance","outline",4,"ngIf"],["appearance","outline"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"options"],["class","card","mat-button","",3,"routerLink",4,"ngFor","ngForOf"],["mat-button","",1,"card",3,"routerLink"],[1,"content"],[1,"icon"],[3,"icon"],[1,"details"],[1,"desc"],[3,"report"]],template:function(t,e){if(1&t&&(r.Wb(0,"div",0),r.Rb(1,"a-sidebar"),r.Wb(2,"div",1),r.Wb(3,"a-topbar-header",2),r.ec("dateChange",(function(t){return e.date=t})),r.Ec(4,l,2,1,"div",3),r.Vb(),r.Wb(5,"main"),r.Ec(6,f,2,1,"div",4),r.Vb(),r.Vb(),r.Vb(),r.Ec(7,u,1,1,"ng-template",null,5,r.Fc)),2&t){const t=r.tc(8);r.Cb(3),r.oc("date",e.date),r.Cb(1),r.oc("ngIf",e.active_report),r.Cb(2),r.oc("ngIf",!e.active_report)("ngIfElse",t)}},styles:[".reports[_ngcontent-%COMP%], [_nghost-%COMP%], main[_ngcontent-%COMP%]{height:100%;width:100%}.reports[_ngcontent-%COMP%]{display:flex;height:100%;background-color:#ecf1f5}main[_ngcontent-%COMP%]{height:calc(100% - 3.5em)}.group[_ngcontent-%COMP%]{flex:1;min-width:12em}.topbar[_ngcontent-%COMP%]{padding:.1em 0 .1em .5em;height:3.5em}.topbar[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin-right:.5em;width:18em}h3[_ngcontent-%COMP%]{font-weight:300;margin-top:0}.options[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100%;width:100%}.card[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:4px;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);margin:1em;padding:1em;font-weight:300;background-color:#fff;height:20em}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column}.card[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%] > app-icon[_ngcontent-%COMP%]{font-size:6em;color:#1937ea}.card[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{display:flex;align-items:center}.card[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%] > app-icon[_ngcontent-%COMP%]{font-size:2em}.card[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%]{width:12em;margin-left:2.5em;white-space:pre-wrap;line-height:1.3em;color:rgba(0,0,0,.6)}"]}),t})();var m=n("PCNd"),C=n("SxV6"),_=n("Qox5"),O=n("Wgwc"),M=n("OaWH"),v=n("5fZw"),w=n("bTqV"),W=n("m6yr"),P=n("kmnG"),V=n("d3UM"),k=n("FKr1"),x=n("Xa2L"),y=n("f6nW");function E(t,e){if(1&t&&(r.Wb(0,"th",7),r.Gc(1),r.Vb()),2&t){const t=r.ic().$implicit;r.Cb(1),r.Hc(t)}}function I(t,e){if(1&t&&(r.Wb(0,"td",8),r.Gc(1),r.Vb()),2&t){const t=e.$implicit,n=r.ic().$implicit;r.Cb(1),r.Hc(t[n])}}function R(t,e){1&t&&(r.Ub(0,4),r.Ec(1,E,2,1,"th",5),r.Ec(2,I,2,1,"td",6),r.Tb()),2&t&&r.oc("cdkColumnDef",e.$implicit)}function G(t,e){1&t&&r.Rb(0,"tr",9)}function D(t,e){1&t&&r.Rb(0,"tr",10)}let F=(()=>{class t{constructor(){this.list=[],this.fields=[]}ngOnChanges(t){t.list&&this.list&&this.list.length&&(this.fields=Object.keys(this.list[0]).filter(t=>this.details.hide_fields.indexOf(t)<0))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.Kb({type:t,selectors:[["a-report-table"]],inputs:{list:"list",details:"details"},features:[r.Ab],decls:4,vars:4,consts:[["cdk-table","",3,"dataSource"],[3,"cdkColumnDef",4,"ngFor","ngForOf"],["cdk-header-row","",4,"cdkHeaderRowDef"],["cdk-row","",4,"cdkRowDef","cdkRowDefColumns"],[3,"cdkColumnDef"],["cdk-header-cell","",4,"cdkHeaderCellDef"],["cdk-cell","",4,"cdkCellDef"],["cdk-header-cell",""],["cdk-cell",""],["cdk-header-row",""],["cdk-row",""]],template:function(t,e){1&t&&(r.Wb(0,"table",0),r.Ec(1,R,3,1,"ng-container",1),r.Ec(2,G,1,0,"tr",2),r.Ec(3,D,1,0,"tr",3),r.Vb()),2&t&&(r.oc("dataSource",e.list),r.Cb(1),r.oc("ngForOf",e.fields),r.Cb(1),r.oc("cdkHeaderRowDef",e.fields),r.Cb(1),r.oc("cdkRowDefColumns",e.fields))},directives:[y.o,o.s,y.l,y.n,y.d,y.j,y.b,y.i,y.a,y.k,y.m],styles:["[_nghost-%COMP%]{font-size:.9em}table[_ngcontent-%COMP%]{border-collapse:collapse;background-color:#fff;width:100%}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding:.25em .5em}td[_ngcontent-%COMP%]{border-right:1px solid #ccc}td[_ngcontent-%COMP%]:last-child{border:none}[cdk-header-row][_ngcontent-%COMP%]{border-top:1px solid #f0f0f0;background-color:#051c2c;color:#fff}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:rgba(0,0,0,.05)}"]}),t})();var j=n("0njA");function H(t,e){if(1&t&&(r.Wb(0,"span",21),r.Gc(1),r.Vb()),2&t){const t=r.ic(2);r.Cb(1),r.Jc(" (+",t.locations.length-1," ",2===(null==t.locations?null:t.locations.length)?"other":"others",") ")}}function z(t,e){if(1&t&&(r.Wb(0,"mat-option",22),r.Wb(1,"div",23),r.Wb(2,"div",24),r.Gc(3),r.Vb(),r.Wb(4,"div",25),r.Gc(5),r.Vb(),r.Vb(),r.Vb()),2&t){const t=e.$implicit;r.oc("value",t),r.Cb(3),r.Hc(t.code),r.Cb(2),r.Hc(t.name)}}function A(t,e){if(1&t){const t=r.Xb();r.Wb(0,"mat-form-field",17),r.Wb(1,"mat-select",18),r.ec("ngModelChange",(function(e){return r.wc(t),r.ic().locations=e})),r.Wb(2,"mat-select-trigger"),r.Gc(3),r.Ec(4,H,2,2,"span",19),r.Vb(),r.Ec(5,z,6,3,"mat-option",20),r.Vb(),r.Vb()}if(2&t){const t=r.ic();r.Cb(1),r.oc("ngModel",t.locations),r.Cb(2),r.Ic(" ",t.locations?null==t.locations[0]?null:t.locations[0].name:""," "),r.Cb(1),r.oc("ngIf",(null==t.locations?null:t.locations.length)>1),r.Cb(1),r.oc("ngForOf",t.buildings)}}function Y(t,e){1&t&&(r.Wb(0,"span"),r.Gc(1,"Generate"),r.Vb())}function $(t,e){1&t&&r.Rb(0,"mat-spinner",26)}const q=function(){return[]};function L(t,e){if(1&t&&(r.Ub(0),r.Rb(1,"a-report-table",27),r.Tb()),2&t){const t=r.ic(2);r.Cb(1),r.oc("list",t.report_data.data||r.pc(2,q))("details",t.report)}}function J(t,e){if(1&t&&(r.Ub(0),r.Ec(1,L,2,3,"ng-container",12),r.Tb()),2&t){const t=r.ic(),e=r.tc(24);r.Cb(1),r.oc("ngIf",t.report_data&&t.report_data.data.length)("ngIfElse",e)}}const K=function(){return{class:"material-icons",content:"arrow_upward"}};function N(t,e){if(1&t&&(r.Wb(0,"div",28),r.Wb(1,"div",29),r.Rb(2,"app-icon",30),r.Vb(),r.Wb(3,"div",31),r.Gc(4),r.Vb(),r.Vb()),2&t){const t=r.ic();r.Cb(2),r.oc("icon",r.pc(2,K)),r.Cb(2),r.Ic(" ",t.report_data?"No entries for selected date":"Press generate above to view report"," ")}}function Q(t,e){1&t&&(r.Wb(0,"div",28),r.Wb(1,"div",29),r.Rb(2,"mat-spinner",26),r.Vb(),r.Wb(3,"div",31),r.Gc(4,"Loading report..."),r.Vb(),r.Vb())}let S=(()=>{class t{constructor(t){this._service=t,this.start_date=O().startOf("d").valueOf(),this.end_date=O().endOf("d").valueOf()}get buildings(){return this._service.Organisation.buildings}ngOnInit(){this._service.Organisation.initialised.pipe(Object(C.a)(t=>t)).subscribe(()=>{this.locations=[this._service.Organisation.building]})}ngOnChanges(t){t.report&&(this.report_data=null)}generateReport(){this.report&&(this.loading=!0,this.report_data=null,this._service.Reports.show(this.report.id,{date:O(this.start_date).format("YYYY-MM-DD"),start_date:Math.floor(this.start_date/1e3),end_date:Math.floor(this.end_date/1e3),zone_ids:this.locations.map(t=>t.id).join(",")}).then(t=>{this.loading=!1,this.report_data=new _.a(this._service.Reports,Object.assign(Object.assign({},t),{type:this.report.id}))},t=>{this.loading=!1,this._service.notifyError(`Error generating report. Error: ${t.message||t}`)}))}downloadReport(){if(this.report_data){const t=O(this.start_date).format("YYYY-MM-DD");this.report_data.downloadCSV(`${this.report.name.split(" ").join("_").toLowerCase()}+${t}.csv`)}}}return t.\u0275fac=function(e){return new(e||t)(r.Qb(M.a))},t.\u0275cmp=r.Kb({type:t,selectors:[["a-report-display"]],inputs:{report:"report"},features:[r.Ab],decls:27,vars:13,consts:[[1,"header"],[1,"period"],[1,"field"],["for","start-date"],["name","start-date",3,"ngModel","from","to","ngModelChange"],[1,"gap"],["for","end-date"],["name","end-date",3,"ngModel","from","to","ngModelChange"],[1,"location","dark-mode"],["appearance","outline",4,"ngIf"],[1,"actions"],["mat-button","",3,"disabled","tapped"],[4,"ngIf","ngIfElse"],["gen_loader",""],[1,"display"],["empty_state",""],["load_state",""],["appearance","outline"],["multiple","",3,"ngModel","ngModelChange"],["class","selection",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[1,"selection"],[3,"value"],[1,"option"],[1,"code"],[1,"name"],["diameter","32"],[3,"list","details"],[1,"info-block","center"],[1,"icon"],[3,"icon"],[1,"text"]],template:function(t,e){if(1&t&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.Wb(2,"div",2),r.Wb(3,"label",3),r.Gc(4,"Start Date"),r.Vb(),r.Wb(5,"a-date-field",4),r.ec("ngModelChange",(function(t){return e.start_date=t})),r.Vb(),r.Vb(),r.Wb(6,"div",5),r.Gc(7,"to"),r.Vb(),r.Wb(8,"div",2),r.Wb(9,"label",6),r.Gc(10,"End Date"),r.Vb(),r.Wb(11,"a-date-field",7),r.ec("ngModelChange",(function(t){return e.end_date=t})),r.Vb(),r.Vb(),r.Vb(),r.Wb(12,"div",8),r.Ec(13,A,6,4,"mat-form-field",9),r.Vb(),r.Wb(14,"div",10),r.Wb(15,"button",11),r.ec("tapped",(function(){return e.generateReport()})),r.Ec(16,Y,2,0,"span",12),r.Ec(17,$,1,0,"ng-template",null,13,r.Fc),r.Vb(),r.Wb(19,"button",11),r.ec("tapped",(function(){return e.downloadReport()})),r.Gc(20,"Download"),r.Vb(),r.Vb(),r.Vb(),r.Wb(21,"div",14),r.Ec(22,J,2,2,"ng-container",12),r.Vb(),r.Ec(23,N,5,3,"ng-template",null,15,r.Fc),r.Ec(25,Q,5,0,"ng-template",null,16,r.Fc)),2&t){const t=r.tc(18),n=r.tc(26);r.Cb(5),r.oc("ngModel",e.start_date)("from",e.end_date/10)("to",e.end_date),r.Cb(6),r.oc("ngModel",e.end_date)("from",e.start_date)("to",10*e.start_date),r.Cb(2),r.oc("ngIf",e.buildings&&e.buildings.length>1),r.Cb(2),r.oc("disabled",e.loading),r.Cb(1),r.oc("ngIf",!e.loading)("ngIfElse",t),r.Cb(3),r.oc("disabled",!e.report_data),r.Cb(3),r.oc("ngIf",!e.loading)("ngIfElse",n)}},directives:[v.a,i.r,i.u,o.t,w.b,W.c,P.b,V.a,V.c,o.s,k.g,x.c,F,j.a],styles:["[_nghost-%COMP%]{flex-direction:column;height:100%}.header[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;align-items:center}.header[_ngcontent-%COMP%]{width:100%;background-color:#051c2c;color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);padding:.5em}label[_ngcontent-%COMP%]{margin-bottom:.5em;font-size:.8em;font-weight:500}.location[_ngcontent-%COMP%]{flex:1;min-width:25%;text-align:center}.period[_ngcontent-%COMP%]{display:flex;align-items:center}.gap[_ngcontent-%COMP%]{padding:1em}.actions[_ngcontent-%COMP%]{display:flex;align-items:center}.display[_ngcontent-%COMP%]{position:relative;flex:1;min-height:50%;width:100%;overflow:auto}button[_ngcontent-%COMP%]{margin:.25em;width:8em;height:2.75em}mat-option[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{display:flex;align-items:center}mat-option[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{width:4em}mat-spinner[_ngcontent-%COMP%]{margin:auto}mat-form-field[_ngcontent-%COMP%]{height:3em}.selection[_ngcontent-%COMP%]{opacity:.75;font-size:.75em}"]}),t})();var T=n("Nuht"),U=n("DWOX"),X=n("YoI9"),B=n("ocbO"),Z=n("4Uey"),tt=n("q/nq"),et=n("4kJo"),nt=n("A+eD"),ot=n("4Man"),it=n("vJ8U"),ct=n("1k4r"),at=n("BAfr"),rt=n("9Kh7"),st=n("WE8N"),dt=n("1DiH"),lt=n("CTJb"),bt=n("opQU"),gt=n("zx1i"),pt=n("019G"),ft=n("cH1L"),ut=n("dNgK"),ht=n("0IaG"),mt=n("ihCf"),Ct=n("qFsG"),_t=n("bv9b"),Ot=n("/1cH"),Mt=n("A5z7"),vt=n("STbY"),wt=n("bSwM"),Wt=n("Qu3c"),Pt=n("QibW"),Vt=n("wZkO"),kt=n("1jcm"),xt=n("vxfF"),yt=n("5+WD"),Et=n("q/DJ");n.d(e,"ReportsModule",(function(){return Rt}));const It=[{path:"",component:h},{path:":report",component:h},{path:"**",redirectTo:""}];let Rt=(()=>{class t{}return t.\u0275mod=r.Ob({type:t}),t.\u0275inj=r.Nb({factory:function(e){return new(e||t)},imports:[[o.c,i.l,c.g.forChild(It),m.a]]}),t})();r.zc(h,[o.q,o.r,o.s,o.t,o.A,o.w,o.x,o.y,o.z,o.u,o.v,i.H,i.w,i.G,i.c,i.x,i.A,i.a,i.D,i.E,i.z,i.r,i.s,i.C,i.n,i.m,i.y,i.b,i.d,i.u,i.v,i.t,c.h,c.d,c.f,c.e,c.i,W.b,W.c,T.a,a.a,U.a,j.a,X.a,B.a,Z.a,tt.a,et.a,nt.a,ot.a,it.a,ct.a,at.a,rt.a,v.a,st.a,dt.a,lt.a,bt.a,gt.a,pt.a,w.b,w.a,ft.b,ut.b,ht.e,ht.d,ht.i,ht.f,ht.c,P.a,P.b,P.e,P.f,P.g,P.h,P.i,mt.b,mt.c,Ct.a,Ct.c,x.a,x.c,_t.a,Ot.a,k.g,k.f,Ot.d,Ot.c,V.a,V.c,Mt.d,Mt.a,Mt.c,Mt.e,Mt.b,Mt.f,k.j,vt.e,vt.b,vt.d,vt.a,wt.a,wt.c,Wt.a,Wt.c,Pt.b,Pt.a,Vt.c,Vt.d,Vt.a,Vt.f,Vt.e,Vt.b,kt.c,kt.a,xt.a,xt.b,xt.c,xt.d,yt.e,yt.f,yt.a,yt.b,yt.d,yt.c,y.o,y.n,y.b,y.c,y.j,y.f,y.d,y.a,y.m,y.i,y.e,y.k,y.l,y.g,y.h,y.r,y.t,y.s,y.q,h,S,F],[o.b,o.G,o.p,o.k,o.E,o.g,o.C,o.F,o.d,o.f,o.i,o.j,o.l,Et.b,Et.c])}}]);