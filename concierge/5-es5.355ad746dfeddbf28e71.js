function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){return function(){var t,n=_getPrototypeOf(e);if(_isNativeReflectConstruct()){var i=_getPrototypeOf(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"A1+e":function(e,t,n){"use strict";n.r(t);var i=n("ofXK"),o=n("tyNb"),a=n("3Pt+"),c=n("IWZj"),r=n("fXoL"),s=n("BAfr"),l=n("ocbO"),b=n("kmnG"),d=n("0njA"),g=n("qFsG"),u=n("bTqV"),m=n("m6yr"),f=n("IRj4"),p=n("0IaG");function h(e,t){return function(e,t){e=e||[],"string"==typeof(t=t||{})&&(t={type:t});try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<e.length;i+=1)n.append(e[i]);return n.getBlob(t.type)}}([e],t)}var v=n("OaWH"),_=n("Sa0K"),C=n("Xa2L"),y=n("q/DJ"),M=function(){return{type:"icon",class:"material-icons",content:"close"}};function O(e,t){1&e&&(r.Wb(0,"button",5),r.Rb(1,"app-icon",6),r.Vb()),2&e&&(r.Cb(1),r.oc("icon",r.pc(1,M)))}var I=function(){return{class:"material-icons",content:"cloud_upload"}};function w(e,t){1&e&&r.Rb(0,"app-icon",6),2&e&&r.oc("icon",r.pc(1,I))}function k(e,t){1&e&&r.Rb(0,"mat-spinner",18)}function W(e,t){if(1&e){var n=r.Xb();r.Wb(0,"main"),r.Wb(1,"form",7),r.Wb(2,"div",8),r.Wb(3,"div",9),r.jc(4,"safe"),r.Ec(5,w,1,2,"app-icon",10),r.Ec(6,k,1,0,"mat-spinner",11),r.Wb(7,"input",12),r.ec("change",(function(e){return r.wc(n),r.ic().uploadImage(e)})),r.Vb(),r.Vb(),r.Vb(),r.Wb(8,"div",8),r.Wb(9,"label",13),r.Gc(10,"Name"),r.Wb(11,"span"),r.Gc(12,"*"),r.Vb(),r.Vb(),r.Wb(13,"mat-form-field",14),r.Rb(14,"input",15),r.Wb(15,"mat-error"),r.Gc(16,"A valid name is required"),r.Vb(),r.Vb(),r.Vb(),r.Wb(17,"div",8),r.Wb(18,"label",16),r.Gc(19,"Description"),r.Vb(),r.Wb(20,"mat-form-field",14),r.Rb(21,"textarea",17),r.Vb(),r.Vb(),r.Vb(),r.Vb()}if(2&e){var i=r.ic();r.Cb(1),r.oc("formGroup",i.form),r.Cb(2),r.Dc("background",r.lc(4,7,"linear-gradient(rgba(0,0,0,.35),rgba(0,0,0,.35)), url("+i.image+")","style"),r.Jb),r.Cb(2),r.oc("ngIf",!i.uploading),r.Cb(1),r.oc("ngIf",i.uploading),r.Cb(3),r.Gb("error",i.form.controls.name.errors&&i.form.controls.name.touched)}}function P(e,t){if(1&e&&(r.Wb(0,"main"),r.Wb(1,"div",19),r.Wb(2,"div",20),r.Rb(3,"mat-spinner",21),r.Vb(),r.Wb(4,"div",22),r.Gc(5),r.Vb(),r.Vb(),r.Vb()),2&e){var n=r.ic();r.Cb(5),r.Hc(n.loading)}}var x,V=((x=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,a){var c;return _classCallCheck(this,n),(c=t.call(this))._service=e,c._upload_manager=i,c._dialog_ref=o,c._data=a,c.event=new r.o,c}return _createClass(n,[{key:"ngOnInit",value:function(){this.form=new a.i({name:new a.f(this.category.name,[a.F.required]),description:new a.f(this.category.description),image_path:new a.f(this.category.image_path)})}},{key:"submit",value:function(){var e=this;if(this.form.markAllAsTouched(),console.log("Form:",this.form),this.form.valid){var t=Object.assign(Object.assign({},this.category.toJSON()),this.form.value);(this.category.id?this._service.CateringCategories.update(this.category.id,t):this._service.CateringCategories.add(t)).then((function(t){e.event.emit({reason:"done",metadata:t}),e._dialog_ref.close()}),(function(t){return e._service.notifyError("Error ".concat(e.category.id?"updating":"creating"," category. Error: ").concat(t.message||t))}))}}},{key:"uploadImage",value:function(e){var t=this;if(e&&e.target&&e.target.files){var n=e.target.files;if(n.length){var i=new FileReader;i.onloadend=function(e){t.uploading=!0;var i=h(e.target.result,"image/png");t._upload_manager.upload([i],{file_name:n[0].name});var o=t._upload_manager.uploads[t._upload_manager.uploads.length-1];t.interval("upload",(function(){(o.complete||o.error)&&(o.access_url&&o.complete&&(console.log("Upload:",o),t.form.controls.image_path.setValue(o.access_url)),t.uploading=!1,t.clearInterval("upload"))}))},i.readAsArrayBuffer(n[0])}}}},{key:"category",get:function(){return this._data.category}},{key:"image",get:function(){return this.form?this.form.controls.image_path.value:""}}]),n}(c.a)).\u0275fac=function(e){return new(e||x)(r.Qb(v.a),r.Qb(_.c),r.Qb(p.h),r.Qb(p.a))},x.\u0275cmp=r.Kb({type:x,selectors:[["a-catering-category-modal"]],outputs:{event:"event"},features:[r.zb],decls:12,vars:5,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["mat-button","",3,"disabled","tapped"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[3,"formGroup"],[1,"field"],[1,"image"],[3,"icon",4,"ngIf"],["diameter","48",4,"ngIf"],["type","file",3,"change"],["for","name"],["appearance","outline"],["matInput","","name","name","placeholder","Category Name","formControlName","name"],["for","description"],["matInput","","name","description","placeholder","Category Description","formControlName","description"],["diameter","48"],[1,"info-block"],[1,"icon"],["diameter","32"],[1,"text"]],template:function(e,t){if(1&e&&(r.Wb(0,"header"),r.Wb(1,"div",0),r.Gc(2),r.Vb(),r.Ec(3,O,2,2,"button",1),r.Vb(),r.Wb(4,"mat-dialog-content"),r.Ec(5,W,22,10,"main",2),r.Vb(),r.Wb(6,"mat-dialog-actions"),r.Wb(7,"footer"),r.Wb(8,"button",3),r.ec("tapped",(function(){return t.submit()})),r.Gc(9,"Save"),r.Vb(),r.Vb(),r.Vb(),r.Ec(10,P,6,1,"ng-template",null,4,r.Fc)),2&e){var n=r.tc(11);r.Cb(2),r.Ic("",t.category.id?"Edit":"Add"," category"),r.Cb(1),r.oc("ngIf",!t.loading),r.Cb(2),r.oc("ngIf",!t.loading)("ngIfElse",n),r.Cb(3),r.oc("disabled",t.uploading)}},directives:[i.t,p.f,p.c,u.b,m.c,p.d,d.a,a.H,a.s,a.j,b.b,g.a,a.c,a.r,a.h,b.a,C.c],pipes:[y.b],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.field[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.heading[_ngcontent-%COMP%]{flex:1;min-width:50%}main[_ngcontent-%COMP%]{padding:1em;width:24em}label[_ngcontent-%COMP%]{min-width:100%;margin-right:1em;font-weight:700;font-size:.8em;width:100%;margin-top:0;margin-bottom:.5em}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ffb300}label.error[_ngcontent-%COMP%]{color:#e53935}.image[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:10em;width:10em!important;border-radius:4px;color:#fff;background-position:50%!important;background-size:cover!important;margin:auto auto 1em}.image[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;opacity:0}.image[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:3em}footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:8em}"]}),x),N=n("wZkO"),j=n("bSwM"),E=n("d3UM"),G=n("FKr1"),S=function(){return{type:"icon",class:"material-icons",content:"close"}};function T(e,t){1&e&&(r.Wb(0,"button",5),r.Rb(1,"app-icon",6),r.Vb()),2&e&&(r.Cb(1),r.oc("icon",r.pc(1,S)))}var z=function(){return{class:"material-icons",content:"cloud_upload"}};function L(e,t){1&e&&r.Rb(0,"app-icon",6),2&e&&r.oc("icon",r.pc(1,z))}function A(e,t){1&e&&r.Rb(0,"mat-spinner",31)}function D(e,t){if(1&e&&(r.Wb(0,"mat-option",32),r.Gc(1),r.Vb()),2&e){var n=t.$implicit;r.oc("value",n.id),r.Cb(1),r.Ic(" ",n.name," ")}}function R(e,t){1&e&&(r.Ub(0),r.Wb(1,"div",13),r.Wb(2,"mat-checkbox",33),r.Gc(3,"Out of Stock"),r.Vb(),r.Vb(),r.Wb(4,"div",13),r.Wb(5,"mat-checkbox",34),r.Gc(6,"Can order anytime"),r.Vb(),r.Vb(),r.Wb(7,"div",8),r.Wb(8,"label",35),r.Gc(9,"Unit Price"),r.Vb(),r.Wb(10,"mat-form-field",17),r.Rb(11,"input",36),r.Vb(),r.Vb(),r.Tb())}function Y(e,t){if(1&e){var n=r.Xb();r.Wb(0,"main"),r.Wb(1,"form",7),r.Wb(2,"div",8),r.Wb(3,"div",9),r.jc(4,"safe"),r.Ec(5,L,1,2,"app-icon",10),r.Ec(6,A,1,0,"mat-spinner",11),r.Wb(7,"input",12),r.ec("change",(function(e){return r.wc(n),r.ic().uploadImage(e)})),r.Vb(),r.Vb(),r.Vb(),r.Wb(8,"div",13),r.Wb(9,"label",14),r.Gc(10,"Parent Category"),r.Vb(),r.Wb(11,"div",15),r.Gc(12),r.Vb(),r.Vb(),r.Wb(13,"div",13),r.Wb(14,"mat-checkbox",16),r.Gc(15,"Package"),r.Vb(),r.Vb(),r.Wb(16,"div",8),r.Wb(17,"label",14),r.Gc(18,"Name"),r.Wb(19,"span"),r.Gc(20,"*"),r.Vb(),r.Vb(),r.Wb(21,"mat-form-field",17),r.Rb(22,"input",18),r.Wb(23,"mat-error"),r.Gc(24,"A valid name is required"),r.Vb(),r.Vb(),r.Vb(),r.Wb(25,"div",8),r.Wb(26,"label",19),r.Gc(27,"Type"),r.Wb(28,"span"),r.Gc(29,"*"),r.Vb(),r.Vb(),r.Wb(30,"mat-form-field",17),r.Wb(31,"mat-select",20),r.Ec(32,D,2,2,"mat-option",21),r.Vb(),r.Wb(33,"mat-error"),r.Gc(34,"Type is required"),r.Vb(),r.Vb(),r.Vb(),r.Wb(35,"div",8),r.Wb(36,"label",22),r.Gc(37,"Description"),r.Vb(),r.Wb(38,"mat-form-field",17),r.Rb(39,"textarea",23),r.Vb(),r.Vb(),r.Ec(40,R,12,0,"ng-container",24),r.Wb(41,"div",8),r.Wb(42,"label",25),r.Gc(43),r.Vb(),r.Wb(44,"mat-form-field",17),r.Rb(45,"input",26),r.Vb(),r.Vb(),r.Wb(46,"div",8),r.Wb(47,"label",27),r.Gc(48,"Minimum Quanity"),r.Vb(),r.Wb(49,"mat-form-field",17),r.Rb(50,"input",28),r.Vb(),r.Vb(),r.Wb(51,"div",8),r.Wb(52,"label",29),r.Gc(53,"Maximum Quanity"),r.Vb(),r.Wb(54,"mat-form-field",17),r.Rb(55,"input",30),r.Vb(),r.Vb(),r.Vb(),r.Vb()}if(2&e){var i=r.ic();r.Cb(1),r.oc("formGroup",i.form),r.Cb(2),r.Dc("background",r.lc(4,13,"linear-gradient(rgba(0,0,0,.35),rgba(0,0,0,.35)), url("+i.image+")","style"),r.Jb),r.Cb(2),r.oc("ngIf",!i.uploading),r.Cb(1),r.oc("ngIf",i.uploading),r.Cb(6),r.Hc(i.parent.name),r.Cb(5),r.Gb("error",i.form.controls.name.errors&&i.form.controls.name.touched),r.Cb(9),r.Gb("error",i.form.controls.catering_type.errors&&i.form.controls.catering_type.touched),r.Cb(6),r.oc("ngForOf",i.types),r.Cb(8),r.oc("ngIf",i.package),r.Cb(3),r.Ic("Items to select from ",i.package?"package":"sub-category","")}}function F(e,t){if(1&e&&(r.Wb(0,"main"),r.Wb(1,"div",37),r.Wb(2,"div",38),r.Rb(3,"mat-spinner",39),r.Vb(),r.Wb(4,"div",40),r.Gc(5),r.Vb(),r.Vb(),r.Vb()),2&e){var n=r.ic();r.Cb(5),r.Hc(n.loading)}}var U,Q=((U=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,a){var c;return _classCallCheck(this,n),(c=t.call(this))._service=e,c._upload_manager=i,c._dialog_ref=o,c._data=a,c.event=new r.o,c.types=[{id:"kitchen",name:"Kitchen"},{id:"pantry",name:"Pantry"}],c}return _createClass(n,[{key:"ngOnInit",value:function(){this.form=new a.i({name:new a.f(this.category.name,[a.F.required]),description:new a.f(this.category.description),image_path:new a.f(this.category.image_path),catering_type:new a.f(this.category.catering_type,[a.F.required]),package:new a.f(this.category.package||!1),must_select:new a.f(this.category.must_select),unit_price:new a.f(this.category.unit_price),minimum_quantity:new a.f(this.category.minimum_quantity),maximum_quantity:new a.f(this.category.maximum_quantity),order_anytime:new a.f(this.category.order_anytime),out_of_stock:new a.f(this.category.out_of_stock)})}},{key:"submit",value:function(){var e=this;if(this.form.markAllAsTouched(),console.log("Form:",this.form),this.form.valid){var t=Object.assign(Object.assign({},this.category.toJSON()),this.form.value);(this.category.id?this._service.CateringCategories.update(this.category.id,t):this._service.CateringCategories.add(t)).then((function(t){e.event.emit({reason:"done",metadata:t}),e._dialog_ref.close()}),(function(t){return e._service.notifyError("Error ".concat(e.category.id?"updating":"creating"," category. Error: ").concat(t.message||t))}))}}},{key:"uploadImage",value:function(e){var t=this;if(e&&e.target&&e.target.files){var n=e.target.files;if(n.length){var i=new FileReader;i.onloadend=function(e){t.uploading=!0;var i=h(e.target.result,"image/png");t._upload_manager.upload([i],{file_name:n[0].name});var o=t._upload_manager.uploads[t._upload_manager.uploads.length-1];t.interval("upload",(function(){(o.complete||o.error)&&(o.access_url&&o.complete&&(console.log("Upload:",o),t.form.controls.image_path.setValue(o.access_url)),t.uploading=!1,t.clearInterval("upload"))}))},i.readAsArrayBuffer(n[0])}}}},{key:"category",get:function(){return this._data.group}},{key:"parent",get:function(){return this._data.parent}},{key:"image",get:function(){return this.form?this.form.controls.image_path.value:""}},{key:"package",get:function(){return!!this.form&&this.form.controls.package.value}}]),n}(c.a)).\u0275fac=function(e){return new(e||U)(r.Qb(v.a),r.Qb(_.c),r.Qb(p.h),r.Qb(p.a))},U.\u0275cmp=r.Kb({type:U,selectors:[["a-catering-group-modal"]],outputs:{event:"event"},features:[r.zb],decls:12,vars:6,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["mat-button","",3,"disabled","tapped"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[3,"formGroup"],[1,"field"],[1,"image"],[3,"icon",4,"ngIf"],["diameter","48",4,"ngIf"],["type","file",3,"change"],[1,"field","padded"],["for","name"],[1,"value"],["formControlName","package"],["appearance","outline"],["matInput","","name","name","placeholder","Category Name","formControlName","name"],["for","type"],["name","type","formControlName","catering_type","placeholder","Select type"],[3,"value",4,"ngFor","ngForOf"],["for","description"],["matInput","","name","description","placeholder","Category Description","formControlName","description"],[4,"ngIf"],["for","must-select"],["matInput","","name","must-select","type","number","placeholder","Must select X items from grouping","formControlName","must_select"],["for","min-quanity"],["matInput","","name","min-quanity","type","number","placeholder","Minimum Quantity","formControlName","minimum_quantity"],["for","max-quanity"],["matInput","","name","max-quanity","type","number","placeholder","Maximum Quantity","formControlName","maximum_quantity"],["diameter","48"],[3,"value"],["formControlName","out_of_stock"],["formControlName","order_anytime"],["for","unit-price"],["matInput","","name","unit-price","type","number","placeholder","Price for one unit of the item without decimal places","formControlName","unit_price"],[1,"info-block"],[1,"icon"],["diameter","32"],[1,"text"]],template:function(e,t){if(1&e&&(r.Wb(0,"header"),r.Wb(1,"div",0),r.Gc(2),r.Vb(),r.Ec(3,T,2,2,"button",1),r.Vb(),r.Wb(4,"mat-dialog-content"),r.Ec(5,Y,56,16,"main",2),r.Vb(),r.Wb(6,"mat-dialog-actions"),r.Wb(7,"footer"),r.Wb(8,"button",3),r.ec("tapped",(function(){return t.submit()})),r.Gc(9,"Save"),r.Vb(),r.Vb(),r.Vb(),r.Ec(10,F,6,1,"ng-template",null,4,r.Fc)),2&e){var n=r.tc(11);r.Cb(2),r.Jc(" ",t.category.id?"Edit":"Add"," ",t.package?"package":"sub-category"," "),r.Cb(1),r.oc("ngIf",!t.loading),r.Cb(2),r.oc("ngIf",!t.loading)("ngIfElse",n),r.Cb(3),r.oc("disabled",t.uploading)}},directives:[i.t,p.f,p.c,u.b,m.c,p.d,d.a,a.H,a.s,a.j,j.a,a.r,a.h,b.b,g.a,a.c,b.a,E.a,i.s,a.x,C.c,G.g],pipes:[y.b],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.field[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.heading[_ngcontent-%COMP%]{flex:1;min-width:50%}main[_ngcontent-%COMP%]{padding:1em;width:24em}label[_ngcontent-%COMP%]{min-width:100%;margin-right:1em;font-weight:700;font-size:.8em;width:100%;margin-top:0;margin-bottom:.5em}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ffb300}label.error[_ngcontent-%COMP%]{color:#e53935}.padded[_ngcontent-%COMP%]{padding:0 0 1em}.image[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;height:10em;width:10em!important;border-radius:4px;color:#fff;background-position:50%!important;background-size:cover!important;margin:auto auto 1em}.image[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;opacity:0}.image[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:3em}footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:8em}"]}),U);function B(e,t){if(1&e&&(r.Wb(0,"div",4),r.Rb(1,"a-catering-menu-item",5),r.Vb()),2&e){var n=t.$implicit,i=r.ic(2);r.Cb(1),r.oc("parent",i.category)("item",n)}}function Z(e,t){if(1&e&&(r.Ub(0),r.Ec(1,B,2,2,"div",3),r.Tb()),2&e){var n=r.ic();r.Cb(1),r.oc("ngForOf",n.category.items)}}var H=function(){return{class:"material-icons",content:"close"}};function J(e,t){if(1&e&&(r.Wb(0,"div",6),r.Wb(1,"div",7),r.Rb(2,"app-icon",8),r.Vb(),r.Wb(3,"div",9),r.Gc(4),r.Vb(),r.Vb()),2&e){var n=r.ic();r.Cb(2),r.oc("icon",r.pc(2,H)),r.Cb(2),r.Ic("No packages or sub-categories for ",n.category.name,"")}}var q,X=((q=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var o;return _classCallCheck(this,n),(o=t.call(this))._dialog=e,o._service=i,o}return _createClass(n,[{key:"ngOnChanges",value:function(e){e.package&&this.package&&this.openGroupModal()}},{key:"openGroupModal",value:function(e){var t=this;e||(e=new f.a({parent_id:this.category.id,zones:[this.building.id]}));var n=this._dialog.open(Q,{data:{group:e,parent:this.category}});this.subscription("category_modal",n.componentInstance.event.subscribe((function(e){if("done"===e.reason){var n=t.category.items.findIndex((function(t){return e.metadata.id===t.id}));n>=0?t.category.items.splice(n,1,e.metadata):t.category.items.push(e.metadata)}}))),n.afterClosed().subscribe((function(){return t.unsub("category_modal")}))}},{key:"building",get:function(){return this._service.Organisation.building}}]),n}(c.a)).\u0275fac=function(e){return new(e||q)(r.Qb(p.b),r.Qb(v.a))},q.\u0275cmp=r.Kb({type:q,selectors:[["a-catering-menu-item-list"]],inputs:{category:"category",package:"package"},features:[r.zb,r.Ab],decls:4,vars:2,consts:[[1,"list"],[4,"ngIf","ngIfElse"],["empty_state",""],["class","item",4,"ngFor","ngForOf"],[1,"item"],[3,"parent","item"],[1,"info-block","center"],[1,"icon"],[3,"icon"],[1,"text"]],template:function(e,t){if(1&e&&(r.Wb(0,"div",0),r.Ec(1,Z,2,1,"ng-container",1),r.Vb(),r.Ec(2,J,5,3,"ng-template",null,2,r.Fc)),2&e){var n=r.tc(3);r.Cb(1),r.oc("ngIf",t.category&&t.category.items&&t.category.items.length)("ngIfElse",n)}},styles:[".list[_ngcontent-%COMP%]{position:relative;height:100%;width:100%;overflow:auto;padding-top:1em;background-color:#ecf1f5;color:#000}.item[_ngcontent-%COMP%]{width:768px;min-height:4em;overflow:hidden;border-radius:8px;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);margin:auto auto 1em;max-width:calc(100% - 1em)}"]}),q),K=function(){return{class:"material-icons",content:"edit"}};function $(e,t){if(1&e){var n=r.Xb();r.Wb(0,"div",9),r.Wb(1,"div",10),r.Gc(2),r.Vb(),r.Wb(3,"button",11),r.ec("click",(function(e){return r.wc(n),e.stopPropagation()}))("tapped",(function(){r.wc(n);var e=r.ic().$implicit;return r.ic(3).openCategoryModal(e)})),r.Rb(4,"app-icon",12),r.Vb(),r.Vb()}if(2&e){var i=r.ic().$implicit;r.Cb(2),r.Hc(null==i?null:i.name),r.Cb(2),r.oc("icon",r.pc(2,K))}}function ee(e,t){if(1&e&&(r.Wb(0,"mat-tab"),r.Ec(1,$,5,3,"ng-template",7),r.Rb(2,"a-catering-menu-item-list",8),r.Vb()),2&e){var n=t.$implicit,i=t.index,o=r.ic(3);r.Cb(2),r.oc("package",o.state[i])("category",n)}}function te(e,t){if(1&e){var n=r.Xb();r.Wb(0,"mat-tab-group",5),r.ec("selectedIndexChange",(function(e){return r.wc(n),r.ic(2).index=e})),r.Ec(1,ee,3,2,"mat-tab",6),r.Vb()}if(2&e){var i=r.ic(2);r.oc("selectedIndex",i.index),r.Cb(1),r.oc("ngForOf",i.filtered_menu)}}function ne(e,t){if(1&e&&(r.Ub(0),r.Ec(1,te,2,2,"mat-tab-group",4),r.Tb()),2&e){var n=r.ic(),i=r.tc(5);r.Cb(1),r.oc("ngIf",n.filtered_menu&&n.filtered_menu.length)("ngIfElse",i)}}function ie(e,t){if(1&e&&(r.Wb(0,"div",13),r.Wb(1,"div",14),r.Rb(2,"mat-spinner",15),r.Vb(),r.Wb(3,"div",16),r.Gc(4),r.Vb(),r.Vb()),2&e){var n=r.ic();r.Cb(4),r.Ic("Loading menu for ",n.building.name,"")}}var oe=function(){return{class:"material-icons",content:"close"}};function ae(e,t){if(1&e&&(r.Wb(0,"div",13),r.Wb(1,"div",14),r.Rb(2,"app-icon",12),r.Vb(),r.Wb(3,"div",16),r.Gc(4),r.Vb(),r.Vb()),2&e){var n=r.ic();r.Cb(2),r.oc("icon",r.pc(2,oe)),r.Cb(2),r.Ic("No menu categories for ",n.building.name,"")}}var ce,re,se=((ce=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var o;return _classCallCheck(this,n),(o=t.call(this))._service=e,o._dialog=i,o.length=new r.o,o.catering_menu=[],o.filtered_menu=[],o.index=0,o.state={},o}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.subscription("building",this._service.Organisation.listen("active_building").subscribe((function(t){e.index=0,e.catering_menu=[],e.filtered_menu=[],e.loadCateringMenu()})))}},{key:"ngOnChanges",value:function(e){e.search&&(this.filtered_menu=this.filter(this.catering_menu)),e.category&&this.category&&this.openCategoryModal(),e.package&&(this.state[this.index]=this.package)}},{key:"openCategoryModal",value:function(e){var t=this;e||(e=new f.a({zones:[this.building.id]}));var n=this._dialog.open(V,{data:{category:e}});this.subscription("category_modal",n.componentInstance.event.subscribe((function(e){if("done"===e.reason){var n=t.catering_menu.findIndex((function(t){return e.metadata.id===t.id}));n>=0?(t.catering_menu.splice(n,1,e.metadata),t.index=n):(t.index=t.catering_menu.length,t.catering_menu.push(e.metadata))}}))),n.afterClosed().subscribe((function(){return t.unsub("category_modal")}))}},{key:"loadCateringMenu",value:function(){var e=this;this.building&&(this.loading=!0,this._service.Menu.query({zone_id:this.building.id}).then((function(t){console.log("Menu:",t),e.catering_menu=(t||[]).map((function(e){return new f.a(e)})),e.length.emit(e.catering_menu.length),e.filtered_menu=e.filter(e.catering_menu),e.loading=!1}),(function(t){e._service.notifyError("Error loading menu for ".concat(e.building.name,". Error: ").concat(t.message|t),"Retry",(function(){return e.loadCateringMenu()})),e.loading=!1})))}},{key:"filter",value:function(e){return e}},{key:"building",get:function(){return this._service.Organisation.building}}]),n}(c.a)).\u0275fac=function(e){return new(e||ce)(r.Qb(v.a),r.Qb(p.b))},ce.\u0275cmp=r.Kb({type:ce,selectors:[["a-catering-menu"]],inputs:{search:"search",category:"category",package:"package"},outputs:{length:"length"},features:[r.zb,r.Ab],decls:6,vars:2,consts:[[1,"menu","page","dark-mode"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[3,"selectedIndex","selectedIndexChange",4,"ngIf","ngIfElse"],[3,"selectedIndex","selectedIndexChange"],[4,"ngFor","ngForOf"],["mat-tab-label",""],[3,"package","category"],[1,"tab-label"],[1,"label"],["mat-icon-button","",3,"click","tapped"],[3,"icon"],[1,"info-block","center"],[1,"icon"],["diameter","32"],[1,"text"]],template:function(e,t){if(1&e&&(r.Wb(0,"div",0),r.Ec(1,ne,2,2,"ng-container",1),r.Vb(),r.Ec(2,ie,5,1,"ng-template",null,2,r.Fc),r.Ec(4,ae,5,3,"ng-template",null,3,r.Fc)),2&e){var n=r.tc(3);r.Cb(1),r.oc("ngIf",!t.loading)("ngIfElse",n)}},directives:[i.t,N.c,i.s,N.a,N.d,X,u.b,m.c,d.a,C.c],styles:[".page[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%;width:100%}mat-tab-group[_ngcontent-%COMP%]{height:100%;background-color:#051c2c}.info-block[_ngcontent-%COMP%]{color:#000}.tab-label[_ngcontent-%COMP%]{display:flex;align-items:center;padding-left:2.75em}.tab-label[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:.5em}.tab-label[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{opacity:0}.tab-label[_ngcontent-%COMP%]:hover   button[_ngcontent-%COMP%]{opacity:1}"]}),ce),le=n("XNiG"),be=n("LRne"),de=n("SxV6"),ge=n("Kj3r"),ue=n("/uUt"),me=n("eIep"),fe=n("JIr8"),pe=n("lJxs"),he=n("7c/B"),ve=n("YxBP"),_e=n("Wgwc"),Ce=n("mrSG"),ye=function(e){return["/day-view",e]},Me=function(e){return{view:e}},Oe=((re=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"storeBooking",value:function(){localStorage.setItem("CONCIERGE.view_booking",JSON.stringify(this.booking.toJSON())),localStorage.setItem("CONCIERGE.date","".concat(this.booking.date))}}]),e}()).\u0275fac=function(e){return new(e||re)},re.\u0275cmp=r.Kb({type:re,selectors:[["order-booking-details"]],inputs:{booking:"booking"},decls:25,vars:11,consts:[[1,"heading"],[1,"content"],[1,"field"],["for","host"],["name","host",1,"value"],["for","space"],["name","space",1,"value"],["for","period"],["name","period",1,"value"],["button","","mat-button","","mat-dialog-close","",1,"footer",3,"routerLink","queryParams","click"]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Gc(1," Meeting Details\n"),r.Vb(),r.Wb(2,"div",1),r.Wb(3,"div",2),r.Wb(4,"label",3),r.Gc(5,"Host:"),r.Vb(),r.Wb(6,"div",4),r.Gc(7),r.Vb(),r.Vb(),r.Wb(8,"div",2),r.Wb(9,"label",5),r.Gc(10,"Room:"),r.Vb(),r.Wb(11,"div",6),r.Gc(12),r.Vb(),r.Vb(),r.Wb(13,"div",2),r.Wb(14,"label",7),r.Gc(15,"Period:"),r.Vb(),r.Wb(16,"div",8),r.Gc(17),r.Vb(),r.Vb(),r.Wb(18,"div",2),r.Wb(19,"label",3),r.Gc(20,"Attendees:"),r.Vb(),r.Wb(21,"div",4),r.Gc(22),r.Vb(),r.Vb(),r.Vb(),r.Wb(23,"a",9),r.ec("click",(function(){return t.storeBooking()})),r.Gc(24," View on Day View\n"),r.Vb()),2&e&&(r.Cb(7),r.Ic(" ",(null==t.booking.organiser?null:t.booking.organiser.name)||t.booking.organiser_email," "),r.Cb(5),r.Ic(" ",null==t.booking.space?null:t.booking.space.name," "),r.Cb(5),r.Ic(" ",t.booking.time_period," "),r.Cb(5),r.Jc(" ",(null==t.booking.attendees?null:t.booking.attendees.length)||"0","(",t.booking.expected_attendees[t.booking.space.id]||0," expected) "),r.Cb(1),r.oc("routerLink",r.qc(7,ye,t.booking.space.level.id))("queryParams",r.qc(9,Me,t.booking.id.slice(0,10))))},directives:[u.a,o.f,p.d],styles:["[_nghost-%COMP%]{display:flex;align-items:center;flex-direction:column;height:100%}[_nghost-%COMP%], [_nghost-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.heading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:1em;font-weight:500;background-color:#ccc}.content[_ngcontent-%COMP%]{flex:1;min-height:50%;overflow:auto;padding:.5em 1em}.field[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:.8em;margin:.5em 0 1em}label[_ngcontent-%COMP%]{margin-right:1em;font-weight:500}.footer[_ngcontent-%COMP%]{width:100%;border-radius:0;padding:.35em}"]}),re);function Ie(e,t){if(1&e&&(r.Wb(0,"div",12),r.Wb(1,"div",8),r.Gc(2),r.Vb(),r.Vb()),2&e){var n=t.$implicit;r.Cb(2),r.Hc(n.name)}}function we(e,t){if(1&e&&(r.Ub(0),r.Ec(1,Ie,3,1,"div",11),r.Tb()),2&e){var n=r.ic().$implicit;r.Cb(1),r.oc("ngForOf",n.items)}}function ke(e,t){if(1&e&&(r.Wb(0,"div",12),r.Wb(1,"div",8),r.Gc(2),r.Vb(),r.Ec(3,we,2,1,"ng-container",10),r.Vb()),2&e){var n=t.$implicit;r.Cb(2),r.Hc(n.name),r.Cb(1),r.oc("ngIf",n.items)}}function We(e,t){if(1&e&&(r.Ub(0),r.Ec(1,ke,4,2,"div",11),r.Tb()),2&e){var n=r.ic().$implicit;r.Cb(1),r.oc("ngForOf",n.items)}}function Pe(e,t){if(1&e&&(r.Wb(0,"div",6),r.Wb(1,"div",7),r.Wb(2,"div",8),r.Gc(3),r.Vb(),r.Wb(4,"div",9),r.Gc(5),r.Vb(),r.Vb(),r.Ec(6,We,2,1,"ng-container",10),r.Vb()),2&e){var n=t.$implicit;r.Cb(3),r.Hc(n.name),r.Cb(2),r.Ic("x",n.amount,""),r.Cb(1),r.oc("ngIf",n.items)}}function xe(e,t){if(1&e&&(r.Ub(0),r.Ec(1,Pe,7,3,"div",5),r.Tb()),2&e){var n=r.ic();r.Cb(1),r.oc("ngForOf",n.items)}}var Ve=function(){return{class:"material-icons",content:"close"}};function Ne(e,t){1&e&&(r.Wb(0,"div",13),r.Wb(1,"div",14),r.Rb(2,"app-icon",15),r.Vb(),r.Wb(3,"div",16),r.Gc(4," No items in order "),r.Vb(),r.Vb()),2&e&&(r.Cb(2),r.oc("icon",r.pc(1,Ve)))}var je,Ee=((je=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"items",get:function(){return this.order.items||[]}}]),e}()).\u0275fac=function(e){return new(e||je)},je.\u0275cmp=r.Kb({type:je,selectors:[["order-details-items"]],inputs:{booking:"booking",order:"order"},decls:8,vars:2,consts:[[1,"heading"],[1,"content"],[4,"ngIf","ngIfElse"],["mat-button","",1,"footer"],["empty_state",""],["class","item",4,"ngFor","ngForOf"],[1,"item"],[1,"details"],[1,"name"],[1,"amount"],[4,"ngIf"],["class","sub-item",4,"ngFor","ngForOf"],[1,"sub-item"],[1,"info-block","center"],[1,"icon"],[3,"icon"],[1,"text"]],template:function(e,t){if(1&e&&(r.Wb(0,"div",0),r.Gc(1," Order Details\n"),r.Vb(),r.Wb(2,"div",1),r.Ec(3,xe,2,1,"ng-container",2),r.Vb(),r.Wb(4,"button",3),r.Gc(5," Edit Order\n"),r.Vb(),r.Ec(6,Ne,5,2,"ng-template",null,4,r.Fc)),2&e){var n=r.tc(7);r.Cb(3),r.oc("ngIf",t.items&&t.items.length)("ngIfElse",n)}},directives:[i.t,u.b,i.s,d.a],styles:["[_nghost-%COMP%]{display:flex;align-items:center;flex-direction:column;height:100%}[_nghost-%COMP%], [_nghost-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.heading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:1em;font-weight:500;background-color:#ccc}.content[_ngcontent-%COMP%]{flex:1;min-height:50%;overflow:auto;padding:.5em}.item[_ngcontent-%COMP%]{font-size:.8em;border-radius:4px;transition:background-color .2s;padding:.5em}.item[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}.sub-item[_ngcontent-%COMP%]{padding:.5em 1em 0;font-size:.75rem}.details[_ngcontent-%COMP%]{display:flex;align-items:center}.name[_ngcontent-%COMP%]{flex:1;min-width:50%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.name[_ngcontent-%COMP%]:hover{white-space:normal}.amount[_ngcontent-%COMP%]{margin-left:1em}.footer[_ngcontent-%COMP%]{width:100%;border-radius:0;padding:.35em}"]}),je);function Ge(e,t){if(1&e&&(r.Wb(0,"div",11),r.Wb(1,"div",12),r.Gc(2),r.Vb(),r.Wb(3,"div",13),r.Wb(4,"div",14),r.Gc(5),r.Vb(),r.Rb(6,"div",15),r.Wb(7,"div",16),r.Gc(8),r.Vb(),r.Vb(),r.Vb()),2&e){var n=t.$implicit;r.Cb(2),r.Hc(n.message),r.Cb(3),r.Hc(n.author),r.Cb(3),r.Hc(n.time)}}function Se(e,t){if(1&e&&(r.Ub(0),r.Ec(1,Ge,9,3,"div",10),r.Tb()),2&e){var n=r.ic();r.Cb(1),r.oc("ngForOf",n.notes)}}function Te(e,t){1&e&&(r.Wb(0,"div",17),r.Rb(1,"mat-spinner",18),r.Vb())}var ze=function(){return{class:"material-icons",content:"close"}};function Le(e,t){1&e&&(r.Wb(0,"div",19),r.Wb(1,"div",20),r.Rb(2,"app-icon",7),r.Vb(),r.Wb(3,"div",12),r.Gc(4," No private notes for order "),r.Vb(),r.Vb()),2&e&&(r.Cb(2),r.oc("icon",r.pc(1,ze)))}var Ae,De=function(){return{class:"material-icons",content:"send"}},Re=((Ae=function(){function e(t){_classCallCheck(this,e),this._service=t,this.bookingChange=new r.o}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"addNote",value:function(){return Object(Ce.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,i,o,a,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.new_note){e.next=7;break}return t=this._service.Users.current,n=this.booking,i=n.notes||[],o=_e().startOf("m"),n.storePendingChange("notes",[].concat(_toConsumableArray(i),[{type:"catering",date:o.valueOf(),author:t.name,order_id:this.order.id,space:n.space.id,message:this.new_note,time:o.format("h:mm A")}])),this.loading=!0,e.next=5,n.save().catch((function(e){throw c._service.notifyError("Failed to add note to order meeting. Error: ".concat(e.message||e)),c.loading=!1,e}));case 5:a=e.sent,this.booking=a,this.order.booking=a,this.bookingChange.emit(a),this.loading=!1,this.new_note="";case 7:case"end":return e.stop()}}),e,this)})))}},{key:"notes",get:function(){var e=this,t=this.booking.notes.filter((function(t){return"catering"===t.type&&t.space===e.order.location_id&&(!t.order_id||t.order_id===e.order.id)}));return t.forEach((function(e){e.time=_e(e.date).format("DD MMM, h:mm A")})),t}}]),e}()).\u0275fac=function(e){return new(e||Ae)(r.Qb(v.a))},Ae.\u0275cmp=r.Kb({type:Ae,selectors:[["order-details-notes"]],inputs:{booking:"booking",order:"order"},outputs:{bookingChange:"bookingChange"},decls:12,vars:8,consts:[[1,"heading"],[1,"content"],[4,"ngIf","ngIfElse"],[1,"footer"],["appearance","none"],["matInput","","placeholder","Type to add notes",3,"ngModel","disabled","ngModelChange","keyup.enter"],["mat-icon-button","","matSuffix","",3,"disabled","tapped"],[3,"icon"],["class","loader center",4,"ngIf"],["empty_state",""],["class","note",4,"ngFor","ngForOf"],[1,"note"],[1,"text"],[1,"details"],[1,"author"],[1,"fill"],[1,"time"],[1,"loader","center"],["diameter","32"],[1,"info-block","center"],[1,"icon"]],template:function(e,t){if(1&e&&(r.Wb(0,"div",0),r.Gc(1," Private Notes\n"),r.Vb(),r.Wb(2,"div",1),r.Ec(3,Se,2,1,"ng-container",2),r.Vb(),r.Wb(4,"div",3),r.Wb(5,"mat-form-field",4),r.Wb(6,"input",5),r.ec("ngModelChange",(function(e){return t.new_note=e}))("keyup.enter",(function(){return t.addNote()})),r.Vb(),r.Wb(7,"button",6),r.ec("tapped",(function(){return t.addNote()})),r.Rb(8,"app-icon",7),r.Vb(),r.Vb(),r.Ec(9,Te,2,0,"div",8),r.Vb(),r.Ec(10,Le,5,2,"ng-template",null,9,r.Fc)),2&e){var n=r.tc(11);r.Cb(3),r.oc("ngIf",t.notes&&t.notes.length)("ngIfElse",n),r.Cb(3),r.oc("ngModel",t.new_note)("disabled",t.loading),r.Cb(1),r.oc("disabled",!t.new_note||t.loading),r.Cb(1),r.oc("icon",r.pc(7,De)),r.Cb(1),r.oc("ngIf",t.loading)}},directives:[i.t,b.b,g.a,a.c,a.r,a.u,u.b,b.i,m.c,d.a,i.s,C.c],styles:["[_nghost-%COMP%]{display:flex;align-items:center;flex-direction:column;height:100%}[_nghost-%COMP%], [_nghost-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.heading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:1em;font-weight:500;background-color:#ccc}.content[_ngcontent-%COMP%]{position:relative;flex:1;min-height:50%;overflow:auto;padding:.5em 1em}.note[_ngcontent-%COMP%]{font-size:.8em;margin:.5em 0}.note[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-weight:500;padding-bottom:.25em;border-bottom:1px solid #f0f0f0}.details[_ngcontent-%COMP%]{display:flex;align-items:center;color:rgba(0,0,0,.6);margin-top:.25em;font-size:.9em}.details[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]{flex:1;min-width:1px}.footer[_ngcontent-%COMP%]{position:relative;width:100%;border-radius:0;border-top:1px solid #ccc}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transform:translateY(.25em)}mat-form-field[_ngcontent-%COMP%]{height:3.25em;width:100%;padding:0 .5em}"]}),Ae);function Ye(e,t){if(1&e&&r.Rb(0,"app-icon",12),2&e){var n=r.ic(2);r.oc("icon",null==n.status_details?null:n.status_details.icon)}}function Fe(e,t){1&e&&r.Rb(0,"mat-spinner",23)}function Ue(e,t){if(1&e&&(r.Wb(0,"mat-option",24),r.Wb(1,"div",16),r.Wb(2,"div",21),r.Gc(3),r.Vb(),r.Rb(4,"div",25),r.Vb(),r.Vb()),2&e){var n=t.$implicit;r.oc("value",n.id),r.Cb(3),r.Hc(n.name),r.Cb(1),r.Dc("background-color",n.colour)}}function Qe(e,t){if(1&e){var n=r.Xb();r.Wb(0,"mat-form-field",13),r.Wb(1,"mat-select",14,15),r.ec("valueChange",(function(e){return r.wc(n),r.ic().active_status=e}))("valueChange",(function(){return r.wc(n),r.ic().updateStatus()})),r.Wb(3,"mat-select-trigger"),r.Wb(4,"div",16),r.Wb(5,"div",17),r.Wb(6,"div",18),r.Ec(7,Ye,1,1,"app-icon",19),r.Ec(8,Fe,1,0,"mat-spinner",20),r.Vb(),r.Vb(),r.Wb(9,"div",21),r.Gc(10),r.Vb(),r.Vb(),r.Vb(),r.Ec(11,Ue,5,4,"mat-option",22),r.Vb(),r.Vb()}if(2&e){var i=r.ic();r.Cb(1),r.oc("value",i.active_status)("disabled",i.loading),r.Cb(5),r.Dc("background-color",i.loading?"#eee":null==i.status_details?null:i.status_details.colour),r.Cb(1),r.oc("ngIf",!i.loading),r.Cb(1),r.oc("ngIf",i.loading),r.Cb(2),r.Hc(null==i.status_details?null:i.status_details.name),r.Cb(1),r.oc("ngForOf",i.statuses)}}var Be,Ze=function(){return{type:"icon",class:"material-icons",content:"close"}},He=((Be=function(){function e(t,n){_classCallCheck(this,e),this._service=t,this._data=n,this.event=new r.o,this.statuses=[{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]}return _createClass(e,[{key:"ngOnInit",value:function(){this.active_status=this._data.order.status}},{key:"updateStatus",value:function(){return Object(Ce.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._data.booking)){e.next=9;break}return this.loading=!0,(n=_toConsumableArray(t.catering)).splice(n.findIndex((function(e){return e.id===i._data.order.id})),1,new he.a(Object.assign(Object.assign({},this._data.order),{status:this.active_status}))),t.storePendingChange("catering",n),e.next=8,t.save().catch((function(e){i._service.notifyError("Error updating order status. Error: ".concat(e.message||e)),i.active_status=i._data.order.status,i.loading=!1}));case 8:this.loading=!1;case 9:case"end":return e.stop()}}),e,this)})))}},{key:"booking",get:function(){return this._data.booking},set:function(e){this._data.booking=e}},{key:"order",get:function(){return this._data.order}},{key:"status_details",get:function(){var e=this;return this.statuses.find((function(t){return t.id===e.active_status}))||{}}},{key:"space",get:function(){return this._service.Spaces.item(this._data.order.location_id)}},{key:"time",get:function(){return"(".concat(_e(this._data.booking.date).add(this._data.order.delivery_time,"m").format("DD MMM YYYY"),") To be delivered at ").concat(this._data.order.deliver_at_time)}}]),e}()).\u0275fac=function(e){return new(e||Be)(r.Qb(v.a),r.Qb(p.a))},Be.\u0275cmp=r.Kb({type:Be,selectors:[["a-order-details-modal"]],outputs:{event:"event"},decls:19,vars:10,consts:[[1,"details"],[1,"burger-icon"],[1,"location"],[1,"time"],[1,"status"],["class","rounded visible","appearance","outline",4,"ngIf"],[1,"content"],[1,"block"],[3,"booking"],[3,"booking","order"],[3,"booking","order","bookingChange"],["mat-icon-button","","mat-dialog-close","",1,"close"],[3,"icon"],["appearance","outline",1,"rounded","visible"],["placeholder","New Order",3,"value","disabled","valueChange"],["select",""],[1,"group"],[1,"icon"],[1,"wrapper"],[3,"icon",4,"ngIf"],["diameter","16",4,"ngIf"],[1,"text"],[3,"value",4,"ngFor","ngForOf"],["diameter","16"],[3,"value"],[1,"colour"]],template:function(e,t){1&e&&(r.Wb(0,"mat-dialog-content"),r.Wb(1,"main"),r.Wb(2,"div",0),r.Rb(3,"div",1),r.Wb(4,"div",2),r.Gc(5),r.Vb(),r.Wb(6,"div",3),r.Gc(7),r.Vb(),r.Wb(8,"div",4),r.Ec(9,Qe,12,8,"mat-form-field",5),r.Vb(),r.Vb(),r.Wb(10,"div",6),r.Wb(11,"div",7),r.Rb(12,"order-booking-details",8),r.Vb(),r.Wb(13,"div",7),r.Rb(14,"order-details-items",9),r.Vb(),r.Wb(15,"div",7),r.Wb(16,"order-details-notes",10),r.ec("bookingChange",(function(e){return t.booking=e})),r.Vb(),r.Vb(),r.Vb(),r.Wb(17,"button",11),r.Rb(18,"app-icon",12),r.Vb(),r.Vb(),r.Vb()),2&e&&(r.Cb(5),r.Hc(null==t.space?null:t.space.name),r.Cb(2),r.Hc(t.time),r.Cb(2),r.oc("ngIf",t.statuses&&t.statuses.length>1),r.Cb(3),r.oc("booking",t.booking),r.Cb(2),r.oc("booking",t.booking)("order",t.order),r.Cb(2),r.oc("booking",t.booking)("order",t.order),r.Cb(2),r.oc("icon",r.pc(9,Ze)))},directives:[p.f,i.t,Oe,Ee,Re,u.b,p.d,d.a,b.b,E.a,E.c,i.s,C.c,G.g],styles:["main[_ngcontent-%COMP%]{position:relative;width:64em;max-width:95vw;overflow:hidden auto}.burger-icon[_ngcontent-%COMP%]{height:8em;width:8em;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNjYuOTA0IiBoZWlnaHQ9IjE2MC44MjEiPjxkZWZzPjxyYWRpYWxHcmFkaWVudCBpZD0iYSIgY3g9Ii41IiBjeT0iLjUiIHI9Ii41IiBncmFkaWVudFVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLW9wYWNpdHk9Ii4zMDIiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNmZmYiIHN0b3Atb3BhY2l0eT0iLjMwMiIvPjwvcmFkaWFsR3JhZGllbnQ+PGNsaXBQYXRoIGlkPSJiIj48cGF0aCBkPSJNNjcuODIzIDE0Ny4xMDZDMzAuMzY2IDE0Ny4xMDYgMCAxNDAuMzg0IDAgMTAyLjg2MSAwIDk0LjM4NSAyLjQxMSAwIDIuNDExIDBoMTMzLjIzNXYxMDIuODYxYzAgMzcuNTIzLTMwLjM2NSA0NC4yNDUtNjcuODIzIDQ0LjI0NXoiIGZpbGw9Im5vbmUiLz48L2NsaXBQYXRoPjwvZGVmcz48ZyBkYXRhLW5hbWU9Ikdyb3VwIDQ4ODQiPjxlbGxpcHNlIGN4PSI3Ny4wNjkiIGN5PSIxNy41MjkiIHJ4PSI3Ny4wNjkiIHJ5PSIxNy41MjkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEyLjc2NyAxMjUuNzY0KSIgZmlsbD0idXJsKCNhKSIvPjxnIGRhdGEtbmFtZT0iR3JvdXAgNDg4MiI+PGcgY2xpcC1wYXRoPSJ1cmwoI2IpIj48cGF0aCBkYXRhLW5hbWU9IkJhY2tncm91bmQwOCIgZD0iTTEyOC4xOTYgOTEuMzk5YzAgMzIuMjUxLTI2LjEgMzguMDI5LTU4LjI5MyAzOC4wMjlTMTEuNjEgMTIzLjY1MSAxMS42MSA5MS4zOTlzMjYuMS00My4yNDggNTguMjkzLTQzLjI0OCA1OC4yOTMgMTEgNTguMjkzIDQzLjI0OCIgZmlsbD0iIzA1MWMyYyIvPjwvZz48ZyBkYXRhLW5hbWU9Ikdyb3VwIDQ4ODMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIyLjcxMiA2NC44MzUpIj48cmVjdCB3aWR0aD0iMzYuMjkxIiBoZWlnaHQ9IjQ3Ljg0MiIgcng9IjExIiB0cmFuc2Zvcm09InJvdGF0ZSgtMTcgMzUuNDk3IDUuMzA1KSIgZmlsbD0iI2ZmZiIvPjxyZWN0IGRhdGEtbmFtZT0iUmVjdGFuZ2xlIiB3aWR0aD0iMjYuMzkzIiBoZWlnaHQ9IjMuOTg3IiByeD0iMS45OTMiIHRyYW5zZm9ybT0icm90YXRlKC0xNyA1NC4xNDIgLTE0LjQwNykiIGZpbGw9IiMxZjQwZTYiLz48cGF0aCBkYXRhLW5hbWU9IkNvbWJpbmVkIFNoYXBlIiBkPSJNMTYuNjM1IDQ1LjgyNWEuNjY0LjY2NCAwIDExLS4zODgtMS4yN2wyMy45NjktNy4zMjhhLjY2NC42NjQgMCAxMS4zODggMS4yN3ptLS43NzctMi41NDJhLjY2NS42NjUgMCAwMS0uMzg4LTEuMjcxbDIzLjk2OC03LjMyOGEuNjY1LjY2NSAwIDExLjM4OSAxLjI3em0tLjc3Ny0yLjU0MmEuNjY1LjY2NSAwIDAxLS4zODktMS4yN2wyMy45Ny03LjMyOWEuNjY1LjY2NSAwIDExLjM4OCAxLjI3MXptLS43NzctMi41NDJhLjY2NS42NjUgMCAwMS0uMzg5LTEuMjdsMjMuOTctNy4zMjlhLjY2NS42NjUgMCAxMS4zODggMS4yNzF6bS0uNzc4LTIuNTQzYS42NjQuNjY0IDAgMTEtLjM4OC0xLjI3bDIzLjk2OS03LjMyOGEuNjY0LjY2NCAwIDExLjM4OCAxLjI3em0tLjc3Ny0yLjU0MmEuNjY0LjY2NCAwIDAxLS4zODgtMS4yN2wyMy45NjktNy4zMjhhLjY2NC42NjQgMCAxMS4zODggMS4yN3ptLS43NzctMi41NDFhLjY2NS42NjUgMCAwMS0uMzg4LTEuMjcxbDIzLjk2OC03LjMyOGEuNjY1LjY2NSAwIDExLjM4OSAxLjI3em0tLjc3Ny0yLjU0MmEuNjY1LjY2NSAwIDAxLS4zODgtMS4yNzFsMjMuOTY4LTcuMzI4YS42NjUuNjY1IDAgMTEuMzg5IDEuMjd6bS0uNzc3LTIuNTQyYS42NjUuNjY1IDAgMDEtLjM4OC0xLjI3bDIzLjk2OS03LjMyN2EuNjY1LjY2NSAwIDExLjM4OCAxLjI3eiIgZmlsbD0iI2U2ZTZlNiIvPjwvZz48ZyBkYXRhLW5hbWU9Ikdyb3VwIDQ4ODIiPjxwYXRoIGRhdGEtbmFtZT0iUGF0aCAxOTc5NiIgZD0iTTQ3LjY2NyAxMTAuNjA2djE5LjI0Nmg2OC4yMzd2LTIwLjAzM0w5OS4xMTggODkuODU0bC0zNC42NzQtLjk4NS0xNC44IDE1LjcwNnoiIGZpbGw9IiNmZmYiLz48ZyBkYXRhLW5hbWU9IkZpbGxlZCBJY29ucyI+PHBhdGggZGF0YS1uYW1lPSJQYXRoIDE5NzM0IiBkPSJNMTEyLjg5MiAxMTMuNzk5SDUwLjc0NGE0LjY3MSA0LjY3MSAwIDAwLTQuNjY0IDQuNjYxdjMuMTA3YTQuNjYzIDQuNjYzIDAgMDA0LjY2NCA0LjY2Mmg2Mi4xNDhhNC42NjUgNC42NjUgMCAwMDQuNjYxLTQuNjYxdi0zLjEwOGE0LjY3MyA0LjY3MyAwIDAwLTQuNjYxLTQuNjYxeiIgZmlsbD0iIzFmNDBlNiIvPjxwYXRoIGRhdGEtbmFtZT0iUGF0aCAxOTczNSIgZD0iTTExNiAxMTAuNjkydi0zLjA4OWEyMS43OCAyMS43OCAwIDAwLTIxLjc1Mi0yMS43NTJINjkuMzg5YTIxLjc3OCAyMS43NzggMCAwMC0yMS43NTUgMjEuNzUydjMuMDg5ek05Ny4zNTUgOTUuMTczYTEuNTU0IDEuNTU0IDAgMTEtMS41NTQgMS41NTQgMS41NTggMS41NTggMCAwMTEuNTU0LTEuNTU0em0tNy43NjgtMy4xMDdhMS41NTQgMS41NTQgMCAxMS0xLjU1MyAxLjU1MyAxLjU1OCAxLjU1OCAwIDAxMS41NTMtMS41NTN6bS03Ljc2OCAzLjEwN2ExLjU1NCAxLjU1NCAwIDExLTEuNTU0IDEuNTU0IDEuNTU4IDEuNTU4IDAgMDExLjU1My0xLjU1NHptLTcuNzY4LTMuMTA3YTEuNTU0IDEuNTU0IDAgMTEtMS41NTQgMS41NTQgMS41NTggMS41NTggMCAwMTEuNTUzLTEuNTU0em0tNy43NjggMy4xMDdhMS41NTQgMS41NTQgMCAxMS0xLjU1NCAxLjU1NCAxLjU1OCAxLjU1OCAwIDAxMS41NTItMS41NTR6IiBmaWxsPSIjMDBhOWY0Ii8+PHBhdGggZGF0YS1uYW1lPSJQYXRoIDE5NzM2IiBkPSJNNDcuNjM0IDEyOS4zMzZ2MS41NzJhNy43NTkgNy43NTkgMCAwMDcuNzY4IDcuNzVoNTIuODMyYTcuNzYxIDcuNzYxIDAgMDA3Ljc2OC03Ljc1di0xLjU3MnoiIGZpbGw9IiMwMGE5ZjQiLz48L2c+PC9nPjwvZz48L2c+PC9zdmc+);background-repeat:no-repeat;background-size:contain;background-position:50% 50%}.details[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;padding:.5em}.details[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-bottom:.25em}.location[_ngcontent-%COMP%]{font-weight:500}mat-dialog-content[_ngcontent-%COMP%]{max-height:95vh}.mat-active[_ngcontent-%COMP%]{color:#1937ea}.group[_ngcontent-%COMP%]{display:flex;align-items:center}.group[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1}.group[_ngcontent-%COMP%]   .colour[_ngcontent-%COMP%]{position:relative;left:-8px;height:8px;width:8px;border-radius:100%;transition:height .2s,width .2s;transform:translateX(50%)}.group[_ngcontent-%COMP%]:hover   .colour[_ngcontent-%COMP%]{height:16px;width:16px}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:1em;width:1em;margin-right:.75em;background-color:none;color:#fff}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{height:1.5em;min-width:1.5em;border-radius:100%;margin-top:4px}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:.8em}.content[_ngcontent-%COMP%]{display:flex;align-items:center;overflow:auto hidden;padding:0 2em 2em}.block[_ngcontent-%COMP%]{height:24em;flex:1;min-width:18em;margin:0 .75em;border:1px solid #ccc}.block[_ngcontent-%COMP%]:first-child{margin-left:0}.block[_ngcontent-%COMP%]:last-child{margin-right:0}.close[_ngcontent-%COMP%]{position:absolute;top:.5em;right:.5em}"]}),Be),Je=n("xhdr"),qe=n("bv9b"),Xe=n("CbDI");function Ke(e,t){1&e&&(r.Ub(0),r.Wb(1,"span"),r.Gc(2,"(K)"),r.Vb(),r.Gc(3," Kitchen"),r.Rb(4,"br"),r.Tb())}function $e(e,t){1&e&&(r.Ub(0),r.Wb(1,"span"),r.Gc(2,"(P)"),r.Vb(),r.Gc(3," Pantry"),r.Tb())}function et(e,t){if(1&e&&r.Rb(0,"app-icon",3),2&e){var n=r.ic(2);r.oc("icon",null==n.status_details?null:n.status_details.icon)}}function tt(e,t){1&e&&r.Rb(0,"mat-spinner",25)}function nt(e,t){if(1&e&&(r.Wb(0,"mat-option",26),r.Wb(1,"div",19),r.Wb(2,"div",23),r.Gc(3),r.Vb(),r.Rb(4,"div",27),r.Vb(),r.Vb()),2&e){var n=t.$implicit;r.oc("value",n.id),r.Cb(3),r.Hc(n.name),r.Cb(1),r.Dc("background-color",n.colour)}}function it(e,t){if(1&e){var n=r.Xb();r.Wb(0,"mat-form-field",16),r.Wb(1,"mat-select",17,18),r.ec("valueChange",(function(e){return r.wc(n),r.ic().active_status=e}))("valueChange",(function(){return r.wc(n),r.ic().updateStatus()})),r.Wb(3,"mat-select-trigger"),r.Wb(4,"div",19),r.Wb(5,"div",2),r.Wb(6,"div",20),r.Ec(7,et,1,1,"app-icon",21),r.Ec(8,tt,1,0,"mat-spinner",22),r.Vb(),r.Vb(),r.Wb(9,"div",23),r.Gc(10),r.Vb(),r.Vb(),r.Vb(),r.Ec(11,nt,5,4,"mat-option",24),r.Vb(),r.Vb()}if(2&e){var i=r.ic();r.Cb(1),r.oc("value",i.active_status)("disabled",i.loading),r.Cb(5),r.Dc("background-color",i.loading?"#eee":null==i.status_details?null:i.status_details.colour),r.Cb(1),r.oc("ngIf",!i.loading),r.Cb(1),r.oc("ngIf",i.loading),r.Cb(2),r.Hc(null==i.status_details?null:i.status_details.name),r.Cb(1),r.oc("ngForOf",i.statuses)}}var ot=function(){return{class:"material-icons",content:"local_pizza"}};function at(e,t){if(1&e&&(r.Wb(0,"div",28),r.Wb(1,"div",2),r.Rb(2,"app-icon",3),r.Vb(),r.Wb(3,"div",29),r.Wb(4,"div",30),r.Gc(5),r.Vb(),r.Wb(6,"div",31),r.Gc(7),r.Vb(),r.Vb(),r.Rb(8,"div",14),r.Vb()),2&e){var n=t.$implicit,i=r.ic();r.Gb("not-match",i.search&&!i.search_matches[n.id]),r.Cb(2),r.oc("icon",r.pc(5,ot)),r.Cb(3),r.Hc(n.name),r.Cb(2),r.Ic("x ",n.amount,"")}}var ct,rt=function(){return{class:"material-icons",content:"room_service"}},st=function(){return{class:"material-icons",content:"visibility"}},lt=function(e){return{class:"material-icons",content:e}},bt=((ct=function(){function e(t,n){_classCallCheck(this,e),this._service=t,this._dialog=n,this.statuses=[{id:"accepted",name:"Accepted",icon:{class:"custom-accepted"},colour:"#3996B6"},{id:"preparing",name:"Preparing",icon:{class:"custom-preparing"},colour:"#E7536B"},{id:"ready",name:"Ready",icon:{class:"custom-ready"},colour:"#FFD028"},{id:"delivered",name:"Delivered",icon:{class:"custom-delivered"},colour:"#75BB43"},{id:"cancelled",name:"Cancelled",icon:{class:"custom-cancelled"},colour:"#747474"}]}return _createClass(e,[{key:"ngOnChanges",value:function(e){e.order&&this.order&&(this.active_status=this.order.status)}},{key:"updateStatus",value:function(){return Object(Ce.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.order.booking)){e.next=9;break}return this.loading=!0,(n=_toConsumableArray(t.catering)).splice(n.findIndex((function(e){return e.id===i.order.id})),1,new he.a(Object.assign(Object.assign({},this.order),{status:this.active_status}))),t.storePendingChange("catering",n),e.next=8,t.save().catch((function(e){i._service.notifyError("Error updating order status. Error: ".concat(e.message||e)),i.active_status=i.order.status,i.loading=!1}));case 8:this.loading=!1;case 9:case"end":return e.stop()}}),e,this)})))}},{key:"viewOrderDetails",value:function(){this._dialog.open(He,{maxHeight:"95vh",maxWidth:"95vw",data:{order:this.order,booking:this.order.booking}})}},{key:"search_matches",get:function(){var e=this,t={};return this.order.items.forEach((function(n){var i=(e.search||"").toLowerCase();t[n.id]=n.name.toLowerCase().indexOf(i)>=0})),t}},{key:"status_details",get:function(){var e=this;return this.statuses.find((function(t){return t.id===e.active_status}))||{}}},{key:"space",get:function(){return this._service.Spaces.item(this.order.location_id)}}]),e}()).\u0275fac=function(e){return new(e||ct)(r.Qb(v.a),r.Qb(p.b))},ct.\u0275cmp=r.Kb({type:ct,selectors:[["a-catering-orders-item"]],inputs:{order:"order",search:"search"},features:[r.Ab],decls:23,vars:21,consts:[[1,"order"],[1,"details"],[1,"icon"],[3,"icon"],[1,"time"],[1,"location"],[1,"host"],[1,"package-type"],[4,"ngIf"],[1,"status"],["class","rounded visible","appearance","outline",4,"ngIf"],["mat-icon-button","",3,"tapped"],[1,"more"],[1,"list"],[1,"bar"],["class","item",3,"not-match",4,"ngFor","ngForOf"],["appearance","outline",1,"rounded","visible"],["placeholder","New Order",3,"value","disabled","valueChange"],["select",""],[1,"group"],[1,"wrapper"],[3,"icon",4,"ngIf"],["diameter","16",4,"ngIf"],[1,"text"],[3,"value",4,"ngFor","ngForOf"],["diameter","16"],[3,"value"],[1,"colour"],[1,"item"],[1,"item-details"],[1,"name"],[1,"quanity"]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.Wb(2,"div",2),r.Rb(3,"app-icon",3),r.Vb(),r.Wb(4,"div",4),r.Gc(5),r.Vb(),r.Wb(6,"div",5),r.Gc(7),r.Vb(),r.Wb(8,"div",6),r.Gc(9),r.Vb(),r.Wb(10,"div",7),r.Ec(11,Ke,5,0,"ng-container",8),r.Ec(12,$e,4,0,"ng-container",8),r.Vb(),r.Wb(13,"div",9),r.Ec(14,it,12,8,"mat-form-field",10),r.Vb(),r.Wb(15,"button",11),r.ec("tapped",(function(){return t.viewOrderDetails()})),r.Rb(16,"app-icon",3),r.Vb(),r.Wb(17,"div",12),r.Wb(18,"button",11),r.ec("tapped",(function(){return t.show_items=!t.show_items})),r.Rb(19,"app-icon",3),r.Vb(),r.Vb(),r.Vb(),r.Wb(20,"div",13),r.Rb(21,"div",14),r.Ec(22,at,9,6,"div",15),r.Vb(),r.Vb()),2&e&&(r.Gb("showing",t.show_items||t.search),r.Cb(1),r.Gb("showing",t.show_items)("not-match",t.search),r.Cb(2),r.oc("icon",r.pc(17,rt)),r.Cb(2),r.Hc(t.order.deliver_at_time),r.Cb(2),r.Hc(t.order.location||(null==t.space?null:t.space.name)),r.Cb(2),r.Hc(t.order.booking.organiser.name),r.Cb(2),r.oc("ngIf",t.order.kitchen),r.Cb(1),r.oc("ngIf",t.order.pantry),r.Cb(2),r.oc("ngIf",t.statuses&&t.statuses.length>1),r.Cb(2),r.oc("icon",r.pc(18,st)),r.Cb(3),r.oc("icon",r.qc(19,lt,t.show_items?"keyboard_arrow_down":"keyboard_arrow_right")),r.Cb(1),r.oc("@show",t.show_items||t.search?"show":"hide"),r.Cb(2),r.oc("ngForOf",t.order.items))},directives:[d.a,i.t,u.b,m.c,i.s,b.b,E.a,E.c,C.c,G.g],styles:[".order[_ngcontent-%COMP%], [_nghost-%COMP%]{width:100%;border-bottom:1px solid rgba(0,0,0,.1);background-color:#fff;transition:background-color .2s}.order.showing[_ngcontent-%COMP%], .showing[_nghost-%COMP%]{background-color:#f0f0f0}.details[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5em .25em}.details.showing[_ngcontent-%COMP%]   .more[_ngcontent-%COMP%]{color:#1937ea}.details[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:.5em}.details[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:relative;background-color:#ccc;border:none;z-index:2}.details[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{width:6rem}.details[_ngcontent-%COMP%]   .host[_ngcontent-%COMP%]{width:10rem}.details[_ngcontent-%COMP%]   .package-type[_ngcontent-%COMP%]{width:6.5rem}.details[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{width:11rem}.not-match[_ngcontent-%COMP%]{opacity:.35}.status[_ngcontent-%COMP%]{height:3.5em;padding:0!important;margin-right:.5em}.status[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{border-radius:100%}.status[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:.5em}mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-active[_ngcontent-%COMP%]{color:#1937ea}.group[_ngcontent-%COMP%]{display:flex;align-items:center}.group[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1}.group[_ngcontent-%COMP%]   .colour[_ngcontent-%COMP%]{position:relative;left:-8px;height:8px;width:8px;border-radius:100%;transition:height .2s,width .2s;transform:translateX(50%)}.group[_ngcontent-%COMP%]:hover   .colour[_ngcontent-%COMP%]{height:16px;width:16px}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:1em;width:1em;margin-right:.75em;background-color:none;color:#fff}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{height:1.5em;min-width:1.5em;border-radius:100%;margin-top:4px}.group[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:.8em}.list[_ngcontent-%COMP%]{position:relative;z-index:1}.list[_ngcontent-%COMP%] > .bar[_ngcontent-%COMP%]{position:absolute;background-color:#aaa;width:2px;top:-1em;bottom:1.3em;left:1.7em}.location[_ngcontent-%COMP%]{flex:1;min-width:1em;font-weight:400}.item[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;font-size:.9em;padding-left:3em;margin-bottom:.5em}.item[_ngcontent-%COMP%]:last-child   .item-details[_ngcontent-%COMP%]{border:none}.item[_ngcontent-%COMP%] > .bar[_ngcontent-%COMP%]{position:absolute;background-color:#aaa;height:2px;top:50%;transform:translateY(-50%);left:1.9em;width:.75em;padding:0}.package-type[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#1937ea}.item-details[_ngcontent-%COMP%]{display:flex;align-items:center;flex:1;min-width:50%;border-bottom:1px solid rgba(0,0,0,.1);height:3em;padding-right:4.25em}.item-details[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:.5em .5em .5em 0}.name[_ngcontent-%COMP%]{flex:1;min-width:1em}.icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:2em;width:2em;margin-right:.5em;border-radius:100%;border:2px dotted rgba(0,0,0,.6);color:rgba(0,0,0,.6);font-size:1.5em}"],data:{animation:[Xe.a]}}),ct);function dt(e,t){1&e&&(r.Wb(0,"div",11),r.Rb(1,"mat-progress-bar",12),r.Vb())}function gt(e,t){if(1&e&&r.Rb(0,"a-catering-orders-item",15),2&e){var n=t.$implicit,i=r.ic(2);r.oc("order",n)("search",i.search)}}function ut(e,t){if(1&e&&(r.Ub(0),r.Rb(1,"div",13),r.Ec(2,gt,1,2,"a-catering-orders-item",14),r.Tb()),2&e){var n=r.ic();r.Cb(2),r.oc("ngForOf",n.filtered_orders)("ngForTrackBy",n.trackByFn)}}var mt=function(){return{class:"material-icons",content:"close"}};function ft(e,t){if(1&e&&(r.Wb(0,"div",16),r.Wb(1,"div",2),r.Rb(2,"app-icon",17),r.Vb(),r.Wb(3,"div",18),r.Gc(4),r.Vb(),r.Vb()),2&e){var n=r.ic();r.Cb(2),r.oc("icon",r.pc(2,mt)),r.Cb(2),r.Ic("No catering orders for ",n.date_display,"")}}var pt,ht=((pt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o){var a;return _classCallCheck(this,n),(a=t.call(this))._service=e,a._route=i,a._dialog=o,a.orders=[],a.filtered_orders=[],a.available_spaces=[],a.search$=new le.a,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this._service.Spaces.initialised.pipe(Object(de.a)((function(e){return e}))).subscribe((function(){e.subscription("building",e._service.Organisation.listen("active_building").subscribe((function(){e.search$.next("".concat(e.date,"|").concat(e.building.id)),e.available_spaces=e._service.Spaces.list((function(t){return t.zones.indexOf(e.building.id)>=0})).map((function(e){return e.id}))}))),e.available_spaces=e._service.Spaces.list((function(t){return t.zones.indexOf(e.building.id)>=0})).map((function(e){return e.id})),e.initBookings(),e.interval("update_bookings",(function(){return e.search$.next("".concat(e.date,"|").concat(e.building.id,"|").concat(_e().unix()))}),3e4),e.search$.next("".concat(e.date,"|").concat(e.building.id,"|").concat(_e().unix())),e.subscription("route.query",e._route.queryParamMap.subscribe((function(t){if(t.has("view")){t.get("view");var n=localStorage.getItem("CONCIERGE.view_order"),i=localStorage.getItem("CONCIERGE.view_booking");if(n){var o=new Je.a(e._service.Bookings,JSON.parse(i)),a=new he.a(JSON.parse(n));a.booking=o,e.viewOrderDetails(a),localStorage.removeItem("CONCIERGE.view_order"),localStorage.removeItem("CONCIERGE.view_booking")}}})))}))}},{key:"ngOnChanges",value:function(e){e.date&&this.building&&this.search$.next("".concat(this.date,"|").concat(this.building.id)),e.search&&(this.filtered_orders=this.filter(this.orders,this.search))}},{key:"trackByFn",value:function(e,t){return t?t.id:void 0}},{key:"viewOrderDetails",value:function(e){this._dialog.open(He,{maxHeight:"95vh",maxWidth:"95vw",data:{order:e,booking:e.booking}})}},{key:"filter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=t.toLowerCase();return e.filter((function(e){return e.items.find((function(e){return e.name.toLowerCase().indexOf(n)>=0||e.items&&e.items.find((function(e){return e.name.toLowerCase().indexOf(n)>=0||e.items&&e.items.find((function(e){return e.name.toLowerCase().indexOf(n)>=0}))}))}))}))}},{key:"initBookings",value:function(){var e=this;this.search_results$=this.search$.pipe(Object(ge.a)(100),Object(ue.a)(),Object(me.a)((function(t){e.loading=!0;var n=_e(e.date).startOf("d");return e._service.Spaces.query({zone_ids:e.building.id,available_from:n.unix(),available_to:n.endOf("d").unix()})})),Object(fe.a)((function(e){return Object(be.a)([])})),Object(pe.a)((function(t){var n=[];return t.forEach((function(e){e.bookings.forEach((function(e){e.catering.forEach((function(t){t.booking_date=e.date,t.booking=e})),n=n.concat(e.catering)}))})),(n=(n=Object(ve.m)(n,"id")).filter((function(t){return e.available_spaces.indexOf(t.location_id)>=0}))).sort((function(e,t){return e.booking_date+60*e.delivery_time*1e3-(t.booking_date+60*t.delivery_time*1e3)})),n}))),this.subscription("search_results",this.search_results$.subscribe((function(t){e.loading=!1,e.orders=t,e.filtered_orders=e.filter(t,e.search)})))}},{key:"date_display",get:function(){var e=_e(this.date);return _e().isSame(e,"d")?"Today":e.format("DD MMM YYYY")}},{key:"building",get:function(){return this._service.Organisation.building}}]),n}(c.a)).\u0275fac=function(e){return new(e||pt)(r.Qb(v.a),r.Qb(o.a),r.Qb(p.b))},pt.\u0275cmp=r.Kb({type:pt,selectors:[["a-catering-orders"]],inputs:{search:"search",date:"date"},features:[r.zb,r.Ab],decls:17,vars:3,consts:[["class","loader",4,"ngIf"],[1,"heading"],[1,"icon"],[1,"time"],[1,"location"],[1,"host"],[1,"types"],[1,"state"],[1,"list"],[4,"ngIf","ngIfElse"],["empty_state",""],[1,"loader"],["mode","indeterminate"],[1,"top-row"],[3,"order","search",4,"ngFor","ngForOf","ngForTrackBy"],[3,"order","search"],[1,"info-block","center"],[3,"icon"],[1,"text"]],template:function(e,t){if(1&e&&(r.Ec(0,dt,2,0,"div",0),r.Wb(1,"div",1),r.Rb(2,"div",2),r.Wb(3,"div",3),r.Gc(4,"Time"),r.Vb(),r.Wb(5,"div",4),r.Gc(6,"Location"),r.Vb(),r.Wb(7,"div",5),r.Gc(8,"Host"),r.Vb(),r.Wb(9,"div",6),r.Gc(10,"Package Types"),r.Vb(),r.Wb(11,"div",7),r.Gc(12,"Status"),r.Vb(),r.Vb(),r.Wb(13,"div",8),r.Ec(14,ut,3,2,"ng-container",9),r.Vb(),r.Ec(15,ft,5,3,"ng-template",null,10,r.Fc)),2&e){var n=r.tc(16);r.oc("ngIf",t.loading),r.Cb(14),r.oc("ngIf",t.filtered_orders&&t.filtered_orders.length)("ngIfElse",n)}},directives:[i.t,qe.a,i.s,bt,d.a],styles:["[_nghost-%COMP%]{flex-direction:column;height:100%;font-size:.9em}.heading[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;align-items:center;width:100%}.heading[_ngcontent-%COMP%]{position:relative;font-weight:400;font-size:.8rem;border-bottom:1px solid rgba(0,0,0,.1);z-index:1}.heading[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:.25em 0;text-transform:capitalize}.heading[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:5em}.heading[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{width:6rem}.heading[_ngcontent-%COMP%]   .host[_ngcontent-%COMP%]{width:10rem}.heading[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%]{flex:1}.heading[_ngcontent-%COMP%]   .types[_ngcontent-%COMP%]{width:6.25rem}.heading[_ngcontent-%COMP%]   .state[_ngcontent-%COMP%]{width:17.5rem}.list[_ngcontent-%COMP%]{position:relative;flex:1;min-height:50%;width:100%;overflow:auto}.top-row[_ngcontent-%COMP%]{display:flex;position:-webkit-sticky;position:sticky;align-items:center;top:0;width:100%}.loader[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;height:4px;z-index:999}"]}),pt),vt=function(){return{class:"material-icons",content:"close"}};function _t(e,t){if(1&e){var n=r.Xb();r.Wb(0,"button",13),r.ec("tapped",(function(){return r.wc(n),r.ic(2).search_str=""})),r.Rb(1,"app-icon",14),r.Vb()}2&e&&(r.Cb(1),r.oc("icon",r.pc(1,vt)))}var Ct=function(){return{class:"material-icons",content:"search"}};function yt(e,t){if(1&e){var n=r.Xb();r.Wb(0,"div",8),r.Wb(1,"mat-form-field",9),r.Rb(2,"app-icon",10),r.Wb(3,"input",11),r.ec("ngModelChange",(function(e){return r.wc(n),r.ic().search_str=e})),r.Vb(),r.Ec(4,_t,2,2,"button",12),r.Vb(),r.Vb()}if(2&e){var i=r.ic();r.Cb(1),r.Gb("rounded",!0),r.Cb(1),r.oc("icon",r.pc(5,Ct)),r.Cb(1),r.oc("ngModel",i.search_str),r.Cb(1),r.oc("ngIf",i.search_str)}}function Mt(e,t){if(1&e){var n=r.Xb();r.Wb(0,"button",15),r.ec("tapped",(function(){r.wc(n);var e=r.ic();return e.category=e.category+1})),r.Gc(1,"New Category"),r.Vb()}}function Ot(e,t){if(1&e){var n=r.Xb();r.Wb(0,"button",15),r.ec("tapped",(function(){r.wc(n);var e=r.ic();return e.package=e.package+1})),r.Gc(1,"Add sub-category"),r.Vb()}}function It(e,t){if(1&e){var n=r.Xb();r.Ub(0),r.Wb(1,"a-catering-menu",16),r.ec("length",(function(e){return r.wc(n),r.ic().length=e})),r.Vb(),r.Tb()}if(2&e){var i=r.ic();r.Cb(1),r.oc("search",i.search_str)("category",i.category)("package",i.package)}}function wt(e,t){if(1&e&&(r.Ub(0),r.Rb(1,"a-catering-orders",17),r.Tb()),2&e){var n=r.ic();r.Cb(1),r.oc("date",n.date)("search",n.search_str)}}var kt=function(){return["/catering","menu"]},Wt=function(){return["/catering","orders"]};function Pt(e,t){1&e&&(r.Ub(0),r.Wb(1,"div",18),r.Wb(2,"a",19),r.Wb(3,"div",20),r.Wb(4,"div",21),r.jc(5,"safe"),r.Wb(6,"h2"),r.Gc(7,"Menus and Pricing"),r.Vb(),r.Vb(),r.Wb(8,"div",22),r.Gc(9,"View and edit menus and pricing"),r.Vb(),r.Vb(),r.Vb(),r.Wb(10,"a",19),r.Wb(11,"div",20),r.Wb(12,"div",21),r.jc(13,"safe"),r.Wb(14,"h2"),r.Gc(15,"Catering Orders"),r.Vb(),r.Vb(),r.Wb(16,"div",22),r.Gc(17," View catering orders and their statuses upon arrival "),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Tb()),2&e&&(r.Cb(2),r.oc("routerLink",r.pc(12,kt)),r.Cb(2),r.Dc("background",r.lc(5,6,"linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(assets/img/menus.jpg)","style"),r.Jb),r.Cb(6),r.oc("routerLink",r.pc(13,Wt)),r.Cb(2),r.Dc("background",r.lc(13,9,"linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(assets/img/orders.jpg)","style"),r.Jb))}var xt,Vt=((xt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this))._route=e,i.category=0,i.package=0,i}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.category=0,this.subscription("route.params",this._route.paramMap.subscribe((function(t){t.has("page")&&(e.page=t.get("page"))})))}}]),n}(c.a)).\u0275fac=function(e){return new(e||xt)(r.Qb(o.a))},xt.\u0275cmp=r.Kb({type:xt,selectors:[["app-catering"]],features:[r.zb],decls:12,vars:7,consts:[[1,"catering"],[1,"group"],[3,"date","dateChange"],["class","input-wrapper",4,"ngIf"],["mat-button","",3,"tapped",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"input-wrapper"],["appearance","outline"],["matPrefix","",3,"icon"],["matInput","","name","visitor-name","placeholder","Search...",3,"ngModel","ngModelChange"],["mat-icon-button","","matSuffix","",3,"tapped",4,"ngIf"],["mat-icon-button","","matSuffix","",3,"tapped"],[3,"icon"],["mat-button","",3,"tapped"],[3,"search","category","package","length"],[3,"date","search"],[1,"options"],["mat-button","",1,"card",3,"routerLink"],[1,"content"],[1,"img"],[1,"desc"]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Rb(1,"a-sidebar"),r.Wb(2,"div",1),r.Wb(3,"a-topbar-header",2),r.ec("dateChange",(function(e){return t.date=e})),r.Ec(4,yt,5,6,"div",3),r.Ec(5,Mt,2,0,"button",4),r.Ec(6,Ot,2,0,"button",4),r.Vb(),r.Wb(7,"main"),r.Ub(8,5),r.Ec(9,It,2,3,"ng-container",6),r.Ec(10,wt,2,2,"ng-container",6),r.Ec(11,Pt,18,14,"ng-container",7),r.Tb(),r.Vb(),r.Vb(),r.Vb()),2&e&&(r.Cb(3),r.oc("date",t.date),r.Cb(1),r.oc("ngIf",t.page),r.Cb(1),r.oc("ngIf","menu"===t.page),r.Cb(1),r.oc("ngIf","menu"===t.page&&t.length),r.Cb(2),r.oc("ngSwitch",t.page),r.Cb(1),r.oc("ngSwitchCase","menu"),r.Cb(1),r.oc("ngSwitchCase","orders"))},directives:[s.a,l.a,i.t,i.x,i.y,i.z,b.b,d.a,b.h,g.a,a.c,a.r,a.u,u.b,b.i,m.c,se,ht,u.a,o.f],pipes:[y.b],styles:[".catering[_ngcontent-%COMP%], [_nghost-%COMP%], main[_ngcontent-%COMP%]{height:100%;width:100%}.catering[_ngcontent-%COMP%]{display:flex;height:100%;background-color:#ecf1f5}main[_ngcontent-%COMP%]{position:relative;height:calc(100% - 3.5em)}.group[_ngcontent-%COMP%]{flex:1;min-width:12em}.options[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100%;width:100%}h2[_ngcontent-%COMP%]{font-weight:400}.input-wrapper[_ngcontent-%COMP%]{height:3.5em;padding:0 .5em}.input-wrapper[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.25em}.card[_ngcontent-%COMP%]{padding:0;border:1px solid #ccc;border-radius:4px;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);margin:1em;font-weight:300;background-color:#fff;height:16em;width:24em;overflow:hidden}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{flex-direction:column}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%], .card[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.card[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]{background-position:50%!important;background-size:cover!important;color:#fff;width:100%;height:13em}.card[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:3em;color:rgba(0,0,0,.6)}button[_ngcontent-%COMP%]{margin-right:.5em}"]}),xt),Nt=n("PCNd"),jt=n("aXH1"),Et=n("g+Po"),Gt=function(){return{type:"icon",class:"material-icons",content:"close"}};function St(e,t){1&e&&(r.Wb(0,"button",5),r.Rb(1,"app-icon",6),r.Vb()),2&e&&(r.Cb(1),r.oc("icon",r.pc(1,Gt)))}function Tt(e,t){if(1&e&&(r.Wb(0,"mat-option",31),r.Gc(1),r.Vb()),2&e){var n=t.$implicit;r.oc("value",n.id),r.Cb(1),r.Ic(" ",n.name," ")}}function zt(e,t){if(1&e&&(r.Wb(0,"main"),r.Wb(1,"form",7),r.Wb(2,"div",8),r.Wb(3,"label",9),r.Gc(4,"Parent Category"),r.Vb(),r.Wb(5,"div",10),r.Gc(6),r.Vb(),r.Vb(),r.Wb(7,"div",11),r.Wb(8,"label",9),r.Gc(9,"Name"),r.Wb(10,"span"),r.Gc(11,"*"),r.Vb(),r.Vb(),r.Wb(12,"mat-form-field",12),r.Rb(13,"input",13),r.Wb(14,"mat-error"),r.Gc(15,"A valid name is required"),r.Vb(),r.Vb(),r.Vb(),r.Wb(16,"div",11),r.Wb(17,"label",14),r.Gc(18,"Type"),r.Wb(19,"span"),r.Gc(20,"*"),r.Vb(),r.Vb(),r.Wb(21,"mat-form-field",12),r.Wb(22,"mat-select",15),r.Ec(23,Tt,2,2,"mat-option",16),r.Vb(),r.Wb(24,"mat-error"),r.Gc(25,"Type is required"),r.Vb(),r.Vb(),r.Vb(),r.Wb(26,"div",11),r.Wb(27,"label",17),r.Gc(28,"Description"),r.Vb(),r.Wb(29,"mat-form-field",12),r.Rb(30,"textarea",18),r.Vb(),r.Vb(),r.Wb(31,"div",11),r.Wb(32,"label",19),r.Gc(33,"Allegen Information"),r.Vb(),r.Wb(34,"mat-form-field",12),r.Rb(35,"textarea",20),r.Vb(),r.Vb(),r.Wb(36,"div",8),r.Wb(37,"mat-checkbox",21),r.Gc(38,"Out of Stock"),r.Vb(),r.Vb(),r.Wb(39,"div",8),r.Wb(40,"mat-checkbox",22),r.Gc(41,"Can order anytime"),r.Vb(),r.Vb(),r.Wb(42,"div",11),r.Wb(43,"label",23),r.Gc(44,"Supplier Price"),r.Vb(),r.Wb(45,"mat-form-field",12),r.Rb(46,"input",24),r.Vb(),r.Vb(),r.Wb(47,"div",11),r.Wb(48,"label",25),r.Gc(49,"Unit Price"),r.Vb(),r.Wb(50,"mat-form-field",12),r.Rb(51,"input",26),r.Vb(),r.Vb(),r.Wb(52,"div",11),r.Wb(53,"label",27),r.Gc(54,"Minimum Quanity"),r.Vb(),r.Wb(55,"mat-form-field",12),r.Rb(56,"input",28),r.Vb(),r.Vb(),r.Wb(57,"div",11),r.Wb(58,"label",29),r.Gc(59,"Maximum Quanity"),r.Vb(),r.Wb(60,"mat-form-field",12),r.Rb(61,"input",30),r.Vb(),r.Vb(),r.Vb(),r.Vb()),2&e){var n=r.ic();r.Cb(1),r.oc("formGroup",n.form),r.Cb(5),r.Hc(n.parent.name),r.Cb(2),r.Gb("error",n.form.controls.name.errors&&n.form.controls.name.touched),r.Cb(9),r.Gb("error",n.form.controls.catering_type.errors&&n.form.controls.catering_type.touched),r.Cb(6),r.oc("ngForOf",n.types)}}function Lt(e,t){if(1&e&&(r.Wb(0,"main"),r.Wb(1,"div",32),r.Wb(2,"div",33),r.Rb(3,"mat-spinner",34),r.Vb(),r.Wb(4,"div",35),r.Gc(5),r.Vb(),r.Vb(),r.Vb()),2&e){var n=r.ic();r.Cb(5),r.Hc(n.loading)}}var At,Dt=((At=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o){var a;return _classCallCheck(this,n),(a=t.call(this))._service=e,a._dialog_ref=i,a._data=o,a.event=new r.o,a.types=[{id:"kitchen",name:"Kitchen"},{id:"pantry",name:"Pantry"}],a}return _createClass(n,[{key:"ngOnInit",value:function(){this.form=new a.i({name:new a.f(this.item.name,[a.F.required]),description:new a.f(this.item.description),catering_type:new a.f(this.item.catering_type,[a.F.required]),supplier_cost:new a.f(this.item.supplier_cost),unit_price:new a.f(this.item.unit_price),minimum_quantity:new a.f(this.item.minimum_quantity),maximum_quantity:new a.f(this.item.maximum_quantity),order_anytime:new a.f(this.item.order_anytime),out_of_stock:new a.f(this.item.out_of_stock),allergy:new a.f(this.item.allergy)})}},{key:"submit",value:function(){var e=this;if(this.form.markAllAsTouched(),console.log("Form:",this.form),this.form.valid){var t=new jt.a(Object.assign(Object.assign({},this.item.toJSON()),this.form.value)).toJSON();(this.item.id?this._service.CateringItems.update(this.item.id,t):this._service.CateringItems.add(t)).then((function(t){e.event.emit({reason:"done",metadata:t}),e._dialog_ref.close()}),(function(t){return e._service.notifyError("Error ".concat(e.item.id?"updating":"creating"," item. Error: ").concat(t.message||t))}))}}},{key:"item",get:function(){return this._data.item}},{key:"parent",get:function(){return this._data.parent}}]),n}(c.a)).\u0275fac=function(e){return new(e||At)(r.Qb(v.a),r.Qb(p.h),r.Qb(p.a))},At.\u0275cmp=r.Kb({type:At,selectors:[["a-catering-item-modal"]],outputs:{event:"event"},features:[r.zb],decls:12,vars:5,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close","",4,"ngIf"],[4,"ngIf","ngIfElse"],["mat-button","",3,"disabled","tapped"],["load_state",""],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[3,"formGroup"],[1,"field","padded"],["for","name"],[1,"value"],[1,"field"],["appearance","outline"],["matInput","","name","name","placeholder","Category Name","formControlName","name"],["for","type"],["name","type","formControlName","catering_type","placeholder","Select type"],[3,"value",4,"ngFor","ngForOf"],["for","description"],["matInput","","name","description","placeholder","Category Description","formControlName","description"],["for","allergy"],["matInput","","name","allergy","placeholder","Allergy details about the item","formControlName","allergy"],["formControlName","out_of_stock"],["formControlName","order_anytime"],["for","supplier-price"],["matInput","","name","supplier-price","type","number","placeholder","Price for one unit of the item from the supplier","formControlName","supplier_cost"],["for","unit-price"],["matInput","","name","unit-price","type","number","placeholder","Price for one unit of the item without decimal places","formControlName","unit_price"],["for","min-quanity"],["matInput","","name","min-quanity","type","number","placeholder","Minimum Quantity","formControlName","minimum_quantity"],["for","max-quanity"],["matInput","","name","max-quanity","type","number","placeholder","Maximum Quantity","formControlName","maximum_quantity"],[3,"value"],[1,"info-block"],[1,"icon"],["diameter","32"],[1,"text"]],template:function(e,t){if(1&e&&(r.Wb(0,"header"),r.Wb(1,"div",0),r.Gc(2),r.Vb(),r.Ec(3,St,2,2,"button",1),r.Vb(),r.Wb(4,"mat-dialog-content"),r.Ec(5,zt,62,7,"main",2),r.Vb(),r.Wb(6,"mat-dialog-actions"),r.Wb(7,"footer"),r.Wb(8,"button",3),r.ec("tapped",(function(){return t.submit()})),r.Gc(9,"Save"),r.Vb(),r.Vb(),r.Vb(),r.Ec(10,Lt,6,1,"ng-template",null,4,r.Fc)),2&e){var n=r.tc(11);r.Cb(2),r.Ic("",t.item.id?"Edit":"Add"," catering item"),r.Cb(1),r.oc("ngIf",!t.loading),r.Cb(2),r.oc("ngIf",!t.loading)("ngIfElse",n),r.Cb(3),r.oc("disabled",t.uploading)}},directives:[i.t,p.f,p.c,u.b,m.c,p.d,d.a,a.H,a.s,a.j,b.b,g.a,a.c,a.r,a.h,b.a,E.a,i.s,j.a,a.x,G.g,C.c],styles:[".field[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.field[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.heading[_ngcontent-%COMP%]{flex:1;min-width:50%}main[_ngcontent-%COMP%]{padding:1em;width:24em}label[_ngcontent-%COMP%]{min-width:100%;margin-right:1em;font-weight:700;font-size:.8em;width:100%;margin-top:0;margin-bottom:.5em}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ffb300}label.error[_ngcontent-%COMP%]{color:#e53935}.padded[_ngcontent-%COMP%]{padding:0 0 1em}footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:8em}"]}),At),Rt=n("STbY");function Yt(e,t){if(1&e&&r.Rb(0,"div",21),2&e){var n=r.ic(2);r.Dc("background-image","url("+n.item.image_path+")",r.Jb)}}function Ft(e,t){if(1&e&&(r.Wb(0,"div",22),r.Gc(1),r.jc(2,"currency"),r.Vb()),2&e){var n=r.ic(2);r.Cb(1),r.Ic(" ",r.lc(2,1,n.item.unit_price/100,n.symbol)," ")}}function Ut(e,t){if(1&e&&(r.Wb(0,"div",23),r.Gc(1),r.Vb()),2&e){var n=r.ic(2);r.Cb(1),r.Jc(" Contains ",n.item.items.length," item",1===n.item.items.length?"":"s"," ")}}function Qt(e,t){if(1&e&&(r.Wb(0,"div",23),r.Wb(1,"span",24),r.Gc(2,"Selected "),r.Vb(),r.Gc(3),r.Wb(4,"span",24),r.Gc(5,"ion"),r.Vb(),r.Gc(6),r.Vb()),2&e){var n=r.ic(2);r.Cb(3),r.Ic("",n.item.must_select," opt"),r.Cb(3),r.Ic("",1===n.item.items.length?"":"s"," ")}}function Bt(e,t){if(1&e&&(r.Wb(0,"div",25),r.Gc(1),r.jc(2,"currency"),r.Vb()),2&e){var n=r.ic(2);r.Cb(1),r.Ic(" ",r.lc(2,1,n.item.unit_price/100,n.symbol)," ")}}var Zt=function(){return{class:"material-icons",content:"more_vert"}},Ht=function(e){return{class:"material-icons",content:e}};function Jt(e,t){if(1&e){var n=r.Xb();r.Wb(0,"div",10),r.Ec(1,Yt,1,2,"div",11),r.Wb(2,"div",12),r.Wb(3,"div",13),r.Gc(4),r.Vb(),r.Wb(5,"div",14),r.Gc(6),r.Vb(),r.Wb(7,"div",15),r.Ec(8,Ft,3,4,"div",16),r.Ec(9,Ut,2,2,"div",17),r.Ec(10,Qt,7,2,"div",17),r.Vb(),r.Vb(),r.Ec(11,Bt,3,4,"div",18),r.Wb(12,"button",19),r.Rb(13,"app-icon",7),r.Vb(),r.Wb(14,"button",20),r.ec("tapped",(function(){r.wc(n);var e=r.ic();return e.show_children=!e.show_children})),r.Rb(15,"app-icon",7),r.Vb(),r.Vb()}if(2&e){var i=r.ic(),o=r.tc(4);r.Gb("subitem",i.subitem),r.Cb(1),r.oc("ngIf",!i.subitem),r.Cb(3),r.Hc(i.item.name),r.Cb(2),r.Jc("",i.item.package?"[Package] ":"","",i.item.description,""),r.Cb(2),r.oc("ngIf",i.item.unit_price),r.Cb(1),r.oc("ngIf",i.item.package&&i.item.items.length&&!i.item.must_select),r.Cb(1),r.oc("ngIf",i.item.package&&i.item.must_select&&i.item.amount>0),r.Cb(1),r.oc("ngIf",i.item.unit_price),r.Cb(1),r.oc("matMenuTriggerFor",o),r.Cb(1),r.oc("icon",r.pc(15,Zt)),r.Cb(1),r.Gb("hide",!(i.item.items&&i.item.items.length)),r.Cb(1),r.oc("icon",r.qc(16,Ht,i.show_children?"keyboard_arrow_up":"keyboard_arrow_down"))}}function qt(e,t){if(1&e&&r.Rb(0,"a-catering-menu-item",26),2&e){var n=t.$implicit,i=r.ic();r.oc("subitem",!0)("symbol",i.symbol)("parent",i.item)("item",n)}}var Xt=function(){return{class:"material-icons",content:"add"}};function Kt(e,t){if(1&e){var n=r.Xb();r.Ub(0),r.Wb(1,"button",27),r.Wb(2,"div",28),r.ec("tapped",(function(){return r.wc(n),r.ic().openGroupModal()})),r.Rb(3,"app-icon",7),r.Wb(4,"div",8),r.Gc(5,"Add Group"),r.Vb(),r.Vb(),r.Vb(),r.Wb(6,"button",5),r.ec("tapped",(function(){return r.wc(n),r.ic().openItemModal()})),r.Wb(7,"div",6),r.Rb(8,"app-icon",7),r.Wb(9,"div",8),r.Gc(10,"Add Item"),r.Vb(),r.Vb(),r.Vb(),r.Tb()}2&e&&(r.Cb(3),r.oc("icon",r.pc(2,Xt)),r.Cb(5),r.oc("icon",r.pc(3,Xt)))}var $t,en=function(){return{class:"material-icons",content:"edit"}},tn=function(){return{class:"material-icons",content:"delete"}},nn=(($t=function(){function e(t,n){_classCallCheck(this,e),this._dialog=t,this._service=n}return _createClass(e,[{key:"openGroupModal",value:function(e){e||(e=new f.a({parent_id:this.item.id,zones:[this.building.id]})),this._dialog.open(Q,{data:{group:e,parent:e.id?this.parent:this.item}})}},{key:"openItemModal",value:function(e){e||(e=new jt.a({parent_id:this.item.id})),this._dialog.open(Dt,{data:{item:e,parent:e.id?this.parent:this.item}})}},{key:"deleteItem",value:function(){var e=this.item instanceof Vt?this.item.package?"Package":"Sub-category":"Item",t=this._dialog.open(Et.b,{data:{title:"Delete catering ".concat(e),content:"Are you sure you want to delete the catering ".concat(e,' "').concat(this.item.name,'"?<br />').concat(this.item instanceof f.a?"Any children items or groups will be <strong>immediately</strong> deleted":""),icon:{type:"icon",class:"material-icons",content:"delete"},action:"Ok"}});t.componentInstance.event.subscribe((function(n){"done"===n.reason&&(t.componentInstance.loading="Deleting ".concat(e,"..."))}))}},{key:"has_items",get:function(){return!(!this.item.items||!this.item.items.length)}},{key:"building",get:function(){return this._service.Organisation.building}}]),e}()).\u0275fac=function(e){return new(e||$t)(r.Qb(p.b),r.Qb(v.a))},$t.\u0275cmp=r.Kb({type:$t,selectors:[["a-catering-menu-item"]],inputs:{subitem:"subitem",item:"item",parent:"parent",symbol:"symbol",disabled:"disabled"},decls:16,vars:10,consts:[["class","catering-item",3,"subitem",4,"ngIf"],[1,"children"],[3,"subitem","symbol","parent","item",4,"ngFor","ngForOf"],["appMenu","matMenu"],[4,"ngIf"],["mat-menu-item","",3,"tapped"],[1,"group"],[3,"icon"],[1,"text"],["mat-menu-item","",1,"delete",3,"tapped"],[1,"catering-item"],["class","image",3,"background-image",4,"ngIf"],[1,"details"],[1,"name"],[1,"description"],[1,"options"],["class","option price mobile-only",4,"ngIf"],["class","option",4,"ngIf"],["class","option price not-mobile",4,"ngIf"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-icon-button","",3,"tapped"],[1,"image"],[1,"option","price","mobile-only"],[1,"option"],[1,"not-mobile"],[1,"option","price","not-mobile"],[3,"subitem","symbol","parent","item"],["mat-menu-item",""],[1,"group",3,"tapped"]],template:function(e,t){1&e&&(r.Ec(0,Jt,16,18,"div",0),r.Wb(1,"div",1),r.Ec(2,qt,1,4,"a-catering-menu-item",2),r.Vb(),r.Wb(3,"mat-menu",null,3),r.Ec(5,Kt,11,4,"ng-container",4),r.Wb(6,"button",5),r.ec("tapped",(function(){return t.item.items?t.openGroupModal(t.item):t.openItemModal(t.item)})),r.Wb(7,"div",6),r.Rb(8,"app-icon",7),r.Wb(9,"div",8),r.Gc(10),r.Vb(),r.Vb(),r.Vb(),r.Wb(11,"button",9),r.ec("tapped",(function(){return t.deleteItem()})),r.Wb(12,"div",6),r.Rb(13,"app-icon",7),r.Wb(14,"div",8),r.Gc(15),r.Vb(),r.Vb(),r.Vb(),r.Vb()),2&e&&(r.oc("ngIf",t.item),r.Cb(1),r.oc("@show",t.show_children?"show":"hide"),r.Cb(1),r.oc("ngForOf",t.item.items),r.Cb(3),r.oc("ngIf",t.item.items),r.Cb(3),r.oc("icon",r.pc(8,en)),r.Cb(2),r.Ic("Edit ",t.item.items?t.item.package?"Package":"Sub-category":"item",""),r.Cb(3),r.oc("icon",r.pc(9,tn)),r.Cb(2),r.Ic("Delete ",t.item.items?t.item.package?"Package":"Sub-category":"item",""))},directives:[i.t,i.s,Rt.e,Rt.b,m.c,d.a,u.b,Rt.d,$t],pipes:[i.d],styles:[".catering-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem}.subitem[_ngcontent-%COMP%]{border-top:1px solid #ccc}.name[_ngcontent-%COMP%]{max-width:480px}.image[_ngcontent-%COMP%]{height:3em;width:3em;min-width:3em;border-radius:4px;background-color:rgba(0,0,0,.05);background-position:50%;background-size:cover;border:1px solid rgba(0,0,0,.05)}.details[_ngcontent-%COMP%]{flex:1;min-width:25%;padding:0 .5em;display:flex;flex-direction:column}.details[_ngcontent-%COMP%]   *[_ngcontent-%COMP%] > {white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.options[_ngcontent-%COMP%]{display:flex;align-items:center}.options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;font-size:.8em;height:1.5em;color:rgba(0,0,0,.85);line-height:1em;padding:0 .25em;text-decoration:underline}.option[_ngcontent-%COMP%]{padding:.25em .5em;border-radius:4px;color:#fff;font-size:.8rem;background-color:#1937ea;margin:.25em .4rem .25em 0;white-space:nowrap}.description[_ngcontent-%COMP%]{font-size:.75em;margin-top:.25em}.children[_ngcontent-%COMP%]{font-size:.9em;background-color:rgba(0,0,0,.05)}.group[_ngcontent-%COMP%]{display:flex;align-items:center}.hide[_ngcontent-%COMP%]{opacity:0;pointer-events:none}.delete[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{color:#e53935}"],data:{animation:[Xe.a]}}),$t),on=n("Nuht"),an=n("DWOX"),cn=n("YoI9"),rn=n("4Uey"),sn=n("q/nq"),ln=n("4kJo"),bn=n("A+eD"),dn=n("4Man"),gn=n("vJ8U"),un=n("1k4r"),mn=n("9Kh7"),fn=n("5fZw"),pn=n("WE8N"),hn=n("1DiH"),vn=n("CTJb"),_n=n("opQU"),Cn=n("zx1i"),yn=n("019G"),Mn=n("cH1L"),On=n("dNgK"),In=n("ihCf"),wn=n("/1cH"),kn=n("A5z7"),Wn=n("Qu3c"),Pn=n("QibW"),xn=n("1jcm"),Vn=n("vxfF"),Nn=n("5+WD"),jn=n("f6nW");n.d(t,"CateringModule",(function(){return Sn}));var En,Gn=[{path:"",component:Vt},{path:":page",component:Vt},{path:"**",redirectTo:""}],Sn=((En=function e(){_classCallCheck(this,e)}).\u0275mod=r.Ob({type:En}),En.\u0275inj=r.Nb({factory:function(e){return new(e||En)},imports:[[i.c,a.l,a.B,o.g.forChild(Gn),Nt.a]]}),En);r.zc(X,[i.q,i.r,i.s,i.t,i.A,i.w,i.x,i.y,i.z,i.u,i.v,a.H,a.w,a.G,a.c,a.x,a.A,a.a,a.D,a.E,a.z,a.r,a.s,a.C,a.n,a.m,a.y,a.b,a.d,a.u,a.v,a.t,a.g,a.j,a.h,a.k,a.e,o.h,o.d,o.f,o.e,o.i,m.b,m.c,on.a,c.a,an.a,d.a,cn.a,l.a,rn.a,sn.a,ln.a,bn.a,dn.a,gn.a,un.a,s.a,mn.a,fn.a,pn.a,hn.a,vn.a,_n.a,Cn.a,yn.a,u.b,u.a,Mn.b,On.b,p.e,p.d,p.i,p.f,p.c,b.a,b.b,b.e,b.f,b.g,b.h,b.i,In.b,In.c,g.a,g.c,C.a,C.c,qe.a,wn.a,G.g,G.f,wn.d,wn.c,E.a,E.c,kn.d,kn.a,kn.c,kn.e,kn.b,kn.f,G.j,Rt.e,Rt.b,Rt.d,Rt.a,j.a,j.c,Wn.a,Wn.c,Pn.b,Pn.a,N.c,N.d,N.a,N.f,N.e,N.b,xn.c,xn.a,Vn.a,Vn.b,Vn.c,Vn.d,Nn.e,Nn.f,Nn.a,Nn.b,Nn.d,Nn.c,jn.o,jn.n,jn.b,jn.c,jn.j,jn.f,jn.d,jn.a,jn.m,jn.i,jn.e,jn.k,jn.l,jn.g,jn.h,jn.r,jn.t,jn.s,jn.q,Vt,ht,se,X,nn,V,Q,Dt,bt,He,Ee,Oe,Re],[i.b,i.G,i.p,i.k,i.E,i.g,i.C,i.F,i.d,i.f,i.i,i.j,i.l,y.b,y.c])}}]);