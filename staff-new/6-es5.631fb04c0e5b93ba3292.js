function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{cmhh:function(e,t,n){"use strict";n.r(t);var i=n("ofXK"),o=n("tyNb"),a=n("3Pt+"),r=n("IhUT"),c=n("OaWH"),s=n("IWZj"),u=n("fXoL");function l(e,t){1&e&&u.Rb(0,"booking-desk-flow")}function d(e,t){1&e&&u.Rb(0,"booking-space-flow")}var f,m=((f=function(e){function t(e,n,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._service=e,o._route=n,o._router=i,o}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){var e=this;this._service.title="Book",this.subscription("route.params",this._route.paramMap.subscribe((function(t){t.has("flow")&&(e.flow=t.get("flow"))}))),this.subscription("router.events",this._router.events.subscribe((function(e){e instanceof o.c&&e.url.indexOf("book")<0&&localStorage.removeItem("ACA_STAFF.booking_form_data")})))}}]),t}(s.a)).\u0275fac=function(e){return new(e||f)(u.Qb(c.a),u.Qb(o.a),u.Qb(o.d))},f.\u0275cmp=u.Kb({type:f,selectors:[["app-bookings"]],features:[u.zb],decls:10,vars:4,consts:[[1,"booking","page"],[1,"header"],[3,"menu","menuChange"],[1,"body"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"footer"],[3,"show","showChange"]],template:function(e,t){1&e&&(u.Wb(0,"div",0),u.Wb(1,"header",1),u.Wb(2,"a-topbar-header",2),u.ec("menuChange",(function(e){return t.show_menu=e})),u.Vb(),u.Vb(),u.Wb(3,"main",3),u.Ub(4,4),u.Ec(5,l,1,0,"booking-desk-flow",5),u.Ec(6,d,1,0,"booking-space-flow",6),u.Tb(),u.Vb(),u.Wb(7,"footer",7),u.Rb(8,"a-footer-menu"),u.Vb(),u.Vb(),u.Wb(9,"a-overlay-menu",8),u.ec("showChange",(function(e){return t.show_menu=e})),u.Vb()),2&e&&(u.Cb(2),u.oc("menu",t.show_menu),u.Cb(2),u.oc("ngSwitch",t.flow),u.Cb(1),u.oc("ngSwitchCase","desks"),u.Cb(4),u.oc("show",t.show_menu))},styles:[".page[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;flex-direction:column}.page[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.body[_ngcontent-%COMP%]{min-width:50%;min-height:50%;flex:1}"]}),f),h=n("PCNd"),b=n("xhdr"),g=n("5RMF"),p=n("Ofvs"),v=n("SxV6"),_=n("0IaG"),y=n("Wgwc"),C=n("wZkO"),w=n("bTqV"),O=n("0njA"),k=n("m6yr"),x=n("kmnG"),P=n("qFsG");function M(e,t){if(1&e&&u.Rb(0,"mat-tab",11),2&e){var n=t.$implicit,i=u.ic();u.oc("label",n.name+(i.form[n.id].invalid&&i.form[n.id].touched?"*":""))}}function V(e,t){1&e&&(u.Wb(0,"span"),u.Gc(1,"*"),u.Vb())}function W(e,t){if(1&e&&(u.Wb(0,"form",12),u.Wb(1,"div",13),u.Wb(2,"label",14),u.Gc(3,"(eg - particular room configurations or specific equipment etc) Additional requests are handled in confidence"),u.Vb(),u.Wb(4,"mat-form-field",15),u.Rb(5,"textarea",16),u.Vb(),u.Vb(),u.Wb(6,"div",17),u.Wb(7,"div",13),u.Wb(8,"label",18),u.Gc(9,"Charge Code"),u.Ec(10,V,2,0,"span",19),u.Vb(),u.Wb(11,"mat-form-field",15),u.Rb(12,"input",20),u.Wb(13,"mat-hint"),u.Wb(14,"span"),u.Gc(15,"Note:"),u.Vb(),u.Gc(16," Your booking will be confirmed before you are charged."),u.Vb(),u.Wb(17,"mat-error"),u.Gc(18,"Charge Code is required"),u.Vb(),u.Vb(),u.Vb(),u.Wb(19,"div",13),u.Wb(20,"label",21),u.Gc(21,"Headcount Estimate"),u.Wb(22,"span"),u.Gc(23,"*"),u.Vb(),u.Vb(),u.Wb(24,"mat-form-field",15),u.Rb(25,"input",22),u.Wb(26,"mat-hint"),u.Wb(27,"span"),u.Gc(28,"Note:"),u.Vb(),u.Gc(29," This estimate is used to calculate catering and/or assign rooms. Please keep updated of any changes."),u.Vb(),u.Wb(30,"mat-error"),u.Gc(31,"Headcount Estimate is required"),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&e){var n=u.ic();u.oc("formGroup",n.active_form),u.Cb(8),u.Gb("error",n.active_form.controls.code.touched&&n.active_form.controls.code.invalid),u.Cb(2),u.oc("ngIf",n.needs_charge_code[n.space_list[n.active_space].id]),u.Cb(10),u.Gb("error",n.active_form.controls.head_count.touched&&n.active_form.controls.head_count.invalid)}}var I,z=function(){return{class:"material-icons",content:"close"}},E=((I=function(){function e(t,n){_classCallCheck(this,e),this._service=t,this._data=n,this.event=new u.n,this.notes={},this.codes={},this.head_counts={},this.form={},this.needs_charge_code={},this.active_space=0}return _createClass(e,[{key:"ngOnInit",value:function(){var e=(this._data.notes_field.value||[]).filter((function(e){return"equipment"===e.type}));this.notes=e.reduce((function(e,t){return e[t.space]=t.message,e}),{}),this.codes=Object.assign({},this._data.codes_field.value||{}),this.head_counts=Object.assign({},this._data.head_counts_field.value||{}),this.generateFormFields()}},{key:"submit",value:function(){var e=this;if(this.space_list.forEach((function(t){return e.form[t.id].markAllAsTouched()})),this.is_valid){var t=(this._data.notes_field.value||[]).filter((function(e){return"equipment"!==e.type})),n=this.space_list.map((function(t){return{author:e._service.Users.current.name,type:"equipment",message:e.form[t.id].controls.notes.value,space:t.id,date:y().valueOf()}}));this._data.notes_field.setValue(t.concat(n).filter((function(e){return e.message}))),this._data.codes_field.setValue(this.space_list.reduce((function(t,n){return t[n.id]=e.form[n.id].controls.code.value,t}),{})),this._data.head_counts_field.setValue(this.space_list.reduce((function(t,n){return t[n.id]=e.form[n.id].controls.head_count.value,t}),{})),this.event.emit({reason:"done"})}}},{key:"generateFormFields",value:function(){var e=this,t=!0,n=!1,i=void 0;try{for(var o,r=function(){var t=o.value,n=e._service.Organisation.buildings.find((function(e){return e.id===t.level.building_id}));e.needs_charge_code[t.id]=n.required.equipment_code,e.form[t.id]=new a.i({notes:new a.f(e.notes[t.id]||""),code:new a.f(e.codes[t.id]||"",n.required.equipment_code?[a.F.required]:[]),head_count:new a.f(e.head_counts[t.id]||"",[a.F.required])})},c=this.space_list[Symbol.iterator]();!(t=(o=c.next()).done);t=!0)r()}catch(s){n=!0,i=s}finally{try{t||null==c.return||c.return()}finally{if(n)throw i}}}},{key:"space_list",get:function(){return this._data.spaces||[]}},{key:"active_form",get:function(){return this.form[this.space_list[this.active_space].id]}},{key:"is_valid",get:function(){var e=this;return this.space_list.reduce((function(t,n){return t&&e.form[n.id].valid}),!0)}}]),e}()).\u0275fac=function(e){return new(e||I)(u.Qb(c.a),u.Qb(_.a))},I.\u0275cmp=u.Kb({type:I,selectors:[["a-requirement-details-modal"]],outputs:{event:"event"},decls:17,vars:5,consts:[[1,"header"],[1,"tabs"],[3,"selectedIndex","selectedIndexChange"],[3,"label",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"details"],["src","assets/img/equipment.svg"],[1,"text"],[3,"formGroup",4,"ngIf"],["mat-button","",3,"tapped"],[3,"label"],[3,"formGroup"],[1,"field"],["for","equipment-notes"],["appearance","outline"],["matInput","","name","equipment-notes","formControlName","notes","placeholder","Add notes here..."],[1,"fieldset"],["for","charge-code"],[4,"ngIf"],["matInput","","name","charge-code","formControlName","code","placeholder","Charge Code"],["for","head-count"],["matInput","","name","head-count","formControlName","head_count","type","number","placeholder","e.g. 12"]],template:function(e,t){1&e&&(u.Wb(0,"div",0),u.Wb(1,"div",1),u.Wb(2,"mat-tab-group",2),u.ec("selectedIndexChange",(function(e){return t.active_space=e})),u.Ec(3,M,1,1,"mat-tab",3),u.Vb(),u.Vb(),u.Wb(4,"button",4),u.Rb(5,"app-icon",5),u.Vb(),u.Vb(),u.Wb(6,"mat-dialog-content"),u.Wb(7,"main"),u.Wb(8,"div",6),u.Rb(9,"img",7),u.Wb(10,"div",8),u.Gc(11,"Would you like to add equipment to your booking's spaces?"),u.Vb(),u.Vb(),u.Ec(12,W,32,6,"form",9),u.Vb(),u.Vb(),u.Wb(13,"mat-dialog-actions"),u.Wb(14,"footer"),u.Wb(15,"button",10),u.ec("tapped",(function(){return t.submit()})),u.Gc(16,"Add to booking"),u.Vb(),u.Vb(),u.Vb()),2&e&&(u.Cb(2),u.oc("selectedIndex",t.active_space),u.Cb(1),u.oc("ngForOf",t.space_list),u.Cb(2),u.oc("icon",u.pc(4,z)),u.Cb(7),u.oc("ngIf",t.space_list[t.active_space]&&t.active_form))},directives:[C.c,i.s,w.b,_.d,O.a,_.f,i.t,_.c,k.c,C.a,a.H,a.s,a.j,x.b,P.a,a.c,a.r,a.h,x.e,x.a,a.x],styles:[".header[_ngcontent-%COMP%]{display:flex;align-items:center;border-bottom:1px solid #ccc;width:100%}.header[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{min-width:50%;flex:1}.details[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;text-align:center;margin-bottom:1em}main[_ngcontent-%COMP%]{padding:1em 1em 0;min-height:36em}label[_ngcontent-%COMP%]{min-width:100%;margin-right:1em;font-weight:700;font-size:.8em;width:100%;margin-top:0;margin-bottom:.5em}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ffb300}label.error[_ngcontent-%COMP%]{color:#e53935}mat-form-field[_ngcontent-%COMP%]{flex:1}mat-tab[_ngcontent-%COMP%]{display:none!important}.field[_ngcontent-%COMP%]{display:flex;min-width:14em;flex:1;flex-wrap:wrap}mat-hint[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#1937ea}mat-form-field[_ngcontent-%COMP%]{margin-bottom:.75em}textarea[_ngcontent-%COMP%]{min-height:7em}.fieldset[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0 .25em}@media only screen and (orientation:portrait) and (max-width:450px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0}}@media only screen and (orientation:landscape) and (max-width:800px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0}}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:first-child{margin-left:0}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:last-child{margin-right:0}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),I),j=n("7c/B");function G(e,t){if(1&e&&u.Rb(0,"mat-tab",11),2&e){var n=t.$implicit,i=u.ic();u.oc("label",n.name+(i.form[n.id].invalid&&i.form[n.id].touched?"*":""))}}function F(e,t){1&e&&(u.Wb(0,"span"),u.Gc(1,"*"),u.Vb())}function D(e,t){if(1&e&&(u.Wb(0,"form",12),u.Wb(1,"div",13),u.Wb(2,"label",14),u.Gc(3,"(eg - allergies, in tolerances, no ice in drinks etc) Additional requests are handled in confidence."),u.Vb(),u.Wb(4,"mat-form-field",15),u.Rb(5,"textarea",16),u.Vb(),u.Vb(),u.Wb(6,"div",13),u.Wb(7,"label",17),u.Gc(8,"Charge Code"),u.Ec(9,F,2,0,"span",18),u.Vb(),u.Wb(10,"mat-form-field",15),u.Rb(11,"input",19),u.Wb(12,"mat-error"),u.Gc(13,"Charge Code is required"),u.Vb(),u.Wb(14,"mat-hint"),u.Wb(15,"span"),u.Gc(16,"Note:"),u.Vb(),u.Gc(17," Your booking will be confirmed before you are charged."),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&e){var n=u.ic();u.oc("formGroup",n.active_form),u.Cb(7),u.Gb("error",n.active_form.controls.code.touched&&n.active_form.controls.code.invalid),u.Cb(2),u.oc("ngIf",n.needs_charge_code[n.space_list[n.active_space].id])}}var S,q=function(){return{class:"material-icons",content:"close"}},A=((S=function(){function e(t,n){_classCallCheck(this,e),this._service=t,this._data=n,this.event=new u.n,this.notes={},this.codes={},this.head_counts={},this.form={},this.needs_charge_code={},this.active_space=0}return _createClass(e,[{key:"ngOnInit",value:function(){var e=(this._data.notes_field.value||[]).filter((function(e){return"catering"===e.type}));this.notes=e.reduce((function(e,t){return e[t.space]=t.message,e}),{}),this.codes=(this._data.catering.value||[]).reduce((function(e,t){return e[t.location_id]=t.charge_code,e}),{}),this.generateFormFields()}},{key:"submit",value:function(){var e=this;if(this.space_list.forEach((function(t){return e.form[t.id].markAllAsTouched()})),this.is_valid){var t=(this._data.notes_field.value||[]).filter((function(e){return"catering"!==e.type})),n=this.space_list.map((function(t){return{author:e._service.Users.current.name,type:"catering",message:e.form[t.id].controls.notes.value,space:t.id,date:y().valueOf()}}));this._data.notes_field.setValue(t.concat(n).filter((function(e){return e.message})));var i=(this._data.catering.value||[]).map((function(t){return new j.a(Object.assign(Object.assign({},t),{charge_code:e.form[t.location_id].controls.code.value}))}));this._data.catering.setValue(i),this.event.emit({reason:"done"})}}},{key:"generateFormFields",value:function(){var e=this,t=!0,n=!1,i=void 0;try{for(var o,r=function(){var t=o.value,n=e._service.Organisation.buildings.find((function(e){return e.id===t.level.building_id}));e.needs_charge_code[t.id]=n.required.equipment_code,e.form[t.id]=new a.i({notes:new a.f(e.notes[t.id]||""),code:new a.f(e.codes[t.id]||"",n.required.equipment_code?[a.F.required]:[])})},c=this.space_list[Symbol.iterator]();!(t=(o=c.next()).done);t=!0)r()}catch(s){n=!0,i=s}finally{try{t||null==c.return||c.return()}finally{if(n)throw i}}}},{key:"space_list",get:function(){return this._data.spaces||[]}},{key:"active_form",get:function(){return this.form[this.space_list[this.active_space].id]}},{key:"is_valid",get:function(){var e=this;return this.space_list.reduce((function(t,n){return t&&e.form[n.id].valid}),!0)}}]),e}()).\u0275fac=function(e){return new(e||S)(u.Qb(c.a),u.Qb(_.a))},S.\u0275cmp=u.Kb({type:S,selectors:[["a-catering-details-modal"]],outputs:{event:"event"},decls:17,vars:5,consts:[[1,"header"],[1,"tabs"],[3,"selectedIndex","selectedIndexChange"],[3,"label",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"details"],["src","assets/img/food-notes.svg"],[1,"text"],[3,"formGroup",4,"ngIf"],["mat-button","",3,"tapped"],[3,"label"],[3,"formGroup"],[1,"field"],["for","equipment-notes"],["appearance","outline"],["matInput","","name","equipment-notes","formControlName","notes","placeholder","Add notes here..."],["for","charge-code"],[4,"ngIf"],["matInput","","name","charge-code","formControlName","code","placeholder","Charge Code"]],template:function(e,t){1&e&&(u.Wb(0,"div",0),u.Wb(1,"div",1),u.Wb(2,"mat-tab-group",2),u.ec("selectedIndexChange",(function(e){return t.active_space=e})),u.Ec(3,G,1,1,"mat-tab",3),u.Vb(),u.Vb(),u.Wb(4,"button",4),u.Rb(5,"app-icon",5),u.Vb(),u.Vb(),u.Wb(6,"mat-dialog-content"),u.Wb(7,"main"),u.Wb(8,"div",6),u.Rb(9,"img",7),u.Wb(10,"div",8),u.Gc(11,"Please specify any allergies or gluten intolerances"),u.Vb(),u.Vb(),u.Ec(12,D,18,4,"form",9),u.Vb(),u.Vb(),u.Wb(13,"mat-dialog-actions"),u.Wb(14,"footer"),u.Wb(15,"button",10),u.ec("tapped",(function(){return t.submit()})),u.Gc(16,"Add to booking"),u.Vb(),u.Vb(),u.Vb()),2&e&&(u.Cb(2),u.oc("selectedIndex",t.active_space),u.Cb(1),u.oc("ngForOf",t.space_list),u.Cb(2),u.oc("icon",u.pc(4,q)),u.Cb(7),u.oc("ngIf",t.space_list[t.active_space]&&t.active_form))},directives:[C.c,i.s,w.b,_.d,O.a,_.f,i.t,_.c,k.c,C.a,a.H,a.s,a.j,x.b,P.a,a.c,a.r,a.h,x.a,x.e],styles:[".header[_ngcontent-%COMP%]{display:flex;align-items:center;border-bottom:1px solid #ccc;width:100%}.header[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{min-width:50%;flex:1}.details[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;text-align:center;margin-bottom:1em}main[_ngcontent-%COMP%]{padding:1em 1em 0}mat-hint[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#1937ea}label[_ngcontent-%COMP%]{min-width:100%;margin-right:1em;font-weight:700;font-size:.8em;width:100%;margin-top:0;margin-bottom:.5em}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ffb300}label.error[_ngcontent-%COMP%]{color:#e53935}mat-form-field[_ngcontent-%COMP%]{flex:1}mat-tab[_ngcontent-%COMP%]{display:none!important}.field[_ngcontent-%COMP%]{display:flex;min-width:14em;flex:1;flex-wrap:wrap}textarea[_ngcontent-%COMP%]{min-height:7em}.fieldset[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0 .25em}@media only screen and (orientation:portrait) and (max-width:450px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0}}@media only screen and (orientation:landscape) and (max-width:800px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0}}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:first-child{margin-left:0}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:last-child{margin-right:0}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),S),T=n("Kj3r"),N=n("/uUt"),R=n("eIep"),$=n("JIr8"),H=n("lJxs"),Q=n("XNiG"),U=n("LRne"),Y=n("YxBP"),L=n("CbDI"),B=n("bSwM"),X=n("A5z7");function K(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div",14),u.Wb(1,"mat-checkbox",15),u.ec("change",(function(e){u.wc(n);var i=t.$implicit,o=u.ic(2);return e.checked?o.addLocationFilter(i):o.removeLocationFilter(i)})),u.Wb(2,"div",16),u.Wb(3,"div",17),u.Gc(4),u.Vb(),u.Wb(5,"div",18),u.Gc(6),u.Vb(),u.Wb(7,"div",19),u.Gc(8),u.Vb(),u.Vb(),u.Vb(),u.Vb()}if(2&e){var i=t.$implicit;u.Cb(4),u.Hc(i.code),u.Cb(2),u.Hc(i.name),u.Cb(2),u.Hc(i.address)}}var Z=function(){return{type:"icon",class:"material-icons",content:"close"}};function J(e,t){if(1&e){var n=u.Xb();u.Wb(0,"mat-chip",23),u.ec("removed",(function(){u.wc(n);var e=t.$implicit;return u.ic(3).removeLocationFilter(e)})),u.Gc(1),u.Rb(2,"app-icon",24),u.Vb()}if(2&e){var i=t.$implicit;u.oc("id",i.id)("removable",!0),u.Cb(1),u.Ic(" ",i.name," "),u.Cb(1),u.oc("icon",u.pc(4,Z))}}function ee(e,t){if(1&e&&(u.Wb(0,"div",20),u.Wb(1,"mat-chip-list",21),u.Ec(2,J,3,5,"mat-chip",22),u.Vb(),u.Vb()),2&e){var n=u.ic(2);u.Cb(2),u.oc("ngForOf",n.location_list)}}var te=function(){return{class:"material-icons",content:"keyboard_arrow_left"}},ne=function(){return{class:"material-icons",content:"keyboard_arrow_right"}},ie=function(e){return{class:"material-icons",content:e}};function oe(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div",1),u.Wb(1,"div",2),u.Wb(2,"div",3),u.Wb(3,"button",4),u.ec("tapped",(function(){return u.wc(n),u.ic().changeDate(-1)})),u.Rb(4,"app-icon",5),u.Vb(),u.Wb(5,"div",6),u.Gc(6),u.Vb(),u.Wb(7,"button",7),u.ec("tapped",(function(){return u.wc(n),u.ic().changeDate(1)})),u.Rb(8,"app-icon",5),u.Vb(),u.Vb(),u.Wb(9,"div",8),u.Wb(10,"div",9),u.ec("tapped",(function(){u.wc(n);var e=u.ic();return e.show_locations=!e.show_locations})),u.Rb(11,"img",10),u.Wb(12,"div",6),u.Gc(13,"Select locations(s)"),u.Vb(),u.Rb(14,"app-icon",5),u.Vb(),u.Wb(15,"div",11),u.Ec(16,K,9,3,"div",12),u.Vb(),u.Vb(),u.Vb(),u.Ec(17,ee,3,1,"div",13),u.Vb()}if(2&e){var i=u.ic();u.Cb(3),u.oc("disabled",i.is_today),u.Cb(1),u.oc("icon",u.pc(8,te)),u.Cb(2),u.Hc(i.date_display),u.Cb(2),u.oc("icon",u.pc(9,ne)),u.Cb(6),u.oc("icon",u.qc(10,ie,"keyboard_arrow_"+(i.show_locations?"up":"down"))),u.Cb(1),u.oc("@show",i.show_locations?"show":"hide"),u.Cb(1),u.oc("ngForOf",i.building_list),u.Cb(1),u.oc("ngIf",i.location_list&&i.location_list.length)}}var ae,re=((ae=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._service=e,n.locations=[],n.locationsChange=new u.n,n}return _inherits(t,e),_createClass(t,[{key:"changeDate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=y(this.date.value).add(e,"d"),n=y().startOf("m");t.isBefore(n,"s")&&(t=n),this.date.setValue(t.valueOf())}},{key:"ngOnInit",value:function(){var e=this;this.building_list=this._service.Organisation.buildings,this.building_list&&this.building_list.length||this.timeout("init",(function(){return e.ngOnInit()}),300)}},{key:"addLocationFilter",value:function(e){this.locations||(this.locations=[]),this.locations.push(e.id),this.locations=Object(Y.k)(this.locations),this.locationsChange.emit(this.locations)}},{key:"removeLocationFilter",value:function(e){this.locations&&(this.locations.splice(this.locations.findIndex((function(t){return e.id===t})),1),this.locationsChange.emit(this.locations))}},{key:"is_today",get:function(){var e=y(this.date.value);return y().isSame(e,"d")}},{key:"date_display",get:function(){var e=y(this.date.value);return this.is_today?"Today":e.format("DD MMM YYYY")}},{key:"location_list",get:function(){var e=this;return(this.locations||[]).map((function(t){return e.building_list.find((function(e){return e.id===t}))}))}}]),t}(s.a)).\u0275fac=function(e){return new(e||ae)(u.Qb(c.a))},ae.\u0275cmp=u.Kb({type:ae,selectors:[["booking-space-filters"]],inputs:{date:"date",locations:"locations"},outputs:{locationsChange:"locationsChange"},features:[u.zb],decls:1,vars:1,consts:[["class","space-filters",4,"ngIf"],[1,"space-filters"],[1,"actions"],[1,"date"],["mat-icon-button","",3,"disabled","tapped"],[3,"icon"],[1,"text"],["mat-icon-button","",3,"tapped"],[1,"location-list"],[1,"inner",3,"tapped"],["src","assets/img/location-img.svg"],[1,"list"],["class","item",4,"ngFor","ngForOf"],["class","filters",4,"ngIf"],[1,"item"],[3,"change"],[1,"building-name"],[1,"code"],[1,"name"],[1,"address"],[1,"filters"],["aria-label","Location Filters"],["color","primary",3,"id","removable","removed",4,"ngFor","ngForOf"],["color","primary",3,"id","removable","removed"],["matChipRemove","",3,"icon"]],template:function(e,t){1&e&&u.Ec(0,oe,18,12,"div",0),2&e&&u.oc("ngIf",t.date)},directives:[i.t,w.b,k.c,O.a,i.s,B.a,X.d,X.a,X.e],styles:[".space-filters[_ngcontent-%COMP%]{width:100%}.actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;padding:1em}@media only screen and (orientation:portrait) and (max-width:450px){.actions[_ngcontent-%COMP%]{padding:.5em}}@media only screen and (orientation:landscape) and (max-width:800px){.actions[_ngcontent-%COMP%]{padding:.5em}}.actions[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:0 .5em}.date[_ngcontent-%COMP%]{display:flex;align-items:center;border:1px solid #1937ea;height:2.5em;overflow:hidden}@media only screen and (orientation:portrait) and (max-width:450px){.date[_ngcontent-%COMP%]{margin-bottom:.5em!important}}@media only screen and (orientation:landscape) and (max-width:800px){.date[_ngcontent-%COMP%]{margin-bottom:.5em!important}}.date[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0;color:#1937ea;background-color:rgba(25,55,234,.1);height:2.5em;width:2.5em;margin:0}.date[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{background-color:#f0f0f0;color:rgba(0,0,0,.35)}.date[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;border-left:1px solid #1937ea;border-right:1px solid #1937ea;width:8em;height:100%}.location-list[_ngcontent-%COMP%]{position:relative;border:1px solid #ccc;width:24em}.location-list[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]{position:relative;overflow:hidden;display:flex;align-items:center;height:2.5em}.location-list[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.5em}.location-list[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:-10px;left:-10px}.location-list[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1;min-width:50%;margin-left:3em;padding:0 1em}.location-list[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{position:absolute;bottom:0;transform:translateY(100%);background-color:#41485b;color:#fff;width:24em;max-height:25em;overflow:hidden auto;z-index:999;max-width:100%}.location-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{margin:.5em;width:24em}.filters[_ngcontent-%COMP%]{padding:0 1em 1em;margin:0 auto;max-width:720px;width:100%}@media only screen and (orientation:portrait) and (max-width:450px){.filters[_ngcontent-%COMP%]{padding-bottom:.5em}}@media only screen and (orientation:landscape) and (max-width:800px){.filters[_ngcontent-%COMP%]{padding-bottom:.5em}}.building-name[_ngcontent-%COMP%]{display:flex;align-items:center}.building-name[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{width:4em}.building-name[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:8em}.building-name[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{flex:1;min-width:6em;max-width:50vw;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:.2em!important}.mat-menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:0 1em}.mat-menu-item[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.2em}.mat-menu-item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1;min-width:50%;margin-left:.5em;padding-right:2em}.mat-chip.mat-standard-chip[_ngcontent-%COMP%]   .mat-chip-remove[_ngcontent-%COMP%]{color:hsla(0,0%,100%,.85)}"],data:{animation:[L.a]}}),ae),ce=n("vxfF"),se=(n("KsZa"),n("ceWj")),ue=n("daPb");function le(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div",6),u.Wb(1,"div",7),u.Gc(2),u.Vb(),u.Wb(3,"div",8),u.Wb(4,"button",9),u.ec("tapped",(function(){u.wc(n);var e=t.$implicit;return u.ic().selectSpace(e)})),u.Wb(5,"div",10),u.Gc(6),u.Vb(),u.Vb(),u.Vb(),u.Vb()}if(2&e){var i=t.$implicit,o=u.ic();u.Cb(2),u.Hc(i.date_string),u.Cb(2),u.Gb("inverse",!i.available&&!i.replaced_by),u.Cb(2),u.Ic(" ",i.replaced_by||(i.available?o.space.name:"Find Room")," ")}}var de,fe=function(){return{type:"icon",class:"material-icons",content:"close"}},me=((de=function(e){function t(e,n,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._data=e,o._dialog=n,o._service=i,o.event=new u.n,o.occurrences=[],o.space_details=[],o}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){this.space_details=[].concat(this._data.conflicts||[]),this.updateOccurrences()}},{key:"save",value:function(){this.event.emit({reason:"done",metadata:this.space_details})}},{key:"selectSpace",value:function(e){var t=this,n=this._dialog.open(ue.a,{width:"auto",height:"auto",maxWidth:"95vw",data:{spaces:[],zone_ids:this.space.level.building_id,date:1e3*e.date,duration:this._data.duration,host:this._data.host,multiple:!1}});this.subscription("new_spaces",n.componentInstance.event.subscribe((function(i){if("done"===i.reason){var o=i.metadata[0];o&&(console.log("Space:",o),t.space_details.unshift({date:e.date,space:o.email,replaces:t.space.email}),t.space_details=Object(Y.k)(t.space_details,"date")),t.updateOccurrences(),n.close(),t.unsub("new_spaces")}})))}},{key:"updateOccurrences",value:function(){var e=this;this.occurrences=this._data.space.recurr_available.map((function(t){var n=e.space_details.find((function(n){return n.date===t.date&&n.replaces===e.space.email})),i=(n||{}).space,o=e._service.Spaces.item(i)||{email:i,name:i};return console.log("Space:",n,o),Object.assign(Object.assign({},t),{date_string:y(1e3*t.date).format("dddd, DD MMMM YYYY"),replaced_by:o.name})})),console.log("Occurrences:",this.occurrences)}},{key:"space",get:function(){return this._data.space}},{key:"occurrences_valid",get:function(){return this.occurrences.reduce((function(e,t){return e&&(t.available||!!t.replaced_by)}),!0)}}]),t}(s.a)).\u0275fac=function(e){return new(e||de)(u.Qb(_.a),u.Qb(_.b),u.Qb(c.a))},de.\u0275cmp=u.Kb({type:de,selectors:[["a-recurrence-spaces-modal"]],outputs:{event:"event"},features:[u.zb],decls:14,vars:5,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"info"],["class","item",4,"ngFor","ngForOf"],["mat-button","",3,"disabled","tapped"],[1,"item"],[1,"date"],[1,"action"],["mat-button","",3,"tapped"],[1,"content"]],template:function(e,t){1&e&&(u.Wb(0,"header"),u.Wb(1,"div",0),u.Gc(2),u.Vb(),u.Wb(3,"button",1),u.Rb(4,"app-icon",2),u.Vb(),u.Vb(),u.Wb(5,"mat-dialog-content"),u.Wb(6,"main"),u.Wb(7,"div",3),u.Gc(8," * Select individual dates to update selected space "),u.Vb(),u.Ec(9,le,7,4,"div",4),u.Vb(),u.Vb(),u.Wb(10,"mat-dialog-actions"),u.Wb(11,"footer"),u.Wb(12,"button",5),u.ec("tapped",(function(){return t.save()})),u.Gc(13,"Add to Booking"),u.Vb(),u.Vb(),u.Vb()),2&e&&(u.Cb(2),u.Ic("Recurrence - ",t.space.name,""),u.Cb(2),u.oc("icon",u.pc(4,fe)),u.Cb(5),u.oc("ngForOf",t.occurrences),u.Cb(3),u.oc("disabled",!t.occurrences_valid))},directives:[w.b,_.d,O.a,_.f,i.s,_.c,k.c],styles:[".heading[_ngcontent-%COMP%]{flex:1}.item[_ngcontent-%COMP%], main[_ngcontent-%COMP%]{padding:.5em}.item[_ngcontent-%COMP%]{display:flex;align-items:center}.item[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{flex:1;margin-right:1em}.item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:13em}.item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{width:10.5em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.info[_ngcontent-%COMP%]{font-size:.8em;color:#1937ea;margin-bottom:1em;font-style:italic}.info[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{text-align:center}footer[_ngcontent-%COMP%]{width:100%}"]}),de);function he(e,t){if(1&e&&u.Rb(0,"div",14),2&e){var n=u.ic(2);u.Dc("background-image","url("+n.space.image+")",u.Jb)}}function be(e,t){if(1&e&&(u.Wb(0,"div",15),u.Gc(1," Available for\xa0"),u.Wb(2,"span"),u.Gc(3),u.Vb(),u.Gc(4,"\xa0meeting ocurrences "),u.Vb()),2&e){var n=u.ic(2);u.Cb(3),u.Hc(n.availability)}}var ge=function(){return{type:"icon",class:"material-icons",content:"account_circle"}};function pe(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div",1),u.Wb(1,"div",2),u.Ec(2,he,1,2,"div",3),u.Rb(3,"div",4),u.Wb(4,"div",5),u.Gc(5),u.Vb(),u.Wb(6,"div",6),u.Wb(7,"div",7),u.Gc(8),u.Vb(),u.Wb(9,"div",8),u.Rb(10,"app-icon",9),u.Gc(11),u.Vb(),u.Vb(),u.Ec(12,be,5,1,"div",10),u.Vb(),u.Wb(13,"div",11),u.Wb(14,"button",12),u.ec("tapped",(function(){return u.wc(n),u.ic().selectSpace()})),u.Gc(15),u.Vb(),u.Wb(16,"button",13),u.ec("tapped",(function(){return u.wc(n),u.ic().locate()})),u.Gc(17,"Map"),u.Vb(),u.Vb(),u.Vb()}if(2&e){var i=u.ic();u.Gb("with-image",i.show_image),u.Cb(2),u.oc("ngIf",i.space.image),u.Cb(3),u.Hc(i.space.name),u.Cb(3),u.Hc(i.location),u.Cb(2),u.oc("icon",u.pc(13,ge)),u.Cb(1),u.Ic(" ",i.space.capacity||"0"," "),u.Cb(1),u.oc("ngIf",i.space.recurr_available&&i.space.recurr_available.length),u.Cb(2),u.Gb("inverse",i.multi&&!i.selected)("request",i.is_request),u.Cb(1),u.Ic(" ",i.multi?i.selected?"Remove":"Select":i.is_request?"Request":"Book"," ")}}var ve,_e=((ve=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._service=e,i._dialog=n,i.select=new u.n,i}return _inherits(t,e),_createClass(t,[{key:"locate",value:function(){this._dialog.open(se.a,{width:"auto",height:"auto",maxWidth:"95vw",maxHeight:"95vh",data:{space:this.space}})}},{key:"selectSpace",value:function(){var e=this;if(!this.space.recurr_available||"all"===this.availability||this.selected)this.select.emit();else{var t=this._dialog.open(me,{width:"auto",height:"auto",maxWidth:"95vw",maxHeight:"95vh",data:{space:this.space,duration:this.form.controls.duration.value,host:this.form.controls.organiser.value,conflicts:this.form.controls.recurrence.value.conflicts||[]}});this.subscription("recurr_conflicts",t.componentInstance.event.subscribe((function(n){if("done"===n.reason){var i=e.form.controls.recurrence.value,o=i.conflicts||[],a=!0,r=!1,c=void 0;try{for(var s,u=function(){var e=s.value,t=o.findIndex((function(t){return t.date===e.date&&t.replaces===e.replaces}));t>=0?o.splice(t,1,e):o.push(e)},l=n.metadata[Symbol.iterator]();!(a=(s=l.next()).done);a=!0)u()}catch(d){r=!0,c=d}finally{try{a||null==l.return||l.return()}finally{if(r)throw c}}e.form.controls.recurrence.setValue(Object.assign(Object.assign({},i),{conflicts:o})),e.select.emit(),t.close()}})))}}},{key:"show_image",get:function(){return this._service.setting("app.space_display.show_images")}},{key:"selected",get:function(){var e=this;return!(!this.form&&this.space)&&this.form.controls.space_list&&!!(this.form.controls.space_list.value||[]).find((function(t){return t.id===e.space.id}))}},{key:"is_request",get:function(){return!!this.form&&this.space.byRequest({date:this.form.controls.date.value,duration:this.form.controls.duration.value,host:this.form.controls.organiser.value||this._service.Users.current})}},{key:"availability",get:function(){var e=this.space.recurr_available.reduce((function(e,t){return e+(t.available?1:0)}),0);return e>=this.space.recurr_available.length?"all":"".concat(e," of ").concat(this.space.recurr_available.length)}},{key:"location",get:function(){if(!this.space)return"Unable to determine location";var e=this.space.level,t=this._service.Organisation.buildings.find((function(t){return t.id===e.building_id}));return"".concat(t?t.name+", ":"").concat(e.name)}}]),t}(s.a)).\u0275fac=function(e){return new(e||ve)(u.Qb(c.a),u.Qb(_.b))},ve.\u0275cmp=u.Kb({type:ve,selectors:[["a-booking-space-item"]],inputs:{space:"space",form:"form",multi:"multi"},outputs:{select:"select"},features:[u.zb],decls:1,vars:1,consts:[["class","space-details",3,"with-image",4,"ngIf"],[1,"space-details"],[1,"details"],["class","image",3,"background-image",4,"ngIf"],[1,"overlay"],[1,"name"],[1,"info"],[1,"location"],[1,"capacity"],[3,"icon"],["class","info recurr",4,"ngIf"],[1,"actions"],["mat-button","",3,"tapped"],["mat-button","",1,"inverse",3,"tapped"],[1,"image"],[1,"info","recurr"]],template:function(e,t){1&e&&u.Ec(0,pe,18,14,"div",0),2&e&&u.oc("ngIf",t.space)},directives:[i.t,O.a,w.b,k.c],styles:[".space-details[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;width:720px;max-width:calc(100vw - 1em);background-color:#fff;flex-wrap:wrap;border-radius:0;overflow:hidden;transition:box-shadow .2s,top .2s;top:0;margin:.5em auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.space-details[_ngcontent-%COMP%]:hover{box-shadow:0 1px 3px 2px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);top:-2px}.space-details[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:none}.with-image[_ngcontent-%COMP%]{padding-top:0;width:480px}.with-image[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:initial;background-color:rgba(0,0,0,.65);color:#fff;transition:opacity .2s}.with-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.with-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{overflow:hidden;background-position:50%;background-size:cover}.with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{-webkit-filter:drop-shadow(0 0 2px #000);filter:drop-shadow(0 0 2px black);color:#fff}.with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{opacity:0}.with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{position:relative;height:6em;width:24em;margin:0 auto 0 0;max-width:24em;overflow:hidden;height:12em}.with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{transition:-webkit-filter .2s;transition:filter .2s;transition:filter .2s,-webkit-filter .2s}.with-image[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;bottom:2em;color:#fff}.with-image[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{position:absolute;bottom:1em;color:hsla(0,0%,100%,.65);width:calc(100% - 2em)}.details[_ngcontent-%COMP%]{flex:1;min-width:50%;padding:1em;min-width:99%}.info[_ngcontent-%COMP%]{display:flex;align-items:center;color:rgba(0,0,0,.65)}.name[_ngcontent-%COMP%]{font-size:1.2em}.location[_ngcontent-%COMP%]{font-size:.8em;flex:1;min-width:50%}.capacity[_ngcontent-%COMP%]{display:flex;align-items:center}.recurr[_ngcontent-%COMP%]{color:#1937ea;font-size:.8em}.recurr[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-decoration:underline}.actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;flex:1}button[_ngcontent-%COMP%]{min-width:12em;flex:1;margin:0;border-radius:0}button.request[_ngcontent-%COMP%]{color:#fff;background-color:#ffb300;border-color:#ffb300}button.request.inverse[_ngcontent-%COMP%]{color:#ffb300;background-color:#fff}"]}),ve),ye=n("Xa2L");function Ce(e,t){if(1&e){var n=u.Xb();u.Ub(0),u.Wb(1,"a-booking-space-item",14),u.ec("select",(function(){u.wc(n);var e=t.$implicit;return u.ic(3).selectSpace(e)})),u.Vb(),u.Tb()}if(2&e){var i=t.$implicit,o=u.ic(3);u.Cb(1),u.oc("form",o.form)("space",i)("multi",o.multiple)}}function we(e,t){if(1&e&&(u.Wb(0,"cdk-virtual-scroll-viewport",12),u.Ec(1,Ce,2,3,"ng-container",13),u.Vb()),2&e){var n=u.ic(2);u.oc("itemSize",n.item_size),u.Cb(1),u.oc("cdkVirtualForOf",n.space_list)}}function Oe(e,t){if(1&e&&(u.Ub(0),u.Ec(1,we,2,2,"cdk-virtual-scroll-viewport",11),u.Tb()),2&e){var n=u.ic(),i=u.tc(13);u.Cb(1),u.oc("ngIf",n.space_list&&n.space_list.length)("ngIfElse",i)}}function ke(e,t){if(1&e){var n=u.Xb();u.Wb(0,"button",15),u.ec("tapped",(function(){return u.wc(n),u.ic().next()})),u.Gc(1," Next "),u.Vb()}if(2&e){var i=u.ic();u.oc("disabled",!i.spaces.value||!i.spaces.value.length)}}function xe(e,t){1&e&&(u.Wb(0,"div",16),u.Wb(1,"div",17),u.Wb(2,"div",18),u.Rb(3,"mat-spinner",19),u.Vb(),u.Wb(4,"div",20),u.Gc(5,"Check space availability..."),u.Vb(),u.Vb(),u.Vb())}var Pe=function(){return{class:"material-icons",content:"close"}};function Me(e,t){1&e&&(u.Wb(0,"div",16),u.Wb(1,"div",17),u.Wb(2,"div",18),u.Rb(3,"app-icon",21),u.Vb(),u.Wb(4,"div",20),u.Gc(5,"No spaces available for the selected time"),u.Vb(),u.Vb(),u.Vb()),2&e&&(u.Cb(3),u.oc("icon",u.pc(1,Pe)))}var Ve,We,Ie=((Ve=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._service=e,n.event=new u.n,n.space_list=[],n.change$=new Q.a,n}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){var e=this;if(!this._service.is_initialised&&this._service.Spaces.list().length)return this.timeout("init",(function(){return e.ngOnInit()}));this.search_results$=this.change$.pipe(Object(T.a)(400),Object(N.a)(),Object(R.a)((function(t){e.loading=!0;var n=e.form.controls.recurrence?e.form.controls.recurrence.value:null,i=n&&n.period&&"None"!==n.period?{recurr_period:(n.period||"").toLowerCase(),recurr_end:y(n.end).unix()}:{},o=Object.assign({date:e.form.controls.date.value,duration:e.form.controls.duration.value,zone_ids:e._service.Organisation.building.id,bookable:!0},i);return e.zone_ids&&e.zone_ids.length&&(o.zone_ids=e.zone_ids.join(",")),e._service.Spaces.available(o)})),Object($.a)((function(e){return console.error(e),Object(U.a)([])})),Object(H.a)((function(t){return e.loading=!1,t}))),this.subscription("search_results",this.search_results$.subscribe((function(t){return e.space_list=t}))),this.change$.next("")}},{key:"ngOnChanges",value:function(e){var t=this;e.form&&(this.form.controls.date&&this.subscription("date_field",this.form.controls.date.valueChanges.subscribe((function(e){return t.change$.next(e)}))),this.form.controls.duration&&this.subscription("duration_field",this.form.controls.duration.valueChanges.subscribe((function(e){return t.change$.next(e)}))))}},{key:"selectSpace",value:function(e){if(this.multiple){var t=this.spaces.value||[],n=t.find((function(t){return t.id===e.id}));this.spaces.setValue(n?t.filter((function(t){return t.id!==e.id})):t.concat([e]))}else this.spaces.setValue([e]),this.event.emit({type:"next",step:"search"})}},{key:"next",value:function(){this.event.emit({type:"next",step:"search"})}},{key:"previous",value:function(){this.event.emit({type:"previous",step:"search"})}},{key:"item_size",get:function(){return window,window,window,130}},{key:"multiple",get:function(){return this._service.setting("app.booking.multiple_spaces")}}]),t}(s.a)).\u0275fac=function(e){return new(e||Ve)(u.Qb(c.a))},Ve.\u0275cmp=u.Kb({type:Ve,selectors:[["booking-find-space"]],inputs:{spaces:"spaces",form:"form"},outputs:{event:"event"},features:[u.zb,u.Ab],decls:14,vars:5,consts:[[1,"find-space"],[1,"background"],[1,"header"],[3,"date","locations","locationsChange"],[4,"ngIf","ngIfElse"],[1,"footer"],[1,"box"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"disabled","tapped",4,"ngIf"],["load_state",""],["empty_state",""],[3,"itemSize",4,"ngIf","ngIfElse"],[3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf"],[3,"form","space","multi","select"],["mat-button","",3,"disabled","tapped"],[1,"body"],[1,"info-block","center"],[1,"icon"],["diameter","48"],[1,"text"],[3,"icon"]],template:function(e,t){if(1&e&&(u.Wb(0,"div",0),u.Rb(1,"div",1),u.Wb(2,"div",2),u.Wb(3,"booking-space-filters",3),u.ec("locationsChange",(function(e){return t.zone_ids=e}))("locationsChange",(function(e){return t.change$.next(e)})),u.Vb(),u.Vb(),u.Ec(4,Oe,2,2,"ng-container",4),u.Wb(5,"div",5),u.Wb(6,"div",6),u.Wb(7,"button",7),u.ec("tapped",(function(){return t.previous()})),u.Gc(8,"Back"),u.Vb(),u.Ec(9,ke,2,1,"button",8),u.Vb(),u.Vb(),u.Vb(),u.Ec(10,xe,6,0,"ng-template",null,9,u.Fc),u.Ec(12,Me,6,2,"ng-template",null,10,u.Fc)),2&e){var n=u.tc(11);u.Cb(3),u.oc("date",t.form.controls.date)("locations",t.zone_ids),u.Cb(1),u.oc("ngIf",!t.loading)("ngIfElse",n),u.Cb(5),u.oc("ngIf",t.multiple)}},directives:[re,i.t,w.b,k.c,ce.d,ce.a,ce.c,_e,ye.c,O.a],styles:[".find-space[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;flex-direction:column;height:100%;width:100%;max-height:calc(100vh - 7.5em);overflow:hidden}@media only screen and (orientation:portrait) and (max-width:450px){.find-space[_ngcontent-%COMP%]{max-height:calc(100vh - 6.5em)}}@media only screen and (orientation:landscape) and (max-width:800px){.find-space[_ngcontent-%COMP%]{max-height:calc(100vh - 6.5em)}}.header[_ngcontent-%COMP%]{position:relative;z-index:999;width:100%;max-width:100vw;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}@media only screen and (orientation:portrait) and (max-width:450px){.header[_ngcontent-%COMP%]{border-radius:0}}@media only screen and (orientation:landscape) and (max-width:800px){.header[_ngcontent-%COMP%]{border-radius:0}}.body[_ngcontent-%COMP%], cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{position:relative;width:100%;flex:1;min-height:50%}.box[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;max-width:100vw;background-color:#fff;padding:.5em;margin:auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);border-top:1px solid #ccc}.box[_ngcontent-%COMP%], .footer[_ngcontent-%COMP%]{width:100%}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:0 .5em}.background[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:50%;transform:translateX(-50%);width:768px;max-width:100vw}.info-block[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:2.5em;width:2.5em}"]}),Ve),ze=function(){return{class:"material-icons",content:"edit"}},Ee=function(){return{class:"material-icons",content:"delete"}},je=((We=function(){function e(t){_classCallCheck(this,e),this._service=t,this.edit=new u.n,this.delete=new u.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"space",get:function(){if(!this.order)return"<No Location>";var e=this._service.Spaces.item(this.order.location_id);return(e?e.name:"")||"<No Location>"}},{key:"delivery_time",get:function(){return this.order?y(this.order.booking_date).add((this.order.changes||{}).delivery_time||this.order.delivery_time,"m").format("h:mm A"):"<Meeting Start>"}},{key:"order_cost",get:function(){return((this.order?this.order.items:null)||[]).reduce((function(e,t){return e+t.amount*t.unit_price}),0)}},{key:"item_count",get:function(){return((this.order?this.order.items:null)||[]).reduce((function(e,t){return e+t.amount}),0)}},{key:"symbol",get:function(){var e=this._service.Spaces.item(this.order.location_id);if(!e||!e.level)return"USD";var t=this._service.Organisation.buildings.find((function(t){return t.id===e.level.building_id}));return t?t.currency:"USD"}}]),e}()).\u0275fac=function(e){return new(e||We)(u.Qb(c.a))},We.\u0275cmp=u.Kb({type:We,selectors:[["catering-order-list-item"]],inputs:{order:"order",date:"date"},outputs:{edit:"edit",delete:"delete"},decls:18,vars:12,consts:[[1,"details"],[1,"group"],[1,"cost"],[1,"actions"],["mat-icon-button","",3,"tapped"],[3,"icon"],["mat-icon-button","",1,"inverse",3,"tapped"]],template:function(e,t){1&e&&(u.Wb(0,"div",0),u.Gc(1," Deliver to "),u.Wb(2,"span"),u.Gc(3),u.Vb(),u.Gc(4," at "),u.Wb(5,"span"),u.Gc(6),u.Vb(),u.Vb(),u.Wb(7,"div",1),u.Wb(8,"div",2),u.Gc(9),u.Vb(),u.Wb(10,"div",2),u.Gc(11),u.jc(12,"currency"),u.Vb(),u.Vb(),u.Wb(13,"div",3),u.Wb(14,"button",4),u.ec("tapped",(function(){return t.edit.emit()})),u.Rb(15,"app-icon",5),u.Vb(),u.Wb(16,"button",6),u.ec("tapped",(function(){return t.delete.emit()})),u.Rb(17,"app-icon",5),u.Vb(),u.Vb()),2&e&&(u.Cb(3),u.Hc(t.space),u.Cb(3),u.Hc(t.delivery_time),u.Cb(3),u.Jc("",t.item_count," item",1===t.item_count?"":"s",""),u.Cb(2),u.Hc(u.lc(12,7,t.order_cost/100,t.symbol)),u.Cb(4),u.oc("icon",u.pc(10,ze)),u.Cb(2),u.oc("icon",u.pc(11,Ee)))},directives:[w.b,k.c,O.a],pipes:[i.d],styles:["[_nghost-%COMP%]{display:flex;align-items:center;padding:.25em;margin:.25em;border-radius:4px}.details[_ngcontent-%COMP%]{flex:1;padding:.5em}.details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:400}.cost[_ngcontent-%COMP%]{padding:.25em .5em;border-radius:4px;font-size:.8rem;margin:.25em .4rem .25em 0;white-space:nowrap;text-align:center}.cost[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{color:#fff;background-color:#1937ea}button[_ngcontent-%COMP%]{margin:.25em}button.inverse[_ngcontent-%COMP%]{background-color:#fff;color:#e53935;border:1px solid #e53935}"]}),We);function Ge(e,t){if(1&e){var n=u.Xb();u.Wb(0,"catering-order-list-item",10),u.ec("edit",(function(){u.wc(n);var e=t.$implicit;return u.ic(2).editOrder(e)}))("delete",(function(){u.wc(n);var e=t.$implicit;return u.ic(2).deleteOrder(e)})),u.Vb()}if(2&e){var i=t.$implicit,o=u.ic(2);u.oc("order",i)("date",o.date)}}function Fe(e,t){if(1&e){var n=u.Xb();u.Ub(0),u.Wb(1,"div",8),u.Ec(2,Ge,1,2,"catering-order-list-item",9),u.Vb(),u.Wb(3,"button",6),u.ec("tapped",(function(){return u.wc(n),u.ic().newOrder()})),u.Gc(4,"Add Order"),u.Vb(),u.Tb()}if(2&e){var i=u.ic();u.Cb(2),u.oc("ngForOf",i.orders)}}var De=function(){return{class:"material-icons",content:"close"}};function Se(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div",11),u.Wb(1,"div",12),u.Rb(2,"app-icon",13),u.Vb(),u.Wb(3,"div",14),u.Gc(4,"No catering orders"),u.Vb(),u.Wb(5,"button",6),u.ec("tapped",(function(){return u.wc(n),u.ic().newOrder()})),u.Gc(6,"Add Order"),u.Vb(),u.Vb()}2&e&&(u.Cb(2),u.oc("icon",u.pc(1,De)))}var qe,Ae=((qe=function(){function e(){_classCallCheck(this,e),this.event=new u.n,this.order=new u.n}return _createClass(e,[{key:"newOrder",value:function(){this.order.emit()}},{key:"editOrder",value:function(e){this.order.emit(e)}},{key:"deleteOrder",value:function(e){var t=this.orders,n=t.findIndex((function(t){return e.id===t.id}));n>=0&&(t.splice(n,1),this.catering.setValue(t))}},{key:"next",value:function(){this.event.emit({type:"next",step:"catering"})}},{key:"previous",value:function(){this.event.emit({type:"previous",step:"catering"})}},{key:"orders",get:function(){var e=this;if(!this.catering)return[];var t=this.catering.value||[];return t.forEach((function(t){return t.booking_date=e.all_day?y(e.date).startOf("d").valueOf():e.date})),t}}]),e}()).\u0275fac=function(e){return new(e||qe)},qe.\u0275cmp=u.Kb({type:qe,selectors:[["a-catering-order-list"]],inputs:{catering:"catering",date:"date",all_day:"all_day"},outputs:{event:"event",order:"order"},decls:13,vars:2,consts:[[1,"catering","order-list"],[1,"header"],[1,"body"],[4,"ngIf","ngIfElse"],[1,"footer"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"tapped"],["empty_state",""],[1,"list"],[3,"order","date","edit","delete",4,"ngFor","ngForOf"],[3,"order","date","edit","delete"],[1,"info-block","center"],[1,"icon"],[3,"icon"],[1,"text"]],template:function(e,t){if(1&e&&(u.Wb(0,"div",0),u.Wb(1,"div",1),u.Wb(2,"h3"),u.Gc(3,"Catering Orders"),u.Vb(),u.Vb(),u.Wb(4,"div",2),u.Ec(5,Fe,5,1,"ng-container",3),u.Vb(),u.Wb(6,"div",4),u.Wb(7,"button",5),u.ec("tapped",(function(){return t.previous()})),u.Gc(8,"Back"),u.Vb(),u.Wb(9,"button",6),u.ec("tapped",(function(){return t.next()})),u.Gc(10,"Next"),u.Vb(),u.Vb(),u.Vb(),u.Ec(11,Se,7,2,"ng-template",null,7,u.Fc)),2&e){var n=u.tc(12);u.Cb(5),u.oc("ngIf",t.orders&&t.orders.length)("ngIfElse",n)}},directives:[i.t,w.b,k.c,i.s,je,O.a],styles:["[_nghost-%COMP%]{height:100%}.order-list[_ngcontent-%COMP%]{flex-direction:column;height:100%;width:768px;margin:auto;max-width:100vw;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.body[_ngcontent-%COMP%], .order-list[_ngcontent-%COMP%]{display:flex;align-items:center}.body[_ngcontent-%COMP%]{position:relative;flex-direction:column;flex:1;width:100%;min-height:50%;overflow:auto}.body[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:8em}.list[_ngcontent-%COMP%]{width:100%}.list[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{border:1px solid #ccc}.list[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.05)}.footer[_ngcontent-%COMP%]{width:100%;text-align:center;border-top:1px solid #ccc}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:.5em}.info-block[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:1em}"]}),qe),Te=n("IRj4"),Ne=n("aXH1"),Re=n("QibW");function $e(e,t){1&e&&u.Sb(0)}function He(e,t){if(1&e){var n=u.Xb();u.Wb(0,"mat-checkbox",11),u.ec("change",(function(e){u.wc(n);var t=u.ic(2).$implicit,i=u.ic(2).package;return u.ic().updateAmount(i,t,e.checked)})),u.Gc(1),u.Vb()}if(2&e){var i=u.ic(2).$implicit;u.oc("checked",!!i.amount),u.Cb(1),u.Ic(" ",i.name," ")}}function Qe(e,t){if(1&e){var n=u.Xb();u.Wb(0,"mat-radio-button",12),u.ec("change",(function(e){u.wc(n);var t=u.ic(2).$implicit,i=u.ic(2).package;return u.ic().updateAmount(i,t,e.value===t.id)})),u.Gc(1),u.Vb()}if(2&e){var i=u.ic(2).$implicit;u.oc("value",i.id),u.Cb(1),u.Ic(" ",i.name," ")}}function Ue(e,t){if(1&e&&(u.Ub(0),u.Ec(1,He,2,2,"mat-checkbox",9),u.Ec(2,Qe,2,2,"mat-radio-button",10),u.Tb()),2&e){var n=u.ic(3).package;u.Cb(1),u.oc("ngIf",n.must_select>1),u.Cb(1),u.oc("ngIf",1===n.must_select)}}function Ye(e,t){if(1&e&&(u.Ub(0),u.Gc(1),u.Tb()),2&e){var n=u.ic().$implicit;u.Cb(1),u.Ic(" ",n.name," ")}}function Le(e,t){1&e&&u.Sb(0)}var Be=function(e){return{package:e}};function Xe(e,t){if(1&e&&(u.Wb(0,"div",8),u.Ec(1,Ue,3,2,"ng-container",5),u.Ec(2,Ye,2,1,"ng-container",5),u.Ec(3,Le,1,0,"ng-container",2),u.Vb()),2&e){var n=t.$implicit,i=u.ic(2).package;u.ic();var o=u.tc(13);u.Db("to-select",n.must_select),u.Cb(1),u.oc("ngIf",i.must_select&&i.must_select<i.items.length&&!n.must_select),u.Cb(1),u.oc("ngIf",i.must_select>=i.items.length||n.must_select),u.Cb(1),u.oc("ngTemplateOutlet",o)("ngTemplateOutletContext",u.qc(5,Be,n))}}function Ke(e,t){if(1&e&&(u.Ub(0),u.Wb(1,"mat-radio-group",6),u.Ec(2,Xe,4,7,"div",7),u.Vb(),u.Tb()),2&e){var n=u.ic().package,i=u.ic();u.Cb(1),u.oc("ngModel",i.active_items[n.id]),u.Cb(1),u.oc("ngForOf",n.items)}}function Ze(e,t){if(1&e&&u.Ec(0,Ke,3,2,"ng-container",5),2&e){var n=t.package;u.oc("ngIf",n.items&&n.items.length)}}var Je,et=function(){return{class:"material-icons",content:"close"}},tt=((Je=function(){function e(t){_classCallCheck(this,e),this._data=t,this.event=new u.n}return _createClass(e,[{key:"ngOnInit",value:function(){this.item=this._data.item}},{key:"updateAmount",value:function(e,t,n){if(n){var i=e.must_select;e.items.filter((function(e){return e.amount>0})).length>=i&&e.items.find((function(e){return e.amount>0})).setAmount(0),t.setAmount(1)}else t.setAmount(0)}},{key:"requirements_met",get:function(){return function e(t){var n=t.items||[];return t.must_select>=n.length?n.reduce((function(t,n){return t&&e(n)}),!0):n.reduce((function(e,t){return e+t.amount?1:0}),0)===t.must_select}(this.item)}},{key:"active_items",get:function(){return function e(t){var n={};if(t.items){var i=t.items.find((function(e){return e.amount>0}));i&&(n[t.id]=i.id),t.items.forEach((function(t){return n=Object.assign(Object.assign({},n),e(t))}))}return n}(this.item)}}]),e}()).\u0275fac=function(e){return new(e||Je)(u.Qb(_.a))},Je.\u0275cmp=u.Kb({type:Je,selectors:[["a-package-options-modal"]],outputs:{event:"event"},decls:14,vars:7,consts:[["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["mat-button","",3,"disabled","tapped"],["item_display",""],[4,"ngIf"],[3,"ngModel"],["class","item",4,"ngFor","ngForOf"],[1,"item"],[3,"checked","change",4,"ngIf"],[3,"value","change",4,"ngIf"],[3,"checked","change"],[3,"value","change"]],template:function(e,t){if(1&e&&(u.Wb(0,"header"),u.Wb(1,"h3"),u.Gc(2,"Package Options"),u.Vb(),u.Wb(3,"button",0),u.Rb(4,"app-icon",1),u.Vb(),u.Vb(),u.Wb(5,"mat-dialog-content"),u.Wb(6,"main"),u.Ec(7,$e,1,0,"ng-container",2),u.Vb(),u.Vb(),u.Wb(8,"mat-dialog-actions"),u.Wb(9,"footer"),u.Wb(10,"button",3),u.ec("tapped",(function(){return t.event.emit({reason:"done"})})),u.Gc(11," Confirm Options "),u.Vb(),u.Vb(),u.Vb(),u.Ec(12,Ze,1,1,"ng-template",null,4,u.Fc)),2&e){var n=u.tc(13);u.Cb(4),u.oc("icon",u.pc(4,et)),u.Cb(3),u.oc("ngTemplateOutlet",n)("ngTemplateOutletContext",u.qc(5,Be,t.item)),u.Cb(3),u.oc("disabled",!t.requirements_met)}},directives:[w.b,_.d,O.a,_.f,i.A,_.c,k.c,i.t,Re.b,a.r,a.u,i.s,B.a,Re.a],styles:["main[_ngcontent-%COMP%]{width:24em;min-height:24em;overflow:hidden auto}main[_ngcontent-%COMP%] > mat-radio-group[_ngcontent-%COMP%] > .item[_ngcontent-%COMP%]{background:none;border:none;border-bottom:1px solid #ccc}main[_ngcontent-%COMP%] > mat-radio-group[_ngcontent-%COMP%] > .item[_ngcontent-%COMP%]:last-child{border:none}.item[_ngcontent-%COMP%]{padding:.5em;border:1px solid #ccc;width:100%}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{border-bottom:none}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:first-child{border-radius:4px 4px 0 0;margin-top:.25em}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:last-child{margin-bottom:.25em;border-radius:0 0 4px 4px;border-bottom:1px solid #ccc}mat-dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #ccc}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),Je),nt=n("Qu3c"),it=n("019G");function ot(e,t){if(1&e&&u.Rb(0,"div",15),2&e){var n=u.ic(2);u.Dc("background-image","url("+n.item.image_path+")",u.Jb)}}function at(e,t){if(1&e&&(u.Wb(0,"div",16),u.Gc(1),u.jc(2,"currency"),u.Vb()),2&e){var n=u.ic(2);u.Cb(1),u.Ic(" ",u.lc(2,1,n.item.unit_price/100,n.symbol)," ")}}function rt(e,t){if(1&e&&(u.Wb(0,"div",17),u.Gc(1),u.Vb()),2&e){var n=u.ic(2);u.oc("matTooltip",n.contents),u.Cb(1),u.Jc(" Contains ",n.item.items.length," item",1===n.item.items.length?"":"s"," ")}}function ct(e,t){if(1&e&&(u.Wb(0,"div",17),u.Wb(1,"span",18),u.Gc(2,"Selected "),u.Vb(),u.Gc(3),u.Wb(4,"span",18),u.Gc(5,"ion"),u.Vb(),u.Gc(6),u.Vb()),2&e){var n=u.ic(2);u.oc("matTooltip",n.contents),u.Cb(3),u.Ic("",n.item.must_select," opt"),u.Cb(3),u.Ic("",1===n.item.items.length?"":"s"," ")}}function st(e,t){if(1&e){var n=u.Xb();u.Wb(0,"button",19),u.ec("tapped",(function(){return u.wc(n),u.ic(2).updatePackageOptions()})),u.Gc(1," Customise "),u.Vb()}}function ut(e,t){if(1&e&&(u.Wb(0,"div",20),u.Gc(1),u.jc(2,"currency"),u.Vb()),2&e){var n=u.ic(2);u.Cb(1),u.Ic(" ",u.lc(2,1,n.item.unit_price/100,n.symbol)," ")}}function lt(e,t){if(1&e){var n=u.Xb();u.Wb(0,"a-counter",21),u.ec("ngModelChange",(function(e){return u.wc(n),u.ic(2).updateAmount(e)})),u.Vb()}if(2&e){var i=u.ic(2);u.oc("ngModel",i.item.amount)}}var dt=function(e){return{class:"material-icons",content:e}};function ft(e,t){if(1&e){var n=u.Xb();u.Wb(0,"button",22),u.ec("tapped",(function(){u.wc(n);var e=u.ic(2);return e.show_children=!e.show_children})),u.Rb(1,"app-icon",23),u.Vb()}if(2&e){var i=u.ic(2);u.Cb(1),u.oc("icon",u.qc(1,dt,i.show_children?"keyboard_arrow_up":"keyboard_arrow_down"))}}function mt(e,t){if(1&e&&(u.Wb(0,"div",3),u.Ec(1,ot,1,2,"div",4),u.Wb(2,"div",5),u.Wb(3,"div",6),u.Gc(4),u.Vb(),u.Wb(5,"div",7),u.Gc(6),u.Vb(),u.Wb(7,"div",8),u.Ec(8,at,3,4,"div",9),u.Ec(9,rt,2,3,"div",10),u.Ec(10,ct,7,3,"div",10),u.Ec(11,st,2,0,"button",11),u.Vb(),u.Vb(),u.Ec(12,ut,3,4,"div",12),u.Ec(13,lt,1,1,"a-counter",13),u.Ec(14,ft,2,3,"button",14),u.Vb()),2&e){var n=u.ic();u.Gb("subitem",n.subitem),u.Db("disabled",n.disabled&&!n.item.can_order_anytime),u.Cb(1),u.oc("ngIf",!n.subitem),u.Cb(3),u.Hc(n.item.name),u.Cb(2),u.Jc("",n.item.package?"[Package] ":"","",n.item.description,""),u.Cb(2),u.oc("ngIf",n.item.unit_price),u.Cb(1),u.oc("ngIf",n.item.package&&n.item.items.length&&!n.item.must_select),u.Cb(1),u.oc("ngIf",n.item.package&&n.item.must_select&&n.item.amount>0),u.Cb(1),u.oc("ngIf",n.item.package&&n.item.must_select&&n.item.amount>0),u.Cb(1),u.oc("ngIf",n.item.unit_price),u.Cb(1),u.oc("ngIf",!n.item.items||n.item.package),u.Cb(1),u.oc("ngIf",n.item.items&&n.item.items.length&&!n.item.package)}}function ht(e,t){if(1&e&&u.Rb(0,"a-catering-order-item",24),2&e){var n=t.$implicit,i=u.ic();u.oc("subitem",!0)("symbol",i.symbol)("item",n)("field",i.field)}}var bt,gt=((bt=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._service=e,i._dialog=n,i}return _inherits(t,e),_createClass(t,[{key:"ngOnChanges",value:function(e){var t=this;if(e.field&&this.field){var n=this.field.value.find((function(e){return e.id===t.item.id}));this.item.setAmount(n?n.amount:0),this.subscription("field_change",this.field.valueChanges.subscribe((function(e){var n=e.find((function(e){return e.id===t.item.id}));t.item.setAmount(n?n.amount:0)})))}}},{key:"updateAmount",value:function(e){var t=this;if(this.field){var n=this.field.value||[],i=n.find((function(e){return e.id===t.item.id}));if(i)this.item.setAmount(e),i.setAmount(e);else{var o=this.item.amount;this.item.setAmount(e),this.item.package&&o<e?this.selectPackageOptions().then((function(e){n.push(new Ne.a(e)),t.field.setValue(n.filter((function(e){return e.amount})))}),(function(){t.item.setAmount(999),t.timeout("amount",(function(){return t.item.setAmount(0)}),5),t._service.notifyWarn("Package options not selected. Item removed from order")})):n.push(new Ne.a(this.item))}this.field.setValue(n.filter((function(e){return e.amount})))}}},{key:"updatePackageOptions",value:function(){this.selectPackageOptions().then((function(){return null}),(function(){return null}))}},{key:"selectPackageOptions",value:function(){var e=this;return new Promise((function(t,n){var i=e._dialog.open(tt,{maxWidth:"95vw",data:{item:new Te.a(e.item)}}),o=!1;i.componentInstance.event.subscribe((function(e){"done"===e.reason&&(o=!0,t(i.componentInstance.item),i.close())})),i.afterClosed().subscribe((function(){o||n()}))}))}},{key:"contents",get:function(){return this.item.items?this.item.items.reduce((function(e,t){return e&&(e+="\n\n"),e+"".concat(t.name).concat(t.items?t.items.reduce((function(e,t){return e+"\n ".concat(t.amount?"\u2713":"\u2022"," ").concat(t.name," ")}),""):""," ").concat(t.amount?"\u2713":"")}),""):""}}]),t}(s.a)).\u0275fac=function(e){return new(e||bt)(u.Qb(c.a),u.Qb(_.b))},bt.\u0275cmp=u.Kb({type:bt,selectors:[["a-catering-order-item"]],inputs:{subitem:"subitem",item:"item",field:"field",symbol:"symbol",disabled:"disabled"},features:[u.zb,u.Ab],decls:3,vars:3,consts:[["class","catering-item",3,"subitem",4,"ngIf"],[1,"children"],[3,"subitem","symbol","item","field",4,"ngFor","ngForOf"],[1,"catering-item"],["class","image",3,"background-image",4,"ngIf"],[1,"details"],[1,"name"],[1,"description"],[1,"options"],["class","option price mobile-only",4,"ngIf"],["class","option",3,"matTooltip",4,"ngIf"],["mat-button","",3,"tapped",4,"ngIf"],["class","option price not-mobile",4,"ngIf"],[3,"ngModel","ngModelChange",4,"ngIf"],["mat-icon-button","",3,"tapped",4,"ngIf"],[1,"image"],[1,"option","price","mobile-only"],[1,"option",3,"matTooltip"],[1,"not-mobile"],["mat-button","",3,"tapped"],[1,"option","price","not-mobile"],[3,"ngModel","ngModelChange"],["mat-icon-button","",3,"tapped"],[3,"icon"],[3,"subitem","symbol","item","field"]],template:function(e,t){1&e&&(u.Ec(0,mt,15,14,"div",0),u.Wb(1,"div",1),u.Ec(2,ht,1,4,"a-catering-order-item",2),u.Vb()),2&e&&(u.oc("ngIf",t.item),u.Cb(1),u.oc("@show",t.show_children?"show":"hide"),u.Cb(1),u.oc("ngForOf",t.item.items))},directives:[i.t,i.s,nt.a,w.b,k.c,it.a,a.r,a.u,O.a,bt],pipes:[i.d],styles:[".catering-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem}.catering-item[disabled=true][_ngcontent-%COMP%]{pointer-events:none;opacity:.35;background-color:rgba(0,0,0,.2)}.subitem[_ngcontent-%COMP%]{border-top:1px solid #ccc}.name[_ngcontent-%COMP%]{max-width:480px}.image[_ngcontent-%COMP%]{height:3em;width:3em;min-width:3em;border-radius:4px;background-color:rgba(0,0,0,.05);background-position:50%;background-size:cover;border:1px solid rgba(0,0,0,.05)}.details[_ngcontent-%COMP%]{flex:1;min-width:25%;padding:0 .5em;display:flex;flex-direction:column}.details[_ngcontent-%COMP%]   *[_ngcontent-%COMP%] > {white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.options[_ngcontent-%COMP%]{display:flex;align-items:center}.options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;font-size:.8em;height:1.5em;color:rgba(0,0,0,.85);line-height:1em;padding:0 .25em;text-decoration:underline}.option[_ngcontent-%COMP%]{padding:.25em .5em;border-radius:4px;color:#fff;font-size:.8rem;background-color:#1937ea;margin:.25em .4rem .25em 0;white-space:nowrap}.description[_ngcontent-%COMP%]{font-size:.75em;margin-top:.25em}.children[_ngcontent-%COMP%]{font-size:.9em;background-color:rgba(0,0,0,.05)}"],data:{animation:[L.a]}}),bt);function pt(e,t){if(1&e&&u.Rb(0,"a-catering-order-item",9),2&e){var n=t.$implicit,i=u.ic();u.oc("field",i.item_field)("subitem",!0)("item",n)("symbol",i.symbol)}}var vt,_t,yt=function(){return{class:"material-icons",content:"close"}},Ct=((vt=function(e){function t(e,n,i){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._service=e,o._dialog_ref=n,o._data=i,o.event=new u.n,o.item_list=[],o}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){var e=this;this._data.form.controls.items&&this.subscription("item_list",this._data.form.controls.items.valueChanges.subscribe((function(t){(!t||t.length<=0)&&e._dialog_ref.close()}))),this.item_list=(this._data.form&&this._data.form.controls.items?this._data.form.controls.items.value:[]).map((function(e){return new Ne.a(e)}))}},{key:"space",get:function(){return this._data.form&&this._data.form.controls.space?this._data.form.controls.space.value:{}}},{key:"delivery_time",get:function(){return y(this._data.date).format("h:mm A")}},{key:"item_field",get:function(){return this._data.form?this._data.form.controls.items:null}},{key:"order_cost",get:function(){return this.item_list.reduce((function(e,t){return e+t.amount*t.unit_price}),0)}},{key:"symbol",get:function(){var e=this;if(!this.space||!this.space.level)return"USD";var t=this._service.Organisation.buildings.find((function(t){return t.id===e.space.level.building_id}));return t?t.currency:"USD"}}]),t}(s.a)).\u0275fac=function(e){return new(e||vt)(u.Qb(c.a),u.Qb(_.h),u.Qb(_.a))},vt.\u0275cmp=u.Kb({type:vt,selectors:[["a-catering-confirm-modal"]],outputs:{event:"event"},features:[u.zb],decls:26,vars:9,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"details"],[1,"list"],[3,"field","subitem","item","symbol",4,"ngFor","ngForOf"],[1,"total"],[1,"value"],["mat-button","",3,"tapped"],[3,"field","subitem","item","symbol"]],template:function(e,t){1&e&&(u.Wb(0,"header"),u.Wb(1,"div",0),u.Gc(2,"Confirm Catering Order"),u.Vb(),u.Wb(3,"button",1),u.Rb(4,"app-icon",2),u.Vb(),u.Vb(),u.Wb(5,"mat-dialog-content"),u.Wb(6,"main"),u.Wb(7,"div",3),u.Gc(8," Delivering to "),u.Wb(9,"span"),u.Gc(10),u.Vb(),u.Gc(11," at "),u.Wb(12,"span"),u.Gc(13),u.Vb(),u.Vb(),u.Wb(14,"div",4),u.Ec(15,pt,1,4,"a-catering-order-item",5),u.Vb(),u.Wb(16,"div",6),u.Wb(17,"label"),u.Gc(18,"Order Total:"),u.Vb(),u.Wb(19,"div",7),u.Gc(20),u.jc(21,"currency"),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(22,"mat-dialog-actions"),u.Wb(23,"footer"),u.Wb(24,"button",8),u.ec("tapped",(function(){return t.event.emit({reason:"done"})})),u.Gc(25,"Save Order"),u.Vb(),u.Vb(),u.Vb()),2&e&&(u.Cb(4),u.oc("icon",u.pc(8,yt)),u.Cb(6),u.Hc(t.space.name||"<Unset>"),u.Cb(3),u.Hc(t.delivery_time),u.Cb(2),u.oc("ngForOf",t.item_list),u.Cb(5),u.Hc(u.lc(21,5,t.order_cost/100,t.symbol)))},directives:[w.b,_.d,O.a,_.f,i.s,_.c,k.c,gt],pipes:[i.d],styles:[".heading[_ngcontent-%COMP%]{flex:1}.details[_ngcontent-%COMP%]{padding:1em;text-align:center}.details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:400}.list[_ngcontent-%COMP%]{height:50vh;overflow:auto}.total[_ngcontent-%COMP%]{border-top:1px solid #ccc;display:flex;align-items:center;justify-content:flex-end;padding:.5em 1em}.total[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.8em;font-weight:500;margin-right:1.5em}mat-dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #ccc}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),vt),wt=function(e,t){return(n=(t={exports:{}}).exports).isLeapYear=function(e){return e%4==0&&e%100!=0||e%400==0},n.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.valueOf())},n.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},n.zeroPad=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n="0";return(e+="").length>=t?e:new Array(t-e.length+1).join(n)+e},n.titleCase=function(e){return e?e[0].toUpperCase()+e.substr(1):""},n.ordinal=function(e){var t=e%10,n=e%100;return 1===t&&11!==n?e+"st":2===t&&12!==n?e+"nd":3===t&&13!==n?e+"rd":e+"th"},n.toCardinal=function(e){return e=(e=String(e)).replace(/([0-9])(st|nd|rd|th)$/i,"$1"),parseInt(e,10)},n.normalize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"day"===(e=(e=(e=(e=e.toLowerCase().trim()).replace(/ies$/,"y")).replace(/s$/,"")).replace(/-/g,""))?"date":e},n.getEpoch=function(e){return"number"==typeof e?e:n.isDate(e)?e.getTime():e.epoch?e.epoch:null},n.beADate=function(e,t){return!1===n.isObject(e)?t.clone().set(e):e},n.formatTimezone=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=Math.abs(e),o=e>0?"+":"-";return"".concat(o).concat(n.zeroPad(i)).concat(t,"00")},t.exports;var n}(),Ot=wt.zeroPad,kt=function(e,t,n,i){var o=new Date(e),a=(o.getTimezoneOffset()||0)+60*i;a=60*a*1e3;var r=function(e){return Ot(e.getMonth()+1)+"/"+Ot(e.getDate())+":"+Ot(e.getHours())}(o=new Date(e+a));return r>=t&&r<n},xt=function(e){var t=e.timezones[e.tz];if(void 0===t)return console.warn("Warning: couldn't find timezone "+e.tz),0;if(void 0===t.dst)return t.offset;var n=t.offset,i=t.offset+1;"n"===t.hem&&(i=n-1);var o=t.dst.split("->");return!0===kt(e.epoch,o[0],o[1],n)?n:i},Pt=["africa","america","asia","atlantic","australia","brazil","canada","chile","europe","indian","mexico","pacific","antarctica","etc"],Mt=(_t=Object.freeze({__proto__:null,default:{"9|s":"2/dili,2/jayapura","9|n":"2/chita,2/khandyga,2/pyongyang,2/seoul,2/tokyo,11/palau","9.5|s|04/05:03->10/04:02":"4/adelaide,4/broken_hill,4/south,4/yancowinna","9.5|s":"4/darwin,4/north","8|s":"12/casey,2/kuala_lumpur,2/makassar,2/singapore,4/perth,4/west","8|n|03/25:03->09/29:23":"2/ulan_bator","8|n":"2/brunei,2/choibalsan,2/chongqing,2/chungking,2/harbin,2/hong_kong,2/irkutsk,2/kuching,2/macao,2/macau,2/manila,2/shanghai,2/taipei,2/ujung_pandang,2/ulaanbaatar","8.75|s":"4/eucla","7|s":"12/davis,2/jakarta,9/christmas","7|n":"2/bangkok,2/barnaul,2/ho_chi_minh,2/hovd,2/krasnoyarsk,2/novokuznetsk,2/novosibirsk,2/phnom_penh,2/pontianak,2/saigon,2/tomsk,2/vientiane","6|s":"12/vostok","6|n":"2/almaty,2/bishkek,2/dacca,2/dhaka,2/kashgar,2/omsk,2/qyzylorda,2/thimbu,2/thimphu,2/urumqi,9/chagos","6.5|n":"2/rangoon,2/yangon,9/cocos","5|s":"12/mawson,9/kerguelen","5|n":"2/aqtau,2/aqtobe,2/ashgabat,2/ashkhabad,2/atyrau,2/baku,2/dushanbe,2/karachi,2/oral,2/samarkand,2/tashkent,2/yekaterinburg,9/maldives","5.75|n":"2/kathmandu,2/katmandu","5.5|n":"2/calcutta,2/colombo,2/kolkata","4|s":"9/reunion","4|n":"2/dubai,2/muscat,2/tbilisi,2/yerevan,8/astrakhan,8/samara,8/saratov,8/ulyanovsk,8/volgograd,2/volgograd,9/mahe,9/mauritius","4.5|n|03/21:00->09/20:24":"2/tehran","4.5|n":"2/kabul","3|s":"12/syowa,9/antananarivo","3|n|03/29:03->10/25:04":"2/famagusta,2/nicosia,8/athens,8/bucharest,8/helsinki,8/kiev,8/mariehamn,8/nicosia,8/riga,8/sofia,8/tallinn,8/uzhgorod,8/vilnius,8/zaporozhye","3|n|03/29:02->10/25:03":"8/chisinau,8/tiraspol","3|n|03/29:00->10/24:24":"2/beirut","3|n|03/27:02->10/25:02":"2/jerusalem,2/tel_aviv","3|n|03/27:00->10/31:01":"2/gaza,2/hebron","3|n|03/27:00->10/30:01":"2/amman","3|n|03/27:00->10/29:24":"2/damascus","3|n":"0/addis_ababa,0/asmara,0/asmera,0/dar_es_salaam,0/djibouti,0/juba,0/kampala,0/mogadishu,0/nairobi,2/aden,2/baghdad,2/bahrain,2/istanbul,2/kuwait,2/qatar,2/riyadh,8/istanbul,8/kirov,8/minsk,8/moscow,8/simferopol,9/comoro,9/mayotte","2|s|03/29:02->10/25:02":"12/troll","2|s":"0/gaborone,0/harare,0/johannesburg,0/lubumbashi,0/lusaka,0/maputo,0/maseru,0/mbabane","2|n|03/29:02->10/25:03":"0/ceuta,arctic/longyearbyen,3/jan_mayen,8/amsterdam,8/andorra,8/belgrade,8/berlin,8/bratislava,8/brussels,8/budapest,8/busingen,8/copenhagen,8/gibraltar,8/ljubljana,8/luxembourg,8/madrid,8/malta,8/monaco,8/oslo,8/paris,8/podgorica,8/prague,8/rome,8/san_marino,8/sarajevo,8/skopje,8/stockholm,8/tirane,8/vaduz,8/vatican,8/vienna,8/warsaw,8/zagreb,8/zurich","2|n":"0/blantyre,0/bujumbura,0/cairo,0/khartoum,0/kigali,0/tripoli,8/kaliningrad","1|s|04/02:01->09/03:03":"0/windhoek","1|s":"0/kinshasa,0/luanda","1|n|04/19:03->05/24:02":"0/casablanca,0/el_aaiun","1|n|03/29:01->10/25:02":"3/canary,3/faeroe,3/faroe,3/madeira,8/belfast,8/dublin,8/guernsey,8/isle_of_man,8/jersey,8/lisbon,8/london","1|n":"0/algiers,0/bangui,0/brazzaville,0/douala,0/lagos,0/libreville,0/malabo,0/ndjamena,0/niamey,0/porto-novo,0/tunis","14|n":"11/kiritimati","13|s|04/05:04->09/27:03":"11/apia","13|s|01/15:02->11/05:03":"11/tongatapu","13|n":"11/enderbury,11/fakaofo","12|s|04/05:03->09/27:02":"12/mcmurdo,12/south_pole,11/auckland","12|s|01/12:03->11/08:02":"11/fiji","12|n":"2/anadyr,2/kamchatka,2/srednekolymsk,11/funafuti,11/kwajalein,11/majuro,11/nauru,11/tarawa,11/wake,11/wallis","12.75|s|04/05:03->04/05:02":"11/chatham","11|s":"12/macquarie,11/bougainville","11|n":"2/magadan,2/sakhalin,11/efate,11/guadalcanal,11/kosrae,11/noumea,11/pohnpei,11/ponape","11.5|n|04/05:03->10/04:02":"11/norfolk","10|s|04/05:03->10/04:02":"4/act,4/canberra,4/currie,4/hobart,4/melbourne,4/nsw,4/sydney,4/tasmania,4/victoria","10|s":"12/dumontdurville,4/brisbane,4/lindeman,4/queensland","10|n":"2/ust-nera,2/vladivostok,2/yakutsk,11/chuuk,11/guam,11/port_moresby,11/saipan,11/truk,11/yap","10.5|s|04/05:01->10/04:02":"4/lhi,4/lord_howe","0|n|03/29:00->10/25:01":"1/scoresbysund,3/azores","0|n":"0/abidjan,0/accra,0/bamako,0/banjul,0/bissau,0/conakry,0/dakar,0/freetown,0/lome,0/monrovia,0/nouakchott,0/ouagadougou,0/sao_tome,0/timbuktu,1/danmarkshavn,3/reykjavik,3/st_helena,13/gmt,13/gmt+0,13/gmt-0,13/gmt0,13/greenwich,13/utc,13/universal,13/zulu","-9|n|03/08:02->11/01:02":"1/adak,1/atka","-9|n":"11/gambier","-9.5|n":"11/marquesas","-8|n|03/08:02->11/01:02":"1/anchorage,1/juneau,1/metlakatla,1/nome,1/sitka,1/yakutat","-8|n":"11/pitcairn","-7|n|03/08:02->11/01:02":"1/dawson,1/ensenada,1/los_angeles,1/santa_isabel,1/tijuana,1/vancouver,1/whitehorse,6/pacific,6/yukon,10/bajanorte","-7|n":"1/creston,1/dawson_creek,1/hermosillo,1/phoenix","-6|s|04/04:22->09/05:22":"7/easterisland,11/easter","-6|n|04/05:02->10/25:02":"1/chihuahua,1/mazatlan,10/bajasur","-6|n|03/08:02->11/01:02":"1/boise,1/cambridge_bay,1/denver,1/edmonton,1/inuvik,1/ojinaga,1/shiprock,1/yellowknife,6/mountain","-6|n":"1/belize,1/costa_rica,1/el_salvador,1/guatemala,1/managua,1/regina,1/swift_current,1/tegucigalpa,6/east-saskatchewan,6/saskatchewan,11/galapagos","-5|s":"1/lima,1/rio_branco,5/acre","-5|n|04/05:02->10/25:02":"1/bahia_banderas,1/merida,1/mexico_city,1/monterrey,10/general","-5|n|03/12:03->11/05:01":"1/north_dakota","-5|n|03/08:02->11/01:02":"1/chicago,1/knox_in,1/matamoros,1/menominee,1/rainy_river,1/rankin_inlet,1/resolute,1/winnipeg,6/central","-5|n":"1/atikokan,1/bogota,1/cancun,1/cayman,1/coral_harbour,1/eirunepe,1/guayaquil,1/jamaica,1/panama,1/porto_acre","-4|s|05/13:23->08/13:01":"12/palmer","-4|s|04/04:24->09/06:00":"1/santiago,7/continental","-4|s|03/21:24->10/04:00":"1/asuncion","-4|s|02/16:24->11/03:00":"1/campo_grande,1/cuiaba","-4|s":"1/la_paz,1/manaus,5/west","-4|n|03/12:03->11/05:01":"1/indiana,1/kentucky","-4|n|03/08:02->11/01:02":"1/detroit,1/fort_wayne,1/grand_turk,1/indianapolis,1/iqaluit,1/louisville,1/montreal,1/nassau,1/new_york,1/nipigon,1/pangnirtung,1/port-au-prince,1/thunder_bay,1/toronto,6/eastern","-4|n|03/08:00->11/01:01":"1/havana","-4|n":"1/anguilla,1/antigua,1/aruba,1/barbados,1/blanc-sablon,1/boa_vista,1/caracas,1/curacao,1/dominica,1/grenada,1/guadeloupe,1/guyana,1/kralendijk,1/lower_princes,1/marigot,1/martinique,1/montserrat,1/port_of_spain,1/porto_velho,1/puerto_rico,1/santo_domingo,1/st_barthelemy,1/st_kitts,1/st_lucia,1/st_thomas,1/st_vincent,1/tortola,1/virgin","-3|s":"1/argentina,1/buenos_aires,1/cordoba,1/fortaleza,1/montevideo,1/punta_arenas,1/sao_paulo,12/rothera,3/stanley,5/east","-3|n|03/08:02->11/01:02":"1/glace_bay,1/goose_bay,1/halifax,1/moncton,1/thule,3/bermuda,6/atlantic","-3|n":"1/araguaina,1/bahia,1/belem,1/catamarca,1/cayenne,1/jujuy,1/maceio,1/mendoza,1/paramaribo,1/recife,1/rosario,1/santarem","-2|s":"5/denoronha","-2|n|03/28:22->10/24:23":"1/godthab","-2|n|03/08:02->11/01:02":"1/miquelon","-2|n":"1/noronha,3/south_georgia","-2.5|n|03/08:02->11/01:02":"1/st_johns,6/newfoundland","-1|n":"3/cape_verde","-11|n":"11/midway,11/niue,11/pago_pago,11/samoa","-10|n":"11/honolulu,11/johnston,11/rarotonga,11/tahiti"}}))&&_t.default||_t,Vt={};Object.keys(Mt).forEach((function(e){var t=e.split("|"),n={offset:Number(t[0]),hem:t[1]};t[2]&&(n.dst=t[2]),Mt[e].split(",").forEach((function(e){e=e.replace(/(^[0-9]+)\//,(function(e,t){return t=Number(t),Pt[t]+"/"})),Vt[e]=n}))})),Vt.utc={offset:0,hem:"n"};for(var Wt=-14;Wt<=14;Wt+=.5){var It=Wt;It>0&&(It="+"+It);var zt="etc/gmt"+It;Vt[zt]={offset:-1*Wt,hem:"n"},Vt[zt="utc/gmt"+It]={offset:-1*Wt,hem:"n"}}var Et,jt=Vt,Gt=/(\-?[0-9]+)h(rs)?/i,Ft=/(\-?[0-9]+)/,Dt=/utc([\-+]?[0-9]+)/i,St=/gmt([\-+]?[0-9]+)/i,qt=function(e){return(e=Number(e))>-13&&e<13?"etc/gmt"+(e=((e*=-1)>0?"+":"")+e):null},At=null===(Et=function(){if("undefined"==typeof Intl||void 0===Intl.DateTimeFormat)return null;var e=Intl.DateTimeFormat();if(void 0===e||void 0===e.resolvedOptions)return null;var t=e.resolvedOptions().timeZone;return t?t.toLowerCase():null}())?"utc":Et,Tt=Object.keys(jt).reduce((function(e,t){var n=t.split("/")[1]||"";return e[n=n.replace(/_/g," ")]=t,e}),{}),Nt=function(e,t){if(!e)return At;var n=e.trim(),i=e.split("/");if(i.length>2&&!1===t.hasOwnProperty(n)&&(n=i[0]+"/"+i[1]),n=n.toLowerCase(),!0===t.hasOwnProperty(n))return n;if(n=function(e){return(e=(e=(e=(e=(e=e.replace(/ time/g,"")).replace(/ (standard|daylight|summer)/g,"")).replace(/\b(east|west|north|south)ern/g,"$1")).replace(/\b(africa|america|australia)n/g,"$1")).replace(/\beuropean/g,"europe")).replace(/\islands/g,"island")}(n),!0===t.hasOwnProperty(n))return n;if(!0===Tt.hasOwnProperty(n))return Tt[n];if(!0===/[0-9]/.test(n)){var o=function(e){var t=e.match(Gt);if(null!==t)return qt(t[1]);if(null!==(t=e.match(Dt)))return qt(t[1]);if(null!==(t=e.match(St))){var n=-1*Number(t[1]);return qt(n)}return null!==(t=e.match(Ft))?qt(t[1]):null}(n);if(o)return o}throw new Error("Spacetime: Cannot find timezone named: '"+e+"'. Please enter an IANA timezone id.")},Rt={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5};Rt.date=Rt.day,Rt.month=25488e5,Rt.week=6048e5,Rt.year=3154e7,Object.keys(Rt).forEach((function(e){Rt[e+"s"]=Rt[e]}));var $t=Rt,Ht=function(e,t,n,i,o){var a=e.d[n]();if(a!==t){var r=null===o?null:e.d[o](),c=e.epoch,s=t-a;e.epoch+=$t[i]*s,"day"===i&&Math.abs(s)>28&&t<28&&(e.epoch+=$t.hour);for(var u=$t[i]/2;e.d[n]()<t;)e.epoch+=u;for(;e.d[n]()>t;)e.epoch-=u;null!==o&&r!==e.d[o]()&&(e.epoch=c,e.epoch+=$t[i]*s*.89)}},Qt={year:{valid:function(e){return e>-4e3&&e<4e3},walkTo:function(e,t){return Ht(e,t,"getFullYear","year",null)}},month:{valid:function(e){return e>=0&&e<=11},walkTo:function(e,t){var n=e.d,i=n.getMonth(),o=e.epoch,a=n.getFullYear();if(i!==t){for(e.epoch+=$t.day*(28*(t-i)),a!==e.d.getFullYear()&&(e.epoch=o);e.d.getMonth()<t;)e.epoch+=$t.day;for(;e.d.getMonth()>t;)e.epoch-=$t.day}}},date:{valid:function(e){return e>0&&e<=31},walkTo:function(e,t){return Ht(e,t,"getDate","day","getMonth")}},hour:{valid:function(e){return e>=0&&e<24},walkTo:function(e,t){return Ht(e,t,"getHours","hour","getDate")}},minute:{valid:function(e){return e>=0&&e<60},walkTo:function(e,t){return Ht(e,t,"getMinutes","minute","getHours")}},second:{valid:function(e){return e>=0&&e<60},walkTo:function(e,t){e.epoch=e.seconds(t).epoch}},millisecond:{valid:function(e){return e>=0&&e<1e3},walkTo:function(e,t){e.epoch=e.milliseconds(t).epoch}}},Ut=function(e,t){for(var n=Object.keys(Qt),i=e.clone(),o=0;o<n.length;o++){var a=n[o],r=t[a];if(void 0===r&&(r=i[a]()),"string"==typeof r&&(r=parseInt(r,10)),!Qt[a].valid(r))return e.epoch=null,void(!1===e.silent&&console.warn("invalid "+a+": "+r));Qt[a].walkTo(e,r)}},Yt=["jan","feb","mar","apr","may","jun","jul","aug","sept","oct","nov","dec"],Lt=["january","february","march","april","may","june","july","august","september","october","november","december"],Bt=function(){return Yt},Xt=function(){return function(){for(var e={sep:8},t=0;t<Yt.length;t++)e[Yt[t]]=t;for(var n=0;n<Lt.length;n++)e[Lt[n]]=n;return e}()},Kt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=(t=t.replace(/^\s+/,"").toLowerCase()).match(/([0-9]{1,2}):([0-9]{1,2}):?([0-9]{1,2})?[:\.]?([0-9]{1,4})?/);if(null!==n){var i=Number(n[1]);if(i<0||i>24)return e.startOf("day");var o=Number(n[2]);if(n[2].length<2||o<0||o>59)return e.startOf("day");e=(e=(e=(e=e.hour(i)).minute(o)).seconds(n[3]||0)).millisecond(n[4]||0);var a=t.match(/[\b0-9](am|pm)\b/);return null!==a&&a[1]&&(e=e.ampm(a[1])),e}if(null!==(n=t.match(/([0-9]+) ?(am|pm)/))&&n[1]){var r=Number(n[1]);return r>12||r<1?e.startOf("day"):e=(e=(e=e.hour(n[1]||0)).ampm(n[2])).startOf("hour")}return e.startOf("day")},Zt=[31,28,31,30,31,30,31,31,30,31,30,31],Jt=wt.isLeapYear,en=function(e){return!0===Zt.hasOwnProperty(e.month)&&(1===e.month?!!(Jt(e.year)&&e.date<=29)||e.date<=28:e.date<=(Zt[e.month]||0))},tn=Xt(),nn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=parseInt(e.trim(),10);return t||(new Date).getFullYear()},on=[{reg:/^(\-?0?0?[0-9]{3,4})-([0-9]{1,2})-([0-9]{1,2})[T| ]([0-9.:]+)(Z|[0-9\-\+:]+)?$/,parse:function(e,t,n,i){var o=parseInt(t[2],10)-1,a={year:t[1],month:o,date:t[3]};return!1===en(a)?(e.epoch=null,e):(function(e,t){if(!t)return e;"Z"===t&&(t="+0000");var n=0;/^[\+-]?[0-9]{2}:[0-9]{2}$/.test(t)&&(!0===/:00/.test(t)&&(t=t.replace(/:00/,"")),!0===/:30/.test(t)&&(t=t.replace(/:30/,".5"))),/^[\+-]?[0-9]{4}$/.test(t)&&(t=t.replace(/30$/,".5")),n=parseFloat(t),Math.abs(n)>100&&(n/=100),(n*=-1)>=0&&(n="+"+n);var i="etc/gmt"+n;e.timezones[i]&&(e.tz=i)}(e,t[5]),Ut(e,a),e=Kt(e,t[4]))}},{reg:/^([0-9]{4})[\-\/]([0-9]{1,2})[\-\/]([0-9]{1,2}),?( [0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(e,t){var n={year:t[1],month:parseInt(t[2],10)-1,date:parseInt(t[3],10)};return n.month>=12&&(n.date=parseInt(t[2],10),n.month=parseInt(t[3],10)-1),!1===en(n)?(e.epoch=null,e):(Ut(e,n),e=Kt(e,t[4]))}},{reg:/^([0-9]{1,2})[\-\/]([0-9]{1,2})[\-\/]?([0-9]{4})?,?( [0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(e,t){var n=parseInt(t[1],10)-1,i=parseInt(t[2],10);(e.british||n>=12)&&(i=parseInt(t[1],10),n=parseInt(t[2],10)-1);var o={year:t[3]||(new Date).getFullYear(),month:n,date:i};return!1===en(o)?(e.epoch=null,e):(Ut(e,o),e=Kt(e,t[4]))}},{reg:/^([0-9]{1,2})[\-\/]([a-z]+)[\-\/]?([0-9]{4})?$/i,parse:function(e,t){var n=tn[t[2].toLowerCase()],i={year:nn(t[3]),month:n,date:wt.toCardinal(t[1]||"")};return!1===en(i)?(e.epoch=null,e):(Ut(e,i),e=Kt(e,t[4]))}},{reg:/^([a-z]+) ([0-9]{1,2}(?:st|nd|rd|th)?),?( [0-9]{4})?( ([0-9:]+( ?am| ?pm| ?gmt)?))?$/i,parse:function(e,t){var n=tn[t[1].toLowerCase()],i={year:nn(t[3]),month:n,date:wt.toCardinal(t[2]||"")};return!1===en(i)?(e.epoch=null,e):(Ut(e,i),e=Kt(e,t[4]))}},{reg:/^([a-z]+) ([0-9]{4})$/i,parse:function(e,t){var n=tn[t[1].toLowerCase()],i={year:nn(t[2]),month:n,date:1};return!1===en(i)?(e.epoch=null,e):(Ut(e,i),e=Kt(e,t[4]))}},{reg:/^([0-9]{1,2}(?:st|nd|rd|th)?) ([a-z]+),?( [0-9]{4})?,? ?([0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(e,t){var n=tn[t[2].toLowerCase()];if(!n)return null;var i={year:nn(t[3]),month:n,date:wt.toCardinal(t[1])};return!1===en(i)?(e.epoch=null,e):(Ut(e,i),e=Kt(e,t[4]))}},{reg:/^[0-9,]+ ?b\.?c\.?$/i,parse:function(e,t){var n=t[0]||"";n=(n=n.replace(/^([0-9,]+) ?b\.?c\.?$/i,"-$1")).replace(/,/g,"");var i=parseInt(n.trim(),10),o=new Date,a={year:i,month:o.getMonth(),date:o.getDate()};return!1===en(a)?(e.epoch=null,e):(Ut(e,a),e=Kt(e))}},{reg:/^[0-9,]+ ?(a\.?d\.?|c\.?e\.?)$/i,parse:function(e,t){var n=t[0]||"";n=n.replace(/,/g,"");var i=parseInt(n.trim(),10),o=new Date,a={year:i,month:o.getMonth(),date:o.getDate()};return!1===en(a)?(e.epoch=null,e):(Ut(e,a),e=Kt(e))}},{reg:/^[0-9]{4}( ?a\.?d\.?)?$/i,parse:function(e,t){var n=nn(t[0]),i=new Date,o={year:n,month:i.getMonth(),date:i.getDate()};return!1===en(o)?(e.epoch=null,e):(Ut(e,o),e=Kt(e))}}],an={now:function(e){return e.epoch=Date.now(),e},tonight:function(e){return e.epoch=Date.now(),e.hour(18)},today:function(e){return e.epoch=Date.now(),e},tomorrow:function(e){return e.epoch=Date.now(),(e=e.add(1,"day")).startOf("day")},yesterday:function(e){return e.epoch=Date.now(),(e=e.subtract(1,"day")).startOf("day")},christmas:function(e){var t=(new Date).getFullYear();return e.set([t,11,25,18,0,0])},"new years":function(e){var t=(new Date).getFullYear();return e.set([t,11,31,18,0,0])}};an["new years eve"]=an["new years"];var rn=an,cn={year:(new Date).getFullYear(),month:0,date:1},sn=function(e,t,n){if("number"==typeof t)return t>0&&t<25e8&&!1===e.silent&&(console.warn("  - Warning: You are setting the date to January 1970."),console.warn("       -   did input seconds instead of milliseconds?")),e.epoch=t,e;if(e.epoch=Date.now(),null==t)return e;if(!0===wt.isDate(t))return e.epoch=t.getTime(),e;if(!0===wt.isArray(t))return function(e,t){for(var n=["year","month","date","hour","minute","second","millisecond"],i=0;i<n.length;i++)e=e[n[i]](t[i]||cn[n[i]]||0);return e}(e,t);if(!0===wt.isObject(t))return t.epoch?(e.epoch=t.epoch,e.tz=t.tz,e):e=function(e,t){t=Object.assign({},cn,t);for(var n=Object.keys(t),i=0;i<n.length;i++){var o=n[i];void 0!==e[o]&&"function"==typeof e[o]&&null!=t[o]&&""!==t[o]&&(e=e[o](t[o]||cn[o]||0))}return e}(e,t);if("string"!=typeof t)return e;if(t=(t=(t=t.replace(/\b(mon|tues|wed|wednes|thu|thurs|fri|sat|satur|sun)(day)?\b/i,"")).replace(/,/g,"")).replace(/ +/g," ").trim(),!0===rn.hasOwnProperty(t))return rn[t](e);for(var i=0;i<on.length;i++){var o=t.match(on[i].reg);if(o){var a=on[i].parse(e,o,n);if(null!==a)return a}}return!1===e.silent&&console.warn("Warning: couldn't parse date-string: '"+t+"'"),e.epoch=null,e},un=["sun","mon","tue","wed","thu","fri","sat"],ln=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],dn=function(){return un},fn=function(){return ln},mn=function(e){var t=e.timezone().current.offset,n=t<0,i="00";return.5===Math.abs(t%1)&&(i="30",t=t>=0?Math.floor(t):Math.ceil(t)),"+00:00"==(t=(t=n?"-"+(t=wt.zeroPad(t*=-1,2)):"+"+(t=wt.zeroPad(t,2)))+":"+i)&&(t="Z"),t},hn={day:function(e){return wt.titleCase(e.dayName())},"day-short":function(e){return wt.titleCase(dn()[e.day()])},"day-number":function(e){return e.day()},"day-ordinal":function(e){return wt.ordinal(e.day())},"day-pad":function(e){return wt.zeroPad(e.day())},date:function(e){return e.date()},"date-ordinal":function(e){return wt.ordinal(e.date())},"date-pad":function(e){return wt.zeroPad(e.date())},month:function(e){return wt.titleCase(e.monthName())},"month-short":function(e){return wt.titleCase(Bt()[e.month()])},"month-number":function(e){return e.month()},"month-ordinal":function(e){return wt.ordinal(e.month())},"month-pad":function(e){return wt.zeroPad(e.month())},"iso-month":function(e){return wt.zeroPad(e.month()+1)},year:function(e){var t=e.year();return t>0?t:(t=Math.abs(t))+" BC"},"year-short":function(e){var t=e.year();return t>0?"'".concat(String(e.year()).substr(2,4)):(t=Math.abs(t))+" BC"},"iso-year":function(e){var t=e.year(),n=t<0,i=wt.zeroPad(Math.abs(t),4);return n&&(i="-"+(i=wt.zeroPad(i,6))),i},time:function(e){return e.time()},"time-24":function(e){return"".concat(e.hour24(),":").concat(wt.zeroPad(e.minute()))},hour:function(e){return e.hour12()},"hour-pad":function(e){return wt.zeroPad(e.hour12())},"hour-24":function(e){return e.hour24()},"hour-24-pad":function(e){return wt.zeroPad(e.hour24())},minute:function(e){return e.minute()},"minute-pad":function(e){return wt.zeroPad(e.minute())},second:function(e){return e.second()},"second-pad":function(e){return wt.zeroPad(e.second())},ampm:function(e){return e.ampm()},quarter:function(e){return"Q"+e.quarter()},season:function(e){return e.season()},era:function(e){return e.era()},json:function(e){return e.json()},timezone:function(e){return e.timezone().name},offset:function(e){return mn(e)},numeric:function(e){return"".concat(e.year(),"/").concat(wt.zeroPad(e.month()+1),"/").concat(wt.zeroPad(e.date()))},"numeric-us":function(e){return"".concat(wt.zeroPad(e.month()+1),"/").concat(wt.zeroPad(e.date()),"/").concat(e.year())},"numeric-uk":function(e){return"".concat(wt.zeroPad(e.date()),"/").concat(wt.zeroPad(e.month()+1),"/").concat(e.year())},"mm/dd":function(e){return"".concat(wt.zeroPad(e.month()+1),"/").concat(wt.zeroPad(e.date()))},iso:function(e){var t=e.format("iso-year"),n=wt.zeroPad(e.month()+1),i=wt.zeroPad(e.date()),o=wt.zeroPad(e.h24()),a=wt.zeroPad(e.minute()),r=wt.zeroPad(e.second()),c=wt.zeroPad(e.millisecond(),3),s=mn(e);return"".concat(t,"-").concat(n,"-").concat(i,"T").concat(o,":").concat(a,":").concat(r,".").concat(c).concat(s)},"iso-short":function(e){var t=wt.zeroPad(e.month()+1),n=wt.zeroPad(e.date());return"".concat(e.year(),"-").concat(t,"-").concat(n)},"iso-utc":function(e){return new Date(e.epoch).toISOString()},nice:function(e){return"".concat(Bt()[e.month()]," ").concat(wt.ordinal(e.date()),", ").concat(e.time())},"nice-year":function(e){return"".concat(Bt()[e.month()]," ").concat(wt.ordinal(e.date()),", ").concat(e.year())},"nice-day":function(e){return"".concat(dn()[e.day()]," ").concat(wt.titleCase(Bt()[e.month()])," ").concat(wt.ordinal(e.date()))},"nice-full":function(e){return"".concat(e.dayName()," ").concat(wt.titleCase(e.monthName())," ").concat(wt.ordinal(e.date()),", ").concat(e.time())}},bn={"day-name":"day","month-name":"month","iso 8601":"iso","time-h24":"time-24","time-12":"time","time-h12":"time",tz:"timezone","day-num":"day-number","month-num":"month-number","month-iso":"iso-month","year-iso":"iso-year","nice-short":"nice",mdy:"numeric-us",dmy:"numeric-uk",ymd:"numeric","yyyy/mm/dd":"numeric","mm/dd/yyyy":"numeric-us","dd/mm/yyyy":"numeric-us","little-endian":"numeric-uk","big-endian":"numeric","day-nice":"nice-day"};Object.keys(bn).forEach((function(e){return hn[e]=hn[bn[e]]}));var gn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!0!==e.isValid())return"";if(hn.hasOwnProperty(t)){var n=hn[t](e)||"";return"json"!==t&&(n=String(n),"ampm"!==t&&(n=wt.titleCase(n))),n}if(-1!==t.indexOf("{")){var i=/\{(.+?)\}/g;return t.replace(i,(function(t,n){return n=n.toLowerCase().trim(),hn.hasOwnProperty(n)?String(hn[n](e)||""):""}))}return e.format("iso-short")},pn=wt.zeroPad,vn=wt.formatTimezone,_n={G:function(e){return e.era()},GG:function(e){return e.era()},GGG:function(e){return e.era()},GGGG:function(e){return"AD"===e.era()?"Anno Domini":"Before Christ"},y:function(e){return e.year()},yy:function(e){return parseInt(String(e.year()).substr(2,4),10)},yyy:function(e){return e.year()},yyyy:function(e){return e.year()},yyyyy:function(e){return"0"+e.year()},Q:function(e){return e.quarter()},QQ:function(e){return e.quarter()},QQQ:function(e){return e.quarter()},QQQQ:function(e){return e.quarter()},M:function(e){return e.month()+1},MM:function(e){return pn(e.month()+1)},MMM:function(e){return e.format("month-short")},MMMM:function(e){return e.format("month")},w:function(e){return e.week()},ww:function(e){return pn(e.week())},d:function(e){return e.date()},dd:function(e){return pn(e.date())},D:function(e){return e.dayOfYear()},DD:function(e){return pn(e.dayOfYear())},DDD:function(e){return pn(e.dayOfYear(),3)},E:function(e){return e.format("day-short")},EE:function(e){return e.format("day-short")},EEE:function(e){return e.format("day-short")},EEEE:function(e){return e.format("day")},EEEEE:function(e){return e.format("day")[0]},e:function(e){return e.day()},ee:function(e){return e.day()},eee:function(e){return e.format("day-short")},eeee:function(e){return e.format("day")},eeeee:function(e){return e.format("day")[0]},a:function(e){return e.ampm().toUpperCase()},aa:function(e){return e.ampm().toUpperCase()},aaa:function(e){return e.ampm().toUpperCase()},aaaa:function(e){return e.ampm().toUpperCase()},h:function(e){return e.h12()},hh:function(e){return pn(e.h12())},H:function(e){return e.hour()},HH:function(e){return pn(e.hour())},m:function(e){return e.minute()},mm:function(e){return pn(e.minute())},s:function(e){return e.second()},ss:function(e){return pn(e.second())},A:function(e){return e.epoch-e.startOf("day").epoch},z:function(e){return e.timezone().name},zz:function(e){return e.timezone().name},zzz:function(e){return e.timezone().name},zzzz:function(e){return e.timezone().name},Z:function(e){return vn(e.timezone().current.offset)},ZZ:function(e){return vn(e.timezone().current.offset)},ZZZ:function(e){return vn(e.timezone().current.offset)},ZZZZ:function(e){return vn(e.timezone().current.offset,":")}},yn=function(e,t,n){for(var i=e,o=t,a=0;a<n;a+=1)_n[i]=_n[o],i+=e,o+=t};yn("q","Q",4),yn("L","M",4),yn("Y","y",4),yn("c","e",4),yn("k","H",2),yn("K","h",2),yn("S","s",2),yn("v","z",4),yn("V","Z",4);var Cn=["year","season","quarter","month","week","day","quarterHour","hour","minute"],wn=function(e,t){var n=e.clone().startOf(t),i=e.clone().endOf(t);return parseFloat(((e.epoch-n.epoch)/(i.epoch-n.epoch)).toFixed(2))},On=function(e,t,n){var i=0;for(e=e.clone();e.isBefore(t);)e=e.add(1,n),i+=1;return e.isAfter(t,n)&&(i-=1),i},kn=function(e,t,n){return e.isBefore(t)?On(e,t,n):-1*On(t,e,n)},xn={months:{almost:10,over:4},days:{almost:25,over:10},hours:{almost:20,over:8},minutes:{almost:50,over:20},seconds:{almost:50,over:20}};function Pn(e,t){return 1===e&&(t=t.slice(0,-1)),e+" "+t}var Mn={north:[["spring",2,1],["summer",5,1],["fall",8,1],["autumn",8,1],["winter",11,1]],south:[["fall",2,1],["autumn",2,1],["winter",5,1],["spring",8,1],["summer",11,1]]},Vn=[null,[0,1],[3,1],[6,1],[9,1]],Wn={minute:function(e){return Ut(e,{second:0,millisecond:0}),e},quarterhour:function(e){var t=e.minutes();return e=e.minutes(t>=45?45:t>=30?30:t>=15?15:0),Ut(e,{second:0,millisecond:0}),e},hour:function(e){return Ut(e,{minute:0,second:0,millisecond:0}),e},day:function(e){return Ut(e,{hour:0,minute:0,second:0,millisecond:0}),e},week:function(e){var t=e.clone();return(e=e.day(e._weekStart)).isAfter(t)&&(e=e.subtract(1,"week")),Ut(e,{hour:0,minute:0,second:0,millisecond:0}),e},month:function(e){return Ut(e,{date:1,hour:0,minute:0,second:0,millisecond:0}),e},quarter:function(e){var t=e.quarter();return Vn[t]&&Ut(e,{month:Vn[t][0],date:Vn[t][1],hour:0,minute:0,second:0,millisecond:0}),e},season:function(e){var t=e.season(),n="north";"South"===e.hemisphere()&&(n="south");for(var i=0;i<Mn[n].length;i++)if(Mn[n][i][0]===t){var o=e.year();return"winter"===t&&e.month()<3&&(o-=1),Ut(e,{year:o,month:Mn[n][i][1],date:Mn[n][i][2],hour:0,minute:0,second:0,millisecond:0}),e}return e},year:function(e){return Ut(e,{month:0,date:1,hour:0,minute:0,second:0,millisecond:0}),e},decade:function(e){var t=(e=e.startOf("year")).year(),n=10*parseInt(t/10,10);return e.year(n)},century:function(e){var t=(e=e.startOf("year")).year(),n=100*parseInt(t/100,10);return e.year(n)}};Wn.date=Wn.day;var In=function(e){return!!dn().find((function(t){return t===e}))||!!fn().find((function(t){return t===e}))},zn=function(e){var t=e.timezones,n=e.tz;if(!1===t.hasOwnProperty(n)&&(n=Nt(e.tz,t)),null===n)return!1===e.silent&&console.warn("Warn: could not find given or local timezone - '"+e.tz+"'"),{current:{epochShift:0}};var i,o,a=t[n],r={name:(i=n,i=(i=(i=i[0].toUpperCase()+i.substr(1)).replace(/\/gmt/,"/GMT")).replace(/[\/_]([a-z])/gi,(function(e){return e.toUpperCase()}))),hasDst:Boolean(a.dst),default_offset:a.offset,hemisphere:"s"===a.hem?"South":"North",current:{}};if(r.hasDst){var c=(o=a.dst)?o.split("->"):[];r.change={start:c[0],back:c[1]}}var s=a.offset,u=s;return!0===r.hasDst&&(u="North"===r.hemisphere?s-1:a.offset+1),!1===r.hasDst?(r.current.offset=s,r.current.isDST=!1):!0===kt(e.epoch,r.change.start,r.change.back,s)?(r.current.offset=s,r.current.isDST="North"===r.hemisphere):(r.current.offset=u,r.current.isDST="South"===r.hemisphere),r},En=["century","decade","year","month","date","day","hour","minute","second","millisecond"],jn={set:function(e,t){var n=this.clone();return n=sn(n,e),t&&(this.tz=Nt(t)),n},timezone:function(){return zn(this)},isDST:function(){return zn(this).current.isDST},hasDST:function(){return zn(this).hasDst},offset:function(){return 60*zn(this).current.offset},hemisphere:function(){return zn(this).hemisphere},format:function(e){return gn(this,e)},unixFmt:function(e){return function(e,t){for(var n=t.split(""),i=[n[0]],o=!1,a=1;a<n.length;a+=1){if("'"===n[a]){if(1!=(o=!o)||!n[a+1]||"'"!==n[a+1])continue;o=!0}!0===o||n[a]===i[i.length-1][0]?i[i.length-1]+=n[a]:i.push(n[a])}return i.reduce((function(t,n){return t+(void 0!==_n[n]?_n[n](e)||"":n)}),"")}(this,e)},startOf:function(e){return function(e,t){var n=e.clone();return t=wt.normalize(t),Wn[t]?Wn[t](n):"summer"===t||"winter"===t?(n=n.season(t),Wn.season(n)):n}(this,e)},endOf:function(e){return function(e,t){var n=e.clone();return t=wt.normalize(t),Wn[t]?n=(n=(n=Wn[t](n)).add(1,t)).subtract(1,"milliseconds"):n}(this,e)},leapYear:function(){var e=this.year();return wt.isLeapYear(e)},progress:function(e){return function(e,t){if(t)return t=wt.normalize(t),wn(e,t);var n={};return Cn.forEach((function(t){n[t]=wn(e,t)})),n}(this,e)},nearest:function(e){return function(e,t){var n=e.progress();return"quarterhour"===(t=wt.normalize(t))&&(t="quarterHour"),void 0!==n[t]?(n[t]>.5&&(e=e.add(1,t)),e=e.startOf(t)):!1===e.silent&&console.warn("no known unit '"+t+"'"),e}(this,e)},diff:function(e,t){return function(e,t,n){t=wt.beADate(t,e);var i=!1;if(e.isAfter(t)){var o=e;e=t,t=o,i=!0}var a=function(e,t){var n=t.epoch-e.epoch,i={milliseconds:n,seconds:parseInt(n/1e3,10)};i.minutes=parseInt(i.seconds/60,10),i.hours=parseInt(i.minutes/60,10);var o=e.clone();return i.years=function(e,t){var n=t.year()-e.year();return(e=e.year(t.year())).isAfter(t)&&(n-=1),n}(o,t),o=e.add(i.years,"year"),i.months=12*i.years,o=e.add(i.months,"month"),i.months+=kn(o,t,"month"),i.weeks=52*i.years,o=e.add(i.weeks,"week"),i.weeks+=kn(o,t,"week"),i.days=7*i.weeks,o=e.add(i.days,"day"),i.days+=kn(o,t,"day"),i}(e,t);return i&&(a=function(e){return Object.keys(e).forEach((function(t){e[t]*=-1})),e}(a)),n?(n=wt.normalize(n),!0!==/s$/.test(n)&&(n+="s"),"dates"===n&&(n="days"),a[n]):a}(this,e,t)},since:function(e){return e||(e=this.clone().set()),function(e,t){var n,i,o,a=function(e,t){var n=e.isBefore(t),i=n?t:e,o=n?e:t;o=o.clone();var a={years:0,months:0,days:0,hours:0,minutes:0,seconds:0};return Object.keys(a).forEach((function(e){if(!o.isSame(i,e)){var t=o.diff(i,e);o=o.add(t,e),a[e]=t}})),n&&Object.keys(a).forEach((function(e){0!==a[e]&&(a[e]*=-1)})),a}(e,t=wt.beADate(t,e));if(!0===Object.keys(a).every((function(e){return!a[e]})))return{diff:a,rounded:"now",qualified:"now",precise:"now"};var r=[];return Object.keys(a).forEach((function(e,t,o){var c=Math.abs(a[e]);if(0!==c){var s=Pn(c,e);if(r.push(s),!n){if(n=i=s,t>4)return;var u=o[t+1],l=Math.abs(a[u]);l>xn[u].almost?(n=Pn(c+1,e),i="almost "+n):l>xn[u].over&&(i="over "+s)}}})),o=r.splice(0,2).join(", "),!0===e.isAfter(t)?(n+=" ago",i+=" ago",o+=" ago"):(n="in "+n,i="in "+i,o="in "+o),{diff:a,rounded:n,qualified:i,precise:o}}(this,e)},next:function(e){return this.add(1,e).startOf(e)},last:function(e){return this.subtract(1,e).startOf(e)},isValid:function(){return!(!this.epoch&&0!==this.epoch||isNaN(this.d.getTime()))},goto:function(e){var t=this.clone();return t.tz=Nt(e,t.timezones),t},every:function(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;if(!t||!n)return[];if(t=wt.normalize(t),n=e.clone().set(n),e.isAfter(n)){var i=e;e=n,n=i}var o=e.clone();In(t)?(o=o.next(t),t="week"):o=o.next(t);for(var a=[];o.isBefore(n);)a.push(o),o=o.add(1,t);return a}(this,e,t)},isAwake:function(){var e=this.hour();return!(e<8||e>22)},isAsleep:function(){return!this.isAwake()},log:function(){return console.log(""),console.log(gn(this,"nice-short")),this},logYear:function(){return console.log(""),console.log(gn(this,"full-short")),this},json:function(){var e=this;return En.reduce((function(t,n){return t[n]=e[n](),t}),{})},debug:function(){var e=this.timezone(),t=this.format("MM")+" "+this.format("date-ordinal")+" "+this.year();return t+="\n     - "+this.format("time"),console.log("\n\n",t+"\n     - "+e.name+" ("+e.current.offset+")"),this},from:function(e){return(e=this.clone().set(e)).since(this)},fromNow:function(){return this.clone().set(Date.now()).since(this)},weekStart:function(e){if("number"==typeof e)return this._weekStart=e,this;if("string"==typeof e){e=e.toLowerCase().trim();var t=dn().indexOf(e);-1===t&&(t=fn().indexOf(e)),-1===t&&(t=1),this._weekStart=t}else console.warn("Spacetime Error: Cannot understand .weekStart() input:",e);return this}};jn.inDST=jn.isDST,jn.round=jn.nearest,jn.each=jn.every;var Gn=jn,Fn=function(e){return"string"==typeof e&&(e=parseInt(e,10)),e},Dn=["year","month","date","hour","minute","second","millisecond"],Sn=function(e,t,n){for(var i=Dn.indexOf(n),o=Dn.slice(i,Dn.length),a=0;a<o.length;a++){var r=t[o[a]]();e[o[a]](r)}return e},qn=function(e,t){t=Fn(t);var n=e.clone(),i=e.minute()-t;return e.epoch-=i*$t.minute,Sn(e,n,"second"),e.epoch},An=function(e,t){(t=Fn(t))>=24?t=24:t<0&&(t=0);var n=e.clone(),i=e.hour()-t;return e.epoch-=i*$t.hour,Ut(e,{hour:t}),Sn(e,n,"minute"),e.epoch},Tn=function(e,t){return t=Fn(t),Ut(e,{year:t}),e.epoch},Nn=function(e){return(e=(e=e.minute(0)).second(0)).millisecond(1)},Rn=Object.assign({},{millisecond:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){t=Fn(t);var n=e.millisecond();return e.epoch-(n-t)}(t,e),t}return this.d.getMilliseconds()},second:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){t=Fn(t);var n=e.second()-t;return e.epoch-n*$t.second}(t,e),t}return this.d.getSeconds()},minute:function(e){if(void 0!==e){var t=this.clone();return t.epoch=qn(t,e),t}return this.d.getMinutes()},hour:function(e){var t=this.d;if(void 0!==e){var n=this.clone();return n.epoch=An(n,e),n}return t.getHours()},hourFloat:function(e){if(void 0!==e){var t=this.clone(),n=e%1;n*=60;var i=parseInt(e,10);return t.epoch=An(t,i),t.epoch=qn(t,n),t}var o=this.d;return o.getHours()+o.getMinutes()/60},hour12:function(e){var t=this.d;if(void 0!==e){var n=this.clone(),i=(e=""+e).match(/^([0-9]+)(am|pm)$/);if(i){var o=parseInt(i[1],10);"pm"===i[2]&&(o+=12),n.epoch=An(n,o)}return n}var a=t.getHours();return a>12&&(a-=12),0===a&&(a=12),a},time:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){var n=t.match(/([0-9]{1,2}):([0-9]{1,2})(am|pm)?/);if(!n){if(!(n=t.match(/([0-9]{1,2})(am|pm)/)))return e.epoch;n.splice(2,0,"0")}var i=!1,o=parseInt(n[1],10),a=parseInt(n[2],10);return o>12&&(i=!0),!1===i&&("am"===n[3]&&12===o&&(o=0),"pm"===n[3]&&o<12&&(o+=12)),(e=(e=(e=(e=e.hour(o)).minute(a)).second(0)).millisecond(0)).epoch}(t,e),t}return"".concat(this.h12(),":").concat(wt.zeroPad(this.minute())).concat(this.ampm())},ampm:function(e){var t="am",n=this.hour();if(n>=12&&(t="pm"),"string"!=typeof e)return t;var i=this.clone();return e=e.toLowerCase().trim(),n>=12&&"am"===e?i.hour(n-=12):n<12&&"pm"===e?i.hour(n+=12):i},dayTime:function(e){if(void 0!==e){var t={morning:"7:00am",breakfast:"7:00am",noon:"12:00am",lunch:"12:00pm",afternoon:"2:00pm",evening:"6:00pm",dinner:"6:00pm",night:"11:00pm",midnight:"23:59pm"},n=this.clone();return e=(e=e||"").toLowerCase(),!0===t.hasOwnProperty(e)&&(n=n.time(t[e])),n}var i=this.hour();return i<6?"night":i<12?"morning":i<17?"afternoon":i<22?"evening":"night"},iso:function(e){return void 0!==e?this.set(e):this.format("iso")}},{date:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){if((t=Fn(t))>28){var n=Zt[e.month()];t>n&&(t=n)}return t<=0&&(t=1),Ut(e,{date:t}),e.epoch}(t,e),t}return this.d.getDate()},day:function(e){if(void 0===e)return this.d.getDay();var t=this.clone(),n=e;"string"==typeof e&&(e=e.toLowerCase(),-1===(n=dn().indexOf(e))&&(n=fn().indexOf(e)));var i=this.d.getDay(),o=this.subtract(24*(i-n),"hours");return Ut(o,{hour:t.hour(),minute:t.minute(),second:t.second()}),o},dayName:function(e){return void 0===e?fn()[this.day()]:this.clone().day(e)},month:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){"string"==typeof t&&(t=Xt()[t.toLowerCase()]),(t=Fn(t))>=12&&(t=11),t<=0&&(t=0);var n=e.date();return n>Zt[t]&&(n=Zt[t]),Ut(e,{month:t,date:n}),e.epoch}(t,e),t}return this.d.getMonth()}},{dayOfYear:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){t=Fn(t);var n=e.clone();return(t-=1)<=0?t=0:t>=365&&(t=364),e=(e=e.startOf("year")).add(t,"day"),Sn(e,n,"hour"),e.epoch}(t,e),t}for(var n,i=0,o=this.d.getMonth(),a=1;a<=o;a++)(n=new Date).setDate(1),n.setFullYear(this.d.getFullYear()),n.setHours(1),n.setMinutes(1),n.setMonth(a),n.setHours(-2),i+=n.getDate();return i+this.d.getDate()},week:function(e){if(void 0!==e){var t=this.clone();return t=(t=(t=t.month(0)).date(1)).day("monday"),"december"===(t=Nn(t)).monthName()&&(t=t.add(1,"week")),t.add(e-=1,"weeks")}var n=this.clone();n=(n=n.month(0)).date(1),"december"===(n=(n=Nn(n)).day("monday")).monthName()&&(n=n.add(1,"week"));var i=1;1===n.date()&&(i=0),n=n.minus(1,"second");var o=this.epoch;if(n.epoch>o)return 1;var a=0,r=4*this.month();for(n.epoch+=$t.week*r,a+=r;a<52;a++){if(n.epoch>o)return a+i;n=n.add(1,"week")}return 52},monthName:function(e){return void 0===e?Lt[this.month()]:this.clone().month(e)},quarter:function(e){if(void 0!==e&&("string"==typeof e&&(e=e.replace(/^q/i,""),e=parseInt(e,10)),Vn[e])){var t=this.clone();return(t=(t=t.month(Vn[e][0])).date(1)).startOf("day")}for(var n=this.d.getMonth(),i=1;i<Vn.length;i++)if(n<Vn[i][0])return i-1;return 4},season:function(e){var t="north";if("South"===this.hemisphere()&&(t="south"),void 0!==e){for(var n=this.clone(),i=0;i<Mn[t].length;i++)e===Mn[t][i][0]&&(n=(n=(n=n.month(Mn[t][i][1])).date(1)).startOf("day"));return n}for(var o=this.d.getMonth(),a=0;a<Mn[t].length-1;a++)if(o>=Mn[t][a][1]&&o<Mn[t][a+1][1])return Mn[t][a][0];return"winter"},year:function(e){if(void 0!==e){var t=this.clone();return t.epoch=Tn(t,e),t}return this.d.getFullYear()},era:function(e){if(void 0!==e){var t=this.clone();e=e.toLowerCase();var n=t.d.getFullYear();return"bc"===e&&n>0&&(t.epoch=Tn(t,-1*n)),"ad"===e&&n<0&&(t.epoch=Tn(t,-1*n)),t}return this.d.getFullYear()<0?"BC":"AD"},decade:function(e){if(void 0!==e){if(!(e=(e=(e=String(e)).replace(/([0-9])'?s$/,"$1")).replace(/([0-9])(th|rd|st|nd)/,"$1")))return console.warn("Spacetime: Invalid decade input"),this;2===e.length&&/[0-9][0-9]/.test(e)&&(e="19"+e);var t=Number(e);return isNaN(t)?this:(t=10*Math.floor(t/10),this.year(t))}return this.startOf("decade").year()},century:function(e){if(void 0!==e){"string"==typeof e&&(e=(e=(e=e.replace(/([0-9])(th|rd|st|nd)/,"$1")).replace(/([0-9]+) ?(b\.?c\.?|a\.?d\.?)/i,(function(e,t,n){return n.match(/b\.?c\.?/i)&&(t="-"+t),t}))).replace(/c$/,""));var t=Number(e);return isNaN(e)?(console.warn("Spacetime: Invalid century input"),this):(0===t&&(t=1),this.year(t=t>=0?100*(t-1):100*(t+1)))}var n=this.startOf("century").year();return(n=Math.floor(n/100))<0?n-1:n+1},millenium:function(e){if(void 0!==e){if("string"==typeof e&&(e=e.replace(/([0-9])(th|rd|st|nd)/,"$1"),e=Number(e),isNaN(e)))return console.warn("Spacetime: Invalid millenium input"),this;e>0&&(e-=1);var t=1e3*e;return 0===t&&(t=1),this.year(t)}var n=Math.floor(this.year()/1e3);return n>=0&&(n+=1),n}});Rn.milliseconds=Rn.millisecond,Rn.seconds=Rn.second,Rn.minutes=Rn.minute,Rn.hours=Rn.hour,Rn.hour24=Rn.hour,Rn.h12=Rn.hour12,Rn.h24=Rn.hour24,Rn.days=Rn.day;var $n=["millisecond","second","minute","hour","date","month"],Hn={second:$n.slice(0,1),minute:$n.slice(0,2),quarterhour:$n.slice(0,2),hour:$n.slice(0,3),date:$n.slice(0,4),month:$n.slice(0,4),quarter:$n.slice(0,4),season:$n.slice(0,4),year:$n,decade:$n,century:$n};Hn.week=Hn.hour,Hn.season=Hn.date,Hn.quarter=Hn.date;var Qn={year:!0,quarter:!0,season:!0,month:!0,week:!0,day:!0},Un={month:!0,quarter:!0,season:!0,year:!0},Yn={millisecond:function(e){return e.epoch},second:function(e){return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second()].join("-")},minute:function(e){return[e.year(),e.month(),e.date(),e.hour(),e.minute()].join("-")},hour:function(e){return[e.year(),e.month(),e.date(),e.hour()].join("-")},day:function(e){return[e.year(),e.month(),e.date()].join("-")},week:function(e){return[e.year(),e.week()].join("-")},month:function(e){return[e.year(),e.month()].join("-")},quarter:function(e){return[e.year(),e.quarter()].join("-")},year:function(e){return e.year()}};Yn.date=Yn.day;var Ln,Bn=jt,Xn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.epoch=null,this.tz=Nt(t,Bn),this.silent=n.silent||!0,this.british=n.dmy||n.british,this._weekStart=1,void 0!==n.weekStart&&(this._weekStart=n.weekStart),Object.defineProperty(this,"d",{get:function(){var e=xt(this),t=(new Date(this.epoch).getTimezoneOffset()||0)+60*e;return t=60*t*1e3,new Date(this.epoch+t)}}),Object.defineProperty(this,"timezones",{get:function(){return Bn},set:function(e){return Bn=e,e}}),void 0!==e||null===e){var i=sn(this,e,t);this.epoch=i.epoch}};Object.keys(Gn).forEach((function(e){Xn.prototype[e]=Gn[e]})),Xn.prototype.clone=function(){return new Xn(this.epoch,this.tz,{silent:this.silent,weekStart:this._weekStart})},Xn.prototype.toLocalDate=function(){return new Date(this.epoch)},Ln=Xn,Object.keys(Rn).forEach((function(e){Ln.prototype[e]=Rn[e]})),function(e){e.prototype.add=function(e,t){var n=this.clone();if(!t||0===e)return n;var i=this.clone();t=wt.normalize(t),$t[t]?n.epoch+=$t[t]*e:"week"===t?n.epoch+=$t.day*(7*e):"quarter"===t||"season"===t?n.epoch+=$t.month*(4*e):"season"===t?n.epoch+=$t.month*(4*e):"quarterhour"===t&&(n.epoch+=15*$t.minute*e);var o={};if(Hn[t]&&Hn[t].forEach((function(e){o[e]=i[e]()})),Qn[t]){var a=i.timezone().current.offset-n.timezone().current.offset;n.epoch+=3600*a*1e3}if("month"===t&&(o.month=i.month()+e,o=function(e,t){if(e.month>0){var n=parseInt(e.month/12,10);e.year=t.year()+n,e.month=e.month%12}else if(e.month<0){var i=Math.floor(Math.abs(e.month)/13,10);i=Math.abs(i)+1,e.year=t.year()-i,e.month=e.month%12,e.month=e.month+12,12===e.month&&(e.month=0)}return e}(o,i)),"week"===t){var r=i.date()+7*e;r<=28&&r>1&&(o.date=r)}else if("date"===t){var c=i.date()+e;c<=28&&c>1?o.date=c:0!==e&&i.isSame(n,"day")&&(o.date=i.date()+e)}else"year"===t&&n.year()===i.year()?n.epoch+=$t.week:"decade"===t?o.year=n.year()+10:"century"===t&&(o.year=n.year()+100);if(Un[t]){var s=Zt[o.month];o.date=i.date(),o.date>s&&(o.date=s)}return Ut(n,o),n},e.prototype.subtract=function(e,t){return this.clone().add(-1*e,t)},e.prototype.minus=e.prototype.subtract,e.prototype.plus=e.prototype.add}(Xn),function(e){e.prototype.isSame=function(t,n){return n?("string"!=typeof t&&"number"!=typeof t||(t=new e(t,this.timezone.name)),n=n.replace(/s$/,""),Yn[n]?Yn[n](this)===Yn[n](t):null):null}}(Xn),function(e){var t={isAfter:function(e){e=wt.beADate(e,this);var t=wt.getEpoch(e);return null===t?null:this.epoch>t},isBefore:function(e){e=wt.beADate(e,this);var t=wt.getEpoch(e);return null===t?null:this.epoch<t},isEqual:function(e){e=wt.beADate(e,this);var t=wt.getEpoch(e);return null===t?null:this.epoch===t},isBetween:function(e,t){e=wt.beADate(e,this),t=wt.beADate(t,this);var n=wt.getEpoch(e);if(null===n)return null;var i=wt.getEpoch(t);return null===i?null:n<this.epoch&&this.epoch<i}};Object.keys(t).forEach((function(n){e.prototype[n]=t[n]}))}(Xn),function(e){var t={i18n:function(e){var t;wt.isObject(e.days)&&(un=(t=e.days).short||un,ln=t.long||ln),wt.isObject(e.months)&&function(e){Yt=e.short||Yt,Lt=e.long||Lt}(e.months)}};Object.keys(t).forEach((function(n){e.prototype[n]=t[n]}))}(Xn);var Kn=Xn,Zn=function(e,t,n){return new Kn(e,t,n)};Zn.now=function(e,t){return new Kn((new Date).getTime(),e,t)},Zn.today=function(e,t){return new Kn((new Date).getTime(),e,t).startOf("day")},Zn.tomorrow=function(e,t){return new Kn((new Date).getTime(),e,t).add(1,"day").startOf("day")},Zn.yesterday=function(e,t){return new Kn((new Date).getTime(),e,t).subtract(1,"day").startOf("day")},Zn.extend=function(e){return Object.keys(e).forEach((function(t){Kn.prototype[t]=e[t]})),this},Zn.whereIts=function(e,t){var n=new Kn(null),i=new Kn(null);n=n.time(e),i=t?i.time(t):n.add(59,"minutes");var o=n.hour(),a=i.hour();return Object.keys(n.timezones).filter((function(e){if(-1===e.indexOf("/"))return!1;var t=new Kn(null,e),r=t.hour();return r>=o&&r<=a&&!(r===o&&t.minute()<n.minute())&&!(r===a&&t.minute()>i.minute())}))},Zn.version="6.4.1",Zn.plugin=Zn.extend;var Jn=Zn,ei=n("d3UM"),ti=n("FKr1");function ni(e,t){if(1&e&&(u.Wb(0,"div",8),u.Rb(1,"a-catering-order-item",9),u.Vb()),2&e){var n=t.$implicit,i=u.ic(2);u.Cb(1),u.oc("disabled",i.disabled)("symbol",i.symbol)("item",n)("field",i.items)}}function ii(e,t){if(1&e&&(u.Ub(0),u.Ec(1,ni,2,4,"div",7),u.Tb()),2&e){var n=u.ic();u.Cb(1),u.oc("ngForOf",n.category.items)}}var oi=function(){return{class:"material-icons",content:"close"}};function ai(e,t){1&e&&(u.Wb(0,"div",10),u.Wb(1,"div",11),u.Rb(2,"app-icon",3),u.Vb(),u.Wb(3,"div",12),u.Gc(4,"Category contains no available items"),u.Vb(),u.Vb()),2&e&&(u.Cb(2),u.oc("icon",u.pc(1,oi)))}var ri,ci=function(){return{class:"material-icons",content:"arrow_back"}},si=((ri=function(){function e(){_classCallCheck(this,e),this.close=new u.n}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||ri)},ri.\u0275cmp=u.Kb({type:ri,selectors:[["a-category-display"]],inputs:{category:"category",items:"items",symbol:"symbol",disabled:"disabled"},outputs:{close:"close"},decls:9,vars:5,consts:[[1,"header"],[1,"content"],["mat-icon-button","",3,"tapped"],[3,"icon"],[1,"name"],[4,"ngIf","ngIfElse"],["empty_state",""],["class","item",4,"ngFor","ngForOf"],[1,"item"],[3,"disabled","symbol","item","field"],[1,"info-block","center"],[1,"icon"],[1,"text"]],template:function(e,t){if(1&e&&(u.Wb(0,"div",0),u.Wb(1,"div",1),u.Wb(2,"button",2),u.ec("tapped",(function(){return t.close.emit()})),u.Rb(3,"app-icon",3),u.Vb(),u.Wb(4,"div",4),u.Gc(5),u.Vb(),u.Vb(),u.Vb(),u.Ec(6,ii,2,1,"ng-container",5),u.Ec(7,ai,5,2,"ng-template",null,6,u.Fc)),2&e){var n=u.tc(8);u.Cb(3),u.oc("icon",u.pc(4,ci)),u.Cb(2),u.Hc(null==t.category?null:t.category.name),u.Cb(1),u.oc("ngIf",t.category.items&&t.category.items.length)("ngIfElse",n)}},directives:[w.b,k.c,O.a,i.t,i.s,gt],styles:[".header[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;width:100%;background-color:#fff;border-bottom:1px solid #ccc;padding:.5em;z-index:1}.header[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;align-items:center;width:640px;max-width:100vw;margin:auto}.header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{flex:1;text-align:center;margin-right:3em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.item[_ngcontent-%COMP%]{position:relative;width:640px;margin:.5em auto;background-color:#fff;border:1px solid #ccc;border-radius:4px;overflow:hidden;max-width:calc(100vw - 1em);z-index:0}"]}),ri);function ui(e,t){if(1&e&&(u.Wb(0,"mat-option",17),u.Gc(1),u.Vb()),2&e){var n=t.$implicit;u.oc("value",n),u.Cb(1),u.Ic(" ",n.name," ")}}function li(e,t){if(1&e&&(u.Wb(0,"mat-option",17),u.Gc(1),u.Vb()),2&e){var n=t.$implicit;u.oc("value",n.id),u.Cb(1),u.Ic(" ",n.name," ")}}function di(e,t){if(1&e&&(u.Wb(0,"div",9),u.Wb(1,"form",10),u.Wb(2,"div",11),u.Wb(3,"label"),u.Gc(4,"Deliver to:"),u.Vb(),u.Wb(5,"mat-form-field",12),u.Wb(6,"mat-select",13),u.Ec(7,ui,2,2,"mat-option",14),u.Vb(),u.Vb(),u.Vb(),u.Wb(8,"div",11),u.Wb(9,"label",15),u.Gc(10,"At:"),u.Vb(),u.Wb(11,"mat-form-field",12),u.Wb(12,"mat-select",16),u.Ec(13,li,2,2,"mat-option",14),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&e){var n=u.ic();u.Cb(1),u.oc("formGroup",n.form),u.Cb(6),u.oc("ngForOf",n.space_list),u.Cb(6),u.oc("ngForOf",n.available_times)}}function fi(e,t){if(1&e){var n=u.Xb();u.Wb(0,"button",23),u.ec("tapped",(function(){u.wc(n);var e=t.$implicit;return u.ic(4).active_category=e})),u.Rb(1,"div",24),u.Wb(2,"div",25),u.Gc(3),u.Vb(),u.Vb()}if(2&e){var i=t.$implicit,o=u.ic(4);u.Dc("background-image","url("+i.image_path+")",u.Jb),u.oc("disabled",o.within_restricted_time&&!i.can_order_anytime),u.Cb(3),u.Hc(i.name)}}function mi(e,t){if(1&e&&(u.Wb(0,"div",21),u.Ec(1,fi,4,4,"button",22),u.Vb()),2&e){var n=u.ic(3);u.Cb(1),u.oc("ngForOf",n.category_list)}}function hi(e,t){if(1&e&&(u.Ub(0),u.Ec(1,mi,2,1,"div",20),u.Tb()),2&e){var n=u.ic(2),i=u.tc(9);u.Cb(1),u.oc("ngIf",n.can_order&&n.category_list.length)("ngIfElse",i)}}function bi(e,t){if(1&e&&(u.Wb(0,"div",18),u.Ec(1,hi,2,2,"ng-container",19),u.Vb()),2&e){var n=u.ic(),i=u.tc(13);u.Cb(1),u.oc("ngIf",!n.active_category)("ngIfElse",i)}}function gi(e,t){if(1&e&&(u.Wb(0,"span",29),u.Gc(1),u.Vb()),2&e){var n=u.ic(2);u.Cb(1),u.Ic(" at least ",(null==n.active_building?null:n.active_building.catering_restricted_from)||"0"," hours in advance for meetings ")}}function pi(e,t){if(1&e&&(u.Wb(0,"div",26),u.Wb(1,"div",27),u.Rb(2,"img",28),u.Vb(),u.Wb(3,"p"),u.Gc(4," Catering is "),u.Wb(5,"span",29),u.Gc(6,"not available"),u.Vb(),u.Gc(7," for this booking."),u.Rb(8,"br"),u.Gc(9," Catering must be ordered within business hours "),u.Ec(10,gi,2,1,"span",30),u.Gc(11),u.Vb(),u.Vb()),2&e){var n=u.ic();u.Cb(10),u.oc("ngIf",null==n.active_building?null:n.active_building.catering_restricted_from),u.Cb(1),u.Ic(" at ",null==n.active_building?null:n.active_building.name,". ")}}function vi(e,t){if(1&e&&(u.Wb(0,"div",18),u.Wb(1,"div",31),u.Wb(2,"div",27),u.Rb(3,"mat-spinner",32),u.Vb(),u.Wb(4,"div",33),u.Gc(5),u.Vb(),u.Vb(),u.Vb()),2&e){var n=u.ic();u.Cb(5),u.Ic("Loading menu for ",null==n.active_building?null:n.active_building.name,"...")}}function _i(e,t){if(1&e){var n=u.Xb();u.Wb(0,"a-category-display",34),u.ec("close",(function(){return u.wc(n),u.ic().active_category=null})),u.Vb()}if(2&e){var i=u.ic();u.oc("category",i.active_category)("symbol",i.symbol)("items",i.form.controls.items)("disabled",i.within_restricted_time)}}var yi,Ci=((yi=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._service=e,i._dialog=n,i.event=new u.n,i.category_list=[],i.available_times=[],i}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){this.generateAvailableTimes(),this.loadMenu()}},{key:"ngOnChanges",value:function(e){var t=this;(e.date||e.duration)&&(this.generateAvailableTimes(),this.form&&!this.available_times.find((function(e){return e.id===t.form.controls.start.value}))&&this.form.controls.start.setValue(this.available_times[0].id)),e.space_list&&this.form&&this.space_list&&!this.form.controls.space.value&&this.form.controls.space.setValue(this.space_list[0]),e.order&&this.order&&this.initForm()}},{key:"initForm",value:function(){var e=this;this.form=new a.i({id:new a.f(this.order.id),booking_date:new a.f(this.all_day?y(this.date).startOf("d").valueOf():this.date),space:new a.f(this._service.Spaces.item(this.order.location_id)||this.space_list[0]),location_id:new a.f(this.order.location_id||this.space_list[0].id),start:new a.f(this.order.delivery_time||this.available_times[0].id),items:new a.f((this.order.items||[]).map((function(e){return new Ne.a(e)})))}),this.timeout("init_items",(function(){return e.form.controls.items.setValue((e.order.items||[]).map((function(e){return new Ne.a(e)})))}),50),this.subscription("space_change",this.form.controls.space.valueChanges.subscribe((function(t){e.form.controls.location_id.setValue(t.id),e.generateAvailableTimes(),e.available_times.find((function(t){return t.id===e.form.controls.start.value}))||e.form.controls.start.setValue(e.available_times[0].id),e.loadMenu()}))),this.generateAvailableTimes(),this.form&&!this.available_times.find((function(t){return t.id===e.form.controls.start.value}))&&this.form.controls.start.setValue(this.available_times[0].id)}},{key:"confirmOrder",value:function(){var e=this,t=this._dialog.open(Ct,{maxWidth:"95vw",data:{date:this.date,form:this.form}});this.subscription("confirm_event",t.componentInstance.event.subscribe((function(n){if("done"===n.reason){var i=new j.a(e.form.value);e.event.emit(i),t.close()}}))),t.afterClosed().subscribe((function(){return e.unsub("confirm_event")}))}},{key:"loadMenu",value:function(){var e=this,t=this.form.controls.space.value;t&&(this.form.controls.items.setValue([]),this.loading=!0,this._service.Menu.query({room_id:t.id}).then((function(t){e.loading=!1,e.category_list=(t||[]).map((function(e){return new Te.a(e)}))}),(function(){return e.loading=!1})))}},{key:"generateAvailableTimes",value:function(){var e=this.all_day?y(this.date).startOf("d"):y(this.date),t=this.generateStartAndEndTimes(),n=t.start,i=t.end;for(n=n.minute(5*Math.ceil(n.minute()/5)),this.available_times=[];n.isBefore(i);)this.available_times.push({id:Math.abs(e.diff(n,"m")),name:n.format("h:mm A")}),n=n.add(5,"m");0===this.available_times.length&&this.available_times.push({id:-1,name:"Out of hours"})}},{key:"generateStartAndEndTimes",value:function(){var e=y(this.date);this.all_day&&(e=e.startOf("d"));var t=this.all_day?e.endOf("d"):e.add(this.duration,"m"),n=Jn(e.toDate());n=n.hour(7);var i=y(n.toLocalDate());if(console.log("Timezone start:",i.format("DD MMM, h:mm A")),e.isBefore(i,"m"))t=(e=i).add(13,"h");else{var o=i.hour(20);console.log("Timezone end:",o.format("DD MMM, h:mm A")),t.isAfter(o)&&(t=o)}return{start:e,end:t}}},{key:"can_order",get:function(){if(!this.form||!this.form.controls.space)return!1;var e=this.form.controls.space.value;return(this._service.Organisation.buildings.find((function(t){return t.id===e.level.building_id})).has_catering||this.category_list.length)&&(!this.within_restricted_time||this.has_available_items)}},{key:"active_building",get:function(){if(!this.form||!this.form.controls.space)return null;var e=this.form.controls.space.value;return e?this._service.Organisation.buildings.find((function(t){return e.level.building_id===t.id})):null}},{key:"symbol",get:function(){var e=this.active_building;return e&&e.currency||"USD"}},{key:"item_count",get:function(){return this.form?(this.form.controls.items.value||[]).reduce((function(e,t){return e+t.amount}),0):0}},{key:"out_of_hours",get:function(){return!!this.form&&this.form.controls.start.value<0}},{key:"within_restricted_time",get:function(){if(!this.form||!this.form.controls.space)return!1;var e=this.form.controls.space.value,t=this._service.Organisation.buildings.find((function(t){return t.id===e.level.building_id}));if(!t.catering_restricted_from||t.catering_restricted_from<=0)return!1;var n=y(),i=y(this.date).subtract(t.catering_restricted_from,"h");return n.isAfter(i,"s")}},{key:"has_available_items",get:function(){return this.category_list.reduce((function(e,t){return e||t.can_order_anytime}),!1)}}]),t}(s.a)).\u0275fac=function(e){return new(e||yi)(u.Qb(c.a),u.Qb(_.b))},yi.\u0275cmp=u.Kb({type:yi,selectors:[["a-catering-order-details"]],inputs:{order:"order",date:"date",duration:"duration",space_list:"space_list",all_day:"all_day"},outputs:{event:"event"},features:[u.zb,u.Ab],decls:14,vars:5,consts:[[1,"catering","order-details"],["class","header",4,"ngIf"],["class","body",4,"ngIf","ngIfElse"],[1,"footer"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"disabled","tapped"],["empty_state",""],["load_state",""],["category_display",""],[1,"header"],[3,"formGroup"],[1,"field"],["appearance","outline"],["formControlName","space"],[3,"value",4,"ngFor","ngForOf"],["for",""],["formControlName","start"],[3,"value"],[1,"body"],[4,"ngIf","ngIfElse"],["class","contents",4,"ngIf","ngIfElse"],[1,"contents"],["mat-button","","class","category",3,"background-image","disabled","tapped",4,"ngFor","ngForOf"],["mat-button","",1,"category",3,"disabled","tapped"],[1,"overlay"],[1,"name"],[1,"empty-state","center"],[1,"icon"],["alt","No Catering Available","src","assets/img/no-catering.svg"],[1,"bold"],["class","bold",4,"ngIf"],[1,"info-block","center"],["diameter","48"],[1,"text"],[3,"category","symbol","items","disabled","close"]],template:function(e,t){if(1&e&&(u.Wb(0,"div",0),u.Ec(1,di,14,3,"div",1),u.Ec(2,bi,2,2,"div",2),u.Wb(3,"div",3),u.Wb(4,"button",4),u.ec("tapped",(function(){return t.event.emit()})),u.Gc(5,"Back"),u.Vb(),u.Wb(6,"button",5),u.ec("tapped",(function(){return t.confirmOrder()})),u.Gc(7),u.Vb(),u.Vb(),u.Vb(),u.Ec(8,pi,12,2,"ng-template",null,6,u.Fc),u.Ec(10,vi,6,1,"ng-template",null,7,u.Fc),u.Ec(12,_i,1,4,"ng-template",null,8,u.Fc)),2&e){var n=u.tc(11);u.Cb(1),u.oc("ngIf",t.form),u.Cb(1),u.oc("ngIf",!t.loading)("ngIfElse",n),u.Cb(4),u.oc("disabled",!t.item_count||t.out_of_hours),u.Cb(1),u.Ic(" Confirm Order(",t.item_count||"0",") ")}},directives:[i.t,w.b,k.c,a.H,a.s,a.j,x.b,ei.a,a.r,a.h,i.s,ti.g,ye.c,si],styles:["[_nghost-%COMP%]{height:100%}.order-details[_ngcontent-%COMP%]{height:100%;margin:auto;max-width:100vw}.header[_ngcontent-%COMP%], .order-details[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;width:100%}.header[_ngcontent-%COMP%]{justify-content:center;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);z-index:99}.body[_ngcontent-%COMP%]{position:relative;flex:1;width:100%;min-height:50%;overflow:hidden auto}.footer[_ngcontent-%COMP%]{width:100%;text-align:center;border-top:1px solid #ccc;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:.5em}form[_ngcontent-%COMP%]{display:flex;align-items:center}.field[_ngcontent-%COMP%]{margin:0 .5em;max-height:3.5em}@media only screen and (orientation:portrait) and (max-width:450px){.field[_ngcontent-%COMP%]{max-height:4.75em}}@media only screen and (orientation:landscape) and (max-width:800px){.field[_ngcontent-%COMP%]{max-height:4.75em}}.contents[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;max-width:768px;margin:auto}.category[_ngcontent-%COMP%]{position:relative;background-position:50%;background-size:cover;height:11em;width:11em;margin:1em;border-radius:4px;border:none;padding:0;background-color:#fff;transition:box-shadow .2s}.category[_ngcontent-%COMP%]:hover{box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.category[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.35);border-radius:4px}.category[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:99;max-width:9em;white-space:normal;line-height:1.25em;margin:0}@media only screen and (orientation:portrait) and (max-width:450px){mat-form-field[_ngcontent-%COMP%]{width:11.75em}}@media only screen and (orientation:landscape) and (max-width:800px){mat-form-field[_ngcontent-%COMP%]{width:11.75em}}label[_ngcontent-%COMP%]{font-weight:500;font-size:.8em;margin-right:.75em}.empty-state[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;background-color:#fff;border-radius:4px;padding:1em;max-width:calc(100vw - 2em);box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.empty-state[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ce1a51}.empty-state[_ngcontent-%COMP%]   .bold[_ngcontent-%COMP%]{font-weight:400}.empty-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:6em;width:8em}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;max-width:24em}.info-block[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:2.5em;width:2.5em}"]}),yi);function wi(e,t){if(1&e){var n=u.Xb();u.Ub(0),u.Wb(1,"a-catering-order-list",3),u.ec("order",(function(e){u.wc(n);var t=u.ic();return e?t.active_order=e:t.newOrder()}))("event",(function(e){return u.wc(n),u.ic().event.emit(e)})),u.Vb(),u.Tb()}if(2&e){var i=u.ic();u.Cb(1),u.oc("catering",i.catering_field)("date",i.date)("all_day",i.all_day)}}function Oi(e,t){if(1&e){var n=u.Xb();u.Wb(0,"a-catering-order-details",4),u.ec("event",(function(e){u.wc(n);var t=u.ic();return e?t.handleOrderEvent(e):t.active_order=null})),u.Vb()}if(2&e){var i=u.ic();u.oc("space_list",i.space_list)("order",i.active_order)("date",i.date)("duration",i.duration)("all_day",i.all_day)}}var ki,xi,Pi=((ki=function(){function e(){_classCallCheck(this,e),this.event=new u.n}return _createClass(e,[{key:"newOrder",value:function(){var e=new j.a({});this.active_order=e}},{key:"handleOrderEvent",value:function(e){if(e){var t=this.form.controls.catering.value||[],n=t.findIndex((function(t){return e.id===t.id}));n<0?t.push(e):t.splice(n,1,e),this.form.controls.catering.setValue(t)}this.active_order=null}},{key:"catering_field",get:function(){return this.form?this.form.controls.catering:null}},{key:"space_list",get:function(){return this.form?this.form.controls.space_list.value:[]}},{key:"date",get:function(){return this.form?this.form.controls.date.value:y().valueOf()}},{key:"duration",get:function(){return this.form?this.form.controls.duration.value:60}},{key:"all_day",get:function(){return!!this.form&&this.form.controls.all_day.value}}]),e}()).\u0275fac=function(e){return new(e||ki)},ki.\u0275cmp=u.Kb({type:ki,selectors:[["booking-catering"]],inputs:{form:"form"},outputs:{event:"event"},decls:4,vars:2,consts:[[1,"catering"],[4,"ngIf","ngIfElse"],["order_display",""],[3,"catering","date","all_day","order","event"],[3,"space_list","order","date","duration","all_day","event"]],template:function(e,t){if(1&e&&(u.Wb(0,"div",0),u.Ec(1,wi,2,3,"ng-container",1),u.Vb(),u.Ec(2,Oi,1,5,"ng-template",null,2,u.Fc)),2&e){var n=u.tc(3);u.Cb(1),u.oc("ngIf",!t.active_order)("ngIfElse",n)}},directives:[i.t,Ae,Ci],styles:[".catering[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%;width:100%}"]}),ki),Mi=n("4Man"),Vi=["container"],Wi=function(){return{class:"material-icons",content:"refresh"}},Ii=((xi=function(){function e(){_classCallCheck(this,e),this.event=new u.n}return _createClass(e,[{key:"next",value:function(){this.form.markAllAsTouched(),this.form.valid?this.event.emit({type:"next",step:"form"}):this.container&&this.container.nativeElement.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}},{key:"previous",value:function(){this.event.emit({type:"previous",step:"form"})}},{key:"resetForm",value:function(){this.event.emit({type:"reset",step:"form"})}}]),e}()).\u0275fac=function(e){return new(e||xi)},xi.\u0275cmp=u.Kb({type:xi,selectors:[["booking-spaces-form"]],viewQuery:function(e,t){var n;1&e&&u.Cc(Vi,!0),2&e&&u.sc(n=u.fc())&&(t.container=n.first)},inputs:{form:"form"},outputs:{event:"event"},decls:15,vars:4,consts:[[1,"booking-form"],["container",""],[1,"header"],["mat-icon-button","","name","reset",3,"tapped"],[3,"icon"],[3,"formGroup","ngSubmit"],[1,"body"],[3,"form"],[1,"footer"],["mat-button","","type","button",1,"inverse",3,"tapped"],["mat-button","","type","submit"]],template:function(e,t){1&e&&(u.Wb(0,"div",0,1),u.Wb(2,"div",2),u.Wb(3,"h3"),u.Gc(4,"New Booking"),u.Vb(),u.Wb(5,"button",3),u.ec("tapped",(function(){return t.resetForm()})),u.Rb(6,"app-icon",4),u.Vb(),u.Vb(),u.Wb(7,"form",5),u.ec("ngSubmit",(function(){return t.next()})),u.Wb(8,"div",6),u.Rb(9,"a-booking-form",7),u.Vb(),u.Wb(10,"div",8),u.Wb(11,"button",9),u.ec("tapped",(function(){return t.previous()})),u.Gc(12,"Back"),u.Vb(),u.Wb(13,"button",10),u.Gc(14,"Next"),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&e&&(u.Cb(6),u.oc("icon",u.pc(3,Wi)),u.Cb(1),u.oc("formGroup",t.form),u.Cb(2),u.oc("form",t.form))},directives:[w.b,k.c,O.a,a.H,a.s,a.j,Mi.a],styles:[".booking-form[_ngcontent-%COMP%]{width:768px;max-width:95vw;min-height:100%;background-color:#fff;margin:auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}form[_ngcontent-%COMP%]{padding:1em}.header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5em 1em;border-bottom:1px solid #f0f0f0}h3[_ngcontent-%COMP%]{min-width:50%;flex:1;margin:0}.footer[_ngcontent-%COMP%]{margin-top:1em;text-align:center}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:0 .5em}"]}),xi);function zi(e,t){if(1&e){var n=u.Xb();u.Wb(0,"booking-find-space",5),u.ec("event",(function(e){return u.wc(n),u.ic(2).handleFlowEvent(e)})),u.Vb()}if(2&e){var i=u.ic(2);u.oc("spaces",i.form.controls.space_list)("form",i.form)}}function Ei(e,t){if(1&e&&(u.Ub(0),u.Ec(1,zi,1,2,"booking-find-space",4),u.Tb()),2&e){var n=u.ic();u.Cb(1),u.oc("ngIf",n.form)}}function ji(e,t){if(1&e){var n=u.Xb();u.Wb(0,"booking-catering",7),u.ec("event",(function(e){return u.wc(n),u.ic(2).handleFlowEvent(e)})),u.Vb()}if(2&e){var i=u.ic(2);u.oc("form",i.form)}}function Gi(e,t){if(1&e&&(u.Ub(0),u.Ec(1,ji,1,1,"booking-catering",6),u.Tb()),2&e){var n=u.ic();u.Cb(1),u.oc("ngIf",n.form)}}function Fi(e,t){if(1&e){var n=u.Xb();u.Wb(0,"booking-spaces-form",7),u.ec("event",(function(e){return u.wc(n),u.ic(2).handleFlowEvent(e)})),u.Vb()}if(2&e){var i=u.ic(2);u.oc("form",i.form)}}function Di(e,t){if(1&e&&(u.Ub(0),u.Ec(1,Fi,1,1,"booking-spaces-form",6),u.Tb()),2&e){var n=u.ic();u.Cb(1),u.oc("ngIf",n.form)}}var Si,qi=((Si=function(e){function t(e,n,i,o){var a;return _classCallCheck(this,t),(a=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._service=e,a._route=n,a._router=i,a._dialog=o,a}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){var e=this;this._service.initialised.pipe(Object(v.a)((function(e){return e}))).subscribe((function(){e.subscription("route.params",e._route.paramMap.subscribe((function(t){t.has("step")&&(e.flow_step=t.get("step"))}))),e._service.Spaces.initialised.pipe(Object(v.a)((function(e){return e}))).subscribe((function(){e.loadFormData()}))}))}},{key:"handleFlowEvent",value:function(e){"next"===e.type?this.toNextFlowStep(e):"previous"===e.type?this.toPreviousFlowStep(e):"reset"===e.type&&this.resetForm()}},{key:"toNextFlowStep",value:function(e){var t=this.form.controls.space_list.value;switch(e.step){case"search":!t||!t.length||e.metadata&&e.metadata.ref&&"equipment"===e.metadata.ref?this.form.controls.has_catering&&this.form.controls.has_catering.value?this.navigate("catering"):(this.navigate("form"),this.confirmBooking()):this.openEquipmentDetailsModal();break;case"catering":var n=this.form.controls.catering.value;!n||!n.length||e.metadata&&e.metadata.ref&&"details"===e.metadata.ref?(this.navigate("form"),this.confirmBooking()):this.openCateringDetailsModal();break;default:this.form.controls.needs_space.value||t&&t.length?this.navigate("search"):this.confirmBooking()}}},{key:"toPreviousFlowStep",value:function(e){switch(e.step){case"search":this.navigate("form");break;case"catering":this.navigate("search")}}},{key:"navigate",value:function(e){this._router.navigate(["book","spaces",e],{queryParamsHandling:"preserve"}),this.flow_step=e}},{key:"resetForm",value:function(){this.booking.clearPendingChanges(),delete this.form,this.form=Object(g.a)(this.booking,this._service.Users.current,this.available_fields)}},{key:"loadFormData",value:function(){var e=this,t={};if(localStorage){var n=localStorage.getItem("ACA_STAFF.booking_form_data");if(n)try{t=JSON.parse(n)}catch(o){}}if(this.booking=new b.a(this._service.Bookings,t||{}),this.subscription("form_changes",this.booking.changeEvents.subscribe((function(){return e.saveFormData()}))),this.form=Object(g.a)(this.booking,this._service.Users.current,this.available_fields),t&&!t.id)for(var i in t)this.form.controls[i]?this.form.controls[i].setValue(t[i]):this.booking.hasOwnProperty("")&&this.booking.storePendingChange(i,t[i]);t&&t.room_ids&&this.form.controls.space_list&&this.form.controls.space_list.setValue(t.room_ids.map((function(t){return e._service.Spaces.item(t)||{id:t,name:t}})))}},{key:"saveFormData",value:function(){localStorage&&this.booking&&localStorage.setItem("ACA_STAFF.booking_form_data",JSON.stringify(this.booking.toJSON(!0)))}},{key:"openEquipmentDetailsModal",value:function(){var e=this,t=this._dialog.open(E,{maxWidth:"95vw",width:"32em",data:{spaces:this.form.controls.space_list.value,notes_field:this.form.controls.notes,codes_field:this.form.controls.equipment_codes,head_counts_field:this.form.controls.expected_attendees}});this.subscription("modal_events",t.componentInstance.event.subscribe((function(n){"done"===n.reason&&(e.toNextFlowStep({type:"next",step:"search",metadata:{ref:"equipment"}}),t.close())}))),t.afterClosed().subscribe((function(){return e.unsub("modal_events")}))}},{key:"openCateringDetailsModal",value:function(){var e=this,t=this._dialog.open(A,{maxWidth:"95vw",width:"32em",data:{spaces:this.form.controls.space_list.value,notes_field:this.form.controls.notes,catering:this.form.controls.catering}});this.subscription("modal_events",t.componentInstance.event.subscribe((function(n){"done"===n.reason&&(e.toNextFlowStep({type:"next",step:"catering",metadata:{ref:"details"}}),t.close())}))),t.afterClosed().subscribe((function(){return e.unsub("modal_events")}))}},{key:"confirmBooking",value:function(){var e=this;this.booking.has_changes?this.form.valid&&this._dialog.open(p.a,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{booking:this.booking}}).componentInstance.event.subscribe((function(t){"success"===t.type&&e._router.navigate(["/schedule"])})):this._service.notifyInfo("No changes have been made to booking")}},{key:"available_fields",get:function(){return this._service.setting("app.booking.show_fields")||[]}}]),t}(s.a)).\u0275fac=function(e){return new(e||Si)(u.Qb(c.a),u.Qb(o.a),u.Qb(o.d),u.Qb(_.b))},Si.\u0275cmp=u.Kb({type:Si,selectors:[["booking-space-flow"]],features:[u.zb],decls:5,vars:3,consts:[[1,"space-flow"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"spaces","form","event",4,"ngIf"],[3,"spaces","form","event"],[3,"form","event",4,"ngIf"],[3,"form","event"]],template:function(e,t){1&e&&(u.Wb(0,"div",0),u.Ub(1,1),u.Ec(2,Ei,2,1,"ng-container",2),u.Ec(3,Gi,2,1,"ng-container",2),u.Ec(4,Di,2,1,"ng-container",3),u.Tb(),u.Vb()),2&e&&(u.Cb(1),u.oc("ngSwitch",t.flow_step),u.Cb(1),u.oc("ngSwitchCase","search"),u.Cb(1),u.oc("ngSwitchCase","catering"))},directives:[i.x,i.y,i.z,i.t,Ie,Pi,Ii],styles:[".space-flow[_ngcontent-%COMP%]{height:100%;overflow:auto}"]}),Si),Ai=n("1gA9"),Ti=n("Nuht"),Ni=n("DWOX"),Ri=n("ocbO"),$i=n("4Uey"),Hi=n("p5rm"),Qi=n("q/nq"),Ui=n("4kJo"),Yi=n("A+eD"),Li=n("oTgu"),Bi=n("vJ8U"),Xi=n("1k4r"),Ki=n("5fZw"),Zi=n("WE8N"),Ji=n("1DiH"),eo=n("CTJb"),to=n("opQU"),no=n("zx1i"),io=n("cH1L"),oo=n("dNgK"),ao=n("ihCf"),ro=n("bv9b"),co=n("/1cH"),so=n("STbY"),uo=n("q/DJ");n.d(t,"BookingsModule",(function(){return mo}));var lo,fo=[{path:":flow",component:m},{path:":flow/:step",component:m},{path:"",redirectTo:"spaces"}],mo=((lo=function e(){_classCallCheck(this,e)}).\u0275mod=u.Ob({type:lo}),lo.\u0275inj=u.Nb({factory:function(e){return new(e||lo)},imports:[[i.c,o.h.forChild(fo),h.a,a.l,a.B,r.b]]}),lo);u.zc(m,[i.q,i.r,i.s,i.t,i.A,i.w,i.x,i.y,i.z,i.u,i.v,o.i,o.e,o.g,o.f,o.j,Ai.d,Ai.e,Ai.f,k.b,k.c,Ti.a,s.a,Ni.a,O.a,Ri.a,$i.a,Hi.a,Qi.a,Ui.a,Yi.a,Mi.a,Li.a,Bi.a,Xi.a,Ki.a,Zi.a,Ji.a,eo.a,to.a,no.a,it.a,w.b,w.a,io.b,oo.b,_.e,_.d,_.i,_.f,_.c,x.a,x.b,x.e,x.f,x.g,x.h,x.i,ao.b,ao.c,P.a,P.c,ye.a,ye.c,ro.a,co.a,ti.g,ti.f,co.d,co.c,ei.a,ei.c,X.d,X.a,X.c,X.e,X.b,X.f,ti.j,so.e,so.b,so.d,so.a,B.a,B.c,nt.a,nt.c,Re.b,Re.a,C.c,C.d,C.a,C.f,C.e,C.b,ce.a,ce.b,ce.c,ce.d,a.H,a.w,a.G,a.c,a.x,a.A,a.a,a.D,a.E,a.z,a.r,a.s,a.C,a.n,a.m,a.y,a.b,a.d,a.u,a.v,a.t,a.g,a.j,a.h,a.k,a.e,r.a,m,qi,Ii,Ie,_e,re,Pi,Ae,Ci,je,si,Ct,gt,tt,E,A,me],[i.b,i.G,i.p,i.k,i.E,i.g,i.C,i.F,i.d,i.f,i.i,i.j,i.l,uo.b,uo.c])}}]);