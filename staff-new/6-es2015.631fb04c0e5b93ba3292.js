(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{cmhh:function(t,e,n){"use strict";n.r(e);var i=n("ofXK"),o=n("tyNb"),a=n("3Pt+"),r=n("IhUT"),c=n("OaWH"),s=n("IWZj"),d=n("fXoL");function l(t,e){1&t&&d.Rb(0,"booking-desk-flow")}function u(t,e){1&t&&d.Rb(0,"booking-space-flow")}let m=(()=>{class t extends s.a{constructor(t,e,n){super(),this._service=t,this._route=e,this._router=n}ngOnInit(){this._service.title="Book",this.subscription("route.params",this._route.paramMap.subscribe(t=>{t.has("flow")&&(this.flow=t.get("flow"))})),this.subscription("router.events",this._router.events.subscribe(t=>{t instanceof o.c&&t.url.indexOf("book")<0&&localStorage.removeItem("ACA_STAFF.booking_form_data")}))}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(c.a),d.Qb(o.a),d.Qb(o.d))},t.\u0275cmp=d.Kb({type:t,selectors:[["app-bookings"]],features:[d.zb],decls:10,vars:4,consts:[[1,"booking","page"],[1,"header"],[3,"menu","menuChange"],[1,"body"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"footer"],[3,"show","showChange"]],template:function(t,e){1&t&&(d.Wb(0,"div",0),d.Wb(1,"header",1),d.Wb(2,"a-topbar-header",2),d.ec("menuChange",(function(t){return e.show_menu=t})),d.Vb(),d.Vb(),d.Wb(3,"main",3),d.Ub(4,4),d.Ec(5,l,1,0,"booking-desk-flow",5),d.Ec(6,u,1,0,"booking-space-flow",6),d.Tb(),d.Vb(),d.Wb(7,"footer",7),d.Rb(8,"a-footer-menu"),d.Vb(),d.Vb(),d.Wb(9,"a-overlay-menu",8),d.ec("showChange",(function(t){return e.show_menu=t})),d.Vb()),2&t&&(d.Cb(2),d.oc("menu",e.show_menu),d.Cb(2),d.oc("ngSwitch",e.flow),d.Cb(1),d.oc("ngSwitchCase","desks"),d.Cb(4),d.oc("show",e.show_menu))},styles:[".page[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;flex-direction:column}.page[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.body[_ngcontent-%COMP%]{min-width:50%;min-height:50%;flex:1}"]}),t})();var h=n("PCNd"),f=n("xhdr"),b=n("5RMF"),g=n("Ofvs"),p=n("SxV6"),v=n("0IaG"),_=n("Wgwc"),y=n("wZkO"),w=n("bTqV"),C=n("0njA"),O=n("m6yr"),x=n("kmnG"),M=n("qFsG");function P(t,e){if(1&t&&d.Rb(0,"mat-tab",11),2&t){const t=e.$implicit,n=d.ic();d.oc("label",t.name+(n.form[t.id].invalid&&n.form[t.id].touched?"*":""))}}function k(t,e){1&t&&(d.Wb(0,"span"),d.Gc(1,"*"),d.Vb())}function V(t,e){if(1&t&&(d.Wb(0,"form",12),d.Wb(1,"div",13),d.Wb(2,"label",14),d.Gc(3,"(eg - particular room configurations or specific equipment etc) Additional requests are handled in confidence"),d.Vb(),d.Wb(4,"mat-form-field",15),d.Rb(5,"textarea",16),d.Vb(),d.Vb(),d.Wb(6,"div",17),d.Wb(7,"div",13),d.Wb(8,"label",18),d.Gc(9,"Charge Code"),d.Ec(10,k,2,0,"span",19),d.Vb(),d.Wb(11,"mat-form-field",15),d.Rb(12,"input",20),d.Wb(13,"mat-hint"),d.Wb(14,"span"),d.Gc(15,"Note:"),d.Vb(),d.Gc(16," Your booking will be confirmed before you are charged."),d.Vb(),d.Wb(17,"mat-error"),d.Gc(18,"Charge Code is required"),d.Vb(),d.Vb(),d.Vb(),d.Wb(19,"div",13),d.Wb(20,"label",21),d.Gc(21,"Headcount Estimate"),d.Wb(22,"span"),d.Gc(23,"*"),d.Vb(),d.Vb(),d.Wb(24,"mat-form-field",15),d.Rb(25,"input",22),d.Wb(26,"mat-hint"),d.Wb(27,"span"),d.Gc(28,"Note:"),d.Vb(),d.Gc(29," This estimate is used to calculate catering and/or assign rooms. Please keep updated of any changes."),d.Vb(),d.Wb(30,"mat-error"),d.Gc(31,"Headcount Estimate is required"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&t){const t=d.ic();d.oc("formGroup",t.active_form),d.Cb(8),d.Gb("error",t.active_form.controls.code.touched&&t.active_form.controls.code.invalid),d.Cb(2),d.oc("ngIf",t.needs_charge_code[t.space_list[t.active_space].id]),d.Cb(10),d.Gb("error",t.active_form.controls.head_count.touched&&t.active_form.controls.head_count.invalid)}}const W=function(){return{class:"material-icons",content:"close"}};let I=(()=>{class t{constructor(t,e){this._service=t,this._data=e,this.event=new d.n,this.notes={},this.codes={},this.head_counts={},this.form={},this.needs_charge_code={},this.active_space=0}get space_list(){return this._data.spaces||[]}get active_form(){return this.form[this.space_list[this.active_space].id]}get is_valid(){return this.space_list.reduce((t,e)=>t&&this.form[e.id].valid,!0)}ngOnInit(){const t=(this._data.notes_field.value||[]).filter(t=>"equipment"===t.type);this.notes=t.reduce((t,e)=>(t[e.space]=e.message,t),{}),this.codes=Object.assign({},this._data.codes_field.value||{}),this.head_counts=Object.assign({},this._data.head_counts_field.value||{}),this.generateFormFields()}submit(){if(this.space_list.forEach(t=>this.form[t.id].markAllAsTouched()),this.is_valid){const t=(this._data.notes_field.value||[]).filter(t=>"equipment"!==t.type),e=this.space_list.map(t=>({author:this._service.Users.current.name,type:"equipment",message:this.form[t.id].controls.notes.value,space:t.id,date:_().valueOf()}));this._data.notes_field.setValue(t.concat(e).filter(t=>t.message)),this._data.codes_field.setValue(this.space_list.reduce((t,e)=>(t[e.id]=this.form[e.id].controls.code.value,t),{})),this._data.head_counts_field.setValue(this.space_list.reduce((t,e)=>(t[e.id]=this.form[e.id].controls.head_count.value,t),{})),this.event.emit({reason:"done"})}}generateFormFields(){for(const t of this.space_list){const e=this._service.Organisation.buildings.find(e=>e.id===t.level.building_id);this.needs_charge_code[t.id]=e.required.equipment_code,this.form[t.id]=new a.i({notes:new a.f(this.notes[t.id]||""),code:new a.f(this.codes[t.id]||"",e.required.equipment_code?[a.F.required]:[]),head_count:new a.f(this.head_counts[t.id]||"",[a.F.required])})}}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(c.a),d.Qb(v.a))},t.\u0275cmp=d.Kb({type:t,selectors:[["a-requirement-details-modal"]],outputs:{event:"event"},decls:17,vars:5,consts:[[1,"header"],[1,"tabs"],[3,"selectedIndex","selectedIndexChange"],[3,"label",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"details"],["src","assets/img/equipment.svg"],[1,"text"],[3,"formGroup",4,"ngIf"],["mat-button","",3,"tapped"],[3,"label"],[3,"formGroup"],[1,"field"],["for","equipment-notes"],["appearance","outline"],["matInput","","name","equipment-notes","formControlName","notes","placeholder","Add notes here..."],[1,"fieldset"],["for","charge-code"],[4,"ngIf"],["matInput","","name","charge-code","formControlName","code","placeholder","Charge Code"],["for","head-count"],["matInput","","name","head-count","formControlName","head_count","type","number","placeholder","e.g. 12"]],template:function(t,e){1&t&&(d.Wb(0,"div",0),d.Wb(1,"div",1),d.Wb(2,"mat-tab-group",2),d.ec("selectedIndexChange",(function(t){return e.active_space=t})),d.Ec(3,P,1,1,"mat-tab",3),d.Vb(),d.Vb(),d.Wb(4,"button",4),d.Rb(5,"app-icon",5),d.Vb(),d.Vb(),d.Wb(6,"mat-dialog-content"),d.Wb(7,"main"),d.Wb(8,"div",6),d.Rb(9,"img",7),d.Wb(10,"div",8),d.Gc(11,"Would you like to add equipment to your booking's spaces?"),d.Vb(),d.Vb(),d.Ec(12,V,32,6,"form",9),d.Vb(),d.Vb(),d.Wb(13,"mat-dialog-actions"),d.Wb(14,"footer"),d.Wb(15,"button",10),d.ec("tapped",(function(){return e.submit()})),d.Gc(16,"Add to booking"),d.Vb(),d.Vb(),d.Vb()),2&t&&(d.Cb(2),d.oc("selectedIndex",e.active_space),d.Cb(1),d.oc("ngForOf",e.space_list),d.Cb(2),d.oc("icon",d.pc(4,W)),d.Cb(7),d.oc("ngIf",e.space_list[e.active_space]&&e.active_form))},directives:[y.c,i.s,w.b,v.d,C.a,v.f,i.t,v.c,O.c,y.a,a.H,a.s,a.j,x.b,M.a,a.c,a.r,a.h,x.e,x.a,a.x],styles:[".header[_ngcontent-%COMP%]{display:flex;align-items:center;border-bottom:1px solid #ccc;width:100%}.header[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{min-width:50%;flex:1}.details[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;text-align:center;margin-bottom:1em}main[_ngcontent-%COMP%]{padding:1em 1em 0;min-height:36em}label[_ngcontent-%COMP%]{min-width:100%;margin-right:1em;font-weight:700;font-size:.8em;width:100%;margin-top:0;margin-bottom:.5em}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ffb300}label.error[_ngcontent-%COMP%]{color:#e53935}mat-form-field[_ngcontent-%COMP%]{flex:1}mat-tab[_ngcontent-%COMP%]{display:none!important}.field[_ngcontent-%COMP%]{display:flex;min-width:14em;flex:1;flex-wrap:wrap}mat-hint[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#1937ea}mat-form-field[_ngcontent-%COMP%]{margin-bottom:.75em}textarea[_ngcontent-%COMP%]{min-height:7em}.fieldset[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0 .25em}@media only screen and (orientation:portrait) and (max-width:450px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0}}@media only screen and (orientation:landscape) and (max-width:800px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0}}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:first-child{margin-left:0}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:last-child{margin-right:0}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),t})();var z=n("7c/B");function E(t,e){if(1&t&&d.Rb(0,"mat-tab",11),2&t){const t=e.$implicit,n=d.ic();d.oc("label",t.name+(n.form[t.id].invalid&&n.form[t.id].touched?"*":""))}}function j(t,e){1&t&&(d.Wb(0,"span"),d.Gc(1,"*"),d.Vb())}function G(t,e){if(1&t&&(d.Wb(0,"form",12),d.Wb(1,"div",13),d.Wb(2,"label",14),d.Gc(3,"(eg - allergies, in tolerances, no ice in drinks etc) Additional requests are handled in confidence."),d.Vb(),d.Wb(4,"mat-form-field",15),d.Rb(5,"textarea",16),d.Vb(),d.Vb(),d.Wb(6,"div",13),d.Wb(7,"label",17),d.Gc(8,"Charge Code"),d.Ec(9,j,2,0,"span",18),d.Vb(),d.Wb(10,"mat-form-field",15),d.Rb(11,"input",19),d.Wb(12,"mat-error"),d.Gc(13,"Charge Code is required"),d.Vb(),d.Wb(14,"mat-hint"),d.Wb(15,"span"),d.Gc(16,"Note:"),d.Vb(),d.Gc(17," Your booking will be confirmed before you are charged."),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&t){const t=d.ic();d.oc("formGroup",t.active_form),d.Cb(7),d.Gb("error",t.active_form.controls.code.touched&&t.active_form.controls.code.invalid),d.Cb(2),d.oc("ngIf",t.needs_charge_code[t.space_list[t.active_space].id])}}const F=function(){return{class:"material-icons",content:"close"}};let D=(()=>{class t{constructor(t,e){this._service=t,this._data=e,this.event=new d.n,this.notes={},this.codes={},this.head_counts={},this.form={},this.needs_charge_code={},this.active_space=0}get space_list(){return this._data.spaces||[]}get active_form(){return this.form[this.space_list[this.active_space].id]}get is_valid(){return this.space_list.reduce((t,e)=>t&&this.form[e.id].valid,!0)}ngOnInit(){const t=(this._data.notes_field.value||[]).filter(t=>"catering"===t.type);this.notes=t.reduce((t,e)=>(t[e.space]=e.message,t),{}),this.codes=(this._data.catering.value||[]).reduce((t,e)=>(t[e.location_id]=e.charge_code,t),{}),this.generateFormFields()}submit(){if(this.space_list.forEach(t=>this.form[t.id].markAllAsTouched()),this.is_valid){const t=(this._data.notes_field.value||[]).filter(t=>"catering"!==t.type),e=this.space_list.map(t=>({author:this._service.Users.current.name,type:"catering",message:this.form[t.id].controls.notes.value,space:t.id,date:_().valueOf()}));this._data.notes_field.setValue(t.concat(e).filter(t=>t.message));const n=(this._data.catering.value||[]).map(t=>new z.a(Object.assign(Object.assign({},t),{charge_code:this.form[t.location_id].controls.code.value})));this._data.catering.setValue(n),this.event.emit({reason:"done"})}}generateFormFields(){for(const t of this.space_list){const e=this._service.Organisation.buildings.find(e=>e.id===t.level.building_id);this.needs_charge_code[t.id]=e.required.equipment_code,this.form[t.id]=new a.i({notes:new a.f(this.notes[t.id]||""),code:new a.f(this.codes[t.id]||"",e.required.equipment_code?[a.F.required]:[])})}}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(c.a),d.Qb(v.a))},t.\u0275cmp=d.Kb({type:t,selectors:[["a-catering-details-modal"]],outputs:{event:"event"},decls:17,vars:5,consts:[[1,"header"],[1,"tabs"],[3,"selectedIndex","selectedIndexChange"],[3,"label",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"details"],["src","assets/img/food-notes.svg"],[1,"text"],[3,"formGroup",4,"ngIf"],["mat-button","",3,"tapped"],[3,"label"],[3,"formGroup"],[1,"field"],["for","equipment-notes"],["appearance","outline"],["matInput","","name","equipment-notes","formControlName","notes","placeholder","Add notes here..."],["for","charge-code"],[4,"ngIf"],["matInput","","name","charge-code","formControlName","code","placeholder","Charge Code"]],template:function(t,e){1&t&&(d.Wb(0,"div",0),d.Wb(1,"div",1),d.Wb(2,"mat-tab-group",2),d.ec("selectedIndexChange",(function(t){return e.active_space=t})),d.Ec(3,E,1,1,"mat-tab",3),d.Vb(),d.Vb(),d.Wb(4,"button",4),d.Rb(5,"app-icon",5),d.Vb(),d.Vb(),d.Wb(6,"mat-dialog-content"),d.Wb(7,"main"),d.Wb(8,"div",6),d.Rb(9,"img",7),d.Wb(10,"div",8),d.Gc(11,"Please specify any allergies or gluten intolerances"),d.Vb(),d.Vb(),d.Ec(12,G,18,4,"form",9),d.Vb(),d.Vb(),d.Wb(13,"mat-dialog-actions"),d.Wb(14,"footer"),d.Wb(15,"button",10),d.ec("tapped",(function(){return e.submit()})),d.Gc(16,"Add to booking"),d.Vb(),d.Vb(),d.Vb()),2&t&&(d.Cb(2),d.oc("selectedIndex",e.active_space),d.Cb(1),d.oc("ngForOf",e.space_list),d.Cb(2),d.oc("icon",d.pc(4,F)),d.Cb(7),d.oc("ngIf",e.space_list[e.active_space]&&e.active_form))},directives:[y.c,i.s,w.b,v.d,C.a,v.f,i.t,v.c,O.c,y.a,a.H,a.s,a.j,x.b,M.a,a.c,a.r,a.h,x.a,x.e],styles:[".header[_ngcontent-%COMP%]{display:flex;align-items:center;border-bottom:1px solid #ccc;width:100%}.header[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{min-width:50%;flex:1}.details[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;text-align:center;margin-bottom:1em}main[_ngcontent-%COMP%]{padding:1em 1em 0}mat-hint[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#1937ea}label[_ngcontent-%COMP%]{min-width:100%;margin-right:1em;font-weight:700;font-size:.8em;width:100%;margin-top:0;margin-bottom:.5em}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ffb300}label.error[_ngcontent-%COMP%]{color:#e53935}mat-form-field[_ngcontent-%COMP%]{flex:1}mat-tab[_ngcontent-%COMP%]{display:none!important}.field[_ngcontent-%COMP%]{display:flex;min-width:14em;flex:1;flex-wrap:wrap}textarea[_ngcontent-%COMP%]{min-height:7em}.fieldset[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0 .25em}@media only screen and (orientation:portrait) and (max-width:450px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0}}@media only screen and (orientation:landscape) and (max-width:800px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0}}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:first-child{margin-left:0}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:last-child{margin-right:0}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),t})();var S=n("Kj3r"),q=n("/uUt"),A=n("eIep"),T=n("JIr8"),$=n("lJxs"),N=n("XNiG"),R=n("LRne"),H=n("YxBP"),Q=n("CbDI"),U=n("bSwM"),Y=n("A5z7");function L(t,e){if(1&t){const t=d.Xb();d.Wb(0,"div",14),d.Wb(1,"mat-checkbox",15),d.ec("change",(function(n){d.wc(t);const i=e.$implicit,o=d.ic(2);return n.checked?o.addLocationFilter(i):o.removeLocationFilter(i)})),d.Wb(2,"div",16),d.Wb(3,"div",17),d.Gc(4),d.Vb(),d.Wb(5,"div",18),d.Gc(6),d.Vb(),d.Wb(7,"div",19),d.Gc(8),d.Vb(),d.Vb(),d.Vb(),d.Vb()}if(2&t){const t=e.$implicit;d.Cb(4),d.Hc(t.code),d.Cb(2),d.Hc(t.name),d.Cb(2),d.Hc(t.address)}}const B=function(){return{type:"icon",class:"material-icons",content:"close"}};function X(t,e){if(1&t){const t=d.Xb();d.Wb(0,"mat-chip",23),d.ec("removed",(function(){d.wc(t);const n=e.$implicit;return d.ic(3).removeLocationFilter(n)})),d.Gc(1),d.Rb(2,"app-icon",24),d.Vb()}if(2&t){const t=e.$implicit;d.oc("id",t.id)("removable",!0),d.Cb(1),d.Ic(" ",t.name," "),d.Cb(1),d.oc("icon",d.pc(4,B))}}function K(t,e){if(1&t&&(d.Wb(0,"div",20),d.Wb(1,"mat-chip-list",21),d.Ec(2,X,3,5,"mat-chip",22),d.Vb(),d.Vb()),2&t){const t=d.ic(2);d.Cb(2),d.oc("ngForOf",t.location_list)}}const Z=function(){return{class:"material-icons",content:"keyboard_arrow_left"}},J=function(){return{class:"material-icons",content:"keyboard_arrow_right"}},tt=function(t){return{class:"material-icons",content:t}};function et(t,e){if(1&t){const t=d.Xb();d.Wb(0,"div",1),d.Wb(1,"div",2),d.Wb(2,"div",3),d.Wb(3,"button",4),d.ec("tapped",(function(){return d.wc(t),d.ic().changeDate(-1)})),d.Rb(4,"app-icon",5),d.Vb(),d.Wb(5,"div",6),d.Gc(6),d.Vb(),d.Wb(7,"button",7),d.ec("tapped",(function(){return d.wc(t),d.ic().changeDate(1)})),d.Rb(8,"app-icon",5),d.Vb(),d.Vb(),d.Wb(9,"div",8),d.Wb(10,"div",9),d.ec("tapped",(function(){d.wc(t);const e=d.ic();return e.show_locations=!e.show_locations})),d.Rb(11,"img",10),d.Wb(12,"div",6),d.Gc(13,"Select locations(s)"),d.Vb(),d.Rb(14,"app-icon",5),d.Vb(),d.Wb(15,"div",11),d.Ec(16,L,9,3,"div",12),d.Vb(),d.Vb(),d.Vb(),d.Ec(17,K,3,1,"div",13),d.Vb()}if(2&t){const t=d.ic();d.Cb(3),d.oc("disabled",t.is_today),d.Cb(1),d.oc("icon",d.pc(8,Z)),d.Cb(2),d.Hc(t.date_display),d.Cb(2),d.oc("icon",d.pc(9,J)),d.Cb(6),d.oc("icon",d.qc(10,tt,"keyboard_arrow_"+(t.show_locations?"up":"down"))),d.Cb(1),d.oc("@show",t.show_locations?"show":"hide"),d.Cb(1),d.oc("ngForOf",t.building_list),d.Cb(1),d.oc("ngIf",t.location_list&&t.location_list.length)}}let nt=(()=>{class t extends s.a{constructor(t){super(),this._service=t,this.locations=[],this.locationsChange=new d.n}get is_today(){const t=_(this.date.value);return _().isSame(t,"d")}get date_display(){const t=_(this.date.value);return this.is_today?"Today":t.format("DD MMM YYYY")}get location_list(){return(this.locations||[]).map(t=>this.building_list.find(e=>e.id===t))}changeDate(t=1){let e=_(this.date.value).add(t,"d");const n=_().startOf("m");e.isBefore(n,"s")&&(e=n),this.date.setValue(e.valueOf())}ngOnInit(){this.building_list=this._service.Organisation.buildings,this.building_list&&this.building_list.length||this.timeout("init",()=>this.ngOnInit(),300)}addLocationFilter(t){this.locations||(this.locations=[]),this.locations.push(t.id),this.locations=Object(H.k)(this.locations),this.locationsChange.emit(this.locations)}removeLocationFilter(t){this.locations&&(this.locations.splice(this.locations.findIndex(e=>t.id===e),1),this.locationsChange.emit(this.locations))}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(c.a))},t.\u0275cmp=d.Kb({type:t,selectors:[["booking-space-filters"]],inputs:{date:"date",locations:"locations"},outputs:{locationsChange:"locationsChange"},features:[d.zb],decls:1,vars:1,consts:[["class","space-filters",4,"ngIf"],[1,"space-filters"],[1,"actions"],[1,"date"],["mat-icon-button","",3,"disabled","tapped"],[3,"icon"],[1,"text"],["mat-icon-button","",3,"tapped"],[1,"location-list"],[1,"inner",3,"tapped"],["src","assets/img/location-img.svg"],[1,"list"],["class","item",4,"ngFor","ngForOf"],["class","filters",4,"ngIf"],[1,"item"],[3,"change"],[1,"building-name"],[1,"code"],[1,"name"],[1,"address"],[1,"filters"],["aria-label","Location Filters"],["color","primary",3,"id","removable","removed",4,"ngFor","ngForOf"],["color","primary",3,"id","removable","removed"],["matChipRemove","",3,"icon"]],template:function(t,e){1&t&&d.Ec(0,et,18,12,"div",0),2&t&&d.oc("ngIf",e.date)},directives:[i.t,w.b,O.c,C.a,i.s,U.a,Y.d,Y.a,Y.e],styles:[".space-filters[_ngcontent-%COMP%]{width:100%}.actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;padding:1em}@media only screen and (orientation:portrait) and (max-width:450px){.actions[_ngcontent-%COMP%]{padding:.5em}}@media only screen and (orientation:landscape) and (max-width:800px){.actions[_ngcontent-%COMP%]{padding:.5em}}.actions[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:0 .5em}.date[_ngcontent-%COMP%]{display:flex;align-items:center;border:1px solid #1937ea;height:2.5em;overflow:hidden}@media only screen and (orientation:portrait) and (max-width:450px){.date[_ngcontent-%COMP%]{margin-bottom:.5em!important}}@media only screen and (orientation:landscape) and (max-width:800px){.date[_ngcontent-%COMP%]{margin-bottom:.5em!important}}.date[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0;color:#1937ea;background-color:rgba(25,55,234,.1);height:2.5em;width:2.5em;margin:0}.date[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{background-color:#f0f0f0;color:rgba(0,0,0,.35)}.date[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;border-left:1px solid #1937ea;border-right:1px solid #1937ea;width:8em;height:100%}.location-list[_ngcontent-%COMP%]{position:relative;border:1px solid #ccc;width:24em}.location-list[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]{position:relative;overflow:hidden;display:flex;align-items:center;height:2.5em}.location-list[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.5em}.location-list[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:-10px;left:-10px}.location-list[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1;min-width:50%;margin-left:3em;padding:0 1em}.location-list[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{position:absolute;bottom:0;transform:translateY(100%);background-color:#41485b;color:#fff;width:24em;max-height:25em;overflow:hidden auto;z-index:999;max-width:100%}.location-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{margin:.5em;width:24em}.filters[_ngcontent-%COMP%]{padding:0 1em 1em;margin:0 auto;max-width:720px;width:100%}@media only screen and (orientation:portrait) and (max-width:450px){.filters[_ngcontent-%COMP%]{padding-bottom:.5em}}@media only screen and (orientation:landscape) and (max-width:800px){.filters[_ngcontent-%COMP%]{padding-bottom:.5em}}.building-name[_ngcontent-%COMP%]{display:flex;align-items:center}.building-name[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{width:4em}.building-name[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:8em}.building-name[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{flex:1;min-width:6em;max-width:50vw;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:.2em!important}.mat-menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:0 1em}.mat-menu-item[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.2em}.mat-menu-item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1;min-width:50%;margin-left:.5em;padding-right:2em}.mat-chip.mat-standard-chip[_ngcontent-%COMP%]   .mat-chip-remove[_ngcontent-%COMP%]{color:hsla(0,0%,100%,.85)}"],data:{animation:[Q.a]}}),t})();var it=n("vxfF"),ot=(n("KsZa"),n("ceWj")),at=n("daPb");function rt(t,e){if(1&t){const t=d.Xb();d.Wb(0,"div",6),d.Wb(1,"div",7),d.Gc(2),d.Vb(),d.Wb(3,"div",8),d.Wb(4,"button",9),d.ec("tapped",(function(){d.wc(t);const n=e.$implicit;return d.ic().selectSpace(n)})),d.Wb(5,"div",10),d.Gc(6),d.Vb(),d.Vb(),d.Vb(),d.Vb()}if(2&t){const t=e.$implicit,n=d.ic();d.Cb(2),d.Hc(t.date_string),d.Cb(2),d.Gb("inverse",!t.available&&!t.replaced_by),d.Cb(2),d.Ic(" ",t.replaced_by||(t.available?n.space.name:"Find Room")," ")}}const ct=function(){return{type:"icon",class:"material-icons",content:"close"}};let st=(()=>{class t extends s.a{constructor(t,e,n){super(),this._data=t,this._dialog=e,this._service=n,this.event=new d.n,this.occurrences=[],this.space_details=[]}get space(){return this._data.space}get occurrences_valid(){return this.occurrences.reduce((t,e)=>t&&(e.available||!!e.replaced_by),!0)}ngOnInit(){this.space_details=[].concat(this._data.conflicts||[]),this.updateOccurrences()}save(){this.event.emit({reason:"done",metadata:this.space_details})}selectSpace(t){const e=this._dialog.open(at.a,{width:"auto",height:"auto",maxWidth:"95vw",data:{spaces:[],zone_ids:this.space.level.building_id,date:1e3*t.date,duration:this._data.duration,host:this._data.host,multiple:!1}});this.subscription("new_spaces",e.componentInstance.event.subscribe(n=>{if("done"===n.reason){const i=n.metadata[0];i&&(console.log("Space:",i),this.space_details.unshift({date:t.date,space:i.email,replaces:this.space.email}),this.space_details=Object(H.k)(this.space_details,"date")),this.updateOccurrences(),e.close(),this.unsub("new_spaces")}}))}updateOccurrences(){this.occurrences=this._data.space.recurr_available.map(t=>{const e=this.space_details.find(e=>e.date===t.date&&e.replaces===this.space.email),n=(e||{}).space,i=this._service.Spaces.item(n)||{email:n,name:n};return console.log("Space:",e,i),Object.assign(Object.assign({},t),{date_string:_(1e3*t.date).format("dddd, DD MMMM YYYY"),replaced_by:i.name})}),console.log("Occurrences:",this.occurrences)}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(v.a),d.Qb(v.b),d.Qb(c.a))},t.\u0275cmp=d.Kb({type:t,selectors:[["a-recurrence-spaces-modal"]],outputs:{event:"event"},features:[d.zb],decls:14,vars:5,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"info"],["class","item",4,"ngFor","ngForOf"],["mat-button","",3,"disabled","tapped"],[1,"item"],[1,"date"],[1,"action"],["mat-button","",3,"tapped"],[1,"content"]],template:function(t,e){1&t&&(d.Wb(0,"header"),d.Wb(1,"div",0),d.Gc(2),d.Vb(),d.Wb(3,"button",1),d.Rb(4,"app-icon",2),d.Vb(),d.Vb(),d.Wb(5,"mat-dialog-content"),d.Wb(6,"main"),d.Wb(7,"div",3),d.Gc(8," * Select individual dates to update selected space "),d.Vb(),d.Ec(9,rt,7,4,"div",4),d.Vb(),d.Vb(),d.Wb(10,"mat-dialog-actions"),d.Wb(11,"footer"),d.Wb(12,"button",5),d.ec("tapped",(function(){return e.save()})),d.Gc(13,"Add to Booking"),d.Vb(),d.Vb(),d.Vb()),2&t&&(d.Cb(2),d.Ic("Recurrence - ",e.space.name,""),d.Cb(2),d.oc("icon",d.pc(4,ct)),d.Cb(5),d.oc("ngForOf",e.occurrences),d.Cb(3),d.oc("disabled",!e.occurrences_valid))},directives:[w.b,v.d,C.a,v.f,i.s,v.c,O.c],styles:[".heading[_ngcontent-%COMP%]{flex:1}.item[_ngcontent-%COMP%], main[_ngcontent-%COMP%]{padding:.5em}.item[_ngcontent-%COMP%]{display:flex;align-items:center}.item[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{flex:1;margin-right:1em}.item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:13em}.item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{width:10.5em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.info[_ngcontent-%COMP%]{font-size:.8em;color:#1937ea;margin-bottom:1em;font-style:italic}.info[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{text-align:center}footer[_ngcontent-%COMP%]{width:100%}"]}),t})();function dt(t,e){if(1&t&&d.Rb(0,"div",14),2&t){const t=d.ic(2);d.Dc("background-image","url("+t.space.image+")",d.Jb)}}function lt(t,e){if(1&t&&(d.Wb(0,"div",15),d.Gc(1," Available for\xa0"),d.Wb(2,"span"),d.Gc(3),d.Vb(),d.Gc(4,"\xa0meeting ocurrences "),d.Vb()),2&t){const t=d.ic(2);d.Cb(3),d.Hc(t.availability)}}const ut=function(){return{type:"icon",class:"material-icons",content:"account_circle"}};function mt(t,e){if(1&t){const t=d.Xb();d.Wb(0,"div",1),d.Wb(1,"div",2),d.Ec(2,dt,1,2,"div",3),d.Rb(3,"div",4),d.Wb(4,"div",5),d.Gc(5),d.Vb(),d.Wb(6,"div",6),d.Wb(7,"div",7),d.Gc(8),d.Vb(),d.Wb(9,"div",8),d.Rb(10,"app-icon",9),d.Gc(11),d.Vb(),d.Vb(),d.Ec(12,lt,5,1,"div",10),d.Vb(),d.Wb(13,"div",11),d.Wb(14,"button",12),d.ec("tapped",(function(){return d.wc(t),d.ic().selectSpace()})),d.Gc(15),d.Vb(),d.Wb(16,"button",13),d.ec("tapped",(function(){return d.wc(t),d.ic().locate()})),d.Gc(17,"Map"),d.Vb(),d.Vb(),d.Vb()}if(2&t){const t=d.ic();d.Gb("with-image",t.show_image),d.Cb(2),d.oc("ngIf",t.space.image),d.Cb(3),d.Hc(t.space.name),d.Cb(3),d.Hc(t.location),d.Cb(2),d.oc("icon",d.pc(13,ut)),d.Cb(1),d.Ic(" ",t.space.capacity||"0"," "),d.Cb(1),d.oc("ngIf",t.space.recurr_available&&t.space.recurr_available.length),d.Cb(2),d.Gb("inverse",t.multi&&!t.selected)("request",t.is_request),d.Cb(1),d.Ic(" ",t.multi?t.selected?"Remove":"Select":t.is_request?"Request":"Book"," ")}}let ht=(()=>{class t extends s.a{constructor(t,e){super(),this._service=t,this._dialog=e,this.select=new d.n}get show_image(){return this._service.setting("app.space_display.show_images")}get selected(){return!(!this.form&&this.space)&&this.form.controls.space_list&&!!(this.form.controls.space_list.value||[]).find(t=>t.id===this.space.id)}get is_request(){return!!this.form&&this.space.byRequest({date:this.form.controls.date.value,duration:this.form.controls.duration.value,host:this.form.controls.organiser.value||this._service.Users.current})}get availability(){const t=this.space.recurr_available.reduce((t,e)=>t+(e.available?1:0),0);return t>=this.space.recurr_available.length?"all":`${t} of ${this.space.recurr_available.length}`}get location(){if(!this.space)return"Unable to determine location";const t=this.space.level,e=this._service.Organisation.buildings.find(e=>e.id===t.building_id);return`${e?e.name+", ":""}${t.name}`}locate(){this._dialog.open(ot.a,{width:"auto",height:"auto",maxWidth:"95vw",maxHeight:"95vh",data:{space:this.space}})}selectSpace(){if(!this.space.recurr_available||"all"===this.availability||this.selected)this.select.emit();else{const t=this._dialog.open(st,{width:"auto",height:"auto",maxWidth:"95vw",maxHeight:"95vh",data:{space:this.space,duration:this.form.controls.duration.value,host:this.form.controls.organiser.value,conflicts:this.form.controls.recurrence.value.conflicts||[]}});this.subscription("recurr_conflicts",t.componentInstance.event.subscribe(e=>{if("done"===e.reason){const n=this.form.controls.recurrence.value,i=n.conflicts||[];for(const t of e.metadata){const e=i.findIndex(e=>e.date===t.date&&e.replaces===t.replaces);e>=0?i.splice(e,1,t):i.push(t)}this.form.controls.recurrence.setValue(Object.assign(Object.assign({},n),{conflicts:i})),this.select.emit(),t.close()}}))}}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(c.a),d.Qb(v.b))},t.\u0275cmp=d.Kb({type:t,selectors:[["a-booking-space-item"]],inputs:{space:"space",form:"form",multi:"multi"},outputs:{select:"select"},features:[d.zb],decls:1,vars:1,consts:[["class","space-details",3,"with-image",4,"ngIf"],[1,"space-details"],[1,"details"],["class","image",3,"background-image",4,"ngIf"],[1,"overlay"],[1,"name"],[1,"info"],[1,"location"],[1,"capacity"],[3,"icon"],["class","info recurr",4,"ngIf"],[1,"actions"],["mat-button","",3,"tapped"],["mat-button","",1,"inverse",3,"tapped"],[1,"image"],[1,"info","recurr"]],template:function(t,e){1&t&&d.Ec(0,mt,18,14,"div",0),2&t&&d.oc("ngIf",e.space)},directives:[i.t,C.a,w.b,O.c],styles:[".space-details[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;width:720px;max-width:calc(100vw - 1em);background-color:#fff;flex-wrap:wrap;border-radius:0;overflow:hidden;transition:box-shadow .2s,top .2s;top:0;margin:.5em auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.space-details[_ngcontent-%COMP%]:hover{box-shadow:0 1px 3px 2px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);top:-2px}.space-details[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:none}.with-image[_ngcontent-%COMP%]{padding-top:0;width:480px}.with-image[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:initial;background-color:rgba(0,0,0,.65);color:#fff;transition:opacity .2s}.with-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.with-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{overflow:hidden;background-position:50%;background-size:cover}.with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{-webkit-filter:drop-shadow(0 0 2px #000);filter:drop-shadow(0 0 2px black);color:#fff}.with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{opacity:0}.with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{position:relative;height:6em;width:24em;margin:0 auto 0 0;max-width:24em;overflow:hidden;height:12em}.with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{transition:-webkit-filter .2s;transition:filter .2s;transition:filter .2s,-webkit-filter .2s}.with-image[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;bottom:2em;color:#fff}.with-image[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{position:absolute;bottom:1em;color:hsla(0,0%,100%,.65);width:calc(100% - 2em)}.details[_ngcontent-%COMP%]{flex:1;min-width:50%;padding:1em;min-width:99%}.info[_ngcontent-%COMP%]{display:flex;align-items:center;color:rgba(0,0,0,.65)}.name[_ngcontent-%COMP%]{font-size:1.2em}.location[_ngcontent-%COMP%]{font-size:.8em;flex:1;min-width:50%}.capacity[_ngcontent-%COMP%]{display:flex;align-items:center}.recurr[_ngcontent-%COMP%]{color:#1937ea;font-size:.8em}.recurr[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-decoration:underline}.actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;flex:1}button[_ngcontent-%COMP%]{min-width:12em;flex:1;margin:0;border-radius:0}button.request[_ngcontent-%COMP%]{color:#fff;background-color:#ffb300;border-color:#ffb300}button.request.inverse[_ngcontent-%COMP%]{color:#ffb300;background-color:#fff}"]}),t})();var ft=n("Xa2L");function bt(t,e){if(1&t){const t=d.Xb();d.Ub(0),d.Wb(1,"a-booking-space-item",14),d.ec("select",(function(){d.wc(t);const n=e.$implicit;return d.ic(3).selectSpace(n)})),d.Vb(),d.Tb()}if(2&t){const t=e.$implicit,n=d.ic(3);d.Cb(1),d.oc("form",n.form)("space",t)("multi",n.multiple)}}function gt(t,e){if(1&t&&(d.Wb(0,"cdk-virtual-scroll-viewport",12),d.Ec(1,bt,2,3,"ng-container",13),d.Vb()),2&t){const t=d.ic(2);d.oc("itemSize",t.item_size),d.Cb(1),d.oc("cdkVirtualForOf",t.space_list)}}function pt(t,e){if(1&t&&(d.Ub(0),d.Ec(1,gt,2,2,"cdk-virtual-scroll-viewport",11),d.Tb()),2&t){const t=d.ic(),e=d.tc(13);d.Cb(1),d.oc("ngIf",t.space_list&&t.space_list.length)("ngIfElse",e)}}function vt(t,e){if(1&t){const t=d.Xb();d.Wb(0,"button",15),d.ec("tapped",(function(){return d.wc(t),d.ic().next()})),d.Gc(1," Next "),d.Vb()}if(2&t){const t=d.ic();d.oc("disabled",!t.spaces.value||!t.spaces.value.length)}}function _t(t,e){1&t&&(d.Wb(0,"div",16),d.Wb(1,"div",17),d.Wb(2,"div",18),d.Rb(3,"mat-spinner",19),d.Vb(),d.Wb(4,"div",20),d.Gc(5,"Check space availability..."),d.Vb(),d.Vb(),d.Vb())}const yt=function(){return{class:"material-icons",content:"close"}};function wt(t,e){1&t&&(d.Wb(0,"div",16),d.Wb(1,"div",17),d.Wb(2,"div",18),d.Rb(3,"app-icon",21),d.Vb(),d.Wb(4,"div",20),d.Gc(5,"No spaces available for the selected time"),d.Vb(),d.Vb(),d.Vb()),2&t&&(d.Cb(3),d.oc("icon",d.pc(1,yt)))}let Ct=(()=>{class t extends s.a{constructor(t){super(),this._service=t,this.event=new d.n,this.space_list=[],this.change$=new N.a}get item_size(){return window,window,window,130}get multiple(){return this._service.setting("app.booking.multiple_spaces")}ngOnInit(){if(!this._service.is_initialised&&this._service.Spaces.list().length)return this.timeout("init",()=>this.ngOnInit());this.search_results$=this.change$.pipe(Object(S.a)(400),Object(q.a)(),Object(A.a)(t=>{this.loading=!0;const e=this.form.controls.recurrence?this.form.controls.recurrence.value:null,n=e&&e.period&&"None"!==e.period?{recurr_period:(e.period||"").toLowerCase(),recurr_end:_(e.end).unix()}:{},i=Object.assign({date:this.form.controls.date.value,duration:this.form.controls.duration.value,zone_ids:this._service.Organisation.building.id,bookable:!0},n);return this.zone_ids&&this.zone_ids.length&&(i.zone_ids=this.zone_ids.join(",")),this._service.Spaces.available(i)}),Object(T.a)(t=>(console.error(t),Object(R.a)([]))),Object($.a)(t=>(this.loading=!1,t))),this.subscription("search_results",this.search_results$.subscribe(t=>this.space_list=t)),this.change$.next("")}ngOnChanges(t){t.form&&(this.form.controls.date&&this.subscription("date_field",this.form.controls.date.valueChanges.subscribe(t=>this.change$.next(t))),this.form.controls.duration&&this.subscription("duration_field",this.form.controls.duration.valueChanges.subscribe(t=>this.change$.next(t))))}selectSpace(t){if(this.multiple){const e=this.spaces.value||[],n=e.find(e=>e.id===t.id);this.spaces.setValue(n?e.filter(e=>e.id!==t.id):e.concat([t]))}else this.spaces.setValue([t]),this.event.emit({type:"next",step:"search"})}next(){this.event.emit({type:"next",step:"search"})}previous(){this.event.emit({type:"previous",step:"search"})}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(c.a))},t.\u0275cmp=d.Kb({type:t,selectors:[["booking-find-space"]],inputs:{spaces:"spaces",form:"form"},outputs:{event:"event"},features:[d.zb,d.Ab],decls:14,vars:5,consts:[[1,"find-space"],[1,"background"],[1,"header"],[3,"date","locations","locationsChange"],[4,"ngIf","ngIfElse"],[1,"footer"],[1,"box"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"disabled","tapped",4,"ngIf"],["load_state",""],["empty_state",""],[3,"itemSize",4,"ngIf","ngIfElse"],[3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf"],[3,"form","space","multi","select"],["mat-button","",3,"disabled","tapped"],[1,"body"],[1,"info-block","center"],[1,"icon"],["diameter","48"],[1,"text"],[3,"icon"]],template:function(t,e){if(1&t&&(d.Wb(0,"div",0),d.Rb(1,"div",1),d.Wb(2,"div",2),d.Wb(3,"booking-space-filters",3),d.ec("locationsChange",(function(t){return e.zone_ids=t}))("locationsChange",(function(t){return e.change$.next(t)})),d.Vb(),d.Vb(),d.Ec(4,pt,2,2,"ng-container",4),d.Wb(5,"div",5),d.Wb(6,"div",6),d.Wb(7,"button",7),d.ec("tapped",(function(){return e.previous()})),d.Gc(8,"Back"),d.Vb(),d.Ec(9,vt,2,1,"button",8),d.Vb(),d.Vb(),d.Vb(),d.Ec(10,_t,6,0,"ng-template",null,9,d.Fc),d.Ec(12,wt,6,2,"ng-template",null,10,d.Fc)),2&t){const t=d.tc(11);d.Cb(3),d.oc("date",e.form.controls.date)("locations",e.zone_ids),d.Cb(1),d.oc("ngIf",!e.loading)("ngIfElse",t),d.Cb(5),d.oc("ngIf",e.multiple)}},directives:[nt,i.t,w.b,O.c,it.d,it.a,it.c,ht,ft.c,C.a],styles:[".find-space[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;flex-direction:column;height:100%;width:100%;max-height:calc(100vh - 7.5em);overflow:hidden}@media only screen and (orientation:portrait) and (max-width:450px){.find-space[_ngcontent-%COMP%]{max-height:calc(100vh - 6.5em)}}@media only screen and (orientation:landscape) and (max-width:800px){.find-space[_ngcontent-%COMP%]{max-height:calc(100vh - 6.5em)}}.header[_ngcontent-%COMP%]{position:relative;z-index:999;width:100%;max-width:100vw;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}@media only screen and (orientation:portrait) and (max-width:450px){.header[_ngcontent-%COMP%]{border-radius:0}}@media only screen and (orientation:landscape) and (max-width:800px){.header[_ngcontent-%COMP%]{border-radius:0}}.body[_ngcontent-%COMP%], cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{position:relative;width:100%;flex:1;min-height:50%}.box[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;max-width:100vw;background-color:#fff;padding:.5em;margin:auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);border-top:1px solid #ccc}.box[_ngcontent-%COMP%], .footer[_ngcontent-%COMP%]{width:100%}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:0 .5em}.background[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:50%;transform:translateX(-50%);width:768px;max-width:100vw}.info-block[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:2.5em;width:2.5em}"]}),t})();const Ot=function(){return{class:"material-icons",content:"edit"}},xt=function(){return{class:"material-icons",content:"delete"}};let Mt=(()=>{class t{constructor(t){this._service=t,this.edit=new d.n,this.delete=new d.n}get space(){if(!this.order)return"<No Location>";const t=this._service.Spaces.item(this.order.location_id);return(t?t.name:"")||"<No Location>"}get delivery_time(){return this.order?_(this.order.booking_date).add((this.order.changes||{}).delivery_time||this.order.delivery_time,"m").format("h:mm A"):"<Meeting Start>"}get order_cost(){return((this.order?this.order.items:null)||[]).reduce((t,e)=>t+e.amount*e.unit_price,0)}get item_count(){return((this.order?this.order.items:null)||[]).reduce((t,e)=>t+e.amount,0)}get symbol(){const t=this._service.Spaces.item(this.order.location_id);if(!t||!t.level)return"USD";const e=this._service.Organisation.buildings.find(e=>e.id===t.level.building_id);return e?e.currency:"USD"}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(c.a))},t.\u0275cmp=d.Kb({type:t,selectors:[["catering-order-list-item"]],inputs:{order:"order",date:"date"},outputs:{edit:"edit",delete:"delete"},decls:18,vars:12,consts:[[1,"details"],[1,"group"],[1,"cost"],[1,"actions"],["mat-icon-button","",3,"tapped"],[3,"icon"],["mat-icon-button","",1,"inverse",3,"tapped"]],template:function(t,e){1&t&&(d.Wb(0,"div",0),d.Gc(1," Deliver to "),d.Wb(2,"span"),d.Gc(3),d.Vb(),d.Gc(4," at "),d.Wb(5,"span"),d.Gc(6),d.Vb(),d.Vb(),d.Wb(7,"div",1),d.Wb(8,"div",2),d.Gc(9),d.Vb(),d.Wb(10,"div",2),d.Gc(11),d.jc(12,"currency"),d.Vb(),d.Vb(),d.Wb(13,"div",3),d.Wb(14,"button",4),d.ec("tapped",(function(){return e.edit.emit()})),d.Rb(15,"app-icon",5),d.Vb(),d.Wb(16,"button",6),d.ec("tapped",(function(){return e.delete.emit()})),d.Rb(17,"app-icon",5),d.Vb(),d.Vb()),2&t&&(d.Cb(3),d.Hc(e.space),d.Cb(3),d.Hc(e.delivery_time),d.Cb(3),d.Jc("",e.item_count," item",1===e.item_count?"":"s",""),d.Cb(2),d.Hc(d.lc(12,7,e.order_cost/100,e.symbol)),d.Cb(4),d.oc("icon",d.pc(10,Ot)),d.Cb(2),d.oc("icon",d.pc(11,xt)))},directives:[w.b,O.c,C.a],pipes:[i.d],styles:["[_nghost-%COMP%]{display:flex;align-items:center;padding:.25em;margin:.25em;border-radius:4px}.details[_ngcontent-%COMP%]{flex:1;padding:.5em}.details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:400}.cost[_ngcontent-%COMP%]{padding:.25em .5em;border-radius:4px;font-size:.8rem;margin:.25em .4rem .25em 0;white-space:nowrap;text-align:center}.cost[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{color:#fff;background-color:#1937ea}button[_ngcontent-%COMP%]{margin:.25em}button.inverse[_ngcontent-%COMP%]{background-color:#fff;color:#e53935;border:1px solid #e53935}"]}),t})();function Pt(t,e){if(1&t){const t=d.Xb();d.Wb(0,"catering-order-list-item",10),d.ec("edit",(function(){d.wc(t);const n=e.$implicit;return d.ic(2).editOrder(n)}))("delete",(function(){d.wc(t);const n=e.$implicit;return d.ic(2).deleteOrder(n)})),d.Vb()}if(2&t){const t=e.$implicit,n=d.ic(2);d.oc("order",t)("date",n.date)}}function kt(t,e){if(1&t){const t=d.Xb();d.Ub(0),d.Wb(1,"div",8),d.Ec(2,Pt,1,2,"catering-order-list-item",9),d.Vb(),d.Wb(3,"button",6),d.ec("tapped",(function(){return d.wc(t),d.ic().newOrder()})),d.Gc(4,"Add Order"),d.Vb(),d.Tb()}if(2&t){const t=d.ic();d.Cb(2),d.oc("ngForOf",t.orders)}}const Vt=function(){return{class:"material-icons",content:"close"}};function Wt(t,e){if(1&t){const t=d.Xb();d.Wb(0,"div",11),d.Wb(1,"div",12),d.Rb(2,"app-icon",13),d.Vb(),d.Wb(3,"div",14),d.Gc(4,"No catering orders"),d.Vb(),d.Wb(5,"button",6),d.ec("tapped",(function(){return d.wc(t),d.ic().newOrder()})),d.Gc(6,"Add Order"),d.Vb(),d.Vb()}2&t&&(d.Cb(2),d.oc("icon",d.pc(1,Vt)))}let It=(()=>{class t{constructor(){this.event=new d.n,this.order=new d.n}get orders(){if(!this.catering)return[];const t=this.catering.value||[];return t.forEach(t=>t.booking_date=this.all_day?_(this.date).startOf("d").valueOf():this.date),t}newOrder(){this.order.emit()}editOrder(t){this.order.emit(t)}deleteOrder(t){const e=this.orders,n=e.findIndex(e=>t.id===e.id);n>=0&&(e.splice(n,1),this.catering.setValue(e))}next(){this.event.emit({type:"next",step:"catering"})}previous(){this.event.emit({type:"previous",step:"catering"})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=d.Kb({type:t,selectors:[["a-catering-order-list"]],inputs:{catering:"catering",date:"date",all_day:"all_day"},outputs:{event:"event",order:"order"},decls:13,vars:2,consts:[[1,"catering","order-list"],[1,"header"],[1,"body"],[4,"ngIf","ngIfElse"],[1,"footer"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"tapped"],["empty_state",""],[1,"list"],[3,"order","date","edit","delete",4,"ngFor","ngForOf"],[3,"order","date","edit","delete"],[1,"info-block","center"],[1,"icon"],[3,"icon"],[1,"text"]],template:function(t,e){if(1&t&&(d.Wb(0,"div",0),d.Wb(1,"div",1),d.Wb(2,"h3"),d.Gc(3,"Catering Orders"),d.Vb(),d.Vb(),d.Wb(4,"div",2),d.Ec(5,kt,5,1,"ng-container",3),d.Vb(),d.Wb(6,"div",4),d.Wb(7,"button",5),d.ec("tapped",(function(){return e.previous()})),d.Gc(8,"Back"),d.Vb(),d.Wb(9,"button",6),d.ec("tapped",(function(){return e.next()})),d.Gc(10,"Next"),d.Vb(),d.Vb(),d.Vb(),d.Ec(11,Wt,7,2,"ng-template",null,7,d.Fc)),2&t){const t=d.tc(12);d.Cb(5),d.oc("ngIf",e.orders&&e.orders.length)("ngIfElse",t)}},directives:[i.t,w.b,O.c,i.s,Mt,C.a],styles:["[_nghost-%COMP%]{height:100%}.order-list[_ngcontent-%COMP%]{flex-direction:column;height:100%;width:768px;margin:auto;max-width:100vw;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.body[_ngcontent-%COMP%], .order-list[_ngcontent-%COMP%]{display:flex;align-items:center}.body[_ngcontent-%COMP%]{position:relative;flex-direction:column;flex:1;width:100%;min-height:50%;overflow:auto}.body[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:8em}.list[_ngcontent-%COMP%]{width:100%}.list[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{border:1px solid #ccc}.list[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.05)}.footer[_ngcontent-%COMP%]{width:100%;text-align:center;border-top:1px solid #ccc}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:.5em}.info-block[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:1em}"]}),t})();var zt=n("IRj4"),Et=n("aXH1"),jt=n("QibW");function Gt(t,e){1&t&&d.Sb(0)}function Ft(t,e){if(1&t){const t=d.Xb();d.Wb(0,"mat-checkbox",11),d.ec("change",(function(e){d.wc(t);const n=d.ic(2).$implicit,i=d.ic(2).package;return d.ic().updateAmount(i,n,e.checked)})),d.Gc(1),d.Vb()}if(2&t){const t=d.ic(2).$implicit;d.oc("checked",!!t.amount),d.Cb(1),d.Ic(" ",t.name," ")}}function Dt(t,e){if(1&t){const t=d.Xb();d.Wb(0,"mat-radio-button",12),d.ec("change",(function(e){d.wc(t);const n=d.ic(2).$implicit,i=d.ic(2).package;return d.ic().updateAmount(i,n,e.value===n.id)})),d.Gc(1),d.Vb()}if(2&t){const t=d.ic(2).$implicit;d.oc("value",t.id),d.Cb(1),d.Ic(" ",t.name," ")}}function St(t,e){if(1&t&&(d.Ub(0),d.Ec(1,Ft,2,2,"mat-checkbox",9),d.Ec(2,Dt,2,2,"mat-radio-button",10),d.Tb()),2&t){const t=d.ic(3).package;d.Cb(1),d.oc("ngIf",t.must_select>1),d.Cb(1),d.oc("ngIf",1===t.must_select)}}function qt(t,e){if(1&t&&(d.Ub(0),d.Gc(1),d.Tb()),2&t){const t=d.ic().$implicit;d.Cb(1),d.Ic(" ",t.name," ")}}function At(t,e){1&t&&d.Sb(0)}const Tt=function(t){return{package:t}};function $t(t,e){if(1&t&&(d.Wb(0,"div",8),d.Ec(1,St,3,2,"ng-container",5),d.Ec(2,qt,2,1,"ng-container",5),d.Ec(3,At,1,0,"ng-container",2),d.Vb()),2&t){const t=e.$implicit,n=d.ic(2).package;d.ic();const i=d.tc(13);d.Db("to-select",t.must_select),d.Cb(1),d.oc("ngIf",n.must_select&&n.must_select<n.items.length&&!t.must_select),d.Cb(1),d.oc("ngIf",n.must_select>=n.items.length||t.must_select),d.Cb(1),d.oc("ngTemplateOutlet",i)("ngTemplateOutletContext",d.qc(5,Tt,t))}}function Nt(t,e){if(1&t&&(d.Ub(0),d.Wb(1,"mat-radio-group",6),d.Ec(2,$t,4,7,"div",7),d.Vb(),d.Tb()),2&t){const t=d.ic().package,e=d.ic();d.Cb(1),d.oc("ngModel",e.active_items[t.id]),d.Cb(1),d.oc("ngForOf",t.items)}}function Rt(t,e){if(1&t&&d.Ec(0,Nt,3,2,"ng-container",5),2&t){const t=e.package;d.oc("ngIf",t.items&&t.items.length)}}const Ht=function(){return{class:"material-icons",content:"close"}};let Qt=(()=>{class t{constructor(t){this._data=t,this.event=new d.n}get requirements_met(){return function t(e){const n=e.items||[];return e.must_select>=n.length?n.reduce((e,n)=>e&&t(n),!0):n.reduce((t,e)=>t+e.amount?1:0,0)===e.must_select}(this.item)}get active_items(){return function t(e){let n={};if(e.items){const i=e.items.find(t=>t.amount>0);i&&(n[e.id]=i.id),e.items.forEach(e=>n=Object.assign(Object.assign({},n),t(e)))}return n}(this.item)}ngOnInit(){this.item=this._data.item}updateAmount(t,e,n){if(n){const n=t.must_select;t.items.filter(t=>t.amount>0).length>=n&&t.items.find(t=>t.amount>0).setAmount(0),e.setAmount(1)}else e.setAmount(0)}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(v.a))},t.\u0275cmp=d.Kb({type:t,selectors:[["a-package-options-modal"]],outputs:{event:"event"},decls:14,vars:7,consts:[["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["mat-button","",3,"disabled","tapped"],["item_display",""],[4,"ngIf"],[3,"ngModel"],["class","item",4,"ngFor","ngForOf"],[1,"item"],[3,"checked","change",4,"ngIf"],[3,"value","change",4,"ngIf"],[3,"checked","change"],[3,"value","change"]],template:function(t,e){if(1&t&&(d.Wb(0,"header"),d.Wb(1,"h3"),d.Gc(2,"Package Options"),d.Vb(),d.Wb(3,"button",0),d.Rb(4,"app-icon",1),d.Vb(),d.Vb(),d.Wb(5,"mat-dialog-content"),d.Wb(6,"main"),d.Ec(7,Gt,1,0,"ng-container",2),d.Vb(),d.Vb(),d.Wb(8,"mat-dialog-actions"),d.Wb(9,"footer"),d.Wb(10,"button",3),d.ec("tapped",(function(){return e.event.emit({reason:"done"})})),d.Gc(11," Confirm Options "),d.Vb(),d.Vb(),d.Vb(),d.Ec(12,Rt,1,1,"ng-template",null,4,d.Fc)),2&t){const t=d.tc(13);d.Cb(4),d.oc("icon",d.pc(4,Ht)),d.Cb(3),d.oc("ngTemplateOutlet",t)("ngTemplateOutletContext",d.qc(5,Tt,e.item)),d.Cb(3),d.oc("disabled",!e.requirements_met)}},directives:[w.b,v.d,C.a,v.f,i.A,v.c,O.c,i.t,jt.b,a.r,a.u,i.s,U.a,jt.a],styles:["main[_ngcontent-%COMP%]{width:24em;min-height:24em;overflow:hidden auto}main[_ngcontent-%COMP%] > mat-radio-group[_ngcontent-%COMP%] > .item[_ngcontent-%COMP%]{background:none;border:none;border-bottom:1px solid #ccc}main[_ngcontent-%COMP%] > mat-radio-group[_ngcontent-%COMP%] > .item[_ngcontent-%COMP%]:last-child{border:none}.item[_ngcontent-%COMP%]{padding:.5em;border:1px solid #ccc;width:100%}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{border-bottom:none}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:first-child{border-radius:4px 4px 0 0;margin-top:.25em}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:last-child{margin-bottom:.25em;border-radius:0 0 4px 4px;border-bottom:1px solid #ccc}mat-dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #ccc}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),t})();var Ut=n("Qu3c"),Yt=n("019G");function Lt(t,e){if(1&t&&d.Rb(0,"div",15),2&t){const t=d.ic(2);d.Dc("background-image","url("+t.item.image_path+")",d.Jb)}}function Bt(t,e){if(1&t&&(d.Wb(0,"div",16),d.Gc(1),d.jc(2,"currency"),d.Vb()),2&t){const t=d.ic(2);d.Cb(1),d.Ic(" ",d.lc(2,1,t.item.unit_price/100,t.symbol)," ")}}function Xt(t,e){if(1&t&&(d.Wb(0,"div",17),d.Gc(1),d.Vb()),2&t){const t=d.ic(2);d.oc("matTooltip",t.contents),d.Cb(1),d.Jc(" Contains ",t.item.items.length," item",1===t.item.items.length?"":"s"," ")}}function Kt(t,e){if(1&t&&(d.Wb(0,"div",17),d.Wb(1,"span",18),d.Gc(2,"Selected "),d.Vb(),d.Gc(3),d.Wb(4,"span",18),d.Gc(5,"ion"),d.Vb(),d.Gc(6),d.Vb()),2&t){const t=d.ic(2);d.oc("matTooltip",t.contents),d.Cb(3),d.Ic("",t.item.must_select," opt"),d.Cb(3),d.Ic("",1===t.item.items.length?"":"s"," ")}}function Zt(t,e){if(1&t){const t=d.Xb();d.Wb(0,"button",19),d.ec("tapped",(function(){return d.wc(t),d.ic(2).updatePackageOptions()})),d.Gc(1," Customise "),d.Vb()}}function Jt(t,e){if(1&t&&(d.Wb(0,"div",20),d.Gc(1),d.jc(2,"currency"),d.Vb()),2&t){const t=d.ic(2);d.Cb(1),d.Ic(" ",d.lc(2,1,t.item.unit_price/100,t.symbol)," ")}}function te(t,e){if(1&t){const t=d.Xb();d.Wb(0,"a-counter",21),d.ec("ngModelChange",(function(e){return d.wc(t),d.ic(2).updateAmount(e)})),d.Vb()}if(2&t){const t=d.ic(2);d.oc("ngModel",t.item.amount)}}const ee=function(t){return{class:"material-icons",content:t}};function ne(t,e){if(1&t){const t=d.Xb();d.Wb(0,"button",22),d.ec("tapped",(function(){d.wc(t);const e=d.ic(2);return e.show_children=!e.show_children})),d.Rb(1,"app-icon",23),d.Vb()}if(2&t){const t=d.ic(2);d.Cb(1),d.oc("icon",d.qc(1,ee,t.show_children?"keyboard_arrow_up":"keyboard_arrow_down"))}}function ie(t,e){if(1&t&&(d.Wb(0,"div",3),d.Ec(1,Lt,1,2,"div",4),d.Wb(2,"div",5),d.Wb(3,"div",6),d.Gc(4),d.Vb(),d.Wb(5,"div",7),d.Gc(6),d.Vb(),d.Wb(7,"div",8),d.Ec(8,Bt,3,4,"div",9),d.Ec(9,Xt,2,3,"div",10),d.Ec(10,Kt,7,3,"div",10),d.Ec(11,Zt,2,0,"button",11),d.Vb(),d.Vb(),d.Ec(12,Jt,3,4,"div",12),d.Ec(13,te,1,1,"a-counter",13),d.Ec(14,ne,2,3,"button",14),d.Vb()),2&t){const t=d.ic();d.Gb("subitem",t.subitem),d.Db("disabled",t.disabled&&!t.item.can_order_anytime),d.Cb(1),d.oc("ngIf",!t.subitem),d.Cb(3),d.Hc(t.item.name),d.Cb(2),d.Jc("",t.item.package?"[Package] ":"","",t.item.description,""),d.Cb(2),d.oc("ngIf",t.item.unit_price),d.Cb(1),d.oc("ngIf",t.item.package&&t.item.items.length&&!t.item.must_select),d.Cb(1),d.oc("ngIf",t.item.package&&t.item.must_select&&t.item.amount>0),d.Cb(1),d.oc("ngIf",t.item.package&&t.item.must_select&&t.item.amount>0),d.Cb(1),d.oc("ngIf",t.item.unit_price),d.Cb(1),d.oc("ngIf",!t.item.items||t.item.package),d.Cb(1),d.oc("ngIf",t.item.items&&t.item.items.length&&!t.item.package)}}function oe(t,e){if(1&t&&d.Rb(0,"a-catering-order-item",24),2&t){const t=e.$implicit,n=d.ic();d.oc("subitem",!0)("symbol",n.symbol)("item",t)("field",n.field)}}let ae=(()=>{class t extends s.a{constructor(t,e){super(),this._service=t,this._dialog=e}get contents(){return this.item.items?this.item.items.reduce((t,e)=>(t&&(t+="\n\n"),t+`${e.name}${e.items?e.items.reduce((t,e)=>t+`\n ${e.amount?"\u2713":"\u2022"} ${e.name} `,""):""} ${e.amount?"\u2713":""}`),""):""}ngOnChanges(t){if(t.field&&this.field){const t=this.field.value.find(t=>t.id===this.item.id);this.item.setAmount(t?t.amount:0),this.subscription("field_change",this.field.valueChanges.subscribe(t=>{const e=t.find(t=>t.id===this.item.id);this.item.setAmount(e?e.amount:0)}))}}updateAmount(t){if(this.field){const e=this.field.value||[],n=e.find(t=>t.id===this.item.id);if(n)this.item.setAmount(t),n.setAmount(t);else{const n=this.item.amount;this.item.setAmount(t),this.item.package&&n<t?this.selectPackageOptions().then(t=>{e.push(new Et.a(t)),this.field.setValue(e.filter(t=>t.amount))},()=>{this.item.setAmount(999),this.timeout("amount",()=>this.item.setAmount(0),5),this._service.notifyWarn("Package options not selected. Item removed from order")}):e.push(new Et.a(this.item))}this.field.setValue(e.filter(t=>t.amount))}}updatePackageOptions(){this.selectPackageOptions().then(()=>null,()=>null)}selectPackageOptions(){return new Promise((t,e)=>{const n=this._dialog.open(Qt,{maxWidth:"95vw",data:{item:new zt.a(this.item)}});let i=!1;n.componentInstance.event.subscribe(e=>{"done"===e.reason&&(i=!0,t(n.componentInstance.item),n.close())}),n.afterClosed().subscribe(()=>{i||e()})})}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(c.a),d.Qb(v.b))},t.\u0275cmp=d.Kb({type:t,selectors:[["a-catering-order-item"]],inputs:{subitem:"subitem",item:"item",field:"field",symbol:"symbol",disabled:"disabled"},features:[d.zb,d.Ab],decls:3,vars:3,consts:[["class","catering-item",3,"subitem",4,"ngIf"],[1,"children"],[3,"subitem","symbol","item","field",4,"ngFor","ngForOf"],[1,"catering-item"],["class","image",3,"background-image",4,"ngIf"],[1,"details"],[1,"name"],[1,"description"],[1,"options"],["class","option price mobile-only",4,"ngIf"],["class","option",3,"matTooltip",4,"ngIf"],["mat-button","",3,"tapped",4,"ngIf"],["class","option price not-mobile",4,"ngIf"],[3,"ngModel","ngModelChange",4,"ngIf"],["mat-icon-button","",3,"tapped",4,"ngIf"],[1,"image"],[1,"option","price","mobile-only"],[1,"option",3,"matTooltip"],[1,"not-mobile"],["mat-button","",3,"tapped"],[1,"option","price","not-mobile"],[3,"ngModel","ngModelChange"],["mat-icon-button","",3,"tapped"],[3,"icon"],[3,"subitem","symbol","item","field"]],template:function(t,e){1&t&&(d.Ec(0,ie,15,14,"div",0),d.Wb(1,"div",1),d.Ec(2,oe,1,4,"a-catering-order-item",2),d.Vb()),2&t&&(d.oc("ngIf",e.item),d.Cb(1),d.oc("@show",e.show_children?"show":"hide"),d.Cb(1),d.oc("ngForOf",e.item.items))},directives:[i.t,i.s,Ut.a,w.b,O.c,Yt.a,a.r,a.u,C.a,t],pipes:[i.d],styles:[".catering-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem}.catering-item[disabled=true][_ngcontent-%COMP%]{pointer-events:none;opacity:.35;background-color:rgba(0,0,0,.2)}.subitem[_ngcontent-%COMP%]{border-top:1px solid #ccc}.name[_ngcontent-%COMP%]{max-width:480px}.image[_ngcontent-%COMP%]{height:3em;width:3em;min-width:3em;border-radius:4px;background-color:rgba(0,0,0,.05);background-position:50%;background-size:cover;border:1px solid rgba(0,0,0,.05)}.details[_ngcontent-%COMP%]{flex:1;min-width:25%;padding:0 .5em;display:flex;flex-direction:column}.details[_ngcontent-%COMP%]   *[_ngcontent-%COMP%] > {white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.options[_ngcontent-%COMP%]{display:flex;align-items:center}.options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;font-size:.8em;height:1.5em;color:rgba(0,0,0,.85);line-height:1em;padding:0 .25em;text-decoration:underline}.option[_ngcontent-%COMP%]{padding:.25em .5em;border-radius:4px;color:#fff;font-size:.8rem;background-color:#1937ea;margin:.25em .4rem .25em 0;white-space:nowrap}.description[_ngcontent-%COMP%]{font-size:.75em;margin-top:.25em}.children[_ngcontent-%COMP%]{font-size:.9em;background-color:rgba(0,0,0,.05)}"],data:{animation:[Q.a]}}),t})();function re(t,e){if(1&t&&d.Rb(0,"a-catering-order-item",9),2&t){const t=e.$implicit,n=d.ic();d.oc("field",n.item_field)("subitem",!0)("item",t)("symbol",n.symbol)}}const ce=function(){return{class:"material-icons",content:"close"}};let se=(()=>{class t extends s.a{constructor(t,e,n){super(),this._service=t,this._dialog_ref=e,this._data=n,this.event=new d.n,this.item_list=[]}get space(){return this._data.form&&this._data.form.controls.space?this._data.form.controls.space.value:{}}get delivery_time(){return _(this._data.date).format("h:mm A")}get item_field(){return this._data.form?this._data.form.controls.items:null}get order_cost(){return this.item_list.reduce((t,e)=>t+e.amount*e.unit_price,0)}get symbol(){if(!this.space||!this.space.level)return"USD";const t=this._service.Organisation.buildings.find(t=>t.id===this.space.level.building_id);return t?t.currency:"USD"}ngOnInit(){this._data.form.controls.items&&this.subscription("item_list",this._data.form.controls.items.valueChanges.subscribe(t=>{(!t||t.length<=0)&&this._dialog_ref.close()})),this.item_list=(this._data.form&&this._data.form.controls.items?this._data.form.controls.items.value:[]).map(t=>new Et.a(t))}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(c.a),d.Qb(v.h),d.Qb(v.a))},t.\u0275cmp=d.Kb({type:t,selectors:[["a-catering-confirm-modal"]],outputs:{event:"event"},features:[d.zb],decls:26,vars:9,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"details"],[1,"list"],[3,"field","subitem","item","symbol",4,"ngFor","ngForOf"],[1,"total"],[1,"value"],["mat-button","",3,"tapped"],[3,"field","subitem","item","symbol"]],template:function(t,e){1&t&&(d.Wb(0,"header"),d.Wb(1,"div",0),d.Gc(2,"Confirm Catering Order"),d.Vb(),d.Wb(3,"button",1),d.Rb(4,"app-icon",2),d.Vb(),d.Vb(),d.Wb(5,"mat-dialog-content"),d.Wb(6,"main"),d.Wb(7,"div",3),d.Gc(8," Delivering to "),d.Wb(9,"span"),d.Gc(10),d.Vb(),d.Gc(11," at "),d.Wb(12,"span"),d.Gc(13),d.Vb(),d.Vb(),d.Wb(14,"div",4),d.Ec(15,re,1,4,"a-catering-order-item",5),d.Vb(),d.Wb(16,"div",6),d.Wb(17,"label"),d.Gc(18,"Order Total:"),d.Vb(),d.Wb(19,"div",7),d.Gc(20),d.jc(21,"currency"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(22,"mat-dialog-actions"),d.Wb(23,"footer"),d.Wb(24,"button",8),d.ec("tapped",(function(){return e.event.emit({reason:"done"})})),d.Gc(25,"Save Order"),d.Vb(),d.Vb(),d.Vb()),2&t&&(d.Cb(4),d.oc("icon",d.pc(8,ce)),d.Cb(6),d.Hc(e.space.name||"<Unset>"),d.Cb(3),d.Hc(e.delivery_time),d.Cb(2),d.oc("ngForOf",e.item_list),d.Cb(5),d.Hc(d.lc(21,5,e.order_cost/100,e.symbol)))},directives:[w.b,v.d,C.a,v.f,i.s,v.c,O.c,ae],pipes:[i.d],styles:[".heading[_ngcontent-%COMP%]{flex:1}.details[_ngcontent-%COMP%]{padding:1em;text-align:center}.details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:400}.list[_ngcontent-%COMP%]{height:50vh;overflow:auto}.total[_ngcontent-%COMP%]{border-top:1px solid #ccc;display:flex;align-items:center;justify-content:flex-end;padding:.5em 1em}.total[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.8em;font-weight:500;margin-right:1.5em}mat-dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #ccc}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),t})();var de,le=function(t,e){return(n=(e={exports:{}}).exports).isLeapYear=function(t){return t%4==0&&t%100!=0||t%400==0},n.isDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(t.valueOf())},n.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},n.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},n.zeroPad=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n="0";return(t+="").length>=e?t:new Array(e-t.length+1).join(n)+t},n.titleCase=function(t){return t?t[0].toUpperCase()+t.substr(1):""},n.ordinal=function(t){var e=t%10,n=t%100;return 1===e&&11!==n?t+"st":2===e&&12!==n?t+"nd":3===e&&13!==n?t+"rd":t+"th"},n.toCardinal=function(t){return t=(t=String(t)).replace(/([0-9])(st|nd|rd|th)$/i,"$1"),parseInt(t,10)},n.normalize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"day"===(t=(t=(t=(t=t.toLowerCase().trim()).replace(/ies$/,"y")).replace(/s$/,"")).replace(/-/g,""))?"date":t},n.getEpoch=function(t){return"number"==typeof t?t:n.isDate(t)?t.getTime():t.epoch?t.epoch:null},n.beADate=function(t,e){return!1===n.isObject(t)?e.clone().set(t):t},n.formatTimezone=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=Math.abs(t),o=t>0?"+":"-";return"".concat(o).concat(n.zeroPad(i)).concat(e,"00")},e.exports;var n}(),ue=le.zeroPad,me=function(t,e,n,i){var o=new Date(t),a=(o.getTimezoneOffset()||0)+60*i;a=60*a*1e3;var r=function(t){return ue(t.getMonth()+1)+"/"+ue(t.getDate())+":"+ue(t.getHours())}(o=new Date(t+a));return r>=e&&r<n},he=function(t){var e=t.timezones[t.tz];if(void 0===e)return console.warn("Warning: couldn't find timezone "+t.tz),0;if(void 0===e.dst)return e.offset;var n=e.offset,i=e.offset+1;"n"===e.hem&&(i=n-1);var o=e.dst.split("->");return!0===me(t.epoch,o[0],o[1],n)?n:i},fe=["africa","america","asia","atlantic","australia","brazil","canada","chile","europe","indian","mexico","pacific","antarctica","etc"],be=(de=Object.freeze({__proto__:null,default:{"9|s":"2/dili,2/jayapura","9|n":"2/chita,2/khandyga,2/pyongyang,2/seoul,2/tokyo,11/palau","9.5|s|04/05:03->10/04:02":"4/adelaide,4/broken_hill,4/south,4/yancowinna","9.5|s":"4/darwin,4/north","8|s":"12/casey,2/kuala_lumpur,2/makassar,2/singapore,4/perth,4/west","8|n|03/25:03->09/29:23":"2/ulan_bator","8|n":"2/brunei,2/choibalsan,2/chongqing,2/chungking,2/harbin,2/hong_kong,2/irkutsk,2/kuching,2/macao,2/macau,2/manila,2/shanghai,2/taipei,2/ujung_pandang,2/ulaanbaatar","8.75|s":"4/eucla","7|s":"12/davis,2/jakarta,9/christmas","7|n":"2/bangkok,2/barnaul,2/ho_chi_minh,2/hovd,2/krasnoyarsk,2/novokuznetsk,2/novosibirsk,2/phnom_penh,2/pontianak,2/saigon,2/tomsk,2/vientiane","6|s":"12/vostok","6|n":"2/almaty,2/bishkek,2/dacca,2/dhaka,2/kashgar,2/omsk,2/qyzylorda,2/thimbu,2/thimphu,2/urumqi,9/chagos","6.5|n":"2/rangoon,2/yangon,9/cocos","5|s":"12/mawson,9/kerguelen","5|n":"2/aqtau,2/aqtobe,2/ashgabat,2/ashkhabad,2/atyrau,2/baku,2/dushanbe,2/karachi,2/oral,2/samarkand,2/tashkent,2/yekaterinburg,9/maldives","5.75|n":"2/kathmandu,2/katmandu","5.5|n":"2/calcutta,2/colombo,2/kolkata","4|s":"9/reunion","4|n":"2/dubai,2/muscat,2/tbilisi,2/yerevan,8/astrakhan,8/samara,8/saratov,8/ulyanovsk,8/volgograd,2/volgograd,9/mahe,9/mauritius","4.5|n|03/21:00->09/20:24":"2/tehran","4.5|n":"2/kabul","3|s":"12/syowa,9/antananarivo","3|n|03/29:03->10/25:04":"2/famagusta,2/nicosia,8/athens,8/bucharest,8/helsinki,8/kiev,8/mariehamn,8/nicosia,8/riga,8/sofia,8/tallinn,8/uzhgorod,8/vilnius,8/zaporozhye","3|n|03/29:02->10/25:03":"8/chisinau,8/tiraspol","3|n|03/29:00->10/24:24":"2/beirut","3|n|03/27:02->10/25:02":"2/jerusalem,2/tel_aviv","3|n|03/27:00->10/31:01":"2/gaza,2/hebron","3|n|03/27:00->10/30:01":"2/amman","3|n|03/27:00->10/29:24":"2/damascus","3|n":"0/addis_ababa,0/asmara,0/asmera,0/dar_es_salaam,0/djibouti,0/juba,0/kampala,0/mogadishu,0/nairobi,2/aden,2/baghdad,2/bahrain,2/istanbul,2/kuwait,2/qatar,2/riyadh,8/istanbul,8/kirov,8/minsk,8/moscow,8/simferopol,9/comoro,9/mayotte","2|s|03/29:02->10/25:02":"12/troll","2|s":"0/gaborone,0/harare,0/johannesburg,0/lubumbashi,0/lusaka,0/maputo,0/maseru,0/mbabane","2|n|03/29:02->10/25:03":"0/ceuta,arctic/longyearbyen,3/jan_mayen,8/amsterdam,8/andorra,8/belgrade,8/berlin,8/bratislava,8/brussels,8/budapest,8/busingen,8/copenhagen,8/gibraltar,8/ljubljana,8/luxembourg,8/madrid,8/malta,8/monaco,8/oslo,8/paris,8/podgorica,8/prague,8/rome,8/san_marino,8/sarajevo,8/skopje,8/stockholm,8/tirane,8/vaduz,8/vatican,8/vienna,8/warsaw,8/zagreb,8/zurich","2|n":"0/blantyre,0/bujumbura,0/cairo,0/khartoum,0/kigali,0/tripoli,8/kaliningrad","1|s|04/02:01->09/03:03":"0/windhoek","1|s":"0/kinshasa,0/luanda","1|n|04/19:03->05/24:02":"0/casablanca,0/el_aaiun","1|n|03/29:01->10/25:02":"3/canary,3/faeroe,3/faroe,3/madeira,8/belfast,8/dublin,8/guernsey,8/isle_of_man,8/jersey,8/lisbon,8/london","1|n":"0/algiers,0/bangui,0/brazzaville,0/douala,0/lagos,0/libreville,0/malabo,0/ndjamena,0/niamey,0/porto-novo,0/tunis","14|n":"11/kiritimati","13|s|04/05:04->09/27:03":"11/apia","13|s|01/15:02->11/05:03":"11/tongatapu","13|n":"11/enderbury,11/fakaofo","12|s|04/05:03->09/27:02":"12/mcmurdo,12/south_pole,11/auckland","12|s|01/12:03->11/08:02":"11/fiji","12|n":"2/anadyr,2/kamchatka,2/srednekolymsk,11/funafuti,11/kwajalein,11/majuro,11/nauru,11/tarawa,11/wake,11/wallis","12.75|s|04/05:03->04/05:02":"11/chatham","11|s":"12/macquarie,11/bougainville","11|n":"2/magadan,2/sakhalin,11/efate,11/guadalcanal,11/kosrae,11/noumea,11/pohnpei,11/ponape","11.5|n|04/05:03->10/04:02":"11/norfolk","10|s|04/05:03->10/04:02":"4/act,4/canberra,4/currie,4/hobart,4/melbourne,4/nsw,4/sydney,4/tasmania,4/victoria","10|s":"12/dumontdurville,4/brisbane,4/lindeman,4/queensland","10|n":"2/ust-nera,2/vladivostok,2/yakutsk,11/chuuk,11/guam,11/port_moresby,11/saipan,11/truk,11/yap","10.5|s|04/05:01->10/04:02":"4/lhi,4/lord_howe","0|n|03/29:00->10/25:01":"1/scoresbysund,3/azores","0|n":"0/abidjan,0/accra,0/bamako,0/banjul,0/bissau,0/conakry,0/dakar,0/freetown,0/lome,0/monrovia,0/nouakchott,0/ouagadougou,0/sao_tome,0/timbuktu,1/danmarkshavn,3/reykjavik,3/st_helena,13/gmt,13/gmt+0,13/gmt-0,13/gmt0,13/greenwich,13/utc,13/universal,13/zulu","-9|n|03/08:02->11/01:02":"1/adak,1/atka","-9|n":"11/gambier","-9.5|n":"11/marquesas","-8|n|03/08:02->11/01:02":"1/anchorage,1/juneau,1/metlakatla,1/nome,1/sitka,1/yakutat","-8|n":"11/pitcairn","-7|n|03/08:02->11/01:02":"1/dawson,1/ensenada,1/los_angeles,1/santa_isabel,1/tijuana,1/vancouver,1/whitehorse,6/pacific,6/yukon,10/bajanorte","-7|n":"1/creston,1/dawson_creek,1/hermosillo,1/phoenix","-6|s|04/04:22->09/05:22":"7/easterisland,11/easter","-6|n|04/05:02->10/25:02":"1/chihuahua,1/mazatlan,10/bajasur","-6|n|03/08:02->11/01:02":"1/boise,1/cambridge_bay,1/denver,1/edmonton,1/inuvik,1/ojinaga,1/shiprock,1/yellowknife,6/mountain","-6|n":"1/belize,1/costa_rica,1/el_salvador,1/guatemala,1/managua,1/regina,1/swift_current,1/tegucigalpa,6/east-saskatchewan,6/saskatchewan,11/galapagos","-5|s":"1/lima,1/rio_branco,5/acre","-5|n|04/05:02->10/25:02":"1/bahia_banderas,1/merida,1/mexico_city,1/monterrey,10/general","-5|n|03/12:03->11/05:01":"1/north_dakota","-5|n|03/08:02->11/01:02":"1/chicago,1/knox_in,1/matamoros,1/menominee,1/rainy_river,1/rankin_inlet,1/resolute,1/winnipeg,6/central","-5|n":"1/atikokan,1/bogota,1/cancun,1/cayman,1/coral_harbour,1/eirunepe,1/guayaquil,1/jamaica,1/panama,1/porto_acre","-4|s|05/13:23->08/13:01":"12/palmer","-4|s|04/04:24->09/06:00":"1/santiago,7/continental","-4|s|03/21:24->10/04:00":"1/asuncion","-4|s|02/16:24->11/03:00":"1/campo_grande,1/cuiaba","-4|s":"1/la_paz,1/manaus,5/west","-4|n|03/12:03->11/05:01":"1/indiana,1/kentucky","-4|n|03/08:02->11/01:02":"1/detroit,1/fort_wayne,1/grand_turk,1/indianapolis,1/iqaluit,1/louisville,1/montreal,1/nassau,1/new_york,1/nipigon,1/pangnirtung,1/port-au-prince,1/thunder_bay,1/toronto,6/eastern","-4|n|03/08:00->11/01:01":"1/havana","-4|n":"1/anguilla,1/antigua,1/aruba,1/barbados,1/blanc-sablon,1/boa_vista,1/caracas,1/curacao,1/dominica,1/grenada,1/guadeloupe,1/guyana,1/kralendijk,1/lower_princes,1/marigot,1/martinique,1/montserrat,1/port_of_spain,1/porto_velho,1/puerto_rico,1/santo_domingo,1/st_barthelemy,1/st_kitts,1/st_lucia,1/st_thomas,1/st_vincent,1/tortola,1/virgin","-3|s":"1/argentina,1/buenos_aires,1/cordoba,1/fortaleza,1/montevideo,1/punta_arenas,1/sao_paulo,12/rothera,3/stanley,5/east","-3|n|03/08:02->11/01:02":"1/glace_bay,1/goose_bay,1/halifax,1/moncton,1/thule,3/bermuda,6/atlantic","-3|n":"1/araguaina,1/bahia,1/belem,1/catamarca,1/cayenne,1/jujuy,1/maceio,1/mendoza,1/paramaribo,1/recife,1/rosario,1/santarem","-2|s":"5/denoronha","-2|n|03/28:22->10/24:23":"1/godthab","-2|n|03/08:02->11/01:02":"1/miquelon","-2|n":"1/noronha,3/south_georgia","-2.5|n|03/08:02->11/01:02":"1/st_johns,6/newfoundland","-1|n":"3/cape_verde","-11|n":"11/midway,11/niue,11/pago_pago,11/samoa","-10|n":"11/honolulu,11/johnston,11/rarotonga,11/tahiti"}}))&&de.default||de,ge={};Object.keys(be).forEach((function(t){var e=t.split("|"),n={offset:Number(e[0]),hem:e[1]};e[2]&&(n.dst=e[2]),be[t].split(",").forEach((function(t){t=t.replace(/(^[0-9]+)\//,(function(t,e){return e=Number(e),fe[e]+"/"})),ge[t]=n}))})),ge.utc={offset:0,hem:"n"};for(var pe=-14;pe<=14;pe+=.5){var ve=pe;ve>0&&(ve="+"+ve);var _e="etc/gmt"+ve;ge[_e]={offset:-1*pe,hem:"n"},ge[_e="utc/gmt"+ve]={offset:-1*pe,hem:"n"}}var ye,we=ge,Ce=/(\-?[0-9]+)h(rs)?/i,Oe=/(\-?[0-9]+)/,xe=/utc([\-+]?[0-9]+)/i,Me=/gmt([\-+]?[0-9]+)/i,Pe=function(t){return(t=Number(t))>-13&&t<13?"etc/gmt"+(t=((t*=-1)>0?"+":"")+t):null},ke=null===(ye=function(){if("undefined"==typeof Intl||void 0===Intl.DateTimeFormat)return null;var t=Intl.DateTimeFormat();if(void 0===t||void 0===t.resolvedOptions)return null;var e=t.resolvedOptions().timeZone;return e?e.toLowerCase():null}())?"utc":ye,Ve=Object.keys(we).reduce((function(t,e){var n=e.split("/")[1]||"";return t[n=n.replace(/_/g," ")]=e,t}),{}),We=function(t,e){if(!t)return ke;var n=t.trim(),i=t.split("/");if(i.length>2&&!1===e.hasOwnProperty(n)&&(n=i[0]+"/"+i[1]),n=n.toLowerCase(),!0===e.hasOwnProperty(n))return n;if(n=function(t){return(t=(t=(t=(t=(t=t.replace(/ time/g,"")).replace(/ (standard|daylight|summer)/g,"")).replace(/\b(east|west|north|south)ern/g,"$1")).replace(/\b(africa|america|australia)n/g,"$1")).replace(/\beuropean/g,"europe")).replace(/\islands/g,"island")}(n),!0===e.hasOwnProperty(n))return n;if(!0===Ve.hasOwnProperty(n))return Ve[n];if(!0===/[0-9]/.test(n)){var o=function(t){var e=t.match(Ce);if(null!==e)return Pe(e[1]);if(null!==(e=t.match(xe)))return Pe(e[1]);if(null!==(e=t.match(Me))){var n=-1*Number(e[1]);return Pe(n)}return null!==(e=t.match(Oe))?Pe(e[1]):null}(n);if(o)return o}throw new Error("Spacetime: Cannot find timezone named: '"+t+"'. Please enter an IANA timezone id.")},Ie={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5};Ie.date=Ie.day,Ie.month=25488e5,Ie.week=6048e5,Ie.year=3154e7,Object.keys(Ie).forEach((function(t){Ie[t+"s"]=Ie[t]}));var ze=Ie,Ee=function(t,e,n,i,o){var a=t.d[n]();if(a!==e){var r=null===o?null:t.d[o](),c=t.epoch,s=e-a;t.epoch+=ze[i]*s,"day"===i&&Math.abs(s)>28&&e<28&&(t.epoch+=ze.hour);for(var d=ze[i]/2;t.d[n]()<e;)t.epoch+=d;for(;t.d[n]()>e;)t.epoch-=d;null!==o&&r!==t.d[o]()&&(t.epoch=c,t.epoch+=ze[i]*s*.89)}},je={year:{valid:function(t){return t>-4e3&&t<4e3},walkTo:function(t,e){return Ee(t,e,"getFullYear","year",null)}},month:{valid:function(t){return t>=0&&t<=11},walkTo:function(t,e){var n=t.d,i=n.getMonth(),o=t.epoch,a=n.getFullYear();if(i!==e){for(t.epoch+=ze.day*(28*(e-i)),a!==t.d.getFullYear()&&(t.epoch=o);t.d.getMonth()<e;)t.epoch+=ze.day;for(;t.d.getMonth()>e;)t.epoch-=ze.day}}},date:{valid:function(t){return t>0&&t<=31},walkTo:function(t,e){return Ee(t,e,"getDate","day","getMonth")}},hour:{valid:function(t){return t>=0&&t<24},walkTo:function(t,e){return Ee(t,e,"getHours","hour","getDate")}},minute:{valid:function(t){return t>=0&&t<60},walkTo:function(t,e){return Ee(t,e,"getMinutes","minute","getHours")}},second:{valid:function(t){return t>=0&&t<60},walkTo:function(t,e){t.epoch=t.seconds(e).epoch}},millisecond:{valid:function(t){return t>=0&&t<1e3},walkTo:function(t,e){t.epoch=t.milliseconds(e).epoch}}},Ge=function(t,e){for(var n=Object.keys(je),i=t.clone(),o=0;o<n.length;o++){var a=n[o],r=e[a];if(void 0===r&&(r=i[a]()),"string"==typeof r&&(r=parseInt(r,10)),!je[a].valid(r))return t.epoch=null,void(!1===t.silent&&console.warn("invalid "+a+": "+r));je[a].walkTo(t,r)}},Fe=["jan","feb","mar","apr","may","jun","jul","aug","sept","oct","nov","dec"],De=["january","february","march","april","may","june","july","august","september","october","november","december"],Se=function(){return Fe},qe=function(){return function(){for(var t={sep:8},e=0;e<Fe.length;e++)t[Fe[e]]=e;for(var n=0;n<De.length;n++)t[De[n]]=n;return t}()},Ae=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=(e=e.replace(/^\s+/,"").toLowerCase()).match(/([0-9]{1,2}):([0-9]{1,2}):?([0-9]{1,2})?[:\.]?([0-9]{1,4})?/);if(null!==n){var i=Number(n[1]);if(i<0||i>24)return t.startOf("day");var o=Number(n[2]);if(n[2].length<2||o<0||o>59)return t.startOf("day");t=(t=(t=(t=t.hour(i)).minute(o)).seconds(n[3]||0)).millisecond(n[4]||0);var a=e.match(/[\b0-9](am|pm)\b/);return null!==a&&a[1]&&(t=t.ampm(a[1])),t}if(null!==(n=e.match(/([0-9]+) ?(am|pm)/))&&n[1]){var r=Number(n[1]);return r>12||r<1?t.startOf("day"):t=(t=(t=t.hour(n[1]||0)).ampm(n[2])).startOf("hour")}return t.startOf("day")},Te=[31,28,31,30,31,30,31,31,30,31,30,31],$e=le.isLeapYear,Ne=function(t){return!0===Te.hasOwnProperty(t.month)&&(1===t.month?!!($e(t.year)&&t.date<=29)||t.date<=28:t.date<=(Te[t.month]||0))},Re=qe(),He=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=parseInt(t.trim(),10);return e||(new Date).getFullYear()},Qe=[{reg:/^(\-?0?0?[0-9]{3,4})-([0-9]{1,2})-([0-9]{1,2})[T| ]([0-9.:]+)(Z|[0-9\-\+:]+)?$/,parse:function(t,e,n,i){var o=parseInt(e[2],10)-1,a={year:e[1],month:o,date:e[3]};return!1===Ne(a)?(t.epoch=null,t):(function(t,e){if(!e)return t;"Z"===e&&(e="+0000");var n=0;/^[\+-]?[0-9]{2}:[0-9]{2}$/.test(e)&&(!0===/:00/.test(e)&&(e=e.replace(/:00/,"")),!0===/:30/.test(e)&&(e=e.replace(/:30/,".5"))),/^[\+-]?[0-9]{4}$/.test(e)&&(e=e.replace(/30$/,".5")),n=parseFloat(e),Math.abs(n)>100&&(n/=100),(n*=-1)>=0&&(n="+"+n);var i="etc/gmt"+n;t.timezones[i]&&(t.tz=i)}(t,e[5]),Ge(t,a),t=Ae(t,e[4]))}},{reg:/^([0-9]{4})[\-\/]([0-9]{1,2})[\-\/]([0-9]{1,2}),?( [0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(t,e){var n={year:e[1],month:parseInt(e[2],10)-1,date:parseInt(e[3],10)};return n.month>=12&&(n.date=parseInt(e[2],10),n.month=parseInt(e[3],10)-1),!1===Ne(n)?(t.epoch=null,t):(Ge(t,n),t=Ae(t,e[4]))}},{reg:/^([0-9]{1,2})[\-\/]([0-9]{1,2})[\-\/]?([0-9]{4})?,?( [0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(t,e){var n=parseInt(e[1],10)-1,i=parseInt(e[2],10);(t.british||n>=12)&&(i=parseInt(e[1],10),n=parseInt(e[2],10)-1);var o={year:e[3]||(new Date).getFullYear(),month:n,date:i};return!1===Ne(o)?(t.epoch=null,t):(Ge(t,o),t=Ae(t,e[4]))}},{reg:/^([0-9]{1,2})[\-\/]([a-z]+)[\-\/]?([0-9]{4})?$/i,parse:function(t,e){var n=Re[e[2].toLowerCase()],i={year:He(e[3]),month:n,date:le.toCardinal(e[1]||"")};return!1===Ne(i)?(t.epoch=null,t):(Ge(t,i),t=Ae(t,e[4]))}},{reg:/^([a-z]+) ([0-9]{1,2}(?:st|nd|rd|th)?),?( [0-9]{4})?( ([0-9:]+( ?am| ?pm| ?gmt)?))?$/i,parse:function(t,e){var n=Re[e[1].toLowerCase()],i={year:He(e[3]),month:n,date:le.toCardinal(e[2]||"")};return!1===Ne(i)?(t.epoch=null,t):(Ge(t,i),t=Ae(t,e[4]))}},{reg:/^([a-z]+) ([0-9]{4})$/i,parse:function(t,e){var n=Re[e[1].toLowerCase()],i={year:He(e[2]),month:n,date:1};return!1===Ne(i)?(t.epoch=null,t):(Ge(t,i),t=Ae(t,e[4]))}},{reg:/^([0-9]{1,2}(?:st|nd|rd|th)?) ([a-z]+),?( [0-9]{4})?,? ?([0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(t,e){var n=Re[e[2].toLowerCase()];if(!n)return null;var i={year:He(e[3]),month:n,date:le.toCardinal(e[1])};return!1===Ne(i)?(t.epoch=null,t):(Ge(t,i),t=Ae(t,e[4]))}},{reg:/^[0-9,]+ ?b\.?c\.?$/i,parse:function(t,e){var n=e[0]||"";n=(n=n.replace(/^([0-9,]+) ?b\.?c\.?$/i,"-$1")).replace(/,/g,"");var i=parseInt(n.trim(),10),o=new Date,a={year:i,month:o.getMonth(),date:o.getDate()};return!1===Ne(a)?(t.epoch=null,t):(Ge(t,a),t=Ae(t))}},{reg:/^[0-9,]+ ?(a\.?d\.?|c\.?e\.?)$/i,parse:function(t,e){var n=e[0]||"";n=n.replace(/,/g,"");var i=parseInt(n.trim(),10),o=new Date,a={year:i,month:o.getMonth(),date:o.getDate()};return!1===Ne(a)?(t.epoch=null,t):(Ge(t,a),t=Ae(t))}},{reg:/^[0-9]{4}( ?a\.?d\.?)?$/i,parse:function(t,e){var n=He(e[0]),i=new Date,o={year:n,month:i.getMonth(),date:i.getDate()};return!1===Ne(o)?(t.epoch=null,t):(Ge(t,o),t=Ae(t))}}],Ue={now:function(t){return t.epoch=Date.now(),t},tonight:function(t){return t.epoch=Date.now(),t.hour(18)},today:function(t){return t.epoch=Date.now(),t},tomorrow:function(t){return t.epoch=Date.now(),(t=t.add(1,"day")).startOf("day")},yesterday:function(t){return t.epoch=Date.now(),(t=t.subtract(1,"day")).startOf("day")},christmas:function(t){var e=(new Date).getFullYear();return t.set([e,11,25,18,0,0])},"new years":function(t){var e=(new Date).getFullYear();return t.set([e,11,31,18,0,0])}};Ue["new years eve"]=Ue["new years"];var Ye=Ue,Le={year:(new Date).getFullYear(),month:0,date:1},Be=function(t,e,n){if("number"==typeof e)return e>0&&e<25e8&&!1===t.silent&&(console.warn("  - Warning: You are setting the date to January 1970."),console.warn("       -   did input seconds instead of milliseconds?")),t.epoch=e,t;if(t.epoch=Date.now(),null==e)return t;if(!0===le.isDate(e))return t.epoch=e.getTime(),t;if(!0===le.isArray(e))return function(t,e){for(var n=["year","month","date","hour","minute","second","millisecond"],i=0;i<n.length;i++)t=t[n[i]](e[i]||Le[n[i]]||0);return t}(t,e);if(!0===le.isObject(e))return e.epoch?(t.epoch=e.epoch,t.tz=e.tz,t):t=function(t,e){e=Object.assign({},Le,e);for(var n=Object.keys(e),i=0;i<n.length;i++){var o=n[i];void 0!==t[o]&&"function"==typeof t[o]&&null!=e[o]&&""!==e[o]&&(t=t[o](e[o]||Le[o]||0))}return t}(t,e);if("string"!=typeof e)return t;if(e=(e=(e=e.replace(/\b(mon|tues|wed|wednes|thu|thurs|fri|sat|satur|sun)(day)?\b/i,"")).replace(/,/g,"")).replace(/ +/g," ").trim(),!0===Ye.hasOwnProperty(e))return Ye[e](t);for(var i=0;i<Qe.length;i++){var o=e.match(Qe[i].reg);if(o){var a=Qe[i].parse(t,o,n);if(null!==a)return a}}return!1===t.silent&&console.warn("Warning: couldn't parse date-string: '"+e+"'"),t.epoch=null,t},Xe=["sun","mon","tue","wed","thu","fri","sat"],Ke=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Ze=function(){return Xe},Je=function(){return Ke},tn=function(t){var e=t.timezone().current.offset,n=e<0,i="00";return.5===Math.abs(e%1)&&(i="30",e=e>=0?Math.floor(e):Math.ceil(e)),"+00:00"==(e=(e=n?"-"+(e=le.zeroPad(e*=-1,2)):"+"+(e=le.zeroPad(e,2)))+":"+i)&&(e="Z"),e},en={day:function(t){return le.titleCase(t.dayName())},"day-short":function(t){return le.titleCase(Ze()[t.day()])},"day-number":function(t){return t.day()},"day-ordinal":function(t){return le.ordinal(t.day())},"day-pad":function(t){return le.zeroPad(t.day())},date:function(t){return t.date()},"date-ordinal":function(t){return le.ordinal(t.date())},"date-pad":function(t){return le.zeroPad(t.date())},month:function(t){return le.titleCase(t.monthName())},"month-short":function(t){return le.titleCase(Se()[t.month()])},"month-number":function(t){return t.month()},"month-ordinal":function(t){return le.ordinal(t.month())},"month-pad":function(t){return le.zeroPad(t.month())},"iso-month":function(t){return le.zeroPad(t.month()+1)},year:function(t){var e=t.year();return e>0?e:(e=Math.abs(e))+" BC"},"year-short":function(t){var e=t.year();return e>0?"'".concat(String(t.year()).substr(2,4)):(e=Math.abs(e))+" BC"},"iso-year":function(t){var e=t.year(),n=e<0,i=le.zeroPad(Math.abs(e),4);return n&&(i="-"+(i=le.zeroPad(i,6))),i},time:function(t){return t.time()},"time-24":function(t){return"".concat(t.hour24(),":").concat(le.zeroPad(t.minute()))},hour:function(t){return t.hour12()},"hour-pad":function(t){return le.zeroPad(t.hour12())},"hour-24":function(t){return t.hour24()},"hour-24-pad":function(t){return le.zeroPad(t.hour24())},minute:function(t){return t.minute()},"minute-pad":function(t){return le.zeroPad(t.minute())},second:function(t){return t.second()},"second-pad":function(t){return le.zeroPad(t.second())},ampm:function(t){return t.ampm()},quarter:function(t){return"Q"+t.quarter()},season:function(t){return t.season()},era:function(t){return t.era()},json:function(t){return t.json()},timezone:function(t){return t.timezone().name},offset:function(t){return tn(t)},numeric:function(t){return"".concat(t.year(),"/").concat(le.zeroPad(t.month()+1),"/").concat(le.zeroPad(t.date()))},"numeric-us":function(t){return"".concat(le.zeroPad(t.month()+1),"/").concat(le.zeroPad(t.date()),"/").concat(t.year())},"numeric-uk":function(t){return"".concat(le.zeroPad(t.date()),"/").concat(le.zeroPad(t.month()+1),"/").concat(t.year())},"mm/dd":function(t){return"".concat(le.zeroPad(t.month()+1),"/").concat(le.zeroPad(t.date()))},iso:function(t){var e=t.format("iso-year"),n=le.zeroPad(t.month()+1),i=le.zeroPad(t.date()),o=le.zeroPad(t.h24()),a=le.zeroPad(t.minute()),r=le.zeroPad(t.second()),c=le.zeroPad(t.millisecond(),3),s=tn(t);return"".concat(e,"-").concat(n,"-").concat(i,"T").concat(o,":").concat(a,":").concat(r,".").concat(c).concat(s)},"iso-short":function(t){var e=le.zeroPad(t.month()+1),n=le.zeroPad(t.date());return"".concat(t.year(),"-").concat(e,"-").concat(n)},"iso-utc":function(t){return new Date(t.epoch).toISOString()},nice:function(t){return"".concat(Se()[t.month()]," ").concat(le.ordinal(t.date()),", ").concat(t.time())},"nice-year":function(t){return"".concat(Se()[t.month()]," ").concat(le.ordinal(t.date()),", ").concat(t.year())},"nice-day":function(t){return"".concat(Ze()[t.day()]," ").concat(le.titleCase(Se()[t.month()])," ").concat(le.ordinal(t.date()))},"nice-full":function(t){return"".concat(t.dayName()," ").concat(le.titleCase(t.monthName())," ").concat(le.ordinal(t.date()),", ").concat(t.time())}},nn={"day-name":"day","month-name":"month","iso 8601":"iso","time-h24":"time-24","time-12":"time","time-h12":"time",tz:"timezone","day-num":"day-number","month-num":"month-number","month-iso":"iso-month","year-iso":"iso-year","nice-short":"nice",mdy:"numeric-us",dmy:"numeric-uk",ymd:"numeric","yyyy/mm/dd":"numeric","mm/dd/yyyy":"numeric-us","dd/mm/yyyy":"numeric-us","little-endian":"numeric-uk","big-endian":"numeric","day-nice":"nice-day"};Object.keys(nn).forEach((function(t){return en[t]=en[nn[t]]}));var on=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!0!==t.isValid())return"";if(en.hasOwnProperty(e)){var n=en[e](t)||"";return"json"!==e&&(n=String(n),"ampm"!==e&&(n=le.titleCase(n))),n}if(-1!==e.indexOf("{")){var i=/\{(.+?)\}/g;return e.replace(i,(function(e,n){return n=n.toLowerCase().trim(),en.hasOwnProperty(n)?String(en[n](t)||""):""}))}return t.format("iso-short")},an=le.zeroPad,rn=le.formatTimezone,cn={G:function(t){return t.era()},GG:function(t){return t.era()},GGG:function(t){return t.era()},GGGG:function(t){return"AD"===t.era()?"Anno Domini":"Before Christ"},y:function(t){return t.year()},yy:function(t){return parseInt(String(t.year()).substr(2,4),10)},yyy:function(t){return t.year()},yyyy:function(t){return t.year()},yyyyy:function(t){return"0"+t.year()},Q:function(t){return t.quarter()},QQ:function(t){return t.quarter()},QQQ:function(t){return t.quarter()},QQQQ:function(t){return t.quarter()},M:function(t){return t.month()+1},MM:function(t){return an(t.month()+1)},MMM:function(t){return t.format("month-short")},MMMM:function(t){return t.format("month")},w:function(t){return t.week()},ww:function(t){return an(t.week())},d:function(t){return t.date()},dd:function(t){return an(t.date())},D:function(t){return t.dayOfYear()},DD:function(t){return an(t.dayOfYear())},DDD:function(t){return an(t.dayOfYear(),3)},E:function(t){return t.format("day-short")},EE:function(t){return t.format("day-short")},EEE:function(t){return t.format("day-short")},EEEE:function(t){return t.format("day")},EEEEE:function(t){return t.format("day")[0]},e:function(t){return t.day()},ee:function(t){return t.day()},eee:function(t){return t.format("day-short")},eeee:function(t){return t.format("day")},eeeee:function(t){return t.format("day")[0]},a:function(t){return t.ampm().toUpperCase()},aa:function(t){return t.ampm().toUpperCase()},aaa:function(t){return t.ampm().toUpperCase()},aaaa:function(t){return t.ampm().toUpperCase()},h:function(t){return t.h12()},hh:function(t){return an(t.h12())},H:function(t){return t.hour()},HH:function(t){return an(t.hour())},m:function(t){return t.minute()},mm:function(t){return an(t.minute())},s:function(t){return t.second()},ss:function(t){return an(t.second())},A:function(t){return t.epoch-t.startOf("day").epoch},z:function(t){return t.timezone().name},zz:function(t){return t.timezone().name},zzz:function(t){return t.timezone().name},zzzz:function(t){return t.timezone().name},Z:function(t){return rn(t.timezone().current.offset)},ZZ:function(t){return rn(t.timezone().current.offset)},ZZZ:function(t){return rn(t.timezone().current.offset)},ZZZZ:function(t){return rn(t.timezone().current.offset,":")}},sn=function(t,e,n){for(var i=t,o=e,a=0;a<n;a+=1)cn[i]=cn[o],i+=t,o+=e};sn("q","Q",4),sn("L","M",4),sn("Y","y",4),sn("c","e",4),sn("k","H",2),sn("K","h",2),sn("S","s",2),sn("v","z",4),sn("V","Z",4);var dn=["year","season","quarter","month","week","day","quarterHour","hour","minute"],ln=function(t,e){var n=t.clone().startOf(e),i=t.clone().endOf(e);return parseFloat(((t.epoch-n.epoch)/(i.epoch-n.epoch)).toFixed(2))},un=function(t,e,n){var i=0;for(t=t.clone();t.isBefore(e);)t=t.add(1,n),i+=1;return t.isAfter(e,n)&&(i-=1),i},mn=function(t,e,n){return t.isBefore(e)?un(t,e,n):-1*un(e,t,n)},hn={months:{almost:10,over:4},days:{almost:25,over:10},hours:{almost:20,over:8},minutes:{almost:50,over:20},seconds:{almost:50,over:20}};function fn(t,e){return 1===t&&(e=e.slice(0,-1)),t+" "+e}var bn={north:[["spring",2,1],["summer",5,1],["fall",8,1],["autumn",8,1],["winter",11,1]],south:[["fall",2,1],["autumn",2,1],["winter",5,1],["spring",8,1],["summer",11,1]]},gn=[null,[0,1],[3,1],[6,1],[9,1]],pn={minute:function(t){return Ge(t,{second:0,millisecond:0}),t},quarterhour:function(t){var e=t.minutes();return t=t.minutes(e>=45?45:e>=30?30:e>=15?15:0),Ge(t,{second:0,millisecond:0}),t},hour:function(t){return Ge(t,{minute:0,second:0,millisecond:0}),t},day:function(t){return Ge(t,{hour:0,minute:0,second:0,millisecond:0}),t},week:function(t){var e=t.clone();return(t=t.day(t._weekStart)).isAfter(e)&&(t=t.subtract(1,"week")),Ge(t,{hour:0,minute:0,second:0,millisecond:0}),t},month:function(t){return Ge(t,{date:1,hour:0,minute:0,second:0,millisecond:0}),t},quarter:function(t){var e=t.quarter();return gn[e]&&Ge(t,{month:gn[e][0],date:gn[e][1],hour:0,minute:0,second:0,millisecond:0}),t},season:function(t){var e=t.season(),n="north";"South"===t.hemisphere()&&(n="south");for(var i=0;i<bn[n].length;i++)if(bn[n][i][0]===e){var o=t.year();return"winter"===e&&t.month()<3&&(o-=1),Ge(t,{year:o,month:bn[n][i][1],date:bn[n][i][2],hour:0,minute:0,second:0,millisecond:0}),t}return t},year:function(t){return Ge(t,{month:0,date:1,hour:0,minute:0,second:0,millisecond:0}),t},decade:function(t){var e=(t=t.startOf("year")).year(),n=10*parseInt(e/10,10);return t.year(n)},century:function(t){var e=(t=t.startOf("year")).year(),n=100*parseInt(e/100,10);return t.year(n)}};pn.date=pn.day;var vn=function(t){return!!Ze().find((function(e){return e===t}))||!!Je().find((function(e){return e===t}))},_n=function(t){var e=t.timezones,n=t.tz;if(!1===e.hasOwnProperty(n)&&(n=We(t.tz,e)),null===n)return!1===t.silent&&console.warn("Warn: could not find given or local timezone - '"+t.tz+"'"),{current:{epochShift:0}};var i,o,a=e[n],r={name:(i=n,i=(i=(i=i[0].toUpperCase()+i.substr(1)).replace(/\/gmt/,"/GMT")).replace(/[\/_]([a-z])/gi,(function(t){return t.toUpperCase()}))),hasDst:Boolean(a.dst),default_offset:a.offset,hemisphere:"s"===a.hem?"South":"North",current:{}};if(r.hasDst){var c=(o=a.dst)?o.split("->"):[];r.change={start:c[0],back:c[1]}}var s=a.offset,d=s;return!0===r.hasDst&&(d="North"===r.hemisphere?s-1:a.offset+1),!1===r.hasDst?(r.current.offset=s,r.current.isDST=!1):!0===me(t.epoch,r.change.start,r.change.back,s)?(r.current.offset=s,r.current.isDST="North"===r.hemisphere):(r.current.offset=d,r.current.isDST="South"===r.hemisphere),r},yn=["century","decade","year","month","date","day","hour","minute","second","millisecond"],wn={set:function(t,e){var n=this.clone();return n=Be(n,t),e&&(this.tz=We(e)),n},timezone:function(){return _n(this)},isDST:function(){return _n(this).current.isDST},hasDST:function(){return _n(this).hasDst},offset:function(){return 60*_n(this).current.offset},hemisphere:function(){return _n(this).hemisphere},format:function(t){return on(this,t)},unixFmt:function(t){return function(t,e){for(var n=e.split(""),i=[n[0]],o=!1,a=1;a<n.length;a+=1){if("'"===n[a]){if(1!=(o=!o)||!n[a+1]||"'"!==n[a+1])continue;o=!0}!0===o||n[a]===i[i.length-1][0]?i[i.length-1]+=n[a]:i.push(n[a])}return i.reduce((function(e,n){return e+(void 0!==cn[n]?cn[n](t)||"":n)}),"")}(this,t)},startOf:function(t){return function(t,e){var n=t.clone();return e=le.normalize(e),pn[e]?pn[e](n):"summer"===e||"winter"===e?(n=n.season(e),pn.season(n)):n}(this,t)},endOf:function(t){return function(t,e){var n=t.clone();return e=le.normalize(e),pn[e]?n=(n=(n=pn[e](n)).add(1,e)).subtract(1,"milliseconds"):n}(this,t)},leapYear:function(){var t=this.year();return le.isLeapYear(t)},progress:function(t){return function(t,e){if(e)return e=le.normalize(e),ln(t,e);var n={};return dn.forEach((function(e){n[e]=ln(t,e)})),n}(this,t)},nearest:function(t){return function(t,e){var n=t.progress();return"quarterhour"===(e=le.normalize(e))&&(e="quarterHour"),void 0!==n[e]?(n[e]>.5&&(t=t.add(1,e)),t=t.startOf(e)):!1===t.silent&&console.warn("no known unit '"+e+"'"),t}(this,t)},diff:function(t,e){return function(t,e,n){e=le.beADate(e,t);var i=!1;if(t.isAfter(e)){var o=t;t=e,e=o,i=!0}var a=function(t,e){var n=e.epoch-t.epoch,i={milliseconds:n,seconds:parseInt(n/1e3,10)};i.minutes=parseInt(i.seconds/60,10),i.hours=parseInt(i.minutes/60,10);var o=t.clone();return i.years=function(t,e){var n=e.year()-t.year();return(t=t.year(e.year())).isAfter(e)&&(n-=1),n}(o,e),o=t.add(i.years,"year"),i.months=12*i.years,o=t.add(i.months,"month"),i.months+=mn(o,e,"month"),i.weeks=52*i.years,o=t.add(i.weeks,"week"),i.weeks+=mn(o,e,"week"),i.days=7*i.weeks,o=t.add(i.days,"day"),i.days+=mn(o,e,"day"),i}(t,e);return i&&(a=function(t){return Object.keys(t).forEach((function(e){t[e]*=-1})),t}(a)),n?(n=le.normalize(n),!0!==/s$/.test(n)&&(n+="s"),"dates"===n&&(n="days"),a[n]):a}(this,t,e)},since:function(t){return t||(t=this.clone().set()),function(t,e){var n,i,o,a=function(t,e){var n=t.isBefore(e),i=n?e:t,o=n?t:e;o=o.clone();var a={years:0,months:0,days:0,hours:0,minutes:0,seconds:0};return Object.keys(a).forEach((function(t){if(!o.isSame(i,t)){var e=o.diff(i,t);o=o.add(e,t),a[t]=e}})),n&&Object.keys(a).forEach((function(t){0!==a[t]&&(a[t]*=-1)})),a}(t,e=le.beADate(e,t));if(!0===Object.keys(a).every((function(t){return!a[t]})))return{diff:a,rounded:"now",qualified:"now",precise:"now"};var r=[];return Object.keys(a).forEach((function(t,e,o){var c=Math.abs(a[t]);if(0!==c){var s=fn(c,t);if(r.push(s),!n){if(n=i=s,e>4)return;var d=o[e+1],l=Math.abs(a[d]);l>hn[d].almost?(n=fn(c+1,t),i="almost "+n):l>hn[d].over&&(i="over "+s)}}})),o=r.splice(0,2).join(", "),!0===t.isAfter(e)?(n+=" ago",i+=" ago",o+=" ago"):(n="in "+n,i="in "+i,o="in "+o),{diff:a,rounded:n,qualified:i,precise:o}}(this,t)},next:function(t){return this.add(1,t).startOf(t)},last:function(t){return this.subtract(1,t).startOf(t)},isValid:function(){return!(!this.epoch&&0!==this.epoch||isNaN(this.d.getTime()))},goto:function(t){var e=this.clone();return e.tz=We(t,e.timezones),e},every:function(t,e){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;if(!e||!n)return[];if(e=le.normalize(e),n=t.clone().set(n),t.isAfter(n)){var i=t;t=n,n=i}var o=t.clone();vn(e)?(o=o.next(e),e="week"):o=o.next(e);for(var a=[];o.isBefore(n);)a.push(o),o=o.add(1,e);return a}(this,t,e)},isAwake:function(){var t=this.hour();return!(t<8||t>22)},isAsleep:function(){return!this.isAwake()},log:function(){return console.log(""),console.log(on(this,"nice-short")),this},logYear:function(){return console.log(""),console.log(on(this,"full-short")),this},json:function(){var t=this;return yn.reduce((function(e,n){return e[n]=t[n](),e}),{})},debug:function(){var t=this.timezone(),e=this.format("MM")+" "+this.format("date-ordinal")+" "+this.year();return e+="\n     - "+this.format("time"),console.log("\n\n",e+"\n     - "+t.name+" ("+t.current.offset+")"),this},from:function(t){return(t=this.clone().set(t)).since(this)},fromNow:function(){return this.clone().set(Date.now()).since(this)},weekStart:function(t){if("number"==typeof t)return this._weekStart=t,this;if("string"==typeof t){t=t.toLowerCase().trim();var e=Ze().indexOf(t);-1===e&&(e=Je().indexOf(t)),-1===e&&(e=1),this._weekStart=e}else console.warn("Spacetime Error: Cannot understand .weekStart() input:",t);return this}};wn.inDST=wn.isDST,wn.round=wn.nearest,wn.each=wn.every;var Cn=wn,On=function(t){return"string"==typeof t&&(t=parseInt(t,10)),t},xn=["year","month","date","hour","minute","second","millisecond"],Mn=function(t,e,n){for(var i=xn.indexOf(n),o=xn.slice(i,xn.length),a=0;a<o.length;a++){var r=e[o[a]]();t[o[a]](r)}return t},Pn=function(t,e){e=On(e);var n=t.clone(),i=t.minute()-e;return t.epoch-=i*ze.minute,Mn(t,n,"second"),t.epoch},kn=function(t,e){(e=On(e))>=24?e=24:e<0&&(e=0);var n=t.clone(),i=t.hour()-e;return t.epoch-=i*ze.hour,Ge(t,{hour:e}),Mn(t,n,"minute"),t.epoch},Vn=function(t,e){return e=On(e),Ge(t,{year:e}),t.epoch},Wn=function(t){return(t=(t=t.minute(0)).second(0)).millisecond(1)},In=Object.assign({},{millisecond:function(t){if(void 0!==t){var e=this.clone();return e.epoch=function(t,e){e=On(e);var n=t.millisecond();return t.epoch-(n-e)}(e,t),e}return this.d.getMilliseconds()},second:function(t){if(void 0!==t){var e=this.clone();return e.epoch=function(t,e){e=On(e);var n=t.second()-e;return t.epoch-n*ze.second}(e,t),e}return this.d.getSeconds()},minute:function(t){if(void 0!==t){var e=this.clone();return e.epoch=Pn(e,t),e}return this.d.getMinutes()},hour:function(t){var e=this.d;if(void 0!==t){var n=this.clone();return n.epoch=kn(n,t),n}return e.getHours()},hourFloat:function(t){if(void 0!==t){var e=this.clone(),n=t%1;n*=60;var i=parseInt(t,10);return e.epoch=kn(e,i),e.epoch=Pn(e,n),e}var o=this.d;return o.getHours()+o.getMinutes()/60},hour12:function(t){var e=this.d;if(void 0!==t){var n=this.clone(),i=(t=""+t).match(/^([0-9]+)(am|pm)$/);if(i){var o=parseInt(i[1],10);"pm"===i[2]&&(o+=12),n.epoch=kn(n,o)}return n}var a=e.getHours();return a>12&&(a-=12),0===a&&(a=12),a},time:function(t){if(void 0!==t){var e=this.clone();return e.epoch=function(t,e){var n=e.match(/([0-9]{1,2}):([0-9]{1,2})(am|pm)?/);if(!n){if(!(n=e.match(/([0-9]{1,2})(am|pm)/)))return t.epoch;n.splice(2,0,"0")}var i=!1,o=parseInt(n[1],10),a=parseInt(n[2],10);return o>12&&(i=!0),!1===i&&("am"===n[3]&&12===o&&(o=0),"pm"===n[3]&&o<12&&(o+=12)),(t=(t=(t=(t=t.hour(o)).minute(a)).second(0)).millisecond(0)).epoch}(e,t),e}return"".concat(this.h12(),":").concat(le.zeroPad(this.minute())).concat(this.ampm())},ampm:function(t){var e="am",n=this.hour();if(n>=12&&(e="pm"),"string"!=typeof t)return e;var i=this.clone();return t=t.toLowerCase().trim(),n>=12&&"am"===t?i.hour(n-=12):n<12&&"pm"===t?i.hour(n+=12):i},dayTime:function(t){if(void 0!==t){var e={morning:"7:00am",breakfast:"7:00am",noon:"12:00am",lunch:"12:00pm",afternoon:"2:00pm",evening:"6:00pm",dinner:"6:00pm",night:"11:00pm",midnight:"23:59pm"},n=this.clone();return t=(t=t||"").toLowerCase(),!0===e.hasOwnProperty(t)&&(n=n.time(e[t])),n}var i=this.hour();return i<6?"night":i<12?"morning":i<17?"afternoon":i<22?"evening":"night"},iso:function(t){return void 0!==t?this.set(t):this.format("iso")}},{date:function(t){if(void 0!==t){var e=this.clone();return e.epoch=function(t,e){if((e=On(e))>28){var n=Te[t.month()];e>n&&(e=n)}return e<=0&&(e=1),Ge(t,{date:e}),t.epoch}(e,t),e}return this.d.getDate()},day:function(t){if(void 0===t)return this.d.getDay();var e=this.clone(),n=t;"string"==typeof t&&(t=t.toLowerCase(),-1===(n=Ze().indexOf(t))&&(n=Je().indexOf(t)));var i=this.d.getDay(),o=this.subtract(24*(i-n),"hours");return Ge(o,{hour:e.hour(),minute:e.minute(),second:e.second()}),o},dayName:function(t){return void 0===t?Je()[this.day()]:this.clone().day(t)},month:function(t){if(void 0!==t){var e=this.clone();return e.epoch=function(t,e){"string"==typeof e&&(e=qe()[e.toLowerCase()]),(e=On(e))>=12&&(e=11),e<=0&&(e=0);var n=t.date();return n>Te[e]&&(n=Te[e]),Ge(t,{month:e,date:n}),t.epoch}(e,t),e}return this.d.getMonth()}},{dayOfYear:function(t){if(void 0!==t){var e=this.clone();return e.epoch=function(t,e){e=On(e);var n=t.clone();return(e-=1)<=0?e=0:e>=365&&(e=364),t=(t=t.startOf("year")).add(e,"day"),Mn(t,n,"hour"),t.epoch}(e,t),e}for(var n,i=0,o=this.d.getMonth(),a=1;a<=o;a++)(n=new Date).setDate(1),n.setFullYear(this.d.getFullYear()),n.setHours(1),n.setMinutes(1),n.setMonth(a),n.setHours(-2),i+=n.getDate();return i+this.d.getDate()},week:function(t){if(void 0!==t){var e=this.clone();return e=(e=(e=e.month(0)).date(1)).day("monday"),"december"===(e=Wn(e)).monthName()&&(e=e.add(1,"week")),e.add(t-=1,"weeks")}var n=this.clone();n=(n=n.month(0)).date(1),"december"===(n=(n=Wn(n)).day("monday")).monthName()&&(n=n.add(1,"week"));var i=1;1===n.date()&&(i=0),n=n.minus(1,"second");var o=this.epoch;if(n.epoch>o)return 1;var a=0,r=4*this.month();for(n.epoch+=ze.week*r,a+=r;a<52;a++){if(n.epoch>o)return a+i;n=n.add(1,"week")}return 52},monthName:function(t){return void 0===t?De[this.month()]:this.clone().month(t)},quarter:function(t){if(void 0!==t&&("string"==typeof t&&(t=t.replace(/^q/i,""),t=parseInt(t,10)),gn[t])){var e=this.clone();return(e=(e=e.month(gn[t][0])).date(1)).startOf("day")}for(var n=this.d.getMonth(),i=1;i<gn.length;i++)if(n<gn[i][0])return i-1;return 4},season:function(t){var e="north";if("South"===this.hemisphere()&&(e="south"),void 0!==t){for(var n=this.clone(),i=0;i<bn[e].length;i++)t===bn[e][i][0]&&(n=(n=(n=n.month(bn[e][i][1])).date(1)).startOf("day"));return n}for(var o=this.d.getMonth(),a=0;a<bn[e].length-1;a++)if(o>=bn[e][a][1]&&o<bn[e][a+1][1])return bn[e][a][0];return"winter"},year:function(t){if(void 0!==t){var e=this.clone();return e.epoch=Vn(e,t),e}return this.d.getFullYear()},era:function(t){if(void 0!==t){var e=this.clone();t=t.toLowerCase();var n=e.d.getFullYear();return"bc"===t&&n>0&&(e.epoch=Vn(e,-1*n)),"ad"===t&&n<0&&(e.epoch=Vn(e,-1*n)),e}return this.d.getFullYear()<0?"BC":"AD"},decade:function(t){if(void 0!==t){if(!(t=(t=(t=String(t)).replace(/([0-9])'?s$/,"$1")).replace(/([0-9])(th|rd|st|nd)/,"$1")))return console.warn("Spacetime: Invalid decade input"),this;2===t.length&&/[0-9][0-9]/.test(t)&&(t="19"+t);var e=Number(t);return isNaN(e)?this:(e=10*Math.floor(e/10),this.year(e))}return this.startOf("decade").year()},century:function(t){if(void 0!==t){"string"==typeof t&&(t=(t=(t=t.replace(/([0-9])(th|rd|st|nd)/,"$1")).replace(/([0-9]+) ?(b\.?c\.?|a\.?d\.?)/i,(function(t,e,n){return n.match(/b\.?c\.?/i)&&(e="-"+e),e}))).replace(/c$/,""));var e=Number(t);return isNaN(t)?(console.warn("Spacetime: Invalid century input"),this):(0===e&&(e=1),this.year(e=e>=0?100*(e-1):100*(e+1)))}var n=this.startOf("century").year();return(n=Math.floor(n/100))<0?n-1:n+1},millenium:function(t){if(void 0!==t){if("string"==typeof t&&(t=t.replace(/([0-9])(th|rd|st|nd)/,"$1"),t=Number(t),isNaN(t)))return console.warn("Spacetime: Invalid millenium input"),this;t>0&&(t-=1);var e=1e3*t;return 0===e&&(e=1),this.year(e)}var n=Math.floor(this.year()/1e3);return n>=0&&(n+=1),n}});In.milliseconds=In.millisecond,In.seconds=In.second,In.minutes=In.minute,In.hours=In.hour,In.hour24=In.hour,In.h12=In.hour12,In.h24=In.hour24,In.days=In.day;var zn=["millisecond","second","minute","hour","date","month"],En={second:zn.slice(0,1),minute:zn.slice(0,2),quarterhour:zn.slice(0,2),hour:zn.slice(0,3),date:zn.slice(0,4),month:zn.slice(0,4),quarter:zn.slice(0,4),season:zn.slice(0,4),year:zn,decade:zn,century:zn};En.week=En.hour,En.season=En.date,En.quarter=En.date;var jn={year:!0,quarter:!0,season:!0,month:!0,week:!0,day:!0},Gn={month:!0,quarter:!0,season:!0,year:!0},Fn={millisecond:function(t){return t.epoch},second:function(t){return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second()].join("-")},minute:function(t){return[t.year(),t.month(),t.date(),t.hour(),t.minute()].join("-")},hour:function(t){return[t.year(),t.month(),t.date(),t.hour()].join("-")},day:function(t){return[t.year(),t.month(),t.date()].join("-")},week:function(t){return[t.year(),t.week()].join("-")},month:function(t){return[t.year(),t.month()].join("-")},quarter:function(t){return[t.year(),t.quarter()].join("-")},year:function(t){return t.year()}};Fn.date=Fn.day;var Dn,Sn=we,qn=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.epoch=null,this.tz=We(e,Sn),this.silent=n.silent||!0,this.british=n.dmy||n.british,this._weekStart=1,void 0!==n.weekStart&&(this._weekStart=n.weekStart),Object.defineProperty(this,"d",{get:function(){var t=he(this),e=(new Date(this.epoch).getTimezoneOffset()||0)+60*t;return e=60*e*1e3,new Date(this.epoch+e)}}),Object.defineProperty(this,"timezones",{get:function(){return Sn},set:function(t){return Sn=t,t}}),void 0!==t||null===t){var i=Be(this,t,e);this.epoch=i.epoch}};Object.keys(Cn).forEach((function(t){qn.prototype[t]=Cn[t]})),qn.prototype.clone=function(){return new qn(this.epoch,this.tz,{silent:this.silent,weekStart:this._weekStart})},qn.prototype.toLocalDate=function(){return new Date(this.epoch)},Dn=qn,Object.keys(In).forEach((function(t){Dn.prototype[t]=In[t]})),function(t){t.prototype.add=function(t,e){var n=this.clone();if(!e||0===t)return n;var i=this.clone();e=le.normalize(e),ze[e]?n.epoch+=ze[e]*t:"week"===e?n.epoch+=ze.day*(7*t):"quarter"===e||"season"===e?n.epoch+=ze.month*(4*t):"season"===e?n.epoch+=ze.month*(4*t):"quarterhour"===e&&(n.epoch+=15*ze.minute*t);var o={};if(En[e]&&En[e].forEach((function(t){o[t]=i[t]()})),jn[e]){var a=i.timezone().current.offset-n.timezone().current.offset;n.epoch+=3600*a*1e3}if("month"===e&&(o.month=i.month()+t,o=function(t,e){if(t.month>0){var n=parseInt(t.month/12,10);t.year=e.year()+n,t.month=t.month%12}else if(t.month<0){var i=Math.floor(Math.abs(t.month)/13,10);i=Math.abs(i)+1,t.year=e.year()-i,t.month=t.month%12,t.month=t.month+12,12===t.month&&(t.month=0)}return t}(o,i)),"week"===e){var r=i.date()+7*t;r<=28&&r>1&&(o.date=r)}else if("date"===e){var c=i.date()+t;c<=28&&c>1?o.date=c:0!==t&&i.isSame(n,"day")&&(o.date=i.date()+t)}else"year"===e&&n.year()===i.year()?n.epoch+=ze.week:"decade"===e?o.year=n.year()+10:"century"===e&&(o.year=n.year()+100);if(Gn[e]){var s=Te[o.month];o.date=i.date(),o.date>s&&(o.date=s)}return Ge(n,o),n},t.prototype.subtract=function(t,e){return this.clone().add(-1*t,e)},t.prototype.minus=t.prototype.subtract,t.prototype.plus=t.prototype.add}(qn),function(t){t.prototype.isSame=function(e,n){return n?("string"!=typeof e&&"number"!=typeof e||(e=new t(e,this.timezone.name)),n=n.replace(/s$/,""),Fn[n]?Fn[n](this)===Fn[n](e):null):null}}(qn),function(t){var e={isAfter:function(t){t=le.beADate(t,this);var e=le.getEpoch(t);return null===e?null:this.epoch>e},isBefore:function(t){t=le.beADate(t,this);var e=le.getEpoch(t);return null===e?null:this.epoch<e},isEqual:function(t){t=le.beADate(t,this);var e=le.getEpoch(t);return null===e?null:this.epoch===e},isBetween:function(t,e){t=le.beADate(t,this),e=le.beADate(e,this);var n=le.getEpoch(t);if(null===n)return null;var i=le.getEpoch(e);return null===i?null:n<this.epoch&&this.epoch<i}};Object.keys(e).forEach((function(n){t.prototype[n]=e[n]}))}(qn),function(t){var e={i18n:function(t){var e;le.isObject(t.days)&&(Xe=(e=t.days).short||Xe,Ke=e.long||Ke),le.isObject(t.months)&&function(t){Fe=t.short||Fe,De=t.long||De}(t.months)}};Object.keys(e).forEach((function(n){t.prototype[n]=e[n]}))}(qn);var An=qn,Tn=function(t,e,n){return new An(t,e,n)};Tn.now=function(t,e){return new An((new Date).getTime(),t,e)},Tn.today=function(t,e){return new An((new Date).getTime(),t,e).startOf("day")},Tn.tomorrow=function(t,e){return new An((new Date).getTime(),t,e).add(1,"day").startOf("day")},Tn.yesterday=function(t,e){return new An((new Date).getTime(),t,e).subtract(1,"day").startOf("day")},Tn.extend=function(t){return Object.keys(t).forEach((function(e){An.prototype[e]=t[e]})),this},Tn.whereIts=function(t,e){var n=new An(null),i=new An(null);n=n.time(t),i=e?i.time(e):n.add(59,"minutes");var o=n.hour(),a=i.hour();return Object.keys(n.timezones).filter((function(t){if(-1===t.indexOf("/"))return!1;var e=new An(null,t),r=e.hour();return r>=o&&r<=a&&!(r===o&&e.minute()<n.minute())&&!(r===a&&e.minute()>i.minute())}))},Tn.version="6.4.1",Tn.plugin=Tn.extend;var $n=Tn,Nn=n("d3UM"),Rn=n("FKr1");function Hn(t,e){if(1&t&&(d.Wb(0,"div",8),d.Rb(1,"a-catering-order-item",9),d.Vb()),2&t){const t=e.$implicit,n=d.ic(2);d.Cb(1),d.oc("disabled",n.disabled)("symbol",n.symbol)("item",t)("field",n.items)}}function Qn(t,e){if(1&t&&(d.Ub(0),d.Ec(1,Hn,2,4,"div",7),d.Tb()),2&t){const t=d.ic();d.Cb(1),d.oc("ngForOf",t.category.items)}}const Un=function(){return{class:"material-icons",content:"close"}};function Yn(t,e){1&t&&(d.Wb(0,"div",10),d.Wb(1,"div",11),d.Rb(2,"app-icon",3),d.Vb(),d.Wb(3,"div",12),d.Gc(4,"Category contains no available items"),d.Vb(),d.Vb()),2&t&&(d.Cb(2),d.oc("icon",d.pc(1,Un)))}const Ln=function(){return{class:"material-icons",content:"arrow_back"}};let Bn=(()=>{class t{constructor(){this.close=new d.n}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=d.Kb({type:t,selectors:[["a-category-display"]],inputs:{category:"category",items:"items",symbol:"symbol",disabled:"disabled"},outputs:{close:"close"},decls:9,vars:5,consts:[[1,"header"],[1,"content"],["mat-icon-button","",3,"tapped"],[3,"icon"],[1,"name"],[4,"ngIf","ngIfElse"],["empty_state",""],["class","item",4,"ngFor","ngForOf"],[1,"item"],[3,"disabled","symbol","item","field"],[1,"info-block","center"],[1,"icon"],[1,"text"]],template:function(t,e){if(1&t&&(d.Wb(0,"div",0),d.Wb(1,"div",1),d.Wb(2,"button",2),d.ec("tapped",(function(){return e.close.emit()})),d.Rb(3,"app-icon",3),d.Vb(),d.Wb(4,"div",4),d.Gc(5),d.Vb(),d.Vb(),d.Vb(),d.Ec(6,Qn,2,1,"ng-container",5),d.Ec(7,Yn,5,2,"ng-template",null,6,d.Fc)),2&t){const t=d.tc(8);d.Cb(3),d.oc("icon",d.pc(4,Ln)),d.Cb(2),d.Hc(null==e.category?null:e.category.name),d.Cb(1),d.oc("ngIf",e.category.items&&e.category.items.length)("ngIfElse",t)}},directives:[w.b,O.c,C.a,i.t,i.s,ae],styles:[".header[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;width:100%;background-color:#fff;border-bottom:1px solid #ccc;padding:.5em;z-index:1}.header[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;align-items:center;width:640px;max-width:100vw;margin:auto}.header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{flex:1;text-align:center;margin-right:3em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.item[_ngcontent-%COMP%]{position:relative;width:640px;margin:.5em auto;background-color:#fff;border:1px solid #ccc;border-radius:4px;overflow:hidden;max-width:calc(100vw - 1em);z-index:0}"]}),t})();function Xn(t,e){if(1&t&&(d.Wb(0,"mat-option",17),d.Gc(1),d.Vb()),2&t){const t=e.$implicit;d.oc("value",t),d.Cb(1),d.Ic(" ",t.name," ")}}function Kn(t,e){if(1&t&&(d.Wb(0,"mat-option",17),d.Gc(1),d.Vb()),2&t){const t=e.$implicit;d.oc("value",t.id),d.Cb(1),d.Ic(" ",t.name," ")}}function Zn(t,e){if(1&t&&(d.Wb(0,"div",9),d.Wb(1,"form",10),d.Wb(2,"div",11),d.Wb(3,"label"),d.Gc(4,"Deliver to:"),d.Vb(),d.Wb(5,"mat-form-field",12),d.Wb(6,"mat-select",13),d.Ec(7,Xn,2,2,"mat-option",14),d.Vb(),d.Vb(),d.Vb(),d.Wb(8,"div",11),d.Wb(9,"label",15),d.Gc(10,"At:"),d.Vb(),d.Wb(11,"mat-form-field",12),d.Wb(12,"mat-select",16),d.Ec(13,Kn,2,2,"mat-option",14),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&t){const t=d.ic();d.Cb(1),d.oc("formGroup",t.form),d.Cb(6),d.oc("ngForOf",t.space_list),d.Cb(6),d.oc("ngForOf",t.available_times)}}function Jn(t,e){if(1&t){const t=d.Xb();d.Wb(0,"button",23),d.ec("tapped",(function(){d.wc(t);const n=e.$implicit;return d.ic(4).active_category=n})),d.Rb(1,"div",24),d.Wb(2,"div",25),d.Gc(3),d.Vb(),d.Vb()}if(2&t){const t=e.$implicit,n=d.ic(4);d.Dc("background-image","url("+t.image_path+")",d.Jb),d.oc("disabled",n.within_restricted_time&&!t.can_order_anytime),d.Cb(3),d.Hc(t.name)}}function ti(t,e){if(1&t&&(d.Wb(0,"div",21),d.Ec(1,Jn,4,4,"button",22),d.Vb()),2&t){const t=d.ic(3);d.Cb(1),d.oc("ngForOf",t.category_list)}}function ei(t,e){if(1&t&&(d.Ub(0),d.Ec(1,ti,2,1,"div",20),d.Tb()),2&t){const t=d.ic(2),e=d.tc(9);d.Cb(1),d.oc("ngIf",t.can_order&&t.category_list.length)("ngIfElse",e)}}function ni(t,e){if(1&t&&(d.Wb(0,"div",18),d.Ec(1,ei,2,2,"ng-container",19),d.Vb()),2&t){const t=d.ic(),e=d.tc(13);d.Cb(1),d.oc("ngIf",!t.active_category)("ngIfElse",e)}}function ii(t,e){if(1&t&&(d.Wb(0,"span",29),d.Gc(1),d.Vb()),2&t){const t=d.ic(2);d.Cb(1),d.Ic(" at least ",(null==t.active_building?null:t.active_building.catering_restricted_from)||"0"," hours in advance for meetings ")}}function oi(t,e){if(1&t&&(d.Wb(0,"div",26),d.Wb(1,"div",27),d.Rb(2,"img",28),d.Vb(),d.Wb(3,"p"),d.Gc(4," Catering is "),d.Wb(5,"span",29),d.Gc(6,"not available"),d.Vb(),d.Gc(7," for this booking."),d.Rb(8,"br"),d.Gc(9," Catering must be ordered within business hours "),d.Ec(10,ii,2,1,"span",30),d.Gc(11),d.Vb(),d.Vb()),2&t){const t=d.ic();d.Cb(10),d.oc("ngIf",null==t.active_building?null:t.active_building.catering_restricted_from),d.Cb(1),d.Ic(" at ",null==t.active_building?null:t.active_building.name,". ")}}function ai(t,e){if(1&t&&(d.Wb(0,"div",18),d.Wb(1,"div",31),d.Wb(2,"div",27),d.Rb(3,"mat-spinner",32),d.Vb(),d.Wb(4,"div",33),d.Gc(5),d.Vb(),d.Vb(),d.Vb()),2&t){const t=d.ic();d.Cb(5),d.Ic("Loading menu for ",null==t.active_building?null:t.active_building.name,"...")}}function ri(t,e){if(1&t){const t=d.Xb();d.Wb(0,"a-category-display",34),d.ec("close",(function(){return d.wc(t),d.ic().active_category=null})),d.Vb()}if(2&t){const t=d.ic();d.oc("category",t.active_category)("symbol",t.symbol)("items",t.form.controls.items)("disabled",t.within_restricted_time)}}let ci=(()=>{class t extends s.a{constructor(t,e){super(),this._service=t,this._dialog=e,this.event=new d.n,this.category_list=[],this.available_times=[]}get can_order(){if(!this.form||!this.form.controls.space)return!1;const t=this.form.controls.space.value;return(this._service.Organisation.buildings.find(e=>e.id===t.level.building_id).has_catering||this.category_list.length)&&(!this.within_restricted_time||this.has_available_items)}get active_building(){if(!this.form||!this.form.controls.space)return null;const t=this.form.controls.space.value;return t?this._service.Organisation.buildings.find(e=>t.level.building_id===e.id):null}get symbol(){const t=this.active_building;return t&&t.currency||"USD"}get item_count(){return this.form?(this.form.controls.items.value||[]).reduce((t,e)=>t+e.amount,0):0}get out_of_hours(){return!!this.form&&this.form.controls.start.value<0}get within_restricted_time(){if(!this.form||!this.form.controls.space)return!1;const t=this.form.controls.space.value,e=this._service.Organisation.buildings.find(e=>e.id===t.level.building_id);if(!e.catering_restricted_from||e.catering_restricted_from<=0)return!1;const n=_(),i=_(this.date).subtract(e.catering_restricted_from,"h");return n.isAfter(i,"s")}get has_available_items(){return this.category_list.reduce((t,e)=>t||e.can_order_anytime,!1)}ngOnInit(){this.generateAvailableTimes(),this.loadMenu()}ngOnChanges(t){(t.date||t.duration)&&(this.generateAvailableTimes(),this.form&&!this.available_times.find(t=>t.id===this.form.controls.start.value)&&this.form.controls.start.setValue(this.available_times[0].id)),t.space_list&&this.form&&this.space_list&&!this.form.controls.space.value&&this.form.controls.space.setValue(this.space_list[0]),t.order&&this.order&&this.initForm()}initForm(){this.form=new a.i({id:new a.f(this.order.id),booking_date:new a.f(this.all_day?_(this.date).startOf("d").valueOf():this.date),space:new a.f(this._service.Spaces.item(this.order.location_id)||this.space_list[0]),location_id:new a.f(this.order.location_id||this.space_list[0].id),start:new a.f(this.order.delivery_time||this.available_times[0].id),items:new a.f((this.order.items||[]).map(t=>new Et.a(t)))}),this.timeout("init_items",()=>this.form.controls.items.setValue((this.order.items||[]).map(t=>new Et.a(t))),50),this.subscription("space_change",this.form.controls.space.valueChanges.subscribe(t=>{this.form.controls.location_id.setValue(t.id),this.generateAvailableTimes(),this.available_times.find(t=>t.id===this.form.controls.start.value)||this.form.controls.start.setValue(this.available_times[0].id),this.loadMenu()})),this.generateAvailableTimes(),this.form&&!this.available_times.find(t=>t.id===this.form.controls.start.value)&&this.form.controls.start.setValue(this.available_times[0].id)}confirmOrder(){const t=this._dialog.open(se,{maxWidth:"95vw",data:{date:this.date,form:this.form}});this.subscription("confirm_event",t.componentInstance.event.subscribe(e=>{if("done"===e.reason){const e=new z.a(this.form.value);this.event.emit(e),t.close()}})),t.afterClosed().subscribe(()=>this.unsub("confirm_event"))}loadMenu(){const t=this.form.controls.space.value;t&&(this.form.controls.items.setValue([]),this.loading=!0,this._service.Menu.query({room_id:t.id}).then(t=>{this.loading=!1,this.category_list=(t||[]).map(t=>new zt.a(t))},()=>this.loading=!1))}generateAvailableTimes(){const t=this.all_day?_(this.date).startOf("d"):_(this.date);let{start:e,end:n}=this.generateStartAndEndTimes();for(e=e.minute(5*Math.ceil(e.minute()/5)),this.available_times=[];e.isBefore(n);)this.available_times.push({id:Math.abs(t.diff(e,"m")),name:e.format("h:mm A")}),e=e.add(5,"m");0===this.available_times.length&&this.available_times.push({id:-1,name:"Out of hours"})}generateStartAndEndTimes(){let t=_(this.date);this.all_day&&(t=t.startOf("d"));let e=this.all_day?t.endOf("d"):t.add(this.duration,"m"),n=$n(t.toDate());n=n.hour(7);const i=_(n.toLocalDate());if(console.log("Timezone start:",i.format("DD MMM, h:mm A")),t.isBefore(i,"m"))t=i,e=t.add(13,"h");else{const t=i.hour(20);console.log("Timezone end:",t.format("DD MMM, h:mm A")),e.isAfter(t)&&(e=t)}return{start:t,end:e}}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(c.a),d.Qb(v.b))},t.\u0275cmp=d.Kb({type:t,selectors:[["a-catering-order-details"]],inputs:{order:"order",date:"date",duration:"duration",space_list:"space_list",all_day:"all_day"},outputs:{event:"event"},features:[d.zb,d.Ab],decls:14,vars:5,consts:[[1,"catering","order-details"],["class","header",4,"ngIf"],["class","body",4,"ngIf","ngIfElse"],[1,"footer"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"disabled","tapped"],["empty_state",""],["load_state",""],["category_display",""],[1,"header"],[3,"formGroup"],[1,"field"],["appearance","outline"],["formControlName","space"],[3,"value",4,"ngFor","ngForOf"],["for",""],["formControlName","start"],[3,"value"],[1,"body"],[4,"ngIf","ngIfElse"],["class","contents",4,"ngIf","ngIfElse"],[1,"contents"],["mat-button","","class","category",3,"background-image","disabled","tapped",4,"ngFor","ngForOf"],["mat-button","",1,"category",3,"disabled","tapped"],[1,"overlay"],[1,"name"],[1,"empty-state","center"],[1,"icon"],["alt","No Catering Available","src","assets/img/no-catering.svg"],[1,"bold"],["class","bold",4,"ngIf"],[1,"info-block","center"],["diameter","48"],[1,"text"],[3,"category","symbol","items","disabled","close"]],template:function(t,e){if(1&t&&(d.Wb(0,"div",0),d.Ec(1,Zn,14,3,"div",1),d.Ec(2,ni,2,2,"div",2),d.Wb(3,"div",3),d.Wb(4,"button",4),d.ec("tapped",(function(){return e.event.emit()})),d.Gc(5,"Back"),d.Vb(),d.Wb(6,"button",5),d.ec("tapped",(function(){return e.confirmOrder()})),d.Gc(7),d.Vb(),d.Vb(),d.Vb(),d.Ec(8,oi,12,2,"ng-template",null,6,d.Fc),d.Ec(10,ai,6,1,"ng-template",null,7,d.Fc),d.Ec(12,ri,1,4,"ng-template",null,8,d.Fc)),2&t){const t=d.tc(11);d.Cb(1),d.oc("ngIf",e.form),d.Cb(1),d.oc("ngIf",!e.loading)("ngIfElse",t),d.Cb(4),d.oc("disabled",!e.item_count||e.out_of_hours),d.Cb(1),d.Ic(" Confirm Order(",e.item_count||"0",") ")}},directives:[i.t,w.b,O.c,a.H,a.s,a.j,x.b,Nn.a,a.r,a.h,i.s,Rn.g,ft.c,Bn],styles:["[_nghost-%COMP%]{height:100%}.order-details[_ngcontent-%COMP%]{height:100%;margin:auto;max-width:100vw}.header[_ngcontent-%COMP%], .order-details[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;width:100%}.header[_ngcontent-%COMP%]{justify-content:center;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);z-index:99}.body[_ngcontent-%COMP%]{position:relative;flex:1;width:100%;min-height:50%;overflow:hidden auto}.footer[_ngcontent-%COMP%]{width:100%;text-align:center;border-top:1px solid #ccc;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:.5em}form[_ngcontent-%COMP%]{display:flex;align-items:center}.field[_ngcontent-%COMP%]{margin:0 .5em;max-height:3.5em}@media only screen and (orientation:portrait) and (max-width:450px){.field[_ngcontent-%COMP%]{max-height:4.75em}}@media only screen and (orientation:landscape) and (max-width:800px){.field[_ngcontent-%COMP%]{max-height:4.75em}}.contents[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;max-width:768px;margin:auto}.category[_ngcontent-%COMP%]{position:relative;background-position:50%;background-size:cover;height:11em;width:11em;margin:1em;border-radius:4px;border:none;padding:0;background-color:#fff;transition:box-shadow .2s}.category[_ngcontent-%COMP%]:hover{box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.category[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.35);border-radius:4px}.category[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:99;max-width:9em;white-space:normal;line-height:1.25em;margin:0}@media only screen and (orientation:portrait) and (max-width:450px){mat-form-field[_ngcontent-%COMP%]{width:11.75em}}@media only screen and (orientation:landscape) and (max-width:800px){mat-form-field[_ngcontent-%COMP%]{width:11.75em}}label[_ngcontent-%COMP%]{font-weight:500;font-size:.8em;margin-right:.75em}.empty-state[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;background-color:#fff;border-radius:4px;padding:1em;max-width:calc(100vw - 2em);box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.empty-state[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ce1a51}.empty-state[_ngcontent-%COMP%]   .bold[_ngcontent-%COMP%]{font-weight:400}.empty-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:6em;width:8em}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;max-width:24em}.info-block[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:2.5em;width:2.5em}"]}),t})();function si(t,e){if(1&t){const t=d.Xb();d.Ub(0),d.Wb(1,"a-catering-order-list",3),d.ec("order",(function(e){d.wc(t);const n=d.ic();return e?n.active_order=e:n.newOrder()}))("event",(function(e){return d.wc(t),d.ic().event.emit(e)})),d.Vb(),d.Tb()}if(2&t){const t=d.ic();d.Cb(1),d.oc("catering",t.catering_field)("date",t.date)("all_day",t.all_day)}}function di(t,e){if(1&t){const t=d.Xb();d.Wb(0,"a-catering-order-details",4),d.ec("event",(function(e){d.wc(t);const n=d.ic();return e?n.handleOrderEvent(e):n.active_order=null})),d.Vb()}if(2&t){const t=d.ic();d.oc("space_list",t.space_list)("order",t.active_order)("date",t.date)("duration",t.duration)("all_day",t.all_day)}}let li=(()=>{class t{constructor(){this.event=new d.n}get catering_field(){return this.form?this.form.controls.catering:null}get space_list(){return this.form?this.form.controls.space_list.value:[]}get date(){return this.form?this.form.controls.date.value:_().valueOf()}get duration(){return this.form?this.form.controls.duration.value:60}get all_day(){return!!this.form&&this.form.controls.all_day.value}newOrder(){const t=new z.a({});this.active_order=t}handleOrderEvent(t){if(t){const e=this.form.controls.catering.value||[],n=e.findIndex(e=>t.id===e.id);n<0?e.push(t):e.splice(n,1,t),this.form.controls.catering.setValue(e)}this.active_order=null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=d.Kb({type:t,selectors:[["booking-catering"]],inputs:{form:"form"},outputs:{event:"event"},decls:4,vars:2,consts:[[1,"catering"],[4,"ngIf","ngIfElse"],["order_display",""],[3,"catering","date","all_day","order","event"],[3,"space_list","order","date","duration","all_day","event"]],template:function(t,e){if(1&t&&(d.Wb(0,"div",0),d.Ec(1,si,2,3,"ng-container",1),d.Vb(),d.Ec(2,di,1,5,"ng-template",null,2,d.Fc)),2&t){const t=d.tc(3);d.Cb(1),d.oc("ngIf",!e.active_order)("ngIfElse",t)}},directives:[i.t,It,ci],styles:[".catering[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%;width:100%}"]}),t})();var ui=n("4Man");const mi=["container"],hi=function(){return{class:"material-icons",content:"refresh"}};let fi=(()=>{class t{constructor(){this.event=new d.n}next(){this.form.markAllAsTouched(),this.form.valid?this.event.emit({type:"next",step:"form"}):this.container&&this.container.nativeElement.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}previous(){this.event.emit({type:"previous",step:"form"})}resetForm(){this.event.emit({type:"reset",step:"form"})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=d.Kb({type:t,selectors:[["booking-spaces-form"]],viewQuery:function(t,e){var n;1&t&&d.Cc(mi,!0),2&t&&d.sc(n=d.fc())&&(e.container=n.first)},inputs:{form:"form"},outputs:{event:"event"},decls:15,vars:4,consts:[[1,"booking-form"],["container",""],[1,"header"],["mat-icon-button","","name","reset",3,"tapped"],[3,"icon"],[3,"formGroup","ngSubmit"],[1,"body"],[3,"form"],[1,"footer"],["mat-button","","type","button",1,"inverse",3,"tapped"],["mat-button","","type","submit"]],template:function(t,e){1&t&&(d.Wb(0,"div",0,1),d.Wb(2,"div",2),d.Wb(3,"h3"),d.Gc(4,"New Booking"),d.Vb(),d.Wb(5,"button",3),d.ec("tapped",(function(){return e.resetForm()})),d.Rb(6,"app-icon",4),d.Vb(),d.Vb(),d.Wb(7,"form",5),d.ec("ngSubmit",(function(){return e.next()})),d.Wb(8,"div",6),d.Rb(9,"a-booking-form",7),d.Vb(),d.Wb(10,"div",8),d.Wb(11,"button",9),d.ec("tapped",(function(){return e.previous()})),d.Gc(12,"Back"),d.Vb(),d.Wb(13,"button",10),d.Gc(14,"Next"),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&t&&(d.Cb(6),d.oc("icon",d.pc(3,hi)),d.Cb(1),d.oc("formGroup",e.form),d.Cb(2),d.oc("form",e.form))},directives:[w.b,O.c,C.a,a.H,a.s,a.j,ui.a],styles:[".booking-form[_ngcontent-%COMP%]{width:768px;max-width:95vw;min-height:100%;background-color:#fff;margin:auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}form[_ngcontent-%COMP%]{padding:1em}.header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5em 1em;border-bottom:1px solid #f0f0f0}h3[_ngcontent-%COMP%]{min-width:50%;flex:1;margin:0}.footer[_ngcontent-%COMP%]{margin-top:1em;text-align:center}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:0 .5em}"]}),t})();function bi(t,e){if(1&t){const t=d.Xb();d.Wb(0,"booking-find-space",5),d.ec("event",(function(e){return d.wc(t),d.ic(2).handleFlowEvent(e)})),d.Vb()}if(2&t){const t=d.ic(2);d.oc("spaces",t.form.controls.space_list)("form",t.form)}}function gi(t,e){if(1&t&&(d.Ub(0),d.Ec(1,bi,1,2,"booking-find-space",4),d.Tb()),2&t){const t=d.ic();d.Cb(1),d.oc("ngIf",t.form)}}function pi(t,e){if(1&t){const t=d.Xb();d.Wb(0,"booking-catering",7),d.ec("event",(function(e){return d.wc(t),d.ic(2).handleFlowEvent(e)})),d.Vb()}if(2&t){const t=d.ic(2);d.oc("form",t.form)}}function vi(t,e){if(1&t&&(d.Ub(0),d.Ec(1,pi,1,1,"booking-catering",6),d.Tb()),2&t){const t=d.ic();d.Cb(1),d.oc("ngIf",t.form)}}function _i(t,e){if(1&t){const t=d.Xb();d.Wb(0,"booking-spaces-form",7),d.ec("event",(function(e){return d.wc(t),d.ic(2).handleFlowEvent(e)})),d.Vb()}if(2&t){const t=d.ic(2);d.oc("form",t.form)}}function yi(t,e){if(1&t&&(d.Ub(0),d.Ec(1,_i,1,1,"booking-spaces-form",6),d.Tb()),2&t){const t=d.ic();d.Cb(1),d.oc("ngIf",t.form)}}let wi=(()=>{class t extends s.a{constructor(t,e,n,i){super(),this._service=t,this._route=e,this._router=n,this._dialog=i}get available_fields(){return this._service.setting("app.booking.show_fields")||[]}ngOnInit(){this._service.initialised.pipe(Object(p.a)(t=>t)).subscribe(()=>{this.subscription("route.params",this._route.paramMap.subscribe(t=>{t.has("step")&&(this.flow_step=t.get("step"))})),this._service.Spaces.initialised.pipe(Object(p.a)(t=>t)).subscribe(()=>{this.loadFormData()})})}handleFlowEvent(t){"next"===t.type?this.toNextFlowStep(t):"previous"===t.type?this.toPreviousFlowStep(t):"reset"===t.type&&this.resetForm()}toNextFlowStep(t){const e=this.form.controls.space_list.value;switch(t.step){case"search":!e||!e.length||t.metadata&&t.metadata.ref&&"equipment"===t.metadata.ref?this.form.controls.has_catering&&this.form.controls.has_catering.value?this.navigate("catering"):(this.navigate("form"),this.confirmBooking()):this.openEquipmentDetailsModal();break;case"catering":const n=this.form.controls.catering.value;!n||!n.length||t.metadata&&t.metadata.ref&&"details"===t.metadata.ref?(this.navigate("form"),this.confirmBooking()):this.openCateringDetailsModal();break;default:this.form.controls.needs_space.value||e&&e.length?this.navigate("search"):this.confirmBooking()}}toPreviousFlowStep(t){switch(t.step){case"search":this.navigate("form");break;case"catering":this.navigate("search")}}navigate(t){this._router.navigate(["book","spaces",t],{queryParamsHandling:"preserve"}),this.flow_step=t}resetForm(){this.booking.clearPendingChanges(),delete this.form,this.form=Object(b.a)(this.booking,this._service.Users.current,this.available_fields)}loadFormData(){let t={};if(localStorage){const n=localStorage.getItem("ACA_STAFF.booking_form_data");if(n)try{t=JSON.parse(n)}catch(e){}}if(this.booking=new f.a(this._service.Bookings,t||{}),this.subscription("form_changes",this.booking.changeEvents.subscribe(()=>this.saveFormData())),this.form=Object(b.a)(this.booking,this._service.Users.current,this.available_fields),t&&!t.id)for(const n in t)this.form.controls[n]?this.form.controls[n].setValue(t[n]):this.booking.hasOwnProperty("")&&this.booking.storePendingChange(n,t[n]);t&&t.room_ids&&this.form.controls.space_list&&this.form.controls.space_list.setValue(t.room_ids.map(t=>this._service.Spaces.item(t)||{id:t,name:t}))}saveFormData(){localStorage&&this.booking&&localStorage.setItem("ACA_STAFF.booking_form_data",JSON.stringify(this.booking.toJSON(!0)))}openEquipmentDetailsModal(){const t=this._dialog.open(I,{maxWidth:"95vw",width:"32em",data:{spaces:this.form.controls.space_list.value,notes_field:this.form.controls.notes,codes_field:this.form.controls.equipment_codes,head_counts_field:this.form.controls.expected_attendees}});this.subscription("modal_events",t.componentInstance.event.subscribe(e=>{"done"===e.reason&&(this.toNextFlowStep({type:"next",step:"search",metadata:{ref:"equipment"}}),t.close())})),t.afterClosed().subscribe(()=>this.unsub("modal_events"))}openCateringDetailsModal(){const t=this._dialog.open(D,{maxWidth:"95vw",width:"32em",data:{spaces:this.form.controls.space_list.value,notes_field:this.form.controls.notes,catering:this.form.controls.catering}});this.subscription("modal_events",t.componentInstance.event.subscribe(e=>{"done"===e.reason&&(this.toNextFlowStep({type:"next",step:"catering",metadata:{ref:"details"}}),t.close())})),t.afterClosed().subscribe(()=>this.unsub("modal_events"))}confirmBooking(){this.booking.has_changes?this.form.valid&&this._dialog.open(g.a,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{booking:this.booking}}).componentInstance.event.subscribe(t=>{"success"===t.type&&this._router.navigate(["/schedule"])}):this._service.notifyInfo("No changes have been made to booking")}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(c.a),d.Qb(o.a),d.Qb(o.d),d.Qb(v.b))},t.\u0275cmp=d.Kb({type:t,selectors:[["booking-space-flow"]],features:[d.zb],decls:5,vars:3,consts:[[1,"space-flow"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"spaces","form","event",4,"ngIf"],[3,"spaces","form","event"],[3,"form","event",4,"ngIf"],[3,"form","event"]],template:function(t,e){1&t&&(d.Wb(0,"div",0),d.Ub(1,1),d.Ec(2,gi,2,1,"ng-container",2),d.Ec(3,vi,2,1,"ng-container",2),d.Ec(4,yi,2,1,"ng-container",3),d.Tb(),d.Vb()),2&t&&(d.Cb(1),d.oc("ngSwitch",e.flow_step),d.Cb(1),d.oc("ngSwitchCase","search"),d.Cb(1),d.oc("ngSwitchCase","catering"))},directives:[i.x,i.y,i.z,i.t,Ct,li,fi],styles:[".space-flow[_ngcontent-%COMP%]{height:100%;overflow:auto}"]}),t})();var Ci=n("1gA9"),Oi=n("Nuht"),xi=n("DWOX"),Mi=n("ocbO"),Pi=n("4Uey"),ki=n("p5rm"),Vi=n("q/nq"),Wi=n("4kJo"),Ii=n("A+eD"),zi=n("oTgu"),Ei=n("vJ8U"),ji=n("1k4r"),Gi=n("5fZw"),Fi=n("WE8N"),Di=n("1DiH"),Si=n("CTJb"),qi=n("opQU"),Ai=n("zx1i"),Ti=n("cH1L"),$i=n("dNgK"),Ni=n("ihCf"),Ri=n("bv9b"),Hi=n("/1cH"),Qi=n("STbY"),Ui=n("q/DJ");n.d(e,"BookingsModule",(function(){return Li}));const Yi=[{path:":flow",component:m},{path:":flow/:step",component:m},{path:"",redirectTo:"spaces"}];let Li=(()=>{class t{}return t.\u0275mod=d.Ob({type:t}),t.\u0275inj=d.Nb({factory:function(e){return new(e||t)},imports:[[i.c,o.h.forChild(Yi),h.a,a.l,a.B,r.b]]}),t})();d.zc(m,[i.q,i.r,i.s,i.t,i.A,i.w,i.x,i.y,i.z,i.u,i.v,o.i,o.e,o.g,o.f,o.j,Ci.d,Ci.e,Ci.f,O.b,O.c,Oi.a,s.a,xi.a,C.a,Mi.a,Pi.a,ki.a,Vi.a,Wi.a,Ii.a,ui.a,zi.a,Ei.a,ji.a,Gi.a,Fi.a,Di.a,Si.a,qi.a,Ai.a,Yt.a,w.b,w.a,Ti.b,$i.b,v.e,v.d,v.i,v.f,v.c,x.a,x.b,x.e,x.f,x.g,x.h,x.i,Ni.b,Ni.c,M.a,M.c,ft.a,ft.c,Ri.a,Hi.a,Rn.g,Rn.f,Hi.d,Hi.c,Nn.a,Nn.c,Y.d,Y.a,Y.c,Y.e,Y.b,Y.f,Rn.j,Qi.e,Qi.b,Qi.d,Qi.a,U.a,U.c,Ut.a,Ut.c,jt.b,jt.a,y.c,y.d,y.a,y.f,y.e,y.b,it.a,it.b,it.c,it.d,a.H,a.w,a.G,a.c,a.x,a.A,a.a,a.D,a.E,a.z,a.r,a.s,a.C,a.n,a.m,a.y,a.b,a.d,a.u,a.v,a.t,a.g,a.j,a.h,a.k,a.e,r.a,m,wi,fi,Ct,ht,nt,li,It,ci,Mt,Bn,se,ae,Qt,I,D,st],[i.b,i.G,i.p,i.k,i.E,i.g,i.C,i.F,i.d,i.f,i.i,i.j,i.l,Ui.b,Ui.c])}}]);