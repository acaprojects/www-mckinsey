(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{cmhh:function(t,e,n){"use strict";n.r(e);var i=n("ofXK"),o=n("tyNb"),a=n("3Pt+"),r=n("IhUT"),c=n("OaWH"),s=n("IWZj"),u=n("fXoL");function l(t,e){1&t&&u.Rb(0,"booking-desk-flow")}function d(t,e){1&t&&u.Rb(0,"booking-space-flow")}let m=(()=>{class t extends s.a{constructor(t,e,n){super(),this._service=t,this._route=e,this._router=n}ngOnInit(){this._service.title="Book",this.subscription("route.params",this._route.paramMap.subscribe(t=>{t.has("flow")&&(this.flow=t.get("flow"))})),this.subscription("router.events",this._router.events.subscribe(t=>{t instanceof o.c&&t.url.indexOf("book")<0&&localStorage.removeItem("ACA_STAFF.booking_form_data")}))}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(c.a),u.Qb(o.a),u.Qb(o.d))},t.\u0275cmp=u.Kb({type:t,selectors:[["app-bookings"]],features:[u.zb],decls:10,vars:4,consts:[[1,"booking","page"],[1,"header"],[3,"menu","menuChange"],[1,"body"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"footer"],[3,"show","showChange"]],template:function(t,e){1&t&&(u.Wb(0,"div",0),u.Wb(1,"header",1),u.Wb(2,"a-topbar-header",2),u.ec("menuChange",(function(t){return e.show_menu=t})),u.Vb(),u.Vb(),u.Wb(3,"main",3),u.Ub(4,4),u.Ec(5,l,1,0,"booking-desk-flow",5),u.Ec(6,d,1,0,"booking-space-flow",6),u.Tb(),u.Vb(),u.Wb(7,"footer",7),u.Rb(8,"a-footer-menu"),u.Vb(),u.Vb(),u.Wb(9,"a-overlay-menu",8),u.ec("showChange",(function(t){return e.show_menu=t})),u.Vb()),2&t&&(u.Cb(2),u.oc("menu",e.show_menu),u.Cb(2),u.oc("ngSwitch",e.flow),u.Cb(1),u.oc("ngSwitchCase","desks"),u.Cb(4),u.oc("show",e.show_menu))},styles:[".page[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;flex-direction:column}.page[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.body[_ngcontent-%COMP%]{min-width:50%;min-height:50%;flex:1}"]}),t})();var h=n("PCNd"),f=n("xhdr"),b=n("5RMF"),g=n("Ofvs"),p=n("SxV6"),v=n("g0I+"),_=n("0IaG"),y=n("7c/B"),w=n("Wgwc"),C=n("wZkO"),O=n("bTqV"),x=n("0njA"),M=n("m6yr"),k=n("kmnG"),P=n("qFsG");function V(t,e){if(1&t&&u.Rb(0,"mat-tab",11),2&t){const t=e.$implicit,n=u.ic();u.oc("label",t.name+(n.form[t.id].invalid&&n.form[t.id].touched?"*":""))}}function W(t,e){1&t&&(u.Wb(0,"span"),u.Gc(1,"*"),u.Vb())}function I(t,e){if(1&t&&(u.Wb(0,"form",12),u.Wb(1,"div",13),u.Wb(2,"label",14),u.Gc(3,"(eg - allergies, in tolerances, no ice in drinks etc) Additional requests are handled in confidence."),u.Vb(),u.Wb(4,"mat-form-field",15),u.Rb(5,"textarea",16),u.Vb(),u.Vb(),u.Wb(6,"div",13),u.Wb(7,"label",17),u.Gc(8,"Charge Code"),u.Ec(9,W,2,0,"span",18),u.Vb(),u.Wb(10,"mat-form-field",15),u.Rb(11,"input",19),u.Wb(12,"mat-error"),u.Gc(13,"Charge Code is required"),u.Vb(),u.Wb(14,"mat-hint"),u.Wb(15,"span"),u.Gc(16,"Note:"),u.Vb(),u.Gc(17," Your booking will be confirmed before you are charged."),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&t){const t=u.ic();u.oc("formGroup",t.active_form),u.Cb(7),u.Gb("error",t.active_form.controls.code.touched&&t.active_form.controls.code.invalid),u.Cb(2),u.oc("ngIf",t.needs_charge_code[t.space_list[t.active_space].id])}}const z=function(){return{class:"material-icons",content:"close"}};let E=(()=>{class t{constructor(t,e){this._service=t,this._data=e,this.event=new u.n,this.notes={},this.codes={},this.head_counts={},this.form={},this.needs_charge_code={},this.active_space=0}get space_list(){return this._data.spaces||[]}get active_form(){return this.form[this.space_list[this.active_space].id]}get is_valid(){return this.space_list.reduce((t,e)=>t&&this.form[e.id].valid,!0)}ngOnInit(){const t=(this._data.notes_field.value||[]).filter(t=>"catering"===t.type);this.notes=t.reduce((t,e)=>(t[e.space]=e.message,t),{}),this.codes=(this._data.catering.value||[]).reduce((t,e)=>(t[e.location_id]=e.charge_code,t),{}),this.generateFormFields()}submit(){if(this.space_list.forEach(t=>this.form[t.id].markAllAsTouched()),this.is_valid){const t=(this._data.notes_field.value||[]).filter(t=>"catering"!==t.type),e=this.space_list.map(t=>({author:this._service.Users.current.name,type:"catering",message:this.form[t.id].controls.notes.value,space:t.id,date:w().valueOf()}));this._data.notes_field.setValue(t.concat(e).filter(t=>t.message));const n=(this._data.catering.value||[]).map(t=>new y.a(Object.assign(Object.assign({},t),{charge_code:this.form[t.location_id].controls.code.value})));this._data.catering.setValue(n),this.event.emit({reason:"done"})}}generateFormFields(){for(const t of this.space_list){const e=this._service.Organisation.buildings.find(e=>e.id===t.level.building_id);this.needs_charge_code[t.id]=e.required.equipment_code,this.form[t.id]=new a.i({notes:new a.f(this.notes[t.id]||""),code:new a.f(this.codes[t.id]||"",e.required.equipment_code?[a.F.required]:[])})}}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(c.a),u.Qb(_.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["a-catering-details-modal"]],outputs:{event:"event"},decls:17,vars:5,consts:[[1,"header"],[1,"tabs"],[3,"selectedIndex","selectedIndexChange"],[3,"label",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"details"],["src","assets/img/food-notes.svg"],[1,"text"],[3,"formGroup",4,"ngIf"],["mat-button","",3,"tapped"],[3,"label"],[3,"formGroup"],[1,"field"],["for","equipment-notes"],["appearance","outline"],["matInput","","name","equipment-notes","formControlName","notes","placeholder","Add notes here..."],["for","charge-code"],[4,"ngIf"],["matInput","","name","charge-code","formControlName","code","placeholder","Charge Code"]],template:function(t,e){1&t&&(u.Wb(0,"div",0),u.Wb(1,"div",1),u.Wb(2,"mat-tab-group",2),u.ec("selectedIndexChange",(function(t){return e.active_space=t})),u.Ec(3,V,1,1,"mat-tab",3),u.Vb(),u.Vb(),u.Wb(4,"button",4),u.Rb(5,"app-icon",5),u.Vb(),u.Vb(),u.Wb(6,"mat-dialog-content"),u.Wb(7,"main"),u.Wb(8,"div",6),u.Rb(9,"img",7),u.Wb(10,"div",8),u.Gc(11,"Please specify any allergies or gluten intolerances"),u.Vb(),u.Vb(),u.Ec(12,I,18,4,"form",9),u.Vb(),u.Vb(),u.Wb(13,"mat-dialog-actions"),u.Wb(14,"footer"),u.Wb(15,"button",10),u.ec("tapped",(function(){return e.submit()})),u.Gc(16,"Add to booking"),u.Vb(),u.Vb(),u.Vb()),2&t&&(u.Cb(2),u.oc("selectedIndex",e.active_space),u.Cb(1),u.oc("ngForOf",e.space_list),u.Cb(2),u.oc("icon",u.pc(4,z)),u.Cb(7),u.oc("ngIf",e.space_list[e.active_space]&&e.active_form))},directives:[C.c,i.s,O.b,_.d,x.a,_.f,i.t,_.c,M.c,C.a,a.H,a.s,a.j,k.b,P.a,a.c,a.r,a.h,k.a,k.e],styles:[".header[_ngcontent-%COMP%]{display:flex;align-items:center;border-bottom:1px solid #ccc;width:100%}.header[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{min-width:50%;flex:1}.details[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;text-align:center;margin-bottom:1em}main[_ngcontent-%COMP%]{padding:1em 1em 0}mat-hint[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#1937ea}label[_ngcontent-%COMP%]{min-width:100%;margin-right:1em;font-weight:700;font-size:.8em;width:100%;margin-top:0;margin-bottom:.5em}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ffb300}label.error[_ngcontent-%COMP%]{color:#e53935}mat-form-field[_ngcontent-%COMP%]{flex:1}mat-tab[_ngcontent-%COMP%]{display:none!important}.field[_ngcontent-%COMP%]{display:flex;min-width:14em;flex:1;flex-wrap:wrap}textarea[_ngcontent-%COMP%]{min-height:7em}.fieldset[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0 .25em}@media only screen and (orientation:portrait) and (max-width:450px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0}}@media only screen and (orientation:landscape) and (max-width:800px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0}}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:first-child{margin-left:0}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:last-child{margin-right:0}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),t})();var j=n("Kj3r"),D=n("/uUt"),G=n("eIep"),S=n("JIr8"),F=n("lJxs"),A=n("XNiG"),T=n("LRne"),q=n("YxBP"),$=n("CbDI"),N=n("bSwM"),R=n("A5z7");function H(t,e){if(1&t){const t=u.Xb();u.Wb(0,"div",14),u.Wb(1,"mat-checkbox",15),u.ec("change",(function(n){u.wc(t);const i=e.$implicit,o=u.ic(2);return n.checked?o.addLocationFilter(i):o.removeLocationFilter(i)})),u.Wb(2,"div",16),u.Wb(3,"div",17),u.Gc(4),u.Vb(),u.Wb(5,"div",18),u.Gc(6),u.Vb(),u.Wb(7,"div",19),u.Gc(8),u.Vb(),u.Vb(),u.Vb(),u.Vb()}if(2&t){const t=e.$implicit;u.Cb(4),u.Hc(t.code),u.Cb(2),u.Hc(t.name),u.Cb(2),u.Hc(t.address)}}const Q=function(){return{type:"icon",class:"material-icons",content:"close"}};function U(t,e){if(1&t){const t=u.Xb();u.Wb(0,"mat-chip",23),u.ec("removed",(function(){u.wc(t);const n=e.$implicit;return u.ic(3).removeLocationFilter(n)})),u.Gc(1),u.Rb(2,"app-icon",24),u.Vb()}if(2&t){const t=e.$implicit;u.oc("id",t.id)("removable",!0),u.Cb(1),u.Ic(" ",t.name," "),u.Cb(1),u.oc("icon",u.pc(4,Q))}}function Y(t,e){if(1&t&&(u.Wb(0,"div",20),u.Wb(1,"mat-chip-list",21),u.Ec(2,U,3,5,"mat-chip",22),u.Vb(),u.Vb()),2&t){const t=u.ic(2);u.Cb(2),u.oc("ngForOf",t.location_list)}}const L=function(){return{class:"material-icons",content:"keyboard_arrow_left"}},B=function(){return{class:"material-icons",content:"keyboard_arrow_right"}},X=function(t){return{class:"material-icons",content:t}};function K(t,e){if(1&t){const t=u.Xb();u.Wb(0,"div",1),u.Wb(1,"div",2),u.Wb(2,"div",3),u.Wb(3,"button",4),u.ec("tapped",(function(){return u.wc(t),u.ic().changeDate(-1)})),u.Rb(4,"app-icon",5),u.Vb(),u.Wb(5,"div",6),u.Gc(6),u.Vb(),u.Wb(7,"button",7),u.ec("tapped",(function(){return u.wc(t),u.ic().changeDate(1)})),u.Rb(8,"app-icon",5),u.Vb(),u.Vb(),u.Wb(9,"div",8),u.Wb(10,"div",9),u.ec("tapped",(function(){u.wc(t);const e=u.ic();return e.show_locations=!e.show_locations})),u.Rb(11,"img",10),u.Wb(12,"div",6),u.Gc(13,"Select locations(s)"),u.Vb(),u.Rb(14,"app-icon",5),u.Vb(),u.Wb(15,"div",11),u.Ec(16,H,9,3,"div",12),u.Vb(),u.Vb(),u.Vb(),u.Ec(17,Y,3,1,"div",13),u.Vb()}if(2&t){const t=u.ic();u.Cb(3),u.oc("disabled",t.is_today),u.Cb(1),u.oc("icon",u.pc(8,L)),u.Cb(2),u.Hc(t.date_display),u.Cb(2),u.oc("icon",u.pc(9,B)),u.Cb(6),u.oc("icon",u.qc(10,X,"keyboard_arrow_"+(t.show_locations?"up":"down"))),u.Cb(1),u.oc("@show",t.show_locations?"show":"hide"),u.Cb(1),u.oc("ngForOf",t.building_list),u.Cb(1),u.oc("ngIf",t.location_list&&t.location_list.length)}}let Z=(()=>{class t extends s.a{constructor(t){super(),this._service=t,this.locations=[],this.locationsChange=new u.n}get is_today(){const t=w(this.date.value);return w().isSame(t,"d")}get date_display(){const t=w(this.date.value);return this.is_today?"Today":t.format("DD MMM YYYY")}get location_list(){return(this.locations||[]).map(t=>this.building_list.find(e=>e.id===t))}changeDate(t=1){let e=w(this.date.value).add(t,"d");const n=w().startOf("m");e.isBefore(n,"s")&&(e=n),this.date.setValue(e.valueOf())}ngOnInit(){this.building_list=this._service.Organisation.buildings,this.building_list&&this.building_list.length||this.timeout("init",()=>this.ngOnInit(),300)}addLocationFilter(t){this.locations||(this.locations=[]),this.locations.push(t.id),this.locations=Object(q.k)(this.locations),this.locationsChange.emit(this.locations)}removeLocationFilter(t){this.locations&&(this.locations.splice(this.locations.findIndex(e=>t.id===e),1),this.locationsChange.emit(this.locations))}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(c.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["booking-space-filters"]],inputs:{date:"date",locations:"locations"},outputs:{locationsChange:"locationsChange"},features:[u.zb],decls:1,vars:1,consts:[["class","space-filters",4,"ngIf"],[1,"space-filters"],[1,"actions"],[1,"date"],["mat-icon-button","",3,"disabled","tapped"],[3,"icon"],[1,"text"],["mat-icon-button","",3,"tapped"],[1,"location-list"],[1,"inner",3,"tapped"],["src","assets/img/location-img.svg"],[1,"list"],["class","item",4,"ngFor","ngForOf"],["class","filters",4,"ngIf"],[1,"item"],[3,"change"],[1,"building-name"],[1,"code"],[1,"name"],[1,"address"],[1,"filters"],["aria-label","Location Filters"],["color","primary",3,"id","removable","removed",4,"ngFor","ngForOf"],["color","primary",3,"id","removable","removed"],["matChipRemove","",3,"icon"]],template:function(t,e){1&t&&u.Ec(0,K,18,12,"div",0),2&t&&u.oc("ngIf",e.date)},directives:[i.t,O.b,M.c,x.a,i.s,N.a,R.d,R.a,R.e],styles:[".space-filters[_ngcontent-%COMP%]{width:100%}.actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;padding:1em}@media only screen and (orientation:portrait) and (max-width:450px){.actions[_ngcontent-%COMP%]{padding:.5em}}@media only screen and (orientation:landscape) and (max-width:800px){.actions[_ngcontent-%COMP%]{padding:.5em}}.actions[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:0 .5em}.date[_ngcontent-%COMP%]{display:flex;align-items:center;border:1px solid #1937ea;height:2.5em;overflow:hidden}@media only screen and (orientation:portrait) and (max-width:450px){.date[_ngcontent-%COMP%]{margin-bottom:.5em!important}}@media only screen and (orientation:landscape) and (max-width:800px){.date[_ngcontent-%COMP%]{margin-bottom:.5em!important}}.date[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0;color:#1937ea;background-color:rgba(25,55,234,.1);height:2.5em;width:2.5em;margin:0}.date[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{background-color:#f0f0f0;color:rgba(0,0,0,.35)}.date[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;border-left:1px solid #1937ea;border-right:1px solid #1937ea;width:8em;height:100%}.location-list[_ngcontent-%COMP%]{position:relative;border:1px solid #ccc;width:24em}.location-list[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]{position:relative;overflow:hidden;display:flex;align-items:center;height:2.5em}.location-list[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.5em}.location-list[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:-10px;left:-10px}.location-list[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1;min-width:50%;margin-left:3em;padding:0 1em}.location-list[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{position:absolute;bottom:0;transform:translateY(100%);background-color:#41485b;color:#fff;width:24em;max-height:25em;overflow:hidden auto;z-index:999;max-width:100%}.location-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{margin:.5em;width:24em}.filters[_ngcontent-%COMP%]{padding:0 1em 1em;margin:0 auto;max-width:720px;width:100%}@media only screen and (orientation:portrait) and (max-width:450px){.filters[_ngcontent-%COMP%]{padding-bottom:.5em}}@media only screen and (orientation:landscape) and (max-width:800px){.filters[_ngcontent-%COMP%]{padding-bottom:.5em}}.building-name[_ngcontent-%COMP%]{display:flex;align-items:center}.building-name[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{width:4em}.building-name[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:8em}.building-name[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{flex:1;min-width:6em;max-width:50vw;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:.2em!important}.mat-menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:0 1em}.mat-menu-item[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.2em}.mat-menu-item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1;min-width:50%;margin-left:.5em;padding-right:2em}.mat-chip.mat-standard-chip[_ngcontent-%COMP%]   .mat-chip-remove[_ngcontent-%COMP%]{color:hsla(0,0%,100%,.85)}"],data:{animation:[$.a]}}),t})();var J=n("vxfF"),tt=(n("KsZa"),n("ceWj")),et=n("daPb");function nt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"div",6),u.Wb(1,"div",7),u.Gc(2),u.Vb(),u.Wb(3,"div",8),u.Wb(4,"button",9),u.ec("tapped",(function(){u.wc(t);const n=e.$implicit;return u.ic().selectSpace(n)})),u.Wb(5,"div",10),u.Gc(6),u.Vb(),u.Vb(),u.Vb(),u.Vb()}if(2&t){const t=e.$implicit,n=u.ic();u.Cb(2),u.Hc(t.date_string),u.Cb(2),u.Gb("inverse",!t.available&&!t.replaced_by),u.Cb(2),u.Ic(" ",t.replaced_by||(t.available?n.space.name:"Find Room")," ")}}const it=function(){return{type:"icon",class:"material-icons",content:"close"}};let ot=(()=>{class t extends s.a{constructor(t,e,n){super(),this._data=t,this._dialog=e,this._service=n,this.event=new u.n,this.occurrences=[],this.space_details=[]}get space(){return this._data.space}get occurrences_valid(){return this.occurrences.reduce((t,e)=>t&&(e.available||!!e.replaced_by),!0)}ngOnInit(){this.space_details=[].concat(this._data.conflicts||[]),this.updateOccurrences()}save(){this.event.emit({reason:"done",metadata:this.space_details})}selectSpace(t){const e=this._dialog.open(et.a,{width:"auto",height:"auto",maxWidth:"95vw",data:{spaces:[],zone_ids:this.space.level.building_id,date:1e3*t.date,duration:this._data.duration,host:this._data.host,multiple:!1}});this.subscription("new_spaces",e.componentInstance.event.subscribe(n=>{if("done"===n.reason){const i=n.metadata[0];i&&(console.log("Space:",i),this.space_details.unshift({date:t.date,space:i.email,replaces:this.space.email}),this.space_details=Object(q.k)(this.space_details,"date")),this.updateOccurrences(),e.close(),this.unsub("new_spaces")}}))}updateOccurrences(){this.occurrences=this._data.space.recurr_available.map(t=>{const e=this.space_details.find(e=>e.date===t.date&&e.replaces===this.space.email),n=(e||{}).space,i=this._service.Spaces.item(n)||{email:n,name:n};return console.log("Space:",e,i),Object.assign(Object.assign({},t),{date_string:w(1e3*t.date).format("dddd, DD MMMM YYYY"),replaced_by:i.name})}),console.log("Occurrences:",this.occurrences)}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(_.a),u.Qb(_.b),u.Qb(c.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["a-recurrence-spaces-modal"]],outputs:{event:"event"},features:[u.zb],decls:14,vars:5,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"info"],["class","item",4,"ngFor","ngForOf"],["mat-button","",3,"disabled","tapped"],[1,"item"],[1,"date"],[1,"action"],["mat-button","",3,"tapped"],[1,"content"]],template:function(t,e){1&t&&(u.Wb(0,"header"),u.Wb(1,"div",0),u.Gc(2),u.Vb(),u.Wb(3,"button",1),u.Rb(4,"app-icon",2),u.Vb(),u.Vb(),u.Wb(5,"mat-dialog-content"),u.Wb(6,"main"),u.Wb(7,"div",3),u.Gc(8," * Select individual dates to update selected space "),u.Vb(),u.Ec(9,nt,7,4,"div",4),u.Vb(),u.Vb(),u.Wb(10,"mat-dialog-actions"),u.Wb(11,"footer"),u.Wb(12,"button",5),u.ec("tapped",(function(){return e.save()})),u.Gc(13,"Add to Booking"),u.Vb(),u.Vb(),u.Vb()),2&t&&(u.Cb(2),u.Ic("Recurrence - ",e.space.name,""),u.Cb(2),u.oc("icon",u.pc(4,it)),u.Cb(5),u.oc("ngForOf",e.occurrences),u.Cb(3),u.oc("disabled",!e.occurrences_valid))},directives:[O.b,_.d,x.a,_.f,i.s,_.c,M.c],styles:[".heading[_ngcontent-%COMP%]{flex:1}.item[_ngcontent-%COMP%], main[_ngcontent-%COMP%]{padding:.5em}.item[_ngcontent-%COMP%]{display:flex;align-items:center}.item[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{flex:1;margin-right:1em}.item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:13em}.item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{width:10.5em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.info[_ngcontent-%COMP%]{font-size:.8em;color:#1937ea;margin-bottom:1em;font-style:italic}.info[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{text-align:center}footer[_ngcontent-%COMP%]{width:100%}"]}),t})();function at(t,e){if(1&t&&u.Rb(0,"div",14),2&t){const t=u.ic(2);u.Dc("background-image","url("+t.space.image+")",u.Jb)}}function rt(t,e){if(1&t&&(u.Wb(0,"div",15),u.Gc(1," Available for\xa0"),u.Wb(2,"span"),u.Gc(3),u.Vb(),u.Gc(4,"\xa0meeting ocurrences "),u.Vb()),2&t){const t=u.ic(2);u.Cb(3),u.Hc(t.availability)}}const ct=function(){return{type:"icon",class:"material-icons",content:"account_circle"}};function st(t,e){if(1&t){const t=u.Xb();u.Wb(0,"div",1),u.Wb(1,"div",2),u.Ec(2,at,1,2,"div",3),u.Rb(3,"div",4),u.Wb(4,"div",5),u.Gc(5),u.Vb(),u.Wb(6,"div",6),u.Wb(7,"div",7),u.Gc(8),u.Vb(),u.Wb(9,"div",8),u.Rb(10,"app-icon",9),u.Gc(11),u.Vb(),u.Vb(),u.Ec(12,rt,5,1,"div",10),u.Vb(),u.Wb(13,"div",11),u.Wb(14,"button",12),u.ec("tapped",(function(){return u.wc(t),u.ic().selectSpace()})),u.Gc(15),u.Vb(),u.Wb(16,"button",13),u.ec("tapped",(function(){return u.wc(t),u.ic().locate()})),u.Gc(17,"Map"),u.Vb(),u.Vb(),u.Vb()}if(2&t){const t=u.ic();u.Gb("with-image",t.show_image),u.Cb(2),u.oc("ngIf",t.space.image),u.Cb(3),u.Hc(t.space.name),u.Cb(3),u.Hc(t.location),u.Cb(2),u.oc("icon",u.pc(13,ct)),u.Cb(1),u.Ic(" ",t.space.capacity||"0"," "),u.Cb(1),u.oc("ngIf",t.space.recurr_available&&t.space.recurr_available.length),u.Cb(2),u.Gb("inverse",t.multi&&!t.selected)("request",t.is_request),u.Cb(1),u.Ic(" ",t.multi?t.selected?"Remove":"Select":t.is_request?"Request":"Book"," ")}}let ut=(()=>{class t extends s.a{constructor(t,e){super(),this._service=t,this._dialog=e,this.select=new u.n}get show_image(){return this._service.setting("app.space_display.show_images")}get selected(){return!(!this.form&&this.space)&&this.form.controls.space_list&&!!(this.form.controls.space_list.value||[]).find(t=>t.id===this.space.id)}get is_request(){return!!this.form&&this.space.byRequest({date:this.form.controls.date.value,duration:this.form.controls.duration.value,host:this.form.controls.organiser.value||this._service.Users.current})}get availability(){const t=this.space.recurr_available.reduce((t,e)=>t+(e.available?1:0),0);return t>=this.space.recurr_available.length?"all":`${t} of ${this.space.recurr_available.length}`}get location(){if(!this.space)return"Unable to determine location";const t=this.space.level,e=this._service.Organisation.buildings.find(e=>e.id===t.building_id);return`${e?e.name+", ":""}${t.name}`}locate(){this._dialog.open(tt.a,{width:"auto",height:"auto",maxWidth:"95vw",maxHeight:"95vh",data:{space:this.space}})}selectSpace(){if(!this.space.recurr_available||"all"===this.availability||this.selected)this.select.emit();else{const t=this._dialog.open(ot,{width:"auto",height:"auto",maxWidth:"95vw",maxHeight:"95vh",data:{space:this.space,duration:this.form.controls.duration.value,host:this.form.controls.organiser.value,conflicts:this.form.controls.recurrence.value.conflicts||[]}});this.subscription("recurr_conflicts",t.componentInstance.event.subscribe(e=>{if("done"===e.reason){const n=this.form.controls.recurrence.value,i=n.conflicts||[];for(const t of e.metadata){const e=i.findIndex(e=>e.date===t.date&&e.replaces===t.replaces);e>=0?i.splice(e,1,t):i.push(t)}this.form.controls.recurrence.setValue(Object.assign(Object.assign({},n),{conflicts:i})),this.select.emit(),t.close()}}))}}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(c.a),u.Qb(_.b))},t.\u0275cmp=u.Kb({type:t,selectors:[["a-booking-space-item"]],inputs:{space:"space",form:"form",multi:"multi"},outputs:{select:"select"},features:[u.zb],decls:1,vars:1,consts:[["class","space-details",3,"with-image",4,"ngIf"],[1,"space-details"],[1,"details"],["class","image",3,"background-image",4,"ngIf"],[1,"overlay"],[1,"name"],[1,"info"],[1,"location"],[1,"capacity"],[3,"icon"],["class","info recurr",4,"ngIf"],[1,"actions"],["mat-button","",3,"tapped"],["mat-button","",1,"inverse",3,"tapped"],[1,"image"],[1,"info","recurr"]],template:function(t,e){1&t&&u.Ec(0,st,18,14,"div",0),2&t&&u.oc("ngIf",e.space)},directives:[i.t,x.a,O.b,M.c],styles:[".space-details[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;width:720px;max-width:calc(100vw - 1em);background-color:#fff;flex-wrap:wrap;border-radius:0;overflow:hidden;transition:box-shadow .2s,top .2s;top:0;margin:.5em auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.space-details[_ngcontent-%COMP%]:hover{box-shadow:0 1px 3px 2px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);top:-2px}.space-details[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:none}.with-image[_ngcontent-%COMP%]{padding-top:0;width:480px}.with-image[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:initial;background-color:rgba(0,0,0,.65);color:#fff;transition:opacity .2s}.with-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.with-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{overflow:hidden;background-position:50%;background-size:cover}.with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{-webkit-filter:drop-shadow(0 0 2px #000);filter:drop-shadow(0 0 2px black);color:#fff}.with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{opacity:0}.with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{position:relative;height:6em;width:24em;margin:0 auto 0 0;max-width:24em;overflow:hidden;height:12em}.with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{transition:-webkit-filter .2s;transition:filter .2s;transition:filter .2s,-webkit-filter .2s}.with-image[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;bottom:2em;color:#fff}.with-image[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{position:absolute;bottom:1em;color:hsla(0,0%,100%,.65);width:calc(100% - 2em)}.details[_ngcontent-%COMP%]{flex:1;min-width:50%;padding:1em;min-width:99%}.info[_ngcontent-%COMP%]{display:flex;align-items:center;color:rgba(0,0,0,.65)}.name[_ngcontent-%COMP%]{font-size:1.2em}.location[_ngcontent-%COMP%]{font-size:.8em;flex:1;min-width:50%}.capacity[_ngcontent-%COMP%]{display:flex;align-items:center}.recurr[_ngcontent-%COMP%]{color:#1937ea;font-size:.8em}.recurr[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-decoration:underline}.actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;flex:1}button[_ngcontent-%COMP%]{min-width:12em;flex:1;margin:0;border-radius:0}button.request[_ngcontent-%COMP%]{color:#fff;background-color:#ffb300;border-color:#ffb300}button.request.inverse[_ngcontent-%COMP%]{color:#ffb300;background-color:#fff}"]}),t})();var lt=n("Xa2L");function dt(t,e){if(1&t){const t=u.Xb();u.Ub(0),u.Wb(1,"a-booking-space-item",14),u.ec("select",(function(){u.wc(t);const n=e.$implicit;return u.ic(3).selectSpace(n)})),u.Vb(),u.Tb()}if(2&t){const t=e.$implicit,n=u.ic(3);u.Cb(1),u.oc("form",n.form)("space",t)("multi",n.multiple)}}function mt(t,e){if(1&t&&(u.Wb(0,"cdk-virtual-scroll-viewport",12),u.Ec(1,dt,2,3,"ng-container",13),u.Vb()),2&t){const t=u.ic(2);u.oc("itemSize",t.item_size),u.Cb(1),u.oc("cdkVirtualForOf",t.space_list)}}function ht(t,e){if(1&t&&(u.Ub(0),u.Ec(1,mt,2,2,"cdk-virtual-scroll-viewport",11),u.Tb()),2&t){const t=u.ic(),e=u.tc(13);u.Cb(1),u.oc("ngIf",t.space_list&&t.space_list.length)("ngIfElse",e)}}function ft(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",15),u.ec("tapped",(function(){return u.wc(t),u.ic().next()})),u.Gc(1," Next "),u.Vb()}if(2&t){const t=u.ic();u.oc("disabled",!t.spaces.value||!t.spaces.value.length)}}function bt(t,e){1&t&&(u.Wb(0,"div",16),u.Wb(1,"div",17),u.Wb(2,"div",18),u.Rb(3,"mat-spinner",19),u.Vb(),u.Wb(4,"div",20),u.Gc(5,"Check space availability..."),u.Vb(),u.Vb(),u.Vb())}const gt=function(){return{class:"material-icons",content:"close"}};function pt(t,e){1&t&&(u.Wb(0,"div",16),u.Wb(1,"div",17),u.Wb(2,"div",18),u.Rb(3,"app-icon",21),u.Vb(),u.Wb(4,"div",20),u.Gc(5,"No spaces available for the selected time"),u.Vb(),u.Vb(),u.Vb()),2&t&&(u.Cb(3),u.oc("icon",u.pc(1,gt)))}let vt=(()=>{class t extends s.a{constructor(t){super(),this._service=t,this.event=new u.n,this.space_list=[],this.change$=new A.a}get item_size(){return window,window,window,130}get multiple(){return this._service.setting("app.booking.multiple_spaces")}ngOnInit(){if(!this._service.is_initialised&&this._service.Spaces.list().length)return this.timeout("init",()=>this.ngOnInit());this.search_results$=this.change$.pipe(Object(j.a)(400),Object(D.a)(),Object(G.a)(t=>{this.loading=!0;const e=this.form.controls.recurrence?this.form.controls.recurrence.value:null,n=e&&e.period&&"None"!==e.period?{recurr_period:(e.period||"").toLowerCase(),recurr_end:w(e.end).unix()}:{},i=Object.assign({date:this.form.controls.date.value,duration:this.form.controls.duration.value,zone_ids:this._service.Organisation.building.id,bookable:!0},n);return this.zone_ids&&this.zone_ids.length&&(i.zone_ids=this.zone_ids.join(",")),this._service.Spaces.available(i)}),Object(S.a)(t=>(console.error(t),Object(T.a)([]))),Object(F.a)(t=>(this.loading=!1,t))),this.subscription("search_results",this.search_results$.subscribe(t=>this.space_list=t)),this.change$.next("")}ngOnChanges(t){t.form&&(this.form.controls.date&&this.subscription("date_field",this.form.controls.date.valueChanges.subscribe(t=>this.change$.next(t))),this.form.controls.duration&&this.subscription("duration_field",this.form.controls.duration.valueChanges.subscribe(t=>this.change$.next(t))))}selectSpace(t){if(this.multiple){const e=this.spaces.value||[],n=e.find(e=>e.id===t.id);this.spaces.setValue(n?e.filter(e=>e.id!==t.id):e.concat([t]))}else this.spaces.setValue([t]),this.event.emit({type:"next",step:"search"})}next(){this.event.emit({type:"next",step:"search"})}previous(){this.event.emit({type:"previous",step:"search"})}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(c.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["booking-find-space"]],inputs:{spaces:"spaces",form:"form"},outputs:{event:"event"},features:[u.zb,u.Ab],decls:14,vars:5,consts:[[1,"find-space"],[1,"background"],[1,"header"],[3,"date","locations","locationsChange"],[4,"ngIf","ngIfElse"],[1,"footer"],[1,"box"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"disabled","tapped",4,"ngIf"],["load_state",""],["empty_state",""],[3,"itemSize",4,"ngIf","ngIfElse"],[3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf"],[3,"form","space","multi","select"],["mat-button","",3,"disabled","tapped"],[1,"body"],[1,"info-block","center"],[1,"icon"],["diameter","48"],[1,"text"],[3,"icon"]],template:function(t,e){if(1&t&&(u.Wb(0,"div",0),u.Rb(1,"div",1),u.Wb(2,"div",2),u.Wb(3,"booking-space-filters",3),u.ec("locationsChange",(function(t){return e.zone_ids=t}))("locationsChange",(function(t){return e.change$.next(t)})),u.Vb(),u.Vb(),u.Ec(4,ht,2,2,"ng-container",4),u.Wb(5,"div",5),u.Wb(6,"div",6),u.Wb(7,"button",7),u.ec("tapped",(function(){return e.previous()})),u.Gc(8,"Back"),u.Vb(),u.Ec(9,ft,2,1,"button",8),u.Vb(),u.Vb(),u.Vb(),u.Ec(10,bt,6,0,"ng-template",null,9,u.Fc),u.Ec(12,pt,6,2,"ng-template",null,10,u.Fc)),2&t){const t=u.tc(11);u.Cb(3),u.oc("date",e.form.controls.date)("locations",e.zone_ids),u.Cb(1),u.oc("ngIf",!e.loading)("ngIfElse",t),u.Cb(5),u.oc("ngIf",e.multiple)}},directives:[Z,i.t,O.b,M.c,J.d,J.a,J.c,ut,lt.c,x.a],styles:[".find-space[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;flex-direction:column;height:100%;width:100%;max-height:calc(100vh - 7.5em);overflow:hidden}@media only screen and (orientation:portrait) and (max-width:450px){.find-space[_ngcontent-%COMP%]{max-height:calc(100vh - 6.5em)}}@media only screen and (orientation:landscape) and (max-width:800px){.find-space[_ngcontent-%COMP%]{max-height:calc(100vh - 6.5em)}}.header[_ngcontent-%COMP%]{position:relative;z-index:999;width:100%;max-width:100vw;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}@media only screen and (orientation:portrait) and (max-width:450px){.header[_ngcontent-%COMP%]{border-radius:0}}@media only screen and (orientation:landscape) and (max-width:800px){.header[_ngcontent-%COMP%]{border-radius:0}}.body[_ngcontent-%COMP%], cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{position:relative;width:100%;flex:1;min-height:50%}.box[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;max-width:100vw;background-color:#fff;padding:.5em;margin:auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);border-top:1px solid #ccc}.box[_ngcontent-%COMP%], .footer[_ngcontent-%COMP%]{width:100%}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:0 .5em}.background[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:50%;transform:translateX(-50%);width:768px;max-width:100vw}.info-block[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:2.5em;width:2.5em}"]}),t})();const _t=function(){return{class:"material-icons",content:"edit"}},yt=function(){return{class:"material-icons",content:"delete"}};let wt=(()=>{class t{constructor(t){this._service=t,this.edit=new u.n,this.delete=new u.n}get space(){if(!this.order)return"<No Location>";const t=this._service.Spaces.item(this.order.location_id);return(t?t.name:"")||"<No Location>"}get delivery_time(){return this.order?w(this.order.booking_date).add((this.order.changes||{}).delivery_time||this.order.delivery_time,"m").format("h:mm A"):"<Meeting Start>"}get order_cost(){return((this.order?this.order.items:null)||[]).reduce((t,e)=>t+e.amount*e.unit_price,0)}get item_count(){return((this.order?this.order.items:null)||[]).reduce((t,e)=>t+e.amount,0)}get symbol(){const t=this._service.Spaces.item(this.order.location_id);if(!t||!t.level)return"USD";const e=this._service.Organisation.buildings.find(e=>e.id===t.level.building_id);return e?e.currency:"USD"}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(c.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["catering-order-list-item"]],inputs:{order:"order",date:"date"},outputs:{edit:"edit",delete:"delete"},decls:18,vars:12,consts:[[1,"details"],[1,"group"],[1,"cost"],[1,"actions"],["mat-icon-button","",3,"tapped"],[3,"icon"],["mat-icon-button","",1,"inverse",3,"tapped"]],template:function(t,e){1&t&&(u.Wb(0,"div",0),u.Gc(1," Deliver to "),u.Wb(2,"span"),u.Gc(3),u.Vb(),u.Gc(4," at "),u.Wb(5,"span"),u.Gc(6),u.Vb(),u.Vb(),u.Wb(7,"div",1),u.Wb(8,"div",2),u.Gc(9),u.Vb(),u.Wb(10,"div",2),u.Gc(11),u.jc(12,"currency"),u.Vb(),u.Vb(),u.Wb(13,"div",3),u.Wb(14,"button",4),u.ec("tapped",(function(){return e.edit.emit()})),u.Rb(15,"app-icon",5),u.Vb(),u.Wb(16,"button",6),u.ec("tapped",(function(){return e.delete.emit()})),u.Rb(17,"app-icon",5),u.Vb(),u.Vb()),2&t&&(u.Cb(3),u.Hc(e.space),u.Cb(3),u.Hc(e.delivery_time),u.Cb(3),u.Jc("",e.item_count," item",1===e.item_count?"":"s",""),u.Cb(2),u.Hc(u.lc(12,7,e.order_cost/100,e.symbol)),u.Cb(4),u.oc("icon",u.pc(10,_t)),u.Cb(2),u.oc("icon",u.pc(11,yt)))},directives:[O.b,M.c,x.a],pipes:[i.d],styles:["[_nghost-%COMP%]{display:flex;align-items:center;padding:.25em;margin:.25em;border-radius:4px}.details[_ngcontent-%COMP%]{flex:1;padding:.5em}.details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:400}.cost[_ngcontent-%COMP%]{padding:.25em .5em;border-radius:4px;font-size:.8rem;margin:.25em .4rem .25em 0;white-space:nowrap;text-align:center}.cost[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{color:#fff;background-color:#1937ea}button[_ngcontent-%COMP%]{margin:.25em}button.inverse[_ngcontent-%COMP%]{background-color:#fff;color:#e53935;border:1px solid #e53935}"]}),t})();function Ct(t,e){if(1&t){const t=u.Xb();u.Wb(0,"catering-order-list-item",10),u.ec("edit",(function(){u.wc(t);const n=e.$implicit;return u.ic(2).editOrder(n)}))("delete",(function(){u.wc(t);const n=e.$implicit;return u.ic(2).deleteOrder(n)})),u.Vb()}if(2&t){const t=e.$implicit,n=u.ic(2);u.oc("order",t)("date",n.date)}}function Ot(t,e){if(1&t){const t=u.Xb();u.Ub(0),u.Wb(1,"div",8),u.Ec(2,Ct,1,2,"catering-order-list-item",9),u.Vb(),u.Wb(3,"button",6),u.ec("tapped",(function(){return u.wc(t),u.ic().newOrder()})),u.Gc(4,"Add Order"),u.Vb(),u.Tb()}if(2&t){const t=u.ic();u.Cb(2),u.oc("ngForOf",t.orders)}}const xt=function(){return{class:"material-icons",content:"close"}};function Mt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"div",11),u.Wb(1,"div",12),u.Rb(2,"app-icon",13),u.Vb(),u.Wb(3,"div",14),u.Gc(4,"No catering orders"),u.Vb(),u.Wb(5,"button",6),u.ec("tapped",(function(){return u.wc(t),u.ic().newOrder()})),u.Gc(6,"Add Order"),u.Vb(),u.Vb()}2&t&&(u.Cb(2),u.oc("icon",u.pc(1,xt)))}let kt=(()=>{class t{constructor(){this.event=new u.n,this.order=new u.n}get orders(){if(!this.catering)return[];const t=this.catering.value||[];return t.forEach(t=>t.booking_date=this.all_day?w(this.date).startOf("d").valueOf():this.date),t}newOrder(){this.order.emit()}editOrder(t){this.order.emit(t)}deleteOrder(t){const e=this.orders,n=e.findIndex(e=>t.id===e.id);n>=0&&(e.splice(n,1),this.catering.setValue(e))}next(){this.event.emit({type:"next",step:"catering"})}previous(){this.event.emit({type:"previous",step:"catering"})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=u.Kb({type:t,selectors:[["a-catering-order-list"]],inputs:{catering:"catering",date:"date",all_day:"all_day"},outputs:{event:"event",order:"order"},decls:13,vars:2,consts:[[1,"catering","order-list"],[1,"header"],[1,"body"],[4,"ngIf","ngIfElse"],[1,"footer"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"tapped"],["empty_state",""],[1,"list"],[3,"order","date","edit","delete",4,"ngFor","ngForOf"],[3,"order","date","edit","delete"],[1,"info-block","center"],[1,"icon"],[3,"icon"],[1,"text"]],template:function(t,e){if(1&t&&(u.Wb(0,"div",0),u.Wb(1,"div",1),u.Wb(2,"h3"),u.Gc(3,"Catering Orders"),u.Vb(),u.Vb(),u.Wb(4,"div",2),u.Ec(5,Ot,5,1,"ng-container",3),u.Vb(),u.Wb(6,"div",4),u.Wb(7,"button",5),u.ec("tapped",(function(){return e.previous()})),u.Gc(8,"Back"),u.Vb(),u.Wb(9,"button",6),u.ec("tapped",(function(){return e.next()})),u.Gc(10,"Next"),u.Vb(),u.Vb(),u.Vb(),u.Ec(11,Mt,7,2,"ng-template",null,7,u.Fc)),2&t){const t=u.tc(12);u.Cb(5),u.oc("ngIf",e.orders&&e.orders.length)("ngIfElse",t)}},directives:[i.t,O.b,M.c,i.s,wt,x.a],styles:["[_nghost-%COMP%]{height:100%}.order-list[_ngcontent-%COMP%]{flex-direction:column;height:100%;width:768px;margin:auto;max-width:100vw;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.body[_ngcontent-%COMP%], .order-list[_ngcontent-%COMP%]{display:flex;align-items:center}.body[_ngcontent-%COMP%]{position:relative;flex-direction:column;flex:1;width:100%;min-height:50%;overflow:auto}.body[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:8em}.list[_ngcontent-%COMP%]{width:100%}.list[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{border:1px solid #ccc}.list[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.05)}.footer[_ngcontent-%COMP%]{width:100%;text-align:center;border-top:1px solid #ccc}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:.5em}.info-block[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:1em}"]}),t})();var Pt=n("IRj4"),Vt=n("aXH1"),Wt=n("QibW");function It(t,e){1&t&&u.Sb(0)}function zt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"mat-checkbox",11),u.ec("change",(function(e){u.wc(t);const n=u.ic(2).$implicit,i=u.ic(2).package;return u.ic().updateAmount(i,n,e.checked)})),u.Gc(1),u.Vb()}if(2&t){const t=u.ic(2).$implicit;u.oc("checked",!!t.amount),u.Cb(1),u.Ic(" ",t.name," ")}}function Et(t,e){if(1&t){const t=u.Xb();u.Wb(0,"mat-radio-button",12),u.ec("change",(function(e){u.wc(t);const n=u.ic(2).$implicit,i=u.ic(2).package;return u.ic().updateAmount(i,n,e.value===n.id)})),u.Gc(1),u.Vb()}if(2&t){const t=u.ic(2).$implicit;u.oc("value",t.id),u.Cb(1),u.Ic(" ",t.name," ")}}function jt(t,e){if(1&t&&(u.Ub(0),u.Ec(1,zt,2,2,"mat-checkbox",9),u.Ec(2,Et,2,2,"mat-radio-button",10),u.Tb()),2&t){const t=u.ic(3).package;u.Cb(1),u.oc("ngIf",t.must_select>1),u.Cb(1),u.oc("ngIf",1===t.must_select)}}function Dt(t,e){if(1&t&&(u.Ub(0),u.Gc(1),u.Tb()),2&t){const t=u.ic().$implicit;u.Cb(1),u.Ic(" ",t.name," ")}}function Gt(t,e){1&t&&u.Sb(0)}const St=function(t){return{package:t}};function Ft(t,e){if(1&t&&(u.Wb(0,"div",8),u.Ec(1,jt,3,2,"ng-container",5),u.Ec(2,Dt,2,1,"ng-container",5),u.Ec(3,Gt,1,0,"ng-container",2),u.Vb()),2&t){const t=e.$implicit,n=u.ic(2).package;u.ic();const i=u.tc(13);u.Db("to-select",t.must_select),u.Cb(1),u.oc("ngIf",n.must_select&&n.must_select<n.items.length&&!t.must_select),u.Cb(1),u.oc("ngIf",n.must_select>=n.items.length||t.must_select),u.Cb(1),u.oc("ngTemplateOutlet",i)("ngTemplateOutletContext",u.qc(5,St,t))}}function At(t,e){if(1&t&&(u.Ub(0),u.Wb(1,"mat-radio-group",6),u.Ec(2,Ft,4,7,"div",7),u.Vb(),u.Tb()),2&t){const t=u.ic().package,e=u.ic();u.Cb(1),u.oc("ngModel",e.active_items[t.id]),u.Cb(1),u.oc("ngForOf",t.items)}}function Tt(t,e){if(1&t&&u.Ec(0,At,3,2,"ng-container",5),2&t){const t=e.package;u.oc("ngIf",t.items&&t.items.length)}}const qt=function(){return{class:"material-icons",content:"close"}};let $t=(()=>{class t{constructor(t){this._data=t,this.event=new u.n}get requirements_met(){return function t(e){const n=e.items||[];return e.must_select>=n.length?n.reduce((e,n)=>e&&t(n),!0):n.reduce((t,e)=>t+e.amount?1:0,0)===e.must_select}(this.item)}get active_items(){return function t(e){let n={};if(e.items){const i=e.items.find(t=>t.amount>0);i&&(n[e.id]=i.id),e.items.forEach(e=>n=Object.assign(Object.assign({},n),t(e)))}return n}(this.item)}ngOnInit(){this.item=this._data.item}updateAmount(t,e,n){if(n){const n=t.must_select;t.items.filter(t=>t.amount>0).length>=n&&t.items.find(t=>t.amount>0).setAmount(0),e.setAmount(1)}else e.setAmount(0)}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(_.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["a-package-options-modal"]],outputs:{event:"event"},decls:14,vars:7,consts:[["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["mat-button","",3,"disabled","tapped"],["item_display",""],[4,"ngIf"],[3,"ngModel"],["class","item",4,"ngFor","ngForOf"],[1,"item"],[3,"checked","change",4,"ngIf"],[3,"value","change",4,"ngIf"],[3,"checked","change"],[3,"value","change"]],template:function(t,e){if(1&t&&(u.Wb(0,"header"),u.Wb(1,"h3"),u.Gc(2,"Package Options"),u.Vb(),u.Wb(3,"button",0),u.Rb(4,"app-icon",1),u.Vb(),u.Vb(),u.Wb(5,"mat-dialog-content"),u.Wb(6,"main"),u.Ec(7,It,1,0,"ng-container",2),u.Vb(),u.Vb(),u.Wb(8,"mat-dialog-actions"),u.Wb(9,"footer"),u.Wb(10,"button",3),u.ec("tapped",(function(){return e.event.emit({reason:"done"})})),u.Gc(11," Confirm Options "),u.Vb(),u.Vb(),u.Vb(),u.Ec(12,Tt,1,1,"ng-template",null,4,u.Fc)),2&t){const t=u.tc(13);u.Cb(4),u.oc("icon",u.pc(4,qt)),u.Cb(3),u.oc("ngTemplateOutlet",t)("ngTemplateOutletContext",u.qc(5,St,e.item)),u.Cb(3),u.oc("disabled",!e.requirements_met)}},directives:[O.b,_.d,x.a,_.f,i.A,_.c,M.c,i.t,Wt.b,a.r,a.u,i.s,N.a,Wt.a],styles:["main[_ngcontent-%COMP%]{width:24em;min-height:24em;overflow:hidden auto}main[_ngcontent-%COMP%] > mat-radio-group[_ngcontent-%COMP%] > .item[_ngcontent-%COMP%]{background:none;border:none;border-bottom:1px solid #ccc}main[_ngcontent-%COMP%] > mat-radio-group[_ngcontent-%COMP%] > .item[_ngcontent-%COMP%]:last-child{border:none}.item[_ngcontent-%COMP%]{padding:.5em;border:1px solid #ccc;width:100%}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{border-bottom:none}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:first-child{border-radius:4px 4px 0 0;margin-top:.25em}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:last-child{margin-bottom:.25em;border-radius:0 0 4px 4px;border-bottom:1px solid #ccc}mat-dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #ccc}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),t})();var Nt=n("Qu3c"),Rt=n("019G");function Ht(t,e){if(1&t&&u.Rb(0,"div",15),2&t){const t=u.ic(2);u.Dc("background-image","url("+t.item.image_path+")",u.Jb)}}function Qt(t,e){if(1&t&&(u.Wb(0,"div",16),u.Gc(1),u.jc(2,"currency"),u.Vb()),2&t){const t=u.ic(2);u.Cb(1),u.Ic(" ",u.lc(2,1,t.item.unit_price/100,t.symbol)," ")}}function Ut(t,e){if(1&t&&(u.Wb(0,"div",17),u.Gc(1),u.Vb()),2&t){const t=u.ic(2);u.oc("matTooltip",t.contents),u.Cb(1),u.Jc(" Contains ",t.item.items.length," item",1===t.item.items.length?"":"s"," ")}}function Yt(t,e){if(1&t&&(u.Wb(0,"div",17),u.Wb(1,"span",18),u.Gc(2,"Selected "),u.Vb(),u.Gc(3),u.Wb(4,"span",18),u.Gc(5,"ion"),u.Vb(),u.Gc(6),u.Vb()),2&t){const t=u.ic(2);u.oc("matTooltip",t.contents),u.Cb(3),u.Ic("",t.item.must_select," opt"),u.Cb(3),u.Ic("",1===t.item.items.length?"":"s"," ")}}function Lt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",19),u.ec("tapped",(function(){return u.wc(t),u.ic(2).updatePackageOptions()})),u.Gc(1," Customise "),u.Vb()}}function Bt(t,e){if(1&t&&(u.Wb(0,"div",20),u.Gc(1),u.jc(2,"currency"),u.Vb()),2&t){const t=u.ic(2);u.Cb(1),u.Ic(" ",u.lc(2,1,t.item.unit_price/100,t.symbol)," ")}}function Xt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"a-counter",21),u.ec("ngModelChange",(function(e){return u.wc(t),u.ic(2).updateAmount(e)})),u.Vb()}if(2&t){const t=u.ic(2);u.oc("ngModel",t.item.amount)}}const Kt=function(t){return{class:"material-icons",content:t}};function Zt(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",22),u.ec("tapped",(function(){u.wc(t);const e=u.ic(2);return e.show_children=!e.show_children})),u.Rb(1,"app-icon",23),u.Vb()}if(2&t){const t=u.ic(2);u.Cb(1),u.oc("icon",u.qc(1,Kt,t.show_children?"keyboard_arrow_up":"keyboard_arrow_down"))}}function Jt(t,e){if(1&t&&(u.Wb(0,"div",3),u.Ec(1,Ht,1,2,"div",4),u.Wb(2,"div",5),u.Wb(3,"div",6),u.Gc(4),u.Vb(),u.Wb(5,"div",7),u.Gc(6),u.Vb(),u.Wb(7,"div",8),u.Ec(8,Qt,3,4,"div",9),u.Ec(9,Ut,2,3,"div",10),u.Ec(10,Yt,7,3,"div",10),u.Ec(11,Lt,2,0,"button",11),u.Vb(),u.Vb(),u.Ec(12,Bt,3,4,"div",12),u.Ec(13,Xt,1,1,"a-counter",13),u.Ec(14,Zt,2,3,"button",14),u.Vb()),2&t){const t=u.ic();u.Gb("subitem",t.subitem),u.Db("disabled",t.disabled&&!t.item.can_order_anytime),u.Cb(1),u.oc("ngIf",!t.subitem),u.Cb(3),u.Hc(t.item.name),u.Cb(2),u.Jc("",t.item.package?"[Package] ":"","",t.item.description,""),u.Cb(2),u.oc("ngIf",t.item.unit_price),u.Cb(1),u.oc("ngIf",t.item.package&&t.item.items.length&&!t.item.must_select),u.Cb(1),u.oc("ngIf",t.item.package&&t.item.must_select&&t.item.amount>0),u.Cb(1),u.oc("ngIf",t.item.package&&t.item.must_select&&t.item.amount>0),u.Cb(1),u.oc("ngIf",t.item.unit_price),u.Cb(1),u.oc("ngIf",!t.item.items||t.item.package),u.Cb(1),u.oc("ngIf",t.item.items&&t.item.items.length&&!t.item.package)}}function te(t,e){if(1&t&&u.Rb(0,"a-catering-order-item",24),2&t){const t=e.$implicit,n=u.ic();u.oc("subitem",!0)("symbol",n.symbol)("item",t)("field",n.field)}}let ee=(()=>{class t extends s.a{constructor(t,e){super(),this._service=t,this._dialog=e}get contents(){return this.item.items?this.item.items.reduce((t,e)=>(t&&(t+="\n\n"),t+`${e.name}${e.items?e.items.reduce((t,e)=>t+`\n ${e.amount?"\u2713":"\u2022"} ${e.name} `,""):""} ${e.amount?"\u2713":""}`),""):""}ngOnChanges(t){if(t.field&&this.field){const t=this.field.value.find(t=>t.id===this.item.id);this.item.setAmount(t?t.amount:0),this.subscription("field_change",this.field.valueChanges.subscribe(t=>{const e=t.find(t=>t.id===this.item.id);this.item.setAmount(e?e.amount:0)}))}}updateAmount(t){if(this.field){const e=this.field.value||[],n=e.find(t=>t.id===this.item.id);if(n)this.item.setAmount(t),n.setAmount(t);else{const n=this.item.amount;this.item.setAmount(t),this.item.package&&n<t?this.selectPackageOptions().then(t=>{e.push(new Vt.a(t)),this.field.setValue(e.filter(t=>t.amount))},()=>{this.item.setAmount(999),this.timeout("amount",()=>this.item.setAmount(0),5),this._service.notifyWarn("Package options not selected. Item removed from order")}):e.push(new Vt.a(this.item))}this.field.setValue(e.filter(t=>t.amount))}}updatePackageOptions(){this.selectPackageOptions().then(()=>null,()=>null)}selectPackageOptions(){return new Promise((t,e)=>{const n=this._dialog.open($t,{maxWidth:"95vw",data:{item:new Pt.a(this.item)}});let i=!1;n.componentInstance.event.subscribe(e=>{"done"===e.reason&&(i=!0,t(n.componentInstance.item),n.close())}),n.afterClosed().subscribe(()=>{i||e()})})}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(c.a),u.Qb(_.b))},t.\u0275cmp=u.Kb({type:t,selectors:[["a-catering-order-item"]],inputs:{subitem:"subitem",item:"item",field:"field",symbol:"symbol",disabled:"disabled"},features:[u.zb,u.Ab],decls:3,vars:3,consts:[["class","catering-item",3,"subitem",4,"ngIf"],[1,"children"],[3,"subitem","symbol","item","field",4,"ngFor","ngForOf"],[1,"catering-item"],["class","image",3,"background-image",4,"ngIf"],[1,"details"],[1,"name"],[1,"description"],[1,"options"],["class","option price mobile-only",4,"ngIf"],["class","option",3,"matTooltip",4,"ngIf"],["mat-button","",3,"tapped",4,"ngIf"],["class","option price not-mobile",4,"ngIf"],[3,"ngModel","ngModelChange",4,"ngIf"],["mat-icon-button","",3,"tapped",4,"ngIf"],[1,"image"],[1,"option","price","mobile-only"],[1,"option",3,"matTooltip"],[1,"not-mobile"],["mat-button","",3,"tapped"],[1,"option","price","not-mobile"],[3,"ngModel","ngModelChange"],["mat-icon-button","",3,"tapped"],[3,"icon"],[3,"subitem","symbol","item","field"]],template:function(t,e){1&t&&(u.Ec(0,Jt,15,14,"div",0),u.Wb(1,"div",1),u.Ec(2,te,1,4,"a-catering-order-item",2),u.Vb()),2&t&&(u.oc("ngIf",e.item),u.Cb(1),u.oc("@show",e.show_children?"show":"hide"),u.Cb(1),u.oc("ngForOf",e.item.items))},directives:[i.t,i.s,Nt.a,O.b,M.c,Rt.a,a.r,a.u,x.a,t],pipes:[i.d],styles:[".catering-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem}.catering-item[disabled=true][_ngcontent-%COMP%]{pointer-events:none;opacity:.35;background-color:rgba(0,0,0,.2)}.subitem[_ngcontent-%COMP%]{border-top:1px solid #ccc}.name[_ngcontent-%COMP%]{max-width:480px}.image[_ngcontent-%COMP%]{height:3em;width:3em;min-width:3em;border-radius:4px;background-color:rgba(0,0,0,.05);background-position:50%;background-size:cover;border:1px solid rgba(0,0,0,.05)}.details[_ngcontent-%COMP%]{flex:1;min-width:25%;padding:0 .5em;display:flex;flex-direction:column}.details[_ngcontent-%COMP%]   *[_ngcontent-%COMP%] > {white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.options[_ngcontent-%COMP%]{display:flex;align-items:center}.options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;font-size:.8em;height:1.5em;color:rgba(0,0,0,.85);line-height:1em;padding:0 .25em;text-decoration:underline}.option[_ngcontent-%COMP%]{padding:.25em .5em;border-radius:4px;color:#fff;font-size:.8rem;background-color:#1937ea;margin:.25em .4rem .25em 0;white-space:nowrap}.description[_ngcontent-%COMP%]{font-size:.75em;margin-top:.25em}.children[_ngcontent-%COMP%]{font-size:.9em;background-color:rgba(0,0,0,.05)}"],data:{animation:[$.a]}}),t})();function ne(t,e){if(1&t&&u.Rb(0,"a-catering-order-item",9),2&t){const t=e.$implicit,n=u.ic();u.oc("field",n.item_field)("subitem",!0)("item",t)("symbol",n.symbol)}}const ie=function(){return{class:"material-icons",content:"close"}};let oe=(()=>{class t extends s.a{constructor(t,e,n){super(),this._service=t,this._dialog_ref=e,this._data=n,this.event=new u.n,this.item_list=[]}get space(){return this._data.form&&this._data.form.controls.space?this._data.form.controls.space.value:{}}get delivery_time(){return w(this._data.date).format("h:mm A")}get item_field(){return this._data.form?this._data.form.controls.items:null}get order_cost(){return this.item_list.reduce((t,e)=>t+e.amount*e.unit_price,0)}get symbol(){if(!this.space||!this.space.level)return"USD";const t=this._service.Organisation.buildings.find(t=>t.id===this.space.level.building_id);return t?t.currency:"USD"}ngOnInit(){this._data.form.controls.items&&this.subscription("item_list",this._data.form.controls.items.valueChanges.subscribe(t=>{(!t||t.length<=0)&&this._dialog_ref.close()})),this.item_list=(this._data.form&&this._data.form.controls.items?this._data.form.controls.items.value:[]).map(t=>new Vt.a(t))}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(c.a),u.Qb(_.h),u.Qb(_.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["a-catering-confirm-modal"]],outputs:{event:"event"},features:[u.zb],decls:26,vars:9,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"details"],[1,"list"],[3,"field","subitem","item","symbol",4,"ngFor","ngForOf"],[1,"total"],[1,"value"],["mat-button","",3,"tapped"],[3,"field","subitem","item","symbol"]],template:function(t,e){1&t&&(u.Wb(0,"header"),u.Wb(1,"div",0),u.Gc(2,"Confirm Catering Order"),u.Vb(),u.Wb(3,"button",1),u.Rb(4,"app-icon",2),u.Vb(),u.Vb(),u.Wb(5,"mat-dialog-content"),u.Wb(6,"main"),u.Wb(7,"div",3),u.Gc(8," Delivering to "),u.Wb(9,"span"),u.Gc(10),u.Vb(),u.Gc(11," at "),u.Wb(12,"span"),u.Gc(13),u.Vb(),u.Vb(),u.Wb(14,"div",4),u.Ec(15,ne,1,4,"a-catering-order-item",5),u.Vb(),u.Wb(16,"div",6),u.Wb(17,"label"),u.Gc(18,"Order Total:"),u.Vb(),u.Wb(19,"div",7),u.Gc(20),u.jc(21,"currency"),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(22,"mat-dialog-actions"),u.Wb(23,"footer"),u.Wb(24,"button",8),u.ec("tapped",(function(){return e.event.emit({reason:"done"})})),u.Gc(25,"Save Order"),u.Vb(),u.Vb(),u.Vb()),2&t&&(u.Cb(4),u.oc("icon",u.pc(8,ie)),u.Cb(6),u.Hc(e.space.name||"<Unset>"),u.Cb(3),u.Hc(e.delivery_time),u.Cb(2),u.oc("ngForOf",e.item_list),u.Cb(5),u.Hc(u.lc(21,5,e.order_cost/100,e.symbol)))},directives:[O.b,_.d,x.a,_.f,i.s,_.c,M.c,ee],pipes:[i.d],styles:[".heading[_ngcontent-%COMP%]{flex:1}.details[_ngcontent-%COMP%]{padding:1em;text-align:center}.details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:400}.list[_ngcontent-%COMP%]{height:50vh;overflow:auto}.total[_ngcontent-%COMP%]{border-top:1px solid #ccc;display:flex;align-items:center;justify-content:flex-end;padding:.5em 1em}.total[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.8em;font-weight:500;margin-right:1.5em}mat-dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #ccc}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),t})();var ae,re=function(t,e){return(n=(e={exports:{}}).exports).isLeapYear=function(t){return t%4==0&&t%100!=0||t%400==0},n.isDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(t.valueOf())},n.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},n.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)},n.zeroPad=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n="0";return(t+="").length>=e?t:new Array(e-t.length+1).join(n)+t},n.titleCase=function(t){return t?t[0].toUpperCase()+t.substr(1):""},n.ordinal=function(t){var e=t%10,n=t%100;return 1===e&&11!==n?t+"st":2===e&&12!==n?t+"nd":3===e&&13!==n?t+"rd":t+"th"},n.toCardinal=function(t){return t=(t=String(t)).replace(/([0-9])(st|nd|rd|th)$/i,"$1"),parseInt(t,10)},n.normalize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"day"===(t=(t=(t=(t=t.toLowerCase().trim()).replace(/ies$/,"y")).replace(/s$/,"")).replace(/-/g,""))?"date":t},n.getEpoch=function(t){return"number"==typeof t?t:n.isDate(t)?t.getTime():t.epoch?t.epoch:null},n.beADate=function(t,e){return!1===n.isObject(t)?e.clone().set(t):t},n.formatTimezone=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=Math.abs(t),o=t>0?"+":"-";return"".concat(o).concat(n.zeroPad(i)).concat(e,"00")},e.exports;var n}(),ce=re.zeroPad,se=function(t,e,n,i){var o=new Date(t),a=(o.getTimezoneOffset()||0)+60*i;a=60*a*1e3;var r=function(t){return ce(t.getMonth()+1)+"/"+ce(t.getDate())+":"+ce(t.getHours())}(o=new Date(t+a));return r>=e&&r<n},ue=function(t){var e=t.timezones[t.tz];if(void 0===e)return console.warn("Warning: couldn't find timezone "+t.tz),0;if(void 0===e.dst)return e.offset;var n=e.offset,i=e.offset+1;"n"===e.hem&&(i=n-1);var o=e.dst.split("->");return!0===se(t.epoch,o[0],o[1],n)?n:i},le=["africa","america","asia","atlantic","australia","brazil","canada","chile","europe","indian","mexico","pacific","antarctica","etc"],de=(ae=Object.freeze({__proto__:null,default:{"9|s":"2/dili,2/jayapura","9|n":"2/chita,2/khandyga,2/pyongyang,2/seoul,2/tokyo,11/palau","9.5|s|04/05:03->10/04:02":"4/adelaide,4/broken_hill,4/south,4/yancowinna","9.5|s":"4/darwin,4/north","8|s":"12/casey,2/kuala_lumpur,2/makassar,2/singapore,4/perth,4/west","8|n|03/25:03->09/29:23":"2/ulan_bator","8|n":"2/brunei,2/choibalsan,2/chongqing,2/chungking,2/harbin,2/hong_kong,2/irkutsk,2/kuching,2/macao,2/macau,2/manila,2/shanghai,2/taipei,2/ujung_pandang,2/ulaanbaatar","8.75|s":"4/eucla","7|s":"12/davis,2/jakarta,9/christmas","7|n":"2/bangkok,2/barnaul,2/ho_chi_minh,2/hovd,2/krasnoyarsk,2/novokuznetsk,2/novosibirsk,2/phnom_penh,2/pontianak,2/saigon,2/tomsk,2/vientiane","6|s":"12/vostok","6|n":"2/almaty,2/bishkek,2/dacca,2/dhaka,2/kashgar,2/omsk,2/qyzylorda,2/thimbu,2/thimphu,2/urumqi,9/chagos","6.5|n":"2/rangoon,2/yangon,9/cocos","5|s":"12/mawson,9/kerguelen","5|n":"2/aqtau,2/aqtobe,2/ashgabat,2/ashkhabad,2/atyrau,2/baku,2/dushanbe,2/karachi,2/oral,2/samarkand,2/tashkent,2/yekaterinburg,9/maldives","5.75|n":"2/kathmandu,2/katmandu","5.5|n":"2/calcutta,2/colombo,2/kolkata","4|s":"9/reunion","4|n":"2/dubai,2/muscat,2/tbilisi,2/yerevan,8/astrakhan,8/samara,8/saratov,8/ulyanovsk,8/volgograd,2/volgograd,9/mahe,9/mauritius","4.5|n|03/21:00->09/20:24":"2/tehran","4.5|n":"2/kabul","3|s":"12/syowa,9/antananarivo","3|n|03/29:03->10/25:04":"2/famagusta,2/nicosia,8/athens,8/bucharest,8/helsinki,8/kiev,8/mariehamn,8/nicosia,8/riga,8/sofia,8/tallinn,8/uzhgorod,8/vilnius,8/zaporozhye","3|n|03/29:02->10/25:03":"8/chisinau,8/tiraspol","3|n|03/29:00->10/24:24":"2/beirut","3|n|03/27:02->10/25:02":"2/jerusalem,2/tel_aviv","3|n|03/27:00->10/31:01":"2/gaza,2/hebron","3|n|03/27:00->10/30:01":"2/amman","3|n|03/27:00->10/29:24":"2/damascus","3|n":"0/addis_ababa,0/asmara,0/asmera,0/dar_es_salaam,0/djibouti,0/juba,0/kampala,0/mogadishu,0/nairobi,2/aden,2/baghdad,2/bahrain,2/istanbul,2/kuwait,2/qatar,2/riyadh,8/istanbul,8/kirov,8/minsk,8/moscow,8/simferopol,9/comoro,9/mayotte","2|s|03/29:02->10/25:02":"12/troll","2|s":"0/gaborone,0/harare,0/johannesburg,0/lubumbashi,0/lusaka,0/maputo,0/maseru,0/mbabane","2|n|03/29:02->10/25:03":"0/ceuta,arctic/longyearbyen,3/jan_mayen,8/amsterdam,8/andorra,8/belgrade,8/berlin,8/bratislava,8/brussels,8/budapest,8/busingen,8/copenhagen,8/gibraltar,8/ljubljana,8/luxembourg,8/madrid,8/malta,8/monaco,8/oslo,8/paris,8/podgorica,8/prague,8/rome,8/san_marino,8/sarajevo,8/skopje,8/stockholm,8/tirane,8/vaduz,8/vatican,8/vienna,8/warsaw,8/zagreb,8/zurich","2|n":"0/blantyre,0/bujumbura,0/cairo,0/khartoum,0/kigali,0/tripoli,8/kaliningrad","1|s|04/02:01->09/03:03":"0/windhoek","1|s":"0/kinshasa,0/luanda","1|n|04/19:03->05/24:02":"0/casablanca,0/el_aaiun","1|n|03/29:01->10/25:02":"3/canary,3/faeroe,3/faroe,3/madeira,8/belfast,8/dublin,8/guernsey,8/isle_of_man,8/jersey,8/lisbon,8/london","1|n":"0/algiers,0/bangui,0/brazzaville,0/douala,0/lagos,0/libreville,0/malabo,0/ndjamena,0/niamey,0/porto-novo,0/tunis","14|n":"11/kiritimati","13|s|04/05:04->09/27:03":"11/apia","13|s|01/15:02->11/05:03":"11/tongatapu","13|n":"11/enderbury,11/fakaofo","12|s|04/05:03->09/27:02":"12/mcmurdo,12/south_pole,11/auckland","12|s|01/12:03->11/08:02":"11/fiji","12|n":"2/anadyr,2/kamchatka,2/srednekolymsk,11/funafuti,11/kwajalein,11/majuro,11/nauru,11/tarawa,11/wake,11/wallis","12.75|s|04/05:03->04/05:02":"11/chatham","11|s":"12/macquarie,11/bougainville","11|n":"2/magadan,2/sakhalin,11/efate,11/guadalcanal,11/kosrae,11/noumea,11/pohnpei,11/ponape","11.5|n|04/05:03->10/04:02":"11/norfolk","10|s|04/05:03->10/04:02":"4/act,4/canberra,4/currie,4/hobart,4/melbourne,4/nsw,4/sydney,4/tasmania,4/victoria","10|s":"12/dumontdurville,4/brisbane,4/lindeman,4/queensland","10|n":"2/ust-nera,2/vladivostok,2/yakutsk,11/chuuk,11/guam,11/port_moresby,11/saipan,11/truk,11/yap","10.5|s|04/05:01->10/04:02":"4/lhi,4/lord_howe","0|n|03/29:00->10/25:01":"1/scoresbysund,3/azores","0|n":"0/abidjan,0/accra,0/bamako,0/banjul,0/bissau,0/conakry,0/dakar,0/freetown,0/lome,0/monrovia,0/nouakchott,0/ouagadougou,0/sao_tome,0/timbuktu,1/danmarkshavn,3/reykjavik,3/st_helena,13/gmt,13/gmt+0,13/gmt-0,13/gmt0,13/greenwich,13/utc,13/universal,13/zulu","-9|n|03/08:02->11/01:02":"1/adak,1/atka","-9|n":"11/gambier","-9.5|n":"11/marquesas","-8|n|03/08:02->11/01:02":"1/anchorage,1/juneau,1/metlakatla,1/nome,1/sitka,1/yakutat","-8|n":"11/pitcairn","-7|n|03/08:02->11/01:02":"1/dawson,1/ensenada,1/los_angeles,1/santa_isabel,1/tijuana,1/vancouver,1/whitehorse,6/pacific,6/yukon,10/bajanorte","-7|n":"1/creston,1/dawson_creek,1/hermosillo,1/phoenix","-6|s|04/04:22->09/05:22":"7/easterisland,11/easter","-6|n|04/05:02->10/25:02":"1/chihuahua,1/mazatlan,10/bajasur","-6|n|03/08:02->11/01:02":"1/boise,1/cambridge_bay,1/denver,1/edmonton,1/inuvik,1/ojinaga,1/shiprock,1/yellowknife,6/mountain","-6|n":"1/belize,1/costa_rica,1/el_salvador,1/guatemala,1/managua,1/regina,1/swift_current,1/tegucigalpa,6/east-saskatchewan,6/saskatchewan,11/galapagos","-5|s":"1/lima,1/rio_branco,5/acre","-5|n|04/05:02->10/25:02":"1/bahia_banderas,1/merida,1/mexico_city,1/monterrey,10/general","-5|n|03/12:03->11/05:01":"1/north_dakota","-5|n|03/08:02->11/01:02":"1/chicago,1/knox_in,1/matamoros,1/menominee,1/rainy_river,1/rankin_inlet,1/resolute,1/winnipeg,6/central","-5|n":"1/atikokan,1/bogota,1/cancun,1/cayman,1/coral_harbour,1/eirunepe,1/guayaquil,1/jamaica,1/panama,1/porto_acre","-4|s|05/13:23->08/13:01":"12/palmer","-4|s|04/04:24->09/06:00":"1/santiago,7/continental","-4|s|03/21:24->10/04:00":"1/asuncion","-4|s|02/16:24->11/03:00":"1/campo_grande,1/cuiaba","-4|s":"1/la_paz,1/manaus,5/west","-4|n|03/12:03->11/05:01":"1/indiana,1/kentucky","-4|n|03/08:02->11/01:02":"1/detroit,1/fort_wayne,1/grand_turk,1/indianapolis,1/iqaluit,1/louisville,1/montreal,1/nassau,1/new_york,1/nipigon,1/pangnirtung,1/port-au-prince,1/thunder_bay,1/toronto,6/eastern","-4|n|03/08:00->11/01:01":"1/havana","-4|n":"1/anguilla,1/antigua,1/aruba,1/barbados,1/blanc-sablon,1/boa_vista,1/caracas,1/curacao,1/dominica,1/grenada,1/guadeloupe,1/guyana,1/kralendijk,1/lower_princes,1/marigot,1/martinique,1/montserrat,1/port_of_spain,1/porto_velho,1/puerto_rico,1/santo_domingo,1/st_barthelemy,1/st_kitts,1/st_lucia,1/st_thomas,1/st_vincent,1/tortola,1/virgin","-3|s":"1/argentina,1/buenos_aires,1/cordoba,1/fortaleza,1/montevideo,1/punta_arenas,1/sao_paulo,12/rothera,3/stanley,5/east","-3|n|03/08:02->11/01:02":"1/glace_bay,1/goose_bay,1/halifax,1/moncton,1/thule,3/bermuda,6/atlantic","-3|n":"1/araguaina,1/bahia,1/belem,1/catamarca,1/cayenne,1/jujuy,1/maceio,1/mendoza,1/paramaribo,1/recife,1/rosario,1/santarem","-2|s":"5/denoronha","-2|n|03/28:22->10/24:23":"1/godthab","-2|n|03/08:02->11/01:02":"1/miquelon","-2|n":"1/noronha,3/south_georgia","-2.5|n|03/08:02->11/01:02":"1/st_johns,6/newfoundland","-1|n":"3/cape_verde","-11|n":"11/midway,11/niue,11/pago_pago,11/samoa","-10|n":"11/honolulu,11/johnston,11/rarotonga,11/tahiti"}}))&&ae.default||ae,me={};Object.keys(de).forEach((function(t){var e=t.split("|"),n={offset:Number(e[0]),hem:e[1]};e[2]&&(n.dst=e[2]),de[t].split(",").forEach((function(t){t=t.replace(/(^[0-9]+)\//,(function(t,e){return e=Number(e),le[e]+"/"})),me[t]=n}))})),me.utc={offset:0,hem:"n"};for(var he=-14;he<=14;he+=.5){var fe=he;fe>0&&(fe="+"+fe);var be="etc/gmt"+fe;me[be]={offset:-1*he,hem:"n"},me[be="utc/gmt"+fe]={offset:-1*he,hem:"n"}}var ge,pe=me,ve=/(\-?[0-9]+)h(rs)?/i,_e=/(\-?[0-9]+)/,ye=/utc([\-+]?[0-9]+)/i,we=/gmt([\-+]?[0-9]+)/i,Ce=function(t){return(t=Number(t))>-13&&t<13?"etc/gmt"+(t=((t*=-1)>0?"+":"")+t):null},Oe=null===(ge=function(){if("undefined"==typeof Intl||void 0===Intl.DateTimeFormat)return null;var t=Intl.DateTimeFormat();if(void 0===t||void 0===t.resolvedOptions)return null;var e=t.resolvedOptions().timeZone;return e?e.toLowerCase():null}())?"utc":ge,xe=Object.keys(pe).reduce((function(t,e){var n=e.split("/")[1]||"";return t[n=n.replace(/_/g," ")]=e,t}),{}),Me=function(t,e){if(!t)return Oe;var n=t.trim(),i=t.split("/");if(i.length>2&&!1===e.hasOwnProperty(n)&&(n=i[0]+"/"+i[1]),n=n.toLowerCase(),!0===e.hasOwnProperty(n))return n;if(n=function(t){return(t=(t=(t=(t=(t=t.replace(/ time/g,"")).replace(/ (standard|daylight|summer)/g,"")).replace(/\b(east|west|north|south)ern/g,"$1")).replace(/\b(africa|america|australia)n/g,"$1")).replace(/\beuropean/g,"europe")).replace(/\islands/g,"island")}(n),!0===e.hasOwnProperty(n))return n;if(!0===xe.hasOwnProperty(n))return xe[n];if(!0===/[0-9]/.test(n)){var o=function(t){var e=t.match(ve);if(null!==e)return Ce(e[1]);if(null!==(e=t.match(ye)))return Ce(e[1]);if(null!==(e=t.match(we))){var n=-1*Number(e[1]);return Ce(n)}return null!==(e=t.match(_e))?Ce(e[1]):null}(n);if(o)return o}throw new Error("Spacetime: Cannot find timezone named: '"+t+"'. Please enter an IANA timezone id.")},ke={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5};ke.date=ke.day,ke.month=25488e5,ke.week=6048e5,ke.year=3154e7,Object.keys(ke).forEach((function(t){ke[t+"s"]=ke[t]}));var Pe=ke,Ve=function(t,e,n,i,o){var a=t.d[n]();if(a!==e){var r=null===o?null:t.d[o](),c=t.epoch,s=e-a;t.epoch+=Pe[i]*s,"day"===i&&Math.abs(s)>28&&e<28&&(t.epoch+=Pe.hour);for(var u=Pe[i]/2;t.d[n]()<e;)t.epoch+=u;for(;t.d[n]()>e;)t.epoch-=u;null!==o&&r!==t.d[o]()&&(t.epoch=c,t.epoch+=Pe[i]*s*.89)}},We={year:{valid:function(t){return t>-4e3&&t<4e3},walkTo:function(t,e){return Ve(t,e,"getFullYear","year",null)}},month:{valid:function(t){return t>=0&&t<=11},walkTo:function(t,e){var n=t.d,i=n.getMonth(),o=t.epoch,a=n.getFullYear();if(i!==e){for(t.epoch+=Pe.day*(28*(e-i)),a!==t.d.getFullYear()&&(t.epoch=o);t.d.getMonth()<e;)t.epoch+=Pe.day;for(;t.d.getMonth()>e;)t.epoch-=Pe.day}}},date:{valid:function(t){return t>0&&t<=31},walkTo:function(t,e){return Ve(t,e,"getDate","day","getMonth")}},hour:{valid:function(t){return t>=0&&t<24},walkTo:function(t,e){return Ve(t,e,"getHours","hour","getDate")}},minute:{valid:function(t){return t>=0&&t<60},walkTo:function(t,e){return Ve(t,e,"getMinutes","minute","getHours")}},second:{valid:function(t){return t>=0&&t<60},walkTo:function(t,e){t.epoch=t.seconds(e).epoch}},millisecond:{valid:function(t){return t>=0&&t<1e3},walkTo:function(t,e){t.epoch=t.milliseconds(e).epoch}}},Ie=function(t,e){for(var n=Object.keys(We),i=t.clone(),o=0;o<n.length;o++){var a=n[o],r=e[a];if(void 0===r&&(r=i[a]()),"string"==typeof r&&(r=parseInt(r,10)),!We[a].valid(r))return t.epoch=null,void(!1===t.silent&&console.warn("invalid "+a+": "+r));We[a].walkTo(t,r)}},ze=["jan","feb","mar","apr","may","jun","jul","aug","sept","oct","nov","dec"],Ee=["january","february","march","april","may","june","july","august","september","october","november","december"],je=function(){return ze},De=function(){return function(){for(var t={sep:8},e=0;e<ze.length;e++)t[ze[e]]=e;for(var n=0;n<Ee.length;n++)t[Ee[n]]=n;return t}()},Ge=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=(e=e.replace(/^\s+/,"").toLowerCase()).match(/([0-9]{1,2}):([0-9]{1,2}):?([0-9]{1,2})?[:\.]?([0-9]{1,4})?/);if(null!==n){var i=Number(n[1]);if(i<0||i>24)return t.startOf("day");var o=Number(n[2]);if(n[2].length<2||o<0||o>59)return t.startOf("day");t=(t=(t=(t=t.hour(i)).minute(o)).seconds(n[3]||0)).millisecond(n[4]||0);var a=e.match(/[\b0-9](am|pm)\b/);return null!==a&&a[1]&&(t=t.ampm(a[1])),t}if(null!==(n=e.match(/([0-9]+) ?(am|pm)/))&&n[1]){var r=Number(n[1]);return r>12||r<1?t.startOf("day"):t=(t=(t=t.hour(n[1]||0)).ampm(n[2])).startOf("hour")}return t.startOf("day")},Se=[31,28,31,30,31,30,31,31,30,31,30,31],Fe=re.isLeapYear,Ae=function(t){return!0===Se.hasOwnProperty(t.month)&&(1===t.month?!!(Fe(t.year)&&t.date<=29)||t.date<=28:t.date<=(Se[t.month]||0))},Te=De(),qe=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=parseInt(t.trim(),10);return e||(new Date).getFullYear()},$e=[{reg:/^(\-?0?0?[0-9]{3,4})-([0-9]{1,2})-([0-9]{1,2})[T| ]([0-9.:]+)(Z|[0-9\-\+:]+)?$/,parse:function(t,e,n,i){var o=parseInt(e[2],10)-1,a={year:e[1],month:o,date:e[3]};return!1===Ae(a)?(t.epoch=null,t):(function(t,e){if(!e)return t;"Z"===e&&(e="+0000");var n=0;/^[\+-]?[0-9]{2}:[0-9]{2}$/.test(e)&&(!0===/:00/.test(e)&&(e=e.replace(/:00/,"")),!0===/:30/.test(e)&&(e=e.replace(/:30/,".5"))),/^[\+-]?[0-9]{4}$/.test(e)&&(e=e.replace(/30$/,".5")),n=parseFloat(e),Math.abs(n)>100&&(n/=100),(n*=-1)>=0&&(n="+"+n);var i="etc/gmt"+n;t.timezones[i]&&(t.tz=i)}(t,e[5]),Ie(t,a),t=Ge(t,e[4]))}},{reg:/^([0-9]{4})[\-\/]([0-9]{1,2})[\-\/]([0-9]{1,2}),?( [0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(t,e){var n={year:e[1],month:parseInt(e[2],10)-1,date:parseInt(e[3],10)};return n.month>=12&&(n.date=parseInt(e[2],10),n.month=parseInt(e[3],10)-1),!1===Ae(n)?(t.epoch=null,t):(Ie(t,n),t=Ge(t,e[4]))}},{reg:/^([0-9]{1,2})[\-\/]([0-9]{1,2})[\-\/]?([0-9]{4})?,?( [0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(t,e){var n=parseInt(e[1],10)-1,i=parseInt(e[2],10);(t.british||n>=12)&&(i=parseInt(e[1],10),n=parseInt(e[2],10)-1);var o={year:e[3]||(new Date).getFullYear(),month:n,date:i};return!1===Ae(o)?(t.epoch=null,t):(Ie(t,o),t=Ge(t,e[4]))}},{reg:/^([0-9]{1,2})[\-\/]([a-z]+)[\-\/]?([0-9]{4})?$/i,parse:function(t,e){var n=Te[e[2].toLowerCase()],i={year:qe(e[3]),month:n,date:re.toCardinal(e[1]||"")};return!1===Ae(i)?(t.epoch=null,t):(Ie(t,i),t=Ge(t,e[4]))}},{reg:/^([a-z]+) ([0-9]{1,2}(?:st|nd|rd|th)?),?( [0-9]{4})?( ([0-9:]+( ?am| ?pm| ?gmt)?))?$/i,parse:function(t,e){var n=Te[e[1].toLowerCase()],i={year:qe(e[3]),month:n,date:re.toCardinal(e[2]||"")};return!1===Ae(i)?(t.epoch=null,t):(Ie(t,i),t=Ge(t,e[4]))}},{reg:/^([a-z]+) ([0-9]{4})$/i,parse:function(t,e){var n=Te[e[1].toLowerCase()],i={year:qe(e[2]),month:n,date:1};return!1===Ae(i)?(t.epoch=null,t):(Ie(t,i),t=Ge(t,e[4]))}},{reg:/^([0-9]{1,2}(?:st|nd|rd|th)?) ([a-z]+),?( [0-9]{4})?,? ?([0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(t,e){var n=Te[e[2].toLowerCase()];if(!n)return null;var i={year:qe(e[3]),month:n,date:re.toCardinal(e[1])};return!1===Ae(i)?(t.epoch=null,t):(Ie(t,i),t=Ge(t,e[4]))}},{reg:/^[0-9,]+ ?b\.?c\.?$/i,parse:function(t,e){var n=e[0]||"";n=(n=n.replace(/^([0-9,]+) ?b\.?c\.?$/i,"-$1")).replace(/,/g,"");var i=parseInt(n.trim(),10),o=new Date,a={year:i,month:o.getMonth(),date:o.getDate()};return!1===Ae(a)?(t.epoch=null,t):(Ie(t,a),t=Ge(t))}},{reg:/^[0-9,]+ ?(a\.?d\.?|c\.?e\.?)$/i,parse:function(t,e){var n=e[0]||"";n=n.replace(/,/g,"");var i=parseInt(n.trim(),10),o=new Date,a={year:i,month:o.getMonth(),date:o.getDate()};return!1===Ae(a)?(t.epoch=null,t):(Ie(t,a),t=Ge(t))}},{reg:/^[0-9]{4}( ?a\.?d\.?)?$/i,parse:function(t,e){var n=qe(e[0]),i=new Date,o={year:n,month:i.getMonth(),date:i.getDate()};return!1===Ae(o)?(t.epoch=null,t):(Ie(t,o),t=Ge(t))}}],Ne={now:function(t){return t.epoch=Date.now(),t},tonight:function(t){return t.epoch=Date.now(),t.hour(18)},today:function(t){return t.epoch=Date.now(),t},tomorrow:function(t){return t.epoch=Date.now(),(t=t.add(1,"day")).startOf("day")},yesterday:function(t){return t.epoch=Date.now(),(t=t.subtract(1,"day")).startOf("day")},christmas:function(t){var e=(new Date).getFullYear();return t.set([e,11,25,18,0,0])},"new years":function(t){var e=(new Date).getFullYear();return t.set([e,11,31,18,0,0])}};Ne["new years eve"]=Ne["new years"];var Re=Ne,He={year:(new Date).getFullYear(),month:0,date:1},Qe=function(t,e,n){if("number"==typeof e)return e>0&&e<25e8&&!1===t.silent&&(console.warn("  - Warning: You are setting the date to January 1970."),console.warn("       -   did input seconds instead of milliseconds?")),t.epoch=e,t;if(t.epoch=Date.now(),null==e)return t;if(!0===re.isDate(e))return t.epoch=e.getTime(),t;if(!0===re.isArray(e))return function(t,e){for(var n=["year","month","date","hour","minute","second","millisecond"],i=0;i<n.length;i++)t=t[n[i]](e[i]||He[n[i]]||0);return t}(t,e);if(!0===re.isObject(e))return e.epoch?(t.epoch=e.epoch,t.tz=e.tz,t):t=function(t,e){e=Object.assign({},He,e);for(var n=Object.keys(e),i=0;i<n.length;i++){var o=n[i];void 0!==t[o]&&"function"==typeof t[o]&&null!=e[o]&&""!==e[o]&&(t=t[o](e[o]||He[o]||0))}return t}(t,e);if("string"!=typeof e)return t;if(e=(e=(e=e.replace(/\b(mon|tues|wed|wednes|thu|thurs|fri|sat|satur|sun)(day)?\b/i,"")).replace(/,/g,"")).replace(/ +/g," ").trim(),!0===Re.hasOwnProperty(e))return Re[e](t);for(var i=0;i<$e.length;i++){var o=e.match($e[i].reg);if(o){var a=$e[i].parse(t,o,n);if(null!==a)return a}}return!1===t.silent&&console.warn("Warning: couldn't parse date-string: '"+e+"'"),t.epoch=null,t},Ue=["sun","mon","tue","wed","thu","fri","sat"],Ye=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Le=function(){return Ue},Be=function(){return Ye},Xe=function(t){var e=t.timezone().current.offset,n=e<0,i="00";return.5===Math.abs(e%1)&&(i="30",e=e>=0?Math.floor(e):Math.ceil(e)),"+00:00"==(e=(e=n?"-"+(e=re.zeroPad(e*=-1,2)):"+"+(e=re.zeroPad(e,2)))+":"+i)&&(e="Z"),e},Ke={day:function(t){return re.titleCase(t.dayName())},"day-short":function(t){return re.titleCase(Le()[t.day()])},"day-number":function(t){return t.day()},"day-ordinal":function(t){return re.ordinal(t.day())},"day-pad":function(t){return re.zeroPad(t.day())},date:function(t){return t.date()},"date-ordinal":function(t){return re.ordinal(t.date())},"date-pad":function(t){return re.zeroPad(t.date())},month:function(t){return re.titleCase(t.monthName())},"month-short":function(t){return re.titleCase(je()[t.month()])},"month-number":function(t){return t.month()},"month-ordinal":function(t){return re.ordinal(t.month())},"month-pad":function(t){return re.zeroPad(t.month())},"iso-month":function(t){return re.zeroPad(t.month()+1)},year:function(t){var e=t.year();return e>0?e:(e=Math.abs(e))+" BC"},"year-short":function(t){var e=t.year();return e>0?"'".concat(String(t.year()).substr(2,4)):(e=Math.abs(e))+" BC"},"iso-year":function(t){var e=t.year(),n=e<0,i=re.zeroPad(Math.abs(e),4);return n&&(i="-"+(i=re.zeroPad(i,6))),i},time:function(t){return t.time()},"time-24":function(t){return"".concat(t.hour24(),":").concat(re.zeroPad(t.minute()))},hour:function(t){return t.hour12()},"hour-pad":function(t){return re.zeroPad(t.hour12())},"hour-24":function(t){return t.hour24()},"hour-24-pad":function(t){return re.zeroPad(t.hour24())},minute:function(t){return t.minute()},"minute-pad":function(t){return re.zeroPad(t.minute())},second:function(t){return t.second()},"second-pad":function(t){return re.zeroPad(t.second())},ampm:function(t){return t.ampm()},quarter:function(t){return"Q"+t.quarter()},season:function(t){return t.season()},era:function(t){return t.era()},json:function(t){return t.json()},timezone:function(t){return t.timezone().name},offset:function(t){return Xe(t)},numeric:function(t){return"".concat(t.year(),"/").concat(re.zeroPad(t.month()+1),"/").concat(re.zeroPad(t.date()))},"numeric-us":function(t){return"".concat(re.zeroPad(t.month()+1),"/").concat(re.zeroPad(t.date()),"/").concat(t.year())},"numeric-uk":function(t){return"".concat(re.zeroPad(t.date()),"/").concat(re.zeroPad(t.month()+1),"/").concat(t.year())},"mm/dd":function(t){return"".concat(re.zeroPad(t.month()+1),"/").concat(re.zeroPad(t.date()))},iso:function(t){var e=t.format("iso-year"),n=re.zeroPad(t.month()+1),i=re.zeroPad(t.date()),o=re.zeroPad(t.h24()),a=re.zeroPad(t.minute()),r=re.zeroPad(t.second()),c=re.zeroPad(t.millisecond(),3),s=Xe(t);return"".concat(e,"-").concat(n,"-").concat(i,"T").concat(o,":").concat(a,":").concat(r,".").concat(c).concat(s)},"iso-short":function(t){var e=re.zeroPad(t.month()+1),n=re.zeroPad(t.date());return"".concat(t.year(),"-").concat(e,"-").concat(n)},"iso-utc":function(t){return new Date(t.epoch).toISOString()},nice:function(t){return"".concat(je()[t.month()]," ").concat(re.ordinal(t.date()),", ").concat(t.time())},"nice-year":function(t){return"".concat(je()[t.month()]," ").concat(re.ordinal(t.date()),", ").concat(t.year())},"nice-day":function(t){return"".concat(Le()[t.day()]," ").concat(re.titleCase(je()[t.month()])," ").concat(re.ordinal(t.date()))},"nice-full":function(t){return"".concat(t.dayName()," ").concat(re.titleCase(t.monthName())," ").concat(re.ordinal(t.date()),", ").concat(t.time())}},Ze={"day-name":"day","month-name":"month","iso 8601":"iso","time-h24":"time-24","time-12":"time","time-h12":"time",tz:"timezone","day-num":"day-number","month-num":"month-number","month-iso":"iso-month","year-iso":"iso-year","nice-short":"nice",mdy:"numeric-us",dmy:"numeric-uk",ymd:"numeric","yyyy/mm/dd":"numeric","mm/dd/yyyy":"numeric-us","dd/mm/yyyy":"numeric-us","little-endian":"numeric-uk","big-endian":"numeric","day-nice":"nice-day"};Object.keys(Ze).forEach((function(t){return Ke[t]=Ke[Ze[t]]}));var Je=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!0!==t.isValid())return"";if(Ke.hasOwnProperty(e)){var n=Ke[e](t)||"";return"json"!==e&&(n=String(n),"ampm"!==e&&(n=re.titleCase(n))),n}if(-1!==e.indexOf("{")){var i=/\{(.+?)\}/g;return e.replace(i,(function(e,n){return n=n.toLowerCase().trim(),Ke.hasOwnProperty(n)?String(Ke[n](t)||""):""}))}return t.format("iso-short")},tn=re.zeroPad,en=re.formatTimezone,nn={G:function(t){return t.era()},GG:function(t){return t.era()},GGG:function(t){return t.era()},GGGG:function(t){return"AD"===t.era()?"Anno Domini":"Before Christ"},y:function(t){return t.year()},yy:function(t){return parseInt(String(t.year()).substr(2,4),10)},yyy:function(t){return t.year()},yyyy:function(t){return t.year()},yyyyy:function(t){return"0"+t.year()},Q:function(t){return t.quarter()},QQ:function(t){return t.quarter()},QQQ:function(t){return t.quarter()},QQQQ:function(t){return t.quarter()},M:function(t){return t.month()+1},MM:function(t){return tn(t.month()+1)},MMM:function(t){return t.format("month-short")},MMMM:function(t){return t.format("month")},w:function(t){return t.week()},ww:function(t){return tn(t.week())},d:function(t){return t.date()},dd:function(t){return tn(t.date())},D:function(t){return t.dayOfYear()},DD:function(t){return tn(t.dayOfYear())},DDD:function(t){return tn(t.dayOfYear(),3)},E:function(t){return t.format("day-short")},EE:function(t){return t.format("day-short")},EEE:function(t){return t.format("day-short")},EEEE:function(t){return t.format("day")},EEEEE:function(t){return t.format("day")[0]},e:function(t){return t.day()},ee:function(t){return t.day()},eee:function(t){return t.format("day-short")},eeee:function(t){return t.format("day")},eeeee:function(t){return t.format("day")[0]},a:function(t){return t.ampm().toUpperCase()},aa:function(t){return t.ampm().toUpperCase()},aaa:function(t){return t.ampm().toUpperCase()},aaaa:function(t){return t.ampm().toUpperCase()},h:function(t){return t.h12()},hh:function(t){return tn(t.h12())},H:function(t){return t.hour()},HH:function(t){return tn(t.hour())},m:function(t){return t.minute()},mm:function(t){return tn(t.minute())},s:function(t){return t.second()},ss:function(t){return tn(t.second())},A:function(t){return t.epoch-t.startOf("day").epoch},z:function(t){return t.timezone().name},zz:function(t){return t.timezone().name},zzz:function(t){return t.timezone().name},zzzz:function(t){return t.timezone().name},Z:function(t){return en(t.timezone().current.offset)},ZZ:function(t){return en(t.timezone().current.offset)},ZZZ:function(t){return en(t.timezone().current.offset)},ZZZZ:function(t){return en(t.timezone().current.offset,":")}},on=function(t,e,n){for(var i=t,o=e,a=0;a<n;a+=1)nn[i]=nn[o],i+=t,o+=e};on("q","Q",4),on("L","M",4),on("Y","y",4),on("c","e",4),on("k","H",2),on("K","h",2),on("S","s",2),on("v","z",4),on("V","Z",4);var an=["year","season","quarter","month","week","day","quarterHour","hour","minute"],rn=function(t,e){var n=t.clone().startOf(e),i=t.clone().endOf(e);return parseFloat(((t.epoch-n.epoch)/(i.epoch-n.epoch)).toFixed(2))},cn=function(t,e,n){var i=0;for(t=t.clone();t.isBefore(e);)t=t.add(1,n),i+=1;return t.isAfter(e,n)&&(i-=1),i},sn=function(t,e,n){return t.isBefore(e)?cn(t,e,n):-1*cn(e,t,n)},un={months:{almost:10,over:4},days:{almost:25,over:10},hours:{almost:20,over:8},minutes:{almost:50,over:20},seconds:{almost:50,over:20}};function ln(t,e){return 1===t&&(e=e.slice(0,-1)),t+" "+e}var dn={north:[["spring",2,1],["summer",5,1],["fall",8,1],["autumn",8,1],["winter",11,1]],south:[["fall",2,1],["autumn",2,1],["winter",5,1],["spring",8,1],["summer",11,1]]},mn=[null,[0,1],[3,1],[6,1],[9,1]],hn={minute:function(t){return Ie(t,{second:0,millisecond:0}),t},quarterhour:function(t){var e=t.minutes();return t=t.minutes(e>=45?45:e>=30?30:e>=15?15:0),Ie(t,{second:0,millisecond:0}),t},hour:function(t){return Ie(t,{minute:0,second:0,millisecond:0}),t},day:function(t){return Ie(t,{hour:0,minute:0,second:0,millisecond:0}),t},week:function(t){var e=t.clone();return(t=t.day(t._weekStart)).isAfter(e)&&(t=t.subtract(1,"week")),Ie(t,{hour:0,minute:0,second:0,millisecond:0}),t},month:function(t){return Ie(t,{date:1,hour:0,minute:0,second:0,millisecond:0}),t},quarter:function(t){var e=t.quarter();return mn[e]&&Ie(t,{month:mn[e][0],date:mn[e][1],hour:0,minute:0,second:0,millisecond:0}),t},season:function(t){var e=t.season(),n="north";"South"===t.hemisphere()&&(n="south");for(var i=0;i<dn[n].length;i++)if(dn[n][i][0]===e){var o=t.year();return"winter"===e&&t.month()<3&&(o-=1),Ie(t,{year:o,month:dn[n][i][1],date:dn[n][i][2],hour:0,minute:0,second:0,millisecond:0}),t}return t},year:function(t){return Ie(t,{month:0,date:1,hour:0,minute:0,second:0,millisecond:0}),t},decade:function(t){var e=(t=t.startOf("year")).year(),n=10*parseInt(e/10,10);return t.year(n)},century:function(t){var e=(t=t.startOf("year")).year(),n=100*parseInt(e/100,10);return t.year(n)}};hn.date=hn.day;var fn=function(t){return!!Le().find((function(e){return e===t}))||!!Be().find((function(e){return e===t}))},bn=function(t){var e=t.timezones,n=t.tz;if(!1===e.hasOwnProperty(n)&&(n=Me(t.tz,e)),null===n)return!1===t.silent&&console.warn("Warn: could not find given or local timezone - '"+t.tz+"'"),{current:{epochShift:0}};var i,o,a=e[n],r={name:(i=n,i=(i=(i=i[0].toUpperCase()+i.substr(1)).replace(/\/gmt/,"/GMT")).replace(/[\/_]([a-z])/gi,(function(t){return t.toUpperCase()}))),hasDst:Boolean(a.dst),default_offset:a.offset,hemisphere:"s"===a.hem?"South":"North",current:{}};if(r.hasDst){var c=(o=a.dst)?o.split("->"):[];r.change={start:c[0],back:c[1]}}var s=a.offset,u=s;return!0===r.hasDst&&(u="North"===r.hemisphere?s-1:a.offset+1),!1===r.hasDst?(r.current.offset=s,r.current.isDST=!1):!0===se(t.epoch,r.change.start,r.change.back,s)?(r.current.offset=s,r.current.isDST="North"===r.hemisphere):(r.current.offset=u,r.current.isDST="South"===r.hemisphere),r},gn=["century","decade","year","month","date","day","hour","minute","second","millisecond"],pn={set:function(t,e){var n=this.clone();return n=Qe(n,t),e&&(this.tz=Me(e)),n},timezone:function(){return bn(this)},isDST:function(){return bn(this).current.isDST},hasDST:function(){return bn(this).hasDst},offset:function(){return 60*bn(this).current.offset},hemisphere:function(){return bn(this).hemisphere},format:function(t){return Je(this,t)},unixFmt:function(t){return function(t,e){for(var n=e.split(""),i=[n[0]],o=!1,a=1;a<n.length;a+=1){if("'"===n[a]){if(1!=(o=!o)||!n[a+1]||"'"!==n[a+1])continue;o=!0}!0===o||n[a]===i[i.length-1][0]?i[i.length-1]+=n[a]:i.push(n[a])}return i.reduce((function(e,n){return e+(void 0!==nn[n]?nn[n](t)||"":n)}),"")}(this,t)},startOf:function(t){return function(t,e){var n=t.clone();return e=re.normalize(e),hn[e]?hn[e](n):"summer"===e||"winter"===e?(n=n.season(e),hn.season(n)):n}(this,t)},endOf:function(t){return function(t,e){var n=t.clone();return e=re.normalize(e),hn[e]?n=(n=(n=hn[e](n)).add(1,e)).subtract(1,"milliseconds"):n}(this,t)},leapYear:function(){var t=this.year();return re.isLeapYear(t)},progress:function(t){return function(t,e){if(e)return e=re.normalize(e),rn(t,e);var n={};return an.forEach((function(e){n[e]=rn(t,e)})),n}(this,t)},nearest:function(t){return function(t,e){var n=t.progress();return"quarterhour"===(e=re.normalize(e))&&(e="quarterHour"),void 0!==n[e]?(n[e]>.5&&(t=t.add(1,e)),t=t.startOf(e)):!1===t.silent&&console.warn("no known unit '"+e+"'"),t}(this,t)},diff:function(t,e){return function(t,e,n){e=re.beADate(e,t);var i=!1;if(t.isAfter(e)){var o=t;t=e,e=o,i=!0}var a=function(t,e){var n=e.epoch-t.epoch,i={milliseconds:n,seconds:parseInt(n/1e3,10)};i.minutes=parseInt(i.seconds/60,10),i.hours=parseInt(i.minutes/60,10);var o=t.clone();return i.years=function(t,e){var n=e.year()-t.year();return(t=t.year(e.year())).isAfter(e)&&(n-=1),n}(o,e),o=t.add(i.years,"year"),i.months=12*i.years,o=t.add(i.months,"month"),i.months+=sn(o,e,"month"),i.weeks=52*i.years,o=t.add(i.weeks,"week"),i.weeks+=sn(o,e,"week"),i.days=7*i.weeks,o=t.add(i.days,"day"),i.days+=sn(o,e,"day"),i}(t,e);return i&&(a=function(t){return Object.keys(t).forEach((function(e){t[e]*=-1})),t}(a)),n?(n=re.normalize(n),!0!==/s$/.test(n)&&(n+="s"),"dates"===n&&(n="days"),a[n]):a}(this,t,e)},since:function(t){return t||(t=this.clone().set()),function(t,e){var n,i,o,a=function(t,e){var n=t.isBefore(e),i=n?e:t,o=n?t:e;o=o.clone();var a={years:0,months:0,days:0,hours:0,minutes:0,seconds:0};return Object.keys(a).forEach((function(t){if(!o.isSame(i,t)){var e=o.diff(i,t);o=o.add(e,t),a[t]=e}})),n&&Object.keys(a).forEach((function(t){0!==a[t]&&(a[t]*=-1)})),a}(t,e=re.beADate(e,t));if(!0===Object.keys(a).every((function(t){return!a[t]})))return{diff:a,rounded:"now",qualified:"now",precise:"now"};var r=[];return Object.keys(a).forEach((function(t,e,o){var c=Math.abs(a[t]);if(0!==c){var s=ln(c,t);if(r.push(s),!n){if(n=i=s,e>4)return;var u=o[e+1],l=Math.abs(a[u]);l>un[u].almost?(n=ln(c+1,t),i="almost "+n):l>un[u].over&&(i="over "+s)}}})),o=r.splice(0,2).join(", "),!0===t.isAfter(e)?(n+=" ago",i+=" ago",o+=" ago"):(n="in "+n,i="in "+i,o="in "+o),{diff:a,rounded:n,qualified:i,precise:o}}(this,t)},next:function(t){return this.add(1,t).startOf(t)},last:function(t){return this.subtract(1,t).startOf(t)},isValid:function(){return!(!this.epoch&&0!==this.epoch||isNaN(this.d.getTime()))},goto:function(t){var e=this.clone();return e.tz=Me(t,e.timezones),e},every:function(t,e){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;if(!e||!n)return[];if(e=re.normalize(e),n=t.clone().set(n),t.isAfter(n)){var i=t;t=n,n=i}var o=t.clone();fn(e)?(o=o.next(e),e="week"):o=o.next(e);for(var a=[];o.isBefore(n);)a.push(o),o=o.add(1,e);return a}(this,t,e)},isAwake:function(){var t=this.hour();return!(t<8||t>22)},isAsleep:function(){return!this.isAwake()},log:function(){return console.log(""),console.log(Je(this,"nice-short")),this},logYear:function(){return console.log(""),console.log(Je(this,"full-short")),this},json:function(){var t=this;return gn.reduce((function(e,n){return e[n]=t[n](),e}),{})},debug:function(){var t=this.timezone(),e=this.format("MM")+" "+this.format("date-ordinal")+" "+this.year();return e+="\n     - "+this.format("time"),console.log("\n\n",e+"\n     - "+t.name+" ("+t.current.offset+")"),this},from:function(t){return(t=this.clone().set(t)).since(this)},fromNow:function(){return this.clone().set(Date.now()).since(this)},weekStart:function(t){if("number"==typeof t)return this._weekStart=t,this;if("string"==typeof t){t=t.toLowerCase().trim();var e=Le().indexOf(t);-1===e&&(e=Be().indexOf(t)),-1===e&&(e=1),this._weekStart=e}else console.warn("Spacetime Error: Cannot understand .weekStart() input:",t);return this}};pn.inDST=pn.isDST,pn.round=pn.nearest,pn.each=pn.every;var vn=pn,_n=function(t){return"string"==typeof t&&(t=parseInt(t,10)),t},yn=["year","month","date","hour","minute","second","millisecond"],wn=function(t,e,n){for(var i=yn.indexOf(n),o=yn.slice(i,yn.length),a=0;a<o.length;a++){var r=e[o[a]]();t[o[a]](r)}return t},Cn=function(t,e){e=_n(e);var n=t.clone(),i=t.minute()-e;return t.epoch-=i*Pe.minute,wn(t,n,"second"),t.epoch},On=function(t,e){(e=_n(e))>=24?e=24:e<0&&(e=0);var n=t.clone(),i=t.hour()-e;return t.epoch-=i*Pe.hour,Ie(t,{hour:e}),wn(t,n,"minute"),t.epoch},xn=function(t,e){return e=_n(e),Ie(t,{year:e}),t.epoch},Mn=function(t){return(t=(t=t.minute(0)).second(0)).millisecond(1)},kn=Object.assign({},{millisecond:function(t){if(void 0!==t){var e=this.clone();return e.epoch=function(t,e){e=_n(e);var n=t.millisecond();return t.epoch-(n-e)}(e,t),e}return this.d.getMilliseconds()},second:function(t){if(void 0!==t){var e=this.clone();return e.epoch=function(t,e){e=_n(e);var n=t.second()-e;return t.epoch-n*Pe.second}(e,t),e}return this.d.getSeconds()},minute:function(t){if(void 0!==t){var e=this.clone();return e.epoch=Cn(e,t),e}return this.d.getMinutes()},hour:function(t){var e=this.d;if(void 0!==t){var n=this.clone();return n.epoch=On(n,t),n}return e.getHours()},hourFloat:function(t){if(void 0!==t){var e=this.clone(),n=t%1;n*=60;var i=parseInt(t,10);return e.epoch=On(e,i),e.epoch=Cn(e,n),e}var o=this.d;return o.getHours()+o.getMinutes()/60},hour12:function(t){var e=this.d;if(void 0!==t){var n=this.clone(),i=(t=""+t).match(/^([0-9]+)(am|pm)$/);if(i){var o=parseInt(i[1],10);"pm"===i[2]&&(o+=12),n.epoch=On(n,o)}return n}var a=e.getHours();return a>12&&(a-=12),0===a&&(a=12),a},time:function(t){if(void 0!==t){var e=this.clone();return e.epoch=function(t,e){var n=e.match(/([0-9]{1,2}):([0-9]{1,2})(am|pm)?/);if(!n){if(!(n=e.match(/([0-9]{1,2})(am|pm)/)))return t.epoch;n.splice(2,0,"0")}var i=!1,o=parseInt(n[1],10),a=parseInt(n[2],10);return o>12&&(i=!0),!1===i&&("am"===n[3]&&12===o&&(o=0),"pm"===n[3]&&o<12&&(o+=12)),(t=(t=(t=(t=t.hour(o)).minute(a)).second(0)).millisecond(0)).epoch}(e,t),e}return"".concat(this.h12(),":").concat(re.zeroPad(this.minute())).concat(this.ampm())},ampm:function(t){var e="am",n=this.hour();if(n>=12&&(e="pm"),"string"!=typeof t)return e;var i=this.clone();return t=t.toLowerCase().trim(),n>=12&&"am"===t?i.hour(n-=12):n<12&&"pm"===t?i.hour(n+=12):i},dayTime:function(t){if(void 0!==t){var e={morning:"7:00am",breakfast:"7:00am",noon:"12:00am",lunch:"12:00pm",afternoon:"2:00pm",evening:"6:00pm",dinner:"6:00pm",night:"11:00pm",midnight:"23:59pm"},n=this.clone();return t=(t=t||"").toLowerCase(),!0===e.hasOwnProperty(t)&&(n=n.time(e[t])),n}var i=this.hour();return i<6?"night":i<12?"morning":i<17?"afternoon":i<22?"evening":"night"},iso:function(t){return void 0!==t?this.set(t):this.format("iso")}},{date:function(t){if(void 0!==t){var e=this.clone();return e.epoch=function(t,e){if((e=_n(e))>28){var n=Se[t.month()];e>n&&(e=n)}return e<=0&&(e=1),Ie(t,{date:e}),t.epoch}(e,t),e}return this.d.getDate()},day:function(t){if(void 0===t)return this.d.getDay();var e=this.clone(),n=t;"string"==typeof t&&(t=t.toLowerCase(),-1===(n=Le().indexOf(t))&&(n=Be().indexOf(t)));var i=this.d.getDay(),o=this.subtract(24*(i-n),"hours");return Ie(o,{hour:e.hour(),minute:e.minute(),second:e.second()}),o},dayName:function(t){return void 0===t?Be()[this.day()]:this.clone().day(t)},month:function(t){if(void 0!==t){var e=this.clone();return e.epoch=function(t,e){"string"==typeof e&&(e=De()[e.toLowerCase()]),(e=_n(e))>=12&&(e=11),e<=0&&(e=0);var n=t.date();return n>Se[e]&&(n=Se[e]),Ie(t,{month:e,date:n}),t.epoch}(e,t),e}return this.d.getMonth()}},{dayOfYear:function(t){if(void 0!==t){var e=this.clone();return e.epoch=function(t,e){e=_n(e);var n=t.clone();return(e-=1)<=0?e=0:e>=365&&(e=364),t=(t=t.startOf("year")).add(e,"day"),wn(t,n,"hour"),t.epoch}(e,t),e}for(var n,i=0,o=this.d.getMonth(),a=1;a<=o;a++)(n=new Date).setDate(1),n.setFullYear(this.d.getFullYear()),n.setHours(1),n.setMinutes(1),n.setMonth(a),n.setHours(-2),i+=n.getDate();return i+this.d.getDate()},week:function(t){if(void 0!==t){var e=this.clone();return e=(e=(e=e.month(0)).date(1)).day("monday"),"december"===(e=Mn(e)).monthName()&&(e=e.add(1,"week")),e.add(t-=1,"weeks")}var n=this.clone();n=(n=n.month(0)).date(1),"december"===(n=(n=Mn(n)).day("monday")).monthName()&&(n=n.add(1,"week"));var i=1;1===n.date()&&(i=0),n=n.minus(1,"second");var o=this.epoch;if(n.epoch>o)return 1;var a=0,r=4*this.month();for(n.epoch+=Pe.week*r,a+=r;a<52;a++){if(n.epoch>o)return a+i;n=n.add(1,"week")}return 52},monthName:function(t){return void 0===t?Ee[this.month()]:this.clone().month(t)},quarter:function(t){if(void 0!==t&&("string"==typeof t&&(t=t.replace(/^q/i,""),t=parseInt(t,10)),mn[t])){var e=this.clone();return(e=(e=e.month(mn[t][0])).date(1)).startOf("day")}for(var n=this.d.getMonth(),i=1;i<mn.length;i++)if(n<mn[i][0])return i-1;return 4},season:function(t){var e="north";if("South"===this.hemisphere()&&(e="south"),void 0!==t){for(var n=this.clone(),i=0;i<dn[e].length;i++)t===dn[e][i][0]&&(n=(n=(n=n.month(dn[e][i][1])).date(1)).startOf("day"));return n}for(var o=this.d.getMonth(),a=0;a<dn[e].length-1;a++)if(o>=dn[e][a][1]&&o<dn[e][a+1][1])return dn[e][a][0];return"winter"},year:function(t){if(void 0!==t){var e=this.clone();return e.epoch=xn(e,t),e}return this.d.getFullYear()},era:function(t){if(void 0!==t){var e=this.clone();t=t.toLowerCase();var n=e.d.getFullYear();return"bc"===t&&n>0&&(e.epoch=xn(e,-1*n)),"ad"===t&&n<0&&(e.epoch=xn(e,-1*n)),e}return this.d.getFullYear()<0?"BC":"AD"},decade:function(t){if(void 0!==t){if(!(t=(t=(t=String(t)).replace(/([0-9])'?s$/,"$1")).replace(/([0-9])(th|rd|st|nd)/,"$1")))return console.warn("Spacetime: Invalid decade input"),this;2===t.length&&/[0-9][0-9]/.test(t)&&(t="19"+t);var e=Number(t);return isNaN(e)?this:(e=10*Math.floor(e/10),this.year(e))}return this.startOf("decade").year()},century:function(t){if(void 0!==t){"string"==typeof t&&(t=(t=(t=t.replace(/([0-9])(th|rd|st|nd)/,"$1")).replace(/([0-9]+) ?(b\.?c\.?|a\.?d\.?)/i,(function(t,e,n){return n.match(/b\.?c\.?/i)&&(e="-"+e),e}))).replace(/c$/,""));var e=Number(t);return isNaN(t)?(console.warn("Spacetime: Invalid century input"),this):(0===e&&(e=1),this.year(e=e>=0?100*(e-1):100*(e+1)))}var n=this.startOf("century").year();return(n=Math.floor(n/100))<0?n-1:n+1},millenium:function(t){if(void 0!==t){if("string"==typeof t&&(t=t.replace(/([0-9])(th|rd|st|nd)/,"$1"),t=Number(t),isNaN(t)))return console.warn("Spacetime: Invalid millenium input"),this;t>0&&(t-=1);var e=1e3*t;return 0===e&&(e=1),this.year(e)}var n=Math.floor(this.year()/1e3);return n>=0&&(n+=1),n}});kn.milliseconds=kn.millisecond,kn.seconds=kn.second,kn.minutes=kn.minute,kn.hours=kn.hour,kn.hour24=kn.hour,kn.h12=kn.hour12,kn.h24=kn.hour24,kn.days=kn.day;var Pn=["millisecond","second","minute","hour","date","month"],Vn={second:Pn.slice(0,1),minute:Pn.slice(0,2),quarterhour:Pn.slice(0,2),hour:Pn.slice(0,3),date:Pn.slice(0,4),month:Pn.slice(0,4),quarter:Pn.slice(0,4),season:Pn.slice(0,4),year:Pn,decade:Pn,century:Pn};Vn.week=Vn.hour,Vn.season=Vn.date,Vn.quarter=Vn.date;var Wn={year:!0,quarter:!0,season:!0,month:!0,week:!0,day:!0},In={month:!0,quarter:!0,season:!0,year:!0},zn={millisecond:function(t){return t.epoch},second:function(t){return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second()].join("-")},minute:function(t){return[t.year(),t.month(),t.date(),t.hour(),t.minute()].join("-")},hour:function(t){return[t.year(),t.month(),t.date(),t.hour()].join("-")},day:function(t){return[t.year(),t.month(),t.date()].join("-")},week:function(t){return[t.year(),t.week()].join("-")},month:function(t){return[t.year(),t.month()].join("-")},quarter:function(t){return[t.year(),t.quarter()].join("-")},year:function(t){return t.year()}};zn.date=zn.day;var En,jn=pe,Dn=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.epoch=null,this.tz=Me(e,jn),this.silent=n.silent||!0,this.british=n.dmy||n.british,this._weekStart=1,void 0!==n.weekStart&&(this._weekStart=n.weekStart),Object.defineProperty(this,"d",{get:function(){var t=ue(this),e=(new Date(this.epoch).getTimezoneOffset()||0)+60*t;return e=60*e*1e3,new Date(this.epoch+e)}}),Object.defineProperty(this,"timezones",{get:function(){return jn},set:function(t){return jn=t,t}}),void 0!==t||null===t){var i=Qe(this,t,e);this.epoch=i.epoch}};Object.keys(vn).forEach((function(t){Dn.prototype[t]=vn[t]})),Dn.prototype.clone=function(){return new Dn(this.epoch,this.tz,{silent:this.silent,weekStart:this._weekStart})},Dn.prototype.toLocalDate=function(){return new Date(this.epoch)},En=Dn,Object.keys(kn).forEach((function(t){En.prototype[t]=kn[t]})),function(t){t.prototype.add=function(t,e){var n=this.clone();if(!e||0===t)return n;var i=this.clone();e=re.normalize(e),Pe[e]?n.epoch+=Pe[e]*t:"week"===e?n.epoch+=Pe.day*(7*t):"quarter"===e||"season"===e?n.epoch+=Pe.month*(4*t):"season"===e?n.epoch+=Pe.month*(4*t):"quarterhour"===e&&(n.epoch+=15*Pe.minute*t);var o={};if(Vn[e]&&Vn[e].forEach((function(t){o[t]=i[t]()})),Wn[e]){var a=i.timezone().current.offset-n.timezone().current.offset;n.epoch+=3600*a*1e3}if("month"===e&&(o.month=i.month()+t,o=function(t,e){if(t.month>0){var n=parseInt(t.month/12,10);t.year=e.year()+n,t.month=t.month%12}else if(t.month<0){var i=Math.floor(Math.abs(t.month)/13,10);i=Math.abs(i)+1,t.year=e.year()-i,t.month=t.month%12,t.month=t.month+12,12===t.month&&(t.month=0)}return t}(o,i)),"week"===e){var r=i.date()+7*t;r<=28&&r>1&&(o.date=r)}else if("date"===e){var c=i.date()+t;c<=28&&c>1?o.date=c:0!==t&&i.isSame(n,"day")&&(o.date=i.date()+t)}else"year"===e&&n.year()===i.year()?n.epoch+=Pe.week:"decade"===e?o.year=n.year()+10:"century"===e&&(o.year=n.year()+100);if(In[e]){var s=Se[o.month];o.date=i.date(),o.date>s&&(o.date=s)}return Ie(n,o),n},t.prototype.subtract=function(t,e){return this.clone().add(-1*t,e)},t.prototype.minus=t.prototype.subtract,t.prototype.plus=t.prototype.add}(Dn),function(t){t.prototype.isSame=function(e,n){return n?("string"!=typeof e&&"number"!=typeof e||(e=new t(e,this.timezone.name)),n=n.replace(/s$/,""),zn[n]?zn[n](this)===zn[n](e):null):null}}(Dn),function(t){var e={isAfter:function(t){t=re.beADate(t,this);var e=re.getEpoch(t);return null===e?null:this.epoch>e},isBefore:function(t){t=re.beADate(t,this);var e=re.getEpoch(t);return null===e?null:this.epoch<e},isEqual:function(t){t=re.beADate(t,this);var e=re.getEpoch(t);return null===e?null:this.epoch===e},isBetween:function(t,e){t=re.beADate(t,this),e=re.beADate(e,this);var n=re.getEpoch(t);if(null===n)return null;var i=re.getEpoch(e);return null===i?null:n<this.epoch&&this.epoch<i}};Object.keys(e).forEach((function(n){t.prototype[n]=e[n]}))}(Dn),function(t){var e={i18n:function(t){var e;re.isObject(t.days)&&(Ue=(e=t.days).short||Ue,Ye=e.long||Ye),re.isObject(t.months)&&function(t){ze=t.short||ze,Ee=t.long||Ee}(t.months)}};Object.keys(e).forEach((function(n){t.prototype[n]=e[n]}))}(Dn);var Gn=Dn,Sn=function(t,e,n){return new Gn(t,e,n)};Sn.now=function(t,e){return new Gn((new Date).getTime(),t,e)},Sn.today=function(t,e){return new Gn((new Date).getTime(),t,e).startOf("day")},Sn.tomorrow=function(t,e){return new Gn((new Date).getTime(),t,e).add(1,"day").startOf("day")},Sn.yesterday=function(t,e){return new Gn((new Date).getTime(),t,e).subtract(1,"day").startOf("day")},Sn.extend=function(t){return Object.keys(t).forEach((function(e){Gn.prototype[e]=t[e]})),this},Sn.whereIts=function(t,e){var n=new Gn(null),i=new Gn(null);n=n.time(t),i=e?i.time(e):n.add(59,"minutes");var o=n.hour(),a=i.hour();return Object.keys(n.timezones).filter((function(t){if(-1===t.indexOf("/"))return!1;var e=new Gn(null,t),r=e.hour();return r>=o&&r<=a&&!(r===o&&e.minute()<n.minute())&&!(r===a&&e.minute()>i.minute())}))},Sn.version="6.4.1",Sn.plugin=Sn.extend;var Fn=Sn,An=n("d3UM"),Tn=n("FKr1");function qn(t,e){if(1&t&&(u.Wb(0,"div",8),u.Rb(1,"a-catering-order-item",9),u.Vb()),2&t){const t=e.$implicit,n=u.ic(2);u.Cb(1),u.oc("disabled",n.disabled)("symbol",n.symbol)("item",t)("field",n.items)}}function $n(t,e){if(1&t&&(u.Ub(0),u.Ec(1,qn,2,4,"div",7),u.Tb()),2&t){const t=u.ic();u.Cb(1),u.oc("ngForOf",t.category.items)}}const Nn=function(){return{class:"material-icons",content:"close"}};function Rn(t,e){1&t&&(u.Wb(0,"div",10),u.Wb(1,"div",11),u.Rb(2,"app-icon",3),u.Vb(),u.Wb(3,"div",12),u.Gc(4,"Category contains no available items"),u.Vb(),u.Vb()),2&t&&(u.Cb(2),u.oc("icon",u.pc(1,Nn)))}const Hn=function(){return{class:"material-icons",content:"arrow_back"}};let Qn=(()=>{class t{constructor(){this.close=new u.n}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=u.Kb({type:t,selectors:[["a-category-display"]],inputs:{category:"category",items:"items",symbol:"symbol",disabled:"disabled"},outputs:{close:"close"},decls:9,vars:5,consts:[[1,"header"],[1,"content"],["mat-icon-button","",3,"tapped"],[3,"icon"],[1,"name"],[4,"ngIf","ngIfElse"],["empty_state",""],["class","item",4,"ngFor","ngForOf"],[1,"item"],[3,"disabled","symbol","item","field"],[1,"info-block","center"],[1,"icon"],[1,"text"]],template:function(t,e){if(1&t&&(u.Wb(0,"div",0),u.Wb(1,"div",1),u.Wb(2,"button",2),u.ec("tapped",(function(){return e.close.emit()})),u.Rb(3,"app-icon",3),u.Vb(),u.Wb(4,"div",4),u.Gc(5),u.Vb(),u.Vb(),u.Vb(),u.Ec(6,$n,2,1,"ng-container",5),u.Ec(7,Rn,5,2,"ng-template",null,6,u.Fc)),2&t){const t=u.tc(8);u.Cb(3),u.oc("icon",u.pc(4,Hn)),u.Cb(2),u.Hc(null==e.category?null:e.category.name),u.Cb(1),u.oc("ngIf",e.category.items&&e.category.items.length)("ngIfElse",t)}},directives:[O.b,M.c,x.a,i.t,i.s,ee],styles:[".header[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;width:100%;background-color:#fff;border-bottom:1px solid #ccc;padding:.5em;z-index:1}.header[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;align-items:center;width:640px;max-width:100vw;margin:auto}.header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{flex:1;text-align:center;margin-right:3em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.item[_ngcontent-%COMP%]{position:relative;width:640px;margin:.5em auto;background-color:#fff;border:1px solid #ccc;border-radius:4px;overflow:hidden;max-width:calc(100vw - 1em);z-index:0}"]}),t})();function Un(t,e){if(1&t&&(u.Wb(0,"mat-option",17),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t),u.Cb(1),u.Ic(" ",t.name," ")}}function Yn(t,e){if(1&t&&(u.Wb(0,"mat-option",17),u.Gc(1),u.Vb()),2&t){const t=e.$implicit;u.oc("value",t.id),u.Cb(1),u.Ic(" ",t.name," ")}}function Ln(t,e){if(1&t&&(u.Wb(0,"div",9),u.Wb(1,"form",10),u.Wb(2,"div",11),u.Wb(3,"label"),u.Gc(4,"Deliver to:"),u.Vb(),u.Wb(5,"mat-form-field",12),u.Wb(6,"mat-select",13),u.Ec(7,Un,2,2,"mat-option",14),u.Vb(),u.Vb(),u.Vb(),u.Wb(8,"div",11),u.Wb(9,"label",15),u.Gc(10,"At:"),u.Vb(),u.Wb(11,"mat-form-field",12),u.Wb(12,"mat-select",16),u.Ec(13,Yn,2,2,"mat-option",14),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&t){const t=u.ic();u.Cb(1),u.oc("formGroup",t.form),u.Cb(6),u.oc("ngForOf",t.space_list),u.Cb(6),u.oc("ngForOf",t.available_times)}}function Bn(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",23),u.ec("tapped",(function(){u.wc(t);const n=e.$implicit;return u.ic(4).active_category=n})),u.Rb(1,"div",24),u.Wb(2,"div",25),u.Gc(3),u.Vb(),u.Vb()}if(2&t){const t=e.$implicit,n=u.ic(4);u.Dc("background-image","url("+t.image_path+")",u.Jb),u.oc("disabled",n.within_restricted_time&&!t.can_order_anytime),u.Cb(3),u.Hc(t.name)}}function Xn(t,e){if(1&t&&(u.Wb(0,"div",21),u.Ec(1,Bn,4,4,"button",22),u.Vb()),2&t){const t=u.ic(3);u.Cb(1),u.oc("ngForOf",t.category_list)}}function Kn(t,e){if(1&t&&(u.Ub(0),u.Ec(1,Xn,2,1,"div",20),u.Tb()),2&t){const t=u.ic(2),e=u.tc(9);u.Cb(1),u.oc("ngIf",t.can_order&&t.category_list.length)("ngIfElse",e)}}function Zn(t,e){if(1&t&&(u.Wb(0,"div",18),u.Ec(1,Kn,2,2,"ng-container",19),u.Vb()),2&t){const t=u.ic(),e=u.tc(13);u.Cb(1),u.oc("ngIf",!t.active_category)("ngIfElse",e)}}function Jn(t,e){if(1&t&&(u.Wb(0,"span",29),u.Gc(1),u.Vb()),2&t){const t=u.ic(2);u.Cb(1),u.Ic(" at least ",(null==t.active_building?null:t.active_building.catering_restricted_from)||"0"," hours in advance for meetings ")}}function ti(t,e){if(1&t&&(u.Wb(0,"div",26),u.Wb(1,"div",27),u.Rb(2,"img",28),u.Vb(),u.Wb(3,"p"),u.Gc(4," Catering is "),u.Wb(5,"span",29),u.Gc(6,"not available"),u.Vb(),u.Gc(7," for this booking."),u.Rb(8,"br"),u.Gc(9," Catering must be ordered within business hours "),u.Ec(10,Jn,2,1,"span",30),u.Gc(11),u.Vb(),u.Vb()),2&t){const t=u.ic();u.Cb(10),u.oc("ngIf",null==t.active_building?null:t.active_building.catering_restricted_from),u.Cb(1),u.Ic(" at ",null==t.active_building?null:t.active_building.name,". ")}}function ei(t,e){if(1&t&&(u.Wb(0,"div",18),u.Wb(1,"div",31),u.Wb(2,"div",27),u.Rb(3,"mat-spinner",32),u.Vb(),u.Wb(4,"div",33),u.Gc(5),u.Vb(),u.Vb(),u.Vb()),2&t){const t=u.ic();u.Cb(5),u.Ic("Loading menu for ",null==t.active_building?null:t.active_building.name,"...")}}function ni(t,e){if(1&t){const t=u.Xb();u.Wb(0,"a-category-display",34),u.ec("close",(function(){return u.wc(t),u.ic().active_category=null})),u.Vb()}if(2&t){const t=u.ic();u.oc("category",t.active_category)("symbol",t.symbol)("items",t.form.controls.items)("disabled",t.within_restricted_time)}}let ii=(()=>{class t extends s.a{constructor(t,e){super(),this._service=t,this._dialog=e,this.event=new u.n,this.category_list=[],this.available_times=[]}get can_order(){if(!this.form||!this.form.controls.space)return!1;const t=this.form.controls.space.value;return(this._service.Organisation.buildings.find(e=>e.id===t.level.building_id).has_catering||this.category_list.length)&&(!this.within_restricted_time||this.has_available_items)}get active_building(){if(!this.form||!this.form.controls.space)return null;const t=this.form.controls.space.value;return t?this._service.Organisation.buildings.find(e=>t.level.building_id===e.id):null}get symbol(){const t=this.active_building;return t&&t.currency||"USD"}get item_count(){return this.form?(this.form.controls.items.value||[]).reduce((t,e)=>t+e.amount,0):0}get out_of_hours(){return!!this.form&&this.form.controls.start.value<0}get within_restricted_time(){if(!this.form||!this.form.controls.space)return!1;const t=this.form.controls.space.value,e=this._service.Organisation.buildings.find(e=>e.id===t.level.building_id);if(!e.catering_restricted_from||e.catering_restricted_from<=0)return!1;const n=w(),i=w(this.date).subtract(e.catering_restricted_from,"h");return n.isAfter(i,"s")}get has_available_items(){return this.category_list.reduce((t,e)=>t||e.can_order_anytime,!1)}ngOnInit(){this.generateAvailableTimes(),this.loadMenu()}ngOnChanges(t){(t.date||t.duration)&&(this.generateAvailableTimes(),this.form&&!this.available_times.find(t=>t.id===this.form.controls.start.value)&&this.form.controls.start.setValue(this.available_times[0].id)),t.space_list&&this.form&&this.space_list&&!this.form.controls.space.value&&this.form.controls.space.setValue(this.space_list[0]),t.order&&this.order&&this.initForm()}initForm(){this.form=new a.i({id:new a.f(this.order.id),booking_date:new a.f(this.all_day?w(this.date).startOf("d").valueOf():this.date),space:new a.f(this._service.Spaces.item(this.order.location_id)||this.space_list[0]),location_id:new a.f(this.order.location_id||this.space_list[0].id),start:new a.f(this.order.delivery_time||this.available_times[0].id),items:new a.f((this.order.items||[]).map(t=>new Vt.a(t)))}),this.timeout("init_items",()=>this.form.controls.items.setValue((this.order.items||[]).map(t=>new Vt.a(t))),50),this.subscription("space_change",this.form.controls.space.valueChanges.subscribe(t=>{this.form.controls.location_id.setValue(t.id),this.generateAvailableTimes(),this.available_times.find(t=>t.id===this.form.controls.start.value)||this.form.controls.start.setValue(this.available_times[0].id),this.loadMenu()})),this.generateAvailableTimes(),this.form&&!this.available_times.find(t=>t.id===this.form.controls.start.value)&&this.form.controls.start.setValue(this.available_times[0].id)}confirmOrder(){const t=this._dialog.open(oe,{maxWidth:"95vw",data:{date:this.date,form:this.form}});this.subscription("confirm_event",t.componentInstance.event.subscribe(e=>{if("done"===e.reason){const e=new y.a(this.form.value);this.event.emit(e),t.close()}})),t.afterClosed().subscribe(()=>this.unsub("confirm_event"))}loadMenu(){const t=this.form.controls.space.value;t&&(this.form.controls.items.setValue([]),this.loading=!0,this._service.Menu.query({room_id:t.id}).then(t=>{this.loading=!1,this.category_list=(t||[]).map(t=>new Pt.a(t))},()=>this.loading=!1))}generateAvailableTimes(){const t=this.all_day?w(this.date).startOf("d"):w(this.date);let{start:e,end:n}=this.generateStartAndEndTimes();for(e=e.minute(5*Math.ceil(e.minute()/5)),this.available_times=[];e.isBefore(n);)this.available_times.push({id:Math.abs(t.diff(e,"m")),name:e.format("h:mm A")}),e=e.add(5,"m");0===this.available_times.length&&this.available_times.push({id:-1,name:"Out of hours"})}generateStartAndEndTimes(){let t=w(this.date);this.all_day&&(t=t.startOf("d"));let e=this.all_day?t.endOf("d"):t.add(this.duration,"m"),n=Fn(t.toDate());n=n.hour(7);const i=w(n.toLocalDate());if(console.log("Timezone start:",i.format("DD MMM, h:mm A")),t.isBefore(i,"m"))t=i,e=t.add(13,"h");else{const t=i.hour(20);console.log("Timezone end:",t.format("DD MMM, h:mm A")),e.isAfter(t)&&(e=t)}return{start:t,end:e}}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(c.a),u.Qb(_.b))},t.\u0275cmp=u.Kb({type:t,selectors:[["a-catering-order-details"]],inputs:{order:"order",date:"date",duration:"duration",space_list:"space_list",all_day:"all_day"},outputs:{event:"event"},features:[u.zb,u.Ab],decls:14,vars:5,consts:[[1,"catering","order-details"],["class","header",4,"ngIf"],["class","body",4,"ngIf","ngIfElse"],[1,"footer"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"disabled","tapped"],["empty_state",""],["load_state",""],["category_display",""],[1,"header"],[3,"formGroup"],[1,"field"],["appearance","outline"],["formControlName","space"],[3,"value",4,"ngFor","ngForOf"],["for",""],["formControlName","start"],[3,"value"],[1,"body"],[4,"ngIf","ngIfElse"],["class","contents",4,"ngIf","ngIfElse"],[1,"contents"],["mat-button","","class","category",3,"background-image","disabled","tapped",4,"ngFor","ngForOf"],["mat-button","",1,"category",3,"disabled","tapped"],[1,"overlay"],[1,"name"],[1,"empty-state","center"],[1,"icon"],["alt","No Catering Available","src","assets/img/no-catering.svg"],[1,"bold"],["class","bold",4,"ngIf"],[1,"info-block","center"],["diameter","48"],[1,"text"],[3,"category","symbol","items","disabled","close"]],template:function(t,e){if(1&t&&(u.Wb(0,"div",0),u.Ec(1,Ln,14,3,"div",1),u.Ec(2,Zn,2,2,"div",2),u.Wb(3,"div",3),u.Wb(4,"button",4),u.ec("tapped",(function(){return e.event.emit()})),u.Gc(5,"Back"),u.Vb(),u.Wb(6,"button",5),u.ec("tapped",(function(){return e.confirmOrder()})),u.Gc(7),u.Vb(),u.Vb(),u.Vb(),u.Ec(8,ti,12,2,"ng-template",null,6,u.Fc),u.Ec(10,ei,6,1,"ng-template",null,7,u.Fc),u.Ec(12,ni,1,4,"ng-template",null,8,u.Fc)),2&t){const t=u.tc(11);u.Cb(1),u.oc("ngIf",e.form),u.Cb(1),u.oc("ngIf",!e.loading)("ngIfElse",t),u.Cb(4),u.oc("disabled",!e.item_count||e.out_of_hours),u.Cb(1),u.Ic(" Confirm Order(",e.item_count||"0",") ")}},directives:[i.t,O.b,M.c,a.H,a.s,a.j,k.b,An.a,a.r,a.h,i.s,Tn.g,lt.c,Qn],styles:["[_nghost-%COMP%]{height:100%}.order-details[_ngcontent-%COMP%]{height:100%;margin:auto;max-width:100vw}.header[_ngcontent-%COMP%], .order-details[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;width:100%}.header[_ngcontent-%COMP%]{justify-content:center;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);z-index:99}.body[_ngcontent-%COMP%]{position:relative;flex:1;width:100%;min-height:50%;overflow:hidden auto}.footer[_ngcontent-%COMP%]{width:100%;text-align:center;border-top:1px solid #ccc;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:.5em}form[_ngcontent-%COMP%]{display:flex;align-items:center}.field[_ngcontent-%COMP%]{margin:0 .5em;max-height:3.5em}@media only screen and (orientation:portrait) and (max-width:450px){.field[_ngcontent-%COMP%]{max-height:4.75em}}@media only screen and (orientation:landscape) and (max-width:800px){.field[_ngcontent-%COMP%]{max-height:4.75em}}.contents[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;max-width:768px;margin:auto}.category[_ngcontent-%COMP%]{position:relative;background-position:50%;background-size:cover;height:11em;width:11em;margin:1em;border-radius:4px;border:none;padding:0;background-color:#fff;transition:box-shadow .2s}.category[_ngcontent-%COMP%]:hover{box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.category[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.35);border-radius:4px}.category[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:99;max-width:9em;white-space:normal;line-height:1.25em;margin:0}@media only screen and (orientation:portrait) and (max-width:450px){mat-form-field[_ngcontent-%COMP%]{width:11.75em}}@media only screen and (orientation:landscape) and (max-width:800px){mat-form-field[_ngcontent-%COMP%]{width:11.75em}}label[_ngcontent-%COMP%]{font-weight:500;font-size:.8em;margin-right:.75em}.empty-state[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;background-color:#fff;border-radius:4px;padding:1em;max-width:calc(100vw - 2em);box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.empty-state[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ce1a51}.empty-state[_ngcontent-%COMP%]   .bold[_ngcontent-%COMP%]{font-weight:400}.empty-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:6em;width:8em}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;max-width:24em}.info-block[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:2.5em;width:2.5em}"]}),t})();function oi(t,e){if(1&t){const t=u.Xb();u.Ub(0),u.Wb(1,"a-catering-order-list",3),u.ec("order",(function(e){u.wc(t);const n=u.ic();return e?n.active_order=e:n.newOrder()}))("event",(function(e){return u.wc(t),u.ic().event.emit(e)})),u.Vb(),u.Tb()}if(2&t){const t=u.ic();u.Cb(1),u.oc("catering",t.catering_field)("date",t.date)("all_day",t.all_day)}}function ai(t,e){if(1&t){const t=u.Xb();u.Wb(0,"a-catering-order-details",4),u.ec("event",(function(e){u.wc(t);const n=u.ic();return e?n.handleOrderEvent(e):n.active_order=null})),u.Vb()}if(2&t){const t=u.ic();u.oc("space_list",t.space_list)("order",t.active_order)("date",t.date)("duration",t.duration)("all_day",t.all_day)}}let ri=(()=>{class t{constructor(){this.event=new u.n}get catering_field(){return this.form?this.form.controls.catering:null}get space_list(){return this.form?this.form.controls.space_list.value:[]}get date(){return this.form?this.form.controls.date.value:w().valueOf()}get duration(){return this.form?this.form.controls.duration.value:60}get all_day(){return!!this.form&&this.form.controls.all_day.value}newOrder(){const t=new y.a({});this.active_order=t}handleOrderEvent(t){if(t){const e=this.form.controls.catering.value||[],n=e.findIndex(e=>t.id===e.id);n<0?e.push(t):e.splice(n,1,t),this.form.controls.catering.setValue(e)}this.active_order=null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=u.Kb({type:t,selectors:[["booking-catering"]],inputs:{form:"form"},outputs:{event:"event"},decls:4,vars:2,consts:[[1,"catering"],[4,"ngIf","ngIfElse"],["order_display",""],[3,"catering","date","all_day","order","event"],[3,"space_list","order","date","duration","all_day","event"]],template:function(t,e){if(1&t&&(u.Wb(0,"div",0),u.Ec(1,oi,2,3,"ng-container",1),u.Vb(),u.Ec(2,ai,1,5,"ng-template",null,2,u.Fc)),2&t){const t=u.tc(3);u.Cb(1),u.oc("ngIf",!e.active_order)("ngIfElse",t)}},directives:[i.t,kt,ii],styles:[".catering[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%;width:100%}"]}),t})();var ci=n("4Man");const si=["container"],ui=function(){return{class:"material-icons",content:"refresh"}};let li=(()=>{class t{constructor(){this.event=new u.n}next(){this.form.markAllAsTouched(),this.form.valid?this.event.emit({type:"next",step:"form"}):this.container&&this.container.nativeElement.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}previous(){this.event.emit({type:"previous",step:"form"})}resetForm(){this.event.emit({type:"reset",step:"form"})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=u.Kb({type:t,selectors:[["booking-spaces-form"]],viewQuery:function(t,e){var n;1&t&&u.Cc(si,!0),2&t&&u.sc(n=u.fc())&&(e.container=n.first)},inputs:{form:"form"},outputs:{event:"event"},decls:15,vars:4,consts:[[1,"booking-form"],["container",""],[1,"header"],["mat-icon-button","","name","reset",3,"tapped"],[3,"icon"],[3,"formGroup","ngSubmit"],[1,"body"],[3,"form"],[1,"footer"],["mat-button","","type","button",1,"inverse",3,"tapped"],["mat-button","","type","submit"]],template:function(t,e){1&t&&(u.Wb(0,"div",0,1),u.Wb(2,"div",2),u.Wb(3,"h3"),u.Gc(4,"New Booking"),u.Vb(),u.Wb(5,"button",3),u.ec("tapped",(function(){return e.resetForm()})),u.Rb(6,"app-icon",4),u.Vb(),u.Vb(),u.Wb(7,"form",5),u.ec("ngSubmit",(function(){return e.next()})),u.Wb(8,"div",6),u.Rb(9,"a-booking-form",7),u.Vb(),u.Wb(10,"div",8),u.Wb(11,"button",9),u.ec("tapped",(function(){return e.previous()})),u.Gc(12,"Back"),u.Vb(),u.Wb(13,"button",10),u.Gc(14,"Next"),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&t&&(u.Cb(6),u.oc("icon",u.pc(3,ui)),u.Cb(1),u.oc("formGroup",e.form),u.Cb(2),u.oc("form",e.form))},directives:[O.b,M.c,x.a,a.H,a.s,a.j,ci.a],styles:[".booking-form[_ngcontent-%COMP%]{width:768px;max-width:95vw;min-height:100%;background-color:#fff;margin:auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}form[_ngcontent-%COMP%]{padding:1em}.header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5em 1em;border-bottom:1px solid #f0f0f0}h3[_ngcontent-%COMP%]{min-width:50%;flex:1;margin:0}.footer[_ngcontent-%COMP%]{margin-top:1em;text-align:center}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:0 .5em}"]}),t})();function di(t,e){if(1&t){const t=u.Xb();u.Wb(0,"booking-find-space",5),u.ec("event",(function(e){return u.wc(t),u.ic(2).handleFlowEvent(e)})),u.Vb()}if(2&t){const t=u.ic(2);u.oc("spaces",t.form.controls.space_list)("form",t.form)}}function mi(t,e){if(1&t&&(u.Ub(0),u.Ec(1,di,1,2,"booking-find-space",4),u.Tb()),2&t){const t=u.ic();u.Cb(1),u.oc("ngIf",t.form)}}function hi(t,e){if(1&t){const t=u.Xb();u.Wb(0,"booking-catering",7),u.ec("event",(function(e){return u.wc(t),u.ic(2).handleFlowEvent(e)})),u.Vb()}if(2&t){const t=u.ic(2);u.oc("form",t.form)}}function fi(t,e){if(1&t&&(u.Ub(0),u.Ec(1,hi,1,1,"booking-catering",6),u.Tb()),2&t){const t=u.ic();u.Cb(1),u.oc("ngIf",t.form)}}function bi(t,e){if(1&t){const t=u.Xb();u.Wb(0,"booking-spaces-form",7),u.ec("event",(function(e){return u.wc(t),u.ic(2).handleFlowEvent(e)})),u.Vb()}if(2&t){const t=u.ic(2);u.oc("form",t.form)}}function gi(t,e){if(1&t&&(u.Ub(0),u.Ec(1,bi,1,1,"booking-spaces-form",6),u.Tb()),2&t){const t=u.ic();u.Cb(1),u.oc("ngIf",t.form)}}let pi=(()=>{class t extends s.a{constructor(t,e,n,i){super(),this._service=t,this._route=e,this._router=n,this._dialog=i}get available_fields(){return this._service.setting("app.booking.show_fields")||[]}ngOnInit(){this._service.initialised.pipe(Object(p.a)(t=>t)).subscribe(()=>{this.subscription("route.params",this._route.paramMap.subscribe(t=>{t.has("step")&&(this.flow_step=t.get("step"))})),this._service.Spaces.initialised.pipe(Object(p.a)(t=>t)).subscribe(()=>{this.loadFormData()})})}handleFlowEvent(t){"next"===t.type?this.toNextFlowStep(t):"previous"===t.type?this.toPreviousFlowStep(t):"reset"===t.type&&this.resetForm()}toNextFlowStep(t){const e=this.form.controls.space_list.value;switch(t.step){case"search":!e||!e.length||t.metadata&&t.metadata.ref&&"equipment"===t.metadata.ref?this.form.controls.has_catering&&this.form.controls.has_catering.value?this.navigate("catering"):(this.navigate("form"),this.confirmBooking()):this.openEquipmentDetailsModal();break;case"catering":const n=this.form.controls.catering.value;!n||!n.length||t.metadata&&t.metadata.ref&&"details"===t.metadata.ref?(this.navigate("form"),this.confirmBooking()):this.openCateringDetailsModal();break;default:this.form.controls.needs_space.value||e&&e.length?this.navigate("search"):this.confirmBooking()}}toPreviousFlowStep(t){switch(t.step){case"search":this.navigate("form");break;case"catering":this.navigate("search")}}navigate(t){this._router.navigate(["book","spaces",t],{queryParamsHandling:"preserve"}),this.flow_step=t}resetForm(){this.booking.clearPendingChanges(),delete this.form,this.form=Object(b.a)(this.booking,this._service.Users.current,this.available_fields)}loadFormData(){let t={};if(localStorage){const n=localStorage.getItem("ACA_STAFF.booking_form_data");if(n)try{t=JSON.parse(n)}catch(e){}}if(this.booking=new f.a(this._service.Bookings,t||{}),this.subscription("form_changes",this.booking.changeEvents.subscribe(()=>this.saveFormData())),this.form=Object(b.a)(this.booking,this._service.Users.current,this.available_fields),t&&!t.id)for(const n in t)this.form.controls[n]?this.form.controls[n].setValue(t[n]):this.booking.hasOwnProperty("")&&this.booking.storePendingChange(n,t[n]);t&&t.room_ids&&this.form.controls.space_list&&this.form.controls.space_list.setValue(t.room_ids.map(t=>this._service.Spaces.item(t)||{id:t,name:t}))}saveFormData(){localStorage&&this.booking&&localStorage.setItem("ACA_STAFF.booking_form_data",JSON.stringify(this.booking.toJSON(!0)))}openEquipmentDetailsModal(){const t=this._dialog.open(v.a,{maxWidth:"95vw",width:"32em",data:{spaces:this.form.controls.space_list.value,notes_field:this.form.controls.notes,codes_field:this.form.controls.equipment_codes,head_counts_field:this.form.controls.expected_attendees}});this.subscription("modal_events",t.componentInstance.event.subscribe(e=>{"done"===e.reason&&(this.toNextFlowStep({type:"next",step:"search",metadata:{ref:"equipment"}}),t.close())})),t.afterClosed().subscribe(()=>this.unsub("modal_events"))}openCateringDetailsModal(){const t=this._dialog.open(E,{maxWidth:"95vw",width:"32em",data:{spaces:this.form.controls.space_list.value,notes_field:this.form.controls.notes,catering:this.form.controls.catering}});this.subscription("modal_events",t.componentInstance.event.subscribe(e=>{"done"===e.reason&&(this.toNextFlowStep({type:"next",step:"catering",metadata:{ref:"details"}}),t.close())})),t.afterClosed().subscribe(()=>this.unsub("modal_events"))}confirmBooking(){this.booking.has_changes?this.form.valid&&this._dialog.open(g.a,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{booking:this.booking}}).componentInstance.event.subscribe(t=>{"success"===t.type&&this._router.navigate(["/schedule"])}):this._service.notifyInfo("No changes have been made to booking")}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(c.a),u.Qb(o.a),u.Qb(o.d),u.Qb(_.b))},t.\u0275cmp=u.Kb({type:t,selectors:[["booking-space-flow"]],features:[u.zb],decls:5,vars:3,consts:[[1,"space-flow"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"spaces","form","event",4,"ngIf"],[3,"spaces","form","event"],[3,"form","event",4,"ngIf"],[3,"form","event"]],template:function(t,e){1&t&&(u.Wb(0,"div",0),u.Ub(1,1),u.Ec(2,mi,2,1,"ng-container",2),u.Ec(3,fi,2,1,"ng-container",2),u.Ec(4,gi,2,1,"ng-container",3),u.Tb(),u.Vb()),2&t&&(u.Cb(1),u.oc("ngSwitch",e.flow_step),u.Cb(1),u.oc("ngSwitchCase","search"),u.Cb(1),u.oc("ngSwitchCase","catering"))},directives:[i.x,i.y,i.z,i.t,vt,ri,li],styles:[".space-flow[_ngcontent-%COMP%]{height:100%;overflow:auto}"]}),t})();var vi=n("1gA9"),_i=n("Nuht"),yi=n("DWOX"),wi=n("ocbO"),Ci=n("4Uey"),Oi=n("p5rm"),xi=n("q/nq"),Mi=n("4kJo"),ki=n("A+eD"),Pi=n("oTgu"),Vi=n("vJ8U"),Wi=n("1k4r"),Ii=n("5fZw"),zi=n("WE8N"),Ei=n("1DiH"),ji=n("CTJb"),Di=n("opQU"),Gi=n("zx1i"),Si=n("cH1L"),Fi=n("dNgK"),Ai=n("ihCf"),Ti=n("bv9b"),qi=n("/1cH"),$i=n("STbY"),Ni=n("q/DJ");n.d(e,"BookingsModule",(function(){return Hi}));const Ri=[{path:":flow",component:m},{path:":flow/:step",component:m},{path:"",redirectTo:"spaces"}];let Hi=(()=>{class t{}return t.\u0275mod=u.Ob({type:t}),t.\u0275inj=u.Nb({factory:function(e){return new(e||t)},imports:[[i.c,o.h.forChild(Ri),h.a,a.l,a.B,r.b]]}),t})();u.zc(m,[i.q,i.r,i.s,i.t,i.A,i.w,i.x,i.y,i.z,i.u,i.v,o.i,o.e,o.g,o.f,o.j,vi.d,vi.e,vi.f,M.b,M.c,_i.a,s.a,yi.a,x.a,wi.a,Ci.a,Oi.a,xi.a,Mi.a,ki.a,ci.a,Pi.a,Vi.a,Wi.a,Ii.a,zi.a,Ei.a,ji.a,Di.a,Gi.a,Rt.a,O.b,O.a,Si.b,Fi.b,_.e,_.d,_.i,_.f,_.c,k.a,k.b,k.e,k.f,k.g,k.h,k.i,Ai.b,Ai.c,P.a,P.c,lt.a,lt.c,Ti.a,qi.a,Tn.g,Tn.f,qi.d,qi.c,An.a,An.c,R.d,R.a,R.c,R.e,R.b,R.f,Tn.j,$i.e,$i.b,$i.d,$i.a,N.a,N.c,Nt.a,Nt.c,Wt.b,Wt.a,C.c,C.d,C.a,C.f,C.e,C.b,J.a,J.b,J.c,J.d,a.H,a.w,a.G,a.c,a.x,a.A,a.a,a.D,a.E,a.z,a.r,a.s,a.C,a.n,a.m,a.y,a.b,a.d,a.u,a.v,a.t,a.g,a.j,a.h,a.k,a.e,r.a,m,pi,li,vt,ut,Z,ri,kt,ii,wt,Qn,oe,ee,$t,v.a,E,ot],[i.b,i.G,i.p,i.k,i.E,i.g,i.C,i.F,i.d,i.f,i.i,i.j,i.l,Ni.b,Ni.c])}}]);