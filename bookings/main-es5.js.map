{"version":3,"sources":["webpack:///$_lazy_route_resource lazy namespace object","webpack:///src/app/app-routing.module.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.component.ts","webpack:///src/app/app.module.ts","webpack:///src/app/overlays/booking-modal/booking-modal.component.html","webpack:///src/app/overlays/booking-modal/booking-modal.component.ts","webpack:///src/app/overlays/confirm-modal/confirm-modal.component.html","webpack:///src/app/overlays/confirm-modal/confirm-modal.component.ts","webpack:///src/app/overlays/embedded-control-modal/embedded-control-modal.component.html","webpack:///src/app/overlays/embedded-control-modal/embedded-control-modal.component.ts","webpack:///src/app/overlays/overlays.module.ts","webpack:///src/app/services/app.service.ts","webpack:///src/app/services/data/base-api.class.ts","webpack:///src/app/services/data/base.service.ts","webpack:///src/app/services/data/bookings/booking.class.ts","webpack:///src/app/services/data/bookings/booking.utilities.ts","webpack:///src/app/services/data/bookings/bookings.service.ts","webpack:///src/app/services/data/organisation/building.class.ts","webpack:///src/app/services/data/organisation/organisation.class.ts","webpack:///src/app/services/data/organisation/organisation.service.ts","webpack:///src/app/services/data/polling/polling.service.ts","webpack:///src/app/services/data/spaces/space.class.ts","webpack:///src/app/services/data/spaces/space.utilities.ts","webpack:///src/app/services/data/spaces/spaces.service.ts","webpack:///src/app/services/data/systems-manager/systems-manager.service.ts","webpack:///src/app/services/data/users/user.class.ts","webpack:///src/app/services/data/users/user.utilities.ts","webpack:///src/app/services/data/users/users.service.ts","webpack:///src/app/services/hotkeys.service.ts","webpack:///src/app/services/settings.service.ts","webpack:///src/app/shared/base.class.ts","webpack:///src/app/shared/base.component.ts","webpack:///src/app/shared/components/duration-field/duration-field.component.html","webpack:///src/app/shared/components/duration-field/duration-field.component.ts","webpack:///src/app/shared/components/time-field/time-field.component.html","webpack:///src/app/shared/components/time-field/time-field.component.ts","webpack:///src/app/shared/components/user-search-field/user-search-field.component.html","webpack:///src/app/shared/components/user-search-field/user-search-field.component.ts","webpack:///src/app/shared/globals/application.ts","webpack:///src/app/shared/globals/form-fields.ts","webpack:///src/app/shared/globals/overlay-register.ts","webpack:///src/app/shared/mocks/index.ts","webpack:///src/app/shared/mocks/systems.mock.ts","webpack:///src/app/shared/shared.module.ts","webpack:///src/app/shared/utilities/api.utilities.ts","webpack:///src/app/shared/utilities/formatting.utilities.ts","webpack:///src/app/shared/utilities/general.utilities.ts","webpack:///src/app/shared/utilities/validation.utilities.ts","webpack:///src/app/shell/bootstrap/bootstrap.component.html","webpack:///src/app/shell/bootstrap/bootstrap.component.ts","webpack:///src/app/shell/panel-array/panel-array.component.html","webpack:///src/app/shell/panel-array/panel-array.component.ts","webpack:///src/app/shell/panel-select/panel-select.component.html","webpack:///src/app/shell/panel-select/panel-select.component.ts","webpack:///src/app/shell/panel/booking-actions/booking-actions.component.html","webpack:///src/app/shell/panel/booking-actions/booking-actions.component.ts","webpack:///src/app/shell/panel/custom-actions/custom-actions.component.html","webpack:///src/app/shell/panel/custom-actions/custom-actions.component.ts","webpack:///src/app/shell/panel/panel.component.html","webpack:///src/app/shell/panel/panel.component.ts","webpack:///src/app/shell/panel/space-details/space-details.component.html","webpack:///src/app/shell/panel/space-details/space-details.component.ts","webpack:///src/app/shell/panel/timeline/timeline.component.html","webpack:///src/app/shell/panel/timeline/timeline.component.ts","webpack:///src/app/shell/shell.component.html","webpack:///src/app/shell/shell.component.ts","webpack:///src/environments/environment.ts","webpack:///src/environments/version.ts","webpack:///src/main.ts"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","routes","path","component","children","redirectTo","AppRoutingModule","AppComponent","window","app_loaded","AppModule","console","log","production","BookingModalComponent","item","service","booking","Bookings","date","data","form_metadata","space_field","form_fields","find","field","key","space","setValue","date_field","valueOf","title_field","title","closing","timeout","close","fields","forEach","i","control","markAsDirty","valid","reduce","fields_valid","length","sub_fields_valid","sub_field","loading","post","on_error","map","push","config","content","ConfirmModalComponent","body","description","action","icon","EmbeddedControlModalComponent","countdown","control_url","interval","tick","OVERLAYS","SharedOverlaysModule","ApplicationService","_app_ref","_zone","_title","_router","_cache","_settings","_overlay","_composer","_analytics","_hotkeys","_systems","_organisation","_users","_bookings","_spaces","_polling","_route_trail","_subjects","_observers","parent","set","undefined","isStable","pipe","_","subscribe","run","_stable","setupCache","waitForSettings","registerOverlays","get","type","msg","on_action","notify","args","stream","force","query","route","Array","url","navigate","queryParams","preserveFragment","pop","name","getValue","next","value","asObservable","subscription","initialised","setup","init","unsub","setupComposer","enabled","setting","load","_initialised","debug","application","listen","clear","settings","protocol","location","host","domain","hostname","port","use_domain","origin","mock","scope","auth_uri","token_uri","redirect_uri","handle_login","local_login","localStorage","setItem","href","isEnabled","activateUpdate","available","event","current","hash","setInterval","checkForUpdate","reload","overlay","register","app_name","title_suffix","setTitle","getTitle","auth","api_endpoint","realtime","BaseDataClass","raw_data","changeEvents","zone_id","email","Math","floor","random","toLowerCase","_form_metadata","_form_fields","changed","changes","showErrors","form","formValues","update","add","task_name","parameters","task","initialiseFormFields","json","changed_fields","metadata","field_list","values","formChanges","edit","required","attributes","a","isValid","BaseAPIService","_subscribers","_promises","_compare","b","_list_filter","_name","_api_route","is_initialised","engine","endpoint","engine_endpoint","filterFn","list","query_params","update_list","cache","reject","result","http","d","process","results","updateList","form_data","new_item","analyticsEvent","post_data","_task","delay","stopPoll","sub","_poll","show","error","complete","put","removeItem","remove_ids","item_id","index","findIndex","splice","label","Analytics","raw_item","old_list","compareFn","new_list","mixed_list","found","Booking","_display","u_service","Users","icaluid","subject","Subject","start","start_epoch","Start","duration","end","end_epoch","End","diff","notes","visitors","catering","_attendees","attendees","organiser","organizer","owner","addFrom","_organiser","_location","format","time","_space_list","room_ids","u","form_settings","user","actions","validators","terms","requiredTrue","formatters","recurrence","custom_elements","defaults","process_field","f","control_type","references","refs","hide","flex","indexOf","now","isBefore","subtract","Spaces","space_names","level","BOOKING_COUNT","BOOKING_DATE","minute","startOf","setMockBookingStartDatetime","generateMockBooking","productName","fill","paragraph","city","getFreeBookingSlots","min_size","slots","sort","bkn_start","bkn_end","isAfter","getNextFreeBookingSlot","second","block","BookingsService","localeCompare","options","Overlay","open","toJSON","create","notifySuccess","notifyError","request","count","staff","num_staff","partners","num_partners","staff_id","period","Systems","exec","err","Building","zone","_extras","extras","extra_id","extra_name","_loan_items","loan_items","_levels","levels","level_id","level_name","_roles","roles","_lockers","lockers","locker_structure","systems","_phone_numbers","phone_numbers","longitude","latitude","_searchables","neighbourhoods","lvl","hasOwnProperty","lvl_features","feature","split","filter","Object","_zones","Organisation","OrganisationService","bld_id","buildings","building","bld","ids","bld_list","_active_building","getItem","loadOrganisation","loadBuildings","loadLevels","tags","org_data","shown_error","bld_data","lvl_data","PingHistory","history","last_ping","room_email","room_id","SECONDS","MINUTES","PollingService","OPTION_DEFAULTS","Space","_level","levelWithID","zones","long_name","map_id","book_type","can_search","searchable","can_control","controlable","hourly_rate","cost_hour","bookable","breakdown","capacity","was_available","raw_bookings","bookings","id_list","removeFrom","_linked_spaces","linked_rooms","linked_spaces","day","isSame","rm","bkn","status","booking_list","bookingsFor","SPACE_COUNT","generateMockSpace","firstName","lastName","linked","join","SpacesService","respond","available_spaces","j","v","SystemsManagerService","_list","state","_resources","sys_id","mod_id","bindings","loadSystems","offset","limit","total","last_total","User","first_name","last_name","windows_id","visitor","phone","mobile","business_unit","department","organisation","organisation_id","organisation_name","external","staff_code","fmno","_delegates","delegates","Location","desk","l","USER_COUNT","USER_DOMAIN","USER_EMAILS","generateMockUser","companyName","delegate_count","min","phoneNumber","UsersService","uhttp","token","expiry","endOf","client_id","hashStr","sessionStorage","go","headers","append","authorise","logout","tries","current_user","INVALID_STANDALONE_KEYS","HotkeysService","keydown_states","keydown_observers","combo_end","registered_combos","counter","addEventListener","mapKey","last_down","preventDefault","combo","combination","validCombination","last_key","updateCombinationEndList","presses","replace","key_list","non_meta","SettingsService","api","local","session","_app_name","build","built","core_version","version","loadFromFile","app","colors","file","file_name","BaseClass","_timers","_intervals","_subscriptions","fn","Function","clearTimeout","setTimeout","clearInterval","unsubscribe","BaseComponent","CustomDurationFieldComponent","group","block_size","controls","date_control","valueChanges","calculateAvailableDurations","room","space_control","updateDisplay","active_duration","new_opt","option","abs","max_duration","min_duration","slot","CustomTimeFieldComponent","calculateAvailableTimes","times","from_ref","active_time","ceil","date_str","book_ahead","hour","CustomUserSearchFieldComponent","filtered_list","search$","search_results$","searching","q","slice","search_str","match_name","match_email","FORM_FIELDS","OVERLAY_REGISTER","LETTERS","NUMBERS","SPACE_LIST","IMAGES","createSystem","touch_enabled","cancel_timeout","has_catering","system","room_name","today","unix","$start_meeting","last_meeting_started","$cancel_meeting","reason","$waiter_call","MOCK_SYSTEMS","USER_LIST","handlers","method","callback","COMPONENTS","ENTRY_COMPONENT","SharedContentModule","toQueryString","str","formatAttendeesWithHost","formatAttendees","attendee_str","users","formatDate","formatTime","formatPeriodWithDuration","t","formatPeriod","timestamp","parts","formatDuration","RECURRENCE_PERIODS","formatRecurrence","formatSpaces","getItemWithKeys","shift","isMobileDevice","r","navigator","userAgent","match","isMobileSafari","agent","isAndroidChrome","padZero","toString","unique","array","el","pos","arr","humaniseDuration","short","h","m","filterList","items","filters","word","regex","RegExp","item_list","JSON","parse","stringify","match_count","match_index","matched","matches","tokens","k","matchToHighlight","timeToDate","flatten","an_array","stack","res","reverse","HAS_ERROR","validateDate","is_from","from","message","buildValidateStartTime","c","validateStartTime","date_obj","buildValidateDuration","max","validateDuration","buildValidateAttendees","validateAttendees","invalid","BootstrapComponent","system_list","selected_system","queryParamMap","params","has","clearBootstrap","system_id","manual_input","bootstrap","loadList","checkBootstrapped","configure","BookingPanelArrayComponent","_service","is_ready","logo","inverse","BookingPanelSelectComponent","system_name","system_icon","system_status","active_system","reset","PanelBookingActionsComponent","no_booking","last_confirm","default_title","startMeeting","meeting","endMeeting","pending_timeout","business_start","business_end","last_started","is_endable","block_end","ask_end","confirmEnd","pending_start","pending_end","ask_start","confirmStart","PanelCustomActionsComponent","callWaiter","Date","toISOString","BookingPanelComponent","_route","show_time","interactive","paramMap","websocket","websocket_connected","space_name","hide_all","_status","show_title","can_cancel","last_cancel","status_overrides","updateStatus","PanelSpaceDetailsComponent","PanelTimelineComponent","time_blocks","generateTimelineBlocks","round","start_offset","in_use","checkBookings","todays_bookings","block_start","hide_status","block_time","ShellWrapperComponent","info_messages","message_index","page","events","updateMessage","reload_at_time","environment","VERSION"],"mappings":"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","file":"main-es5.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { ShellWrapperComponent } from './shell/shell.component';\r\nimport { BootstrapComponent } from './shell/bootstrap/bootstrap.component';\r\nimport { BookingPanelComponent } from './shell/panel/panel.component';\r\nimport { BookingPanelArrayComponent } from './shell/panel-array/panel-array.component';\r\nimport { BookingPanelSelectComponent } from './shell/panel-select/panel-select.component';\r\n\r\nconst routes: Routes = [\r\n    {\r\n        path: '',\r\n        component: ShellWrapperComponent,\r\n        children: [\r\n            { path: 'bootstrap', component: BootstrapComponent },\r\n            { path: 'panel/:system_id', component: BookingPanelComponent },\r\n            { path: 'panel-array', component: BookingPanelArrayComponent },\r\n            { path: 'panel-select', component: BookingPanelSelectComponent },\r\n            { path: '**', redirectTo: 'bootstrap' }\r\n        ]\r\n    },\r\n    { path: '**', redirectTo: 'bootstrap' }\r\n];\r\n\r\n@NgModule({\r\n    imports: [RouterModule.forRoot(routes, { useHash: true })],\r\n    exports: [RouterModule]\r\n})\r\nexport class AppRoutingModule {}\r\n","<div class=\"app\">\r\n    <router-outlet></router-outlet>\r\n</div>\r\n","import { Component, ViewEncapsulation } from '@angular/core';\r\n\r\n@Component({\r\n    selector: 'app-root',\r\n    templateUrl: './app.component.html',\r\n    styleUrls: ['./styles/app.component.scss', './styles/custom-element.styles.scss', './styles/native-element.styles.scss'],\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\nexport class AppComponent {\r\n    constructor() {\r\n        (window as any).app_loaded = true;\r\n    }\r\n}\r\n","import { BrowserModule } from '@angular/platform-browser';\r\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\r\nimport { NgModule } from '@angular/core';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport './shared/mocks';\r\n\r\nimport { ComposerModule } from '@acaprojects/ngx-composer';\r\nimport { AGoogleAnalyticsModule } from '@acaprojects/ngx-google-analytics';\r\n\r\nimport { AppRoutingModule } from './app-routing.module';\r\nimport { AppComponent } from './app.component';\r\nimport { ServiceWorkerModule } from '@angular/service-worker';\r\nimport { environment } from '../environments/environment';\r\n\r\nimport { SharedOverlaysModule } from './overlays/overlays.module';\r\nimport { SharedContentModule } from './shared/shared.module';\r\n\r\nimport { ShellWrapperComponent } from './shell/shell.component';\r\nimport { BootstrapComponent } from './shell/bootstrap/bootstrap.component';\r\nimport { BookingPanelComponent } from './shell/panel/panel.component';\r\nimport { PanelTimelineComponent } from './shell/panel/timeline/timeline.component';\r\nimport { PanelSpaceDetailsComponent } from './shell/panel/space-details/space-details.component';\r\nimport { PanelBookingActionsComponent } from './shell/panel/booking-actions/booking-actions.component';\r\nimport { PanelCustomActionsComponent } from './shell/panel/custom-actions/custom-actions.component';\r\nimport { BookingPanelArrayComponent } from './shell/panel-array/panel-array.component';\r\nimport { BookingPanelSelectComponent } from './shell/panel-select/panel-select.component';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        AppComponent,\r\n        ShellWrapperComponent,\r\n        BootstrapComponent,\r\n        BookingPanelComponent,\r\n        PanelTimelineComponent,\r\n        PanelSpaceDetailsComponent,\r\n        PanelBookingActionsComponent,\r\n        PanelCustomActionsComponent,\r\n        BookingPanelArrayComponent,\r\n        BookingPanelSelectComponent\r\n    ],\r\n    imports: [\r\n        BrowserModule,\r\n        BrowserAnimationsModule,\r\n        AppRoutingModule,\r\n        HttpClientModule,\r\n        FormsModule,\r\n        ComposerModule,\r\n        AGoogleAnalyticsModule,\r\n        SharedOverlaysModule,\r\n        SharedContentModule,\r\n        ServiceWorkerModule.register('ngsw-worker.js', { enabled: environment.production })\r\n    ],\r\n    providers: [],\r\n    bootstrap: [AppComponent]\r\n})\r\nexport class AppModule {\r\n    constructor() {\r\n        console.log('Production:', !!environment.production);\r\n    }\r\n}\r\n","<div class=\"modal booking\" widget [class.is-loading]=\"loading\" [@show] *ngIf=\"!closing\">\r\n    <div class=\"header\">\r\n        <div class=\"text\">New Booking</div>\r\n    </div>\r\n    <div class=\"body\" *ngIf=\"!loading\">\r\n        <div class=\"form\" *ngIf=\"booking\">\r\n            <a-dynamic-form [fields]=\"booking.form_fields\"></a-dynamic-form>\r\n        </div>\r\n    </div>\r\n    <div class=\"body\" *ngIf=\"loading\">\r\n        <div class=\"info-block\">\r\n            <div class=\"icon\">\r\n                <a-spinner circle-ring color=\"#000\"></a-spinner>\r\n            </div>\r\n            <div class=\"text\">Processing request...</div>\r\n        </div>\r\n    </div>\r\n    <div class=\"footer\" *ngIf=\"!loading\">\r\n        <button widget name=\"close\" (tapped)=\"close()\">Cancel</button>\r\n        <button widget name=\"save\" (tapped)=\"save()\">Save</button>\r\n    </div>\r\n</div>","import { Component, OnInit } from '@angular/core';\r\nimport { animate, style, transition, trigger } from '@angular/animations';\r\nimport { OverlayItem } from '@acaprojects/ngx-overlays';\r\n\r\nimport { ApplicationService } from '../../services/app.service';\r\nimport { BaseComponent } from '../../shared/base.component';\r\nimport { Booking } from '../../services/data/bookings/booking.class';\r\nimport { OVERLAY_REGISTER } from '../../shared/globals/overlay-register';\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\nexport interface BookingData {\r\n    booking: Booking;\r\n    on_error: () => void;\r\n    close: () => void;\r\n}\r\n\r\n@Component({\r\n    selector: 'booking-modal',\r\n    templateUrl: './booking-modal.component.html',\r\n    styleUrls: ['./booking-modal.component.scss'],\r\n    animations: [\r\n        trigger('show', [\r\n            transition(':enter', [\r\n                style({ opacity: 0, transform: 'translateX(100%) scale(0)' }),\r\n                animate(200, style({ opacity: 1, transform: 'translateX(0%) scale(1)' }))\r\n            ]),\r\n            transition(':leave', [\r\n                style({ opacity: 1, transform: 'translateX(0%) scale(1)' }),\r\n                animate(\r\n                    200,\r\n                    style({\r\n                        opacity: 0,\r\n                        transform: 'translateX(-100%) scale(0)'\r\n                    })\r\n                )\r\n            ])\r\n        ])\r\n    ]\r\n})\r\nexport class BookingModalComponent extends BaseComponent implements OnInit {\r\n    /** Whether modal is closing */\r\n    public closing: boolean;\r\n    /** New Booking instance */\r\n    public booking: Booking;\r\n    /** Whether the modal is processing a booking request */\r\n    public loading: boolean;\r\n\r\n    constructor(private item: OverlayItem, private service: ApplicationService) {\r\n        super();\r\n    }\r\n\r\n    public ngOnInit(): void {\r\n        this.booking = new Booking(this.service.Bookings, {\r\n            date: this.item.data.date,\r\n            form_metadata: { ...this.item.data }\r\n        });\r\n        const space_field = this.booking.form_fields.find(field => field.key === 'space');\r\n        if (this.item.data.space && space_field) {\r\n            space_field.setValue(this.item.data.space);\r\n        }\r\n        const date_field = this.booking.form_fields.find(field => field.key === 'date');\r\n        if (date_field) {\r\n            date_field.setValue(this.item.data.date || dayjs().valueOf());\r\n        }\r\n        const title_field = this.booking.form_fields.find(field => field.key === 'title');\r\n        if (title_field) {\r\n            title_field.setValue(this.item.data.title || '');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Closes the modal\r\n     */\r\n    public close() {\r\n        this.closing = true;\r\n        this.timeout('close', () => this.item.close());\r\n    }\r\n\r\n    /**\r\n     * Post form data\r\n     */\r\n    public save() {\r\n        const fields = this.booking.form_fields;\r\n        fields.forEach(i => i.control.markAsDirty());\r\n        const valid = fields.reduce(\r\n            (fields_valid, field) =>\r\n                fields_valid &&\r\n                (field.control.valid ||\r\n                    (field.children &&\r\n                        field.children.length &&\r\n                        field.children.reduce(\r\n                            (sub_fields_valid, sub_field) => sub_fields_valid && sub_field.control.valid,\r\n                            true\r\n                        ))),\r\n            true\r\n        );\r\n        if (this.booking && valid) {\r\n            this.loading = true;\r\n            this.item.post('finish', {\r\n                booking: this.booking,\r\n                on_error: () => (this.loading = false),\r\n                close: () => this.close()\r\n            });\r\n        } else {\r\n            console.log(\r\n                'Invalid form fields. Valid states:',\r\n                fields.map(field => `${field.key}:${field.control.valid}`)\r\n            );\r\n        }\r\n    }\r\n}\r\n\r\nOVERLAY_REGISTER.push({\r\n    id: 'booking',\r\n    config: { content: BookingModalComponent, config: 'modal' }\r\n});\r\n","<div class=\"confirm modal\" widget [@show] *ngIf=\"!closing\">\r\n    <div class=\"header\">\r\n        <div class=\"text\">{{ title || 'Confirm' }}</div>\r\n    </div>\r\n    <div class=\"body\">\r\n        <div class=\"icon\" *ngIf=\"icon\">\r\n            <i *ngIf=\"icon.class\" [class]=\"icon.class\">{{ icon.value }}</i>\r\n            <img *ngIf=\"!icon.class && icon.src\" [src]=\"icon.src\">\r\n        </div>\r\n        <div class=\"content\">\r\n            <p>{{ content || 'Are you sure?' }}</p>\r\n        </div>\r\n    </div>\r\n    <div class=\"footer\">\r\n        <button widget name=\"cancel\" (tapped)=\"close()\">Cancel</button>\r\n        <button widget name=\"accept\" (tapped)=\"accept()\">{{ action || 'Ok' }}</button>\r\n    </div>\r\n</div>","import { Component, OnInit } from '@angular/core';\r\nimport { animate, style, transition, trigger } from '@angular/animations';\r\n\r\nimport { OverlayItem } from '@acaprojects/ngx-overlays';\r\n\r\nimport { BaseComponent } from '../../shared/base.component';\r\nimport { OVERLAY_REGISTER } from '../../shared/globals/overlay-register';\r\n\r\n@Component({\r\n    selector: 'confirm-modal',\r\n    templateUrl: './confirm-modal.component.html',\r\n    styleUrls: ['./confirm-modal.component.scss'],\r\n    animations: [\r\n        trigger('show', [\r\n            transition(':enter', [\r\n                style({ opacity: 0, transform: 'translateX(100%) scale(0)' }),\r\n                animate(200, style({ opacity: 1, transform: 'translateX(0%) scale(1)' }))\r\n            ]),\r\n            transition(':leave', [\r\n                style({ opacity: 1, transform: 'translateX(0%) scale(1)' }),\r\n                animate(200, style({ opacity: 0, transform: 'translateX(-100%) scale(0)' }))\r\n            ])\r\n        ])\r\n    ]\r\n})\r\nexport class ConfirmModalComponent extends BaseComponent implements OnInit {\r\n    /** Title of the confirm modal */\r\n    public title: string;\r\n    /** Body of the confirm modal */\r\n    public content: string;\r\n    /** Display text on the confirm button */\r\n    public action: string;\r\n    /** Display icon properties */\r\n    public icon: { class?: string; value?: string; src?: string };\r\n    /** Whether modal is closing */\r\n    public closing: boolean;\r\n\r\n    constructor(private item: OverlayItem) {\r\n        super();\r\n    }\r\n\r\n    public ngOnInit(): void {\r\n        const data = this.item.data;\r\n        if (data) {\r\n            this.title = data.title || 'Confirm';\r\n            this.content = data.content || data.body || data.description || 'Confirm';\r\n            this.action = data.action || 'Ok';\r\n            this.icon = data.icon;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Close the modal\r\n     */\r\n    public close() {\r\n        this.closing = true;\r\n        this.timeout('close', () => this.item.close());\r\n\r\n    }\r\n\r\n    /**\r\n     * User confirmation of the content of the modal\r\n     */\r\n    public accept() {\r\n        this.item.post('finish');\r\n        this.close();\r\n    }\r\n}\r\n\r\nOVERLAY_REGISTER.push({ id: 'confirm', config: { content: ConfirmModalComponent, config: 'modal' } });\r\n","<div class=\"background\"></div>\r\n<div class=\"modal control\" [@show] (window:touchend)=\"reset()\" (window:mouseup)=\"reset()\">\r\n    <div class=\"control-frame\">\r\n        <iframe [src]=\"control_url | safe:'resource'\"></iframe>\r\n    </div>\r\n</div>\r\n<div class=\"overlay\">\r\n    <button widget class=\"action countdown\" (tapped)=\"reset()\" (contextmenu)=\"$event.preventDefault()\">{{ countdown }}</button>\r\n    <button widget class=\"action close\" (tapped)=\"close()\" (contextmenu)=\"$event.preventDefault()\">\r\n        <div class=\"icon\">\r\n            <i class=\"material-icons\">close</i>\r\n        </div>\r\n    </button>\r\n</div>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { animate, keyframes, state, style, transition, trigger } from '@angular/animations';\r\n\r\nimport { OverlayItem } from '@acaprojects/ngx-overlays';\r\n\r\nimport { BaseComponent } from '../../shared/base.component';\r\nimport { OVERLAY_REGISTER } from '../../shared/globals/overlay-register';\r\n\r\n@Component({\r\n    selector: 'embedded-control-modal',\r\n    templateUrl: './embedded-control-modal.component.html',\r\n    styleUrls: ['./embedded-control-modal.component.scss'],\r\n    animations: [\r\n        trigger('show', [\r\n            transition(':enter', [style({ opacity: 0 }), animate(500, style({ opacity: 1 }))]),\r\n            transition(':leave', [style({ opacity: 1 }), animate(1000, style({ opacity: 0 }))]),\r\n        ]),\r\n    ],\r\n})\r\nexport class EmbeddedControlModalComponent extends BaseComponent implements OnInit {\r\n    /** Control URL to embed into the modal */\r\n    public control_url: string;\r\n    /** Display value for the time remain until the modal automatically closes */\r\n    public countdown: number;\r\n\r\n    constructor(private item: OverlayItem) {\r\n        super();\r\n        this.countdown = 30;\r\n    }\r\n\r\n    public ngOnInit(): void {\r\n        const data = this.item.data;\r\n        if (data) {\r\n            this.control_url = data.control_url;\r\n        }\r\n        if (!this.control_url) {\r\n            this.close();\r\n        }\r\n        this.countdown = 30;\r\n        this.interval('countdown', () => this.tick(), 1000);\r\n    }\r\n\r\n    /**\r\n     * Close the modal\r\n     */\r\n    public close() {\r\n        this.item.close();\r\n        this.countdown = 30;\r\n    }\r\n\r\n    /**\r\n     * User confirmation of the content of the modal\r\n     */\r\n    public reset() {\r\n        this.countdown = 30;\r\n        this.interval('countdown', () => this.tick(), 1000);\r\n    }\r\n\r\n    /**\r\n     * Decrement countdown and close if 0\r\n     */\r\n    public tick() {\r\n        if (this.countdown <= 0) {\r\n            this.close();\r\n        }\r\n        this.countdown--;\r\n    }\r\n}\r\n\r\nOVERLAY_REGISTER.push({ id: 'embeded-control', config: { content: EmbeddedControlModalComponent, config: 'modal' } });\r\n","\r\nimport { NgModule, Type } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { SharedContentModule } from '../shared/shared.module';\r\n\r\nimport { ConfirmModalComponent } from './confirm-modal/confirm-modal.component';\r\nimport { EmbeddedControlModalComponent } from './embedded-control-modal/embedded-control-modal.component';\r\nimport { BookingModalComponent } from './booking-modal/booking-modal.component';\r\n\r\nconst OVERLAYS: Type<any>[] = [\r\n    ConfirmModalComponent,\r\n    EmbeddedControlModalComponent,\r\n    BookingModalComponent\r\n];\r\n\r\n@NgModule({\r\n    declarations: [\r\n        ...OVERLAYS\r\n    ],\r\n    imports: [\r\n        CommonModule,\r\n        SharedContentModule\r\n    ],\r\n    exports: [\r\n        ...OVERLAYS\r\n    ],\r\n    entryComponents: [\r\n        ...OVERLAYS\r\n    ]\r\n})\r\nexport class SharedOverlaysModule {}\r\n","import { ApplicationRef, Injectable, NgZone } from '@angular/core';\r\nimport { Title } from '@angular/platform-browser';\r\nimport { Router } from '@angular/router';\r\nimport { SwUpdate } from '@angular/service-worker';\r\n\r\nimport { ComposerService } from '@acaprojects/ngx-composer';\r\nimport { ComposerOptions } from '@acaprojects/ts-composer';\r\nimport { AOverlayService } from '@acaprojects/ngx-overlays';\r\nimport { GoogleAnalyticsService } from '@acaprojects/ngx-google-analytics';\r\n\r\nimport { Observable, BehaviorSubject, Subject, Subscription } from 'rxjs';\r\n\r\nimport { BaseClass } from '../shared/base.class';\r\nimport { SettingsService, ConsoleStream } from './settings.service';\r\nimport { HashMap } from '../shared/utilities/types.utilities';\r\n\r\nimport { OVERLAY_REGISTER } from '../shared/globals/overlay-register';\r\nimport { ComposerSettings } from '../shared/utilities/settings.interfaces';\r\n\r\nimport { HotkeysService } from './hotkeys.service';\r\nimport { OrganisationService } from './data/organisation/organisation.service';\r\nimport { UsersService } from './data/users/users.service';\r\nimport { BookingsService } from './data/bookings/bookings.service';\r\nimport { SpacesService } from './data/spaces/spaces.service';\r\nimport { SystemsManagerService } from './data/systems-manager/systems-manager.service';\r\nimport { PollingService } from './data/polling/polling.service';\r\nimport { first } from 'rxjs/operators';\r\n\r\ndeclare global {\r\n    interface Window {\r\n        application: ApplicationService;\r\n        mock: {\r\n            enabled: boolean;\r\n            backend: any;\r\n        };\r\n    }\r\n}\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class ApplicationService extends BaseClass {\r\n    /** List of previous routes for return navigation */\r\n    private _route_trail: string[] = [];\r\n    /** Map of state variables for Service */\r\n    protected _subjects: { [key: string]: BehaviorSubject<any> | Subject<any> } = {};\r\n    /** Map of observables for state variables */\r\n    protected _observers: { [key: string]: Observable<any> } = {};\r\n    /** Whether the application has stablised */\r\n    private _stable: boolean;\r\n\r\n    /** Whether the application has stablised */\r\n    public get is_stable(): boolean {\r\n        return this._stable || false;\r\n    }\r\n\r\n    constructor(\r\n        private _app_ref: ApplicationRef,\r\n        private _zone: NgZone,\r\n        private _title: Title,\r\n        private _router: Router,\r\n        private _cache: SwUpdate,\r\n        private _settings: SettingsService,\r\n        private _overlay: AOverlayService,\r\n        private _composer: ComposerService,\r\n        private _analytics: GoogleAnalyticsService,\r\n        private _hotkeys: HotkeysService,\r\n        private _systems: SystemsManagerService,\r\n        private _organisation: OrganisationService,\r\n        private _users: UsersService,\r\n        private _bookings: BookingsService,\r\n        private _spaces: SpacesService,\r\n        private _polling: PollingService\r\n    ) {\r\n        super();\r\n        this._organisation.parent = this._users.parent = this._bookings.parent\r\n            = this._spaces.parent = this._systems.parent = this._polling.parent = this;\r\n        this.set('system', null);\r\n        this.log('APP', `Waiting for Application to stablised...`, undefined, undefined, true);\r\n        this._app_ref.isStable.pipe(first(_ => _)).subscribe(() => {\r\n            this.log('APP', `Application has stablised.`, undefined, undefined, true);\r\n            this._zone.run(() => {\r\n                this._stable = true;\r\n                this.setupCache();\r\n                this.waitForSettings();\r\n                this.registerOverlays();\r\n            });\r\n        });\r\n    }\r\n\r\n    /** Overlay service */\r\n    public get Overlay(): AOverlayService {\r\n        return this._overlay;\r\n    }\r\n\r\n    /** Analytics service */\r\n    public get Analytics() {\r\n        return this._analytics;\r\n    }\r\n\r\n    /** Hotkeys service */\r\n    public get Hotkeys() {\r\n        return this._hotkeys;\r\n    }\r\n\r\n    /** Systems Manager service */\r\n    public get Systems() {\r\n        return this._systems;\r\n    }\r\n\r\n    /** Organisation service */\r\n    public get Organisation() {\r\n        return this._organisation;\r\n    }\r\n\r\n    /** Users service */\r\n    public get Users() {\r\n        return this._users;\r\n    }\r\n\r\n    /** Bookings service */\r\n    public get Bookings() {\r\n        return this._bookings;\r\n    }\r\n\r\n    /** Spaces service */\r\n    public get Spaces() {\r\n        return this._spaces;\r\n    }\r\n\r\n    /**\r\n     * Get a setting from the settings service\r\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\r\n     */\r\n    public setting(key: string): any {\r\n        return this._settings.get(key);\r\n    }\r\n\r\n    /** Name of the application */\r\n    public get name() {\r\n        return this._settings.app_name;\r\n    }\r\n\r\n    /**\r\n     * Title of the page\r\n     */\r\n    public set title(value: string) {\r\n        const title_suffix = this.setting('app.title');\r\n        this._title.setTitle(`${value ? value + ' | ' : ''}${title_suffix}`);\r\n    }\r\n\r\n    /**\r\n     * Title of the page\r\n     */\r\n    public get title(): string {\r\n        return this._title.getTitle();\r\n    }\r\n\r\n    /** Root API Endpoint */\r\n    public get endpoint() {\r\n        return `/api/staff/`;\r\n    }\r\n\r\n    /** Root API Endpoint for engine */\r\n    public get engine_endpoint() {\r\n        return `${this._composer.auth.api_endpoint}/`;\r\n    }\r\n\r\n    /** Get websocket */\r\n    public get websocket() {\r\n        return this._composer.realtime;\r\n    }\r\n\r\n    /**\r\n     * Create notification popup\r\n     * @param type CSS Class to add to the notification\r\n     * @param msg Message to display on the notificaiton\r\n     * @param action Display text for the callback action\r\n     * @param on_action Callback of action on the notification\r\n     */\r\n    public notify(type: string, msg: string, action?: string, on_action?: () => void): void {\r\n        const content = `<div class=\"icon\"><i class=\"material-icons\"></i></div><div class=\"text\">${msg}</div>`;\r\n        this._overlay.notify(content, action, on_action, type);\r\n    }\r\n\r\n    /**\r\n     * Create success notification popup\r\n     * @param msg Message to display on the notificaiton\r\n     * @param action Display text for the callback action\r\n     * @param on_action Callback of action on the notification\r\n     */\r\n    public notifySuccess(msg: string, action?: string, on_action?: () => void): void {\r\n        this.notify('success', msg, action, on_action);\r\n    }\r\n\r\n    /**\r\n     * Create success notification popup\r\n     * @param msg Message to display on the notificaiton\r\n     * @param action Display text for the callback action\r\n     * @param on_action Callback of action on the notification\r\n     */\r\n    public notifyError(msg: string, action?: string, on_action?: () => void): void {\r\n        this.notify('error', msg, action, on_action);\r\n    }\r\n\r\n    /**\r\n     * Create info notification popup\r\n     * @param msg Message to display on the notificaiton\r\n     * @param action Display text for the callback action\r\n     * @param on_action Callback of action on the notification\r\n     */\r\n    public notifyInfo(msg: string, action?: string, on_action?: () => void): void {\r\n        this.notify('info', msg, action, on_action);\r\n    }\r\n\r\n    /**\r\n     * Log data to the browser console\r\n     * @param type Type of message\r\n     * @param msg Message body\r\n     * @param args array of argments to log to the console\r\n     * @param stream Stream to emit the console on. 'debug', 'log', 'warn' or 'error'\r\n     * @param force Whether to force message to be emitted when debug is disabled\r\n     */\r\n    public log(type: string, msg: string, args?: any, stream: ConsoleStream = 'debug', force: boolean = false): void {\r\n        this._settings.log(type, msg, args, stream, force);\r\n    }\r\n\r\n    /**\r\n     * Navigate to the given path\r\n     * @param path Path or array of path parts\r\n     * @param query Key value pairs to add to the URL as query parameters\r\n     */\r\n    public navigate(path: string | string[], query?: HashMap): void {\r\n        const route = path instanceof Array ? [...path] : [path];\r\n        this._route_trail.push(this._router.url);\r\n        this._router.navigate(route, query ? { queryParams: query } : { preserveFragment: true });\r\n    }\r\n\r\n    /**\r\n     * Navigate to the previous location in the route trail\r\n     */\r\n    public navigateBack(): void {\r\n        if (this._route_trail && this._route_trail.length > 0) {\r\n            const path = this._route_trail.pop();\r\n            this._router.navigate([path]);\r\n        } else {\r\n            this._router.navigate(['']);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the current value of the named property\r\n     * @param name Property name\r\n     */\r\n    public get<U = any>(name: string): U {\r\n        return this._subjects[name] && this._subjects[name] instanceof BehaviorSubject\r\n            ? (this._subjects[name] as BehaviorSubject<U>).getValue()\r\n            : null;\r\n    }\r\n\r\n\r\n    /**\r\n     * Listen to value change of the named property\r\n     * @param name Property name\r\n     * @param next Callback for value changes\r\n     */\r\n    public listen<U = any>(name: string, next: (_: U) => void): Subscription {\r\n        return this._observers[name] ? this._observers[name].subscribe(next) : null;\r\n    }\r\n\r\n    /**\r\n     * Update the value of the named property\r\n     * @param name Property name\r\n     * @param value New value\r\n     */\r\n    public set<U = any>(name: string, value: U): void {\r\n        if (!this._subjects[name]) {\r\n            this._subjects[name] = new BehaviorSubject<U>(value);\r\n            this._observers[name] = this._subjects[name].asObservable();\r\n        } else {\r\n            this._subjects[name].next(value);\r\n        }\r\n    }\r\n\r\n    /** Wait for settings to be initialised before setting up the application */\r\n    private waitForSettings() {\r\n        // Wait until the settings have loaded before initialising\r\n        this.subscription('setting_setup', this._settings.initialised.subscribe((setup) => {\r\n            if (setup) {\r\n                this.init();\r\n                this.unsub('setting_setup');\r\n            }\r\n        }));\r\n    }\r\n\r\n    /**\r\n     * Initialise application services\r\n     */\r\n    private init(): void {\r\n        this.setupComposer();\r\n        // Setup analytics\r\n        this._analytics.enabled = !!this.setting('app.analytics.enabled');\r\n        if (this._analytics.enabled) {\r\n            this._analytics.load(this.setting('app.analytics.tracking_id'));\r\n        }\r\n        this._composer.initialised.pipe(first(_ => _)).subscribe(() => {\r\n            this._users.init();\r\n            this._organisation.init();\r\n            this._bookings.init();\r\n            this._spaces.init();\r\n            this._polling.init();\r\n            this._initialised.next(true);\r\n        });\r\n        // Add service to window if in debug mode\r\n        if (window.debug) {\r\n            window.application = this;\r\n        }\r\n        this._hotkeys.listen(['Shift', 'Backslash'], () => {\r\n            this.navigate('bootstrap', { clear: true });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Initialise the composer library comms\r\n     */\r\n    private setupComposer(): void {\r\n        this.log('SYSTEM', 'Setting up composer...');\r\n        // Get application settings\r\n        const settings: ComposerSettings = this.setting('composer') || {};\r\n        const protocol = settings.protocol || location.protocol;\r\n        const host = settings.domain || location.hostname;\r\n        const port = settings.port || location.port;\r\n        const url = settings.use_domain ? `${protocol}//${host}:${port}` : location.origin;\r\n        const route = settings.route || '';\r\n        const mock = this.setting('mock');\r\n        // Generate configuration object\r\n        const config: ComposerOptions = {\r\n            scope: 'public',\r\n            host: `${host}:${port}`,\r\n            auth_uri: `${url}/auth/oauth/authorize`,\r\n            token_uri: `${url}/auth/token`,\r\n            redirect_uri: `${location.origin}${route}/oauth-resp.html`,\r\n            handle_login: !settings.local_login,\r\n            mock\r\n        };\r\n        if (localStorage) {\r\n            localStorage.setItem('oauth_redirect', location.href);\r\n        }\r\n        this._composer.setup(config);\r\n        this.log('SYSTEM', 'Finsihed setting up composer.');\r\n    }\r\n\r\n    /**\r\n     * Setup handler for cache change events\r\n     */\r\n    private setupCache() {\r\n        this.unsub('app_stable');\r\n        this.log('CACHE', `Initialising cache...`);\r\n        if (this._cache.isEnabled) {\r\n            this.log('CACHE', `Listening to cache events...`);\r\n            this._cache.activateUpdate();\r\n            this.subscription('cache_update', this._cache.available.subscribe((event) => {\r\n                const current = `current version is ${event.current.hash}`;\r\n                const available = `available version is ${event.available.hash}`;\r\n                this.log('CACHE', `Update available: ${current} ${available}`);\r\n                this.activateUpdate()\r\n            }));\r\n            setInterval(() => {\r\n                this.log('CACHE', `Checking for updates...`);\r\n                this._cache.checkForUpdate();\r\n            }, 5 * 60 * 1000);\r\n        }\r\n        this._users.init();\r\n        this._organisation.init();\r\n        this._bookings.init();\r\n        this._spaces.init();\r\n        // Add service to window if in debug mode\r\n        if (window.debug) {\r\n            window.application = this;\r\n        }\r\n\r\n        this._hotkeys.listen(['Shift', 'Backslash'], () => {\r\n            this.navigate('bootstrap', { clear: true });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Update the cache and reload the page\r\n     */\r\n    private activateUpdate() {\r\n        if (this._cache.isEnabled) {\r\n            this.log('CACHE', `Activating changes to the cache...`);\r\n            this._cache.activateUpdate().then(() => location.reload(true));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Pre-register available overlays\r\n     */\r\n    private registerOverlays(): void {\r\n        if (OVERLAY_REGISTER) {\r\n            for (const overlay of OVERLAY_REGISTER) {\r\n                this._overlay.register(overlay.id, overlay.config);\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { ADynamicFormField } from '@acaprojects/ngx-dynamic-forms';\r\nimport { Subject } from 'rxjs';\r\n\r\nimport { BaseClass } from '../../shared/base.class';\r\nimport { HashMap } from '../../shared/utilities/types.utilities';\r\n\r\nexport interface IDataClassEvent {\r\n    type: string;\r\n    metadata: HashMap;\r\n}\r\n\r\nexport class BaseDataClass extends BaseClass {\r\n    /** Unique Identifier of the object */\r\n    readonly id: string;\r\n    /** Human readable name of the object */\r\n    readonly name: string;\r\n    /** Email address associated with the object */\r\n    readonly email: string;\r\n    /** Subject for change events to the class object */\r\n    readonly changeEvents = new Subject<IDataClassEvent>();\r\n    /** Form Fields for the object */\r\n    protected _form_fields: ADynamicFormField[];\r\n    /** Metadata to pass to form fields */\r\n    protected _form_metadata: HashMap;\r\n\r\n    constructor(protected service: any, raw_data: HashMap) {\r\n        super();\r\n        this.id = raw_data.id || raw_data.zone_id || raw_data.email || `${Math.floor(Math.random() * 9999999999)}`;\r\n        this.name = raw_data.name;\r\n        this.email = (raw_data.email || '').toLowerCase();\r\n        this._form_metadata = raw_data.form_metadata || {};\r\n    }\r\n\r\n    /** Get form field metadata for the object */\r\n    public get form_fields(): ADynamicFormField[] {\r\n        if (!this._form_fields) {\r\n            this._form_fields = this.initialiseFormFields();\r\n        }\r\n        return this._form_fields;\r\n    }\r\n\r\n    /** Whether form fields are valid */\r\n    public get valid(): boolean {\r\n        return this._form_fields ? this._form_fields.reduce((a, i) => a && i.isValid(), true) : false;\r\n    }\r\n\r\n    /** Whether the form has changes */\r\n    public get changes(): boolean {\r\n        return this.formChanges().length > 0;\r\n    }\r\n\r\n    /**\r\n     * Reset the values on the form to their initial state\r\n     */\r\n    public resetForm(): void {\r\n        if (this._form_fields) {\r\n            for (const field of this._form_fields) {\r\n                field.setValue(this[field.key]);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get a list of the field names that have changed values\r\n     */\r\n    public formChanges(): string[] {\r\n        const changed: string[] = [];\r\n        if (this._form_fields) {\r\n            for (const field of this._form_fields) {\r\n                if (field.getValue() !== this[field.key]) {\r\n                    changed.push(field.key);\r\n                }\r\n            }\r\n        }\r\n        return changed;\r\n    }\r\n\r\n    /**\r\n     * Save form changes to server\r\n     */\r\n    public save(): Promise<BaseDataClass> {\r\n        if (this.changes && this.service) {\r\n            this._form_fields.forEach(i => i.showErrors(true));\r\n            if (this.valid) {\r\n                const form = this.formValues();\r\n                return this.id\r\n                    ? this.service.update(this.id, form)\r\n                    : this.service.add(form);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Delete this item from the server\r\n     */\r\n    public delete(): Promise<void> {\r\n        if (this.id) {\r\n            return this.service.delete(this.id);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Run task for this item on the service\r\n     * @param task_name Name of the task\r\n     * @param parameters Parameters to pass to the task request\r\n     */\r\n    public runTask(task_name: string, parameters: HashMap): Promise<void> {\r\n        if (this.id) {\r\n            return this.service.task(this.id, task_name, parameters);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get a map of the field values\r\n     */\r\n    public toJSON(): HashMap {\r\n        if (!this._form_fields) {\r\n            this._form_fields = this.initialiseFormFields();\r\n        }\r\n        const json = this.formValues();\r\n        json.id = this.id;\r\n        delete json.changed_fields;\r\n        return json;\r\n    }\r\n\r\n    /**\r\n     * Emits change event\r\n     * @param type Type of change that has occurred\r\n     * @param metadata Supporting metadata for the event\r\n     */\r\n    public emit(type: string, metadata?: HashMap): void {\r\n        this.changeEvents.next({ type, metadata })\r\n    }\r\n\r\n    /**\r\n     * Make a copy of this object\r\n     */\r\n    public clone(): BaseDataClass {\r\n        return new BaseDataClass(this.service, this);\r\n    }\r\n\r\n    /**\r\n     * Make a copy of this object without identification data\r\n     */\r\n    public duplicate(): BaseDataClass {\r\n        return new BaseDataClass(this.service, { ...this, id: null, email: null });\r\n    }\r\n\r\n    /**\r\n     * Get the mapped values of the form fields\r\n     */\r\n    protected formValues(field_list: ADynamicFormField[] = this._form_fields, changes: boolean = true): HashMap {\r\n        const values: HashMap = {};\r\n        for (const field of field_list) {\r\n            if (field.children && field.children.length > 0) {\r\n                values[field.key] = this.formValues(field.children, false);\r\n            } else {\r\n                values[field.key] = field.getValue();\r\n            }\r\n        }\r\n        if (changes) {\r\n            values.changed_fields = this.formChanges();\r\n        }\r\n        return values;\r\n    }\r\n\r\n    /**\r\n     * Initialise the form field metadata for the field\r\n     */\r\n    protected initialiseFormFields(): ADynamicFormField[] {\r\n        const edit = !!this.id;\r\n        const fields: ADynamicFormField[] = [\r\n            new ADynamicFormField({\r\n                key: 'name',\r\n                type: 'input',\r\n                value: this.name\r\n            }),\r\n            new ADynamicFormField({\r\n                key: 'email',\r\n                type: 'input',\r\n                value: this.email,\r\n                required: true,\r\n                attributes: { type: 'email' }\r\n            })\r\n        ];\r\n        return fields;\r\n    }\r\n}\r\n","import { ComposerService } from '@acaprojects/ngx-composer';\r\nimport { EngineHttpClient } from '@acaprojects/ts-composer';\r\nimport { BehaviorSubject, Observable, Subscription, Subscriber, Subject } from 'rxjs';\r\n\r\nimport { BaseDataClass } from './base-api.class';\r\nimport { BaseClass } from '../../shared/base.class';\r\nimport { ApplicationService } from '../app.service';\r\nimport { HashMap } from '../../shared/utilities/types.utilities';\r\nimport { toQueryString } from '../../shared/utilities/api.utilities';\r\n\r\nexport interface IEngineResponse {\r\n    results: HashMap[];\r\n    total: number\r\n}\r\n\r\nexport class BaseAPIService<T = BaseDataClass> extends BaseClass {\r\n    /** Application service */\r\n    public parent: ApplicationService;\r\n    /** Display name of the service */\r\n    protected _name: string;\r\n    /** API Route of the service */\r\n    protected _api_route: string;\r\n    /** Map of state variables for Service */\r\n    protected _subjects: { [key: string]: BehaviorSubject<any> | Subject<any> } = {};\r\n    /** Map of observables for state variables */\r\n    protected _observers: { [key: string]: Observable<any> } = {};\r\n    /** Map of poll subscribers for API endpoints */\r\n    protected _subscribers: { [key: string]: Subscriber<any> } = {};\r\n    /** Map of promises for Service */\r\n    protected _promises: { [key: string]: Promise<any> } = {};\r\n    /** Comparison function for service items */\r\n    protected _compare: (a: T, b: T) => boolean = (a, b) => a === b || (a as any).id === (b as any).id;\r\n    /** Default filter function for list method */\r\n    protected _list_filter: (a: T) => boolean = (a) => !!a;\r\n\r\n    private get http(): EngineHttpClient {\r\n        return this._composer.http;\r\n    }\r\n\r\n    constructor(protected _composer: ComposerService) {\r\n        super();\r\n        this._name = 'Base';\r\n        this._api_route = 'base';\r\n        this.set('list', []);\r\n    }\r\n\r\n    /**\r\n     * Initailise service\r\n     */\r\n    public init() {\r\n        if (!this.parent || !this.parent.is_initialised) {\r\n            return this.timeout('init', () => this.init());\r\n        }\r\n        this.load().then(_ => this._initialised.next(true));\r\n    }\r\n\r\n    /**\r\n     * Get API route for the service\r\n     * @param engine Whether endpoint is using the application API or engine API\r\n     */\r\n    public route(engine: boolean = false) {\r\n        const endpoint = this.parent ? (engine ? this.parent.engine_endpoint : this.parent.endpoint) : '/api/';\r\n        return `${endpoint}${this._api_route}`;\r\n    }\r\n    /** API Route of the service */\r\n    public get api_route() {\r\n        return this._api_route;\r\n    }\r\n\r\n    /**\r\n     * Get a service related setting from the settings service\r\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\r\n     */\r\n    public setting(key: string) {\r\n        return this.parent ? this.parent.setting(`app.${this._name.toLowerCase()}.${key}`) : null;\r\n    }\r\n\r\n    /**\r\n     * Get the current value of the named property\r\n     * @param name Property name\r\n     */\r\n    public get<U = any>(name: string): U {\r\n        return this._subjects[name] && this._subjects[name] instanceof BehaviorSubject\r\n            ? (this._subjects[name] as BehaviorSubject<U>).getValue()\r\n            : null;\r\n    }\r\n\r\n\r\n    /**\r\n     * Listen to value change of the named property\r\n     * @param name Property name\r\n     * @param next Callback for value changes\r\n     */\r\n    public listen<U = any>(name: string, next: (_: U) => void): Subscription {\r\n        return this._observers[name] ? this._observers[name].subscribe(next) : null;\r\n    }\r\n\r\n    /**\r\n     * Update the value of the named property\r\n     * @param name Property name\r\n     * @param value New value\r\n     */\r\n    protected set<U = any>(name: string, value: U): void {\r\n        if (!this._subjects[name]) {\r\n            this._subjects[name] = new BehaviorSubject<U>(value);\r\n            this._observers[name] = this._subjects[name].asObservable();\r\n        } else {\r\n            this._subjects[name].next(value);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get list of loaded items\r\n     * @param filterFn Function for filtering the list\r\n     */\r\n    public list(filterFn: (a: T) => boolean = this._list_filter): T[] {\r\n        const list = this.get('list') || [];\r\n        return list.reduce((a, i) => { if (filterFn(i)) { a.push(i); } return a; }, []);\r\n    }\r\n\r\n    /**\r\n     * Get item with the given id from the loaded items\r\n     * @param id ID of the item\r\n     */\r\n    public item(id: string): T {\r\n        const list = this.get('list') || [];\r\n        return list.find(i => i.id === id || i.email === id);\r\n    }\r\n\r\n    /**\r\n     * Query the index of the API route associated with this service\r\n     * @param query_params Map of query paramaters to add to the request URL\r\n     */\r\n    public query(query_params: HashMap = { update_list: true }): Promise<T[] | HashMap[]> {\r\n        let engine = false;\r\n        let cache = 1000;\r\n        if (query_params) {\r\n            engine = !!query_params.engine;\r\n            delete query_params.engine;\r\n            cache = query_params.cache || 1000;\r\n            delete query_params.cache;\r\n        }\r\n        const query = toQueryString(query_params);\r\n        const key = `query|${query}`;\r\n        if (!this._promises[key]) {\r\n            this._promises[key] = new Promise((resolve, reject) => {\r\n                const url = `${this.route(engine)}${query ? '?' + query : ''}`;\r\n                let result: T[] | HashMap[] = [];\r\n                this.http.get(url).subscribe(\r\n                    (d: IEngineResponse | HashMap[]) => {\r\n                        result = d && d instanceof Array\r\n                            ? d.map(i => this.process(i))\r\n                            : (d && !(d instanceof Array) && d.results\r\n                                ? d.results as HashMap[]\r\n                                : []);\r\n                    }, e => {\r\n                        reject(e);\r\n                        this._promises[key] = null;\r\n                    },\r\n                    () => {\r\n                        if ((!query || (query_params && query_params.update_list)) && result.length > 0 && result[0] instanceof BaseDataClass) {\r\n                            this.set('list', this.updateList(this.get('list'), result as T[]));\r\n                        }\r\n                        resolve(result);\r\n                        this.timeout(key, () => (this._promises[key] = null), cache);\r\n                    }\r\n                );\r\n            });\r\n        }\r\n        return this._promises[key];\r\n    }\r\n\r\n    /**\r\n     * Query the API route for a sepecific item\r\n     * @param id ID of the item\r\n     * @param query_params Map of query paramaters to add to the request URL\r\n     */\r\n    public show(id: string, query_params: HashMap = {}): Promise<T> {\r\n        let engine = false;\r\n        if (query_params) {\r\n            engine = !!query_params.engine;\r\n            delete query_params.engine;\r\n        }\r\n        const query = toQueryString(query_params);\r\n        const key = `show|${id}|${query}`;\r\n        if (!this._promises[key]) {\r\n            this._promises[key] = new Promise<T>((resolve, reject) => {\r\n                const url = `${this.route(engine)}/${id}${query ? '?' + query : ''}`;\r\n                let result: T = null;\r\n                this.http.get(url).subscribe(\r\n                    d => result = this.process(d),\r\n                    e => {\r\n                        reject(e);\r\n                        this._promises[key] = null;\r\n                    },\r\n                    () => {\r\n                        resolve(result);\r\n                        this.timeout(key, () => (this._promises[key] = null), 1000);\r\n                    }\r\n                );\r\n            });\r\n        }\r\n        return this._promises[key];\r\n    }\r\n\r\n    /**\r\n     * Make post request for a new item to the service\r\n     * @param form_data Data to post to the server\r\n     * @param query_params Map of query paramaters to add to the request URL\r\n     */\r\n    public add(form_data: HashMap, query_params: HashMap = {}): Promise<T> {\r\n        if (!this._promises.new_item) {\r\n            this._promises.new_item = new Promise<T>((resolve, reject) => {\r\n                const query = toQueryString(query_params);\r\n                const url = `${this.route(query_params.engine)}${query ? '?' + query : ''}`;\r\n                let result: T = null;\r\n                this.http.post(url, form_data).subscribe(\r\n                    d => (result = this.process(d)),\r\n                    e => {\r\n                        reject(e);\r\n                        this.analyticsEvent(`create-${this._name.toLowerCase()}-failed`);\r\n                        this._promises.new_item = null;\r\n                    },\r\n                    () => {\r\n                        resolve(result);\r\n                        this.set('list', this.updateList(this.get('list'), [result]));\r\n                        this.analyticsEvent(`create-${this._name.toLowerCase()}-success`);\r\n                        this._promises.new_item = null;\r\n                    }\r\n                );\r\n            });\r\n        }\r\n        return this._promises.new_item;\r\n    }\r\n\r\n    /**\r\n     * Perform API task for the given item ID\r\n     * @param id ID of the item\r\n     * @param task_name Name of the task\r\n     * @param form_data Map of data to pass to the API\r\n     */\r\n    public task<U = any>(id: string, task_name: string, form_data: HashMap = {}): Promise<U> {\r\n        const query = toQueryString(form_data);\r\n        const key = `task|${id}|${task_name}|${query}`;\r\n        if (!this._promises[key]) {\r\n            this._promises[key] = new Promise<U>((resolve, reject) => {\r\n                const post_data = { ...form_data, id, _task: task_name };\r\n                const url = `${this.route(form_data.engine)}/${id}/${task_name}`;\r\n                let result = null;\r\n                this.http.post(url, post_data).subscribe(\r\n                    d => result = d,\r\n                    e => {\r\n                        reject(e);\r\n                        this.analyticsEvent(`${this._name.toLowerCase()}-task-${task_name}-failed`, id);\r\n                        this._promises[key] = null;\r\n                    },\r\n                    () => {\r\n                        resolve(result as U);\r\n                        this.analyticsEvent(`${this._name.toLowerCase()}-task-${task_name}-success`, id);\r\n                        this.timeout(key, () => this._promises[key] = null, 1000);\r\n                    }\r\n                );\r\n            });\r\n        }\r\n        return this._promises[key];\r\n    }\r\n\r\n    /**\r\n     * Setup a poller for an API endpoint\r\n     * @param id Show request ID. Leave blank to poll on the query endpoint\r\n     * @param query_params Map of query paramaters to add to the polled URL\r\n     * @param delay Delay between each poll event\r\n     */\r\n    public poll(id?: string, query_params: HashMap = {}, delay: number = 5000): Observable<T | T[]> {\r\n        const key = `poll|${id || ''}|${toQueryString(query_params) || ''}`;\r\n        this.stopPoll(id, query_params);\r\n        this._subjects[key] = new Subject<T | T[]>();\r\n        this._observers[key] = this._subjects[key].asObservable();\r\n        const sub = this._subjects[key];\r\n        const query = { ...(query_params || {}), _poll: true };\r\n        if (id) {\r\n            this.show(id, query).then((d) => sub.next(d), e => sub.error(e));\r\n            this.interval(key, () => {\r\n                this.show(id, query).then((d) => sub.next(d), e => sub.error(e));\r\n            }, delay);\r\n        } else {\r\n            this.query(query).then((d) => sub.next(d), e => sub.error(e));\r\n            this.interval(key, () => {\r\n                this.query(query).then((d) => sub.next(d), e => sub.error(e));\r\n            }, delay);\r\n        }\r\n        return this._observers[key];\r\n    }\r\n\r\n    /**\r\n     * Destroy poller\r\n     * @param id\r\n     * @param query_params\r\n     */\r\n    public stopPoll(id?: string, query_params: HashMap = {}) {\r\n        const key = `poll|${id || ''}|${toQueryString(query_params) || ''}`;\r\n        if (this._subjects[key]) {\r\n            this._subjects[key].complete();\r\n            this._subjects[key] = null;\r\n            this._observers[key] = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Make put request for changes to the item with the given id\r\n     * @param id ID of the item being updated\r\n     * @param form_data New values for the item\r\n     * @param query_params Map of query paramaters to add to the request URL\r\n     */\r\n    public update(id: string, form_data: HashMap, query_params: HashMap = {}): Promise<T> {\r\n        const key = `update|${id}`;\r\n        if (!this._promises[key]) {\r\n            this._promises[key] = new Promise<T>((resolve, reject) => {\r\n                const query = toQueryString(query_params);\r\n                const url = `${this.route(query_params.engine)}/${id}${query ? '?' + query : ''}`;\r\n                let result: T = null;\r\n                this.http.put(url, form_data).subscribe(\r\n                    d => (result = this.process(d)),\r\n                    e => {\r\n                        reject(e);\r\n                        this.analyticsEvent(`update-${this._name.toLowerCase()}-failed`, id);\r\n                        this._promises[key] = null;\r\n                    },\r\n                    () => {\r\n                        resolve(result);\r\n                        this.set('list', this.updateList(this.removeItem(this.get('list'), { id } as any), [result]));\r\n                        this.analyticsEvent(`update-${this._name.toLowerCase()}-success`, id);\r\n                        this._promises[key] = null;\r\n                    }\r\n                );\r\n            });\r\n        }\r\n        return this._promises[key];\r\n    }\r\n\r\n    /**\r\n     * Make delete request for the given item\r\n     * @param id ID of item\r\n     */\r\n    public delete(id: string): Promise<void> {\r\n        const key = `delete|${id}`;\r\n        if (!this._promises[key]) {\r\n            this._promises[key] = new Promise<void>((resolve, reject) => {\r\n                const url = `${this.route()}/${id}`;\r\n                this.http.delete(url).subscribe(\r\n                    _ => null,\r\n                    e => reject(e),\r\n                    () => {\r\n                        this.set('list', this.removeItem(this.get('list'), ({ id } as any)));\r\n                        resolve();\r\n                    }\r\n                );\r\n            });\r\n        }\r\n        return this._promises[key];\r\n    }\r\n\r\n    /**\r\n     * Add new API item from another service or API class\r\n     * @param id ID of the item/or service adding the new item\r\n     * @param data Raw API data for the new item\r\n     * @param type Adder type\r\n     */\r\n    public addFrom(id: string, data: HashMap, type: 'class' | 'service' | 'other' = 'other'): string {\r\n        const new_item = this.process(data);\r\n        this.set('list', this.updateList(this.get('list'), [new_item]));\r\n        return (new_item as any).id;\r\n    }\r\n\r\n    /**\r\n     * Remove items with the given IDs from the list\r\n     * @param id ID of the item/or service remove the list of items\r\n     * @param remove_ids List of item IDs to remove\r\n     * @param type Remover type\r\n     */\r\n    public removeFrom(id: string, remove_ids: string[], type: 'class' | 'service' | 'other' = 'other') {\r\n        const list = this.get('list');\r\n        for (const item_id of remove_ids) {\r\n            const index = list.findIndex(item => item.id === item_id);\r\n            if (index >= 0) {\r\n                list.splice(index, 1);\r\n            }\r\n        }\r\n        this.set('list', list);\r\n    }\r\n\r\n    /**\r\n     * Load initial data for the service\r\n     */\r\n    protected load(): Promise<void> {\r\n        return new Promise<void>((resolve) => {\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Post analytics event for this service\r\n     * @param action Name of the action to post\r\n     */\r\n    protected analyticsEvent(action: string, label?: string) {\r\n        if (this.parent && this.parent.Analytics) {\r\n            this.parent.Analytics.event(this._name, `${this.parent.name.toLowerCase()}-${action}`, label);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Convert raw API data into a valid API Object\r\n     * @param raw_item Raw API data\r\n     */\r\n    protected process(raw_item: HashMap): T {\r\n        return raw_item as T;\r\n    }\r\n\r\n    /**\r\n     * Update recorded list of items\r\n     * @param old_list Old list of items\r\n     * @param list List of updated items\r\n     * @param compareFn Function to compare items to remove duplicates\r\n     */\r\n    protected updateList(old_list: T[], list: T[], compareFn: (a: T, b: T) => boolean = this._compare): T[] {\r\n        if (!list || list.length === 0) { return old_list; }\r\n        const new_list: T[] = [];\r\n        const mixed_list = [...list, ...old_list];\r\n        if (!compareFn) { compareFn = this._compare; }\r\n        for (const item of mixed_list) {\r\n            const found = new_list.find(i => compareFn(i, item));\r\n            if (!found) {\r\n                new_list.push(item);\r\n            }\r\n        }\r\n        return new_list;\r\n    }\r\n\r\n    /**\r\n     * Remove the given item from the given list\r\n     * @param list List of items\r\n     * @param item Item to remove\r\n     * @param compareFn Function to compare items\r\n     */\r\n    protected removeItem(list: T[], item: T, compareFn?: (a: T, b: T) => boolean) {\r\n        const new_list = [];\r\n        if (!compareFn) { compareFn = this._compare; }\r\n        list.forEach(i => compareFn(item, i) ? null : new_list.push(i));\r\n        return new_list;\r\n    }\r\n}\r\n","\r\nimport { formatDate } from '@angular/common';\r\nimport { Validators } from '@angular/forms';\r\nimport { ADynamicFormField } from '@acaprojects/ngx-dynamic-forms';\r\n\r\nimport { BaseDataClass } from '../base-api.class';\r\nimport { User } from '../users/user.class';\r\nimport { HashMap } from '../../../shared/utilities/types.utilities';\r\nimport { humaniseDuration } from '../../../shared/utilities/general.utilities';\r\nimport { Space } from '../spaces/space.class';\r\nimport { FORM_FIELDS } from '../../../shared/globals/form-fields';\r\n\r\nimport { formatAttendeesWithHost, formatRecurrence, formatSpaces } from '../../../shared/utilities/formatting.utilities';\r\nimport { validateDate, buildValidateDuration, buildValidateAttendees } from '../../../shared/utilities/validation.utilities';\r\n\r\nimport * as dayjs from 'dayjs';\r\nimport { BaseAPIService } from '../base.service';\r\n\r\nexport class Booking extends BaseDataClass {\r\n    /** Unique calendar event ID */\r\n    readonly icaluid: string;\r\n    /** Subject or title of the booking */\r\n    readonly title: string;\r\n    /** Unix timestamp of the booking start */\r\n    readonly date: number;\r\n    /** Length of the booking in minutes */\r\n    readonly duration: number;\r\n    /** Description or details of the booking */\r\n    readonly body: string;\r\n    /** Supplimentary notes for the booking */\r\n    readonly notes: string;\r\n    /** Type of booking */\r\n    readonly type: string;\r\n    /** Whether the booking has catering associated with it */\r\n    readonly catering: boolean;\r\n    /** String location set in booking */\r\n    readonly _location: string;\r\n    /** List of attendee emails associated with the booking */\r\n    private _attendees: string[];\r\n    /** Email of the host or organiser of the booking */\r\n    private _organiser: string;\r\n    /** List of spaces associated with the booking */\r\n    private _space_list: string[];\r\n    /** Cached display strings */\r\n    private _display: HashMap<string> = {};\r\n\r\n    constructor(protected service: BaseAPIService<Booking>, raw_data: HashMap) {\r\n        super(service, raw_data);\r\n        const u_service = service.parent.Users;\r\n        this.icaluid = raw_data.icaluid || this.id;\r\n        this.title = raw_data.title || raw_data.subject || raw_data.Subject;\r\n        const start = dayjs(raw_data.date || raw_data.start || raw_data.start_epoch * 1000 || raw_data.Start);\r\n        this.date = start.valueOf();\r\n        this.duration = raw_data.duration || dayjs(raw_data.end || raw_data.end_epoch * 1000 || raw_data.End).diff(start, 'm');\r\n        this.body = raw_data.body || raw_data.description;\r\n        this.notes = raw_data.notes;\r\n        this.type = raw_data.type || (raw_data.visitors ? 'external' : null) || 'internal';\r\n        this.catering = raw_data.catering;\r\n        this._attendees = (raw_data.attendees || raw_data._attendees || []).map(i => u_service.item(i.email) || new User(u_service, i));\r\n        const organiser = raw_data.organiser || raw_data.organizer || { email: `${raw_data.owner}@fake.org` };\r\n        if (raw_data.owner) {\r\n            this.service.parent.Users.addFrom('booking', { name: raw_data.owner, email: `${raw_data.owner}@fake.org` });\r\n        }\r\n        this._organiser = organiser.email || raw_data._organiser;\r\n        this._location = raw_data.location || raw_data._location;\r\n        this._display = {\r\n            date: start.format('DD MMM YYYY'),\r\n            time: `${start.format('h:mma')} - ${dayjs(start)\r\n                .add(this.duration, 'm')\r\n                .format('h:mma')}`,\r\n            start: start.format('h:mma'),\r\n            end: dayjs(start)\r\n                .add(this.duration, 'm')\r\n                .format('h:mma'),\r\n            duration: humaniseDuration(this.duration)\r\n        };\r\n        this._space_list = raw_data.room_ids || raw_data._space_list;\r\n        // Add attendees and organiser to service data\r\n        if (this.service.parent && this.service.parent.Users) {\r\n            if (raw_data.attendees) {\r\n                raw_data.attendees.forEach(u => {\r\n                    if (!this.service.parent.Users.item(u.email)) {\r\n                        this.service.parent.Users.addFrom(this.id, u, 'class');\r\n                    }\r\n                });\r\n            }\r\n            if (organiser) {\r\n                if (!this.service.parent.Users.item(organiser.email)) {\r\n                    this.service.parent.Users.addFrom(this.id, organiser, 'class');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /** List of attendees to the meeting */\r\n    public get attendees(): User[] {\r\n        return this.service && this.service.parent && this.service.parent.Users\r\n            ? this.service.parent.Users.list((user) => this._attendees.indexOf(user.id) >= 0)\r\n            : [];\r\n    }\r\n\r\n    /** Host or organiser of the meeting */\r\n    public get organiser(): User {\r\n        return this.service && this.service.parent && this.service.parent.Users && this._organiser\r\n            ? this.service.parent.Users.item(this._organiser) : null;\r\n    }\r\n\r\n    /** Status of the booking */\r\n    public get status(): 'future' | 'upcoming' | 'done' | 'started' | 'in_progress' {\r\n        const now = dayjs();\r\n        const date = dayjs(this.date);\r\n        if (now.isBefore(date.subtract(15, 'm'), 'm')) {\r\n            return 'future';\r\n        } else if (now.isBefore(date, 'm')) {\r\n            return 'upcoming';\r\n        } else if (now.isBefore(date.add(15, 'm'), 'm')) {\r\n            return 'started';\r\n        } else if (now.isBefore(date.add(this.duration, 'm'), 'm')) {\r\n            return 'in_progress';\r\n        }\r\n        return 'done';\r\n    }\r\n\r\n    /** Get the first space from the space list */\r\n    public get space(): Space {\r\n        return this.service && this.service.parent && this.service.parent.Spaces && this._space_list && this._space_list.length > 0\r\n            ? this.service.parent.Spaces.item(this._space_list[0]) : null;\r\n    }\r\n    /** Spaces associated with the booking */\r\n    public get space_list(): Space[] {\r\n        return this.service && this.service.parent && this.service.parent.Spaces\r\n            ? this.service.parent.Spaces.list((space) => this._space_list.indexOf(space.id) >= 0)\r\n            : [];\r\n    }\r\n\r\n    /** Display value for the date */\r\n    public get date_string(): string {\r\n        return this._display.date;\r\n    }\r\n    /** Display valuie for the start and end times of the booking */\r\n    public get time_period(): string {\r\n        return this._display.time;\r\n    }\r\n    /** Display value for the start time of the booking */\r\n    public get start_time(): string {\r\n        return this._display.start;\r\n    }\r\n    /** Display value for the end time of the booking */\r\n    public get end_time(): string {\r\n        return this._display.end;\r\n    }\r\n    /** Display value for the duration of the booking */\r\n    public get length_string(): string {\r\n        return this._display.duration;\r\n    }\r\n    /** Display value for the location of the booking */\r\n    public get location(): string {\r\n        return this._display.space_names || this._location || 'No location set';\r\n    }\r\n    /** Display value for the level of the first space in the booking */\r\n    public get level(): string {\r\n        return this._display.level;\r\n    }\r\n\r\n    /**\r\n     * Create form fields for the object\r\n     */\r\n    protected initialiseFormFields(): ADynamicFormField[] {\r\n        const form_fields = [];\r\n        const form_settings = this.service.setting('fields') || [];\r\n        const user = this.service.parent.Users.current;\r\n        const actions = {\r\n            // space: () => this.setSpace(),\r\n            // recurrence: () => this.setRecurrence(),\r\n            // conferencing: (v?) => this.setConferencing(v)\r\n        };\r\n        const validators = {\r\n            date: [validateDate],\r\n            duration: [buildValidateDuration()],\r\n            attendees: [buildValidateAttendees(user, this.service.setting('min_attendees'))],\r\n            terms: [Validators.requiredTrue]\r\n        };\r\n        const formatters = {\r\n            attendees: formatAttendeesWithHost(user),\r\n            date: formatDate,\r\n            space: formatSpaces,\r\n            recurrence: formatRecurrence\r\n        };\r\n        const custom_elements = FORM_FIELDS;\r\n        const defaults = {};\r\n        const process_field = field => {\r\n            const f = {\r\n                key: field.key,\r\n                label: field.label,\r\n                icon: field.icon,\r\n                type: field.control_type || field.type,\r\n                value: this[field.key] || defaults[field.key] || '',\r\n                action: field.action || actions[field.key],\r\n                format: field.format || formatters[field.key],\r\n                content: field.content || custom_elements[field.key],\r\n                required: field.required,\r\n                validators: validators[field.key],\r\n                references: field.references || field.refs,\r\n                hide: field.hide,\r\n                metadata: { ...field.metadata, ...this._form_metadata, service: this.service },\r\n                attributes: { flex: field.flex },\r\n                children: field.children ? field.children.map(i => process_field(i)) : null\r\n            };\r\n            return new ADynamicFormField(f);\r\n        };\r\n        for (const field of form_settings) {\r\n            if (field.key) {\r\n                form_fields.push(process_field(field));\r\n            }\r\n        }\r\n        return form_fields;\r\n    }\r\n\r\n    /**\r\n     * Make a copy of this object\r\n     */\r\n    public clone(): Booking {\r\n        return new Booking(this.service, this);\r\n    }\r\n\r\n    /**\r\n     * Make a copy of this object without identification data\r\n     */\r\n    public duplicate(): Booking {\r\n        return new Booking(this.service, { ...this, id: null, email: null, icaluid: null });\r\n    }\r\n}\r\n","import { padZero } from '../../../shared/utilities/general.utilities';\r\n\r\nimport { generateMockUser } from '../users/user.utilities';\r\n\r\nimport * as faker from 'faker';\r\nimport * as dayjs from 'dayjs';\r\nimport { Booking } from './booking.class';\r\n\r\nlet BOOKING_COUNT = 0;\r\nlet BOOKING_DATE = dayjs().minute(0).startOf('m');\r\n\r\n/**\r\n * Set the initial time used for generating mock bookings\r\n * @param time New initial time as ms from UTC epoch\r\n */\r\nexport function setMockBookingStartDatetime(time: number) {\r\n    BOOKING_DATE = dayjs(time).startOf('m');\r\n}\r\n\r\n/**\r\n * Create mock raw API data for a booking\r\n * @param id\r\n */\r\nexport function generateMockBooking(id?: string) {\r\n    if (!id) {\r\n        id = `booking-${BOOKING_COUNT++}`;\r\n    }\r\n    BOOKING_DATE = BOOKING_DATE.add(Math.floor(Math.random() * 4) + 15, 'm');\r\n    const start = BOOKING_DATE.valueOf();\r\n    const duration = Math.floor(Math.random() * 4) + 30;\r\n    BOOKING_DATE = BOOKING_DATE.add(Math.floor(Math.random() * 4) + 15, 'm');\r\n    return {\r\n        id,\r\n        icaluid: padZero(Math.floor(Math.random() * 99999999), 8),\r\n        title: `${faker.commerce.productName()} Meeting`,\r\n        attendees: Array(Math.floor(Math.random() * 5 + 2))\r\n            .fill(0)\r\n            .map(i => generateMockUser()),\r\n        organiser: generateMockUser(),\r\n        date: start,\r\n        duration,\r\n        description: faker.lorem.paragraph(),\r\n        notes: faker.lorem.paragraph(),\r\n        location: faker.address.city(),\r\n        catering: Math.floor(Math.random() * 34567) % 3 === 0\r\n    };\r\n}\r\n\r\nexport interface IBookingSlot {\r\n    start: number;\r\n    end: number;\r\n}\r\n\r\n/**\r\n * Generate a list of free time slots between the given bookings\r\n * @param list List of bookings to find slots between\r\n * @param min_size Minimum length of a free slot in minutes\r\n */\r\nexport function getFreeBookingSlots(list: Booking[], min_size: number = 30): IBookingSlot[] {\r\n    if (!list) { return [{ start: 0, end: dayjs().startOf('m').valueOf() * 10 }] }\r\n    const slots: IBookingSlot[] = [];\r\n    let start = dayjs(0);\r\n    list.sort((a, b) => a.date - b.date);\r\n    for (const booking of list) {\r\n        const bkn_start = dayjs(booking.date);\r\n        const bkn_end = bkn_start.add(booking.duration, 'm');\r\n        if (bkn_start.isAfter(start)) {\r\n            const diff = bkn_start.diff(start, 'm');\r\n            if (diff >= min_size) {\r\n                slots.push({ start: start.valueOf(), end: bkn_start.valueOf() });\r\n            }\r\n            start = bkn_end;\r\n        }\r\n    }\r\n    slots.push({ start: start.valueOf(), end: dayjs().startOf('m').valueOf() * 10 })\r\n    return slots;\r\n}\r\n\r\n/**\r\n * Get the next free time slot from the given bookings\r\n * @param list List of bookings to find the next slot\r\n * @param date Date to find next slot after in ms since UTC epoch\r\n * @param min_size Minimum length of the free slot in minutes\r\n */\r\nexport function getNextFreeBookingSlot(list: Booking[], date: number = dayjs().valueOf(), min_size: number = 30): IBookingSlot {\r\n    const slots = getFreeBookingSlots(list, min_size);\r\n    const time = dayjs(date).startOf('m').second(1);\r\n    for (const block of slots) {\r\n        const start = dayjs(block.start).startOf('m');\r\n        const end = dayjs(block.end).startOf('m');\r\n        if (start.isAfter(time, 's')) {\r\n            return block;\r\n        } else if (time.isBefore(end, 's')) {\r\n            const duration = end.diff(time, 'm');\r\n            if (duration >= min_size) {\r\n                return block;\r\n            }\r\n        }\r\n    }\r\n    return slots[slots.length - 1];\r\n}\r\n","\r\nimport { Injectable } from '@angular/core';\r\nimport { ComposerService } from '@acaprojects/ngx-composer';\r\n\r\nimport { BaseAPIService } from '../base.service';\r\nimport { Booking } from './booking.class';\r\nimport { Space } from '../spaces/space.class';\r\nimport { HashMap } from '../../../shared/utilities/types.utilities';\r\nimport { BookingData } from '../../../overlays/booking-modal/booking-modal.component';\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\nexport interface IBookingOptions {\r\n    space: Space;\r\n    date?: number;\r\n    title?: string;\r\n    max_duration?: number;\r\n    min_duration?: number;\r\n}\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class BookingsService extends BaseAPIService<Booking> {\r\n    constructor(protected _composer: ComposerService) {\r\n        super(_composer);\r\n        this._name = 'Bookings';\r\n        this._api_route = 'bookings';\r\n        this._compare = (a, b) => !a.id.localeCompare(b.id) || !a.icaluid.localeCompare(b.icaluid);\r\n    }\r\n\r\n    /**\r\n     * Open form modal for creating new bookings\r\n     * @param space Space to make booking in\r\n     * @param date Default date on the form\r\n     */\r\n    public new(options: IBookingOptions) {\r\n        if (options.space) {\r\n            this.parent.Overlay.open('booking', {\r\n                config: 'modal',\r\n                data: options as any\r\n            }, (event: { type: string, data: BookingData }) => {\r\n                const booking = event.data.booking.toJSON();\r\n                this.timeout('book', () => {\r\n                    this.create(options.space, booking)\r\n                        .then(() => {\r\n                            this.parent.notifySuccess('Booking successfully created');\r\n                            event.data.close ? event.data.close() : ''\r\n                        }).catch(_ => {\r\n                            this.parent.notifyError(`Error creating meeting. ${_}`);\r\n                            event.data.on_error ? event.data.on_error() : '';\r\n                        });\r\n                }, 1000);\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create new booking with the given properties\r\n     * @param booking New booking data\r\n     */\r\n    private create(space: Space, booking: HashMap) {\r\n        return new Promise((resolve, reject) => {\r\n            if (space) {\r\n                const request = {\r\n                    title: booking.title,\r\n                    count: {\r\n                        staff: booking.num_staff ? +booking.num_staff : 0,\r\n                        partners: booking.num_partners ? +booking.num_partners : 0,\r\n                    },\r\n                    staff_id: '', // data.form.user.staff_code,\r\n                    start: booking.date.valueOf(),\r\n                    end: dayjs(booking.date).add(booking.period.duration, 'm').valueOf(),\r\n                    host: booking.host || booking.user || { name: 'Panel User' }\r\n                };\r\n                const module = this.parent.Systems.get(space.id, 'Bookings');\r\n                if (request && module) {\r\n                    module.exec('create_meeting', [request]).then(() => {\r\n                        this.analyticsEvent('create-success');\r\n                        resolve();\r\n                    }, (err) => {\r\n                        this.analyticsEvent('create-failed');\r\n                        reject(`Error making booking: ${err}`);\r\n                    })\r\n                } else {\r\n                    reject(`No Bookings module found for space ${space.id}`);\r\n                }\r\n            } else {\r\n                reject('No space set for booking');\r\n            }\r\n        });\r\n    }\r\n\r\n    protected process(raw_data: HashMap): Booking {\r\n        return new Booking(this, raw_data);\r\n    }\r\n}\r\n","import { BaseDataClass } from '../base-api.class';\r\nimport { HashMap, Identity } from '../../../shared/utilities/types.utilities';\r\nimport { getItemWithKeys } from '../../../shared/utilities/general.utilities';\r\nimport { BaseAPIService } from '../base.service';\r\nimport { Organisation } from './organisation.class';\r\n\r\nexport interface IBuildingRoleUser {\r\n    name: string;\r\n    email: string;\r\n    phone: string;\r\n}\r\n\r\nexport interface LockerMap {\r\n    [zone: string]: {\r\n        [area: string]: {\r\n            [type: string]: (string | boolean)[][];\r\n        };\r\n    };\r\n}\r\n\r\nexport interface ICoordinates {\r\n    longitude: number;\r\n    latitude: number;\r\n}\r\n\r\nexport interface IMapFeature {\r\n    id: string;\r\n    level_id: string;\r\n    name: string;\r\n}\r\n\r\nexport class Building extends BaseDataClass {\r\n    /** Engine Zone ID for the building */\r\n    readonly zone_id: string;\r\n    /** List of available extras for the building */\r\n    private _extras: Identity[];\r\n    /** List of available extra equipment for loan at the building */\r\n    private _loan_items: Identity[];\r\n    /** List of available levels for the building */\r\n    private _levels: Identity[];\r\n    /** Map of custom settings for the building */\r\n    private _settings: HashMap;\r\n    /** Map of roles and list of the associated users */\r\n    private _roles: HashMap<IBuildingRoleUser[]>;\r\n    /** Map of the locker ID arrays */\r\n    private _lockers: LockerMap;\r\n    /** Map of important system ids for the building */\r\n    private _systems: HashMap<string>;\r\n    /** Map of important phone numbers for the building */\r\n    private _phone_numbers: HashMap<string>;\r\n    /** Globe coordiates for the build */\r\n    private _location: ICoordinates;\r\n    /** List of zones associated with the building */\r\n    private _zones: string[];\r\n    /** Searchable map features */\r\n    private _searchables: IMapFeature[];\r\n\r\n    constructor(protected service: BaseAPIService<Organisation>, raw_data: HashMap) {\r\n        super(service, raw_data);\r\n        this.zone_id = raw_data.zone_id || raw_data.zone;\r\n        this._extras = (raw_data.extras || []).map(i => ({ id: i.extra_id || i.id, name: i.extra_name || i.name }));\r\n        this._loan_items = (raw_data.loan_items || []).map(i => ({ id: i.extra_id || i.id, name: i.extra_name || i.name }));\r\n        this._levels = (raw_data.levels || []).map(i => ({ id: i.level_id || i.id, name: i.level_name || i.name }));\r\n        this._roles = raw_data.roles || {};\r\n        this._lockers = raw_data.lockers || raw_data.locker_structure || {};\r\n        this._systems = raw_data.systems || {};\r\n        this._settings = raw_data.settings || {};\r\n        this._phone_numbers = raw_data.phone_numbers || {};\r\n        this._location = raw_data.location || { longitude: null, latitude: null };\r\n        this._searchables = [];\r\n        if (raw_data.neighbourhoods) {\r\n            for (const lvl in raw_data.neighbourhoods) {\r\n                if (raw_data.neighbourhoods.hasOwnProperty(lvl)) {\r\n                    const lvl_features = raw_data.neighbourhoods[lvl] || {};\r\n                    for (const feature in lvl_features) {\r\n                        if (lvl_features.hasOwnProperty(feature)) {\r\n                            this._searchables.push({\r\n                                id: lvl_features[feature],\r\n                                name: feature,\r\n                                level_id: lvl\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /** List of available extras for the building */\r\n    public get extras(): Identity[] {\r\n        return [...(this._extras || [])];\r\n    }\r\n    /** List of available extras for the building */\r\n    public get loan_items(): Identity[] {\r\n        return [...(this._loan_items || [])];\r\n    }\r\n    /** List of available levels for the building */\r\n    public get levels(): Identity[] {\r\n        return [...(this._levels || [])];\r\n    }\r\n    /**\r\n     * Get a custom building setting\r\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\r\n     */\r\n    public setting(key: string): any {\r\n        const keys = key.split('.');\r\n        const value = getItemWithKeys(keys, this._settings);\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Get list of users with the associated role\r\n     * @param name Role to find users for\r\n     */\r\n    public role(name: string): IBuildingRoleUser[] {\r\n        return [...(this._roles[name] || [])];\r\n    }\r\n    /**\r\n     * Get list of the names of available user role lists\r\n     */\r\n    public get role_names(): string[] {\r\n        return Object.keys(this._roles).filter(i => this._roles.hasOwnProperty(i));\r\n    }\r\n    /** Map of the locker ID arrays */\r\n    public get lockers(): LockerMap {\r\n        return { ...(this._lockers || {}) };\r\n    }\r\n    /** Map of important system ids for the building */\r\n    public get systems(): HashMap<string> {\r\n        return { ...(this._systems || {}) };\r\n    }\r\n    /** Map of important phone numbers for the building */\r\n    public get phone_numbers(): HashMap<string> {\r\n        return { ...(this._phone_numbers || {}) };\r\n    }\r\n    /** Real coordinates */\r\n    public get location(): ICoordinates {\r\n        return { ...this._location };\r\n    }\r\n    /** List of zones associated with the building */\r\n    public get zones(): string[] {\r\n        return [...(this._zones || [])];\r\n    }\r\n    /** Searchable map features */\r\n    public get searchables(): IMapFeature[] {\r\n        return [...(this._searchables || [])];\r\n    }\r\n\r\n    /**\r\n     * Get search map feature for the given level ID\r\n     * @param level_id ID of level to grab features for\r\n     */\r\n    public featuresForLevel(level_id: string): IMapFeature[] {\r\n        return (this._searchables || []).filter(i => i.level_id === level_id);\r\n    }\r\n\r\n    /**\r\n     * Building objects are readonly and cannot be changed\r\n     */\r\n    public async save(): Promise<Building> {\r\n        throw new Error('Building objects are readonly and cannot be changed');\r\n    }\r\n\r\n    /**\r\n     * Building objects are readonly and cannot be deleted\r\n     */\r\n    public async delete(): Promise<void> {\r\n        throw new Error('Building objects are readonly and cannot be deleted');\r\n    }\r\n}\r\n","import { BaseDataClass } from '../base-api.class';\r\nimport { HashMap } from '../../../shared/utilities/types.utilities';\r\nimport { getItemWithKeys } from '../../../shared/utilities/general.utilities';\r\nimport { BaseAPIService } from '../base.service';\r\n\r\nexport class Organisation extends BaseDataClass {\r\n    /** Map of custom settings for the building */\r\n    private _settings: HashMap;\r\n\r\n    constructor(protected service: BaseAPIService<Organisation>, raw_data: HashMap) {\r\n        super(service, raw_data);\r\n        this._settings = raw_data.settings || {};\r\n    }\r\n\r\n    /**\r\n     * Get a custom building setting\r\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\r\n     */\r\n    public setting(key: string): any {\r\n        const keys = key.split('.');\r\n        const value = getItemWithKeys(keys, this._settings);\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Building objects are readonly and cannot be changed\r\n     */\r\n    public async save(): Promise<Organisation> {\r\n        throw new Error('Organisation objects are readonly and cannot be changed');\r\n    }\r\n\r\n    /**\r\n     * Building objects are readonly and cannot be deleted\r\n     */\r\n    public async delete(): Promise<void> {\r\n        throw new Error('Organisation objects are readonly and cannot be deleted');\r\n    }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ComposerService } from '@acaprojects/ngx-composer';\r\n\r\nimport { BaseAPIService } from '../base.service';\r\nimport { Organisation } from './organisation.class';\r\nimport { Building } from './building.class';\r\nimport { HashMap } from '../../../shared/utilities/types.utilities';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class OrganisationService extends BaseAPIService {\r\n    /** Organisation data for the application */\r\n    private _organisation: Organisation;\r\n    /** Actively displayed building */\r\n    private _active_building: string;\r\n    /** Whether an error was shown when loading organisation data */\r\n    private shown_error: boolean;\r\n\r\n    constructor(protected _composer: ComposerService) {\r\n        super(_composer);\r\n        this._name = 'Organisation';\r\n        this._api_route = 'zones';\r\n        this.set('buildings', []);\r\n    }\r\n\r\n    /**\r\n     * Get list of levels for the given building ID\r\n     * @param bld_id Building ID\r\n     */\r\n    public levels(bld_id: string): any[] {\r\n        return (this.buildings.find(i => i.id === bld_id) || {} as Building).levels;\r\n    }\r\n\r\n    /**\r\n     * Get a setting from the organisation or active building\r\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\r\n     */\r\n    public setting(key: string) {\r\n        return this.building.setting(key) || this._organisation.setting(key);\r\n    }\r\n\r\n    /** Active building */\r\n    public get building(): Building {\r\n        return (this.buildings.find(i => i.id === this._active_building));\r\n    }\r\n\r\n    public set building(bld: Building) {\r\n        if (bld instanceof Building) {\r\n            this._active_building = bld.id;\r\n        } else {\r\n            this._active_building = bld;\r\n        }\r\n    }\r\n\r\n    /** List of buildings for the organisation */\r\n    public get buildings(): Building[] {\r\n        return this.get<Building[]>('buildings') || [];\r\n    }\r\n\r\n    /**\r\n     * Get list of available equipment\r\n     * @param id ID of the building to get the list from. i.e. Defaults to the active building\r\n     */\r\n    public getExtras(id: string, bld_id?: string) {\r\n        const bld = (bld_id ? this.buildings.find(i => i.id === bld_id) : null) || this.building;\r\n        if (bld && id) {\r\n            return bld.extras.filter(i => i.id.indexOf(id) >= 0) || [];\r\n        }\r\n        return [];\r\n    }\r\n\r\n    /**\r\n     * Get the first level matching the list of given IDs\r\n     * @param ids List of ID to search with\r\n     */\r\n    public levelWithID(ids: string | string[]) {\r\n        const list = ids instanceof Array ? ids : [ids];\r\n        const bld_list = this.buildings;\r\n        for (const id of list) {\r\n            for (const bld of bld_list) {\r\n                for (const lvl of bld.levels) {\r\n                    if (lvl.id === id) {\r\n                        return lvl;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Initialise service data\r\n     */\r\n    protected load(): Promise<void> {\r\n        if (localStorage) {\r\n            this._active_building = localStorage.getItem(`${this.parent.name}.building`);\r\n        }\r\n        return new Promise((resolve) => {\r\n            this.loadOrganisation().then(() => {\r\n                this.loadBuildings().then(() => {\r\n                    this.loadLevels().then(() => resolve());\r\n                });\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Load organisation data for application\r\n     */\r\n    public loadOrganisation(): Promise<void> {\r\n        return new Promise<void>((resolve) => {\r\n            this.query({ tags: 'org', engine: true }).then((org_data) => {\r\n                this._organisation = new Organisation(this as any, org_data[0]);\r\n                this.set('organisation', this._organisation);\r\n                this.shown_error = false;\r\n                resolve();\r\n            }, _ => {\r\n                if (!this.shown_error) {\r\n                    this.shown_error = true;\r\n                    this.parent.notifyError('Error loading organisation data. Retrying...');\r\n                }\r\n                this.timeout('load_org', () => this.loadOrganisation().then(() => resolve()), 1000);\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Load buildings data for the organisation\r\n     */\r\n    public loadBuildings(): Promise<void> {\r\n        return new Promise<void>((resolve) => {\r\n            this.query({ tags: 'building', engine: true }).then((bld_data) => {\r\n                const buildings = (bld_data as HashMap[]).map(i => new Building(this as any, i));\r\n                this.set('buildings', buildings || []);\r\n                if (!this._active_building && buildings && buildings.length > 0) {\r\n                    this._active_building = buildings[0].id;\r\n                }\r\n                resolve();\r\n            }, _ => {\r\n                this.parent.notifyError('Error loading building data. Retrying...');\r\n                this.timeout('load_bld', () => this.loadBuildings().then(() => resolve()), 1000);\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Load levels data for the buildings\r\n     */\r\n    public loadLevels(): Promise<void> {\r\n        return new Promise<void>((resolve) => {\r\n            this.query({ tags: 'level', engine: true }).then((lvl_data) => {\r\n                resolve();\r\n            }, _ => {\r\n                this.parent.notifyError('Error loading level data. Retrying...');\r\n                this.timeout('load_lvl', () => this.loadLevels().then(() => resolve()), 1000);\r\n            });\r\n        });\r\n    }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { ComposerService } from '@acaprojects/ngx-composer';\r\n\r\nimport { BaseAPIService } from '../base.service';\r\nimport { HashMap } from 'src/app/shared/utilities/types.utilities';\r\n\r\nexport interface PollingMetadata {\r\n    room_id: string;\r\n    metadata?: HashMap<any>;\r\n}\r\n\r\nexport class PingHistory {\r\n    /** List of previous poll data */\r\n    readonly history: PollingMetadata[];\r\n    /** Unix time in seconds of the last poll request */\r\n    readonly last_ping: number;\r\n    /** Email of the associated space */\r\n    readonly room_email: string;\r\n    /** ID of the associated space */\r\n    readonly room_id: string;\r\n\r\n    constructor(data: HashMap) {\r\n        this.history = data.history;\r\n        this.last_ping = data.last_ping;\r\n        this.room_email = data.room_email;\r\n        this.room_id = data.room_id;\r\n    }\r\n}\r\n\r\nconst SECONDS = 1000;\r\nconst MINUTES = 60 * SECONDS;\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class PollingService extends BaseAPIService<PingHistory> {\r\n    constructor(protected _composer: ComposerService) {\r\n        super(_composer);\r\n        this._name = 'Users';\r\n        this._api_route = 'pings';\r\n    }\r\n\r\n    protected async load() {\r\n        this.interval('poll_endpoint', () => {\r\n            this.add({\r\n                room_id: this.parent.get('system')\r\n            });\r\n        }, 10 * MINUTES);\r\n    }\r\n\r\n    public query(...args: any): never {\r\n        throw new Error('Query method not available for polling endpoint');\r\n    }\r\n\r\n    public show(...args: any): never {\r\n        throw new Error('Show method not available for polling endpoint');\r\n    }\r\n\r\n    public update(...args: any): never {\r\n        throw new Error('Put method not available for polling endpoint');\r\n    }\r\n\r\n    public delete(...args: any): never {\r\n        throw new Error('delete method not available for polling endpoint');\r\n    }\r\n\r\n    protected process(data: HashMap) {\r\n        return new PingHistory(data);\r\n    }\r\n}\r\n","import { BaseDataClass } from '../base-api.class';\r\nimport { HashMap, Identity } from '../../../shared/utilities/types.utilities';\r\nimport { Booking } from '../bookings/booking.class';\r\nimport { BaseAPIService } from '../base.service';\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\nexport interface ISpaceAvailabilityOptions {\r\n    date?: number;\r\n    duration: number;\r\n    id?: string;\r\n    room_ids?: string;\r\n    bookable?: boolean;\r\n    rooms?: string;\r\n    ignore?: string;\r\n    zone_id?: string;\r\n    clear?: boolean;\r\n}\r\n\r\nconst OPTION_DEFAULTS: ISpaceAvailabilityOptions = {\r\n    duration: 60\r\n};\r\n\r\nexport class Space extends BaseDataClass {\r\n    /** Extends name for the space */\r\n    readonly long_name: string;\r\n    /** CSS selector for the location of the space of the level's map */\r\n    readonly map_id: string;\r\n    /** Type of space */\r\n    readonly type: string;\r\n    /** Whether user can search for this space */\r\n    readonly can_search: boolean;\r\n    /** Whether user can open the control URL if available */\r\n    readonly can_control: boolean;\r\n    /** Hourly cost for using the space */\r\n    readonly hourly_rate: number;\r\n    /** Whether space can be booked by users */\r\n    readonly bookable: boolean;\r\n    /** People capacity of the space */\r\n    readonly capacity: number;\r\n    /** Index to force order when sorting multiple spaces */\r\n    readonly sort_priority: number;\r\n    /** Setup time for bookings in this space */\r\n    readonly setup: number;\r\n    /** Breakdown time for bookings in this space */\r\n    readonly breakdown: number;\r\n    /** Last returned availability result */\r\n    readonly was_available: boolean;\r\n\r\n    /** Level in which the spaces is associated */\r\n    private _level: HashMap;\r\n    /** Bookings associated with the space */\r\n    private _bookings: string[];\r\n    /** Engine zones associated with the space */\r\n    private _zones: string[];\r\n    /** List of equipment available in the space */\r\n    private _extras: Identity[];\r\n    /** List of ids for linked spaces */\r\n    private _linked_spaces: string[];\r\n\r\n    constructor(protected service: BaseAPIService<Space>, raw_data: HashMap = {}) {\r\n        super(service, raw_data);\r\n        const settings = raw_data.settings || {};\r\n        this._level = this.service.parent.Organisation.levelWithID(raw_data.zones) || { settings: {} };\r\n\r\n        this.long_name = settings.long_name || raw_data.long_name;\r\n        this.map_id = settings.map_id || raw_data.map_id;\r\n        this.type = settings.book_type || this._level.book_type || this._level.settings.book_type || raw_data.book_type || raw_data.type || 'book';\r\n        this.can_search = settings.searchable || raw_data.searchable || raw_data.can_search || false;\r\n        this.can_control = settings.controlable || raw_data.controlable || raw_data.can_control || false;\r\n        this.hourly_rate = settings.cost_hour || raw_data.cost_hour || raw_data.hourly_rate || 0;\r\n        this.bookable = settings.bookable || raw_data.bookable || false;\r\n        this.setup = ((settings.setup || 0) / 60) || raw_data.setup || 0;\r\n        this.breakdown = ((settings.breakdown || 0) / 60) || raw_data.breakdown || 0;\r\n        this.capacity = raw_data.capacity || 0;\r\n        this.was_available = settings.available || raw_data.available || raw_data.was_available || false;\r\n\r\n        this._zones = raw_data.zones || [];\r\n        const raw_bookings = settings.bookings || raw_data.bookings || [];\r\n        this._bookings = raw_bookings.map(i => i.id);\r\n        if (this.service.parent && this.service.parent.Bookings) {\r\n            if (raw_bookings) {\r\n                const id_list = [];\r\n                raw_bookings.forEach(booking => {\r\n                    let id = booking.id;\r\n                    this.service.parent.Bookings.removeFrom(this.id, [id], 'class');\r\n                    id = this.service.parent.Bookings.addFrom(this.id, booking, 'class');\r\n                    id_list.push(id);\r\n                });\r\n                this._bookings = id_list;\r\n            }\r\n        }\r\n        this._extras = [];\r\n        this._linked_spaces = settings.linked_rooms || raw_data.linked_rooms || raw_data.linked_spaces || [];\r\n    }\r\n\r\n    /** Whether the space has a booking in progress */\r\n    public get in_use(): boolean {\r\n        return !!this.current;\r\n    }\r\n\r\n    /** Get any current in progress meeting */\r\n    public get current(): Booking {\r\n        const bookings = this.bookings;\r\n        for (const bkn of bookings) {\r\n            const status = bkn.status;\r\n            if (status === 'in_progress' || status === 'started') {\r\n                return bkn;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /** Get the next upcoming meeting */\r\n    public get next(): Booking {\r\n        const now = dayjs().valueOf();\r\n        const bookings = this.bookings;\r\n        for (const bkn of bookings) {\r\n            if (bkn.date > now) {\r\n                return bkn;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /** List of stored bookings for the space */\r\n    public get bookings(): Booking[] {\r\n        const booking_list = this.service && this.service.parent && this.service.parent.Bookings\r\n            ? this.service.parent.Bookings.list((booking) => this._bookings.indexOf(booking.id) >= 0) || []\r\n            : [];\r\n        return booking_list.sort((a, b) => a.date - b.date);\r\n    }\r\n\r\n    /** List of bookings for today */\r\n    public get todays_bookings(): Booking[] {\r\n        return this.bookingsFor(dayjs().valueOf());\r\n    }\r\n\r\n    /** List of ids for linked spaces */\r\n    public get linked_spaces() {\r\n        return [...this._linked_spaces];\r\n    }\r\n\r\n    /** Level in which the space is associated */\r\n    public get level(): HashMap {\r\n        return this._level;\r\n    }\r\n\r\n    /** Engine zones associated with the space */\r\n    public get zones(): string[] {\r\n        return [...this._zones];\r\n    }\r\n\r\n    /**\r\n     * Get bookings for space\r\n     * @param date Date to filter bookings on\r\n     */\r\n    public bookingsFor(date?: number): Booking[] {\r\n        if (date) {\r\n            const day = dayjs(date);\r\n            return this.bookings.filter(i => dayjs(i.date).isSame(day, 'd'));\r\n        } else {\r\n            return this.bookings;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Whether the space is available.\r\n     */\r\n    public isAvailable(options?: ISpaceAvailabilityOptions): Promise<boolean> {\r\n        options = options\r\n            ? { ...OPTION_DEFAULTS, ...options, room_ids: this.id }\r\n            : { ...OPTION_DEFAULTS, room_ids: this.id };\r\n        return new Promise((resolve) => {\r\n            (this.service as any).available(options).then((list: Space[]) => {\r\n                for (const rm of list) {\r\n                    if (rm.id === this.id) {\r\n                        return resolve(true);\r\n                    }\r\n                }\r\n                resolve(false);\r\n            }, () => resolve(false));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Make a copy of this object\r\n     */\r\n    public clone(): Space {\r\n        return new Space(this.service, this);\r\n    }\r\n\r\n    /**\r\n     * Make a copy of this object without identification data\r\n     */\r\n    public duplicate(): Space {\r\n        return new Space(this.service, { ...this, id: null, email: null, _bookings: [] });\r\n    }\r\n}\r\n","import { HashMap } from '../../../shared/utilities/types.utilities';\r\nimport { generateMockBooking } from '../bookings/booking.utilities';\r\n\r\nimport * as faker from 'faker';\r\nimport { USER_DOMAIN } from '../users/user.utilities';\r\n\r\nlet SPACE_COUNT: number = 0;\r\n\r\nexport function generateMockSpace(id?: string, zones?: string[]): HashMap {\r\n    if (!id) {\r\n        id = `space-${SPACE_COUNT++}`;\r\n    }\r\n    const name = `${faker.name.firstName()} ${faker.name.lastName()} Space`;\r\n    const linked = Math.floor(Math.random() * 99999) % 2 === 0 && SPACE_COUNT > 1;\r\n    return {\r\n        id,\r\n        name,\r\n        long_name: `${name} with an long name`,\r\n        map_id: `${SPACE_COUNT}`,\r\n        capacity: Math.floor(Math.random() * 20 + 1) * 2,\r\n        email: `${name.toLowerCase().split(' ').join('.')}@${USER_DOMAIN}`,\r\n        type: faker.commerce.productName(),\r\n        searchable: Math.floor(Math.random() * 99999) % 2 === 0,\r\n        controlable: Math.floor(Math.random() * 99999) % 2 === 0,\r\n        bookable: Math.floor(Math.random() * 99999) % 2 === 0,\r\n        cost_hour: Math.floor(Math.random() * 300) * 100,\r\n        setup: Math.floor(Math.random() * 6) * 5,\r\n        breakdown: Math.floor(Math.random() * 6) * 5,\r\n        zones: zones || ['zone_lvl-0'],\r\n        bookings: Array(10).fill(0).map(i => generateMockBooking()),\r\n        linked_rooms: linked ? [`space-${Math.floor(Math.random() * (SPACE_COUNT - 1))}`] : []\r\n    };\r\n}\r\n","\r\nimport { Injectable } from '@angular/core';\r\nimport { ComposerService } from '@acaprojects/ngx-composer';\r\n\r\nimport { BaseAPIService } from '../base.service';\r\nimport { Space, ISpaceAvailabilityOptions } from './space.class';\r\nimport { HashMap } from '../../../shared/utilities/types.utilities';\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class SpacesService extends BaseAPIService<Space> {\r\n\r\n    constructor(protected _composer: ComposerService) {\r\n        super(_composer);\r\n        this._name = 'Space';\r\n        this._api_route = 'rooms';\r\n        this._compare = (a, b) => !a.id.localeCompare(b.id) || !a.email.localeCompare(b.email);\r\n        this._list_filter = (a: Space) => {\r\n            const bld = this.parent.Organisation.building;\r\n            return a.level.bld_id === bld.id;\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Get available spaces\r\n     * @param options\r\n     */\r\n    public available(options: ISpaceAvailabilityOptions): Promise<Space[]> {\r\n        if (!options) { throw new Error('Space avilability requires request options'); }\r\n        if (!options.date) { options.date = dayjs().startOf('m').valueOf(); }\r\n        const key = `available|${options.id ? options.id : ''}`;\r\n        if (!this._promises[key]) {\r\n            this._promises[key] = new Promise((resolve, reject) => {\r\n                const respond = (list: Space[]) => {\r\n                    const available_spaces = list.filter(i => {\r\n                        const linked = list.filter(j => i.linked_spaces.indexOf(j.id) >= 0);\r\n                        return i.was_available && linked.reduce((a, v) => a && v.was_available, true);\r\n                    });\r\n                    resolve(available_spaces);\r\n                };\r\n                const error = (e) => reject(e);\r\n                if (options.id) {\r\n                    this.show(options.id, options).then((i) => respond([i]), error);\r\n                } else {\r\n                    this.query(options).then(respond, error);\r\n                }\r\n            });\r\n        }\r\n        return this._promises[key];\r\n    }\r\n\r\n    /**\r\n     * Load initial data for the service\r\n     */\r\n    protected async load(): Promise<void> {\r\n        await this.query();\r\n    }\r\n\r\n    /**\r\n     * Convert raw data into API object\r\n     * @param raw_data Raw API data\r\n     */\r\n    protected process(raw_data: HashMap): Space {\r\n        return new Space(this, raw_data);\r\n    }\r\n}\r\n","\r\nimport { Injectable } from '@angular/core';\r\nimport { ComposerService } from '@acaprojects/ngx-composer';\r\nimport { EngineSystemsService, EngineModuleBinding, EngineSystem } from '@acaprojects/ts-composer';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\nimport { ApplicationService } from '../../app.service';\r\nimport { BaseClass } from '../../../shared/base.class';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class SystemsManagerService extends BaseClass {\r\n    /** Application service */\r\n    public parent: ApplicationService;\r\n    /** Composer resource service */\r\n    private _resources: EngineSystemsService;\r\n    /** Subject for System list */\r\n    private _list = new BehaviorSubject<EngineSystem[]>([]);\r\n\r\n    constructor(private _composer: ComposerService) {\r\n        super();\r\n        this._composer.initialised.subscribe((state) => {\r\n            if (state) {\r\n                this._resources = this._composer.systems;\r\n                this.load();\r\n            }\r\n        });\r\n    }\r\n\r\n    /** List of available systems */\r\n    public get list() {\r\n        return this._list.getValue() || [];\r\n    }\r\n\r\n    /**\r\n     * List to changes on observable\r\n     * @param name Name of the observable\r\n     * @param next Callback for changes to the observable\r\n     */\r\n    public listen(name: 'list', next: (list: EngineSystem[]) => void) {\r\n        return this._list.subscribe(next);\r\n    }\r\n\r\n    /**\r\n     * Get engine module for the given system\r\n     * @param sys_id ID of the system to get the module from\r\n     * @param mod_id ID of the module with the given system\r\n     * @param index Index of the module\r\n     */\r\n    public get(sys_id: string, mod_id: string, index?: number): EngineModuleBinding {\r\n        return this._composer.bindings.module(sys_id, mod_id, index);\r\n    }\r\n\r\n    /**\r\n     * Load Systems\r\n     */\r\n    protected load() {\r\n        if (!this.parent || !this.parent.is_initialised || !this.parent.Users || !this.parent.Users.initialised) {\r\n            return this.timeout('load', () => this.load());\r\n        }\r\n        this.loadSystems();\r\n    }\r\n\r\n    /**\r\n     * Load one page of systems\r\n     * @param offset Item offset for the page to load\r\n     */\r\n    protected loadSystems(offset: number = 0, limit: number = 250) {\r\n        this._resources.query({ offset, limit }).then((list) => {\r\n            const total = this._resources.last_total;\r\n            const systems: EngineSystem[] = [...this.list, ...list];\r\n            this._list.next(systems.sort((a, b) => (a.name || '').localeCompare(b.name)));\r\n            if (systems.length < total) {\r\n                this.loadSystems(systems.length);\r\n            }\r\n        });\r\n    }\r\n}\r\n","import { ADynamicFormField } from '@acaprojects/ngx-dynamic-forms';\r\n\r\nimport { BaseDataClass } from '../base-api.class';\r\nimport { HashMap, Identity } from '../../../shared/utilities/types.utilities';\r\nimport { BaseAPIService } from '../base.service';\r\n\r\nexport interface ILocation {\r\n    x?: number;\r\n    y?: number;\r\n    name?: string;\r\n    map_id?: string;\r\n    building: string;\r\n    level: string | Identity;\r\n    fixed: boolean;\r\n    loc_id?: string;\r\n    display?: { [name: string]: string };\r\n    confidence?: number;\r\n    another_bld?: boolean;\r\n    at_desk?: boolean;\r\n}\r\n\r\nexport class User extends BaseDataClass {\r\n    /** First name of the user */\r\n    readonly first_name: string;\r\n    /** Last name of the user */\r\n    readonly last_name: string;\r\n    /** Windows user ID */\r\n    readonly windows_id: string;\r\n    /** Type of user */\r\n    readonly type: 'partner' | 'external' | 'internal';\r\n    /** Contact phone number of the user */\r\n    readonly phone: string;\r\n    /** Organisational department the user is part of */\r\n    readonly business_unit: string;\r\n    /** Whether user is external from the application's organisation */\r\n    readonly external: boolean;\r\n    /** Organisational Identifier for the user */\r\n    readonly staff_code: string;\r\n    /** Organisation the user is associated with */\r\n    private _organisation: Identity;\r\n    /** Map location of the user */\r\n    private _location: ILocation;\r\n    /** List of users that this user can act on behalf */\r\n    private _delegates: string[];\r\n\r\n    constructor(protected service: BaseAPIService<User>, raw_data: HashMap = {}) {\r\n        super(service, raw_data);\r\n        this.first_name = raw_data.first_name;\r\n        this.last_name = raw_data.last_name;\r\n        this.windows_id = raw_data.email;\r\n        this.type = raw_data.visitor ? 'external' : raw_data.type || 'internal';\r\n        this.phone = raw_data.phone || raw_data.mobile;\r\n        this.business_unit = raw_data.business_unit || raw_data.department;\r\n        this._organisation = raw_data.organisation || { id: raw_data.organisation_id, name: raw_data.organisation_name };\r\n        this.external = this.type === 'external';\r\n        this._location = null;\r\n        this.staff_code = raw_data.staff_code || raw_data.fmno;\r\n        this._delegates = raw_data.delegates;\r\n    }\r\n\r\n    /** Organisation the user is associated with */\r\n    public get organisation() {\r\n        return this._organisation;\r\n    }\r\n\r\n    /** Map location of the user */\r\n    public get last_location(): ILocation {\r\n        return this._location ? { ...(this._location) } : null;\r\n    }\r\n\r\n    /** List of users that this user can act on behalf */\r\n    public get delegates(): string[] {\r\n        return [...(this._delegates || [])];\r\n    }\r\n\r\n    /**\r\n     * Ask the server for the users current location\r\n     */\r\n    public locate(): Promise<ILocation> {\r\n        const service: any = this.service.parent || {};\r\n        return new Promise((resolve, reject) => {\r\n            if (service.Location) {\r\n                service.Location.show(this.id, { desk: this.email }).then(\r\n                    l => {\r\n                        this._location = l;\r\n                        resolve(l);\r\n                    },\r\n                    e => reject(e)\r\n                );\r\n            } else {\r\n                resolve(null);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Whether user is available during the given period\r\n     * @param start Start time as a unix timestamp with milliseconds\r\n     * @param end End time as a unix timestamp with milliseconds\r\n     */\r\n    public available(start?: number, end?: number): Promise<boolean> {\r\n        return new Promise<boolean>(resolve => {\r\n            this.service.query({ email: this.email, start, end })\r\n                .then(l => resolve(l && l.length > 0), _ => resolve(false));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Make a copy of this object\r\n     */\r\n    public clone(): User {\r\n        return new User(this.service, this);\r\n    }\r\n\r\n    /**\r\n     * Make a copy of this object without identification data\r\n     */\r\n    public duplicate(): User {\r\n        return new User(this.service, { ...this, id: null, email: null });\r\n    }\r\n\r\n    /**\r\n     * Initialise the form field metadata for the field\r\n     */\r\n    protected initialiseFormFields(): ADynamicFormField[] {\r\n        const edit = !!this.id;\r\n        const fields: ADynamicFormField[] = [\r\n            new ADynamicFormField({\r\n                key: 'name',\r\n                type: 'input',\r\n                value: this.name,\r\n                hide: true\r\n            }),\r\n            new ADynamicFormField({\r\n                key: 'first_name',\r\n                label: 'First Name',\r\n                type: 'input',\r\n                value: this.first_name,\r\n                required: true\r\n            }),\r\n            new ADynamicFormField({\r\n                key: 'last_name',\r\n                label: 'Last Name',\r\n                type: 'input',\r\n                value: this.last_name,\r\n                required: true\r\n            }),\r\n            new ADynamicFormField({\r\n                key: 'email',\r\n                label: 'Email',\r\n                type: 'input',\r\n                value: this.email,\r\n                required: true,\r\n                attributes: { type: 'email' }\r\n            })\r\n        ];\r\n        return fields;\r\n    }\r\n}\r\n","import { HashMap } from '../../../shared/utilities/types.utilities';\r\n\r\nimport * as faker from 'faker';\r\nimport { padZero, unique } from '../../../shared/utilities/general.utilities';\r\n\r\nlet USER_COUNT = 0;\r\n\r\nexport let USER_DOMAIN = 'acaprojects.com';\r\n\r\nconst USER_EMAILS: string[] = [];\r\n\r\n/**\r\n * Generate raw mock data for a user\r\n * @param id Forced ID for the mock\r\n * @param name Forced name for the user\r\n * @param external Whether user is external of the organisation\r\n */\r\nexport function generateMockUser(id?: string, name?: string, external?: boolean): HashMap {\r\n    if (!id) {\r\n        id = `user-${USER_COUNT++}`;\r\n    }\r\n    if (!name) {\r\n        name = `${faker.name.firstName()} ${faker.name.lastName()}`;\r\n    }\r\n    if (external === undefined) {\r\n        external = !((Math.random() * 99999) % 2);\r\n    }\r\n    const organisation = external ? faker.company.companyName() : USER_DOMAIN.split('.')[0];\r\n    let delegates: string[] = [];\r\n    const delegate_count = Math.min(Math.random() * 4 + 1, USER_EMAILS.length);\r\n    for (let i = 0; i < delegate_count; i++) {\r\n        delegates.push(USER_EMAILS[Math.floor(Math.random() * USER_EMAILS.length)]);\r\n    }\r\n    delegates = unique(delegates);\r\n    const email = `${name.split(' ').join('.').toLowerCase()}@${external ? 'not-' : ''}${USER_DOMAIN}`;\r\n    USER_EMAILS.push(email);\r\n    return {\r\n        id,\r\n        name,\r\n        email,\r\n        phone: faker.phone.phoneNumber(),\r\n        visitor: external,\r\n        organisation: {\r\n            id: organisation.split(' ').join('.').toLowerCase(),\r\n            name: organisation\r\n        },\r\n        department: faker.commerce.department(),\r\n        staff_code: padZero(Math.floor(Math.random() * 99999), 5),\r\n        delegates\r\n    };\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Location } from '@angular/common';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport { ComposerService } from '@acaprojects/ngx-composer';\r\nimport { Md5 } from 'ts-md5/dist/md5';\r\n\r\nimport { BaseAPIService } from '../base.service';\r\nimport { User } from './user.class';\r\nimport { HashMap } from '../../../shared/utilities/types.utilities';\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\nexport interface ILoginOptions {\r\n    /** URL to post login request to */\r\n    url?: string;\r\n    /** Whether form data is passed in the body of the request */\r\n    form?: boolean;\r\n    /** Custom headers to pass into the post request */\r\n    headers?: HashMap<string>;\r\n}\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class UsersService extends BaseAPIService<User> {\r\n    constructor(protected _composer: ComposerService, protected uhttp: HttpClient, protected location: Location) {\r\n        super(_composer);\r\n        this._name = 'Users';\r\n        this._api_route = 'users';\r\n        this._compare = (a, b) => !a.id.localeCompare(b.id) || !a.email.localeCompare(b.email);\r\n        this.set('current_user', new User(this, { id: 'local_user', name: 'Local User' }));\r\n    }\r\n\r\n    /** Currently logged in user */\r\n    public get current(): User {\r\n        return this.get('current_user');\r\n    }\r\n\r\n    /**\r\n     * Sets the access token and expiry for the user\r\n     * @param token OAuth bearer token\r\n     * @param expiry Expiry epoch timestamp in ms\r\n     * @param reload Whether to reload the page after setting tokens\r\n     */\r\n    public setToken(token: string, expiry?: number, reload: boolean = true) {\r\n        if (!expiry) {\r\n            expiry = dayjs()\r\n                .add(7, 'd').endOf('d')\r\n                .valueOf();\r\n        }\r\n        const path = `${location.origin}${this.parent.setting('composer.route') || ''}/oauth-resp.html`;\r\n        const client_id = Md5.hashStr(path);\r\n        if (sessionStorage) {\r\n            sessionStorage.setItem(`${client_id}_access_token`, token);\r\n            sessionStorage.setItem(`${client_id}_expires_at`, `${expiry}`);\r\n        }\r\n        if (localStorage) {\r\n            localStorage.setItem(`${client_id}_access_token`, token);\r\n            localStorage.setItem(`${client_id}_expires_at`, `${expiry}`);\r\n        }\r\n        if (reload) {\r\n            this.location.go(this.location.path());\r\n        }\r\n        return path;\r\n    }\r\n\r\n    /**\r\n     * Post login request to the API\r\n     * @param query_params Key value pairs to pass into\r\n     * @param options Options for the login request\r\n     */\r\n    public login(query_params: HashMap, options: ILoginOptions = {}): Promise<void> {\r\n        if (!this._promises['login']) {\r\n            this._promises['login'] = new Promise<void>((resolve, reject) => {\r\n                this.set('status', 'loading');\r\n                let headers = new HttpHeaders();\r\n                if (!options || options.form !== false) {\r\n                    headers = headers.append('Content-Type', 'application/x-www-form-urlencoded');\r\n                }\r\n                const url = (options ? options.url : '') || '/auth/signin';\r\n                this.uhttp.post(url, query_params, { headers }).subscribe(\r\n                    _ => null,\r\n                    e => reject(e),\r\n                    () => {\r\n                        this._composer.auth.authorise();\r\n                        resolve();\r\n                    }\r\n                );\r\n            });\r\n        }\r\n        return this._promises['login'];\r\n    }\r\n\r\n    /**\r\n     * Logout of user and redirect to logout URL\r\n     */\r\n    public logout() {\r\n        this._composer.auth.logout();\r\n    }\r\n\r\n    /**\r\n     * Load initial data for the service\r\n     */\r\n    protected load(tries: number = 0): Promise<void> {\r\n        this.set('status', 'loading');\r\n        return new Promise<void>(resolve => {\r\n            if (tries > 4) {\r\n                this.set('status', 'invalid');\r\n                return resolve();\r\n            }\r\n            this.show('current', { engine: true }).then(\r\n                current_user => {\r\n                    this.set('status', 'available');\r\n                    this.set('current_user', current_user);\r\n                    if (this.parent && this.parent.setting('app.user.grab_api_details')) {\r\n                        this.show(current_user.email).then(\r\n                            user => {\r\n                                this.set('current_user', user);\r\n                                resolve();\r\n                            },\r\n                            () => this.timeout('load', () => this.load(++tries).then(() => resolve()))\r\n                        );\r\n                    } else {\r\n                        resolve();\r\n                    }\r\n                },\r\n                () => this.timeout('load', () => this.load(++tries).then(() => resolve()))\r\n            );\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Convert raw API data into a valid User Object\r\n     * @param raw_item Raw API data\r\n     */\r\n    protected process(raw_data: any): User {\r\n        return new User(this, raw_data);\r\n    }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, Observable, Subscription } from 'rxjs';\r\n\r\nimport { HashMap } from '../shared/utilities/types.utilities';\r\nimport { unique } from '../shared/utilities/general.utilities';\r\n\r\n/** List of keys that cannot be in a combination by themselves or with each other */\r\nconst INVALID_STANDALONE_KEYS: string[] = ['control', 'shift', 'alt', 'meta', 'os'];\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class HotkeysService {\r\n    /** Map of subjects which store press states of keys */\r\n    private keydown_states: HashMap<BehaviorSubject<number>> = {};\r\n    /** Map of obserers for key state subjects */\r\n    private keydown_observers: HashMap<Observable<number>> = {};\r\n    /** List of keys at the end of a combination */\r\n    private combo_end: string[] = [];\r\n    /** List of registered hotkey combinations */\r\n    private registered_combos: string[][] = [];\r\n    /** Counter for the number of keydown events. Used for checking order of key presses */\r\n    private counter: number = 0;\r\n    /** Last key code to be pressed */\r\n    private last_down: string;\r\n\r\n    constructor() {\r\n        window.addEventListener('keydown', (event: KeyboardEvent) => {\r\n            const code = this.mapKey((event.code || '').toLowerCase());\r\n            if (this.last_down !== code) {\r\n                if (!this.keydown_states[code]) {\r\n                    this.keydown_states[code] = new BehaviorSubject(null);\r\n                    this.keydown_observers[code] = this.keydown_states[code].asObservable();\r\n                }\r\n                this.keydown_states[code].next(this.counter++);\r\n                if (this.combo_end.indexOf(code) >= 0) {\r\n                    event.preventDefault();\r\n                }\r\n                this.last_down = code;\r\n            }\r\n        });\r\n\r\n        window.addEventListener('keyup', (event: KeyboardEvent) => {\r\n            const code = this.mapKey((event.code || '').toLowerCase());\r\n            this.keydown_states[code].next(null);\r\n            if (this.last_down === code) {\r\n                this.last_down = null;\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Listen to the given key combination\r\n     * @param combo Array of key codes to listen to or a hotkey string e.g. `Alt+Shift+KeyK`\r\n     * @param next Callback for combination presses\r\n     */\r\n    public listen(combo: string | string[], next: () => void): Subscription {\r\n        combo = (combo instanceof Array ? combo : combo.split('+'));\r\n        const combination: string[] = combo.map(i => this.mapKey(i.toLowerCase()));\r\n        if (combination.length > 0 && this.validCombination(combination)) {\r\n            this.registered_combos.push(combination);\r\n            const last_key = combination[combination.length - 1];\r\n            if (!this.keydown_states[last_key]) {\r\n                this.keydown_states[last_key] = new BehaviorSubject(null);\r\n                this.keydown_observers[last_key] = this.keydown_states[last_key].asObservable();\r\n            }\r\n            this.updateCombinationEndList();\r\n            return this.keydown_observers[last_key].subscribe((count) => {\r\n                if (count) {\r\n                    const presses: number[] = [];\r\n                    if (combination.length > 1) {\r\n                        // Check that keys are pressed\r\n                        for (const key of combination) {\r\n                            const state = this.keydown_states[key];\r\n                            presses.push(state ? state.getValue() || -1 : -1);\r\n                        }\r\n                        // Check that keys are pressed in the correct order\r\n                        for (let i = 0; i < combination.length - 1; i++) {\r\n                            if (presses[i] > presses[i + 1]) { return; }\r\n                        }\r\n                    }\r\n                    next();\r\n                }\r\n            });\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Map key codes with multiple versions to simple form\r\n     * @param code Code to transform\r\n     */\r\n    private mapKey(code: string): string {\r\n        if (code.indexOf('alt') || code.indexOf('shift') || code.indexOf('control')) {\r\n            return code.replace('left', '').replace('right', '');\r\n        }\r\n        return code;\r\n    }\r\n\r\n    /**\r\n     * Update the list of the last keys in combinations to allow for prevent default actions on pre-existing hotkeys\r\n     */\r\n    private updateCombinationEndList(): void {\r\n        const key_list = [];\r\n        for (const combo of this.registered_combos) {\r\n            this.combo_end.push(combo[combo.length - 1]);\r\n        }\r\n        this.combo_end = unique(key_list);\r\n    }\r\n\r\n    /**\r\n     * Checks if the given hotkey combination is allowed and valid\r\n     * @param combo Array of key codes\r\n     */\r\n    private validCombination(combo: string[]): boolean {\r\n        let non_meta = 0;\r\n        for (const key of combo) {\r\n            if (INVALID_STANDALONE_KEYS.indexOf(key) < 0) {\r\n                non_meta++;\r\n            }\r\n        }\r\n        return non_meta > 0;\r\n    }\r\n}","import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\n\r\nimport { HashMap } from '../shared/utilities/types.utilities';\r\nimport { getItemWithKeys } from '../shared/utilities/general.utilities';\r\nimport { BaseClass } from '../shared/base.class';\r\nimport { VERSION } from 'src/environments/version';\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\ninterface SettingsMap {\r\n    api: HashMap;\r\n    local: HashMap;\r\n    session: HashMap;\r\n    [block: string]: HashMap;\r\n}\r\n\r\ndeclare global {\r\n    interface Window {\r\n        debug: boolean;\r\n    }\r\n}\r\n\r\nexport type ConsoleStream = 'debug' | 'warn' | 'log' | 'error';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class SettingsService extends BaseClass {\r\n\r\n    /** Map of settings */\r\n    private _settings: SettingsMap = { api: {}, local: {}, session: {} };\r\n    /** Store for promises */\r\n    private _promises: { [name: string]: Promise<any> } = {};\r\n    /** Name of the application */\r\n    private _app_name = 'PlaceOS';\r\n\r\n    constructor(private http: HttpClient) {\r\n        super();\r\n        const now = dayjs();\r\n        const build = dayjs(VERSION.time);\r\n        const built = now.isSame(build, 'd') ? `Today at ${build.format('h:mmA')}` : build.format('D MMM YYYY, h:mmA');\r\n        this.log('CORE', `${VERSION.core_version}`, null, 'debug', true);\r\n        this.log('APP', `${VERSION.version} - ${VERSION.hash} | Built: ${built}`, null, 'debug', true);\r\n        this.init();\r\n    }\r\n\r\n    /**\r\n     * Initialise the settings\r\n     */\r\n    public async init() {\r\n        await this.loadFromFile('api');\r\n        /* istanbul ignore next */\r\n        if (this._settings.api.debug) {\r\n            window.debug = true;\r\n        }\r\n        /* istanbul ignore next */\r\n        if (this._settings.api.app && this._settings.api.app.name) {\r\n            this._app_name = this._settings.api.app.name;\r\n        }\r\n        this.log('Settings', 'Successfully loaded settings');\r\n        this._initialised.next(true);\r\n    }\r\n\r\n    /** Whether settings service has initialised */\r\n    public get app_name() { return this._app_name; }\r\n\r\n    /* istanbul ignore next */\r\n    /**\r\n     * Log data to the browser console\r\n     * @param type Type of message\r\n     * @param msg Message body\r\n     * @param args array of argments to log to the console\r\n     * @param stream Stream to emit the console on. 'debug', 'log', 'warn' or 'error'\r\n     * @param force Whether to force message to be emitted when debug is disabled\r\n     */\r\n    public log(type: string, msg: string, args?: any, stream: ConsoleStream = 'debug', force: boolean = false) {\r\n        if (window.debug || force) {\r\n            const colors: string[] = ['color: #E91E63', 'color: #3F51B5', 'color: default'];\r\n            if (args) {\r\n                console[stream](`%c[${this.app_name}]%c[${type}] %c${msg}`, ...colors, args);\r\n            } else {\r\n                console[stream](`%c[${this.app_name}]%c[${type}] %c${msg}`, ...colors);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get a setting\r\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\r\n     */\r\n    public get(key: string): any {\r\n        const keys = key.split('.');\r\n        let value = null;\r\n        value = getItemWithKeys(keys, this._settings.api) ||\r\n            getItemWithKeys(keys, this._settings.session) ||\r\n            getItemWithKeys(keys, this._settings.local);\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Load setting data from a file\r\n     * @param name Namespace to add file data to\r\n     * @param file URL to file to load setting data from\r\n     */\r\n    private async loadFromFile(name: string, file: string = 'assets/settings.json', tries: number = 0) {\r\n        if (file !== 'assets/settings.json' && tries > 5) {\r\n            return Promise.resolve();\r\n        }\r\n        const file_name = file.split('/')[file.split('/').length - 1];\r\n        // Check if data has been loaded into the global space\r\n        if (window[file_name] instanceof Object) {\r\n            this._settings[name] = { ...(this._settings[name] || {}), ...window[file_name] };\r\n            return Promise.resolve();\r\n        }\r\n        const key = `load|${name}|${file}`;\r\n        if (!this._promises[key]) {\r\n            this._promises[key] = new Promise<void>((resolve, reject) => {\r\n                this.http.get(file).subscribe(\r\n                    (data) => {\r\n                        this._settings[name] = { ...(this._settings[name] || {}), ...(data || {}) };\r\n                    }, (e) => {\r\n                        this.log('Settings', `Failed to load settings from \"${file}\"`);\r\n                        this._promises[key] = null;\r\n                        this.timeout(`load_${file_name}`, () => {\r\n                            this.loadFromFile(name, file, ++tries).then(() => resolve());\r\n                        })\r\n                    }, () => resolve()\r\n                );\r\n            });\r\n        }\r\n        return this._promises[key];\r\n    }\r\n\r\n}\r\n","import { Subscription, BehaviorSubject } from \"rxjs\";\r\n\r\nexport class BaseClass {\r\n    /** Store for named timers */\r\n    protected _timers: { [name: string]: number } = {};\r\n    /** Store for named intervals */\r\n    protected _intervals: { [name: string]: number } = {};\r\n    /** Store for named subscription unsub callbacks */\r\n    protected _subscriptions: { [name: string]: (Subscription | (() => void)) } = {};\r\n    /** Subject which stores the initialised state of the object */\r\n    protected readonly _initialised = new BehaviorSubject<boolean>(false);\r\n\r\n    /** Observable of the initialised state of the object */\r\n    public get initialised(): BehaviorSubject<boolean> {\r\n        return this._initialised;\r\n    }\r\n    /** Whether the object has been initialised */\r\n    public get is_initialised(): boolean {\r\n        return this._initialised.getValue();\r\n    }\r\n\r\n    /**\r\n     * Creates a named timer\r\n     * @param name Name of the timer\r\n     * @param fn Callback function for the timer\r\n     * @param delay Callback delay\r\n     */\r\n    protected timeout(name: string, fn: () => void, delay: number = 300) {\r\n        if (name && fn && fn instanceof Function) {\r\n            this.clearTimeout(name);\r\n            this._timers[name] = <any>setTimeout(() => {\r\n                fn();\r\n                this._timers[name] = null;\r\n            }, delay);\r\n        } else {\r\n            throw new Error(\r\n                name ? 'Cannot create named timeout without a name' : 'Cannot create a timeout without a callback'\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Clears the named timer\r\n     * @param name Timer name\r\n     */\r\n    protected clearTimeout(name: string) {\r\n        if (this._timers[name]) {\r\n            clearTimeout(this._timers[name]);\r\n            this._timers[name] = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a named interval\r\n     * @param name Name of the interval\r\n     * @param fn Callback function for the interval\r\n     * @param delay Callback delay\r\n     */\r\n    protected interval(name: string, fn: () => void, delay: number = 300) {\r\n        if (name && fn && fn instanceof Function) {\r\n            this.clearInterval(name);\r\n            this._intervals[name] = <any>setInterval(() => fn(), delay);\r\n        } else {\r\n            throw new Error(\r\n                name ? 'Cannot create named interval without a name' : 'Cannot create a interval without a callback'\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Clears the named interval\r\n     * @param name Timer name\r\n     */\r\n    protected clearInterval(name: string) {\r\n        if (this._intervals[name]) {\r\n            clearInterval(this._intervals[name]);\r\n            this._intervals[name] = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Store named subscription\r\n     * @param name Name of the subscription\r\n     * @param unsub Unsubscribe callback or Subscription object\r\n     */\r\n    protected subscription(name: string, unsub: Subscription | (() => void)) {\r\n        this.unsub(name);\r\n        this._subscriptions[name] = unsub\r\n    }\r\n\r\n    /**\r\n     * Call unsubscribe callback with the given name\r\n     * @param name\r\n     */\r\n    protected unsub(name: string) {\r\n        if (this._subscriptions && this._subscriptions[name]) {\r\n            if (this._subscriptions[name] instanceof Subscription) {\r\n                (this._subscriptions[name] as Subscription).unsubscribe()\r\n            } else if (this._subscriptions[name] instanceof Function) {\r\n                (this._subscriptions[name] as any)();\r\n            }\r\n            this._subscriptions[name] = null;\r\n        }\r\n    }\r\n}\r\n","\r\nimport { Component, OnDestroy } from '@angular/core';\r\nimport { BaseClass } from './base.class';\r\n\r\n@Component({\r\n    selector: 'a-very-basic-component-base-that-should-not-be-used',\r\n    template: ``,\r\n    styles: [``]\r\n})\r\nexport class BaseComponent extends BaseClass implements OnDestroy {\r\n\r\n    public ngOnDestroy(): void {\r\n        // Clear local timers\r\n        for (const key in this._timers) {\r\n            if (this._timers.hasOwnProperty(key)) {\r\n                this.clearTimeout(key);\r\n            }\r\n        }\r\n        // Clear local intervals\r\n        for (const key in this._intervals) {\r\n            if (this._intervals.hasOwnProperty(key)) {\r\n                this.clearInterval(key);\r\n            }\r\n        }\r\n        // Clear local subscriptions\r\n        for (const key in this._subscriptions) {\r\n            if (this._subscriptions.hasOwnProperty(key)) {\r\n                this.unsub(key);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n","<div *ngIf=\"group\">\r\n    <a-dropdown [items]=\"options\" [(ngModel)]=\"active_duration\" placeholder=\"Select duration...\" (ngModelChange)=\"setValue($event)\"></a-dropdown>\r\n</div>\r\n","import { Component } from '@angular/core';\r\nimport { FormGroup, AbstractControl } from '@angular/forms';\r\nimport { ADynamicFormField } from '@acaprojects/ngx-dynamic-forms';\r\n\r\nimport { BaseComponent } from '../../base.component';\r\nimport { getNextFreeBookingSlot } from '../../../services/data/bookings/booking.utilities';\r\nimport { humaniseDuration } from '../../utilities/general.utilities';\r\nimport { FORM_FIELDS } from '../../globals/form-fields';\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\n@Component({\r\n    selector: 'custom-duration-field',\r\n    templateUrl: './duration-field.component.html',\r\n    styleUrls: ['./duration-field.component.scss']\r\n})\r\nexport class CustomDurationFieldComponent extends BaseComponent  {\r\n    /** Form Control holding date data */\r\n    public date_control: AbstractControl;\r\n    /** Form Control holding space data */\r\n    public space_control: AbstractControl;\r\n    /** Step size for available times */\r\n    public block_size = 15;\r\n    /** Step size for available times */\r\n    public active_duration: { id: number, name: string };\r\n    /** List of available durations */\r\n    public options: { id: number, name: string }[] = [];\r\n\r\n    constructor(protected field: ADynamicFormField, public group: FormGroup) {\r\n        super();\r\n    }\r\n\r\n    public ngOnInit(): void {\r\n        if (this.group) {\r\n            if (this.group.controls.date) {\r\n                this.date_control = this.group.controls.date;\r\n                this.subscription('date', this.date_control.valueChanges.subscribe(() => this.calculateAvailableDurations()));\r\n            }\r\n            if (this.group.controls.room || this.group.controls.space) {\r\n                this.space_control = this.group.controls.room || this.group.controls.space;\r\n                this.subscription('space', this.space_control.valueChanges.subscribe(() => this.calculateAvailableDurations()));\r\n            }\r\n            this.subscription('control', this.field.control.valueChanges.subscribe(() => this.updateDisplay()));\r\n        }\r\n        this.calculateAvailableDurations();\r\n    }\r\n\r\n    /**\r\n     * Update the active value displayed on the dropdown\r\n     */\r\n    public updateDisplay() {\r\n        if (this.options && this.options.length > 0) {\r\n            if (!this.active_duration) {\r\n                if (this.field.getValue()) {\r\n                    this.active_duration = this.options.find(i => i.id === this.field.getValue());\r\n                }\r\n                if (!this.active_duration) {\r\n                    this.active_duration = this.options[0];\r\n                    this.setValue(this.options[0]);\r\n                }\r\n            } else if (!this.options.find(i => i.id === this.active_duration.id)) {\r\n                let diff = 9999;\r\n                let new_opt = null;\r\n                for (const option of this.options) {\r\n                    if (Math.abs(option.id - this.active_duration.id) < diff) {\r\n                        diff = Math.abs(option.id - this.active_duration.id);\r\n                        new_opt = option;\r\n                    }\r\n                }\r\n                if (new_opt) {\r\n                    this.active_duration = new_opt;\r\n                    this.setValue(new_opt);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Generate a list of times selectable by the user\r\n     */\r\n    public calculateAvailableDurations() {\r\n        this.options = [];\r\n        let date = dayjs().startOf('m');\r\n        const max_duration = this.field.metadata ? this.field.metadata.max_duration || 600 : 600;\r\n        const min_duration = this.field.metadata ? this.field.metadata.min_duration || 30 : 30;\r\n        let end = date.add(max_duration, 'm');\r\n        if (this.space_control) {\r\n            // Get times based off available times in space\r\n            if (this.date_control && this.date_control.value) {\r\n                date = dayjs(this.date_control.value).startOf('m');\r\n            }\r\n            const slot = getNextFreeBookingSlot(this.space_control.value.bookings, date.valueOf(), min_duration);\r\n            if (slot) {\r\n                // Check if slot is after the active date\r\n                date = slot.start > date.valueOf() ? dayjs(slot.start).startOf('m') : date;\r\n            }\r\n            end = slot ? dayjs(slot.end).startOf('m') : dayjs(date).add(max_duration, 'm');\r\n        }\r\n        end = end.endOf('m');\r\n        // Get available durations between the date and end times\r\n        date = date.add(min_duration, 'm').startOf('m');\r\n        let duration = min_duration;\r\n        for (; date.isBefore(end, 's'); date = date.add(this.block_size, 'm')) {\r\n            this.options.push({ id: duration, name: humaniseDuration(duration) });\r\n            duration += 15;\r\n            if (this.options.length > Math.floor((max_duration - min_duration) / this.block_size)) {\r\n                break;\r\n            }\r\n        }\r\n        this.updateDisplay();\r\n    }\r\n\r\n    /**\r\n     * Update the value of the form field\r\n     * @param value New value\r\n     */\r\n    public setValue(block: { id: number, name: string }) {\r\n        this.field.setValue(block.id);\r\n    }\r\n}\r\n\r\nFORM_FIELDS.duration = CustomDurationFieldComponent;\r\n","<div *ngIf=\"group\">\r\n    <a-dropdown [items]=\"times\" [(ngModel)]=\"active_time\" placeholder=\"Select time...\" (ngModelChange)=\"setValue($event)\"></a-dropdown>\r\n</div>\r\n","import { Component } from '@angular/core';\r\nimport { FormGroup, AbstractControl } from '@angular/forms';\r\n\r\nimport { BaseComponent } from '../../base.component';\r\nimport { ADynamicFormField } from '@acaprojects/ngx-dynamic-forms';\r\nimport { getFreeBookingSlots } from '../../../services/data/bookings/booking.utilities';\r\n\r\nimport * as dayjs from 'dayjs';\r\nimport { FORM_FIELDS } from '../../globals/form-fields';\r\n\r\ninterface TimeSlot {\r\n    id: string;\r\n    name: string;\r\n    value?: number;\r\n}\r\n\r\n@Component({\r\n    selector: 'custom-time-field',\r\n    templateUrl: './time-field.component.html',\r\n    styleUrls: ['./time-field.component.scss']\r\n})\r\nexport class CustomTimeFieldComponent extends BaseComponent {\r\n    /** Form Control holding date data */\r\n    public date_control: AbstractControl;\r\n    /** Form Control holding space data */\r\n    public space_control: AbstractControl;\r\n    /** Step size for available times */\r\n    public block_size = 5;\r\n    /** Step size for available times */\r\n    public min_size = this.block_size * 6;\r\n    /** Step size for available times */\r\n    public active_time: TimeSlot;\r\n    /** List of selectable times */\r\n    public times: TimeSlot[];\r\n\r\n    constructor(protected field: ADynamicFormField, public group: FormGroup) {\r\n        super();\r\n    }\r\n\r\n    public ngOnInit(): void {\r\n        if (this.group) {\r\n            if (this.group.controls.date) {\r\n                this.date_control = this.group.controls.date;\r\n                this.subscription('date', this.date_control.valueChanges.subscribe(() => this.updateDisplay(true)));\r\n            }\r\n            if (this.group.controls.room || this.group.controls.space) {\r\n                this.space_control = this.group.controls.room || this.group.controls.space;\r\n                this.subscription('space', this.space_control.valueChanges.subscribe(() => this.updateDisplay()));\r\n            }\r\n            this.subscription('control', this.field.control.valueChanges.subscribe(() => this.updateDisplay()));\r\n        }\r\n        this.calculateAvailableTimes();\r\n        if (this.date_control) {\r\n            const value = this.date_control.value;\r\n            if (!this.times.find(block => block.value === value)) {\r\n                this.setValue(this.times[0]);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Update the active value displayed on the dropdown\r\n     * @param from_ref Whether new value was generated from a reference field\r\n     */\r\n    public updateDisplay(from_ref: boolean = false) {\r\n        if (this.times) {\r\n            for (const time of this.times) {\r\n                if (this.field.getValue() === time.id) {\r\n                    this.active_time = time;\r\n                    break;\r\n                }\r\n            }\r\n            if (!this.field.getValue()) {\r\n                // Initialise with date time set on date control\r\n                if (this.date_control) {\r\n                    let date = dayjs(this.date_control.value);\r\n                    date = date.minute(Math.ceil(date.minute() / 5) * 5);\r\n                    const date_str = date.format('HH:mm');\r\n                    for (const time of this.times) {\r\n                        if (date.valueOf() - time.value <= 0) {\r\n                            this.active_time = time;\r\n                            this.setValue(time, true);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                // Set to default value\r\n                if (!this.field.getValue()) {\r\n                    this.active_time = this.times[0];\r\n                    this.setValue(this.times[0], from_ref);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Generate a list of times selectable by the user\r\n     */\r\n    public calculateAvailableTimes() {\r\n        this.times = [];\r\n        let date = dayjs().startOf('m');\r\n        const book_ahead = this.field.metadata ? this.field.metadata.book_ahead || 660 : 660; // 11 hours default\r\n        const min_duration = this.field.metadata ? this.field.metadata.min_duration || 30 : 30;\r\n        if (this.space_control) {\r\n            // Get times based off available times in space\r\n            const slots = getFreeBookingSlots(this.space_control.value.bookings, min_duration);\r\n            date = date.minute(Math.ceil(date.minute() / this.block_size) * this.block_size);\r\n            const end = dayjs(date)\r\n                .add(book_ahead, 'm')\r\n                .endOf('m');\r\n            for (; date.isBefore(end, 's'); date = date.add(this.block_size, 'm')) {\r\n                const value = date.valueOf();\r\n                if (slots.find(i => i.start <= value && value < i.end && dayjs(i.end).diff(date, 'm') >= min_duration)) {\r\n                    this.times.push({ id: date.format('HH:mm'), name: date.format('h:mm A'), value: date.valueOf() });\r\n                }\r\n            }\r\n        } else {\r\n            // Get times from now\r\n            if (date.minute() % this.block_size !== 0) {\r\n                this.times.push({ id: date.format('HH:mm'), name: date.format('h:mm A') });\r\n            }\r\n            date = date.minute(Math.ceil(date.minute() / this.block_size) * this.block_size);\r\n            const end = dayjs(date).add(book_ahead, 'm');\r\n            for (; date.isBefore(end); date = date.add(this.block_size, 'm')) {\r\n                this.times.push({ id: date.format('HH:mm'), name: date.format('h:mm A'), value: date.valueOf() });\r\n            }\r\n        }\r\n        this.updateDisplay();\r\n    }\r\n\r\n    /**\r\n     * Update the value of the form field\r\n     * @param value New value\r\n     * @param from_ref Whether new value was generated from a reference field\r\n     */\r\n    public setValue(slot: TimeSlot, from_ref: boolean = false) {\r\n        this.field.setValue(slot.id);\r\n        if (this.date_control && !from_ref) {\r\n            const time = dayjs(slot.value);\r\n            const date = dayjs(this.date_control.value)\r\n                .hour(time.hour())\r\n                .minute(time.minute())\r\n                .startOf('m');\r\n            this.date_control.setValue(date.valueOf());\r\n        }\r\n    }\r\n}\r\n\r\nFORM_FIELDS.time = CustomTimeFieldComponent;\r\n","<div class=\"user-search\" widget>\r\n    <div class=\"search\" a-tooltip [show]=\"show && search_str && filtered_list.length > 0\" (showChange)=\"show = $event\" [content]=\"list\">\r\n        <div class=\"searchbar\">\r\n            <input type=\"text\" [(ngModel)]=\"search_str\" (ngModelChange)=\"search($event)\" (blur)=\"reset()\" placeholder=\"Search for host...\" />\r\n            <div class=\"spinner\" *ngIf=\"searching\">\r\n                <a-spinner circle-ring color=\"#000\"></a-spinner>\r\n            </div>\r\n        </div>\r\n        <ng-template #list>\r\n            <div class=\"user-list\">\r\n                <div class=\"item\" *ngFor=\"let item of filtered_list\" (mouseup)=\"select(item)\" (touchend)=\"select(item)\" feedback>\r\n                    <div class=\"name\" [innerHTML]=\"item.match_name || item.name\"></div>\r\n                    <div class=\"email\" [innerHTML]=\"item.match_email || item.email\"></div>\r\n                </div>\r\n            </div>\r\n        </ng-template>\r\n    </div>\r\n</div>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { Subject, Observable, of } from 'rxjs';\r\nimport { switchMap, debounceTime, distinctUntilChanged, map, catchError } from 'rxjs/operators';\r\n\r\nimport { ADynamicFormField } from '@acaprojects/ngx-dynamic-forms';\r\n\r\nimport { BaseComponent } from '../../base.component';\r\nimport { ApplicationService } from '../../../services/app.service';\r\nimport { User } from '../../../services/data/users/user.class';\r\nimport { filterList, matchToHighlight } from '../../utilities/general.utilities';\r\nimport { FORM_FIELDS } from '../../globals/form-fields';\r\n\r\n@Component({\r\n    selector: 'custom-user-search-field',\r\n    templateUrl: './user-search-field.component.html',\r\n    styleUrls: ['./user-search-field.component.scss']\r\n})\r\nexport class CustomUserSearchFieldComponent extends BaseComponent implements OnInit {\r\n    /** List of users from an API search */\r\n    public filtered_list: User[] = [];\r\n    /** List of users from an API search */\r\n    public search_results$: Observable<User[]>;\r\n    /** Whether to show list tooltip */\r\n    public show: boolean;\r\n    /** Search input field value */\r\n    public search_str: string;\r\n    /** Whether a query is in progress */\r\n    public searching: boolean;\r\n    /** Subject holding the value of the search */\r\n    private search$ = new Subject<string>();\r\n\r\n    constructor(protected field: ADynamicFormField, protected group: FormGroup, private service: ApplicationService) {\r\n        super();\r\n    }\r\n\r\n    public ngOnInit(): void {\r\n        if (this.group) {\r\n            if (this.field.references && this.field.references.length > 0) {\r\n                const control = this.group.controls[this.field.references[0]];\r\n                if (control) {\r\n                    this.subscription('reference', control.valueChanges.subscribe(() => this.updateDisplay()));\r\n                }\r\n            }\r\n            this.subscription('control', this.field.control.valueChanges.subscribe(() => this.updateDisplay()));\r\n        }\r\n        // Listen for input changes\r\n        this.search_results$ = this.search$.pipe(\r\n            debounceTime(400),\r\n            distinctUntilChanged(),\r\n            switchMap(query => {\r\n                this.searching = true;\r\n                this.show = true;\r\n                return query.length >= 3 ? (this.service.Users.query({ q: query.slice(0, 3), cache: 60 * 1000 }) as Promise<User[]>) : Promise.resolve([]);\r\n            }),\r\n            catchError((err) => of([])),\r\n            map(list => {\r\n                this.searching = false;\r\n                return filterList(this.search_str, list, ['name', 'email']);\r\n            })\r\n        );\r\n        // Process API results\r\n        this.search_results$.subscribe(list => {\r\n            this.filtered_list = list;\r\n            this.filtered_list.forEach((i: any) => {\r\n                i.match_name = matchToHighlight(i.match_name);\r\n                i.match_email = matchToHighlight(i.match_email);\r\n                return i;\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Search for a user that matches the filter string\r\n     * @param filter String to filter users on\r\n     */\r\n    public search(filter: string) {\r\n        this.search_str = filter;\r\n        this.search$.next(filter);\r\n    }\r\n\r\n    /**\r\n     * Update input display string\r\n     */\r\n    public updateDisplay() {\r\n        const value = this.field.control.value;\r\n        this.search_str = value ? value.name : '';\r\n    }\r\n\r\n    /**\r\n     * Reset the display value for the search input\r\n     */\r\n    public reset() {\r\n        this.timeout('reset', () => {\r\n            const value = this.field.control.value;\r\n            this.search_str = value ? value.name : '';\r\n            this.show = false;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Set the active user\r\n     * @param user New active user\r\n     */\r\n    public select(user: User) {\r\n        if (user) {\r\n            this.field.setValue(user);\r\n        }\r\n        this.timeout('hide', () => {\r\n        this.show = false;\r\n        }, 100);\r\n    }\r\n}\r\n\r\nFORM_FIELDS.host = CustomUserSearchFieldComponent;\r\n","\r\nimport * as dayjs from 'dayjs';\r\n\r\n/** Version number of the application */\r\nexport const version = 'local-dev';\r\n/** Version number of the base application */\r\nexport const core_version = '1.0.0';\r\n/** Build time of the application */\r\nexport const build = dayjs();\r\n","\r\nimport { Type } from '@angular/core';\r\n\r\n/** List of form field contents mapped to corresponding keys */\r\nexport const FORM_FIELDS: { [id: string]: Type<any> } = {};","\r\nimport { IOverlayConfig } from \"@acaprojects/ngx-overlays\";\r\n\r\n/** List of Overlays to register on application initialisation */\r\nexport const OVERLAY_REGISTER: { id: string; config: IOverlayConfig }[] = [];\r\n","\r\nimport './systems.mock';\r\n","\r\nimport { MockHttpRequestHandlerOptions } from '@acaprojects/ts-composer';\r\n\r\nimport { HashMap } from \"../utilities/types.utilities\";\r\nimport { generateMockSpace } from \"../../services/data/spaces/space.utilities\";\r\nimport { setMockBookingStartDatetime } from \"../../services/data/bookings/booking.utilities\";\r\nimport { generateMockUser } from \"../../services/data/users/user.utilities\";\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\ninterface IMockEngineSystem {\r\n    id?: string;\r\n    name?: string;\r\n    [module: string]: HashMap[] | string;\r\n}\r\n\r\nexport interface IBookingPanelBindings {\r\n    /** Whether user input is enabled */\r\n    touch_enabled: boolean;\r\n    /** Number of seconds before a meeting can be started, being truthy enables start/stop and auto-cancellations */\r\n    timeout?: number;\r\n    /** Number of seconds after the start of a meeting when it is auto-cancelled, overrides `timeout` value */\r\n    cancel_timeout?: number;\r\n    /** Whether to display hearing assistance UI elements */\r\n    has_accessability?: boolean;\r\n    /** URL to embed into the control modal when opened */\r\n    control_url?: string;\r\n    /** Whether to display catering UI elements */\r\n    has_catering?: boolean;\r\n    /** Whether to hide booking details(title and host) */\r\n    hide_details?: boolean;\r\n    /** Whether to hide the title of the displayed bookings */\r\n    hide_title?: boolean;\r\n    /** Whether to hide user(host) details */\r\n    hide_user?: boolean;\r\n    /** Whether to hide timeline availability */\r\n    hide_availability?: boolean;\r\n    /** Whether to disable booking from the UI */\r\n    booking_disabled?: boolean;\r\n    /** Whether booking future meetings are allowed */\r\n    no_timeline_bookings?: boolean;\r\n    /** Time before the booking end with which the current booking is endable in ms from UTC epoch */\r\n    is_endable?: number;\r\n    /** Whether to automatically ask user starting the current meeting */\r\n    ask_start?: boolean;\r\n    /** Whether to automatically ask user about ending the active meeting */\r\n    ask_end?: boolean;\r\n    /** Default meeting title if the displayed meeting doesn't have one */\r\n    default_title?: string;\r\n    /** Hide all meeting related details */\r\n    hide_all?: boolean;\r\n    /** Title of the active space */\r\n    title?: string;\r\n    /** Description of the active space */\r\n    description?: string;\r\n    /** URL of an icon image to display on the UI */\r\n    icon?: string;\r\n    /** Whether the space status is displayed on the right */\r\n    flip_status?: boolean;\r\n    /** Whether bookings can be automatically cancelled once they expire */\r\n    can_cancel?: boolean;\r\n    /** Minimum bookable duration in minutes */\r\n    min_duration?: number;\r\n    /** Maximum bookable duration in minutes */\r\n    max_duration?: number;\r\n    /** Start time of the business day with format `HH:mm` */\r\n    business_start?: string;\r\n    /** End time of the business day with format `HH:mm` */\r\n    business_end?: string;\r\n\r\n}\r\n\r\nconst LETTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');\r\nconst NUMBERS = '0123456789'.split('');\r\n\r\nlet index = 0;\r\n\r\nconst SPACE_LIST: any[] = [];\r\n\r\nconst IMAGES: string[] = ['large_down', 'large_up', 'small_down', 'small_up'];\r\n\r\n/**\r\n * Create mock engine booking module with appropriate bookings and space data\r\n */\r\nfunction createSystem(): IMockEngineSystem {\r\n    const id = `sys-${LETTERS[Math.floor(index / NUMBERS.length)]}${NUMBERS[(index++) % NUMBERS.length]}`;\r\n    setMockBookingStartDatetime(dayjs().minute(-50).valueOf());\r\n    const space = generateMockSpace(id);\r\n    SPACE_LIST.push(space);\r\n    const bindings: IBookingPanelBindings = {\r\n        touch_enabled: true,\r\n        timeout: 300,\r\n        cancel_timeout: 600,\r\n        has_catering: true,\r\n        control_url: 'https://aca.im/demo/aca/control/',\r\n        icon: `/assets/img/${IMAGES[Math.floor(Math.random() * IMAGES.length)]}.png`\r\n    };\r\n    const system = {\r\n        id, name: space.name,\r\n        Bookings: []\r\n    };\r\n    system.Bookings.push({\r\n        ...bindings,\r\n        room_name: space.name,\r\n        today: space.bookings,\r\n        reload: dayjs().add(1, 'h').unix(),\r\n        $start_meeting: (time: number) => {\r\n            system.Bookings[0].last_meeting_started = time;\r\n        },\r\n        $cancel_meeting: (time: number, reason: string) => {\r\n            const list = system.Bookings[0].today;\r\n            system.Bookings[0].today = list.filter(i => i.date !== time);\r\n        },\r\n        $waiter_call: () => {\r\n            console.log(`[MOCK][${id}] Waiter called...`);\r\n        }\r\n    });\r\n    return system;\r\n}\r\n\r\n\r\nexport const MOCK_SYSTEMS = Array(10).fill(0).map(i => createSystem());\r\n\r\n// Add mock systems to the global space so that the mock websocket can hook into them\r\nif (!window.control) {\r\n    window.control = { systems: {} };\r\n}\r\nwindow.control.systems = MOCK_SYSTEMS.reduce((a: { [module:string]: IMockEngineSystem }, v) => {\r\n    a[v.id] = v;\r\n    return a;\r\n}, {});\r\n\r\n// Add mock data for API endpoints\r\nconst USER_LIST = Array(1000).fill(0).map(i => generateMockUser());\r\n\r\nconst handlers: MockHttpRequestHandlerOptions[] = [\r\n    {\r\n        path: '/api/engine/v2/systems',\r\n        metadata: null,\r\n        method: 'GET',\r\n        callback: _ => ({ total: 10, results: MOCK_SYSTEMS })\r\n    },\r\n    {\r\n        path: '/api/staff/rooms',\r\n        metadata: null,\r\n        method: 'GET',\r\n        callback: _ => SPACE_LIST\r\n    },\r\n    {\r\n        path: '/api/staff/users',\r\n        metadata: null,\r\n        method: 'GET',\r\n        callback: _ => USER_LIST\r\n    },\r\n    {\r\n        path: '/api/engine/v2/users/current',\r\n        metadata: null,\r\n        method: 'GET',\r\n        callback: _ => USER_LIST[0]\r\n    },\r\n    {\r\n        path: '/api/engine/v2/zones',\r\n        metadata: null,\r\n        method: 'GET',\r\n        callback: _ => ({ total: 1, results: [{ id: 'zone_org-1' }] })\r\n    }\r\n];\r\nwindow.control.handlers = handlers;\r\n","\r\nimport { NgModule, Type } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\n\r\nimport { ADropdownsModule } from '@acaprojects/ngx-dropdown';\r\nimport { ASpinnerModule } from '@acaprojects/ngx-spinners';\r\nimport { AButtonsModule } from '@acaprojects/ngx-buttons';\r\nimport { APipesModule } from '@acaprojects/ngx-pipes';\r\nimport { AOverlayModule } from '@acaprojects/ngx-overlays';\r\nimport { ADynamicFormsModule } from '@acaprojects/ngx-dynamic-forms';\r\nimport { ACustomEventsModule } from '@acaprojects/ngx-custom-events';\r\n\r\nimport { BaseComponent } from './base.component';\r\nimport { CustomUserSearchFieldComponent } from './components/user-search-field/user-search-field.component';\r\nimport { CustomTimeFieldComponent } from './components/time-field/time-field.component';\r\nimport { CustomDurationFieldComponent } from './components/duration-field/duration-field.component';\r\n\r\nconst COMPONENTS: Type<any>[] = [\r\n    BaseComponent\r\n];\r\n\r\nconst ENTRY_COMPONENT: Type<any>[] = [\r\n    CustomUserSearchFieldComponent,\r\n    CustomTimeFieldComponent,\r\n    CustomDurationFieldComponent\r\n]\r\n\r\n@NgModule({\r\n    declarations: [\r\n        ...COMPONENTS,\r\n        ...ENTRY_COMPONENT,\r\n    ],\r\n    imports: [\r\n        CommonModule,\r\n        ADropdownsModule,\r\n        ASpinnerModule,\r\n        AButtonsModule,\r\n        AOverlayModule,\r\n        FormsModule,\r\n        ReactiveFormsModule,\r\n        ACustomEventsModule,\r\n        ADynamicFormsModule\r\n    ],\r\n    exports: [\r\n        ADropdownsModule,\r\n        ASpinnerModule,\r\n        AButtonsModule,\r\n        APipesModule,\r\n        AOverlayModule,\r\n        ACustomEventsModule,\r\n        ADynamicFormsModule,\r\n        ...COMPONENTS,\r\n        ...ENTRY_COMPONENT\r\n    ],\r\n    entryComponents: [\r\n        ...COMPONENTS,\r\n        ...ENTRY_COMPONENT\r\n    ]\r\n})\r\nexport class SharedContentModule {}\r\n","import { HashMap } from \"./types.utilities\";\r\n\r\n/**\r\n * Convert map into a query string\r\n * @param map Key value pairs to convert\r\n */\r\nexport function toQueryString(map: HashMap) {\r\n    let str = '';\r\n    if (map) {\r\n        for (const key in map) {\r\n            if (map.hasOwnProperty(key) && map[key] !== undefined && map[key] !== null) {\r\n                str += `${(str ? '&' : '')}${key}=${map[key]}`;\r\n            }\r\n        }\r\n    }\r\n    return str;\r\n}\r\n","\r\nimport { humaniseDuration } from './general.utilities';\r\n\r\nimport { User } from '../../services/data/users/user.class';\r\nimport { Space } from '../../services/data/spaces/space.class';\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\n// attendees: FormFormatters.attendees(user),\r\n// date: FormFormatters.date,\r\n// room: FormFormatters.space,\r\n// recurrence: FormFormatters.recurrence\r\n\r\n/**\r\n * Get function to create formatted string for a list of users with a host\r\n * @param host Host user\r\n */\r\nexport function formatAttendeesWithHost(host: User): (_: User[]) => string {\r\n    return (l) => formatAttendees(l, host);\r\n}\r\n\r\n/**\r\n * Create formatted string from a list of users\r\n * @param list List of users\r\n * @param host Owner of the list of users\r\n */\r\nexport function formatAttendees(list: User[], host?: User) {\r\n    let attendee_str: string = '';\r\n    if (list && list.length > 0) {\r\n        const users = [...list];\r\n        if (host) {\r\n            const result = users.find(a => a.email === host.email);\r\n            if (result) {\r\n                users.splice(users.indexOf(result), 1);\r\n            }\r\n        }\r\n        const length = users.length + (host ? 1 : 0);\r\n        attendee_str = `${length} Attendee${length === 1 ? '' : 's'}; ${host ? host.name : ''}`;\r\n        for (const item of users) {\r\n            if (attendee_str) {\r\n                attendee_str += ', ';\r\n            }\r\n            attendee_str += item.name;\r\n        }\r\n        attendee_str = attendee_str.replace('; ,', ';');\r\n    }\r\n    return attendee_str;\r\n}\r\n\r\n/**\r\n * Create date formatted string for given date\r\n * @param date Date to format\r\n */\r\nexport function formatDate(date: number) {\r\n    return dayjs(date).format('DD MMMM YYYY');\r\n}\r\n\r\n/**\r\n * Create time formatted string for given date\r\n * @param date Date to format\r\n */\r\nexport function formatTime(date: number) {\r\n    return dayjs(date).format('h:mm A');\r\n}\r\n\r\n/**\r\n * Create formatted string for a period of given duration\r\n * @param duration Period duration in minutes\r\n */\r\nexport function formatPeriodWithDuration(duration: number) {\r\n    return (t) => formatPeriod(t, duration);\r\n}\r\n\r\n/**\r\n * Create formatted string for a period of given duration\r\n * @param timestamp Start hours and minutes of the period in the format `HH:mm`\r\n * @param duration Period duration in minutes\r\n */\r\nexport function formatPeriod(timestamp: string, duration: number = 60) {\r\n    const parts = timestamp.split(':');\r\n    const date = dayjs().hour(+parts[0]).minute(+parts[1]);\r\n    return `${date.format('h:mm A')} - ${date.add(duration, 'm').format('h:mm A')} (${humaniseDuration(duration)})`;\r\n}\r\n\r\n/**\r\n * Create formatted human readable string for a given duration\r\n * @param duration Duration in minutes\r\n */\r\nexport function formatDuration(duration: number) {\r\n    return humaniseDuration(duration);\r\n}\r\n\r\n/** Human readable names of applicable recurrence periods */\r\nexport const RECURRENCE_PERIODS: string[] = ['None', 'Daily', 'Weekly', 'Monthly', 'Yearly'];\r\n\r\n/**\r\n * Create human readable string for recurrence metadata\r\n * @param value\r\n */\r\nexport function formatRecurrence(value: { period: string | number, end: number }) {\r\n    if (!value || !value.period || value.period as any >= RECURRENCE_PERIODS.length) {\r\n        return 'No recurrence';\r\n    }\r\n    const period = typeof value.period === 'string' ? value.period : RECURRENCE_PERIODS[value.period];\r\n    const end = value.end ? `until ${dayjs(value.end).format('DD MMM YYYY')}` : 'forever';\r\n    return `${period} ${end}`;\r\n}\r\n\r\n/**\r\n * Create human readable string for a room or list of rooms\r\n * @param list List of spaces/rooms\r\n */\r\nexport function formatSpaces(list: Space | Space[]) {\r\n    if (!list || (list instanceof Array && list.length <= 0)) {\r\n        return 'No selected space';\r\n    }\r\n    if (list instanceof Array) {\r\n        return list.length === 1 ? list[0].name : `${list.length} Space${list.length !== 1 ? 's' : ''}`;\r\n    } else {\r\n        const capacity = list.capacity ? '(' + list.capacity + ' ' + (list.capacity === 1 ? 'person' : 'people') + ')' : '';\r\n        return `${list.name} ${capacity}`;\r\n    }\r\n}\r\n","import { HashMap } from './types.utilities';\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\nexport function getItemWithKeys(keys: string[], map: HashMap) {\r\n    const key = keys.shift();\r\n    if (map[key]) {\r\n        return keys.length > 0 ? getItemWithKeys(keys, map[key]) : map[key];\r\n    }\r\n    return null;\r\n}\r\n\r\n/**\r\n * Checks whether the platform is a mobile device.\r\n */\r\nexport function isMobileDevice(): boolean {\r\n    const r = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;\r\n    return !!navigator.userAgent.match(r);\r\n}\r\n\r\n/**\r\n * Checks whether the browser is Mobile Safari.\r\n */\r\nexport function isMobileSafari(): boolean {\r\n    const agent = navigator.userAgent;\r\n    return !!(agent.match(/iPhone|iPad|iPod/) && agent.match(/AppleWebKit/) && !agent.match('CriOS'));\r\n}\r\n\r\n/**\r\n * Checks whether the browser is Android Chrome.\r\n */\r\nexport function isAndroidChrome(): boolean {\r\n    const agent = navigator.userAgent;\r\n    return !!(agent.match(/Android/) && agent.match(/Chrome/));\r\n}\r\n\r\n/**\r\n * Generate string representation of a number with zeros padding the length\r\n * @param value Number to pad with zeros\r\n * @param length Length of the resulting string\r\n */\r\nexport function padZero(value: number, length: number): string {\r\n    let str = value.toString();\r\n    while (str.length < length) {\r\n        str = '0' + str;\r\n    }\r\n    return str;\r\n}\r\n\r\n/**\r\n * Remove duplicates from the given array\r\n * @param array List of items to remove duplicates from\r\n * @param key Key on array objects to compare for uniqueness\r\n */\r\nexport function unique(array: any[], key: string = '') {\r\n    return array.filter((el, pos, arr) =>\r\n        arr.indexOf(key ? arr.find(i => i[key] === el[key]) : arr.find(i => i === el)) === pos\r\n    );\r\n}\r\n\r\n/**\r\n * Convert duration to human readable string\r\n * @param duration Duration in minutes\r\n * @param short Whether to use short form of duration words e.g. hours as h\r\n */\r\nexport function humaniseDuration(duration: number, short: boolean = false) {\r\n    if (!duration || duration < 0) { return ''; }\r\n    const h = Math.floor(duration / 60);\r\n    let d = `${h >= 1 ? (h + (short ? 'h' : (' hour' + (h === 1 ? '' : 's')))) : ''}`;\r\n    if (duration % 60 !== 0) {\r\n        if (d) { d += short ? ' ' : ', '; }\r\n        const m = duration % 60;\r\n        d += `${m >= 1 ? (m + (short ? 'm' : (' minute' + (m === 1 ? '' : 's')))) : ''}`;\r\n    }\r\n    return d;\r\n}\r\n\r\n/**\r\n * Get a filtered list of items\r\n * @param filter Value to filter on\r\n * @param items List of results to filter\r\n * @param fields Fields to check for matches on each item\r\n */\r\nexport function filterList<T = HashMap>(filter: string, items?: T[], fields: string[] = ['id']): T[] {\r\n    let results: any[];\r\n    // Tokenise filter string\r\n    const filters = (filter || '').toLowerCase().split(' ');\r\n    const list = {};\r\n    for (const f of filters) {\r\n        if (f) {\r\n            if (!list[f]) { list[f] = 0; }\r\n            list[f]++;\r\n        }\r\n    }\r\n    // Group similar tokens\r\n    const parts = [];\r\n    for (const f in list) {\r\n        if (list.hasOwnProperty(f)) {\r\n            parts.push({ word: f, count: list[f], regex: new RegExp(f, 'gi') });\r\n        }\r\n    }\r\n    parts.sort((a, b) => b.word.length - a.word.length || a.word.localeCompare(b.word));\r\n    const item_list = JSON.parse(JSON.stringify(items || []));\r\n    if (filter) {\r\n        results = item_list.filter(\r\n            (item) => {\r\n                let match_count = 0;\r\n                item.match_index = 65535;\r\n                item.match = '';\r\n                const field_list = {};\r\n                // Initialise field match variables\r\n                for (const f of fields) {\r\n                    field_list[f] = {\r\n                        value: (item[f] || '').toLowerCase(),\r\n                        index: 65536,\r\n                        matched: 0\r\n                    };\r\n                }\r\n                // Search for matches with the tokenised filter string\r\n                for (const i of parts) {\r\n                    if (i.word) {\r\n                        // Check fields for matches\r\n                        for (const f of fields) {\r\n                            const field = field_list[f];\r\n                            const index = field.value.indexOf(i.word);\r\n                            field.index = index < field.index ? index : field.index;\r\n                            field.matches = (field.value.match(i.regex) || []).length;\r\n                            field.value = field.value.replace(i.regex, ' ');\r\n                        }\r\n                        // Update token match count\r\n                        for (const f of fields) {\r\n                            const field = field_list[f];\r\n                            if (field.matches >= i.count) {\r\n                                match_count++;\r\n                                // Update field matches\r\n                                let changed = 0;\r\n                                const tokens = (item[`match_${f}`] || item[f] || '').split(' ');\r\n                                for (const k of tokens) {\r\n                                    if (changed >= i.count) {\r\n                                        break;\r\n                                    }\r\n                                    if (k.toLowerCase().indexOf(i.word) >= 0 && k.indexOf('`') < 0) {\r\n                                        tokens[tokens.indexOf(k)] = k.replace(i.regex, '`$&`');\r\n                                        changed++;\r\n                                    }\r\n                                }\r\n                                item[`match_${f}`] = tokens.join(' ');\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                // Get field with the most relevent match\r\n                for (const f of fields) {\r\n                    const field = field_list[f];\r\n                    if (field.index < item.match_index && field.index >= 0) {\r\n                        item.match_index = field.index;\r\n                        item.match = f;\r\n                    }\r\n                }\r\n                return item.match_index >= 0 && item.match && (match_count >= parts.length);\r\n            });\r\n    } else {\r\n        results = item_list;\r\n    }\r\n    // Sort by order of relevence then name\r\n    results.sort((a, b) => {\r\n        const diff = a.match_index - b.match_index;\r\n        return diff === 0 ? a.name.localeCompare(b.name) : diff;\r\n    });\r\n    return results;\r\n}\r\n\r\n/**\r\n * Convert a match string from `filterList` to renderable HTML\r\n * @param str Match string to change\r\n */\r\nexport function matchToHighlight(str: string): string {\r\n    if (str) {\r\n        str = str.replace(/\\`[a-zA-Z0-9\\@\\.\\_]*\\`/g, '<span class=\"highlight\">$&</span>');\r\n        str = str.replace(/\\`/g, '');\r\n    }\r\n    return str;\r\n}\r\n\r\n/**\r\n * Convert time string to ms from UTC epoch for today\r\n * @param time Time string in the format `HH:mm`\r\n */\r\nexport function timeToDate(time: string): number {\r\n    const parts = (time || '').split(':');\r\n    const date = dayjs().hour(+parts[0]).minute(+parts[1]).startOf('m');\r\n    return date.valueOf();\r\n}\r\n\r\n/* istanbul ignore next */\r\n/**\r\n * Flatten nested array\r\n * @param an_array Array to flatten\r\n */\r\nexport function flatten<T = any>(an_array: (T[] | T)[]): T[] {\r\n    const stack: any[] = [...an_array];\r\n    const res = [];\r\n    while (stack.length) {\r\n        // pop value from stack\r\n        const next: T[] | T = stack.pop();\r\n        if (next instanceof Array) {\r\n            // push back array items, won't modify the original input\r\n            stack.push(...next);\r\n        } else {\r\n            res.push(next);\r\n        }\r\n    }\r\n    // reverse to restore input order\r\n    return res.reverse();\r\n}\r\n","import { AbstractControl } from '@angular/forms';\r\n\r\nimport { User } from '../../services/data/users/user.class';\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\nconst HAS_ERROR = true;\r\n\r\n/**\r\n * Check that control value is a date that is the same or after from date\r\n * @param control Angular form control\r\n * @param is_from Comparison date(ms from UTC epoch). Defaults to the current time\r\n */\r\nexport function validateDate(control: AbstractControl, is_from: number = dayjs().valueOf()) {\r\n    const from = dayjs(is_from);\r\n    const date = dayjs(control.value || undefined);\r\n    return date.isBefore(from, 'd') ? { date: HAS_ERROR, message: 'Booking needs to be made in the future' } : null;\r\n}\r\n\r\n/**\r\n * Build start time validation function\r\n * @param date Date of the time to check\r\n * @param is_from Comparison date(ms from UTC epoch). Defaults to the current time\r\n */\r\nexport function buildValidateStartTime(date: number, is_from: number = dayjs().valueOf()) {\r\n    return (c) => validateStartTime(c, date, is_from);\r\n}\r\n\r\n/**\r\n * Check that control value time is after the comparison date time\r\n * @param control Angular form control\r\n * @param date Date of the time to check\r\n * @param is_from Comparison date(ms from UTC epoch). Defaults to the current time\r\n */\r\nexport function validateStartTime(control: AbstractControl, date: number, is_from: number = dayjs().valueOf()) {\r\n    const now = dayjs(is_from);\r\n    const parts = control.value.split(':');\r\n    const date_obj = dayjs(date).hour(+parts[0]).minute(+parts[1]);\r\n    return date_obj.isBefore(now, 'm') ? { start: HAS_ERROR, message: 'Booking time needs to be made in the future' } : null;\r\n}\r\n\r\nexport function buildValidateDuration(min: number = 30, max: number = 240) {\r\n    return (c) => validateDuration(c, min, max);\r\n}\r\n\r\nexport function validateDuration(control: AbstractControl, min: number = 30, max: number = 240) {\r\n    if (control.value < (min || 30)) {\r\n        return { duration: HAS_ERROR, message: `Minimum booking duration is ${min} minute${min === 1 ? 's' : ''}` };\r\n    } else if (control.value > (max || 480)) {\r\n        return { length: HAS_ERROR, message: `Maximum booking duration is ${max} minute${max === 1 ? 's' : ''}` };\r\n    }\r\n    return null;\r\n}\r\n\r\nexport function buildValidateAttendees(host: User, min: number = 0) {\r\n    return (c) => validateAttendees(c, host, min);\r\n}\r\n\r\nexport function validateAttendees(control: AbstractControl, host: User, min: number = 0) {\r\n    if (!control || !(control.value instanceof Array)) {\r\n        return min > 0\r\n            ? { invalid: true, message: `Minimum of ${min} attendee${min === 1 ? ' is' : 's are'} required other than you` }\r\n            : null;\r\n    }\r\n    const list: User[] = control.value;\r\n    if (host) {\r\n        const result = list.find(a => a.email === host.email);\r\n        if (result) { list.splice(list.indexOf(result), 1); }\r\n    }\r\n    return list.length >= min ? null : {\r\n        count: true,\r\n        message: `Minimum of ${min} attendee${min === 1 ? ' is' : 's are'} required other than you`\r\n    };\r\n}\r\n","<div class=\"bootstrap\">\r\n    <div class=\"options\">\r\n        <div class=\"header fs-big\">\r\n            <h1>Booking Panel Setup</h1>\r\n            <div\r\n                class=\"toggle\"\r\n                feedback\r\n                center=\"true\"\r\n                *ngIf=\"system_list && system_list.length > 0\"\r\n                (tapped)=\"manual_input = !manual_input\"\r\n            >\r\n                <i class=\"material-icons\">{{ manual_input ? 'list' : 'code' }}</i>\r\n            </div>\r\n        </div>\r\n        <div class=\"body\" *ngIf=\"!loading\">\r\n            <ng-container *ngIf=\"manual_input; else list_desc\">\r\n                <p class=\"description\">\r\n                    Input the Engine System ID to bootstrap\r\n                </p>\r\n                <div class=\"content\">\r\n                    <div class=\"input\" [class.focus]=\"input_focus || system_id\">\r\n                        <input [(ngModel)]=\"system_id\" (focus)=\"input_focus = true\" (blur)=\"input_focus = false\" />\r\n                        <div class=\"placeholder\" [class.focus]=\"input_focus\">Engine System ID</div>\r\n                    </div>\r\n                </div>\r\n            </ng-container>\r\n            <ng-template #list_desc>\r\n                <p class=\"description\">\r\n                    Select the relevent system from the available dropdown\r\n                </p>\r\n                <div class=\"content\">\r\n                    <a-dropdown\r\n                        klass=\"fill\"\r\n                        [items]=\"system_list\"\r\n                        [(ngModel)]=\"selected_system\"\r\n                        [options]=\"{ can_filter: true }\"\r\n                        placeholder=\"Select system\"\r\n                    ></a-dropdown>\r\n                </div>\r\n            </ng-template>\r\n        </div>\r\n        <div class=\"body\" *ngIf=\"loading\">\r\n            <div class=\"info-block\">\r\n                <div class=\"icon\">\r\n                    <a-spinner circle-ring color=\"#000\"></a-spinner>\r\n                </div>\r\n                <div class=\"text\">\r\n                    Loading system data...\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"footer\" *ngIf=\"!loading\">\r\n            <button\r\n                widget\r\n                [disabled]=\"(manual_input && !system_id) || (!manual_input && (!selected_system || !selected_system.id))\"\r\n                (tapped)=\"bootstrap()\"\r\n            >\r\n                Submit\r\n            </button>\r\n        </div>\r\n    </div>\r\n</div>\r\n","\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { EngineSystem } from '@acaprojects/ts-composer';\r\n\r\nimport { ApplicationService } from '../../services/app.service';\r\nimport { BaseComponent } from '../../shared/base.component';\r\nimport { first } from 'rxjs/operators';\r\n\r\n@Component({\r\n    selector: 'app-bootstrap',\r\n    templateUrl: './bootstrap.component.html',\r\n    styleUrls: ['./bootstrap.component.scss']\r\n})\r\nexport class BootstrapComponent extends BaseComponent implements OnInit {\r\n    /** Whether to show manual input for bootstrap ID */\r\n    public manual_input: boolean;\r\n    /** List of available systems */\r\n    public system_list: EngineSystem[] = [];\r\n    /** Whether application data is loading */\r\n    public loading: boolean;\r\n    /** ID of the system to bootstrap */\r\n    public system_id: string;\r\n    /** Selected system to bootstrap */\r\n    public selected_system: EngineSystem = null;\r\n    /** Whether input field is focused */\r\n    public input_focus: boolean;\r\n\r\n    constructor(private service: ApplicationService, private route: ActivatedRoute) {\r\n        super();\r\n    }\r\n\r\n    public ngOnInit(): void {\r\n        this.loading = true;\r\n        this.service.Spaces.initialised.pipe(first(_ => _)).subscribe(() => {\r\n            this.subscription('route.query', this.route.queryParamMap.subscribe((params) => {\r\n                if (params.has('clear') && params.get('clear')) {\r\n                    this.clearBootstrap();\r\n                }\r\n                if (params.has('system_id') || params.has('sys_id')) {\r\n                    this.system_id = params.get('system_id') || params.get('sys_id');\r\n                    this.manual_input = true;\r\n                    this.bootstrap();\r\n                }\r\n            }));\r\n            this.subscription('system_list', this.service.Systems.listen('list', (systems) => {\r\n                this.system_list = systems || [];\r\n                this.manual_input = !this.system_list || this.system_list.length <= 0;\r\n            }));\r\n            this.loadList();\r\n            this.checkBootstrapped();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Setup the default system for the application to bind to\r\n     */\r\n    public bootstrap() {\r\n        if (this.manual_input && this.system_id) {\r\n            this.configure(this.system_id);\r\n        } else if (this.selected_system) {\r\n            this.configure(this.selected_system.id);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Grab the list of systems from the Systems Manager\r\n     * @param tries Number of previous attempts\r\n     */\r\n    private loadList(tries: number = 0): void {\r\n        this.system_list = this.service.Systems.list || [];\r\n        if ((!this.system_list || this.system_list.length <= 0) && tries < 10) {\r\n            this.timeout('load', () => this.loadList(++tries));\r\n            return;\r\n        }\r\n        if (!this.system_list || this.system_list.length <= 0) {\r\n            this.manual_input = true;\r\n        }\r\n        this.loading = false;\r\n    }\r\n\r\n    /**\r\n     * Check if the application has previously been bootstrapped\r\n     */\r\n    private checkBootstrapped(): void {\r\n        this.loading = true;\r\n        if (localStorage) {\r\n            const system_id = localStorage.getItem('ACA.PANEL.system') || localStorage.getItem('ACA.CONTROL.system');\r\n            if (system_id) {\r\n                this.service.navigate(['panel', system_id]);\r\n                return;\r\n            }\r\n        }\r\n        const user = this.service.Users.current;\r\n        if (user) {\r\n            const space = this.service.Spaces.item(user.email);\r\n            if (space) {\r\n                this.service.navigate(['panel', space.id]);\r\n                return;\r\n            }\r\n        }\r\n        this.loading = false;\r\n    }\r\n\r\n    /**\r\n     * Save the bootstrapped ID and redirect to the panel for that ID\r\n     * @param system_id System to bootstrap\r\n     */\r\n    private configure(system_id: string): void {\r\n        if (localStorage) {\r\n            localStorage.setItem('ACA.PANEL.system', system_id);\r\n        }\r\n        this.service.navigate(['panel', system_id]);\r\n    }\r\n\r\n    /**\r\n     * Remove any previously set bootstrapping details\r\n     */\r\n    private clearBootstrap() {\r\n        if (localStorage) {\r\n            localStorage.removeItem('ACA.PANEL.system');\r\n        }\r\n    }\r\n\r\n}\r\n\r\n","<div class=\"panel-array\">\r\n    <ng-container *ngIf=\"systems && systems.length > 0; else none\">\r\n        <div\r\n            class=\"panel-outlet\"\r\n            *ngFor=\"let id of systems | slice: 0:4; let i = index\"\r\n            [style.height]=\"systems.length >= 2 ? '50%' : '100%'\"\r\n        >\r\n            <app-booking-panel *ngIf=\"id; else empty_state\" [system_id]=\"id\" [show_time]=\"false\" [reverse]=\"i % 2 !== 0\"></app-booking-panel>\r\n        </div>\r\n    </ng-container>\r\n    <ng-template #none>\r\n        <div class=\"info-block\">\r\n            <div class=\"text\">No systems are set for displaying on the panel array</div>\r\n        </div>\r\n    </ng-template>\r\n</div>\r\n<ng-template #empty_state>\r\n    <div class=\"container\">\r\n        <div class=\"content center\">\r\n            <div class=\"logo\" *ngIf=\"logo\">\r\n                <img [src]=\"logo\"/>\r\n            </div>\r\n            <div class=\"time\">{{ time }}</div>\r\n        </div>\r\n    </div>\r\n</ng-template>\r\n\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\n\r\nimport { BaseComponent } from '../../shared/base.component';\r\nimport { ApplicationService } from 'src/app/services/app.service';\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\n@Component({\r\n    selector: 'app-booking-panel-array',\r\n    templateUrl: './panel-array.component.html',\r\n    styleUrls: ['./panel-array.component.scss']\r\n})\r\nexport class BookingPanelArrayComponent extends BaseComponent implements OnInit {\r\n    /** List of systems to show panels for */\r\n    public systems: string[];\r\n    /** Application logo */\r\n    public logo: string;\r\n\r\n    /** Display value for the current time */\r\n    public get time(): string {\r\n        return dayjs().format('h:mm:ss A')\r\n    }\r\n\r\n    constructor(private route: ActivatedRoute, private _service: ApplicationService) {\r\n        super();\r\n    }\r\n\r\n    public ngOnInit(): void {\r\n        this.subscription('app_ready', this._service.initialised.subscribe((is_ready) => {\r\n            if (is_ready) {\r\n                this.subscription('route.query', this.route.queryParamMap.subscribe((params) => {\r\n                    if (params.has('system_ids')) {\r\n                        this.systems = (params.get('system_ids') || '').split(',');\r\n                    }\r\n                }));\r\n                const logo = this._service.setting('app.logo');\r\n                this.logo = (logo ? logo.inverse : null) || '';\r\n                this.unsub('app_ready');\r\n            }\r\n        }));\r\n    }\r\n}\r\n","<div class=\"panel-select\" (window:mousedown)=\"reset()\" (window:touchstart)=\"reset()\">\r\n    <div class=\"panel-options\">\r\n        <ng-container *ngIf=\"systems && systems.length > 0; else none\">\r\n            <div class=\"item\" *ngFor=\"let id of systems | slice: 0:8; let i = index\" (tapped)=\"system_name[id] ? showPanel(id) : ''\">\r\n                <div class=\"bindings\" *ngIf=\"id\">\r\n                    <i binding [sys]=\"id\" mod=\"Bookings\" bind=\"room_name\" [(model)]=\"system_name[id]\"></i>\r\n                    <i binding [sys]=\"id\" mod=\"Bookings\" bind=\"icon\" [(model)]=\"system_icon[id]\"></i>\r\n                    <i binding [sys]=\"id\" mod=\"Bookings\" bind=\"today\" (modelChange)=\"updateStatus(id, $event)\"></i>\r\n                </div>\r\n                <div [class]=\"'icon' + (system_status[id] ? ' ' + system_status[id] : '')\">\r\n                    <img *ngIf=\"system_name[id]\" [src]=\"system_icon[id]\">\r\n                    <a-spinner *ngIf=\"!system_name[id]\" circle-ring color=\"#fff\"></a-spinner>\r\n                </div>\r\n                <div class=\"text\">{{ system_name[id] || id + ' connecting...' }}</div>\r\n            </div>\r\n        </ng-container>\r\n    </div>\r\n    <div class=\"panel-outlet\" *ngIf=\"active_system\">\r\n        <app-booking-panel [system_id]=\"active_system\"></app-booking-panel>\r\n        <div class=\"overlay\">\r\n            <button widget class=\"action close\" (tapped)=\"close()\" (contextmenu)=\"$event.preventDefault()\">\r\n                <div class=\"icon\">\r\n                    <i class=\"material-icons\">close</i>\r\n                </div>\r\n            </button>\r\n            <button widget class=\"action countdown\" (contextmenu)=\"$event.preventDefault()\">{{ countdown }}</button>\r\n        </div>\r\n    </div>\r\n    <ng-template #none>\r\n        <div class=\"info-block\">\r\n            <div class=\"text\">No systems are set for displaying on the panel select list</div>\r\n        </div>\r\n    </ng-template>\r\n</div>\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { BaseComponent } from '../../shared/base.component';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { HashMap } from '../../shared/utilities/types.utilities';\r\nimport { Space } from '../../services/data/spaces/space.class';\r\nimport { ApplicationService } from '../../services/app.service';\r\n\r\n@Component({\r\n    selector: 'app-booking-panel-select',\r\n    templateUrl: './panel-select.component.html',\r\n    styleUrls: ['./panel-select.component.scss']\r\n})\r\nexport class BookingPanelSelectComponent extends BaseComponent implements OnInit {\r\n    /** List of systems to show panels for */\r\n    public systems: string[];\r\n    /** Names for the list of systems */\r\n    public system_name: HashMap<string> = {};\r\n    /** Icons for the list of systems */\r\n    public system_icon: HashMap<string> = {};\r\n    /** Status for the list of systems */\r\n    public system_status: HashMap<string> = {};\r\n    /** Active Panel system */\r\n    public active_system: string;\r\n    /** Countdown counter */\r\n    public countdown: number;\r\n\r\n    constructor(private route: ActivatedRoute, private service: ApplicationService) {\r\n        super();\r\n    }\r\n\r\n    public ngOnInit(): void {\r\n        this.subscription('route.query', this.route.queryParamMap.subscribe((params) => {\r\n            if (params.has('system_ids')) {\r\n                this.systems = (params.get('system_ids') || '').split(',');\r\n            }\r\n        }));\r\n    }\r\n\r\n    /**\r\n     * Show booking panel for the given system ID\r\n     * @param id ID of the system to show\r\n     */\r\n    public showPanel(id: string) {\r\n        this.active_system = id;\r\n        this.reset();\r\n    }\r\n\r\n    /**\r\n     * Update the status value for the given system ID\r\n     * @param id ID of the system to update\r\n     * @param bookings List of current bookings for the system\r\n     */\r\n    public updateStatus(id: string, bookings: HashMap[]) {\r\n        const space = new Space(this.service.Spaces, { id, bookings });\r\n        this.system_status[id] = space.current ? 'available' : 'unavailable';\r\n    }\r\n\r\n    /**\r\n     * Close the modal\r\n     */\r\n    public close() {\r\n        this.active_system = null;\r\n        this.clearInterval('countdown');\r\n    }\r\n\r\n    /**\r\n     * User confirmation of the content of the modal\r\n     */\r\n    public reset() {\r\n        if (this.active_system) {\r\n            this.countdown = 30;\r\n            this.interval('countdown', () => this.tick(), 1000);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Decrement countdown and close if 0\r\n     */\r\n    public tick() {\r\n        if (this.countdown <= 0) {\r\n            this.close();\r\n        }\r\n        this.countdown--;\r\n    }\r\n}\r\n","<div class=\"booking-actions\">\r\n    <div class=\"actions\" *ngIf=\"space\">\r\n        <button widget class=\"end large action\" *ngIf=\"status === 'endable'\" (tapped)=\"confirmEnd()\" (contextmenu)=\"$event.preventDefault()\">\r\n            <div class=\"icon\">\r\n                <i class=\"material-icons\">event_busy</i>\r\n            </div>\r\n            <div class=\"text\">End</div>\r\n        </button>\r\n        <button widget class=\"start large action\" *ngIf=\"status === 'pending'\" (tapped)=\"startMeeting()\" (contextmenu)=\"$event.preventDefault()\">\r\n            <div class=\"icon\">\r\n                <i class=\"material-icons\">event_available</i>\r\n            </div>\r\n            <div class=\"text\">Start</div>\r\n        </button>\r\n        <button widget class=\"book large action\" *ngIf=\"!no_booking\" (tapped)=\"book()\" (contextmenu)=\"$event.preventDefault()\">\r\n            <div class=\"icon\">\r\n                <i class=\"material-icons\">add</i>\r\n            </div>\r\n            <div class=\"text\">Book</div>\r\n        </button>\r\n    </div>\r\n    <div class=\"bindings\" *ngIf=\"space\">\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"booking_disabled\" [(model)]=\"no_booking\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"last_meeting_started\" [(model)]=\"last_started\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"is_endable\" [(model)]=\"is_endable\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"timeout\" [(model)]=\"pending_timeout\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"cancel_timeout\" [(model)]=\"cancel_timeout\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"ask_start\" [(model)]=\"ask_start\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"ask_end\" [(model)]=\"ask_end\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"default_title\" [(model)]=\"default_title\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"min_duration\" [(model)]=\"min_duration\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"max_duration\" [(model)]=\"max_duration\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"business_start\" [(model)]=\"business_start\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"business_end\" [(model)]=\"business_end\"></i>\r\n    </div>\r\n</div>\r\n","\r\nimport { Component, Input } from '@angular/core';\r\n\r\nimport { Space } from '../../../services/data/spaces/space.class';\r\nimport { BaseComponent } from '../../../shared/base.component';\r\nimport { ApplicationService } from '../../../services/app.service';\r\nimport { timeToDate } from '../../../shared/utilities/general.utilities';\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\nexport type SpaceStatus = 'pending' | 'available' | 'unavailable' | 'endable';\r\n\r\n@Component({\r\n    selector: 'panel-booking-actions',\r\n    templateUrl: './booking-actions.component.html',\r\n    styleUrls: ['./booking-actions.component.scss']\r\n})\r\nexport class PanelBookingActionsComponent extends BaseComponent {\r\n    /** Space with which to display bookings for */\r\n    @Input() public space: Space;\r\n    /** Whether booking is allowed */\r\n    public no_booking: boolean = false;\r\n    /** Whether the current booking is able to be ended */\r\n    public is_endable: number;\r\n    /** Number of seconds before a meeting can be started, being truthy enables start/stop and auto-cancellations */\r\n    public pending_timeout: number;\r\n    /** Number of seconds after the start of a meeting when it is auto-cancelled, overrides `timeout` value */\r\n    public cancel_timeout: number;\r\n    /** Timestamp of the last started meeting as ms since UTC epoch */\r\n    public last_started: number;\r\n    /** Whether to ask user to start the meeting */\r\n    public ask_start: boolean;\r\n    /** Whether to ask user to end the meeting */\r\n    public ask_end: boolean;\r\n    /** Time of the last automatic confirmation of start or end */\r\n    public last_confirm: number = 0;\r\n    /** Default title for bookings */\r\n    public default_title: string;\r\n    /** Maximum allowed booking duation */\r\n    public max_duration: number;\r\n    /** Minimum allowed booking duation */\r\n    public min_duration: number;\r\n    /** Start time of the business day with format `HH:mm` */\r\n    public business_start: string;\r\n    /** End time of the business day with format `HH:mm` */\r\n    public business_end: string;\r\n\r\n    /** Current status of the active system */\r\n    public get status(): SpaceStatus{\r\n        let status: SpaceStatus = 'available';\r\n            if (this.space && (this.space.current || this.space.next)) {\r\n                const booking = this.space.current || this.space.next;\r\n                status = this.space.current ? 'unavailable' : 'available';\r\n                if (this.pending_timeout) {\r\n                    const now = dayjs().startOf('m').second(1);\r\n                    const business_start = dayjs(timeToDate(this.business_start || '08:00'));\r\n                    const business_end = dayjs(timeToDate(this.business_end || '17:30'));\r\n                    // Check if within business hours before looking at pending logic\r\n                    if (now.isBefore(business_start, 'm') || now.isAfter(business_end, 'm')) {\r\n                        return status;\r\n                    }\r\n                    const date = dayjs(booking.date);\r\n                    if (this.last_started >= now.valueOf() || this.last_started >= date.valueOf()) {\r\n                        if (this.is_endable && this.space.current) {\r\n                            const end = date.add(booking.duration, 'm').startOf('m');\r\n                            const block_end = end.subtract(Math.max(this.is_endable, 300), 's');\r\n                            if (now.isAfter(block_end, 's') && now.isBefore(end, 'm')) {\r\n                                status = 'endable';\r\n                                if (this.ask_end && this.last_confirm < end.valueOf()) {\r\n                                    this.confirmEnd();\r\n                                    this.last_confirm = end.valueOf();\r\n                                }\r\n                            } else {\r\n                                status = 'unavailable';\r\n                            }\r\n                        } else {\r\n                            status = 'unavailable';\r\n                        }\r\n                    } else {\r\n                        const pending_start = date.startOf('m').subtract(this.pending_timeout, 's');\r\n                        const pending_end = date.startOf('m').add(this.cancel_timeout || this.pending_timeout, 's');\r\n                        if (now.isAfter(pending_start, 's') && now.isBefore(pending_end, 's')) {\r\n                            status = 'pending';\r\n                            if (this.ask_start && this.last_confirm < date.valueOf()) {\r\n                                this.confirmStart();\r\n                                this.last_confirm = date.valueOf();\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        return status;\r\n    }\r\n\r\n    constructor(private service: ApplicationService) {\r\n        super();\r\n    }\r\n\r\n    /**\r\n     * Open modal to make a new booking\r\n     */\r\n    public book() {\r\n        this.service.Bookings.new({\r\n            space: this.space,\r\n            title: this.default_title,\r\n            max_duration: this.max_duration,\r\n            min_duration: this.min_duration\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Open confirmation modal for starting the meeting\r\n     */\r\n    public confirmStart() {\r\n        this.service.Overlay.open('confirm', {\r\n            config: 'modal',\r\n            data: {\r\n                title: 'Do you wish to start your meeting?',\r\n                body: `If you don't start your meeting it will be cancelled ${this.cancel_timeout / 60} minutes after the start time.`,\r\n                icon: { class: 'material-icons', value: 'play_arrow' }\r\n            }\r\n        }, _ => this.startMeeting());\r\n    }\r\n\r\n    /**\r\n     * Execute the logic on the engine driver to start the current or upcoming meeting\r\n     */\r\n    public startMeeting() {\r\n        if (this.space) {\r\n            const meeting = this.space.current || this.space.next;\r\n            const module = this.service.Systems.get(this.space.id, 'Bookings');\r\n            if (meeting && module) {\r\n                const date = dayjs(meeting.date);\r\n                module.exec('start_meeting', [meeting.date]).then(_ => {\r\n                    this.service.Analytics.event('Checkin', 'checked-in', `${this.space.id} at ${date.format('DD MMM YYYY, h:mm A Z')}`);\r\n                }, (e) => {\r\n                    this.service.notifyError(`Error starting meeting. ${e}`);\r\n                    this.service.Analytics.event('Checkin', 'checked-in-failed', `${this.space.id} at ${date.format('DD MMM YYYY, h:mm A Z')}`);\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Open confirmation modal for ending the meeting\r\n     */\r\n    public confirmEnd() {\r\n        this.service.Overlay.open('confirm', {\r\n            config: 'modal',\r\n            data: {\r\n                title: 'Are you sure want to end your meeting?',\r\n                body: 'Ending your meeting early will free up this room for others to use',\r\n                icon: { class: 'material-icons', value: 'stop' }\r\n            }\r\n        }, _ => this.endMeeting());\r\n    }\r\n\r\n    /**\r\n     * Execute end meeting logic on engine driver\r\n     * @param reason Reason for ending the meeting early\r\n     */\r\n    public endMeeting(reason: string = 'user_input') {\r\n        if (this.space) {\r\n            const meeting = this.space.current || this.space.next;\r\n            const module = this.service.Systems.get(this.space.id, 'Bookings');\r\n            if (meeting && module) {\r\n                const date = dayjs(meeting.date);\r\n                module.exec('cancel_meeting', [meeting.date, reason]).then(_ => {\r\n                    this.service.Analytics.event('Checkin', 'cancelled', `${this.space.id} at ${date.format('DD MMM YYYY, h:mm A Z')} | ${reason}`);\r\n                }, (e) => {\r\n                    this.service.notifyError(`Error starting meeting. ${e}`);\r\n                    this.service.Analytics.event('Checkin', 'cancel-failed', `${this.space.id} at ${date.format('DD MMM YYYY, h:mm A Z')} | ${reason}`);\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\n","<div class=\"custom-actions\">\r\n    <div class=\"actions\" *ngIf=\"space\">\r\n        <button widget class=\"action control\" *ngIf=\"can_control !== false && control_url\" (tapped)=\"openControl()\" (contextmenu)=\"$event.preventDefault()\">\r\n            <div class=\"icon\">\r\n                <i class=\"material-icons\">dvr</i>\r\n            </div>\r\n        </button>\r\n        <button widget class=\"action service\" *ngIf=\"catering\" (tapped)=\"confirmWaiterCall()\" (contextmenu)=\"$event.preventDefault()\">\r\n            <div class=\"icon\">\r\n                <i class=\"material-icons\">room_service</i>\r\n            </div>\r\n        </button>\r\n    </div>\r\n    <div class=\"bindings\" *ngIf=\"space\">\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"control_url\" [(model)]=\"control_url\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"can_control\" [(model)]=\"can_control\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"has_catering\" [(model)]=\"catering\"></i>\r\n    </div>\r\n</div>\r\n","import { Component, Input } from '@angular/core';\r\nimport { Space } from '../../../services/data/spaces/space.class';\r\nimport { ApplicationService } from '../../../services/app.service';\r\n\r\n@Component({\r\n    selector: 'panel-custom-actions',\r\n    templateUrl: './custom-actions.component.html',\r\n    styleUrls: ['./custom-actions.component.scss']\r\n})\r\nexport class PanelCustomActionsComponent {\r\n    /** Space with which to display bookings for */\r\n    @Input() public space: Space;\r\n    /** Control URL of the active space */\r\n    public control_url: string;\r\n    /** Whether the user is able to open the control URL */\r\n    public can_control: boolean;\r\n    /** Whether space has catering */\r\n    public catering: boolean;\r\n\r\n    constructor(private service: ApplicationService) {}\r\n\r\n    /**\r\n     * Open confirmation modal for ending the meeting\r\n     */\r\n    public confirmWaiterCall() {\r\n        this.service.Overlay.open('confirm', {\r\n            config: 'modal',\r\n            data: {\r\n                title: 'Call a waiter to your room?',\r\n                body: 'Call a waiter to your room to order catering',\r\n                icon: { class: 'material-icons', value: 'call' }\r\n            }\r\n        }, _ => this.callWaiter());\r\n    }\r\n\r\n    /**\r\n     * Execute call waiter logic on engine driver\r\n     */\r\n    public callWaiter() {\r\n        if (this.space) {\r\n            const module = this.service.Systems.get(this.space.id, 'Bookings');\r\n            if (module) {\r\n                module.exec('waiter_call', []).then(_ => {\r\n                    this.service.Analytics.event('Catering', 'waiter-call', (new Date).toISOString());\r\n                }, (e) => {\r\n                    this.service.Analytics.event('Catering', 'waiter-call-failed', (new Date).toISOString());\r\n                    this.service.notifyError(`Error calling waiter. ${e}`);\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Open modal to show embeded control URL\r\n     */\r\n    public openControl() {\r\n        this.service.Analytics.event('Control', 'open-view', (new Date).toISOString());\r\n        this.service.Overlay.open('embeded-control', {\r\n            config: 'modal',\r\n            data: {\r\n                control_url: this.control_url\r\n            }\r\n        });\r\n    }\r\n}\r\n","<div class=\"booking-panel\" [class.disabled]=\"interactive === false\" [class.reverse]=\"reverse || flip_status\" [class.no-time]=\"!show_time\">\r\n    <div [class]=\"'status' + (status && !hide_all ? ' ' + status : '')\">\r\n        <div class=\"time-display\" *ngIf=\"show_time\">{{ display_time }}</div>\r\n    </div>\r\n    <div class=\"body\">\r\n        <div class=\"details-display\">\r\n            <div class=\"content\">\r\n                <div class=\"title\" (tapped)=\"showTitle()\" [class.show]=\"show_title\">{{ space_name }}</div>\r\n                <div [class]=\"'status-text' + (status && !hide_all ? ' ' + status : '')\" >\r\n                    {{ (!hide_all ? status_display : null) || 'Not Bookable' }}\r\n                </div>\r\n                <div class=\"details\" *ngIf=\"!hide_all && show_details\">\r\n                    <panel-space-details [space]=\"space\"></panel-space-details>\r\n                </div>\r\n            </div>\r\n            <div class=\"overlay\" *ngIf=\"!hide_all && show_details\">\r\n                <panel-booking-actions [space]=\"space\"></panel-booking-actions>\r\n                <panel-custom-actions [space]=\"space\"></panel-custom-actions>\r\n            </div>\r\n        </div>\r\n        <div class=\"timeline\" *ngIf=\"show_details\">\r\n            <panel-timeline [space]=\"space\"></panel-timeline>\r\n        </div>\r\n    </div>\r\n    <div class=\"bindings\" *ngIf=\"system_id\">\r\n        <i binding [sys]=\"system_id\" mod=\"Bookings\" bind=\"room_name\" [(model)]=\"space_name\"></i>\r\n        <i binding [sys]=\"system_id\" mod=\"Bookings\" bind=\"touch_enabled\" [(model)]=\"interactive\"></i>\r\n        <i binding [sys]=\"system_id\" mod=\"Bookings\" bind=\"today\" (modelChange)=\"updateBookings($event)\"></i>\r\n        <i binding [sys]=\"system_id\" mod=\"Bookings\" bind=\"timeout\" [(model)]=\"pending_timeout\" (modelChange)=\"updateStatus()\"></i>\r\n        <i binding [sys]=\"system_id\" mod=\"Bookings\" bind=\"cancel_timeout\" [(model)]=\"cancel_timeout\" (modelChange)=\"updateStatus()\"></i>\r\n        <i binding [sys]=\"system_id\" mod=\"Bookings\" bind=\"last_meeting_started\" [(model)]=\"last_started\" (modelChange)=\"updateStatus()\"></i>\r\n        <i binding [sys]=\"system_id\" mod=\"Bookings\" bind=\"hide_all\" [(model)]=\"hide_all\"></i>\r\n        <i binding [sys]=\"system_id\" mod=\"Bookings\" bind=\"flip_status\" [(model)]=\"flip_status\"></i>\r\n        <i binding [sys]=\"system_id\" mod=\"Bookings\" bind=\"can_cancel\" [(model)]=\"can_cancel\"></i>\r\n        <i binding [sys]=\"system_id\" mod=\"Bookings\" bind=\"business_start\" [(model)]=\"business_start\"></i>\r\n        <i binding [sys]=\"system_id\" mod=\"Bookings\" bind=\"business_end\" [(model)]=\"business_end\"></i>\r\n        <i binding [sys]=\"system_id\" mod=\"Bookings\" bind=\"status_override\" [(model)]=\"status_overrides\"></i>\r\n    </div>\r\n</div>\r\n","import { Component, OnInit, Input } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\n\r\nimport { ApplicationService } from '../../services/app.service';\r\nimport { BaseComponent } from '../../shared/base.component';\r\nimport { Space } from '../../services/data/spaces/space.class';\r\nimport { HashMap } from '../../shared/utilities/types.utilities';\r\nimport { timeToDate } from '../../shared/utilities/general.utilities';\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\n@Component({\r\n    selector: 'app-booking-panel',\r\n    templateUrl: './panel.component.html',\r\n    styleUrls: ['./panel.component.scss']\r\n})\r\nexport class BookingPanelComponent extends BaseComponent implements OnInit {\r\n    /** ID of the active system */\r\n    @Input() public system_id: string;\r\n    /** Whether the status is on the right side */\r\n    @Input() public reverse: boolean;\r\n    /** Whether to show the time at the bottom of the status */\r\n    @Input() public show_time = true;\r\n    /** Name of the connected system */\r\n    public space_name: string;\r\n    /** Space with which to display bookings for */\r\n    public space: Space;\r\n    /** Number of seconds before a meeting can be started, being truthy enables start/stop and auto-cancellations */\r\n    public pending_timeout: number;\r\n    /** Number of seconds after the start of a meeting when it is auto-cancelled, overrides `timeout` value */\r\n    public cancel_timeout: number;\r\n    /** Timestamp of the last started meeting as ms since UTC epoch */\r\n    public last_started: number;\r\n    /** Whether to hide booking related details */\r\n    public hide_all: boolean;\r\n    /** Whether user interaction is enabled for the panel */\r\n    public interactive = true;\r\n    /** Whether status display is on the right side of the UI */\r\n    public flip_status: boolean;\r\n    /** Whether bookings can be cancelled if they timeout */\r\n    public can_cancel: boolean;\r\n    /** Time of the last cancelled meeting in ms since UTC epoch */\r\n    private last_cancel: number;\r\n    /** Start time of the business day with format `HH:mm` */\r\n    public business_start: string;\r\n    /** End time of the business day with format `HH:mm` */\r\n    public business_end: string;\r\n    /** Whether to show full room name when it overflows */\r\n    public show_title: boolean;\r\n    /** Override mapping for status values */\r\n    public status_overrides: HashMap<string>;\r\n    /** Status of websocket */\r\n    public websocket_connected: boolean;\r\n\r\n    /** Current status of the active system */\r\n    private _status: 'pending' | 'available' | 'unavailable';\r\n\r\n    /** Get the display value for the status */\r\n    public get status_display(): string {\r\n        if (!this.websocket_connected && !this._service.setting('show_status_when_disconnected')) {\r\n            return ' ';\r\n        }\r\n        if (this.status_overrides && Object.keys(this.status_overrides).length === 1) {\r\n            this._status = this.space.current ? 'unavailable' : Object.keys(this.status_overrides)[0] as any;\r\n        }\r\n        const status = (!this.hide_all ? this._status : null) || 'not-bookable';\r\n        return (this.status_overrides || [])[status] || this._status;\r\n    }\r\n\r\n    /** Current status of the active system */\r\n    public get status(): 'pending' | 'available' | 'unavailable' | 'not-bookable' {\r\n        if (!this.websocket_connected && !this._service.setting('show_status_when_disconnected')) {\r\n            return 'not-bookable';\r\n        }\r\n        // Perform any status overrides\r\n        this.updateStatus();\r\n        if (\r\n            this.status_overrides &&\r\n            Object.keys(this.status_overrides).length === 1 &&\r\n            (!this.space.current || this._status !== 'unavailable')\r\n        ) {\r\n            this._status = Object.keys(this.status_overrides)[0] as any;\r\n        }\r\n        return this._status;\r\n    }\r\n    /** Whether booking details should be shown */\r\n    public get show_details(): boolean {\r\n        return this.websocket_connected || !!this._service.setting('show_status_when_disconnected');\r\n    }\r\n\r\n    /** Display string for the current time */\r\n    public get display_time(): string {\r\n        return dayjs().format('h:mm A');\r\n    }\r\n\r\n    constructor(public _service: ApplicationService, public _route: ActivatedRoute) {\r\n        super();\r\n    }\r\n\r\n    public ngOnInit(): void {\r\n        this.subscription('app_ready', this._service.initialised.subscribe((is_ready) => {\r\n            if (is_ready) {\r\n                this.subscription(\r\n                    'route.params',\r\n                    this._route.paramMap.subscribe(params => {\r\n                        if (params.has('system_id')) {\r\n                            this.system_id = params.get('system_id');\r\n                            this._service.set('system', this.system_id);\r\n                        }\r\n                    })\r\n                );\r\n                this.timeout('websocket', () => {\r\n                    this._service.websocket.status(status => {\r\n                        this.websocket_connected = status;\r\n                    });\r\n                });\r\n                this.unsub('app_ready');\r\n            }\r\n        }));\r\n    }\r\n\r\n    /**\r\n     * Update the bookings for the active space\r\n     * @param bookings Array of raw booking data\r\n     */\r\n    public updateBookings(bookings: HashMap[]): void {\r\n        this.space = new Space(this._service.Spaces, {\r\n            id: this.system_id,\r\n            name: this.space_name,\r\n            bookings\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Update the current status of the active space\r\n     */\r\n    public updateStatus(): void {\r\n        if (this.hide_all) {\r\n            this._status = null;\r\n        } else {\r\n            if (this.space && (this.space.current || this.space.next)) {\r\n                const booking = this.space.current || this.space.next;\r\n                this._status = this.space.current ? 'unavailable' : 'available';\r\n                if (this.pending_timeout) {\r\n                    const now = dayjs();\r\n                    const date = dayjs(booking.date).startOf('m');\r\n                    if (this.last_started >= now.valueOf() || this.last_started >= date.valueOf()) {\r\n                        this._status = 'unavailable';\r\n                    } else {\r\n                        // Only meetings with durations less than 8 hours can be pending or cancelled\r\n                        const pending_start = date.subtract(this.pending_timeout, 's');\r\n                        const pending_end = date.add(this.cancel_timeout || this.pending_timeout, 's');\r\n                        const end = date.add(booking.duration, 'm');\r\n                        if (now.isAfter(pending_start, 's') && now.isBefore(pending_end, 's')) {\r\n                            this._status = 'pending';\r\n                        } else if (now.isAfter(pending_end, 's') && now.isBefore(end, 'm')) {\r\n                            this._status = 'pending';\r\n                            const business_start = dayjs(timeToDate(this.business_start || '08:00'));\r\n                            const business_end = dayjs(timeToDate(this.business_end || '17:30'));\r\n                            // Check if within business hours before cancelling the meeting\r\n                            if (now.isBefore(business_start, 'm') || now.isAfter(business_end, 'm')) {\r\n                                return;\r\n                            }\r\n                            this.endMeeting('timeout');\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                this._status = 'available';\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Show full room name if overflowing\r\n     */\r\n    public showTitle() {\r\n        this.show_title = true;\r\n        this.timeout('hide_title', () => (this.show_title = false), 3000);\r\n    }\r\n\r\n    /**\r\n     * Execute end meeting logic on engine driver\r\n     * @param reason Reason for ending the meeting early\r\n     */\r\n    private endMeeting(reason: string = 'user_input') {\r\n        if (this.space && this.can_cancel !== false) {\r\n            const meeting = this.space.current || this.space.next;\r\n            const module = this._service.Systems.get(this.space.id, 'Bookings');\r\n            if (meeting.duration >= 8 * 60 && reason === 'timeout') {\r\n                reason = 'hide multi-day';\r\n            }\r\n            if (meeting && module && meeting.date !== this.last_cancel) {\r\n                const date = dayjs(meeting.date);\r\n                module.exec('cancel_meeting', [meeting.date, reason]).then(\r\n                    _ => {\r\n                        this._service.Analytics.event(\r\n                            'Checkin',\r\n                            'cancelled',\r\n                            `${this.space.id} at ${date.format('DD MMM YYYY, h:mm A Z')} | ${reason}`\r\n                        );\r\n                        this.last_cancel = meeting.date;\r\n                    },\r\n                    e => {\r\n                        this._service.notifyError(`Error cancelling meeting. ${e}`);\r\n                        this._service.Analytics.event(\r\n                            'Checkin',\r\n                            'cancel-failed',\r\n                            `${this.space.id} at ${date.format('DD MMM YYYY, h:mm A Z')} | ${reason}`\r\n                        );\r\n                    }\r\n                );\r\n            }\r\n        }\r\n    }\r\n}\r\n","<div class=\"space-booking-details\">\r\n    <div class=\"details current\" *ngIf=\"space && space.current\">\r\n        <div class=\"time\" *ngIf=\"!hide_availability\">Booked until {{ space.current?.end_time }}</div>\r\n        <div class=\"title\" *ngIf=\"!hide_title && !hide_details\">{{ space.current?.title }}</div>\r\n        <div class=\"host\" *ngIf=\"!hide_user && !hide_details\">{{ space.current?.organiser?.name }}</div>\r\n    </div>\r\n    <div class=\"details next\" *ngIf=\"space && space.next\">\r\n        <div class=\"time\" *ngIf=\"!hide_availability\">Next meeting at {{ space.next?.start_time }}</div>\r\n        <div class=\"title\" *ngIf=\"!hide_title && !hide_details\">{{ space.next?.title }}</div>\r\n        <div class=\"host\" *ngIf=\"!hide_user && !hide_details\">{{ space.next?.organiser?.name }}</div>\r\n    </div>\r\n    <div class=\"details other\" *ngIf=\"space && space.current && space.next\">\r\n        <div class=\"time\" *ngIf=\"!hide_availability\">\r\n            Free {{ space.current ? 'at ' + space.current.end_time : '' }} {{ space.next ? 'until ' + space.next.start_time : '' }}\r\n        </div>\r\n    </div>\r\n    <div class=\"information\" *ngIf=\"title || description\">\r\n        <div class=\"title\">{{ title }}</div>\r\n        <div class=\"block\">\r\n            <div class=\"icon\" *ngIf=\"icon\">\r\n                <img [src]=\"icon\">\r\n            </div>\r\n            <div class=\"text\">{{ description }}</div>\r\n        </div>\r\n    </div>\r\n    <div class=\"bindings\" *ngIf=\"space\">\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"hide_details\" [(model)]=\"hide_details\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"hide_title\" [(model)]=\"hide_title\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"hide_availability\" [(model)]=\"hide_availability\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"hide_user\" [(model)]=\"hide_user\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"title\" [(model)]=\"title\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"description\" [(model)]=\"description\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"icon\" [(model)]=\"icon\"></i>\r\n    </div>\r\n</div>\r\n","\r\nimport { Component, Input } from '@angular/core';\r\n\r\nimport { Space } from '../../../services/data/spaces/space.class';\r\n\r\n@Component({\r\n    selector: 'panel-space-details',\r\n    templateUrl: './space-details.component.html',\r\n    styleUrls: ['./space-details.component.scss']\r\n})\r\nexport class PanelSpaceDetailsComponent {\r\n    /** Space with which to display bookings for */\r\n    @Input() public space: Space;\r\n    /** Secondary title for the space */\r\n    public title: string;\r\n    /** Description for the space */\r\n    public description: string;\r\n    /** Image that suppliments the description for the space */\r\n    public icon: { class?: string, value?: string, src?: string };\r\n\r\n    /** Whether to hide the booking timing details */\r\n    public hide_availability: boolean;\r\n    /** Whether to hide the current booking title */\r\n    public hide_title: boolean;\r\n    /** Whether to hide booking details(title and host) */\r\n    public hide_details: boolean;\r\n    /** Whether to hide booking host */\r\n    public hide_user: boolean;\r\n}\r\n\r\n","<div class=\"timeline\">\r\n    <div class=\"block-list\" *ngIf=\"time_blocks && time_blocks.length > 0\">\r\n        <div\r\n            class=\"block\"\r\n            *ngFor=\"let item of time_blocks\"\r\n            [class.show]=\"item.show || item.hour\"\r\n            [class.in-use]=\"item.in_use\"\r\n            (tapped)=\"!item.in_use && !no_bookings && !no_timeline_bookings ? book(item) : ''\"\r\n        >\r\n            <div class=\"hour\" *ngIf=\"item.hour\">{{ item.hour }}</div>\r\n            <div class=\"bar\" [class.hour]=\"item.hour\"></div>\r\n        </div>\r\n    </div>\r\n    <div class=\"overlay\">\r\n        <div class=\"expired\" [style.width]=\"((options?.start_offset || 120) / (options?.duration || 720)) * 100 + '%'\"></div>\r\n        <div class=\"current-block\" [style.left]=\"((options?.start_offset || 120) / (options?.duration || 720)) * 100 + '%'\">\r\n            <div class=\"bar\"></div>\r\n            <div class=\"triangle\"></div>\r\n            <div class=\"time-display\" *ngIf=\"display_time\">Time Now<br>{{ display_time }}</div>\r\n        </div>\r\n    </div>\r\n    <div class=\"bindings\" *ngIf=\"space\">\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"hide_availability\" [(model)]=\"hide_status\" (modelChange)=\"checkBookings()\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"hide_all\" [(model)]=\"hide_all\" (modelChange)=\"checkBookings()\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"booking_disabled\" [(model)]=\"no_bookings\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"no_timeline_bookings\" [(model)]=\"no_timeline_bookings\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"default_title\" [(model)]=\"default_title\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"min_duration\" [(model)]=\"min_duration\"></i>\r\n        <i binding [sys]=\"space.id\" mod=\"Bookings\" bind=\"max_duration\" [(model)]=\"max_duration\"></i>\r\n    </div>\r\n</div>\r\n","\r\nimport { Component, OnInit, Input, Output, EventEmitter, SimpleChanges, OnChanges } from '@angular/core';\r\nimport { BaseComponent } from '../../../shared/base.component';\r\nimport { Space } from '../../../services/data/spaces/space.class';\r\n\r\nimport * as dayjs from 'dayjs';\r\nimport { BookingData } from '../../../overlays/booking-modal/booking-modal.component';\r\nimport { HashMap } from '../../../shared/utilities/types.utilities';\r\nimport { ApplicationService } from '../../../services/app.service';\r\n\r\nexport interface IPanelTimelineOptions {\r\n    /** Length of time in minutes to display on the timeline after the current time */\r\n    duration: number;\r\n    /** Time offset in minutes which is displayed before the current time marker */\r\n    start_offset: number;\r\n    /** Size of shown blocks in minutes */\r\n    block_size: number;\r\n}\r\n\r\ninterface ITimelineBlock {\r\n    /** Block time as ms since UTC epoch */\r\n    value: number;\r\n    /** Whether to show block divider */\r\n    show: boolean;\r\n    /** Hour of the day represented by this time block */\r\n    hour: number;\r\n    /** Whether block is in use or not */\r\n    in_use: boolean;\r\n}\r\n\r\n@Component({\r\n    selector: 'panel-timeline',\r\n    templateUrl: './timeline.component.html',\r\n    styleUrls: ['./timeline.component.scss']\r\n})\r\nexport class PanelTimelineComponent extends BaseComponent implements OnInit, OnChanges {\r\n    /** Space with which to display bookings for */\r\n    @Input() public space: Space;\r\n    /** Display options for the timeline */\r\n    @Input() public options: IPanelTimelineOptions;\r\n    /** Emitter for user events on the timeline */\r\n    @Output() public event = new EventEmitter();\r\n\r\n    /** List of display time block  */\r\n    public time_blocks: ITimelineBlock[] = [];\r\n    /** Whether to hide unavailable blocks on the UI */\r\n    public hide_status: boolean;\r\n    /** Whether to hide all booking data */\r\n    public hide_all: boolean;\r\n    /** Whether user is not allowed to make bookings */\r\n    public no_booking: boolean;\r\n    /** Whether user is not allowed to make bookings using the timeline */\r\n    public no_timeline_bookings: boolean;\r\n    /** Default title for bookings */\r\n    public default_title: string;\r\n    /** Maximum allowed booking duation */\r\n    public max_duration: number;\r\n    /** Minimum allowed booking duation */\r\n    public min_duration: number;\r\n\r\n    /** Display string for the current time */\r\n    public get display_time(): string {\r\n        return dayjs().format('h:mm A')\r\n    }\r\n\r\n    constructor(private service: ApplicationService) {\r\n        super();\r\n    }\r\n\r\n    public ngOnInit(): void {\r\n        this.generateTimelineBlocks();\r\n        this.interval('update_blocks', () => this.generateTimelineBlocks(), 60 * 1000);\r\n    }\r\n\r\n    public ngOnChanges(changes: SimpleChanges): void {\r\n        this.generateTimelineBlocks();\r\n    }\r\n\r\n    /**\r\n     * Generate time blocks to display\r\n     */\r\n    private generateTimelineBlocks(): void {\r\n        let now = dayjs().startOf('m');\r\n        now = now.minute(Math.round(now.minute() / 5) * 5);\r\n        const start = now.subtract((this.options ? this.options.start_offset : null) || 120, 'm');\r\n        const end = start.add((this.options ? this.options.duration : null) || 720, 'm');\r\n        let date = dayjs(start);\r\n        delete this.time_blocks;\r\n        this.time_blocks = [];\r\n        while (date.isBefore(end, 'm')) {\r\n            this.time_blocks.push({\r\n                value: date.valueOf(),\r\n                show: (date.minute() % ((this.options ? this.options.block_size : null) || 30)) === 0,\r\n                hour: date.minute() === 0 ? (date.hour() % 12 === 0 ? 12 : date.hour() % 12) : null,\r\n                in_use: false\r\n            });\r\n            date = date.add(5, 'm');\r\n        }\r\n        this.checkBookings();\r\n    }\r\n\r\n    /**\r\n     * Update the statuses of time blocks based off space bookings\r\n     */\r\n    public checkBookings(): void {\r\n        if (this.space && this.space.todays_bookings) {\r\n            const block_start = dayjs().subtract((this.options ? this.options.start_offset : null) || 120, 'm');\r\n            const block_end = dayjs().add((this.options ? this.options.duration : null) || 720, 'm');\r\n            // Filter bookings for the shown times\r\n            const bookings = this.space.bookings.filter(i => {\r\n                const start = dayjs(i.date);\r\n                const end = start.add(i.duration, 'm');\r\n                return end.isAfter(block_start, 'm') && start.isBefore(block_end, 'm');\r\n            });\r\n            this.time_blocks.forEach(i => i.in_use = false);\r\n            if (!this.hide_status && !this.hide_all) {\r\n                for (const booking of bookings) {\r\n                    const start = dayjs(booking.date);\r\n                    const end = start.add(booking.duration, 'm');\r\n                    for (const block of this.time_blocks) {\r\n                        const block_time = dayjs(block.value);\r\n                        if (block_time.isSame(start, 'm') || (block_time.isAfter(start, 'm') && block_time.isBefore(end, 'm'))) {\r\n                            block.in_use = true;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Open modal to make a new booking\r\n     */\r\n    public book(block: ITimelineBlock) {\r\n        this.service.Bookings.new({\r\n            space: this.space,\r\n            date: block.value,\r\n            title: this.default_title,\r\n            max_duration: this.max_duration,\r\n            min_duration: this.min_duration\r\n        });\r\n    }\r\n}\r\n\r\n","\r\n<div class=\"shell\">\r\n    <div class=\"view\">\r\n        <router-outlet></router-outlet>\r\n    </div>\r\n    <div class=\"bindings\" *ngIf=\"system_id\">\r\n        <i binding [sys]=\"system_id\" mod=\"Bookings\" bind=\"room_name\" [(model)]=\"system_name\" (modelChange)=\"checkLoading()\"></i>\r\n        <i binding [sys]=\"system_id\" mod=\"Bookings\" bind=\"reload\" (modelChange)=\"reloadAt($event)\"></i>\r\n    </div>\r\n    <div class=\"loading-block\" *ngIf=\"system_id && !system_name\">\r\n        <div class=\"info-block\">\r\n            <div class=\"title\">Connecting to system({{system_id}})...</div>\r\n            <div class=\"text\">Attempting to connect to engine server...</div>\r\n            <div class=\"text message\">{{info_messages[message_index]}}</div>\r\n            <div class=\"icon\">\r\n                <a-spinner ring-rotate color=\"#000\"></a-spinner>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"version\" *ngIf=\"show_version\" [class.loading]=\"system_id && !system_name\">\r\n        Version: {{ version }}<br>\r\n        Built: {{ build }}\r\n    </div>\r\n</div>","import { Component, OnInit } from '@angular/core';\r\nimport { NavigationEnd, Router } from '@angular/router';\r\n\r\nimport { BaseComponent } from '../shared/base.component';\r\nimport { ApplicationService } from '../services/app.service';\r\nimport { version, build } from '../shared/globals/application';\r\n\r\nimport * as dayjs from 'dayjs';\r\n\r\n@Component({\r\n    selector: 'app-shell-wrapper',\r\n    templateUrl: './shell.component.html',\r\n    styleUrls: ['./shell.component.scss']\r\n})\r\nexport class ShellWrapperComponent extends BaseComponent implements OnInit {\r\n    /** Whether application has system */\r\n    public has_system: boolean;\r\n    /** ID of the active system */\r\n    public system_id: string;\r\n    /** Name of the active system */\r\n    public system_name: string;\r\n    /** Name of the active page */\r\n    public page: string;\r\n    /** List of informational messages to display while connecting to the active system */\r\n    public info_messages: string[] = [\r\n        'If this message persists, check you network connection and then try reloading this page.',\r\n        'It seems to be taking a while. Make sure the selected system is valid.',\r\n        'Still nothing, huh. Are you authenticated? Do you have have a network connection?',\r\n        'Try reloading the page. If this persists contact your administrator.'\r\n    ];\r\n    /** Index of the info message being displayed */\r\n    public message_index: number = 0;\r\n\r\n    /** Current version of the application */\r\n    public get version(): string {\r\n        return version;\r\n    }\r\n\r\n    /** Current version of the application */\r\n    public get build(): string {\r\n        const now = dayjs();\r\n        const built = build.format('DD/MM/YY HH:mm');\r\n        return built;\r\n    }\r\n\r\n    public get show_version(): boolean {\r\n        return this._service.setting('app.show_version');\r\n    }\r\n\r\n    constructor(private _service: ApplicationService, private _router: Router) {\r\n        super();\r\n    }\r\n\r\n    public ngOnInit(): void {\r\n        this.subscription('app_ready', this._service.initialised.subscribe((is_ready) => {\r\n            if (is_ready) {\r\n                // Listen for system changes\r\n                this.subscription('system', this._service.listen('system', (value) => this.system_id = value));\r\n                // Listen for routing events\r\n                this.page = this._router.url?.split('/')[1] || '';\r\n\r\n                this.subscription(\r\n                    'router.change',\r\n                    this._router.events.subscribe(event => {\r\n                        if (event instanceof NavigationEnd) {\r\n                            this.page = this._router.url.split('/')[1] || '';\r\n                        }\r\n                    })\r\n                );\r\n                this.unsub('app_ready');\r\n            }\r\n        }));\r\n    }\r\n\r\n    /**\r\n     * Check if the system data has loaded\r\n     * @param delay Delay before first loading message update\r\n     */\r\n    public checkLoading(delay: number = 3000) {\r\n        if (!this.system_name) {\r\n            this.message_index = 0;\r\n            this.timeout('update_msg', () => this.updateMessage(), delay);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Update the index of the info message displayed\r\n     */\r\n    private updateMessage(): void {\r\n        if (!this.system_id) { return; }\r\n        this.message_index++;\r\n        if (this.message_index === this.info_messages.length) {\r\n            this.message_index--;\r\n            return;\r\n        }\r\n        this.timeout('update_msg', () => this.updateMessage(), 3000);\r\n    }\r\n\r\n    /**\r\n     * Schedule a reload the UI for a future time\r\n     * @param time Time to reload the UI\r\n     */\r\n    public reloadAt(time: number): void {\r\n        if (time && typeof time === 'number') {\r\n            this.clearTimeout('reload_ui');\r\n            const now = dayjs().startOf('s');\r\n            const reload_at_time = dayjs((time || 0) * 1000).startOf('s');\r\n            const diff = reload_at_time.diff(now, 'ms');\r\n            if (diff > 100) {\r\n                this.timeout('reload_ui', () => location.reload(true), diff);\r\n            }\r\n        }\r\n        this.timeout('update_msg', () => this.updateMessage(), 3000);\r\n    }\r\n}\r\n","export const environment = {\r\n  production: true\r\n};\r\n","// IMPORTANT: THIS FILE IS AUTO GENERATED! DO NOT MANUALLY EDIT OR CHECKIN!\n/* tslint:disable */\nexport const VERSION = {\n    \"dirty\": true,\n    \"raw\": \"a01119b-dirty\",\n    \"hash\": \"a01119b\",\n    \"distance\": null,\n    \"tag\": null,\n    \"semver\": null,\n    \"suffix\": \"a01119b-dirty\",\n    \"semverString\": null,\n    \"version\": \"0.0.0\",\n    \"core_version\": \"1.0.0\",\n    \"time\": 1596546807556\n};\n/* tslint:enable */\n","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic().bootstrapModule(AppModule)\r\n  .catch(err => console.error(err));\r\n"]}