function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,a=!0,r=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return a=e.done,e},e:function(e){r=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(r)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){return function(){var t,n=_getPrototypeOf(e);if(_isNativeReflectConstruct()){var i=_getPrototypeOf(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{Xi7U:function(e,t,n){"use strict";n.r(t);var i=n("ofXK"),o=n("3Pt+"),a=n("vxfF"),r=n("tyNb"),c=n("Cvi9"),s=n("IWZj"),l=n("OaWH"),d=n("fXoL"),u=n("ocbO"),v=n("p5rm"),f=n("4Uey"),b=n("bTqV"),h=n("Xa2L"),g=n("xhdr"),p=n("YxBP"),m=n("ceWj"),_=n("Wgwc"),C=n("0IaG"),y=n("m6yr"),w=function(e){return[e]};function O(e,t){if(1&e){var n=d.Xb();d.Ub(0),d.Wb(1,"i",23),d.lc("modelChange",(function(e){d.Dc(n);var t=d.pc().$implicit;return d.pc().last_start[t.id]=e})),d.Vb(),d.Wb(2,"i",24),d.lc("modelChange",(function(e){return d.Dc(n),d.pc(2).checkin=e})),d.Vb(),d.Tb()}if(2&e){var i=d.pc().$implicit,o=d.pc();d.Cb(1),d.vc("model",o.last_start[i.id])("sys",i.id),d.Cb(1),d.vc("model",o.checkin)("sys",i.id)("params",d.xc(5,w,o.event.date))}}function M(e,t){if(1&e&&(d.Ub(0),d.Lc(1,O,3,7,"ng-container",22),d.Tb()),2&e){var n=t.$implicit;d.Cb(1),d.vc("ngIf",null==n?null:null==n.level?null:n.level.id)}}function x(e,t){if(1&e){var n=d.Xb();d.Wb(0,"button",29),d.lc("touchrelease",(function(){d.Dc(n);var e=d.pc().$implicit;return d.pc().locate(e)})),d.Nc(1," Map "),d.Vb()}}function k(e,t){if(1&e&&(d.Wb(0,"a",30),d.Nc(1,"Control"),d.Vb()),2&e){var n=d.pc().$implicit;d.vc("href",n.support_url,d.Fc)}}function P(e,t){if(1&e&&(d.Wb(0,"div",25),d.Rb(1,"div",26),d.Wb(2,"div",27),d.Nc(3),d.Vb(),d.Lc(4,x,2,0,"button",12),d.Lc(5,k,2,1,"a",28),d.Vb()),2&e){var n=t.$implicit,i=d.pc();d.vc("title",(null==n?null:n.name)+" - "+((null==n?null:n.status)||"Approved")),d.Cb(3),d.Oc(null==n?null:n.name),d.Cb(1),d.vc("ngIf",null==n?null:n.map_id),d.Cb(1),d.vc("ngIf",(null==n?null:n.support_url)&&i.can_control)}}function W(e,t){1&e&&(d.Wb(0,"div",31),d.Nc(1,"No Location"),d.Vb())}function V(e,t){if(1&e){var n=d.Xb();d.Wb(0,"button",29),d.lc("touchrelease",(function(){d.Dc(n);var e=d.pc();return e.show_locations=!e.show_locations})),d.Nc(1),d.Vb()}if(2&e){var i=d.pc();d.Cb(1),d.Pc(" ",i.show_locations?"Hide":"Show"," Locations ")}}function I(e,t){if(1&e&&(d.Wb(0,"div",34),d.Wb(1,"a",35),d.Nc(2),d.Vb(),d.Vb()),2&e){var n=d.pc().$implicit,i=d.pc();d.Cb(1),d.vc("href","mailto:"+n.email+"?subject="+i.event.title,d.Fc),d.Cb(1),d.Oc(n.email)}}function S(e,t){if(1&e&&(d.Wb(0,"div",25),d.Rb(1,"div",26),d.Wb(2,"div",27),d.Wb(3,"div",32),d.Nc(4),d.Vb(),d.Lc(5,I,3,2,"div",33),d.Vb(),d.Vb()),2&e){var n=t.$implicit;d.vc("title",(null==n?null:n.name)+" - "+((null==n?null:n.status)||"Accepted")+(null!=n&&n.email?"\n"+n.email:"")),d.Cb(4),d.Oc(n.name),d.Cb(1),d.vc("ngIf",n.email)}}function N(e,t){if(1&e){var n=d.Xb();d.Wb(0,"button",29),d.lc("touchrelease",(function(){d.Dc(n);var e=d.pc();return e.show_attendees=!e.show_attendees})),d.Nc(1),d.Vb()}if(2&e){var i=d.pc();d.Cb(1),d.Pc(" ",i.show_attendees?"Hide":"Show"," Attendees ")}}function D(e,t){1&e&&(d.Wb(0,"div",36),d.Wb(1,"label"),d.Nc(2,"Catered:"),d.Vb(),d.Wb(3,"div",5),d.Nc(4,"Yes"),d.Vb(),d.Vb())}function L(e,t){if(1&e&&(d.Wb(0,"button",37),d.Wb(1,"div",27),d.Nc(2),d.Vb(),d.Vb()),2&e){var n=d.pc();d.Eb("done"!==n.status||n.is_checked_in?n.is_checked_in?"success no-events":"":"error no-events"),d.Cb(2),d.Pc(" ","done"!==n.status||n.is_checked_in?n.is_checked_in?"Checked in":"Checkin":"Cancelled"," ")}}function A(e,t){if(1&e){var n=d.Xb();d.Wb(0,"button",38),d.lc("tapped",(function(){return d.Dc(n),d.pc().edit()})),d.Nc(1,"Edit"),d.Vb()}}function T(e,t){if(1&e){var n=d.Xb();d.Wb(0,"button",39),d.lc("tapped",(function(){return d.Dc(n),d.pc().duplicate()})),d.Nc(1,"Duplicate"),d.Vb()}}var z,Y=((z=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o){var a;return _classCallCheck(this,n),(a=t.call(this))._service=e,a._dialog=i,a._router=o,a.change=new d.n,a.loading=new d.n,a.last_start={},a}return _createClass(n,[{key:"locate",value:function(e){if(e){var t=this._service.Spaces.item(e.id)||e;this._dialog.open(m.a,{width:"auto",height:"auto",maxWidth:"95vw",maxHeight:"95vh",data:{space:t}})}}},{key:"edit",value:function(){this.change.emit({type:"edit"})}},{key:"checkin",value:function(){this.checked_in=!this.checked_in}},{key:"duplicate",value:function(){if(localStorage){var e=this.event.duplicate();localStorage.setItem("STAFF.booking_form",JSON.stringify(e))}this.change.emit({type:"duplicate"}),this._router.navigate(["/book"])}},{key:"title",get:function(){return this.event&&this.event.title||""}},{key:"when",get:function(){if(!this.event)return"Unable to determine.";var e=_(this.event.date),t=e.add(this.event.duration||60,"m");return this.event.all_day||this.event.duration>1380?"".concat(e.format("DD MMM YYYY")," - All Day"):e.isSame(t,"d")?"".concat(e.format("DD MMM YYYY, h:mm A")," - ").concat(t.format("h:mm A")):"".concat(e.format("DD MMM YYYY, h:mm A")," - ").concat(t.format("DD MMM YYYY, h:mm A"))}},{key:"duration",get:function(){return this.event?Object(p.g)(this.event.duration||60):"Unable to determine"}},{key:"spaces",get:function(){return this.event?this.event.space_list||(this.event.space?[this.event.space]:[]):[]}},{key:"attendees",get:function(){var e=this;return this.event&&this.event.attendees.filter((function(t){return t.email!==e.organiser.email}))||[]}},{key:"organiser",get:function(){return this.event&&this.event.organiser||this._service.Users.current}},{key:"can_edit",get:function(){return this.organiser.email===this._service.Users.current.email&&"done"!==this.status}},{key:"notes",get:function(){return this.event&&this.event.description||""}},{key:"status",get:function(){if(this.event){var e=_(),t=_(this.event.date);if(e.isBefore(t.subtract(15,"m"),"m"))return"future";if(e.isBefore(t,"m"))return"upcoming";if(e.isBefore(t.add(15,"m"),"m"))return"started";if(e.isBefore(t.add(this.event.duration,"m"),"m"))return"in_progress"}return"done"}},{key:"is_checked_in",get:function(){var e=this;return this.spaces.reduce((function(t,n){return t&&e.event.date<=(e.last_start[n.id]||0)}),!0)}},{key:"can_control",get:function(){return this.spaces.length>0&&"future"!==this.status&&"done"!==this.status}},{key:"can_checkin",get:function(){return this.spaces.length>0&&("upcoming"===this.status||"started"===this.status)}}]),n}(s.a)).\u0275fac=function(e){return new(e||z)(d.Qb(l.a),d.Qb(C.b),d.Qb(r.d))},z.\u0275cmp=d.Kb({type:z,selectors:[["schedule-event-details"]],inputs:{event:"event"},outputs:{change:"change",loading:"loading"},features:[d.zb],decls:48,vars:21,consts:[[1,"event-details"],[1,"bindings"],[4,"ngFor","ngForOf"],[1,"body"],["name","title",1,"field"],[1,"value"],["name","when",1,"field"],["name","duration",1,"field"],["name","location",1,"field","multi"],[1,"list"],["class","list-item",3,"title",4,"ngFor","ngForOf"],["class","list-item",4,"ngIf"],["class","show",3,"touchrelease",4,"ngIf"],["name","host",1,"field"],["name","attendees",1,"field","multi"],["name","notes",1,"field"],[1,"value",3,"innerHTML"],["class","field","name","catering",4,"ngIf"],[1,"footer"],["mat-button","",3,"class",4,"ngIf"],["mat-button","","name","edit",3,"tapped",4,"ngIf"],["mat-button","","name","duplicate",3,"tapped",4,"ngIf"],[4,"ngIf"],["binding","","mod","Booking","bind","last_meeting_started",3,"model","sys","modelChange"],["binding","","mod","Booking","exec","start_meeting",3,"model","sys","params","modelChange"],[1,"list-item",3,"title"],[1,"status"],[1,"text"],["class","show","target","_blank",3,"href",4,"ngIf"],[1,"show",3,"touchrelease"],["target","_blank",1,"show",3,"href"],[1,"list-item"],[1,"name"],["class","email",4,"ngIf"],[1,"email"],[3,"href"],["name","catering",1,"field"],["mat-button",""],["mat-button","","name","edit",3,"tapped"],["mat-button","","name","duplicate",3,"tapped"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"div",1),d.Lc(2,M,2,1,"ng-container",2),d.Vb(),d.Wb(3,"div",3),d.Wb(4,"div",4),d.Wb(5,"label"),d.Nc(6,"Title:"),d.Vb(),d.Wb(7,"div",5),d.Nc(8),d.Vb(),d.Vb(),d.Wb(9,"div",6),d.Wb(10,"label"),d.Nc(11,"When:"),d.Vb(),d.Wb(12,"div",5),d.Nc(13),d.Vb(),d.Vb(),d.Wb(14,"div",7),d.Wb(15,"label"),d.Nc(16,"Duration:"),d.Vb(),d.Wb(17,"div",5),d.Nc(18),d.Vb(),d.Vb(),d.Wb(19,"div",8),d.Wb(20,"label"),d.Nc(21),d.Vb(),d.Wb(22,"div",5),d.Wb(23,"div",9),d.Lc(24,P,6,4,"div",10),d.Lc(25,W,2,0,"div",11),d.Vb(),d.Lc(26,V,2,1,"button",12),d.Vb(),d.Vb(),d.Wb(27,"div",13),d.Wb(28,"label"),d.Nc(29,"Host:"),d.Vb(),d.Wb(30,"div",5),d.Nc(31),d.Vb(),d.Vb(),d.Wb(32,"div",14),d.Wb(33,"label"),d.Nc(34),d.Vb(),d.Wb(35,"div",5),d.Wb(36,"div",9),d.Lc(37,S,6,3,"div",10),d.Vb(),d.Lc(38,N,2,1,"button",12),d.Vb(),d.Vb(),d.Wb(39,"div",15),d.Wb(40,"label"),d.Nc(41,"Notes:"),d.Vb(),d.Rb(42,"div",16),d.Vb(),d.Lc(43,D,5,0,"div",17),d.Vb(),d.Wb(44,"div",18),d.Lc(45,L,3,3,"button",19),d.Lc(46,A,2,0,"button",20),d.Lc(47,T,2,0,"button",21),d.Vb(),d.Vb()),2&e&&(d.Cb(2),d.vc("ngForOf",t.spaces),d.Cb(6),d.Oc(t.title),d.Cb(5),d.Oc(t.when),d.Cb(5),d.Oc(t.duration),d.Cb(3),d.Pc("Locations(",t.spaces.length||"0","):"),d.Cb(2),d.Gb("shown",t.show_locations),d.Cb(1),d.vc("ngForOf",t.spaces),d.Cb(1),d.vc("ngIf",!t.spaces.length),d.Cb(1),d.vc("ngIf",t.spaces.length>5),d.Cb(5),d.Oc(t.organiser.name),d.Cb(3),d.Pc("Attendees(",t.attendees.length||"0","):"),d.Cb(2),d.Gb("shown",t.show_attendees),d.Cb(1),d.vc("ngForOf",t.attendees),d.Cb(1),d.vc("ngIf",t.attendees.length>5),d.Cb(4),d.vc("innerHTML",t.notes,d.Ec),d.Cb(1),d.vc("ngIf",t.event&&t.event.has_catering),d.Cb(2),d.vc("ngIf",t.can_checkin),d.Cb(1),d.vc("ngIf",t.can_edit),d.Cb(1),d.vc("ngIf",t.can_edit))},directives:[i.s,i.t,c.a,y.c,b.b],styles:[".event-details[_ngcontent-%COMP%]{width:100%;padding:1em 2em}.field[_ngcontent-%COMP%]{display:flex;margin:1em 0}@media only screen and (orientation:portrait) and (max-width:450px){.field[_ngcontent-%COMP%]{flex-wrap:wrap}}@media only screen and (orientation:landscape) and (max-width:800px){.field[_ngcontent-%COMP%]{flex-wrap:wrap}}.field[name=title][_ngcontent-%COMP%]{display:none}@media only screen and (orientation:portrait) and (max-width:450px){.field[name=title][_ngcontent-%COMP%]{display:flex}}@media only screen and (orientation:landscape) and (max-width:800px){.field[name=title][_ngcontent-%COMP%]{display:flex}}label[_ngcontent-%COMP%]{width:8em;margin-top:.25em;margin-right:1em;font-weight:700;font-size:.8em}@media only screen and (orientation:portrait) and (max-width:450px){label[_ngcontent-%COMP%]{width:100%;margin-bottom:.5em}}@media only screen and (orientation:landscape) and (max-width:800px){label[_ngcontent-%COMP%]{width:100%;margin-bottom:.5em}}.value[_ngcontent-%COMP%]{flex:1;min-width:50%;padding:0 .5em}.value[_ngcontent-%COMP%]   .show[_ngcontent-%COMP%]{font-size:.8em;background:none;border:none;outline:none;text-decoration:underline;cursor:pointer}.value[_ngcontent-%COMP%]   .show[_ngcontent-%COMP%]:hover{color:#1937ea}.multi[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{margin-top:-.25em}.footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;padding:.5em}.list[_ngcontent-%COMP%]{max-height:15em;overflow:hidden;margin-left:-.5em}.list.shown[_ngcontent-%COMP%]{max-height:100em}.email[_ngcontent-%COMP%]{font-size:.75em;color:rgba(0,0,0,.6)}.list-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.25em .5em;border-radius:8px;width:100%}.list-item[_ngcontent-%COMP%]:nth-child(2n){background-color:rgba(0,0,0,.05)}.list-item[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{height:8px;width:8px;border-radius:100%;background-color:#43a047;margin:.5em .5em .5em 0}.list-item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{margin-right:1em;flex:1;min-width:50%}a[_ngcontent-%COMP%]{color:inherit}[name=attendees][_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{margin-bottom:1.5em}button[_ngcontent-%COMP%]{width:8em;margin:.25em;white-space:nowrap}"]}),z),E=n("5RMF"),F=n("Ofvs"),R=n("4Man");function j(e,t){if(1&e){var n=d.Xb();d.Wb(0,"form",2),d.lc("ngSubmit",(function(){return d.Dc(n),d.pc().save()})),d.Wb(1,"div",3),d.Rb(2,"a-booking-form",4),d.Vb(),d.Wb(3,"div",5),d.Wb(4,"button",6),d.lc("tapped",(function(){return d.Dc(n),d.pc().cancel()})),d.Nc(5,"Cancel"),d.Vb(),d.Wb(6,"button",7),d.Nc(7,"Save"),d.Vb(),d.Vb(),d.Vb()}if(2&e){var i=d.pc();d.vc("formGroup",i.form),d.Cb(2),d.vc("form",i.form)}}var U,B=((U=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var o;return _classCallCheck(this,n),(o=t.call(this))._service=e,o._dialog=i,o.change=new d.n,o.loading=new d.n,o}return _createClass(n,[{key:"ngOnInit",value:function(){this.event&&(this.form=Object(E.a)(this.event,this._service.Users.current,this._service.setting("app.booking.show_fields")||[]))}},{key:"ngOnChanges",value:function(e){e.event&&this.event&&(this.form&&e.event.previousValue&&e.event.previousValue.emit("item_saved"),this.form=Object(E.a)(this.event,this._service.Users.current,this._service.setting("app.booking.show_fields")||[]))}},{key:"ngOnDestroy",value:function(){this.form&&this.event&&this.event.emit("item_saved")}},{key:"cancel",value:function(){this.change.emit({type:"cancel"})}},{key:"save",value:function(){var e=this;this.event.has_changes?this.form.valid?this._dialog.open(F.a,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{booking:this.event}}).componentInstance.event.subscribe((function(t){"success"===t.reason&&e.change.emit({type:"view"})})):console.warn("Some form fields are invalid:",this.form):this._service.notifyInfo("No changes have been made to booking")}},{key:"handleEvent",value:function(e){}}]),n}(s.a)).\u0275fac=function(e){return new(e||U)(d.Qb(l.a),d.Qb(C.b))},U.\u0275cmp=d.Kb({type:U,selectors:[["schedule-event-edit"]],inputs:{event:"event"},outputs:{change:"change",loading:"loading"},features:[d.zb,d.Ab],decls:2,vars:1,consts:[[1,"event-edit"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"body"],[3,"form"],[1,"footer"],["mat-button","","type","button","name","cancel",1,"inverse",3,"tapped"],["mat-button","","type","submit"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Lc(1,j,8,2,"form",1),d.Vb()),2&e&&(d.Cb(1),d.vc("ngIf",t.form))},directives:[i.t,o.H,o.s,o.j,R.a,b.b,y.c],styles:[".event-edit[_ngcontent-%COMP%]{width:100%;padding:1em 2em}.footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;padding:.5em}button[_ngcontent-%COMP%]{width:8em;margin:.25em}"]}),U);function X(e,t){if(1&e&&(d.Ub(0),d.Wb(1,"div",14),d.Wb(2,"div",2),d.Rb(3,"mat-spinner",15),d.Vb(),d.Wb(4,"div",16),d.Nc(5),d.Vb(),d.Vb(),d.Tb()),2&e){var n=d.pc();d.Cb(5),d.Pc(" ",n.loading," ")}}function H(e,t){if(1&e){var n=d.Xb();d.Ub(0),d.Wb(1,"schedule-event-details",17),d.lc("change",(function(e){return d.Dc(n),d.pc().onChange(e)}))("loading",(function(e){return d.Dc(n),d.pc().loading=e})),d.Vb(),d.Tb()}if(2&e){var i=d.pc();d.Cb(1),d.vc("event",i.event)}}function Q(e,t){if(1&e){var n=d.Xb();d.Wb(0,"schedule-event-edit",17),d.lc("change",(function(e){return d.Dc(n),d.pc().onChange(e)}))("loading",(function(e){return d.Dc(n),d.pc().loading=e})),d.Vb()}if(2&e){var i=d.pc();d.vc("event",i.event)}}var G,$=function(e){return["/schedule","view",e]},K=function(){return["/schedule"]},J=((G=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var o;return _classCallCheck(this,n),(o=t.call(this))._service=e,o._router=i,o}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.subscription("arrow_right",this._service.Hotkeys.listen(["ArrowRight"],(function(){return e.nextBooking()}))),this.subscription("arrow_left",this._service.Hotkeys.listen(["ArrowLeft"],(function(){return e.previousBooking()}))),this.subscription("changes",this._service.Bookings.listen("list").subscribe((function(){return e.loadEvent()})))}},{key:"ngOnChanges",value:function(e){e.id&&this.id&&(this.event=null,this.editing=!1,this.loading="",this.loadEvent())}},{key:"loadEvent",value:function(){var e=this;this.loading="Loading booking data...";var t=this._service.Bookings.item(this.id);t?(this.event=t,this.loading=""):this._service.Bookings.show(this.id,{}).then((function(t){e.loading="",e.event=t}),(function(){e.loading="",e._service.notifyError("Failed to loaded booking data<br>ID: ".concat(e.id)),e._router.navigate(["/schedule"])}))}},{key:"nextBooking",value:function(){this.next&&!this.editing&&this._router.navigate(["/schedule","view",this.next])}},{key:"previousBooking",value:function(){this.previous&&!this.editing&&this._router.navigate(["/schedule","view",this.previous])}},{key:"onChange",value:function(e){"edit"===e.type?this.editing=!0:"view"!==e.type&&"cancel"!==e.type||(this.editing=!1)}},{key:"spaces",get:function(){return this.event?this.event.space_list||(this.event.space?[this.event.space]:[]):[]}}]),n}(s.a)).\u0275fac=function(e){return new(e||G)(d.Qb(l.a),d.Qb(r.d))},G.\u0275cmp=d.Kb({type:G,selectors:[["schedule-view-event"]],inputs:{id:"id",next:"next",previous:"previous"},features:[d.zb,d.Ab],decls:25,vars:18,consts:[[1,"event-display"],[1,"header"],[1,"icon"],[1,"details"],["mat-icon-button","",3,"routerLink"],[1,"left","icon"],[1,"material-icons"],[1,"title"],[1,"right","icon"],[1,"body"],[1,"content"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["edit_form",""],[1,"no-item","center"],["diameter","48"],[1,"text"],[3,"event","change","loading"]],template:function(e,t){if(1&e&&(d.Wb(0,"div",0),d.Wb(1,"div",1),d.Rb(2,"div",2),d.Wb(3,"div",3),d.Wb(4,"a",4),d.Wb(5,"div",5),d.Wb(6,"i",6),d.Nc(7,"keyboard_arrow_left"),d.Vb(),d.Vb(),d.Vb(),d.Wb(8,"div",7),d.Nc(9),d.Vb(),d.Wb(10,"a",4),d.Wb(11,"div",8),d.Wb(12,"i",6),d.Nc(13,"keyboard_arrow_right"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(14,"a",4),d.Wb(15,"div",2),d.Wb(16,"i",6),d.Nc(17,"close"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(18,"div",9),d.Wb(19,"div",10),d.Lc(20,X,6,1,"ng-container",11),d.Wb(21,"div"),d.Lc(22,H,2,1,"ng-container",12),d.Lc(23,Q,1,1,"ng-template",null,13,d.Mc),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&e){var n=d.Ac(24);d.Cb(4),d.Gb("disabled",!t.previous),d.vc("routerLink",d.xc(13,$,t.previous)),d.Cb(5),d.Oc(t.event?t.event.title||"No title":"????"),d.Cb(1),d.Gb("disabled",!t.next),d.vc("routerLink",d.xc(15,$,t.next)),d.Cb(4),d.vc("routerLink",d.wc(17,K)),d.Cb(6),d.vc("ngIf",t.loading),d.Cb(1),d.Gb("hide",t.loading),d.Cb(1),d.vc("ngIf",!t.editing)("ngIfElse",n)}},directives:[b.a,r.g,i.t,h.c,Y,B],styles:[".event-display[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;flex-direction:column;background-color:#ccc}.event-display[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]{display:flex;align-items:center}.header[_ngcontent-%COMP%]{position:relative;background-color:#1937ea;color:#fff;height:3em;width:100%;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);z-index:10}.details[_ngcontent-%COMP%]{flex:1;min-width:50%}.details[_ngcontent-%COMP%], .icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.icon[_ngcontent-%COMP%]{height:1.25em;width:1.25em;font-size:2em;margin:0 .5em;border-radius:100%;cursor:pointer}.icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transition:font-size .2s}.icon[_ngcontent-%COMP%]:hover{color:hsla(0,0%,100%,.6)}.icon[_ngcontent-%COMP%]:active   i[_ngcontent-%COMP%]{font-size:.75em}.title[_ngcontent-%COMP%]{font-size:1.6em;min-width:50%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center}.body[_ngcontent-%COMP%]{min-height:50%;max-height:100%;width:100%;flex:1;overflow:auto}.content[_ngcontent-%COMP%]{position:relative;max-width:768px;min-height:100%;margin:auto;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.disabled[_ngcontent-%COMP%]{color:hsla(0,0%,100%,.35)!important;pointer-events:none}.disabled[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:active   i[_ngcontent-%COMP%]{font-size:1em!important}.hide[_ngcontent-%COMP%]{display:none;pointer-events:none}[mat-icon-button][_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:1rem;height:2em;width:2em;margin:0 .5em}"]}),G),q=n("mAda"),Z=n("STbY"),ee=n("0njA"),te=n("Nuht"),ne=n("kmnG"),ie=n("d3UM"),oe=n("FKr1"),ae=n("bv9b"),re=n("V8Ex");function ce(e,t){if(1&e&&(d.Wb(0,"div",5),d.Nc(1),d.Vb()),2&e){var n=d.pc(2);d.Cb(1),d.Oc(n.event.title)}}function se(e,t){if(1&e&&(d.Wb(0,"div",6),d.Nc(1),d.Vb()),2&e){var n=d.pc(2);d.Cb(1),d.Pc(" No events for ",n.date_display," ")}}function le(e,t){1&e&&(d.Wb(0,"div",19),d.Nc(1,"In Progress"),d.Vb())}function de(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div",7),d.Wb(1,"a",8),d.lc("tapped",(function(){return d.Dc(n),d.pc(2).openDetailsModal()})),d.Wb(2,"div",9),d.Wb(3,"div",10),d.Wb(4,"div"),d.Nc(5),d.Vb(),d.Lc(6,le,2,0,"div",11),d.Vb(),d.Wb(7,"div",12),d.Rb(8,"img",13),d.Vb(),d.Wb(9,"div",14),d.Wb(10,"div",15),d.Nc(11),d.Vb(),d.Wb(12,"div",16),d.Rb(13,"img",17),d.Wb(14,"div",18),d.Nc(15),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb()}if(2&e){var i=d.pc(2);d.Cb(5),d.Oc(i.time),d.Cb(1),d.vc("ngIf",i.in_progress),d.Cb(2),d.vc("src","assets/img/"+i.type_image+".svg",d.Fc),d.Cb(3),d.Oc(i.event.title),d.Cb(4),d.Oc(i.location||i.event.location_name||"No location")}}function ue(e,t){if(1&e&&(d.Wb(0,"div"),d.Ub(1,1),d.Lc(2,ce,2,1,"div",2),d.Lc(3,se,2,1,"div",3),d.Lc(4,de,16,5,"div",4),d.Tb(),d.Vb()),2&e){var n=d.pc();d.Eb("event-item "+n.event.type+" "+n.status),d.Db("id",n.event.id),d.Cb(1),d.vc("ngSwitch",n.event.type),d.Cb(1),d.vc("ngSwitchCase","date"),d.Cb(1),d.vc("ngSwitchCase","empty")}}var ve,fe=((ve=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var o;return _classCallCheck(this,n),(o=t.call(this))._dialog=e,o._service=i,o}return _createClass(n,[{key:"openDetailsModal",value:function(){this.event instanceof g.a&&this._dialog.open(re.a,{maxHeight:"auto",maxWidth:"auto",width:"auto",height:"auto",hasBackdrop:!1,closeOnNavigation:!0,data:{booking:this.event,as_delegate:this._service.Users.current.email===(this.user||{}).email,delegate:this.user.email,is_first:!1,is_last:!1}})}},{key:"in_progress",get:function(){return"in_progress"===this.event.status}},{key:"date_display",get:function(){if(!this.event)return"Today";var e=_(this.event.date);return _().isSame(e,"d")?"Today":e.format("DD MMM YYYY")}},{key:"location",get:function(){if(!this.event||"date"===this.event.type||"empty"===this.event.type)return"No location";var e=this.event;return(e.space_list||[e.space]).map((function(e){return e.name})).join(", ")}},{key:"type_image",get:function(){return this.event&&"date"!==this.event.type&&"empty"!==this.event.type?this.event.has_visitors?"external":"book_room":"block"}},{key:"time",get:function(){if(!this.event||"date"===this.event.type||"empty"===this.event.type)return"";var e=this.event;return e.all_day||e.duration>1380?"All Day":_(e.date).format("h:mm A")}},{key:"status",get:function(){var e,t=this.event.approval_status||{},n=this.event.space_list||[],i=_createForOfIteratorHelper(n);try{for(i.s();!(e=i.n()).done;){var o=t[e.value.id]||"";if(o.indexOf("tentative")>=0||0===o.indexOf("not"))return"tentative";if(o.indexOf("declined")>=0)return"declined"}}catch(c){i.e(c)}finally{i.f()}var a=this.event.location||"",r=("string"==typeof a?a:"").toLowerCase();return r.indexOf("tentative")>=0?"tentative":r.indexOf("declined")>=0?"declined":n.length?"approved":""}}]),n}(s.a)).\u0275fac=function(e){return new(e||ve)(d.Qb(C.b),d.Qb(l.a))},ve.\u0275cmp=d.Kb({type:ve,selectors:[["schedule-event-item"]],inputs:{event:"event",user:"user"},features:[d.zb],decls:1,vars:1,consts:[[3,"class",4,"ngIf"],[3,"ngSwitch"],["class","day display",4,"ngSwitchCase"],["class","emptied display",4,"ngSwitchCase"],["class","event display",4,"ngSwitchDefault"],[1,"day","display"],[1,"emptied","display"],[1,"event","display"],[3,"tapped"],[1,"content"],[1,"time"],["class","info",4,"ngIf"],[1,"icon"],[3,"src"],[1,"details"],[1,"title","text"],[1,"location","text"],["src","assets/img/location.svg"],[1,"text"],[1,"info"]],template:function(e,t){1&e&&d.Lc(0,ue,5,6,"div",0),2&e&&d.vc("ngIf",t.event)},directives:[i.t,i.x,i.y,i.z,y.c],styles:[".event-item[_ngcontent-%COMP%]{height:5em;width:100%;max-width:100vw;background-color:#f8f8f8;border-bottom:1px solid rgba(0,0,0,.05)}.event-item.date[_ngcontent-%COMP%]{background-color:#ccc}.event-item.empty[_ngcontent-%COMP%]{background-color:#f0f0f0}.event-item.approved[_ngcontent-%COMP%]{background-color:#cff7df}.event-item.tentative[_ngcontent-%COMP%]{background-color:#fff5d0}.event-item.declined[_ngcontent-%COMP%]{background-color:#ffb0b0}.display[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;align-items:center;justify-content:center}.emptied[_ngcontent-%COMP%]{font-size:1.2em;color:rgba(0,0,0,.35)}.day[_ngcontent-%COMP%]{font-size:1.6em}a[_ngcontent-%COMP%]{height:100%;width:100%;color:rgba(0,0,0,.85);text-decoration:none}a[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.05)}.title[_ngcontent-%COMP%]{font-size:1.4em}.icon[_ngcontent-%COMP%]{height:3em;margin:0 .75em}@media only screen and (orientation:portrait) and (max-width:450px){.icon[_ngcontent-%COMP%]{margin-left:0}}@media only screen and (orientation:landscape) and (max-width:800px){.icon[_ngcontent-%COMP%]{margin-left:0}}.icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:3em}.details[_ngcontent-%COMP%]{min-width:50%;flex:1}.content[_ngcontent-%COMP%]{height:100%;max-width:768px;padding:.35em .75em;margin:auto}.content[_ngcontent-%COMP%], .location[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center}.location[_ngcontent-%COMP%]{color:rgba(0,0,0,.6);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.location[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1em;margin:0 .25em}.location[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1;min-width:50%}.time[_ngcontent-%COMP%]{width:4.5em;text-align:center;white-space:nowrap}@media only screen and (orientation:portrait) and (max-width:450px){.time[_ngcontent-%COMP%]{transform:rotate(45deg)}}@media only screen and (orientation:landscape) and (max-width:800px){.time[_ngcontent-%COMP%]{transform:rotate(45deg)}}.text[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.info[_ngcontent-%COMP%]{font-size:.7em}"]}),ve);function be(e,t){if(1&e&&(d.Wb(0,"mat-option",21),d.Nc(1),d.Vb()),2&e){var n=t.$implicit;d.vc("value",n),d.Cb(1),d.Pc(" ",null==n?null:n.name," ")}}function he(e,t){if(1&e){var n=d.Xb();d.Wb(0,"mat-form-field",17),d.Wb(1,"mat-select",18,19),d.lc("valueChange",(function(e){return d.Dc(n),d.pc().active_user=e}))("valueChange",(function(e){return d.Dc(n),d.pc().updateEvents(e)})),d.Lc(3,be,2,2,"mat-option",20),d.Vb(),d.Vb()}if(2&e){var i=d.pc();d.Cb(1),d.vc("value",i.active_user),d.Cb(2),d.vc("ngForOf",i.user_list)}}function ge(e,t){1&e&&d.Rb(0,"mat-progress-bar",22)}function pe(e,t){if(1&e&&(d.Ub(0),d.Rb(1,"schedule-event-item",23),d.Tb()),2&e){var n=t.$implicit,i=d.pc();d.Cb(1),d.vc("user",i.active_user)("event",n)}}var me,_e=function(){return{class:"material-icons",content:"event"}},Ce=((me=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var o;return _classCallCheck(this,n),(o=t.call(this))._service=e,o._route=i,o.event_list=new d.n,o.events=[],o.shown_offset=7,o.date_offset=0,o.now=_().valueOf(),o.at_top=!0,o.user_list=[],o}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.subscription("route.query",this._route.queryParamMap.subscribe((function(t){t.has("email")&&(e.active_user=e._service.Users.item(t.get("email"))||new q.a(e._service.Users,{email:t.get("email")}))}))),this.updateEvents(),this.interval("update_events",(function(){return e.updateEvents()}),1e4),this.subscription("scroll",this.scroll_viewport.elementScrolled().subscribe((function(){return e.onScroll()}))),this.subscription("delegate_list",this._service.Users.listen("delegates").subscribe((function(t){t&&t[0]&&(e.user_list=[e._service.Users.current].concat(t),e.active_user||(e.active_user=e.user_list[0]))})))}},{key:"updateEvents",value:function(){var e=this;return this.event_promise||(this.event_promise=new Promise((function(t){var n=_().add(e.date_offset,"d").startOf("d"),i=n.add(7,"d").endOf("d");e.loading=!0,e._service.Bookings.query({email:(e.active_user?e.active_user.email:"")||e._service.Users.current.email,from:n.unix(),to:i.unix()}).then((function(t){e._service.Bookings.updateList(e._service.Bookings.list(),t);var o=e.events.filter((function(e){var t=_(e.date);return"date"!==e.type&&"empty"!==e.type&&(t.isBefore(n,"s")||t.isAfter(i,"s"))}));e.events=e.processEvents(t,o);var a=e.events.filter((function(e){return"date"!==e.type&&"empty"!==e.type}));e.event_list.emit(a.map((function(e){return{id:e.id,date:e.date}}))),e.timeout("scroll_to",(function(){return e.scrollTo()})),e.loading=!1,delete e.event_promise}),(function(){e.loading=!1,delete e.event_promise}))}))),this.event_promise}},{key:"processEvents",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],i=_(),o=_().startOf("d"),a=o.add(this.shown_offset,"d").endOf("d");o.isBefore(a);o=o.add(1,"d")){var r=o.format("YYYY-MM-DD");n.push({id:r,type:"date",order_id:r,title:o.format("dddd, DD MMM"),is_today:o.isSame(i,"d"),date:o.valueOf()});var c=function(e){var t=_(e.date);return t.isAfter(o,"s")&&t.isBefore(o.endOf("d"),"s")},s=e.filter(c),l=t.filter(c);s.length||l.length?n=n.concat(s).concat(l):n.push({id:"".concat(r,"-empty"),type:"empty",order_id:r,title:"No items for ".concat(o.format("dddd, DD MMM")),is_today:o.isSame(i,"d"),date:o.valueOf()+1})}return n.sort((function(e,t){return e.date-t.date})),n=Object(p.l)(n,"id")}},{key:"onScroll",value:function(){if(!this.event_promise){this.show_calendar=!1;var e=this.scroll_viewport.getRenderedRange(),t=e.end-e.start,n=this.events[e.start];this.at_top=0===e.start&&this.scroll_viewport.measureScrollOffset()<5,this.date_offset=_(n.date).diff(_(),"d")-1,this.date=_((this.events[t+e.start]||{}).date).subtract(1,"d").valueOf(),e.end>this.events.length-7&&(this.shown_offset+=3,this.updateEvents())}}},{key:"updateDate",value:function(e){var t=_(e);this.date_offset=t.diff(_(),"d")-1,this.shown_offset=Math.max(this.shown_offset,this.date_offset+3),this.scroll_to=t.format("YYYY-MM-DD"),delete this.event_promise,this.show_calendar=!1,this.date=_().add(this.date_offset,"d").valueOf(),this.updateEvents()}},{key:"closeDatePicker",value:function(){this.trigger.closeMenu()}},{key:"scrollTo",value:function(){var e=this;if(this.scroll_to){var t=this.events.findIndex((function(t){return t.id===e.scroll_to}));t>-1&&(this.scroll_viewport.scrollToIndex(t,"smooth"),this.scroll_to=null)}}}]),n}(s.a)).\u0275fac=function(e){return new(e||me)(d.Qb(l.a),d.Qb(r.a))},me.\u0275cmp=d.Kb({type:me,selectors:[["schedule-event-list"]],viewQuery:function(e,t){var n;1&e&&(d.Jc(a.d,!0),d.Jc(Z.d,!0)),2&e&&(d.zc(n=d.mc())&&(t.scroll_viewport=n.first),d.zc(n=d.mc())&&(t.trigger=n.first))},outputs:{event_list:"eventList"},features:[d.zb],decls:18,vars:9,consts:[[1,"event-list"],[1,"header","dark-mode"],[1,"user"],["appearance","outline",4,"ngIf"],[1,"flex"],[1,"date"],["mat-icon-button","",3,"matMenuTriggerFor"],[3,"icon"],[1,"progress"],["mode","indeterminate",4,"ngIf"],[1,"body"],["itemSize","80",1,"viewport",3,"scroll"],[4,"cdkVirtualFor","cdkVirtualForOf"],[1,"footer"],["appMenu","matMenu"],["mat-menu-item","",1,"date-picker",3,"click"],[3,"ngModel","ngModelChange"],["appearance","outline"],[3,"value","valueChange"],["select",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mode","indeterminate"],[3,"user","event"]],template:function(e,t){if(1&e&&(d.Wb(0,"div",0),d.Wb(1,"div",1),d.Wb(2,"div",2),d.Lc(3,he,4,2,"mat-form-field",3),d.Vb(),d.Rb(4,"div",4),d.Wb(5,"div",5),d.Wb(6,"button",6),d.Rb(7,"app-icon",7),d.Vb(),d.Vb(),d.Vb(),d.Wb(8,"div",8),d.Lc(9,ge,1,0,"mat-progress-bar",9),d.Vb(),d.Wb(10,"div",10),d.Wb(11,"cdk-virtual-scroll-viewport",11),d.lc("scroll",(function(){return t.onScroll()})),d.Lc(12,pe,2,2,"ng-container",12),d.Vb(),d.Vb(),d.Rb(13,"div",13),d.Vb(),d.Wb(14,"mat-menu",null,14),d.Wb(16,"div",15),d.lc("click",(function(e){return e.stopPropagation()})),d.Wb(17,"a-date-picker",16),d.lc("ngModelChange",(function(e){return t.date=e}))("ngModelChange",(function(e){return t.updateDate(e),t.closeDatePicker()})),d.Vb(),d.Vb(),d.Vb()),2&e){var n=d.Ac(15);d.Cb(1),d.Gb("scrolled",!t.at_top),d.Cb(2),d.vc("ngIf",t.user_list&&t.user_list.length>1),d.Cb(3),d.vc("matMenuTriggerFor",n),d.Cb(1),d.vc("icon",d.wc(8,_e)),d.Cb(2),d.vc("ngIf",t.loading),d.Cb(3),d.vc("cdkVirtualForOf",t.events),d.Cb(5),d.vc("ngModel",t.date)}},directives:[i.t,b.b,Z.d,ee.a,a.d,a.a,a.c,Z.e,Z.b,te.a,o.r,o.u,ne.b,ie.a,i.s,oe.g,ae.a,fe],styles:[".event-list[_ngcontent-%COMP%]{top:0;left:0;right:0;overflow:hidden;display:flex;align-items:center;flex-direction:column}.event-list[_ngcontent-%COMP%], .progress[_ngcontent-%COMP%]{position:absolute;bottom:0}.progress[_ngcontent-%COMP%]{width:100%;z-index:999}.header[_ngcontent-%COMP%]{display:flex;align-items:center;background:linear-gradient(90deg,#051c2c,#051c2c 40%,#0b2453 60%,#1f40e6);color:#fff;height:3.5em;width:100%;z-index:10;transition:box-shadow .2s}.header.scrolled[_ngcontent-%COMP%]{box-shadow:0 1px 3px 2px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.header[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]{height:100%;padding:0 .5em}.date[_ngcontent-%COMP%]{position:relative;margin:.5em}.date[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:1.25rem;height:2em;width:2em}.flex[_ngcontent-%COMP%]{flex:1;min-width:1px}.body[_ngcontent-%COMP%]{min-height:50%;max-height:100%;width:100%;flex:1;background-color:#e6e6e6;overflow:auto}.viewport[_ngcontent-%COMP%]{height:100%;width:100%;overflow:hidden auto}.load-state[_ngcontent-%COMP%]{position:absolute;left:50%;bottom:1em;transform:translateX(-50%);font-size:.75em}.date-picker[_ngcontent-%COMP%]{height:26.5em}.date-picker[_ngcontent-%COMP%]:hover{background:none}"]}),me);function ye(e,t){if(1&e&&(d.Ub(0),d.Rb(1,"schedule-view-event",9),d.Tb()),2&e){var n=d.pc();d.Cb(1),d.vc("id",n.id)("next",n.next)("previous",n.previous)}}function we(e,t){if(1&e){var n=d.Xb();d.Ub(0),d.Wb(1,"schedule-event-list",10),d.lc("eventList",(function(e){return d.Dc(n),d.pc().updateEvents(e)})),d.Vb(),d.Tb()}}var Oe,Me=((Oe=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var o;return _classCallCheck(this,n),(o=t.call(this))._route=e,o._service=i,o.show_menu=!1,o}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.subscription("route.route",this._route.paramMap.subscribe((function(t){t.has("page")&&(e.page=t.get("page")),t.has("id")&&(e.id=t.get("id"))}))),this.loadEvents(),this._service.title="My Day"}},{key:"updateEvents",value:function(e){this.events=e,this.saveEvents()}},{key:"saveEvents",value:function(){localStorage&&localStorage.setItem("STAFF.events",JSON.stringify(this.events||[]))}},{key:"loadEvents",value:function(){if(localStorage){var e=localStorage.getItem("STAFF.events");this.events=JSON.parse(e||"[]")}}},{key:"next",get:function(){var e=this;if(this.events){var t=this.events.findIndex((function(t){return e.id===t.id}))+1;if(t>-1&&this.events[t])return this.events[t].id}return""}},{key:"previous",get:function(){var e=this;if(this.events){var t=this.events.findIndex((function(t){return e.id===t.id}))-1;if(t>-1&&this.events[t])return this.events[t].id}return""}}]),n}(s.a)).\u0275fac=function(e){return new(e||Oe)(d.Qb(r.a),d.Qb(l.a))},Oe.\u0275cmp=d.Kb({type:Oe,selectors:[["app-schedule"]],features:[d.zb],decls:10,vars:4,consts:[[1,"schedule","page"],[1,"header"],[3,"menu","menuChange"],[1,"body"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"footer"],[3,"show","showChange"],[3,"id","next","previous"],[3,"eventList"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"header",1),d.Wb(2,"a-topbar-header",2),d.lc("menuChange",(function(e){return t.show_menu=e})),d.Vb(),d.Vb(),d.Wb(3,"main",3),d.Ub(4,4),d.Lc(5,ye,2,3,"ng-container",5),d.Lc(6,we,2,0,"ng-container",6),d.Tb(),d.Vb(),d.Wb(7,"footer",7),d.Rb(8,"a-footer-menu"),d.Vb(),d.Vb(),d.Wb(9,"a-overlay-menu",8),d.lc("showChange",(function(e){return t.show_menu=e})),d.Vb()),2&e&&(d.Cb(2),d.vc("menu",t.show_menu),d.Cb(2),d.vc("ngSwitch",t.page),d.Cb(1),d.vc("ngSwitchCase","view"),d.Cb(4),d.vc("show",t.show_menu))},directives:[u.a,i.x,i.y,i.z,v.a,f.a,J,Ce],styles:[".page[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;flex-direction:column}.page[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.body[_ngcontent-%COMP%]{position:relative;min-width:50%;flex:1}"]}),Oe),xe=[{path:"",component:Me},{path:":page",component:Me},{path:":page/:id",component:Me},{path:"**",redirectTo:""}],ke=n("PCNd");n.d(t,"ScheduleModule",(function(){return We}));var Pe,We=((Pe=function e(){_classCallCheck(this,e)}).\u0275mod=d.Ob({type:Pe}),Pe.\u0275inj=d.Nb({factory:function(e){return new(e||Pe)},imports:[[i.c,o.l,c.b,o.l,o.B,r.h.forChild(xe),ke.a,a.f]]}),Pe)}}]);