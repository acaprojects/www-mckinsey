function _templateObject50(){var e=_taggedTemplateLiteral([":Select desk description\u241f8262190b8373d8939609ad2b1f7b452777152de7\u241f121158745294466959: Choose a desk on the map. "]);return _templateObject50=function(){return e},e}function _templateObject49(){var e=_taggedTemplateLiteral([":Reserve desk description\u241f765c353930cb1b8fdd2493639c68e467b9c6d82d\u241f7556704774845594175: Reserve this desk for use from: "]);return _templateObject49=function(){return e},e}function _templateObject48(){var e=_taggedTemplateLiteral([":Desk checkout description\u241fed326ff843f67937c1d04c582a52fa7bb67ff945\u241f7079828377705672895: Checking out makes the desk available for others "]);return _templateObject48=function(){return e},e}function _templateObject47(){var e=_taggedTemplateLiteral([":Desk checkout\u241ff72126dcb376d87a60b0bdc49340712b91452ac9\u241f5393506726404439645: Check-Out "]);return _templateObject47=function(){return e},e}function _templateObject46(){var e=_taggedTemplateLiteral([":Desk check in description\u241f5898dd87be2a12fc0d908be4efce0227e3283dc0\u241f6699028280403914993: Checking in will reserve this desk under your name for the rest of the day. "]);return _templateObject46=function(){return e},e}function _templateObject45(){var e=_taggedTemplateLiteral([":Desk check in\u241f8c41f97fbceb9b04d8ab986819decab585f02a32\u241f5207140864145722677: Check-In "]);return _templateObject45=function(){return e},e}function _templateObject44(){var e=_taggedTemplateLiteral([":Select another desk\u241f5ca89aea2cadf208387d22a6722fa691328e4639\u241f8438296162356008540: Please select a different desk from the map "]);return _templateObject44=function(){return e},e}function _templateObject43(){var e=_taggedTemplateLiteral([":Booking form continue action\u241ff732c304c7433e5a83ffcd862c3dce709a0f4982\u241f3885497195825665706:Next"]);return _templateObject43=function(){return e},e}function _templateObject42(){var e=_taggedTemplateLiteral([":Booking form cancel action\u241fcda31dbd724cf5f4fa7a4274d9120651490c8a8c\u241f8890553633144307762:Back"]);return _templateObject42=function(){return e},e}function _templateObject41(){var e=_taggedTemplateLiteral([":Booking form header\u241fbd532c9813cc0577fcc3ff32640a61afef2bf40a\u241f6464057252608386690:New Booking"]);return _templateObject41=function(){return e},e}function _templateObject40(){var e=_taggedTemplateLiteral([":Catering order loading label\u241fbfda21d2176fb36e23aa0481fe88e423db437c00\u241f3030815663356248509:Loading menu for ",":INTERPOLATION:..."]);return _templateObject40=function(){return e},e}function _templateObject39(){var e=_taggedTemplateLiteral([":Catering order unavailable\u241f448721d1af607594c77bfa7c99edf1405aaac332\u241f6239341027793385302: Catering is ",":START_TAG_SPAN:not available",":CLOSE_TAG_SPAN: for this booking.",":LINE_BREAK: Catering must be ordered within business hours ",":START_TAG_SPAN_1: at least ",":INTERPOLATION: hours in advance for meetings ",":CLOSE_TAG_SPAN: at ",":INTERPOLATION_1:. "]);return _templateObject39=function(){return e},e}function _templateObject38(){var e=_taggedTemplateLiteral([":Catering order delivery time label\u241fef36f0dc0067decf548cc11905ef3100f5bbd004\u241f7479716926471212179:At:"]);return _templateObject38=function(){return e},e}function _templateObject37(){var e=_taggedTemplateLiteral([":Catering order location label\u241fc2931e3c6024d3f3125d9eae5ea680549dfef481\u241f5372192538848052965:Deliver to:"]);return _templateObject37=function(){return e},e}function _templateObject36(){var e=_taggedTemplateLiteral([":Catering order confirm action\u241f65b17a3b00a67be5d8022c4c834ee46cfbf7e8c1\u241f4100878296986971969: Confirm Order(",":INTERPOLATION:) "]);return _templateObject36=function(){return e},e}function _templateObject35(){var e=_taggedTemplateLiteral([":Catering order cancel action\u241fcda31dbd724cf5f4fa7a4274d9120651490c8a8c\u241f8890553633144307762:Back"]);return _templateObject35=function(){return e},e}function _templateObject34(){var e=_taggedTemplateLiteral([":Catering category empty label\u241f413312f415b4e0acfd6be72da7d811ea1e3a60de\u241f8482974523885197860:Category contains no available items"]);return _templateObject34=function(){return e},e}function _templateObject33(){var e=_taggedTemplateLiteral([":Catering confirm save action\u241fe787287c2a4bf3ec6b3208d05d1c3d5f21688ced\u241f7260697646773693724:Save Order"]);return _templateObject33=function(){return e},e}function _templateObject32(){var e=_taggedTemplateLiteral([":Catering confirm order header\u241f6340fbfb7791b769818d351dcad5944eea4af597\u241f1890120752020168546:Confirm Catering Order"]);return _templateObject32=function(){return e},e}function _templateObject31(){var e=_taggedTemplateLiteral([":Catering order item options change action\u241f7519e367547b18c1a111e6fe13cd5b318a6d1cf5\u241f204010548841636282: Customise "]);return _templateObject31=function(){return e},e}function _templateObject30(){var e=_taggedTemplateLiteral([":Catering order item selected options label\u241fef028ca4d759738e1437e4c8c753a05a09d0bf5a\u241f9119132180854167033: Selected "]);return _templateObject30=function(){return e},e}function _templateObject29(){var e=_taggedTemplateLiteral([":Catering order item available options label\u241f8d2393e9c6ca1b836a6850f9fdb5f171e496ea1b\u241f7552499218458333923: ",":ICU: "]);return _templateObject29=function(){return e},e}function _templateObject28(){var e=_taggedTemplateLiteral([":\u241f326d978c4b2de6f42edfe0ac588e188b6fc40471\u241f3278355766885608724:{VAR_PLURAL, plural, =1 {Contains {INTERPOLATION} item } other {Contains {INTERPOLATION} items }}"]);return _templateObject28=function(){return e},e}function _templateObject27(){var e=_taggedTemplateLiteral([":Catering package options save action\u241fefd2d9627cb8a4759431044f8adbef29895bc3c6\u241f7017188217946174407: Confirm Options "]);return _templateObject27=function(){return e},e}function _templateObject26(){var e=_taggedTemplateLiteral([":Catering package options header\u241f15bd44965d742d8d8427ae3b909d26a812cc552f\u241f8442475149770947712:Package Options"]);return _templateObject26=function(){return e},e}function _templateObject25(){var e=_taggedTemplateLiteral([":Catering order list add action\u241f4bcabe959483f6b5cfb07513161e79223ee32d52\u241f2633188293896971176: Add Order "]);return _templateObject25=function(){return e},e}function _templateObject24(){var e=_taggedTemplateLiteral([":Catering order list empty label\u241fc6e5750edd2f95032c6113e88975d7be3b55b6c7\u241f4052001556626773369:No catering orders"]);return _templateObject24=function(){return e},e}function _templateObject23(){var e=_taggedTemplateLiteral([":Catering order list add action\u241f307c09c102f6ec213cf0e452b7302b85fd27b155\u241f4992565535187194144: Add Order "]);return _templateObject23=function(){return e},e}function _templateObject22(){var e=_taggedTemplateLiteral([":Catering order list continue action\u241f75db05d5e0bebee12a6a7b0e31ea09754d18d8fb\u241f7200802776192640190: Next "]);return _templateObject22=function(){return e},e}function _templateObject21(){var e=_taggedTemplateLiteral([":Catering order list cancel action\u241f9dc973b1a2fa6ac0ac5a539eeb8a44c2f7ab8138\u241f6168722822529020983: Back "]);return _templateObject21=function(){return e},e}function _templateObject20(){var e=_taggedTemplateLiteral([":Catering order list header\u241f198d88d73d77e70a466db43ea2283f95a26f022b\u241f7084836568225090871:Catering Orders"]);return _templateObject20=function(){return e},e}function _templateObject19(){var e=_taggedTemplateLiteral([":Items\u241f02072719ffd1bb48ba4003201565037d2695a251\u241f8762707649498451477:{VAR_PLURAL, plural, =1 {item } other {items }}"]);return _templateObject19=function(){return e},e}function _templateObject18(){var e=_taggedTemplateLiteral([":Catering order item delivery details\u241f860413d275ab6e50489dae7e770f40364267d1be\u241f2502060370458020279: Deliver to ",":START_TAG_SPAN:",":INTERPOLATION:",":CLOSE_TAG_SPAN: at ",":START_TAG_SPAN:",":INTERPOLATION_1:",":CLOSE_TAG_SPAN:"]);return _templateObject18=function(){return e},e}function _templateObject17(){var e=_taggedTemplateLiteral([":Booking spaces empty label\u241f43777c73f6bf125d154fca4427a6e1ea0d3cb778\u241f3717593149132753615:No spaces available for the selected time"]);return _templateObject17=function(){return e},e}function _templateObject16(){var e=_taggedTemplateLiteral([":Booking spaces loading label\u241fe4560a146a9929dd23ee2c39d318816ced7e48f0\u241f3487485599479520443:Checking space availability..."]);return _templateObject16=function(){return e},e}function _templateObject15(){var e=_taggedTemplateLiteral([":Booking spaces continue action\u241f39494c73fcb8affcef6b03a8c7e52f8c789b2d1d\u241f6609643060537118464: Next "]);return _templateObject15=function(){return e},e}function _templateObject14(){var e=_taggedTemplateLiteral([":Booking spaces cancel action\u241fcda31dbd724cf5f4fa7a4274d9120651490c8a8c\u241f8890553633144307762:Back"]);return _templateObject14=function(){return e},e}function _templateObject13(){var e=_taggedTemplateLiteral([":Booking space availability label\u241f2a1fc73ce353aecee76c8fe49d4f9884dd1ffc78\u241f8859996495474290193: Available for\xa0",":START_TAG_SPAN:",":INTERPOLATION:",":CLOSE_TAG_SPAN:\xa0meeting ocurrences "]);return _templateObject13=function(){return e},e}function _templateObject12(){var e=_taggedTemplateLiteral([":Booking space locate action\u241ff130d84389fb831e5eb6580c7562dffc2d52a8ea\u241f4746077833803509960: Map "]);return _templateObject12=function(){return e},e}function _templateObject11(){var e=_taggedTemplateLiteral([":Space recurrence save action\u241fdac15c8d36c2c7ab047c86ba8aaf8807ad675087\u241f7340520212541034776: Add to Booking "]);return _templateObject11=function(){return e},e}function _templateObject10(){var e=_taggedTemplateLiteral([":Space recurrence information\u241f5adceef379acff2f5b02b532d6246dc4b5d58063\u241f2284203384413164791: * Select individual dates to update selected space "]);return _templateObject10=function(){return e},e}function _templateObject9(){var e=_taggedTemplateLiteral([":Space recurrence header\u241f0d8f27b9a841ca2917819f2ff73ada4f8ab59d79\u241f8622659837326450623:Recurrence - ",":INTERPOLATION:"]);return _templateObject9=function(){return e},e}function _templateObject8(){var e=_taggedTemplateLiteral([":Booking space filters locations label\u241fb7052a01675881e6c47a045f17e24883c8a0708b\u241f9185812574124356046:Select locations(s)"]);return _templateObject8=function(){return e},e}function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i,r=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return r=e.done,e},e:function(e){o=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(o)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _templateObject7(){var e=_taggedTemplateLiteral([":Catering details charge code label\u241f0623cad0eeefa482e8dadfe201c0f0ddff07f405\u241f4381230312262498447: Charge Code",":START_TAG_SPAN:*",":CLOSE_TAG_SPAN:"]);return _templateObject7=function(){return e},e}function _templateObject6(){var e=_taggedTemplateLiteral([":Catering details charge code hint\u241f309202b2ded3e8d0aa94923fa187763d6ba21830\u241f1078849591937392404:",":START_TAG_SPAN:Note:",":CLOSE_TAG_SPAN: Your booking will be confirmed before you are charged. "]);return _templateObject6=function(){return e},e}function _templateObject5(){var e=_taggedTemplateLiteral([":Catering details charge code error\u241f4b1851c001235398631979c2ebff230f501e3fb9\u241f6433134519537727373: Charge Code is required "]);return _templateObject5=function(){return e},e}function _templateObject4(){var e=_taggedTemplateLiteral([":\u241f95984e0af2c6fdc0c7a9e4ad9b413fd969a5324a\u241f4704310930093496744:Charge Code"]);return _templateObject4=function(){return e},e}function _templateObject3(){var e=_taggedTemplateLiteral([":\u241ff7bdd304a99c014dc0fff3af941e6a9d968371db\u241f4048193419886450033:Add notes here..."]);return _templateObject3=function(){return e},e}function _templateObject2(){var e=_taggedTemplateLiteral([":Catering details equipment notes label\u241f9560d941e07bf55dfdf44d454055e8dddffb2f91\u241f5669621286420940838: (eg - allergies, in tolerances, no ice in drinks etc) Additional requests are handled in confidence. "]);return _templateObject2=function(){return e},e}function _templateObject(){var e=_taggedTemplateLiteral([":Catering details save action\u241f6679108dd552b13e53a38ea4c5e5e6f8e6fadab7\u241f2732940016977811303: Add to booking "]);return _templateObject=function(){return e},e}function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){return function(){var t,n=_getPrototypeOf(e);if(_isNativeReflectConstruct()){var a=_getPrototypeOf(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{cmhh:function(e,t,n){"use strict";n.r(t);var a=n("ofXK"),i=n("tyNb"),r=n("3Pt+"),o=n("Cvi9"),c=n("OaWH"),s=n("IWZj"),l=n("fXoL");function u(e,t){1&e&&l.Rb(0,"booking-desk-flow")}function d(e,t){1&e&&l.Rb(0,"booking-space-flow")}var f,m,b,p=((f=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,i){var r;return _classCallCheck(this,n),(r=t.call(this))._service=e,r._route=a,r._router=i,r}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this._service.title="Book",this.subscription("route.params",this._route.paramMap.subscribe((function(t){t.has("flow")&&(e.flow=t.get("flow"))}))),this.subscription("router.events",this._router.events.subscribe((function(e){e instanceof i.c&&e.url.indexOf("book")<0&&localStorage.removeItem("ACA_STAFF.booking_form_data")})))}}]),n}(s.a)).\u0275fac=function(e){return new(e||f)(l.Qb(c.a),l.Qb(i.a),l.Qb(i.d))},f.\u0275cmp=l.Kb({type:f,selectors:[["app-bookings"]],features:[l.zb],decls:10,vars:4,consts:[[1,"booking","page"],[1,"header"],[3,"menu","menuChange"],[1,"body"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"footer"],[3,"show","showChange"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.Wb(1,"header",1),l.Wb(2,"a-topbar-header",2),l.lc("menuChange",(function(e){return t.show_menu=e})),l.Vb(),l.Vb(),l.Wb(3,"main",3),l.Ub(4,4),l.Lc(5,u,1,0,"booking-desk-flow",5),l.Lc(6,d,1,0,"booking-space-flow",6),l.Tb(),l.Vb(),l.Wb(7,"footer",7),l.Rb(8,"a-footer-menu"),l.Vb(),l.Vb(),l.Wb(9,"a-overlay-menu",8),l.lc("showChange",(function(e){return t.show_menu=e})),l.Vb()),2&e&&(l.Cb(2),l.vc("menu",t.show_menu),l.Cb(2),l.vc("ngSwitch",t.flow),l.Cb(1),l.vc("ngSwitchCase","desks"),l.Cb(4),l.vc("show",t.show_menu))},styles:[".page[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;flex-direction:column}.page[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.body[_ngcontent-%COMP%]{min-width:50%;min-height:50%;flex:1}"]}),f),h=n("PCNd"),g=n("xhdr"),v=n("5RMF"),_=n("Ofvs"),y=n("SxV6"),O=n("g0I+"),C=n("0IaG"),k=n("7c/B"),w=n("Wgwc"),P=n("wZkO"),M=n("bTqV"),x=n("0njA"),j=n("m6yr"),V=n("kmnG"),W=n("qFsG");function z(e,t){if(1&e&&l.Rb(0,"mat-tab",11),2&e){var n=t.$implicit,a=l.pc();l.vc("label",n.name+(a.form[n.id].invalid&&a.form[n.id].touched?"*":""))}}m=$localize(_templateObject()),b=$localize(_templateObject2());var I,L,T,S=["placeholder",$localize(_templateObject3())],D=["placeholder",$localize(_templateObject4())];function A(e,t){1&e&&(l.gc(0,T,1),l.Rb(1,"span"),l.dc())}function N(e,t){if(1&e&&(l.Wb(0,"form",12),l.Wb(1,"div",13),l.Wb(2,"label",14),l.ac(3,b),l.Vb(),l.Wb(4,"mat-form-field",15),l.Wb(5,"textarea",16),l.cc(6,S),l.Vb(),l.Vb(),l.Vb(),l.Wb(7,"div",13),l.Wb(8,"label",17),l.gc(9,T),l.Lc(10,A,2,0,"span",18),l.dc(),l.Vb(),l.Wb(11,"mat-form-field",15),l.Wb(12,"input",19),l.cc(13,D),l.Vb(),l.Wb(14,"mat-error"),l.ac(15,I),l.Vb(),l.Wb(16,"mat-hint"),l.gc(17,L),l.Rb(18,"span"),l.dc(),l.Vb(),l.Vb(),l.Vb(),l.Vb()),2&e){var n=l.pc();l.vc("formGroup",n.active_form),l.Cb(8),l.Gb("error",n.active_form.controls.code.touched&&n.active_form.controls.code.invalid),l.Cb(2),l.vc("ngIf",n.needs_charge_code[n.space_list[n.active_space].id])}}I=$localize(_templateObject5()),L=$localize(_templateObject6(),"\ufffd#18\ufffd","\ufffd/#18\ufffd"),T=$localize(_templateObject7(),"\ufffd*10:1\ufffd\ufffd#1:1\ufffd","\ufffd/#1:1\ufffd\ufffd/*10:1\ufffd");var $,F,E=function(){return{class:"material-icons",content:"close"}},R=(($=function(){function e(t,n){_classCallCheck(this,e),this._service=t,this._data=n,this.event=new l.n,this.notes={},this.codes={},this.head_counts={},this.form={},this.needs_charge_code={},this.active_space=0}return _createClass(e,[{key:"ngOnInit",value:function(){var e=(this._data.notes_field.value||[]).filter((function(e){return"catering"===e.type}));this.notes=e.reduce((function(e,t){return e[t.space]=t.message,e}),{}),this.codes=(this._data.catering.value||[]).reduce((function(e,t){return e[t.location_id]=t.charge_code,e}),{}),this.generateFormFields()}},{key:"submit",value:function(){var e=this;if(this.space_list.forEach((function(t){return e.form[t.id].markAllAsTouched()})),this.is_valid){var t=(this._data.notes_field.value||[]).filter((function(e){return"catering"!==e.type})),n=this.space_list.map((function(t){return{author:e._service.Users.current.name,type:"catering",message:e.form[t.id].controls.notes.value,space:t.id,date:w().valueOf()}}));this._data.notes_field.setValue(t.concat(n).filter((function(e){return e.message})));var a=(this._data.catering.value||[]).map((function(t){return new k.a(Object.assign(Object.assign({},t),{charge_code:e.form[t.location_id].controls.code.value}))}));this._data.catering.setValue(a),this.event.emit({reason:"done"})}}},{key:"generateFormFields",value:function(){var e,t=this,n=_createForOfIteratorHelper(this.space_list);try{var a=function(){var n=e.value,a=t._service.Organisation.buildings.find((function(e){return e.id===n.level.building_id}));t.needs_charge_code[n.id]=a.required.equipment_code,t.form[n.id]=new r.i({notes:new r.f(t.notes[n.id]||""),code:new r.f(t.codes[n.id]||"",a.required.equipment_code?[r.F.required]:[])})};for(n.s();!(e=n.n()).done;)a()}catch(i){n.e(i)}finally{n.f()}}},{key:"space_list",get:function(){return this._data.spaces||[]}},{key:"active_form",get:function(){return this.form[this.space_list[this.active_space].id]}},{key:"is_valid",get:function(){var e=this;return this.space_list.reduce((function(t,n){return t&&e.form[n.id].valid}),!0)}}]),e}()).\u0275fac=function(e){return new(e||$)(l.Qb(c.a),l.Qb(C.a))},$.\u0275cmp=l.Kb({type:$,selectors:[["a-catering-details-modal"]],outputs:{event:"event"},decls:17,vars:5,consts:[[1,"header"],[1,"tabs"],[3,"selectedIndex","selectedIndexChange"],[3,"label",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"details"],["src","assets/img/food-notes.svg"],[1,"text"],[3,"formGroup",4,"ngIf"],["mat-button","",3,"tapped"],[3,"label"],[3,"formGroup"],[1,"field"],["for","equipment-notes"],["appearance","outline"],["matInput","","name","equipment-notes","formControlName","notes",6,"placeholder"],["for","charge-code"],[4,"ngIf"],["matInput","","name","charge-code","formControlName","code",6,"placeholder"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.Wb(1,"div",1),l.Wb(2,"mat-tab-group",2),l.lc("selectedIndexChange",(function(e){return t.active_space=e})),l.Lc(3,z,1,1,"mat-tab",3),l.Vb(),l.Vb(),l.Wb(4,"button",4),l.Rb(5,"app-icon",5),l.Vb(),l.Vb(),l.Wb(6,"mat-dialog-content"),l.Wb(7,"main"),l.Wb(8,"div",6),l.Rb(9,"img",7),l.Wb(10,"div",8),l.Nc(11,"Please specify any allergies or gluten intolerances"),l.Vb(),l.Vb(),l.Lc(12,N,19,4,"form",9),l.Vb(),l.Vb(),l.Wb(13,"mat-dialog-actions"),l.Wb(14,"footer"),l.Wb(15,"button",10),l.lc("tapped",(function(){return t.submit()})),l.ac(16,m),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Cb(2),l.vc("selectedIndex",t.active_space),l.Cb(1),l.vc("ngForOf",t.space_list),l.Cb(2),l.vc("icon",l.wc(4,E)),l.Cb(7),l.vc("ngIf",t.space_list[t.active_space]&&t.active_form))},directives:[P.c,a.s,M.b,C.d,x.a,C.f,a.t,C.c,j.c,P.a,r.H,r.s,r.j,V.b,W.a,r.c,r.r,r.h,V.a,V.e],styles:[".header[_ngcontent-%COMP%]{display:flex;align-items:center;border-bottom:1px solid #ccc;width:100%}.header[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{min-width:50%;flex:1}.details[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;text-align:center;margin-bottom:1em}main[_ngcontent-%COMP%]{padding:1em 1em 0}mat-hint[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#1937ea}label[_ngcontent-%COMP%]{min-width:100%;margin-right:1em;font-weight:700;font-size:.8em;width:100%;margin-top:0;margin-bottom:.5em}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ffb300}label.error[_ngcontent-%COMP%]{color:#e53935}mat-form-field[_ngcontent-%COMP%]{flex:1}mat-tab[_ngcontent-%COMP%]{display:none!important}.field[_ngcontent-%COMP%]{display:flex;min-width:14em;flex:1;flex-wrap:wrap}textarea[_ngcontent-%COMP%]{min-height:7em}.fieldset[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0 .25em}@media only screen and (orientation:portrait) and (max-width:450px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0}}@media only screen and (orientation:landscape) and (max-width:800px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0}}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:first-child{margin-left:0}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:last-child{margin-right:0}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),$),q=n("Kj3r"),B=n("/uUt"),G=n("eIep"),Q=n("JIr8"),U=n("lJxs"),Y=n("XNiG"),X=n("LRne"),H=n("YxBP"),K=n("CbDI"),Z=n("bSwM"),J=n("A5z7");function ee(e,t){if(1&e){var n=l.Xb();l.Wb(0,"div",14),l.Wb(1,"mat-checkbox",15),l.lc("change",(function(e){l.Dc(n);var a=t.$implicit,i=l.pc(2);return e.checked?i.addLocationFilter(a):i.removeLocationFilter(a)})),l.Wb(2,"div",16),l.Wb(3,"div",17),l.Nc(4),l.Vb(),l.Wb(5,"div",18),l.Nc(6),l.Vb(),l.Wb(7,"div",19),l.Nc(8),l.Vb(),l.Vb(),l.Vb(),l.Vb()}if(2&e){var a=t.$implicit;l.Cb(4),l.Oc(a.code),l.Cb(2),l.Oc(a.name),l.Cb(2),l.Oc(a.address)}}F=$localize(_templateObject8());var te=function(){return{type:"icon",class:"material-icons",content:"close"}};function ne(e,t){if(1&e){var n=l.Xb();l.Wb(0,"mat-chip",23),l.lc("removed",(function(){l.Dc(n);var e=t.$implicit;return l.pc(3).removeLocationFilter(e)})),l.Nc(1),l.Rb(2,"app-icon",24),l.Vb()}if(2&e){var a=t.$implicit;l.vc("id",a.id)("removable",!0),l.Cb(1),l.Pc(" ",a.name," "),l.Cb(1),l.vc("icon",l.wc(4,te))}}function ae(e,t){if(1&e&&(l.Wb(0,"div",20),l.Wb(1,"mat-chip-list",21),l.Lc(2,ne,3,5,"mat-chip",22),l.Vb(),l.Vb()),2&e){var n=l.pc(2);l.Cb(2),l.vc("ngForOf",n.location_list)}}var ie=function(){return{class:"material-icons",content:"keyboard_arrow_left"}},re=function(){return{class:"material-icons",content:"keyboard_arrow_right"}},oe=function(e){return{class:"material-icons",content:e}};function ce(e,t){if(1&e){var n=l.Xb();l.Wb(0,"div",1),l.Wb(1,"div",2),l.Wb(2,"div",3),l.Wb(3,"button",4),l.lc("tapped",(function(){return l.Dc(n),l.pc().changeDate(-1)})),l.Rb(4,"app-icon",5),l.Vb(),l.Wb(5,"div",6),l.Nc(6),l.Vb(),l.Wb(7,"button",7),l.lc("tapped",(function(){return l.Dc(n),l.pc().changeDate(1)})),l.Rb(8,"app-icon",5),l.Vb(),l.Vb(),l.Wb(9,"div",8),l.Wb(10,"div",9),l.lc("tapped",(function(){l.Dc(n);var e=l.pc();return e.show_locations=!e.show_locations})),l.Rb(11,"img",10),l.Wb(12,"div",6),l.ac(13,F),l.Vb(),l.Rb(14,"app-icon",5),l.Vb(),l.Wb(15,"div",11),l.Lc(16,ee,9,3,"div",12),l.Vb(),l.Vb(),l.Vb(),l.Lc(17,ae,3,1,"div",13),l.Vb()}if(2&e){var a=l.pc();l.Cb(3),l.vc("disabled",a.is_today),l.Cb(1),l.vc("icon",l.wc(8,ie)),l.Cb(2),l.Oc(a.date_display),l.Cb(2),l.vc("icon",l.wc(9,re)),l.Cb(6),l.vc("icon",l.xc(10,oe,"keyboard_arrow_"+(a.show_locations?"up":"down"))),l.Cb(1),l.vc("@show",a.show_locations?"show":"hide"),l.Cb(1),l.vc("ngForOf",a.building_list),l.Cb(1),l.vc("ngIf",a.location_list&&a.location_list.length)}}var se,le,ue,de,fe=((se=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var a;return _classCallCheck(this,n),(a=t.call(this))._service=e,a.locations=[],a.locationsChange=new l.n,a}return _createClass(n,[{key:"changeDate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=w(this.date.value).add(e,"d"),n=w().startOf("m");t.isBefore(n,"s")&&(t=n),this.date.setValue(t.valueOf())}},{key:"ngOnInit",value:function(){var e=this;this.building_list=this._service.Organisation.buildings,this.building_list&&this.building_list.length||this.timeout("init",(function(){return e.ngOnInit()}),300)}},{key:"addLocationFilter",value:function(e){this.locations||(this.locations=[]),this.locations.push(e.id),this.locations=Object(H.l)(this.locations),this.locationsChange.emit(this.locations)}},{key:"removeLocationFilter",value:function(e){this.locations&&(this.locations.splice(this.locations.findIndex((function(t){return e.id===t})),1),this.locationsChange.emit(this.locations))}},{key:"is_today",get:function(){var e=w(this.date.value);return w().isSame(e,"d")}},{key:"date_display",get:function(){var e=w(this.date.value);return this.is_today?"Today":e.format("DD MMM YYYY")}},{key:"location_list",get:function(){var e=this;return(this.locations||[]).map((function(t){return e.building_list.find((function(e){return e.id===t}))}))}}]),n}(s.a)).\u0275fac=function(e){return new(e||se)(l.Qb(c.a))},se.\u0275cmp=l.Kb({type:se,selectors:[["booking-space-filters"]],inputs:{date:"date",locations:"locations"},outputs:{locationsChange:"locationsChange"},features:[l.zb],decls:1,vars:1,consts:[["class","space-filters",4,"ngIf"],[1,"space-filters"],[1,"actions"],[1,"date"],["mat-icon-button","",3,"disabled","tapped"],[3,"icon"],[1,"text"],["mat-icon-button","",3,"tapped"],[1,"location-list"],[1,"inner",3,"tapped"],["src","assets/img/location-img.svg"],[1,"list"],["class","item",4,"ngFor","ngForOf"],["class","filters",4,"ngIf"],[1,"item"],[3,"change"],[1,"building-name"],[1,"code"],[1,"name"],[1,"address"],[1,"filters"],["aria-label","Location Filters"],["color","primary",3,"id","removable","removed",4,"ngFor","ngForOf"],["color","primary",3,"id","removable","removed"],["matChipRemove","",3,"icon"]],template:function(e,t){1&e&&l.Lc(0,ce,18,12,"div",0),2&e&&l.vc("ngIf",t.date)},directives:[a.t,M.b,j.c,x.a,a.s,Z.a,J.d,J.a,J.e],styles:[".space-filters[_ngcontent-%COMP%]{width:100%}.actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;padding:1em}@media only screen and (orientation:portrait) and (max-width:450px){.actions[_ngcontent-%COMP%]{padding:.5em}}@media only screen and (orientation:landscape) and (max-width:800px){.actions[_ngcontent-%COMP%]{padding:.5em}}.actions[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:0 .5em}.date[_ngcontent-%COMP%]{display:flex;align-items:center;border:1px solid #1937ea;height:2.5em;overflow:hidden}@media only screen and (orientation:portrait) and (max-width:450px){.date[_ngcontent-%COMP%]{margin-bottom:.5em!important}}@media only screen and (orientation:landscape) and (max-width:800px){.date[_ngcontent-%COMP%]{margin-bottom:.5em!important}}.date[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0;color:#1937ea;background-color:rgba(25,55,234,.1);height:2.5em;width:2.5em;margin:0}.date[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{background-color:#f0f0f0;color:rgba(0,0,0,.35)}.date[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;border-left:1px solid #1937ea;border-right:1px solid #1937ea;width:8em;height:100%}.location-list[_ngcontent-%COMP%]{position:relative;border:1px solid #ccc;width:24em}.location-list[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]{position:relative;overflow:hidden;display:flex;align-items:center;height:2.5em}.location-list[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.5em}.location-list[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:-10px;left:-10px}.location-list[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1;min-width:50%;margin-left:3em;padding:0 1em}.location-list[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{position:absolute;bottom:0;transform:translateY(100%);background-color:#41485b;color:#fff;width:24em;max-height:25em;overflow:hidden auto;z-index:999;max-width:100%}.location-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{margin:.5em;width:24em}.filters[_ngcontent-%COMP%]{padding:0 1em 1em;margin:0 auto;max-width:720px;width:100%}@media only screen and (orientation:portrait) and (max-width:450px){.filters[_ngcontent-%COMP%]{padding-bottom:.5em}}@media only screen and (orientation:landscape) and (max-width:800px){.filters[_ngcontent-%COMP%]{padding-bottom:.5em}}.building-name[_ngcontent-%COMP%]{display:flex;align-items:center}.building-name[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{width:4em}.building-name[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:8em}.building-name[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{flex:1;min-width:6em;max-width:50vw;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:.2em!important}.mat-menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:0 1em}.mat-menu-item[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.2em}.mat-menu-item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1;min-width:50%;margin-left:.5em;padding-right:2em}.mat-chip.mat-standard-chip[_ngcontent-%COMP%]   .mat-chip-remove[_ngcontent-%COMP%]{color:hsla(0,0%,100%,.85)}"],data:{animation:[K.a]}}),se),me=n("vxfF"),be=(n("KsZa"),n("ceWj")),pe=n("daPb");function he(e,t){if(1&e){var n=l.Xb();l.Wb(0,"div",6),l.Wb(1,"div",7),l.Nc(2),l.Vb(),l.Wb(3,"div",8),l.Wb(4,"button",9),l.lc("tapped",(function(){l.Dc(n);var e=t.$implicit;return l.pc().selectSpace(e)})),l.Wb(5,"div",10),l.Nc(6),l.Vb(),l.Vb(),l.Vb(),l.Vb()}if(2&e){var a=t.$implicit,i=l.pc();l.Cb(2),l.Oc(a.date_string),l.Cb(2),l.Gb("inverse",!a.available&&!a.replaced_by),l.Cb(2),l.Pc(" ",a.replaced_by||(a.available?i.space.name:"Find Room")," ")}}le=$localize(_templateObject9(),"\ufffd0\ufffd"),ue=$localize(_templateObject10()),de=$localize(_templateObject11());var ge,ve,_e,ye=function(){return{type:"icon",class:"material-icons",content:"close"}},Oe=((ge=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,i){var r;return _classCallCheck(this,n),(r=t.call(this))._data=e,r._dialog=a,r._service=i,r.event=new l.n,r.occurrences=[],r.space_details=[],r}return _createClass(n,[{key:"ngOnInit",value:function(){this.space_details=[].concat(this._data.conflicts||[]),this.updateOccurrences()}},{key:"save",value:function(){this.event.emit({reason:"done",metadata:this.space_details})}},{key:"selectSpace",value:function(e){var t=this,n=this._dialog.open(pe.a,{width:"auto",height:"auto",maxWidth:"95vw",data:{spaces:[],zone_ids:this.space.level.building_id,date:1e3*e.date,duration:this._data.duration,host:this._data.host,multiple:!1}});this.subscription("new_spaces",n.componentInstance.event.subscribe((function(a){if("done"===a.reason){var i=a.metadata[0];i&&(console.log("Space:",i),t.space_details.unshift({date:e.date,space:i.email,replaces:t.space.email}),t.space_details=Object(H.l)(t.space_details,"date")),t.updateOccurrences(),n.close(),t.unsub("new_spaces")}})))}},{key:"updateOccurrences",value:function(){var e=this;this.occurrences=this._data.space.recurr_available.map((function(t){var n=e.space_details.find((function(n){return n.date===t.date&&n.replaces===e.space.email})),a=(n||{}).space,i=e._service.Spaces.item(a)||{email:a,name:a};return console.log("Space:",n,i),Object.assign(Object.assign({},t),{date_string:w(1e3*t.date).format("dddd, DD MMMM YYYY"),replaced_by:i.name})})),console.log("Occurrences:",this.occurrences)}},{key:"space",get:function(){return this._data.space}},{key:"occurrences_valid",get:function(){return this.occurrences.reduce((function(e,t){return e&&(t.available||!!t.replaced_by)}),!0)}}]),n}(s.a)).\u0275fac=function(e){return new(e||ge)(l.Qb(C.a),l.Qb(C.b),l.Qb(c.a))},ge.\u0275cmp=l.Kb({type:ge,selectors:[["a-recurrence-spaces-modal"]],outputs:{event:"event"},features:[l.zb],decls:14,vars:5,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"info"],["class","item",4,"ngFor","ngForOf"],["mat-button","",3,"disabled","tapped"],[1,"item"],[1,"date"],[1,"action"],["mat-button","",3,"tapped"],[1,"content"]],template:function(e,t){1&e&&(l.Wb(0,"header"),l.Wb(1,"div",0),l.ac(2,le),l.Vb(),l.Wb(3,"button",1),l.Rb(4,"app-icon",2),l.Vb(),l.Vb(),l.Wb(5,"mat-dialog-content"),l.Wb(6,"main"),l.Wb(7,"div",3),l.ac(8,ue),l.Vb(),l.Lc(9,he,7,4,"div",4),l.Vb(),l.Vb(),l.Wb(10,"mat-dialog-actions"),l.Wb(11,"footer"),l.Wb(12,"button",5),l.lc("tapped",(function(){return t.save()})),l.ac(13,de),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Cb(2),l.ec(t.space.name),l.bc(2),l.Cb(2),l.vc("icon",l.wc(4,ye)),l.Cb(5),l.vc("ngForOf",t.occurrences),l.Cb(3),l.vc("disabled",!t.occurrences_valid))},directives:[M.b,C.d,x.a,C.f,a.s,C.c,j.c],styles:[".heading[_ngcontent-%COMP%]{flex:1}.item[_ngcontent-%COMP%], main[_ngcontent-%COMP%]{padding:.5em}.item[_ngcontent-%COMP%]{display:flex;align-items:center}.item[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{flex:1;margin-right:1em}.item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:13em}.item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{width:10.5em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.info[_ngcontent-%COMP%]{font-size:.8em;color:#1937ea;margin-bottom:1em;font-style:italic}.info[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{text-align:center}footer[_ngcontent-%COMP%]{width:100%}"]}),ge);function Ce(e,t){if(1&e&&l.Rb(0,"div",14),2&e){var n=l.pc(2);l.Kc("background-image","url("+n.space.image+")",l.Jb)}}function ke(e,t){if(1&e&&(l.Wb(0,"div",15),l.gc(1,_e),l.Rb(2,"span"),l.dc(),l.Vb()),2&e){var n=l.pc(2);l.Cb(2),l.ec(n.availability),l.bc(1)}}ve=$localize(_templateObject12()),_e=$localize(_templateObject13(),"\ufffd#2\ufffd","\ufffd0\ufffd","\ufffd/#2\ufffd");var we=function(){return{type:"icon",class:"material-icons",content:"account_circle"}};function Pe(e,t){if(1&e){var n=l.Xb();l.Wb(0,"div",1),l.Wb(1,"div",2),l.Lc(2,Ce,1,2,"div",3),l.Rb(3,"div",4),l.Wb(4,"div",5),l.Nc(5),l.Vb(),l.Wb(6,"div",6),l.Wb(7,"div",7),l.Nc(8),l.Vb(),l.Wb(9,"div",8),l.Rb(10,"app-icon",9),l.Nc(11),l.Vb(),l.Vb(),l.Lc(12,ke,3,1,"div",10),l.Vb(),l.Wb(13,"div",11),l.Wb(14,"button",12),l.lc("tapped",(function(){return l.Dc(n),l.pc().selectSpace()})),l.Nc(15),l.Vb(),l.Wb(16,"button",13),l.lc("tapped",(function(){return l.Dc(n),l.pc().locate()})),l.ac(17,ve),l.Vb(),l.Vb(),l.Vb()}if(2&e){var a=l.pc();l.Gb("with-image",a.show_image),l.Cb(2),l.vc("ngIf",a.space.image),l.Cb(3),l.Oc(a.space.name),l.Cb(3),l.Oc(a.location),l.Cb(2),l.vc("icon",l.wc(13,we)),l.Cb(1),l.Pc(" ",a.space.capacity||"0"," "),l.Cb(1),l.vc("ngIf",a.space.recurr_available&&a.space.recurr_available.length),l.Cb(2),l.Gb("inverse",a.multi&&!a.selected)("request",a.is_request),l.Cb(1),l.Pc(" ",a.multi?a.selected?"Remove":"Select":a.is_request?"Request":"Book"," ")}}var Me,xe,je,Ve,We,ze=((Me=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a){var i;return _classCallCheck(this,n),(i=t.call(this))._service=e,i._dialog=a,i.select=new l.n,i}return _createClass(n,[{key:"locate",value:function(){this._dialog.open(be.a,{width:"auto",height:"auto",maxWidth:"95vw",maxHeight:"95vh",data:{space:this.space}})}},{key:"selectSpace",value:function(){var e=this;if(!this.space.recurr_available||"all"===this.availability||this.selected)this.select.emit();else{var t=this._dialog.open(Oe,{width:"auto",height:"auto",maxWidth:"95vw",maxHeight:"95vh",data:{space:this.space,duration:this.form.controls.duration.value,host:this.form.controls.organiser.value,conflicts:this.form.controls.recurrence.value.conflicts||[]}});this.subscription("recurr_conflicts",t.componentInstance.event.subscribe((function(n){if("done"===n.reason){var a,i=e.form.controls.recurrence.value,r=i.conflicts||[],o=_createForOfIteratorHelper(n.metadata);try{var c=function(){var e=a.value,t=r.findIndex((function(t){return t.date===e.date&&t.replaces===e.replaces}));t>=0?r.splice(t,1,e):r.push(e)};for(o.s();!(a=o.n()).done;)c()}catch(s){o.e(s)}finally{o.f()}e.form.controls.recurrence.setValue(Object.assign(Object.assign({},i),{conflicts:r})),e.select.emit(),t.close()}})))}}},{key:"show_image",get:function(){return this._service.setting("app.space_display.show_images")}},{key:"selected",get:function(){var e=this;return!(!this.form&&this.space)&&this.form.controls.space_list&&!!(this.form.controls.space_list.value||[]).find((function(t){return t.id===e.space.id}))}},{key:"is_request",get:function(){return!!this.form&&this.space.byRequest({date:this.form.controls.date.value,duration:this.form.controls.duration.value,host:this.form.controls.organiser.value||this._service.Users.current})}},{key:"availability",get:function(){var e=this.space.recurr_available.reduce((function(e,t){return e+(t.available?1:0)}),0);return e>=this.space.recurr_available.length?"all":"".concat(e," of ").concat(this.space.recurr_available.length)}},{key:"location",get:function(){if(!this.space)return"Unable to determine location";var e=this.space.level,t=this._service.Organisation.buildings.find((function(t){return t.id===e.building_id}));return"".concat(t?t.name+", ":"").concat(e.name)}}]),n}(s.a)).\u0275fac=function(e){return new(e||Me)(l.Qb(c.a),l.Qb(C.b))},Me.\u0275cmp=l.Kb({type:Me,selectors:[["a-booking-space-item"]],inputs:{space:"space",form:"form",multi:"multi"},outputs:{select:"select"},features:[l.zb],decls:1,vars:1,consts:[["class","space-details",3,"with-image",4,"ngIf"],[1,"space-details"],[1,"details"],["class","image",3,"background-image",4,"ngIf"],[1,"overlay"],[1,"name"],[1,"info"],[1,"location"],[1,"capacity"],[3,"icon"],["class","info recurr",4,"ngIf"],[1,"actions"],["mat-button","",3,"tapped"],["mat-button","",1,"inverse",3,"tapped"],[1,"image"],[1,"info","recurr"]],template:function(e,t){1&e&&l.Lc(0,Pe,18,14,"div",0),2&e&&l.vc("ngIf",t.space)},directives:[a.t,x.a,M.b,j.c],styles:[".space-details[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;width:720px;max-width:calc(100vw - 1em);background-color:#fff;flex-wrap:wrap;border-radius:0;overflow:hidden;transition:box-shadow .2s,top .2s;top:0;margin:.5em auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.space-details[_ngcontent-%COMP%]:hover{box-shadow:0 1px 3px 2px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);top:-2px}.space-details[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:none}.with-image[_ngcontent-%COMP%]{padding-top:0;width:480px}.with-image[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:initial;background-color:rgba(0,0,0,.65);color:#fff;transition:opacity .2s}.with-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.with-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{overflow:hidden;background-position:50%;background-size:cover}.with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{-webkit-filter:drop-shadow(0 0 2px #000);filter:drop-shadow(0 0 2px black);color:#fff}.with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{opacity:0}.with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{position:relative;height:6em;width:24em;margin:0 auto 0 0;max-width:24em;overflow:hidden;height:12em}.with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{transition:-webkit-filter .2s;transition:filter .2s;transition:filter .2s,-webkit-filter .2s}.with-image[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;bottom:2em;color:#fff}.with-image[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{position:absolute;bottom:1em;color:hsla(0,0%,100%,.65);width:calc(100% - 2em)}.details[_ngcontent-%COMP%]{flex:1;min-width:50%;padding:1em;min-width:99%}.info[_ngcontent-%COMP%]{display:flex;align-items:center;color:rgba(0,0,0,.65)}.name[_ngcontent-%COMP%]{font-size:1.2em}.location[_ngcontent-%COMP%]{font-size:.8em;flex:1;min-width:50%}.capacity[_ngcontent-%COMP%]{display:flex;align-items:center}.recurr[_ngcontent-%COMP%]{color:#1937ea;font-size:.8em}.recurr[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-decoration:underline}.actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;flex:1}button[_ngcontent-%COMP%]{min-width:12em;flex:1;margin:0;border-radius:0}button.request[_ngcontent-%COMP%]{color:#fff;background-color:#ffb300;border-color:#ffb300}button.request.inverse[_ngcontent-%COMP%]{color:#ffb300;background-color:#fff}"]}),Me),Ie=n("Xa2L");function Le(e,t){if(1&e){var n=l.Xb();l.Ub(0),l.Wb(1,"a-booking-space-item",14),l.lc("select",(function(){l.Dc(n);var e=t.$implicit;return l.pc(3).selectSpace(e)})),l.Vb(),l.Tb()}if(2&e){var a=t.$implicit,i=l.pc(3);l.Cb(1),l.vc("form",i.form)("space",a)("multi",i.multiple)}}function Te(e,t){if(1&e&&(l.Wb(0,"cdk-virtual-scroll-viewport",12),l.Lc(1,Le,2,3,"ng-container",13),l.Vb()),2&e){var n=l.pc(2);l.vc("itemSize",n.item_size),l.Cb(1),l.vc("cdkVirtualForOf",n.space_list)}}function Se(e,t){if(1&e&&(l.Ub(0),l.Lc(1,Te,2,2,"cdk-virtual-scroll-viewport",11),l.Tb()),2&e){var n=l.pc(),a=l.Ac(13);l.Cb(1),l.vc("ngIf",n.space_list&&n.space_list.length)("ngIfElse",a)}}function De(e,t){if(1&e){var n=l.Xb();l.Wb(0,"button",15),l.lc("tapped",(function(){return l.Dc(n),l.pc().next()})),l.ac(1,je),l.Vb()}if(2&e){var a=l.pc();l.vc("disabled",!a.spaces.value||!a.spaces.value.length)}}function Ae(e,t){1&e&&(l.Wb(0,"div",16),l.Wb(1,"div",17),l.Wb(2,"div",18),l.Rb(3,"mat-spinner",19),l.Vb(),l.Wb(4,"div",20),l.ac(5,Ve),l.Vb(),l.Vb(),l.Vb())}xe=$localize(_templateObject14()),je=$localize(_templateObject15()),Ve=$localize(_templateObject16()),We=$localize(_templateObject17());var Ne=function(){return{class:"material-icons",content:"close"}};function $e(e,t){1&e&&(l.Wb(0,"div",16),l.Wb(1,"div",17),l.Wb(2,"div",18),l.Rb(3,"app-icon",21),l.Vb(),l.Wb(4,"div",20),l.ac(5,We),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Cb(3),l.vc("icon",l.wc(1,Ne)))}var Fe,Ee,Re,qe=((Fe=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var a;return _classCallCheck(this,n),(a=t.call(this))._service=e,a.event=new l.n,a.space_list=[],a.change$=new Y.a,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;if(!this._service.is_initialised&&this._service.Spaces.list().length)return this.timeout("init",(function(){return e.ngOnInit()}));this.search_results$=this.change$.pipe(Object(q.a)(400),Object(B.a)(),Object(G.a)((function(t){e.loading=!0;var n=e.form.controls.recurrence?e.form.controls.recurrence.value:null,a=n&&n.period&&"None"!==n.period?{recurr_period:(n.period||"").toLowerCase(),recurr_end:w(n.end).unix()}:{},i=Object.assign({date:e.form.controls.date.value,duration:e.form.controls.duration.value,zone_ids:e._service.Organisation.building.id,bookable:!0},a);return e.zone_ids&&e.zone_ids.length&&(i.zone_ids=e.zone_ids.join(",")),e._service.Spaces.available(i)})),Object(Q.a)((function(e){return console.error(e),Object(X.a)([])})),Object(U.a)((function(t){return e.loading=!1,t}))),this.subscription("search_results",this.search_results$.subscribe((function(t){return e.space_list=t}))),this.change$.next("")}},{key:"ngOnChanges",value:function(e){var t=this;e.form&&(this.form.controls.date&&this.subscription("date_field",this.form.controls.date.valueChanges.subscribe((function(e){return t.change$.next(e)}))),this.form.controls.duration&&this.subscription("duration_field",this.form.controls.duration.valueChanges.subscribe((function(e){return t.change$.next(e)}))))}},{key:"selectSpace",value:function(e){if(this.multiple){var t=this.spaces.value||[],n=t.find((function(t){return t.id===e.id}));this.spaces.setValue(n?t.filter((function(t){return t.id!==e.id})):t.concat([e]))}else this.spaces.setValue([e]),this.event.emit({type:"next",step:"search"})}},{key:"next",value:function(){this.event.emit({type:"next",step:"search"})}},{key:"previous",value:function(){this.event.emit({type:"previous",step:"search"})}},{key:"item_size",get:function(){return window,window,window,130}},{key:"multiple",get:function(){return this._service.setting("app.booking.multiple_spaces")}}]),n}(s.a)).\u0275fac=function(e){return new(e||Fe)(l.Qb(c.a))},Fe.\u0275cmp=l.Kb({type:Fe,selectors:[["booking-find-space"]],inputs:{spaces:"spaces",form:"form"},outputs:{event:"event"},features:[l.zb,l.Ab],decls:14,vars:5,consts:[[1,"find-space"],[1,"background"],[1,"header"],[3,"date","locations","locationsChange"],[4,"ngIf","ngIfElse"],[1,"footer"],[1,"box"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"disabled","tapped",4,"ngIf"],["load_state",""],["empty_state",""],[3,"itemSize",4,"ngIf","ngIfElse"],[3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf"],[3,"form","space","multi","select"],["mat-button","",3,"disabled","tapped"],[1,"body"],[1,"info-block","center"],[1,"icon"],["diameter","48"],[1,"text"],[3,"icon"]],template:function(e,t){if(1&e&&(l.Wb(0,"div",0),l.Rb(1,"div",1),l.Wb(2,"div",2),l.Wb(3,"booking-space-filters",3),l.lc("locationsChange",(function(e){return t.zone_ids=e}))("locationsChange",(function(e){return t.change$.next(e)})),l.Vb(),l.Vb(),l.Lc(4,Se,2,2,"ng-container",4),l.Wb(5,"div",5),l.Wb(6,"div",6),l.Wb(7,"button",7),l.lc("tapped",(function(){return t.previous()})),l.ac(8,xe),l.Vb(),l.Lc(9,De,2,1,"button",8),l.Vb(),l.Vb(),l.Vb(),l.Lc(10,Ae,6,0,"ng-template",null,9,l.Mc),l.Lc(12,$e,6,2,"ng-template",null,10,l.Mc)),2&e){var n=l.Ac(11);l.Cb(3),l.vc("date",t.form.controls.date)("locations",t.zone_ids),l.Cb(1),l.vc("ngIf",!t.loading)("ngIfElse",n),l.Cb(5),l.vc("ngIf",t.multiple)}},directives:[fe,a.t,M.b,j.c,me.d,me.a,me.c,ze,Ie.c,x.a],styles:[".find-space[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;flex-direction:column;height:100%;width:100%;max-height:calc(100vh - 7.5em);overflow:hidden}@media only screen and (orientation:portrait) and (max-width:450px){.find-space[_ngcontent-%COMP%]{max-height:calc(100vh - 6.5em)}}@media only screen and (orientation:landscape) and (max-width:800px){.find-space[_ngcontent-%COMP%]{max-height:calc(100vh - 6.5em)}}.header[_ngcontent-%COMP%]{position:relative;z-index:999;width:100%;max-width:100vw;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}@media only screen and (orientation:portrait) and (max-width:450px){.header[_ngcontent-%COMP%]{border-radius:0}}@media only screen and (orientation:landscape) and (max-width:800px){.header[_ngcontent-%COMP%]{border-radius:0}}.body[_ngcontent-%COMP%], cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{position:relative;width:100%;flex:1;min-height:50%}.box[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;max-width:100vw;background-color:#fff;padding:.5em;margin:auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);border-top:1px solid #ccc}.box[_ngcontent-%COMP%], .footer[_ngcontent-%COMP%]{width:100%}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:0 .5em}.background[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:50%;transform:translateX(-50%);width:768px;max-width:100vw}.info-block[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:2.5em;width:2.5em}"]}),Fe);Ee=$localize(_templateObject18(),"[\ufffd#2\ufffd|\ufffd#3\ufffd]","\ufffd0\ufffd","[\ufffd/#2\ufffd|\ufffd/#3\ufffd]","[\ufffd#2\ufffd|\ufffd#3\ufffd]","\ufffd1\ufffd","[\ufffd/#2\ufffd|\ufffd/#3\ufffd]"),Ee=l.fc(Ee),Re=$localize(_templateObject19()),Re=l.fc(Re,{VAR_PLURAL:"\ufffd0\ufffd"});var Be,Ge,Qe,Ue,Ye,Xe,He,Ke=function(){return{class:"material-icons",content:"edit"}},Ze=function(){return{class:"material-icons",content:"delete"}},Je=((Be=function(){function e(t){_classCallCheck(this,e),this._service=t,this.edit=new l.n,this.delete=new l.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"space",get:function(){if(!this.order)return"<No Location>";var e=this._service.Spaces.item(this.order.location_id);return(e?e.name:"")||"<No Location>"}},{key:"delivery_time",get:function(){return this.order?w(this.order.booking_date).add((this.order.changes||{}).delivery_time||this.order.delivery_time,"m").format("h:mm A"):"<Meeting Start>"}},{key:"order_cost",get:function(){return((this.order?this.order.items:null)||[]).reduce((function(e,t){return e+t.amount*t.unit_price}),0)}},{key:"item_count",get:function(){return((this.order?this.order.items:null)||[]).reduce((function(e,t){return e+t.amount}),0)}},{key:"symbol",get:function(){var e=this._service.Spaces.item(this.order.location_id);if(!e||!e.level)return"USD";var t=this._service.Organisation.buildings.find((function(t){return t.id===e.level.building_id}));return t?t.currency:"USD"}}]),e}()).\u0275fac=function(e){return new(e||Be)(l.Qb(c.a))},Be.\u0275cmp=l.Kb({type:Be,selectors:[["catering-order-list-item"]],inputs:{order:"order",date:"date"},outputs:{edit:"edit",delete:"delete"},decls:17,vars:12,consts:[[1,"details"],[1,"group"],[1,"cost"],[1,"actions"],["mat-icon-button","",3,"tapped"],[3,"icon"],["mat-icon-button","",1,"inverse",3,"tapped"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.gc(1,Ee),l.Rb(2,"span"),l.Rb(3,"span"),l.dc(),l.Vb(),l.Wb(4,"div",1),l.Wb(5,"div",2),l.Nc(6),l.Wb(7,"span"),l.ac(8,Re),l.Vb(),l.Vb(),l.Wb(9,"div",2),l.Nc(10),l.qc(11,"currency"),l.Vb(),l.Vb(),l.Wb(12,"div",3),l.Wb(13,"button",4),l.lc("tapped",(function(){return t.edit.emit()})),l.Rb(14,"app-icon",5),l.Vb(),l.Wb(15,"button",6),l.lc("tapped",(function(){return t.delete.emit()})),l.Rb(16,"app-icon",5),l.Vb(),l.Vb()),2&e&&(l.Cb(3),l.ec(t.space)(t.delivery_time),l.bc(1),l.Cb(3),l.Pc(" ",t.item_count," "),l.Cb(2),l.ec(t.item_count),l.bc(8),l.Cb(2),l.Oc(l.sc(11,7,t.order_cost/100,t.symbol)),l.Cb(4),l.vc("icon",l.wc(10,Ke)),l.Cb(2),l.vc("icon",l.wc(11,Ze)))},directives:[M.b,j.c,x.a],pipes:[a.d],styles:["[_nghost-%COMP%]{display:flex;align-items:center;padding:.25em;margin:.25em;border-radius:4px}.details[_ngcontent-%COMP%]{flex:1;padding:.5em}.details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:400}.cost[_ngcontent-%COMP%]{padding:.25em .5em;border-radius:4px;font-size:.8rem;margin:.25em .4rem .25em 0;white-space:nowrap;text-align:center}.cost[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{color:#fff;background-color:#1937ea}button[_ngcontent-%COMP%]{margin:.25em}button.inverse[_ngcontent-%COMP%]{background-color:#fff;color:#e53935;border:1px solid #e53935}"]}),Be);function et(e,t){if(1&e){var n=l.Xb();l.Wb(0,"catering-order-list-item",10),l.lc("edit",(function(){l.Dc(n);var e=t.$implicit;return l.pc(2).editOrder(e)}))("delete",(function(){l.Dc(n);var e=t.$implicit;return l.pc(2).deleteOrder(e)})),l.Vb()}if(2&e){var a=t.$implicit,i=l.pc(2);l.vc("order",a)("date",i.date)}}function tt(e,t){if(1&e){var n=l.Xb();l.Ub(0),l.Wb(1,"div",8),l.Lc(2,et,1,2,"catering-order-list-item",9),l.Vb(),l.Wb(3,"button",6),l.lc("tapped",(function(){return l.Dc(n),l.pc().newOrder()})),l.ac(4,Ye),l.Vb(),l.Tb()}if(2&e){var a=l.pc();l.Cb(2),l.vc("ngForOf",a.orders)}}Ge=$localize(_templateObject20()),Qe=$localize(_templateObject21()),Ue=$localize(_templateObject22()),Ye=$localize(_templateObject23()),Xe=$localize(_templateObject24()),He=$localize(_templateObject25());var nt=function(){return{class:"material-icons",content:"close"}};function at(e,t){if(1&e){var n=l.Xb();l.Wb(0,"div",11),l.Wb(1,"div",12),l.Rb(2,"app-icon",13),l.Vb(),l.Wb(3,"div",14),l.ac(4,Xe),l.Vb(),l.Wb(5,"button",6),l.lc("tapped",(function(){return l.Dc(n),l.pc().newOrder()})),l.ac(6,He),l.Vb(),l.Vb()}2&e&&(l.Cb(2),l.vc("icon",l.wc(1,nt)))}var it,rt,ot,ct=((it=function(){function e(){_classCallCheck(this,e),this.event=new l.n,this.order=new l.n}return _createClass(e,[{key:"newOrder",value:function(){this.order.emit()}},{key:"editOrder",value:function(e){this.order.emit(e)}},{key:"deleteOrder",value:function(e){var t=this.orders,n=t.findIndex((function(t){return e.id===t.id}));n>=0&&(t.splice(n,1),this.catering.setValue(t))}},{key:"next",value:function(){this.event.emit({type:"next",step:"catering"})}},{key:"previous",value:function(){this.event.emit({type:"previous",step:"catering"})}},{key:"orders",get:function(){var e=this;if(!this.catering)return[];var t=this.catering.value||[];return t.forEach((function(t){return t.booking_date=e.all_day?w(e.date).startOf("d").valueOf():e.date})),t}}]),e}()).\u0275fac=function(e){return new(e||it)},it.\u0275cmp=l.Kb({type:it,selectors:[["a-catering-order-list"]],inputs:{catering:"catering",date:"date",all_day:"all_day"},outputs:{event:"event",order:"order"},decls:13,vars:2,consts:[[1,"catering","order-list"],[1,"header"],[1,"body"],[4,"ngIf","ngIfElse"],[1,"footer"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"tapped"],["empty_state",""],[1,"list"],[3,"order","date","edit","delete",4,"ngFor","ngForOf"],[3,"order","date","edit","delete"],[1,"info-block","center"],[1,"icon"],[3,"icon"],[1,"text"]],template:function(e,t){if(1&e&&(l.Wb(0,"div",0),l.Wb(1,"div",1),l.Wb(2,"h3"),l.ac(3,Ge),l.Vb(),l.Vb(),l.Wb(4,"div",2),l.Lc(5,tt,5,1,"ng-container",3),l.Vb(),l.Wb(6,"div",4),l.Wb(7,"button",5),l.lc("tapped",(function(){return t.previous()})),l.ac(8,Qe),l.Vb(),l.Wb(9,"button",6),l.lc("tapped",(function(){return t.next()})),l.ac(10,Ue),l.Vb(),l.Vb(),l.Vb(),l.Lc(11,at,7,2,"ng-template",null,7,l.Mc)),2&e){var n=l.Ac(12);l.Cb(5),l.vc("ngIf",t.orders&&t.orders.length)("ngIfElse",n)}},directives:[a.t,M.b,j.c,a.s,Je,x.a],styles:["[_nghost-%COMP%]{height:100%}.order-list[_ngcontent-%COMP%]{flex-direction:column;height:100%;width:768px;margin:auto;max-width:100vw;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.body[_ngcontent-%COMP%], .order-list[_ngcontent-%COMP%]{display:flex;align-items:center}.body[_ngcontent-%COMP%]{position:relative;flex-direction:column;flex:1;width:100%;min-height:50%;overflow:auto}.body[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:8em}.list[_ngcontent-%COMP%]{width:100%}.list[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{border:1px solid #ccc}.list[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.05)}.footer[_ngcontent-%COMP%]{width:100%;text-align:center;border-top:1px solid #ccc}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:.5em}.info-block[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:1em}"]}),it),st=n("IRj4"),lt=n("aXH1"),ut=n("QibW");function dt(e,t){1&e&&l.Sb(0)}function ft(e,t){if(1&e){var n=l.Xb();l.Wb(0,"mat-checkbox",11),l.lc("change",(function(e){l.Dc(n);var t=l.pc(2).$implicit,a=l.pc(2).package;return l.pc().updateAmount(a,t,e.checked)})),l.Nc(1),l.Vb()}if(2&e){var a=l.pc(2).$implicit;l.vc("checked",!!a.amount),l.Cb(1),l.Pc(" ",a.name," ")}}function mt(e,t){if(1&e){var n=l.Xb();l.Wb(0,"mat-radio-button",12),l.lc("change",(function(e){l.Dc(n);var t=l.pc(2).$implicit,a=l.pc(2).package;return l.pc().updateAmount(a,t,e.value===t.id)})),l.Nc(1),l.Vb()}if(2&e){var a=l.pc(2).$implicit;l.vc("value",a.id),l.Cb(1),l.Pc(" ",a.name," ")}}function bt(e,t){if(1&e&&(l.Ub(0),l.Lc(1,ft,2,2,"mat-checkbox",9),l.Lc(2,mt,2,2,"mat-radio-button",10),l.Tb()),2&e){var n=l.pc(3).package;l.Cb(1),l.vc("ngIf",n.must_select>1),l.Cb(1),l.vc("ngIf",1===n.must_select)}}function pt(e,t){if(1&e&&(l.Ub(0),l.Nc(1),l.Tb()),2&e){var n=l.pc().$implicit;l.Cb(1),l.Pc(" ",n.name," ")}}function ht(e,t){1&e&&l.Sb(0)}rt=$localize(_templateObject26()),ot=$localize(_templateObject27());var gt=function(e){return{package:e}};function vt(e,t){if(1&e&&(l.Wb(0,"div",8),l.Lc(1,bt,3,2,"ng-container",5),l.Lc(2,pt,2,1,"ng-container",5),l.Lc(3,ht,1,0,"ng-container",2),l.Vb()),2&e){var n=t.$implicit,a=l.pc(2).package;l.pc();var i=l.Ac(13);l.Db("to-select",n.must_select),l.Cb(1),l.vc("ngIf",a.must_select&&a.must_select<a.items.length&&!n.must_select),l.Cb(1),l.vc("ngIf",a.must_select>=a.items.length||n.must_select),l.Cb(1),l.vc("ngTemplateOutlet",i)("ngTemplateOutletContext",l.xc(5,gt,n))}}function _t(e,t){if(1&e&&(l.Ub(0),l.Wb(1,"mat-radio-group",6),l.Lc(2,vt,4,7,"div",7),l.Vb(),l.Tb()),2&e){var n=l.pc().package,a=l.pc();l.Cb(1),l.vc("ngModel",a.active_items[n.id]),l.Cb(1),l.vc("ngForOf",n.items)}}function yt(e,t){if(1&e&&l.Lc(0,_t,3,2,"ng-container",5),2&e){var n=t.package;l.vc("ngIf",n.items&&n.items.length)}}var Ot,Ct,kt,wt,Pt,Mt=function(){return{class:"material-icons",content:"close"}},xt=((Ot=function(){function e(t){_classCallCheck(this,e),this._data=t,this.event=new l.n}return _createClass(e,[{key:"ngOnInit",value:function(){this.item=this._data.item}},{key:"updateAmount",value:function(e,t,n){if(n){var a=e.must_select;e.items.filter((function(e){return e.amount>0})).length>=a&&e.items.find((function(e){return e.amount>0})).setAmount(0),t.setAmount(1)}else t.setAmount(0)}},{key:"requirements_met",get:function(){return function e(t){var n=t.items||[];return t.must_select>=n.length?n.reduce((function(t,n){return t&&e(n)}),!0):n.reduce((function(e,t){return e+t.amount?1:0}),0)===t.must_select}(this.item)}},{key:"active_items",get:function(){return function e(t){var n={};if(t.items){var a=t.items.find((function(e){return e.amount>0}));a&&(n[t.id]=a.id),t.items.forEach((function(t){return n=Object.assign(Object.assign({},n),e(t))}))}return n}(this.item)}}]),e}()).\u0275fac=function(e){return new(e||Ot)(l.Qb(C.a))},Ot.\u0275cmp=l.Kb({type:Ot,selectors:[["a-package-options-modal"]],outputs:{event:"event"},decls:14,vars:7,consts:[["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["mat-button","",3,"disabled","tapped"],["item_display",""],[4,"ngIf"],[3,"ngModel"],["class","item",4,"ngFor","ngForOf"],[1,"item"],[3,"checked","change",4,"ngIf"],[3,"value","change",4,"ngIf"],[3,"checked","change"],[3,"value","change"]],template:function(e,t){if(1&e&&(l.Wb(0,"header"),l.Wb(1,"h3"),l.ac(2,rt),l.Vb(),l.Wb(3,"button",0),l.Rb(4,"app-icon",1),l.Vb(),l.Vb(),l.Wb(5,"mat-dialog-content"),l.Wb(6,"main"),l.Lc(7,dt,1,0,"ng-container",2),l.Vb(),l.Vb(),l.Wb(8,"mat-dialog-actions"),l.Wb(9,"footer"),l.Wb(10,"button",3),l.lc("tapped",(function(){return t.event.emit({reason:"done"})})),l.ac(11,ot),l.Vb(),l.Vb(),l.Vb(),l.Lc(12,yt,1,1,"ng-template",null,4,l.Mc)),2&e){var n=l.Ac(13);l.Cb(4),l.vc("icon",l.wc(4,Mt)),l.Cb(3),l.vc("ngTemplateOutlet",n)("ngTemplateOutletContext",l.xc(5,gt,t.item)),l.Cb(3),l.vc("disabled",!t.requirements_met)}},directives:[M.b,C.d,x.a,C.f,a.A,C.c,j.c,a.t,ut.b,r.r,r.u,a.s,Z.a,ut.a],styles:["main[_ngcontent-%COMP%]{width:24em;min-height:24em;overflow:hidden auto}main[_ngcontent-%COMP%] > mat-radio-group[_ngcontent-%COMP%] > .item[_ngcontent-%COMP%]{background:none;border:none;border-bottom:1px solid #ccc}main[_ngcontent-%COMP%] > mat-radio-group[_ngcontent-%COMP%] > .item[_ngcontent-%COMP%]:last-child{border:none}.item[_ngcontent-%COMP%]{padding:.5em;border:1px solid #ccc;width:100%}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{border-bottom:none}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:first-child{border-radius:4px 4px 0 0;margin-top:.25em}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:last-child{margin-bottom:.25em;border-radius:0 0 4px 4px;border-bottom:1px solid #ccc}mat-dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #ccc}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),Ot),jt=n("Qu3c"),Vt=n("019G");function Wt(e,t){if(1&e&&l.Rb(0,"div",15),2&e){var n=l.pc(2);l.Kc("background-image","url("+n.item.image_path+")",l.Jb)}}function zt(e,t){if(1&e&&(l.Wb(0,"div",16),l.Nc(1),l.qc(2,"currency"),l.Vb()),2&e){var n=l.pc(2);l.Cb(1),l.Pc(" ",l.sc(2,1,n.item.unit_price/100,n.symbol)," ")}}function It(e,t){if(1&e&&(l.Wb(0,"div",17),l.ac(1,kt),l.Vb()),2&e){var n=l.pc(2);l.vc("matTooltip",n.contents),l.Cb(1),l.ec(n.item.items.length)(n.item.items.length),l.bc(1)}}function Lt(e,t){if(1&e&&(l.Wb(0,"div",17),l.Nc(1),l.Wb(2,"span",18),l.ac(3,wt),l.Vb(),l.Vb()),2&e){var n=l.pc(2);l.vc("matTooltip",n.contents),l.Cb(1),l.Pc(" ",n.item.must_select," ")}}function Tt(e,t){if(1&e){var n=l.Xb();l.Wb(0,"button",19),l.lc("tapped",(function(){return l.Dc(n),l.pc(2).updatePackageOptions()})),l.ac(1,Pt),l.Vb()}}function St(e,t){if(1&e&&(l.Wb(0,"div",20),l.Nc(1),l.qc(2,"currency"),l.Vb()),2&e){var n=l.pc(2);l.Cb(1),l.Pc(" ",l.sc(2,1,n.item.unit_price/100,n.symbol)," ")}}function Dt(e,t){if(1&e){var n=l.Xb();l.Wb(0,"a-counter",21),l.lc("ngModelChange",(function(e){return l.Dc(n),l.pc(2).updateAmount(e)})),l.Vb()}if(2&e){var a=l.pc(2);l.vc("ngModel",a.item.amount)}}Ct=$localize(_templateObject28()),Ct=l.fc(Ct,{VAR_PLURAL:"\ufffd0\ufffd",INTERPOLATION:"\ufffd1\ufffd"}),kt=$localize(_templateObject29(),Ct),wt=$localize(_templateObject30()),Pt=$localize(_templateObject31());var At=function(e){return{class:"material-icons",content:e}};function Nt(e,t){if(1&e){var n=l.Xb();l.Wb(0,"button",22),l.lc("tapped",(function(){l.Dc(n);var e=l.pc(2);return e.show_children=!e.show_children})),l.Rb(1,"app-icon",23),l.Vb()}if(2&e){var a=l.pc(2);l.Cb(1),l.vc("icon",l.xc(1,At,a.show_children?"keyboard_arrow_up":"keyboard_arrow_down"))}}function $t(e,t){if(1&e&&(l.Wb(0,"div",3),l.Lc(1,Wt,1,2,"div",4),l.Wb(2,"div",5),l.Wb(3,"div",6),l.Nc(4),l.Vb(),l.Wb(5,"div",7),l.Nc(6),l.Vb(),l.Wb(7,"div",8),l.Lc(8,zt,3,4,"div",9),l.Lc(9,It,2,3,"div",10),l.Lc(10,Lt,4,2,"div",10),l.Lc(11,Tt,2,0,"button",11),l.Vb(),l.Vb(),l.Lc(12,St,3,4,"div",12),l.Lc(13,Dt,1,1,"a-counter",13),l.Lc(14,Nt,2,3,"button",14),l.Vb()),2&e){var n=l.pc();l.Gb("subitem",n.subitem),l.Db("disabled",n.disabled&&!n.item.can_order_anytime),l.Cb(1),l.vc("ngIf",!n.subitem),l.Cb(3),l.Oc(n.item.name),l.Cb(2),l.Qc("",n.item.package?"[Package] ":"","",n.item.description,""),l.Cb(2),l.vc("ngIf",n.item.unit_price),l.Cb(1),l.vc("ngIf",n.item.package&&n.item.items.length&&!n.item.must_select),l.Cb(1),l.vc("ngIf",n.item.package&&n.item.must_select&&n.item.amount>0),l.Cb(1),l.vc("ngIf",n.item.package&&n.item.must_select&&n.item.amount>0),l.Cb(1),l.vc("ngIf",n.item.unit_price),l.Cb(1),l.vc("ngIf",!n.item.items||n.item.package),l.Cb(1),l.vc("ngIf",n.item.items&&n.item.items.length&&!n.item.package)}}function Ft(e,t){if(1&e&&l.Rb(0,"a-catering-order-item",24),2&e){var n=t.$implicit,a=l.pc();l.vc("subitem",!0)("symbol",a.symbol)("item",n)("field",a.field)}}var Et,Rt,qt,Bt=((Et=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a){var i;return _classCallCheck(this,n),(i=t.call(this))._service=e,i._dialog=a,i}return _createClass(n,[{key:"ngOnChanges",value:function(e){var t=this;if(e.field&&this.field){var n=this.field.value.find((function(e){return e.id===t.item.id}));this.item.setAmount(n?n.amount:0),this.subscription("field_change",this.field.valueChanges.subscribe((function(e){var n=e.find((function(e){return e.id===t.item.id}));t.item.setAmount(n?n.amount:0)})))}}},{key:"updateAmount",value:function(e){var t=this;if(this.field){var n=this.field.value||[],a=n.find((function(e){return e.id===t.item.id}));if(a)this.item.setAmount(e),a.setAmount(e);else{var i=this.item.amount;this.item.setAmount(e),this.item.package&&i<e?this.selectPackageOptions().then((function(e){n.push(new lt.a(e)),t.field.setValue(n.filter((function(e){return e.amount})))}),(function(){t.item.setAmount(999),t.timeout("amount",(function(){return t.item.setAmount(0)}),5),t._service.notifyWarn("Package options not selected. Item removed from order")})):n.push(new lt.a(this.item))}this.field.setValue(n.filter((function(e){return e.amount})))}}},{key:"updatePackageOptions",value:function(){this.selectPackageOptions().then((function(){return null}),(function(){return null}))}},{key:"selectPackageOptions",value:function(){var e=this;return new Promise((function(t,n){var a=e._dialog.open(xt,{maxWidth:"95vw",data:{item:new st.a(e.item)}}),i=!1;a.componentInstance.event.subscribe((function(e){"done"===e.reason&&(i=!0,t(a.componentInstance.item),a.close())})),a.afterClosed().subscribe((function(){i||n()}))}))}},{key:"contents",get:function(){return this.item.items?this.item.items.reduce((function(e,t){return e&&(e+="\n\n"),e+"".concat(t.name).concat(t.items?t.items.reduce((function(e,t){return e+"\n ".concat(t.amount?"\u2713":"\u2022"," ").concat(t.name," ")}),""):""," ").concat(t.amount?"\u2713":"")}),""):""}}]),n}(s.a)).\u0275fac=function(e){return new(e||Et)(l.Qb(c.a),l.Qb(C.b))},Et.\u0275cmp=l.Kb({type:Et,selectors:[["a-catering-order-item"]],inputs:{subitem:"subitem",item:"item",field:"field",symbol:"symbol",disabled:"disabled"},features:[l.zb,l.Ab],decls:3,vars:3,consts:[["class","catering-item",3,"subitem",4,"ngIf"],[1,"children"],[3,"subitem","symbol","item","field",4,"ngFor","ngForOf"],[1,"catering-item"],["class","image",3,"background-image",4,"ngIf"],[1,"details"],[1,"name"],[1,"description"],[1,"options"],["class","option price mobile-only",4,"ngIf"],["class","option",3,"matTooltip",4,"ngIf"],["mat-button","",3,"tapped",4,"ngIf"],["class","option price not-mobile",4,"ngIf"],[3,"ngModel","ngModelChange",4,"ngIf"],["mat-icon-button","",3,"tapped",4,"ngIf"],[1,"image"],[1,"option","price","mobile-only"],[1,"option",3,"matTooltip"],[1,"not-mobile"],["mat-button","",3,"tapped"],[1,"option","price","not-mobile"],[3,"ngModel","ngModelChange"],["mat-icon-button","",3,"tapped"],[3,"icon"],[3,"subitem","symbol","item","field"]],template:function(e,t){1&e&&(l.Lc(0,$t,15,14,"div",0),l.Wb(1,"div",1),l.Lc(2,Ft,1,4,"a-catering-order-item",2),l.Vb()),2&e&&(l.vc("ngIf",t.item),l.Cb(1),l.vc("@show",t.show_children?"show":"hide"),l.Cb(1),l.vc("ngForOf",t.item.items))},directives:[a.t,a.s,jt.a,M.b,j.c,Vt.a,r.r,r.u,x.a,Et],pipes:[a.d],styles:[".catering-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem}.catering-item[disabled=true][_ngcontent-%COMP%]{pointer-events:none;opacity:.35;background-color:rgba(0,0,0,.2)}.subitem[_ngcontent-%COMP%]{border-top:1px solid #ccc}.name[_ngcontent-%COMP%]{max-width:480px}.image[_ngcontent-%COMP%]{height:3em;width:3em;min-width:3em;border-radius:4px;background-color:rgba(0,0,0,.05);background-position:50%;background-size:cover;border:1px solid rgba(0,0,0,.05)}.details[_ngcontent-%COMP%]{flex:1;min-width:25%;padding:0 .5em;display:flex;flex-direction:column}.details[_ngcontent-%COMP%]   *[_ngcontent-%COMP%] > {white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.options[_ngcontent-%COMP%]{display:flex;align-items:center}.options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;font-size:.8em;height:1.5em;color:rgba(0,0,0,.85);line-height:1em;padding:0 .25em;text-decoration:underline}.option[_ngcontent-%COMP%]{padding:.25em .5em;border-radius:4px;color:#fff;font-size:.8rem;background-color:#1937ea;margin:.25em .4rem .25em 0;white-space:nowrap}.description[_ngcontent-%COMP%]{font-size:.75em;margin-top:.25em}.children[_ngcontent-%COMP%]{font-size:.9em;background-color:rgba(0,0,0,.05)}"],data:{animation:[K.a]}}),Et);function Gt(e,t){if(1&e&&l.Rb(0,"a-catering-order-item",9),2&e){var n=t.$implicit,a=l.pc();l.vc("field",a.item_field)("subitem",!0)("item",n)("symbol",a.symbol)}}Rt=$localize(_templateObject32()),qt=$localize(_templateObject33());var Qt,Ut,Yt=function(){return{class:"material-icons",content:"close"}},Xt=((Qt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,i){var r;return _classCallCheck(this,n),(r=t.call(this))._service=e,r._dialog_ref=a,r._data=i,r.event=new l.n,r.item_list=[],r}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this._data.form.controls.items&&this.subscription("item_list",this._data.form.controls.items.valueChanges.subscribe((function(t){(!t||t.length<=0)&&e._dialog_ref.close()}))),this.item_list=(this._data.form&&this._data.form.controls.items?this._data.form.controls.items.value:[]).map((function(e){return new lt.a(e)}))}},{key:"space",get:function(){return this._data.form&&this._data.form.controls.space?this._data.form.controls.space.value:{}}},{key:"delivery_time",get:function(){return w(this._data.date).format("h:mm A")}},{key:"item_field",get:function(){return this._data.form?this._data.form.controls.items:null}},{key:"order_cost",get:function(){return this.item_list.reduce((function(e,t){return e+t.amount*t.unit_price}),0)}},{key:"symbol",get:function(){var e=this;if(!this.space||!this.space.level)return"USD";var t=this._service.Organisation.buildings.find((function(t){return t.id===e.space.level.building_id}));return t?t.currency:"USD"}}]),n}(s.a)).\u0275fac=function(e){return new(e||Qt)(l.Qb(c.a),l.Qb(C.h),l.Qb(C.a))},Qt.\u0275cmp=l.Kb({type:Qt,selectors:[["a-catering-confirm-modal"]],outputs:{event:"event"},features:[l.zb],decls:26,vars:9,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"details"],[1,"list"],[3,"field","subitem","item","symbol",4,"ngFor","ngForOf"],[1,"total"],[1,"value"],["mat-button","",3,"tapped"],[3,"field","subitem","item","symbol"]],template:function(e,t){1&e&&(l.Wb(0,"header"),l.Wb(1,"div",0),l.ac(2,Rt),l.Vb(),l.Wb(3,"button",1),l.Rb(4,"app-icon",2),l.Vb(),l.Vb(),l.Wb(5,"mat-dialog-content"),l.Wb(6,"main"),l.Wb(7,"div",3),l.Nc(8," Delivering to "),l.Wb(9,"span"),l.Nc(10),l.Vb(),l.Nc(11," at "),l.Wb(12,"span"),l.Nc(13),l.Vb(),l.Vb(),l.Wb(14,"div",4),l.Lc(15,Gt,1,4,"a-catering-order-item",5),l.Vb(),l.Wb(16,"div",6),l.Wb(17,"label"),l.Nc(18,"Order Total:"),l.Vb(),l.Wb(19,"div",7),l.Nc(20),l.qc(21,"currency"),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Wb(22,"mat-dialog-actions"),l.Wb(23,"footer"),l.Wb(24,"button",8),l.lc("tapped",(function(){return t.event.emit({reason:"done"})})),l.ac(25,qt),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Cb(4),l.vc("icon",l.wc(8,Yt)),l.Cb(6),l.Oc(t.space.name||"<Unset>"),l.Cb(3),l.Oc(t.delivery_time),l.Cb(2),l.vc("ngForOf",t.item_list),l.Cb(5),l.Oc(l.sc(21,5,t.order_cost/100,t.symbol)))},directives:[M.b,C.d,x.a,C.f,a.s,C.c,j.c,Bt],pipes:[a.d],styles:[".heading[_ngcontent-%COMP%]{flex:1}.details[_ngcontent-%COMP%]{padding:1em;text-align:center}.details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:400}.list[_ngcontent-%COMP%]{height:50vh;overflow:auto}.total[_ngcontent-%COMP%]{border-top:1px solid #ccc;display:flex;align-items:center;justify-content:flex-end;padding:.5em 1em}.total[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.8em;font-weight:500;margin-right:1.5em}mat-dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #ccc}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),Qt),Ht=function(e,t){return(n=(t={exports:{}}).exports).isLeapYear=function(e){return e%4==0&&e%100!=0||e%400==0},n.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.valueOf())},n.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},n.zeroPad=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n="0";return(e+="").length>=t?e:new Array(t-e.length+1).join(n)+e},n.titleCase=function(e){return e?e[0].toUpperCase()+e.substr(1):""},n.ordinal=function(e){var t=e%10,n=e%100;return 1===t&&11!==n?e+"st":2===t&&12!==n?e+"nd":3===t&&13!==n?e+"rd":e+"th"},n.toCardinal=function(e){return e=(e=String(e)).replace(/([0-9])(st|nd|rd|th)$/i,"$1"),parseInt(e,10)},n.normalize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"day"===(e=(e=(e=(e=e.toLowerCase().trim()).replace(/ies$/,"y")).replace(/s$/,"")).replace(/-/g,""))?"date":e},n.getEpoch=function(e){return"number"==typeof e?e:n.isDate(e)?e.getTime():e.epoch?e.epoch:null},n.beADate=function(e,t){return!1===n.isObject(e)?t.clone().set(e):e},n.formatTimezone=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=Math.abs(e),i=e>0?"+":"-";return"".concat(i).concat(n.zeroPad(a)).concat(t,"00")},t.exports;var n}(),Kt=Ht.zeroPad,Zt=function(e,t,n,a){var i=new Date(e),r=(i.getTimezoneOffset()||0)+60*a;r=60*r*1e3;var o=function(e){return Kt(e.getMonth()+1)+"/"+Kt(e.getDate())+":"+Kt(e.getHours())}(i=new Date(e+r));return o>=t&&o<n},Jt=function(e){var t=e.timezones[e.tz];if(void 0===t)return console.warn("Warning: couldn't find timezone "+e.tz),0;if(void 0===t.dst)return t.offset;var n=t.offset,a=t.offset+1;"n"===t.hem&&(a=n-1);var i=t.dst.split("->");return!0===Zt(e.epoch,i[0],i[1],n)?n:a},en=["africa","america","asia","atlantic","australia","brazil","canada","chile","europe","indian","mexico","pacific","antarctica","etc"],tn=(Ut=Object.freeze({__proto__:null,default:{"9|s":"2/dili,2/jayapura","9|n":"2/chita,2/khandyga,2/pyongyang,2/seoul,2/tokyo,11/palau","9.5|s|04/05:03->10/04:02":"4/adelaide,4/broken_hill,4/south,4/yancowinna","9.5|s":"4/darwin,4/north","8|s":"12/casey,2/kuala_lumpur,2/makassar,2/singapore,4/perth,4/west","8|n|03/25:03->09/29:23":"2/ulan_bator","8|n":"2/brunei,2/choibalsan,2/chongqing,2/chungking,2/harbin,2/hong_kong,2/irkutsk,2/kuching,2/macao,2/macau,2/manila,2/shanghai,2/taipei,2/ujung_pandang,2/ulaanbaatar","8.75|s":"4/eucla","7|s":"12/davis,2/jakarta,9/christmas","7|n":"2/bangkok,2/barnaul,2/ho_chi_minh,2/hovd,2/krasnoyarsk,2/novokuznetsk,2/novosibirsk,2/phnom_penh,2/pontianak,2/saigon,2/tomsk,2/vientiane","6|s":"12/vostok","6|n":"2/almaty,2/bishkek,2/dacca,2/dhaka,2/kashgar,2/omsk,2/qyzylorda,2/thimbu,2/thimphu,2/urumqi,9/chagos","6.5|n":"2/rangoon,2/yangon,9/cocos","5|s":"12/mawson,9/kerguelen","5|n":"2/aqtau,2/aqtobe,2/ashgabat,2/ashkhabad,2/atyrau,2/baku,2/dushanbe,2/karachi,2/oral,2/samarkand,2/tashkent,2/yekaterinburg,9/maldives","5.75|n":"2/kathmandu,2/katmandu","5.5|n":"2/calcutta,2/colombo,2/kolkata","4|s":"9/reunion","4|n":"2/dubai,2/muscat,2/tbilisi,2/yerevan,8/astrakhan,8/samara,8/saratov,8/ulyanovsk,8/volgograd,2/volgograd,9/mahe,9/mauritius","4.5|n|03/21:00->09/20:24":"2/tehran","4.5|n":"2/kabul","3|s":"12/syowa,9/antananarivo","3|n|03/29:03->10/25:04":"2/famagusta,2/nicosia,8/athens,8/bucharest,8/helsinki,8/kiev,8/mariehamn,8/nicosia,8/riga,8/sofia,8/tallinn,8/uzhgorod,8/vilnius,8/zaporozhye","3|n|03/29:02->10/25:03":"8/chisinau,8/tiraspol","3|n|03/29:00->10/24:24":"2/beirut","3|n|03/27:02->10/25:02":"2/jerusalem,2/tel_aviv","3|n|03/27:00->10/31:01":"2/gaza,2/hebron","3|n|03/27:00->10/30:01":"2/amman","3|n|03/27:00->10/29:24":"2/damascus","3|n":"0/addis_ababa,0/asmara,0/asmera,0/dar_es_salaam,0/djibouti,0/juba,0/kampala,0/mogadishu,0/nairobi,2/aden,2/baghdad,2/bahrain,2/istanbul,2/kuwait,2/qatar,2/riyadh,8/istanbul,8/kirov,8/minsk,8/moscow,8/simferopol,9/comoro,9/mayotte","2|s|03/29:02->10/25:02":"12/troll","2|s":"0/gaborone,0/harare,0/johannesburg,0/lubumbashi,0/lusaka,0/maputo,0/maseru,0/mbabane","2|n|03/29:02->10/25:03":"0/ceuta,arctic/longyearbyen,3/jan_mayen,8/amsterdam,8/andorra,8/belgrade,8/berlin,8/bratislava,8/brussels,8/budapest,8/busingen,8/copenhagen,8/gibraltar,8/ljubljana,8/luxembourg,8/madrid,8/malta,8/monaco,8/oslo,8/paris,8/podgorica,8/prague,8/rome,8/san_marino,8/sarajevo,8/skopje,8/stockholm,8/tirane,8/vaduz,8/vatican,8/vienna,8/warsaw,8/zagreb,8/zurich","2|n":"0/blantyre,0/bujumbura,0/cairo,0/khartoum,0/kigali,0/tripoli,8/kaliningrad","1|s|04/02:01->09/03:03":"0/windhoek","1|s":"0/kinshasa,0/luanda","1|n|04/19:03->05/24:02":"0/casablanca,0/el_aaiun","1|n|03/29:01->10/25:02":"3/canary,3/faeroe,3/faroe,3/madeira,8/belfast,8/dublin,8/guernsey,8/isle_of_man,8/jersey,8/lisbon,8/london","1|n":"0/algiers,0/bangui,0/brazzaville,0/douala,0/lagos,0/libreville,0/malabo,0/ndjamena,0/niamey,0/porto-novo,0/tunis","14|n":"11/kiritimati","13|s|04/05:04->09/27:03":"11/apia","13|s|01/15:02->11/05:03":"11/tongatapu","13|n":"11/enderbury,11/fakaofo","12|s|04/05:03->09/27:02":"12/mcmurdo,12/south_pole,11/auckland","12|s|01/12:03->11/08:02":"11/fiji","12|n":"2/anadyr,2/kamchatka,2/srednekolymsk,11/funafuti,11/kwajalein,11/majuro,11/nauru,11/tarawa,11/wake,11/wallis","12.75|s|04/05:03->04/05:02":"11/chatham","11|s":"12/macquarie,11/bougainville","11|n":"2/magadan,2/sakhalin,11/efate,11/guadalcanal,11/kosrae,11/noumea,11/pohnpei,11/ponape","11.5|n|04/05:03->10/04:02":"11/norfolk","10|s|04/05:03->10/04:02":"4/act,4/canberra,4/currie,4/hobart,4/melbourne,4/nsw,4/sydney,4/tasmania,4/victoria","10|s":"12/dumontdurville,4/brisbane,4/lindeman,4/queensland","10|n":"2/ust-nera,2/vladivostok,2/yakutsk,11/chuuk,11/guam,11/port_moresby,11/saipan,11/truk,11/yap","10.5|s|04/05:01->10/04:02":"4/lhi,4/lord_howe","0|n|03/29:00->10/25:01":"1/scoresbysund,3/azores","0|n":"0/abidjan,0/accra,0/bamako,0/banjul,0/bissau,0/conakry,0/dakar,0/freetown,0/lome,0/monrovia,0/nouakchott,0/ouagadougou,0/sao_tome,0/timbuktu,1/danmarkshavn,3/reykjavik,3/st_helena,13/gmt,13/gmt+0,13/gmt-0,13/gmt0,13/greenwich,13/utc,13/universal,13/zulu","-9|n|03/08:02->11/01:02":"1/adak,1/atka","-9|n":"11/gambier","-9.5|n":"11/marquesas","-8|n|03/08:02->11/01:02":"1/anchorage,1/juneau,1/metlakatla,1/nome,1/sitka,1/yakutat","-8|n":"11/pitcairn","-7|n|03/08:02->11/01:02":"1/dawson,1/ensenada,1/los_angeles,1/santa_isabel,1/tijuana,1/vancouver,1/whitehorse,6/pacific,6/yukon,10/bajanorte","-7|n":"1/creston,1/dawson_creek,1/hermosillo,1/phoenix","-6|s|04/04:22->09/05:22":"7/easterisland,11/easter","-6|n|04/05:02->10/25:02":"1/chihuahua,1/mazatlan,10/bajasur","-6|n|03/08:02->11/01:02":"1/boise,1/cambridge_bay,1/denver,1/edmonton,1/inuvik,1/ojinaga,1/shiprock,1/yellowknife,6/mountain","-6|n":"1/belize,1/costa_rica,1/el_salvador,1/guatemala,1/managua,1/regina,1/swift_current,1/tegucigalpa,6/east-saskatchewan,6/saskatchewan,11/galapagos","-5|s":"1/lima,1/rio_branco,5/acre","-5|n|04/05:02->10/25:02":"1/bahia_banderas,1/merida,1/mexico_city,1/monterrey,10/general","-5|n|03/12:03->11/05:01":"1/north_dakota","-5|n|03/08:02->11/01:02":"1/chicago,1/knox_in,1/matamoros,1/menominee,1/rainy_river,1/rankin_inlet,1/resolute,1/winnipeg,6/central","-5|n":"1/atikokan,1/bogota,1/cancun,1/cayman,1/coral_harbour,1/eirunepe,1/guayaquil,1/jamaica,1/panama,1/porto_acre","-4|s|05/13:23->08/13:01":"12/palmer","-4|s|04/04:24->09/06:00":"1/santiago,7/continental","-4|s|03/21:24->10/04:00":"1/asuncion","-4|s|02/16:24->11/03:00":"1/campo_grande,1/cuiaba","-4|s":"1/la_paz,1/manaus,5/west","-4|n|03/12:03->11/05:01":"1/indiana,1/kentucky","-4|n|03/08:02->11/01:02":"1/detroit,1/fort_wayne,1/grand_turk,1/indianapolis,1/iqaluit,1/louisville,1/montreal,1/nassau,1/new_york,1/nipigon,1/pangnirtung,1/port-au-prince,1/thunder_bay,1/toronto,6/eastern","-4|n|03/08:00->11/01:01":"1/havana","-4|n":"1/anguilla,1/antigua,1/aruba,1/barbados,1/blanc-sablon,1/boa_vista,1/caracas,1/curacao,1/dominica,1/grenada,1/guadeloupe,1/guyana,1/kralendijk,1/lower_princes,1/marigot,1/martinique,1/montserrat,1/port_of_spain,1/porto_velho,1/puerto_rico,1/santo_domingo,1/st_barthelemy,1/st_kitts,1/st_lucia,1/st_thomas,1/st_vincent,1/tortola,1/virgin","-3|s":"1/argentina,1/buenos_aires,1/cordoba,1/fortaleza,1/montevideo,1/punta_arenas,1/sao_paulo,12/rothera,3/stanley,5/east","-3|n|03/08:02->11/01:02":"1/glace_bay,1/goose_bay,1/halifax,1/moncton,1/thule,3/bermuda,6/atlantic","-3|n":"1/araguaina,1/bahia,1/belem,1/catamarca,1/cayenne,1/jujuy,1/maceio,1/mendoza,1/paramaribo,1/recife,1/rosario,1/santarem","-2|s":"5/denoronha","-2|n|03/28:22->10/24:23":"1/godthab","-2|n|03/08:02->11/01:02":"1/miquelon","-2|n":"1/noronha,3/south_georgia","-2.5|n|03/08:02->11/01:02":"1/st_johns,6/newfoundland","-1|n":"3/cape_verde","-11|n":"11/midway,11/niue,11/pago_pago,11/samoa","-10|n":"11/honolulu,11/johnston,11/rarotonga,11/tahiti"}}))&&Ut.default||Ut,nn={};Object.keys(tn).forEach((function(e){var t=e.split("|"),n={offset:Number(t[0]),hem:t[1]};t[2]&&(n.dst=t[2]),tn[e].split(",").forEach((function(e){e=e.replace(/(^[0-9]+)\//,(function(e,t){return t=Number(t),en[t]+"/"})),nn[e]=n}))})),nn.utc={offset:0,hem:"n"};for(var an=-14;an<=14;an+=.5){var rn=an;rn>0&&(rn="+"+rn);var on="etc/gmt"+rn;nn[on]={offset:-1*an,hem:"n"},nn[on="utc/gmt"+rn]={offset:-1*an,hem:"n"}}var cn,sn=nn,ln=/(\-?[0-9]+)h(rs)?/i,un=/(\-?[0-9]+)/,dn=/utc([\-+]?[0-9]+)/i,fn=/gmt([\-+]?[0-9]+)/i,mn=function(e){return(e=Number(e))>-13&&e<13?"etc/gmt"+(e=((e*=-1)>0?"+":"")+e):null},bn=null===(cn=function(){if("undefined"==typeof Intl||void 0===Intl.DateTimeFormat)return null;var e=Intl.DateTimeFormat();if(void 0===e||void 0===e.resolvedOptions)return null;var t=e.resolvedOptions().timeZone;return t?t.toLowerCase():null}())?"utc":cn,pn=Object.keys(sn).reduce((function(e,t){var n=t.split("/")[1]||"";return e[n=n.replace(/_/g," ")]=t,e}),{}),hn=function(e,t){if(!e)return bn;var n=e.trim(),a=e.split("/");if(a.length>2&&!1===t.hasOwnProperty(n)&&(n=a[0]+"/"+a[1]),n=n.toLowerCase(),!0===t.hasOwnProperty(n))return n;if(n=function(e){return(e=(e=(e=(e=(e=e.replace(/ time/g,"")).replace(/ (standard|daylight|summer)/g,"")).replace(/\b(east|west|north|south)ern/g,"$1")).replace(/\b(africa|america|australia)n/g,"$1")).replace(/\beuropean/g,"europe")).replace(/\islands/g,"island")}(n),!0===t.hasOwnProperty(n))return n;if(!0===pn.hasOwnProperty(n))return pn[n];if(!0===/[0-9]/.test(n)){var i=function(e){var t=e.match(ln);if(null!==t)return mn(t[1]);if(null!==(t=e.match(dn)))return mn(t[1]);if(null!==(t=e.match(fn))){var n=-1*Number(t[1]);return mn(n)}return null!==(t=e.match(un))?mn(t[1]):null}(n);if(i)return i}throw new Error("Spacetime: Cannot find timezone named: '"+e+"'. Please enter an IANA timezone id.")},gn={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5};gn.date=gn.day,gn.month=25488e5,gn.week=6048e5,gn.year=3154e7,Object.keys(gn).forEach((function(e){gn[e+"s"]=gn[e]}));var vn=gn,_n=function(e,t,n,a,i){var r=e.d[n]();if(r!==t){var o=null===i?null:e.d[i](),c=e.epoch,s=t-r;e.epoch+=vn[a]*s,"day"===a&&Math.abs(s)>28&&t<28&&(e.epoch+=vn.hour);for(var l=vn[a]/2;e.d[n]()<t;)e.epoch+=l;for(;e.d[n]()>t;)e.epoch-=l;null!==i&&o!==e.d[i]()&&(e.epoch=c,e.epoch+=vn[a]*s*.89)}},yn={year:{valid:function(e){return e>-4e3&&e<4e3},walkTo:function(e,t){return _n(e,t,"getFullYear","year",null)}},month:{valid:function(e){return e>=0&&e<=11},walkTo:function(e,t){var n=e.d,a=n.getMonth(),i=e.epoch,r=n.getFullYear();if(a!==t){for(e.epoch+=vn.day*(28*(t-a)),r!==e.d.getFullYear()&&(e.epoch=i);e.d.getMonth()<t;)e.epoch+=vn.day;for(;e.d.getMonth()>t;)e.epoch-=vn.day}}},date:{valid:function(e){return e>0&&e<=31},walkTo:function(e,t){return _n(e,t,"getDate","day","getMonth")}},hour:{valid:function(e){return e>=0&&e<24},walkTo:function(e,t){return _n(e,t,"getHours","hour","getDate")}},minute:{valid:function(e){return e>=0&&e<60},walkTo:function(e,t){return _n(e,t,"getMinutes","minute","getHours")}},second:{valid:function(e){return e>=0&&e<60},walkTo:function(e,t){e.epoch=e.seconds(t).epoch}},millisecond:{valid:function(e){return e>=0&&e<1e3},walkTo:function(e,t){e.epoch=e.milliseconds(t).epoch}}},On=function(e,t){for(var n=Object.keys(yn),a=e.clone(),i=0;i<n.length;i++){var r=n[i],o=t[r];if(void 0===o&&(o=a[r]()),"string"==typeof o&&(o=parseInt(o,10)),!yn[r].valid(o))return e.epoch=null,void(!1===e.silent&&console.warn("invalid "+r+": "+o));yn[r].walkTo(e,o)}},Cn=["jan","feb","mar","apr","may","jun","jul","aug","sept","oct","nov","dec"],kn=["january","february","march","april","may","june","july","august","september","october","november","december"],wn=function(){return Cn},Pn=function(){return function(){for(var e={sep:8},t=0;t<Cn.length;t++)e[Cn[t]]=t;for(var n=0;n<kn.length;n++)e[kn[n]]=n;return e}()},Mn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=(t=t.replace(/^\s+/,"").toLowerCase()).match(/([0-9]{1,2}):([0-9]{1,2}):?([0-9]{1,2})?[:\.]?([0-9]{1,4})?/);if(null!==n){var a=Number(n[1]);if(a<0||a>24)return e.startOf("day");var i=Number(n[2]);if(n[2].length<2||i<0||i>59)return e.startOf("day");e=(e=(e=(e=e.hour(a)).minute(i)).seconds(n[3]||0)).millisecond(n[4]||0);var r=t.match(/[\b0-9](am|pm)\b/);return null!==r&&r[1]&&(e=e.ampm(r[1])),e}if(null!==(n=t.match(/([0-9]+) ?(am|pm)/))&&n[1]){var o=Number(n[1]);return o>12||o<1?e.startOf("day"):e=(e=(e=e.hour(n[1]||0)).ampm(n[2])).startOf("hour")}return e.startOf("day")},xn=[31,28,31,30,31,30,31,31,30,31,30,31],jn=Ht.isLeapYear,Vn=function(e){return!0===xn.hasOwnProperty(e.month)&&(1===e.month?!!(jn(e.year)&&e.date<=29)||e.date<=28:e.date<=(xn[e.month]||0))},Wn=Pn(),zn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=parseInt(e.trim(),10);return t||(new Date).getFullYear()},In=[{reg:/^(\-?0?0?[0-9]{3,4})-([0-9]{1,2})-([0-9]{1,2})[T| ]([0-9.:]+)(Z|[0-9\-\+:]+)?$/,parse:function(e,t,n,a){var i=parseInt(t[2],10)-1,r={year:t[1],month:i,date:t[3]};return!1===Vn(r)?(e.epoch=null,e):(function(e,t){if(!t)return e;"Z"===t&&(t="+0000");var n=0;/^[\+-]?[0-9]{2}:[0-9]{2}$/.test(t)&&(!0===/:00/.test(t)&&(t=t.replace(/:00/,"")),!0===/:30/.test(t)&&(t=t.replace(/:30/,".5"))),/^[\+-]?[0-9]{4}$/.test(t)&&(t=t.replace(/30$/,".5")),n=parseFloat(t),Math.abs(n)>100&&(n/=100),(n*=-1)>=0&&(n="+"+n);var a="etc/gmt"+n;e.timezones[a]&&(e.tz=a)}(e,t[5]),On(e,r),e=Mn(e,t[4]))}},{reg:/^([0-9]{4})[\-\/]([0-9]{1,2})[\-\/]([0-9]{1,2}),?( [0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(e,t){var n={year:t[1],month:parseInt(t[2],10)-1,date:parseInt(t[3],10)};return n.month>=12&&(n.date=parseInt(t[2],10),n.month=parseInt(t[3],10)-1),!1===Vn(n)?(e.epoch=null,e):(On(e,n),e=Mn(e,t[4]))}},{reg:/^([0-9]{1,2})[\-\/]([0-9]{1,2})[\-\/]?([0-9]{4})?,?( [0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(e,t){var n=parseInt(t[1],10)-1,a=parseInt(t[2],10);(e.british||n>=12)&&(a=parseInt(t[1],10),n=parseInt(t[2],10)-1);var i={year:t[3]||(new Date).getFullYear(),month:n,date:a};return!1===Vn(i)?(e.epoch=null,e):(On(e,i),e=Mn(e,t[4]))}},{reg:/^([0-9]{1,2})[\-\/]([a-z]+)[\-\/]?([0-9]{4})?$/i,parse:function(e,t){var n=Wn[t[2].toLowerCase()],a={year:zn(t[3]),month:n,date:Ht.toCardinal(t[1]||"")};return!1===Vn(a)?(e.epoch=null,e):(On(e,a),e=Mn(e,t[4]))}},{reg:/^([a-z]+) ([0-9]{1,2}(?:st|nd|rd|th)?),?( [0-9]{4})?( ([0-9:]+( ?am| ?pm| ?gmt)?))?$/i,parse:function(e,t){var n=Wn[t[1].toLowerCase()],a={year:zn(t[3]),month:n,date:Ht.toCardinal(t[2]||"")};return!1===Vn(a)?(e.epoch=null,e):(On(e,a),e=Mn(e,t[4]))}},{reg:/^([a-z]+) ([0-9]{4})$/i,parse:function(e,t){var n=Wn[t[1].toLowerCase()],a={year:zn(t[2]),month:n,date:1};return!1===Vn(a)?(e.epoch=null,e):(On(e,a),e=Mn(e,t[4]))}},{reg:/^([0-9]{1,2}(?:st|nd|rd|th)?) ([a-z]+),?( [0-9]{4})?,? ?([0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(e,t){var n=Wn[t[2].toLowerCase()];if(!n)return null;var a={year:zn(t[3]),month:n,date:Ht.toCardinal(t[1])};return!1===Vn(a)?(e.epoch=null,e):(On(e,a),e=Mn(e,t[4]))}},{reg:/^[0-9,]+ ?b\.?c\.?$/i,parse:function(e,t){var n=t[0]||"";n=(n=n.replace(/^([0-9,]+) ?b\.?c\.?$/i,"-$1")).replace(/,/g,"");var a=parseInt(n.trim(),10),i=new Date,r={year:a,month:i.getMonth(),date:i.getDate()};return!1===Vn(r)?(e.epoch=null,e):(On(e,r),e=Mn(e))}},{reg:/^[0-9,]+ ?(a\.?d\.?|c\.?e\.?)$/i,parse:function(e,t){var n=t[0]||"";n=n.replace(/,/g,"");var a=parseInt(n.trim(),10),i=new Date,r={year:a,month:i.getMonth(),date:i.getDate()};return!1===Vn(r)?(e.epoch=null,e):(On(e,r),e=Mn(e))}},{reg:/^[0-9]{4}( ?a\.?d\.?)?$/i,parse:function(e,t){var n=zn(t[0]),a=new Date,i={year:n,month:a.getMonth(),date:a.getDate()};return!1===Vn(i)?(e.epoch=null,e):(On(e,i),e=Mn(e))}}],Ln={now:function(e){return e.epoch=Date.now(),e},tonight:function(e){return e.epoch=Date.now(),e.hour(18)},today:function(e){return e.epoch=Date.now(),e},tomorrow:function(e){return e.epoch=Date.now(),(e=e.add(1,"day")).startOf("day")},yesterday:function(e){return e.epoch=Date.now(),(e=e.subtract(1,"day")).startOf("day")},christmas:function(e){var t=(new Date).getFullYear();return e.set([t,11,25,18,0,0])},"new years":function(e){var t=(new Date).getFullYear();return e.set([t,11,31,18,0,0])}};Ln["new years eve"]=Ln["new years"];var Tn=Ln,Sn={year:(new Date).getFullYear(),month:0,date:1},Dn=function(e,t,n){if("number"==typeof t)return t>0&&t<25e8&&!1===e.silent&&(console.warn("  - Warning: You are setting the date to January 1970."),console.warn("       -   did input seconds instead of milliseconds?")),e.epoch=t,e;if(e.epoch=Date.now(),null==t)return e;if(!0===Ht.isDate(t))return e.epoch=t.getTime(),e;if(!0===Ht.isArray(t))return function(e,t){for(var n=["year","month","date","hour","minute","second","millisecond"],a=0;a<n.length;a++)e=e[n[a]](t[a]||Sn[n[a]]||0);return e}(e,t);if(!0===Ht.isObject(t))return t.epoch?(e.epoch=t.epoch,e.tz=t.tz,e):e=function(e,t){t=Object.assign({},Sn,t);for(var n=Object.keys(t),a=0;a<n.length;a++){var i=n[a];void 0!==e[i]&&"function"==typeof e[i]&&null!=t[i]&&""!==t[i]&&(e=e[i](t[i]||Sn[i]||0))}return e}(e,t);if("string"!=typeof t)return e;if(t=(t=(t=t.replace(/\b(mon|tues|wed|wednes|thu|thurs|fri|sat|satur|sun)(day)?\b/i,"")).replace(/,/g,"")).replace(/ +/g," ").trim(),!0===Tn.hasOwnProperty(t))return Tn[t](e);for(var a=0;a<In.length;a++){var i=t.match(In[a].reg);if(i){var r=In[a].parse(e,i,n);if(null!==r)return r}}return!1===e.silent&&console.warn("Warning: couldn't parse date-string: '"+t+"'"),e.epoch=null,e},An=["sun","mon","tue","wed","thu","fri","sat"],Nn=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],$n=function(){return An},Fn=function(){return Nn},En=function(e){var t=e.timezone().current.offset,n=t<0,a="00";return.5===Math.abs(t%1)&&(a="30",t=t>=0?Math.floor(t):Math.ceil(t)),"+00:00"==(t=(t=n?"-"+(t=Ht.zeroPad(t*=-1,2)):"+"+(t=Ht.zeroPad(t,2)))+":"+a)&&(t="Z"),t},Rn={day:function(e){return Ht.titleCase(e.dayName())},"day-short":function(e){return Ht.titleCase($n()[e.day()])},"day-number":function(e){return e.day()},"day-ordinal":function(e){return Ht.ordinal(e.day())},"day-pad":function(e){return Ht.zeroPad(e.day())},date:function(e){return e.date()},"date-ordinal":function(e){return Ht.ordinal(e.date())},"date-pad":function(e){return Ht.zeroPad(e.date())},month:function(e){return Ht.titleCase(e.monthName())},"month-short":function(e){return Ht.titleCase(wn()[e.month()])},"month-number":function(e){return e.month()},"month-ordinal":function(e){return Ht.ordinal(e.month())},"month-pad":function(e){return Ht.zeroPad(e.month())},"iso-month":function(e){return Ht.zeroPad(e.month()+1)},year:function(e){var t=e.year();return t>0?t:(t=Math.abs(t))+" BC"},"year-short":function(e){var t=e.year();return t>0?"'".concat(String(e.year()).substr(2,4)):(t=Math.abs(t))+" BC"},"iso-year":function(e){var t=e.year(),n=t<0,a=Ht.zeroPad(Math.abs(t),4);return n&&(a="-"+(a=Ht.zeroPad(a,6))),a},time:function(e){return e.time()},"time-24":function(e){return"".concat(e.hour24(),":").concat(Ht.zeroPad(e.minute()))},hour:function(e){return e.hour12()},"hour-pad":function(e){return Ht.zeroPad(e.hour12())},"hour-24":function(e){return e.hour24()},"hour-24-pad":function(e){return Ht.zeroPad(e.hour24())},minute:function(e){return e.minute()},"minute-pad":function(e){return Ht.zeroPad(e.minute())},second:function(e){return e.second()},"second-pad":function(e){return Ht.zeroPad(e.second())},ampm:function(e){return e.ampm()},quarter:function(e){return"Q"+e.quarter()},season:function(e){return e.season()},era:function(e){return e.era()},json:function(e){return e.json()},timezone:function(e){return e.timezone().name},offset:function(e){return En(e)},numeric:function(e){return"".concat(e.year(),"/").concat(Ht.zeroPad(e.month()+1),"/").concat(Ht.zeroPad(e.date()))},"numeric-us":function(e){return"".concat(Ht.zeroPad(e.month()+1),"/").concat(Ht.zeroPad(e.date()),"/").concat(e.year())},"numeric-uk":function(e){return"".concat(Ht.zeroPad(e.date()),"/").concat(Ht.zeroPad(e.month()+1),"/").concat(e.year())},"mm/dd":function(e){return"".concat(Ht.zeroPad(e.month()+1),"/").concat(Ht.zeroPad(e.date()))},iso:function(e){var t=e.format("iso-year"),n=Ht.zeroPad(e.month()+1),a=Ht.zeroPad(e.date()),i=Ht.zeroPad(e.h24()),r=Ht.zeroPad(e.minute()),o=Ht.zeroPad(e.second()),c=Ht.zeroPad(e.millisecond(),3),s=En(e);return"".concat(t,"-").concat(n,"-").concat(a,"T").concat(i,":").concat(r,":").concat(o,".").concat(c).concat(s)},"iso-short":function(e){var t=Ht.zeroPad(e.month()+1),n=Ht.zeroPad(e.date());return"".concat(e.year(),"-").concat(t,"-").concat(n)},"iso-utc":function(e){return new Date(e.epoch).toISOString()},nice:function(e){return"".concat(wn()[e.month()]," ").concat(Ht.ordinal(e.date()),", ").concat(e.time())},"nice-year":function(e){return"".concat(wn()[e.month()]," ").concat(Ht.ordinal(e.date()),", ").concat(e.year())},"nice-day":function(e){return"".concat($n()[e.day()]," ").concat(Ht.titleCase(wn()[e.month()])," ").concat(Ht.ordinal(e.date()))},"nice-full":function(e){return"".concat(e.dayName()," ").concat(Ht.titleCase(e.monthName())," ").concat(Ht.ordinal(e.date()),", ").concat(e.time())}},qn={"day-name":"day","month-name":"month","iso 8601":"iso","time-h24":"time-24","time-12":"time","time-h12":"time",tz:"timezone","day-num":"day-number","month-num":"month-number","month-iso":"iso-month","year-iso":"iso-year","nice-short":"nice",mdy:"numeric-us",dmy:"numeric-uk",ymd:"numeric","yyyy/mm/dd":"numeric","mm/dd/yyyy":"numeric-us","dd/mm/yyyy":"numeric-us","little-endian":"numeric-uk","big-endian":"numeric","day-nice":"nice-day"};Object.keys(qn).forEach((function(e){return Rn[e]=Rn[qn[e]]}));var Bn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!0!==e.isValid())return"";if(Rn.hasOwnProperty(t)){var n=Rn[t](e)||"";return"json"!==t&&(n=String(n),"ampm"!==t&&(n=Ht.titleCase(n))),n}if(-1!==t.indexOf("{")){var a=/\{(.+?)\}/g;return t.replace(a,(function(t,n){return n=n.toLowerCase().trim(),Rn.hasOwnProperty(n)?String(Rn[n](e)||""):""}))}return e.format("iso-short")},Gn=Ht.zeroPad,Qn=Ht.formatTimezone,Un={G:function(e){return e.era()},GG:function(e){return e.era()},GGG:function(e){return e.era()},GGGG:function(e){return"AD"===e.era()?"Anno Domini":"Before Christ"},y:function(e){return e.year()},yy:function(e){return parseInt(String(e.year()).substr(2,4),10)},yyy:function(e){return e.year()},yyyy:function(e){return e.year()},yyyyy:function(e){return"0"+e.year()},Q:function(e){return e.quarter()},QQ:function(e){return e.quarter()},QQQ:function(e){return e.quarter()},QQQQ:function(e){return e.quarter()},M:function(e){return e.month()+1},MM:function(e){return Gn(e.month()+1)},MMM:function(e){return e.format("month-short")},MMMM:function(e){return e.format("month")},w:function(e){return e.week()},ww:function(e){return Gn(e.week())},d:function(e){return e.date()},dd:function(e){return Gn(e.date())},D:function(e){return e.dayOfYear()},DD:function(e){return Gn(e.dayOfYear())},DDD:function(e){return Gn(e.dayOfYear(),3)},E:function(e){return e.format("day-short")},EE:function(e){return e.format("day-short")},EEE:function(e){return e.format("day-short")},EEEE:function(e){return e.format("day")},EEEEE:function(e){return e.format("day")[0]},e:function(e){return e.day()},ee:function(e){return e.day()},eee:function(e){return e.format("day-short")},eeee:function(e){return e.format("day")},eeeee:function(e){return e.format("day")[0]},a:function(e){return e.ampm().toUpperCase()},aa:function(e){return e.ampm().toUpperCase()},aaa:function(e){return e.ampm().toUpperCase()},aaaa:function(e){return e.ampm().toUpperCase()},h:function(e){return e.h12()},hh:function(e){return Gn(e.h12())},H:function(e){return e.hour()},HH:function(e){return Gn(e.hour())},m:function(e){return e.minute()},mm:function(e){return Gn(e.minute())},s:function(e){return e.second()},ss:function(e){return Gn(e.second())},A:function(e){return e.epoch-e.startOf("day").epoch},z:function(e){return e.timezone().name},zz:function(e){return e.timezone().name},zzz:function(e){return e.timezone().name},zzzz:function(e){return e.timezone().name},Z:function(e){return Qn(e.timezone().current.offset)},ZZ:function(e){return Qn(e.timezone().current.offset)},ZZZ:function(e){return Qn(e.timezone().current.offset)},ZZZZ:function(e){return Qn(e.timezone().current.offset,":")}},Yn=function(e,t,n){for(var a=e,i=t,r=0;r<n;r+=1)Un[a]=Un[i],a+=e,i+=t};Yn("q","Q",4),Yn("L","M",4),Yn("Y","y",4),Yn("c","e",4),Yn("k","H",2),Yn("K","h",2),Yn("S","s",2),Yn("v","z",4),Yn("V","Z",4);var Xn=["year","season","quarter","month","week","day","quarterHour","hour","minute"],Hn=function(e,t){var n=e.clone().startOf(t),a=e.clone().endOf(t);return parseFloat(((e.epoch-n.epoch)/(a.epoch-n.epoch)).toFixed(2))},Kn=function(e,t,n){var a=0;for(e=e.clone();e.isBefore(t);)e=e.add(1,n),a+=1;return e.isAfter(t,n)&&(a-=1),a},Zn=function(e,t,n){return e.isBefore(t)?Kn(e,t,n):-1*Kn(t,e,n)},Jn={months:{almost:10,over:4},days:{almost:25,over:10},hours:{almost:20,over:8},minutes:{almost:50,over:20},seconds:{almost:50,over:20}};function ea(e,t){return 1===e&&(t=t.slice(0,-1)),e+" "+t}var ta={north:[["spring",2,1],["summer",5,1],["fall",8,1],["autumn",8,1],["winter",11,1]],south:[["fall",2,1],["autumn",2,1],["winter",5,1],["spring",8,1],["summer",11,1]]},na=[null,[0,1],[3,1],[6,1],[9,1]],aa={minute:function(e){return On(e,{second:0,millisecond:0}),e},quarterhour:function(e){var t=e.minutes();return e=e.minutes(t>=45?45:t>=30?30:t>=15?15:0),On(e,{second:0,millisecond:0}),e},hour:function(e){return On(e,{minute:0,second:0,millisecond:0}),e},day:function(e){return On(e,{hour:0,minute:0,second:0,millisecond:0}),e},week:function(e){var t=e.clone();return(e=e.day(e._weekStart)).isAfter(t)&&(e=e.subtract(1,"week")),On(e,{hour:0,minute:0,second:0,millisecond:0}),e},month:function(e){return On(e,{date:1,hour:0,minute:0,second:0,millisecond:0}),e},quarter:function(e){var t=e.quarter();return na[t]&&On(e,{month:na[t][0],date:na[t][1],hour:0,minute:0,second:0,millisecond:0}),e},season:function(e){var t=e.season(),n="north";"South"===e.hemisphere()&&(n="south");for(var a=0;a<ta[n].length;a++)if(ta[n][a][0]===t){var i=e.year();return"winter"===t&&e.month()<3&&(i-=1),On(e,{year:i,month:ta[n][a][1],date:ta[n][a][2],hour:0,minute:0,second:0,millisecond:0}),e}return e},year:function(e){return On(e,{month:0,date:1,hour:0,minute:0,second:0,millisecond:0}),e},decade:function(e){var t=(e=e.startOf("year")).year(),n=10*parseInt(t/10,10);return e.year(n)},century:function(e){var t=(e=e.startOf("year")).year(),n=100*parseInt(t/100,10);return e.year(n)}};aa.date=aa.day;var ia=function(e){return!!$n().find((function(t){return t===e}))||!!Fn().find((function(t){return t===e}))},ra=function(e){var t=e.timezones,n=e.tz;if(!1===t.hasOwnProperty(n)&&(n=hn(e.tz,t)),null===n)return!1===e.silent&&console.warn("Warn: could not find given or local timezone - '"+e.tz+"'"),{current:{epochShift:0}};var a,i,r=t[n],o={name:(a=n,a=(a=(a=a[0].toUpperCase()+a.substr(1)).replace(/\/gmt/,"/GMT")).replace(/[\/_]([a-z])/gi,(function(e){return e.toUpperCase()}))),hasDst:Boolean(r.dst),default_offset:r.offset,hemisphere:"s"===r.hem?"South":"North",current:{}};if(o.hasDst){var c=(i=r.dst)?i.split("->"):[];o.change={start:c[0],back:c[1]}}var s=r.offset,l=s;return!0===o.hasDst&&(l="North"===o.hemisphere?s-1:r.offset+1),!1===o.hasDst?(o.current.offset=s,o.current.isDST=!1):!0===Zt(e.epoch,o.change.start,o.change.back,s)?(o.current.offset=s,o.current.isDST="North"===o.hemisphere):(o.current.offset=l,o.current.isDST="South"===o.hemisphere),o},oa=["century","decade","year","month","date","day","hour","minute","second","millisecond"],ca={set:function(e,t){var n=this.clone();return n=Dn(n,e),t&&(this.tz=hn(t)),n},timezone:function(){return ra(this)},isDST:function(){return ra(this).current.isDST},hasDST:function(){return ra(this).hasDst},offset:function(){return 60*ra(this).current.offset},hemisphere:function(){return ra(this).hemisphere},format:function(e){return Bn(this,e)},unixFmt:function(e){return function(e,t){for(var n=t.split(""),a=[n[0]],i=!1,r=1;r<n.length;r+=1){if("'"===n[r]){if(1!=(i=!i)||!n[r+1]||"'"!==n[r+1])continue;i=!0}!0===i||n[r]===a[a.length-1][0]?a[a.length-1]+=n[r]:a.push(n[r])}return a.reduce((function(t,n){return t+(void 0!==Un[n]?Un[n](e)||"":n)}),"")}(this,e)},startOf:function(e){return function(e,t){var n=e.clone();return t=Ht.normalize(t),aa[t]?aa[t](n):"summer"===t||"winter"===t?(n=n.season(t),aa.season(n)):n}(this,e)},endOf:function(e){return function(e,t){var n=e.clone();return t=Ht.normalize(t),aa[t]?n=(n=(n=aa[t](n)).add(1,t)).subtract(1,"milliseconds"):n}(this,e)},leapYear:function(){var e=this.year();return Ht.isLeapYear(e)},progress:function(e){return function(e,t){if(t)return t=Ht.normalize(t),Hn(e,t);var n={};return Xn.forEach((function(t){n[t]=Hn(e,t)})),n}(this,e)},nearest:function(e){return function(e,t){var n=e.progress();return"quarterhour"===(t=Ht.normalize(t))&&(t="quarterHour"),void 0!==n[t]?(n[t]>.5&&(e=e.add(1,t)),e=e.startOf(t)):!1===e.silent&&console.warn("no known unit '"+t+"'"),e}(this,e)},diff:function(e,t){return function(e,t,n){t=Ht.beADate(t,e);var a=!1;if(e.isAfter(t)){var i=e;e=t,t=i,a=!0}var r=function(e,t){var n=t.epoch-e.epoch,a={milliseconds:n,seconds:parseInt(n/1e3,10)};a.minutes=parseInt(a.seconds/60,10),a.hours=parseInt(a.minutes/60,10);var i=e.clone();return a.years=function(e,t){var n=t.year()-e.year();return(e=e.year(t.year())).isAfter(t)&&(n-=1),n}(i,t),i=e.add(a.years,"year"),a.months=12*a.years,i=e.add(a.months,"month"),a.months+=Zn(i,t,"month"),a.weeks=52*a.years,i=e.add(a.weeks,"week"),a.weeks+=Zn(i,t,"week"),a.days=7*a.weeks,i=e.add(a.days,"day"),a.days+=Zn(i,t,"day"),a}(e,t);return a&&(r=function(e){return Object.keys(e).forEach((function(t){e[t]*=-1})),e}(r)),n?(n=Ht.normalize(n),!0!==/s$/.test(n)&&(n+="s"),"dates"===n&&(n="days"),r[n]):r}(this,e,t)},since:function(e){return e||(e=this.clone().set()),function(e,t){var n,a,i,r=function(e,t){var n=e.isBefore(t),a=n?t:e,i=n?e:t;i=i.clone();var r={years:0,months:0,days:0,hours:0,minutes:0,seconds:0};return Object.keys(r).forEach((function(e){if(!i.isSame(a,e)){var t=i.diff(a,e);i=i.add(t,e),r[e]=t}})),n&&Object.keys(r).forEach((function(e){0!==r[e]&&(r[e]*=-1)})),r}(e,t=Ht.beADate(t,e));if(!0===Object.keys(r).every((function(e){return!r[e]})))return{diff:r,rounded:"now",qualified:"now",precise:"now"};var o=[];return Object.keys(r).forEach((function(e,t,i){var c=Math.abs(r[e]);if(0!==c){var s=ea(c,e);if(o.push(s),!n){if(n=a=s,t>4)return;var l=i[t+1],u=Math.abs(r[l]);u>Jn[l].almost?(n=ea(c+1,e),a="almost "+n):u>Jn[l].over&&(a="over "+s)}}})),i=o.splice(0,2).join(", "),!0===e.isAfter(t)?(n+=" ago",a+=" ago",i+=" ago"):(n="in "+n,a="in "+a,i="in "+i),{diff:r,rounded:n,qualified:a,precise:i}}(this,e)},next:function(e){return this.add(1,e).startOf(e)},last:function(e){return this.subtract(1,e).startOf(e)},isValid:function(){return!(!this.epoch&&0!==this.epoch||isNaN(this.d.getTime()))},goto:function(e){var t=this.clone();return t.tz=hn(e,t.timezones),t},every:function(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;if(!t||!n)return[];if(t=Ht.normalize(t),n=e.clone().set(n),e.isAfter(n)){var a=e;e=n,n=a}var i=e.clone();ia(t)?(i=i.next(t),t="week"):i=i.next(t);for(var r=[];i.isBefore(n);)r.push(i),i=i.add(1,t);return r}(this,e,t)},isAwake:function(){var e=this.hour();return!(e<8||e>22)},isAsleep:function(){return!this.isAwake()},log:function(){return console.log(""),console.log(Bn(this,"nice-short")),this},logYear:function(){return console.log(""),console.log(Bn(this,"full-short")),this},json:function(){var e=this;return oa.reduce((function(t,n){return t[n]=e[n](),t}),{})},debug:function(){var e=this.timezone(),t=this.format("MM")+" "+this.format("date-ordinal")+" "+this.year();return t+="\n     - "+this.format("time"),console.log("\n\n",t+"\n     - "+e.name+" ("+e.current.offset+")"),this},from:function(e){return(e=this.clone().set(e)).since(this)},fromNow:function(){return this.clone().set(Date.now()).since(this)},weekStart:function(e){if("number"==typeof e)return this._weekStart=e,this;if("string"==typeof e){e=e.toLowerCase().trim();var t=$n().indexOf(e);-1===t&&(t=Fn().indexOf(e)),-1===t&&(t=1),this._weekStart=t}else console.warn("Spacetime Error: Cannot understand .weekStart() input:",e);return this}};ca.inDST=ca.isDST,ca.round=ca.nearest,ca.each=ca.every;var sa=ca,la=function(e){return"string"==typeof e&&(e=parseInt(e,10)),e},ua=["year","month","date","hour","minute","second","millisecond"],da=function(e,t,n){for(var a=ua.indexOf(n),i=ua.slice(a,ua.length),r=0;r<i.length;r++){var o=t[i[r]]();e[i[r]](o)}return e},fa=function(e,t){t=la(t);var n=e.clone(),a=e.minute()-t;return e.epoch-=a*vn.minute,da(e,n,"second"),e.epoch},ma=function(e,t){(t=la(t))>=24?t=24:t<0&&(t=0);var n=e.clone(),a=e.hour()-t;return e.epoch-=a*vn.hour,On(e,{hour:t}),da(e,n,"minute"),e.epoch},ba=function(e,t){return t=la(t),On(e,{year:t}),e.epoch},pa=function(e){return(e=(e=e.minute(0)).second(0)).millisecond(1)},ha=Object.assign({},{millisecond:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){t=la(t);var n=e.millisecond();return e.epoch-(n-t)}(t,e),t}return this.d.getMilliseconds()},second:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){t=la(t);var n=e.second()-t;return e.epoch-n*vn.second}(t,e),t}return this.d.getSeconds()},minute:function(e){if(void 0!==e){var t=this.clone();return t.epoch=fa(t,e),t}return this.d.getMinutes()},hour:function(e){var t=this.d;if(void 0!==e){var n=this.clone();return n.epoch=ma(n,e),n}return t.getHours()},hourFloat:function(e){if(void 0!==e){var t=this.clone(),n=e%1;n*=60;var a=parseInt(e,10);return t.epoch=ma(t,a),t.epoch=fa(t,n),t}var i=this.d;return i.getHours()+i.getMinutes()/60},hour12:function(e){var t=this.d;if(void 0!==e){var n=this.clone(),a=(e=""+e).match(/^([0-9]+)(am|pm)$/);if(a){var i=parseInt(a[1],10);"pm"===a[2]&&(i+=12),n.epoch=ma(n,i)}return n}var r=t.getHours();return r>12&&(r-=12),0===r&&(r=12),r},time:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){var n=t.match(/([0-9]{1,2}):([0-9]{1,2})(am|pm)?/);if(!n){if(!(n=t.match(/([0-9]{1,2})(am|pm)/)))return e.epoch;n.splice(2,0,"0")}var a=!1,i=parseInt(n[1],10),r=parseInt(n[2],10);return i>12&&(a=!0),!1===a&&("am"===n[3]&&12===i&&(i=0),"pm"===n[3]&&i<12&&(i+=12)),(e=(e=(e=(e=e.hour(i)).minute(r)).second(0)).millisecond(0)).epoch}(t,e),t}return"".concat(this.h12(),":").concat(Ht.zeroPad(this.minute())).concat(this.ampm())},ampm:function(e){var t="am",n=this.hour();if(n>=12&&(t="pm"),"string"!=typeof e)return t;var a=this.clone();return e=e.toLowerCase().trim(),n>=12&&"am"===e?a.hour(n-=12):n<12&&"pm"===e?a.hour(n+=12):a},dayTime:function(e){if(void 0!==e){var t={morning:"7:00am",breakfast:"7:00am",noon:"12:00am",lunch:"12:00pm",afternoon:"2:00pm",evening:"6:00pm",dinner:"6:00pm",night:"11:00pm",midnight:"23:59pm"},n=this.clone();return e=(e=e||"").toLowerCase(),!0===t.hasOwnProperty(e)&&(n=n.time(t[e])),n}var a=this.hour();return a<6?"night":a<12?"morning":a<17?"afternoon":a<22?"evening":"night"},iso:function(e){return void 0!==e?this.set(e):this.format("iso")}},{date:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){if((t=la(t))>28){var n=xn[e.month()];t>n&&(t=n)}return t<=0&&(t=1),On(e,{date:t}),e.epoch}(t,e),t}return this.d.getDate()},day:function(e){if(void 0===e)return this.d.getDay();var t=this.clone(),n=e;"string"==typeof e&&(e=e.toLowerCase(),-1===(n=$n().indexOf(e))&&(n=Fn().indexOf(e)));var a=this.d.getDay(),i=this.subtract(24*(a-n),"hours");return On(i,{hour:t.hour(),minute:t.minute(),second:t.second()}),i},dayName:function(e){return void 0===e?Fn()[this.day()]:this.clone().day(e)},month:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){"string"==typeof t&&(t=Pn()[t.toLowerCase()]),(t=la(t))>=12&&(t=11),t<=0&&(t=0);var n=e.date();return n>xn[t]&&(n=xn[t]),On(e,{month:t,date:n}),e.epoch}(t,e),t}return this.d.getMonth()}},{dayOfYear:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){t=la(t);var n=e.clone();return(t-=1)<=0?t=0:t>=365&&(t=364),e=(e=e.startOf("year")).add(t,"day"),da(e,n,"hour"),e.epoch}(t,e),t}for(var n,a=0,i=this.d.getMonth(),r=1;r<=i;r++)(n=new Date).setDate(1),n.setFullYear(this.d.getFullYear()),n.setHours(1),n.setMinutes(1),n.setMonth(r),n.setHours(-2),a+=n.getDate();return a+this.d.getDate()},week:function(e){if(void 0!==e){var t=this.clone();return t=(t=(t=t.month(0)).date(1)).day("monday"),"december"===(t=pa(t)).monthName()&&(t=t.add(1,"week")),t.add(e-=1,"weeks")}var n=this.clone();n=(n=n.month(0)).date(1),"december"===(n=(n=pa(n)).day("monday")).monthName()&&(n=n.add(1,"week"));var a=1;1===n.date()&&(a=0),n=n.minus(1,"second");var i=this.epoch;if(n.epoch>i)return 1;var r=0,o=4*this.month();for(n.epoch+=vn.week*o,r+=o;r<52;r++){if(n.epoch>i)return r+a;n=n.add(1,"week")}return 52},monthName:function(e){return void 0===e?kn[this.month()]:this.clone().month(e)},quarter:function(e){if(void 0!==e&&("string"==typeof e&&(e=e.replace(/^q/i,""),e=parseInt(e,10)),na[e])){var t=this.clone();return(t=(t=t.month(na[e][0])).date(1)).startOf("day")}for(var n=this.d.getMonth(),a=1;a<na.length;a++)if(n<na[a][0])return a-1;return 4},season:function(e){var t="north";if("South"===this.hemisphere()&&(t="south"),void 0!==e){for(var n=this.clone(),a=0;a<ta[t].length;a++)e===ta[t][a][0]&&(n=(n=(n=n.month(ta[t][a][1])).date(1)).startOf("day"));return n}for(var i=this.d.getMonth(),r=0;r<ta[t].length-1;r++)if(i>=ta[t][r][1]&&i<ta[t][r+1][1])return ta[t][r][0];return"winter"},year:function(e){if(void 0!==e){var t=this.clone();return t.epoch=ba(t,e),t}return this.d.getFullYear()},era:function(e){if(void 0!==e){var t=this.clone();e=e.toLowerCase();var n=t.d.getFullYear();return"bc"===e&&n>0&&(t.epoch=ba(t,-1*n)),"ad"===e&&n<0&&(t.epoch=ba(t,-1*n)),t}return this.d.getFullYear()<0?"BC":"AD"},decade:function(e){if(void 0!==e){if(!(e=(e=(e=String(e)).replace(/([0-9])'?s$/,"$1")).replace(/([0-9])(th|rd|st|nd)/,"$1")))return console.warn("Spacetime: Invalid decade input"),this;2===e.length&&/[0-9][0-9]/.test(e)&&(e="19"+e);var t=Number(e);return isNaN(t)?this:(t=10*Math.floor(t/10),this.year(t))}return this.startOf("decade").year()},century:function(e){if(void 0!==e){"string"==typeof e&&(e=(e=(e=e.replace(/([0-9])(th|rd|st|nd)/,"$1")).replace(/([0-9]+) ?(b\.?c\.?|a\.?d\.?)/i,(function(e,t,n){return n.match(/b\.?c\.?/i)&&(t="-"+t),t}))).replace(/c$/,""));var t=Number(e);return isNaN(e)?(console.warn("Spacetime: Invalid century input"),this):(0===t&&(t=1),this.year(t=t>=0?100*(t-1):100*(t+1)))}var n=this.startOf("century").year();return(n=Math.floor(n/100))<0?n-1:n+1},millenium:function(e){if(void 0!==e){if("string"==typeof e&&(e=e.replace(/([0-9])(th|rd|st|nd)/,"$1"),e=Number(e),isNaN(e)))return console.warn("Spacetime: Invalid millenium input"),this;e>0&&(e-=1);var t=1e3*e;return 0===t&&(t=1),this.year(t)}var n=Math.floor(this.year()/1e3);return n>=0&&(n+=1),n}});ha.milliseconds=ha.millisecond,ha.seconds=ha.second,ha.minutes=ha.minute,ha.hours=ha.hour,ha.hour24=ha.hour,ha.h12=ha.hour12,ha.h24=ha.hour24,ha.days=ha.day;var ga=["millisecond","second","minute","hour","date","month"],va={second:ga.slice(0,1),minute:ga.slice(0,2),quarterhour:ga.slice(0,2),hour:ga.slice(0,3),date:ga.slice(0,4),month:ga.slice(0,4),quarter:ga.slice(0,4),season:ga.slice(0,4),year:ga,decade:ga,century:ga};va.week=va.hour,va.season=va.date,va.quarter=va.date;var _a={year:!0,quarter:!0,season:!0,month:!0,week:!0,day:!0},ya={month:!0,quarter:!0,season:!0,year:!0},Oa={millisecond:function(e){return e.epoch},second:function(e){return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second()].join("-")},minute:function(e){return[e.year(),e.month(),e.date(),e.hour(),e.minute()].join("-")},hour:function(e){return[e.year(),e.month(),e.date(),e.hour()].join("-")},day:function(e){return[e.year(),e.month(),e.date()].join("-")},week:function(e){return[e.year(),e.week()].join("-")},month:function(e){return[e.year(),e.month()].join("-")},quarter:function(e){return[e.year(),e.quarter()].join("-")},year:function(e){return e.year()}};Oa.date=Oa.day;var Ca,ka=sn,wa=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.epoch=null,this.tz=hn(t,ka),this.silent=n.silent||!0,this.british=n.dmy||n.british,this._weekStart=1,void 0!==n.weekStart&&(this._weekStart=n.weekStart),Object.defineProperty(this,"d",{get:function(){var e=Jt(this),t=(new Date(this.epoch).getTimezoneOffset()||0)+60*e;return t=60*t*1e3,new Date(this.epoch+t)}}),Object.defineProperty(this,"timezones",{get:function(){return ka},set:function(e){return ka=e,e}}),void 0!==e||null===e){var a=Dn(this,e,t);this.epoch=a.epoch}};Object.keys(sa).forEach((function(e){wa.prototype[e]=sa[e]})),wa.prototype.clone=function(){return new wa(this.epoch,this.tz,{silent:this.silent,weekStart:this._weekStart})},wa.prototype.toLocalDate=function(){return new Date(this.epoch)},Ca=wa,Object.keys(ha).forEach((function(e){Ca.prototype[e]=ha[e]})),function(e){e.prototype.add=function(e,t){var n=this.clone();if(!t||0===e)return n;var a=this.clone();t=Ht.normalize(t),vn[t]?n.epoch+=vn[t]*e:"week"===t?n.epoch+=vn.day*(7*e):"quarter"===t||"season"===t?n.epoch+=vn.month*(4*e):"season"===t?n.epoch+=vn.month*(4*e):"quarterhour"===t&&(n.epoch+=15*vn.minute*e);var i={};if(va[t]&&va[t].forEach((function(e){i[e]=a[e]()})),_a[t]){var r=a.timezone().current.offset-n.timezone().current.offset;n.epoch+=3600*r*1e3}if("month"===t&&(i.month=a.month()+e,i=function(e,t){if(e.month>0){var n=parseInt(e.month/12,10);e.year=t.year()+n,e.month=e.month%12}else if(e.month<0){var a=Math.floor(Math.abs(e.month)/13,10);a=Math.abs(a)+1,e.year=t.year()-a,e.month=e.month%12,e.month=e.month+12,12===e.month&&(e.month=0)}return e}(i,a)),"week"===t){var o=a.date()+7*e;o<=28&&o>1&&(i.date=o)}else if("date"===t){var c=a.date()+e;c<=28&&c>1?i.date=c:0!==e&&a.isSame(n,"day")&&(i.date=a.date()+e)}else"year"===t&&n.year()===a.year()?n.epoch+=vn.week:"decade"===t?i.year=n.year()+10:"century"===t&&(i.year=n.year()+100);if(ya[t]){var s=xn[i.month];i.date=a.date(),i.date>s&&(i.date=s)}return On(n,i),n},e.prototype.subtract=function(e,t){return this.clone().add(-1*e,t)},e.prototype.minus=e.prototype.subtract,e.prototype.plus=e.prototype.add}(wa),function(e){e.prototype.isSame=function(t,n){return n?("string"!=typeof t&&"number"!=typeof t||(t=new e(t,this.timezone.name)),n=n.replace(/s$/,""),Oa[n]?Oa[n](this)===Oa[n](t):null):null}}(wa),function(e){var t={isAfter:function(e){e=Ht.beADate(e,this);var t=Ht.getEpoch(e);return null===t?null:this.epoch>t},isBefore:function(e){e=Ht.beADate(e,this);var t=Ht.getEpoch(e);return null===t?null:this.epoch<t},isEqual:function(e){e=Ht.beADate(e,this);var t=Ht.getEpoch(e);return null===t?null:this.epoch===t},isBetween:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=Ht.beADate(e,this),t=Ht.beADate(t,this);var a=Ht.getEpoch(e);if(null===a)return null;var i=Ht.getEpoch(t);return null===i?null:n?this.isBetween(e,t)||this.isEqual(e)||this.isEqual(t):a<this.epoch&&this.epoch<i}};Object.keys(t).forEach((function(n){e.prototype[n]=t[n]}))}(wa),function(e){var t={i18n:function(e){var t;Ht.isObject(e.days)&&(An=(t=e.days).short||An,Nn=t.long||Nn),Ht.isObject(e.months)&&function(e){Cn=e.short||Cn,kn=e.long||kn}(e.months)}};Object.keys(t).forEach((function(n){e.prototype[n]=t[n]}))}(wa);var Pa=wa,Ma=function(e,t,n){return new Pa(e,t,n)};Ma.now=function(e,t){return new Pa((new Date).getTime(),e,t)},Ma.today=function(e,t){return new Pa((new Date).getTime(),e,t).startOf("day")},Ma.tomorrow=function(e,t){return new Pa((new Date).getTime(),e,t).add(1,"day").startOf("day")},Ma.yesterday=function(e,t){return new Pa((new Date).getTime(),e,t).subtract(1,"day").startOf("day")},Ma.extend=function(e){return Object.keys(e).forEach((function(t){Pa.prototype[t]=e[t]})),this},Ma.whereIts=function(e,t){var n=new Pa(null),a=new Pa(null);n=n.time(e),a=t?a.time(t):n.add(59,"minutes");var i=n.hour(),r=a.hour();return Object.keys(n.timezones).filter((function(e){if(-1===e.indexOf("/"))return!1;var t=new Pa(null,e),o=t.hour();return o>=i&&o<=r&&!(o===i&&t.minute()<n.minute())&&!(o===r&&t.minute()>a.minute())}))},Ma.version="6.4.3",Ma.plugin=Ma.extend;var xa,ja=Ma,Va=n("d3UM"),Wa=n("FKr1");function za(e,t){if(1&e&&(l.Wb(0,"div",8),l.Rb(1,"a-catering-order-item",9),l.Vb()),2&e){var n=t.$implicit,a=l.pc(2);l.Cb(1),l.vc("disabled",a.disabled)("symbol",a.symbol)("item",n)("field",a.items)}}function Ia(e,t){if(1&e&&(l.Ub(0),l.Lc(1,za,2,4,"div",7),l.Tb()),2&e){var n=l.pc();l.Cb(1),l.vc("ngForOf",n.category.items)}}xa=$localize(_templateObject34());var La=function(){return{class:"material-icons",content:"close"}};function Ta(e,t){1&e&&(l.Wb(0,"div",10),l.Wb(1,"div",11),l.Rb(2,"app-icon",3),l.Vb(),l.Wb(3,"div",12),l.ac(4,xa),l.Vb(),l.Vb()),2&e&&(l.Cb(2),l.vc("icon",l.wc(1,La)))}var Sa,Da,Aa,Na,$a,Fa,Ea,Ra=function(){return{class:"material-icons",content:"arrow_back"}},qa=((Sa=function(){function e(){_classCallCheck(this,e),this.close=new l.n}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Sa)},Sa.\u0275cmp=l.Kb({type:Sa,selectors:[["a-category-display"]],inputs:{category:"category",items:"items",symbol:"symbol",disabled:"disabled"},outputs:{close:"close"},decls:9,vars:5,consts:[[1,"header"],[1,"content"],["mat-icon-button","",3,"tapped"],[3,"icon"],[1,"name"],[4,"ngIf","ngIfElse"],["empty_state",""],["class","item",4,"ngFor","ngForOf"],[1,"item"],[3,"disabled","symbol","item","field"],[1,"info-block","center"],[1,"icon"],[1,"text"]],template:function(e,t){if(1&e&&(l.Wb(0,"div",0),l.Wb(1,"div",1),l.Wb(2,"button",2),l.lc("tapped",(function(){return t.close.emit()})),l.Rb(3,"app-icon",3),l.Vb(),l.Wb(4,"div",4),l.Nc(5),l.Vb(),l.Vb(),l.Vb(),l.Lc(6,Ia,2,1,"ng-container",5),l.Lc(7,Ta,5,2,"ng-template",null,6,l.Mc)),2&e){var n=l.Ac(8);l.Cb(3),l.vc("icon",l.wc(4,Ra)),l.Cb(2),l.Oc(null==t.category?null:t.category.name),l.Cb(1),l.vc("ngIf",t.category.items&&t.category.items.length)("ngIfElse",n)}},directives:[M.b,j.c,x.a,a.t,a.s,Bt],styles:[".header[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;width:100%;background-color:#fff;border-bottom:1px solid #ccc;padding:.5em;z-index:1}.header[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;align-items:center;width:640px;max-width:100vw;margin:auto}.header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{flex:1;text-align:center;margin-right:3em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.item[_ngcontent-%COMP%]{position:relative;width:640px;margin:.5em auto;background-color:#fff;border:1px solid #ccc;border-radius:4px;overflow:hidden;max-width:calc(100vw - 1em);z-index:0}"]}),Sa);function Ba(e,t){if(1&e&&(l.Wb(0,"mat-option",17),l.Nc(1),l.Vb()),2&e){var n=t.$implicit;l.vc("value",n),l.Cb(1),l.Pc(" ",n.name," ")}}function Ga(e,t){if(1&e&&(l.Wb(0,"mat-option",17),l.Nc(1),l.Vb()),2&e){var n=t.$implicit;l.vc("value",n.id),l.Cb(1),l.Pc(" ",n.name," ")}}function Qa(e,t){if(1&e&&(l.Wb(0,"div",9),l.Wb(1,"form",10),l.Wb(2,"div",11),l.Wb(3,"label"),l.ac(4,Na),l.Vb(),l.Wb(5,"mat-form-field",12),l.Wb(6,"mat-select",13),l.Lc(7,Ba,2,2,"mat-option",14),l.Vb(),l.Vb(),l.Vb(),l.Wb(8,"div",11),l.Wb(9,"label",15),l.ac(10,$a),l.Vb(),l.Wb(11,"mat-form-field",12),l.Wb(12,"mat-select",16),l.Lc(13,Ga,2,2,"mat-option",14),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb()),2&e){var n=l.pc();l.Cb(1),l.vc("formGroup",n.form),l.Cb(6),l.vc("ngForOf",n.space_list),l.Cb(6),l.vc("ngForOf",n.available_times)}}function Ua(e,t){if(1&e){var n=l.Xb();l.Wb(0,"button",23),l.lc("tapped",(function(){l.Dc(n);var e=t.$implicit;return l.pc(4).active_category=e})),l.Rb(1,"div",24),l.Wb(2,"div",25),l.Nc(3),l.Vb(),l.Vb()}if(2&e){var a=t.$implicit,i=l.pc(4);l.Kc("background-image","url("+a.image_path+")",l.Jb),l.vc("disabled",i.within_restricted_time&&!a.can_order_anytime),l.Cb(3),l.Oc(a.name)}}function Ya(e,t){if(1&e&&(l.Wb(0,"div",21),l.Lc(1,Ua,4,4,"button",22),l.Vb()),2&e){var n=l.pc(3);l.Cb(1),l.vc("ngForOf",n.category_list)}}function Xa(e,t){if(1&e&&(l.Ub(0),l.Lc(1,Ya,2,1,"div",20),l.Tb()),2&e){var n=l.pc(2),a=l.Ac(9);l.Cb(1),l.vc("ngIf",n.can_order&&n.category_list.length)("ngIfElse",a)}}function Ha(e,t){if(1&e&&(l.Wb(0,"div",18),l.Lc(1,Xa,2,2,"ng-container",19),l.Vb()),2&e){var n=l.pc(),a=l.Ac(13);l.Cb(1),l.vc("ngIf",!n.active_category)("ngIfElse",a)}}function Ka(e,t){if(1&e&&(l.gc(0,Fa,1),l.Rb(1,"span",29),l.dc()),2&e){var n=l.pc(2);l.Cb(1),l.ec((null==n.active_building?null:n.active_building.catering_restricted_from)||"0"),l.bc(0)}}function Za(e,t){if(1&e&&(l.Wb(0,"div",26),l.Wb(1,"div",27),l.Rb(2,"img",28),l.Vb(),l.Wb(3,"p"),l.gc(4,Fa),l.Rb(5,"span",29),l.Rb(6,"br"),l.Lc(7,Ka,2,1,"span",30),l.dc(),l.Vb(),l.Vb()),2&e){var n=l.pc();l.Cb(7),l.vc("ngIf",null==n.active_building?null:n.active_building.catering_restricted_from),l.ec(null==n.active_building?null:n.active_building.name),l.bc(4)}}function Ja(e,t){if(1&e&&(l.Wb(0,"div",18),l.Wb(1,"div",31),l.Wb(2,"div",27),l.Rb(3,"mat-spinner",32),l.Vb(),l.Wb(4,"div",33),l.ac(5,Ea),l.Vb(),l.Vb(),l.Vb()),2&e){var n=l.pc();l.Cb(5),l.ec(null==n.active_building?null:n.active_building.name),l.bc(5)}}function ei(e,t){if(1&e){var n=l.Xb();l.Wb(0,"a-category-display",34),l.lc("close",(function(){return l.Dc(n),l.pc().active_category=null})),l.Vb()}if(2&e){var a=l.pc();l.vc("category",a.active_category)("symbol",a.symbol)("items",a.form.controls.items)("disabled",a.within_restricted_time)}}Da=$localize(_templateObject35()),Aa=$localize(_templateObject36(),"\ufffd0\ufffd"),Na=$localize(_templateObject37()),$a=$localize(_templateObject38()),Fa=$localize(_templateObject39(),"\ufffd#5\ufffd","[\ufffd/#5\ufffd|\ufffd/#1:1\ufffd\ufffd/*7:1\ufffd]","\ufffd#6\ufffd\ufffd/#6\ufffd","\ufffd*7:1\ufffd\ufffd#1:1\ufffd","\ufffd0:1\ufffd","[\ufffd/#5\ufffd|\ufffd/#1:1\ufffd\ufffd/*7:1\ufffd]","\ufffd0\ufffd"),Fa=l.fc(Fa),Ea=$localize(_templateObject40(),"\ufffd0\ufffd");var ti,ni=((ti=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a){var i;return _classCallCheck(this,n),(i=t.call(this))._service=e,i._dialog=a,i.event=new l.n,i.category_list=[],i.available_times=[],i}return _createClass(n,[{key:"ngOnInit",value:function(){this.generateAvailableTimes(),this.loadMenu()}},{key:"ngOnChanges",value:function(e){var t=this;(e.date||e.duration)&&(this.generateAvailableTimes(),this.form&&!this.available_times.find((function(e){return e.id===t.form.controls.start.value}))&&this.form.controls.start.setValue(this.available_times[0].id)),e.space_list&&this.form&&this.space_list&&!this.form.controls.space.value&&this.form.controls.space.setValue(this.space_list[0]),e.order&&this.order&&this.initForm()}},{key:"initForm",value:function(){var e=this;this.form=new r.i({id:new r.f(this.order.id),booking_date:new r.f(this.all_day?w(this.date).startOf("d").valueOf():this.date),space:new r.f(this._service.Spaces.item(this.order.location_id)||this.space_list[0]),location_id:new r.f(this.order.location_id||this.space_list[0].id),start:new r.f(this.order.delivery_time||this.available_times[0].id),items:new r.f((this.order.items||[]).map((function(e){return new lt.a(e)})))}),this.timeout("init_items",(function(){return e.form.controls.items.setValue((e.order.items||[]).map((function(e){return new lt.a(e)})))}),50),this.subscription("space_change",this.form.controls.space.valueChanges.subscribe((function(t){e.form.controls.location_id.setValue(t.id),e.generateAvailableTimes(),e.available_times.find((function(t){return t.id===e.form.controls.start.value}))||e.form.controls.start.setValue(e.available_times[0].id),e.loadMenu()}))),this.generateAvailableTimes(),this.form&&!this.available_times.find((function(t){return t.id===e.form.controls.start.value}))&&this.form.controls.start.setValue(this.available_times[0].id)}},{key:"confirmOrder",value:function(){var e=this,t=this._dialog.open(Xt,{maxWidth:"95vw",data:{date:this.date,form:this.form}});this.subscription("confirm_event",t.componentInstance.event.subscribe((function(n){if("done"===n.reason){var a=new k.a(e.form.value);e.event.emit(a),t.close()}}))),t.afterClosed().subscribe((function(){return e.unsub("confirm_event")}))}},{key:"loadMenu",value:function(){var e=this,t=this.form?this.form.controls.space.value:null;t&&(this.form.controls.items.setValue([]),this.loading=!0,this._service.Menu.query({room_id:t.id}).then((function(t){e.loading=!1,e.category_list=(t||[]).map((function(e){return new st.a(e)}))}),(function(){return e.loading=!1})))}},{key:"generateAvailableTimes",value:function(){var e=this.all_day?w(this.date).startOf("d"):w(this.date),t=this.generateStartAndEndTimes(),n=t.start,a=t.end;for(n=n.minute(5*Math.ceil(n.minute()/5)),this.available_times=[];n.isBefore(a);)this.available_times.push({id:Math.abs(e.diff(n,"m")),name:n.format("h:mm A")}),n=n.add(5,"m");0===this.available_times.length&&this.available_times.push({id:-1,name:"Out of hours"})}},{key:"generateStartAndEndTimes",value:function(){var e=w(this.date);this.all_day&&(e=e.startOf("d"));var t=this.all_day?e.endOf("d"):e.add(this.duration,"m"),n=ja(e.toDate());n=n.hour(7);var a=w(n.toLocalDate());if(console.log("Timezone start:",a.format("DD MMM, h:mm A")),e.isBefore(a,"m"))t=(e=a).add(13,"h");else{var i=a.hour(20);console.log("Timezone end:",i.format("DD MMM, h:mm A")),t.isAfter(i)&&(t=i)}return{start:e,end:t}}},{key:"can_order",get:function(){if(!this.form||!this.form.controls.space)return!1;var e=this.form.controls.space.value;return(this._service.Organisation.buildings.find((function(t){return t.id===e.level.building_id})).has_catering||this.category_list.length)&&(!this.within_restricted_time||this.has_available_items)}},{key:"active_building",get:function(){if(!this.form||!this.form.controls.space)return null;var e=this.form.controls.space.value;return e?this._service.Organisation.buildings.find((function(t){return e.level.building_id===t.id})):null}},{key:"symbol",get:function(){var e=this.active_building;return e&&e.currency||"USD"}},{key:"item_count",get:function(){return this.form?(this.form.controls.items.value||[]).reduce((function(e,t){return e+t.amount}),0):0}},{key:"out_of_hours",get:function(){return!!this.form&&this.form.controls.start.value<0}},{key:"within_restricted_time",get:function(){if(!this.form||!this.form.controls.space)return!1;var e=this.form.controls.space.value,t=this._service.Organisation.buildings.find((function(t){return t.id===e.level.building_id}));if(!t.catering_restricted_from||t.catering_restricted_from<=0)return!1;var n=w(),a=w(this.date).subtract(t.catering_restricted_from,"h");return n.isAfter(a,"s")}},{key:"has_available_items",get:function(){return this.category_list.reduce((function(e,t){return e||t.can_order_anytime}),!1)}}]),n}(s.a)).\u0275fac=function(e){return new(e||ti)(l.Qb(c.a),l.Qb(C.b))},ti.\u0275cmp=l.Kb({type:ti,selectors:[["a-catering-order-details"]],inputs:{order:"order",date:"date",duration:"duration",space_list:"space_list",all_day:"all_day"},outputs:{event:"event"},features:[l.zb,l.Ab],decls:14,vars:5,consts:[[1,"catering","order-details"],["class","header",4,"ngIf"],["class","body",4,"ngIf","ngIfElse"],[1,"footer"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"disabled","tapped"],["empty_state",""],["load_state",""],["category_display",""],[1,"header"],[3,"formGroup"],[1,"field"],["appearance","outline"],["formControlName","space"],[3,"value",4,"ngFor","ngForOf"],["for","start"],["name","start","formControlName","start"],[3,"value"],[1,"body"],[4,"ngIf","ngIfElse"],["class","contents",4,"ngIf","ngIfElse"],[1,"contents"],["mat-button","","class","category",3,"background-image","disabled","tapped",4,"ngFor","ngForOf"],["mat-button","",1,"category",3,"disabled","tapped"],[1,"overlay"],[1,"name"],[1,"empty-state","center"],[1,"icon"],["alt","No Catering Available","src","assets/img/no-catering.svg"],[1,"bold"],["class","bold",4,"ngIf"],[1,"info-block","center"],["diameter","48"],[1,"text"],[3,"category","symbol","items","disabled","close"]],template:function(e,t){if(1&e&&(l.Wb(0,"div",0),l.Lc(1,Qa,14,3,"div",1),l.Lc(2,Ha,2,2,"div",2),l.Wb(3,"div",3),l.Wb(4,"button",4),l.lc("tapped",(function(){return t.event.emit()})),l.ac(5,Da),l.Vb(),l.Wb(6,"button",5),l.lc("tapped",(function(){return t.confirmOrder()})),l.ac(7,Aa),l.Vb(),l.Vb(),l.Vb(),l.Lc(8,Za,8,2,"ng-template",null,6,l.Mc),l.Lc(10,Ja,6,1,"ng-template",null,7,l.Mc),l.Lc(12,ei,1,4,"ng-template",null,8,l.Mc)),2&e){var n=l.Ac(11);l.Cb(1),l.vc("ngIf",t.form),l.Cb(1),l.vc("ngIf",!t.loading)("ngIfElse",n),l.Cb(4),l.vc("disabled",!t.item_count||t.out_of_hours),l.Cb(1),l.ec(t.item_count||"0"),l.bc(7)}},directives:[a.t,M.b,j.c,r.H,r.s,r.j,V.b,Va.a,r.r,r.h,a.s,Wa.g,Ie.c,qa],styles:["[_nghost-%COMP%]{height:100%}.order-details[_ngcontent-%COMP%]{height:100%;margin:auto;max-width:100vw}.header[_ngcontent-%COMP%], .order-details[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;width:100%}.header[_ngcontent-%COMP%]{justify-content:center;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);z-index:99}.body[_ngcontent-%COMP%]{position:relative;flex:1;width:100%;min-height:50%;overflow:hidden auto}.footer[_ngcontent-%COMP%]{width:100%;text-align:center;border-top:1px solid #ccc;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:.5em}form[_ngcontent-%COMP%]{display:flex;align-items:center}.field[_ngcontent-%COMP%]{margin:0 .5em;max-height:3.5em}@media only screen and (orientation:portrait) and (max-width:450px){.field[_ngcontent-%COMP%]{max-height:4.75em}}@media only screen and (orientation:landscape) and (max-width:800px){.field[_ngcontent-%COMP%]{max-height:4.75em}}.contents[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;max-width:768px;margin:auto}.category[_ngcontent-%COMP%]{position:relative;background-position:50%;background-size:cover;height:11em;width:11em;margin:1em;border-radius:4px;border:none;padding:0;background-color:#fff;transition:box-shadow .2s}.category[_ngcontent-%COMP%]:hover{box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.category[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.35);border-radius:4px}.category[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:99;max-width:9em;white-space:normal;line-height:1.25em;margin:0}@media only screen and (orientation:portrait) and (max-width:450px){mat-form-field[_ngcontent-%COMP%]{width:11.75em}}@media only screen and (orientation:landscape) and (max-width:800px){mat-form-field[_ngcontent-%COMP%]{width:11.75em}}label[_ngcontent-%COMP%]{font-weight:500;font-size:.8em;margin-right:.75em}.empty-state[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;background-color:#fff;border-radius:4px;padding:1em;max-width:calc(100vw - 2em);box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.empty-state[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ce1a51}.empty-state[_ngcontent-%COMP%]   .bold[_ngcontent-%COMP%]{font-weight:400}.empty-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:6em;width:8em}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;max-width:24em}.info-block[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:2.5em;width:2.5em}"]}),ti);function ai(e,t){if(1&e){var n=l.Xb();l.Ub(0),l.Wb(1,"a-catering-order-list",3),l.lc("order",(function(e){l.Dc(n);var t=l.pc();return e?t.active_order=e:t.newOrder()}))("event",(function(e){return l.Dc(n),l.pc().event.emit(e)})),l.Vb(),l.Tb()}if(2&e){var a=l.pc();l.Cb(1),l.vc("catering",a.catering_field)("date",a.date)("all_day",a.all_day)}}function ii(e,t){if(1&e){var n=l.Xb();l.Wb(0,"a-catering-order-details",4),l.lc("event",(function(e){l.Dc(n);var t=l.pc();return e?t.handleOrderEvent(e):t.active_order=null})),l.Vb()}if(2&e){var a=l.pc();l.vc("space_list",a.space_list)("order",a.active_order)("date",a.date)("duration",a.duration)("all_day",a.all_day)}}var ri,oi,ci,si,li=((ri=function(){function e(){_classCallCheck(this,e),this.event=new l.n}return _createClass(e,[{key:"newOrder",value:function(){var e=new k.a({});this.active_order=e}},{key:"handleOrderEvent",value:function(e){if(e){var t=this.form.controls.catering.value||[],n=t.findIndex((function(t){return e.id===t.id}));n<0?t.push(e):t.splice(n,1,e),this.form.controls.catering.setValue(t)}this.active_order=null}},{key:"catering_field",get:function(){return this.form?this.form.controls.catering:null}},{key:"space_list",get:function(){return this.form?this.form.controls.space_list.value:[]}},{key:"date",get:function(){return this.form?this.form.controls.date.value:w().startOf("m").valueOf()}},{key:"duration",get:function(){return this.form?this.form.controls.duration.value:60}},{key:"all_day",get:function(){return!!this.form&&this.form.controls.all_day.value}}]),e}()).\u0275fac=function(e){return new(e||ri)},ri.\u0275cmp=l.Kb({type:ri,selectors:[["booking-catering"]],inputs:{form:"form"},outputs:{event:"event"},decls:4,vars:2,consts:[[1,"catering"],[4,"ngIf","ngIfElse"],["order_display",""],[3,"catering","date","all_day","order","event"],[3,"space_list","order","date","duration","all_day","event"]],template:function(e,t){if(1&e&&(l.Wb(0,"div",0),l.Lc(1,ai,2,3,"ng-container",1),l.Vb(),l.Lc(2,ii,1,5,"ng-template",null,2,l.Mc)),2&e){var n=l.Ac(3);l.Cb(1),l.vc("ngIf",!t.active_order)("ngIfElse",n)}},directives:[a.t,ct,ni],styles:[".catering[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%;width:100%}"]}),ri),ui=n("4Man"),di=["container"];oi=$localize(_templateObject41()),ci=$localize(_templateObject42()),si=$localize(_templateObject43());var fi,mi=function(){return{class:"material-icons",content:"refresh"}},bi=((fi=function(){function e(){_classCallCheck(this,e),this.event=new l.n}return _createClass(e,[{key:"next",value:function(){this.form.markAllAsTouched(),this.form.valid?this.event.emit({type:"next",step:"form"}):this.container&&this.container.nativeElement.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}},{key:"previous",value:function(){this.event.emit({type:"previous",step:"form"})}},{key:"resetForm",value:function(){this.event.emit({type:"reset",step:"form"})}}]),e}()).\u0275fac=function(e){return new(e||fi)},fi.\u0275cmp=l.Kb({type:fi,selectors:[["booking-spaces-form"]],viewQuery:function(e,t){var n;1&e&&l.Jc(di,!0),2&e&&l.zc(n=l.mc())&&(t.container=n.first)},inputs:{form:"form"},outputs:{event:"event"},decls:15,vars:4,consts:[[1,"booking-form"],["container",""],[1,"header"],["mat-icon-button","","name","reset",3,"tapped"],[3,"icon"],[3,"formGroup","ngSubmit"],[1,"body"],[3,"form"],[1,"footer"],["mat-button","","type","button",1,"inverse",3,"tapped"],["mat-button","","type","submit"]],template:function(e,t){1&e&&(l.Wb(0,"div",0,1),l.Wb(2,"div",2),l.Wb(3,"h3"),l.ac(4,oi),l.Vb(),l.Wb(5,"button",3),l.lc("tapped",(function(){return t.resetForm()})),l.Rb(6,"app-icon",4),l.Vb(),l.Vb(),l.Wb(7,"form",5),l.lc("ngSubmit",(function(){return t.next()})),l.Wb(8,"div",6),l.Rb(9,"a-booking-form",7),l.Vb(),l.Wb(10,"div",8),l.Wb(11,"button",9),l.lc("tapped",(function(){return t.previous()})),l.ac(12,ci),l.Vb(),l.Wb(13,"button",10),l.ac(14,si),l.Vb(),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Cb(6),l.vc("icon",l.wc(3,mi)),l.Cb(1),l.vc("formGroup",t.form),l.Cb(2),l.vc("form",t.form))},directives:[M.b,j.c,x.a,r.H,r.s,r.j,ui.a],styles:[".booking-form[_ngcontent-%COMP%]{width:768px;max-width:95vw;min-height:100%;background-color:#fff;margin:auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}form[_ngcontent-%COMP%]{padding:1em}.header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5em 1em;border-bottom:1px solid #f0f0f0}h3[_ngcontent-%COMP%]{min-width:50%;flex:1;margin:0}.footer[_ngcontent-%COMP%]{margin-top:1em;text-align:center}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:0 .5em}"]}),fi);function pi(e,t){if(1&e){var n=l.Xb();l.Wb(0,"booking-find-space",5),l.lc("event",(function(e){return l.Dc(n),l.pc(2).handleFlowEvent(e)})),l.Vb()}if(2&e){var a=l.pc(2);l.vc("spaces",a.form.controls.space_list)("form",a.form)}}function hi(e,t){if(1&e&&(l.Ub(0),l.Lc(1,pi,1,2,"booking-find-space",4),l.Tb()),2&e){var n=l.pc();l.Cb(1),l.vc("ngIf",n.form)}}function gi(e,t){if(1&e){var n=l.Xb();l.Wb(0,"booking-catering",7),l.lc("event",(function(e){return l.Dc(n),l.pc(2).handleFlowEvent(e)})),l.Vb()}if(2&e){var a=l.pc(2);l.vc("form",a.form)}}function vi(e,t){if(1&e&&(l.Ub(0),l.Lc(1,gi,1,1,"booking-catering",6),l.Tb()),2&e){var n=l.pc();l.Cb(1),l.vc("ngIf",n.form)}}function _i(e,t){if(1&e){var n=l.Xb();l.Wb(0,"booking-spaces-form",7),l.lc("event",(function(e){return l.Dc(n),l.pc(2).handleFlowEvent(e)})),l.Vb()}if(2&e){var a=l.pc(2);l.vc("form",a.form)}}function yi(e,t){if(1&e&&(l.Ub(0),l.Lc(1,_i,1,1,"booking-spaces-form",6),l.Tb()),2&e){var n=l.pc();l.Cb(1),l.vc("ngIf",n.form)}}var Oi,Ci,ki,wi,Pi,Mi,xi,ji,Vi=((Oi=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,i,r){var o;return _classCallCheck(this,n),(o=t.call(this))._service=e,o._route=a,o._router=i,o._dialog=r,o}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this._service.initialised.pipe(Object(y.a)((function(e){return e}))).subscribe((function(){e.settings=e._service.setting("app.booking"),e.subscription("route.params",e._route.paramMap.subscribe((function(t){t.has("step")&&(e.flow_step=t.get("step"))}))),e._service.Spaces.initialised.pipe(Object(y.a)((function(e){return e}))).subscribe((function(){e.loadFormData()}))}))}},{key:"handleFlowEvent",value:function(e){"next"===e.type?this.toNextFlowStep(e):"previous"===e.type?this.toPreviousFlowStep(e):"reset"===e.type&&this.resetForm()}},{key:"toNextFlowStep",value:function(e){var t=this.form.controls.space_list.value;switch(e.step){case"search":!(t&&t.length&&this.settings.multiple_spaces)||e.metadata&&e.metadata.ref&&"equipment"===e.metadata.ref?this.form.controls.has_catering&&this.form.controls.has_catering.value?this.navigate("catering"):(this.navigate("form"),this.confirmBooking()):this.openEquipmentDetailsModal();break;case"catering":var n=this.form.controls.catering.value;!n||!n.length||e.metadata&&e.metadata.ref&&"details"===e.metadata.ref?(this.navigate("form"),this.confirmBooking()):this.openCateringDetailsModal();break;default:this.form.controls.needs_space&&(!this.form.controls.needs_space.value||t&&t.length)?this.confirmBooking():this.navigate("search")}}},{key:"toPreviousFlowStep",value:function(e){switch(e.step){case"search":this.navigate("form");break;case"catering":this.navigate("search")}}},{key:"navigate",value:function(e){this._router.navigate(["book","spaces",e],{queryParamsHandling:"preserve"}),this.flow_step=e}},{key:"resetForm",value:function(){this.booking.clearPendingChanges(),delete this.form,this.form=Object(v.a)(this.booking,this._service.Users.current,this.available_fields)}},{key:"loadFormData",value:function(){var e=this,t={};if(localStorage){var n=localStorage.getItem("ACA_STAFF.booking_form_data");if(n)try{t=JSON.parse(n)}catch(i){}}if(this.booking=new g.a(this._service.Bookings,t||{}),this.subscription("form_changes",this.booking.changeEvents.subscribe((function(){return e.saveFormData()}))),this.form=Object(v.a)(this.booking,this._service.Users.current,this.available_fields),t&&!t.id)for(var a in t)this.form.controls[a]?this.form.controls[a].setValue(t[a]):this.booking.hasOwnProperty("")&&this.booking.storePendingChange(a,t[a]);t&&t.room_ids&&this.form.controls.space_list&&this.form.controls.space_list.setValue(t.room_ids.map((function(t){return e._service.Spaces.item(t)||{id:t,name:t}})))}},{key:"saveFormData",value:function(){localStorage&&this.booking&&localStorage.setItem("ACA_STAFF.booking_form_data",JSON.stringify(this.booking.toJSON(!0)))}},{key:"openEquipmentDetailsModal",value:function(){var e=this,t=this._dialog.open(O.a,{maxWidth:"95vw",width:"32em",data:{spaces:this.form.controls.space_list.value,notes_field:this.form.controls.notes,codes_field:this.form.controls.equipment_codes,head_counts_field:this.form.controls.expected_attendees}});this.subscription("modal_events",t.componentInstance.event.subscribe((function(n){"done"===n.reason&&(e.toNextFlowStep({type:"next",step:"search",metadata:{ref:"equipment"}}),t.close())}))),t.afterClosed().subscribe((function(){return e.unsub("modal_events")}))}},{key:"openCateringDetailsModal",value:function(){var e=this,t=this._dialog.open(R,{maxWidth:"95vw",width:"32em",data:{spaces:this.form.controls.space_list.value,notes_field:this.form.controls.notes,catering:this.form.controls.catering}});this.subscription("modal_events",t.componentInstance.event.subscribe((function(n){"done"===n.reason&&(e.toNextFlowStep({type:"next",step:"catering",metadata:{ref:"details"}}),t.close())}))),t.afterClosed().subscribe((function(){return e.unsub("modal_events")}))}},{key:"confirmBooking",value:function(){var e=this;this.booking.has_changes?this.form.valid&&this._dialog.open(_.a,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{booking:this.booking}}).componentInstance.event.subscribe((function(t){"success"===t.type&&e._router.navigate(["/schedule"])})):this._service.notifyInfo("No changes have been made to booking")}},{key:"available_fields",get:function(){return this._service.setting("app.booking.show_fields")||[]}}]),n}(s.a)).\u0275fac=function(e){return new(e||Oi)(l.Qb(c.a),l.Qb(i.a),l.Qb(i.d),l.Qb(C.b))},Oi.\u0275cmp=l.Kb({type:Oi,selectors:[["booking-space-flow"]],features:[l.zb],decls:5,vars:3,consts:[[1,"space-flow"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"spaces","form","event",4,"ngIf"],[3,"spaces","form","event"],[3,"form","event",4,"ngIf"],[3,"form","event"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.Ub(1,1),l.Lc(2,hi,2,1,"ng-container",2),l.Lc(3,vi,2,1,"ng-container",2),l.Lc(4,yi,2,1,"ng-container",3),l.Tb(),l.Vb()),2&e&&(l.Cb(1),l.vc("ngSwitch",t.flow_step),l.Cb(1),l.vc("ngSwitchCase","search"),l.Cb(1),l.vc("ngSwitchCase","catering"))},directives:[a.x,a.y,a.z,a.t,qe,li,bi],styles:[".space-flow[_ngcontent-%COMP%]{height:100%;overflow:auto}"]}),Oi),Wi=n("1gA9"),zi=n("5fZw"),Ii=n("1DiH"),Li=n("oTgu");function Ti(e,t){if(1&e){var n=l.Xb();l.Wb(0,"div",11),l.Wb(1,"i",12),l.lc("modelChange",(function(e){return l.Dc(n),l.pc().bookings=e}))("modelChange",(function(){return l.Dc(n),l.pc().processDeskBookings()})),l.Vb(),l.Vb()}if(2&e){var a=l.pc();l.Cb(1),l.vc("model",a.bookings)("sys",a.system_id)("bind",a.active_level+":bookings")}}function Si(e,t){if(1&e&&(l.Wb(0,"div"),l.Nc(1),l.Vb()),2&e){var n=l.pc(2);l.Eb("status "+(n.available||n.belongs_to_user?"available":"unavailable")),l.Cb(1),l.Pc(" ",n.available||n.belongs_to_user?"Available":"Not Available"," ")}}function Di(e,t){1&e&&(l.Wb(0,"div",20),l.ac(1,Ci),l.Vb())}function Ai(e,t){if(1&e){var n=l.Xb();l.Wb(0,"div"),l.Wb(1,"button",21),l.lc("tapped",(function(){return l.Dc(n),l.pc(2).check_in()})),l.ac(2,ki),l.Vb(),l.Wb(3,"div"),l.ac(4,wi),l.Vb(),l.Vb()}}function Ni(e,t){if(1&e){var n=l.Xb();l.Wb(0,"div"),l.Wb(1,"div"),l.Nc(2,"Now reserved for"),l.Vb(),l.Wb(3,"div",22),l.Nc(4),l.Vb(),l.Wb(5,"button",21),l.lc("tapped",(function(){return l.Dc(n),l.pc(2).check_out()})),l.ac(6,Pi),l.Vb(),l.Wb(7,"div"),l.ac(8,Mi),l.Vb(),l.Vb()}if(2&e){var a=l.pc(2);l.Cb(4),l.Oc(a.user.name)}}function $i(e,t){if(1&e){var n=l.Xb();l.Wb(0,"div",23),l.Wb(1,"div",24),l.Wb(2,"div",25),l.ac(3,xi),l.Vb(),l.Wb(4,"a-time-field",26),l.lc("ngModelChange",(function(e){return l.Dc(n),l.pc(2).date=e})),l.Vb(),l.Wb(5,"div",27),l.Wb(6,"button",28),l.lc("tapped",(function(){return l.Dc(n),l.pc(2).book()})),l.Nc(7," Confirm "),l.Vb(),l.Vb(),l.Vb(),l.Vb()}if(2&e){var a=l.pc(2);l.Cb(4),l.vc("ngModel",a.date)}}function Fi(e,t){if(1&e&&(l.Wb(0,"div",13),l.Wb(1,"div",14),l.Wb(2,"div",15),l.Nc(3),l.Vb(),l.Lc(4,Si,2,3,"div",16),l.Lc(5,Di,2,0,"div",17),l.Lc(6,Ai,5,0,"div",18),l.Lc(7,Ni,9,1,"div",18),l.Vb(),l.Lc(8,$i,8,1,"div",19),l.Vb()),2&e){var n=l.pc();l.Cb(3),l.Pc(" ",n.desk," "),l.Cb(1),l.vc("ngIf",!(n.belongs_to_user&&n.current_booking.checked_in)),l.Cb(1),l.vc("ngIf",!n.available&&!n.belongs_to_user),l.Cb(1),l.vc("ngIf",n.belongs_to_user&&!n.current_booking.checked_in),l.Cb(1),l.vc("ngIf",n.belongs_to_user&&n.current_booking.checked_in),l.Cb(1),l.vc("ngIf",n.available)}}function Ei(e,t){1&e&&(l.Wb(0,"div",13),l.Wb(1,"div",14),l.Wb(2,"div",15),l.ac(3,ji),l.Vb(),l.Vb(),l.Vb())}function Ri(e,t){1&e&&l.Rb(0,"mat-spinner",3)}function qi(e,t){if(1&e){var n=l.Xb();l.Wb(0,"a-map-controls",29),l.lc("levelChange",(function(e){return l.Dc(n),l.pc().active_level=e}))("levelChange",(function(){return l.Dc(n),l.pc().onLevelChange()})),l.Vb()}if(2&e){var a=l.pc();l.vc("level",a.active_level)}}Ci=$localize(_templateObject44()),ki=$localize(_templateObject45()),wi=$localize(_templateObject46()),Pi=$localize(_templateObject47()),Mi=$localize(_templateObject48()),xi=$localize(_templateObject49()),ji=$localize(_templateObject50());var Bi,Gi=((Bi=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,i){var r;return _classCallCheck(this,n),(r=t.call(this))._service=e,r._route=a,r._router=i,r.style_map={},r.status_map={},r.colour_map={},r}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this._service.initialised.pipe(Object(y.a)((function(e){return e}))).subscribe((function(){e.colour_map=e._service.setting("app.explore.colors")||{},e.user=e._service.Users.current,e.date=w().valueOf(),e.subscription("route.queryparams",e._route.queryParamMap.subscribe((function(t){t.has("desk")&&(e.desk=t.get("desk")),t.has("level")?(e.active_level=t.get("level"),e.loadSystem(e.active_level)):(e.active_level=e.loadLevel(),e.loadSystem(e.active_level)),e.processDeskBookings()})))}))}},{key:"loadSystem",value:function(e){if(e){var t=this._service.Organisation.levelWithID(e),n=this._service.Organisation.buildings.find((function(e){return e.id===t.building_id}));this.system_id=n.systems.desk_bookings}else{var a=this._service.Organisation.building;a&&a.levels.length&&(this.active_level=a.levels[0].id),this.system_id=a.systems.desk_bookings}}},{key:"focusDesk",value:function(){this.focus=this.desk,this.features=[{id:this.desk,coordinates:null,content:Wi.e,data:{text:""}}],this.zoom=2}},{key:"processStatuses",value:function(){var e={};(this.status_map.desks||[]).forEach((function(t){return e["#".concat(t.id)]=t.styles})),this.style_map=e}},{key:"changeDate",value:function(e){var t=this._service.setting("app.booking.desk_start")||9;this.date=w().isSame(w(e),"d")?w().valueOf():w(e).hour(t).startOf("h").valueOf(),this.processDeskBookings()}},{key:"processDeskBookings",value:function(){var e=this;this.timeout("desk_bookings",(function(){var t=[],n=[];e.on_level?e.focusDesk():(e.focus=null,e.center={x:.5,y:.5},e.zoom=1),e.desks_list.forEach((function(a){var i=e.getBooking(a);e.desk&&a===e.desk&&(e.current_booking=i);var r=i?"unavailable":"available";t.push({id:a,styles:{fill:e.colour_map["desk-".concat(r)],stroke:e.colour_map["desk-".concat(r,"-stroke")]},status_id:r}),n.push({id:a,event:"click",callback:function(){e._router.navigate(["book","desks"],{queryParams:{level:e.active_level,desk:a}})}})})),e.status_map.desks=t,e.processStatuses(),e.listeners=n}))}},{key:"getBooking",value:function(e){var t=w(this.date).format("YYYY-MM-DD");if(!(this.bookings&&this.bookings[e]&&this.bookings[e][t]))return null;var n=this.bookings[e][t];for(var a in n)if(w(this.date).unix()>=n[a].start&&w(this.date).unix()<=n[a].end)return{email:a,start:n[a].start,end:n[a].end,checked_in:n[a].checked_in}}},{key:"book",value:function(){var e=this,t=this._service.Composer.bindings.module(this.system_id,"DeskBookings");t&&t.exec("book",[this.desk,w(this.date).unix()]).then((function(t){e._service.notifySuccess("The desk was booked successfully")}))}},{key:"check_in",value:function(){var e=this,t=this._service.Composer.bindings.module(this.system_id,"DeskBookings");t&&t.exec("check_in",[this.desk,!0]).then((function(t){e._service.notifySuccess("Checked in successfully")}))}},{key:"check_out",value:function(){var e=this,t=this._service.Composer.bindings.module(this.system_id,"DeskBookings");t&&t.exec("check_in",[this.desk,!1]).then((function(t){e._service.notifySuccess("Checked out successfully")}))}},{key:"loadLevel",value:function(){return localStorage?localStorage.getItem("STAFF.desk.level"):null}},{key:"onLevelChange",value:function(){localStorage&&localStorage.setItem("STAFF.desk.level",this.active_level)}},{key:"desks_list",get:function(){return this.bookings?Object.keys(this.bookings):[]}},{key:"on_level",get:function(){var e=this;return!(!this.desks_list||!this.desk||!this.desks_list.find((function(t){return t===e.desk})))}},{key:"map_url",get:function(){return(this._service.Organisation.levelWithID(this.active_level)||{map_url:""}).map_url||""}},{key:"belongs_to_user",get:function(){return this.current_booking&&this.current_booking.email===this.user.email}},{key:"available",get:function(){return!this.current_booking}}]),n}(s.a)).\u0275fac=function(e){return new(e||Bi)(l.Qb(c.a),l.Qb(i.a),l.Qb(i.d))},Bi.\u0275cmp=l.Kb({type:Bi,selectors:[["booking-desk-flow"]],features:[l.zb],decls:13,vars:13,consts:[[1,"desk-flow"],["class","bindings","hidden","",4,"ngIf"],[3,"zoom","center","src","css","listeners","features","focus","zoomChange","centerChange"],["diameter","32"],[1,"body"],["class","main",4,"ngIf"],["diameter","32",4,"ngIf"],[1,"header"],["overlay","",3,"level","levelChange",4,"ngIf"],[1,"date"],["position","left",3,"ngModel","ngModelChange"],["hidden","",1,"bindings"],["binding","","mod","DeskBookings",3,"model","sys","bind","modelChange"],[1,"main"],[1,"title"],[1,"name"],[3,"class",4,"ngIf"],["class","description",4,"ngIf"],[4,"ngIf"],["class","form-wrapper",4,"ngIf"],[1,"description"],["mat-button","",1,"button",3,"tapped"],[1,"user-name"],[1,"form-wrapper"],[1,"form"],[1,"text"],[3,"ngModel","ngModelChange"],[1,"footer"],["mat-button","","name","confirm",1,"success",3,"tapped"],["overlay","",3,"level","levelChange"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.Lc(1,Ti,2,3,"div",1),l.Wb(2,"a-map",2),l.lc("zoomChange",(function(e){return t.zoom=e}))("centerChange",(function(e){return t.center=e})),l.Rb(3,"mat-spinner",3),l.Vb(),l.Ub(4),l.Wb(5,"div",4),l.Lc(6,Fi,9,6,"div",5),l.Lc(7,Ei,4,0,"div",5),l.Lc(8,Ri,1,0,"mat-spinner",6),l.Vb(),l.Tb(),l.Wb(9,"div",7),l.Lc(10,qi,1,1,"a-map-controls",8),l.Wb(11,"div",9),l.Wb(12,"a-date-field",10),l.lc("ngModelChange",(function(e){return t.changeDate(e)})),l.Vb(),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Cb(1),l.vc("ngIf",t.system_id),l.Cb(1),l.vc("zoom",t.zoom)("center",t.center)("src",t.map_url)("css",t.style_map)("listeners",t.listeners)("features",t.features)("focus",t.focus),l.Cb(4),l.vc("ngIf",!t.loading&&t.on_level),l.Cb(1),l.vc("ngIf",!t.on_level),l.Cb(1),l.vc("ngIf",t.loading),l.Cb(2),l.vc("ngIf",t.active_level),l.Cb(2),l.vc("ngModel",t.date))},directives:[a.t,Wi.d,Ie.c,zi.a,r.r,r.u,o.a,M.b,j.c,Ii.a,Li.a],styles:[".desk-flow[_ngcontent-%COMP%]{height:100%;overflow:auto;display:flex;flex-direction:column}.desk-flow[_ngcontent-%COMP%]   a-map[_ngcontent-%COMP%]{height:55%;background-color:#fff}.desk-flow[_ngcontent-%COMP%]   a-map.large[_ngcontent-%COMP%]{height:70%}.desk-flow[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex:1;background-color:rgba(26,47,66,.97);padding:1.5em}.desk-flow[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{height:100%}.desk-flow[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{height:25%;font-size:1.2em;color:#fff}.desk-flow[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{font-weight:700}.desk-flow[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .available[_ngcontent-%COMP%]{color:#43a047}.desk-flow[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .unavailable[_ngcontent-%COMP%]{color:#e53935}.desk-flow[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin:1em 0}.desk-flow[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{margin-top:1em}.desk-flow[_ngcontent-%COMP%]   .user-name[_ngcontent-%COMP%]{color:#1937ea}.desk-flow[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%]{height:75%;display:flex;align-items:flex-start;justify-content:center}.desk-flow[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{background-color:#fff;padding:1em;border-radius:.5em}.desk-flow[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{margin-bottom:.5em}.desk-flow[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:1em}.desk-flow[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:absolute;width:100%;display:flex;padding:1em;justify-content:space-between;pointer-events:none}.desk-flow[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{pointer-events:auto}.desk-flow[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   a-map-controls[_ngcontent-%COMP%]{z-index:10}.desk-flow[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{background-color:#fff;z-index:10}"]}),Bi),Qi=n("Nuht"),Ui=n("DWOX"),Yi=n("ocbO"),Xi=n("4Uey"),Hi=n("p5rm"),Ki=n("q/nq"),Zi=n("4kJo"),Ji=n("A+eD"),er=n("vJ8U"),tr=n("1k4r"),nr=n("WE8N"),ar=n("CTJb"),ir=n("opQU"),rr=n("zx1i"),or=n("cH1L"),cr=n("dNgK"),sr=n("ihCf"),lr=n("bv9b"),ur=n("/1cH"),dr=n("STbY"),fr=n("q/DJ");n.d(t,"BookingsModule",(function(){return pr}));var mr,br=[{path:":flow",component:p},{path:":flow/:step",component:p},{path:"",redirectTo:"spaces"}],pr=((mr=function e(){_classCallCheck(this,e)}).\u0275mod=l.Ob({type:mr}),mr.\u0275inj=l.Nb({factory:function(e){return new(e||mr)},imports:[[a.c,i.h.forChild(br),h.a,r.l,r.B,o.b]]}),mr);l.Gc(p,[a.q,a.r,a.s,a.t,a.A,a.w,a.x,a.y,a.z,a.u,a.v,i.i,i.e,i.g,i.f,i.j,Wi.d,Wi.e,Wi.f,j.b,j.c,Qi.a,s.a,Ui.a,x.a,Yi.a,Xi.a,Hi.a,Ki.a,Zi.a,Ji.a,ui.a,Li.a,er.a,tr.a,zi.a,nr.a,Ii.a,ar.a,ir.a,rr.a,Vt.a,M.b,M.a,or.b,cr.b,C.e,C.d,C.i,C.f,C.c,V.a,V.b,V.e,V.f,V.g,V.h,V.i,sr.b,sr.c,W.a,W.c,Ie.a,Ie.c,lr.a,ur.a,Wa.g,Wa.f,ur.d,ur.c,Va.a,Va.c,J.d,J.a,J.c,J.e,J.b,J.f,Wa.j,dr.e,dr.b,dr.d,dr.a,Z.a,Z.c,jt.a,jt.c,ut.b,ut.a,P.c,P.d,P.a,P.f,P.e,P.b,me.a,me.b,me.c,me.d,r.H,r.w,r.G,r.c,r.x,r.A,r.a,r.D,r.E,r.z,r.r,r.s,r.C,r.n,r.m,r.y,r.b,r.d,r.u,r.v,r.t,r.g,r.j,r.h,r.k,r.e,o.a,p,Vi,bi,qe,ze,fe,li,ct,ni,Je,qa,Xt,Bt,xt,O.a,R,Oe,Gi],[a.b,a.G,a.p,a.k,a.E,a.g,a.C,a.F,a.d,a.f,a.i,a.j,a.l,fr.b,fr.c])}}]);