{"version":3,"sources":["./src/app/services/data/catering/catering.utilities.ts","./src/app/shell/booking/booking.component.ts.BookingComponent.html","./src/app/shell/booking/booking.component.ts","./src/app/shell/booking/booking.module.ts","./src/app/shell/booking/main-flow/catering/category-list/category-list.component.html","./src/app/shell/booking/main-flow/catering/category-list/category-list.component.ts","./src/app/shell/booking/main-flow/catering/catering-order/catering-order.component.html","./src/app/shell/booking/main-flow/catering/catering-order/catering-order.component.ts","./src/app/shell/booking/main-flow/catering/catering.component.html","./src/app/shell/booking/main-flow/catering/catering.component.ts","./src/app/shell/booking/main-flow/catering/item-list/item-list.component.html","./src/app/shell/booking/main-flow/catering/item-list/item-list.component.ts","./src/app/shell/booking/main-flow/catering/item-list/list-item/list-item.component.html","./src/app/shell/booking/main-flow/catering/item-list/list-item/list-item.component.ts","./src/app/shell/booking/main-flow/catering/order-list/item/item.component.html","./src/app/shell/booking/main-flow/catering/order-list/item/item.component.ts","./src/app/shell/booking/main-flow/catering/order-list/order-list.component.html","./src/app/shell/booking/main-flow/catering/order-list/order-list.component.ts","./src/app/shell/booking/main-flow/find-space/find-space.component.html","./src/app/shell/booking/main-flow/find-space/find-space.component.ts","./src/app/shell/booking/main-flow/find-space/space-item/space-item.component.html","./src/app/shell/booking/main-flow/find-space/space-item/space-item.component.ts","./src/app/shell/booking/main-flow/form/form.component.html","./src/app/shell/booking/main-flow/form/form.component.ts","./src/app/shell/booking/main-flow/main-flow.component.html","./src/app/shell/booking/main-flow/main-flow.component.ts"],"names":[],"mappings":"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","file":"shell-booking-booking-module-ngfactory-es2015.js","sourcesContent":["import { FormGroup, FormControl, Validators } from \"@angular/forms\";\n\nimport { CateringOrder } from \"./catering-order.class\";\n\nimport * as dayjs from 'dayjs';\n\nexport function generateCateringOrderFormFields(order: CateringOrder): FormGroup {\n    const form = new FormGroup({\n        items: new FormControl(order.items && order.items.length ? [...order.items] : [], [Validators.required]),\n        delivery_time: new FormControl(order.delivery_time || dayjs().startOf('m').valueOf(), [Validators.required]),\n        location_id: new FormControl(order.location_id || '', [Validators.required]),\n        charge_code: new FormControl(order.charge_code || '', [Validators.required]),\n        notes: new FormControl(order.notes || ''),\n    });\n    for (const key in form.controls) {\n        form.controls[key].valueChanges.subscribe((value) => order.storePendingChanges(key as any, value));\n    }\n    return form;\n}\n","<router-outlet></router-outlet>","\nimport { Component, OnInit } from '@angular/core';\n\nimport { AppService } from '../../services/app.service';\nimport { BaseComponent } from '../../shared/globals/base.component';\n\n@Component({\n    selector: 'app-booking',\n    template: '<router-outlet></router-outlet>',\n    styles: ['']\n})\nexport class BookingComponent extends BaseComponent implements OnInit {\n    public model: any = {};\n\n    constructor(private service: AppService) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.service.set('BANNER.block_height', 0);\n    }\n}\n","\nimport { NgModule, Type } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { ScrollingModule } from '@angular/cdk/scrolling';\nimport { RouterModule } from '@angular/router';\n\nimport { WidgetsModule } from '@acaprojects/ngx-widgets';\nimport { ACheckboxModule } from '@acaprojects/ngx-checkbox';\n\nimport { SharedComponentModule } from '../../shared/components/shared.module';\n\nimport { ROUTES } from './booking.routes';\n\nimport { BookingComponent } from './booking.component';\nimport { BookingMainFlowComponent } from './main-flow/main-flow.component';\nimport { BookingMainFlowFormComponent } from './main-flow/form/form.component';\nimport { BookingMainFlowFindSpaceComponent } from './main-flow/find-space/find-space.component';\nimport { BookingMainFlowSpaceItemComponent } from './main-flow/find-space/space-item/space-item.component';\nimport { BookingMainFlowCateringComponent } from './main-flow/catering/catering.component';\nimport { BookingMainFlowCateringOrderComponent } from './main-flow/catering/catering-order/catering-order.component';\nimport { BookingMainFlowCateringCategoryListComponent } from './main-flow/catering/category-list/category-list.component';\nimport { BookingMainFlowCateringItemListComponent } from './main-flow/catering/item-list/item-list.component';\nimport { BookingMainFlowCateringListItemComponent } from './main-flow/catering/item-list/list-item/list-item.component';\n\nimport { BookingCateringDetailsModalComponent } from './overlays/catering-details/catering-details.component';\nimport { BookingEquipmentDetailsModalComponent } from './overlays/equipment-details/equipment-details.component';\nimport { BookingDetailsModalComponent } from './overlays/booking-details/booking-details.component';\nimport { CateringOrderListComponent } from './main-flow/catering/order-list/order-list.component';\nimport { BookingCateringOrderItemComponent } from './main-flow/catering/order-list/item/item.component';\n\nconst COMPONENTS: Type<any>[] = [\n    BookingComponent,\n    BookingMainFlowComponent,\n    BookingMainFlowFormComponent,\n\n    BookingMainFlowFindSpaceComponent,\n    BookingMainFlowSpaceItemComponent,\n\n    BookingMainFlowCateringComponent,\n    BookingMainFlowCateringOrderComponent,\n    BookingMainFlowCateringCategoryListComponent,\n    BookingMainFlowCateringItemListComponent,\n    BookingMainFlowCateringListItemComponent,\n    CateringOrderListComponent,\n    BookingCateringOrderItemComponent\n];\n\nexport const BOOKING_ENTRY_COMPONENTS: Type<any>[] = [\n    BookingEquipmentDetailsModalComponent,\n    BookingCateringDetailsModalComponent,\n    BookingDetailsModalComponent\n];\n\n@NgModule({\n    declarations: [\n        ...COMPONENTS\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        WidgetsModule,\n        RouterModule.forChild(ROUTES),\n        SharedComponentModule,\n        ScrollingModule,\n        ACheckboxModule\n    ],\n})\nexport class AppBookingModule { }\n","<div class=\"catering-category-list\">\n    <div\n        class=\"card\"\n        *ngFor=\"let item of types\"\n        [attr.cant-order]=\"exclude && !item.order_anytime\"\n        (touchrelease)=\"selectItem(item)\"\n        [style.background-image]=\"(item.image_url ? 'url(' + item.image_url + ')' : '') | safestyle\"\n    >\n        <div class=\"overlay\"></div>\n        <div class=\"text\">{{ item.name }}</div>\n    </div>\n</div>\n","\nimport { Component, OnInit, Input, Output, EventEmitter, SimpleChanges } from '@angular/core';\n\nimport { AppService } from '../../../../../services/app.service';\nimport { BaseComponent } from '../../../../../shared/globals/base.component';\nimport { IRoom } from '../../../../../services/data/rooms.service';\nimport { CateringCategory } from '../../../../../services/data/catering/catering-category.class';\n\n@Component({\n    selector: 'catering-category-list',\n    templateUrl: './category-list.component.html',\n    styleUrls: ['./category-list.component.scss']\n})\nexport class BookingMainFlowCateringCategoryListComponent extends BaseComponent implements OnInit {\n    /** Space selected to add catering to */\n    @Input() public space: IRoom;\n    /** List of available catering item categories */\n    @Input() public types: CateringCategory[];\n    /** Whether booking is within the catering exclusion period */\n    @Input() public exclude: boolean;\n    /** Emitter for the selected category */\n    @Output() public selected = new EventEmitter<CateringCategory>();\n\n    public packages: CateringCategory;\n\n    constructor(private _service: AppService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n    }\n\n    public selectItem(item: CateringCategory) {\n        this.selected.emit(item);\n    }\n}\n","<div class=\"details\">\n    <div class=\"title\">Order Details</div>\n    <div class=\"count\">{{ count || '0' }} item{{ count === 1 ? '' : 's' }} selected</div>\n</div>\n<div class=\"contents\" [class.show]=\"show\">\n    <div class=\"rooms\" [attr.space-id]=\"order.location_id\">\n        <div\n            class=\"item\"\n            *ngFor=\"let item of items?.value || []\"\n            [attr.cant-order]=\"exclude && exclude[order.location_id] && !item.order_anytime\"\n        >\n            <div class=\"item-details\">\n                <div class=\"name\">{{ item.name }}</div>\n                <div class=\"cost\">\n                    {{ (item.amount * item.unit_price) / 100 | currency: symbol }}\n                </div>\n            </div>\n            <div\n                class=\"amount\"\n                title=\"Ctrl + Click to add/remove 10\nShift + Click to add/remove 100\"\n            >\n                <div\n                    class=\"icon less\"\n                    [class.disabled]=\"!item.amount || item.amount < 1\"\n                    (touchrelease)=\"change(item, -step)\"\n                    click-responder\n                >\n                    <i class=\"material-icons\">remove</i>\n                </div>\n                <div class=\"value\">{{ item.amount }}</div>\n                <div\n                    class=\"icon more\"\n                    [class.disabled]=\"item.amount >= (item.maximum || 100)\"\n                    (touchrelease)=\"change(item, step)\"\n                    click-responder\n                >\n                    <i class=\"material-icons\">add</i>\n                </div>\n            </div>\n        </div>\n        <div class=\"total\">\n            <span>Total:</span>\n            {{ total / 100 || 0 | currency: symbol }}\n        </div>\n    </div>\n</div>\n<!-- <div class=\"total\"><span>Order Total:</span> {{ total / 100 | currency }}</div> -->\n<div class=\"info\" *ngIf=\"show\">\n    *Orders are subject to a <span>48 hour limit</span> for cancellation ahead of a meeting\n</div>\n<div class=\"option\">\n    <btn (tapped)=\"event.emit({ type: 'next' })\" [disabled]=\"!valid\"\n        >Save order</btn\n    >\n</div>\n","import { Component, OnInit, EventEmitter, Input, Output } from '@angular/core';\nimport { ADynamicFormField } from '@acaprojects/ngx-dynamic-forms';\n\nimport { IBookingFlowEvent } from '../../main-flow.component';\nimport { BaseComponent } from '../../../../../shared/globals/base.component';\nimport { AppService } from '../../../../../services/app.service';\nimport { IRoom } from '../../../../../services/data/rooms.service';\nimport { CateringOrder } from '../../../../../services/data/catering/catering-order.class';\nimport { CateringCategory } from '../../../../../services/data/catering/catering-category.class';\nimport { CateringItem } from '../../../../../services/data/catering/catering-item.class';\nimport { FormControl } from '@angular/forms';\n\nexport interface ICateringOrderList {\n    [room_id: string]: ICateringOrder;\n}\n\nexport interface ICateringOrder {\n    room_id: string;\n    name?: string;\n    items: ICateringItem[];\n    total: number;\n    count?: number;\n    symbol?: string;\n}\n\nexport interface ICateringItem {\n    id: string;\n    name?: string;\n    amount: number;\n    unit_cost: number;\n    maximum?: number;\n    minimum?: number;\n}\n\n@Component({\n    selector: 'catering-order',\n    templateUrl: './catering-order.component.html',\n    styleUrls: ['./catering-order.component.scss']\n})\nexport class BookingMainFlowCateringOrderComponent extends BaseComponent {\n    /** List of rooms selected for the booking */\n    @Input() spaces: IRoom[];\n    /** Form field for storing catering data for the booking */\n    @Input() order: CateringOrder;\n    /** Form field for storing catering data for the booking */\n    @Input() items: FormControl;\n    /** Show contents of the order */\n    @Input() public show: boolean;\n    /** Step value for adding catering items */\n    @Input() public step: number = 1;\n    /** Whether booking is within the catering exclusion period */\n    @Input() public exclude: { [space_id: string]: boolean };\n    /** Emitter for form events */\n    @Output() public event = new EventEmitter<IBookingFlowEvent>();\n\n    constructor(private _service: AppService) {\n        super();\n    }\n\n    /** Whether catering order is valid */\n    public get valid(): boolean {\n        if (!this.items) return true;\n        const list = this.items.value || [];\n        return list.reduce((v, i) => v && (i instanceof CateringCategory ? i.items : []).reduce((v, j) => v && this.isValid(j), true), true);\n    }\n\n    /**\n     * Whether the given catering item/package is valid\n     * @param item\n     */\n    private isValid(item) {\n        if (!this.items) return true;\n        if (item.must_select && item.amount) {\n            return item.must_select <= item.items.reduce((v, i) => v + (i.selected ? 1 : 0), 0);\n        } else if (item.items) {\n            return item.items.reduce((v, i) => v && this.isValid(i), true);\n        }\n        return true;\n    }\n\n    /** Number of total items in all room orders */\n    public get count(): number {\n        if (!this.items) return 0;\n        const list = this.items.value || [];\n        return list.reduce((total, item) => total + item.amount, 0);\n    }\n\n    /** Total cost for all room orders */\n    public get total() {\n        if (!this.items) return 0;\n        const list = this.items.value || [];\n        return list.reduce((total, item) => total + item.total, 0);\n    }\n\n    public get symbol(): string {\n        if (!this.order) return 'USD';\n        const space = this._service.Rooms.list(true).find(room => room.id === this.order.location_id);\n        const building = this._service.Buildings.get(space.level.bld_id) || {} as any;\n        return building.currency || 'USD';\n    }\n\n    public change(item: CateringItem, amount: number) {\n        if (amount < 0) {\n            item.removeFromOrder(amount);\n        } else {\n            item.addToOrder(amount);\n        }\n        this.items.setValue(this.items.value);\n    }\n}\n","<div\n    class=\"catering\"\n    (window:keydown.control)=\"enableModifer('control')\"\n    (window:keyup.control)=\"disableModifer('control')\"\n    (window:keydown.shift)=\"enableModifer('shift')\"\n    (window:keyup.shift)=\"disableModifer('shift')\"\n    *ngIf=\"order_form\"\n>\n    <div class=\"topbar\">\n        <div class=\"icon\" (touchrelease)=\"event.emit({ type: 'previous' })\">\n            <i class=\"material-icons\">arrow_back</i>\n        </div>\n        <div class=\"text\" (touchrelease)=\"event.emit({ type: 'previous' })\">Order List</div>\n    </div>\n    <div class=\"header\">\n        <div class=\"search\">\n            <input\n                [(ngModel)]=\"search_str\"\n                (ngModelChange)=\"search()\"\n                placeholder=\"Type to search\"\n            />\n            <div class=\"icon\">\n                <i class=\"material-icons\">search</i>\n            </div>\n            <div class=\"icon\" [class.disabled]=\"!search_str\" (touchrelease)=\"search_str = ''\">\n                <i class=\"material-icons\">close</i>\n            </div>\n        </div>\n        <div class=\"room-list\" *ngIf=\"spaces && spaces.length > 0\">\n            <div class=\"group\">\n                Deliver to:&nbsp;\n                <div class=\"set-space\">\n                    <dropdown\n                        klass=\"form\"\n                        [list]=\"spaces\"\n                        [model]=\"space_index\"\n                        (modelChange)=\"setSpace(spaces[$event])\"\n                    ></dropdown>\n                </div>\n            </div>\n            <div class=\"group\">\n                At:&nbsp;\n                <div class=\"set-delivery-time\">\n                    <dropdown\n                        klass=\"form\"\n                        [list]=\"delivery_times\"\n                        [model]=\"time_index\"\n                        (modelChange)=\"\n                            order_form?.controls.delivery_time.setValue(delivery_times[$event].id)\n                        \"\n                    ></dropdown>\n                </div>\n            </div>\n        </div>\n    </div>\n    <ng-container *ngIf=\"active_space && !loading[active_space.id]; else loader\">\n        <div class=\"body\" *ngIf=\"catering_allowed; else no_catering_allowed\">\n            <catering-category-list\n                *ngIf=\"!category\"\n                [types]=\"menu_map[active_space.id]\"\n                [exclude]=\"within_exclusion_period\"\n                (selected)=\"category = $event\"\n            ></catering-category-list>\n            <catering-item-list\n                *ngIf=\"category\"\n                [step]=\"step\"\n                [space]=\"active_space\"\n                [category]=\"category\"\n                [items]=\"order_form?.controls.items\"\n                [exclude]=\"within_exclusion_period\"\n                (event)=\"category = null\"\n            ></catering-item-list>\n            <div\n                class=\"no-catering\"\n                *ngIf=\"\n                    active_space &&\n                    (!menu_map[active_space.id] || menu_map[active_space.id].length <= 0)\n                \"\n            >\n                <div class=\"icon\">\n                    <img\n                        [alt]=\"is_catered ? 'Concierge Catering' : 'No Catering Available'\"\n                        [src]=\"\n                            is_catered ? 'assets/img/concierge.svg' : 'assets/img/no-catering.svg'\n                        \"\n                    />\n                </div>\n                <p>\n                    <ng-container *ngIf=\"is_catered; else no_catering\">\n                        Concierge will be in touch for\n                        {{ active_building.name }} catered rooms\n                    </ng-container>\n                    <ng-template #no_catering>\n                        Catering is <span>not available</span> in Converge for\n                        {{ active_building.name }} spaces. Please contact the local office for more\n                        information.\n                    </ng-template>\n                </p>\n                <div class=\"toggle\" *ngIf=\"is_catered\">\n                    <a-checkbox\n                        [(ngModel)]=\"has_catering\"\n                        [label]=\"\n                            'Add catering to ' + (active_space.number || active_space.name) + '?'\n                        \"\n                    ></a-checkbox>\n                </div>\n            </div>\n        </div>\n    </ng-container>\n    <div class=\"footer\">\n        <div class=\"order-list\" [class.show]=\"show_order\">\n            <div class=\"bar\" (touchrelease)=\"show_order = !show_order\"></div>\n            <catering-order\n                [spaces]=\"spaces\"\n                [step]=\"step\"\n                [order]=\"order\"\n                [items]=\"order_form.controls.items\"\n                [show]=\"show_order\"\n                [exclude]=\"exclusion_map\"\n                (event)=\"event.emit($event)\"\n            ></catering-order>\n        </div>\n    </div>\n</div>\n<ng-template #loader>\n    <div class=\"body\">\n        <div class=\"no-item\">\n            <div class=\"icon\">\n                <spinner type=\"circle-ring\" color=\"rgba(0,0,0, .35)\"></spinner>\n            </div>\n            <div class=\"text\">Loading menu data...</div>\n        </div>\n    </div>\n</ng-template>\n<ng-template #no_catering_allowed>\n    <div class=\"body\">\n        <div class=\"no-catering margin\">\n            <div class=\"icon\">\n                <img alt=\"No Catering Available\" src=\"assets/img/no-catering.svg\" />\n            </div>\n            <p>\n                Catering is <span class=\"bold\">not available</span> for this booking.<br />\n                Catering must be ordered within business hours\n                <span *ngIf=\"active_building.catering_restricted_from\">\n                    at least {{ active_building.catering_restricted_from || '0' }} hours in advance\n                    for meetings\n                </span>\n                at {{ active_building.name }}.\n            </p>\n        </div>\n    </div>\n</ng-template>\n","import { Component, Input, EventEmitter, Output, OnChanges, SimpleChanges } from '@angular/core';\nimport { ADynamicFormField } from '@acaprojects/ngx-dynamic-forms';\n\nimport { IBookingFlowEvent } from '../main-flow.component';\nimport { IRoom } from '../../../../services/data/rooms.service';\nimport { BaseComponent } from '../../../../shared/globals/base.component';\nimport { AppService } from '../../../../services/app.service';\nimport { IBuilding } from '../../../../services/data/buildings.service';\n\nimport * as dayjs from 'dayjs';\nimport { CateringCategory } from '../../../../services/data/catering/catering-category.class';\nimport { CateringOrder } from '../../../../services/data/catering/catering-order.class';\nimport { generateCateringOrderFormFields } from '../../../../services/data/catering/catering.utilities';\nimport { FormGroup } from '@angular/forms';\nimport { Identity } from '../../../../shared/utilities/types.interfaces';\n\n@Component({\n    selector: 'booking-main-flow-catering',\n    templateUrl: './catering.component.html',\n    styleUrls: ['./catering.component.scss']\n})\nexport class BookingMainFlowCateringComponent extends BaseComponent implements OnChanges {\n    /** Booking ID */\n    @Input() id: string;\n    /** List of rooms selected for the booking */\n    @Input() spaces: IRoom[];\n    /** Start time of the current booking */\n    @Input() all_day = false;\n    /** Start time of the current booking */\n    @Input() date: number;\n    /** Length of the current booking in minutes */\n    @Input() duration: number;\n    /** Form field for storing catering data for the booking */\n    @Input() order: CateringOrder;\n    /** Emitter for form events */\n    @Output() public event = new EventEmitter<IBookingFlowEvent>();\n\n    /** Mapping of rooms to loading states */\n    public loading: { [id: string]: boolean } = {};\n    /** Mapping of room ids to available menu categories */\n    public menu_map: { [room_id: string]: CateringCategory[] } = {};\n    /** Selected menu category */\n    public category: CateringCategory;\n    /** Value to filter menu items on */\n    public search_str: string;\n    /** Active room to add catering items to */\n    public active_space: IRoom;\n\n    public show_order: boolean;\n    /** State of modifier keys */\n    public key_states: { shift: boolean; control: boolean } = { shift: false, control: false };\n    /** Step value for adding catering items */\n    public step: number = 1;\n    /** Form fields for the order */\n    public order_form: FormGroup;\n    /** List of available booking times */\n    public delivery_times: Identity[];\n\n    public get space_index(): number {\n        return Math.max(\n            0,\n            (this.spaces || []).findIndex(\n                space => space.id === this.order_form.controls.location_id.value\n            )\n        );\n    }\n\n    public get time_index(): number {\n        return Math.max(\n            0,\n            (this.delivery_times || []).findIndex(\n                block => block.id === this.order_form.controls.delivery_time.value\n            )\n        );\n    }\n\n    constructor(private _service: AppService) {\n        super();\n    }\n\n    public get active_building(): IBuilding {\n        if (this.active_space && this.active_space.level) {\n            const building = this._service.Buildings.get(this.active_space.level.bld_id);\n            return building || ({} as any);\n        }\n        return {} as any;\n    }\n\n    /** Whether catering can be provided if no menu is available */\n    public get is_catered() {\n        return !!this.active_building.has_catering;\n    }\n\n    /** Whether catering is allowed for the current time */\n    public get catering_allowed(): boolean {\n        if (this.delivery_times[0].id < 0) { return false; }\n        if ((this.menu_map[this.active_space.id] || []).find(category => category.order_anytime)) {\n            return true;\n        }\n        return !this.within_exclusion_period;\n    }\n\n    /** Whether booking time is within the building's exlusion period for catering  */\n    public get within_exclusion_period(): boolean {\n        if (!this.active_building.catering_restricted_from) {\n            return false;\n        }\n        return this.isExcluded(this.active_building.catering_restricted_from);\n    }\n\n    public isExcluded(restriction_time: number): boolean {\n        const now = dayjs().startOf('m');\n        const start = dayjs(this.date)\n            .startOf('m')\n            .second(1);\n        let end = start.subtract(restriction_time || -900, 'h');\n        if (end.format('ddd') === 'Sun' || end.format('ddd') === 'Sat') {\n            end = end.subtract(2, 'd');\n        }\n        return now.isAfter(end, 's');\n    }\n\n    public get exclusion_map(): { [key: string]: boolean } {\n        const exclusions: { [key: string]: boolean } = {};\n        const building_list = this._service.Buildings.list();\n        for (const space of this.spaces) {\n            const bld = building_list.find(bld => bld.id === space.level.bld_id);\n            if (bld) {\n                exclusions[space.id] = this.isExcluded(bld.catering_restricted_from);\n            }\n        }\n        return exclusions;\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.spaces && this.spaces) {\n            if (\n                !this.active_space ||\n                this.spaces.findIndex(i => i.id === this.active_space.id) < 0\n            ) {\n                this.active_space = this.spaces[0];\n            }\n            this.loadMenu();\n        }\n        if (changes.date || changes.duration) {\n            this.delivery_times = this.generateAvailableTimes();\n        }\n        if (changes.order && this.order) {\n            this.order_form = generateCateringOrderFormFields(this.order);\n        }\n    }\n\n    /**\n     * Load menu categories for the selected rooms\n     */\n    public loadMenu() {\n        if (this.spaces && this.spaces instanceof Array) {\n            this.spaces.forEach(space => {\n                this.loading[space.id] = true;\n                this.menu_map[space.id] = null;\n                this._service.Menu.query({ room_id: space.id }).then(\n                    list => {\n                        this.loading[space.id] = false;\n                        this.menu_map[space.id] = (list || []) as CateringCategory[];\n                    },\n                    () => {\n                        this.loading[space.id] = false;\n                        this.menu_map[space.id] = [];\n                    }\n                );\n            });\n        }\n    }\n\n    /**\n     * Update the active space\n     * @param space New active space\n     */\n    public setSpace(space: IRoom) {\n        this.category = null;\n        this.order_form.controls.location_id.setValue(space.id);\n        this.order_form.controls.items.setValue([]);\n        this.order.storePendingChanges('location', space.name);\n        this.timeout('set_space', () => (this.active_space = space), 100);\n    }\n\n    /**\n     * Filter category items\n     */\n    public search() {\n        if (this.active_space && this.search_str) {\n            const search = this.search_str.toLowerCase();\n            const categories = this.menu_map[this.active_space.id];\n            const list = {\n                id: 'search',\n                name: 'Search results',\n                src: '',\n                package: false,\n                zones: [],\n                items: categories.reduce((v, i) => {\n                    v = v.concat(\n                        i.items.filter((j: any) => {\n                            if (j.items) {\n                                return (\n                                    j.name.toLowerCase().indexOf(search) >= 0 ||\n                                    j.items.findIndex(\n                                        k => k.name.toLowerCase().indexOf(search) >= 0\n                                    ) >= 0\n                                );\n                            }\n                            return j.name.toLowerCase().indexOf(search) >= 0;\n                        })\n                    );\n                    return v;\n                }, [])\n            };\n            this.category = new CateringCategory(list);\n        } else {\n            this.category = null;\n        }\n    }\n\n    /** Enable a step modifier key */\n    public enableModifer(mod: 'shift' | 'control') {\n        this.key_states[mod] = true;\n        this.updateStep();\n    }\n\n    /** Disable a step modifier key */\n    public disableModifer(mod: 'shift' | 'control') {\n        this.key_states[mod] = false;\n        this.updateStep();\n    }\n\n    /** Update the increment and decrement step value */\n    public updateStep() {\n        this.step = this.key_states.shift ? 100 : this.key_states.control ? 10 : 1;\n    }\n\n    /** Generate list of available delivery times */\n    public generateAvailableTimes(): Identity[] {\n        const time_list: Identity[] = [];\n        if (this.date) {\n            let start = dayjs(this.date).startOf('m');\n            const old_start = start;\n            let end = start.add(this.duration, 'm');\n            if (start.isBefore(start.hour(7).minute(0), 'm') || this.all_day) {\n                start = start.hour(7).minute(0);\n                const now = dayjs().startOf('m');\n                if (start.isBefore(now, 'm')) {\n                    start = now.minute(Math.ceil(now.minute() / 5) * 5);\n                }\n            }\n            start = start.minute(Math.ceil(start.minute() / 5) * 5);\n            if (end.isAfter(start.hour(20).minute(0), 'm') || this.all_day) {\n                end = start.hour(20).minute(0);\n            }\n            let duration = Math.abs(old_start.diff(start, 'm'));\n            while (start.isBefore(end, 'm')) {\n                time_list.push({ id: duration, name: start.format('h:mm A') });\n                start = start.add(5, 'm');\n                duration += 5;\n            }\n            if (time_list.length <= 0) {\n                time_list.push({ id: -(90 * 24 * 60), name: 'Outside of hours' });\n            }\n            console.log('Time list:', time_list);\n        }\n        return time_list;\n    }\n}\n","<div class=\"catering-item-list\">\n    <div class=\"category-header\">\n        <div class=\"heading\">{{ category.name }}</div>\n        <div class=\"back\" (touchrelease)=\"event.emit()\">\n            <div class=\"icon\">\n                <i class=\"material-icons\">keyboard_arrow_left</i>\n            </div>\n            <div class=\"text\">Categories</div>\n        </div>\n    </div>\n    <ng-container *ngIf=\"category && category.items && category.items.length > 0; else empty\">\n        <div class=\"item\" *ngFor=\"let item of category.items\">\n            <catering-item [exclude]=\"exclude\" [step]=\"step\" [space]=\"space\" [items]=\"items\" [parent]=\"category\" [item]=\"item\"></catering-item>\n        </div>\n    </ng-container>\n    <ng-template #empty>\n        <div class=\"no-item\">\n            <div class=\"icon\">\n                <i class=\"material-icons\">close</i>\n            </div>\n            <div class=\"text\">No matching items</div>\n        </div>\n    </ng-template>\n</div>","\nimport { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { ADynamicFormField } from '@acaprojects/ngx-dynamic-forms';\n\nimport { BaseComponent } from '../../../../../shared/globals/base.component';\nimport { IRoom } from '../../../../../services/data/rooms.service';\nimport { CateringCategory } from '../../../../../services/data/catering/catering-category.class';\nimport { FormControl } from '@angular/forms';\n\n@Component({\n    selector: 'catering-item-list',\n    templateUrl: './item-list.component.html',\n    styleUrls: ['./item-list.component.scss']\n})\nexport class BookingMainFlowCateringItemListComponent extends BaseComponent {\n    /** Space selected to add catering to */\n    @Input() public space: IRoom;\n    /** Selected category of items to display */\n    @Input() public category: CateringCategory;\n    /** Whether booking is within the catering exclusion period */\n    @Input() public exclude: boolean;\n    /** Field for storing ordered catering items */\n    @Input() public items: FormControl;\n    /** Step value for adding catering items */\n    @Input() public step: number = 1;\n    /** Event emitter for item listings */\n    @Output() public event = new EventEmitter();\n\n}\n\n","<div\n    class=\"catering-list-item\"\n    [attr.item-id]=\"item?.id\"\n    [class.simple]=\"simple\"\n    [attr.cant-order]=\"exclude && !item.order_anytime\"\n    (touchrelease)=\"parent.must_select && !item.package ? toggle() : ''\"\n>\n    <div class=\"details\">\n        <div\n            class=\"image\"\n            [style.background-image]=\"(item.image_url ? 'url(' + item.image_url + ')' : '') | safestyle\"\n        >\n        </div>\n        <div class=\"info\" (touchrelease)=\"show_list = !show_list\">\n            <div class=\"name\">{{ item.name }}</div>\n            <div class=\"count\" *ngIf=\"!item.package\">\n                {{ item.unit_price / 100 | currency: symbol }}\n                {{\n                    (item.unit_price ? '| ' : '') + item.description ||\n                        (item.items ? 'Selection of ' + item.items.length + ' items' : '') ||\n                        'No description'\n                }}\n            </div>\n            <div class=\"count\" *ngIf=\"item.package\">\n                {{ item.unit_price / 100 | currency: symbol }}\n                {{ item.description ? (item.unit_price ? '| ' : '') + item.description : '' }}\n                {{ item.minimum_quantity ? ' | Minimum of ' + item.minimum_quantity : '' }}\n                {{ item.must_select ? ' | Select ' + item.must_select + ' from the below options' : '' }}\n            </div>\n        </div>\n        <div\n            class=\"amount\"\n            *ngIf=\"!parent.package && !parent.must_select && item.unit_price; else radio_option\"\n            title=\"Ctrl + Click to add/remove 10\nShift + Click to add/remove 100\"\n        >\n            <div\n                class=\"icon less\"\n                [class.disabled]=\"!item.amount || item.amount <= 0\"\n                (touchrelease)=\"remove(item)\"\n                click-responder\n            >\n                <i class=\"material-icons\">remove</i>\n            </div>\n            <div class=\"value\">{{ item.amount || '0' }}</div>\n            <div\n                class=\"icon more\"\n                [class.disabled]=\"item.amount >= (item.maximum_quantity || 100)\"\n                (touchrelease)=\"add(item)\"\n                click-responder\n            >\n                <i class=\"material-icons\">add</i>\n            </div>\n        </div>\n        <ng-template #radio_option>\n            <div class=\"amount select\" *ngIf=\"!item.package\">\n                <radio-btn *ngIf=\"parent.must_select === 1\" [model]=\"selected\"></radio-btn>\n                <a-checkbox *ngIf=\"parent.must_select > 1\" [ngModel]=\"selected\"></a-checkbox>\n            </div>\n        </ng-template>\n    </div>\n    <div class=\"sub-items\" *ngIf=\"item && item.items\" [@show]=\"show_list ? 'show' : 'hide'\">\n        <div class=\"item\" *ngFor=\"let itm of item.items\" [class.selection]=\"itm.items && itm.items.length > 0\">\n            <catering-item\n                [simple]=\"true\"\n                [space]=\"space\"\n                [items]=\"items\"\n                [parent]=\"item\"\n                [item]=\"itm\"\n                (amountChange)=\"handleSelect(itm)\"\n            ></catering-item>\n            <div class=\"bar\"></div>\n        </div>\n    </div>\n</div>\n","\nimport { trigger, state, style, animate, transition } from '@angular/animations';\nimport { Component, Input, SimpleChanges, Output, EventEmitter } from '@angular/core';\nimport { FormControl } from '@angular/forms';\n\nimport { BaseComponent } from '../../../../../../shared/globals/base.component';\nimport { IRoom } from '../../../../../../services/data/rooms.service';\nimport { AppService } from '../../../../../../services/app.service';\nimport { CateringCategory } from '../../../../../../services/data/catering/catering-category.class';\nimport { CateringItem } from '../../../../../../services/data/catering/catering-item.class';\n\n@Component({\n    selector: 'catering-item',\n    templateUrl: './list-item.component.html',\n    styleUrls: ['./list-item.component.scss'],\n    animations: [\n        trigger('show', [\n            state('show', style({ opacity: 1, height: '*' })),\n            state('hide', style({ opacity: 0, height: 0 })),\n            transition('show <=> hide', animate('200ms')),\n        ])\n    ]\n})\nexport class BookingMainFlowCateringListItemComponent extends BaseComponent {\n    /** Simple display of details */\n    @Input() simple: boolean;\n    /** Space selected to add catering to */\n    @Input() public space: IRoom;\n    /** Catering parent group or category */\n    @Input() public parent: CateringCategory;\n    /** Catering item or item group */\n    @Input() public item: CateringCategory;\n    /** Whether booking is within the catering exclusion period */\n    @Input() public exclude: boolean;\n    /** Field for storing ordered catering items */\n    @Input() public items: FormControl;\n    /** Whether the item can be selected */\n    @Input() public disabled: number;\n    /** Step value for adding catering items */\n    @Input() public step: number = 1;\n    /** Emitter for changes to the selected amount of the item */\n    @Output() public amountChange = new EventEmitter<number>();\n\n    /** Whether to show list of sub items */\n    public show_list: boolean;\n\n    constructor(private _service: AppService) {\n        super();\n    }\n\n    /** Currency code for the active space */\n    public get symbol(): string {\n        const level = this.space.level || {} as any;\n        const building = this._service.Buildings.get(level.bld_id) || {}  as any;\n        return building.currency || 'USD';\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.items && this.items) {\n            this.subscription('control', this.items.valueChanges.subscribe(() => this.updateAmounts()));\n        }\n        if (changes.space && this.space) {\n            this.updateAmounts()\n        }\n    }\n\n    /**\n     * Add the given item from the catering order\n     * @param item Item to add\n     */\n    public add(new_item: CateringItem | CateringCategory) {\n        if (this.items) {\n            const items: CateringItem[] = this.items.value || [];\n            if (!items.find(item => item.id === new_item.id)) {\n                items.push(new_item instanceof CateringCategory ? new CateringCategory(new_item) : new CateringItem(new_item));\n            }\n            const item = items.find(item => item.id === new_item.id);\n            item.addToOrder();\n            this.items.setValue(items);\n            this.amountChange.emit(item.amount);\n        }\n    }\n\n    /**\n     * Remove the given item from the catering order\n     * @param item Item to remove\n     */\n    public remove(existing_item: CateringItem | CateringCategory) {\n        if (this.items && this.space) {\n            const items: CateringItem[] = this.items.value || [];\n            const item = items.find(item => item.id === existing_item.id);\n            if (item) {\n                item.removeFromOrder();\n                if (item.amount === 0) {\n                    items.splice(items.indexOf(item), 1);\n                    this.items.setValue(items);\n                }\n                this.updateAmounts();\n                this.amountChange.emit(item.amount);\n            }\n        }\n    }\n\n    /**\n     * Toggle the activation state of the item\n     */\n    public toggle() {\n        if (this.item.amount === 0) {\n            this.add(this.item);\n        } else {\n            this.remove(this.item);\n        }\n    }\n\n    public handleSelect(item: CateringItem | CateringCategory) {\n        if (this.item instanceof CateringCategory) {\n            if (this.item.must_select === 1) {\n                for (const i of this.item.items) {\n                    if (i.amount === 0) {\n                        i.addToOrder();\n                    }\n                }\n            } else if (this.item.must_select > 1 && item.amount > 0) {\n                const active = this.item.items.reduce((v, i) => v + (i.amount > 0 ? 1 : 0), 0);\n                if (active > this.item.must_select) {\n                    let diff = active - this.item.must_select;\n                    for (const i of this.item.items) {\n                        if (diff > 0 && i.amount > 0 && !(item.id === i.id || item.name === i.name)) {\n                            this.item.setAmount(0);\n                            diff--;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    public updateAmounts() {\n        if (this.items) {\n            const items: CateringItem[] = this.items.value || [];\n            const item = items.find(item => this.item.id === item.id);\n            if (item && item !== this.item && item.amount !== this.item.amount) {\n                this.item.setAmount(item.amount);\n            } else {\n                this.item.setAmount(0);\n            }\n        }\n    }\n}\n","<div class=\"delivery-time\">{{ time }}</div>\n<div class=\"location\">{{ location }}</div>\n<div class=\"count\">\n    {{ count || \"0\" }} Item{{ count === 1 ? \"\" : \"s\" }}\n</div>\n<div class=\"cost\">\n    {{ total / 100 | currency:symbol }}\n</div>\n<div class=\"actions\" *ngIf=\"!expired\">\n    <button *ngIf=\"!order.error\" (touchrelease)=\"edit.emit()\">\n        <i class=\"material-icons\">edit</i>\n    </button>\n    <button (touchrelease)=\"delete.emit()\">\n        <i class=\"material-icons\">delete</i>\n    </button>\n</div>\n","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\n\nimport { CateringOrder } from '../../../../../../services/data/catering/catering-order.class';\nimport { CateringItem } from '../../../../../../services/data/catering/catering-item.class';\nimport { AppService } from '../../../../../../services/app.service';\n\nimport * as dayjs from 'dayjs';\n\n@Component({\n    selector: 'catering-order-list-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss']\n})\nexport class BookingCateringOrderItemComponent implements OnInit {\n    /** Catering order to display */\n    @Input() public order: CateringOrder;\n    /** Emitter for edit events */\n    @Output() public edit = new EventEmitter<void>();\n    /** Emitter for delete events */\n    @Output() public delete = new EventEmitter<void>();\n\n    public get expired(): boolean {\n        if (!this.order) return false;\n        const time =\n            (this.order.changes ? this.order.changes.delivery_time : null) ||\n            this.order.delivery_time;\n        return dayjs().isAfter(dayjs(this.order.booking_date).add(time, 'm'), 's');\n    }\n\n    constructor(private _service: AppService) { }\n\n    /** Display string for the delivery location of the order */\n    public get location(): string {\n        if (!this.order) return 'No Location';\n        if (this.order.changes && this.order.changes.location_id) {\n            const space = (this._service.Rooms.list(true) || []).find(room => room.id = this.order.changes.location_id) || {};\n            return space.name;\n        }\n        return this.order.location;\n    }\n\n    /** Display string for the set delivery time */\n    public get time(): string {\n        if (!this.order) return 'No Delivery Time';\n        const duration =\n            (this.order.changes ? this.order.changes.delivery_time : null) ||\n            this.order.delivery_time;\n        return dayjs(this.order.booking_date).add(duration, 'm').format('h:mm A');\n    }\n\n    /** Number of items in the order */\n    public get count(): number {\n        if (!this.order) return 0;\n        const items: CateringItem[] =\n            (this.order.changes ? this.order.changes.items : null) || this.order.items;\n        return (items || []).reduce((total, item) => total + item.amount, 0);\n    }\n\n    /** Total cost of the items in the order */\n    public get total(): number {\n        if (!this.order) return 0;\n        const items: CateringItem[] =\n            (this.order.changes ? this.order.changes.items : null) || this.order.items;\n        return (items || []).reduce((total, item) => total + item.total, 0);\n    }\n\n    /** Current symbol for the order */\n    public get symbol(): string {\n        if (!this.order) return 'USD';\n        const space = this._service.Rooms.list(true).find(room => room.id === this.order.location_id);\n        if (!space) return 'USD';\n        const building = this._service.Buildings.get(space.level.bld_id) || {} as any;\n        return building.currency || 'USD';\n    }\n\n    public ngOnInit(): void {}\n}\n","<div class=\"catering order-list\">\n    <div class=\"content\">\n        <div class=\"header\">\n            <h3>Catering Orders</h3>\n        </div>\n        <div class=\"body\" *ngIf=\"order_list && order_list.length; else empty_state\">\n            <div class=\"list\">\n                <div class=\"order\" *ngFor=\"let order of order_list\" [class.error]=\"order.error\">\n                    <catering-order-list-item [order]=\"order\" (edit)=\"editOrder(order)\" (delete)=\"deleteOrder(order)\"></catering-order-list-item>\n                    <div class=\"error-message\">\n                        The space associated with this booking has been removed.\n                        Unless the space is re-added this order will be removed.\n                    </div>\n                </div>\n                <btn widget (tapped)=\"addOrder()\">\n                    <div class=\"icon\">\n                        <i class=\"material-icons\">add</i>\n                    </div>\n                    <div class=\"text\">New order</div>\n                </btn>\n            </div>\n        </div>\n        <div class=\"footer\">\n            <btn (tapped)=\"event.emit({ type: 'previous' })\">Back</btn>\n            <btn (tapped)=\"event.emit({ type: 'next' })\">Continue</btn>\n        </div>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div class=\"body\">\n        <div class=\"no-item\">\n            <div class=\"icon\">\n                <i class=\"material-icons\">close</i>\n            </div>\n            <div class=\"text\">No catering orders</div>\n        </div>\n        <btn widget (tapped)=\"addOrder()\">\n            <div class=\"icon\">\n                <i class=\"material-icons\">add</i>\n            </div>\n            <div class=\"text\">New order</div>\n        </btn>\n    </div>\n</ng-template>\n","import { Component, Input, Output, EventEmitter, OnChanges, SimpleChanges } from '@angular/core';\nimport { ADynamicFormField } from '@acaprojects/ngx-dynamic-forms';\nimport { Router } from '@angular/router';\n\nimport { BaseComponent } from '../../../../../shared/globals/base.component';\nimport { CateringOrder } from '../../../../../services/data/catering/catering-order.class';\nimport { IRoom } from '../../../../../services/data/rooms.service';\n\n@Component({\n    selector: 'booking-main-flow-catering-orders',\n    templateUrl: './order-list.component.html',\n    styleUrls: ['./order-list.component.scss']\n})\nexport class CateringOrderListComponent extends BaseComponent implements OnChanges {\n    /** Form field for storing catering data for the booking */\n    @Input() public catering: ADynamicFormField;\n    /** List of rooms selected for the booking */\n    @Input() public spaces: IRoom[];\n    /** Start time of the current booking */\n    @Input() public date: number;\n    /** Emitter for changes to the active catering order */\n    @Output('order') public active_order = new EventEmitter();\n    /** Emitter for user events on component */\n    @Output() public event = new EventEmitter();\n\n    constructor(private _router: Router) {\n        super();\n    }\n\n    /** List of orders in the current booking */\n    public get order_list(): CateringOrder[] {\n        if (!this.catering) {\n            return [];\n        }\n        return this.catering.control.value || [];\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.date && this.catering) {\n            this.catering.control.setValue(\n                this.order_list.map(\n                    order => new CateringOrder({ ...order, booking_date: this.date })\n                )\n            );\n            this.order_list.forEach(\n                order => (order.error = !this.spaces.find(space => space.id === order.location_id))\n            );\n        }\n    }\n\n    /**\n     * Create new order and start editing it\n     */\n    public addOrder(): void {\n        const order = new CateringOrder({\n            id: `order-${Math.floor(Math.random() * 999_999_999)}`,\n            location_id: this.spaces[0].id,\n            location: this.spaces[0].name,\n            booking_date: this.date,\n            delivery_time: 0\n        });\n        this.active_order.emit(order);\n        this._router.navigate(['book', 'main', 'catering'], {\n            queryParams: { order_id: order.id }\n        });\n    }\n\n    /**\n     * Start editing the given order\n     * @param order\n     */\n    public editOrder(order: CateringOrder): void {\n        const the_order = this.order_list.find(o => o.id === order.id);\n        this.active_order.emit(the_order);\n        this._router.navigate(['book', 'main', 'catering']);\n    }\n\n    /**\n     * Remove the given order from the catering order list\n     * @param order\n     */\n    public deleteOrder(order: CateringOrder): void {\n        const order_list = this.order_list;\n        const the_order = order_list.find(o => o.id === order.id);\n        order_list.splice(order_list.indexOf(the_order), 1);\n        this.catering.control.setValue(order_list);\n    }\n}\n","<div class=\"find-space\">\n    <div class=\"topbar\">\n        <div class=\"icon\" (touchrelease)=\"event.emit({ type: 'previous' })\">\n            <i class=\"material-icons\">arrow_back</i>\n        </div>\n        <div class=\"text\" (touchrelease)=\"event.emit({ type: 'previous' })\">Book</div>\n    </div>\n    <div class=\"header\">\n        <div class=\"location-select\">\n            <custom-dropdown klass=\"options\" [(show)]=\"show\" [content]=\"content\" [template]=\"list\">\n                <ng-template #content>\n                    <div class=\"dropdown-header\" (touchrelease)=\"show = !show\">\n                        <div class=\"image\">\n                            <img src=\"assets/img/location-img.svg\" />\n                        </div>\n                        <div class=\"text\">Select location(s)</div>\n                        <div class=\"icon\">\n                            <i class=\"material-icons\">{{ show ? 'keyboard_arrow_up' : 'keyboard_arrow_down' }}</i>\n                        </div>\n                    </div>\n                </ng-template>\n                <ng-template #list>\n                    <div class=\"item-list\">\n                        <ng-container *ngIf=\"locations && locations.length > 0\">\n                            <cdk-virtual-scroll-viewport\n                                [itemSize]=\"40\"\n                                [style.height]=\"(locations.length < 6 ? locations.length : 6) * 40 + 'px'\"\n                            >\n                                <ng-container *cdkVirtualFor=\"let item of locations; let i = index\">\n                                    <div\n                                        class=\"item\"\n                                        (touchrelease)=\"item.selected = !item.selected; filter$.next(item.id + item.selected)\"\n                                    >\n                                        <a-checkbox klass=\"dark\" [ngModel]=\"item.selected\"></a-checkbox>\n                                        <div class=\"text\">\n                                            <div class=\"code\" [title]=\"item.code\">{{ item.code }}</div>\n                                            <div class=\"name\" [title]=\"item.name\">{{ item.name }}</div>\n                                            <div class=\"address\" [title]=\"item.address\">{{ item.address }}</div>\n                                        </div>\n                                    </div>\n                                </ng-container>\n                            </cdk-virtual-scroll-viewport>\n                        </ng-container>\n                    </div>\n                </ng-template>\n            </custom-dropdown>\n        </div>\n        <div class=\"selected-locations\">\n            <ng-container *ngFor=\"let item of locations\">\n                <div class=\"location\" *ngIf=\"item.selected\">\n                    <div class=\"icon close\" (touchrelease)=\"item.selected = false; filter$.next(item.id + item.selected)\">\n                        <i class=\"material-icons\">close</i>\n                    </div>\n                    <div class=\"text\">({{ item.code }}) {{ item.name }}</div>\n                </div>\n            </ng-container>\n        </div>\n    </div>\n    <div class=\"body\">\n        <ng-container *ngIf=\"!loading\">\n            <cdk-virtual-scroll-viewport [itemSize]=\"120\">\n                <div class=\"item\" *cdkVirtualFor=\"let item of shown_spaces || []\">\n                    <booking-main-flow-space-item [space]=\"item\" [(selected)]=\"item.selected\" (selectedChange)=\"setState(item, $event)\"></booking-main-flow-space-item>\n                </div>\n            </cdk-virtual-scroll-viewport>\n        </ng-container>\n        <div class=\"no-item center\" *ngIf=\"!shown_spaces || shown_spaces.length <= 0 || loading\">\n            <div class=\"icon\">\n                <i class=\"material-icons\" *ngIf=\"!loading\">close</i>\n                <spinner *ngIf=\"loading\" type=\"circle-ring\" color=\"rgba(0,0,0,.6)\"></spinner>\n            </div>\n            <div class=\"text\" *ngIf=\"!loading\">No available rooms</div>\n        </div>\n    </div>\n    <div class=\"footer\">\n        <div class=\"date\">\n            <div class=\"arrow\" [class.disabled]=\"is_today\" (touchrelease)=\"changeDate(-1)\">\n                <i class=\"material-icons\">keyboard_arrow_left</i>\n            </div>\n            <div class=\"display\">{{ date_display }}</div>\n            <div class=\"arrow\" (touchrelease)=\"changeDate(1)\">\n                <i class=\"material-icons\">keyboard_arrow_right</i>\n            </div>\n        </div>\n        <div class=\"next\">\n            <btn [disabled]=\"!spaces || !spaces.control.value || spaces.control.value.length <= 0\" (tapped)=\"event.emit({ type: 'next' })\">\n                Next\n            </btn>\n        </div>\n    </div>\n</div>\n","import { Component, OnInit, Input, Output, EventEmitter, SimpleChanges } from '@angular/core';\nimport { ADynamicFormField } from '@acaprojects/ngx-dynamic-forms';\nimport { Subject } from 'rxjs';\nimport { debounceTime, switchMap } from 'rxjs/operators';\n\nimport { IBookingFlowEvent } from '../main-flow.component';\nimport { IBuilding } from '../../../../services/data/buildings.service';\nimport { BaseComponent } from '../../../../shared/globals/base.component';\nimport { AppService } from '../../../../services/app.service';\nimport { IRoom, IRoomAvailabilityRequest } from '../../../../services/data/rooms.service';\nimport { IUser } from '../../../../services/data/users.service';\nimport { rulesForSpace } from '../../../../shared/utilities/booking.utilities';\n\nimport * as dayjs from 'dayjs';\nimport { Utils } from '../../../../shared/utility.class';\n\n@Component({\n    selector: 'booking-main-flow-find-space',\n    templateUrl: './find-space.component.html',\n    styleUrls: ['./find-space.component.scss']\n})\nexport class BookingMainFlowFindSpaceComponent extends BaseComponent implements OnInit {\n    /** Date time to search for free rooms */\n    @Input('dateField') public date_field: ADynamicFormField;\n    /** Available slot size to search for free rooms */\n    @Input() public duration: number;\n    /** Whether booking is all day */\n    @Input() public all_day: boolean;\n    /** Whether booking has catering */\n    @Input() public catering: boolean;\n    /** Selected host for the booking being created */\n    @Input() public user: IUser;\n    /** Timestamp for the end of recurrence period */\n    @Input() public recurr_end: number;\n    /** Form field for selected spaces */\n    @Input() public spaces: ADynamicFormField;\n    /** Emitter for form events */\n    @Output() public event = new EventEmitter<IBookingFlowEvent>();\n\n    /** List of available buildings to filter available rooms on */\n    public locations: IBuilding[] = [];\n    /** Whether the space results are being loaded or not */\n    public loading: boolean;\n    /** Spaces available before local filtering */\n    public available_spaces: IRoom[] = [];\n    /** Spaces available with the selected filters */\n    public shown_spaces: IRoom[] = [];\n    /** Whether to show the location dropdown list */\n    public show: boolean;\n    /** Subject for changes filters for displaying available rooms */\n    private filter$ = new Subject<any>();\n    /** Last query string used for searching for rooms */\n    private last_query = '';\n\n    constructor(private _service: AppService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        if (!this._service.ready() || this._service.Rooms.list(true).length <= 0) {\n            return this.timeout('init', () => this.ngOnInit());\n        }\n        this.last_query = '';\n        this.subscription(\n            'filter',\n            this.filter$\n                .pipe(\n                    debounceTime(500),\n                    switchMap(_ => this.search())\n                )\n                .subscribe((results: IRoom[]) => {\n                    this.available_spaces = results;\n                    this.shown_spaces = this.filter(results);\n                    this.shown_spaces.sort((a, b) => this.sort(a, b));\n                    this.loading = false;\n                })\n        );\n        this.subscription('building', this._service.Buildings.listen((bld) => {\n            if (bld) {\n                let active_locations = '';\n                if (localStorage) {\n                    active_locations = localStorage.getItem('STAFF.booking.filters') || '';\n                }\n                this.locations = this._service.Buildings.list().map(i => ({\n                    ...i,\n                    selected: active_locations ? active_locations.indexOf(i.id) >= 0 : i.id === bld.id\n                }));\n                this.filter$.next(Math.floor(Math.random() * 99999));\n            }\n        }));\n    }\n\n    /** Timestamp of the currently selected date */\n    public get date(): number {\n        let date: number = this.date_field ? this.date_field.getValue() : dayjs().valueOf();\n        if (this.catering) {\n            date = dayjs(date).subtract(15, 'm').valueOf();\n        }\n        if (this.duration > 720 || this.all_day) {\n            date = dayjs(date).startOf('d').valueOf();\n        }\n        return date;\n    }\n\n    /** Display string for the selected date */\n    public get date_display(): string {\n        return dayjs(this.date).format('ddd, DD MMM YYYY');\n    }\n\n    /** Whether the selected date is today */\n    public get is_today(): boolean {\n        const date = dayjs(this.date);\n        return dayjs().isSame(date, 'd');\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if ((changes.date_field && this.date_field) || (changes.duration && this.duration)) {\n            this.filter$.next(`${this.date}|${this.duration}`);\n        }\n    }\n\n    /**\n     * Search for available rooms matching the set filters\n     */\n    public search(): Promise<IRoom[]> {\n        const query: IRoomAvailabilityRequest = {\n            date: this.all_day ? dayjs(this.date).startOf('d').valueOf() : this.date,\n            duration: this.all_day ? 24 * 60 : (this.duration + (this.catering ? 15 : 0)),\n            hide_bookings: true\n        };\n        const locations = this.locations.reduce((v, i) => { (i as any).selected ? v.push(i.id) : ''; return v }, []);\n        if (locations.length <= 0) {\n            locations.push(this._service.Buildings.current().id);\n        }\n        const location_list = locations.join(',');\n        this.timeout('save_filters', () => {\n            if (localStorage) {\n                localStorage.setItem('STAFF.booking.filters', location_list);\n            }\n        });\n        let room_list: IRoom[] = [];\n        for (const zone of locations) {\n            room_list = room_list.concat(this._service.Rooms.list(true, zone));\n        }\n        const date = query.date;\n        const duration = query.duration;\n        // Filter out rooms unavailable due to booking rules\n        room_list = Utils.unique(room_list, 'id').filter(room => {\n            const bld: any = this._service.Buildings.get(room.level.bld_id) || this._service.Buildings.current() || {};\n            const rules = rulesForSpace({\n                user: this.user || this._service.Users.current(),\n                space: room,\n                time: date,\n                recurr_end: this.recurr_end || 0,\n                duration,\n                rules: bld.booking_rules\n            });\n            room.book_type = rules.auto_approve ? 'Book' : 'Request';\n            return rules.hide;\n        });\n        // Limit number of rooms retrieved\n        room_list = room_list.slice(0, Math.min(100, room_list.length));\n        query.ignore_rooms = room_list.reduce((v, i) => v + (v ? ',' : '') + i.id, '');\n        query.zone_ids = location_list;\n        const query_str = JSON.stringify(query);\n        if (query_str !== this.last_query && this.locations && this.locations.length > 0) {\n            this.last_query = query_str;\n            this.loading = true;\n        }\n        return this._service.Rooms.available(query);\n    }\n\n    /**\n     * Filter rooms based booking rules\n     * @param list List of rooms\n     */\n    public filter(list: IRoom[]): IRoom[] {\n        const selected = this.spaces.control.value || [];\n        const date = this.all_day ? dayjs(this.date).startOf('d').valueOf() : this.date;\n        const duration = this.all_day ? 24 * 60 : (this.duration + (this.catering ? 15 : 0));\n        return list\n            .filter(room => {\n                const bld: any = this._service.Buildings.get(room.level.bld_id) || this._service.Buildings.current() || {};\n                const rules = rulesForSpace({\n                    user: this.user || this._service.Users.current(),\n                    space: room,\n                    time: date,\n                    recurr_end: this.recurr_end || 0,\n                    duration,\n                    rules: bld.booking_rules\n                });\n                room.book_type = rules.auto_approve ? 'Book' : 'Request';\n                return !rules.hide;\n            })\n            .map(i => ({ ...i, selected: !!selected.find(j => i.id === j.id) } as any));\n    }\n\n    /**\n     * Update the list of spaces selected for the current booking\n     * @param space Space with which it's state has changed\n     * @param state New selected state of the space\n     */\n    public setState(space: IRoom, state: boolean) {\n        const list = this.spaces.control.value || [];\n        if (state) {\n            if (list.findIndex(i => i.id === space.id) < 0) {\n                this.spaces.setValue(list.concat([space]));\n            }\n        } else {\n            this.spaces.setValue(list.filter(i => i.id !== space.id));\n        }\n    }\n\n    /**\n     * Update the selected date\n     * @param value Value to change the date by. 1, 0 or -1 days\n     */\n    public changeDate(value: number) {\n        if (this.date_field) {\n            const date = dayjs(this.date);\n            const new_date = date.add(value, 'd');\n            if (!new_date.isBefore(dayjs().subtract(10, 'm'), 'm')) {\n                this.date_field.setValue(new_date.valueOf());\n                this.filter$.next(`${this.date}|${this.duration}`);\n            }\n        }\n    }\n\n    /**\n     * Determine the sort order of the two given itemss\n     * @param space_a\n     * @param space_b\n     */\n    private sort(space_a: IRoom, space_b: IRoom) {\n        const bld = this._service.Buildings.get(space_a.level.bld_id);\n        const bld_b = this._service.Buildings.get(space_a.level.bld_id);\n        if (bld && bld !== bld_b) {\n            return (bld.name || '').localeCompare(bld_b.name || '');\n        }\n        const sort_order = (bld.sort_order ? [...bld.sort_order] : []).reverse();\n        for (const zone_id of sort_order) {\n            if (zone_id === '*') { continue; }\n            const a_has_zone = space_a.zones.indexOf(zone_id) >= 0;\n            const b_has_zone = space_b.zones.indexOf(zone_id) >= 0;\n            if (a_has_zone && !b_has_zone) {\n                return 1;\n            } else if (b_has_zone && !a_has_zone) {\n                return -1;\n            }\n        }\n        return (space_a.name || '').localeCompare(space_b.name || '');\n    }\n}\n","<div class=\"space-item\" [class.request]=\"book_type === 'Request'\">\n    <div class=\"details\">\n        <div class=\"icon\">\n            <img src=\"assets/img/location.svg\" />\n        </div>\n        <div class=\"text\">\n            <div class=\"name\">{{ space?.level?.name }}, {{ space?.name }}</div>\n            <div class=\"info\" *ngIf=\"building\">({{ building.code }}) {{ building.name }}</div>\n            <div class=\"info\">Capacity: {{ space?.capacity }} {{ space && space.capacity === 1 ? 'Person' : 'People' }}</div>\n        </div>\n    </div>\n    <div class=\"options\">\n        <button click-responder (touchrelease)=\"toggle()\" [class.selected]=\"selected\">\n            {{\n                selected ? (book_type === 'Request' ? 'Requesting' : 'Selected') : book_type === 'Request' ? 'Request' : 'Select'\n            }}\n        </button>\n        <button click-responder (touchrelease)=\"showMap()\">Map</button>\n    </div>\n</div>\n","\nimport { Component, Input, Output, EventEmitter, SimpleChanges, OnChanges } from '@angular/core';\nimport { IRoom } from '../../../../../services/data/rooms.service';\nimport { BaseComponent } from '../../../../../shared/globals/base.component';\nimport { AppService } from '../../../../../services/app.service';\nimport { IBuilding } from '../../../../../services/data/buildings.service';\n\n@Component({\n    selector: 'booking-main-flow-space-item',\n    templateUrl: './space-item.component.html',\n    styleUrls: ['./space-item.component.scss']\n})\nexport class BookingMainFlowSpaceItemComponent extends BaseComponent implements OnChanges {\n    /** Space to display */\n    @Input() public space: IRoom;\n    /** Whether the space has been selected for booking */\n    @Input() public selected: boolean;\n    /** Emitter for changes to selected state of the space */\n    @Output() public selectedChange = new EventEmitter<boolean>();\n    /** Building associated with the set space */\n    public building: IBuilding;\n\n    constructor(private _service: AppService) {\n        super();\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.space &&  this.space) {\n            this.timeout('building', () => {\n                if (this.space.level) {\n                    this.building = this._service.Buildings.get(this.space.level.bld_id);\n                }\n            }, 100);\n        }\n    }\n\n    /** Booking type for the space */\n    public get book_type() {\n        return (this.space ? this.space.book_type : null) || 'Book';\n    }\n\n    /**\n     * Toggle the selected state of the space\n     */\n    public toggle() {\n        this.selected = !this.selected;\n        this.selectedChange.emit(this.selected);\n    }\n\n    /**\n     * Open modal to show the location of the space on a map\n     */\n    public showMap() {\n        this._service.Overlay.openModal('view-room', { data: {\n            room: this.space,\n        }}, (e) => e.close());\n    }\n}\n\n","<div class=\"booking-form\">\n    <div class=\"form\">\n        <a-dynamic-form [fields]=\"fields\"></a-dynamic-form>\n        <div class=\"options\">\n            <btn (tapped)=\"next()\">Next</btn>\n        </div>\n    </div>\n</div>","import { Component, OnInit, Input, Output, EventEmitter, OnChanges, SimpleChanges } from '@angular/core';\nimport { ADynamicFormField } from '@acaprojects/ngx-dynamic-forms';\n\nimport { IBookingFlowEvent } from '../main-flow.component';\nimport { BaseComponent } from '../../../../shared/globals/base.component';\nimport { AppService } from '../../../../services/app.service';\n\n@Component({\n    selector: 'booking-main-flow-form',\n    templateUrl: './form.component.html',\n    styleUrls: ['./form.component.scss']\n})\nexport class BookingMainFlowFormComponent extends BaseComponent implements OnChanges {\n    /** List of fields to display on the form */\n    @Input() fields: ADynamicFormField[] = [];\n    /** Emitter for form events */\n    @Output() public event = new EventEmitter<IBookingFlowEvent>();\n\n    constructor(private _service: AppService) {\n        super();\n    }\n\n    /** Whether the form is valid */\n    public get valid(): boolean {\n        return this.fields.reduce((a, v) => {\n            const valid = v.children && v.children.length > 0\n                ? v.children.reduce((r, i) => r && (i.isValid() || !i.required || i.disabled), true)\n                : (v.isValid() || !v.required || v.disabled);\n            return a && valid;\n        }, true);\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.fields && this.fields) {\n            const find = this.fields.find(i => i.key === 'recurrence' || !!(i.children && i.children.find(j => j.key === 'recurrence')));\n            const field = find ? (find.key === 'recurrence' ? find : find.children.find(j => j.key === 'recurrence')) : null;\n            if (field) {\n                this.subscription('recurrence', field.action.subscribe(() => this.setRecurrence(field)));\n            }\n            const find_space = this.fields.find(i => i.key === 'room' || !!(i.children && i.children.find(j => j.key === 'room')));\n            const spaces = find_space ? (find_space.key === 'room' ? find_space : find_space.children.find(j => j.key === 'room')) : null;\n            if (spaces && !spaces.hide) {\n                this.subscription('spaces', spaces.action.subscribe(() => this.setSpaces(spaces)));\n            }\n        }\n    }\n\n    public next() {\n        this.fields.forEach(i => i.control.markAsDirty());\n        if (this.valid) {\n            this.event.emit({ type: 'next' })\n        } else {\n            this._service.error('Some of the form fields are invalid');\n        }\n    }\n\n    /**\n     * Open modal to change the selected spaces for the booking\n     * @param field Form field associated with spaces\n     */\n    public setSpaces(field: ADynamicFormField) {\n        let periodField = this.fields.find(i => i.key === 'period_group');\n        let dateField = periodField.children.find(i => i.key === 'date');\n        let timeField = this.fields.find(i => i.key === 'time_group');\n        let durationField = timeField.children.find(i => i.key === 'duration');\n        this._service.Overlay.openModal('select-room', {\n            data: {\n                date: dateField.control.value,\n                duration: durationField.control.value,\n                spaces: field.getValue() || [],\n                multi: true\n            }\n        }, event => {\n            if (event.type === 'Select') {\n                field.setValue(event.data.select_list || []);\n            }\n            event.close();\n        });\n    }\n\n    /**\n     * Open modal to change the recurrence options for the booking\n     * @param field Form field associated with recurrence\n     */\n    public setRecurrence(field: ADynamicFormField) {\n        this._service.Overlay.openModal('recurrence-form', { data: { form: field.getValue() } }, event => {\n            if (event.type === 'Accept') {\n                field.setValue({\n                    period: event.data.form.recurr_period,\n                    end: event.data.form.recurr_end\n                });\n            }\n            event.close();\n        });\n    }\n}\n","<ng-container [ngSwitch]=\"page\">\n    <ng-container *ngSwitchCase=\"'orders'\">\n        <booking-main-flow-catering-orders\n            [catering]=\"catering\"\n            [spaces]=\"spaces\"\n            [date]=\"date\"\n            (order)=\"order = $event\"\n            (event)=\"progress($event)\"\n        >\n        </booking-main-flow-catering-orders>\n    </ng-container>\n    <ng-container *ngSwitchCase=\"'catering'\">\n        <booking-main-flow-catering\n            [id]=\"id\"\n            [all_day]=\"all_day\"\n            [date]=\"date\"\n            [duration]=\"duration\"\n            [spaces]=\"spaces\"\n            [order]=\"order\"\n            (event)=\"progress($event)\"\n        >\n        </booking-main-flow-catering>\n    </ng-container>\n    <ng-container *ngSwitchCase=\"'space'\">\n        <booking-main-flow-find-space\n            [dateField]=\"date_field\"\n            [recurr_end]=\"recurr_end\"\n            [all_day]=\"all_day\"\n            [duration]=\"duration\"\n            [spaces]=\"space_list\"\n            [catering]=\"needs_catering\"\n            (event)=\"progress($event)\"\n        ></booking-main-flow-find-space>\n    </ng-container>\n    <ng-container *ngSwitchDefault>\n        <booking-main-flow-form\n            [fields]=\"form_fields\"\n            (event)=\"progress($event)\"\n        ></booking-main-flow-form>\n    </ng-container>\n</ng-container>\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router, NavigationEnd } from '@angular/router';\nimport { ADynamicFormField } from '@acaprojects/ngx-dynamic-forms';\nimport { FormGroup } from '@angular/forms';\n\nimport { AppService } from '../../../services/app.service';\nimport { IBooking } from '../../../services/data/bookings.service';\nimport { IRoom } from '../../../services/data/rooms.service';\nimport { IUser } from '../../../services/data/users.service';\nimport { BaseComponent } from '../../../shared/globals/base.component';\nimport { generateBookingFormMetadata } from '../../../shared/utilities/booking.utilities';\nimport { formatSpaces } from '../../../shared/utilities/formatting.utilities';\nimport { ICateringOrderList } from './catering/catering-order/catering-order.component';\nimport { CateringOrder } from '../../../services/data/catering/catering-order.class';\n\nimport { BookingEquipmentDetailsModalComponent } from '../overlays/equipment-details/equipment-details.component';\nimport { BookingCateringDetailsModalComponent } from '../overlays/catering-details/catering-details.component';\nimport { BookingDetailsModalComponent } from '../overlays/booking-details/booking-details.component';\n\nimport * as dayjs from 'dayjs';\n\nexport interface IBookingFlowEvent {\n    type: 'next' | 'previous';\n    data?: { [name: string]: any };\n}\n\n@Component({\n    selector: 'booking-main-flow',\n    templateUrl: './main-flow.component.html',\n    styleUrls: ['./main-flow.component.scss']\n})\nexport class BookingMainFlowComponent extends BaseComponent implements OnInit {\n    /** Booking ID */\n    public id: string;\n    /** List of form fields associated with a booking */\n    public form_fields: ADynamicFormField[];\n    /** Name of the current page shown on the booking flow */\n    public page: string;\n    /** Form field for listing selected catering items */\n    public catering: ADynamicFormField;\n    /** Form field for the list of selected spaces */\n    public space_list: ADynamicFormField;\n    /** Form field for the selected date */\n    public date_field: ADynamicFormField;\n    /** Active catering order */\n    public order: CateringOrder;\n\n    constructor(\n        private _service: AppService,\n        private _route: ActivatedRoute,\n        private _router: Router\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        if (!this._service.ready()) {\n            return this.timeout('init', () => this.ngOnInit());\n        }\n        this.subscription(\n            'route',\n            this._route.paramMap.subscribe(params => {\n                if (params.has('page')) {\n                    this.page = params.get('page');\n                }\n            })\n        );\n        this.subscription(\n            'route_change',\n            this._router.events.subscribe(event => {\n                if (event instanceof NavigationEnd && event.url.indexOf('book') < 0) {\n                    this.clearForm();\n                }\n            })\n        );\n        this.loadForm();\n    }\n\n    /** List of selected rooms for the booking */\n    public get spaces(): IRoom[] {\n        const field = this.form_fields.find(i => i.key === 'room');\n        if (field) {\n            return field.control.value || [];\n        }\n        return [];\n    }\n\n    /** Timestamp of the end of the recurrence period */\n    public get recurr_end(): number {\n        let field = this.form_fields.find(i => i.key === 'recurrence');\n        if (field) {\n            return (field.control.value || { end: 0 }).end || 0;\n        }\n        field = this.form_fields.find(i => i.key === 'period_group');\n        if (field) {\n            return ((field.control as FormGroup).controls.recurrence.value || { end: 0 }).end || 0;\n        }\n        return 0;\n    }\n\n    /** Datetime selected for the booking */\n    public get date(): number {\n        const field = this.date_field;\n        if (field) {\n            return field.control.value;\n        }\n        return dayjs()\n            .startOf('m')\n            .valueOf();\n    }\n\n    /** Selected duration for the booking */\n    public get duration(): number {\n        let field: any = this.form_fields.find(i => i.key === 'duration');\n        if (field) {\n            return field.control.value;\n        }\n        field = this.form_fields.find(i => i.key === 'time_group');\n        if (field) {\n            return field.control.controls.duration.value;\n        }\n        return 60;\n    }\n\n    /** Whether booking is all day */\n    public get all_day(): boolean {\n        const field = this.form_fields.find(i => i.key === 'all_day');\n        return field ? field.control.value : false;\n    }\n\n    /** Whether the user want to add catering to their booking */\n    public get needs_catering(): boolean {\n        const empty = { control: { value: {} } };\n        const catering: boolean = (this.form_fields.find(i => i.key === 'needs_catering') || empty)\n            .control.value;\n        return catering;\n    }\n\n    /** Number of items in the catering order */\n    public get has_ordered(): number {\n        const empty = { control: { value: {} } };\n        const order: ICateringOrderList = (\n            this.form_fields.find(i => i.key === 'catering') || empty\n        ).control.value;\n        return order\n            ? Object.keys(order).reduce((v, key) => {\n                  const room_order = order[key];\n                  if (room_order && room_order.items) {\n                      v += room_order.items.reduce((c, i) => c + (i.amount || 0), 0);\n                  }\n                  return v;\n              }, 0)\n            : 0;\n    }\n\n    /**\n     * Progress to the next step in the flow\n     */\n    public progress(event: IBookingFlowEvent) {\n        const empty = { control: { value: true } };\n        const catering = (this.form_fields.find(i => i.key === 'needs_catering') || empty).control\n            .value;\n        const space = (this.form_fields.find(i => i.key === 'needs_space') || empty).control.value;\n        const id = (this.form_fields.find(i => i.key === 'id') || empty).control.value;\n        this.id = id || !space ? '10' : '';\n        if (event.type === 'next') {\n            switch (this.page) {\n                case 'catering':\n                    this._service.navigate(['book', 'main', 'orders']);\n                    const order_list: CateringOrder[] = this.catering.getValue() || [];\n                    const index = order_list.findIndex(order => order.id === this.order.id);\n                    const new_item_count = this.order.changes.items\n                        ? this.order.changes.items.reduce(\n                              (count, item) => count + (item.amount || 0),\n                              0\n                          )\n                        : this.order.item_count;\n                    if (new_item_count > 0 && index < 0) {\n                        order_list.push(new CateringOrder(this.order.toJSON(true)));\n                    } else {\n                        index >= 0 && new_item_count > 0\n                            ? order_list.splice(index, 1, new CateringOrder(this.order.toJSON(true)))\n                            : index >= 0\n                                ? order_list.splice(index, 1)\n                                : '';\n                    }\n                    this.catering.control.setValue(order_list);\n                    break;\n                case 'orders':\n                    const orders: CateringOrder[] = this.catering.getValue();\n                    const item_count = (orders || []).reduce((count, order) => count + order.item_count, 0);\n                    if (item_count > 0) {\n                        this.addCateringNotes().then(() => this.confirmBooking());\n                    } else {\n                        this.confirmBooking();\n                    }\n                    break;\n                case 'space':\n                    this.addEquipment()\n                        .then(() => {\n                            if (catering) {\n                                this._service.navigate(['book', 'main', 'orders']);\n                            } else {\n                                this.confirmBooking();\n                            }\n                        })\n                        .catch(() => {});\n                    break;\n                default:\n                    if (space && !id) {\n                        this._service.navigate(['book', 'main', 'space']);\n                    } else if (this.spaces && this.spaces.length > 0) {\n                        this.addEquipment()\n                            .then(() => {\n                                if (catering) {\n                                    this._service.navigate(['book', 'main', 'orders']);\n                                } else {\n                                    this.confirmBooking();\n                                }\n                            })\n                            .catch(() => {});\n                    } else if ((space || (this.spaces && this.spaces.length)) && catering) {\n                        this._service.navigate(['book', 'main', 'orders']);\n                    } else {\n                        this.confirmBooking();\n                    }\n                    break;\n            }\n        } else if (event.type === 'previous') {\n            switch (this.page) {\n                case 'catering':\n                    if (id || !space) {\n                        // Whether space selection handled on the main form\n                        this._service.navigate(['book', 'main', 'orders']);\n                    } else {\n                        this._service.navigate(['book', 'main', 'orders']);\n                    }\n                    break;\n                case 'orders':\n                    if (id || !space) {\n                        // Whether space selection handled on the main form\n                        this._service.navigate(['book', 'main', 'form']);\n                    } else {\n                        this._service.navigate(['book', 'main', 'space']);\n                    }\n                    break;\n                case 'space':\n                    this._service.navigate(['book', 'main', 'form']);\n                    break;\n                default:\n                    this._service.navigate(['home']);\n                    break;\n            }\n        }\n    }\n\n    /**\n     * Clear any form data\n     */\n    private clearForm() {\n        if (localStorage) {\n            localStorage.removeItem('STAFF.booking_form');\n        }\n        this.loadForm();\n    }\n\n    /**\n     * Load old form data and intialise the form\n     */\n    private loadForm() {\n        let booking: any = {};\n        if (localStorage) {\n            booking = JSON.parse(localStorage.getItem('STAFF.booking_form') || '{}');\n        }\n        this.form_fields = generateBookingFormMetadata(\n            booking as IBooking,\n            this._service.Settings.get('app.booking.fields'),\n            this._service\n        );\n        const host = this.form_fields.find(i => i.key === 'host');\n        if (host) {\n            host.metadata = { service: this._service.Bookings, options: this.getHostOptions() };\n            host.setValue(host.getValue() || booking.host);\n        }\n        this.form_fields.push(\n            new ADynamicFormField({\n                key: 'id',\n                type: 'action',\n                hide: true,\n                value: booking.id\n            })\n        );\n        this.date_field = this.form_fields\n            .reduce((v, i) => v.concat(i.children && i.children.length ? i.children : [i]), [])\n            .find(i => i.key === 'date');\n        this.space_list = new ADynamicFormField({\n            key: 'room',\n            label: 'Spaces',\n            type: 'action',\n            format: formatSpaces,\n            hide: !booking.id,\n            value: booking.room || []\n        });\n        this.catering = new ADynamicFormField({\n            key: 'catering',\n            label: 'Catering',\n            type: 'action',\n            hide: true,\n            value: (\n                (booking.catering instanceof Array ? booking.catering : [booking.catering]) || []\n            )\n                .filter(order => order)\n                .map(order => new CateringOrder(order))\n        });\n        this.form_fields.unshift(this.space_list);\n        this.form_fields.push(this.catering);\n        this.form_fields.forEach(field => {\n            if (field.children && field.children.length) {\n                field.children.forEach(sub_field => {\n                    this.subscription(\n                        sub_field.key,\n                        sub_field.control.valueChanges.subscribe(value => {\n                            if (value && sub_field.control.valid) {\n                                this.saveForm();\n                            }\n                        })\n                    );\n                });\n            } else {\n                this.subscription(\n                    field.key,\n                    field.control.valueChanges.subscribe(value => {\n                        if (value && field.control.valid) {\n                            this.saveForm();\n                        }\n                    })\n                );\n            }\n        });\n        const empty: any = { control: { value: true, valueChanges: false }, children: [] };\n        const space = (this.form_fields.find(i => i.key === 'needs_space') || empty).control.value;\n        const time = this.form_fields.find(i => i.key === 'time_group') || empty;\n        const all_day = this.form_fields.find(i => i.key === 'all_day') || empty;\n        (time as ADynamicFormField).setDisabled(this.duration > 450);\n        const start = time.children.find(i => i.key === 'start') || empty;\n        this.subscription(\n            'all_day_value',\n            all_day.control.valueChanges.subscribe(state =>\n                (start as ADynamicFormField).setDisabled(state)\n            )\n        );\n        const id = (this.form_fields.find(i => i.key === 'id') || empty).control.value;\n        this.id = id || !space ? '10' : '';\n    }\n\n    /**\n     * Save changes to the form data\n     */\n    private saveForm() {\n        this.timeout(\n            'save_form',\n            () => {\n                const form = this.formToBooking();\n                if (localStorage) {\n                    localStorage.setItem('STAFF.booking_form', JSON.stringify(form));\n                }\n                const empty = { control: { value: true }, children: [] };\n                const time = this.form_fields.find(i => i.key === 'time_group') || empty;\n                (time as ADynamicFormField).children[0].setDisabled(\n                    this.duration > 450 || this.all_day\n                );\n            },\n            50\n        );\n    }\n\n    /**\n     * Convert form field data to a Booking object\n     */\n    private formToBooking(): IBooking {\n        return this.form_fields.reduce((v, i) => {\n            if (i.children && i.children.length) {\n                i.children.forEach(j => (v[j.key] = j.control.value));\n            } else {\n                v[i.key] = i.control.value;\n            }\n            return v;\n        }, {}) as IBooking;\n    }\n\n    /**\n     * Show modal to user for adding equipment details to a booking\n     */\n    private addEquipment() {\n        return new Promise((resolve, reject) => {\n            const empty = { control: { value: '' } };\n            const notes = this.form_fields.find(i => i.key === 'equipment');\n            const expected_attendees = this.form_fields.find(i => i.key === 'expected_attendees');\n            const spaces = this.form_fields.find(i => i.key === 'room');\n            const cost_code = this.form_fields.find(i => i.key === 'equipment_code');\n            this._service.Overlay.openModal(\n                'booking-equipment',\n                {\n                    cmp: BookingEquipmentDetailsModalComponent,\n                    data: {\n                        spaces: (spaces || empty).control.value || [],\n                        expected_attendees: (expected_attendees || empty).control.value || {},\n                        notes: (notes || empty).control.value,\n                        cost_code: (cost_code || empty).control.value\n                    }\n                },\n                event => {\n                    if (event.type === 'finish') {\n                        if (notes) {\n                            notes.setValue(event.data.notes);\n                        }\n                        if (expected_attendees) {\n                            expected_attendees.setValue(event.data.expected_attendees || {});\n                        }\n                        if (cost_code) {\n                            cost_code.setValue(event.data.cost_code);\n                        }\n                        resolve();\n                    } else {\n                        reject();\n                    }\n                    event.close();\n                }\n            );\n        });\n    }\n\n    /**\n     * Show modal for adding details to catering\n     */\n    private addCateringNotes() {\n        return new Promise((resolve, reject) => {\n            const empty = { control: { value: '' } };\n            const notes = this.form_fields.find(i => i.key === 'catering_notes');\n            const spaces = this.form_fields.find(i => i.key === 'room');\n            const cost_code = this.form_fields.find(i => i.key === 'catering_code');\n            this._service.Overlay.openModal(\n                'booking-catering-notes',\n                {\n                    cmp: BookingCateringDetailsModalComponent,\n                    data: {\n                        spaces: (spaces || empty).control.value || [],\n                        notes: (notes || empty).control.value,\n                        cost_code: (cost_code || empty).control.value\n                    }\n                },\n                event => {\n                    if (event.type === 'finish') {\n                        if (notes) {\n                            notes.setValue(event.data.notes);\n                        }\n                        if (cost_code) {\n                            cost_code.setValue(event.data.cost_code);\n                        }\n                        resolve();\n                    } else {\n                        reject();\n                    }\n                    event.close();\n                }\n            );\n        });\n    }\n\n    /**\n     * Open modal for confirming booking details\n     */\n    private confirmBooking() {\n        this.timeout(\n            'confirm-booking',\n            () => {\n                const fields: any = this.formToBooking();\n                fields.catering = fields.catering.map((order: CateringOrder) => order.toJSON(true));\n                this._service.Overlay.openModal(\n                    'confirm-booking',\n                    {\n                        cmp: BookingDetailsModalComponent,\n                        data: fields\n                    },\n                    event => {\n                        if (event.type === 'finish') {\n                            // Booking completed successfully\n                            this.clearForm();\n                            this._service.navigate(['schedule'], {\n                                host: fields.host\n                                    ? fields.host.email\n                                    : this._service.Users.current().email\n                            });\n                            event.close();\n                        } else if (event.type === 'new') {\n                            // User wishes to create a new booking\n                            this.clearForm();\n                            this._service.navigate(['book', 'main', 'form']);\n                        } else if (event.type === 'edit') {\n                            // User wishes to edit the booking\n                            this._service.navigate(['book', 'main', 'form']);\n                            event.close();\n                        } else {\n                            event.close();\n                        }\n                    }\n                );\n            },\n            100\n        );\n    }\n\n    /**\n     * Get list of users available to select as the meeting host\n     */\n    private getHostOptions(): IUser[] {\n        const user = this._service.Users.current();\n        const list: IUser[] = [user];\n        if (user.delegates) {\n            for (const email of user.delegates) {\n                const delegate = this._service.Users.item(email);\n                if (delegate) {\n                    list.push(delegate);\n                } else {\n                    this.timeout(`load_user|${email}`, () =>\n                        this._service.Users.show(email, { update: true }).then(() => {\n                            this.timeout('update_host_options', () => {\n                                const host = this.form_fields.find(i => i.key === 'host');\n                                if (host) {\n                                    host.metadata = {\n                                        service: this._service.Bookings,\n                                        options: this.getHostOptions()\n                                    };\n                                    host.setValue(host.getValue());\n                                }\n                            });\n                        })\n                    );\n                }\n            }\n        }\n        return list;\n    }\n}\n"],"sourceRoot":"webpack:///"}