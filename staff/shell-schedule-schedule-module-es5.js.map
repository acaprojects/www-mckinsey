{"version":3,"sources":["webpack:///src/app/shell/schedule/event-list/event-list.component.ts","webpack:///src/app/shell/schedule/event-list/event-list.component.html","webpack:///src/app/shell/schedule/event-list/list-item/list-item.component.ts","webpack:///src/app/shell/schedule/event-list/list-item/list-item.component.html","webpack:///src/app/shell/schedule/schedule.component.ts","webpack:///src/app/shell/schedule/schedule.template.html","webpack:///src/app/shell/schedule/schedule.module.ts","webpack:///src/app/shell/schedule/schedule.routes.ts","webpack:///src/app/shell/schedule/view-event/event-details/event-details.component.ts","webpack:///src/app/shell/schedule/view-event/event-details/event-details.component.html","webpack:///src/app/shell/schedule/view-event/event-edit/event-edit.component.ts","webpack:///src/app/shell/schedule/view-event/event-edit/event-edit.component.html","webpack:///src/app/shell/schedule/view-event/view-event.component.ts","webpack:///src/app/shell/schedule/view-event/view-event.component.html"],"names":["ScheduleEventListComponent","_users","_bookings","_spaces","_route","event_list","events","shown_offset","date_offset","now","valueOf","at_top","user_list","initialised","pipe","_","subscribe","subscription","queryParamMap","params","has","active_user","find","get","email","updateEvents","interval","scroll_viewport","elementScrolled","onScroll","listen","list","current","concat","event_promise","Promise","resolve","start","add","startOf","end","endOf","loading","query","from","unix","to","then","updateList","filter","old_events","i","date","type","isBefore","isAfter","processEvents","emit","map","id","timeout","scrollTo","date_str","format","push","order_id","title","is_today","isSame","filter_fn","day","new_items","old_items","length","sort","a","b","show_calendar","range","getRenderedRange","dist","nearest","measureScrollOffset","diff","subtract","Math","max","scroll_to","trigger","closeMenu","item","index","findIndex","scrollToIndex","$event","stopPropagation","updateDate","closeDatePicker","selector","templateUrl","styleUrls","ScheduleEventListItemComponent","_dialog","event","open","maxHeight","maxWidth","width","height","hasBackdrop","closeOnNavigation","data","booking","as_delegate","user","delegate","is_first","is_last","status","space_list","space","name","join","has_visitors","all_day","duration","statuses","approval_status","spaces","indexOf","location","location_lower","toLowerCase","ScheduleComponent","_service","show_menu","paramMap","page","loadEvents","saveEvents","localStorage","setItem","JSON","stringify","getItem","parse","ScheduleModule","forChild","declarations","imports","ROUTES","path","component","redirectTo","EventDetailsComponent","_router","change","last_start","checked_in","duplicate","navigate","attendees","organiser","description","reduce","v","EventEditComponent","form","setting","changes","previousValue","has_changes","notifyInfo","valid","dialog_ref","componentInstance","reason","ScheduleViewEventComponent","Hotkeys","nextBooking","previousBooking","loadEvent","editing","show","bkn","notifyError","next","previous"],"mappings":"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","file":"shell-schedule-schedule-module-es5.js","sourcesContent":["import { Component, ViewChild, Output, EventEmitter } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { MatMenuTrigger } from '@angular/material/menu';\nimport { CdkVirtualScrollViewport } from '@angular/cdk/scrolling';\nimport { first } from 'rxjs/operators';\n\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { unique } from 'src/app/shared/utilities/general.utilities';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { BookingLike } from './list-item/list-item.component';\nimport { User } from 'src/app/services/data/users/user.class';\nimport { UsersService } from 'src/app/services/data/users/users.service';\nimport { BookingsService } from 'src/app/services/data/bookings/bookings.service';\nimport { SpacesService } from 'src/app/services/data/spaces/spaces.service';\n\nimport * as dayjs from 'dayjs';\n\nexport interface EventPair {\n    id: string;\n    date: number;\n}\n\n@Component({\n    selector: 'schedule-event-list',\n    templateUrl: './event-list.component.html',\n    styleUrls: ['./event-list.component.scss'],\n})\nexport class ScheduleEventListComponent extends BaseDirective {\n    /** Emitter  */\n    @Output('eventList') public event_list = new EventEmitter<EventPair[]>();\n    /** List of items to display on the event list */\n    public events: BookingLike[] = [];\n    /** Update promise */\n    public event_promise: Promise<void>;\n    /** Whether bookings are being updated */\n    public loading: boolean;\n    /** Number of days to render in the list from the current date */\n    public shown_offset: number = 7;\n    /** Offset of the date to show events for */\n    public date_offset: number = 0;\n    /** Whether to show the calendar tooltip */\n    public show_calendar: boolean;\n    /** Date to scroll to on next update */\n    public scroll_to: string;\n    /** Current UTC epoch */\n    public now: number = dayjs().valueOf();\n    /** Current UTC epoch */\n    public date: number;\n    /** Whether list is displaying the top of the first item */\n    public at_top: boolean = true;\n    /** List of users available to view schedules for */\n    public user_list: User[] = [];\n    /** Active user to display schedule for */\n    public active_user: User;\n\n    /** Viewport for the scrollable area of the list */\n    @ViewChild(CdkVirtualScrollViewport, { static: true })\n    private scroll_viewport: CdkVirtualScrollViewport;\n\n    @ViewChild(MatMenuTrigger, { static: true }) trigger: MatMenuTrigger;\n\n    constructor(\n        private _users: UsersService,\n        private _bookings: BookingsService,\n        private _spaces: SpacesService,\n        private _route: ActivatedRoute\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._spaces.initialised.pipe(first(_ => _)).subscribe(() => {\n            this.subscription(\n                'route.query',\n                this._route.queryParamMap.subscribe((params) => {\n                    /* istanbul ignore else */\n                    if (params.has('email')) {\n                        this.active_user =\n                            this._users.find(params.get('email')) ||\n                            new User({ email: params.get('email') });\n                    }\n                })\n            );\n            this.updateEvents();\n            this.interval('update_events', () => this.updateEvents(), 10 * 1000);\n            this.subscription(\n                'scroll',\n                this.scroll_viewport.elementScrolled().subscribe(() => this.onScroll())\n            );\n            this.subscription(\n                'delegate_list',\n                this._users.listen('delegates').subscribe((list) => {\n                    /* istanbul ignore else */\n                    if (list && list[0]) {\n                        this.user_list = [this._users.current].concat(list);\n                        /* istanbul ignore else */\n                        if (!this.active_user) {\n                            this.active_user = this.user_list[0];\n                        }\n                    }\n                })\n            );\n        });\n    }\n\n    /**\n     * Update the list of events for the currently visible period\n     */\n    public updateEvents() {\n        /* istanbul ignore else */\n        if (!this.event_promise) {\n            this.event_promise = new Promise((resolve) => {\n                const start = dayjs().add(this.date_offset, 'd').startOf('d');\n                const end = start.add(7, 'd').endOf('d');\n                this.loading = true;\n                this._bookings\n                    .query({\n                        email:\n                            (this.active_user ? this.active_user.email : '') ||\n                            this._users.current.email,\n                        from: start.unix(),\n                        to: end.unix(),\n                    })\n                    .then(\n                        (list: Booking[]) => {\n                            this._bookings.updateList(this._bookings.filter(), list);\n                            const old_events = this.events.filter((i) => {\n                                const date = dayjs(i.date);\n                                return (\n                                    i.type !== 'date' &&\n                                    i.type !== 'empty' &&\n                                    (date.isBefore(start, 's') || date.isAfter(end, 's'))\n                                );\n                            });\n                            this.events = this.processEvents(list, old_events);\n                            // Update event list for view listing\n                            const event_list = this.events.filter(\n                                (i) => i.type !== 'date' && i.type !== 'empty'\n                            );\n                            this.event_list.emit(\n                                event_list.map((i) => ({ id: i.id, date: i.date }))\n                            );\n                            // Scroll to date if needed\n                            this.timeout('scroll_to', () => this.scrollTo());\n                            this.loading = false;\n                            delete this.event_promise;\n                        },\n                        () => {\n                            this.loading = false;\n                            delete this.event_promise;\n                        }\n                    );\n            });\n        }\n        return this.event_promise;\n    }\n\n    /**\n     * Process list of new items and merge with the old\n     * @param list List of new bookings to generate event blocks for\n     * @param old_events List of relevant old event blocks\n     */\n    public processEvents(list: Booking[], old_events: BookingLike[]): BookingLike[] {\n        let events: BookingLike[] = [];\n        const now = dayjs();\n        let date = dayjs().startOf('d');\n        const end = date.add(this.shown_offset, 'd').endOf('d');\n        for (; date.isBefore(end); date = date.add(1, 'd')) {\n            const date_str = date.format('YYYY-MM-DD');\n            // Add date block\n            events.push({\n                id: date_str,\n                type: 'date',\n                order_id: date_str,\n                title: date.format('dddd, DD MMM'),\n                is_today: date.isSame(now, 'd'),\n                date: date.valueOf(),\n            });\n            const filter_fn: (_: BookingLike) => boolean = (i) => {\n                const day = dayjs(i.date);\n                return day.isAfter(date, 's') && day.isBefore(date.endOf('d'), 's');\n            };\n            // Add events for today to list\n            const new_items = list.filter(filter_fn as any);\n            const old_items = old_events.filter(filter_fn as any);\n            if (new_items.length || old_items.length) {\n                events = events.concat(new_items as any).concat(old_items);\n            } else {\n                // Add block for no events if so\n                events.push({\n                    id: `${date_str}-empty`,\n                    type: 'empty',\n                    order_id: date_str,\n                    title: `No items for ${date.format('dddd, DD MMM')}`,\n                    is_today: date.isSame(now, 'd'),\n                    date: date.valueOf() + 1,\n                });\n            }\n        }\n        events.sort((a, b) => a.date - b.date);\n        events = unique(events, 'id');\n        return events;\n    }\n\n    /**\n     * Handle scrolling on the event list\n     */\n    public onScroll() {\n        /* istanbul ignore else */\n        if (!this.event_promise) {\n            this.show_calendar = false;\n            const range = this.scroll_viewport.getRenderedRange();\n            const dist = range.end - range.start;\n            const nearest = this.events[range.start];\n            this.at_top = range.start === 0 && this.scroll_viewport.measureScrollOffset() < 5;\n            this.date_offset = dayjs(nearest.date).diff(dayjs(), 'd') - 1;\n            this.date = dayjs((this.events[dist + range.start] || {}).date)\n                .subtract(1, 'd')\n                .valueOf();\n            /* istanbul ignore else */\n            if (range.end > this.events.length - 7) {\n                this.shown_offset += 3;\n                this.updateEvents();\n            }\n        }\n    }\n\n    /**\n     * Update the date offset\n     * @param date UTC milliseconds epoch of new date offset\n     */\n    public updateDate(date: number) {\n        const day = dayjs(date);\n        this.date_offset = day.diff(dayjs(), 'd') - 1;\n        this.shown_offset = Math.max(this.shown_offset, this.date_offset + 3);\n        this.scroll_to = day.format('YYYY-MM-DD');\n        delete this.event_promise;\n        this.show_calendar = false;\n        this.date = dayjs().add(this.date_offset, 'd').valueOf();\n        this.updateEvents();\n    }\n\n    /** Close the menu popup with the date picker */\n    public closeDatePicker() {\n        this.trigger.closeMenu();\n    }\n\n    /* istanbul ignore next */\n    public trackByFn(item: BookingLike, index: number) {\n        return item ? item.id : null;\n    }\n\n    /**\n     * Scroll to a previously defined date on the event list\n     */\n    private scrollTo() {\n        /* istanbul ignore else */\n        if (this.scroll_to) {\n            const index = this.events.findIndex((i) => i.id === this.scroll_to);\n            /* istanbul ignore else */\n            if (index > -1) {\n                this.scroll_viewport.scrollToIndex(index, 'smooth');\n                this.scroll_to = null;\n            }\n        }\n    }\n}\n","<div class=\"event-list\">\n    <div class=\"header dark-mode\" [class.scrolled]=\"!at_top\">\n        <div class=\"user\">\n            <mat-form-field appearance=\"outline\" *ngIf=\"user_list && user_list.length > 1\" >\n                <mat-select #select [(value)]=\"active_user\" (valueChange)=\"updateEvents($event)\">\n                    <mat-option *ngFor=\"let user of user_list\" [value]=\"user\">\n                        {{ user?.name }}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n        </div>\n        <div class=\"flex\"></div>\n        <div class=\"date\">\n            <button mat-icon-button [matMenuTriggerFor]=\"appMenu\">\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'event' }\"></app-icon>\n            </button>\n        </div>\n    </div>\n    <div class=\"progress\">\n        <mat-progress-bar mode=\"indeterminate\" *ngIf=\"loading\"></mat-progress-bar>\n    </div>\n    <div class=\"body\">\n        <cdk-virtual-scroll-viewport itemSize=\"80\" class=\"viewport\" (scroll)=\"onScroll()\">\n            <ng-container *cdkVirtualFor=\"let item of events; trackBy: trackByFn\">\n                <schedule-event-item [attr.id]=\"item.id | slice:0:10\" [user]=\"active_user\" [event]=\"item\"></schedule-event-item>\n            </ng-container>\n        </cdk-virtual-scroll-viewport>\n    </div>\n    <div class=\"footer\"></div>\n</div>\n<mat-menu #appMenu=\"matMenu\">\n    <div mat-menu-item class=\"date-picker\" (click)=\"$event.stopPropagation()\">\n        <a-date-picker\n            [(ngModel)]=\"date\"\n            (ngModelChange)=\"updateDate($event); closeDatePicker()\"\n        ></a-date-picker>\n    </div>\n</mat-menu>\n","import { Component, Input } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport {\n    MeetingDetailsOverlayComponent,\n    MeetingDetailsModalData,\n} from 'src/app/overlays/meeting-details-overlay/meeting-details-overlay.component';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { User } from 'src/app/services/data/users/user.class';\n\nimport * as dayjs from 'dayjs';\nimport { UsersService } from 'src/app/services/data/users/users.service';\n\nexport interface BookingLike {\n    /** ID of the item */\n    id: string;\n    /** Sorting weight of the item */\n    order_id: string;\n    /** Type of item to render */\n    type: 'date' | 'event' | 'empty';\n    /** Whether the event is on the current date */\n    is_today: boolean;\n    /** Title of the event */\n    title: string;\n    /** Date in UTC milliseconds */\n    date: number;\n    /** Current state of the booking */\n    status?: 'future' | 'upcoming' | 'done' | 'started' | 'in_progress';\n\n    [key: string]: any;\n}\n\n@Component({\n    selector: 'schedule-event-item',\n    templateUrl: './list-item.component.html',\n    styleUrls: ['./list-item.component.scss'],\n})\nexport class ScheduleEventListItemComponent extends BaseDirective {\n    /** Booking to display */\n    @Input() public event: BookingLike;\n    /** User who's schedule is being viewed */\n    @Input() public user: User;\n\n    public get in_progress(): boolean {\n        return this.event.status === 'in_progress';\n    }\n\n    public get date_display(): string {\n        const date = dayjs(this.event.date);\n        const now = dayjs();\n        return now.isSame(date, 'd') ? 'Today' : date.format('DD MMM YYYY');\n    }\n\n    /** Display location of the booking event */\n    public get location(): string {\n        const booking: Booking = this.event as any;\n        return (booking.space_list || [booking.space]).map((i) => i.name).join(', ');\n    }\n\n    /** Image name to display for the event */\n    public get type_image(): string {\n        const booking: Booking = this.event as any;\n        return booking.has_visitors ? 'external' : 'book_room';\n    }\n\n    public get time(): string {\n        const booking: Booking = this.event as any;\n        return booking.all_day || booking.duration > 23 * 60\n            ? 'All Day'\n            : dayjs(booking.date).format('h:mm A');\n    }\n\n    /** Status of the current booking */\n    public get status(): 'approved' | 'tentative' | 'declined' | '' {\n        const statuses = this.event.approval_status || {};\n        const spaces = this.event.space_list || [];\n        for (const space of spaces) {\n            const status = statuses[space.id] || '';\n            if (status.indexOf('tentative') >= 0 || status.indexOf('not') === 0) {\n                return 'tentative';\n            } else if (status.indexOf('declined') >= 0) {\n                return 'declined';\n            }\n        }\n        const location = this.event.location || '';\n        const location_lower = (typeof location === 'string' ? location : '').toLowerCase();\n        if (location_lower.indexOf('tentative') >= 0) {\n            return 'tentative';\n        } else if (location_lower.indexOf('declined') >= 0) {\n            return 'declined';\n        }\n        return spaces.length ? 'approved' : '';\n    }\n\n    constructor(private _dialog: MatDialog, private _users: UsersService) {\n        super();\n    }\n\n    public openDetailsModal() {\n        /* istanbul ignore else */\n        if (this.event instanceof Booking) {\n            this._dialog.open<MeetingDetailsOverlayComponent, MeetingDetailsModalData>(\n                MeetingDetailsOverlayComponent,\n                {\n                    maxHeight: 'auto',\n                    maxWidth: 'auto',\n                    width: 'auto',\n                    height: 'auto',\n                    hasBackdrop: false,\n                    closeOnNavigation: true,\n                    data: {\n                        booking: this.event,\n                        as_delegate: this._users.current.email === (this.user || {}).email,\n                        delegate: this.user.email,\n                        is_first: false,\n                        is_last: false,\n                    },\n                }\n            );\n        }\n    }\n}\n","<div [class]=\"'event-item ' + event.type + ' ' + status\" *ngIf=\"event\" [attr.id]=\"event.id\">\n    <ng-container [ngSwitch]=\"event.type\">\n        <div *ngSwitchCase=\"'date'\" class=\"day display\">{{ event.title }}</div>\n        <div *ngSwitchCase=\"'empty'\" class=\"emptied display\">\n            No events for {{ date_display }}\n        </div>\n        <div *ngSwitchDefault class=\"event display\">\n            <a (tapped)=\"openDetailsModal()\">\n                <div class=\"content\">\n                    <div class=\"time\">\n                        <div>{{ time }}</div>\n                        <div class=\"info\" *ngIf=\"in_progress\">In Progress</div>\n                    </div>\n                    <div class=\"icon\">\n                        <img [src]=\"'assets/img/' + type_image + '.svg'\" />\n                    </div>\n                    <div class=\"details\">\n                        <div class=\"title text\">{{ event.title }}</div>\n                        <div class=\"location text\">\n                            <img src=\"assets/img/location.svg\">\n                            <div class=\"text\">{{ location || event.location_name || 'No location' }}</div>\n                        </div>\n                    </div>\n                </div>\n            </a>\n        </div>\n    </ng-container>\n</div>\n","\nimport { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\n\nimport { EventPair } from './event-list/event-list.component';\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { ApplicationService } from 'src/app/services/app.service';\n\n@Component({\n    selector: 'app-schedule',\n    templateUrl: './schedule.template.html',\n    styleUrls: ['./schedule.styles.scss'],\n})\nexport class ScheduleComponent extends BaseDirective implements OnInit {\n    /** Name of the page to render */\n    public page: string;\n    /** ID of the event item to view */\n    public id: string;\n    /** Current list of loaded events */\n    public events: EventPair[];\n    /** Whether to show menu */\n    public show_menu = false;\n\n    /** ID of the event after the active event */\n    public get next(): string {\n        if (this.events) {\n            const index = this.events.findIndex(i => this.id === i.id) + 1;\n            if (index > -1 && this.events[index]) {\n                return this.events[index].id;\n            }\n        }\n        return '';\n    }\n\n    /** ID of the event before the active event */\n    public get previous(): string {\n        if (this.events) {\n            const index = this.events.findIndex(i => this.id === i.id) - 1;\n            if (index > -1 && this.events[index]) {\n                return this.events[index].id;\n            }\n        }\n        return '';\n    }\n\n    constructor(private _route: ActivatedRoute, private _service: ApplicationService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.subscription('route.route', this._route.paramMap.subscribe((params) => {\n            if (params.has('page')) {\n                this.page = params.get('page');\n            }\n            if (params.has('id')) {\n                this.id = params.get('id');\n            }\n        }));\n        this.loadEvents();\n        this._service.title = 'My Day';\n    }\n\n    /**\n     * Update local event listing\n     * @param event_list New list of events\n     */\n    public updateEvents(event_list: EventPair[]) {\n        this.events = event_list;\n        this.saveEvents();\n    }\n\n    /**\n     * Save the current event listing\n     */\n    public saveEvents() {\n        if (localStorage) {\n            localStorage.setItem('STAFF.events', JSON.stringify(this.events || []));\n        }\n    }\n\n    /**\n     * Load the last saved event listing\n     */\n    public loadEvents() {\n        if (localStorage) {\n            const data = localStorage.getItem('STAFF.events');\n            this.events = JSON.parse(data || '[]');\n        }\n    }\n}\n","<div class=\"schedule page\">\n    <header class=\"header\">\n        <a-topbar-header [(menu)]=\"show_menu\"></a-topbar-header>\n    </header>\n    <main class=\"body\">\n        <ng-container [ngSwitch]=\"page\">\n            <ng-container *ngSwitchCase=\"'view'\">\n                <schedule-view-event [id]=\"id\" [next]=\"next\" [previous]=\"previous\"></schedule-view-event>\n            </ng-container>\n            <ng-container *ngSwitchDefault>\n                <schedule-event-list (eventList)=\"updateEvents($event)\"></schedule-event-list>\n            </ng-container>\n        </ng-container>\n    </main>\n    <footer class=\"footer\">\n        <a-footer-menu></a-footer-menu>\n    </footer>\n</div>\n<a-overlay-menu [(show)]=\"show_menu\"></a-overlay-menu>","\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { ScrollingModule } from '@angular/cdk/scrolling';\nimport { RouterModule } from '@angular/router';\nimport { ComposerModule } from '@placeos/composer';\n\nimport { ROUTES } from './schedule.routes';\nimport { SharedContentModule } from 'src/app/shared/shared.module';\n\nimport { ScheduleComponent } from './schedule.component';\nimport { ScheduleEventListComponent } from './event-list/event-list.component';\nimport { ScheduleViewEventComponent } from './view-event/view-event.component';\nimport { ScheduleEventListItemComponent } from './event-list/list-item/list-item.component';\nimport { EventDetailsComponent } from './view-event/event-details/event-details.component';\nimport { EventEditComponent } from './view-event/event-edit/event-edit.component';\n\n@NgModule({\n    declarations: [\n        ScheduleComponent,\n        ScheduleViewEventComponent,\n        ScheduleEventListComponent,\n        ScheduleEventListItemComponent,\n        EventDetailsComponent,\n        EventEditComponent\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ComposerModule,\n        FormsModule,\n        ReactiveFormsModule,\n        RouterModule.forChild(ROUTES),\n        SharedContentModule,\n        ScrollingModule\n    ]\n})\nexport class ScheduleModule { }\n","import { Routes } from '@angular/router';\n\nimport { ScheduleComponent } from './schedule.component';\n\nexport const ROUTES: Routes = [\n    { path: '', component: ScheduleComponent },\n    { path: ':page', component: ScheduleComponent },\n    { path: ':page/:id', component: ScheduleComponent },\n    { path: '**', redirectTo: '' }\n];\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Router } from '@angular/router';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { humaniseDuration } from 'src/app/shared/utilities/general.utilities';\nimport { Space } from 'src/app/services/data/spaces/space.class';\nimport { User } from 'src/app/services/data/users/user.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { ViewRoomModalComponent } from 'src/app/overlays/view-room-modal/view-room-modal.component';\n\nimport * as dayjs from 'dayjs';\nimport { UsersService } from 'src/app/services/data/users/users.service';\n\n@Component({\n    selector: 'schedule-event-details',\n    templateUrl: './event-details.component.html',\n    styleUrls: ['./event-details.component.scss']\n})\nexport class EventDetailsComponent extends BaseDirective {\n    /** Booking to display */\n    @Input() event: Booking;\n    /** Emitter for action on the display view */\n    @Output() change = new EventEmitter();\n    /** Emitter for changes to the loading state */\n    @Output() loading = new EventEmitter();\n    /** Toggle for activating checkin */\n    public checked_in: boolean;\n    /** Mapping of spaces to last checkin time */\n    public last_start: { [id: string]: number } = {};\n    /** Whether to show full locations list */\n    public show_locations: boolean;\n    /** Whether to show full attendee list */\n    public show_attendees: boolean;\n\n    /** Title of the displayed event */\n    public get title(): string {\n        if (!this.event) {\n            return '';\n        }\n        return this.event.title;\n    }\n\n    /** Display string of when the event will occur */\n    public get when(): string {\n        if (!this.event) {\n            return 'Unable to determine.';\n        }\n        const date = dayjs(this.event.date);\n        const end = date.add(this.event.duration || 60, 'm');\n        if (this.event.all_day || this.event.duration > 23 * 60) {\n            return `${date.format('DD MMM YYYY')} - All Day`;\n        } else {\n            if (date.isSame(end, 'd')) {\n                return `${date.format('DD MMM YYYY, h:mm A')} - ${end.format('h:mm A')}`;\n            } else {\n                return `${date.format('DD MMM YYYY, h:mm A')} - ${end.format(\n                    'DD MMM YYYY, h:mm A'\n                )}`;\n            }\n        }\n    }\n\n    /** Display string for the event's duration */\n    public get duration(): string {\n        if (!this.event) {\n            return 'Unable to determine';\n        }\n        return humaniseDuration(this.event.duration || 60);\n    }\n\n    /** List of spaces associated with the event */\n    public get spaces(): Space[] {\n        if (!this.event) {\n            return [];\n        }\n        return this.event.space_list;\n    }\n\n    /** List of attendees associated with the event not including the host */\n    public get attendees(): User[] {\n        if (!this.event) {\n            return [];\n        }\n        return this.event.attendees.filter(i => i.email !== this.organiser.email);\n    }\n\n    /** Host of the event */\n    public get organiser(): User {\n        if (!this.event) {\n            return this._users.current;\n        }\n        return this.event.organiser || this._users.current;\n    }\n\n    /** Whether the user is allowed to edit the event */\n    public get can_edit(): boolean {\n        const organiser = this.organiser;\n        const user = this._users.current;\n        return organiser.email === user.email && this.status !== 'done';\n    }\n\n    /** Details about the event */\n    public get notes(): string {\n        if (!this.event) {\n            return '';\n        }\n        return this.event.description || '';\n    }\n\n    /** Status of the event */\n    public get status(): 'future' | 'upcoming' | 'done' | 'started' | 'in_progress' {\n        if (this.event) {\n            const now = dayjs();\n            const date = dayjs(this.event.date);\n            /* istanbul ignore else */\n            if (now.isBefore(date.subtract(15, 'm'), 'm')) {\n                return 'future';\n            } else if (now.isBefore(date, 'm')) {\n                return 'upcoming';\n            } else if (now.isBefore(date.add(15, 'm'), 'm')) {\n                return 'started';\n            } else if (now.isBefore(date.add(this.event.duration, 'm'), 'm')) {\n                return 'in_progress';\n            }\n        }\n        return 'done';\n    }\n\n    /** Whether the user has checkin to all the spaces in the event */\n    public get is_checked_in(): boolean {\n        return this.spaces.reduce(\n            (a, v) => a && this.event.date <= (this.last_start[v.id] || 0),\n            true\n        );\n    }\n\n    /** Whether the spaces can be controlled */\n    public get can_control(): boolean {\n        return this.spaces.length > 0 && this.status !== 'future' && this.status !== 'done';\n    }\n\n    /** Whether the user is able to checkin to the event */\n    public get can_checkin(): boolean {\n        return this.spaces.length > 0 && (this.status === 'upcoming' || this.status === 'started');\n    }\n\n    constructor(private _users: UsersService, private _dialog: MatDialog, private _router: Router) {\n        super();\n    }\n\n    /**\n     * Open the modal to show the location of a space\n     * @param space Space to show the location\n     */\n    public locate(space: Space) {\n        /* istanbul ignore else */\n        if (space) {\n            this._dialog.open(ViewRoomModalComponent, {\n                width: 'auto',\n                height: 'auto',\n                maxWidth: '95vw',\n                maxHeight: '95vh',\n                data: { space }\n            });\n        }\n    }\n\n    /**\n     * Enter edit mode for the booking\n     */\n    public edit(): void {\n        this.change.emit({ type: 'edit' });\n    }\n\n    /**\n     * Checkin the current booking\n     */\n    public checkin(): void {\n        this.checked_in = !this.checked_in;\n    }\n\n    /**\n     * Store the booking data and navigate to the booking form\n     */\n    public duplicate(): void {\n        /* istanbul ignore else */\n        if (localStorage) {\n            const booking = this.event.duplicate();\n            localStorage.setItem('STAFF.booking_form', JSON.stringify(booking));\n        }\n        this.change.emit({ type: 'duplicate' });\n        this._router.navigate(['/book']);\n    }\n}\n","<div class=\"event-details\">\n    <div class=\"bindings\">\n        <ng-container *ngFor=\"let space of spaces\">\n            <ng-container *ngIf=\"space?.level?.id\">\n                <i\n                    binding\n                    [(model)]=\"last_start[space.id]\"\n                    [sys]=\"space.id\"\n                    mod=\"Booking\"\n                    bind=\"last_meeting_started\"\n                ></i>\n                <i\n                    binding\n                    [(model)]=\"checkin\"\n                    [sys]=\"space.id\"\n                    mod=\"Booking\"\n                    exec=\"start_meeting\"\n                    [params]=\"[event.date]\"\n                ></i>\n            </ng-container>\n        </ng-container>\n    </div>\n    <div class=\"body\">\n        <div class=\"field\" name=\"title\">\n            <label>Title:</label>\n            <div class=\"value\">{{ title }}</div>\n        </div>\n        <div class=\"field\" name=\"when\">\n            <label>When:</label>\n            <div class=\"value\">{{ when }}</div>\n        </div>\n        <div class=\"field\" name=\"duration\">\n            <label>Duration:</label>\n            <div class=\"value\">{{ duration }}</div>\n        </div>\n        <div class=\"field multi\" name=\"location\">\n            <label>Locations({{ spaces.length || '0' }}):</label>\n            <div class=\"value\">\n                <div class=\"list\" [class.shown]=\"show_locations\">\n                    <div\n                        class=\"list-item\"\n                        *ngFor=\"let item of spaces\"\n                        [title]=\"item?.name + ' - ' + (item?.status || 'Approved')\"\n                    >\n                        <div class=\"status\"></div>\n                        <div class=\"text\">{{ item?.name }}</div>\n                        <button class=\"show\" *ngIf=\"item?.map_id\" name=\"map\" (tapped)=\"locate(item)\">\n                            Map\n                        </button>\n                        <a\n                            class=\"show\"\n                            *ngIf=\"item?.support_url && can_control\"\n                            name=\"control\"\n                            [href]=\"item.support_url\"\n                            target=\"_blank\"\n                            >Control</a\n                        >\n                    </div>\n                    <div class=\"list-item\" *ngIf=\"!spaces.length\">No Location</div>\n                </div>\n                <button\n                    class=\"show\"\n                    *ngIf=\"spaces.length > 5\"\n                    (touchrelease)=\"show_locations = !show_locations\"\n                >\n                    {{ show_locations ? 'Hide' : 'Show' }} Locations\n                </button>\n            </div>\n        </div>\n        <div class=\"field\" name=\"host\">\n            <label>Host:</label>\n            <div class=\"value\">{{ organiser.name }}</div>\n        </div>\n        <div class=\"field multi\" name=\"attendees\">\n            <label>Attendees({{ attendees.length || '0' }}):</label>\n            <div class=\"value\">\n                <div class=\"list\" [class.shown]=\"show_attendees\">\n                    <div\n                        class=\"list-item\"\n                        *ngFor=\"let item of attendees\"\n                        [title]=\"\n                            item?.name +\n                            ' - ' +\n                            (item?.status || 'Accepted') +\n                            (item?.email ? '\\n' + item.email : '')\n                        \"\n                    >\n                        <div class=\"status\"></div>\n                        <div class=\"text\">\n                            <div class=\"name\">{{ item.name }}</div>\n                            <div class=\"email\" *ngIf=\"item.email\">\n                                <a [href]=\"'mailto:' + item.email + '?subject=' + event.title\">{{\n                                    item.email\n                                }}</a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <button\n                    class=\"show\"\n                    *ngIf=\"attendees.length > 5\"\n                    (touchrelease)=\"show_attendees = !show_attendees\"\n                >\n                    {{ show_attendees ? 'Hide' : 'Show' }} Attendees\n                </button>\n            </div>\n        </div>\n        <div class=\"field\" name=\"notes\">\n            <label>Notes:</label>\n            <div class=\"value\" [innerHTML]=\"notes\"></div>\n        </div>\n        <div class=\"field\" *ngIf=\"event && event.has_catering\" name=\"catering\">\n            <label>Catered:</label>\n            <div class=\"value\">Yes</div>\n        </div>\n    </div>\n    <div class=\"footer\">\n        <button\n            mat-button\n            *ngIf=\"can_checkin\"\n            name=\"checkin\"\n            [class]=\"\n                status === 'done' && !is_checked_in\n                    ? 'error no-events'\n                    : is_checked_in\n                    ? 'success no-events'\n                    : ''\n            \"\n            (tapped)=\"checkin()\"\n        >\n            <div class=\"text\">\n                {{\n                    status === 'done' && !is_checked_in\n                        ? 'Cancelled'\n                        : is_checked_in\n                        ? 'Checked in'\n                        : 'Checkin'\n                }}\n            </div>\n        </button>\n        <button mat-button *ngIf=\"can_edit\" name=\"edit\" (tapped)=\"edit()\">Edit</button>\n        <button mat-button *ngIf=\"can_edit\" name=\"duplicate\" (tapped)=\"duplicate()\">Duplicate</button>\n    </div>\n</div>\n","import { Component, OnInit, EventEmitter, Input, Output, SimpleChanges, OnChanges, OnDestroy } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { generateBookingForm } from 'src/app/services/data/bookings/booking.utilities';\nimport { BookingConfirmComponent } from 'src/app/shell/bookings/overlays/booking-confirm/booking-confirm.component';\nimport { UsersService } from 'src/app/services/data/users/users.service';\n\n@Component({\n    selector: 'schedule-event-edit',\n    templateUrl: './event-edit.component.html',\n    styleUrls: ['./event-edit.component.scss']\n})\nexport class EventEditComponent extends BaseDirective implements OnInit, OnChanges, OnDestroy {\n    /** Booking to display */\n    @Input() public event: Booking;\n    /** Emitter for action on the display view */\n    @Output() public change = new EventEmitter<{ type: string }>();\n    /** Emitter for changes to the loading state */\n    @Output() public loading = new EventEmitter<string>();\n    /** Form field data */\n    public form: FormGroup;\n\n    constructor(private _service: ApplicationService, private _users: UsersService, private _dialog: MatDialog) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        /* istanbul ignore else */\n        if (this.event) {\n            this.form = generateBookingForm(\n                this.event,\n                this._users.current,\n                this._service.setting('app.booking.show_fields') || []\n            );\n        }\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.event && this.event) {\n            /* istanbul ignore else */\n            if (this.form && changes.event.previousValue) {\n                (changes.event.previousValue as Booking).emit('item_saved');\n            }\n            this.form = generateBookingForm(\n                this.event,\n                this._users.current,\n                this._service.setting('app.booking.show_fields') || []\n            );\n        }\n    }\n\n    public ngOnDestroy() {\n        super.ngOnDestroy();\n        /* istanbul ignore else */\n        if (this.form && this.event) {\n            this.event.emit('item_saved');\n        }\n    }\n\n    /**\n     * Exit the edit form\n     */\n    public cancel() {\n        this.change.emit({ type: 'cancel' });\n    }\n\n    /**\n     * Save changes to the booking\n     */\n    public save() {\n        /* istanbul ignore else */\n        if (!this.event.has_changes) {\n            this._service.notifyInfo('No changes have been made to booking');\n            return;\n        }\n        /* istanbul ignore else */\n        if (this.form.valid) {\n            const dialog_ref = this._dialog.open(BookingConfirmComponent, {\n                width: '32em',\n                maxWidth: '95vw',\n                maxHeight: '95vh',\n                data: { booking: this.event }\n            });\n            dialog_ref.componentInstance.event.subscribe(event => {\n                /* istanbul ignore else */\n                if (event.reason === 'success') {\n                    this.change.emit({ type: 'view' });\n                }\n            });\n        }\n    }\n}\n","<div class=\"event-edit\">\n    <form *ngIf=\"form\" [formGroup]=\"form\" (ngSubmit)=\"save()\">\n        <div class=\"body\">\n            <a-booking-form [form]=\"form\"></a-booking-form>\n        </div>\n        <div class=\"footer\">\n            <button mat-button type=\"button\" class=\"inverse\" name=\"cancel\" (tapped)=\"cancel()\">\n                Cancel\n            </button>\n            <button mat-button type=\"submit\">Save</button>\n        </div>\n    </form>\n</div>\n","import { Component, OnInit, Input, SimpleChanges, OnChanges } from '@angular/core';\nimport { Router } from '@angular/router';\n\nimport { BaseDirective } from 'src/app/shared/base.directive';\nimport { Booking } from 'src/app/services/data/bookings/booking.class';\nimport { ApplicationService } from 'src/app/services/app.service';\nimport { BookingsService } from 'src/app/services/data/bookings/bookings.service';\n\n@Component({\n    selector: 'schedule-view-event',\n    templateUrl: './view-event.component.html',\n    styleUrls: ['./view-event.component.scss'],\n})\nexport class ScheduleViewEventComponent extends BaseDirective implements OnChanges, OnInit {\n    /** ID of the current booking to display */\n    @Input() public id: string;\n    /** ID of the next booking */\n    @Input() public next: string;\n    /** ID of the previous booking */\n    @Input() public previous: string;\n    /** Booking to display */\n    public event: Booking;\n    /** Whether booking data is being loaded */\n    public loading: string;\n    /** Whether booking is being edited */\n    public editing: boolean;\n\n    constructor(\n        private _service: ApplicationService,\n        private _bookings: BookingsService,\n        private _router: Router\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.subscription(\n            'arrow_right',\n            this._service.Hotkeys.listen(['ArrowRight'], () => this.nextBooking())\n        );\n        this.subscription(\n            'arrow_left',\n            this._service.Hotkeys.listen(['ArrowLeft'], () => this.previousBooking())\n        );\n        this.subscription(\n            'changes',\n            this._bookings.listen('list').subscribe(() => this.loadEvent())\n        );\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.id && this.id) {\n            this.event = null;\n            this.editing = false;\n            this.loading = '';\n            this.loadEvent();\n        }\n    }\n\n    /**\n     * Load the details of the active event\n     */\n    public loadEvent() {\n        this.loading = 'Loading booking data...';\n        let booking = this._bookings.find(this.id);\n        if (booking) {\n            this.event = booking;\n            this.loading = '';\n        } else {\n            this._bookings.show(this.id, {}).then(\n                (bkn) => {\n                    this.loading = '';\n                    this.event = bkn;\n                },\n                () => {\n                    this.loading = '';\n                    this._service.notifyError(`Failed to loaded booking data<br>ID: ${this.id}`);\n                    this._router.navigate(['/schedule']);\n                }\n            );\n        }\n    }\n\n    /**\n     * View the next booking in the list\n     */\n    public nextBooking() {\n        /* istanbul ignore else */\n        if (this.next && !this.editing) {\n            this._router.navigate(['/schedule', 'view', this.next]);\n        }\n    }\n\n    /**\n     * View the previous booking in the list\n     */\n    public previousBooking() {\n        /* istanbul ignore else */\n        if (this.previous && !this.editing) {\n            this._router.navigate(['/schedule', 'view', this.previous]);\n        }\n    }\n\n    /**\n     * Handle changes to sub-components\n     */\n    public onChange(event: { type: string }): void {\n        /* istanbul ignore else */\n        if (event.type === 'edit') {\n            this.editing = true;\n        } else if (event.type === 'view' || event.type === 'cancel') {\n            this.editing = false;\n        }\n    }\n}\n","<div class=\"event-display\">\n    <div class=\"header\">\n        <div class=\"icon\"></div>\n        <div class=\"details\">\n            <a mat-icon-button name=\"previous\" [routerLink]=\"['/schedule', 'view', previous]\" [class.disabled]=\"!previous\">\n                <div class=\"left icon\">\n                    <i class=\"material-icons\">keyboard_arrow_left</i>\n                </div>\n            </a>\n            <div class=\"title\">{{ event ? event.title || 'No title' : '????' }}</div>\n            <a mat-icon-button name=\"next\" [routerLink]=\"['/schedule', 'view', next]\" [class.disabled]=\"!next\">\n                <div class=\"right icon\">\n                    <i class=\"material-icons\">keyboard_arrow_right</i>\n                </div>\n            </a>\n        </div>\n        <a mat-icon-button [routerLink]=\"['/schedule']\">\n            <div class=\"icon\">\n                <i class=\"material-icons\">close</i>\n            </div>\n        </a>\n    </div>\n    <div class=\"body\">\n        <div class=\"content\">\n            <ng-container *ngIf=\"loading\">\n                <div class=\"no-item center\">\n                    <div class=\"icon\">\n                        <mat-spinner diameter=\"48\"></mat-spinner>\n                    </div>\n                    <div class=\"text\">\n                        {{ loading }}\n                    </div>\n                </div>\n            </ng-container>\n            <div [class.hide]=\"loading\">\n                <ng-container *ngIf=\"!editing; else edit_form\">\n                    <schedule-event-details [event]=\"event\" (change)=\"onChange($event)\" (loading)=\"loading = $event\"></schedule-event-details>\n                </ng-container>\n                <ng-template #edit_form>\n                    <schedule-event-edit [event]=\"event\" (change)=\"onChange($event)\" (loading)=\"loading = $event\"></schedule-event-edit>\n                </ng-template>\n            </div>\n        </div>\n    </div>\n</div>\n\n"]}