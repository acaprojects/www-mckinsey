{"version":3,"sources":["webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/animations/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/animations/src/lib/angular-animations.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/animations/src/lib/animations.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/base.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/base.directive.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/base.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/cdk-drop-list-scroll-container.directive.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/date.spec-helpers.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/date.utils.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/general.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/image.directive.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/numbers-only.directive.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/base/src/lib/replace.pipe.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/bookings/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/bookings/src/lib/bookings.actions.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/bookings/src/lib/bookings.effects.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/bookings/src/lib/bookings.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/bookings/src/lib/bookings.reducer.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/bookings/src/lib/bookings.utils.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/buildings/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/buildings/src/lib/buildings.actions.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/buildings/src/lib/buildings.effects.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/buildings/src/lib/buildings.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/buildings/src/lib/buildings.reducer.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/api.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/app.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/base-api.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/base.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/booking-filter.utils.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/booking.form.actions.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/booking.form.data.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/booking.form.spec-helpers.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/booking.selectors.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/booking.utils.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/booking/room-results/room-results.viewmodel.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/booking-state.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/booking.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/booking.types.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/booking.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/bookings.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/bookingsPaginated.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/bookings/space.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering-categories.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering-category.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering-item.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering-items.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering-menu.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering-notes.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering-order.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/catering.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/catering/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/close-modal-dialog-service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/data-common.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/hotkeys.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/location/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/location/location.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/location/location.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/organisation/building.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/organisation/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/organisation/level.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/organisation/organisation.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/organisation/organisation.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/paginated.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/recurrence/recurrence.utils.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/reports/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/reports/report.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/reports/reports.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/service-manager.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/settings.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/spaces/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/spaces/space.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/spaces/space.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/spaces/spaces.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/spec-helpers.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/users/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/users/user.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/users/user.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/users/users.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/data-common/src/lib/validation.utilities.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/date-tz/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/date-tz/src/lib/date-tz.class.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/environment/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/environment/src/lib/environment.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/environment/src/lib/environment.service.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/environment/src/lib/version.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/booking-confirm/booking-confirm.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/booking-confirm/booking-confirm.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/booking-form/booking-form.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/booking-form/booking-form.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/catering-confirm-modal/catering-confirm-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/catering-confirm-modal/catering-confirm-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/catering-details-modal/catering-details-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/catering-details-modal/catering-details-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/confirm-modal/confirm-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/confirm-modal/confirm-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/legacy-overlays.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/new-user-modal/new-user-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/new-user-modal/new-user-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/no-catering-modal/no-catering-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/no-catering-modal/no-catering-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/requirement-details-modal/requirement-details-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/requirement-details-modal/requirement-details-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/space-select-modal/space-select-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/space-select-modal/space-select-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/user-form/user-form.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-overlays/src/lib/user-form/user-form.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/action-icon/action-icon.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/action-icon/action-icon.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/bookings/catering/item/item.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/bookings/catering/item/item.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/bookings/catering/package-options-modal/package-options-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/bookings/catering/package-options-modal/package-options-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/action-field/action-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/action-field/action-field.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/counter/counter.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/counter/counter.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/date-field/date-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/date-field/date-field.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/duration-field/duration-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/duration-field/duration-field.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/time-field/time-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/time-field/time-field.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/user-list-field/user-list-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/user-list-field/user-list-field.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/user-search-field/user-search-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/custom-fields/user-search-field/user-search-field.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/feedback/feedback.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/feedback/feedback.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/icon/icon.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/icon/icon.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/legacy-ui.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/popout-menu/popout-menu.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/popout-menu/popout-menu.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/searchbar/searchbar.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/searchbar/searchbar.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/user-avatar/user-avatar.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/legacy-ui/src/lib/user-avatar/user-avatar.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/loading/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/loading/src/lib/loading.actions.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/loading/src/lib/loading.effects.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/loading/src/lib/loading.model.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/loading/src/lib/loading.selectors.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/loading/testing/effects.testing.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/loading/testing/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/organisation/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/organisation/src/lib/organisation.actions.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/organisation/src/lib/organisation.effects.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/organisation/src/lib/organisation.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/organisation/src/lib/organisation.reducer.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/rooms/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/rooms/src/lib/rooms.actions.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/rooms/src/lib/rooms.effects.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/rooms/src/lib/rooms.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/rooms/src/lib/rooms.reducer.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/rooms/src/lib/rooms.types.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/rooms/src/lib/rooms.utils.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/rx-utils/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/rx-utils/src/lib/loading-model.utils.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/rx-utils/src/lib/operators.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/rx-utils/src/lib/rx-utils.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/aca-date-picker/aca-date-picker.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/aca-date-picker/aca-date-picker.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/alert-banner/alert-banner.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/auto-complete-chip-select-item/auto-complete-chip-select-item.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/auto-complete-chip-select-item/groupHeader.pipe.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/auto-complete-select-option/auto-complete-select-option.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/auto-complete-select-option/auto-complete-select-option.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/base-template.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/cng-select/cng-select-options.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/cng-select/cng-select-options.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/cng-select/cng-select.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/cng-select/cng-select.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/cng-select/dropdown-trigger-for.directive.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/collapse-header/collapse-header.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/conflict-alert-modal/conflict-alert-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/conflict-alert-modal/conflict-alert-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/conflicts-modal/conflicts-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/conflicts-modal/conflicts-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/date-tz-calendar-widget/date-tz-calendar-widget.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/date-tz-calendar-widget/date-tz-calendar-widget.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/date-tz-date-picker/date-tz-date-picker.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/date-tz-duration-field/date-tz-duration-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/date-tz-time-field/date-tz-time-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/duration-field/duration-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/error-message/error-message.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/icons/calendar/calendar-icon.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/icons/calendar/chevron-icon.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/icons/close/close-icon.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/informational-image/informational-image.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/label/label.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/legend-dropdown/legend-dropdown.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/mck-date-picker/mck-date-picker.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/modal-button-row/modal-button-row.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/modal/modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/override-changes-modal/override-changes-modal.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/override-changes-modal/override-changes-modal.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/pipes/filter.pipe.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/pipes/sanitise.pipe.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/radio-select/radio-select.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/recurrence-booking-form/recurrence-booking-form.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/recurrence-booking-form/recurrence-booking-form.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/recurrence-date-form/recurrence-date-form.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/recurrence-date-form/recurrence-date-form.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/recurrence-pattern-form/recurrence-pattern-form.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/recurrence-pattern-form/recurrence-pattern-form.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/select-option/select-option.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/select/select.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/select/select.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/selected-chip-count/selected-chip-count.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/spacer/spacer.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/switch-group/switch-group.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/time-field/time-field.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/toggle/toggle.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/tooltip/tooltip.component.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/tooltip/tooltip.component.html","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/tooltip/tooltip.directive.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/tooltip/tooltip.enums.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/types.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/ui.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/ui/src/lib/utils/time.utils.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/user/src/index.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/user/src/lib/user.actions.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/user/src/lib/user.effects.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/user/src/lib/user.module.ts","webpack:///home/runner/work/mckinsey-converge/mckinsey-converge/libs/user/src/lib/user.reducer.ts","webpack:///$_lazy_route_resource lazy namespace object","webpack:///src/app/app-routing.module.ts","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///src/app/booking/booking-calendar/booking-calendar-date-widget/calendar-date-widget.component.ts","webpack:///src/app/booking/booking-calendar/booking-calendar-date-widget/calendar-date-widget.component.html","webpack:///src/app/booking/booking-calendar/booking-calendar-routing.module.ts","webpack:///src/app/booking/booking-calendar/booking-calendar-wrapper.component.ts","webpack:///src/app/booking/booking-calendar/booking-calendar-wrapper.html","webpack:///src/app/booking/booking-calendar/booking-calendar.module.ts","webpack:///src/app/booking/booking-calendar/cng-menu-item/cng-menu-item.component.ts","webpack:///src/app/booking/booking-calendar/cng-menu-item/cng-menu-item.component.html","webpack:///src/app/booking/booking-calendar/staff-calendar/space/event/event.component.ts","webpack:///src/app/booking/booking-calendar/staff-calendar/space/event/event.component.html","webpack:///src/app/booking/booking-calendar/staff-calendar/space/space.component.ts","webpack:///src/app/booking/booking-calendar/staff-calendar/space/space.component.html","webpack:///src/app/booking/booking-calendar/staff-calendar/staff-calendar.component.ts","webpack:///src/app/booking/booking-calendar/staff-calendar/staff-calendar.component.html","webpack:///src/app/booking/booking-calendar/staff-calendar/timeline/timeline.component.ts","webpack:///src/app/booking/booking-calendar/staff-calendar/timeline/timeline.component.html","webpack:///src/app/booking/booking-confirmation/booking-confirmation.component.ts","webpack:///src/app/booking/booking-create/booking-create.component.ts","webpack:///src/app/booking/booking-create/booking-form-base.component.html","webpack:///src/app/booking/booking-create/booking-edit-wrapper.component.ts","webpack:///src/app/booking/booking-create/booking-edit.component.ts","webpack:///src/app/booking/booking-create/booking-form-base.component.ts","webpack:///src/app/booking/booking-details-modal/booking-details-modal.component.ts","webpack:///src/app/booking/booking-duration-modal/booking-duration-modal.component.ts","webpack:///src/app/booking/booking-result-item/booking-result-item.component.ts","webpack:///src/app/booking/booking-result-item/booking-result-item.component.html","webpack:///src/app/booking/booking-routing.module.ts","webpack:///src/app/booking/booking.form.reducer.ts","webpack:///src/app/booking/booking.module.ts","webpack:///src/app/booking/bookings-listing/bookings-listing.component.ts","webpack:///src/app/booking/bookings-listing/bookings-listing.component.html","webpack:///src/app/booking/cancel-booking-modal/cancel-booking-modal.component.ts","webpack:///src/app/booking/catering/catering.component.ts","webpack:///src/app/booking/catering/catering.component.html","webpack:///src/app/booking/catering/order-details/category/category.component.ts","webpack:///src/app/booking/catering/order-details/category/category.component.html","webpack:///src/app/booking/catering/order-details/order-details.component.ts","webpack:///src/app/booking/catering/order-details/order-details.component.html","webpack:///src/app/booking/catering/order-list/item/item.component.ts","webpack:///src/app/booking/catering/order-list/item/item.component.html","webpack:///src/app/booking/catering/order-list/order-list.component.ts","webpack:///src/app/booking/catering/order-list/order-list.component.html","webpack:///src/app/booking/catering/order-table/order-table.component.ts","webpack:///src/app/booking/manage-bookings/manage-bookings.component.ts","webpack:///src/app/booking/manage-bookings/manage-bookings.viewmodel.ts","webpack:///src/app/booking/office-floor/floor-map-overlay/floor-map-overlay.component.ts","webpack:///src/app/booking/office-floor/floor-map.utils.ts","webpack:///src/app/booking/office-floor/office-floor-map.module.ts","webpack:///src/app/booking/office-floor/office-floor/office-floor.component.ts","webpack:///src/app/booking/office-floor/office-floor/office-floor.component.html","webpack:///src/app/booking/results-header/results-header.component.ts","webpack:///src/app/booking/room-availability-preview-modal/room-availability-preview-modal.component.ts","webpack:///src/app/booking/room-availability-preview/room-availability-preview.component.ts","webpack:///src/app/booking/room-availability-preview/room-availability-preview.component.html","webpack:///src/app/booking/room-booking-details-form/room-booking-details-form.component.ts","webpack:///src/app/booking/room-booking-details-form/room-booking-details-form.component.html","webpack:///src/app/booking/room-booking-form/room-booking-form.component.ts","webpack:///src/app/booking/room-booking-form/room-booking-form.component.html","webpack:///src/app/booking/room-booking-modal/room-booking-modal.component.ts","webpack:///src/app/booking/room-booking/room-booking.component.ts","webpack:///src/app/booking/room-details/room-details.component.ts","webpack:///src/app/booking/room-details/room-details.component.html","webpack:///src/app/booking/room-filters-form/room-filters-form.component.ts","webpack:///src/app/booking/room-filters-modal/room-filters-modal.component.ts","webpack:///src/app/booking/room-location-preview/room-location-preview.component.ts","webpack:///src/app/booking/room-result-item/room-result-item.component.ts","webpack:///src/app/booking/room-results-paginated/room-results-paginated.component.ts","webpack:///src/app/booking/room-results-section/room-results-section.component.ts","webpack:///src/app/booking/room-results/room-results-coachmark.viewmodel.ts","webpack:///src/app/booking/room-results/room-results.component.ts","webpack:///src/app/booking/searched-location/searched-location.component.ts","webpack:///src/app/components/footer-menu/footer-menu.component.ts","webpack:///src/app/components/footer-menu/footer-menu.component.html","webpack:///src/app/components/map-controls/map-controls.component.ts","webpack:///src/app/components/map-controls/map-controls.component.html","webpack:///src/app/components/overlay-menu/overlay-menu.component.ts","webpack:///src/app/components/overlay-menu/overlay-menu.component.html","webpack:///src/app/components/responsive-inline-images/responsive-inline-images.component.ts","webpack:///src/app/components/survey-modal/survey-modal.component.ts","webpack:///src/app/components/survey-modal/survey-modal.component.html","webpack:///src/app/components/topbar-header/topbar-header.component.ts","webpack:///src/app/login/login.component.ts","webpack:///src/app/login/login.component.html","webpack:///src/app/map/map-controls/map-controls.component.ts","webpack:///src/app/map/map-filters/map-filters.component.ts","webpack:///src/app/map/map-overlay/map-overlay.component.ts","webpack:///src/app/map/map-search/map-search.component.ts","webpack:///src/app/map/map.module.ts","webpack:///src/app/map/map.utils.ts","webpack:///src/app/map/office-information-modal/office-information-modal.component.ts","webpack:///src/app/shared/shared.module.ts","webpack:///src/app/shell/shell.component.ts","webpack:///src/app/shell/shell.component.html","webpack:///src/app/utilities/urls.ts","webpack:///src/environments/environment.ts","webpack:///src/environments/settings.ts","webpack:///src/hmr.ts","webpack:///src/main.ts"],"names":["ANIMATION_SHOW_ENTER_LEAVE","trigger","transition","style","opacity","height","animate","ANIMATION_SHOW_CONTRACT_EXPAND","state","AnimationsModule","CommonModule","NgModule","imports","BaseClass","_timers","_intervals","_subscriptions","_initialised","BehaviorSubject","key","hasOwnProperty","clearTimeout","clearInterval","unsub","name","fn","delay","Function","setTimeout","Error","setInterval","Subscription","unsubscribe","getValue","BaseDirective","destroy","Directive","selector","BaseModule","NumbersOnlyDirective","declarations","exports","ScrollDirection","CdkDropListScrollContainer","_cdkDropList","_renderer","direction","X","last_scroll","x","y","changes","scrollContainer","element","nativeElement","closest","subscription","items","subscribe","list","toArray","forEach","i","index","listen","onDrop","onDrag","updateListPosition","timeout","scroll","scrollLeft","scrollTop","BOTH","Y","_dropListRef","_cacheOwnPosition","_siblings","isReceiving","CdkDrag","Input","ContentChildren","initialTime","mockDate","timeOverride","set","Date","resetDate","reset","closestToTimeSlot","date","stepMinute","start","millisecond","second","minute","Math","ceil","plus","minutes","closestToTimeSlotTz","dateTz","setValue","addValue","durationHumanized","duration","short","h","floor","d","m","weekDayMonthYearFormat","formatDate","extractDateFromInput","input","checkHour","startDate","dayjs","dayJsTimeFormatString","isValid","cleanedInput","times","split","undefined","length","dayJsHoursMinutes","month","year","hour","nearestStepToInput","step","currentStartDate","luxonDate","DateTime","fromMillis","valueOf","closestDate","toFormat","nearestDurationToInput","durationGroups","value","parseInt","indexOf","add","diff","closestDurationGroup","find","max","offset","reduce","previousValue","currentValue","resetSecondsOnTimestamp","timestamp","toMillis","formatDateWithSuffix","dateObj","day","getDate","toLocaleString","getFullYear","nthNumber","number","getListOfDateFormat","extend","utc","timezone","isToday","weekday","customParseFormat","log","type","msg","args","stream","force","app_name","window","debug","colors","console","getItemWithKeys","keys","map","slice","isMobileDevice","r","navigator","userAgent","match","isMobileSafari","agent","isAndroidChrome","padZero","str","toString","unique","array","filter","el","pos","arr","humaniseDuration","durationInput","size","singular","format","hours","filterList","fields","results","filters","toLowerCase","f","parts","push","word","count","regex","RegExp","sort","a","b","localeCompare","item_list","JSON","parse","stringify","item","match_count","match_index","field_list","matched","field","matches","replace","changed","tokens","k","join","matchToHighlight","timeToDate","time","DateNow","startOfValue","ms","randomInt","random","timeFormatString","is24HourTime","hoursMinutes","timezoneNameToDate","timeZoneName","zone","toZone","e","timezoneDisplay","gmtOffsetDisplay","timeWithZoneFormatString","toLocaleLowerCase","timeWithGmtOffsetFormatString","startEndTimeFormatString","startDateTz","endDateTz","startEndTimeWithZoneFormatString","dateLocalFormatString","comma","formatLocalDate","dateBuildingFormatString","shorterLocalDateFormatString","shorterBuildingDateFormatString","localeString","toLocaleTimeString","document","querySelector","getAttribute","language","downloadFile","filename","contents","createElement","setAttribute","encodeURIComponent","display","body","appendChild","click","removeChild","csvToJson","csv","lines","splice","v","line","part","jsonToCsv","json","Array","Object","valid_keys","detectIE","ua","msie","substring","trident","rv","edge","eventToPoint","event","MouseEvent","clientX","clientY","touches","flatten","an_array","stack","res","next","pop","isArray","reverse","seed","xmur3","rand","sfc32","predictableRandomInt","imul","charCodeAt","c","t","isLessThanBreakpoint","breakpoint","innerWidth","toTitleCase","toUpperCase","ImageDirective","_el","initalValue","stopPropagation","HostListener","ReplacePipe","from","to","Pipe","bookingStateSelector","bookings","loadBookingsWithQuery","createAction","props","loadHomepageBookingsResults","createLoadingAction","loadUpcomingBookingsResults","loadPastBookingsResults","loadCancelledBookingsResults","loadBookingByIdResults","clearBookingByIdResults","BookingsEffects","actions","bookingService","afterBookingsRequestResultsLoadOthersEffect","pipe","ofType","mergeMap","action","DateTZ","yourBookingsRequest","email","pagination","limit","show_cancelled","end_epoch","subtractValue","seconds","include_rooms","upcomingRequest","pastRequest","start_epoch","cancelledRequest","byIdRequest","id","effects","target","request","loadHomepageBookingsResultsEffect","createLoadingEffect","userBookings","loadUpcomingBookingsResultsEffect","loadPastBookingsResultsEffect","loadCancelledBookingsResultsEffect","loadBookingByIdResultsEffect","Effect","Injectable","BookingsModule","EffectsModule","forFeature","StoreModule","bookingsReducer","initialBookingsState","query","LoadingModel","empty","homepage","upcoming","past","cancelled","bookingById","createReducer","on","ons","initialBookingFormState","activeFormFilters","bookingFormReducer","storeBookingFormData","activeForm","payload","clearBookingFormData","openBookingSurvey","bookingCompleted","storeRoomFilters","clearRoomFilters","mapBookingToSelectOption","booking","loadBuildings","buildingStateSelector","buildings","selectLoadBuildingsSuccess","createSelector","selectors","optionalSuccess","selectBuildingOptionsGroupedByCity","success","mapped","Map","s","found","city","get","selectLevelByZoneId","param","levels","l","BuildingsEffects","organizationService","loadBuildingsWithOrg","loadBuildingsAfterOrg","loadOrganisations","BuildingsModule","buildingsReducer","initialBuildingState","data","toQueryString","ApplicationService","store","analytics","_app_ref","_zone","_title","_settings","_hotkeys","_composer","_snackbar","_environment","_subjects","_observers","isStable","first","_","run","waitForSettings","message","on_action","icon","content","snackbar_ref","open","panelClass","afterDismissed","dismiss","onAction","notify","asObservable","initialised","init","setupComposer","select","selectCurrentUser","user","take","setupAnalytics","fmno","application","loading","composer","settings","protocol","location","host","domain","hostname","port","url","use_domain","origin","route","includes","mock","href","localStorage","getItem","config","scope","auth_uri","token_uri","redirect_uri","handle_login","local_login","setup","heap_io_id","heapIo","app_id","load","identify","frontend","isIt","_kioskFormFilter","title_suffix","setting","setTitle","getTitle","auth","api_endpoint","is_initialised","providedIn","BaseDataClass","raw_data","event_subject","Subject","events","_server_names","zone_id","_service","form","toJSON","Promise","resolve","reject","promise","update","then","metadata","task_name","parameters","task","obj","_changes","new_key","ServiceManager","serviceFor","BaseAPIService","settingsService","_subscribers","_promises","_compare","_list_filter","_name","_api_route","form_data","concierge","err","engine","endpoint","predicate","query_params","cache","result","http","process","processApiResult","catchError","error","of","new_item","post","injectConcierge","analyticsEvent","updateList","method","post_data","_task","put","removeItem","should_inject_concierge","apiSubRoute","token","sessionStorage","access_token","headers","HttpHeaders","requestOptions","q","label","raw_item","old_list","compareFn","new_list","mixed_list","spaceExtraFeatureToDisplayName","feature","SpaceFeatures","VideoConference","ConferencePhone","WirelessContentSharing","FlipChart","Glassboard","ElectronicWhiteboard","ConferenceRoom","TeamRoom","PartnerOffice","PhoneBooth","NaturalLight","BoardRoom","CocktailRoom","TheatreRoom","WorkshopRoom","UShapeRoom","Miscellaneous","Catering","instantBookOption","shortDisplay","instantBookOptions","mapSpaceFeaturesToSelectOption","roomEquipmentRequiredOptions","internalRoomTypeRequiredOptions","externalRoomTypeRequiredOptions","roomDetailsRequired","roomCateringAvailable","SpaceFilterReason","filterSpacesByAppliedFilters","formFilters","spaces","currentUser","instantBook","some","onlyCatering","featureFilters","formFiltersEmpty","options","rulesCount","ruleReason","excludedByFiltersCount","statusMap","filteredSpaces","space","Space","raw_space","building","zones","rules","rulesForSpace","booking_rules","reason","valid","hide","hasAllFeatures","internalRoomTypeFilters","every","featuresArray","canBook","bookable","matchesType","bookingType","internal_or_external","hasCatering","has_catering","status","statusFromBookings","Booking","auto_approve","group","available","buildingsInSameCity","meta","alternateBuildings","locationItem","specificReason","None","Filters","OfficeRules","AlternateBuildingsFound","DEFAULT_BOOKING_DURATION","internalBookingTypeOption","allBookingTypeOption","bookingTypeOptions","defaultRoomSizeOption","roomSizeOptions","roomSizeOptionsKiosk","roomCapacityToValue","roomSize","roomMaxCapacityToValue","roomFormDataToQuery","filteredLocationIds","groupChild","locations","capacity","capacity_max","is_recurrent","recurrence_period","recurrence_interval","recurrence_endTz","recurrence_count","recurrence_starts","recurrence_exceptions","recurrence_days","ignore","now","defaultTestBookingForm","selectBookingFormsData","bookingForm","selectActiveForm","is_local_tz","building_tz","endTzDate","recEditingSearchPayload","SeriesAction","EDIT","selectBookingType","selectBookingLocations","groupHeader","selectIsInternal","selectFormFilters","selectRoomResultsFromState","roomStateSelector","loadRoomsForResults","model","selectRoomResultsFromState_map","loadRoomsForResultsMap","selectLaterThatDayResultsFromState","loadLaterThatDayResults","selectNextDayResultsFromState","loadNextDayResults","selectByIdResultsFromState","loadByIdResults","selectDiffSizeResultsFromState","loadDiffSizeResults","selectHomepageBookingsResultsFromState","selectUpcomingBookingsResultsFromState","selectPastBookingsResultsFromState","selectCancelledBookingsResultsFromState","selectBookingByIdResultsFromState","filterSpacesByAppliedFiltersIfSuccess","mutate","selectFilteredResults","selectMapFilteredResults","selectFilteredLaterDayResults","selectFilteredNextDayResults","selectFilteredByIdResults","selectFilteredDiffSizeResults","selectSelectedBuildingOptions","MAX_ABBREV_LOCATIONS","mapBuildingToSelectOption","dropdownOverride","code","address","groupId","mapCityToAllSelectOption","flattenDisplayOffices","grouped","toggleSelectedByGroup","selectedOptions","option","toSelect","selected","newGroup","remainingChildrenInGroup","o","ng","truncateLocationList","truncatedLocations","shouldTruncate","mapBuildingLevelToOption","level","flattenBuildingsWithLevels","flattenedLevels","placeholderRoute","num","setupRoomImages","componentReference","image_positions","rootFolderURL","fileSlug","imagesLoaded","foundImages","path","n","desiredImageName","desiredImage","pathname","tester","Image","onload","loadImages","src","bookingStatusDetails","image","text","title","roomHasCateringHours","catering_hours","cateringAllowed","disallowedStatus","opens","closed","end","openMinutes","closeMinutes","startOfDay","cateringOpenTime","cateringCloseTime","checkCollisions","service","availabilityParams","room_ids","breakdown","hide_bookings","recurrence_type","icaluid","start_time","end_time","has_conflict","bkn","b_setup","b_breakdown","recurrence_master_id","getStatusErrorMessage","RoomResultsViewModel","levelDisplay","short_name","local_name","office","mapResultsToViewModels","BookingStateService","_org","_spaces","ngZone","_poll","_long_poll","_long_poll_week","_bookings","_noOfMeetings","_filters","_dateTz","_loading","_state","combineLatest","filtered","bdTz","booking_date","startTz","endTz","endOfValue","filterBookings","shareReplay","filtered_week","bd","getEndOfWeek","filtered_month","search","debounceTime","switchMap","fzone","queryBooking","zone_ids","available_from","available_to","search_long_week","querySpace","space_list","processBookings","dailyCount","days","daily_count","buildSpaceLongQuery","counts","details","runOutsideAngular","interval","updateRoomList","new_bookings","concat","undo","attempted_to_delete","bkg","booking_master","period","replaceBookings","room_email","fromTz","toTz","intersects","timePeriodsIntersect","in_zone","room","has_space","space_emails","in_zones","declined","getType","show","hide_type","dateWeekday","time_changed","SettingsService","is_concierge","nowTz","defaultTitle","defaultLocalTimezone","Intl","DateTimeFormat","resolvedOptions","timeZone","defaultBuildingZone","defaultOrgainiser","User","active_user","defaultBookingType","building_zone","booking_type","attendees","organiser","creator","booked_by","notes","equipment_codes","expected_attendees","check_ins","notify_users","company","booker","booker_concierge","level_zone","opt_out","room_id","findSpace","defaultStartTz","startEpochProvided","startDateTzProvided","round","created_epoch","all_day","show_as","approvalStatus","approval_status","catering","CateringOrder","edited_fields","edits","values","occurrence_edits","recurrence_end","occurrence_ids","occurrence_details","author","isEdit","opts","note","handleRecurrenceFields","recurrence_list","location_name","from_room","approve","old_start","old_end","creation_date","creationDateTz","cateringOrders","allAttendees","checked_in","checkInsArray","has_visitors","occurence","getTime","shift","_recurrence_endTz","byRequest","tentative","delivery_time","getTimezoneOffsetString","abs","dateDiff","displayEndDateTz","external","buildingTzDt","isBeforeDate","isAfterDate","recurrenEndFromOcurrences","mergeCateringOrders","order_list","orders","order","location_id","booking_timezone","BOOKING_STATUS","MINUTE","HOUR","DAY","WEEK","MONTH","DURATION_MAP","months","week","weeks","bookingOptionsToQuery","property","until","getFreeBookingSlots","min_size","slots","bkn_start","bkn_end","getNextFreeBookingSlot","date_","block","generateBookingForm","use_fields","isConcierge","manualTimezone","user_service","current_user","current","FormControl","disabled","Validators","required","validators","minLength","updateOn","needs_space","is_before_date","setValidators","validateEndTime","disable","dateValidators","isFuture","validDateTZ","updateValueAndValidity","list_length","valueChanges","expected","codes","new_expected","new_codes","space_needed","simplified_fields","handleAllDay","clone","enable","occurrences","RecurrencePeriod","LIST","occurrence","CLONE","BookingAction","start_dateTz","d1","d2","_recurr_end","fields_with_recurrence","WEEKLY","recurrence_pattern","arrayWithValues","FormGroup","control","validDate","isSameDate","JSDate","getMinLength","rule_list","min","min_block","min_length","conditions","stringToMinutes","durationGreaterThanOrEqual","duration_1","duration_2","requestable","free_slots","next_free_slot","currently_free","time_until_next_block","free_tomorrow","free_today","available_until","spaceStatusToDisplay","filter_options","filtered_list","updated_list","start1","end1","start2","end2","formatWhen","startTZ","endTZ","displayEndTZ","BookingsService","setService","uniqueId","respond","series","toApiJSON","taskObsr","requests","booking_id","forkJoin","BookingsPaginatedService","getHoldingBay","queryHoldingBay","response","PaginatedAPIService","space_rules_for_user","rule_block","checkRules","ruleset","max_length","counter","condition","groups","j","last_location","check","CateringCategoriesService","CateringCategory","is_category","must_select","order_anytime","CateringItem","_amount","instance_id","from_month","to_month","description","prior_notice","notice","unit_price","price","supplier_cost","minimum_quantity","maximum_quantity","parent_categories","category_ids","categories","image_path","admin_only","catering_type","amount","allergy","cateringItems","filteredCateringItems","out_of_stock","availableItems","substr","anytime","can_order_anytime","CateringItemsService","CateringMenuService","CateringNotesService","cateringNotes","hasBookingAttached","bookingDateTz","charge_code","kitchen","pantry","symbol","total","deliver_date","mergeCateringItemWithFormData","existing","override","CloseDialogService","dialogRefMap","dialogRef","close","DialogIds","DataCommonModule","INVALID_STANDALONE_KEYS","HotkeysService","keydown_states","keydown_observers","combo_end","registered_combos","addEventListener","mapKey","last_down","preventDefault","combo","combination","validCombination","last_key","updateCombinationEndList","presses","key_list","non_meta","MapLocation","map_id","desk_id","normalise","x_max","Organisation","BuildingLevel","levelWithID","fixed","confidence","at_desk","bld","building_id","LocationService","Building","disc_info","discovery_info","extras","extra_id","extra_name","loan_items","_roles","roles","_lockers","lockers","locker_structure","_systems","systems","_phone_numbers","phone_numbers","_location","longitude","latitude","searchables","neighbourhoods","lvl","lvl_features","level_id","booking_details","catering_restricted_from","currency","requires_equipment_code","equipment_code","requires_expected_attendees","holding_bay","visitor_space","sort_order","_data","bld_id","level_name","lower_name","map_url","floor_type","available_buildings","OrganisationService","_users","_spaceTypesSubject","_organisation","ids","bld_list","_active_building","organisation","loadOrganisation","loadLevels","space_types","loadSpaceTypes","tags","org_data","bld_data","lvl_data","type_data","types","getOrganizationFiltersByRoomType","setItem","DaysOfWeek","RepeatsOn","recurrencePeriodToDurationType","DAILY","ABSOLUTE_MONTHLY","generateWeekDays","params","start_week","week_days","activeDate","active","full_name","day_index","getFirstDateFromList","getLastDateFromList","recurrenceDetails","recurr","getPeriod","recurrenceRecurringDetails","removeExpiredOcurrences","controls","tz","date_now","setStartAndEndDateFromArray","dates","setRecurrenceStartsTime","dateHour","Report","cleanData","txt","charAt","UNIX_timestamp","getMonth","getHours","suffix","getMinutes","timeConverter","formatCancelledBy","room_field","price_field","row","space_service","org_service","CurrencyPipe","transform","organizer","person","isCancelled","cancelled_by","cancelled_at_epoch","cancelled_date","remove_fields","output","idx_a","idx_b","csv_json","ReportsService","fromCSV","_service_list","findIndex","provider","provideFor","useValue","SETTINGS_TOKEN","SettingsObject","_app_name","_overrides","_observables","_bypass_bookings","VERSION","built","semver","hash","override_settings","Inject","OPTION_DEFAULTS","SpaceEquipments","SpaceStyles","EMPTY_ARRAY","allowStaffRoomWithBookings","room_style","equipment","bypass_bookings","defaultGlobalName","defaultSettings","room_name","support_url","features","extra_features","room_type","simple_name","rulesFor","nowMs","runningBookings","bks","startEpoch","endEpoch","spaceWithBookings","roomType","natural_light","Set","recurrence_availability","availabilityOptionsToQuery","hide_declined","blds","bld_b","a_has_zone","b_has_zone","SPACE_LIST","SpacesService","queryRooms","updateSpace","uploadSpacePhotos","setList","filterAvailableSpaces","faker","SERVICE","generateMockOrganisationService","jest","generateMockBuilding","getRoomTypeSubsetDDOptions","generateMockDataService","generateMockSpacesService","generateMockUsersService","loadCurrentUser","bookingState","setZone","setDate","setFilters","remove","startPolling","startPollingMonth","startPollingWeek","startPollingEveryFiveMin","test_app","logo_light","background","logo_dark","heap_io","force_ssl","secure_cookie","disable_text_capture","cookie_path","TEST_SETTINGS","app","generateMockSettingsService","overrides","provideMockSettingsObject","provide","generateMockAppService","settingsOverrides","notifyInfo","notifyWarn","notifySuccess","notifyError","navigate","navigateBack","Composer","Hotkeys","Users","Locations","Base","Menu","Spaces","Bookings","Reports","CateringItems","CateringCategories","Settings","generateMockUser","booking_list","fill","generateMockBooking","mockReturnValue","save","addFrom","removeFrom","clearList","removeFromList","accept","decline","checkin","is_logged_in","queryRoomsForQR","queryObsr","checkinIndividualVisitor","updateObsr","mockImplementation","SPACE_COUNT","generateMinimalRoomDetails","generateMockSpace","space_id","recurring_search","lastName","room_booking_screen","vc","linked","commerce","productName","searchable","controlable","hourly_rate","sort_priority","business","USER_DOMAIN","BOOKING_COUNT","BOOKING_DATE","setMockBookingStartDatetime","visitor","generateMockCateringOrder","menu","date_start","users","lorem","paragraph","BLD_COUNT","LVL_COUNT","generateMockLevel","levelGenerator","firstName","test","nested","level2","org","USER_COUNT","USER_EMAILS","companyName","delegates","delegate_count","first_name","last_name","phone","phoneNumber","department","staff_code","avatar","pickMenuItem","menu_map","category","generateMockLocation","fixed_locations","maps","ORG_COUNT","generateMockOrganisation","generateMockBuildingSetByCity","generateMockModalData","pendingDate","pendingDuration","mockDateToBuildingTz","windows_id","mobile","business_unit","organisation_id","organisation_name","officeLocation","desk","generateUserForm","pattern","maxLength","UsersService","uhttp","expiry","reload","client_id","Md5","hashStr","go","append","authorise","logout","tries","locate","loadDelegates","promises","del","all","HAS_ERROR","buildValidateDate","validateDate","is_from","buildValidateStartTime","validateStartTime","date_obj","buildValidateDuration","validateDuration","buildValidateAttendees","validateAttendees","invalid","dateControlTz","noWhitespaceValidator","isWhitespace","trim","whitespace","date_org","local_tz","zoneName","compare_to","unit","ans_unit","newDate","startOf","monday","sunday","later","endOf","isLastDayOfMonth","minus","hasSame","dateYear","dateMonth","dateDay","trunc","toSeconds","toUTC","toJSDate","getDay","convertLocalTimestampToTimezonedDateTz","buildingTimezone","convertTimezonedTimestampToLocalDateTz","localOffset","getTimezoneOffset","desiredOffset","eleA","localTimezone","offset_minutes","toMiddayUTC","timezoneOffset","EnvironmentModule","providers","ENVIRONMENT_TOKEN","EnvironmentService","environment","production","BookingConfirmComponent","_booking_state_service","_router","_dialog","_dialog_ref","closeDialogService","EventEmitter","lastMomentConflict","old_booking","is_request","approved","bookingDetails","bookedBy","disableClose","checkSpaceAvailability","newEmail","replaceObjects","constructor","replacement","nk","has_note_buffer","updated","master_booking","pollOnce","closeDialog","MeetingDetails","emit","erroMessage","queryParams","ref","ConflictsModalComponent","maxWidth","width","conflicts","copy_conflicts","componentInstance","clipboard","writeText","conflictsText","afterClosed","duration_value","recurrenceDates","a_space","dateTZ","MAT_DIALOG_DATA","Component","templateUrl","styleUrls","Output","BookingFormComponent","cdRef","user_list","fromDateTz","untilDateTz","localStart","localEnd","chipOptions","updateCoachmarkTimes","skip","distinctUntilChanged","recurrenceStarts","clearValidators","arrayValidators","disableInputs","has_id","is_edit","patchValue","SpaceSelectModalComponent","multiple","needsCatering","NewUserModalComponent","detectChanges","localTzOffset","buildingTzOffset","changeDetection","ChangeDetectionStrategy","OnPush","BookingCateringConfirmModalComponent","CateringDetailsModalComponent","_cateringNotesService","head_counts","needs_charge_code","active_space","note_list","notes_field","generateFormFields","markAllAsTouched","is_valid","new_notes","setNotes","_scrollToBottom","_content_el","scrollTo","top","scrollHeight","left","behavior","active_form","errors","minlength","submit","ViewChild","CONFIRM_METADATA","maxHeight","ConfirmModalComponent","DECLARATIONS","NoCateringModalComponent","RequirementDetailsModalComponent","UserFormComponent","LegacyOverlaysModule","LegacyUiModule","FormsModule","ReactiveFormsModule","UiModule","EditorModule","new_user","confirm","cancel","codes_field","head_counts_field","head_count","roomBasedEqCode","officeBasedEqCode","change$","selected_spaces","request_map","formGroup","triggerSearch","savedSelection","request_id","search_results$","active_building","resp","active_type","_space","setDefaultBuilding","grouped_by_city","city_buildings","noCateringDialogRef","autoFocus","backdropClass","defaultBld","opt","space_a","space_b","withLatestFrom","formData","ActionIconComponent","hasSelectionRequirements","getActiveList","CateringMenuItemComponent","initial_state","an_cat","setAmount","cat","an_item","updatePackageSelection","setPrice","selectPackageOptions","confirmed_item","cart_item","active_items","updatedList","PackageOptionsModalComponent","done","a_list","animations","checkItemRequirements","getActiveItems","a_package","needed","ActionFieldComponent","show_tooltip","performAction","CounterComponent","useInput","previous_value","handleTimeout","ctrl_key","shift_key","new_value","changeInput","Number","isNaN","_onChange","_onTouch","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","DateFieldComponent","_from","position","onChange","old_date","new_d","new_date","_trigger","closeMenu","openMenu","_to","years","menuOpen","MatMenuTrigger","openDatePicker","$event","closeDatePicker","DurationFieldComponent","specialPreprops","duration_options","generateDurationOptions","blocks","TimeFieldComponent","no_past_times","show_select","_time_options","generateAvailableTimes","select_field","focus","openedChange","datestamp","show_past","showSelect","UserListFieldComponent","search$","search_str","match_name","match_email","inputAutoComplete","openPanel","closePanel","active_list","a_user","file","files","reader","FileReader","readAsText","evt","processCsvData","srcElement","endsWith","addUser","template","MatAutocompleteTrigger","addUsersFromFile","downloadCSVTemplate","read","UserSearchFieldComponent","resetSearchString","FeedbackComponent","updateRoute","NavigationEnd","current_page","IconComponent","PopoutMenuComponent","SearchbarComponent","UserAvatarComponent","MATERIAL_MODULES","MatButtonModule","MatSnackBarModule","MatDialogModule","MatFormFieldModule","MatInputModule","MatProgressSpinnerModule","MatProgressBarModule","MatAutocompleteModule","MatSelectModule","MatChipsModule","MatRippleModule","MatMenuModule","MatCheckboxModule","MatTooltipModule","MatRadioModule","MatTabsModule","MatSlideToggleModule","ACA_PIPES_MODULE","valueChange","autofocus","focusField","input_field","actionPrefix","stateKey","buildAction","postfix","clear","wrapLoading","selectData","warn","selSuccess","selectSuccess","selOptionalSuccess","selectOptionalSuccess","selError","selectOptionalError","selLoading","selectIsLoading","actionObject","caller","flatMap","isLoading","hasError","hasSuccess","_success","isEmpty","isSuccess","isError","hasLoaded","shouldLoad","selectIsSuccess","selectIsError","selectHasLoaded","selectIsEmpty","generateMockActions","dispatcher","Actions","verifyActionSuccess","effect","expect","toBeDefined","toStrictEqual","verifyActionError","organisationStateSelector","OrganisationEffects","organisationService","OrganisationModule","organisationReducer","initialState","rooms","loadRoomsWithQuery","selectRoomResultsSuccess","RoomsEffects","spaceService","afterRequestResultsLoadOthersEffect","laterThatDayFromDateTz","nextBusinessDay","diff_capacity","loadRoomsForResultsEffect","roomQueryOptionsToSpaceAvailabilityOptions","loadRoomsForResultsMapEffect","loadLaterThatDayResultsEffect","loadNextDayResultsEffect","loadDiffSizeResultsEffect","loadRoomByIdResultsEffect","roomByIdQueryOptionsToSpaceAvailabilityOptions","RoomsModule","roomsReducer","initialRoomsState","byid","todayFromDate","retDate","mapRoomToSelectOption","resultCountObservable","loadingObservable","resultsObservable","viewModelLength","deepDistinctUntilChanged","deepEqual","filterUndefined","RxUtilsModule","AcaDatePickerComponent","klass","show_last_selection","min_offset","max_offset","date_list","month_name","days_of_week","day_format","month_format","generateMonth","generateDaysOfTheWeek","updateOptions","counters","difference","today","end_","non_month","_change_timer","new_offset","updateDate","changeMonth","AlertMode","AlertBannerDisplay","AlertBannerComponent","mode","Warning","showClose","V1","iconPath","materialColor","closeIcon","_onModeChange","Coachmark","BlueCoachmark","AutoCompleteChipSelectItemComponent","optionSelected","feedbackOutput","chipsCleared","onClickConfirm","selectOnlyOneGroup","localFilter","selectOnlyOneGroupChange","separatorKeysCodes","ENTER","COMMA","filterFormControl","focused","mobileFullScreen","autocompleteOptions","filteredAutocompleteOptions","enableCTAs","hasChips","scrollEvent","panelOpen","classList","contains","onFocus","blur","valueAccessor","color","enabled","selectedGroupHeader","getFilteredAutocompleteOptions","groupHeaders","g","searchString","exactMatches","moreOptions","joinedOptions","groupIds","parents","jo","matInput","feedbackInput","useCTAs","focusIn","fromPanel","componentInput","loseFocus","isDisabled","spl","removeEventListener","dirty","touched","keyedInput","onPanelFocusChange","selectOption","encapsulation","ViewEncapsulation","Self","Optional","GroupHeaderPipe","hasHeader","displayAsHeader","AutoCompleteSelectOptionComponent","filteredOptionsChange","inputTextChange","emptyBoxEvent","_options","updateFilteredOptions","selectedValue","resetInput","filteredOptions","startWith","_filter","filterValue","filterValues","matchesAll","onChangeInput","BaseTemplateComponent","vcRef","isRendered","attemptViewEmbed","createEmbeddedView","TemplateRef","CngSelectOptionsComponent","CngSelectComponent","isClosed","defaultSelected","onChangeCallback","DropdownTriggerForDirective","overlay","elementRef","viewContainerRef","renderer","isDropdownOpen","dropdownClosingActionsSub","EMPTY","isPanelOpened","destroyDropdown","openDropdown","ddWidth","dropdownPanel","offsetWidth","overlayRef","create","hasBackdrop","scrollStrategy","scrollStrategies","positionStrategy","flexibleConnectedTo","withPositions","originX","originY","overlayX","overlayY","offsetY","templatePortal","TemplatePortal","templateRef","attach","dropdownClosingActions","backdropClick$","backdropClick","detachment$","detachments","dropdownClosed","merge","detach","dispose","CollapseHeaderComponent","isExpanded","ConflictAlertModalComponent","dialogData","callback","dateIsToday","copy","DateTzCalendarWidgetComponent","className","selectedDateTz","_today","registerOnChange","registerOnTouched","startOfMonthDateTz","DateTzDatePickerComponent","icon_only","onSelect","can_pick_today","selectedDateTzValue","resetToLastSelection","_acaDatePicker","initialDateSelectionTz","writeValue","newValueTz","newDateTz","onDatePickerClose","DateTzDurationFieldComponent","defaultDurationGroups","DEFAULT_DURATION","currentStartDateTz","nearestStep","placeHolderOption","selectedOption","generateDurationOptionsFromGroups","extended","dopt","DateTzTimeFieldComponent","noPastTimes","show_current","startFromDateTz","selectedTimeString","generateAvailableTimesTz","generateOptionForDateTz","os","timeOptions","displayString","newTimeTz","setSelectedValues","ErrorMessageComponent","CalendarIconComponent","ChevronIconComponent","CloseIconComponent","InformationalImageComponent","LabelComponent","LegendDropdownComponent","isOpen","placeholderOpen","placeholder","MckDatePickerComponent","dateValue","initialDateSelection","goToToday","secondarySubmit","primarySubmit","ModalButtonRowComponent","primaryDisabled","disableFixed","secondaryDisabled","smallButtons","ModalComponent","shouldClose","OverrideChangesModalComponent","FilterPipe","searchText","objectKey","splitKeys","it","included","SecurityContext","SanitizePipe","sanitizer","sanitize","RESOURCE_URL","URL","SCRIPT","STYLE","HTML","RadioSelectComponent","RecurringBookingForm","recurrence_types","PATTERN","DATE","recurrencePeriod","current_type","pattern_form","recurrencePatternFormControl","RecurrencePatternForm","onChangeType","RecurrenceDateForm","selected_dates","setPickerToGivenDate","tempForSort","start_date","formDateTz","is_selected","setDateTzForm","dateTsValue","addDate","fromStartTz","untilTz","repeat_period_options","validateRecurrenceInterval","repeat_every_options","recurrenceIntervalFormControl","fromEndTz","setEndDateFromStartDate","recurrenceDateStartTzFormControl","recurrencePeriodFormControl","generateMaxIntervals","recurrenceDaysFormControl","current_days","generateOcurrenceList","recurrenceEndFormControl","end_date","updateActiveWeekday","updateValidators","date_diff","periodToDurationType","first_date","recurr_days","daysInMonth","_week_days","new_day","current_index","setRepeatEvery","setRepeatPeriod","SelectOptionComponent","ignoreDisabled","noEntriesFoundLabel","SelectComponent","searchEnabled","splitDisplay","showDivider","SelectedChipCountComponent","SpacerMode","SpacerComponent","Horizontal","SwitchGroupComponent","optionChecked","closestTimeSlot","buildingDate","newTime","ToggleComponent","selectedChange","TooltipComponent","isVisible","TooltipPosition","DEFAULT","theme","TooltipTheme","tooltip","visible","TooltipDirective","appRef","componentFactoryResolver","injector","showDelay","hideDelay","componentRef","initializeTooltip","setHideTooltipTimeout","touchTimeout","bind","componentFactory","resolveComponentFactory","attachView","hostView","rootNodes","tooltipDOMElement","setTooltipComponentProperties","showTimeout","showTooltip","instance","getBoundingClientRect","right","bottom","BELOW","ABOVE","RIGHT","LEFT","hideTimeout","detachView","MatIconModule","MatExpansionModule","OverlayModule","NgxMatSelectSearchModule","NgxSkeletonLoaderModule","ALL_DAY_BOOKING_VALUE","showPast","inputDate","allDayOption","oneWeekOption","loadUser","selectUserState","selectHasUserData","UserEffects","userService","UserModule","userReducer","initialUserState","webpackEmptyAsyncContext","req","module","routes","component","ShellWrapperComponent","children","loadChildren","BookingModule","redirectTo","AppRoutingModule","RouterModule","forRoot","useHash","AppComponent","_app","_route","val","navigationTrigger","cleanHash","isLoadBookingUrl","isLoadCateringUrl","localStorageSyncReducer","reducer","localStorageSync","rehydrate","metaReducers","AppModule","MAT_LABEL_GLOBAL_OPTIONS","DEFAULT_SETTINGS","BrowserModule","BrowserAnimationsModule","HttpClientModule","ComposerModule","SharedContentModule","StoreDevtoolsModule","instrument","maxAge","logOnly","MapModule","bootstrap","CalendarDateWidgetComponent","show_add_item","show_events","retainSelectedDate","dateChangeTz","timezone_value","event_map","dateInputTz","changeDate","noOfCount","applyDatePickerValue","BookingCalendarWrapperComponent","BookingCalendarRoutingModule","forChild","settingService","TopBarHeaderMode","backRoute","orgBuildings","onBackCallback","bookingModuleDeclarations","StaffCalendarComponent","DayViewTimelineComponent","DayViewSpaceComponent","DayViewSpaceEventComponent","CngMenuItemComponent","bookingModuleImports","BookingCalendarModule","router","onChildSelect","node","overlap","calculatePosition","storeOrder","view","shown_date","from_previous_day","toFixed","overflow_top","overflow_bottom","timeBasedStatusLabel","userEmail","time_period","userName","cdr","legend","eventMovingLoader","inView","dragging","moving","event_list","overlap_details","position_list","time_blocks","generateTimeBlocks","filterEvents","checkInView","last_update","calculateOverlaps","override_state","overflow_only","collisions","cmp","cmp_start","cmp_end","in_view","offsetLeft","box","delta","pointerPosition","scroll_top","top_minutes","selectedBlockStart","selectedBlockEnd","hasValidBreakdown","active_level","foundSearchLength","searchedCounter","totalFoundItem","levelsDD","isIncludes","searchVaue","paramMap","has","updateLevel","initSpace","numeric","ignorePunctuation","roomLevelDD","ddBoxClass","onChangeActiveLevel","generateBuildingMenu","filterd_booking","showSrchWarning","searchValue","allItems","filteredItems","searchStr","menuItem","displayName","iconName","buildingLevels","buildingMenuItems","activeBuildingName","searchBooking","updateDateTz","UPDATE_INTERVAL","scroll_left","scroll_offset","filtered_spaces","loading_space","space_zones","is_today","modalInitialized","isEventMoving","scroll_area","initSpaces","updateTime","addClass","virtualScroll","space_type","stopPolling","scrollIntoView","queryParamMap","view_id","spaceJson","active_hour","searchData","column","removeClass","spaceId","bookingEl","timeoutID","scroll_box","date_percent","scrollWidth","CdkVirtualScrollViewport","clearSelected","updateScroll","BookingConfirmationComponent","Light","statusText","confirmed","isUnavailable","Urls","Help","modal","dispatch","u","generateFeedbackUrl","currentPage","BookingCreateComponent","bookingFormToBooking","updateConfimatinModal","unavailable","_bookings_service","handleBookingSuccessResponse","handleBookingErrorMessage","displayWarningBanner","BookingFormBaseComponent","submitForm","validateForm","BookingEditWrapperComponent","BookingEditComponent","updateCallback","isEditSeries","roomEmail","bk","selectedRoom","getNotes","isEquipmentNote","isCateringNote","booking_form_data","cloneDeep","formToAttendees","formToCompany","updateNotes","closeCallback","dialog","invalidForm","showWarningBanner","submitTimestamp","has_delegate","saveChanges","raw_user","nameParts","companies","custom","warningMessage","bookingData","setupOrganiser","setupNotes","track","headcount","dataForConfirmation","dateString","endDateString","timeString","durationString","isConflictWithOccurences","openRecurrenceConflictsModal","totalOccurrences","availableOccurrences","is_conflict","total_Conflicts","recurr_ref","bookingTypeLabel","recurrenceStart","BookingDetailsModalComponent","expandedLocation","isRecurrentBooking","byIdResults","expandedAvailability","showInfoBanner","showCatering","disableSeriesEditButton","disableCancelButton","disableEditTimeButton","disableUpdateDetailsButton","_specific_dates","roomLocation","street_and_city","initDisplayValues","displayCancelModal","cancelBooking","addCatering","roomHasCatering","hasLoaderUrl","ocurrence","available_fields","fromEvent","throttleTime","tap","showDetails","dispatchToGetFloorCurrentStatus","hostEmail","roomName","attendeesString","chargeCode","mapUrl","extendableMaximum","focusedRoom","checkingExtendable","receiptionEmail","reception_email","companyString","setAlternativeWeekStartDate","requirements","orgStatus","recentlyExpired","statusImage","findMaxExtension","fetchRooms","invalidDueToOfficeRule","alertIfItHasConflict","flag","setupInSeconds","breakdownInMinutes","gapInMinutes","editingSeries","roomOption","recurringBookingData","rec_endTz","getLocation","clearFormAndResultData","dialog_ref","RoomBookingModalComponent","navigateTo","navigateT0Search","relativeTo","refresh","CancelBookingModalComponent","legth","dialogRefX","BookingDurationModalComponent","maximum","updateBookingState","alternativeWeekStartDateTz","pendingChanges","roomRules","displayInfoBanner","global_name","isBookable","isAvailable","headerText","buttonLabel","bookingDate","allWeek","startOfWeek","specific_dates","show_fields","getRawValue","closeModal","steps","updateBookingDuration","bookingSelect","BookingResultItemComponent","small","timeStringParts","localTimeStringParts","isAnotherTimezone","setupDisplayFields","viewModel","timeRangeString","bkn1","bkn2","RoomResultsComponent","RoomFiltersModalComponent","RoomDetailsComponent","ManageBookingsComponent","OfficeFloorComponent","RoomBookingComponent","BookingRoutingModule","BookingsListingComponent","BookingCateringComponent","BookingCateringOrderDetailsComponent","BookingCateringOrderListComponent","CateringMenuCategoryComponent","CateringOrderListItemComponent","SearchedLocationComponent","ResultsHeaderComponent","RoomAvailabilityPreviewComponent","RoomLocationPreviewComponent","RoomResultItemComponent","RoomBookingFormComponent","RoomBookingDetailsFormComponent","RoomResultsPaginatedComponent","RoomFiltersFormComponent","RoomResultsSectionComponent","RoomAvailabilityPreviewModalComponent","OrderTableComponent","SurveyModalComponent","CalendarModule","DateAdapter","useFactory","adapterFactory","OfficeFloorMapModule","bookingResults","showBookings","reloading","totalRecords","pageLimit","prevPage","setPage","nextPage","prevGroup","nextGroup","gotoPage","page","sort_asc","sort_desc","reverse_sort","allBookings","$change","getBuilding","page_idx","pages","p","startPosition","maxed","mined","canceled","buildingAddress","next_disabled","combineItems","newItems","oldItems","itemsObj","active_order","an_order","reduceItems","reduceOrders","consolidatedOrders","deliveryTime","saveBooking","openCateringDetailsModal","_menu","category_list","available_times","matched_items","initForm","_input_el","show_search","loadMenu","generateStartAndEndTimes","space_email","building_time","cat_start_time","cat_end_time","within_restricted_time","has_available_items","out_of_hours","form_controls","expired","confirmOrder","edit","newOrder","previous","bookingTypes","bookingId","snapshot","verb","initData","closeAll","viewBookingFromEmailLink","replaceUrl","clearPage","BookingResultsViewModel","WAITING_TIME","FloorMapOverlayComponent","selectedRoomId","zoom","MIN_ZOOM_LEVEL","center","CENTER_POINT","availableUntil","untilNextBookingFlag","isTimerActive","timerIndex","fetchRoomWithBookings","userSelectedRoom","calculateRoomBookingTimeInfo","currentStatus","activeBookings","timeRemainingInActiveBooking","timeUntilNextBooking","setupTimer","updateSchedulingEpochs","intervalCall_1","intervalCall_15","determineNextBookingStartTime","parentComponent","roomStatus","nowTime","ts","addMin","nextBookingStartTime","futureBookingsForTheDay","nextBookingStartTimeMs","setUpTime","addSeconds","TIME_SIMPLE","startTimer","childCallback","updateRoomData","isOverlayOpened","adjustedTime","timeSlot","end_epoch_15","end_epoch_30","timer","currentTime","endTime","availableTimeToBook","minutesRemaining","secondsRemaining","setup15MinTimer","addjustedTime","futureBookings","endEpoch30","latestBookingStartTime","timeDiffMs","diffInMs","diffInHours","diffInMinutes","roomSelected","roomDataCallback","confirmBooking","MAP_OVERLAY_DATA","Emulated","MAX_ZOOM_LEVEL","mapSpaceStatusToDisplay","mapSpaceStatusToOption","legendOptions","defaultMapBookingRules","defaultMapBookingSubtitle","generateMapStyleForSpace","colorStatusMap","styles","generateMapListenersForSpace","hoverSpace","leaveSpace","clickSpace","listeners","spaceToMapFeature","coordinates","roomToMapFeature","SERVICE_ACCOUNT","mapModuleImports","LibraryModule","mapModuleDeclarations","openHeader","focusedMapSpace","resultBuildings","resultSpaces","activeBuilding","activeLevel","activeSpace","style_map","bookingLocations","buildingLevelOptions","spaceListOptions","activeBuildingOption","activeLevelOption","activeSpaceOption","bookingFormData","bookingConfirmed","getState","floorMap","selection","serviceAccount","self","selectActiveBuilding","spacesFromSelection","colour_map","mapStyle","focusOnRoom","firstBuilding","selectBuildingLevel","OfficeInformationModalComponent","navigationExtras","kioskFormFilter","dayOfWeek","toggleOptions","selectedToggle","selectedToggleChange","retrievedOption","onSelectedChange","queryParamsHandling","pendingDateTz","updateDisplay","pendingDateString","pendingTimeString","pendingDurationString","currentBooking","mockBooking","pending_date","$value","formControl","localizedStartDate","localizedEndDate","updateDatePickerValue","WEEKEND_DAYS","grey","secondary","primary","blue","red","confirmChanges","handleExpand","updateCalendarWeekView","warnIfItHasConflict","showDatePicker","showWeekend","calendarPopupValue","pendingChange","eventSnapSize","dayRefresh","weekRefresh","addMarginOnConflict","cssClass","resizable","beforeStart","afterEnd","draggable","modal_data","scrollFired","date_span","dateControl","currentBookingStartDate","weekViewDateTz","calendarCenter","viewDateTz","fromISO","setCalendarValue","setupEventName","transformBookings","expanded","setDislayValues","dayStartHour","tz_offset","week_start_date","week_view_date","weekViewRangeText","backgroundColor","startHour","dayEndHour","bumper","getBumpers","calendarSpan","raw_booking","displayClass","utcStart","utcEnd","adjustedStartDate","utcToZonedTime","adjustedEndDate","assign","milliseconds","updateTileColor","booked","conflict","hasConflict","isEvents","thirty_minutes_in_millis","toDate","buildingTz","localizedStartTime","localizedEndTime","bookingStartTime","bookingEndTime","bstart","bend","newStart","newEnd","iEvent","buildingStartDateTz","buildingEndDateTz","new_start","md","dnd_duration","one_day_in_millis","conflictCheckStartTime","conflictCheckEndTime","buildingStartDate","applyChanges","ele","getElementById","_snackBar","triggerSubmit","showHint","searchSubject","hostOptions","selectedUsers","notesHandle","noteValidationClass","selectedCompanies","companyOptions","bookingFormGroup","host_list","ifUser","searchResults","unshift","formRef","onSubmit","inputValue","headCountControl","showCancel","cancelSubmit","fromDate","emitEvent","formGroupData","is_past","_checkDateInPast","openSnackBar","formGroupDate","closestTz","prevClosestTz","prevDateTz","showManageButtonA","showManageButtonB","showManageButtonC","homepageBookingResults","pastBookingResults","onbeforeunload","upcomingBookings","LearnMore","routeToResults","routeToManageBookings","isAlertDisplayed","roomSubtype","occurenceAvailability","getCurrentNavigation","availabilityStatus","checkAvailabiltyAsPerRule","setRoomSubType","requestedDateTz","endDate","requestedEndDateTz","temp","isSpaceValidAsPerRule","goToBackRoute","expandAvailability","updateAvailabilityStatus","primaryCheck","secondaryCheck","removeDateOffset","bookingRoute","isRequest","combinedFeatures","handleClose","expandMap","bookRoom","isInternal","filtersSubmit","getFilters","toggleOptionChecked","submitFilters","Dark","viewMode","featuresRoom","minZoom","setIntervalHandle","initMapZoom","zoomToRoom","roomSelect","availability","firstChange","coachMarkAction","ROOM_DISPLAY_STEP","ROOM_DISPLAY_START","displayCount","displayViewModels","viewModels","vm","markForCheck","showLoadMore","remainingResults","spaceConflicts","overrideChanges","goToRoomDetail","mainResultViewModels","editing_form","AlternateBuildings","subscribeResultsToViewModels","subName","flattenLevelBuildings","viewModelSubject","resultsLoading","updateCoachMark","coachMarkDisplay","RoomResultsCoachmarkViewmodel","rules_link","levelBuildings","cityFromLocation","actionButtonText","day_offset","mainResults","mainResultsFiltered","laterThatDayResults","nextBusinessDayResults","diffSizeResults","laterThatDayDisplay","mainCoachMarkDisplay","mainResultsCount","laterThatDayCount","nextBusinessDayCount","diffSizeCount","spaceControl","searchStringPresent","nday","mainResultsSpaces","filteredRooms","selectedSpace","clearRoomSearch","roomIds","changeSearchResults","overflow","changeClick","filterClick","canFilter","timing","filterDisplay","filterCount","computeDisplay","occEndDate","endRecDate","startDisplay","endDisplay","durationDisplay","FooterMenuComponent","tiles","MapControlsComponent","levelChange","building_details","building_list","level_list","setBuilding","lvl_id","OverlayMenuComponent","showChange","copyright","delayedClose","cancelClose","ResponsiveInlineImagesComponent","imgArr","phase","baseUrl","questions","created_at","updated_at","header_question","header_subtext","answers","questions_id","positive","option_responses","comments","getFeedbackQuestionsFromApi","questionID","checked","$evemt","delayed","TopbarHeaderComponent","backModal","noSurvey","menuChange","onBack","modalOpen","surveyDialogRef","feedbackId","logo","feedback_id","openFeedbackModal","homeOverride","back","goToFeedback","goToHelp","LoginComponent","username","password","login","setErrors","zoomOutClick","zoomInClick","refreshClick","infoClick","toggleEvent","toggle","MapFiltersComponent","selectedBuildingChange","selectedLevelChange","selectedSpaceChange","searchClick","buildingControl","levelControl","MapOverlayComponent","MapSearchComponent","floorData","floorDataParam","refreshFloorNumber","selectActiveSpace","displayOfficeInformation","propagateToggle","zoomIn","zoomOut","resetZoomLevels","info","custom_html","map_rules","other_rules","contact","link","COMPONENTS","CDK_MODULES","ScrollingModule","DragDropModule","CdkTableModule","APipesModule","AInteractiveMapModule","ACustomEventsModule","IvyCarouselModule","placeOs","activatedRoute","userLoading","isQRCode","buildingOptions","roomId","oauth_redirect","availibityParams","setSpaceList","bookingRoom","seledtedZone","NavigationStart","checkRoomId","query2","loading_state","initialized","isQRCodeScanedAndReady","mod","Feedback","hmr","general","home","help","columns","booking_types","html_body","multiple_spaces","desk_start","space_display","show_images","directory","show_avatars","min_search_length","explore","can_select_building","show_legend_group_names","show_timeline","General","day_view","dragdrop","hmrBootstrap","ngModule","hot","ApplicationRef","elements","components","makeVisible","createNewHosts","enableProdMode","platformBrowser","bootstrapModule"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACDA;AAAA;AAAA;;AAEa,YAAAA,0BAAA,GAA6B,aAAAC,OAAA,CAAQ,MAAR,EAAgB,CACtD,aAAAC,UAAA,CAAW,QAAX,EAAqB,CACjB,aAAAC,KAAA,CAAM;AAAEC,aAAO,EAAE,CAAX;AAAcC,YAAM,EAAE;AAAtB,KAAN,CADiB,EAEjB,aAAAC,OAAA,CAAQ,GAAR,EAAa,aAAAH,KAAA,CAAM;AAAEC,aAAO,EAAE,CAAX;AAAcC,YAAM,EAAE;AAAtB,KAAN,CAAb,CAFiB,CAArB,CADsD,EAKtD,aAAAH,UAAA,CAAW,QAAX,EAAqB,CACjB,aAAAC,KAAA,CAAM;AAAEC,aAAO,EAAE,CAAX;AAAcC,YAAM,EAAE;AAAtB,KAAN,CADiB,EAEjB,aAAAC,OAAA,CAAQ,GAAR,EAAa,aAAAH,KAAA,CAAM;AAAEC,aAAO,EAAE,CAAX;AAAcC,YAAM,EAAE;AAAtB,KAAN,CAAb,CAFiB,CAArB,CALsD,CAAhB,CAA7B;AAWA,YAAAE,8BAAA,GAAiC,aAAAN,OAAA,CAAQ,MAAR,EAAgB,CAC1D,aAAAO,KAAA,CAAM,MAAN,EAAc,aAAAL,KAAA,CAAM;AAAEC,aAAO,EAAE,CAAX;AAAcC,YAAM,EAAE;AAAtB,KAAN,CAAd,CAD0D,EAE1D,aAAAG,KAAA,CAAM,MAAN,EAAc,aAAAL,KAAA,CAAM;AAAEC,aAAO,EAAE,CAAX;AAAcC,YAAM,EAAE;AAAtB,KAAN,CAAd,CAF0D,EAG1D,aAAAH,UAAA,CAAW,eAAX,EAA4B,aAAAI,OAAA,CAAQ,eAAR,CAA5B,CAH0D,CAAhB,CAAjC;;;;;;;;;;;;;;;;;;;;ACbb;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;QAKaG,gB;;;;AAHb;;YAGaA;;;;yBAAAA,gB;AAAgB,O;AAAA,gBAFlB,CAAC,SAAAC,YAAD,CAEkB;;;;+EAAhBD,gB,EAAgB;AAAA,kBAFjB,SAAAC,YAEiB;AAAA,O;AAFL,K;;;;;2BAEXD,gB,EAAgB;cAH5B,OAAAE,QAG4B;eAHnB;AACRC,iBAAO,EAAE,CAAC,SAAAF,YAAD;AADD,S;AAGmB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;ACN7B;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACTA;AAAA;AAAA;;QAEaG,S;AAAb;AAAA;;AACI;AACU,aAAAC,OAAA,GAAsC,EAAtC;AACV;;AACU,aAAAC,UAAA,GAAyC,EAAzC;AACV;;AACU,aAAAC,cAAA,GAAoE,EAApE;AACV;;AACmB,aAAAC,YAAA,GAAe,IAAI,OAAAC,eAAJ,CAA6B,KAA7B,CAAf;AA8GtB;AA5GG;;;;;kCASoB;AAChB,eAAK,IAAMC,GAAX,IAAkB,KAAKL,OAAvB,EAAgC;AAC5B,gBAAI,KAAKA,OAAL,CAAaM,cAAb,CAA4BD,GAA5B,CAAJ,EAAsC;AAClC,mBAAKE,YAAL,CAAkBF,GAAlB;AACH;AACJ;;AACD,eAAK,IAAMA,IAAX,IAAkB,KAAKJ,UAAvB,EAAmC;AAC/B,gBAAI,KAAKA,UAAL,CAAgBK,cAAhB,CAA+BD,IAA/B,CAAJ,EAAyC;AACrC,mBAAKG,aAAL,CAAmBH,IAAnB;AACH;AACJ;;AACD,eAAK,IAAMA,KAAX,IAAkB,KAAKH,cAAvB,EAAuC;AACnC,gBAAI,KAAKA,cAAL,CAAoBI,cAApB,CAAmCD,KAAnC,CAAJ,EAA6C;AACzC,mBAAKI,KAAL,CAAWJ,KAAX;AACH;AACJ;AACJ;AAED;;;;;;;;;gCAMkBK,I,EAAcC,E,EAAqC;AAAA;;AAAA,cAArBC,KAAqB,uEAAL,GAAK;;AACjE,cAAIF,IAAI,IAAIC,EAAR,IAAcA,EAAE,YAAYE,QAAhC,EAA0C;AACtC,iBAAKN,YAAL,CAAkBG,IAAlB;AACA,iBAAKV,OAAL,CAAaU,IAAb,IAA0BI,UAAU,CAAC,YAAM;AACvCH,gBAAE;AACF,mBAAI,CAACX,OAAL,CAAaU,IAAb,IAAqB,IAArB;AACH,aAHmC,EAGjCE,KAHiC,CAApC;AAIH,WAND,MAMO;AACH,kBAAM,IAAIG,KAAJ,CACFL,IAAI,GAAG,4CAAH,GAAkD,4CADpD,CAAN;AAGH;AACJ;AAED;;;;;;;;;;;;;;;;;oBAIuBA,I,EAAc;AACjC,cAAI,KAAKV,OAAL,CAAaU,IAAb,CAAJ,EAAwB;AACpBH,wBAAY,CAAC,KAAKP,OAAL,CAAaU,IAAb,CAAD,CAAZ;AACA,iBAAKV,OAAL,CAAaU,IAAb,IAAqB,IAArB;AACH;AACJ,S;AAED;;;;;;;;;iCAMmBA,I,EAAcC,E,EAAqC;AAAA,cAArBC,KAAqB,uEAAL,GAAK;;AAClE,cAAIF,IAAI,IAAIC,EAAR,IAAcA,EAAE,YAAYE,QAAhC,EAA0C;AACtC,iBAAKL,aAAL,CAAmBE,IAAnB;AACA,iBAAKT,UAAL,CAAgBS,IAAhB,IAA6BM,WAAW,CAAC;AAAA,qBAAML,EAAE,EAAR;AAAA,aAAD,EAAaC,KAAb,CAAxC;AACH,WAHD,MAGO;AACH,kBAAM,IAAIG,KAAJ,CACFL,IAAI,GAAG,6CAAH,GAAmD,6CADrD,CAAN;AAGH;AACJ;AAED;;;;;;;;;;;;;;;;;oBAIwBA,I,EAAc;AAClC,cAAI,KAAKT,UAAL,CAAgBS,IAAhB,CAAJ,EAA2B;AACvBF,yBAAa,CAAC,KAAKP,UAAL,CAAgBS,IAAhB,CAAD,CAAb;AACA,iBAAKT,UAAL,CAAgBS,IAAhB,IAAwB,IAAxB;AACH;AACJ,S;AAED;;;;;;;;qCAKuBA,I,EAAcD,K,EAAoC;AACrE,eAAKA,KAAL,CAAWC,IAAX;AACA,eAAKR,cAAL,CAAoBQ,IAApB,IAA4BD,KAA5B;AACH;AAED;;;;;;;8BAIgBC,I,EAAc;AAC1B,cAAI,KAAKR,cAAL,IAAuB,KAAKA,cAAL,CAAoBQ,IAApB,CAA3B,EAAsD;AAClD,iBAAKR,cAAL,CAAoBQ,IAApB,aAAqC,OAAAO,YAArC,GACO,KAAKf,cAAL,CAAoBQ,IAApB,EAA2CQ,WAA3C,EADP,GAEO,KAAKhB,cAAL,CAAoBQ,IAApB,GAFP;AAGA,iBAAKR,cAAL,CAAoBQ,IAApB,IAA4B,IAA5B;AACH;AACJ;;;4BA1GqB;AAClB,iBAAO,KAAKP,YAAZ;AACH;AACD;;;;4BACyB;AACrB,iBAAO,KAAKA,YAAL,CAAkBgB,QAAlB,EAAP;AACH;;;;;;AAjBL;;;;;;;;;;;;;;;;;;;;ACDA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;QAKaC,a;;;;;;;;;;;;;sCACS;AACd,eAAKC,OAAL;AACH;;;;MAH8B,aAAAtB,S;;AAHnC;;;6CAGaqB,a;AAAa,K;;;YAAbA,a;AAAa,0E;AAAA;;8DAAbA,a;;;;2BAAAA,a,EAAa;cAHzB,OAAAE,SAGyB;eAHf;AACPC,kBAAQ,EAAE;AADH,S;AAGe,Q;;;;;;;;;;;;;;;;;;;;;;ACP1B;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;QAWaC,U;;;;AATb;;YASaA;;;;yBAAAA,U;AAAU,O;AAAA,gBARV,CAAC,SAAA5B,YAAD,CAQU;;;;+EAAV4B,U,EAAU;AAAA,uBANf,yBAAAC,oBAMe;AANK,kBAFd,SAAA7B,YAEc,CAML;AARG,kBAKlB,yBAAA6B,oBALkB;AAQH,O;AAHK,K;;;;;2BAGfD,U,EAAU;cATtB,OAAA3B,QASsB;eATb;AACNC,iBAAO,EAAE,CAAC,SAAAF,YAAD,CADH;AAEN8B,sBAAY,EAAE,CACV,yBAAAD,oBADU,CAFR;AAKNE,iBAAO,EAAE,CACL,yBAAAF,oBADK;AALH,S;AASa,Q;;;;;;;;;;;;;;;;;;;;;;ACbvB;AAAA;AAAA;;AAUA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;AAEA,QAAYG,eAAZ;;AAAA,eAAYA,eAAZ,EAA2B;AACvB;AACA;AACA;AACA;AACH,KALD,EAAYA,eAAe,GAAf,QAAAA,eAAA,aAAAA,eAAA,GAAe,EAAf,CAAZ;;QAUaC,0B;;;;;AAcT,0CAAoBC,YAApB,EAAuDC,SAAvD,EAA6E;AAAA;;AAAA;;AACzE;AADgB,eAAAD,YAAA,GAAAA,YAAA;AAAmC,eAAAC,SAAA,GAAAA,SAAA;AAZvD;;AACS,eAAAC,SAAA,GAA6BJ,eAAe,CAACK,CAA7C;AAKT;;AACO,eAAAC,WAAA,GAAwC;AAAEC,WAAC,EAAE,CAAL;AAAQC,WAAC,EAAE;AAAX,SAAxC;AAKsE;AAE5E;;;;oCAEkBC,O,EAAsB;AACrC,cAAIA,OAAO,CAACC,eAAR,IAA2B,KAAKA,eAApC,EAAqD;AACjD,iBAAKC,OAAL,GAAe,KAAKT,YAAL,CAAkBS,OAAlB,CAA0BC,aAA1B,CAAwCC,OAAxC,CACX,KAAKH,eADM,CAAf;AAGH;AACJ;;;6CAEwB;AAAA;;AACrB,eAAKI,YAAL,CACI,YADJ,EAEI,KAAKC,KAAL,CAAWN,OAAX,CAAmBO,SAAnB,CAA6B,UAACD,KAAD,EAA+B;AACxD,gBAAME,IAAI,GAAGF,KAAK,CAACG,OAAN,EAAb;AACAD,gBAAI,CAACE,OAAL,CAAa,UAACC,CAAD,EAAIC,KAAJ,EAAc;AACvB,oBAAI,CAACP,YAAL,qBACiBO,KADjB,GAEI,MAAI,CAAClB,SAAL,CAAemB,MAAf,CAAsBF,CAAC,CAACT,OAAF,CAAUC,aAAhC,EAA+C,WAA/C,EAA4D,YAAM;AAC9D,sBAAI,CAACE,YAAL,CACI,cADJ,EAEI,MAAI,CAACX,SAAL,CAAemB,MAAf,CAAsB,QAAtB,EAAgC,SAAhC,EAA2C;AAAA,yBAAM,MAAI,CAACC,MAAL,EAAN;AAAA,iBAA3C,CAFJ;;AAIA,sBAAI,CAACC,MAAL;AACH,eAND,CAFJ;;AAUA,oBAAI,CAACV,YAAL,2BACuBO,KADvB,GAEI,MAAI,CAAClB,SAAL,CAAemB,MAAf,CAAsBF,CAAC,CAACT,OAAF,CAAUC,aAAhC,EAA+C,YAA/C,EAA6D,YAAM;AAC/D,sBAAI,CAACE,YAAL,CACI,cADJ,EAEI,MAAI,CAACX,SAAL,CAAemB,MAAf,CAAsB,QAAtB,EAAgC,UAAhC,EAA4C;AAAA,yBAAM,MAAI,CAACC,MAAL,EAAN;AAAA,iBAA5C,CAFJ;;AAIA,sBAAI,CAACC,MAAL;AACH,eAND,CAFJ;AAUH,aArBD;AAsBH,WAxBD,CAFJ;AA4BH;AAED;;;;iCACgB;AAAA;;AACZ,cAAI,KAAKb,OAAT,EAAkB;AACd,iBAAKG,YAAL,CACI,QADJ,EAEI,KAAKX,SAAL,CAAemB,MAAf,CAAsB,KAAKX,OAA3B,EAAoC,QAApC,EAA8C;AAAA,qBAAM,MAAI,CAACc,kBAAL,EAAN;AAAA,aAA9C,CAFJ;AAIH;AACJ;AAED;;;;iCACgB;AACZ,eAAK5C,KAAL,CAAW,QAAX;AACH;AAED;;;;;;6CAG6B;AAAA;;AACzB,eAAK6C,OAAL,CACI,kBADJ,EAEI,YAAM;AACF,gBAAMC,MAAM,GAAG;AAAEpB,eAAC,EAAE,MAAI,CAACI,OAAL,CAAaiB,UAAlB;AAA8BpB,eAAC,EAAE,MAAI,CAACG,OAAL,CAAakB;AAA9C,aAAf;;AACA,gBACK,CAAC,MAAI,CAACzB,SAAL,KAAmBJ,eAAe,CAAC8B,IAAnC,IACE,MAAI,CAAC1B,SAAL,KAAmBJ,eAAe,CAAC+B,CADtC,KAEGJ,MAAM,CAACnB,CAAP,KAAa,MAAI,CAACF,WAAL,CAAiBE,CAFlC,IAGC,CAAC,MAAI,CAACJ,SAAL,KAAmBJ,eAAe,CAAC8B,IAAnC,IACE,MAAI,CAAC1B,SAAL,KAAmBJ,eAAe,CAACK,CADtC,KAEGsB,MAAM,CAACpB,CAAP,KAAa,MAAI,CAACD,WAAL,CAAiBC,CANtC,EAOE;AACG,oBAAI,CAACL,YAAL,CAAkB8B,YAAlB,CAAuCC,iBAAvC;;AACA,oBAAI,CAAC/B,YAAL,CAAkB8B,YAAlB,CAAuCE,SAAvC,CAAiDf,OAAjD,CAAyD,UAAAC,CAAC;AAAA,uBACvDA,CAAC,CAACe,WAAF,KAAkBf,CAAC,CAACa,iBAAF,EAAlB,GAA0C,IADa;AAAA,eAA1D;AAGJ;;AACD,kBAAI,CAAC3B,WAAL,GAAmBqB,MAAnB;AACH,WAlBL,EAmBI,EAnBJ;AAqBH;;;;MAjG2C,iBAAAnC,a;;AAHhD;;;uBAGaS,0B,EAA0B,oC,EAAA,kC;AAAA,K;;;YAA1BA,0B;AAA0B,iE;AAAA;AAAA;sCAYlB,YAAAmC,O,EAAO,K;;;;;;;;;;;;;;;;;;2BAZfnC,0B,EAA0B;cAHtC,OAAAP,SAGsC;eAH5B;AACPC,kBAAQ,EAAE;AADH,S;AAG4B,Q;;;;;;;;gBAGlC,OAAA0C;;;gBAEA,OAAAA;;;gBAOA,OAAAC,e;iBAAgB,YAAAF,O;;;;;;;;;;;;;;;;;;;;;;;;ACnCrB;AAAA;AAAA;AAEA;;;;;AAGA,QAAMG,WAAW,GAAG,aAAa,IAAjC;;AAEa,YAAAC,QAAA,GAAW;AAAA,UAACC,YAAD,uEAAgBF,WAAhB;AAAA,aAAgC,sBAASG,GAAT,CAAa,IAAIC,IAAJ,CAASF,YAAT,CAAb,CAAhC;AAAA,KAAX;;AAEA,YAAAG,SAAA,GAAY;AAAA,aAAM,sBAASC,KAAT,EAAN;AAAA,KAAZ;;;;;;;;;;;;;;;;;;;;;ACRb;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;AAuBA;;;;;;AAMA;;;AACa,YAAAC,iBAAA,GAAoB,UAACC,IAAD,EAAiBC,UAAjB,EAAsE;AAAA,UAAjCC,KAAiC,uEAAjB,CAAiB;AACnG,aAAOF,IAAI,CAACL,GAAL,CAAS;AAAEQ,mBAAW,EAAE,CAAf;AAAkBC,cAAM,EAAE,CAA1B;AAA6BC,cAAM,EAAEC,IAAI,CAACC,IAAL,CAAUP,IAAI,CAACK,MAAL,GAAcJ,UAAxB,IAAsCA;AAA3E,OAAT,EACFO,IADE,CACG;AAAEC,eAAO,EAAEP,KAAK,GAAG;AAAnB,OADH,CAAP,CADmG,CAEhE;AACtC,KAHY;;AAKA,YAAAQ,mBAAA,GAAsB,UAACC,MAAD,EAAiBV,UAAjB,EAAoE;AAAA,UAA/BC,KAA+B,uEAAf,CAAe;AACnG,aAAOS,MAAM,CAACC,QAAP,CAAgB;AAAET,mBAAW,EAAE,CAAf;AAAkBC,cAAM,EAAE,CAA1B;AAA6BC,cAAM,EAAEC,IAAI,CAACC,IAAL,CAAUI,MAAM,CAACF,OAAP,GAAiBR,UAA3B,IAAyCA;AAA9E,OAAhB,EACFY,QADE,CACO;AAAEJ,eAAO,EAAEP,KAAK,GAAG;AAAnB,OADP,CAAP,CADmG,CAE5D;AAC1C,KAHY;AAKb;;;;;;;AAKA,aAAgBY,iBAAhB,CAAkCC,QAAlC,EAA0E;AAAA,UAAtBC,MAAsB,uEAAL,KAAK;;AACtE,UAAI,CAACD,QAAD,IAAaA,QAAQ,GAAG,CAA5B,EAA+B;AAC3B,eAAO,EAAP;AACH;;AACD,UAAME,CAAC,GAAGX,IAAI,CAACY,KAAL,CAAWH,QAAQ,GAAG,EAAtB,CAAV;AACA,UAAII,CAAC,aAAMF,CAAC,IAAI,CAAL,GAASA,CAAC,IAAID,MAAK,GAAG,KAAH,GAAW,WAAWC,CAAC,KAAK,CAAN,GAAU,EAAV,GAAe,GAA1B,CAApB,CAAV,GAAgE,EAAtE,CAAL;;AACA,UAAIF,QAAQ,GAAG,EAAX,KAAkB,CAAtB,EAAyB;AACrB,YAAII,CAAJ,EAAO;AACHA,WAAC,IAAIH,MAAK,GAAG,GAAH,GAAS,IAAnB;AACH;;AACD,YAAMI,CAAC,GAAGL,QAAQ,GAAG,EAArB;AACAI,SAAC,cAAOC,CAAC,IAAI,CAAL,GAASA,CAAC,IAAIJ,MAAK,GAAG,MAAH,GAAY,aAAaI,CAAC,KAAK,CAAN,GAAU,EAAV,GAAe,GAA5B,CAArB,CAAV,GAAmE,EAA1E,CAAD;AACH;;AACD,aAAOD,CAAP;AACH;;AAdD;;AAgBa,YAAAE,sBAAA,GAAyB,UAACrB,IAAD;AAAA,aAA0BA,IAAI,CAACsB,UAAL,CAAgB,iBAAhB,CAA1B;AAAA,KAAzB;AAEb;;;;;;AAIa,YAAAC,oBAAA,GAAuB,UAACC,KAAD,EAChCC,SADgC,EAEhCC,SAFgC,EAEoB;AACpD;AACA;AACA;AACA,UAAI1B,IAAI,GAAG2B,KAAK,CAACH,KAAD,EAAQ,oBAAAI,qBAAA,EAAR,CAAhB;;AACA,UAAI,CAAC5B,IAAI,CAAC6B,OAAL,EAAL,EAAqB;AACjB;AACA,YAAIC,YAAY,GAAGN,KAAnB;AACA,YAAMO,KAAK,GAAGP,KAAK,CAACQ,KAAN,CAAY,GAAZ,CAAd;;AACA,YAAG,CAACR,KAAJ,EAAU;AACN,iBAAOS,SAAP;AACH;;AACD,YAAIF,KAAK,CAACG,MAAN,KAAiB,CAArB,EAAwB;AACpB,cAAIH,KAAK,CAAC,CAAD,CAAL,CAASG,MAAT,KAAoB,CAAxB,EAA2B;AACvBJ,wBAAY,aAAMC,KAAK,CAAC,CAAD,CAAX,cAAkBA,KAAK,CAAC,CAAD,CAAvB,MAAZ;AACH;AACJ,SAXgB,CAYjB;;;AACA/B,YAAI,GAAG2B,KAAK,CAACG,YAAD,EAAe,oBAAAK,iBAAA,EAAf,CAAZ,CAbiB,CAcjB;;AACA,YAAI,CAACnC,IAAI,CAAC6B,OAAL,EAAD,IAAmBJ,SAAvB,EAAkC;AAC9BzB,cAAI,GAAG2B,KAAK,CAACH,KAAD,EAAQ,GAAR,CAAZ;AACH;AACJ,OAvBmD,CAwBpD;AACA;AACA;AACA;;;AACA,UAAIxB,IAAI,CAAC6B,OAAL,EAAJ,EAAoB;AAChB;AACA7B,YAAI,GAAGA,IAAI,CAACoC,KAAL,CAAWV,SAAS,CAACU,KAAV,EAAX,EAA8BpC,IAA9B,CAAmC0B,SAAS,CAAC1B,IAAV,EAAnC,EAAqDqC,IAArD,CAA0DX,SAAS,CAACW,IAAV,EAA1D,CAAP;;AACA,YAAIX,SAAS,CAACY,IAAV,KAAmBtC,IAAI,CAACsC,IAAL,EAAnB,IAAkCtC,IAAI,CAACA,IAAL,OAAgB0B,SAAS,CAAC1B,IAAV,EAAtD,EAAwE;AACpEA,cAAI,GAAGA,IAAI,CAACL,GAAL,CAAS,MAAT,EAAiBK,IAAI,CAACsC,IAAL,KAAc,EAA/B,CAAP;AACH;AACJ;;AAED,aAAOtC,IAAI,CAAC6B,OAAL,KAAiB7B,IAAjB,GAAwBiC,SAA/B;AACH,KAvCY;AA0Cb;;;;;;;;;;AAQa,YAAAM,kBAAA,GAAqB,UAC9BC,IAD8B,EAE9BhB,KAF8B,EAG9BiB,gBAH8B,EAKrB;AAAA,UADTvC,KACS,uEADO,CACP;AACT,UAAIF,IAAI,GAAG,QAAAuB,oBAAA,CAAqBC,KAArB,EAA4B,KAA5B,EAAmCG,KAAK,CAACc,gBAAD,CAAxC,CAAX;;AACA,UAAIzC,IAAJ,EAAU;AACN,YAAM0C,SAAS,GAAG,QAAAC,QAAA,CAASC,UAAT,CAAoB5C,IAAI,CAAC6C,OAAL,EAApB,CAAlB;AACA,YAAMC,WAAW,GAAG,QAAA/C,iBAAA,CAAkB2C,SAAlB,EAA6BF,IAA7B,EAAmCtC,KAAnC,CAApB;AACA,eAAO4C,WAAW,CAACC,QAAZ,CAAqB,oBAAAZ,iBAAA,EAArB,CAAP;AACH,OAJD,MAIO;AACH,eAAOX,KAAP;AACH;AACJ,KAdY;AAeb;;;;;;;;;;;AASa,YAAAwB,sBAAA,GAAyB,UAACC,cAAD,EAClCR,gBADkC,EAElCS,KAFkC,EAER;AAE1B,UAAIlD,IAAI,GAAG,QAAAuB,oBAAA,CAAqB2B,KAArB,EAA4B,KAA5B,EAAmCvB,KAAK,CAACc,gBAAD,CAAxC,CAAX;;AAEA,UAAI,CAACzC,IAAL,EAAW;AACP;AACA,YAAMe,QAAQ,GAAGoC,QAAQ,CAACD,KAAD,CAAzB;;AACA,YAAI,OAAQnC,QAAR,KAAsB,QAAtB,IAAkCmC,KAAK,CAACE,OAAN,CAAc,GAAd,MAAuB,CAAC,CAA1D,IAA+DrC,QAAQ,GAAG,EAA9E,EAAkF;AAC9Ef,cAAI,GAAG2B,KAAK,CAACc,gBAAD,CAAL,CAAwBY,GAAxB,CAA4BtC,QAA5B,EAAsC,GAAtC,CAAP;AACH;AACJ;;AAED,UAAIf,IAAJ,EAAU;AACN,YAAMS,OAAO,GAAGT,IAAI,CAACsD,IAAL,CAAUb,gBAAV,EAA4B,QAA5B,CAAhB;AACA,YAAMc,oBAAoB,GAAGN,cAAc,CAACO,IAAf,CAAoB,UAAArC,CAAC,EAAI;AAClD,iBAAQV,OAAO,IAAIU,CAAC,CAACsC,GAArB;AACH,SAF4B,CAA7B;;AAGA,YAAIF,oBAAJ,EAA0B;AACtB,cAAMG,MAAM,GAAG,CAACH,oBAAD,EAAuBI,MAAvB,CAA8B,UAACC,aAAD,EAAgBC,YAAhB,EAAiC;AAC1E,mBAAOD,aAAa,GAAGC,YAAY,CAAC3D,KAApC;AACH,WAFc,EAEZ,CAFY,CAAf;AAGA,cAAMwC,SAAS,GAAG,QAAAC,QAAA,CAASC,UAAT,CAAoB5C,IAAI,CAAC6C,OAAL,EAApB,CAAlB;AACA,cAAMC,WAAW,GAAG,QAAA/C,iBAAA,CAAkB2C,SAAlB,EAA6Ba,oBAAoB,CAACf,IAAlD,EAAwD,CAAxD,CAApB;AACA,iBAAOM,WAAW,CAACC,QAAZ,CAAqB,oBAAAZ,iBAAA,EAArB,CAAP;AACH;AACJ;;AAED,aAAOe,KAAP;AACH,KA9BY;;AAgCA,YAAAY,uBAAA,GAA0B,UAACC,SAAD,EAAuB;AAC1D,aAAO,QAAApB,QAAA,CAASC,UAAT,CAAoBmB,SAApB,EAA+BpE,GAA/B,CAAmC;AAAES,cAAM,EAAE,CAAV;AAAaD,mBAAW,EAAE;AAA1B,OAAnC,EAAkE6D,QAAlE,EAAP;AACH,KAFY;;AAIA,YAAAC,oBAAA,GAAuB,UAACjE,IAAD,EAA0B;AAC1D,UAAMkE,OAAO,GAAG,IAAItE,IAAJ,CAASI,IAAT,CAAhB;AACA,UAAMmE,GAAG,GAAGD,OAAO,CAACE,OAAR,EAAZ;AACA,UAAMhC,KAAK,GAAG8B,OAAO,CAACG,cAAR,CAAuB,SAAvB,EAAkC;AAAEjC,aAAK,EAAE;AAAT,OAAlC,CAAd;AACA,UAAMC,IAAI,GAAG6B,OAAO,CAACI,WAAR,EAAb;AACA,uBAAUH,GAAV,SAAgBI,SAAS,CAACJ,GAAD,CAAzB,cAAkC/B,KAAlC,cAA2CC,IAA3C,EAL0D,CAKP;AACtD,KANY;;AAQb,QAAMkC,SAAS,GAAG,SAAZA,SAAY,CAACC,MAAD,EAAY;AAC1B,aAAOA,MAAM,GAAG,CAAT,GACD,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,EAAmB,IAAnB,EACOA,MAAM,GAAG,CAAT,IAAcA,MAAM,GAAG,EAAxB,IAA+BA,MAAM,GAAG,EAAT,GAAc,CAA7C,GAAiD,CAAjD,GAAqDA,MAAM,GAAG,EADpE,CADC,GAID,EAJN;AAKH,KAND;;AAQa,YAAAC,mBAAA,GAAsB,YAAM;AACrC,aAAO,CACH,WADG,EAEH,WAFG,EAGH,SAHG,EAIH,QAJG,EAKH,OALG,EAOH,UAPG,EAQH,YARG,EASH,cATG,EAUH,YAVG,EAYH,SAZG,EAaH,QAbG,EAeH,UAfG,EAiBH,OAjBG,EAkBH,UAlBG,EAmBH,YAnBG,EAqBH,OArBG,EAsBH,UAtBG,EAuBH,YAvBG,EAyBH,SAzBG,EA0BH,SA1BG,EA2BH,QA3BG,EA4BH,QA5BG,EA8BH,SA9BG,EA+BH,YA/BG,EAiCH,UAjCG,EAkCH,WAlCG,EAmCH,WAnCG,EAoCH,YApCG,EAuCH,YAvCG,EAwCH,WAxCG,EAyCH,UAzCG,EA0CH,YA1CG,EA2CH,WA3CG,EA6CH,YA7CG,EA8CH,YA9CG,EA+CH,WA/CG,EAiDH,WAjDG,EAkDH,WAlDG,EAmDH,WAnDG,EAoDH,UApDG,EAsDH,QAtDG,EAuDH,OAvDG,CAuDK;AAvDL,OAAP;AA0DH,KA3DY;;;;;;;;;;;;;;;;;;;;;AClMb;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA,uC,CAEA;;;AACA9C,SAAK,CAAC+C,MAAN,CAAaC,GAAb;AACAhD,SAAK,CAAC+C,MAAN,CAAaE,QAAb;AACAjD,SAAK,CAAC+C,MAAN,CAAaG,OAAb;AACAlD,SAAK,CAAC+C,MAAN,CAAaI,OAAb;AACAnD,SAAK,CAAC+C,MAAN,CAAaK,iBAAb;AAKA;;;;;;;;;AAQA,aAAgBC,GAAhB,CACIC,IADJ,EAEIC,GAFJ,EAGIC,IAHJ,EAM8B;AAAA,UAF1BC,MAE0B,uEAFF,OAEE;AAAA,UAD1BC,KAC0B,uEADT,KACS;AAAA,UAA1BC,QAA0B,uEAAP,OAAO;;AAE1B,UAAKC,MAAc,CAACC,KAAf,IAAwBH,KAA7B,EAAoC;AAChC,YAAMI,MAAM,GAAa,CACrB,gBADqB,EAErB,gBAFqB,EAGrB,gBAHqB,CAAzB;;AAKA,YAAIN,IAAJ,EAAU;AAAA;;AACN,sBAAAO,OAAO,EAACN,MAAD,CAAP,+BACUE,QADV,iBACyBL,IADzB,iBACoCC,GADpC,UAEOO,MAFP,GAGIN,IAHJ;AAKH,SAND,MAMO;AAAA;;AACH,uBAAAO,OAAO,EAACN,MAAD,CAAP,gCAAsBE,QAAtB,iBAAqCL,IAArC,iBAAgDC,GAAhD,UAA0DO,MAA1D;AACH;AACJ;AACJ;;AAxBD;AA0BA;;;;;;AAKC,aAAgBE,eAAhB,CAAgCC,IAAhC,EAAgDC,GAAhD,EAA8D;AAC3D,UAAMnK,GAAG,GAAGkK,IAAI,CAAC,CAAD,CAAhB;;AACA,UAAIC,GAAG,IAAInK,GAAG,IAAImK,GAAlB,EAAuB;AACnB,eAAOD,IAAI,CAAC1D,MAAL,GAAc,CAAd,GACDyD,eAAe,CAACC,IAAI,CAACE,KAAL,CAAW,CAAX,CAAD,EAAgBD,GAAG,CAACnK,GAAD,CAAH,IAAY,EAA5B,CADd,GAEDmK,GAAG,CAACnK,GAAD,CAFT;AAGH;;AACD,aAAO,IAAP;AACH;;AARA;AAUD;;AACA;;;;AAGA,aAAgBqK,cAAhB,GAA8B;AAC1B,UAAMC,CAAC,GAAG,gEAAV;AACA,aAAO,CAAC,CAACC,SAAS,CAACC,SAAV,CAAoBC,KAApB,CAA0BH,CAA1B,CAAT;AACH;;AAHD;AAKA;;AACA;;;;AAGA,aAAgBI,cAAhB,GAA8B;AAC1B,UAAMC,KAAK,GAAGJ,SAAS,CAACC,SAAxB;AACA,aAAO,CAAC,EACJG,KAAK,CAACF,KAAN,CAAY,kBAAZ,KACAE,KAAK,CAACF,KAAN,CAAY,aAAZ,CADA,IAEA,CAACE,KAAK,CAACF,KAAN,CAAY,OAAZ,CAHG,CAAR;AAKH;;AAPD;AASA;;AACA;;;;AAGA,aAAgBG,eAAhB,GAA+B;AAC3B,UAAMD,KAAK,GAAGJ,SAAS,CAACC,SAAxB;AACA,aAAO,CAAC,EAAEG,KAAK,CAACF,KAAN,CAAY,SAAZ,KAA0BE,KAAK,CAACF,KAAN,CAAY,QAAZ,CAA5B,CAAR;AACH;;AAHD;AAKA;;;;;;AAKA,aAAgBI,OAAhB,CAAwBrD,KAAxB,EAAuChB,MAAvC,EAAqD;AACjD,UAAIsE,GAAG,GAAGtD,KAAK,CAACuD,QAAN,EAAV;;AACA,aAAOD,GAAG,CAACtE,MAAJ,GAAaA,MAApB,EAA4B;AACxBsE,WAAG,GAAG,MAAMA,GAAZ;AACH;;AACD,aAAOA,GAAP;AACH;;AAND;AAQA;;;;;;AAKA,aAAgBE,MAAhB,CAA0BC,KAA1B,EAA4E;AAAA,UAAtCjL,GAAsC,uEAAXuG,SAAW;AACxE,aAAO0E,KAAK,CAACC,MAAN,CACH,UAACC,EAAD,EAAKC,GAAL,EAAUC,GAAV;AAAA,eACIF,EAAE,IACFE,GAAG,CAAC3D,OAAJ,CACI1H,GAAG,GACGqL,GAAG,CAACvD,IAAJ,CAAS,UAACnF,CAAD;AAAA,iBAAOA,CAAC,IAAIA,CAAC,CAAC3C,GAAD,CAAD,KAAWmL,EAAE,CAACnL,GAAD,CAAzB;AAAA,SAAT,CADH,GAEGqL,GAAG,CAACvD,IAAJ,CAAS,UAACnF,CAAD;AAAA,iBAAOA,CAAC,KAAKwI,EAAb;AAAA,SAAT,CAHV,MAIMC,GANV;AAAA,OADG,CAAP;AASH;;AAVD;AAYA;;;;;;AAKA,aAAgBE,gBAAhB,CAAiCC,aAAjC,EAA+E;AAAA,UAAvBC,IAAuB,uEAAR,MAAQ;AAC3E,UAAMnG,QAAQ,GAAGT,IAAI,CAACY,KAAL,CAAW+F,aAAX,CAAjB;;AACA,UAAI,CAAClG,QAAD,IAAaA,QAAQ,GAAG,CAA5B,EAA+B;AAC3B,eAAO,EAAP;AACH;;AACD,UAAIoG,QAAQ,GAAG,KAAf;AACA,UAAIC,MAAM,GAAG;AAAEC,aAAK,EAAE,OAAT;AAAkB5G,eAAO,EAAE;AAA3B,OAAb;;AACA,cAAQyG,IAAR;AACI,aAAK,QAAL;AACIE,gBAAM,GAAG;AAAEC,iBAAK,EAAE,IAAT;AAAe5G,mBAAO,EAAE;AAAxB,WAAT;AACA;;AACJ,aAAK,OAAL;AACI2G,gBAAM,GAAG;AAAEC,iBAAK,EAAE,GAAT;AAAc5G,mBAAO,EAAE;AAAvB,WAAT;AACA0G,kBAAQ,GAAG,IAAX;AACA;AAPR;;AASA,UAAMlG,CAAC,GAAGX,IAAI,CAACY,KAAL,CAAWH,QAAQ,GAAG,EAAtB,CAAV;AACA,UAAII,CAAC,aACDF,CAAC,IAAI,CAAL,GACMA,CAAC,IACAkG,QAAQ,GAAGC,MAAM,CAACC,KAAV,GAAkBD,MAAM,CAACC,KAAP,IAAgBpG,CAAC,KAAK,CAAN,GAAU,EAAV,GAAe,GAA/B,CAD1B,CADP,GAGM,EAJL,CAAL;;AAMA,UAAIF,QAAQ,GAAG,EAAX,KAAkB,CAAtB,EAAyB;AACrB,YAAII,CAAJ,EAAO;AACHA,WAAC,IAAIgG,QAAQ,GAAG,GAAH,GAAS,IAAtB;AACH;;AACD,YAAM/F,CAAC,GAAGL,QAAQ,GAAG,EAArB;AACAI,SAAC,cACGC,CAAC,IAAI,CAAL,GACMA,CAAC,IACA+F,QAAQ,GACHC,MAAM,CAAC3G,OADJ,GAEH2G,MAAM,CAAC3G,OAAP,IAAkBW,CAAC,KAAK,CAAN,GAAU,EAAV,GAAe,GAAjC,CAHL,CADP,GAKM,EANT,CAAD;AAQH;;AACD,aAAOD,CAAP;AACH;;AAtCD;AAwCA;;;;;;;AAMA,aAAgBmG,UAAhB,CACIV,MADJ,EAEI5I,KAFJ,EAG6B;AAAA,UAAzBuJ,MAAyB,uEAAN,CAAC,IAAD,CAAM;AAEzB,UAAIC,OAAJ,CAFyB,CAGzB;;AACA,UAAMC,OAAO,GAAG,CAACb,MAAM,IAAI,EAAX,EAAec,WAAf,GAA6B1F,KAA7B,CAAmC,GAAnC,CAAhB;AACA,UAAM9D,IAAI,GAAG,EAAb;;AALyB,iDAMTuJ,OANS;AAAA;;AAAA;AAMzB,4DAAyB;AAAA,cAAdE,GAAc;;AACrB;AACA,cAAIA,GAAJ,EAAO;AACH;AACA,gBAAI,CAACzJ,IAAI,CAACyJ,GAAD,CAAT,EAAc;AACVzJ,kBAAI,CAACyJ,GAAD,CAAJ,GAAU,CAAV;AACH;;AACDzJ,gBAAI,CAACyJ,GAAD,CAAJ;AACH;AACJ,SAfwB,CAgBzB;;AAhByB;AAAA;AAAA;AAAA;AAAA;;AAiBzB,UAAMC,KAAK,GAAG,EAAd;;AACA,WAAK,IAAMD,CAAX,IAAgBzJ,IAAhB,EAAsB;AAClB;AACA,YAAIA,IAAI,CAACvC,cAAL,CAAoBgM,CAApB,CAAJ,EAA4B;AACxBC,eAAK,CAACC,IAAN,CAAW;AAAEC,gBAAI,EAAEH,CAAR;AAAWI,iBAAK,EAAE7J,IAAI,CAACyJ,CAAD,CAAtB;AAA2BK,iBAAK,EAAE,IAAIC,MAAJ,CAAWN,CAAX,EAAc,IAAd;AAAlC,WAAX;AACH;AACJ;;AACDC,WAAK,CAACM,IAAN,CACI,UAACC,CAAD,EAAIC,CAAJ;AAAA,eAAUA,CAAC,CAACN,IAAF,CAAO5F,MAAP,GAAgBiG,CAAC,CAACL,IAAF,CAAO5F,MAAvB,IAAiCiG,CAAC,CAACL,IAAF,CAAOO,aAAP,CAAqBD,CAAC,CAACN,IAAvB,CAA3C;AAAA,OADJ;AAGA,UAAMQ,SAAS,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAezK,KAAK,IAAI,EAAxB,CAAX,CAAlB;AACA;;AACA,UAAI4I,MAAJ,EAAY;AACRY,eAAO,GAAGc,SAAS,CAAC1B,MAAV,CAAiB,UAAC8B,IAAD,EAAU;AACjC,cAAIC,WAAW,GAAG,CAAlB;AACAD,cAAI,CAACE,WAAL,GAAmB,KAAnB;AACAF,cAAI,CAACvC,KAAL,GAAa,EAAb;AACA,cAAM0C,UAAU,GAAG,EAAnB,CAJiC,CAKjC;;AALiC,sDAMjBtB,MANiB;AAAA;;AAAA;AAMjC,mEAAwB;AAAA,kBAAbI,GAAa;AACpBkB,wBAAU,CAAClB,GAAD,CAAV,GAAgB;AACZzE,qBAAK,EAAE,CAACwF,IAAI,CAACf,GAAD,CAAJ,IAAW,EAAZ,EAAgBD,WAAhB,EADK;AAEZpJ,qBAAK,EAAE,KAFK;AAGZwK,uBAAO,EAAE;AAHG,eAAhB;AAKH,aAZgC,CAajC;;AAbiC;AAAA;AAAA;AAAA;AAAA;;AAAA,sDAcjBlB,KAdiB;AAAA;;AAAA;AAcjC,mEAAuB;AAAA,kBAAZvJ,CAAY;;AACnB;AACA,kBAAIA,CAAC,CAACyJ,IAAN,EAAY;AACR;AADQ,4DAEQP,MAFR;AAAA;;AAAA;AAER,yEAAwB;AAAA,wBAAbI,GAAa;AACpB,wBAAMoB,KAAK,GAAGF,UAAU,CAAClB,GAAD,CAAxB;AACA,wBAAMrJ,KAAK,GAAGyK,KAAK,CAAC7F,KAAN,CAAYE,OAAZ,CAAoB/E,CAAC,CAACyJ,IAAtB,CAAd;AACAiB,yBAAK,CAACzK,KAAN,GAAcA,KAAK,GAAGyK,KAAK,CAACzK,KAAd,GAAsBA,KAAtB,GAA8ByK,KAAK,CAACzK,KAAlD;AACAyK,yBAAK,CAACC,OAAN,GAAgB,CACZD,KAAK,CAAC7F,KAAN,CAAYiD,KAAZ,CAAkB9H,CAAC,CAAC2J,KAApB,KAA8B,EADlB,EAEd9F,MAFF;AAGA6G,yBAAK,CAAC7F,KAAN,GAAc6F,KAAK,CAAC7F,KAAN,CAAY+F,OAAZ,CAAoB5K,CAAC,CAAC2J,KAAtB,EAA6B,GAA7B,CAAd;AACH,mBAVO,CAWR;;AAXQ;AAAA;AAAA;AAAA;AAAA;;AAAA,4DAYQT,MAZR;AAAA;;AAAA;AAYR,yEAAwB;AAAA,wBAAbI,GAAa;AACpB,wBAAMoB,MAAK,GAAGF,UAAU,CAAClB,GAAD,CAAxB;AACA;;AACA,wBAAIoB,MAAK,CAACC,OAAN,IAAiB3K,CAAC,CAAC0J,KAAvB,EAA8B;AAC1BY,iCAAW,GADe,CAE1B;;AACA,0BAAIO,OAAO,GAAG,CAAd;AACA,0BAAMC,MAAM,GAAG,CACXT,IAAI,iBAAUf,GAAV,EAAJ,IACAe,IAAI,CAACf,GAAD,CADJ,IAEA,EAHW,EAIb3F,KAJa,CAIP,GAJO,CAAf;;AAJ0B,kEASVmH,MATU;AAAA;;AAAA;AAS1B,+EAAwB;AAAA,8BAAbC,CAAa;;AACpB;AACA,8BAAIF,OAAO,IAAI7K,CAAC,CAAC0J,KAAjB,EAAwB;AACpB;AACH;AACD;;;AACA,8BACIqB,CAAC,CAAC1B,WAAF,GAAgBtE,OAAhB,CAAwB/E,CAAC,CAACyJ,IAA1B,KAAmC,CAAnC,IACAsB,CAAC,CAAChG,OAAF,CAAU,GAAV,IAAiB,CAFrB,EAGE;AACE+F,kCAAM,CAACA,MAAM,CAAC/F,OAAP,CAAegG,CAAf,CAAD,CAAN,GAA4BA,CAAC,CAACH,OAAF,CACxB5K,CAAC,CAAC2J,KADsB,EAExB,MAFwB,CAA5B;AAIAkB,mCAAO;AACV;AACJ;AAzByB;AAAA;AAAA;AAAA;AAAA;;AA0B1BR,0BAAI,iBAAUf,GAAV,EAAJ,GAAqBwB,MAAM,CAACE,IAAP,CAAY,GAAZ,CAArB;AACA;AACH;AACJ;AA5CO;AAAA;AAAA;AAAA;AAAA;AA6CX;AACJ,aA9DgC,CA+DjC;;AA/DiC;AAAA;AAAA;AAAA;AAAA;;AAAA,sDAgEjB9B,MAhEiB;AAAA;;AAAA;AAgEjC,mEAAwB;AAAA,kBAAbI,GAAa;AACpB,kBAAMoB,OAAK,GAAGF,UAAU,CAAClB,GAAD,CAAxB;AACA;;AACA,kBAAIoB,OAAK,CAACzK,KAAN,GAAcoK,IAAI,CAACE,WAAnB,IAAkCG,OAAK,CAACzK,KAAN,IAAe,CAArD,EAAwD;AACpDoK,oBAAI,CAACE,WAAL,GAAmBG,OAAK,CAACzK,KAAzB;AACAoK,oBAAI,CAACvC,KAAL,GAAawB,GAAb;AACH;AACJ;AAvEgC;AAAA;AAAA;AAAA;AAAA;;AAwEjC,iBACIe,IAAI,CAACE,WAAL,IAAoB,CAApB,IACAF,IAAI,CAACvC,KADL,IAEAwC,WAAW,IAAIf,KAAK,CAAC1F,MAHzB;AAKH,SA7ES,CAAV;AA8EH,OA/ED,MA+EO;AACHsF,eAAO,GAAGc,SAAV;AACH,OA9GwB,CA+GzB;;;AACAd,aAAO,CAACU,IAAR,CAAa,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACnB,YAAM9E,IAAI,GAAG6E,CAAC,CAACS,WAAF,GAAgBR,CAAC,CAACQ,WAA/B;AACA,eAAOtF,IAAI,KAAK,CAAT,GAAa6E,CAAC,CAACpM,IAAF,CAAOsM,aAAP,CAAqBD,CAAC,CAACrM,IAAvB,CAAb,GAA4CuH,IAAnD;AACH,OAHD;AAIA,aAAOkE,OAAP;AACH;;AAxHD;AA0HA;;;;;AAIA,aAAgB8B,gBAAhB,CAAiC9C,GAAjC,EAA4C;AACxC;AACA,UAAIA,GAAJ,EAAS;AACLA,WAAG,GAAGA,GAAG,CAACyC,OAAJ,CACF,yBADE,EAEF,mCAFE,CAAN;AAIAzC,WAAG,GAAGA,GAAG,CAACyC,OAAJ,CAAY,KAAZ,EAAmB,EAAnB,CAAN;AACH;;AACD,aAAOzC,GAAP;AACH;;AAVD;AAYA;;;;;AAIA,aAAgB+C,UAAhB,CAA2BC,IAA3B,EAAuC;AACnC,UAAM5B,KAAK,GAAG4B,IAAI,CAACxH,KAAL,CAAW,GAAX,CAAd;AACA,UAAMhC,IAAI,GAAG,UAAAyJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EACRgB,QADQ,CACC;AACN0B,YAAI,EAAE,CAACsF,KAAK,CAAC,CAAD,CADN;AAENvH,cAAM,EAAE,CAACuH,KAAK,CAAC,CAAD;AAFR,OADD,EAKR8B,YALQ,CAKK,QALL,CAAb;AAMA,aAAO1J,IAAI,CAAC2J,EAAZ;AACH;;AATD;AAWA;;;;;;AAKA,aAAgBC,SAAhB,CAA0BrJ,IAA1B,EAA2D;AAAA,UAAnBW,KAAmB,uEAAH,CAAG;AACvD,aAAOZ,IAAI,CAACY,KAAL,CAAWZ,IAAI,CAACuJ,MAAL,MAAiBtJ,IAAI,GAAGW,KAAxB,CAAX,IAA6CA,KAApD;AACH;;AAFD;AAIA;;;;;AAIA,aAAgB4I,gBAAhB,GAAgC;AAC5B,aAAOC,YAAY,KAAK,OAAL,GAAe,OAAlC;AACH;;AAFD;;AAIa,YAAAC,YAAA,GAAe;AAAA,aAAeD,YAAY,KAAK,OAAL,GAAe,OAA1C;AAAA,KAAf;;AAEb,aAAgBnI,qBAAhB,GAAqC;AACjC,aAAOmI,YAAY,KAAK,OAAL,GAAe,OAAlC;AACH;;AAFD;;AAIa,YAAA5H,iBAAA,GAAoB;AAAA,aAC7B4H,YAAY,KAAK,OAAL,GAAe,MADE;AAAA,KAApB;AAGb;;;;;;AAIa,YAAAE,kBAAA,GAAqB,UAC9BC,YAD8B,EAET;AACrB,UAAIC,IAAJ;;AACA,UAAID,YAAJ,EAAkB;AACd,YAAI;AACAC,cAAI,GAAG,UAAAV,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoBwK,MAApB,CAA2BF,YAA3B,CAAP;AACH,SAFD,CAEE,OAAOG,CAAP,EAAU,CACR;AACA;AACH;AACJ;;AACD,aAAOF,IAAP;AACH,KAbY;;AAeA,YAAAG,eAAA,GAAkB,UAACtK,IAAD;AAAA,aAC3B,CAAC,CAACA,IAAF,aAAYA,IAAI,CAACsB,UAAL,CAAgB,MAAhB,CAAZ,IAAwC,EADb;AAAA,KAAlB;;AAEA,YAAAiJ,gBAAA,GAAmB,UAACvK,IAAD;AAAA,aAC5B,CAAC,CAACA,IAAF,iBAAgBA,IAAI,CAACsB,UAAL,CAAgB,IAAhB,CAAhB,SAA2C,EADf;AAAA,KAAnB;AAGb;;;;;;AAIA,aAAgBkJ,wBAAhB,CAAyCxK,IAAzC,EAAqD;AACjD,uBAAUA,IAAI,CACTsB,UADK,CACMwI,gBAAgB,EADtB,EAELW,iBAFK,EAAV,cAE4B,QAAAH,eAAA,CAAgBtK,IAAhB,CAF5B;AAGH;;AAJD;;AAMA,aAAgB0K,6BAAhB,CAA8C1K,IAA9C,EAA0D;AACtD,uBAAUA,IAAI,CACTsB,UADK,CACMwI,gBAAgB,EADtB,EAELW,iBAFK,EAAV,cAE4B,QAAAF,gBAAA,CAAiBvK,IAAjB,CAF5B;AAGH;;AAJD;AAMA;;;;;;;;AAOA,aAAgB2K,wBAAhB,CACIC,WADJ,EAEIC,SAFJ,EAEqB;AAEjB,uBAAUD,WAAW,CAChBtJ,UADK,CACMwI,gBAAgB,EADtB,EAELW,iBAFK,EAAV,cAE4BI,SAAS,CAChCvJ,UADuB,CACZwI,gBAAgB,EADJ,EAEvBW,iBAFuB,EAF5B;AAKH;;AATD;AAWA;;;;;;;;AAOA,aAAgBK,gCAAhB,CACIF,WADJ,EAEIC,SAFJ,EAEqB;AAEjB,uBAAUD,WAAW,CAChBtJ,UADK,CACMwI,gBAAgB,EADtB,EAELW,iBAFK,EAAV,cAE4BI,SAAS,CAChCvJ,UADuB,CACZwI,gBAAgB,EADJ,EAEvBW,iBAFuB,EAF5B,cAI4B,QAAAF,gBAAA,CAAiBK,WAAjB,CAJ5B;AAKH;;AATD;AAWA;;;;;;AAKA,aAAgBG,qBAAhB,CAAsC/K,IAAtC,EAAoDgL,KAApD,EAAmE;AAC/D,UAAIA,KAAJ,EAAW;AACP,eAAOhL,IAAI,CAACiL,eAAL,CAAqB,mBAArB,CAAP;AACH;;AACD,aAAOjL,IAAI,CAACiL,eAAL,CAAqB,kBAArB,CAAP;AACH;;AALD;;AAOA,aAAgBC,wBAAhB,CACIlL,IADJ,EAEIgL,KAFJ,EAEmB;AAEf,UAAIA,KAAJ,EAAW;AACP,eAAOhL,IAAI,CAACsB,UAAL,CAAgB,mBAAhB,CAAP;AACH;;AACD,aAAOtB,IAAI,CAACsB,UAAL,CAAgB,kBAAhB,CAAP;AACH;;AARD;;AAUA,aAAgB6J,4BAAhB,CACInL,IADJ,EAEIgL,KAFJ,EAEmB;AAEf,UAAIA,KAAJ,EAAW;AACP,eAAOhL,IAAI,CAACiL,eAAL,CAAqB,iBAArB,CAAP;AACH;;AACD,aAAOjL,IAAI,CAACiL,eAAL,CAAqB,gBAArB,CAAP;AACH;;AARD;;AAUA,aAAgBG,+BAAhB,CACIpL,IADJ,EAEIgL,KAFJ,EAEmB;AAEf,UAAIA,KAAJ,EAAW;AACP,eAAOhL,IAAI,CAACsB,UAAL,CAAgB,iBAAhB,CAAP;AACH;;AACD,aAAOtB,IAAI,CAACsB,UAAL,CAAgB,gBAAhB,CAAP;AACH;;AARD;AAUA;;AACA,aAAgByI,YAAhB,GAA4B;AACxB,UAAM/J,IAAI,GAAG,IAAIJ,IAAJ,EAAb;AACA,UAAMyL,YAAY,GAAGrL,IAAI,CACpBsL,kBADgB,CAEbC,QAAQ,CAACC,aAAT,CAAuB,MAAvB,EAA+BC,YAA/B,CAA4C,MAA5C,KACIxF,SAAS,CAACyF,QAHD,EAKhBhE,WALgB,EAArB;AAMA,aAAO2D,YAAY,CAACjI,OAAb,CAAqB,IAArB,IAA6B,CAA7B,IAAkCiI,YAAY,CAACjI,OAAb,CAAqB,IAArB,IAA6B,CAAtE;AACH;;AATD;AAWA;;AACA;;;;;;AAKA,aAAgBuI,YAAhB,CAA6BC,QAA7B,EAA+CC,QAA/C,EAAiE;AAC7D,UAAMjO,OAAO,GAAG2N,QAAQ,CAACO,aAAT,CAAuB,GAAvB,CAAhB;AACAlO,aAAO,CAACmO,YAAR,CACI,MADJ,EAEI,mCACIC,kBAAkB,CAAC,WAAWH,QAAZ,CAH1B;AAKAjO,aAAO,CAACmO,YAAR,CAAqB,UAArB,EAAiCH,QAAjC;AAEAhO,aAAO,CAAClD,KAAR,CAAcuR,OAAd,GAAwB,MAAxB;AACAV,cAAQ,CAACW,IAAT,CAAcC,WAAd,CAA0BvO,OAA1B;AAEAA,aAAO,CAACwO,KAAR;AAEAb,cAAQ,CAACW,IAAT,CAAcG,WAAd,CAA0BzO,OAA1B;AACH;;AAfD;AAiBA;;;;;AAIA,aAAgB0O,SAAhB,CAA0BC,GAA1B,EAAuC;AACnC,UAAMC,KAAK,GAAGD,GAAG,CAACvK,KAAJ,CAAU,IAAV,CAAd;AACA,UAAIuF,MAAM,GAAGiF,KAAK,CAACC,MAAN,CAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,EAAsBzK,KAAtB,CAA4B,GAA5B,CAAb;AACAuF,YAAM,GAAGA,MAAM,CAAC1B,GAAP,CAAW,UAAC6G,CAAD;AAAA,eAAOA,CAAC,CAACzD,OAAF,CAAU,IAAV,EAAgB,EAAhB,CAAP;AAAA,OAAX,CAAT;AACA,UAAM/K,IAAI,GAAU,EAApB;;AAJmC,kDAKhBsO,KALgB;AAAA;;AAAA;AAKnC,+DAA0B;AAAA,cAAfG,IAAe;AACtB,cAAI/E,KAAK,GAAG+E,IAAI,CAAC3K,KAAL,CAAW,GAAX,CAAZ;AACA4F,eAAK,GAAGA,KAAK,CAAC/B,GAAN,CAAU,UAAC6G,CAAD;AAAA,mBAAOA,CAAC,CAACzD,OAAF,CAAU,IAAV,EAAgB,EAAhB,CAAP;AAAA,WAAV,CAAR;AACA;;AACA,cAAIrB,KAAK,CAAC1F,MAAN,IAAgBqF,MAAM,CAACrF,MAA3B,EAAmC;AAC/B,gBAAMwG,IAAI,GAAQ,EAAlB;;AACA,iBAAK,IAAIrK,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAIuJ,KAAK,CAAC1F,MAA3B,EAAmC7D,CAAC,EAApC,EAAwC;AACpC,kBAAIuO,IAAI,GAAG,IAAX;AACAA,kBAAI,GAAGhF,KAAK,CAACvJ,CAAD,CAAZ;AACA;;AACA,kBAAIuO,IAAI,KAAK3K,SAAb,EAAwB;AACpByG,oBAAI,CAAC,CAACnB,MAAM,CAAClJ,CAAD,CAAN,IAAa,EAAd,EAAkB2D,KAAlB,CAAwB,GAAxB,EAA6BqH,IAA7B,CAAkC,GAAlC,EAAuC3B,WAAvC,EAAD,CAAJ,GACIkF,IADJ;AAEH;AACJ;;AACD1O,gBAAI,CAAC2J,IAAL,CAAUa,IAAV;AACH;AACJ;AAtBkC;AAAA;AAAA;AAAA;AAAA;;AAwBnC,aAAOxK,IAAP;AACH;;AAzBD;AA2BA;;;;;AAIA,aAAgB2O,SAAhB,CAA0BC,IAA1B,EAA2C;AACvC;AACA,UAAIA,IAAI,YAAYC,KAAhB,IAAyBD,IAAI,CAAC5K,MAAL,GAAc,CAA3C,EAA8C;AAC1C,YAAM0D,IAAI,GAAGoH,MAAM,CAACpH,IAAP,CAAYkH,IAAI,CAAC,CAAD,CAAhB,CAAb;AACA,YAAMG,UAAU,GAAGrH,IAAI,CAACgB,MAAL,CAAY,UAAClL,GAAD;AAAA,iBAASoR,IAAI,CAAC,CAAD,CAAJ,CAAQnR,cAAR,CAAuBD,GAAvB,CAAT;AAAA,SAAZ,CAAnB;AACA,yBAAUuR,UAAU,CAAC5D,IAAX,CAAgB,GAAhB,CAAV,eAAmCyD,IAAI,CAClCjH,GAD8B,CAC1B,UAAC6C,IAAD;AAAA,iBACDuE,UAAU,CACLpH,GADL,CACS,UAACnK,GAAD,EAAS;AACV,mBAAO,OAAOgN,IAAI,CAAChN,GAAD,CAAX,KAAqB,SAArB,eACGgN,IAAI,CAAChN,GAAD,CAAJ,IAAa,EADhB,UAEDgN,IAAI,CAAChN,GAAD,CAFV;AAGH,WALL,EAMK2N,IANL,CAMU,GANV,CADC;AAAA,SAD0B,EAU9BA,IAV8B,CAUzB,IAVyB,CAAnC;AAWH;;AACD,aAAO,EAAP;AACH;;AAlBD;AAoBA;;AACA;;;;;AAIA,aAAgB6D,QAAhB,GAA2B;AACvB,UAAIC,EAAE,GAAG5H,MAAM,CAACU,SAAP,CAAiBC,SAA1B;AAEA,UAAIkH,IAAI,GAAGD,EAAE,CAAC/J,OAAH,CAAW,OAAX,CAAX;;AACA,UAAIgK,IAAI,GAAG,CAAX,EAAc;AACV;AACA,eAAOjK,QAAQ,CAACgK,EAAE,CAACE,SAAH,CAAaD,IAAI,GAAG,CAApB,EAAuBD,EAAE,CAAC/J,OAAH,CAAW,GAAX,EAAgBgK,IAAhB,CAAvB,CAAD,EAAgD,EAAhD,CAAf;AACH;;AAED,UAAIE,OAAO,GAAGH,EAAE,CAAC/J,OAAH,CAAW,UAAX,CAAd;;AACA,UAAIkK,OAAO,GAAG,CAAd,EAAiB;AACb;AACA,YAAIC,EAAE,GAAGJ,EAAE,CAAC/J,OAAH,CAAW,KAAX,CAAT;AACA,eAAOD,QAAQ,CAACgK,EAAE,CAACE,SAAH,CAAaE,EAAE,GAAG,CAAlB,EAAqBJ,EAAE,CAAC/J,OAAH,CAAW,GAAX,EAAgBmK,EAAhB,CAArB,CAAD,EAA4C,EAA5C,CAAf;AACH;;AAED,UAAIC,IAAI,GAAGL,EAAE,CAAC/J,OAAH,CAAW,OAAX,CAAX;;AACA,UAAIoK,IAAI,GAAG,CAAX,EAAc;AACV;AACA,eAAOrK,QAAQ,CAACgK,EAAE,CAACE,SAAH,CAAaG,IAAI,GAAG,CAApB,EAAuBL,EAAE,CAAC/J,OAAH,CAAW,GAAX,EAAgBoK,IAAhB,CAAvB,CAAD,EAAgD,EAAhD,CAAf;AACH,OApBsB,CAsBvB;;;AACA,aAAO,KAAP;AACH;;AAxBD;AA0BA;;;;;AAIA,aAAgBC,YAAhB,CAA6BC,KAA7B,EAA2D;AACvD,UAAI,CAACA,KAAL,EAAY;AACR,eAAO;AAAElQ,WAAC,EAAE,CAAC,CAAN;AAASC,WAAC,EAAE,CAAC;AAAb,SAAP;AACH;;AACD,UAAIiQ,KAAK,YAAYC,UAArB,EAAiC;AAC7B,eAAO;AAAEnQ,WAAC,EAAEkQ,KAAK,CAACE,OAAX;AAAoBnQ,WAAC,EAAEiQ,KAAK,CAACG;AAA7B,SAAP;AACH,OAFD,MAEO;AACH,eAAOH,KAAK,CAACI,OAAN,IAAiBJ,KAAK,CAACI,OAAN,CAAc5L,MAAd,GAAuB,CAAxC,GACD;AAAE1E,WAAC,EAAEkQ,KAAK,CAACI,OAAN,CAAc,CAAd,EAAiBF,OAAtB;AAA+BnQ,WAAC,EAAEiQ,KAAK,CAACI,OAAN,CAAc,CAAd,EAAiBD;AAAnD,SADC,GAED;AAAErQ,WAAC,EAAE,CAAC,CAAN;AAASC,WAAC,EAAE,CAAC;AAAb,SAFN;AAGH;AACJ;;AAXD;AAaA;;AACA;;;;;AAIA,aAAgBsQ,OAAhB,CAAiCC,QAAjC,EAAgD;AAC5C,UAAMC,KAAK,sBAAOD,QAAP,CAAX;;AACA,UAAME,GAAG,GAAG,EAAZ;;AACA,aAAOD,KAAK,CAAC/L,MAAb,EAAqB;AACjB;AACA,YAAMiM,IAAI,GAAGF,KAAK,CAACG,GAAN,EAAb;;AACA,YAAIrB,KAAK,CAACsB,OAAN,CAAcF,IAAd,CAAJ,EAAyB;AACrB;AACAF,eAAK,CAACpG,IAAN,OAAAoG,KAAK,qBAASE,IAAT,EAAL;AACH,SAHD,MAGO;AACHD,aAAG,CAACrG,IAAJ,CAASsG,IAAT;AACH;AACJ,OAZ2C,CAa5C;;;AACA,aAAOD,GAAG,CAACI,OAAJ,EAAP;AACH;;AAfD;AAiBA,QAAMC,IAAI,GAAGC,KAAK,CAAC,SAAD,CAAlB;AACA,QAAMC,IAAI,GAAGC,KAAK,CAAC,UAAD,EAAa,UAAb,EAAyB,UAAzB,EAAqCH,IAAI,EAAzC,CAAlB;;AAEA,aAAgBI,oBAAhB,GAA4E;AAAA,UAAvCpO,IAAuC,uEAAxB,GAAwB;AAAA,UAAnBW,KAAmB,uEAAH,CAAG;AACxE,aAAOZ,IAAI,CAACY,KAAL,CAAWuN,IAAI,MAAMlO,IAAI,GAAGW,KAAb,CAAf,IAAsCA,KAA7C;AACH;;AAFD,wD,CAIA;;AACA,aAASsN,KAAT,CAAehI,GAAf,EAAoB;AAChB,WAAK,IAAInI,CAAC,GAAG,CAAR,EAAW4C,CAAC,GAAG,aAAauF,GAAG,CAACtE,MAArC,EAA6C7D,CAAC,GAAGmI,GAAG,CAACtE,MAArD,EAA6D7D,CAAC,EAA9D;AACK4C,SAAC,GAAGX,IAAI,CAACsO,IAAL,CAAU3N,CAAC,GAAGuF,GAAG,CAACqI,UAAJ,CAAexQ,CAAf,CAAd,EAAiC,UAAjC,CAAL,EACK4C,CAAC,GAAIA,CAAC,IAAI,EAAN,GAAaA,CAAC,KAAK,EAD5B;AADJ;;AAGA,aAAO,YAAY;AACfA,SAAC,GAAGX,IAAI,CAACsO,IAAL,CAAU3N,CAAC,GAAIA,CAAC,KAAK,EAArB,EAA0B,UAA1B,CAAJ;AACAA,SAAC,GAAGX,IAAI,CAACsO,IAAL,CAAU3N,CAAC,GAAIA,CAAC,KAAK,EAArB,EAA0B,UAA1B,CAAJ;AACA,eAAO,CAACA,CAAC,IAAIA,CAAC,KAAK,EAAZ,MAAoB,CAA3B;AACH,OAJD;AAKH;;AAED,aAASyN,KAAT,CAAevG,CAAf,EAAkBC,CAAlB,EAAqB0G,CAArB,EAAwB3N,CAAxB,EAA2B;AACvB,aAAO,YAAY;AACfgH,SAAC,MAAM,CAAP;AACAC,SAAC,MAAM,CAAP;AACA0G,SAAC,MAAM,CAAP;AACA3N,SAAC,MAAM,CAAP;AACA,YAAI4N,CAAC,GAAI5G,CAAC,GAAGC,CAAL,GAAU,CAAlB;AACAD,SAAC,GAAGC,CAAC,GAAIA,CAAC,KAAK,CAAf;AACAA,SAAC,GAAI0G,CAAC,IAAIA,CAAC,IAAI,CAAT,CAAF,GAAiB,CAArB;AACAA,SAAC,GAAIA,CAAC,IAAI,EAAN,GAAaA,CAAC,KAAK,EAAvB;AACA3N,SAAC,GAAIA,CAAC,GAAG,CAAL,GAAU,CAAd;AACA4N,SAAC,GAAIA,CAAC,GAAG5N,CAAL,GAAU,CAAd;AACA2N,SAAC,GAAIA,CAAC,GAAGC,CAAL,GAAU,CAAd;AACA,eAAO,CAACA,CAAC,KAAK,CAAP,IAAY,UAAnB;AACH,OAbD;AAcH;;AAED,aAAgBC,oBAAhB,CAAqCC,UAArC,EAAuD;AACnD,UAAI1J,MAAJ,EAAY;AACR,eAAOA,MAAM,CAAC2J,UAAP,GAAoBD,UAA3B;AACH;;AACD,aAAO,KAAP;AACH;;AALD;;AAOA,aAAgBE,WAAhB,CAA4B3I,GAA5B,EAAuC;AACnC,aAAO,OAAOA,GAAP,KAAe,QAAf,GACDA,GAAG,CACEkB,WADL,GAEK1F,KAFL,CAEW,GAFX,EAGK6D,GAHL,CAGS,UAAUiC,IAAV,EAAgB;AACjB,eAAOA,IAAI,CAACmB,OAAL,CAAanB,IAAI,CAAC,CAAD,CAAjB,EAAsBA,IAAI,CAAC,CAAD,CAAJ,CAAQsH,WAAR,EAAtB,CAAP;AACH,OALL,EAMK/F,IANL,CAMU,GANV,CADC,GAQD,EARN;AASH;;AAVD;;;;;;;;;;;;;;;;;;;;ACxqBA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;QAOagG,c;;;;;;;;;;;;;sCAGS;AACd,eAAK3S,OAAL;AACH;;;;MAL+B,aAAAtB,S;;AAHpC;;;8CAGaiU,c;AAAc,K;;;YAAdA,c;AAAc,2E;AAAA;;+DAAdA,c;;;;2BAAAA,c,EAAc;cAH1B,OAAA1S,SAG0B;eAHhB;AACPC,kBAAQ,EAAE;AADH,S;AAGgB,Q;;;;;;;;;;;;;;;;;;;;;;ACT3B;AAAA;AAAA;;;;;;QASaE,oB;AAET,oCAAoBwS,GAApB,EAAqC;AAAA;;AAAjB,aAAAA,GAAA,GAAAA,GAAA;AACnB;;;;sCAEgD5B,K,EAAO;AACpD,cAAM6B,WAAW,GAAG,KAAKD,GAAL,CAASzR,aAAT,CAAuBqF,KAA3C;AACA,eAAKoM,GAAL,CAASzR,aAAT,CAAuBqF,KAAvB,GAA+BqM,WAAW,CAACtG,OAAZ,CAAoB,UAApB,EAAgC,EAAhC,CAA/B;;AACA,cAAIsG,WAAW,KAAK,KAAKD,GAAL,CAASzR,aAAT,CAAuBqF,KAA3C,EAAkD;AAC9CwK,iBAAK,CAAC8B,eAAN;AACH;AACJ;;;;;;AAdL;;;uBAGa1S,oB,EAAoB,mC;AAAA,K;;;YAApBA,oB;AAAoB,4E;AAAA;AAAA;;mBAApB,yB;AAAqB,W;;;;;;;2BAArBA,oB,EAAoB;cAHhC,OAAAH,SAGgC;eAHtB;AACPC,kBAAQ,EAAE;AADH,S;AAGsB,Q;;;;;;gBAK5B,OAAA6S,Y;iBAAa,O,EAAS,CAAC,QAAD,C;;;;;;;;;;;;;;;;;;;;;;;;ACd3B;AAAA;AAAA;;;;;;QAKaC,W;;;;;;;kCAECxM,K,EAAmD;AAAA,cAApCyM,IAAoC,uEAArB,GAAqB;AAAA,cAAhBC,EAAgB,uEAAH,GAAG;AACzD,iBAAO,CAAC1M,KAAK,IAAG,EAAT,EAAalB,KAAb,CAAmB2N,IAAnB,EAAyBtG,IAAzB,CAA8BuG,EAA9B,CAAP;AACH;;;;;;AAPL;;;uBAGaF,W;AAAW,K;;;;YAAXA,W;AAAW;;;;;2BAAXA,W,EAAW;cAHvB,OAAAG,IAGuB;eAHlB;AACJ9T,cAAI,EAAE;AADF,S;AAGkB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;ACLxB;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACFA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AAKa,YAAA+T,oBAAA,GAAuB,UAAC/U,KAAD;AAAA,aAAiCA,KAAK,CAACgV,QAAvC;AAAA,KAAvB;;AAEA,YAAAC,qBAAA,GAAwB,QAAAC,YAAA,CAAa,qCAAb,EAAoD,QAAAC,KAAA,EAApD,CAAxB;AAEA,YAAAC,2BAAA,GAA8B,kBAAAC,mBAAA,CAA6E,kBAA7E,EAAiG,UAAjG,CAA9B;AAEA,YAAAC,2BAAA,GAA8B,kBAAAD,mBAAA,CAA6E,kBAA7E,EAAiG,UAAjG,CAA9B;AAEA,YAAAE,uBAAA,GAA0B,kBAAAF,mBAAA,CAA6E,cAA7E,EAA6F,MAA7F,CAA1B;AAEA,YAAAG,4BAAA,GAA+B,kBAAAH,mBAAA,CAA6E,mBAA7E,EAAkG,WAAlG,CAA/B;AAEA,YAAAI,sBAAA,GAAyB,kBAAAJ,mBAAA,CAA6E,aAA7E,EAA4F,aAA5F,CAAzB;AAEA,YAAAK,uBAAA,GAA0B,QAAAR,YAAA,CAAa,kCAAb,CAA1B;;;;;;;;;;;;;;;;;;;;;;;;AC7Bb;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AAIA;AAAA;AAAA;;;;;;;;;;;;;;QAGaS,e,GACT,yBAAoBC,OAApB,EACoBC,cADpB,EAC8D;AAAA;;AAAA;;AAD1C,WAAAD,OAAA,GAAAA,OAAA;AACA,WAAAC,cAAA,GAAAA,cAAA;AAIb,WAAAC,2CAAA,GAA8C,KAAKF,OAAL,CAAaG,IAAb,CACjD,UAAAC,MAAA,CAAO,mBAAAf,qBAAP,CADiD,EAEjD,YAAAgB,QAAA,CAAS,UAACC,MAAD,EAAiD;AACtD,YAAMjR,IAAI,GAAG,IAAI,UAAAkR,MAAJ,CAAW;AAAClR,cAAI,EAAEiR,MAAM,CAACtB;AAAd,SAAX,CAAb;AACA,YAAMwB,mBAAmB,GAAG;AACxBC,eAAK,EAAEH,MAAM,CAACG,KADU;AAExBC,oBAAU,EAAE,IAFY;AAGxBC,eAAK,EAAE,CAHiB;AAIxB5N,gBAAM,EAAEuN,MAAM,CAACvN,MAJS;AAKxB6N,wBAAc,EAAE,KALQ;AAMxBrJ,cAAI,EAAE,iBANkB;AAOxBT,iBAAO,EAAE;AACL+J,qBAAS,cAAOxR,IAAI,CAACyR,aAAL,CAAmB;AAAEhR,qBAAO,EAAE;AAAX,aAAnB,EAAmCiR,OAA1C;AADJ,WAPe;AAUxBC,uBAAa,EAAE;AAVS,SAA5B;AAYA,YAAMC,eAAe,GAAG;AACpBR,eAAK,EAAEH,MAAM,CAACG,KADM;AAEpBC,oBAAU,EAAE,IAFQ;AAGpBC,eAAK,EAAE,CAHa;AAIpB5N,gBAAM,EAAEuN,MAAM,CAACvN,MAJK;AAKpB6N,wBAAc,EAAE,KALI;AAMpBrJ,cAAI,EAAE,iBANc;AAOpBT,iBAAO,EAAE;AACL+J,qBAAS,cAAOxR,IAAI,CAAC0R,OAAZ;AADJ,WAPW;AAUpBC,uBAAa,EAAE;AAVK,SAAxB;AAYA,YAAME,WAAW,GAAG;AAChBT,eAAK,EAAEH,MAAM,CAACG,KADE;AAEhBC,oBAAU,EAAE,IAFI;AAGhBC,eAAK,EAAE,CAHS;AAIhB5N,gBAAM,EAAEuN,MAAM,CAACvN,MAJC;AAKhB6N,wBAAc,EAAE,KALA;AAMhBrJ,cAAI,EAAE,kBANU;AAOhBT,iBAAO,EAAE;AACLqK,uBAAW,aAAM9R,IAAI,CAACyR,aAAL,CAAmB;AAAEpK,mBAAK,EAAE;AAAT,aAAnB,EAAkCqK,OAAxC,CADN;AAELF,qBAAS,aAAMxR,IAAI,CAAC0R,OAAX;AAFJ,WAPO;AAWhBC,uBAAa,EAAE;AAXC,SAApB;AAaA,YAAMI,gBAAgB,GAAG;AACrBX,eAAK,EAAEH,MAAM,CAACG,KADO;AAErBC,oBAAU,EAAE,IAFS;AAGrBC,eAAK,EAAE,CAHc;AAIrB5N,gBAAM,EAAEuN,MAAM,CAACvN,MAJM;AAKrB6N,wBAAc,EAAE,IALK;AAMrBrJ,cAAI,EAAE,kBANe;AAOrBT,iBAAO,EAAE;AACLqK,uBAAW,aAAM9R,IAAI,CAACyR,aAAL,CAAmB;AAAEpK,mBAAK,EAAE;AAAT,aAAnB,EAAkCqK,OAAxC;AADN,WAPY;AAUrBC,uBAAa,EAAE;AAVM,SAAzB;AAYA,YAAMK,WAAW,GAAG;AAChBZ,eAAK,EAAEH,MAAM,CAACG,KADE;AAEhBa,YAAE,EAAEhB,MAAM,CAACgB,EAFK;AAGhBZ,oBAAU,EAAE,IAHI;AAIhBC,eAAK,EAAE,CAJS;AAKhBK,uBAAa,EAAE;AALC,SAApB;AAQA,YAAMO,OAAO,GAAG,EAAhB;;AACA,gBAAOjB,MAAM,CAACkB,MAAd;AACI,eAAK,UAAL;AACID,mBAAO,CAACrK,IAAR,CAAa,mBAAAwI,2BAAA,CAA4B+B,OAA5B,CAAoCR,eAApC,CAAb;AACA;;AACJ,eAAK,MAAL;AACIM,mBAAO,CAACrK,IAAR,CAAa,mBAAAyI,uBAAA,CAAwB8B,OAAxB,CAAgCP,WAAhC,CAAb;AACA;;AACJ,eAAK,WAAL;AACIK,mBAAO,CAACrK,IAAR,CAAa,mBAAA0I,4BAAA,CAA6B6B,OAA7B,CAAqCL,gBAArC,CAAb;AACA;;AACJ,eAAK,aAAL;AACIG,mBAAO,CAACrK,IAAR,CAAa,mBAAA2I,sBAAA,CAAuB4B,OAAvB,CAA+BJ,WAA/B,CAAb;AACA;;AACJ,eAAK,UAAL;AACIE,mBAAO,CAACrK,IAAR,CAAa,mBAAAsI,2BAAA,CAA4BiC,OAA5B,CAAoCjB,mBAApC,CAAb;AACAe,mBAAO,CAACrK,IAAR,CAAa,mBAAAyI,uBAAA,CAAwB8B,OAAxB,CAAgCP,WAAhC,CAAb;AACA;;AACJ;AAjBJ;;AAmBA,eAAOK,OAAP;AACH,OAhFD,CAFiD,CAA9C;AAsFA,WAAAG,iCAAA,GAAoC,UAAAC,mBAAA,CAAoB,KAAK3B,OAAzB,EAAkC,mBAAAR,2BAAlC,EACvC,UAACc,MAAD,EAAY;AAAD;;AAAC,qBAAI,CAACL,cAAL,CAAoB2B,YAApB,CAAiCtB,MAAjC,qBAAqD,OAAAA,MAAM,CAACxJ,OAAP,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAEqK,WAAhB,KAA+B,EAApF,SAAyF,OAAAb,MAAM,CAACxJ,OAAP,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAE+J,SAAhB,KAA6B,EAAtH;AAA2H,OADhG,CAApC;AAIA,WAAAgB,iCAAA,GAAoC,UAAAF,mBAAA,CAAoB,KAAK3B,OAAzB,EAAkC,mBAAAN,2BAAlC,EACvC,UAACY,MAAD,EAAY;AAAD;;AAAC,qBAAI,CAACL,cAAL,CAAoB2B,YAApB,CAAiCtB,MAAjC,qBAAqD,OAAAA,MAAM,CAACxJ,OAAP,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAEqK,WAAhB,KAA+B,EAApF,SAAyF,OAAAb,MAAM,CAACxJ,OAAP,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAE+J,SAAhB,KAA6B,EAAtH;AAA2H,OADhG,CAApC;AAIA,WAAAiB,6BAAA,GAAgC,UAAAH,mBAAA,CAAoB,KAAK3B,OAAzB,EAAkC,mBAAAL,uBAAlC,EACnC,UAACW,MAAD,EAAW;AAAA;;AACP,qBAAI,CAACL,cAAL,CAAoB2B,YAApB,CAAiCtB,MAAjC,iBAAiD,OAAAA,MAAM,CAACxJ,OAAP,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAEqK,WAAhB,KAA+B,EAAhF,SAAqF,OAAAb,MAAM,CAACxJ,OAAP,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAE+J,SAAhB,KAA6B,EAAlH;AAAuH,OAFxF,CAAhC;AAKA,WAAAkB,kCAAA,GAAqC,UAAAJ,mBAAA,CAAoB,KAAK3B,OAAzB,EAAkC,mBAAAJ,4BAAlC,EACxC,UAACU,MAAD,EAAW;AAAA;;AACP,qBAAI,CAACL,cAAL,CAAoB2B,YAApB,CAAiCtB,MAAjC,sBAAsD,OAAAA,MAAM,CAACxJ,OAAP,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAEqK,WAAhB,KAA+B,EAArF,SAA0F,OAAAb,MAAM,CAACxJ,OAAP,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAE+J,SAAhB,KAA6B,EAAvH;AAA4H,OAFxF,CAArC;AAKA,WAAAmB,4BAAA,GAA+B,UAAAL,mBAAA,CAAoB,KAAK3B,OAAzB,EAAkC,mBAAAH,sBAAlC,EAClC,UAACS,MAAD;AAAA,eACI,MAAI,CAACL,cAAL,CAAoB2B,YAApB,CAAiCtB,MAAjC,wBAAwDA,MAAM,CAACgB,EAA/D,EADJ;AAAA,OADkC,CAA/B;AA3GN,K;;;uBAHQvB,e,EAAe,uB,EAAA,wC;AAAA,K;;;aAAfA,e;AAAe,eAAfA,eAAe;;;AAMxB,wBADC,UAAAkC,MAAA,EACD,E,yCAAA,G,yBAAA,E,6CAAA,E,MAAA;;AAsFA,wBADC,UAAAA,MAAA,EACD,E,yCAAA,G,yBAAA,E,mCAAA,E,MAAA;;AAIA,wBADC,UAAAA,MAAA,EACD,E,yCAAA,G,yBAAA,E,mCAAA,E,MAAA;;AAIA,wBADC,UAAAA,MAAA,EACD,E,yCAAA,G,yBAAA,E,+BAAA,E,MAAA;;AAKA,wBADC,UAAAA,MAAA,EACD,E,yCAAA,G,yBAAA,E,oCAAA,E,MAAA;;AAKA,wBADC,UAAAA,MAAA,EACD,E,yCAAA,G,yBAAA,E,8BAAA,E,MAAA;;AA/GJ;;;;2BACalC,e,EAAe;cAD3B,OAAAmC;AAC2B,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7B5B;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;QASaC,c;;;;AAPb;;YAOaA;;;;yBAAAA,c;AAAc,O;AAAA,gBANd,CACL,SAAA7X,YADK,EAEL,UAAA8X,aAAA,CAAcC,UAAd,CAAyB,CAAC,mBAAAtC,eAAD,CAAzB,CAFK,EAGL,QAAAuC,WAAA,CAAYD,UAAZ,CAAuB,UAAvB,EAAmC,mBAAAE,eAAnC,CAHK,CAMc;;;;+EAAdJ,c,EAAc;AAAA,kBALnB,SAAA7X,YAKmB,EALP,uBAKO,EALP,qBAKO;AAAA,O;AALP,K;;;;;2BAKP6X,c,EAAc;cAP1B,OAAA5X,QAO0B;eAPjB;AACNC,iBAAO,EAAE,CACL,SAAAF,YADK,EAEL,UAAA8X,aAAA,CAAcC,UAAd,CAAyB,CAAC,mBAAAtC,eAAD,CAAzB,CAFK,EAGL,QAAAuC,WAAA,CAAYD,UAAZ,CAAuB,UAAvB,EAAmC,mBAAAE,eAAnC,CAHK;AADH,S;AAOiB,Q;;;;;;;;;;;;;;;;;;;;;;ACd3B;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAUa,YAAAC,oBAAA,GAAwC;AACjDC,WAAK,EAAE,UAAAC,YAAA,CAAaC,KAAb,EAD0C;AAEjDC,cAAQ,EAAE,UAAAF,YAAA,CAAaC,KAAb,EAFuC;AAGjDE,cAAQ,EAAE,UAAAH,YAAA,CAAaC,KAAb,EAHuC;AAIjDG,UAAI,EAAE,UAAAJ,YAAA,CAAaC,KAAb,EAJ2C;AAKjDI,eAAS,EAAE,UAAAL,YAAA,CAAaC,KAAb,EALsC;AAMjDK,iBAAW,EAAE,UAAAN,YAAA,CAAaC,KAAb;AANoC,KAAxC;AASA,YAAAJ,eAAA,GAAkB,QAAAU,aAAA,iBAAc,QAAAT,oBAAd,EAC3B,QAAAU,EAAA,CAAG,mBAAApD,uBAAH,EAA4B,UAAC1V,KAAD;AAAA,aAA6B,MAAD,OAAC,CAAD,kBACjDA,KADiD,CAAC,EAC7C;AACR4Y,mBAAW,EAAE,UAAAN,YAAA,CAAaC,KAAb;AADL,OAD6C,CAA7B;AAAA,KAA5B,CAD2B,4BAKxB,mBAAAnD,2BAAA,CAA4B2D,GALJ,sBAMxB,mBAAAzD,2BAAA,CAA4ByD,GANJ,sBAOxB,mBAAAxD,uBAAA,CAAwBwD,GAPA,sBAQxB,mBAAAvD,4BAAA,CAA6BuD,GARL,sBASxB,mBAAAtD,sBAAA,CAAuBsD,GATC,GAAlB;AAcI,YAAAC,uBAAA,GAA4C;AACrDC,uBAAiB,EAAE;AADkC,KAA5C;AAIA,YAAAC,kBAAA,GAAqB,QAAAL,aAAA,CAAc,QAAAG,uBAAd,EAC9B,QAAAF,EAAA,CAAG,cAAAK,oBAAH,EAAyB,UAACnZ,KAAD,EAA0BkW,MAA1B,EAAqC;AAC1D,aAAO,gCACAlW,KADA,GACK;AACRoZ,kBAAU,EAAE,MAAF,OAAE,CAAF,kBACHpZ,KAAK,CAACoZ,UADH,CAAE,EAELlD,MAAM,CAACmD,OAFF;AADJ,OADL,CAAP;AAOH,KARD,CAD8B,EAU9B,QAAAP,EAAA,CAAG,cAAAQ,oBAAH,EAAyB,UAAAtZ,KAAK;AAAA,aAAK,MAAD,OAAC,CAAD,kBAC3BA,KAD2B,CAAC,EACvB;AACRoZ,kBAAU,EAAElS;AADJ,OADuB,CAAL;AAAA,KAA9B,CAV8B,EAc9B,QAAA4R,EAAA,CAAG,cAAAS,iBAAH,EAAsB,UAAAvZ,KAAK;AAAA,aAAK,MAAD,OAAC,CAAD,kBACxBA,KADwB,CAAC,EACpB;AACRwZ,wBAAgB,EAAE,IAAI3U,IAAJ;AADV,OADoB,CAAL;AAAA,KAA3B,CAd8B,EAkB9B,QAAAiU,EAAA,CAAG,cAAAW,gBAAH,EAAqB,UAACzZ,KAAD,EAA0BkW,MAA1B,EAAqC;AACtD,aAAO,gCACAlW,KADA,GACK;AACRiZ,yBAAiB,EAAE/C,MAAM,CAACmD;AADlB,OADL,CAAP;AAIH,KALD,CAlB8B,EAwB9B,QAAAP,EAAA,CAAG,cAAAY,gBAAH,EAAqB,UAAC1Z,KAAD;AAAA,aAA8B,MAAD,OAAC,CAAD,kBAC3CA,KAD2C,CAAC,EACvC;AACRiZ,yBAAiB,EAAE,QAAAD,uBAAA,CAAwBC;AADnC,OADuC,CAA9B;AAAA,KAArB,CAxB8B,CAArB;;;;;;;;;;;;;;;;;;;;ACjDJ,YAAAU,wBAAA,GAA2B,UAACC,OAAD;AAAA,aAA0CA,OAAO,GAAI;AACzFzR,aAAK,EAAEyR,OAAO,CAAC1C,EAD0E;AAEzFhG,eAAO,EAAE0I,OAAO,CAAC5Y;AAFwE,OAAJ,GAGpFkG,SAHmC;AAAA,KAA3B;;;;;;;;;;;;;;;;;;;;;;;;;ACHb;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACHA;AAAA;AAAA;;AAaA;AAAA;AAAA;;AAMa,YAAA2S,aAAA,GAAgB,kBAAAxE,mBAAA,CAA6D,WAA7D,EAA0E,MAA1E,CAAhB;;AAEA,YAAAyE,qBAAA,GAAwB,UAAC9Z,KAAD;AAAA,aAA+BA,KAAK,CAAC+Z,SAArC;AAAA,KAAxB;;AAEA,YAAAC,0BAAA,GAA6B,QAAAC,cAAA,CAAe,QAAAH,qBAAf,EAAsC,QAAAD,aAAA,CAAcK,SAAd,CAAwBC,eAA9D,CAA7B;AAEb;;;;AAGa,YAAAC,kCAAA,GAAqC,QAAAH,cAAA,CAAe,QAAAJ,aAAA,CAAcK,SAAd,CAAwBC,eAAvC,EAAwD,UAACE,OAAD,EAAa;AACnH,UAAIA,OAAJ,EAAa;AACT,YAAMC,MAAM,GAAG,IAAIC,GAAJ,EAAf;AACAF,eAAO,CAAChX,OAAR,CAAgB,UAAAmX,CAAC,EAAI;AACjB,cAAMC,KAAK,GAAGzI,KAAK,CAAC4C,IAAN,CAAW0F,MAAM,CAACzP,IAAP,EAAX,EAA0BpC,IAA1B,CAA+B,UAAAsL,CAAC;AAAA,mBAAIA,CAAC,CAAC/S,IAAF,KAAWwZ,CAAC,CAACE,IAAjB;AAAA,WAAhC,CAAd;AACA,cAAIvX,IAAI,GAAGsX,KAAK,GAAGH,MAAM,CAACK,GAAP,CAAWF,KAAX,CAAH,GAAuBvT,SAAvC;;AACA,cAAI,CAAC/D,IAAL,EAAW;AACPA,gBAAI,GAAG,EAAP;AACAmX,kBAAM,CAAC1V,GAAP,CAAW;AACP5D,kBAAI,EAAEwZ,CAAC,CAACE,IADD;AAEP7Q,sBAAQ,EAAE2Q,CAAC,CAAC3Q;AAFL,aAAX,EAGG1G,IAHH;AAIH;;AACDA,cAAI,CAAC2J,IAAL,CAAU0N,CAAV;AACH,SAXD;AAYA,eAAOF,MAAP;AACH;;AACD,aAAO,IAAIC,GAAJ,EAAP;AACH,KAlBiD,CAArC;AAoBA,YAAAK,mBAAA,GAAsB,QAAAX,cAAA,CAAe,QAAAD,0BAAf,EAC/B,UAACD,SAAD,EAAYc,KAAZ,EAA8B;;;AAC1B,UAAId,SAAJ,EAAe;AACX,eAAO,CAAP,WAAOA,SAAS,CAACjP,GAAV,CAAc,UAAAuC,CAAC;AAAA,iBAAIA,CAAC,CAACyN,MAAF,CAASrS,IAAT,CAAc,UAACsS,CAAD;AAAA,mBAAsBA,CAAC,CAAC7D,EAAF,KAAS2D,KAA/B;AAAA,WAAd,CAAJ;AAAA,SAAf,CAAP,MAA8E,IAA9E,IAA8E,aAA9E,GAA8E,MAA9E,GAA8E,GACvE,CADuE,CAAvE,MACC,IADD,IACC,aADD,GACC,EADD,GACM3T,SADb;AAEH;;AACD,aAAOA,SAAP;AACH,KAP8B,CAAtB;;;;;;;;;;;;;;;;;;;;;;;;AChDb;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;QAIa8T,gB,GAEX,0BAAoBpF,OAApB,EACoBqF,mBADpB,EAC8D;AAAA;;AAAA;;AAD1C,WAAArF,OAAA,GAAAA,OAAA;AACA,WAAAqF,mBAAA,GAAAA,mBAAA;AAKb,WAAApB,aAAA,GAAgB,UAAAtC,mBAAA,CAAoB,KAAK3B,OAAzB,EAAkC,oBAAAiE,aAAlC,EACrB,UAAC3D,MAAD;AAAA,eAAY,MAAI,CAAC+E,mBAAL,CAAyBC,oBAAzB,CAA8ChF,MAA9C,CAAZ;AAAA,OADqB,CAAhB;AAIA,WAAAiF,qBAAA,GAAwB,KAAKvF,OAAL,CAAaG,IAAb,CAC7B,UAAAC,MAAA,CAAO,uBAAAoF,iBAAA,CAAkBf,OAAzB,CAD6B,EAE7B,YAAAvP,GAAA,CAAI,UAACoL,MAAD;AAAA,eAAkD,oBAAA2D,aAAA,CAAcxC,OAAd,CAAsBnB,MAAM,CAACmD,OAA7B,CAAlD;AAAA,OAAJ,CAF6B,CAAxB;AAPN,K;;;uBALU2B,gB,EAAgB,uB,EAAA,mC;AAAA,K;;;aAAhBA,gB;AAAgB,eAAhBA,gBAAgB;;;AAQ3B,wBADC,UAAAnD,MAAA,EACD,E,yCAAA,G,0BAAA,E,eAAA,E,MAAA;;AAIA,wBADC,UAAAA,MAAA,EACD,E,yCAAA,G,0BAAA,E,uBAAA,E,MAAA;;AAbF;;;;2BACamD,gB,EAAgB;cAD5B,OAAAlD;AAC4B,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrB7B;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;QAaauD,e;;;;AAVb;;YAUaA;;;;yBAAAA,e;AAAe,O;AAAA,gBARf,CACL,SAAAnb,YADK,EAEL,UAAA8X,aAAA,CAAcC,UAAd,CAAyB,CACrB,oBAAA+C,gBADqB,CAAzB,CAFK,EAKL,QAAA9C,WAAA,CAAYD,UAAZ,CAAuB,WAAvB,EAAoC,oBAAAqD,gBAApC,CALK,CAQe;;;;+EAAfD,e,EAAe;AAAA,kBAPpB,SAAAnb,YAOoB,EAPR,uBAOQ,EAPR,qBAOQ;AAAA,O;AAPR,K;;;;;2BAOPmb,e,EAAe;cAV3B,OAAAlb,QAU2B;eAVlB;AACN6B,sBAAY,EAAE,EADR;AAEN5B,iBAAO,EAAE,CACL,SAAAF,YADK,EAEL,UAAA8X,aAAA,CAAcC,UAAd,CAAyB,CACrB,oBAAA+C,gBADqB,CAAzB,CAFK,EAKL,QAAA9C,WAAA,CAAYD,UAAZ,CAAuB,WAAvB,EAAoC,oBAAAqD,gBAApC,CALK;AAFH,S;AAUkB,Q;;;;;;;;;;;;;;;;;;;;;;AClB5B;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAGa,YAAAC,oBAAA,GAAsC;AAC/CC,UAAI,EAAE,UAAAlD,YAAA,CAAaC,KAAb;AADyC,KAAtC;AAIA,YAAA+C,gBAAA,GAAmB,QAAAzC,aAAA,iBAAc,QAAA0C,oBAAd,4BACzB,oBAAA1B,aAAA,CAAcd,GADW,GAAnB;;;;;;;;;;;;;;;;;;;;;;;;ACTb;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;ACnBA;;;;;AAIA,aAAgB0C,aAAhB,CAA8B3Q,GAA9B,EAA4C;AAC1C,UAAIW,GAAG,GAAG,EAAV;;AACA,UAAIX,GAAJ,EAAS;AACP,aAAK,IAAMnK,GAAX,IAAkBmK,GAAlB,EAAuB;AACrB,cAAIA,GAAG,CAAClK,cAAJ,CAAmBD,GAAnB,KAA2BmK,GAAG,CAACnK,GAAD,CAAH,KAAauG,SAAxC,IAAqD4D,GAAG,CAACnK,GAAD,CAAH,KAAa,IAAtE,EAA4E;AAC1E8K,eAAG,cAAQA,GAAG,GAAG,GAAH,GAAS,EAApB,SAA0B9K,GAA1B,cAAiCmK,GAAG,CAACnK,GAAD,CAApC,CAAH;AACD;AACF;AACF;;AACD,aAAO8K,GAAP;AACD;;AAVD;;;;;;;;;;;;;;;;;;;;ACNA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAKA;AAAA;AAAA,6D,CAAuF;;;AACvF;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAGA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAgBaiQ,kB;;;;;AAST,kCACWC,KADX,EAEWC,SAFX,EAGYC,QAHZ,EAIYC,KAJZ,EAKYC,MALZ,EAMYC,SANZ,EAOYC,QAPZ,EAQYC,SARZ,EASYC,SATZ,EAUYC,YAVZ,EAU4C;AAAA;;AAAA;;AAExC;AAXO,eAAAT,KAAA,GAAAA,KAAA;AACA,eAAAC,SAAA,GAAAA,SAAA;AACC,eAAAC,QAAA,GAAAA,QAAA;AACA,eAAAC,KAAA,GAAAA,KAAA;AACA,eAAAC,MAAA,GAAAA,MAAA;AACA,eAAAC,SAAA,GAAAA,SAAA;AACA,eAAAC,QAAA,GAAAA,QAAA;AACA,eAAAC,SAAA,GAAAA,SAAA;AACA,eAAAC,SAAA,GAAAA,SAAA;AACA,eAAAC,YAAA,GAAAA,YAAA;AAlBZ;;AACU,eAAAC,SAAA,GAEN,EAFM;AAGV;;AACU,eAAAC,UAAA,GAAiD,EAAjD;;AAgBN,eAAK1X,GAAL,CAAS,QAAT,EAAmB,IAAnB;;AACA,eAAKA,GAAL,CAAS,OAAT,EAAkB,MAAlB;;AACA,eAAKA,GAAL,CAAS,SAAT,EAAoB,EAApB;;AACA,eAAKA,GAAL,CAAS,4BAAT,EAAuC,IAAvC;;AACA,eAAKA,GAAL,CAAS,MAAT,EAAiB,IAAI,OAAAlE,eAAJ,CAGP,IAHO,CAAjB;;AAKA,eAAKkE,GAAL,CAAS,eAAT,EAA0B,KAA1B;;AAEA,eAAKiX,QAAL,CAAcU,QAAd,CAAuBxG,IAAvB,CAA4B,YAAAyG,KAAA,CAAM,UAAAC,CAAC;AAAA,iBAAIA,CAAJ;AAAA,SAAP,CAA5B,EAA2CvZ,SAA3C,CAAqD,YAAM;AACvD,iBAAK4Y,KAAL,CAAWY,GAAX,CAAe,YAAM;AACjB,mBAAKzS,GAAL,CAAS,KAAT;;AACA,mBAAK0S,eAAL;AACH,WAHD;AAIH,SALD;;AAdwC;AAoB3C;;;;;AAoBD;;;;gCAIehc,G,EAAW;AACtB,iBAAO,KAAKqb,SAAL,CAAerB,GAAf,CAAmBha,GAAnB,CAAP;AACH;AAED;;;;;;;AA+BA;;;;;;;;+BASIuJ,I,EACA0S,O,EAOC;AAAA;;AAAA,cAND1G,MAMC,uEANgB,IAMhB;AAAA,cALD2G,SAKC;AAAA,cAJDC,IAIC,uEAJuB;AACpB5S,gBAAI,EAAE,MADc;AAEpB,qBAAO,gBAFa;AAGpB6S,mBAAO,EAAE;AAHW,WAIvB;;AAED,cAAMC,YAAY,GAAG,KAAKb,SAAL,CAAec,IAAf,CAAoBL,OAApB,EAA6B1G,MAA7B,EAAqC;AACtDgH,sBAAU,EAAE,CAAChT,IAAD,CAD0C;AAEtDlE,oBAAQ,EAAE;AAF4C,WAArC,CAArB;;AAIA,eAAKhD,YAAL,CACI,gBADJ,EAEIga,YAAY,CAACG,cAAb,GAA8Bja,SAA9B,CAAwC,YAAM;AAC1C,kBAAI,CAACnC,KAAL,CAAW,gBAAX;;AACA,kBAAI,CAACA,KAAL,CAAW,QAAX;AACH,WAHD,CAFJ;;AAOA,cAAImV,MAAJ,EAAY;AACR2G,qBAAS,GAAGA,SAAS,IAAK;AAAA,qBAAMG,YAAY,CAACI,OAAb,EAAN;AAAA,aAA1B;;AACA,iBAAKpa,YAAL,CACI,QADJ,EAEIga,YAAY,CAACK,QAAb,GAAwBna,SAAxB,CAAkC;AAAA,qBAAM2Z,SAAS,EAAf;AAAA,aAAlC,CAFJ;AAIH;AACJ;AAED;;;;;;;;;sCAMqB1S,G,EAAa+L,M,EAAiB2G,S,EAAsB;AACrE,cAAMC,IAAI,GAAoB;AAC1B5S,gBAAI,EAAE,MADoB;AAE1B,qBAAO,gBAFmB;AAG1B6S,mBAAO,EAAE;AAHiB,WAA9B;AAKA,eAAKO,MAAL,CAAY,SAAZ,EAAuBnT,GAAvB,EAA4B+L,MAA5B,EAAoC2G,SAApC,EAA+CC,IAA/C;AACH;AAED;;;;;;;;;oCAMmB3S,G,EAAa+L,M,EAAiB2G,S,EAAsB;AACnE,cAAMC,IAAI,GAAoB;AAC1B5S,gBAAI,EAAE,MADoB;AAE1B,qBAAO,gBAFmB;AAG1B6S,mBAAO,EAAE;AAHiB,WAA9B;AAKA,eAAKO,MAAL,CAAY,OAAZ,EAAqBnT,GAArB,EAA0B+L,MAA1B,EAAkC2G,SAAlC,EAA6CC,IAA7C;AACH;AAED;;;;;;;;;mCAMkB3S,G,EAAa+L,M,EAAiB2G,S,EAAsB;AAClE,cAAMC,IAAI,GAAoB;AAC1B5S,gBAAI,EAAE,MADoB;AAE1B,qBAAO,gBAFmB;AAG1B6S,mBAAO,EAAE;AAHiB,WAA9B;AAKA,eAAKO,MAAL,CAAY,MAAZ,EAAoBnT,GAApB,EAAyB+L,MAAzB,EAAiC2G,SAAjC,EAA4CC,IAA5C;AACH;AAED;;;;;;;;;mCAMkB3S,G,EAAa+L,M,EAAiB2G,S,EAAsB;AAClE,eAAKS,MAAL,CAAY,MAAZ,EAAoBnT,GAApB,EAAyB+L,MAAzB,EAAiC2G,SAAjC;AACH;AAED;;;;;;;;;;;4BASI3S,I,EACAC,G,EACAC,I,EAEsB;AAAA,cADtBC,MACsB,uEADE,OACF;AAAA,cAAtBC,KAAsB,uEAAL,KAAK;AAEtB,iBAAAL,GAAA,CAAIC,IAAJ,EAAUC,GAAV,EAAeC,IAAf,EAAqBC,MAArB,EAA6BC,KAA7B;AACH;AAED;;;;;;;4BAIoBtJ,I,EAAY;AAC5B,iBAAO,KAAKqb,SAAL,CAAerb,IAAf,KAAwB,KAAKqb,SAAL,CAAerb,IAAf,aAAgC,OAAAN,eAAxD,GACA,KAAK2b,SAAL,CAAerb,IAAf,EAA4CS,QAA5C,EADA,GAED,IAFN;AAGH;AAED;;;;;;;;+BAKuBT,I,EAAY;AAC/B,cAAI,CAAC,KAAKsb,UAAL,CAAgBtb,IAAhB,CAAL,EAA4B;AACxB,iBAAK4D,GAAL,CAAY5D,IAAZ,EAAkB,IAAlB;AACH;;AACD,iBAAO,KAAKsb,UAAL,CAAgBtb,IAAhB,CAAP;AACH;AAED;;;;;;;;4BAKoBA,I,EAAcmH,K,EAAQ;AACtC,cAAI,CAAC,KAAKkU,SAAL,CAAerb,IAAf,CAAL,EAA2B;AACvB,iBAAKqb,SAAL,CAAerb,IAAf,IAAuB,IAAI,OAAAN,eAAJ,CAAuByH,KAAvB,CAAvB;AACA,iBAAKmU,UAAL,CAAgBtb,IAAhB,IAAwB,KAAKqb,SAAL,CAAerb,IAAf,EAAqBuc,YAArB,EAAxB;AACH,WAHD,MAGO;AACH,iBAAKlB,SAAL,CAAerb,IAAf,EAAqBoS,IAArB,CAA0BjL,KAA1B;AACH;AACJ;AAED;;;;0CAC0B;AAAA;;AACtB;AACA,eAAK6T,SAAL,CAAewB,WAAf,CAA2BzH,IAA3B,CAAgC,YAAAyG,KAAA,CAAM,UAAAC,CAAC;AAAA,mBAAIA,CAAJ;AAAA,WAAP,CAAhC,EAA+CvZ,SAA/C,CAAyD;AAAA,mBAAM,OAAI,CAACua,IAAL,EAAN;AAAA,WAAzD;AACH;AAED;;;;;;+BAGY;AAAA;;AACR,eAAKC,aAAL;AACA,eAAK1a,YAAL,CAAkB,aAAlB,EAAiC,KAAK2Y,KAAL,CAAWgC,MAAX,CAAkB,eAAAC,iBAAlB,EAC5B7H,IAD4B,CACtB,YAAAlK,MAAA,CAAO,UAAAgS,IAAI;AAAA,mBAAIA,IAAI,KAAK3W,SAAb;AAAA,WAAX,CADsB,EAE5B6O,IAF4B,CAEvB,YAAA+H,IAAA,CAAK,CAAL,CAFuB,EAG5B5a,SAH4B,CAGlB,UAAC2a,IAAD,EAAe;AACtB;AACA,mBAAI,CAACE,cAAL,CAAoBF,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEG,IAA1B;AACH,WAN4B,CAAjC;;AAQA,eAAK9B,SAAL,CAAesB,WAAf,CAA2BzH,IAA3B,CAAgC,YAAAyG,KAAA,CAAM,UAAAC,CAAC;AAAA,mBAAIA,CAAJ;AAAA,WAAP,CAAhC,EAA+CvZ,SAA/C,CAAyD,YAAM;AAC3D,mBAAI,CAACzC,YAAL,CAAkB2S,IAAlB,CAAuB,IAAvB;AACH,WAFD,EAVQ,CAaR;;;AACA,cAAI5I,MAAM,CAACC,KAAX,EAAkB;AACdD,kBAAM,CAACyT,WAAP,GAAqB,IAArB;AACH;AACJ;AAED;;;;;;wCAGqB;AACjB,eAAKhU,GAAL,CAAS,QAAT,EAAmB,sBAAnB;AACA,cAAMiU,OAAO,GAA4B,KAAKvD,GAAL,CAAS,SAAT,CAAzC;AACAuD,iBAAO,CAACC,QAAR,GAAmB;AACfvB,mBAAO,EAAE,iCADM;AAEf5c,iBAAK,EAAE;AAFQ,WAAnB;AAIA,eAAK4E,GAAL,CAAS,SAAT,EAAoBsZ,OAApB,EAPiB,CAQjB;;AACA,cAAME,QAAQ,GAAqB,KAAKpC,SAAL,CAAerB,GAAf,CAAmB,UAAnB,KAAkC,EAArE;AACA,cAAM0D,QAAQ,GAAGD,QAAQ,CAACC,QAAT,IAAqBC,QAAQ,CAACD,QAA/C;AACA,cAAME,IAAI,GAAGH,QAAQ,CAACI,MAAT,IAAmBF,QAAQ,CAACG,QAAzC;AACA,cAAMC,IAAI,GAAGN,QAAQ,CAACM,IAAT,IAAiBJ,QAAQ,CAACI,IAAvC;AACA,cAAMC,GAAG,GAAGP,QAAQ,CAACQ,UAAT,aAAyBP,QAAzB,eAAsCE,IAAtC,cAA8CG,IAA9C,IAAuDJ,QAAQ,CAACO,MAA5E;AACA,cAAMC,KAAK,GAAGP,IAAI,CAACQ,QAAL,CAAc,WAAd,KAA8BL,IAAI,KAAK,MAAvC,GAAgD,EAAhD,GAAqDN,QAAQ,CAACU,KAAT,IAAkB,EAArF;AACA,cAAME,IAAI,GACN,KAAKhD,SAAL,CAAerB,GAAf,CAAmB,MAAnB,KACA2D,QAAQ,CAACW,IAAT,CAAcF,QAAd,CAAuB,WAAvB,CADA,IAEAG,YAAY,CAACC,OAAb,CAAqB,MAArB,MAAiC,MAHrC,CAfiB,CAmBjB;;AACA,cAAMC,MAAM,GAAmB;AAC3BC,iBAAK,EAAE,QADoB;AAE3Bd,gBAAI,YAAKA,IAAL,cAAaG,IAAb,CAFuB;AAG3BY,oBAAQ,YAAKX,GAAL,0BAHmB;AAI3BY,qBAAS,YAAKZ,GAAL,gBAJkB;AAK3Ba,wBAAY,YAAKlB,QAAQ,CAACO,MAAd,SAAuBC,KAAvB,qBALe;AAM3BW,wBAAY,EAAE,CAACrB,QAAQ,CAACsB,WANG;AAO3BV,gBAAI,EAAJA;AAP2B,WAA/B;;AASA,eAAK9C,SAAL,CAAeyD,KAAf,CAAqBP,MAArB;;AACAlB,iBAAO,CAACC,QAAR,GAAmB;AACfvB,mBAAO,EAAE,iCADM;AAEf5c,iBAAK,EAAE;AAFQ,WAAnB;AAIA,eAAK4E,GAAL,CAAS,SAAT,EAAoBsZ,OAApB;AACH;;;uCAEsBF,I,EAAc;;;AACjC,eAAK/T,GAAL,CAAS,MAAT,yBAAiC,WAAKmS,YAAL,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEwD,UAApD,GADiC,CAEjC;;AACA,cAAMC,MAAM,GAAG,KAAK7D,SAAL,CAAerB,GAAf,CAAmB,aAAnB,CAAf;;AACA,cAAI,CAAJ,KAAI,KAAKyB,YAAL,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEwD,UAAvB,EAAmC;AAC/B;AACAC,kBAAM,CAACC,MAAP,GAAgB,KAAK1D,YAAL,CAAkBwD,UAAlC;AACH;;AACD,cAAIC,MAAJ,EAAY;AACR,iBAAKjE,SAAL,CAAemE,IAAf,CAAoBF,MAApB;;AACA,gBAAI7B,IAAJ,EAAU;AACN,mBAAKpC,SAAL,CAAeoE,QAAf,CAAwBhC,IAAxB;AACH;AACJ,WALD,MAKO;AACH,iBAAK/T,GAAL,CAAS,MAAT,6DAAqE,KAAK+R,SAAL,CAAeiE,QAApF;AACH;AACJ;;;0BAjS0BC,I,EAAe;AACtC,eAAKC,gBAAL,GAAwBD,IAAxB;AACH,S;4BAEyB;AACtB,iBAAO,KAAKC,gBAAZ;AACH;AAED;;;;4BACuB;AACnB,iBAAO,EAAP;AACH;AAED;;;;4BACqB;AACjB,iBAAO,KAAKlE,QAAZ;AACH;;;0BAagB9T,K,EAAe;AAC5B,cAAMiY,YAAY,GAAG,KAAKC,OAAL,CAAa,WAAb,CAArB;AACA,eAAKzb,GAAL,CAAS,OAAT,EAAkBuD,KAAlB;;AACA,eAAK4T,MAAL,CAAYuE,QAAZ,WAAwBnY,KAAK,GAAGA,KAAK,GAAG,KAAX,GAAmB,EAAhD,SAAqDiY,YAArD;AACH;AAED;;;;4BAGgB;AACZ,iBAAO,KAAKrE,MAAL,CAAYwE,QAAZ,EAAP;AACH;AAED;;;;4BACsB;AAClB;AACH;AAED;;;;4BAC6B;AACzB,iBAAO,KAAKrE,SAAL,CAAesE,IAAf,CAAoBC,YAApB,GAAmC,GAA1C;AACH;AAED;;;;4BACuB;AACnB,iBAAO,KAAKzE,SAAL,CAAe0E,cAAtB;AACH;;;;MAhGmC,OAAArgB,S;;AAHxC;;;uBAGaqb,kB,EAAkB,qB,EAAA,6B,EAAA,8B,EAAA,sB,EAAA,qB,EAAA,+B,EAAA,8B,EAAA,+B,EAAA,2B,EAAA,kC;AAAA,K;;;aAAlBA,kB;AAAkB,eAAlBA,kBAAkB,K;AAAA,kBAFf;;;;;2BAEHA,kB,EAAkB;cAH9B,OAAA5D,UAG8B;eAHnB;AACR6I,oBAAU,EAAE;AADJ,S;AAGmB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvD/B;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAIA;AAAA;AAAA;;QAaaC,a;;;;;AAmBX,6BAAYC,QAAZ,EAA+B;AAAA;;AAAA;;AAC7B;AAnBF;;AACmB,gBAAAC,aAAA,GAAgB,IAAI,OAAAC,OAAJ,EAAhB;AACnB;;AACgB,gBAAAC,MAAA,GAAS,QAAKF,aAAL,CAAmBvD,YAAnB,EAAT;AAOhB;;AACU,gBAAA0D,aAAA,GAAiC,EAAjC;AASR,gBAAK/J,EAAL,GAAU2J,QAAQ,CAAC3J,EAAT,IAAe2J,QAAQ,CAACK,OAAxB,IAAmCL,QAAQ,CAACxK,KAA5C,IAAqD,EAA/D;AACA,gBAAKrV,IAAL,GAAY6f,QAAQ,CAAC7f,IAAT,IAAiB,EAA7B;AACA,gBAAKqV,KAAL,GAAa,UAAGwK,QAAQ,CAACxK,KAAT,IAAkB,EAArB,EAA0B1J,WAA1B,EAAb;AAJ6B;AAK9B;AAVD;;;;;;AAYA;;;+BAGW;AAAA;;AACT,cAAI,KAAKwU,QAAT,EAAmB;AACjB,gBAAMC,IAAI,GAAG,KAAKC,MAAL,EAAb;AACA,mBAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,kBAAMC,OAAO,GAAG,OAAI,CAACvK,EAAL,GACZ,OAAI,CAACiK,QAAL,CAAcO,MAAd,CAAqB,OAAI,CAACxK,EAA1B,EAA8BkK,IAA9B,CADY,GAEZ,OAAI,CAACD,QAAL,CAAc7Y,GAAd,CAAkB8Y,IAAlB,CAFJ;AAGAK,qBAAO,CAACE,IAAR,CACE,UAACvb,CAAD,EAAO;AACL,uBAAI,CAAC0a,aAAL,CAAmB1N,IAAnB,CAAwB;AAAElJ,sBAAI,EAAE,YAAR;AAAsB0X,0BAAQ,EAAExb;AAAhC,iBAAxB;;AACAmb,uBAAO,CAACnb,CAAD,CAAP;AACD,eAJH,EAKE,UAACqW,CAAD;AAAA,uBAAO+E,MAAM,CAAC/E,CAAD,CAAb;AAAA,eALF;AAOD,aAXM,CAAP;AAYD,WAdD,MAcO;AACL6E,mBAAO,CAACE,MAAR,CAAe,+BAAf;AACD;AACF;AAED;;;;;;kCAGa;AACX,cAAI,KAAKtK,EAAT,EAAa;AACX,mBAAO,KAAKiK,QAAL,WAAqB,KAAKjK,EAA1B,CAAP;AACD;AACF;AAED;;;;;;;;gCAKe2K,S,EAAmBC,U,EAAmB;AACnD,cAAI,KAAK5K,EAAT,EAAa;AACX,mBAAO,KAAKiK,QAAL,CAAcY,IAAd,CAAmB,KAAK7K,EAAxB,EAA4B2K,SAA5B,EAAuCC,UAAvC,CAAP;AACD;AACF;AAED;;;;;;iCAGa;AACX,cAAME,GAAG,qBAAa,IAAb,CAAT,CADW,CAEX;;AACA,iBAAOA,GAAG,CAACb,QAAX;AACA,iBAAOa,GAAG,CAACC,QAAX;AACA,iBAAOD,GAAG,CAAClB,aAAX;AACA,iBAAOkB,GAAG,CAAChB,MAAX,CANW,CAOX;;AACA,iBAAOgB,GAAG,CAAC1hB,OAAX;AACA,iBAAO0hB,GAAG,CAACzhB,UAAX;AACA,iBAAOyhB,GAAG,CAACxhB,cAAX;AACA,iBAAOwhB,GAAG,CAACf,aAAX;AACA,iBAAOe,GAAG,CAACvhB,YAAX,CAZW,CAaX;;AACA,cAAMoK,IAAI,GAAGoH,MAAM,CAACpH,IAAP,CAAYmX,GAAZ,CAAb;;AACA,mCAAkBnX,IAAlB,2BAAwB;AAAnB,gBAAMlK,GAAG,YAAT;;AACH,gBAAIA,GAAG,CAAC,CAAD,CAAH,KAAW,GAAf,EAAoB;AAClB,kBAAMuhB,OAAO,GAAG,KAAKjB,aAAL,CAAmBtgB,GAAG,CAAC2R,SAAJ,CAAc,CAAd,CAAnB,KAAwC3R,GAAG,CAAC2R,SAAJ,CAAc,CAAd,CAAxD;AACA0P,iBAAG,CAACE,OAAD,CAAH,GAAeF,GAAG,CAACrhB,GAAD,CAAlB;AACA,qBAAOqhB,GAAG,CAACrhB,GAAD,CAAV;AACD,aAJD,MAIO,IAAIqhB,GAAG,CAACrhB,GAAD,CAAH,KAAauG,SAAjB,EAA4B;AACjC,qBAAO8a,GAAG,CAACrhB,GAAD,CAAV;AACD;AACF;;AACD,iBAAOqhB,GAAP;AACD;AAED;;;;;;gCAGY;AACV,iBAAO,IAAIpB,aAAJ,CAAkB,IAAlB,CAAP;AACD;AAED;;;;;;oCAGgB;AACd,iBAAO,IAAIA,aAAJ,CAAkB,MAAD,OAAC,CAAD,kBAAM,IAAN,CAAC,EAAS;AAAE1J,cAAE,EAAE,IAAN;AAAYb,iBAAK,EAAE;AAAnB,WAAT,CAAlB,CAAP;AACD;;;4BAhGqB;AACpB,iBAAO,wBAAA8L,cAAA,CAAeC,UAAf,CAA0BxB,aAA1B,CAAP;AACD;;;;MAjBgC,OAAAvgB,S;;AAAnC;;;;;;;;;;;;;;;;;;;;;;;;AClBA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;QAOagiB,c;;;;;AAyBX,8BAAsBnG,SAAtB,EACsBoG,eADtB,EACwD;AAAA;;AAAA;;AACtD;AAFoB,gBAAApG,SAAA,GAAAA,SAAA;AACA,gBAAAoG,eAAA,GAAAA,eAAA;AAnBtB;;AACU,gBAAAjG,SAAA,GAAoE,EAApE;AACV;;AACU,gBAAAC,UAAA,GAAiD,EAAjD;AACV;;AACU,gBAAAiG,YAAA,GAAmD,EAAnD;AACV;;AACU,gBAAAC,SAAA,GAA6C,EAA7C;AACV;;AACU,gBAAAC,QAAA,GAAoC,UAACrV,CAAD,EAAIC,CAAJ;AAAA,iBAC5CD,CAAC,KAAKC,CAAN,IAAYD,CAAS,CAAC8J,EAAV,KAAkB7J,CAAS,CAAC6J,EADI;AAAA,SAApC;AAEV;;;AACU,gBAAAwL,YAAA,GAAkC,UAACtV,CAAD;AAAA,iBAAO,CAAC,CAACA,CAAT;AAAA,SAAlC;;AASR,gBAAKuV,KAAL,GAAa,MAAb;AACA,gBAAKC,UAAL,GAAkB,MAAlB;;AACA,gBAAKhe,GAAL,CAAS,MAAT,EAAiB,EAAjB;;AAJsD;AAKvD;AAVD;;;;;;AAYA;;;wCAGwBie,S,EAAoB;AACxC;AACA;AACA,cAAI,KAAKP,eAAL,CAAqBQ,SAAzB,EAAoC;AAChC,mBAAO,MAAP,OAAO,CAAP,kBAAYD,SAAZ,CAAO,EAAc;AAAEC,uBAAS,EAAE;AAAb,aAAd,CAAP;AACH;;AACD,iBAAOD,SAAP;AACH;AAED;;;;;;+BAGc;AAAA;;AACZ,eAAK9C,IAAL,GAAY4B,IAAZ,CACE,UAAClF,CAAD;AAAA,mBAAO,OAAI,CAAChc,YAAL,CAAkB2S,IAAlB,CAAuB,IAAvB,CAAP;AAAA,WADF,EAEE,UAAC2P,GAAD;AAAA,mBAAS,OAAI,CAACnf,OAAL,CAAa,MAAb,EAAqB;AAAA,qBAAM,OAAI,CAAC6Z,IAAL,EAAN;AAAA,aAArB,EAAwC,IAAxC,CAAT;AAAA,WAFF;AAID;AAED;;;;;;;gCAIsC;AAAA,cAAzBuF,MAAyB,uEAAP,KAAO;AACpC,cAAMC,QAAQ,GAAGD,MAAM,GACnB,KAAK9G,SAAL,CAAesE,IAAf,CAAoBC,YADD,GAEnB,YAFJ;AAGA,2BAAUwC,QAAV,cAAsB,KAAKL,UAA3B;AACD;AAED;;;;;AAKA;;;;4BAIoB5hB,I,EAAY;AAC9B,cAAI,CAAC,KAAKsb,UAAL,CAAgBtb,IAAhB,CAAL,EAA4B;AAC1B,iBAAK4D,GAAL,CAAY5D,IAAZ,EAAkB,IAAlB;AACD;;AACD,iBAAQ,KAAKqb,SAAL,CAAerb,IAAf,EAA4CS,QAA5C,EAAR;AACD;AAED;;;;;;;;+BAKuBT,I,EAAY;AACjC,cAAI,CAAC,KAAKsb,UAAL,CAAgBtb,IAAhB,CAAL,EAA4B;AAC1B,iBAAK4D,GAAL,CAAY5D,IAAZ,EAAkB,IAAlB;AACD;;AACD,iBAAO,KAAKsb,UAAL,CAAgBtb,IAAhB,CAAP;AACD;AAED;;;;;;;;4BAKuBA,I,EAAcmH,K,EAAQ;AAC3C,cAAI,CAAC,KAAKkU,SAAL,CAAerb,IAAf,CAAL,EAA2B;AACzB,iBAAKqb,SAAL,CAAerb,IAAf,IAAuB,IAAI,OAAAN,eAAJ,CAAuByH,KAAvB,CAAvB;AACA,iBAAKmU,UAAL,CAAgBtb,IAAhB,IAAwB,KAAKqb,SAAL,CAAerb,IAAf,EAAqBuc,YAArB,EAAxB;AACD,WAHD,MAGO;AACL,iBAAKlB,SAAL,CAAerb,IAAf,EAAqBoS,IAArB,CAA0BjL,KAA1B;AACD;AACF;AAED;;;;;;;iCAI8D;AAAA,cAAhD+a,SAAgD,uEAAjB,KAAKR,YAAY;AACxD,cAAMvf,IAAI,GAAQ,KAAKwX,GAAL,CAAS,MAAT,CAAlB;AACA,iBAAOxX,IAAI,CAAC0I,MAAL,CAAYqX,SAAZ,CAAP;AACL;AAED;;;;;;;6BAIYhM,E,EAAU;AACpB,cAAM/T,IAAI,GAAG,KAAKwX,GAAL,CAAS,MAAT,CAAb;AACA,iBAAOxX,IAAI,CAACsF,IAAL,CAAU,UAACnF,CAAD,EAAO;AAAD;;AAAC,mBAAAA,CAAC,CAAC4T,EAAF,KAASA,EAAT,IAAgB,OAAA5T,CAAC,CAAC+S,KAAF,MAAO,IAAP,IAAO,aAAP,GAAO,MAAP,GAAO,GAAE1J,WAAF,EAAP,OAA2BuK,EAAE,SAAF,IAAAA,EAAE,WAAF,GAAE,MAAF,GAAAA,EAAE,CAAEvK,WAAJ,EAA3B,CAAhB;AAA6D,WAA9E,CAAP;AACD;AAED;;;;;;;gCAIuC;AAAA;;AAAA,cAA1BwW,YAA0B,uEAAF,EAAE;AACrC,cAAIH,MAAM,GAAG,KAAb;AACA,cAAII,KAAK,GAAG,IAAZ;AACA;;AACA,cAAID,YAAJ,EAAkB;AAChBH,kBAAM,GAAG,CAAC,CAACG,YAAY,CAACH,MAAxB;AACA,mBAAOG,YAAY,CAACH,MAApB;AACAI,iBAAK,GAAG,OAAOD,YAAY,CAACC,KAApB,KAA8B,SAA9B,GAA0CD,YAAY,CAACC,KAAb,IAAsB,IAAhE,GAAuE,IAA/E;AACA,mBAAOD,YAAY,CAACC,KAApB,KAA8B,SAA9B,IAA2C,OAAOD,YAAY,CAACC,KAA/D;AACD;;AACD,cAAI/K,KAAK,GAAG,gBAAAoD,aAAA,CAAc0H,YAAd,CAAZ;AACA,cAAMxiB,GAAG,mBAAY0X,KAAZ,CAAT;;AACA,cAAI,CAAC,KAAKmK,SAAL,CAAe7hB,GAAf,CAAL,EAA0B;AACxB;AACA;AACA;AACA;AACA,iBAAK6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAAI2gB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACrD,kBAAM7C,GAAG,aAAM,OAAI,CAACG,KAAL,CAAWkE,MAAX,CAAN,SAA2B3K,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAAjD,CAAT;AACA,kBAAIgL,MAAM,GAAoB,EAA9B;;AACA,qBAAI,CAACC,IAAL,CAAU3I,GAAV,CAAcgE,GAAd,EAAmBzb,SAAnB,CACE,UAACkD,CAAD,EAAoC;AAClCid,sBAAM,GACJjd,CAAC,IAAIA,CAAC,YAAY4L,KAAlB,GACI5L,CAAC,CAAC0E,GAAF,CAAM,UAACxH,CAAD;AAAA,yBAAO,OAAI,CAACigB,OAAL,CAAajgB,CAAb,CAAP;AAAA,iBAAN,CADJ,GAEI8C,CAAC,IAAI,EAAEA,CAAC,YAAY4L,KAAf,CAAL,IAA8B5L,CAAC,CAACqG,OAAhC,GACCrG,CAAC,CAACqG,OADH,GAEArG,CAAC,IAAI,EAAEA,CAAC,YAAY4L,KAAf,CAAL,IAA8B,CAAC5L,CAAC,CAACqG,OAAjC,GACA,CAACrG,CAAD,CADA,GAEA,EAPN;AAQD,eAVH,EAWE,UAACkJ,CAAD,EAAO;AACLkS,sBAAM,CAAClS,CAAD,CAAN;AACA,uBAAI,CAACkT,SAAL,CAAe7hB,GAAf,IAAsB,IAAtB;AACD,eAdH,EAeE,YAAM;AACJ4gB,uBAAO,CAAC8B,MAAD,CAAP;;AACA,uBAAI,CAACzf,OAAL,CAAajD,GAAb,EAAkB;AAAA,yBAAO,OAAI,CAAC6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAA7B;AAAA,iBAAlB,EAAsDyiB,KAAtD;AACD,eAlBH;AAoBD,aAvBqB,CAAtB;AAwBD;;AACD,iBAAO,KAAKZ,SAAL,CAAe7hB,GAAf,CAAP;AACD;AAED;;;;;;;;oCAK4C;AAAA;;AAAA,cAA1BwiB,YAA0B,uEAAF,EAAE;AAC1C,cAAIH,MAAM,GAAG,KAAb;AACA,cAAII,KAAK,GAAG,IAAZ;AACA;;AACA,cAAID,YAAJ,EAAkB;AAChBH,kBAAM,GAAG,CAAC,CAACG,YAAY,CAACH,MAAxB;AACA,mBAAOG,YAAY,CAACH,MAApB;AACD;;AACD,cAAI3K,KAAK,GAAG,gBAAAoD,aAAA,CAAc0H,YAAd,CAAZ;AACA,cAAMxiB,GAAG,mBAAY0X,KAAZ,CAAT;AACA,cAAMsG,GAAG,aAAM,KAAKG,KAAL,CAAWkE,MAAX,CAAN,SAA2B3K,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAAjD,CAAT;AACA,iBAAO,KAAKiL,IAAL,CAAU3I,GAAV,CAAcgE,GAAd,EAAmB5I,IAAnB,CACL,YAAAjL,GAAA,CAAI,UAAC1E,CAAD;AAAA,mBAAqC,OAAI,CAACod,gBAAL,CAAsBpd,CAAtB,CAArC;AAAA,WAAJ,CADK,EAEL,YAAAqd,UAAA,CAAW,UAAIC,KAAJ,EAAgBL,MAAhB,EAA+B;AACxC1Y,mBAAO,CAACV,GAAR,CAAYyZ,KAAZ;AACA,mBAAO,OAAAC,EAAA,CAAGN,MAAH,CAAP;AACC,WAHH,CAFK,CAAP;AAME;AACH;AAGD;;;;;;;;yCAKkBjd,C,EAA8B;AAAA;;AAC9C,cAAIid,MAAM,GACNjd,CAAC,IAAIA,CAAC,YAAY4L,KAAlB,GACI5L,CAAC,CAAC0E,GAAF,CAAM,UAACxH,CAAD;AAAA,mBAAO,OAAI,CAACigB,OAAL,CAAajgB,CAAb,CAAP;AAAA,WAAN,CADJ,GAEI8C,CAAC,IAAI,EAAEA,CAAC,YAAY4L,KAAf,CAAL,IAA8B5L,CAAC,CAACqG,OAAhC,GACCrG,CAAC,CAACqG,OADH,GAEArG,CAAC,IAAI,EAAEA,CAAC,YAAY4L,KAAf,CAAL,IAA8B,CAAC5L,CAAC,CAACqG,OAAjC,GACA,CAACrG,CAAD,CADA,GAEA,EAPR;AAQA,iBAAOid,MAAP;AACD;AAED;;;;;;;;0CAKiD;AAAA,cAA1BF,YAA0B,uEAAF,EAAE;AAC/C,cAAIH,MAAM,GAAG,KAAb;AACA,cAAII,KAAK,GAAG,IAAZ;AACA;;AACA,cAAID,YAAJ,EAAkB;AAChBH,kBAAM,GAAG,CAAC,CAACG,YAAY,CAACH,MAAxB;AACA,mBAAOG,YAAY,CAACH,MAApB;AACD;;AACD,cAAI3K,KAAK,GAAG,gBAAAoD,aAAA,CAAc0H,YAAd,CAAZ;AACA,cAAMxiB,GAAG,mBAAY0X,KAAZ,CAAT;AACA,cAAMsG,GAAG,aAAM,KAAKG,KAAL,CAAWkE,MAAX,CAAN,SAA2B3K,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAAjD,CAAT;AACA,iBAAO,KAAKiL,IAAL,CAAU3I,GAAV,CAAcgE,GAAd,CAAP;AACD;AAED;;;;;;;;6BAKYzH,E,EAAsC;AAAA;;AAAA,cAA1BiM,YAA0B,uEAAF,EAAE;AAChD,cAAIH,MAAM,GAAG,KAAb;AACA;;AACA,cAAIG,YAAJ,EAAkB;AAChBH,kBAAM,GAAG,CAAC,CAACG,YAAY,CAACH,MAAxB;AACA,mBAAOG,YAAY,CAACH,MAApB;AACD;;AACD,cAAM3K,KAAK,GAAG,gBAAAoD,aAAA,CAAc0H,YAAd,CAAd;AACA,cAAMxiB,GAAG,kBAAWuW,EAAX,cAAiBmB,KAAjB,CAAT;AACA;;AACA,cAAI,CAAC,KAAKmK,SAAL,CAAe7hB,GAAf,CAAL,EAA0B;AACxB,iBAAK6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAAI2gB,OAAJ,CAAe,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACxD,kBAAM7C,GAAG,aAAM,OAAI,CAACG,KAAL,CAAWkE,MAAX,CAAN,cAA4B9L,EAA5B,SAAiCmB,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAAvD,CAAT;AACA,kBAAIgL,MAAM,GAAM,IAAhB;;AACA,qBAAI,CAACC,IAAL,CAAU3I,GAAV,CAAcgE,GAAd,EAAmBzb,SAAnB,CACE,UAACkD,CAAD;AAAA,uBAAQid,MAAM,GAAG,OAAI,CAACE,OAAL,CAAand,CAAb,CAAjB;AAAA,eADF,EAEE,UAACkJ,CAAD,EAAO;AACLkS,sBAAM,CAAClS,CAAD,CAAN;AACA,uBAAI,CAACkT,SAAL,CAAeoB,QAAf,GAA0B,IAA1B;AACD,eALH,EAME,YAAM;AACJrC,uBAAO,CAAC8B,MAAD,CAAP;;AACA,uBAAI,CAACzf,OAAL,CAAajD,GAAb,EAAkB;AAAA,yBAAO,OAAI,CAAC6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAA7B;AAAA,iBAAlB,EAAsD,IAAtD;AACD,eATH;AAWD,aAdqB,CAAtB;AAeD;;AACD,iBAAO,KAAK6hB,SAAL,CAAe7hB,GAAf,CAAP;AACD;AAED;;;;;;;;4BAKWkiB,S,EAA8C;AAAA;;AAAA,cAA1BM,YAA0B,uEAAF,EAAE;;AACvD;AACA,cAAI,CAAC,KAAKX,SAAL,CAAeoB,QAApB,EAA8B;AAC5B,iBAAKpB,SAAL,CAAeoB,QAAf,GAA0B,IAAItC,OAAJ,CAAe,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC5D,kBAAMnJ,KAAK,GAAG,gBAAAoD,aAAA,CAAc0H,YAAd,CAAd;AACA,kBAAMxE,GAAG,aAAM,OAAI,CAACG,KAAL,CAAWqE,YAAY,CAACH,MAAxB,CAAN,SAAwC3K,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAA9D,CAAT;AACA,kBAAIgL,MAAM,GAAM,IAAhB;;AACA,qBAAI,CAACC,IAAL,CAAUO,IAAV,CAAelF,GAAf,EAAoB,OAAI,CAACmF,eAAL,CAAqBjB,SAArB,CAApB,EAAqD3f,SAArD,CACE,UAACkD,CAAD;AAAA,uBAAQid,MAAM,GAAG,OAAI,CAACE,OAAL,CAAand,CAAb,CAAjB;AAAA,eADF,EAEE,UAACkJ,CAAD,EAAO;AACLkS,sBAAM,CAAClS,CAAD,CAAN;;AACA,uBAAI,CAACyU,cAAL,kBAA8B,OAAI,CAACpB,KAAL,CAAWhW,WAAX,EAA9B;;AACA,uBAAI,CAAC6V,SAAL,CAAeoB,QAAf,GAA0B,IAA1B;AACD,eANH,EAOE,YAAM;AACJrC,uBAAO,CAAC8B,MAAD,CAAP;;AACA,uBAAI,CAACze,GAAL,CAAS,MAAT,EAAiB,OAAI,CAACof,UAAL,CAAgB,OAAI,CAACrJ,GAAL,CAAS,MAAT,CAAhB,EAAkC,CAAC0I,MAAD,CAAlC,CAAjB;;AACA,uBAAI,CAACU,cAAL,kBAA8B,OAAI,CAACpB,KAAL,CAAWhW,WAAX,EAA9B;;AACA,uBAAI,CAAC6V,SAAL,CAAeoB,QAAf,GAA0B,IAA1B;AACD,eAZH;AAcD,aAlByB,CAA1B;AAmBD;;AACD,iBAAO,KAAKpB,SAAL,CAAeoB,QAAtB;AACD;;;6BAWC1M,E,EACA2K,S,EAE+B;AAAA;;AAAA,cAD/BgB,SAC+B,uEADV,EACU;AAAA,cAA/BoB,MAA+B,uEAAN,MAAM;AAE/B,cAAM5L,KAAK,GAAI,gBAAAoD,aAAA,CAAc,KAAKqI,eAAL,CAAqBjB,SAArB,CAAd,CAAf;AACA,cAAMliB,GAAG,kBAAWuW,EAAX,cAAiB2K,SAAjB,cAA8BxJ,KAA9B,CAAT;AACA;;AACA,cAAI,CAAC,KAAKmK,SAAL,CAAe7hB,GAAf,CAAL,EAA0B;AACxB,iBAAK6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAAI2gB,OAAJ,CAAe,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACxD,kBAAM0C,SAAS,GAAG,MAAH,OAAG,CAAH,kBAAQrB,SAAR,CAAG,EAAc;AAAE3L,kBAAE,EAAFA,EAAF;AAAMiN,qBAAK,EAAEtC;AAAb,eAAd,CAAlB;AACA,kBAAMlD,GAAG,aAAM,OAAI,CAACG,KAAL,CAAW,KAAX,CAAN,cAA2B5H,EAA3B,cAAiC2K,SAAjC,CAAT;AACA,kBAAIwB,MAAJ;AACA,kBAAMhM,OAAO,GACX4M,MAAM,KAAK,MAAX,GACI,OAAI,CAACX,IAAL,CAAUO,IAAV,CAAelF,GAAf,EAAoBuF,SAApB,CADJ,GAEI,OAAI,CAACZ,IAAL,CAAU3I,GAAV,WAAiBgE,GAAjB,SAAuBtG,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAA7C,EAHN;AAIAhB,qBAAO,CAACnU,SAAR,CACE,UAACkD,CAAD;AAAA,uBAAQid,MAAM,GAAGjd,CAAjB;AAAA,eADF,EAEE,UAACkJ,CAAD,EAAO;AACLkS,sBAAM,CAAClS,CAAD,CAAN;;AACA,uBAAI,CAACyU,cAAL,WACK,OAAI,CAACpB,KAAL,CAAWhW,WAAX,EADL,mBACsCkV,SADtC,cAEE3K,EAFF;;AAIA,uBAAO,OAAI,CAACsL,SAAL,CAAe7hB,GAAf,CAAP;AACD,eATH,EAUE,YAAM;AACJ4gB,uBAAO,CAAC8B,MAAD,CAAP;;AACA,uBAAI,CAACU,cAAL,WACK,OAAI,CAACpB,KAAL,CAAWhW,WAAX,EADL,mBACsCkV,SADtC,eAEE3K,EAFF;;AAIA,uBAAI,CAACtT,OAAL,CAAajD,GAAb,EAAkB;AAAA,yBAAM,OAAO,OAAI,CAAC6hB,SAAL,CAAe7hB,GAAf,CAAb;AAAA,iBAAlB,EAAoD,IAApD;AACD,eAjBH;AAmBD,aA3BqB,CAAtB;AA4BD;;AACD,iBAAO,KAAK6hB,SAAL,CAAe7hB,GAAf,CAAP;AACD;AAGD;;;;;;;;;;;iCASEuW,E,EACA2K,S,EAE+B;AAAA,cAD/BgB,SAC+B,uEADV,EACU;AAAA,cAA/BoB,MAA+B,uEAAN,MAAM;AAC/B,cAAM5L,KAAK,GAAK,gBAAAoD,aAAA,CAAc,KAAKqI,eAAL,CAAqBjB,SAArB,CAAd,CAAhB;AACA,cAAIG,MAAM,GAAG,KAAb;AACA,cAAII,KAAK,GAAG,IAAZ;AACA,cAAMc,SAAS,GAAG,MAAH,OAAG,CAAH,kBAAQrB,SAAR,CAAG,EAAc;AAAE3L,cAAE,EAAFA,EAAF;AAAMiN,iBAAK,EAAEtC;AAAb,WAAd,CAAlB;AACA,cAAMlD,GAAG,aAAM,KAAKG,KAAL,CAAW,KAAX,CAAN,cAA2B5H,EAA3B,cAAiC2K,SAAjC,CAAT;AACA,cAAIwB,MAAJ;AAEA,cAAMhM,OAAO,GAAG4M,MAAM,KAAK,MAAX,GACZ,KAAKX,IAAL,CAAUO,IAAV,CAAelF,GAAf,EAAoBuF,SAApB,CADY,GAEZ,KAAKZ,IAAL,CAAU3I,GAAV,WAAiBgE,GAAjB,SAAuBtG,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAA7C,EAFJ;AAIE,iBAAOhB,OAAP;AACH;AAGD;;;;;;;;;+BAMcH,E,EAAY2L,S,EAA8C;AAAA;;AAAA,cAA1BM,YAA0B,uEAAF,EAAE;AACtE,cAAMxiB,GAAG,oBAAauW,EAAb,CAAT;AACA;;AACA,cAAI,CAAC,KAAKsL,SAAL,CAAe7hB,GAAf,CAAL,EAA0B;AACxB,iBAAK6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAAI2gB,OAAJ,CAAe,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACxD,kBAAMnJ,KAAK,GAAG,gBAAAoD,aAAA,CAAc,OAAI,CAACqI,eAAL,CAAqBX,YAArB,CAAd,CAAd;AACA,kBAAMxE,GAAG,aAAM,OAAI,CAACG,KAAL,CAAWqE,YAAY,CAACH,MAAxB,CAAN,cAAyC9L,EAAzC,SAA8CmB,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAApE,CAAT;AACA,kBAAIgL,MAAM,GAAM,IAAhB;;AACA,qBAAI,CAACC,IAAL,CAAUc,GAAV,CAAczF,GAAd,EAAmB,OAAI,CAACmF,eAAL,CAAqBjB,SAArB,CAAnB,EAAoD3f,SAApD,CACE,UAACkD,CAAD;AAAA,uBAAQid,MAAM,GAAG,OAAI,CAACE,OAAL,CAAand,CAAb,CAAjB;AAAA,eADF,EAEE,UAACkJ,CAAD,EAAO;AACLkS,sBAAM,CAAClS,CAAD,CAAN;;AACA,uBAAI,CAACyU,cAAL,kBAA8B,OAAI,CAACpB,KAAL,CAAWhW,WAAX,EAA9B,cAAiEuK,EAAjE;;AACA,uBAAI,CAACsL,SAAL,CAAe7hB,GAAf,IAAsB,IAAtB;AACD,eANH,EAOE,YAAM;AACJ4gB,uBAAO,CAAC8B,MAAD,CAAP;;AACA,uBAAI,CAACze,GAAL,CACE,MADF,EAEE,OAAI,CAACof,UAAL,CAAgB,OAAI,CAACK,UAAL,CAAgB,OAAI,CAAC1J,GAAL,CAAS,MAAT,CAAhB,EAAkC;AAAEzD,oBAAE,EAAFA;AAAF,iBAAlC,CAAhB,EAAkE,CAChEmM,MADgE,CAAlE,CAFF;;AAMA,uBAAI,CAACU,cAAL,kBAA8B,OAAI,CAACpB,KAAL,CAAWhW,WAAX,EAA9B,eAAkEuK,EAAlE;;AACA,uBAAI,CAACsL,SAAL,CAAe7hB,GAAf,IAAsB,IAAtB;AACD,eAjBH;AAmBD,aAvBqB,CAAtB;AAwBD;;AACD,iBAAO,KAAK6hB,SAAL,CAAe7hB,GAAf,CAAP;AACD;AAGD;;;;;;;;;;mCAOmBuW,E,EAAY2L,S,EAAwF;AAAA;;AAAA,cAApEyB,uBAAoE,uEAAjC,KAAiC;AAAA,cAA1BnB,YAA0B,uEAAF,EAAE;AACrH,cAAM9K,KAAK,GAAGiM,uBAAuB,GAAG,gBAAA7I,aAAA,CAAc,KAAKqI,eAAL,CAAqBX,YAArB,CAAd,CAAH,GAAuD,KAA5F;AACA,cAAMxE,GAAG,aAAM,KAAKG,KAAL,CAAWqE,YAAY,CAACH,MAAxB,CAAN,cAAyC9L,EAAzC,SAA8CmB,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAApE,CAAT;AACA,cAAMlH,IAAI,GAAGmT,uBAAuB,GAAG,KAAKR,eAAL,CAAqBjB,SAArB,CAAH,GAAqCA,SAAzE;AAEA,iBAAO,KAAKS,IAAL,CAAUc,GAAV,CAAczF,GAAd,EAAmBxN,IAAnB,EACJ4E,IADI,CAED,YAAAjL,GAAA,CAAI,UAAC1E,CAAD;AAAA,mBAAqC,OAAI,CAACod,gBAAL,CAAsBpd,CAAtB,CAArC;AAAA,WAAJ,CAFC,EAIH,YAAAqd,UAAA,CAAW,UAAIC,KAAJ,EAAgBL,MAAhB,EAA+B;AACxC1Y,mBAAO,CAACV,GAAR,CAAYyZ,KAAZ;;AACA,mBAAI,CAACK,cAAL,kBAA8B,OAAI,CAACpB,KAAL,CAAWhW,WAAX,EAA9B,cAAiEuK,EAAjE;;AACA,mBAAO,OAAAyM,EAAA,CAAGD,KAAH,CAAP;AACD,WAJD,CAJG,CAAP;AAWD;AAED;;;;;;;;;0CAM0Ba,W,EAAqB1B,S,EAAwF;AAAA,cAApEyB,uBAAoE,uEAAjC,KAAiC;AAAA,cAA1BnB,YAA0B,uEAAF,EAAE;AACrI,cAAM9K,KAAK,GAAGiM,uBAAuB,GAAG,gBAAA7I,aAAA,CAAc,KAAKqI,eAAL,CAAqBX,YAArB,CAAd,CAAH,GAAuD,KAA5F;AACA,cAAMxE,GAAG,aAAM,KAAKG,KAAL,CAAWqE,YAAY,CAACH,MAAxB,CAAN,cAAyCuB,WAAzC,SAAuDlM,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAA7E,CAAT;AACA,cAAMlH,IAAI,GAAGmT,uBAAuB,GAAG,KAAKR,eAAL,CAAqBjB,SAArB,CAAH,GAAqCA,SAAzE;AAEA,cAAM2B,KAAK,GAAGC,cAAc,CAACtd,MAAf,GAAwBqG,IAAI,CAACC,KAAL,CAAWgX,cAAc,CAACtF,OAAf,CAAuB,cAAvB,CAAX,EAAmDuF,YAA3E,GAA0F,EAAxG;AAEA,cAAMC,OAAO,GAAG,IAAI,OAAAC,WAAJ,CAAgB;AAC9B,8CAA2BJ,KAA3B;AAD8B,WAAhB,CAAhB;AAIF,cAAMK,cAAc,GAAG;AAAEF,mBAAO,EAAEA;AAAX,WAAvB,CAXuI,CAarI;AACA;AACA;;AAEA,iBAAO,KAAKrB,IAAL,CAAUO,IAAV,CAAelF,GAAf,EAAoBxN,IAApB,CAAP;AAED;AAED;;;;;;;gCAIc+F,E,EAA2B;AAAA;;AAAA,cAAf4N,CAAe,uEAAF,EAAE;AACvC,cAAMnkB,GAAG,oBAAauW,EAAb,CAAT;AACA;;AACA,cAAI,CAAC,KAAKsL,SAAL,CAAe7hB,GAAf,CAAL,EAA0B;AACxB,iBAAK6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAAI2gB,OAAJ,CAAkB,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC3D,kBAAMnJ,KAAK,GAAG,gBAAAoD,aAAA,CAAcqJ,CAAd,CAAd;AACA,kBAAMnG,GAAG,aAAM,OAAI,CAACG,KAAL,EAAN,cAAsB5H,EAAtB,SAA2BmB,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAAjD,CAAT;;AACA,qBAAI,CAACiL,IAAL,WAAiB3E,GAAjB,EAAsBzb,SAAtB,CACE,UAACuZ,CAAD;AAAA,uBAAO,IAAP;AAAA,eADF,EAEE,UAACnN,CAAD,EAAO;AACLkS,sBAAM,CAAClS,CAAD,CAAN;AACA,uBAAI,CAACkT,SAAL,CAAe7hB,GAAf,IAAsB,IAAtB;AACD,eALH,EAME,YAAM;AACJ,uBAAI,CAACiE,GAAL,CAAS,MAAT,EAAiB,OAAI,CAACyf,UAAL,CAAgB,OAAI,CAAC1J,GAAL,CAAS,MAAT,CAAhB,EAAkC;AAAEzD,oBAAE,EAAFA;AAAF,iBAAlC,CAAjB;;AACA,uBAAI,CAACsL,SAAL,CAAe7hB,GAAf,IAAsB,IAAtB;AACA4gB,uBAAO;AACR,eAVH;AAYD,aAfqB,CAAtB;AAgBD;;AACD,iBAAO,KAAKiB,SAAL,CAAe7hB,GAAf,CAAP;AACD;AAED;;;;;;+BAGoB;;;;;;;;;;;;AACnB;AAED;;;;;;;uCAIyBuV,M,EAAgB6O,K,EAAgB,CACvD;AACA;AACA;AACD;AAED;;;;;;;gCAIkBC,Q,EAAiB;AACjC,iBAAOA,QAAP;AACD;AAED;;;;;;;;;mCAOEC,Q,EACA9hB,I,EACkD;AAAA,cAAlD+hB,SAAkD,uEAAb,KAAKzC,QAAQ;;AAElD;AACA,cAAI,CAACtf,IAAD,IAASA,IAAI,CAACgE,MAAL,KAAgB,CAA7B,EAAgC;AAC9B,mBAAO8d,QAAP;AACD;;AACD,cAAME,QAAQ,GAAQ,EAAtB;AACA,cAAMC,UAAU,gCAAOjiB,IAAP,sBAAgB8hB,QAAhB,EAAhB;AACA;;AACA,cAAI,CAACC,SAAL,EAAgB;AACdA,qBAAS,GAAG,KAAKzC,QAAjB;AACD;;AAXiD,sDAY/B2C,UAZ+B;AAAA;;AAAA;AAAA;AAAA,kBAYvCzX,IAZuC;AAahD,kBAAM8M,KAAK,GAAG0K,QAAQ,CAAC1c,IAAT,CAAc,UAACnF,CAAD;AAAA,uBAAO4hB,SAAS,CAAC5hB,CAAD,EAAIqK,IAAJ,CAAhB;AAAA,eAAd,CAAd;AACA;;AACA,kBAAI,CAAC8M,KAAL,EAAY;AACV0K,wBAAQ,CAACrY,IAAT,CAAca,IAAd;AACD;AAjB+C;;AAYlD,mEAA+B;AAAA;AAM9B;AAlBiD;AAAA;AAAA;AAAA;AAAA;;AAmBlD,iBAAOwX,QAAP;AACD;AAED;;;;;;;;;mCAMqBhiB,I,EAAWwK,I,EAASuX,S,EAAqC;AAC5E,cAAMC,QAAQ,GAAG,EAAjB;AACA;;AACA,cAAI,CAACD,SAAL,EAAgB;AACdA,qBAAS,GAAG,KAAKzC,QAAjB;AACD;;AACDtf,cAAI,CAACE,OAAL,CAAa,UAACC,CAAD;AAAA,mBAAQ4hB,SAAS,CAACvX,IAAD,EAAOrK,CAAP,CAAT,GAAqB,IAArB,GAA4B6hB,QAAQ,CAACrY,IAAT,CAAcxJ,CAAd,CAApC;AAAA,WAAb;AACA,iBAAO6hB,QAAP;AACD;;;4BApiBoB;AACnB,iBAAO,KAAKjJ,SAAL,CAAeoH,IAAtB;AACD;;;4BA2CsB;AACrB,iBAAO,KAAKV,UAAZ;AACD;;;;MArE+D,OAAAviB,S;;AAAlE;;;;;;;;;;;;;;;;;;;;ACdA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAGa,YAAAglB,8BAAA,GAAiC,UAACC,OAAD,EAA4B;AACtE,cAAQA,OAAR;AACI,aAAK,cAAAC,aAAA,CAAcC,eAAnB;AACI,iBAAO,uBAAP;;AACJ,aAAK,cAAAD,aAAA,CAAcE,eAAnB;AACI,iBAAO,kBAAP;;AACJ,aAAK,cAAAF,aAAA,CAAcG,sBAAnB;AACI,iBAAO,0BAAP;;AACJ,aAAK,cAAAH,aAAA,CAAcI,SAAnB;AACI,iBAAO,YAAP;;AACJ,aAAK,cAAAJ,aAAA,CAAcK,UAAnB;AACI,iBAAO,YAAP;;AACJ,aAAK,cAAAL,aAAA,CAAcM,oBAAnB;AACI,iBAAO,YAAP;;AACJ,aAAK,cAAAN,aAAA,CAAcO,cAAnB;AACI,iBAAO,YAAP;;AACJ,aAAK,cAAAP,aAAA,CAAcQ,QAAnB;AACI,iBAAO,MAAP;;AACJ,aAAK,cAAAR,aAAA,CAAcS,aAAnB;AACI,iBAAO,SAAP;;AACJ,aAAK,cAAAT,aAAA,CAAcU,UAAnB;AACI,iBAAO,aAAP;;AACJ,aAAK,cAAAV,aAAA,CAAcW,YAAnB;AACI,iBAAO,uCAAP;;AACJ,aAAK,cAAAX,aAAA,CAAcY,SAAnB;AACI,iBAAO,sBAAP;;AACJ,aAAK,cAAAZ,aAAA,CAAca,YAAnB;AACI,iBAAO,qBAAP;;AACJ,aAAK,cAAAb,aAAA,CAAcc,WAAnB;AACI,iBAAO,oBAAP;;AACJ,aAAK,cAAAd,aAAA,CAAce,YAAnB;AACI,iBAAO,qBAAP;;AACJ,aAAK,cAAAf,aAAA,CAAcgB,UAAnB;AACI,iBAAO,oBAAP;;AACJ,aAAK,cAAAhB,aAAA,CAAciB,aAAnB;AACI,iBAAO,0BAAP;;AACJ,aAAK,cAAAjB,aAAA,CAAckB,QAAnB;AACI,iBAAO,qBAAP;AACJ;;AACA;AACI,iBAAOnB,OAAP;AAvCR;AAyCH,KA1CY;;AA6CA,YAAAoB,iBAAA,GAAuC;AAChDve,WAAK,EAAE,cADyC;AAEhD+I,aAAO,EAAE,0DAFuC;AAGhDyV,kBAAY,EAAE;AAHkC,KAAvC;AAKA,YAAAC,kBAAA,GAA0C,CACnD,QAAAF,iBADmD,CAA1C;;AAIA,YAAAG,8BAAA,GAAiC,UAACja,CAAD,EAAyC;AACnF,UAAMsE,OAAO,GAAG,QAAAmU,8BAAA,CAA+BzY,CAA/B,CAAhB;AACA,aAAQ;AACJzE,aAAK,EAAEyE,CADH;AAEJsE,eAAO,EAAPA,OAFI;AAGJ;AACA;AACA;AACA;AACA;AACA;AACAyV,oBAAY,EAAEzV;AATV,OAAR;AAWH,KAbY;;AAeA,YAAA4V,4BAAA,GAAoD,CAC7D,cAAAvB,aAAA,CAAcC,eAD+C,EAE7D,cAAAD,aAAA,CAAcE,eAF+C,EAG7D,cAAAF,aAAA,CAAcG,sBAH+C,EAI7D,cAAAH,aAAA,CAAcI,SAJ+C,EAK7D,cAAAJ,aAAA,CAAcK,UAL+C,EAM7D,cAAAL,aAAA,CAAcM,oBAN+C,EAO/D/a,GAP+D,CAO3D,QAAA+b,8BAP2D,CAApD;AASA,YAAAE,+BAAA,GAAuD,CAChE,cAAAxB,aAAA,CAAcS,aADkD,EAEhE,cAAAT,aAAA,CAAcO,cAFkD,EAGhE,cAAAP,aAAA,CAAcQ,QAHkD,EAIhE,cAAAR,aAAA,CAAcU,UAJkD,EAKlEnb,GALkE,CAK9D,QAAA+b,8BAL8D,CAAvD;AAOA,YAAAG,+BAAA,GAAuD,CAChE,cAAAzB,aAAA,CAAcO,cADkD,EAEhE,cAAAP,aAAA,CAAcQ,QAFkD,EAGlEjb,GAHkE,CAG9D,QAAA+b,8BAH8D,CAAvD;AAKA,YAAAI,mBAAA,GAA2C,CACpD,cAAA1B,aAAA,CAAcW,YADsC,EAEpD,cAAAX,aAAA,CAAcY,SAFsC,EAGpD,cAAAZ,aAAA,CAAca,YAHsC,EAIpD,cAAAb,aAAA,CAAcc,WAJsC,EAKpD,cAAAd,aAAA,CAAce,YALsC,EAMpD,cAAAf,aAAA,CAAcgB,UANsC,EAOpD,cAAAhB,aAAA,CAAciB,aAPsC,EAQtD1b,GARsD,CAQlD,QAAA+b,8BARkD,CAA3C;AAUA,YAAAK,qBAAA,GAA6C,CACtD,cAAA3B,aAAA,CAAckB,QADwC,EAExD3b,GAFwD,CAEpD,QAAA+b,8BAFoD,CAA7C;AAIb;;;;AAGA,QAAYM,iBAAZ;;AAAA,eAAYA,iBAAZ,EAA6B;AACzB;;;AAGA;AAEA;;;;;AAIA;AAEA;;;;AAGA;AAEA;;;;AAGA;AAEA;;;;AAGA;AAEA;;;;AAGA;AACH,KA/BD,EAAYA,iBAAiB,GAAjB,QAAAA,iBAAA,aAAAA,iBAAA,GAAiB,EAAjB,CAAZ;AAwCA;;;;;;;;;;;AASa,YAAAC,4BAAA,GAA+B,UACxCC,WADwC,EAExCC,MAFwC,EAEX;AAC7BlO,cAHwC,EAKU;AAAA,UADlDW,SACkD,uEAD1B,EAC0B;AAAA,UAAlDwN,WAAkD;AAClD,UAAMC,WAAW,GAAYH,WAAW,CAACI,IAAZ,CAAiB,UAAA7a,CAAC;AAAA,eAAIA,CAAC,CAACzE,KAAF,KAAY,QAAAue,iBAAA,CAAkBve,KAAlC;AAAA,OAAlB,CAA7B;AACA,UAAMuf,YAAY,GAAaL,WAAW,CAACI,IAAZ,CAAiB,UAAA7a,CAAC;AAAA,eAAIA,CAAC,CAACzE,KAAF,KAAY,cAAAod,aAAA,CAAckB,QAA9B;AAAA,OAAlB,CAA/B,CAFkD,CAGlD;;AACA,UAAMkB,cAAc,GAAGN,WAAW,CAACxb,MAAZ,CAAmB,UAAAA,MAAM;AAAA,eAAI,CAAC,CAAC,QAAA6a,iBAAA,CAAkBve,KAAnB,EAA0B,cAAAod,aAAA,CAAckB,QAAxC,EAAkD1H,QAAlD,CAA2DlT,MAAM,CAAC1D,KAAlE,CAAL;AAAA,OAAzB,CAAvB;AACA,UAAMyf,gBAAgB,GAAGD,cAAc,CAACxgB,MAAf,KAA0B,CAAnD,CALkD,CAOlD;AACA;;AACA,UAAM0gB,OAAO,GAA4B;AACrC7hB,gBAAQ,EAAEoT,UAAU,CAACpT,QADgB;AAErCuY,YAAI,EAAEgJ,WAF+B;AAGrC3hB,cAAM,EAAEwT,UAAU,CAACxT;AAHkB,OAAzC;AAKA,UAAIkiB,UAAU,GAAG,CAAjB;AACA,UAAIC,UAAU,GAAG,EAAjB;AACA,UAAIC,sBAAsB,GAAG,CAA7B;AACA,UAAMC,SAAS,GAAyB,EAAxC,CAjBkD,CAkBlD;;AACA,UAAMC,cAAc,GAAGZ,MAAM,SAAN,IAAAA,MAAM,WAAN,GAAM,MAAN,GAAAA,MAAM,CAAExc,GAAR,CAAY,UAAAqd,KAAK;AAAA,eAAIA,KAAK,YAAY,SAAAC,KAAjB,GAAyBD,KAAzB,GAAiC,IAAI,SAAAC,KAAJ,CAAUD,KAAV,CAArC;AAAA,OAAjB,EAAwEtc,MAAxE,CAA+E,UAAAwc,SAAS,EAAI;;;AAC/G,YAAMF,KAAK,GAAG,IAAI,SAAAC,KAAJ,CAAUC,SAAV,CAAd,CAD+G,CAC3E;;AACpC,YAAMC,QAAQ,GAAGvO,SAAS,CAACtR,IAAV,CAAe,UAAA4E,CAAC;AAAA,iBAAI8a,KAAK,CAACI,KAAN,CAAYxJ,QAAZ,CAAqB1R,CAAC,CAAC6J,EAAvB,CAAJ;AAAA,SAAhB,CAAjB;AACA,YAAMsR,KAAK,GAAG,kBAAAC,aAAA,CAAc;AACxBha,cAAI,EAAE,CAAF,KAAEoZ,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEjiB,MAAT,MAAe,IAAf,IAAe,aAAf,GAAe,MAAf,GAAe,GAAEgJ,EADC;AAExB5I,kBAAQ,EAAE6hB,OAAO,CAAC7hB,QAFM;AAGxB6X,cAAI,EAAEgK,OAAO,CAACtJ,IAHU;AAIxBiK,eAAK,EAAEF,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEI,aAJO;AAKxBP,eAAK,EAALA;AALwB,SAAd,CAAd;AAOAJ,kBAAU,GAAGS,KAAK,CAACG,MAAnB;AACA,YAAIC,KAAK,GAAG,CAACJ,KAAK,CAACK,IAAnB;;AACA,YAAI,CAACD,KAAL,EAAY;AACRd,oBAAU;AACV,iBAAO,KAAP;AACH,SAf8G,CAkB/G;;;AACA,YAAIgB,cAAJ;AACA,YAAMC,uBAAuB,GAAG,CAC5B,YAD4B,EAE5B,cAF4B,EAG5B,SAH4B,EAI5B,aAJ4B,EAK5B,WAL4B,CAAhC;;AAQA,YAAIpB,cAAc,CAACxgB,MAAf,KAA0B,CAA9B,EAAiC;AAC7B2hB,wBAAc,GAAG,IAAjB;AACH,SAFD,MAEO,IAAGnB,cAAc,CAACqB,KAAf,CAAqB,UAAApc,CAAC;AAAA,iBAAImc,uBAAuB,CAAChK,QAAxB,CAAiCnS,CAAC,CAACzE,KAAnC,CAAJ;AAAA,SAAtB,CAAH,EAAyE;AAAK;AACjF2gB,wBAAc,GAAGnB,cAAc,CAACF,IAAf,CAAoB,UAAA7a,CAAC;AAAA,mBAAIub,KAAK,CAACc,aAAN,CAAoBlK,QAApB,CAA6BnS,CAAC,CAACzE,KAA/B,CAAJ;AAAA,WAArB,CAAjB;AACD,SAFI,MAEE;AAAK;AACV2gB,wBAAc,GAAGnB,cAAc,CAACqB,KAAf,CAAqB,UAAApc,CAAC;AAAA,mBAAIub,KAAK,CAACc,aAAN,CAAoBlK,QAApB,CAA6BnS,CAAC,CAACzE,KAA/B,CAAJ;AAAA,WAAtB,CAAjB;AACD;;AAEH,YAAM+gB,OAAO,GAAG1B,WAAW,GAAGW,KAAK,CAACgB,QAAT,GAAoB,IAA/C;AACA,YAAMC,WAAW,GAAG,OAAAhQ,UAAU,SAAV,IAAAA,UAAU,WAAV,GAAU,MAAV,GAAAA,UAAU,CAAEiQ,WAAZ,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAElhB,KAAzB,MAAmC,UAAnC,GACE,IADF,GAEE,OAAAggB,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAEmB,oBAAP,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAEniB,MAA7B,IACAghB,KAAK,CAACmB,oBAAN,MAA0B,MAAKlQ,UAAU,SAAV,IAAAA,UAAU,WAAV,GAAU,MAAV,GAAAA,UAAU,CAAEiQ,WAAjB,MAA4B,IAA5B,IAA4B,aAA5B,GAA4B,MAA5B,GAA4B,GAAElhB,KAAxD,CADA,GAEA,IAJtB;AAKAygB,aAAK,GAAGA,KAAK,IAAIQ,WAAT,KAAyBxB,gBAAgB,IAAIkB,cAA7C,KAAgEI,OAAxE;AACA,YAAIK,WAAW,GAAGjB,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEkB,YAA5B;;AACA,YAAI,CAAArB,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAEqB,YAAP,MAAwB,KAA5B,EAAmC;AAC/BD,qBAAW,GAAG,KAAd;AACH,SA9C8G,CA+C/G;;;AACA,YAAI7B,YAAY,IAAI,CAAC6B,WAArB,EAAkC;AAC9BX,eAAK,GAAG,KAAR,CAD8B,CAE9B;AACH,SAnD8G,CAqD/G;;;AACA,YAAI,CAACE,cAAL,EAAqB;AACjBF,eAAK,GAAG,KAAR,CADiB,CAEjB;AACH;;AAED,YAAMa,MAAM,GAAG,oBAAAC,kBAAA,CACXvB,KAAK,CAACnT,QAAN,CAAe7N,MAAf,GAAwBghB,KAAK,CAACnT,QAAN,CAAelK,GAAf,CAAmB,UAAAuC,CAAC;AAAA,iBAAI,IAAI,gBAAAsc,OAAJ,CAAYtc,CAAZ,CAAJ;AAAA,SAApB,CAAxB,GAAkE8a,KAAK,CAAC/J,QAAN,CAAepJ,QAAf,CAAwBlK,GAAxB,CAA4B,UAAAuC,CAAC;AAAA,iBAAI,IAAI,gBAAAsc,OAAJ,CAAYtc,CAAZ,CAAJ;AAAA,SAA7B,CADvD,EAEX8a,KAAK,CAACgB,QAAN,IAAkB,CAACX,KAAK,CAACK,IAFd,EAGX,CAACL,KAAK,CAACoB,YAHI,EAIXxQ,UAAU,CAACxT,MAJA,EAKXuiB,KALW,CAAf,CA3D+G,CAmE/G;;AACA,YAAIX,WAAW,IAAIoB,KAAnB,EAA0B;AACtBA,eAAK,GAAGa,MAAM,CAACA,MAAP,KAAkB;AAAL;AAArB;AACA,cAAI,CAACb,KAAL,EAAYje,OAAO,CAACkf,KAAR,CAAc,oBAAd;AAEf;AAGD;;;;;;;AAKA,YAAG,CAAC1B,KAAK,CAAC2B,SAAV,EAAqB;AACjBlB,eAAK,GAAGT,KAAK,CAAC2B,SAAd;AACH;AACD;AAEA;;;AACA,YAAIlB,KAAJ,EAAW;AACPX,mBAAS,CAACE,KAAK,CAACjR,EAAP,CAAT,GAAsBuS,MAAM,CAACA,MAA7B;AACH,SAFD,MAEO;AACHzB,gCAAsB;AACzB,SA1F8G,CA2F/G;;;AACA,eAAOY,KAAP;AACH,OA7FsB,CAAvB;AA+FA,UAAMmB,mBAAmB,GAAGhQ,SAAS,CAAClO,MAAV,CACxB,UAAC4Q,CAAD,EAAM;AAAA;;AAAA,gBAAArD,UAAU,SAAV,IAAAA,UAAU,WAAV,GAAU,MAAV,GAAAA,UAAU,CAAEkF,QAAZ,MAAuBpX,SAAvB,KAAgC,MAAIkS,UAAU,SAAV,IAAAA,UAAU,WAAV,GAAU,MAAV,GAAAA,UAAU,CAAEkF,QAAhB,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,GAAEnX,MAA1D,KAAqEsV,CAAC,CAAC/B,IAAF,MAAM,kBAAKtB,UAAU,SAAV,IAAAA,UAAU,WAAV,GAAU,MAAV,GAAAA,UAAU,CAAEkF,QAAZ,CAAqB,CAArB,CAAL,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAG0L,IAA9B,MAAkC,IAAlC,IAAkC,aAAlC,GAAkC,MAAlC,GAAkC,GAAE1B,QAApC,MAA4C,IAA5C,IAA4C,aAA5C,GAA4C,MAA5C,GAA4C,GAAE5N,IAApD,CAArE;AAA6H,OAD3G,KAEvB,EAFL;AAGA,UAAMuP,kBAAkB,GAAGF,mBAAmB,CAACle,MAApB,CAA2B,UAAAyc,QAAQ;AAAA,eAC1D,CAAClP,UAAU,CAACkF,QAAX,CAAoBmJ,IAApB,CAAyB,UAAAyC,YAAY,EAAG;AAAA;;AACrC,8BAAAA,YAAY,CAACF,IAAb,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAE1B,QAAnB,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAEpR,EAA7B,MAAoCoR,QAAQ,CAACpR,EAA7C;AAA+C,SADlD,CADyD;AAAA,OAAnC,CAA3B,CArHkD,CA2HlD;;AACA,UAAIyR,MAAJ;AAAA,UAAYwB,cAAc,GAAGhD,iBAAiB,CAACiD,IAA/C,CA5HkD,CA6HlD;;AACA,UAAI,CAAAlC,cAAc,SAAd,IAAAA,cAAc,WAAd,GAAc,MAAd,GAAAA,cAAc,CAAE/gB,MAAhB,MAA2B,CAA/B,EAAkC;AAC9B,YAAI6gB,sBAAsB,GAAG,CAAzB,KAA+B,CAACJ,gBAAD,IAAqBF,YAApD,CAAJ,EAAuE;AACnEiB,gBAAM,GAAGxB,iBAAiB,CAACkD,OAA3B;AACH,SAFD,MAEO,IAAIvC,UAAU,GAAG,CAAjB,EAAoB;AACvBa,gBAAM,GAAGxB,iBAAiB,CAACmD,WAA3B;AACH,SAFM,MAEA,IAAGL,kBAAH,EAAsB;AACzBtB,gBAAM,GAAGxB,iBAAiB,CAACoD,uBAA3B;AACH,SAFM,MAGF;AACD5B,gBAAM,GAAGxB,iBAAiB,CAACvf,QAA3B;AACH;;AAED,YAAImgB,UAAU,KAAKZ,iBAAiB,CAACmD,WAArC,EAAkD;AAC9CH,wBAAc,GAAGhD,iBAAiB,CAACmD,WAAnC;AACH;AACJ;;AAED,aAAO;AAAEhD,cAAM,EAAEY,cAAV;AAA0BS,cAAM,EAANA,MAA1B;AAAkCV,iBAAS,EAATA,SAAlC;AAA6CkC,sBAAc,EAAdA;AAA7C,OAAP;AACH,KArJY;;;;;;;;;;;;;;;;;;;;;AC1Kb;AAAA;AAAA;;AAIsE;AAIzD,YAAAhR,oBAAA,GAAuB,QAAAjE,YAAA,CAAa,+BAAb,EAChC,QAAAC,KAAA,EADgC,CAAvB;AAGA,YAAAmE,oBAAA,GAAuB,QAAApE,YAAA,CAAa,+BAAb,CAAvB;AAEA,YAAAuE,gBAAA,GAAmB,QAAAvE,YAAA,CAAa,kCAAb,EAC5B,QAAAC,KAAA,EAD4B,CAAnB;AAGA,YAAAuE,gBAAA,GAAmB,QAAAxE,YAAA,CAAa,kCAAb,CAAnB;AAEA,YAAAqE,iBAAA,GAAoB,QAAArE,YAAA,CAAa,mCAAb,CAApB;;;;;;;;;;;;;;;;;;;ACZA,YAAAsV,wBAAA,GAA2B,EAA3B;AAEA,YAAAC,yBAAA,GAA4B;AACrCtiB,WAAK,EAAE,UAD8B;AAErC+I,aAAO,EAAE;AAF4B,KAA5B;AAKA,YAAAwZ,oBAAA,GAAuB;AAChCviB,WAAK,EAAE,UADyB;AAEhC+I,aAAO,EAAE;AAFuB,KAAvB;AAKA,YAAAyZ,kBAAA,GAA6C,CACtD,QAAAF,yBADsD,EAEtD;AACItiB,WAAK,EAAE,UADX;AAEI+I,aAAO,EAAE;AAFb,KAFsD,CAA7C;AAQA,YAAA0Z,qBAAA,GAAwB;AACjCziB,WAAK,EAAE,GAD0B;AAEjC+I,aAAO,EAAE;AAFwB,KAAxB;AAKA,YAAA2Z,eAAA,GAA0C,CACnD;AACI1iB,WAAK,EAAE,GADX;AAEI+I,aAAO,EAAE;AAFb,KADmD,EAKnD,QAAA0Z,qBALmD,EAMnD;AACIziB,WAAK,EAAE,GADX;AAEI+I,aAAO,EAAE;AAFb,KANmD,CAA1C;AAYA,YAAA4Z,oBAAA,gCACP,QAAAD,eADO,IAET;AACI1iB,WAAK,EAAE,GADX;AAEI+I,aAAO,EAAE;AAFb,KAFS;;AAQA,YAAA6Z,mBAAA,GAAsB,UAACC,QAAD,EAA8B;AAC7D,cAAQA,QAAR;AACI,aAAK,GAAL;AACI,iBAAO,CAAP;;AACJ,aAAK,GAAL;AACI,iBAAO,CAAP;;AACJ,aAAK,GAAL;AACI,iBAAO,EAAP;;AACJ,aAAK,GAAL;AACI,iBAAO,IAAP;AARR;AAUH,KAXY;;AAaA,YAAAC,sBAAA,GAAyB,UAACD,QAAD,EAA8B;AAChE,cAAQA,QAAR;AACI,aAAK,GAAL;AACI,iBAAO,CAAP;;AACJ,aAAK,GAAL;AACI,iBAAO,CAAP;;AACJ;AACI,iBAAO,IAAP;AANR;AAQH,KATY;AAkDb;;;;;AAGa,YAAAE,mBAAA,GAAsB,UAC/B1P,IAD+B,EAEZ;iBAAA,CACnB;;;AACA,UAAM2P,mBAAmB,GAAG3P,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAE8C,QAAN,CACvBzS,MADuB,CAChB,UAACkP,CAAD;AAAA,eAAOA,CAAC,CAACqQ,UAAT;AAAA,OADgB,EAEvBtgB,GAFuB,CAEnB,UAACiQ,CAAD;AAAA,eAAOA,CAAC,CAAC5S,KAAT;AAAA,OAFmB,EAGvBmG,IAHuB,CAGlB,GAHkB,CAA5B;AAIA,aAAO;AACH1I,cAAM,EAAE4V,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAE5V,MADX;AAEHI,gBAAQ,EAAEwV,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAExV,QAFb;AAGHqlB,iBAAS,EAAEF,mBAHR;AAIHG,gBAAQ,EAAE,QAAAP,mBAAA,CAAoB,CAAD,KAACvP,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEwP,QAAN,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAE7iB,KAApC,CAJP;AAKHojB,oBAAY,EAAE,QAAAN,sBAAA,CAAuB,CAAD,KAACzP,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEwP,QAAN,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAE7iB,KAAvC,CALX;AAOHqjB,oBAAY,EAAEhQ,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEgQ,YAPjB;AAQHC,yBAAiB,EAAEjQ,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEiQ,iBARtB;AASHC,2BAAmB,EAAElQ,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEkQ,mBATxB;AAUHC,wBAAgB,EAAEnQ,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEmQ,gBAVrB;AAWHC,wBAAgB,EAAEpQ,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEoQ,gBAXrB;AAYHC,yBAAiB,EAAErQ,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEqQ,iBAZtB;AAaHC,6BAAqB,EAAEtQ,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEsQ,qBAb1B;AAcHC,uBAAe,EAAEvQ,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEuQ,eAdpB;AAeHliB,gBAAQ,EAAE2R,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAE3R,QAfb;AAgBHlB,cAAM,EAAE6S,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAE7S,MAhBX;AAiBHoR,iBAAS,EAAEyB,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEzB,SAjBd;AAkBHoP,gBAAQ,EAAE3N,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAE2N,QAlBb;AAmBH6C,cAAM,EAAExQ,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEwQ;AAnBX,OAAP;AAqBH,KA7BY;;;;;;;;;;;;;;;;;;;;;ACrHb;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAEA,QAAMC,GAAG,GAAG,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAZ;;AAEa,YAAAqnB,sBAAA,GAAyB;AAAA,aAAyB;AAC3D9S,kBAAU,EAAE;AACRxT,gBAAM,EAAEqmB,GADA;AAERjmB,kBAAQ,EAAE,IAAI,oBAAAwkB,wBAFN;AAGRlM,kBAAQ,EAAE,EAHF;AAIR+K,qBAAW,EAAE,oBAAAoB,yBAJL;AAKRO,kBAAQ,EAAE,oBAAAJ;AALF,SAD+C;AAQ3D3R,yBAAiB,EAAE;AARwC,OAAzB;AAAA,KAAzB;;;;;;;;;;;;;;;;;;;;;ACVb;AAAA;AAAA;;AAIA;AAAA;AAAA;;AASA;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAGa,YAAAkT,sBAAA,GACT,UAACnsB,KAAD;AAAA,aACKA,KAAa,CAACosB,WADnB;AAAA,KADS;;AAIA,YAAAC,gBAAA,GAAmB,QAAApS,cAAA,CAAe,QAAAkS,sBAAf,EAAuC,UAAAnsB,KAAK,EAAI;iCAAA,CAC5E;;;AACA,UAAI,QAACA,KAAK,CAACoZ,UAAP,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAExT,MAAnB,CAAJ,EAA+B;AAC3B,eAAO5F,KAAK,CAACoZ,UAAb;AACH;;AAJ2E,iBAKlC,CAAH,KAAGpZ,KAAK,CAACoZ,UAAN,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAExT,MALgB;AAAA,UAKpEX,IALoE,QAKpEA,IALoE;AAAA,UAK9DqnB,WAL8D,QAK9DA,WAL8D;AAAA,UAKjDC,WALiD,QAKjDA,WALiD;;AAM5E,UAAMC,SAAS,GAAG,CAAH,WAAKxsB,KAAK,CAACoZ,UAAX,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAEuS,gBAApB,MAAoC,IAApC,IAAoC,aAApC,GAAoC,MAApC,GAAoC,GAAE1mB,IAAxD;AACA,UAAM0mB,gBAAgB,GAAGa,SAAS,GAAG;AACjCb,wBAAgB,EAAG,IAAI,UAAAxV,MAAJ,CAAW;AAAElR,cAAI,EAAEunB,SAAS,CAAC1kB,OAAV,EAAR;AAA6BwkB,qBAAW,EAAXA,WAA7B;AAA0CC,qBAAW,EAAXA;AAA1C,SAAX;AADc,OAAH,GAE9B,EAFJ;AAIA,UAAMV,iBAAiB,GAAI,OAAA7rB,KAAK,CAACoZ,UAAN,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEyS,iBAAlB,IAC1B;AACAA,yBAAiB,EAAE,CAAF,KAAE7rB,KAAK,CAACoZ,UAAN,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEyS,iBAAF,CAAoB/gB,GAApB,CAAyB,UAAAgB,EAAE,EAAG;AAE/D;AACA;AACA,iBAAO,IAAI,UAAAqK,MAAJ,CAAW;AAAElR,gBAAI,EAAE,OAAO6G,EAAP,KAAc,QAAd,GAAyBA,EAAE,GAAG,IAA9B,GAAqCA,EAAE,CAAC7G,IAAH,CAAQ6C,OAAR,EAA7C;AAAgEwkB,uBAAW,EAAXA,WAAhE;AAA6EC,uBAAW,EAAXA;AAA7E,WAAX,CAAP;AACA,SALiC;AADnC,OAD0B,GAU1B,EAVD;AAaA,UAAME,uBAAuB,GAAKzsB,KAAK,CAACoZ,UAAN,CAAiBlD,MAAjB,KAA4B,mBAAAwW,YAAA,CAAaC,IAAzC,IAAiD3sB,KAAK,CAACoZ,UAAN,CAAiBoS,YAAnE,GAEjC;AACAtU,UAAE,EAAElX,KAAK,CAACoZ,UAAN,CAAiBlC,EADrB;AAEA8U,cAAM,EAAEhsB,KAAK,CAACoZ,UAAN,CAAiB4S,MAFzB;AAGA7C,gBAAQ,EAAEnpB,KAAK,CAACoZ,UAAN,CAAiB+P;AAH3B,OAFiC,GAOhC,EAPD;AAYA,aAAO,MAAP,OAAO,CAAP,4DACOnpB,KAAK,CAACoZ,UADb,GACuB;AACnBxT,cAAM,EAAE,IAAI,UAAAuQ,MAAJ,CAAW;AAAElR,cAAI,EAAEA,IAAI,CAAC6C,OAAL,EAAR;AAAwBwkB,qBAAW,EAAXA,WAAxB;AAAqCC,qBAAW,EAAXA;AAArC,SAAX;AADW,OADvB,GAGOZ,gBAHP,GAIOE,iBAJP,CAAO,EAKJY,uBALI,CAAP;AAOH,KA3C+B,CAAnB;AA6CA,YAAAG,iBAAA,GAAoB,QAAA3S,cAAA,CAAe,QAAAoS,gBAAf,EAC7B,UAACjL,IAAD;AAAA,aAAUA,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEiI,WAAhB;AAAA,KAD6B,CAApB;AAGA,YAAAwD,sBAAA,GAAyB,QAAA5S,cAAA,CAAe,QAAAoS,gBAAf,EAClC,UAACjL,IAAD;AAAA,aAAU,CAAC,CAAAA,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAE9C,QAAN,KAAkB,EAAnB,EAAuBzS,MAAvB,CAA8B,UAAAe,CAAC;AAAA,eAAI,CAACA,CAAC,CAACkgB,WAAP;AAAA,OAA/B,CAAV;AAAA,KADkC,CAAzB;AAGA,YAAAC,gBAAA,GAAmB,QAAA9S,cAAA,CAAe,QAAA2S,iBAAf,EAC5B,UAAC1iB,IAAD;AAAA,aAAU,CAAAA,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAE/B,KAAN,MAAgB,oBAAAsiB,yBAAA,CAA0BtiB,KAApD;AAAA,KAD4B,CAAnB;AAGA,YAAA6kB,iBAAA,GAAoB,QAAA/S,cAAA,CAAe,QAAAkS,sBAAf,EAC7B,UAACnsB,KAAD;AAAA,aAAWA,KAAK,CAACiZ,iBAAN,IAA2B,EAAtC;AAAA,KAD6B,CAApB;AAGb,QAAMgU,0BAA0B,GAAG,QAAAhT,cAAA,CAAe,gBAAAiT,iBAAf,EAC/B,gBAAAC,mBAAA,CAAoBjT,SAApB,CAA8BkT,KADC,CAAnC;AAGA,QAAMC,8BAA8B,GAAG,QAAApT,cAAA,CAAe,gBAAAiT,iBAAf,EACnC,gBAAAI,sBAAA,CAAuBpT,SAAvB,CAAiCkT,KADE,CAAvC;AAGA,QAAMG,kCAAkC,GAAG,QAAAtT,cAAA,CAAe,gBAAAiT,iBAAf,EACvC,gBAAAM,uBAAA,CAAwBtT,SAAxB,CAAkCkT,KADK,CAA3C;AAEA,QAAMK,6BAA6B,GAAG,QAAAxT,cAAA,CAAe,gBAAAiT,iBAAf,EAClC,gBAAAQ,kBAAA,CAAmBxT,SAAnB,CAA6BkT,KADK,CAAtC;AAEA,QAAMO,0BAA0B,GAAG,QAAA1T,cAAA,CAAe,gBAAAiT,iBAAf,EAC/B,gBAAAU,eAAA,CAAgB1T,SAAhB,CAA0BkT,KADK,CAAnC;AAEA,QAAMS,8BAA8B,GAAG,QAAA5T,cAAA,CAAe,gBAAAiT,iBAAf,EACnC,gBAAAY,mBAAA,CAAoB5T,SAApB,CAA8BkT,KADK,CAAvC;AAGa,YAAAW,sCAAA,GAAyC,QAAA9T,cAAA,CAAe,mBAAAlF,oBAAf,EAC9C,mBAAAK,2BAAA,CAA4B8E,SAA5B,CAAsCkT,KADQ,CAAzC;AAEA,YAAAY,sCAAA,GAAyC,QAAA/T,cAAA,CAAe,mBAAAlF,oBAAf,EAClD,mBAAAO,2BAAA,CAA4B4E,SAA5B,CAAsCkT,KADY,CAAzC;AAEA,YAAAa,kCAAA,GAAqC,QAAAhU,cAAA,CAAe,mBAAAlF,oBAAf,EAC1C,mBAAAQ,uBAAA,CAAwB2E,SAAxB,CAAkCkT,KADQ,CAArC;AAEA,YAAAc,uCAAA,GAA0C,QAAAjU,cAAA,CAAe,mBAAAlF,oBAAf,EAC/C,mBAAAS,4BAAA,CAA6B0E,SAA7B,CAAuCkT,KADQ,CAA1C;AAEA,YAAAe,iCAAA,GAAoC,QAAAlU,cAAA,CAAe,mBAAAlF,oBAAf,EACzC,mBAAAU,sBAAA,CAAuByE,SAAvB,CAAiCkT,KADQ,CAApC;AAGb;;;;;AAIA,QAAMgB,qCAAqC,GAAG,SAAxCA,qCAAwC,CAC1C3hB,OAD0C,EAE1C4a,WAF0C,EAG1CjO,UAH0C,EAI1CW,SAJ0C,EAK1CwN,WAL0C,EAKsB;AAChE,UAAM/L,IAAI,GAAG/O,OAAO,CAAC0N,eAArB,CADgE,CAGhE;;AACA,aAAO,CAACf,UAAD,GAAc3M,OAAO,CAAC4hB,MAAR,CAAe;AAChC/G,cAAM,EAAE9L,IADwB;AAEhCmN,cAAM,EAAE,uBAAAxB,iBAAA,CAAkBiD,IAFM;AAGhCnC,iBAAS,EAAE;AAHqB,OAAf,CAAd,GAIFxb,OAAO,CAAC4hB,MAAR,CACD,uBAAAjH,4BAAA,CAA6BC,WAA7B,EAA0C7L,IAA1C,EAAgDpC,UAAhD,EAA4DW,SAAS,IAAIX,UAAU,CAACW,SAApF,EAA+FwN,WAA/F,CADC,CAJL;AAMH,KAfD;;AAiBa,YAAA+G,qBAAA,GAAwB,QAAArU,cAAA,CAAegT,0BAAf,EACjC,QAAAD,iBADiC,EAEjC,QAAAX,gBAFiC,EAGjC,oBAAArS,0BAHiC,EAIjC,eAAA4D,iBAJiC,EAKjCwQ,qCALiC,CAAxB;AAOA,YAAAG,wBAAA,GAA2B,QAAAtU,cAAA,CAAeoT,8BAAf,EACpC,QAAAhB,gBADoC,EAEpC,oBAAArS,0BAFoC,EAGpC,eAAA4D,iBAHoC,EAIpC,UAACnR,OAAD,EAAU2M,UAAV,EAAsBW,SAAtB,EAAiCwN,WAAjC;AAAA,aAAiD6G,qCAAqC,CAAC3hB,OAAD,EAAU,EAAV,EAAc2M,UAAd,EAA0BW,SAA1B,EAAqCwN,WAArC,CAAtF;AAAA,KAJoC,CAA3B;AAMA,YAAAiH,6BAAA,GAAgC,QAAAvU,cAAA,CAAesT,kCAAf,EACzC,QAAAP,iBADyC,EAEzC,QAAAX,gBAFyC,EAGzC,oBAAArS,0BAHyC,EAIzC,eAAA4D,iBAJyC,EAKzCwQ,qCALyC,CAAhC;AAOA,YAAAK,4BAAA,GAA+B,QAAAxU,cAAA,CAAewT,6BAAf,EACxC,QAAAT,iBADwC,EAExC,QAAAX,gBAFwC,EAGxC,oBAAArS,0BAHwC,EAIxC,eAAA4D,iBAJwC,EAKxCwQ,qCALwC,CAA/B;AAQA,YAAAM,yBAAA,GAA4B,QAAAzU,cAAA,CAAe0T,0BAAf,EACrC,QAAAtB,gBADqC,EAErC,oBAAArS,0BAFqC,EAGrC,eAAA4D,iBAHqC,EAIrC,UAACnR,OAAD,EAAU2M,UAAV,EAAsBW,SAAtB,EAAiCwN,WAAjC;AAAA,aAAiD6G,qCAAqC,CAAC3hB,OAAD,EAAU,EAAV,EAAc2M,UAAd,EAA0BW,SAA1B,EAAqCwN,WAArC,CAAtF;AAAA,KAJqC,CAA5B;AAMA,YAAAoH,6BAAA,GAAgC,QAAA1U,cAAA,CAAe4T,8BAAf,EACzC,QAAAb,iBADyC,EAEzC,QAAAX,gBAFyC,EAGzC,oBAAArS,0BAHyC,EAIzC,eAAA4D,iBAJyC,EAKzCwQ,qCALyC,CAAhC;AAOb;;;;AAGa,YAAAQ,6BAAA,GAAgC,QAAA3U,cAAA,CACzC,QAAA4S,sBADyC,EAEzC,oBAAA7S,0BAFyC,EAGzC,UAACqR,SAAD,EAAYtR,SAAZ;AAAA,aAA2BsR,SAAS,CAC/BvgB,GADsB,CAClB,UAAAiQ,CAAC;AAAA,eAAIhB,SAAS,SAAT,IAAAA,SAAS,WAAT,GAAS,MAAT,GAAAA,SAAS,CAAEtR,IAAX,CAAgB,UAAA4E,CAAC;AAAA,iBAAIA,CAAC,CAAC6J,EAAF,KAAS6D,CAAC,CAAC5S,KAAf;AAAA,SAAjB,CAAJ;AAAA,OADiB,EAEtB0D,MAFsB,CAEf,UAAAe,CAAC;AAAA,eAAI,CAAC,CAACA,CAAN;AAAA,OAFc,CAA3B;AAAA,KAHyC,CAAhC;;;;;;;;;;;;;;;;;;;;ACnMb;AAAA;AAAA;;AAOA;AAAA;AAAA;AAEA;;;;;AAGA,QAAMiiB,oBAAoB,GAAG,CAA7B;;AAEa,YAAAC,yBAAA,GAA4B,UACrCpU,IADqC,EAErC4N,QAFqC;AAAA,aAGhB;AACrBpX,eAAO,YAAKoX,QAAQ,CAACtnB,IAAd,cAAsB,OAAAuO,eAAA,CACzB,OAAAL,kBAAA,CAAmBoZ,QAAQ,CAACze,QAA5B,CADyB,CAAtB,CADc;AAIrBklB,wBAAgB,YAAKzG,QAAQ,CAAC0G,IAAd,cAAsB1G,QAAQ,CAACtnB,IAA/B,eAAwCsnB,QAAQ,CAAC2G,OAAjD,CAJK;AAKrB9mB,aAAK,EAAEmgB,QAAQ,CAACpR,EALK;AAMrBgY,eAAO,EAAExU,IANY;AAOrB0Q,kBAAU,EAAE,IAPS;AAQrBzE,oBAAY,YAAK2B,QAAQ,CAACtnB,IAAd,cAAsB,OAAAuO,eAAA,CAC9B,OAAAL,kBAAA,CAAmBoZ,QAAQ,CAACze,QAA5B,CAD8B,CAAtB,CARS;AAWrBmgB,YAAI,EAAE;AAAE1B,kBAAQ,EAARA,QAAF;AAAY5N,cAAI,EAAJA;AAAZ;AAXe,OAHgB;AAAA,KAA5B;;AAiBA,YAAAyU,wBAAA,GAA2B,UACpCzU,IADoC;AAAA,aAEf;AACrBxJ,eAAO,YAAKwJ,IAAI,CAAC1Z,IAAV,4BAAgC,OAAAuO,eAAA,CACnC,OAAAL,kBAAA,CAAmBwL,IAAI,CAAC7Q,QAAxB,CADmC,CAAhC,CADc;AAIrB1B,aAAK,EAAEuS,IAAI,CAAC1Z,IAJS;AAKrB8rB,mBAAW,EAAE,IALQ;AAMrBoC,eAAO,EAAExU,IAAI,CAAC1Z,IANO;AAOrB2lB,oBAAY,YAAKjM,IAAI,CAAC1Z,IAAV,4BAAgC,OAAAuO,eAAA,CACxC,OAAAL,kBAAA,CAAmBwL,IAAI,CAAC7Q,QAAxB,CADwC,CAAhC,CAPS;AAUrBmgB,YAAI,EAAE;AAAEtP,cAAI,EAAJA;AAAF;AAVe,OAFe;AAAA,KAA3B;AAeb;;;;;;AAIa,YAAA0U,qBAAA,GAAwB,UACjCC,OADiC,EAEhC;AACD,UAAMxH,OAAO,GAAwB,EAArC;AACAwH,aAAO,CAAChsB,OAAR,CAAgB,UAAC8E,KAAD,EAAQxH,GAAR,EAAgB;AAC5BknB,eAAO,CAAC/a,IAAR,CAAa,QAAAqiB,wBAAA,CAAyBxuB,GAAzB,CAAb;AACAwH,aAAK,CAAC9E,OAAN,CAAc,UAACgK,CAAD;AAAA,iBACVwa,OAAO,CAAC/a,IAAR,CAAa,QAAAgiB,yBAAA,CAA0BnuB,GAAG,CAACK,IAA9B,EAAoCqM,CAApC,CAAb,CADU;AAAA,SAAd;AAGH,OALD;AAMA,aAAOwa,OAAP;AACH,KAXY;AAab;;;;;;;;;;;;;AAWa,YAAAyH,qBAAA,GAAwB,UACjCzH,OADiC,EAEjC0H,eAFiC,EAGjCC,MAHiC,EAIhC;AACD,UAAID,eAAe,CAAC9mB,IAAhB,CAAqB,UAAC+R,CAAD;AAAA,eAAOA,CAAC,CAACrS,KAAF,KAAYqnB,MAAM,CAACrnB,KAA1B;AAAA,OAArB,CAAJ,EAA2D;AACvD,eAAOonB,eAAe,CAAC1jB,MAAhB,CAAuB,UAAC2O,CAAD,EAAO;AACjC,cAAI3O,MAAM,GAAG2O,CAAC,CAACrS,KAAF,KAAYqnB,MAAM,CAACrnB,KAAhC,CADiC,CAEjC;;AACA,cAAIqnB,MAAM,CAAC1C,WAAX,EAAwB;AACpBjhB,kBAAM,GACFA,MAAM,KACL,CAAC2O,CAAC,CAAC4Q,UAAH,IACI5Q,CAAC,CAAC4Q,UAAF,IAAgB5Q,CAAC,CAAC0U,OAAF,KAAcM,MAAM,CAACN,OAFpC,CADV;AAIH,WALD,MAKO,IAAIM,MAAM,CAACpE,UAAX,EAAuB;AAC1B;AACAvf,kBAAM,GACFA,MAAM,KACL,CAAC2O,CAAC,CAACsS,WAAH,IACItS,CAAC,CAACsS,WAAF,IAAiBtS,CAAC,CAAC0U,OAAF,KAAcM,MAAM,CAACN,OAFrC,CADV;AAIH;;AACD,iBAAOrjB,MAAP;AACH,SAhBM,CAAP;AAiBH,OAnBA,CAoBD;AACA;;;AACA,UAAI2jB,MAAM,CAAC1C,WAAX,EAAwB;AACpB,YAAM2C,QAAQ,GAAG5H,OAAO,CAAChc,MAAR,CACb,UAAC8F,CAAD;AAAA,iBACIA,CAAC,CAACyZ,UAAF,IACAzZ,CAAC,CAACud,OAAF,KAAcM,MAAM,CAACrnB,KADrB,IAEA,CAAConB,eAAe,CAAC9mB,IAAhB,CAAqB,UAACinB,QAAD;AAAA,mBAAcA,QAAQ,CAACvnB,KAAT,KAAmBwJ,CAAC,CAACxJ,KAAnC;AAAA,WAArB,CAHL;AAAA,SADa,CAAjB;AAMA,4CAAWonB,eAAX,IAA4BC,MAA5B,sBAAuCC,QAAvC;AACH,OA9BA,CA+BD;;;AACA,UAAME,QAAQ,gCAAOJ,eAAP,IAAwBC,MAAxB,EAAd,CAhCC,CAkCD;AACA;;AACA,UAAMI,wBAAwB,GAAG/H,OAAO,CAAChc,MAAR,CAC7B,UAACgkB,CAAD;AAAA,eACIA,CAAC,CAACzE,UAAF,IACAyE,CAAC,CAACX,OAAF,KAAcM,MAAM,CAACN,OADrB,IAEA,CAACS,QAAQ,CAAClnB,IAAT,CAAc,UAACqnB,EAAD;AAAA,iBAAQA,EAAE,CAAC3nB,KAAH,KAAa0nB,CAAC,CAAC1nB,KAAvB;AAAA,SAAd,CAHL;AAAA,OAD6B,CAAjC,CApCC,CA0CD;;AACA,UAAIynB,wBAAwB,CAACzoB,MAAzB,KAAoC,CAAxC,EAA2C;AACvC,4CACOwoB,QADP,IAEI9H,OAAO,CAACpf,IAAR,CAAa,UAAConB,CAAD;AAAA,iBAAOA,CAAC,CAAC/C,WAAF,IAAiB+C,CAAC,CAACX,OAAF,KAAcM,MAAM,CAACN,OAA7C;AAAA,SAAb,CAFJ;AAIH;;AACD,aAAOS,QAAP;AACH,KAtDY;AAwDb;;;;;;AAIa,YAAAI,oBAAA,GAAuB,UAChC1E,SADgC,EAEvB;AACT;AACA,UAAI2E,kBAAkB,sBAAO3E,SAAP,CAAtB;;AACA,UAAM4E,cAAc,GAAG5E,SAAS,CAAClkB,MAAV,GAAmB0nB,oBAA1C;;AACA,UAAIoB,cAAJ,EAAoB;AAChBD,0BAAkB,GAAGA,kBAAkB,CAACte,MAAnB,CAA0B,CAA1B,EAA6Bmd,oBAA7B,CAArB;AACH;;AACD,UAAI3d,OAAO,GAAG8e,kBAAkB,CAC3BllB,GADS,CACL,UAACiQ,CAAD;AAAA,eAAOA,CAAC,CAAC4L,YAAF,IAAkB5L,CAAC,CAAC7J,OAA3B;AAAA,OADK,EAET5C,IAFS,CAEJ,IAFI,CAAd;;AAGA,UAAI2hB,cAAJ,EAAoB;AAChB/e,eAAO,kBAAWma,SAAS,CAAClkB,MAArB,MAAP;AACH;;AACD,aAAO+J,OAAP;AACH,KAhBY;;AAkBA,YAAAgf,wBAAA,GAA2B,UACpCC,KADoC;AAAA,aAGpCA,KAAK,GACC;AACIhoB,aAAK,EAAEgoB,KAAK,CAACjZ,EADjB;AAEIhG,eAAO,EAAEif,KAAK,CAACnvB;AAFnB,OADD,GAKCkG,SAR8B;AAAA,KAA3B;AAUb;;;;;;AAIa,YAAAkpB,0BAAA,GAA6B,UAACrW,SAAD,EAA2B;AACjE,UAAMsW,eAAe,GAAG,OAAA1kB,MAAA,CACpBoO,SAAS,CAACnR,MAAV,CAAiB,UAACwK,IAAD,EAAwBkV,QAAxB,EAA+C;AAC5DlV,YAAI,CAACtG,IAAL,OAAAsG,IAAI,qBAASkV,QAAQ,CAACxN,MAAlB,EAAJ;AACA,eAAO1H,IAAP;AACH,OAHD,EAGG,EAHH,CADoB,EAKpB,IALoB,CAAxB;AAOA,aAAO;AACHid,uBAAe,EAAfA,eADG;AAEHtW,iBAAS,EAATA;AAFG,OAAP;AAIH,KAZY;AAcb;;;AAEa,YAAAuW,gBAAA,GAAmB,UAACC,GAAD,EAAyB;AACrD,UAAIhtB,KAAJ;;AACA,UAAIgtB,GAAG,IAAI,CAAX,EAAc;AACVhtB,aAAK,GAAGgtB,GAAR;AACH,OAFD,MAEO,IAAIA,GAAG,GAAG,CAAN,KAAY,CAAhB,EAAmB;AACtBhtB,aAAK,GAAG,CAAR;AACH,OAFM,MAEA;AACHA,aAAK,GAAG,CAAR;AACH;;AACD,oDAAuCA,KAAvC;AACH,KAVY;AAYb;;;;;;AAIa,YAAAitB,eAAA,GAAkB,UAC3BC,kBAD2B,EAE3BC,eAF2B,EAG3BC,aAH2B,EAI3BC,QAJ2B,EAMpB;AAAA,UADPC,YACO,uEADiB,KACjB;AACP,UAAIC,WAAW,GAAUJ,eAAe,CAAC5lB,GAAhB,CAAoB,UAACxH,CAAD;AAAA,eACzCA,CAAC,GAAG;AAAEytB,cAAI,EAAE,QAAAT,gBAAA,CAAiBhtB,CAAjB;AAAR,SAAH,GAAmC,KADK;AAAA,OAApB,CAAzB;AAGAotB,qBAAe,CAACrtB,OAAhB,CAAwB,UAAC2tB,CAAD,EAAO;AAC3B,YAAMC,gBAAgB,aAAMN,aAAN,SAAsBC,QAAtB,mBAAuCI,CAAvC,SAAtB;AACA,YAAME,YAAY,GAAG5S,QAAQ,CAAC6S,QAAT,CAAkBpS,QAAlB,CAA2B,WAA3B,cAA8CT,QAAQ,CAACO,MAAvD,oBAAuEoS,gBAAvE,IAA4FA,gBAAjH;;AACA,YAAI,CAACJ,YAAL,EAAmB;AACf,cAAMO,MAAM,GAAG,IAAIC,KAAJ,EAAf;;AACAD,gBAAM,CAACE,MAAP,GAAgB,YAAM;AAClB;AACAR,uBAAW,CAACE,CAAC,GAAG,CAAL,CAAX,GAAqB;AAAED,kBAAI,EAAEG;AAAR,aAArB;AACAT,8BAAkB,CAACK,WAAnB,sBAAqCA,WAAW,CAAC/lB,KAAZ,EAArC;AACA,aAAA0lB,kBAAkB,SAAlB,IAAAA,kBAAkB,WAAlB,GAAkB,MAAlB,GAAAA,kBAAkB,CAAEc,UAApB,MAAkCd,kBAAkB,SAAlB,IAAAA,kBAAkB,WAAlB,GAAkB,MAAlB,GAAAA,kBAAkB,CAAEc,UAApB,CAA+Bne,IAA/B,oBAAwC0d,WAAW,CAAC/lB,KAAZ,EAAxC,EAAlC;AACH,WALD;;AAMAqmB,gBAAM,CAACI,GAAP,GAAaN,YAAb;AACH,SAZ0B,CAc3B;;;AACA,YAAIL,YAAJ,EAAkB;AACdC,qBAAW,CAACE,CAAC,GAAG,CAAL,CAAX,GAAqB;AAAED,gBAAI,EAAEG;AAAR,WAArB;AACAT,4BAAkB,CAACK,WAAnB,GAAiCA,WAAW,CAAC/lB,KAAZ,EAAjC;AACH;AACJ,OAnBD;AAoBH,KA9BY;;AAgCA,YAAA0mB,oBAAA,GAAuB,UAAC7X,OAAD,EAAsB;AACtD,UAAMqS,GAAG,GAAG,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAZ;AACA,UAAI6sB,KAAK,GAAG,EAAZ;AACA,UAAIC,IAAI,GAAG,EAAX;AACA,UAAIC,KAAK,GAAG,EAAZ;;AAEA,UAAIhY,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE6P,MAAb,EAAqB;AACjB,YAAMA,MAAM,GAAGwC,GAAG,GAAGrS,OAAO,CAAC9J,SAAd,GAA0B,SAA1B,GAAsC8J,OAAO,CAAC6P,MAA7D;;AACA,gBAAQA,MAAR;AACI,eAAK,aAAL;AACIiI,iBAAK,GAAG,mCAAR;AACAE,iBAAK,GAAG,aAAR;AACAD,gBAAI,GAAG,aAAP;AACA;;AACJ,eAAK,UAAL;AACID,iBAAK,GAAG,mCAAR;AACAE,iBAAK,GAAG,WAAR;AACAD,gBAAI,GAAG,WAAP;AACA;;AACJ,eAAK,WAAL;AACID,iBAAK,GAAG,mCAAR;AACAE,iBAAK,GAAG,WAAR;AACAD,gBAAI,GAAG,WAAP;AACA;;AACJ,eAAK,SAAL;AACID,iBAAK,GAAG,iCAAR;AACAE,iBAAK,GAAG,SAAR;AACAD,gBAAI,GAAG,SAAP;AACA;;AACJ,eAAK,WAAL;AACID,iBAAK,GAAG,iCAAR;AACAE,iBAAK,GAAG,WAAR;AACAD,gBAAI,GAAG,SAAP;AACA;;AACJ,eAAK,UAAL;AACID,iBAAK,GAAG,mCAAR;AACAE,iBAAK,GAAG,WAAR;AACAD,gBAAI,GAAG,WAAP;AACA;;AACJ,eAAK,UAAL;AACID,iBAAK,GAAG,mCAAR;AACAE,iBAAK,GAAG,WAAR;AACAD,gBAAI,GAAG,WAAP;AACA;;AACJ;AACI;AACAD,iBAAK,GAAG,iCAAR;AACAE,iBAAK,GAAG,SAAR;AACAD,gBAAI,GAAG,SAAP;AACA;AAzCR;AA2CH;;AACD,aAAO;AAAEA,YAAI,EAAJA,IAAF;AAAQC,aAAK,EAALA,KAAR;AAAeF,aAAK,EAALA;AAAf,OAAP;AACH,KArDY;;AAuDA,YAAAG,oBAAA,GAAuB,UAACvJ,QAAD,EAAqBH,KAArB,EAAsC;AACtE,UAAIoB,WAAW,GAAGjB,QAAQ,GACpBA,QAAQ,CAACkB,YAAT,IAAyBlB,QAAQ,CAACwJ,cADd,GAEpB,KAFN,CADsE,CAItE;;AACA,UAAI,CAAA3J,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAEqB,YAAP,MAAwB,KAA5B,EAAmC;AAC/BD,mBAAW,GAAG,KAAd;AACH;;AACD,aAAOA,WAAP;AACH,KATY;;AAWA,YAAAwI,eAAA,GAAkB,UAACnY,OAAD,EAAmB0O,QAAnB,EAA0C;;;AACrE,UAAMmB,MAAM,GAAG,QAAAgI,oBAAA,CAAqB7X,OAArB,CAAf;AACA,UAAMoY,gBAAgB,GAAG,CAAC,UAAD,EAAa,WAAb,EAA0B,SAA1B,EAAqCjT,QAArC,CACrB0K,MAAM,CAACkI,IADc,CAAzB;AAGA,UAAMM,KAAK,GAAG,CAAH,KAAG3J,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEwJ,cAAV,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,GAAE3sB,KAAxC;AACA,UAAM+sB,MAAM,GAAG,CAAH,KAAG5J,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEwJ,cAAV,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,GAAEK,GAAzC;;AAEA,UAAIH,gBAAJ,EAAsB;AAClB,eAAO,KAAP;AACH;;AAED,UAAI,OAAOC,KAAP,KAAiB,WAAjB,IAAgC,OAAOC,MAAP,KAAkB,WAAtD,EAAmE;AAC/D,eAAO,KAAP;AACH,OAdoE,CAgBrE;;;AACA,UAAME,WAAW,GAAGH,KAAK,GAAG,EAA5B;AACA,UAAMI,YAAY,GAAGH,MAAM,GAAG,EAA9B;AAEA,UAAMI,UAAU,GAAG1Y,OAAO,CAAC/J,WAAR,CAAoBlB,YAApB,CAAiC,KAAjC,CAAnB;AACA,UAAM4jB,gBAAgB,GAAGD,UAAU,CAACxsB,QAAX,CAAoB;AAAEJ,eAAO,EAAE0sB;AAAX,OAApB,CAAzB;AACA,UAAMI,iBAAiB,GAAGF,UAAU,CAACxsB,QAAX,CAAoB;AAAEJ,eAAO,EAAE2sB;AAAX,OAApB,CAA1B;;AAEA,UACIE,gBAAgB,CAAC3jB,EAAjB,IAAuBgL,OAAO,CAAC/J,WAAR,CAAoBjB,EAA3C,IACA4jB,iBAAiB,CAAC5jB,EAAlB,GAAuBgL,OAAO,CAAC/J,WAAR,CAAoBjB,EAF/C,EAGE;AACE;AACA,YAAIgL,OAAO,CAAC9J,SAAR,CAAkBlB,EAAlB,IAAwB2jB,gBAAgB,CAAC3jB,EAA7C,EAAiD;AAC7C,iBAAO,KAAP;AACH,SAJH,CAKE;;;AACA,YAAIgL,OAAO,CAAC/J,WAAR,CAAoBjB,EAApB,GAAyB4jB,iBAAiB,CAAC5jB,EAA/C,EAAmD;AAC/C,iBAAO,KAAP;AACH,SARH,CAUE;;;AACA,YAAIgL,OAAO,CAAC/J,WAAR,CAAoBjB,EAApB,GAAyB,UAAAF,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAAjD,EAAqD;AACjD;AACA,iBAAO,IAAP;AACH;AACJ;;AAED,aAAO,KAAP;AACH,KA7CY;;AA+CA,YAAA6jB,eAAA,GAAkB,UAC3BC,OAD2B,EAE3B9Y,OAF2B,EAGR;AACnB,aAAO,IAAI0H,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAEpC,YAAImR,kBAAkB,GAQlB;AACAC,kBAAQ,EAAEhZ,OAAO,CAACuO,KAAR,CAAcjR,EADxB;AAEAtR,gBAAM,EAAEgU,OAAO,CAAC/J,WAFhB;AAGA7J,kBAAQ,EAAE4T,OAAO,CAAC5T,QAHlB;AAIA2Z,eAAK,EAAE/F,OAAO,CAAC+F,KAAR,CAAc/F,OAAO,CAACuO,KAAR,CAAc9R,KAA5B,CAJP;AAKAwc,mBAAS,EAAEjZ,OAAO,CAACiZ,SAAR,CAAkBjZ,OAAO,CAACuO,KAAR,CAAc9R,KAAhC,CALX;AAMAyc,uBAAa,EAAE;AANf,SARJ;;AAiBA,YAAIlZ,OAAO,CAACmZ,eAAR,KAA4B,QAA5B,IAAwCnZ,OAAO,CAACmZ,eAAR,KAA4B,IAAxE,EAA8E;AAC1EJ,4BAAkB,GAAG,gCACdA,kBADc,GACI;AACrB3G,kBAAM,EAAEpS,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEoZ,OADI;AAErBpH,4BAAgB,EAAEhS,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEgS,gBAFN;AAGrBH,6BAAiB,EAAE7R,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE6R,iBAHP;AAIrBE,4BAAgB,EAAE/R,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE+R,gBAJN;AAKrBD,+BAAmB,EAAE9R,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE8R,mBALT;AAMrBG,6BAAiB,EAAEjS,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEiS,iBANP;AAOrBL,wBAAY,EAAE5R,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE4R,YAPF;AAQrBO,2BAAe,EAAEnS,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEmS;AARL,WADJ,CAArB;AAWH;;AAED2G,eAAO,CACF5I,SADL,CAEQ6I,kBAFR,EAGQ,IAHR,EAIQ,KAJR,EAMKhR,IANL,CAOQ,UAACxe,IAAD,EAAU;AACN,cAAMglB,KAAK,GAAGhlB,IAAI,CAACgE,MAAL,GAAchE,IAAI,CAAC,CAAD,CAAlB,GAAwB,IAAtC;;AACA,cAAIglB,KAAJ,EAAW;AACP,gBAAI,CAACA,KAAK,CAACgB,QAAX,EAAqB,OAAO3H,MAAM,CAAC,cAAD,CAAb;AACrB,gBAAM7B,KAAK,GAAG,CAAA/F,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE+F,KAAT,CAAewI,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAE9R,KAAtB,MAAgC,CAA9C;AACA,gBAAMwc,SAAS,GAAG,CAAAjZ,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEiZ,SAAT,CAAmB1K,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAE9R,KAA1B,MAAoC,CAAtD;AACA,gBAAM4c,UAAU,GAAG,CAAArZ,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE/J,WAAT,CAAqB8G,OAArB,IAA+BgJ,KAAlD;AACA,gBAAMuT,QAAQ,GAAGtZ,OAAO,CAAC9J,SAAR,CAAkB6G,OAAlB,GAA4Bkc,SAA7C;AAEA,gBAAM7d,QAAQ,GAAGmT,KAAK,CAAC/J,QAAN,CAAepJ,QAAhC,CAPO,CAQP;AACA;;AACA,gBAAIA,QAAQ,CAAC7N,MAAb,EAAqB;AACjB,kBAAMgsB,YAAY,GAAGne,QAAQ,CAACvM,IAAT,CAAc,UAAA2qB,GAAG,EAAI;AACtC,oBAAMC,OAAO,GAAGD,GAAG,CAACzT,KAAJ,CAAUwI,KAAK,CAAC9R,KAAhB,KAA0B,CAA1C;AACA,oBAAMid,WAAW,GAAGF,GAAG,CAACzT,KAAJ,CAAUwI,KAAK,CAAC9R,KAAhB,KAA0B,CAA9C;AACA,oBAAMlR,KAAK,GAAG,CAACiuB,GAAG,CAACrc,WAAJ,IAAmBqc,GAAG,CAACjuB,KAAxB,IAAiCkuB,OAA/C;AACA,oBAAMlB,GAAG,GAAG,CAACiB,GAAG,CAAC3c,SAAJ,IAAiB2c,GAAG,CAACjB,GAAtB,IAA6BmB,WAAzC;AACA,uBAAO,CACFJ,QAAQ,GAAG/tB,KAAX,IAAoB+tB,QAAQ,IAAIf,GAAjC,IAAyC;AACxCc,0BAAU,IAAI9tB,KAAd,IAAuB8tB,UAAU,GAAGd,GADrC,IAC6C;AAC5Cc,0BAAU,IAAI9tB,KAAd,IAAuB+tB,QAAQ,IAAIf,GAHjC,CAGsC;AAHtC,qBAIFiB,GAAG,CAAClc,EAAJ,KAAW0C,OAAO,CAAC1C,EAJjB,KAKD0C,OAAO,CAACmZ,eAAR,KAA4B,QAA5B,IAAwCnZ,OAAO,CAACmZ,eAAR,KAA4B,IAArE,GAEGK,GAAG,CAACG,oBAAJ,KAA6B3Z,OAAO,CAAC1C,EAFxC,GAIG,KATD,CAAP;AAcH,eAnBoB,CAArB,CADiB,CAqBjB;;AACA,kBAAIic,YAAJ,EAAkB,OAAO3R,MAAM,CAAC,sBAAD,CAAb;AACrB;;AACD,mBAAOD,OAAO,CAAC4G,KAAK,CAACgB,QAAP,CAAd;AACH;;AACD3H,gBAAM,CAAC,iBAAD,CAAN;AACH,SA9CT,EA+CQ;AAAA,iBAAMA,MAAM,CAAC,iBAAD,CAAZ;AAAA,SA/CR;AAiDH,OAlFM,CAAP;AAmFH,KAvFY;;AAyFA,YAAAgS,qBAAA,GAAwB,UAAC/J,MAAD,EAAqB;AACtD,UAAItf,GAAG,GAAG,EAAV;;AACA,cAAQsf,MAAR;AACD,aAAK,GAAL;AACCtf,aAAG,GAAG,+IAAN;AACA;;AACD,aAAK,GAAL;AACCA,aAAG,GAAG,qDAAN;AACA;;AACD,aAAK,GAAL;AACCA,aAAG,GAAG,0DAAN;AACA;;AACD;AACCA,aAAG,GAAG,iDAAN;AAXA;;AAaA,aAAOA,GAAP;AACH,KAhBY;;;;;;;;;;;;;;;;;;;;;;;;;ACrbb;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;QCHaspB,oB,GAOT,8BAAmBtL,KAAnB,EACmBgI,KADnB,EAEmB7H,QAFnB,EAEwC;AAAA;;;;AAFrB,WAAAH,KAAA,GAAAA,KAAA;AACA,WAAAgI,KAAA,GAAAA,KAAA;AACA,WAAA7H,QAAA,GAAAA,QAAA;AAEf,WAAKoL,YAAL,mBAA6B,iBAAKvL,KAAL,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAEgI,KAAZ,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEwD,UAAhD;AACA,WAAK/B,KAAL,GAAa,KAAKzJ,KAAL,CAAWyL,UAAxB;AACA,WAAKC,MAAL,GAAc,KAAKvL,QAAL,cAAoB,WAAKA,QAAL,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAE0G,IAAnC,eAA4C,WAAK1G,QAAL,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEtnB,IAA3D,IAAoE,EAAlF;AACA,WAAKsqB,QAAL,uBAA6B,KAAKnD,KAAL,CAAWmD,QAAxC;AACH,K;;AAfL;AAkBA;;;;AAGa,YAAAwI,sBAAA,GAAyB,UAACrnB,OAAD,EACC4jB,eADD,EAECtW,SAFD;AAAA,aAGlCtN,OAAO,CAAC3B,GAAR,CAAY,UAACG,CAAD,EAAc;AACtB,YAAMklB,KAAK,GAAGE,eAAe,CAAC5nB,IAAhB,CAAqB,UAAAsS,CAAC;AAAA,iBAAI9P,CAAC,CAACsd,KAAF,CAAQxJ,QAAR,CAAiBhE,CAAC,CAAC7D,EAAnB,CAAJ;AAAA,SAAtB,CAAd;AACA,YAAMoR,QAAQ,GAAGvO,SAAS,CAACtR,IAAV,CAAe,UAAA4E,CAAC;AAAA,iBAAIpC,CAAC,CAACsd,KAAF,CAAQxJ,QAAR,CAAiB1R,CAAC,CAAC6J,EAAnB,CAAJ;AAAA,SAAhB,CAAjB;AACA,eAAO,IAAIuc,oBAAJ,CACHxoB,CADG,EAEHklB,KAFG,EAGH7H,QAHG,CAAP;AAKH,OARD,CAHkC;AAAA,KAAzB;;;;;;;;;;;;;;;;;;;;;ACzBb;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AASA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;QAqBayL,mB;;;;;AA4FT,mCACYC,IADZ,EAEYC,OAFZ,EAGYC,MAHZ,EAG0B;AAAA;;AAAA;;AAEtB;AAJQ,gBAAAF,IAAA,GAAAA,IAAA;AACA,gBAAAC,OAAA,GAAAA,OAAA;AACA,gBAAAC,MAAA,GAAAA,MAAA;AA9FZ;;AACQ,gBAAAC,KAAA,GAAQ,IAAI,OAAAzzB,eAAJ,CAA6B,KAA7B,CAAR;AACR;;AACQ,gBAAA0zB,UAAA,GAAa,IAAI,OAAA1zB,eAAJ,CAAkC,EAAlC,CAAb;AACA,gBAAA2zB,eAAA,GAAkB,IAAI,OAAA3zB,eAAJ,CAAiC,EAAjC,CAAlB;AACR;;AACQ,gBAAA4zB,SAAA,GAAY,IAAI,OAAA5zB,eAAJ,CAA+B,EAA/B,CAAZ;AACR;;AACO,gBAAA6zB,aAAA,GAAgB,IAAI,OAAA7zB,eAAJ,CAAwB,EAAxB,CAAhB;AACP;;AACQ,gBAAA8zB,QAAA,GAAW,IAAI,OAAA9zB,eAAJ,CAAoC,EAApC,CAAX;AACR;;AACQ,gBAAA+zB,OAAA,GAAU,IAAI,OAAA/zB,eAAJ,CAA4B,UAAAgO,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAA5B,CAAV;AACR;;AACQ,gBAAAiX,KAAA,GAAQ,IAAI,OAAApb,eAAJ,CAA4B,GAA5B,CAAR;AACR;;AACQ,gBAAAg0B,QAAA,GAAW,IAAI,OAAAh0B,eAAJ,CAA6B,KAA7B,CAAX;AACR;;AACQ,gBAAAi0B,MAAA,GAAS,OAAAC,aAAA,CACb,QAAKN,SADQ,EAEb,QAAKE,QAFQ,EAGb,QAAKC,OAHQ,EAIb,QAAK3Y,KAJQ,CAAT;AAOR;;AACgB,gBAAA9G,QAAA,GAAW,QAAKsf,SAAL,CAAe/W,YAAf,EAAX;AAChB;;AACgB,gBAAA3X,MAAA,GAAS,QAAK6uB,OAAL,CAAalX,YAAb,EAAT;AAChB;AAAkC;;AAClB,gBAAAnO,IAAA,GAAO,QAAKqlB,OAAL,CAAalX,YAAb,EAAP;AAChB;;AACgB,gBAAAW,OAAA,GAAU,QAAKwW,QAAL,CAAcnX,YAAd,EAAV;AAWhB;;AACgB,gBAAAsX,QAAA,GAAW,QAAKF,MAAL,CAAY5e,IAAZ,CACvB,YAAAjL,GAAA,CAAI,UAAC9K,KAAD,EAAW;AACX,cAAM80B,IAAI,GAAG,QAAKjrB,QAAL,GACP,IAAI,UAAAsM,MAAJ,CAAW;AACPlR,gBAAI,EAAE,QAAK8vB,YAAL,CAAkBnmB,EADjB;AAEP0d,uBAAW,EAAE,KAFN;AAGPC,uBAAW,EAAE,QAAK1iB;AAHX,WAAX,CADO,GAMP,QAAKkrB,YANX;AAOA,cAAMC,OAAO,GAAGF,IAAI,CAACnmB,YAAL,CAAkB,KAAlB,CAAhB;AACA,cAAMsmB,KAAK,GAAGD,OAAO,CAAClvB,QAAR,CAAiB,EAAjB,EAAqBovB,UAArB,CAAgC,KAAhC,CAAd;AACA,iBAAO,QAAKC,cAAL,CAAoBH,OAApB,EAA6BC,KAA7B,CAAP;AACH,SAXD,CADuB,EAavB,YAAAG,WAAA,CAAY,CAAZ,CAbuB,CAAX;AAgBhB;;AACgB,gBAAAC,aAAA,GAAgB,QAAKV,MAAL,CAAY5e,IAAZ,CAC5B,YAAAjL,GAAA,CAAI,YAAM;AACN;AACA,cAAMwqB,EAAE,GAAG,QAAKzrB,QAAL,GACT,IAAI,UAAAsM,MAAJ,CAAW;AACPlR,gBAAI,EAAE,QAAK8vB,YAAL,CAAkBnmB,EADjB;AAEP0d,uBAAW,EAAE,KAFN;AAGPC,uBAAW,EAAE,QAAK1iB;AAHX,WAAX,CADS,GAMT,QAAKkrB,YANP;AAOA,cAAM5vB,KAAK,GAAGmwB,EAAE,CAAC3mB,YAAH,CAAgB,MAAhB,EAAwBA,YAAxB,CAAqC,KAArC,CAAd;;AACA,cAAMwjB,GAAG,GAAG,QAAKoD,YAAL,CAAkBD,EAAlB,CAAZ;;AACA,iBAAO,QAAKH,cAAL,CAAoBhwB,KAApB,EAA2BgtB,GAA3B,CAAP;AACH,SAZD,CAD4B,CAAhB;AAgBhB;;AACgB,gBAAAqD,cAAA,GAAiB,QAAKb,MAAL,CAAY5e,IAAZ,CAC7B,YAAAjL,GAAA,CAAI,YAAM;AACN,cAAM3F,KAAK,GAAG,QAAK4vB,YAAL,CAAkBpmB,YAAlB,CAA+B,OAA/B,CAAd;;AACA,cAAMwjB,GAAG,GAAG,QAAK4C,YAAL,CAAkBG,UAAlB,CAA6B,OAA7B,CAAZ;;AACA,iBAAO,QAAKC,cAAL,CAAoBhwB,KAApB,EAA2BgtB,GAA3B,CAAP;AACH,SAJD,CAD6B,CAAjB;;AAoBZ,gBAAK6B,IAAL,CAAUxW,WAAV,CAAsBzH,IAAtB,CAA2B,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,iBAAOA,CAAP;AAAA,SAAN,CAA3B,EAA4CvZ,SAA5C,CAAsD,YAAM;iBAAA,CACxD;;;AACA,kBAAKuxB,OAAL,CAAarhB,IAAb,CACI,IAAI,UAAA+C,MAAJ,CAAW;AACPlR,gBAAI,EAAE,QAAKwvB,OAAL,CAAatsB,KAAb,CAAmByG,EADlB;AAEP0d,uBAAW,EAAE,KAFN;AAGPC,uBAAW,EAAE,CAAF,KAAE,QAAKyH,IAAL,CAAU1L,QAAV,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEze;AAH1B,WAAX,CADJ;AAOH,SATD;AAWA;;;AACA,YAAM4rB,MAAM,GAAG,OAAAb,aAAA,CAAc,QAAKT,KAAnB,EAA0B,QAAKrY,KAA/B,EAAsC,QAAK2Y,OAA3C,EAAoD1e,IAApD,CACX,YAAAlK,MAAA,CAAO,UAACvI,CAAD;AAAA,iBAAO,CAAC,CAACA,CAAC,CAAC,CAAD,CAAV;AAAA,SAAP,CADW,EAEX,YAAAoyB,YAAA,CAAa,GAAb,CAFW,EAGX,YAAAC,SAAA,CAAU,YAAM;AACZ,cAAMC,KAAK,GAAG,QAAK9Z,KAAL,CAAWra,QAAX,EAAd;;AACA,cAAI,CAACm0B,KAAL,EAAY;AACR,mBAAO,OAAAjS,EAAA,CAAG,EAAH,CAAP;AACH;;AACD,kBAAK+Q,QAAL,CAActhB,IAAd,CAAmB,IAAnB;;AACA,cAAMjO,KAAK,GAAG,QAAK4vB,YAAL,CAAkBpmB,YAAlB,CAA+B,KAA/B,CAAd;;AACA,cAAMwjB,GAAG,GAAGhtB,KAAK,CAAC+vB,UAAN,CAAiB,KAAjB,CAAZ;AACA,iBAAO,QAAKjB,OAAL,CAAa4B,YAAb,CAA0B;AAC7BC,oBAAQ,EAAEF,KADmB;AAE7BG,0BAAc,EAAE5wB,KAAK,CAACwR,OAFO;AAG7Bqf,wBAAY,EAAE7D,GAAG,CAACxb;AAHW,WAA1B,CAAP;AAKH,SAbD,CAHW,EAiBX,YAAA8M,UAAA,CAAW;AAAA,iBAAM,OAAAE,EAAA,CAAG,EAAH,CAAN;AAAA,SAAX,CAjBW,CAAf;AAoBA,YAAMsS,gBAAgB,GAAG,OAAArB,aAAA,CACrB,QAAKP,eADgB,EAErB,QAAKvY,KAFgB,EAGrB,QAAK2Y,OAHgB,EAIvB1e,IAJuB,CAKrB,YAAAlK,MAAA,CAAO,UAACvI,CAAD;AAAA,iBAAO,CAAC,CAACA,CAAC,CAAC,CAAD,CAAV;AAAA,SAAP,CALqB,EAMrB,YAAAoyB,YAAA,CAAa,GAAb,CANqB,EAOrB,YAAAC,SAAA,CAAU,UAACxgB,KAAD,EAAW;AACjB,cAAMjL,IAAI,GAAGiL,KAAK,CAAC,CAAD,CAAlB;AACA,cAAMygB,KAAK,GAAGzgB,KAAK,CAAC,CAAD,CAAnB;AACA,cAAMvP,MAAM,GAAGuP,KAAK,CAAC,CAAD,CAApB;;AACA,cAAI,CAACygB,KAAL,EAAY;AACR,mBAAO,OAAAjS,EAAA,CAAG,EAAH,CAAP;AACH;;AACD,kBAAK+Q,QAAL,CAActhB,IAAd,CAAmB,IAAnB;;AACA,iBAAO,QAAK8iB,UAAL,CAAgBhsB,IAAhB,EAAsB0rB,KAAtB,EAA6BhwB,MAA7B,EAAqC,KAArC,CAAP;AACH,SATD,CAPqB,EAiBrB,YAAA6d,UAAA,CAAW,UAACnU,CAAD,EAAO;AACd,iBAAO,OAAAqU,EAAA,CAAG,EAAH,CAAP;AACF,SAFF,CAjBqB,CAAzB;AAsBA;;AACA8R,cAAM,CAACvyB,SAAP,CAAiB,UAACizB,UAAD,EAAgB;AAC7B,kBAAKC,eAAL,CAAqBD,UAArB;;AACA,kBAAKzB,QAAL,CAActhB,IAAd,CAAmB,KAAnB;AACH,SAHD;AAIA6iB,wBAAgB,CAAC/yB,SAAjB,CAA2B,UAACizB,UAAD,EAAgB;AACvC,kBAAKC,eAAL,CAAqBD,UAArB,EAAiC,QAAK9B,eAAL,CAAqB5yB,QAArB,EAAjC;;AACA,kBAAKizB,QAAL,CAActhB,IAAd,CAAmB,KAAnB;AACH,SAHD;AA/DsB;AAmEzB;;;;;AAED;;;8CAGuD;AAAA;;AAAA,cAA3BijB,UAA2B,uEAAL,KAAK;AACnD,iBAAO,OAAAzB,aAAA,CACH,KAAKR,UADF,EAEH,KAAKtY,KAFF,EAGH,KAAK2Y,OAHF,EAIL1e,IAJK,CAKH,YAAAlK,MAAA,CAAO,UAACvI,CAAD;AAAA,mBAAO,CAAC,CAACA,CAAC,CAAC,CAAD,CAAV;AAAA,WAAP,CALG,EAMH,YAAAoyB,YAAA,CAAa,GAAb,CANG,EAOH,YAAAC,SAAA,CAAU,UAACxgB,KAAD,EAAW;AACjB,gBAAMjL,IAAI,GAAGiL,KAAK,CAAC,CAAD,CAAlB;AACA,gBAAMygB,KAAK,GAAGS,UAAU,GAAG,OAAI,CAACrC,IAAL,CAAU1L,QAAV,CAAmBpR,EAAtB,GAA2B/B,KAAK,CAAC,CAAD,CAAxD;AACA,gBAAMvP,MAAM,GAAGuP,KAAK,CAAC,CAAD,CAApB;;AACA,gBAAI,CAACygB,KAAL,EAAY;AACR,qBAAO,OAAAjS,EAAA,CAAG,EAAH,CAAP;AACH;;AACD,mBAAI,CAAC+Q,QAAL,CAActhB,IAAd,CAAmB,IAAnB;;AACA,mBAAO,OAAI,CAAC8iB,UAAL,CAAgBhsB,IAAhB,EAAsB0rB,KAAtB,EAA6BhwB,MAA7B,EAAqCywB,UAArC,CAAP;AACH,WATD,CAPG,EAiBH,YAAA5S,UAAA,CAAW,UAACnU,CAAD,EAAO;AACd,mBAAO,OAAAqU,EAAA,CAAG,EAAH,CAAP;AACF,WAFF,CAjBG,CAAP;AAqBH;;;mCAEkBzZ,I,EAAc0rB,K,EAAehwB,M,EAA6C;AAAA,cAA7BywB,UAA6B,uEAAP,KAAO;;AACzF,cAAMlxB,KAAK,GAAG,SAARA,KAAQ,GAAM;AAChB,gBAAMqV,CAAC,GAAG5U,MAAV;;AACA,gBAAIsE,IAAI,KAAK,MAAb,EAAqB;AACjB,qBAAOsQ,CAAC,CAAC7L,YAAF,CAAe,MAAf,CAAP;AACH,aAFD,MAEO;AACH,qBAAO6L,CAAC,CAAC7L,YAAF,CAAe,OAAf,CAAP;AACH;AACJ,WAPD;;AASA,cAAMwjB,GAAG,GAAG,SAANA,GAAM,GAAM;AACd,gBAAM7iB,CAAC,GAAGnK,KAAK,EAAf;;AACA,gBAAI+E,IAAI,KAAK,MAAb,EAAqB;AACjB;;;;AAIA,qBAAOoF,CAAC,CAACxJ,QAAF,CAAW;AAAEwwB,oBAAI,EAAE;AAAR,eAAX,EAAwBpB,UAAxB,CAAmC,MAAnC,CAAP;AACH,aAND,MAMO;AACH,qBAAO5lB,CAAC,CAAC4lB,UAAF,CAAa,OAAb,CAAP;AACH;AACD;;;;;AAIH,WAfD,CAVyF,CA2BzF;;;AACA,iBAAO,KAAKjB,OAAL,CAAa4B,YAAb,CAA0B,MAAD,OAAC,CAAD;AAC5BC,oBAAQ,EAAEF,KADkB;AAE5BG,0BAAc,EAAE5wB,KAAK,GAAGwR,OAFI;AAG5Bqf,wBAAY,EAAE7D,GAAG,GAAGxb;AAHQ,WAAC,EAIzB0f,UAAD,GAAe;AAAEE,uBAAW,EAAE;AAAf,WAAf,GAAuC,EAJb,CAA1B,CAAP;AAMH;;;+CAG6B;AAAA;;AAC1B,eAAKnC,UAAL,CAAgBhhB,IAAhB,CAAqB,OAArB;;AACA,eAAKojB,mBAAL,CAAyB,IAAzB,EAA+BtzB,SAA/B,CAAyC,UAACuzB,MAAD,EAAY;AACjD,mBAAI,CAAClC,aAAL,CAAmBnhB,IAAnB,CAAwBqjB,MAAxB;;AACA,mBAAI,CAAC/B,QAAL,CAActhB,IAAd,CAAmB,KAAnB;AACH,WAHD;AAIH;AAED;;;;;;;mCAIkBsjB,O,EAAyB;AACvC,eAAKlC,QAAL,CAAcphB,IAAd,CAAmBsjB,OAAnB;AACH;AAED;;;;;;;gCAIe9wB,M,EAAgB;AAC3B,eAAK6uB,OAAL,CAAarhB,IAAb,CAAkBxN,MAAlB;AACH;AAED;;;;;;;gCAIewJ,I,EAAc;AACzB,eAAK0M,KAAL,CAAW1I,IAAX,CAAgBhE,IAAhB;AACH;AAED;;;;;;mCAGe;AACX,eAAK+kB,KAAL,CAAW/gB,IAAX,CAAgB,IAAhB;AACH;AAED;;;;;;;uCAI+C;AAAA;;AAAA,cAA3BlS,KAA2B,uEAAX,KAAK,IAAM;;AAC3C,eAAKizB,KAAL,CAAW/gB,IAAX,CAAgB,IAAhB;;AACA,eAAK8gB,MAAL,CAAYyC,iBAAZ,CAA8B,YAAM;AAChC,mBAAI,CAACC,QAAL,CAAc,SAAd,EAAyB;AAAA,qBAAM,OAAI,CAACzC,KAAL,CAAW/gB,IAAX,CAAgB,IAAhB,CAAN;AAAA,aAAzB,EAAsDlS,KAAtD;AACH,WAFD;AAGH;AAED;;;;;;;2CAIqD;AAAA;;AAAA,cAA7BA,KAA6B,uEAAb,IAAI,EAAJ,GAAS,IAAI;;AACjD,eAAKmzB,eAAL,CAAqBjhB,IAArB,CAA0B,MAA1B;;AACA,eAAK8gB,MAAL,CAAYyC,iBAAZ,CAA8B,YAAM;AAChC,mBAAI,CAACC,QAAL,CACI,cADJ,EAEI;AAAA,qBAAM,OAAI,CAACvC,eAAL,CAAqBjhB,IAArB,CAA0B,MAA1B,CAAN;AAAA,aAFJ,EAGIlS,KAHJ;AAKH,WAND;AAOH;AACD;;;;;;;mDAI4D;AAAA;;AAAA,cAA5BA,KAA4B,uEAAX,KAAK,IAAM;;AACxD,eAAKizB,KAAL,CAAW/gB,IAAX,CAAgB,IAAhB;;AACA,eAAK8gB,MAAL,CAAYyC,iBAAZ,CAA8B,YAAM;AAChC,mBAAI,CAACC,QAAL,CAAc,SAAd,EAAyB;AAAA,qBAAM,OAAI,CAACzC,KAAL,CAAW/gB,IAAX,CAAgB,IAAhB,CAAN;AAAA,aAAzB,EAAsDlS,KAAtD;AACH,WAFD;AAGH;AAED;;;;;;;4CAIwD;AAAA;;AAAA,cAA/BA,KAA+B,uEAAf,IAAI,EAAJ,GAAS,IAAM;;AACpD,eAAKkzB,UAAL,CAAgBhhB,IAAhB,CAAqB,OAArB;;AACA,eAAK8gB,MAAL,CAAYyC,iBAAZ,CAA8B,YAAM;AAChC,mBAAI,CAACC,QAAL,CACI,cADJ,EAEI;AAAA,qBAAM,OAAI,CAACxC,UAAL,CAAgBhhB,IAAhB,CAAqB,OAArB,CAAN;AAAA,aAFJ,EAGIlS,KAHJ;AAKH,WAND;AAOH;AAGD;;;;;;sCAGqB;AACjB,eAAKizB,KAAL,CAAW/gB,IAAX,CAAgB,KAAhB;;AACA,eAAKtS,aAAL,CAAmB,SAAnB;;AACA,eAAKszB,UAAL,CAAgBhhB,IAAhB,CAAqB,EAArB;;AACA,eAAKtS,aAAL,CAAmB,cAAnB;AACH;;;yCAEuB;AACpB,eAAKmzB,OAAL,CAAa4C,cAAb;AACH;AAED;;;;;;;4BAIWjd,O,EAAkB;AACzB,cAAM5E,QAAQ,GAAG,KAAKsf,SAAL,CAAe7yB,QAAf,EAAjB;;AACA,cAAMq1B,YAAY,GAAG9hB,QAAQ,CAAC+hB,MAAT,CAAgB,CAACnd,OAAD,CAAhB,CAArB;;AACA,eAAK0a,SAAL,CAAelhB,IAAf,CAAoB0jB,YAApB;AACH;AAED;;;;;;;gCAIeld,O,EAAkB;AAC7B,cAAM5E,QAAQ,GAAG,KAAKsf,SAAL,CAAe7yB,QAAf,EAAjB;;AACA,cAAMq1B,YAAY,GAAG9hB,QAAQ,CACxBnJ,MADgB,CAEb,UAACunB,GAAD;AAAA,mBACIA,GAAG,CAACJ,OAAJ,KAAgBpZ,OAAO,CAACoZ,OAAxB,IAAmCI,GAAG,CAAClc,EAAJ,KAAW0C,OAAO,CAAC1C,EAD1D;AAAA,WAFa,EAKhB6f,MALgB,CAKT,CAACnd,OAAD,CALS,CAArB;;AAMA,eAAK0a,SAAL,CAAelhB,IAAf,CAAoB0jB,YAApB;AACH;AAED;;;;;;;+BAIcld,O,EAAkB;AAC5B,cAAM5E,QAAQ,GAAG,KAAKsf,SAAL,CAAe7yB,QAAf,EAAjB;;AACA,cAAMq1B,YAAY,GAAG9hB,QAAQ,CAACnJ,MAAT,CACjB,UAACunB,GAAD;AAAA,mBAASA,GAAG,CAACJ,OAAJ,KAAgBpZ,OAAO,CAACoZ,OAAjC;AAAA,WADiB,CAArB;;AAGA,eAAKsB,SAAL,CAAelhB,IAAf,CAAoB0jB,YAApB;AACH;;;uCAGGld,O,EAEqB;AAAA,cADrB1D,MACqB,uEADU,SACV;AAAA,cAArB8gB,IAAqB,uEAAL,KAAK;;AAErB,cAAMhiB,QAAQ,GAAG,KAAKsf,SAAL,CAAe7yB,QAAf,EAAjB;;AACA,cAAMw1B,mBAAmB,GAAI,UAAC/gB,MAAD,EAAY;AACrC,mBAAO,UAACghB,GAAD,EAAkB;AACrB,sBAAQhhB,MAAR;AACI,qBAAK,SAAL;AAAgB;AACZ,wBAAMihB,cAAc,GAAGniB,QAAQ,CAACvM,IAAT,CACnB,UAAC2qB,GAAD;AAAA,6BAASA,GAAG,CAACJ,OAAJ,KAAgBpZ,OAAO,CAACoZ,OAAjC;AAAA,qBADmB,CAAvB;AAGA,wBAAI,CAACmE,cAAL,EAAqB,OAAO,KAAP;AACrB,2BAAOD,GAAG,CAAChgB,EAAJ,KAAW0C,OAAO,CAAC1C,EAA1B;AACH;;AACD,qBAAK,QAAL;AAAe;AACX,wBAAMigB,eAAc,GAAGniB,QAAQ,CAACvM,IAAT,CACnB,UAACyuB,GAAD;AAAA,6BACIA,GAAG,CAAChgB,EAAJ,MACC0C,OAAO,CAACmZ,eAAR,KAA4B,YAA5B,GACKnZ,OAAO,CAAC2Z,oBADb,GAEK3Z,OAAO,CAAC1C,EAHd,CADJ;AAAA,qBADmB,CAAvB;;AAOA,wBAAI,CAACigB,eAAL,EAAqB,OAAO,KAAP;AACrB,2BACIA,eAAc,CAACjgB,EAAf,KAAsBggB,GAAG,CAAChgB,EAA1B,IACAggB,GAAG,CAAC3D,oBAAJ,KAA6B4D,eAAc,CAACjgB,EAFhD;AAIH;;AACD;AACI;AAvBR;AAyBH,aA1BD;AA2BH,WA5B2B,CA4BzBhB,MA5ByB,CAA5B;;AA8BA,cAAM4gB,YAAY,GAAG,mBAAI9hB,QAAJ,EAAclK,GAAd,CAAkB,UAACosB,GAAD,EAAS;AAC5C,gBAAI,CAACF,IAAD,IAASC,mBAAmB,CAACC,GAAD,CAAhC,EAAuC;AACnCA,iBAAG,CAACD,mBAAJ,GAA0B/gB,MAA1B;AACH;;AAED,gBAAI8gB,IAAI,IAAIC,mBAAmB,CAACC,GAAD,CAA/B,EAAsC;AAClCA,iBAAG,CAACD,mBAAJ,GAA0B,IAA1B;AACH;;AAED,mBAAOC,GAAP;AACH,WAVoB,CAArB;;AAYA,eAAK5C,SAAL,CAAelhB,IAAf,CAAoB0jB,YAApB;AACH;;;wCAGGX,U,EACwC;AAAA;;AAAA,cAAxCiB,MAAwC,uEAAL,KAAK;;AAExC,cAAMjyB,KAAK,GAAG,SAARA,KAAQ,GAAM;AAChB,oBAAQiyB,MAAR;AACI,mBAAK,OAAL;AACI,uBAAO,OAAI,CAACrC,YAAL,CAAkBpmB,YAAlB,CAA+B,OAA/B,CAAP;;AACJ,mBAAK,MAAL;AACI,uBAAO,OAAI,CAAComB,YAAL,CAAkBpmB,YAAlB,CAA+B,MAA/B,CAAP;;AACJ;AACI,uBAAO,OAAI,CAAComB,YAAL,CAAkBpmB,YAAlB,CAA+B,KAA/B,CAAP;AANR;AAQH,WATD;;AAUA,cAAMwjB,GAAG,GAAG,SAANA,GAAM,GAAM;AACd,gBAAM3X,CAAC,GAAGrV,KAAK,EAAf;;AACA,oBAAQiyB,MAAR;AACI,mBAAK,OAAL;AACI,uBAAO5c,CAAC,CAAC0a,UAAF,CAAa,OAAb,CAAP;;AACJ,mBAAK,MAAL;AACI,uBAAO1a,CAAC,CAAC0a,UAAF,CAAa,MAAb,CAAP;;AACJ;AACI,uBAAO1a,CAAC,CAAC0a,UAAF,CAAa,KAAb,CAAP;AANR;AAQH,WAVD;;AAYA,cAAIlgB,QAAQ,GAAG,KAAKsf,SAAL,CAAe7yB,QAAf,EAAf;;AACA00B,oBAAU,CAAC9yB,OAAX,CAAmB,UAAC8kB,KAAD,EAAW;AAC1B,mBAAQnT,QAAQ,GAAG,oBAAAqiB,eAAA,CACfriB,QADe,EAEfmT,KAAK,CAACnT,QAAN,CAAelK,GAAf,CAAmB,UAACsoB,GAAD;AAAA,qBAAS,IAAI,gBAAAzJ,OAAJ,CAAYyJ,GAAZ,CAAT;AAAA,aAAnB,CAFe,EAGf;AACIkE,wBAAU,EAAEnP,KAAK,CAAC9R,KADtB;AAEIkhB,oBAAM,EAAEpyB,KAAK,EAFjB;AAGIqyB,kBAAI,EAAErF,GAAG;AAHb,aAHe,CAAnB;AASH,WAVD;;AAWA,eAAKmC,SAAL,CAAelhB,IAAf,CAAoB4B,QAApB;AACH;;;uCAEsBggB,O,EAAiBC,K,EAAe;AACnD,cAAMvoB,OAAO,GAAG,KAAK8nB,QAAL,CAAc/yB,QAAd,EAAhB;;AACA,cAAMuT,QAAQ,GAAG,KAAKsf,SAAL,CAAe7yB,QAAf,EAAjB;;AACA,cAAMm0B,KAAK,GAAG,KAAK9Z,KAAL,CAAWra,QAAX,EAAd;;AACA,iBAAOuT,QAAQ,CAACnJ,MAAT,CAAgB,UAACunB,GAAD,EAAS;;;AAC5B,gBAAMqE,UAAU,GAAG,oBAAAC,oBAAA,CACf1C,OAAO,CAACpmB,EADO,EAEfqmB,KAAK,CAACrmB,EAFS,EAGfwkB,GAAG,CAACvjB,WAAJ,CAAgBjB,EAHD,EAIfwkB,GAAG,CAACtjB,SAAJ,CAAclB,EAJC,CAAnB;AAMA,gBAAM+oB,OAAO,GAAGvE,GAAG,CAACwE,IAAJ,CAASrP,KAAT,CAAexJ,QAAf,CAAwB6W,KAAxB,CAAhB;AACA,gBAAMiC,SAAS,GACX,QAACnrB,OAAO,CAACorB,YAAT,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAE3wB,MAAvB,KACAuF,OAAO,CAACorB,YAAR,CAAqB/Y,QAArB,CAA8BqU,GAAG,CAACwE,IAAJ,CAASvhB,KAAvC,CAFJ;AAGA,gBAAM0hB,QAAQ,GACV,QAACrrB,OAAO,CAACopB,QAAT,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAE3uB,MAAnB,KACA,CAAC,CAACisB,GAAG,CAACwE,IAAJ,CAASrP,KAAT,CAAe9f,IAAf,CAAoB,UAAC2G,IAAD;AAAA,qBAClB1C,OAAO,CAACopB,QAAR,CAAiB/W,QAAjB,CAA0B3P,IAA1B,CADkB;AAAA,aAApB,CAFN;AAKA,gBAAMlF,IAAI,GAAGkpB,GAAG,CAAC4E,QAAJ,GAAe,UAAf,GAA4B5E,GAAG,CAAC6E,OAAJ,EAAzC;AAEA,gBAAMC,IAAI,GACN,QAACxrB,OAAO,CAACyrB,SAAT,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEhxB,MAApB,KACA,CAACuF,OAAO,CAACyrB,SAAR,CAAkBpZ,QAAlB,CAA2B7U,IAA3B,CAFL;AAGA,mBAAOutB,UAAU,IAAII,SAAd,IAA2BF,OAA3B,IAAsCI,QAAtC,IAAkDG,IAAzD;AACH,WAtBM,CAAP;AAuBH;AAED;;;;qCACqBjzB,I,EAAY;AAC7B,iBAAOA,IAAI,CAACmzB,WAAL,KAAqB,CAArB,GACDnzB,IAAI,CAACa,QAAL,CAAc;AAAEwwB,gBAAI,EAAE;AAAR,WAAd,EAA2BpB,UAA3B,CAAsC,MAAtC,EAA8CA,UAA9C,CAAyD,KAAzD,CADC,GAEDjwB,IAAI,CAACiwB,UAAL,CAAgB,MAAhB,EAAwBA,UAAxB,CAAmC,KAAnC,CAFN;AAGH;;;4BA7cyB;AACtB;AACA,iBAAO,KAAKT,OAAL,CAAatsB,KAApB;AACH;;;4BAEqB;AAClB,iBAAO+W,YAAY,CAACC,OAAb,CAAqB,oBAArB,CAAP;AACH;AA6CD;;;;4BACqB;AACjB,iBAAO,KAAKqV,QAAL,CAAc/yB,QAAd,EAAP;AACH;;;;MA1FoC,OAAApB,S;;AAHzC;;;uBAGa0zB,mB,EAAmB,mC,EAAA,6B,EAAA,sB;AAAA,K;;;aAAnBA,mB;AAAmB,eAAnBA,mBAAmB,K;AAAA,kBAFhB;;;;;2BAEHA,mB,EAAmB;cAH/B,OAAAjc,UAG+B;eAHpB;AACR6I,oBAAU,EAAE;AADJ,S;AAGoB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtChC;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AASA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;QAuBagJ,O;;;;;AAuHT,yBAAoC;AAAA;;AAAA,YAAxB9I,QAAwB,uEAAJ,EAAI;;AAAA;;;;AAChC,qCAAMA,QAAN;AAvEJ;;AACO,gBAAAwX,YAAA,GAAe,KAAf,CAqE6B,CAEhC;;AACA,YAAM/V,eAAe,GAAG,wBAAAH,cAAA,CAAeC,UAAf,CAA0B,mBAAAkW,eAA1B,CAAxB;AACA,gBAAKC,YAAL,GAAoBjW,eAAe,CAACQ,SAApC;AAEA;;;;AAGA,YAAM0V,KAAK,GAAG,IAAI,UAAAriB,MAAJ,EAAd;AAEA,YAAMsiB,YAAY,GAAG,EAArB,CAXgC,CAWP;;AACzB,YAAMC,oBAAoB,GAAG,CAAH,WAAGC,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEC,cAAN,EAAH,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAIC,eAAJ,EAApB,MAAuC,IAAvC,IAAuC,aAAvC,GAAuC,MAAvC,GAAuC,GAAIC,QAAxE;AACA,YAAMC,mBAAmB,GAAG,IAA5B,CAbgC,CAaC;;AACjC,YAAMC,iBAAiB,GAAG,QAAAC,IAAA,CAAKC,WAAL,IAAoB,IAAI,QAAAD,IAAJ,EAA9C,CAdgC,CAc0B;;AAC1D,YAAME,kBAAkB,GAAG,UAA3B;AAEA;;;;AAGA,gBAAKvH,KAAL,GAAa/Q,QAAQ,CAAC+Q,KAAT,IAAkB6G,YAA/B;AACA,gBAAK5uB,QAAL,GAAgBgX,QAAQ,CAAChX,QAAT,IAAqB6uB,oBAArC,CArBgC,CAsBhC;;AACA,gBAAKU,aAAL,GAAqBvY,QAAQ,CAACuY,aAAT,IAA0BL,mBAA/C;AACA,gBAAK5nB,IAAL,GAAY0P,QAAQ,CAAC1P,IAAT,IAAiB,EAA7B,CAxBgC,CAyBhC;;AACA,gBAAKkoB,YAAL,GAAoBxY,QAAQ,CAACwY,YAAT,IAAyBF,kBAA7C,CA1BgC,CA2BhC;;AACA,gBAAKG,SAAL,GAAiB,CAACzY,QAAQ,CAACyY,SAAT,IAAsB,EAAvB,EAA2BxuB,GAA3B,CAA+B,UAACxH,CAAD;AAAA,iBAAO,IAAI,QAAA21B,IAAJ,CAAS31B,CAAT,CAAP;AAAA,SAA/B,CAAjB,CA5BgC,CA6BhC;;AACA,gBAAKi2B,SAAL,GAAiB1Y,QAAQ,CAAC0Y,SAAT,GAAqB,IAAI,QAAAN,IAAJ,CAASpY,QAAQ,CAAC0Y,SAAlB,CAArB,GAAoDP,iBAArE,CA9BgC,CA+BhC;;AACA,gBAAKQ,OAAL,GAAe,CAAC3Y,QAAQ,CAAC4Y,SAAT,GAAqB,IAAI,QAAAR,IAAJ,CAASpY,QAAQ,CAAC4Y,SAAlB,CAArB,GAAoDT,iBAArD,KAA2E,QAAKO,SAA/F,CAhCgC,CAiChC;;AACA,gBAAK5Z,KAAL,GAAakB,QAAQ,CAAClB,KAAT,IAAkB,EAA/B;AACA,gBAAKkT,SAAL,GAAiBhS,QAAQ,CAACgS,SAAT,IAAsB,EAAvC,CAnCgC,CAoChC;;AACA,gBAAK6G,KAAL,GAAa7Y,QAAQ,CAAC6Y,KAAT,IAAkB,EAA/B;AACA,gBAAKC,eAAL,GAAuB9Y,QAAQ,CAAC8Y,eAAT,IAA4B,EAAnD;AACA,gBAAKC,kBAAL,GAA0B/Y,QAAQ,CAAC+Y,kBAAT,IAA+B,EAAzD;AACA,gBAAKC,SAAL,GAAiBhZ,QAAQ,CAACgZ,SAAT,IAAsB,EAAvC;AACA,gBAAKC,YAAL,GAAoB,OAAAjZ,QAAQ,CAACiZ,YAAT,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAE3yB,MAAvB,IAAgC0Z,QAAQ,CAACiZ,YAAzC,GAAwD,CAAC,CAAD,KAAC,QAAKP,SAAL,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAEv4B,IAAjB,CAA5E;AACA,gBAAK+4B,OAAL,GAAelZ,QAAQ,CAACkZ,OAAT,IAAoB,EAAnC,CA1CgC,CA2ChC;;AACA,gBAAKN,SAAL,GAAiB5Y,QAAQ,CAAC4Y,SAA1B;AACA,gBAAKO,MAAL,GAAcnZ,QAAQ,CAACmZ,MAAvB;AACA,gBAAKC,gBAAL,GAAwBpZ,QAAQ,CAACoZ,gBAAjC;AACA,gBAAKC,UAAL,GAAkBrZ,QAAQ,CAACqZ,UAA3B;AACA,gBAAKC,OAAL,GAAetZ,QAAQ,CAACsZ,OAAxB;AAEA;;;;;;;;AAOA,gBAAKvC,IAAL,GAAY/W,QAAQ,CAAC+W,IAAT,GAAgB,IAAI,cAAAxP,KAAJ,CAAUvH,QAAQ,CAAC+W,IAAnB,CAAhB,GAA2C,IAAI,cAAAxP,KAAJ,EAAvD;AAEA,YAAMgS,OAAO,GAAGvZ,QAAQ,CAACuZ,OAAT,IAAoBvZ,QAAQ,CAAC+R,QAA7C,CA3DgC,CA2DsB;;AACtD,YAAI,CAAC,QAAKgF,IAAL,CAAU1gB,EAAX,KAAiBkjB,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEjzB,MAA1B,CAAJ,EAAsC;AAClC,kBAAKywB,IAAL,GAAY,SAAAyC,SAAA,CAAUD,OAAO,CAAC,CAAD,CAAjB,KAAyB,QAAKxC,IAA1C;AACH;AACD;;;;;;;AAOA;;;AACA,YAAM0C,cAAc,GAAG,IAAI,UAAAnkB,MAAJ,CAAW;AAAElR,cAAI,EAAEuzB,KAAK,CAAC5pB,EAAd;AAAkB0d,qBAAW,EAAE,KAA/B;AAAsCC,qBAAW,EAAE,QAAK1iB;AAAxD,SAAX,EAA+EhE,QAA/E,CAAwF;AAAEP,gBAAM,EAAEC,IAAI,CAACC,IAAL,CAAUgzB,KAAK,CAAC9yB,OAAN,GAAgB,CAA1B,IAA+B;AAAzC,SAAxF,CAAvB;AAEA;;;;;;;AAMA,YAAM60B,kBAAkB,GAAG,CAAC,EAAE1Z,QAAQ,CAAC9J,WAAT,IAAwB8J,QAAQ,CAAC1b,KAAnC,CAA5B;AACA,YAAMq1B,mBAAmB,GAAG,CAAC,CAAC3Z,QAAQ,CAAChR,WAAvC;AAEA;;;;AAGA,YAAI,CAAC0qB,kBAAD,IAAuBC,mBAA3B,EAAgD;AAC5C;;;;;AAKA,kBAAK3qB,WAAL,GAAmBgR,QAAQ,CAAChR,WAA5B;AACA,kBAAKC,SAAL,GAAiB+Q,QAAQ,CAAC/Q,SAA1B;AACH,SARD,MAQO,IAAIyqB,kBAAJ,EAAwB;AAC3B;;;;AAIA,kBAAK1qB,WAAL,GAAmB,IAAI,UAAAsG,MAAJ,CAAW;AAC1BlR,gBAAI,EAAG,CAAC4b,QAAQ,CAAC9J,WAAT,IAAwB8J,QAAQ,CAAC1b,KAAlC,IAA2C,IADxB;AAE1BmnB,uBAAW,EAAE,KAFa;AAG1BC,uBAAW,EAAE,QAAK1iB;AAHQ,WAAX,CAAnB;AAKA,kBAAKiG,SAAL,GAAiB,IAAI,UAAAqG,MAAJ,CAAW;AACxBlR,gBAAI,EAAG,CAAC4b,QAAQ,CAACpK,SAAT,IAAsBoK,QAAQ,CAACsR,GAAhC,IAAsC,IADrB;AAExB7F,uBAAW,EAAE,KAFW;AAGxBC,uBAAW,EAAE,QAAK1iB;AAHM,WAAX,CAAjB;AAKH,SAfM,MAeA;AACH;;;;AAIA,kBAAKgG,WAAL,GAAmByqB,cAAnB;AACA,kBAAKxqB,SAAL,GAAiBwqB,cAAc,CAACx0B,QAAf,CAAwB;AAAEJ,mBAAO,EAAE;AAAX,WAAxB,CAAjB;AAA0D;AAC7D;AAED;;;;;;;;;AAOA,YAAK,QAAKoK,SAAL,CAAepK,OAAf,GAAyB,CAA1B,KAAiC,CAAjC,IAAsC,QAAKoK,SAAL,CAAezK,MAAf,GAAwB,CAAlE,EAAqE;AACjE;AACA,kBAAKyK,SAAL,GAAiB,QAAKA,SAAL,CAAejK,QAAf,CAAwB;AAAER,kBAAM,EAAE,CAAV;AAAaC,kBAAM,EAAEC,IAAI,CAACk1B,KAAL,CAAW,QAAK3qB,SAAL,CAAepK,OAAf,GAAyB,CAApC,IAAyC;AAA9D,WAAxB,CAAjB;AACH;AAID;;;;;;;;;AAOA,gBAAKg1B,aAAL,GAAqB7Z,QAAQ,CAAC6Z,aAAT,IAA0BlC,KAAK,CAAC7hB,OAArD;AAGA;;;;;;;;AAOA,YAAI,aAAakK,QAAjB,EAA2B;AACvB,kBAAK8Z,OAAL,GAAe9Z,QAAQ,CAAC8Z,OAAxB;AACH,SAFD,MAEO;AACH,kBAAKA,OAAL,GAAe,CAAC,CAAC9Z,QAAQ,CAAC8Z,OAAX,IAAsB,QAAK30B,QAAL,GAAgB,KAAK,EAA1D;AACH,SAxJ+B,CA2JhC;;;AACA,YAAI,CAAC,QAAKuyB,YAAN,IAAsB,QAAKoC,OAA3B,IAAsC,QAAK9wB,QAA/C,EAAyD;AACrD;;;AAGA,kBAAKgG,WAAL,GAAmB,QAAKA,WAAL,CAAiBlB,YAAjB,CAA8B,KAA9B,CAAnB;AACH;AAED;;;;;AAGC,YAAI8a,MAAM,GAAG5I,QAAQ,CAAC4I,MAAtB,CAtK+B,CAuK/B;;AACA,YAAI,CAAC5I,QAAQ,CAAC4I,MAAd,EAAsB;AACnBA,gBAAM,GAAG,UAAT;AACF,SA1K8B,CA2K/B;;;AACA,YAAI5I,QAAQ,CAAC+Z,OAAT,IAAoB/Z,QAAQ,CAAC+Z,OAAT,KAAqB,WAA7C,EAA0D;AACvDnR,gBAAM,GAAG,UAAT;AACF;;AACD,YAAMoR,cAAc,GAAG,EAAvB;AACAA,sBAAc,CAAC,QAAKjD,IAAL,CAAUvhB,KAAX,CAAd,GAAkCoT,MAAlC,CAhL+B,CAiL/B;;AACA,gBAAKA,MAAL,GAAcA,MAAd;AACA,gBAAKqR,eAAL,GAAuBja,QAAQ,CAACia,eAAT,IAA4B,EAAnD;AAED;;;;;;AAMA,gBAAKC,QAAL,GAAgB,CAACla,QAAQ,CAACka,QAAT,YAA6B/oB,KAA7B,GAAqC6O,QAAQ,CAACka,QAA9C,GAAyD,EAA1D,EAA8DjwB,GAA9D,CACZ,UAACxH,CAAD;AAAA,iBAAO,IAAI,WAAA03B,aAAJ,CAAkB13B,CAAlB,CAAP;AAAA,SADY,CAAhB;AAMA;;;;;;;;AAOA,YAAM23B,aAAa,GAAGjpB,KAAK,CAACsB,OAAN,CAAcuN,QAAQ,CAACqa,KAAvB,IAChBra,QAAQ,CAACqa,KADO,GAEhB,OAAAvvB,MAAA,CACE,OAAAqH,OAAA,CACIf,MAAM,CAACpH,IAAP,CAAYgW,QAAQ,CAACqa,KAAT,IAAkB,EAA9B,EAAkCpwB,GAAlC,CAAsC,UAAC8sB,IAAD,EAAU;AAC5C,iBAAO,OAAA5kB,OAAA,CAAQf,MAAM,CAACkpB,MAAP,CAActa,QAAQ,CAACqa,KAAT,CAAetD,IAAf,CAAd,CAAR,CAAP;AACH,SAFD,CADJ,CADF,CAFN;AASA,gBAAKsD,KAAL,GAAaD,aAAb;AAEA;;;;;;;AAMA,gBAAKrP,gBAAL,GAAwB/K,QAAQ,CAAC+K,gBAAT,IAA6B,IAArD;AACA,gBAAKG,eAAL,GAAuBlL,QAAQ,CAACkL,eAAT,IAA4B,IAAnD;AACA,gBAAKqP,gBAAL,GAAwBva,QAAQ,CAACua,gBAAT,IAA6B,IAArD;AACA,gBAAKzP,gBAAL,GAAwB9K,QAAQ,CAACwa,cAAT,GAA0B,IAAI,UAAAllB,MAAJ,CAAW;AAAClR,cAAI,EAAE4b,QAAQ,CAACwa,cAAT,GAA0B,IAAjC;AAAuC/O,qBAAW,EAAE,KAApD;AAA2DC,qBAAW,EAAE,QAAK1iB;AAA7E,SAAX,CAA1B,GAA+H,IAAvJ;AACA,gBAAKiiB,qBAAL,GAA6BjL,QAAQ,CAACiL,qBAAT,IAAkC,IAA/D;AACA,gBAAKwP,cAAL,GAAsBza,QAAQ,CAACya,cAAT,IAA2B,IAAjD;AACA,gBAAK5P,mBAAL,GAA2B7K,QAAQ,CAAC6K,mBAAT,IAAgC,IAA3D;AACA,gBAAKD,iBAAL,GAAyB5K,QAAQ,CAAC4K,iBAAT,IAA8B,IAAvD;AACA,gBAAKsH,eAAL,GAAuBlS,QAAQ,CAACkS,eAAT,IAA4B,IAAnD;AACA,gBAAKQ,oBAAL,GAA4B1S,QAAQ,CAAC0S,oBAArC;AACA,gBAAKgI,kBAAL,GAA0B1a,QAAQ,CAAC0a,kBAAnC;AACA,gBAAK/P,YAAL,GAAoB3K,QAAQ,CAAC2K,YAAT,IAA0B,CAAC,CAAC,QAAKuH,eAAP,IAA0B,CAAC,CAAC,QAAKtH,iBAA3D,IAAiF,IAArG;AACA,gBAAKI,iBAAL,GAAyBhL,QAAQ,CAACgL,iBAAT,IAA8B,EAAvD;AACA,gBAAK9U,WAAL,GAAmB8J,QAAQ,CAAC9J,WAA5B;AACA,gBAAKN,SAAL,GAAiBoK,QAAQ,CAACpK,SAA1B;AAEA;;;;;AAIA,YAAIoK,QAAQ,CAAC1P,IAAT,IAAiB,CAAC,QAAKuoB,KAAL,CAAWjxB,IAAX,CAAgB,UAACnF,CAAD;AAAA,iBAAOA,CAAC,CAAC4G,IAAF,KAAW,aAAlB;AAAA,SAAhB,CAAtB,EAAwE;AACpE,kBAAKwvB,KAAL,gCACO,QAAKA,KADZ,IAEI;AACIxvB,gBAAI,EAAE,aADV;AAEIjF,gBAAI,EAAE,CAFV;AAGI2X,mBAAO,EAAEiE,QAAQ,CAAC1P,IAHtB;AAIIqqB,kBAAM,EAAE,QAAKjC,SAAL,CAAeljB;AAJ3B,WAFJ;AASH;AAED;;;;;;AAIA,gBAAK4gB,mBAAL,GAA2BpW,QAAQ,CAACoW,mBAAT,IAAgC,IAA3D;AA7PgC;AA8PnC;AA/QD;;;;;;AAqeA;;;gCAGY;AACR,iBAAO,IAAItN,OAAJ,CAAY,KAAKtI,MAAL,EAAZ,CAAP;AACH;AAED;;;;;;oCAG+B;AAAA,cAAdoa,MAAc,uEAAL,KAAK;AAC3B,iBAAO,IAAI9R,OAAJ,CAAY,MAAD,OAAC,CAAD,kBACX,KAAKtI,MAAL,EADW,CAAC,EACC;AAChBnK,cAAE,EAAEukB,MAAM,GAAG,KAAKvkB,EAAR,GAAa;AADP,WADD,CAAZ,CAAP;AAIH;AAED;;;;;;;;6BAKYuS,M,EAA8D;AAAA,cAA/BiS,IAA+B,uEAAF,EAAE;AACtE,iBAAO,KAAKva,QAAL,CAAc6V,IAAd,CACH,KAAK9f,EADF,EACMuS,MAAM,IAAI,QADhB,EAEHiS,IAFG,CAAP;AAIH;AAED;;;;;;kCAG6C;AAAA,cAA/BA,IAA+B,uEAAF,EAAE;;AACzC,cAAI,KAAKxkB,EAAT,EAAa;AACT,mBAAO,KAAKiK,QAAL,WAAqB,KAAKjK,EAA1B,EAA8B,MAAF,OAAE,CAAF,EAAE,EAAKwkB,IAAL,CAA9B,CAAP,CADS,CAGT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH;AACJ;AAED;;;;;;iCAGa;;;AACT,cAAIlgB,IAAI,sEAAR,CADS,CAET;;;AACAA,cAAI,CAACke,KAAL,GAAa1nB,KAAK,CAACsB,OAAN,CAAckI,IAAI,CAACke,KAAnB,IAA4Ble,IAAI,CAACke,KAAL,CAAW7tB,MAAX,CAAkB,UAAC8vB,IAAD;AAAA,mBAAUA,IAAI,CAACzxB,IAAL,KAAc,aAAxB;AAAA,WAAlB,CAA5B,GAAuFsR,IAAI,CAACke,KAAzG,CAHS,CAIT;;AACAle,cAAI,CAACoc,IAAL,GAAYpc,IAAI,CAACoc,IAAL,CAAUvW,MAAV,EAAZ;AAGA7F,cAAI,CAAC+d,SAAL,GAAiB/d,IAAI,CAAC+d,SAAL,CAAelY,MAAf,EAAjB;AACA7F,cAAI,CAACge,OAAL,GAAe,OAAAhe,IAAI,CAACge,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAEnY,MAAd,IAAuB7F,IAAI,CAACge,OAAL,CAAanY,MAAb,EAAvB,GAA8C7F,IAAI,CAACge,OAAlE,CATS,CAUT;;AACAhe,cAAI,CAAC8d,SAAL,GAAiB9d,IAAI,CAAC8d,SAAL,CAAexuB,GAAf,CAAmB,UAACxH,CAAD;AAAA,mBAAaA,CAAC,CAAC+d,MAAF,EAAb;AAAA,WAAnB,CAAjB,CAXS,CAaT;;AACA7F,cAAI,GAAG,mBAAAogB,sBAAA,CAAuBpgB,IAAvB,CAAP;;AAEA,cAAGA,IAAI,CAACqgB,eAAR,EAAwB;AACpBrgB,gBAAI,CAACqQ,iBAAL,sBAA6BrQ,IAAI,CAACqgB,eAAlC;AACA,mBAAOrgB,IAAI,CAACqgB,eAAZ;AACH;;AAED,iBAAOrgB,IAAP;AACH;AAED;;;;;;oCAGgB;;;AACZ,cAAIA,IAAI,sEAAR,CADY,CAGZ;;;AACAA,cAAI,CAACwX,OAAL,GAAe,EAAf;;AACA,cAAIxX,IAAI,CAACtE,EAAT,EAAa;AACTsE,gBAAI,CAACwX,OAAL,GAAexX,IAAI,CAACtE,EAApB;AACAsE,gBAAI,CAACsgB,aAAL,GAAqB,KAAKlE,IAAL,CAAUhE,UAA/B;AACApY,gBAAI,CAACugB,SAAL,GAAiB,KAAKnE,IAAL,CAAUvhB,KAA3B;AACAmF,gBAAI,CAAC4d,aAAL,GAAqB,CAAH,KAAG,KAAKxB,IAAL,CAAUtP,QAAV,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEpR,EAAzC;AACH;AAED;;;;;;;AAKAsE,cAAI,CAACwgB,OAAL,GAAe,KAAKpS,YAApB,CAjBY,CAiBsB;;AAClCpO,cAAI,CAACoO,YAAL,GAAoB,CAAC,KAAKA,YAAN,CAApB,CAlBY,CAkB6B;AACzC;AAEA;;AACA,iBAAOpO,IAAI,CAAC3L,WAAZ;AACA,iBAAO2L,IAAI,CAAC1L,SAAZ;AACA0L,cAAI,CAACrW,KAAL,GAAa,KAAK0K,WAAL,CAAiB8G,OAA9B;AACA6E,cAAI,CAAC2W,GAAL,GAAW,KAAKriB,SAAL,CAAe6G,OAA1B;AACA6E,cAAI,CAACygB,SAAL,GAAiB,KAAKpsB,WAAL,CAAiB8G,OAAlC,CA1BY,CA0B+B;;AAC3C6E,cAAI,CAAC0gB,OAAL,GAAe,KAAKpsB,SAAL,CAAe6G,OAA9B,CA3BY,CA2B2B;AAEvC;;AACA,iBAAO6E,IAAI,CAACkf,aAAZ;AACAlf,cAAI,CAAC2gB,aAAL,GAAqB,KAAKC,cAAL,CAAoBzlB,OAAzC,CA/BY,CAiCZ;AACA;;AACA6E,cAAI,CAACuf,QAAL,GAAgB,KAAKsB,cAArB;AACA7gB,cAAI,CAACgO,YAAL,GAAoB,KAAKA,YAAzB;AACA,iBAAOhO,IAAI,CAAC6gB,cAAZ,CArCY,CAuCZ;AACA;;AACA7gB,cAAI,CAAC8d,SAAL,GAAiB,KAAKgD,YAAL,CAAkBxxB,GAAlB,CAAsB,UAACxH,CAAD;AAAA,mBAAaA,CAAC,CAAC+d,MAAF,GAAW/d,CAAC,CAAC+d,MAAF,EAAX,GAAwB/d,CAArC;AAAA,WAAtB,CAAjB,CAzCY,CA2CZ;;AACAkY,cAAI,CAAC+d,SAAL,GAAiB/d,IAAI,CAAC+d,SAAL,CAAelY,MAAf,GAAwB7F,IAAI,CAAC+d,SAAL,CAAelY,MAAf,EAAxB,GAAkD7F,IAAI,CAAC+d,SAAxE;AACA/d,cAAI,CAACge,OAAL,GAAehe,IAAI,CAACge,OAAL,CAAanY,MAAb,GAAsB7F,IAAI,CAACge,OAAL,CAAanY,MAAb,EAAtB,GAA8C7F,IAAI,CAACge,OAAlE,CA7CY,CA+CZ;;AACA,iBAAOhe,IAAI,CAACqe,SAAZ;AACAre,cAAI,CAAC+gB,UAAL,GAAkB,KAAKC,aAAvB,CAjDY,CAmDZ;AAEA;;AACAhhB,cAAI,CAACoX,QAAL,GAAgB,CAAC,KAAKgF,IAAL,CAAUvhB,KAAX,CAAhB;AACA,iBAAOmF,IAAI,CAACoc,IAAZ,CAvDY,CAyDZ;;AACApc,cAAI,GAAG,mBAAAogB,sBAAA,CAAuBpgB,IAAvB,CAAP;;AAGA,cAAGA,IAAI,CAACqgB,eAAR,EAAwB;AACpBrgB,gBAAI,CAACqQ,iBAAL,sBAA6BrQ,IAAI,CAACqgB,eAAlC;AACA,mBAAOrgB,IAAI,CAACqgB,eAAZ;AACH,WAhEW,CAkEZ;;;AACA,iBAAOrgB,IAAI,CAACxa,IAAZ;AACA,iBAAOwa,IAAI,CAACnF,KAAZ;AACA,iBAAOmF,IAAI,CAAC+c,YAAZ,CArEY,CAsEZ;AACA;;AAEA,iBAAO/c,IAAP;AACH;;;kCAEa;;;AACV,cAAI,CAAC,IAAD,KAAK,MAAI,KAAKiO,MAAT,MAAe,IAAf,IAAe,aAAf,GAAe,MAAf,GAAe,GAAE1K,QAAF,CAAW,SAAX,CAApB,CAAJ,EAA+C;AAC3C,mBAAO,WAAP;AACH;;AACD,cAAMsa,YAAY,GAAG,KAAKA,YAA1B;;AACA,cAAIA,YAAY,KAAK,UAAjB,IAA+B,KAAKoD,YAAxC,EAAsD;AAClD,mBAAO,UAAP;AACH;;AACD,iBAAOpD,YAAP;AACH;AAED;;;;kDACiCkC,kB,EAAyD;AACtF,cAAMt2B,IAAI,GAAG,CAAAs2B,kBAAkB,SAAlB,IAAAA,kBAAkB,WAAlB,GAAkB,MAAlB,GAAAA,kBAAkB,CAAEzwB,GAApB,CAAwB,UAAA4xB,SAAS;AAAA,mBAAIA,SAAJ;AAAA,WAAjC,EACZvvB,IADY,CACP,UAACC,CAAD,EAAIC,CAAJ;AAAA,mBAAU,IAAIxI,IAAJ,CAASuI,CAAC,CAAC2J,WAAF,GAAgB,IAAzB,EAA+B4lB,OAA/B,KAA2C,IAAI93B,IAAJ,CAASwI,CAAC,CAAC0J,WAAF,GAAgB,IAAzB,EAA+B4lB,OAA/B,EAArD;AAAA,WADO,EAEZppB,OAFY,GAGZqpB,KAHY,GAIZ7lB,WAJY,IAIE,IAJf;AAKA,iBAAO,IAAI,UAAAZ,MAAJ,CAAW;AAAClR,gBAAI,EAAJA,IAAD;AAAOqnB,uBAAW,EAAE,KAApB;AAA2BC,uBAAW,EAAE,KAAK1iB;AAA7C,WAAX,CAAP;AACH;;;4BAjpB0B;AACvB,iBAAO,KAAKgzB,iBAAZ;AACH,S;0BAE2B53B,I,EAAc;AACtC,eAAK43B,iBAAL,GAAyB53B,IAAzB;AACH;AA2QD;;;;4BACyB;AACrB,iBAAO,wBAAAkd,cAAA,CAAeC,UAAf,CAA0BuH,OAA1B,CAAP;AACH;AAED;;;;4BACuB;AACnB;AACA,cAAI,KAAK4O,YAAT,EAAuB;AACnB,mBAAO,IAAP;AACH;;AACD,iBAAO,CAAC,KAAKX,IAAL,CAAUkF,SAAV,CAAoB;AACxBl3B,kBAAM,EAAE,KAAKiK,WADW;AAExB7J,oBAAQ,EAAE,KAAKA,QAFS;AAGxBuY,gBAAI,EAAE,KAAKgb;AAHa,WAApB,CAAR;AAKH;AAED;;;;4BACmB;AACf,iBAAO,CAAC,KAAKvB,QAAN,IAAkB,CAAC,KAAK+E,SAA/B;AACH;AAED;;;;4BACuB;AACnB,iBAAO,OAAApxB,MAAA,CAAO,CAAC,KAAK4tB,SAAN,EAAiBxC,MAAjB,CAAwB,KAAKuC,SAA7B,CAAP,EAAgD,OAAhD,CAAP;AACH;AAED;;;;4BACwB;AACpB,iBAAO,KAAKD,YAAL,CAAkB1sB,WAAlB,EAAP;AACH;AAED;;;;4BAC2B;AACvB,iBAAO,OAAAyH,WAAA,CAAY,KAAKilB,YAAjB,CAAP;AACH;AAED;;;;4BACwB;AACpB,iBAAOpnB,MAAM,CAACpH,IAAP,CAAY,KAAKgvB,SAAL,IAAkB,EAA9B,CAAP;AACH;AAED;AAAiC;;;;4BACjB;AACZ,iBAAO,KAAKR,YAAZ;AACH;AAED;;;;4BAC2B;AACvB,cAAK,KAAKvpB,SAAL,CAAepK,OAAf,GAAyB,CAA1B,KAAiC,CAArC,EAAwC;AACpC;AACA,mBAAO,KAAKoK,SAAL,CAAehK,QAAf,CAAwB;AAAE6Q,qBAAO,EAAE;AAAX,aAAxB,CAAP;AACH,WAJsB,CAKvB;;;AACA,iBAAO,KAAK7G,SAAZ;AACH;AAED;;;;4BACmB;AACf;;;;AAIA,cAAI,KAAK8nB,IAAL,CAAU52B,IAAV,CAAe2L,WAAf,GAA6BoS,QAA7B,CAAsC,SAAtC,CAAJ,EAAsD;AAClD,mBAAO,IAAP;AACH;;AAED,cAAI,KAAK0K,MAAL,CAAY1K,QAAZ,CAAqB,SAArB,CAAJ,EAAqC;AACjC,mBAAO,IAAP;AACH;;AAED,iBAAO,KAAP;AACH;AAED;;;;4BACsB;AAClB,cAAM4c,IAAI,GAAG,CAAC,KAAKjC,KAAL,IAAc,EAAf,EAAmBjxB,IAAnB,CAAwB,UAACnF,CAAD;AAAA,mBAAOA,CAAC,CAAC4G,IAAF,KAAW,aAAlB;AAAA,WAAxB,CAAb;AACA,iBAAOyxB,IAAI,GAAGA,IAAI,CAAC/e,OAAR,GAAkB,EAA7B;AACH;AAED;;;;4BAC4B;AACxB;AACA,iBAAO,KAAKme,QAAL,GAAgB,KAAKA,QAAL,CAAchwB,KAAd,GAAsBoC,IAAtB,CAA2B,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACxD,gBAAI,CAAAD,CAAC,SAAD,IAAAA,CAAC,WAAD,GAAC,MAAD,GAAAA,CAAC,CAAE4vB,aAAH,KAAmB3vB,CAAC,SAAD,IAAAA,CAAC,WAAD,GAAC,MAAD,GAAAA,CAAC,CAAE2vB,aAAtB,CAAJ,EAAyC,OAAO,CAAP;AACzC,gBAAI,CAAA3vB,CAAC,SAAD,IAAAA,CAAC,WAAD,GAAC,MAAD,GAAAA,CAAC,CAAE2vB,aAAH,KAAmB5vB,CAAC,SAAD,IAAAA,CAAC,WAAD,GAAC,MAAD,GAAAA,CAAC,CAAE4vB,aAAtB,CAAJ,EAAyC,OAAO,CAAC,CAAR;AAEzC,mBAAO,CAAP;AACH,WALsB,CAAhB,GAKF,EALL;AAMH;AAED;;;;4BAC4B;AACxB,iBAAO,IAAI,UAAA7mB,MAAJ,CAAW;AAAElR,gBAAI,EAAE,KAAKy1B,aAAL,GAAqB,IAA7B;AAAmCpO,uBAAW,EAAE,KAAhD;AAAuDC,uBAAW,EAAE,KAAK1iB;AAAzE,WAAX,CAAP;AACH;;;4BAEsB;AACnB,iBAAO,UAAAozB,uBAAA,CAAwB,KAAKpzB,QAA7B,CAAP;AACH;AAED;;;;4BACsB;AAClB,iBAAO,KAAKgG,WAAL,CAAiBtJ,UAAjB,CAA4B,aAA5B,CAAP;AACH;AAED;;;;;;4BAGoB;AAChB,iBAAOhB,IAAI,CAAC23B,GAAL,CAAS,KAAKrtB,WAAL,CAAiBlB,YAAjB,CAA8B,QAA9B,EAAwCwuB,QAAxC,CAAiD,KAAKC,gBAAtD,EAAwE,SAAxE,CAAT,CAAP;AACH;AAED;;;;4BACkB;AACd,iBAAO,KAAKvtB,WAAL,CAAiBjB,EAAxB;AACH;AAED;;;;4BACuB;AACnB,iBAAO,KAAK0qB,SAAL,CAAe1wB,MAAf,CAAsB,UAACwE,CAAD,EAAIuE,CAAJ;AAAA,mBAAUvE,CAAC,IAAIuE,CAAC,CAAC0rB,QAAjB;AAAA,WAAtB,EAAiD,KAAjD,CAAP;AACH;AAED;;;;4BACuB;AACnB,iBAAO,CAAC,CAAC,KAAKtC,QAAL,CAAc5zB,MAAvB;AACH;AAED;;;;;;;4BAIkB;AACd,iBAAO,KAAK+P,EAAZ;AACH;AAED;;;;;;4BAGkB;AACd,iBAAO,KAAK0gB,IAAL,CAAU1gB,EAAjB;AACH;AAED;;;;4BACgB;AACZ,iBAAO,KAAK0gB,IAAZ;AACH;AAED;;;;4BAC+B;AAC3B,cAAO0F,YAAY,GAAG,UAAA5uB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoBwK,MAApB,CAA2B,KAAKxF,QAAhC,CAAtB,CAD2B,CACwC;;AAEnE,cAAI,UAAA6E,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB04B,YAApB,CAAiC,KAAK1tB,WAAL,CAAiB6G,aAAjB,CAA+B;AAAEhR,mBAAO,EAAE;AAAX,WAA/B,CAAjC,CAAJ,EAAuF;AACnF,mBAAO,QAAP;AACH,WAFD,MAEO,IAAI,UAAAgJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB04B,YAApB,CAAiC,KAAK1tB,WAAtC,CAAJ,EAAwD;AAC3D,mBAAO,UAAP;AACH,WAFM,MAEA,IAAI,UAAAnB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB04B,YAApB,CAAiC,KAAK1tB,WAAL,CAAiB/J,QAAjB,CAA0B;AAAEJ,mBAAO,EAAE;AAAX,WAA1B,CAAjC,CAAJ,EAAkF;AACrF,mBAAO,SAAP;AACH,WAFM,MAEA,IAAI,UAAAgJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB04B,YAApB,CAAiC,KAAK1tB,WAAL,CAAiB/J,QAAjB,CAA0B;AAAEJ,mBAAO,EAAE,KAAKM;AAAhB,WAA1B,CAAjC,CAAJ,EAA6F;AAChG,mBAAO,aAAP;AACH,WAFM,CAGP;AAHO,eAIF,IAAGs3B,YAAY,CAAC3uB,YAAb,CAA0B,KAA1B,EAAiC7I,QAAjC,CAA0C;AAAEJ,qBAAO,EAAE;AAAX,aAA1C,EAA0D83B,WAA1D,CAAsE,KAAK3tB,WAA3E,EAAwF,KAAxF,CAAH,EAAoG;AACrG,qBAAO,mBAAP;AACH;;AAED,iBAAO,MAAP;AACH;AAED;;;;4BACoB;AAChB,cACI,KAAK4Z,MAAL,IACA,KAAKA,MAAL,CAAYphB,OAAZ,CAAoB,WAApB,KAAoC,CAFxC,EAGE;AACE,mBAAO,IAAP;AACH;;AAED,iBAAO,KAAP;AACH;AAED;;;;4BACsB;AAClB,2BAAU,KAAKwH,WAAL,CAAiBtJ,UAAjB,CAA4B,OAA5B,CAAV,gBAAoD,KAAK62B,gBAAL,CAAsB72B,UAAtB,CAAiC,OAAjC,CAApD;AACH;AAED;;;;4BACqB;AACjB,iBAAO,KAAKsJ,WAAL,CAAiBtJ,UAAjB,CAA4B,OAA5B,CAAP;AACH;AAED;;;;4BACmB;AACf,iBAAO,KAAKuJ,SAAL,CAAevJ,UAAf,CAA0B,OAA1B,CAAP;AACH;AAED;;;;4BACwB;AACpB,iBAAO,OAAA0F,gBAAA,CAAiB,KAAKjG,QAAtB,CAAP;AACH;AAED;;;;4BAC0B;;;AACtB,iBAAO,YAAK4xB,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEhE,UAAX,KAAyB,aAAhC;AACH;AAED;;;;4BACgB;AACZ,iBAAO,KAAKzL,KAAL,CAAWgI,KAAX,CAAiBnvB,IAAxB;AACH;;;4BAiLuB;AACpB,iBAAO,OAAAoP,4BAAA,CAA6B,KAAKP,WAAlC,CAAP;AACH;;;4BAC+B;AAC5B,iBAAO,OAAAQ,+BAAA,CAAgC,KAAKR,WAArC,CAAP;AACH;;;4BAEuB;AACpB,iBAAO,OAAAO,4BAAA,CAA6B,KAAKqtB,yBAAL,CAA+B,KAAKlC,kBAApC,CAA7B,CAAP;AACH;;;;MAnwBwB,iBAAA3a,a;;AAA7B;AAswBA;;;;;AAIA,aAAgB8c,mBAAhB,CAAoCC,UAApC,EAAiE;AAAA;;AAAA;AAGzD,YAAMC,MAAM,GAAGD,UAAU,CAAC9xB,MAAX,CACX,UAACgyB,KAAD;AAAA,iBACIA,KAAK,CAACC,WAAN,KAAsBH,UAAU,CAACr6B,GAAD,CAAV,CAAcw6B,WAApC,IACAD,KAAK,CAACb,aAAN,KAAwBW,UAAU,CAACr6B,GAAD,CAAV,CAAc05B,aAF1C;AAAA,SADW,CAAf;;AAKA,YAAIY,MAAM,CAACz2B,MAAP,GAAgB,CAApB,EAAuB;AACnB,cAAMge,QAAQ,GAAGwY,UAAU,CAAC9xB,MAAX,CACb,UAACgyB,KAAD;AAAA,mBACI,EAAEA,KAAK,CAACC,WAAN,KAAsBH,UAAU,CAACr6B,GAAD,CAAV,CAAcw6B,WAApC,IACED,KAAK,CAACb,aAAN,KAAwBW,UAAU,CAACr6B,GAAD,CAAV,CAAc05B,aAD1C,CADJ;AAAA,WADa,CAAjB;AAKA7X,kBAAQ,CAACrY,IAAT,CAAc,IAAI,WAAAkuB,aAAJ,CAAkB,MAAD,OAAC,CAAD,kBACxB2C,UAAU,CAACr6B,GAAD,CADc,CAAC,EACZ;AAChBL,iBAAK,EAAE,OAAA+P,OAAA,CAAQ4qB,MAAM,CAAC9yB,GAAP,CAAW,UAAA+yB,KAAK;AAAA,qBAAIA,KAAK,CAAC56B,KAAV;AAAA,aAAhB,CAAR,CADS;AAEhB8xB,wBAAY,EAAE,OAAI,CAACllB,WAAL,CAAiBjB,EAFf;AAGhBmvB,4BAAgB,EAAE,OAAI,CAACA;AAHP,WADY,CAAlB,CAAd;AAMAJ,oBAAU,GAAGxY,QAAb;AACA7hB,aAAC,GAAG,CAAJ;AACH;;AAtBwD;AAAA;;AAC7D;AACA,WAAK,IAAIA,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGq6B,UAAU,CAACx2B,MAA/B,EAAuC7D,CAAC,EAAxC,EAA4C;AAAA,eAAnCA,CAAmC;AAqB3C;;AACD,aAAOq6B,UAAP;AACH;;AAzBD;;;;;;;;;;;;;;;;;;;ACnxBA,QAAYK,cAAZ;;AAAA,eAAYA,cAAZ,EAA0B;AACtB;AACA;AACA;AACA;AACH,KALD,EAAYA,cAAc,GAAd,QAAAA,cAAA,aAAAA,cAAA,GAAc,EAAd,CAAZ;;;;;;;;;;;;;;;;;;;;;AClCA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAGA,QAAMC,MAAM,GAAG,CAAf;AACA,QAAMC,IAAI,GAAG,EAAb;AACA,QAAMC,GAAG,GAAG,KAAKD,IAAjB;AACA,QAAME,IAAI,GAAG,IAAID,GAAjB;AACA,QAAME,KAAK,GAAG,KAAKF,GAAnB;AAEA,QAAMG,YAAY,GAAmC;AACjDj3B,WAAK,EAAEg3B,KAD0C;AAEjDE,YAAM,EAAEF,KAFyC;AAGjDG,UAAI,EAAEJ,IAH2C;AAIjDK,WAAK,EAAEL,IAJ0C;AAKjDh1B,SAAG,EAAE+0B,GAL4C;AAMjD7H,UAAI,EAAE6H,GAN2C;AAOjD52B,UAAI,EAAE22B,IAP2C;AAQjD5xB,WAAK,EAAE4xB,IAR0C;AASjD54B,YAAM,EAAE24B,MATyC;AAUjDv4B,aAAO,EAAEu4B;AAVwC,KAArD;AAaA;;;;AAGa,YAAAv5B,QAAA,GAAW,OAAAA,QAAX;AAEb;;;;AAGa,YAAAI,SAAA,GAAY,OAAAA,SAAZ;;AAQb,aAAgB45B,qBAAhB,CAAsC7W,OAAtC,EAAmE;AAC/D,UAAIxP,KAAK,GAAY,EAArB;;AACA,UAAIwP,OAAJ,EAAa;AACTxP,aAAK,GAAG,MAAH,OAAG,CAAH,EAAG,EAAKwP,OAAL,CAAR;AACA,eAAOxP,KAAK,CAACnO,IAAb;;AACA,YAAI2d,OAAO,CAACnb,OAAZ,EAAqB;AACjB,iBAAO2L,KAAK,CAAC3L,OAAb;;AACA,eAAK,IAAMiyB,QAAX,IAAuB9W,OAAO,CAACnb,OAA/B,EAAwC;AACpC,gBAAI,CAAC2L,KAAK,CAACsmB,QAAD,CAAV,EAAsB;AAClBtmB,mBAAK,CAACsmB,QAAD,CAAL,GAAkB9W,OAAO,CAACnb,OAAR,CAAgBiyB,QAAhB,CAAlB;AACH;AACJ;AACJ,SAVQ,CAYT;AACA;;;AACA,YAAI9W,OAAO,CAAC+W,KAAZ,EAAmB;AACfvmB,eAAK,CAACxD,EAAN,GAAWgT,OAAO,CAAC+W,KAAnB;AACA,iBAAOvmB,KAAK,CAACumB,KAAb;AACH;AAEJ;;AACD,aAAOvmB,KAAP;AACH;;AAvBD;AA0BA;;;;;;AAKA,aAAgBwmB,mBAAhB,CAAoC17B,IAApC,EAA0E;AAAA,UAArB27B,QAAqB,uEAAF,EAAE;;AACtE;AACA,UAAI,CAAC37B,IAAL,EAAW;AACP,eAAO,CACH;AACIgC,eAAK,EAAE,CADX;AAEIgtB,aAAG,EAAE,UAAAzjB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB8J,YAApB,CAAiC,QAAjC,EAA2CC,EAA3C,GAAgD;AAFzD,SADG,CAAP;AAMH;;AACD,UAAMmwB,KAAK,GAAmB,EAA9B;AACA,UAAI55B,KAAK,GAAG,IAAI,UAAAgR,MAAJ,CAAW;AAAElR,YAAI,EAAE;AAAR,OAAX,CAAZ;AACA9B,UAAI,CAACgK,IAAL,CAAU,UAACC,CAAD,EAAIC,CAAJ;AAAA,eAAUD,CAAC,CAACnI,IAAF,GAASoI,CAAC,CAACpI,IAArB;AAAA,OAAV;;AAZsE,mDAahD9B,IAbgD;AAAA;;AAAA;AAatE,kEAA4B;AAAA,cAAjByW,OAAiB;AACxB,cAAMolB,SAAS,GAAGplB,OAAO,CAAC/J,WAA1B;AACA,cAAMovB,OAAO,GAAGrlB,OAAO,CAAC9J,SAAxB;;AACA,cAAIkvB,SAAS,CAACxB,WAAV,CAAsBr4B,KAAtB,CAAJ,EAAkC;AAC9B,gBAAMoD,IAAI,GAAGhD,IAAI,CAAC23B,GAAL,CAAS8B,SAAS,CAAC7B,QAAV,CAAmBh4B,KAAnB,EAA0B,SAA1B,CAAT,CAAb;AACA;;AACA,gBAAIoD,IAAI,IAAIu2B,QAAZ,EAAsB;AAClBC,mBAAK,CAACjyB,IAAN,CAAW;AAAE3H,qBAAK,EAAEA,KAAK,CAACyJ,EAAf;AAAmBujB,mBAAG,EAAE6M,SAAS,CAACpwB;AAAlC,eAAX;AACH;;AACDzJ,iBAAK,GAAG85B,OAAR;AACH,WAPD,MAOO,IAAI95B,KAAK,CAACwJ,YAAN,CAAmB,QAAnB,EAA6BC,EAA7B,KAAoCowB,SAAS,CAACrwB,YAAV,CAAuB,QAAvB,EAAiCC,EAAzE,EAA6E;AAChFzJ,iBAAK,GAAG85B,OAAR;AACH;AACJ;AA1BqE;AAAA;AAAA;AAAA;AAAA;;AA2BtEF,WAAK,CAACjyB,IAAN,CAAW;AACP3H,aAAK,EAAEA,KAAK,CAACyJ,EADN;AAEN;AACDujB,WAAG,EAAE,UAAAzjB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB8J,YAApB,CAAiC,QAAjC,EAA2CC,EAA3C,GAAgD;AAH9C,OAAX;AAMA,aAAOmwB,KAAP;AACH;;AAlCD;AAoCA;;;;;;;;;AAQA,aAAgBG,sBAAhB,CACI/7B,IADJ,EAGyB;AAAA,UADrB8B,IACqB,uEADN,UAAAyJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EACd;AAAA,UAArBkwB,QAAqB,uEAAF,EAAE;AAErB,UAAMC,KAAK,GAAGF,mBAAmB,CAAC17B,IAAD,EAAO27B,QAAP,CAAjC;AACA,UAAMK,KAAK,GAAG,IAAI,UAAAhpB,MAAJ,CAAW;AAAClR,YAAI,EAAJA;AAAD,OAAX,CAAd;AACA,UAAMwJ,IAAI,GAAG0wB,KAAK,CAACxwB,YAAN,CAAmB,QAAnB,EAA6B9I,QAA7B,CAAsC;AAAER,cAAM,EAAE;AAAV,OAAtC,CAAb;;AAJqB,mDAKD05B,KALC;AAAA;;AAAA;AAKrB,kEAA2B;AAAA,cAAhBK,KAAgB;AACvB,cAAMj6B,KAAK,GAAG,IAAI,UAAAgR,MAAJ,CAAW;AAAClR,gBAAI,EAAEm6B,KAAK,CAACj6B;AAAb,WAAX,CAAd;AACA,cAAMgtB,GAAG,GAAG,IAAI,UAAAhc,MAAJ,CAAW;AAAClR,gBAAI,EAAEm6B,KAAK,CAACjN;AAAb,WAAX,CAAZ;;AACA,cAAIhtB,KAAK,CAACwJ,YAAN,CAAmB,QAAnB,EAA6B6uB,WAA7B,CAAyC/uB,IAAzC,CAAJ,EAAoD;AAChD,mBAAO2wB,KAAP;AACH,WAFD,MAEO,IAAI3wB,IAAI,CAAC8uB,YAAL,CAAkBpL,GAAG,CAACxjB,YAAJ,CAAiB,QAAjB,CAAlB,CAAJ,EAAmD;AACtD,gBAAM3I,QAAQ,GAAGmsB,GAAG,CAACxjB,YAAJ,CAAiB,QAAjB,EAA2BwuB,QAA3B,CAAoC1uB,IAApC,EAA0C,SAA1C,CAAjB;AACA;;AACA,gBAAIzI,QAAQ,IAAI84B,QAAhB,EAA0B;AACtB,qBAAOM,KAAP;AACH;AACJ;AACJ;AAjBoB;AAAA;AAAA;AAAA;AAAA;;AAkBrB,aAAOL,KAAK,CAACA,KAAK,CAAC53B,MAAN,GAAe,CAAhB,CAAZ;AACH;;AAtBD;AAwBA;;;;;;AAKA,aAAgBk4B,mBAAhB,CACIzlB,OADJ,EAEI0lB,UAFJ,EAKgD;AAAA,UAF5CC,WAE4C,uEAFrB,KAEqB;AAAA,UAD5CC,cAC4C;AAAA,UAA5CtpB,MAA4C;;;;AAE5C,UAAI,CAAC0D,OAAL,EAAc;AACV,cAAMvY,KAAK,CAAC,mBAAD,CAAX;AACH;;AAED,UAAMo+B,YAAY,GAAG,wBAAAtd,cAAA,CAAeC,UAAf,CAA0B,aAAA6W,IAA1B,CAArB;AACA,UAAMyG,YAAY,GACdD,YAAY,CAACE,OAAb,IACA,IAAI,aAAA1G,IAAJ,CAAS;AAAE/hB,UAAE,EAAE,YAAN;AAAoBlW,YAAI,EAAE,YAA1B;AAAwCqV,aAAK,EAAE;AAA/C,OAAT,CAFJ;AAIA,UAAM7J,MAAM,GAAyB;AACjC0K,UAAE,EAAE,IAAI,QAAA0oB,WAAJ,CAAgBhmB,OAAO,CAAC1C,EAAR,IAAc,EAA9B,CAD6B;AAEjCif,kBAAU,EAAE,IAAI,QAAAyJ,WAAJ,CAAgB,CAAChmB,OAAO,CAACge,IAAT,CAAhB,EAAgC,EAAhC,CAFqB;AAGjCA,YAAI,EAAE,IAAI,QAAAgI,WAAJ,CAAgBhmB,OAAO,CAACge,IAAxB,EAA8B,EAA9B,CAH2B;AAIjChyB,cAAM,EAAE,IAAI,QAAAg6B,WAAJ,CAAgB;AAAEz3B,eAAK,EAAEyR,OAAO,CAAC/J,WAAR,IAAuB,UAAAnB,OAAA,EAAhC;AAA2CmxB,kBAAQ,EAAE;AAArD,SAAhB,EAA8E,CAAC,QAAAC,UAAA,CAAWC,QAAZ,CAA9E,CAJyB;AAKjC/5B,gBAAQ,EAAE,IAAI,QAAA45B,WAAJ,CAAgB;AAAEz3B,eAAK,EAAEyR,OAAO,CAAC5T,QAAjB;AAA2B65B,kBAAQ,EAAE;AAArC,SAAhB,CALuB;AAMjCtG,iBAAS,EAAE,IAAI,QAAAqG,WAAJ,CAAgBhmB,OAAO,CAAC2f,SAAR,IAAqBmG,YAArC,EAAmD,CAAC,QAAAI,UAAA,CAAWC,QAAZ,CAAnD,CANsB;AAOjCzG,iBAAS,EAAE,IAAI,QAAAsG,WAAJ,CAAgBhmB,OAAO,CAAC0f,SAAxB,EAAmC,EAAnC,CAPsB;AAQjC1H,aAAK,EAAE,IAAI,QAAAgO,WAAJ,CAAgBhmB,OAAO,CAACgY,KAAR,IAAiB,EAAjC,EAAqC;AAAEoO,oBAAU,EAAE,CAAE,QAAAF,UAAA,CAAWC,QAAb,EAAuB,QAAAD,UAAA,CAAWG,SAAX,CAAqB,CAArB,CAAvB,CAAd;AAAgEC,kBAAQ,EAAE;AAA1E,SAArC,CAR0B;AASjC7G,oBAAY,EAAE,IAAI,QAAAuG,WAAJ,CAAgBhmB,OAAO,CAACyf,YAAxB,CATmB;AAUjCloB,YAAI,EAAE,IAAI,QAAAyuB,WAAJ,CAAgBhmB,OAAO,CAACzI,IAAxB,CAV2B;AAWjCuoB,aAAK,EAAE,IAAI,QAAAkG,WAAJ,CAAgBhmB,OAAO,CAAC8f,KAAxB,CAX0B;AAYjCC,uBAAe,EAAE,IAAI,QAAAiG,WAAJ,CAAgBhmB,OAAO,CAAC+f,eAAxB,CAZgB;AAajCC,0BAAkB,EAAE,IAAI,QAAAgG,WAAJ,CAAgBhmB,OAAO,CAACggB,kBAAxB,CAba;AAcjCG,eAAO,EAAE,IAAI,QAAA6F,WAAJ,CAAgBhmB,OAAO,CAACmgB,OAAxB,CAdwB;AAejCgB,gBAAQ,EAAE,IAAI,QAAA6E,WAAJ,CACNhmB,OAAO,CAACyiB,cAAR,CAAuBvxB,GAAvB,CACI,UAAC+yB,KAAD;AAAA,iBAAW,IAAI,uBAAA7C,aAAJ,CAAkB,MAAD,OAAC,CAAD,kBACrB6C,KADqB,CAAC,EACjB;AACR9I,wBAAY,EAAEnb,OAAO,CAAC/J,WAAR,CAAoBjB,EAD1B;AAERmvB,4BAAgB,EAAEnkB,OAAO,CAAC/P;AAFlB,WADiB,CAAlB,CAAX;AAAA,SADJ,CADM,CAfuB;AAwBjC8wB,eAAO,EAAE,IAAI,QAAAiF,WAAJ,CAAgB,CAAC,CAAChmB,OAAO,CAAC+gB,OAA1B,CAxBwB;AAyBjCnR,oBAAY,EAAE,IAAI,QAAAoW,WAAJ,CAAgB,CAAC,CAAChmB,OAAO,CAAC4P,YAA1B,CAzBmB;AA0BjC2W,mBAAW,EAAE,IAAI,QAAAP,WAAJ,CAAgB,IAAhB,CA1BoB;AA2BjC1pB,cAAM,EAAE,IAAI,QAAA0pB,WAAJ,CAAgB,EAAhB,CA3ByB;AA4BjC/1B,gBAAQ,EAAE,IAAI,QAAA+1B,WAAJ,CAAgBJ,cAAc,IAAI,EAAlC,CA5BuB;AA6BjCY,sBAAc,EAAE,IAAI,QAAAR,WAAJ,CAAgB,KAAhB;AA7BiB,OAArC;;AA+BA,UAAI,CAACL,WAAL,EAAkB;AACd/yB,cAAM,CAACxG,QAAP,CAAgBq6B,aAAhB,CAA8B,CAAC,QAAAP,UAAA,CAAWC,QAAZ,EAAsB,uBAAAO,eAAA,CAAgB9zB,MAAM,CAAC5G,MAAvB,CAAtB,CAA9B;AACH;AACD;;;AACA,UAAIgU,OAAO,CAAC1C,EAAR,IAAc0C,OAAO,CAAC1C,EAAR,KAAe,QAAjC,EAA2C;AACvC1K,cAAM,CAAC+sB,SAAP,CAAiBgH,OAAjB;AACA;;AACA,YAAI3mB,OAAO,CAAC9J,SAAR,CAAkBlB,EAAlB,GAAuB,UAAAF,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAA/C,EAAmD;AAC/CpC,gBAAM,CAAC5G,MAAP,CAAc26B,OAAd;AACH;AACJ,OAND,MAMO;AACH,YAAMC,cAAc,GAAG,CAAC,QAAAV,UAAA,CAAWC,QAAZ,CAAvB;;AACA,YAAI,CAACR,WAAL,EAAkB;AACdiB,wBAAc,CAAC1zB,IAAf,CAAoB2zB,QAApB;AACH;;AACDD,sBAAc,CAAC1zB,IAAf,CAAoB4zB,WAApB;AACAl0B,cAAM,CAAC5G,MAAP,CAAcy6B,aAAd,CAA4BG,cAA5B;AACAh0B,cAAM,CAAC5G,MAAP,CAAc+6B,sBAAd;AACH;;AACD,UAAIC,WAAW,GAAG,CAAC,CAAnB;AACAp0B,YAAM,CAAC2pB,UAAP,CAAkB0K,YAAlB,CAA+B39B,SAA/B,CAAyC,UAACC,IAAD,EAAU;AAC/C,YAAM29B,QAAQ,GAAGt0B,MAAM,CAACotB,kBAAP,CAA0BzxB,KAA1B,IAAmC,EAApD;AACA,YAAM8F,OAAO,GAAGgE,MAAM,CAACpH,IAAP,CAAYi2B,QAAZ,EAAsBj1B,MAAtB,CAA6B,UAAClL,GAAD;AAAA,iBACzCwC,IAAI,CAACsF,IAAL,CAAU,UAAC0f,KAAD;AAAA,mBAAWA,KAAK,CAAC9R,KAAN,KAAgB1V,GAA3B;AAAA,WAAV,CADyC;AAAA,SAA7B,EAEdwG,MAFF;;AAGA,YAAIhE,IAAI,IAAIA,IAAI,CAACgE,MAAb,IAAuB8G,OAAO,KAAK,CAAvC,EAA0C;AACtC,cAAM8yB,KAAK,GAAGv0B,MAAM,CAACmtB,eAAP,CAAuBxxB,KAAvB,IAAgC,EAA9C;;AACA,cAAI8J,MAAM,CAACpH,IAAP,CAAYi2B,QAAZ,EAAsB35B,MAAtB,IAAgC,CAAhC,IAAqC8K,MAAM,CAACpH,IAAP,CAAYk2B,KAAZ,EAAmB55B,MAAnB,IAA6B,CAAtE,EAAyE;AACrE,gBAAMxG,GAAG,GAAGsR,MAAM,CAACpH,IAAP,CAAYi2B,QAAZ,EAAsB,CAAtB,KAA4B7uB,MAAM,CAACpH,IAAP,CAAYk2B,KAAZ,EAAmB,CAAnB,CAAxC;AACA,gBAAMC,YAAY,GAAG,EAArB;AACA,gBAAMC,SAAS,GAAG,EAAlB;AACA,gBAAMvH,KAAK,GAAGltB,MAAM,CAACktB,KAAP,CAAavxB,KAA3B;AACAuxB,iBAAK,CAACr2B,OAAN,CAAc,UAACs4B,IAAD;AAAA,qBAAWA,IAAI,CAACxT,KAAL,KAAexnB,GAAf,GAAsBg7B,IAAI,CAACxT,KAAL,GAAahlB,IAAI,CAAC,CAAD,CAAJ,CAAQkT,KAA3C,GAAoD,EAA/D;AAAA,aAAd;AACA2qB,wBAAY,CAAC79B,IAAI,CAAC,CAAD,CAAJ,CAAQkT,KAAT,CAAZ,GAA8ByqB,QAAQ,CAACngC,GAAD,CAAtC;AACAsgC,qBAAS,CAAC99B,IAAI,CAAC,CAAD,CAAJ,CAAQkT,KAAT,CAAT,GAA2B0qB,KAAK,CAACpgC,GAAD,CAAhC;AACA6L,kBAAM,CAACotB,kBAAP,CAA0B/zB,QAA1B,CAAmCm7B,YAAnC;AACAx0B,kBAAM,CAACmtB,eAAP,CAAuB9zB,QAAvB,CAAgCo7B,SAAhC;AACH;AACJ;;AACDL,mBAAW,GAAGz9B,IAAI,CAACgE,MAAnB;AACH,OApBD;AAqBAqF,YAAM,CAAC5G,MAAP,CAAci7B,YAAd,CAA2B39B,SAA3B,CAAqC,UAACuZ,CAAD,EAAO;AACxCjQ,cAAM,CAACxG,QAAP,CAAgB26B,sBAAhB;AACH,OAFD;AAGAn0B,YAAM,CAAC2zB,WAAP,CAAmBU,YAAnB,CAAgC39B,SAAhC,CAA0C,UAACg+B,YAAD,EAAkB;AACxD,YAAI,CAACA,YAAL,EAAmB;AACf10B,gBAAM,CAAC2pB,UAAP,CAAkBtwB,QAAlB,CAA2B,EAA3B;AACH;AACJ,OAJD;AAKA2G,YAAM,CAACgd,YAAP,CAAoBqX,YAApB,CAAiC39B,SAAjC,CAA2C,UAACsmB,YAAD,EAAkB;AACzD,YAAI,CAACA,YAAL,EAAmB;AACfhd,gBAAM,CAACuuB,QAAP,CAAgBl1B,QAAhB,CAAyB,EAAzB;AACH;AACJ,OAJD;AAKA,UAAMs7B,iBAAiB,GAAyB,CAC5C,IAD4C,EAE5C,YAF4C,EAG5C,WAH4C,EAI5C,OAJ4C,EAK5C,QAL4C,EAM5C,cAN4C,EAO5C,iBAP4C,EAQ5C,oBAR4C,EAS5C,UAT4C,EAU5C,gBAV4C,4BAWzC7B,UAXyC,GAY9C12B,MAZ8C,CAYvC,UAACkC,GAAD,EAAMnK,GAAN,EAAc;AACnB;AACA,YAAI6L,MAAM,CAAC7L,GAAD,CAAV,EAAiB;AACbmK,aAAG,CAACnK,GAAD,CAAH,GAAW6L,MAAM,CAAC7L,GAAD,CAAjB;AACH;;AACD,eAAOmK,GAAP;AACH,OAlB+C,EAkB7C,EAlB6C,CAAhD;;AAoBA,UAAIq2B,iBAAiB,CAACxG,OAAtB,EAA+B;AAC3B,YAAMyG,YAAY,GAAG,SAAfA,YAAe,CAACj5B,KAAD,EAAW;AAC5B,cAAIA,KAAJ,EAAW;AACP,gBAAImqB,UAAU,GAAG6O,iBAAiB,CAACv7B,MAAlB,CAAyBuC,KAAzB,CAA+Bk5B,KAA/B,EAAjB,CADO,CAEP;AACA;;AACA,gBAAI7B,cAAJ,EAAoB;AAChBlN,wBAAU,GAAGA,UAAU,CAACjjB,MAAX,CAAkBmwB,cAAlB,CAAb;AACH;;AAED2B,6BAAiB,CAACv7B,MAAlB,CAAyBy6B,aAAzB,CAAuC,CAAC,QAAAP,UAAA,CAAWC,QAAZ,CAAvC;AACAoB,6BAAiB,CAACv7B,MAAlB,CAAyBC,QAAzB,CAAkCs7B,iBAAiB,CAACxG,OAAlB,CAA0BxyB,KAA1B,GACpBmqB,UAAU,CAAC3jB,YAAX,CAAwB,KAAxB,CADoB,GAEpBwyB,iBAAiB,CAACv7B,MAAlB,CAAyBuC,KAFvC;AAGAg5B,6BAAiB,CAACn7B,QAAlB,CAA2BH,QAA3B,CAAoCs7B,iBAAiB,CAACxG,OAAlB,CAA0BxyB,KAA1B,GAC9B,KAAK,EADyB,GAE9Bg5B,iBAAiB,CAACn7B,QAAlB,CAA2BmC,KAFjC;AAGAg5B,6BAAiB,CAACv7B,MAAlB,CAAyB+6B,sBAAzB;AACAQ,6BAAiB,CAACn7B,QAAlB,CAA2Bu6B,OAA3B,GAhBO,CAiBP;AACH,WAlBD,MAkBO;AACH,gBAAMC,eAAc,GAAG,CAAC,QAAAV,UAAA,CAAWC,QAAZ,CAAvB;;AACA,gBAAI,CAACR,WAAL,EAAkB;AACdiB,6BAAc,CAAC1zB,IAAf,CAAoB2zB,QAApB;AACH;;AACDD,2BAAc,CAAC1zB,IAAf,CAAoB4zB,WAApB;;AACAS,6BAAiB,CAACv7B,MAAlB,CAAyBy6B,aAAzB,CAAuCG,eAAvC;AACAW,6BAAiB,CAACn7B,QAAlB,CAA2BH,QAA3B,CAAoC+T,OAAO,CAAC5T,QAAR,IAAoB,EAAxD;AACAm7B,6BAAiB,CAACv7B,MAAlB,CAAyB+6B,sBAAzB;AACAQ,6BAAiB,CAACn7B,QAAlB,CAA2Bs7B,MAA3B;AACAH,6BAAiB,CAACv7B,MAAlB,CAAyB07B,MAAzB;AACH;AACJ,SA/BD;;AAgCAH,yBAAiB,CAACxG,OAAlB,CAA0BkG,YAA1B,CAAuC39B,SAAvC,CAAiDk+B,YAAjD;AACAA,oBAAY,CAACD,iBAAiB,CAACxG,OAAlB,CAA0BxyB,KAA3B,CAAZ;AACH;;AAED,UAAMo5B,WAAW,GAAG3nB,OAAO,CAAC2hB,kBAAR,IAA8B,EAAlD,CAzJ4C,CA2J5C;;AACA,UAAGrlB,MAAM,IAAI0D,OAAO,CAAC6R,iBAAR,KAA+B,mBAAA+V,gBAAA,CAAiBC,IAA7D,EAAkE;AAC9D7nB,eAAO,CAACiS,iBAAR,GAA4B0V,WAAW,CAClC11B,MADuB,CAChB,UAAA61B,UAAU;AAAA,iBAAIA,UAAU,CAACxqB,EAAX,KAAkB0C,OAAO,CAAC2Z,oBAA9B;AAAA,SADM,EAEvBzoB,GAFuB,CAEnB,UAAC42B,UAAD;AAAA,iBAAgB,IAAI,UAAAvrB,MAAJ,CAAW;AAAClR,gBAAI,EAAEy8B,UAAU,CAAC3qB,WAAX,GAAyB,IAAhC;AAAsCuV,uBAAW,EAAE,KAAnD;AAA0DC,uBAAW,EAAE3S,OAAO,CAAC/P;AAA/E,WAAX,CAAhB;AAAA,SAFmB,CAA5B;AAIH;AACD;;;;;AAGA,UAAGqM,MAAM,IAAIA,MAAM,KAAK,mBAAAwW,YAAA,CAAaiV,KAAlC,IAA2CzrB,MAAM,KAAK,mBAAA0rB,aAAA,CAAcD,KAApE,IAA6EJ,WAA7E,IAA4FA,WAAW,CAACp6B,MAAxG,IAAkH,CAACyS,OAAO,CAAC1C,EAA9H,EAAiI;AAC7H,YAAM2qB,YAAY,GAAG,IAAI,UAAA1rB,MAAJ,CAAW;AAC5BlR,cAAI,EAAEs8B,WAAW,CAACp0B,IAAZ,CAAiB,UAAC20B,EAAD,EAAKC,EAAL;AAAA,mBAAYD,EAAE,CAAC/qB,WAAH,GAAiBgrB,EAAE,CAAChrB,WAAhC;AAAA,WAAjB,EAA8D,CAA9D,EAAiEA,WAAjE,GAA+E,IADzD;AAE5BuV,qBAAW,EAAE,KAFe;AAERC,qBAAW,EAAE3S,OAAO,CAAC/P;AAFb,SAAX,CAArB;AAIAs3B,yBAAiB,CAACv7B,MAAlB,CAAyBC,QAAzB,CAAkCg8B,YAAlC;AACA,YAAM1P,GAAG,GAAGoP,WAAW,CAACp0B,IAAZ,CAAiB,UAAC20B,EAAD,EAAKC,EAAL;AAAA,iBAAYA,EAAE,CAAChrB,WAAH,GAAiB+qB,EAAE,CAAC/qB,WAAhC;AAAA,SAAjB,EAA8D,CAA9D,EAAiEA,WAAjE,GAA+E,IAA3F;AACA6C,eAAO,CAAC+R,gBAAR,GAA4B,IAAI,UAAAxV,MAAJ,CAAW;AAAClR,cAAI,EAAEktB,GAAP;AAAY7F,qBAAW,EAAE,KAAzB;AAAgCC,qBAAW,EAAE3S,OAAO,CAAC/P;AAArD,SAAX,CAA5B;AACH,OA7K2C,CA+K5C;;;AACA,UAAMm4B,WAAW,GAAG,OAAAb,iBAAiB,CAACv7B,MAAlB,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,GAAEuC,KAA1B,KAAmC,IAAI,UAAAgO,MAAJ,CAAW;AAAElR,YAAI,EAAE;AAAR,OAAX,CAAvD,CAhL4C,CAgLoC;;;AAChF,UAAMg9B,sBAAsB,GAAG,MAAH,OAAG,CAAH,kBACrBd,iBADqB,CAAG,EACP;AACpB1V,yBAAiB,EAAE,IAAI,QAAAmU,WAAJ,CAAgBhmB,OAAO,CAAC6R,iBAAR,IAA6B,mBAAA+V,gBAAA,CAAiBU,MAA9D,CADC;AAEpBxW,2BAAmB,EAAE,IAAI,QAAAkU,WAAJ,CAAgBhmB,OAAO,CAAC8R,mBAAR,IAA+B,CAA/C,CAFD;AAGpBC,wBAAgB,EAAE,IAAI,QAAAiU,WAAJ,CAAgBhmB,OAAO,CAAC+R,gBAAR,IAA4BqW,WAAW,CAACl8B,QAAZ,CAAqB;AAACwwB,cAAI,EAAE;AAAP,SAArB,CAA5C,CAHE;AAIpB1K,wBAAgB,EAAE,IAAI,QAAAgU,WAAJ,CAAgBhmB,OAAO,CAACgS,gBAAR,IAA4B,CAA5C,CAJE;AAKpBJ,oBAAY,EAAE,IAAI,QAAAoU,WAAJ,CAAgBhmB,OAAO,CAAC4R,YAAxB,CALM;AAMpBK,yBAAiB,EAAE,IAAI,QAAA+T,WAAJ,CAAgBhmB,OAAO,CAACiS,iBAAR,IAA6B,EAA7C,CANC;AAOpBC,6BAAqB,EAAE,IAAI,QAAA8T,WAAJ,CAAgB,EAAhB,CAPH;AAQpBuC,0BAAkB,EAAE,IAAI,QAAAvC,WAAJ,CAAgB,mBAAA4B,gBAAA,CAAiBU,MAAjC,CARA;AASpBnW,uBAAe,EAAE,IAAI,QAAA6T,WAAJ,CAAgBhmB,OAAO,CAACmS,eAAR,IAA2B,EAA3C;AATG,OADO,CAA/B;;AAaA,UAAGnS,OAAO,CAAC4R,YAAR,IAAwBtV,MAAM,KAAK,mBAAA0rB,aAAA,CAAcD,KAApD,EAA0D;AACtDM,8BAAsB,CAACpW,iBAAvB,CAAyCwU,aAAzC,CAAuD,CAAC+B,eAAD,CAAvD;AACAH,8BAAsB,CAACpW,iBAAvB,CAAyC8U,sBAAzC;AACAsB,8BAAsB,CAACtW,gBAAvB,CAAwC0U,aAAxC,CAAsD,CAAC,QAAAP,UAAA,CAAWC,QAAZ,EAAsBW,WAAtB,CAAtD;AACH,OAlM2C,CAmM5C;;;AACA,UAAMtf,IAAI,GAAG,IAAI,QAAAihB,SAAJ,CAAcJ,sBAAd,CAAb;AACA,aAAO7gB,IAAP;AACH;;AA3MD;AA6MA;;;;;AAIA,aAAgBqf,QAAhB,CAAyB6B,OAAzB,EAAmD;AAC/C,UAAM18B,MAAM,GAAG08B,OAAO,CAACn6B,KAAvB,CAD+C,CACjB;;AAC9B,aAAOvC,MAAM,CAAC23B,YAAP,CAAoB,UAAA7uB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB6R,aAApB,CAAkC;AAAEhR,eAAO,EAAE;AAAX,OAAlC,CAApB,IACD;AAAEE,cAAM,EAAE;AAAV,OADC,GAED,IAFN;AAGH;;AALD;AAOA;;;;;AAIA,aAAgBw8B,eAAhB,CAAiCE,OAAjC,EAA2D;AACvD,aAAOA,OAAO,CAACn6B,KAAR,CAAchB,MAAd,KAAyB,CAAzB,GAA6B,IAA7B,GAAoC;AAAE6G,aAAK,EAAE;AAAT,OAA3C;AACH;;AAFD;AAIA;;;;;AAIC,aAAgBu0B,SAAhB,CAA2BD,OAA3B,EAAqD;AACjD,UAAG,CAACA,OAAO,CAACn6B,KAAZ,EAAkB;AACd,eAAO;AAAElD,cAAI,EAAE;AAAR,SAAP;AACH;;AACF,UAAMA,IAAI,GAAG,IAAI,UAAAkR,MAAJ,CAAW;AAAClR,YAAI,EAAEq9B,OAAO,CAACn6B;AAAf,OAAX,CAAb;AACA,UAAM8jB,GAAG,GAAG,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAZ;AACA,UAAMiC,OAAO,GAAGmlB,GAAG,CAACsR,YAAJ,CAAiBt4B,IAAjB,EAAuB,KAAvB,KAAiCgnB,GAAG,CAACuW,UAAJ,CAAev9B,IAAf,EAAqB,KAArB,CAAjD;AACA,aAAO6B,OAAO,GAAG,IAAH,GAAU;AAAE7B,YAAI,EAAE;AAAR,OAAxB;AACH;;AARA;AAUD;;;;;AAIC,aAAgBy7B,WAAhB,CAA6B4B,OAA7B,EAAuD;AACpD,UAAG,CAACA,OAAO,CAACn6B,KAAZ,EAAkB;AACd,eAAO;AAAElD,cAAI,EAAE;AAAR,SAAP;AACH;;AACF,UAAMA,IAAI,GAAG,UAAAyJ,OAAA,CAAQ4zB,OAAO,CAACn6B,KAAR,CAAcs6B,MAAtB,CAAb;AACA,UAAMxW,GAAG,GAAG,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAZ;AACA,UAAMiC,OAAO,GAAGmlB,GAAG,CAACsR,YAAJ,CAAiBt4B,IAAjB,EAAuB,KAAvB,KAAiCgnB,GAAG,CAACuW,UAAJ,CAAev9B,IAAf,EAAqB,KAArB,CAAjD;AACA,aAAO6B,OAAO,GAAG,IAAH,GAAU;AAAE7B,YAAI,EAAE;AAAR,OAAxB;AACF;;AARA;AAUD;;;;;AAIA,aAAgBy9B,YAAhB,CAA6BC,SAA7B,EAA8D;AAC1D,aAAO1wB,MAAM,CAACkpB,MAAP,CAAcwH,SAAd,EAAyB/5B,MAAzB,CAAgC,UAACg6B,GAAD,EAAMxD,KAAN,EAAgB;AACnD,YAAMyD,SAAS,GAAGzD,KAAK,CAACx2B,MAAN,CAAa,UAACk6B,UAAD,EAAah3B,EAAb,EAAoB;AAC/C,cAAIA,EAAE,CAACi3B,UAAH,CAAcD,UAAd,IAA4BE,eAAe,CAACl3B,EAAE,CAACi3B,UAAH,CAAcD,UAAf,CAAf,GAA4CF,GAA5E,EAAiF;AAC7E,mBAAOI,eAAe,CAACl3B,EAAE,CAACi3B,UAAH,CAAcD,UAAf,CAAtB;AACH,WAFD,MAEO;AACH,mBAAOA,UAAP;AACH;AACJ,SANiB,EAMf,CANe,CAAlB;;AAOA,YAAID,SAAS,GAAGD,GAAhB,EAAqB;AACjB,iBAAOC,SAAP;AACH,SAFD,MAEO;AACH,iBAAOD,GAAP;AACH;AACJ,OAbM,EAaJ,CAbI,CAAP;AAcH;;AAfD;AAiBA;;;;;;AAKA,aAAgBK,0BAAhB,CACIC,UADJ,EAEIC,UAFJ,EAE+B;AAE3B,UAAM3mB,KAAK,GAAW,OAAO0mB,UAAP,KAAsB,QAAtB,GAAiCF,eAAe,CAACE,UAAD,CAAhD,GAA+DA,UAArF;AACA,UAAM79B,MAAM,GACR,OAAO89B,UAAP,KAAsB,QAAtB,GAAiCH,eAAe,CAACG,UAAD,CAAhD,GAA+DA,UADnE;AAEA,aAAO3mB,KAAK,IAAInX,MAAhB;AACH;;AARD;AAUA;;;;;AAIA,aAAgB29B,eAAhB,CAAgCv3B,GAAhC,EAA2C;AACvC,UAAMoB,KAAK,GAAGpB,GAAG,CAACxE,KAAJ,CAAU,GAAV,CAAd;AACA,aAAO,CAAC4F,KAAK,CAAC,CAAD,CAAN,GAAYyxB,YAAY,CAACzxB,KAAK,CAAC,CAAD,CAAN,CAA/B;AACH;;AAHD;AAKA;;;;;;;AAMA,aAAgB6c,kBAAhB,GAKiB;AAAA,UAJb1U,QAIa,uEAJS,EAIT;AAAA,UAHbmU,QAGa,uEAHO,IAGP;AAAA,UAFbia,WAEa,uEAFU,KAEV;AAAA,UADbx9B,MACa,uEADI,UAAA8I,OAAA,EACJ;AAAA,UAAbyZ,KAAa;AAEb,UAAMkb,UAAU,GAAGxE,mBAAmB,CAAC7pB,QAAQ,CAACnJ,MAAT,CAAgB,UAACunB,GAAD;AAAA,eAAS,CAACA,GAAG,CAAC4E,QAAd;AAAA,OAAhB,CAAD,CAAtC;AACA,UAAM/L,GAAG,GAAG,UAAAvd,OAAA,EAAZ,CAHa,CAGS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,UAAM40B,cAAc,GAAGpE,sBAAsB,CAAClqB,QAAQ,CAACnJ,MAAT,CAAgB,UAACunB,GAAD;AAAA,eAAS,CAACA,GAAG,CAAC4E,QAAd;AAAA,OAAhB,CAAD,CAA7C;AAEA,UAAM7yB,KAAK,GAAG,IAAI,UAAAgR,MAAJ,CAAW;AAAClR,YAAI,EAAE,CAAAq+B,cAAc,SAAd,IAAAA,cAAc,WAAd,GAAc,MAAd,GAAAA,cAAc,CAAEn+B,KAAhB,KAAyB;AAAhC,OAAX,CAAd;AACA,UAAMgtB,GAAG,GAAG,IAAI,UAAAhc,MAAJ,CAAW;AAAClR,YAAI,EAAE,CAAAq+B,cAAc,SAAd,IAAAA,cAAc,WAAd,GAAc,MAAd,GAAAA,cAAc,CAAEnR,GAAhB,KAAuB;AAA9B,OAAX,CAAZ;AACA,UAAMoR,cAAc,GAAGtX,GAAG,CAACuR,WAAJ,CAAgBr4B,KAAK,CAACwJ,YAAN,CAAmB,QAAnB,CAAhB,KAAiDsd,GAAG,CAACsR,YAAJ,CAAiBpL,GAAG,CAACxjB,YAAJ,CAAiB,QAAjB,CAAjB,CAAxE;AACA,UAAM60B,qBAAqB,GAAG,OAAAv3B,gBAAA,CAC1Bs3B,cAAc,GAAGpR,GAAG,CAACgL,QAAJ,CAAalR,GAAb,EAAkB,SAAlB,CAAH,GAAkC9mB,KAAK,CAACg4B,QAAN,CAAelR,GAAf,EAAoB,SAApB,CADtB,EAE1B,OAF0B,CAA9B;AAKA,UAAMwX,aAAa,GAAG,CAACF,cAAD,IAAmB,CAACp+B,KAAK,CAACq9B,UAAN,CAAiBvW,GAAjB,EAAsB,KAAtB,CAA1C;AACA,UAAMyX,UAAU,GAAGH,cAAc,IAAI,CAACpR,GAAG,CAACqQ,UAAJ,CAAevW,GAAf,EAAoB,KAApB,CAAtC;AAEA,aAAO;AACHxC,cAAM,EAAG,CAACN,QAAD,GACH;AAAD;AADI,UAEHoa,cAAc,GACVH,WAAW,GACP;AAAD;AADQ,UAEP;AAAD;AAHO,UAIV;AAAD;AAPN;AAQHO,uBAAe,EAAED,UAAU,GACrB,mBADqB,GAErBH,cAAc,wBACIpR,GAAG,CAAC5rB,UAAJ,CAAe,OAAAwI,gBAAA,EAAf,CADJ,cAC0Cy0B,qBAD1C,SAEVC,aAAa,GACT,mBADS,qBAEEt+B,KAAK,CAACoB,UAAN,CAAiB,OAAAwI,gBAAA,EAAjB,CAFF,cAE0Cy0B,qBAF1C;AAZpB,OAAP;AAgBH;;AA9CD;AAgDA;;;;AAGa,YAAAI,oBAAA,GAAuB,UAACna,MAAD,EAAiC;AACjE,cAAQA,MAAR;AACI,aAAK;AAAL;AAAA;AACI,iBAAO,cAAP;;AACJ,aAAK;AAAL;AAAA;AACI,iBAAO,sBAAP;;AACJ,aAAK;AAAL;AAAA;AACI,iBAAO,aAAP;;AACJ,aAAK;AAAL;AAAA;AACI,iBAAO,qBAAP;;AACJ,aAAK;AAAL;AAAA;AACA;AACI,iBAAO,WAAP;AAXR;AAaH,KAdY;;AAgBb,aAAgB4N,eAAhB,CACIl0B,IADJ,EAEI2zB,YAFJ,EAGI+M,cAHJ,EAGwE;AAEpE,UAAMC,aAAa,GAAG3gC,IAAI,CAAC0I,MAAL,CAAY,UAAC+N,OAAD,EAAa;;;AAC3C,eACI,EAAE,OAAAA,OAAO,CAACge,IAAR,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAEvhB,KAAd,MAAwBwtB,cAAc,CAACvM,UAAzC,KACA,CAACI,oBAAoB,CAACmM,cAAc,CAACtM,MAAf,CAAsB3oB,EAAvB,EAA2Bi1B,cAAc,CAACrM,IAAf,CAAoB5oB,EAA/C,EAAmDgL,OAAO,CAAC/J,WAAR,CAAoBjB,EAAvE,EAA2EgL,OAAO,CAAC9J,SAAR,CAAkBlB,EAA7F,CAFzB;AAIH,OALqB,CAAtB;AAMA,UAAMm1B,YAAY,GAAGD,aAAa,CAAC/M,MAAd,CAAqBD,YAArB,CAArB;AACAiN,kBAAY,CAAC52B,IAAb,CAAkB,UAACC,CAAD,EAAIC,CAAJ;AAAA,eAAUD,CAAC,CAACnI,IAAF,GAASoI,CAAC,CAACpI,IAArB;AAAA,OAAlB;AACA,aAAO,OAAA0G,MAAA,CAAOo4B,YAAP,EAAqB,SAArB,CAAP;AACH;;AAdD;;AAgBA,aAAgBrM,oBAAhB,CACIsM,MADJ,EAEIC,IAFJ,EAGIC,MAHJ,EAIIC,IAJJ,EAKa;AAAA,UAATj6B,IAAS,uEAAF,EAAE;AAET,aACK85B,MAAM,IAAIE,MAAV,IAAoBF,MAAM,GAAGG,IAA9B,IACCF,IAAI,GAAGC,MAAP,IAAiBD,IAAI,IAAIE,IAD1B,IAECD,MAAM,IAAIF,MAAV,IAAoBE,MAAM,GAAGD,IAF9B,IAGCE,IAAI,GAAGH,MAAP,IAAiBG,IAAI,IAAIF,IAJ9B;AAMH;;AAbD;;AAeA,aAAgBG,UAAhB,QAKC;AAAA,UAJGzJ,OAIH,SAJGA,OAIH;AAAA,UAHG0J,OAGH,SAHGA,OAGH;AAAA,UAFGC,KAEH,SAFGA,KAEH;AAAA,UADGC,YACH,SADGA,YACH;;AACG,UAAI5J,OAAJ,EAAa;AACT,yBAAU0J,OAAO,CAAC99B,UAAR,CAAmB,aAAnB,CAAV;AACH,OAFD,MAEO;AACH,YAAI89B,OAAO,CAAC7B,UAAR,CAAmB8B,KAAnB,EAA0B,KAA1B,CAAJ,EAAsC;AAClC,2BAAUD,OAAO,CAAC99B,UAAR,CAAmB,oBAAnB,CAAV,gBAAwDg+B,YAAY,CAACh+B,UAAb,CAAwB,OAAxB,CAAxD;AACH,SAFD,MAEO;AACH,2BAAU89B,OAAO,CAAC99B,UAAR,CAAmB,oBAAnB,CAAV,gBAAwDg+B,YAAY,CAACh+B,UAAb,CAAwB,oBAAxB,CAAxD;AACH;AACJ;AACJ;;AAfD;;;;;;;;;;;;;;;;;;;;ACxjBA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;QAKai+B,e;;;;;AACT,+BAAsBtoB,SAAtB,EACIoG,eADJ,EACoC;AAAA;;AAAA;;AAEhC,sCAAMpG,SAAN,EAAiBoG,eAAjB;AAHkB,gBAAApG,SAAA,GAAAA,SAAA;AAIlB,gCAAAiG,cAAA,CAAesiB,UAAf,CAA0B,gBAAA9a,OAA1B;AACA,gBAAKhH,KAAL,GAAa,UAAb;AACA,gBAAKC,UAAL,GAAkB,UAAlB;;AACA,gBAAKH,QAAL,GAAgB,UAACrV,CAAD,EAAIC,CAAJ;AAAA,iBAAU,CAAC,CAACD,CAAC,CAAC8J,EAAF,IAAQ,EAAT,EAAa5J,aAAb,CAA2BD,CAAC,CAAC6J,EAA7B,CAAD,IAAqC,CAAC,CAAC9J,CAAC,CAAC4lB,OAAF,IAAa,EAAd,EAAkB1lB,aAAlB,CAAgCD,CAAC,CAAC2lB,OAAlC,CAAhD;AAAA,SAAhB;;AANgC;AAOnC;AAED;;;;;;;;qCAIoBnL,O,EAChB6c,Q,EAAiB;AAAA;;AACjB,cAAI,CAAC7c,OAAL,EAAc;AACV,kBAAM,IAAIxmB,KAAJ,CAAU,8CAAV,CAAN;AACH;;AACD,cAAM4qB,GAAG,GAAG,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAZ;;AACA,cAAI,CAACgjB,OAAO,CAACjT,IAAb,EAAmB;AACfiT,mBAAO,CAACjT,IAAR,GAAeqX,GAAG,CACbtd,YADU,CACG,KADH,EAEV+H,aAFU,CAEI;AAAE4f,kBAAI,EAAE;AAAR,aAFJ,EAGV1nB,EAHL;AAIH;;AACD,cAAI,CAACiZ,OAAO,CAAC+W,KAAb,EAAoB;AAChB/W,mBAAO,CAAC+W,KAAR,GAAgB,IAAhB;AACH;;AAED,cAAMj+B,GAAG,sBAAeknB,OAAO,CAAC3Q,EAAR,GAAa2Q,OAAO,CAAC3Q,EAArB,GAA0B,EAAzC,cAA+CwtB,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAAA,QAAA,GAAY,EAA3D,CAAT;;AACA,cAAI,CAAC,KAAKliB,SAAL,CAAe7hB,GAAf,CAAL,EAA0B;AACtB,iBAAK6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAAI2gB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACnD,kBAAMmjB,OAAO,GAAG,SAAVA,OAAU,CAACxhC,IAAD,EAAqB;AACjC,uBAAO,OAAI,CAACqf,SAAL,CAAe7hB,GAAf,CAAP;AACA4gB,uBAAO,CAACpe,IAAD,CAAP;AACH,eAHD;;AAIA,kBAAMugB,KAAK,GAAG,SAARA,KAAQ,CAAApU,CAAC,EAAI;AACfkS,sBAAM,CAAClS,CAAD,CAAN;AACA,uBAAO,OAAI,CAACkT,SAAL,CAAe7hB,GAAf,CAAP;AACH,eAHD;;AAIA,kBAAM0X,KAAK,GAAG,oBAAAqmB,qBAAA,CAAsB7W,OAAtB,CAAd;;AACA,kBAAIA,OAAO,CAAC3Q,EAAZ,EAAgB;AACZ,uBAAI,CAACghB,IAAL,CAAUrQ,OAAO,CAAC3Q,EAAlB,EAAsBmB,KAAtB,EAA6BsJ,IAA7B,CAAkC,UAAAre,CAAC;AAAA,yBAAIqhC,OAAO,CAAC,CAACrhC,CAAD,CAAD,CAAX;AAAA,iBAAnC,EAAqDogB,KAArD;AACH,eAFD,MAEO;AACH,uBAAI,CAACrL,KAAL,CAAWA,KAAX,EAAkBsJ,IAAlB,CAAuBgjB,OAAvB,EAAgCjhB,KAAhC;AACH;AACJ,aAfqB,CAAtB;AAgBH;;AACD,iBAAO,KAAKlB,SAAL,CAAe7hB,GAAf,CAAP;AACH;AAGD;;;;;;;6BAIYiZ,O,EAAkBgrB,M,EAAgB;AAC1C,cAAMzzB,IAAI,GAAGyI,OAAO,CAACirB,SAAR,EAAb;;AACA,cAAGD,MAAH,EAAU;AACNzzB,gBAAI,CAACyzB,MAAL,GAAc,IAAd;AACH;;AACD,iBAAOhrB,OAAO,CAAC1C,EAAR,GAAa,KAAKwK,MAAL,CAAY9H,OAAO,CAAC1C,EAApB,EAAwB/F,IAAxB,CAAb,GAA6C,KAAK7I,GAAL,CAAS6I,IAAT,CAApD;AACH;AAED;;;;;;;;gCAKe+F,E,EAAY1K,M,EAA8B;AACrD,iBAAQ,KAAKuV,IAAL,CAAU7K,EAAV,EAAc,SAAd,EAAyB1K,MAAzB,CAAR;AACH;;;iDAC+B0K,E,EAAY1K,M,EAA8B;AACtE,iBAAQ,KAAKs4B,QAAL,CAAc5tB,EAAd,EAAkB,SAAlB,EAA6B1K,MAA7B,CAAR;AACH;;;+BAEa0K,E,EAAY1K,M,EAAkB;AACxC,iBAAO,KAAKuV,IAAL,CAAU7K,EAAV,EAAc,QAAd,EAAwB1K,MAAxB,CAAP;AACH;;;6BAEW0K,E,EAAYuS,M,EAA8Bjd,M,EAAkB;AACpE,iBAAO,KAAKuV,IAAL,CAAU7K,EAAV,EAAcuS,MAAd,EAAsBjd,MAAtB,CAAP;AACH;;;gCAEc0K,E,EAAY1K,M,EAAkB;AACzC,iBAAO,KAAKuV,IAAL,CAAU7K,EAAV,EAAc,KAAKoL,eAAL,CAAqBQ,SAArB,GAAiC,mBAAjC,GAAuD,SAArE,EAAgFtW,MAAhF,CAAP;AACH;;;gCAEiBqU,Q,EAAiB;AAC/B,iBAAO,IAAI,gBAAA8I,OAAJ,CAAY9I,QAAZ,CAAP;AACH;;;wCAEsB7L,Q,EAAmB;AAAA;;AACtC,cAAM+vB,QAAQ,GAAG,EAAjB;AACA/vB,kBAAQ,CAAC3R,OAAT,CAAiB,UAAA6zB,GAAG,EAAI;;;AACpB,gBAAMtd,OAAO,GAAGsd,GAAG,CAAC7V,MAAJ,EAAhB;AACA,gBAAMnK,EAAE,GAAG0C,OAAO,CAAC1C,EAAnB;AACA,gBAAM1K,MAAM,GAAG;AACXw4B,wBAAU,EAAEprB,OAAO,CAAC1C,EADT;AAEXqiB,uBAAS,EAAE3f,OAAO,CAAC2f,SAAR,CAAkBljB,KAFlB;AAGXihB,wBAAU,EAAE,CAAF,KAAE1d,OAAO,CAACuO,KAAR,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAE9R,KAHhB;AAIX2c,qBAAO,EAAEpZ,OAAO,CAACoZ,OAJN;AAKX7tB,mBAAK,EAAEyU,OAAO,CAAC/J,WAAR,CAAoBtJ,UAApB,CAA+B,QAA/B,EAAyCmJ,iBAAzC,EALI;AAMXyiB,iBAAG,EAAEvY,OAAO,CAAC9J,SAAR,CAAkBvJ,UAAlB,CAA6B,QAA7B,EAAuCmJ,iBAAvC;AANM,aAAf;AAQAq1B,oBAAQ,CAACj4B,IAAT,CAAc,OAAI,CAACg4B,QAAL,CAAc5tB,EAAd,EAAkB,mBAAlB,EAAuC1K,MAAvC,CAAd;AACH,WAZD;AAaA,iBAAO,OAAAy4B,QAAA,CAASF,QAAT,CAAP;AACH;;;;MA9GgC,eAAA1iB,c;;AAHrC;;;uBAGamiB,e,EAAe,+B,EAAA,+B;AAAA,K;;;aAAfA,e;AAAe,eAAfA,eAAe,K;AAAA,kBAFZ;;;;;2BAEHA,e,EAAe;cAH3B,OAAA1sB,UAG2B;eAHhB;AACR6I,oBAAU,EAAE;AADJ,S;AAGgB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnB5B;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;QAYaukB,wB;;;;;AACT,wCAAsBhpB,SAAtB,EACIoG,eADJ,EACoC;AAAA;;AAAA;;AAEhC,sCAAMpG,SAAN,EAAiBoG,eAAjB;AAHkB,gBAAApG,SAAA,GAAAA,SAAA,CACc,CA4EpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;AAEO,gBAAAipB,aAAA,GAAgB,UAAC9sB,KAAD;AAAA,iBAAsD,QAAK+sB,eAAL,CAAqB/sB,KAArB,EAA4B;AAAEsG,eAAG,EAAE;AAAP,WAA5B,CAAtD;AAAA,SAAhB;;AA5FH,gCAAAwD,cAAA,CAAesiB,UAAf,CAA0B,gBAAA9a,OAA1B;AACA,gBAAKhH,KAAL,GAAa,UAAb;AACA,gBAAKC,UAAL,GAAkB,UAAlB;;AACA,gBAAKH,QAAL,GAAgB,UAACrV,CAAD,EAAIC,CAAJ;AAAA,iBAAU,CAAC,CAACD,CAAC,CAAC8J,EAAF,IAAQ,EAAT,EAAa5J,aAAb,CAA2BD,CAAC,CAAC6J,EAA7B,CAAD,IAAqC,CAAC,CAAC9J,CAAC,CAAC4lB,OAAF,IAAa,EAAd,EAAkB1lB,aAAlB,CAAgCD,CAAC,CAAC2lB,OAAlC,CAAhD;AAAA,SAAhB;;AANgC;AAOnC;AAED;;;;;;;;qCAIoBnL,O,EAChB6c,Q,EAAiB;AAAA;;AACjB,cAAI,CAAC7c,OAAL,EAAc;AACV,kBAAM,IAAIxmB,KAAJ,CAAU,8CAAV,CAAN;AACH;;AAED,cAAMV,GAAG,+BAAwBknB,OAAO,CAAC3Q,EAAR,GAAa2Q,OAAO,CAAC3Q,EAArB,GAA0B,EAAlD,cAAwDwtB,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAAA,QAAA,GAAY,EAApE,CAAT;;AACA,cAAI,CAAC,KAAKliB,SAAL,CAAe7hB,GAAf,CAAL,EAA0B;AACtB,iBAAK6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAAI2gB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACnD,kBAAMmjB,OAAO,GAAG,SAAVA,OAAU,CAACU,QAAD,EAAmB;AAC/B,uBAAO,OAAI,CAAC7iB,SAAL,CAAe7hB,GAAf,CAAP;AACA4gB,uBAAO,CAAC8jB,QAAD,CAAP;AACH,eAHD;;AAIA,kBAAM3hB,KAAK,GAAG,SAARA,KAAQ,CAAApU,CAAC,EAAI;AACfkS,sBAAM,CAAClS,CAAD,CAAN;AACA,uBAAO,OAAI,CAACkT,SAAL,CAAe7hB,GAAf,CAAP;AACH,eAHD;;AAIA,kBAAM0X,KAAK,GAAG,oBAAAqmB,qBAAA,CAAsB7W,OAAtB,CAAd;;AACA,kBAAIA,OAAO,CAAC3Q,EAAZ,EAAgB;AACZ,uBAAI,CAACghB,IAAL,CAAUrQ,OAAO,CAAC3Q,EAAlB,EAAsBmB,KAAtB,EAA6BsJ,IAA7B,CAAkC,UAAAre,CAAC;AAAA,yBAAIqhC,OAAO,CAAC,CAACrhC,CAAD,CAAD,CAAX;AAAA,iBAAnC,EAAqDogB,KAArD;AACH,eAFD,MAEO;AACH,uBAAI,CAACrL,KAAL,CAAWA,KAAX,EAAkBsJ,IAAlB,CAAuBgjB,OAAvB,EAAgCjhB,KAAhC;AACH;AACJ,aAfqB,CAAtB;AAgBH;;AAED,iBAAO,KAAKlB,SAAL,CAAe7hB,GAAf,CAAP;AACH;AAGD;;;;;;;6BAIYiZ,O,EAAgB;AACxB,iBAAOA,OAAO,CAAC1C,EAAR,GAAa,KAAKwK,MAAL,CAAY9H,OAAO,CAAC1C,EAApB,EAAwB0C,OAAO,CAACyH,MAAR,EAAxB,CAAb,GAAyD,KAAK/Y,GAAL,CAASsR,OAAO,CAACyH,MAAR,EAAT,CAAhE;AACH;AAED;;;;;;;;gCAKenK,E,EAAY1K,M,EAA8B;AACrD,iBAAO,KAAKuV,IAAL,CAAU7K,EAAV,EAAc,SAAd,EAAyB1K,MAAzB,CAAP;AACH;;;+BAEa0K,E,EAAY1K,M,EAAkB;AACxC,iBAAO,KAAKuV,IAAL,CAAU7K,EAAV,EAAc,QAAd,EAAwB1K,MAAxB,CAAP;AACH;;;gCAEc0K,E,EAAY1K,M,EAAkB;AACzC,iBAAO,KAAKuV,IAAL,CAAU7K,EAAV,EAAc,KAAKoL,eAAL,CAAqBQ,SAArB,GAAiC,mBAAjC,GAAuD,SAArE,EAAgFtW,MAAhF,CAAP;AACH;;;6BAEW0K,E,EAAYuS,M,EAA8Bjd,M,EAAkB;AACpE,iBAAO,KAAKuV,IAAL,CAAU7K,EAAV,EAAcuS,MAAd,EAAsBjd,MAAtB,CAAP;AACH;;;gCAEiBqU,Q,EAAiB;AAC/B,iBAAO,IAAI,gBAAA8I,OAAJ,CAAY9I,QAAZ,CAAP;AACH;;;;MA5EyC,oBAAAykB,mB;;AAH9C;;;uBAGaJ,wB,EAAwB,+B,EAAA,+B;AAAA,K;;;aAAxBA,wB;AAAwB,eAAxBA,wBAAwB,K;AAAA,kBAFrB;;;;;2BAEHA,wB,EAAwB;cAHpC,OAAAptB,UAGoC;eAHzB;AACR6I,oBAAU,EAAE;AADJ,S;AAGyB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrBrC;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACLA;AAAA;AAAA;;AAQA;AAAA;AAAA;AAEA;;;;;;AAIA,aAAgB8H,aAAhB,CAA8BZ,OAA9B,EAAuD;AACnD,UAAI,CAACA,OAAL,EAAc;AACV,cAAMxmB,KAAK,CAAC,8CAAD,CAAX;AACH;;AACD,UAAMkkC,oBAAoB,GAAe;AACrC3b,oBAAY,EAAE,IADuB;AAErCf,YAAI,EAAE,IAF+B;AAGrCF,cAAM,EAAE;AAH6B,OAAzC;AAKA,UAAIvd,KAAK,GAAG,KAAZ;AACA;;AACA,UAAIyc,OAAO,CAACM,KAAZ,EAAmB;AAAA,qCACJje,IADI;AAEX,cACI2d,OAAO,CAACW,KAAR,CAAc5nB,cAAd,CAA6BsJ,IAA7B,KACA2d,OAAO,CAACW,KAAR,CAActe,IAAd,aAA+B8H,KAD/B,IAEA6V,OAAO,CAACM,KAAR,CAAcI,KAAd,CAAoB9f,IAApB,CAAyB,UAAC2G,IAAD;AAAA,mBAAUA,IAAI,KAAKlF,IAAnB;AAAA,WAAzB,CAHJ,EAIE;AAAA,yDAC2B2d,OAAO,CAACW,KAAR,CAActe,IAAd,CAD3B;AAAA;;AAAA;AACE,wEAA8C;AAAA,oBAAnCs7B,UAAmC;;AAC1C;AACA,oBACIC,UAAU,CAAC;AACP5nB,sBAAI,EAAEgK,OAAO,CAAChK,IADP;AAEPsK,uBAAK,EAAEN,OAAO,CAACM,KAFR;AAGP1Z,sBAAI,EAAEoZ,OAAO,CAACpZ,IAHP;AAIPzI,0BAAQ,EAAE6hB,OAAO,CAAC7hB,QAJX;AAKPwiB,uBAAK,EAAEgd,UAAU,CAACzC;AALX,iBAAD,CADd,EAQE;AACE,sBAAM2C,OAAO,GAAGF,UAAU,CAAChd,KAA3B;AACA,sBAAMua,UAAU,GAAGyC,UAAU,CAACzC,UAA9B;AACAwC,sCAAoB,CAAC1c,IAArB,GAA4B,KAA5B;AACA;;AACA,sBAAIka,UAAU,CAAC4C,UAAf,EAA2B;AACvBJ,wCAAoB,CAACI,UAArB,GAAkC,oBAAA3C,eAAA,CAC9BD,UAAU,CAAC4C,UADmB,CAAlC;AAGH;AACD;;;AACA,sBAAI5C,UAAU,CAACD,UAAf,EAA2B;AACvByC,wCAAoB,CAACzC,UAArB,GAAkC,oBAAAE,eAAA,CAC9BD,UAAU,CAACD,UADmB,CAAlC;AAGH,mBAfH,CAgBE;AACA;AACA;AACA;;AACA;;;AACA,sBAAI4C,OAAO,CAAC9b,YAAR,KAAyB1iB,SAA7B,EAAwC;AACpCq+B,wCAAoB,CAAC3b,YAArB,GAAoC8b,OAAO,CAAC9b,YAA5C;AACH;;AACDxe,uBAAK,GAAG,IAAR;AACAm6B,sCAAoB,CAAC5c,MAArB,GAA8B,EAA9B;AACA;AACH,iBAnCD,MAoCK;AACD4c,sCAAoB,CAAC5c,MAArB,GAA8B,aAA9B;AACH;AACJ;AA1CH;AAAA;AAAA;AAAA;AAAA;AA2CD;AAED;;;AACA,cAAI,CAAC4c,oBAAoB,CAAC1c,IAA1B,EAAgC;AAC5B;AACH;AAtDU;;AACf,aAAK,IAAM3e,IAAX,IAAmB2d,OAAO,CAACW,KAA3B,EAAkC;AAAA,4BAAvBte,IAAuB;;AAAA,gCAoD1B;AAEP;AACJ;;AACD,UAAI,CAACkB,KAAL,EAAY;AACRm6B,4BAAoB,CAAC1c,IAArB,GAA4B,IAA5B;AACH;;AACD,aAAO0c,oBAAP;AACH;;AAxED;AA2EA;;;;;AAIA,aAASE,UAAT,CAAoB5d,OAApB,EAA8C;AAC1C;AACA,UAAIA,OAAO,CAACW,KAAZ,EAAmB;AACf,YAAM/Z,IAAI,GAAG,IAAI,UAAA0H,MAAJ,CAAW;AAAClR,cAAI,EAAE4iB,OAAO,CAACpZ;AAAf,SAAX,CAAb;AACA,YAAMzB,KAAK,GAAGiF,MAAM,CAACpH,IAAP,CAAYgd,OAAO,CAACW,KAApB,EAA2BrhB,MAAzC;AACA,YAAI8G,OAAO,GAAG,CAAd;AACAgE,cAAM,CAACpH,IAAP,CAAYgd,OAAO,CAACW,KAApB,EAA2BnlB,OAA3B,CAAmC,UAAC1C,GAAD,EAAS;AACxC,cAAIilC,OAAO,GAAG,CAAd;AACA,cAAMC,SAAS,GACXhe,OAAO,CAACW,KAAR,CAAc7nB,GAAd,aAA8BqR,KAA9B,GACO6V,OAAO,CAACW,KAAR,CAAc7nB,GAAd,CADP,GAEM,CAACknB,OAAO,CAACW,KAAR,CAAc7nB,GAAd,CAAD,CAHV;;AAIA,kBAAQA,GAAR;AACI,iBAAK,QAAL;AACI;AACA,kBAAIknB,OAAO,CAAChK,IAAR,IAAgBgK,OAAO,CAAChK,IAAR,CAAaioB,MAAjC,EAAyC;AACrCF,uBAAO,GAAG,CAAV;AACAC,yBAAS,CAACxiC,OAAV,CAAkB,UAACC,CAAD;AAAA,yBACdukB,OAAO,CAAChK,IAAR,CAAaioB,MAAb,CAAoBr9B,IAApB,CAAyB,UAACs9B,CAAD;AAAA,2BAAOA,CAAC,KAAKziC,CAAb;AAAA,mBAAzB,IAA2CsiC,OAAO,EAAlD,GAAuD,IADzC;AAAA,iBAAlB;AAGA;;AACA,oBAAIA,OAAO,GAAG,CAAd,EAAiB;AACb33B,yBAAO;AACV;AACJ;;AACD;;AACJ,iBAAK,WAAL;AACI;AACA,kBAAI4Z,OAAO,CAAChK,IAAR,IAAgBgK,OAAO,CAAChK,IAAR,CAAaS,QAAjC,EAA2C;AACvCsnB,uBAAO,GAAG,CAAV;AACAC,yBAAS,CAACxiC,OAAV,CAAkB,UAACC,CAAD;AAAA,yBACd,CAACukB,OAAO,CAAChK,IAAR,CAAamoB,aAAb,CAA2BhlC,IAA3B,IAAmC,EAApC,EAAwCqH,OAAxC,CAAgD/E,CAAhD,KAAsD,CAAtD,GACMsiC,OAAO,EADb,GAEM,IAHQ;AAAA,iBAAlB;AAKA;;AACA,oBAAIA,OAAO,IAAI/d,OAAO,CAACW,KAAR,CAAc7nB,GAAd,EAAmBwG,MAAlC,EAA0C;AACtC8G,yBAAO;AACV;AACJ;;AACD;;AACJ,iBAAK,WAAL;AACI;AACA,kBAAI4Z,OAAO,CAACpZ,IAAZ,EAAkB;AACd,oBAAMzI,QAAQ,GAAG,oBAAAg9B,eAAA,CAAgB6C,SAAS,CAAC,CAAD,CAAzB,CAAjB;AACA,oBAAMI,KAAK,GAAG,UAAAv3B,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoBiB,QAApB,CAA6B;AAAEJ,yBAAO,EAAEM;AAAX,iBAA7B,CAAd;AACA,oBAAIoF,KAAK,GAAGqD,IAAI,CAAC8uB,YAAL,CAAkB0I,KAAlB,CAAZ;AACA;;AACAh4B,uBAAO,IAAI7C,KAAK,GAAG,CAAH,GAAO,CAAvB;AACH;;AACD;;AACJ,iBAAK,UAAL;AACI;AACA,kBAAIyc,OAAO,CAACpZ,IAAZ,EAAkB;AAEd,oBAAMzI,SAAQ,GAAG,oBAAAg9B,eAAA,CAAgB6C,SAAS,CAAC,CAAD,CAAzB,CAAjB;;AACA,oBAAMI,MAAK,GAAG,UAAAv3B,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAd;;AACA4J,oBAAI,CAAC+uB,WAAL,CAAiByI,MAAK,CAACngC,QAAN,CAAe;AAAEJ,yBAAO,EAAEM;AAAX,iBAAf,CAAjB,IAA0DiI,OAAO,EAAjE,GAAsE,EAAtE;AACH;;AACD;;AACJ,iBAAK,YAAL;AACI;AACA,kBACI4Z,OAAO,CAAC7hB,QAAR,IACA,oBAAAi9B,0BAAA,CAA2Bpb,OAAO,CAAC7hB,QAAnC,EAA6C6/B,SAAS,CAAC,CAAD,CAAtD,CAFJ,EAGE;AACE53B,uBAAO;AACV;;AACD;;AACJ,iBAAK,YAAL;AACI;AACA,kBACI4Z,OAAO,CAAC7hB,QAAR,IACA,oBAAAi9B,0BAAA,CAA2B4C,SAAS,CAAC,CAAD,CAApC,EAAyChe,OAAO,CAAC7hB,QAAjD,CAFJ,EAGE;AACEiI,uBAAO;AACV;;AACD;AAjER;AAmEH,SAzED;AA0EA,eAAOA,OAAO,IAAIjB,KAAlB;AACH;;AACD,aAAO,KAAP;AACH;;;;;;;;;;;;;;;;;;;;;ACjLD;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;QAKak5B,yB;;;;;AAET,yCAAsBhqB,SAAtB,EACYoG,eADZ,EAC8C;AAAA;;AAAA;;AAC1C,sCAAMpG,SAAN,EAAiBoG,eAAjB;AAFkB,gBAAApG,SAAA,GAAAA,SAAA;AAGlB,gCAAAiG,cAAA,CAAesiB,UAAf,CAA0B,0BAAA0B,gBAA1B;AACA,gBAAKxjB,KAAL,GAAa,yBAAb;AACA,gBAAKC,UAAL,GAAkB,mBAAlB;AAJ0C;AAK7C;;;;gCAEW;AACR,gBAAMvhB,KAAK,CAAC,uEAAD,CAAX;AACH;;;+BAEU;AACP,gBAAMA,KAAK,CAAC,sEAAD,CAAX;AACH;;;oCAEkB2jB,Q,EAAe;AAC9B,iBAAO,IAAI,0BAAAmhB,gBAAJ,CAAqBnhB,QAArB,CAAP;AACH;;;+BAEarX,I,EAAwB;AAClC,iBAAO,MAAP,OAAO,CAAP,EAAO,EAAKA,IAAL,CAAP;AACH;;;;MAxB0C,eAAA0U,c;;AAH/C;;;uBAGa6jB,yB,EAAyB,+B,EAAA,+B;AAAA,K;;;aAAzBA,yB;AAAyB,eAAzBA,yBAAyB,K;AAAA,kBAFtB;;;;;2BAEHA,yB,EAAyB;cAHrC,OAAApuB,UAGqC;eAH1B;AACR6I,oBAAU,EAAE;AADJ,S;AAG0B,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXtC;AAAA;AAAA;;QAGawlB,gB;;;;;AAKT,gCAAY3qB,IAAZ,EAA2B;AAAA;;AAAA;;AACvB,sCAAMA,IAAN;AALJ;;AACO,gBAAA4qB,WAAA,GAAc,IAAd;AAKH,gBAAKA,WAAL,GAAmB,IAAnB;AACC,gBAAaC,WAAb,GAA2B,QAAKA,WAAL,IAAoB,CAA/C;AACA,gBAAaC,aAAb,GAA6B,CAAC,CAAC9qB,IAAI,CAAC8qB,aAAP,IAAwB,kBAArD;AAJsB;AAK1B;AAED;;;;;;;iCAGa;AACT,cAAMtkB,GAAG,+EAAT;;AACAA,aAAG,CAACskB,aAAJ,GAAoB,CAAC,CAACtkB,GAAG,CAACskB,aAAN,IAAuBtkB,GAAG,WAA9C;AACA,iBAAOA,GAAP;AACH;;;;MAnBiC,sBAAAukB,Y;;AAAtC;;;;;;;;;;;;;;;;;;;;QCMaA,Y;AA0ET,4BAAY/qB,IAAZ,EAA2B;AAAA;;;AAlC3B;;;AACQ,aAAAgrB,OAAA,GAAU,CAAV;AAGR;;AACO,aAAAJ,WAAA,GAAuB,KAAvB;AA8BH,aAAKK,WAAL,kBAA2BlhC,IAAI,CAACY,KAAL,CAAWZ,IAAI,CAACuJ,MAAL,KAAgB,SAA3B,CAA3B;AACA,aAAKoI,EAAL,GAAUsE,IAAI,CAACtE,EAAL,IAAW,EAArB;AACA,aAAKlW,IAAL,GAAYwa,IAAI,CAACxa,IAAL,IAAa,EAAzB;AACA,aAAKolC,WAAL,GAAmB,KAAKlvB,EAAL,CAAQ6H,QAAR,CAAiB,WAAjB,CAAnB;AACA,aAAK+K,SAAL,GAAiB;AACb4c,oBAAU,EAAE,CAAClrB,IAAI,CAACsO,SAAL,GAAiBtO,IAAI,CAACsO,SAAL,CAAe4c,UAAhC,GAA6ClrB,IAAI,CAACua,cAAnD,KAAsE,CAAC,CADtE;AAEb4Q,kBAAQ,EAAE,CAACnrB,IAAI,CAACsO,SAAL,GAAiBtO,IAAI,CAACsO,SAAL,CAAe6c,QAAhC,GAA2CnrB,IAAI,CAACwa,YAAjD,KAAkE,CAAC;AAFhE,SAAjB;AAIA,aAAK4Q,WAAL,GAAmBprB,IAAI,CAACorB,WAAL,IAAoB,EAAvC;AACA,aAAKC,YAAL,GAAoBrrB,IAAI,CAACqrB,YAAL,IAAqBrrB,IAAI,CAACsrB,MAA9C;AACA,aAAKC,UAAL,GAAkBvrB,IAAI,CAACurB,UAAL,IAAmBvrB,IAAI,CAACwrB,KAAxB,IAAiC,CAAnD;AACA,aAAKC,aAAL,GAAqBzrB,IAAI,CAACyrB,aAA1B;AACA,aAAKC,gBAAL,GAAwB3hC,IAAI,CAACmD,GAAL,CAAS,CAAT,EAAY8S,IAAI,CAAC0rB,gBAAL,IAAyB,CAArC,CAAxB;AACA,aAAKC,gBAAL,GAAwB5hC,IAAI,CAACmD,GAAL,CAAS,CAAT,EAAY8S,IAAI,CAAC2rB,gBAAL,IAAyB,GAArC,CAAxB;AACA,aAAKC,iBAAL,GAAyB5rB,IAAI,CAAC6rB,YAAL,IAAqB7rB,IAAI,CAAC4rB,iBAA1B,IAA+C5rB,IAAI,CAAC8rB,UAA7E;AACA,aAAKhB,aAAL,GAAqB,CAAC,CAAC9qB,IAAI,CAAC8qB,aAA5B;AACA,aAAKiB,UAAL,GAAkB/rB,IAAI,CAAC+rB,UAAL,IAAmB,EAArC;AACA,aAAKC,UAAL,GAAkBhsB,IAAI,CAACgsB,UAAvB;AACA,aAAKC,aAAL,GAAqBjsB,IAAI,CAACisB,aAA1B;AACA,aAAKpB,WAAL,GAAmB,CAAH,KAAG7qB,IAAI,CAAC6qB,WAAL,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,EAAhB,GAAoB,CAAvC;AACA,aAAKG,OAAL,GAAehrB,IAAI,CAACgrB,OAAL,IAAgBhrB,IAAI,CAACksB,MAArB,IAA+B,CAA9C;AACA,aAAKC,OAAL,GAAensB,IAAI,CAACmsB,OAAL,IAAgB,EAA/B;AACA,YAAMC,aAAa,GAAmB,CAACpsB,IAAI,CAACvY,KAAL,IAAc,EAAf,EAAmB6H,GAAnB,CAAuB,UAAA6C,IAAI;AAAA,iBAAI,IAAI44B,YAAJ,CAAiB54B,IAAjB,CAAJ;AAAA,SAA3B,CAAtC;AACA,aAAK1K,KAAL,GAAa2kC,aAAb;AACA,YAAMC,qBAAqB,GAAGD,aAAa,CAAC/7B,MAAd,CAAqB,UAAAkI,CAAC;AAAA,iBAAI,CAACA,CAAC,CAAC+zB,YAAP;AAAA,SAAtB,CAA9B;AACA,aAAKC,cAAL,GAAsBF,qBAAtB;AACA,aAAKC,YAAL,GAAoB,CAAC,CAACtsB,IAAI,CAACssB,YAAP,IAChB;AACCF,qBAAa,CAACzgC,MAAd,GAAuB,CAAvB,IAA4B0gC,qBAAqB,CAAC1gC,MAAtB,KAAiC,CAFlE;AAGA,0BAAeqU,IAAI,WAAJ,KAAiB,MAAjB,IAA2BA,IAAI,WAAJ,KAAiB,IAA3D;AACA,aAAK+M,KAAL,GAAa/M,IAAI,CAAC+M,KAAL,IAAc/M,IAAI,CAAC+M,KAAL,CAAWphB,MAAzB,sBAAsCqU,IAAI,CAAC+M,KAA3C,IAAoD,EAAjE;AACH;;;;oCAEkC;AAAA,cAAlBmf,MAAkB,uEAAD,CAAC;;AAC/B,cAAIA,MAAM,IAAI,KAAKlB,OAAnB,EAA4B;AACxB,gBAAIkB,MAAM,GAAG,KAAKR,gBAAlB,EAAoC;AAChCQ,oBAAM,GAAG,CAAT;AACH;AACJ,WAJD,MAIO;AACH,gBAAIA,MAAM,GAAG,KAAKR,gBAAlB,EAAoC;AAChCQ,oBAAM,GAAG,KAAKR,gBAAd;AACH;AACJ;;AACD,eAAKV,OAAL,GAAejhC,IAAI,CAACmD,GAAL,CAAS,CAAT,EAAYnD,IAAI,CAACq9B,GAAL,CAAS,KAAKuE,gBAAd,EAAgCO,MAAhC,CAAZ,CAAf;AACH;AAED;;;;;;;mCAIiC;AAAA,cAAjBV,KAAiB,uEAAD,CAAC;AAC7B,cAAG,KAAKD,UAAL,KAAoBC,KAAvB,EAA8B,KAAKD,UAAL,GAAkBC,KAAlB;AACjC;AAED;;;;;;;qCAIsC;AAAA,cAApBU,MAAoB,uEAAH,CAAG;AAClCA,gBAAM,GAAGniC,IAAI,CAACmD,GAAL,CAAS,CAAT,EAAYg/B,MAAZ,CAAT;AACA,eAAKlB,OAAL,IAAgBkB,MAAhB;;AACA,cAAI,KAAKlB,OAAL,GAAe,CAAnB,EAAsB;AAClB,iBAAKA,OAAL,GAAe,CAAf;AACH,WAFD,MAEO,IAAI,KAAKA,OAAL,GAAe,KAAKU,gBAAxB,EAA0C;AAC7C,iBAAKV,OAAL,GAAe,KAAKU,gBAApB;AACH,WAFM,MAEA,IAAI,KAAKV,OAAL,GAAe,KAAKW,gBAAxB,EAA0C;AAC7C,iBAAKX,OAAL,GAAe,KAAKW,gBAApB;AACH;AACJ;AAED;;;;;;;0CAI2C;AAAA,cAApBO,MAAoB,uEAAH,CAAG;AACvCA,gBAAM,GAAGniC,IAAI,CAACmD,GAAL,CAAS,CAAT,EAAYg/B,MAAZ,CAAT;AACA,eAAKlB,OAAL,IAAgBkB,MAAhB;;AACA,cAAI,KAAKlB,OAAL,GAAe,CAAnB,EAAsB;AAClB,iBAAKA,OAAL,GAAe,CAAf;AACH,WAFD,MAEO,IAAI,KAAKA,OAAL,GAAe,KAAKU,gBAAxB,EAA0C;AAC7C,iBAAKV,OAAL,GAAe,CAAf;AACH;AACJ;AAED;;;;;;iCAGa;AACT,cAAMxkB,GAAG,qBAAa,IAAb,CAAT,CADS,CAET;;AACA,iBAAOA,GAAG,CAACC,QAAX;AACA,iBAAOD,GAAG,CAACf,aAAX,CAJS,CAKT;;AACAe,aAAG,CAACglB,KAAJ,GAAYhlB,GAAG,CAAC+kB,UAAhB;AACA/kB,aAAG,CAACslB,UAAJ,GAAiBtlB,GAAG,CAAColB,iBAArB;AACA,cAAMv8B,IAAI,GAAGoH,MAAM,CAACpH,IAAP,CAAYmX,GAAZ,CAAb;;AACA,qCAAkBnX,IAAlB,8BAAwB;AAAnB,gBAAMlK,GAAG,cAAT;;AACD,gBAAIA,GAAG,CAAC,CAAD,CAAH,KAAW,GAAf,EAAoB;AAChB,kBAAMuhB,OAAO,GAAGvhB,GAAG,CAACqnC,MAAJ,CAAW,CAAX,CAAhB;AACAhmB,iBAAG,CAACE,OAAD,CAAH,GAAeF,GAAG,CAACrhB,GAAD,CAAlB;AACA,qBAAOqhB,GAAG,CAACrhB,GAAD,CAAV;AACH,aAJD,MAIO,IAAIqhB,GAAG,CAACrhB,GAAD,CAAH,KAAauG,SAAjB,EAA4B;AAC/B,qBAAO8a,GAAG,CAACrhB,GAAD,CAAV;AACH;AACJ;;AACDqhB,aAAG,CAAC/e,KAAJ,GAAY+e,GAAG,CAAC/e,KAAJ,CAAU6H,GAAV,CAAc,UAAC6C,IAAD;AAAA,mBAAwBA,IAAI,CAAC0T,MAAL,EAAxB;AAAA,WAAd,CAAZ;AACA,iBAAOW,GAAP;AACH;;;4BArI2B;AACxB,iBACI,KAAKskB,aAAL,IACA,CAAC,eAAD,IAAiB,KAAKrjC,KAAL,CAAW2F,MAAX,CACb,UAACq/B,OAAD,EAAUt6B,IAAV;AAAA,mBAAmBs6B,OAAO,IAAIt6B,IAAI,CAACu6B,iBAAnC;AAAA,WADa,EAEb,KAFa,CAFrB;AAOH;AAED;;;;4BACiB;AACb,iBAAO,KAAK1B,OAAL,IAAgB,CAAvB;AACH;AAEA;;;;4BACgB;AACb,iBAAO,KAAKO,UAAL,IAAmB,CAA1B;AACH;AAED;;;;4BACgB;AACZ,iBAAQ,KAAKP,OAAL,GAAe,KAAKO,UAArB,IAAoC,CAA3C;AACH;;;;;;AAxEL;;;;;;;;;;;;;;;;;;;;ACRA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;QAKaoB,oB;;;;;AACT,oCAAsBjsB,SAAtB,EACYoG,eADZ,EAC8C;AAAA;;AAAA;;AAC1C,sCAAMpG,SAAN,EAAiBoG,eAAjB;AAFkB,gBAAApG,SAAA,GAAAA,SAAA;AAGlB,gCAAAiG,cAAA,CAAesiB,UAAf,CAA0B,sBAAA8B,YAA1B;AACA,gBAAK5jB,KAAL,GAAa,eAAb;AACA,gBAAKC,UAAL,GAAkB,eAAlB;AAJ0C;AAK7C;;;;gCAEW;AACR,gBAAMvhB,KAAK,CAAC,yDAAD,CAAX;AACH;;;+BAEU;AACP,gBAAMA,KAAK,CAAC,wDAAD,CAAX;AACH;;;oCAEkB2jB,Q,EAAe;AAC9B,iBAAO,IAAI,sBAAAuhB,YAAJ,CAAiBvhB,QAAjB,CAAP;AACH;;;+BAEarX,I,EAAoB;AAC9B,iBAAOA,IAAI,YAAY,sBAAA44B,YAAhB,GAA+B54B,IAAI,CAAC0T,MAAL,EAA/B,GAA+C1T,IAAtD;AACH;;;;MAvBqC,eAAA0U,c;;AAH1C;;;uBAGa8lB,oB,EAAoB,+B,EAAA,+B;AAAA,K;;;aAApBA,oB;AAAoB,eAApBA,oBAAoB,K;AAAA,kBAFjB;;;;;2BAEHA,oB,EAAoB;cAHhC,OAAArwB,UAGgC;eAHrB;AACR6I,oBAAU,EAAE;AADJ,S;AAGqB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXjC;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;QAKaynB,mB;;;;;AACT,mCAAsBlsB,SAAtB,EACYoG,eADZ,EAC8C;AAAA;;AAAA;;AAC1C,sCAAMpG,SAAN,EAAiBoG,eAAjB;AAFkB,gBAAApG,SAAA,GAAAA,SAAA;AAGlB,gBAAKyG,KAAL,GAAa,eAAb;AACA,gBAAKC,UAAL,GAAkB,MAAlB;AAH0C;AAI7C;AAED;;;;;;;;oCAIsBjV,I,EAAe;AACjC,iBAAOA,IAAI,CAAC1K,KAAL,GAAa,IAAI,0BAAAkjC,gBAAJ,CAAqBx4B,IAArB,CAAb,GAA0C,IAAI,sBAAA44B,YAAJ,CAAiB54B,IAAjB,CAAjD;AACH;;;;MAdoC,eAAA0U,c;;AAHzC;;;uBAGa+lB,mB,EAAmB,+B,EAAA,+B;AAAA,K;;;aAAnBA,mB;AAAmB,eAAnBA,mBAAmB,K;AAAA,kBAFhB;;;;;2BAEHA,mB,EAAmB;cAH/B,OAAAtwB,UAG+B;eAHpB;AACR6I,oBAAU,EAAE;AADJ,S;AAGoB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXhC;AAAA;AAAA;;;;;;QAKa0nB,oB;AAHb;AAAA;;AAKW,aAAAC,aAAA,GAAgB,EAAhB;AAUV;;;;iCAPmB5O,K,EAAO;AACnB,eAAK4O,aAAL,GAAqB5O,KAArB;AACH;;;mCAEiB;AACd,iBAAO,KAAK4O,aAAZ;AACH;;;;;;AAdL;;;uBAGaD,oB;AAAoB,K;;;aAApBA,oB;AAAoB,eAApBA,oBAAoB,K;AAAA,kBAFjB;;;;;2BAEHA,oB,EAAoB;cAHhC,OAAAvwB,UAGgC;eAHrB;AACR6I,oBAAU,EAAE;AADJ,S;AAGqB,Q;;;;;;;;;;;;;;;;;;;;;;ACNjC;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAaA,QAAMsL,GAAG,GAAG,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAZ,C,CAEA;;QACam2B,a;AA8EX,6BAAYxf,IAAZ,EAA2B;AAAA;;;AAzD3B;;;AACA,aAAAsiB,WAAA,GAAsB,EAAtB;AACA;;AACA,aAAAxf,QAAA,GAAmB,EAAnB;AAMA;;;;;;;;;;AASO,aAAA1E,OAAA,GAAmB,IAAnB;AAaP;;AACS,aAAAojB,aAAA,GAAwB,CAAxB;AAOT;;AACS,aAAA/5B,KAAA,GAAsD,EAAtD,CAiBkB,CAV3B;AACA;;AACA;;AACU,aAAAge,aAAA,GAAiC,EAAjC;AAQR;;;;AAGA,YAAMuX,KAAK,GAAG,UAAA9pB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAd,CAJyB,CAKzB;;AACA,YAAMy1B,cAAc,GAAG9B,KAAK,CAAC3yB,QAAN,CAAe;AAAEP,gBAAM,EAAEC,IAAI,CAACC,IAAL,CAAUgzB,KAAK,CAAC9yB,OAAN,GAAgB,CAA1B,IAA+B;AAAzC,SAAf,CAAvB;AACA,YAAMgzB,oBAAoB,GAAG,CAAH,WAAGC,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEC,cAAN,EAAH,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAIC,eAAJ,EAApB,MAAuC,IAAvC,IAAuC,aAAvC,GAAuC,MAAvC,GAAuC,GAAIC,QAAxE;AAEA,aAAK5hB,EAAL,GAAUsE,IAAI,CAACtE,EAAL,oBAAoB3R,IAAI,CAACY,KAAL,CAAWZ,IAAI,CAACuJ,MAAL,KAAgB,SAA3B,CAApB,CAAV,CATyB,CAWzB;;AACA,aAAK8K,OAAL,GAAe4B,IAAI,CAAC5B,OAAL,IAAgB,IAA/B,CAZyB,CAezB;;AACA,YAAI,KAAK2uB,kBAAT,EAA6B;AAC3B,eAAKxT,YAAL,GAAoB,KAAKnb,OAAL,CAAa/J,WAAb,CAAyBjB,EAA7C;AACA,eAAKmvB,gBAAL,GAAwB,KAAKnkB,OAAL,CAAa/P,QAArC;AACA,eAAK2+B,aAAL,GAAqB,KAAK5uB,OAAL,CAAa/J,WAAlC;AACA,eAAKiuB,WAAL,GAAmBtiB,IAAI,CAACsiB,WAAL,IAAoB,EAAvC;AACA,eAAKxf,QAAL,GAAgB9C,IAAI,CAAC8C,QAAL,IAAiB,EAAjC;AACD,SAND,MAMO;AACL,eAAKyW,YAAL,GAAoBvZ,IAAI,CAACuZ,YAAL,IAAqBuF,cAAc,CAAC1rB,EAAxD;AACA,eAAKmvB,gBAAL,GAAwBviB,IAAI,CAACuiB,gBAAL,IAAyBrF,oBAAjD;AACA,eAAK8P,aAAL,GAAqB,IAAI,UAAAryB,MAAJ,CAAW;AAAElR,gBAAI,EAAE,KAAK8vB,YAAb;AAA2BzI,uBAAW,EAAE,KAAxC;AAA+CC,uBAAW,EAAE,KAAKwR;AAAjE,WAAX,CAArB;AACA,eAAKD,WAAL,GAAmBtiB,IAAI,CAACsiB,WAAL,IAAoB,EAAvC;AACA,eAAKxf,QAAL,GAAgB9C,IAAI,CAAC8C,QAAL,IAAiB,EAAjC;AACD;;AAED,aAAK0e,aAAL,GAAqB,OAAOxhB,IAAI,CAACwhB,aAAZ,KAA8B,QAA9B,GAAyCxhB,IAAI,CAACwhB,aAA9C,GAA8D,CAAnF;AACA,aAAKvT,MAAL,GAAcjO,IAAI,CAACiO,MAAL,IAAe,UAA7B;AACA,aAAKgf,WAAL,GAAmBjtB,IAAI,CAACitB,WAAL,IAAoBjtB,IAAI,CAACwT,IAA5C;AACA,aAAK0K,KAAL,GAAale,IAAI,CAACke,KAAlB;AACA,aAAKgP,OAAL,GAAeltB,IAAI,CAACktB,OAAL,YAAwB12B,KAAxB,GAAgC,CAAC,CAACwJ,IAAI,CAACktB,OAAL,CAAavhC,MAA/C,GAAwDqU,IAAI,CAACktB,OAA5E;AACA,aAAKC,MAAL,GAAcntB,IAAI,CAACmtB,MAAL,YAAuB32B,KAAvB,GAA+B,CAAC,CAACwJ,IAAI,CAACmtB,MAAL,CAAYxhC,MAA7C,GAAsDqU,IAAI,CAACmtB,MAAzE;AACA,aAAKC,MAAL,GAAcptB,IAAI,CAACotB,MAAL,IAAe,KAA7B;AACA,aAAK3lC,KAAL,GAAa,CAACuY,IAAI,CAACvY,KAAL,IAAc,EAAf,EACV6H,GADU,CACN,UAAA6C,IAAI;AAAA,iBAAKA,IAAI,CAAC1K,KAAL,GAAa,IAAI,0BAAAkjC,gBAAJ,CAAqBx4B,IAArB,CAAb,GAA0C,IAAI,sBAAA44B,YAAJ,CAAiB54B,IAAjB,CAA/C;AAAA,SADE,EAEV9B,MAFU,CAEH,UAAA8B,IAAI;AAAA,iBAAI,CAAC,CAACA,IAAI,CAAC+5B,MAAX;AAAA,SAFD,CAAb;AAGD;AAED;;;;;;AAgDA;;;gCAGY;AACR,iBAAO,IAAI1M,aAAJ,CAAkB,KAAK3Z,MAAL,EAAlB,CAAP;AACH;AAED;;;;;;iCAGa;AACX,cAAMW,GAAG,qBAAa,IAAb,CAAT,CADW,CAEX;;AACA,iBAAOA,GAAG,CAACf,aAAX,CAHW,CAIX;;AACA,iBAAOe,GAAG,CAACpI,OAAX;AACA,iBAAOoI,GAAG,CAAC9D,OAAX;AACA,iBAAO8D,GAAG,CAACwmB,aAAX,CAPW,CASX;;AACA,cAAM39B,IAAI,GAAGoH,MAAM,CAACpH,IAAP,CAAYmX,GAAZ,CAAb;;AACA,qCAAkBnX,IAAlB,8BAAwB;AAAnB,gBAAMlK,GAAG,cAAT;;AACH,gBAAIA,GAAG,CAAC,CAAD,CAAH,KAAW,GAAf,EAAoB;AAClB,kBAAMuhB,OAAO,GAAG,KAAKjB,aAAL,CAAmBtgB,GAAG,CAACqnC,MAAJ,CAAW,CAAX,CAAnB,KAAqCrnC,GAAG,CAACqnC,MAAJ,CAAW,CAAX,CAArD;AACAhmB,iBAAG,CAACE,OAAD,CAAH,GAAeF,GAAG,CAACrhB,GAAD,CAAlB;AACA,qBAAOqhB,GAAG,CAACrhB,GAAD,CAAV;AACD,aAJD,MAIO,IAAIqhB,GAAG,CAACrhB,GAAD,CAAH,KAAauG,SAAjB,EAA4B;AACjC,qBAAO8a,GAAG,CAACrhB,GAAD,CAAV;AACD;AACF;;AACDqhB,aAAG,CAAC/e,KAAJ,GAAY+e,GAAG,CAAC/e,KAAJ,CAAU6H,GAAV,CAAc,UAAC6C,IAAD;AAAA,mBAAwBA,IAAI,CAAC0T,MAAL,EAAxB;AAAA,WAAd,CAAZ;AAEA,iBAAOW,GAAP;AACD;;;4BAhF4B;AAC3B,iBAAO,CAAC,CAAC,KAAKpI,OAAd;AACD;AAED;;;;4BACe;AACb,cAAI1P,IAAI,GAAG,EAAX;AACA;;AACA,cAAI,KAAKw+B,OAAT,EAAkBx+B,IAAI,IAAI,SAAR;AAClB;;AACA,cAAI,KAAKy+B,MAAT,EAAiB;AACf;AACA,gBAAIz+B,IAAJ,EAAUA,IAAI,IAAI,KAAR;AACVA,gBAAI,IAAI,QAAR;AACD;;AACD,iBAAOA,IAAP;AACD;AAED;;;;4BACgB;AACd,iBAAO,KAAKjH,KAAL,CAAW2F,MAAX,CAAkB,UAACigC,KAAD,EAAQl7B,IAAR;AAAA,mBAAiBk7B,KAAK,IAAIl7B,IAAI,CAACk7B,KAAL,IAAc,CAAlB,CAAtB;AAAA,WAAlB,EAA8D,CAA9D,CAAP;AACD;AAED;;;;4BACqB;AACnB,iBAAO,KAAK5lC,KAAL,CAAW2F,MAAX,CAAkB,UAACigC,KAAD,EAAQl7B,IAAR;AAAA,mBAAiBk7B,KAAK,IAAIl7B,IAAI,CAAC+5B,MAAL,IAAe,CAAnB,CAAtB;AAAA,WAAlB,EAA+D,CAA/D,CAAP;AACD;;;4BAEsB;;;AACrB,iBAAO,CAAC,KAAKc,aAAL,KAAkB,MAAI,KAAK5uB,OAAT,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAE/J,WAApC,CAAD,EAAkD/J,QAAlD,CAA2D;AAAEJ,mBAAO,EAAE,KAAKs3B;AAAhB,WAA3D,CAAP;AACD;AAED;;;;4BACqB;AACnB,iBAAO,KAAK8L,YAAL,CAAkBviC,UAAlB,CAA6B,QAA7B,CAAP;AACD;AAED;;;;4BAC0B;AACxB,iBAAO,KAAKuiC,YAAL,CAAkBviC,UAAlB,CAA6B,OAA7B,EAAsCmJ,iBAAtC,EAAP;AACD;AAED;;;;4BAC0B;AACxB,iBAAO,KAAKo5B,YAAL,CAAkBviC,UAAlB,CAA6B,aAA7B,CAAP;AACD;;;;;;AAtKH;;;;;;;;;;;;;;;;;;;;ACtBA;AAAA;AAAA;;AAEa,YAAAwiC,6BAAA,GAAgC,UAACC,QAAD,EAAyBC,QAAzB;AAAA,aACzC,IAAI,sBAAA1C,YAAJ,CAAiB,MAAD,OAAC,CAAD,kBACRyC,QAAQ,YAAY,sBAAAzC,YAApB,GAAmCyC,QAAQ,CAAC3nB,MAAT,EAAnC,GAAuD2nB,QAD/C,CAAC,EAEVC,QAFU,CAAjB,CADyC;AAAA,KAAhC;;;;;;;;;;;;;;;;;;;;;;;;;ACFb;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACPA;AAAA;AAAA;;;;;;QAMaC,kB;AAGX,oCAAc;AAAA;;AAFN,aAAAC,YAAA,GAAe,IAAI5uB,GAAJ,EAAf;AAES,O,CAEjB;;;;;uCACerD,E,EAAYkyB,S,EAA4B;AACrD,eAAKD,YAAL,CAAkBvkC,GAAlB,CAAsBsS,EAAtB,EAA0BkyB,SAA1B;AACD,S,CAED;;;;oCACYlyB,E,EAAU;AACpB,cAAMkyB,SAAS,GAAG,KAAKD,YAAL,CAAkBxuB,GAAlB,CAAsBzD,EAAtB,CAAlB;;AACA,cAAIkyB,SAAJ,EAAe;AACbA,qBAAS,CAACC,KAAV;AACA,iBAAKF,YAAL,WAAyBjyB,EAAzB;AACD;AACF,S,CAED;;;;0CACe;AAAA;;AACb,eAAKiyB,YAAL,CAAkB9lC,OAAlB,CAA0B,UAAC+lC,SAAD,EAAYlyB,EAAZ,EAAmB;AAC3CkyB,qBAAS,CAACC,KAAV;;AACA,mBAAI,CAACF,YAAL,WAAyBjyB,EAAzB;AACD,WAHD;AAID;;;;;;AA5BH;;;uBAGagyB,kB;AAAkB,K;;;aAAlBA,kB;AAAkB,eAAlBA,kBAAkB,K;AAAA,kBAFjB;;;;;2BAEDA,kB,EAAkB;cAH9B,OAAApxB,UAG8B;eAHnB;AACV6I,oBAAU,EAAE;AADF,S;AAGmB,Q;;;;;AA4B/B,QAAY2oB,SAAZ;;AAAA,eAAYA,SAAZ,EAAqB;AACnB;AACA;AACD,KAHD,EAAYA,SAAS,GAAT,QAAAA,SAAA,aAAAA,SAAA,GAAS,EAAT,CAAZ;;;;;;;;;;;;;;;;;;;;;AClCA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;QAKaC,gB;;;;AAHb;;YAGaA;;;;yBAAAA,gB;AAAgB,O;AAAA,gBAFlB,CAAC,SAAArpC,YAAD,CAEkB;;;;+EAAhBqpC,gB,EAAgB;AAAA,kBAFjB,SAAArpC,YAEiB;AAAA,O;AAFL,K;;;;;2BAEXqpC,gB,EAAgB;cAH5B,OAAAppC,QAG4B;eAHnB;AACRC,iBAAO,EAAE,CAAC,SAAAF,YAAD;AADD,S;AAGmB,Q;;;;;;;;;;;;;;;;;;;;;;ACN7B;AAAA;AAAA;;AACA;AAAA;AAAA;;AAMA;AAAA;AAAA;;;;;AAKA;;;AACA,QAAMspC,uBAAuB,GAAa,CAAC,SAAD,EAAY,OAAZ,EAAqB,KAArB,EAA4B,MAA5B,EAAoC,IAApC,CAA1C;;QAKaC,c;AAcX,gCAAc;AAAA;;AAAA;;AAbd;AACQ,aAAAC,cAAA,GAAmD,EAAnD;AACR;;AACQ,aAAAC,iBAAA,GAAiD,EAAjD;AACR;;AACQ,aAAAC,SAAA,GAAsB,EAAtB;AACR;;AACQ,aAAAC,iBAAA,GAAgC,EAAhC;AACR;;AACQ,aAAAjE,OAAA,GAAkB,CAAlB;AAKNp7B,cAAM,CAACs/B,gBAAP,CAAwB,SAAxB,EAAmC,UAACn3B,KAAD,EAA0B;AAC3D,cAAMqc,IAAI,GAAG,OAAI,CAAC+a,MAAL,CAAY,CAACp3B,KAAK,CAACqc,IAAN,IAAc,EAAf,EAAmBriB,WAAnB,EAAZ,CAAb;AACA;;;AACA,cAAI,OAAI,CAACq9B,SAAL,KAAmBhb,IAAvB,EAA6B;AAC3B;AACA,gBAAI,CAAC,OAAI,CAAC0a,cAAL,CAAoB1a,IAApB,CAAL,EAAgC;AAC9B,qBAAI,CAAC0a,cAAL,CAAoB1a,IAApB,IAA4B,IAAI,OAAAtuB,eAAJ,CAAoB,IAApB,CAA5B;AACA,qBAAI,CAACipC,iBAAL,CAAuB3a,IAAvB,IAA+B,OAAI,CAAC0a,cAAL,CAAoB1a,IAApB,EAA0BzR,YAA1B,EAA/B;AACD;;AACD,mBAAI,CAACmsB,cAAL,CAAoB1a,IAApB,EAA0B5b,IAA1B,CAA+B,EAAE,OAAI,CAACwyB,OAAtC;AACA;;;AACA,gBAAI,OAAI,CAACgE,SAAL,CAAevhC,OAAf,CAAuB2mB,IAAvB,KAAgC,CAApC,EAAuC;AACrCrc,mBAAK,CAACs3B,cAAN;AACD;;AACD,mBAAI,CAACD,SAAL,GAAiBhb,IAAjB;AACD;AACF,SAhBD;AAkBAxkB,cAAM,CAACs/B,gBAAP,CAAwB,OAAxB,EAAiC,UAACn3B,KAAD,EAA0B;AACzD,cAAMqc,IAAI,GAAG,OAAI,CAAC+a,MAAL,CAAY,CAACp3B,KAAK,CAACqc,IAAN,IAAc,EAAf,EAAmBriB,WAAnB,EAAZ,CAAb;AACA;;;AACA,cAAI,OAAI,CAAC+8B,cAAL,CAAoB1a,IAApB,CAAJ,EAA+B;AAC7B,mBAAI,CAAC0a,cAAL,CAAoB1a,IAApB,EAA0B5b,IAA1B,CAA+B,IAA/B;AACD;AACD;;;AACA,cAAI,OAAI,CAAC42B,SAAL,KAAmBhb,IAAvB,EAA6B;AAC3B,mBAAI,CAACgb,SAAL,GAAiB,IAAjB;AACD;AACF,SAVD;AAWD;AAED;;;;;;;;;+BAKcE,K,EAA0B92B,I,EAAgB;AAAA;;AACtD82B,eAAK,GAAIA,KAAK,YAAYl4B,KAAjB,GAAyBk4B,KAAzB,GAAiCA,KAAK,CAACjjC,KAAN,CAAY,GAAZ,CAA1C;AACA,cAAMkjC,WAAW,GAAaD,KAAK,CAACp/B,GAAN,CAAU,UAAAxH,CAAC;AAAA,mBAAI,OAAI,CAACymC,MAAL,CAAYzmC,CAAC,CAACqJ,WAAF,EAAZ,CAAJ;AAAA,WAAX,CAA9B;AACA;;AACA,cAAIw9B,WAAW,CAAChjC,MAAZ,GAAqB,CAArB,IAA0B,KAAKijC,gBAAL,CAAsBD,WAAtB,CAA9B,EAAkE;AAChE,iBAAKN,iBAAL,CAAuB/8B,IAAvB,CAA4Bq9B,WAA5B;AACA,gBAAME,QAAQ,GAAGF,WAAW,CAACA,WAAW,CAAChjC,MAAZ,GAAqB,CAAtB,CAA5B;AACA;;AACA,gBAAI,CAAC,KAAKuiC,cAAL,CAAoBW,QAApB,CAAL,EAAoC;AAClC,mBAAKX,cAAL,CAAoBW,QAApB,IAAgC,IAAI,OAAA3pC,eAAJ,CAAoB,IAApB,CAAhC;AACA,mBAAKipC,iBAAL,CAAuBU,QAAvB,IAAmC,KAAKX,cAAL,CAAoBW,QAApB,EAA8B9sB,YAA9B,EAAnC;AACD;;AACD,iBAAK+sB,wBAAL;AACA,mBAAO,KAAKX,iBAAL,CAAuBU,QAAvB,EAAiCnnC,SAAjC,CAA2C,UAAC8J,KAAD,EAAW;AAC3D;AACA,kBAAIA,KAAJ,EAAW;AACT,oBAAMu9B,OAAO,GAAa,EAA1B;AACA;;AACA,oBAAIJ,WAAW,CAAChjC,MAAZ,GAAqB,CAAzB,EAA4B;AAC1B;AAD0B,+DAERgjC,WAFQ;AAAA;;AAAA;AAE1B,8EAA+B;AAAA,0BAApBxpC,GAAoB;AAC7B,0BAAMX,KAAK,GAAG,OAAI,CAAC0pC,cAAL,CAAoB/oC,GAApB,CAAd;AACA4pC,6BAAO,CAACz9B,IAAR,CAAa9M,KAAK,GAAGA,KAAK,CAACyB,QAAN,MAAoB,CAAC,CAAxB,GAA4B,CAAC,CAA/C;AACD,qBALyB,CAM1B;;AAN0B;AAAA;AAAA;AAAA;AAAA;;AAO1B,uBAAK,IAAI6B,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAG6mC,WAAW,CAAChjC,MAAZ,GAAqB,CAAzC,EAA4C7D,GAAC,EAA7C,EAAiD;AAC/C,wBAAIinC,OAAO,CAACjnC,GAAD,CAAP,GAAainC,OAAO,CAACjnC,GAAC,GAAG,CAAL,CAAxB,EAAiC;AAC/B;AACD;AACF;AACF;;AACD,oBAAMulC,KAAK,GAAG0B,OAAO,CAAC3hC,MAAR,CAAe,UAACwE,CAAD,EAAIuE,CAAJ;AAAA,yBAAUvE,CAAC,IAAIuE,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAY,CAAC,CAAjB,CAAX;AAAA,iBAAf,EAA+C,CAA/C,CAAd;AACA;;AACA,oBAAIk3B,KAAK,IAAIsB,WAAW,CAAChjC,MAAzB,EAAiC;AAC/BiM,sBAAI;AACL;AACF;AACF,aAxBM,CAAP;AAyBD;;AACD,iBAAO,IAAP;AACD;AAED;;;;;;;+BAIe4b,I,EAAY;AACzB;AACA,cAAIA,IAAI,CAAC3mB,OAAL,CAAa,KAAb,KAAuB,CAAvB,IAA4B2mB,IAAI,CAAC3mB,OAAL,CAAa,OAAb,KAAyB,CAArD,IAA0D2mB,IAAI,CAAC3mB,OAAL,CAAa,SAAb,KAA2B,CAAzF,EAA4F;AAC1F,mBAAO2mB,IAAI,CAAC9gB,OAAL,CAAa,MAAb,EAAqB,EAArB,EAAyBA,OAAzB,CAAiC,OAAjC,EAA0C,EAA1C,CAAP;AACD;;AACD,iBAAO8gB,IAAP;AACD;AAED;;;;;;mDAGgC;AAC9B,cAAMwb,QAAQ,GAAG,EAAjB;;AAD8B,uDAEV,KAAKX,iBAFK;AAAA;;AAAA;AAE9B,sEAA4C;AAAA,kBAAjCK,KAAiC;AAC1C,mBAAKN,SAAL,CAAe98B,IAAf,CAAoBo9B,KAAK,CAACA,KAAK,CAAC/iC,MAAN,GAAe,CAAhB,CAAzB;AACD;AAJ6B;AAAA;AAAA;AAAA;AAAA;;AAK9B,eAAKyiC,SAAL,GAAiB,OAAAj+B,MAAA,CAAO6+B,QAAP,CAAjB;AACD;AAED;;;;;;;yCAIyBN,K,EAAe;AACtC,cAAIO,QAAQ,GAAG,CAAf;;AADsC,uDAEpBP,KAFoB;AAAA;;AAAA;AAEtC,sEAAyB;AAAA,kBAAdvpC,GAAc;;AACvB;AACA,kBAAI6oC,uBAAuB,CAACnhC,OAAxB,CAAgC1H,GAAhC,IAAuC,CAA3C,EAA8C;AAC5C8pC,wBAAQ;AACT;AACF;AAPqC;AAAA;AAAA;AAAA;AAAA;;AAQtC,iBAAOA,QAAQ,GAAG,CAAlB;AACD;;;;;;AApIH;;;uBAGahB,c;AAAc,K;;;aAAdA,c;AAAc,eAAdA,cAAc,K;AAAA,kBAFb;;;;;2BAEDA,c,EAAc;cAH1B,OAAA3xB,UAG0B;eAHf;AACV6I,oBAAU,EAAE;AADF,S;AAGe,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClB3B;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACCA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;QAEa+pB,W;AAyCX,2BAAY7pB,QAAZ,EAA+B;AAAA;;AAC7B,aAAK3J,EAAL,GAAU2J,QAAQ,CAAC3J,EAAT,IAAe2J,QAAQ,CAAC8pB,MAAxB,IAAkC9pB,QAAQ,CAAC+pB,OAArD;AACA,aAAK5pC,IAAL,GAAY6f,QAAQ,CAAC7f,IAAT,IAAiB,EAA7B;AACA,aAAKyB,CAAL,GAASoe,QAAQ,CAACpe,CAAT,GACL8C,IAAI,CAACY,KAAL,CAAW,KAAK0kC,SAAL,CAAehqB,QAAQ,CAACpe,CAAxB,EAA2Boe,QAAQ,CAACiqB,KAAT,IAAkB,KAA7C,IAAsD,KAAjE,CADK,GAEL,IAFJ;AAGA,aAAKpoC,CAAL,GAASme,QAAQ,CAACne,CAAT,GACL6C,IAAI,CAACY,KAAL,CAAW,KAAK0kC,SAAL,CAAehqB,QAAQ,CAACne,CAAxB,EAA2Bme,QAAQ,CAACiqB,KAAT,IAAkB,KAA7C,IAAsD,KAAjE,CADK,GAEL,IAFJ;AAGA,YAAMpY,OAAO,GAAG,wBAAAvQ,cAAA,CAAeC,UAAf,CAA0B,qBAAA2oB,YAA1B,CAAhB;AACA,aAAK5a,KAAL,GACEtP,QAAQ,CAACsP,KAAT,YAA0B,cAAA6a,aAA1B,GACInqB,QAAQ,CAACsP,KADb,GAEIuC,OAAO,GACPA,OAAO,CAACuY,WAAR,CAAoBpqB,QAAQ,CAACsP,KAA7B,CADO,GAEP,IAAI,cAAA6a,aAAJ,CAAkBnqB,QAAQ,CAACsP,KAA3B,CALN;AAMA,aAAK+a,KAAL,GAAa,KAAKzoC,CAAL,KAAW,IAAX,IAAmB,KAAKC,CAAL,KAAW,IAA3C;AACA,aAAKyoC,UAAL,GAAkB5lC,IAAI,CAACmD,GAAL,CAAS,CAAT,EAAYnD,IAAI,CAACq9B,GAAL,CAAS,EAAT,EAAa/hB,QAAQ,CAACsqB,UAAT,IAAuB,CAApC,CAAZ,CAAlB;AACA,aAAKC,OAAL,GAAe,KAAKl0B,EAAL,IAAW,KAAKA,EAAL,CAAQ7O,OAAR,CAAgB,OAAhB,MAA6B,CAAvD;AACA,aAAKkQ,KAAL,GAAa,EAAE,KAAKvX,IAAL,IAAa,KAAKmvB,KAAlB,KAA4B,KAAKjZ,EAAL,IAAW,KAAKzU,CAAhB,IAAqB,KAAKC,CAAtD,CAAF,CAAb;AACD;AAzCD;;;;;;AA2CA;kCACkByF,K,EAAeO,G,EAAW;AAC1C,iBAAOP,KAAK,IAAIO,GAAG,GAAG,GAAV,CAAZ;AACD;;;4BA7CqB;AACpB,iBAAO,wBAAAyZ,cAAA,CAAeC,UAAf,CAA0BsoB,WAA1B,CAAP;AACD;AAED;;;;4BACkB;AAAA;;AAChB,cAAMhY,OAAO,GAAG,wBAAAvQ,cAAA,CAAeC,UAAf,CAA0B,qBAAA2oB,YAA1B,CAAhB;;AACA,cAAI,CAACrY,OAAL,EAAc;AACZ,mBAAO,KAAKvC,KAAL,CAAWnvB,IAAlB;AACD;;AACD,cAAMqqC,GAAG,GAAG3Y,OAAO,CAAC3Y,SAAR,CAAkBtR,IAAlB,CAAuB,UAAC4iC,GAAD;AAAA,mBAASA,GAAG,CAACn0B,EAAJ,KAAW,OAAI,CAACiZ,KAAL,CAAWmb,WAA/B;AAAA,WAAvB,CAAZ;AACA,iBAAOD,GAAG,aAAMA,GAAG,CAACrqC,IAAV,eAAmB,KAAKmvB,KAAL,CAAWnvB,IAA9B,IAAuC,KAAKmvB,KAAL,CAAWnvB,IAA5D;AACD;AAED;;;;4BAC8B;AAC5B,cAAM0xB,OAAO,GAAG,wBAAAvQ,cAAA,CAAeC,UAAf,CAA0B,qBAAA2oB,YAA1B,CAAhB;AACA,iBAAOrY,OAAO,IAAIA,OAAO,CAACpK,QAAR,CAAiBpR,EAAjB,KAAwB,KAAKiZ,KAAL,CAAWmb,WAArD;AACD;;;;;;AAvCH;;;;;;;;;;;;;;;;;;;;ACTA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;QAKaC,e;;;;;AACT,+BAAsBrvB,SAAtB,EACYoG,eADZ,EAC8C;AAAA;;AAAA;;AAC1C,sCAAMpG,SAAN,EAAiBoG,eAAjB;AAFkB,gBAAApG,SAAA,GAAAA,SAAA;AAGlB,gCAAAiG,cAAA,CAAesiB,UAAf,CAA0B,iBAAAiG,WAA1B;AACA,gBAAK/nB,KAAL,GAAa,UAAb;AACA,gBAAKC,UAAL,GAAkB,QAAlB;AAJ0C;AAK7C;;;;8BAEiB;AACd,gBAAM,IAAIvhB,KAAJ,CAAU,yCAAV,CAAN;AACH;;;iCAEoB;AACjB,gBAAM,IAAIA,KAAJ,CAAU,yCAAV,CAAN;AACH;;;kCAEoB;AACjB,gBAAM,IAAIA,KAAJ,CAAU,yCAAV,CAAN;AACH;;;gCAEcsM,I,EAAe;AAC1B,iBAAO,IAAI,iBAAA+8B,WAAJ,CAAgB/8B,IAAhB,CAAP;AACH;;;;MAvBgC,eAAA0U,c;;AAHrC;;;uBAGakpB,e,EAAe,+B,EAAA,+B;AAAA,K;;;aAAfA,e;AAAe,eAAfA,eAAe,K;AAAA,kBAFZ;;;;;2BAEHA,e,EAAe;cAH3B,OAAAzzB,UAG2B;eAHhB;AACR6I,oBAAU,EAAE;AADJ,S;AAGgB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZ5B;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAEA;AAAA;AAAA;;QAmDa6qB,Q;;;;;AA2DT,wBAAY3qB,QAAZ,EAA+B;AAAA;;AAAA;;AAC3B,sCAAMA,QAAN;AACA,YAAMzC,QAAQ,GAAGyC,QAAQ,CAACzC,QAAT,IAAqB,EAAtC;AACA,YAAMqtB,SAAS,GAAGrtB,QAAQ,CAACstB,cAAT,IAA2B,EAA7C;AACA,gBAAKxqB,OAAL,GAAeL,QAAQ,CAACK,OAAT,IAAoBL,QAAQ,CAACzR,IAA5C;AACA,gBAAKu8B,MAAL,GAAc,CAAC9qB,QAAQ,CAAC8qB,MAAT,IAAmBF,SAAS,CAACE,MAA7B,IAAuC,EAAxC,EAA4C7gC,GAA5C,CAAgD,UAAAxH,CAAC;AAAA,iBAAK;AAChE4T,cAAE,EAAE5T,CAAC,CAACsoC,QAAF,IAActoC,CAAC,CAAC4T,EAD4C;AAEhElW,gBAAI,EAAEsC,CAAC,CAACuoC,UAAF,IAAgBvoC,CAAC,CAACtC;AAFwC,WAAL;AAAA,SAAjD,CAAd;AAIA,gBAAK8qC,UAAL,GAAkB,CAACjrB,QAAQ,CAACirB,UAAT,IAAuBL,SAAS,CAACK,UAAjC,IAA+C,EAAhD,EAAoDhhC,GAApD,CAAwD,UAAAxH,CAAC;AAAA,iBAAK;AAC5E4T,cAAE,EAAE5T,CAAC,CAACsoC,QAAF,IAActoC,CAAC,CAAC4T,EADwD;AAE5ElW,gBAAI,EAAEsC,CAAC,CAACuoC,UAAF,IAAgBvoC,CAAC,CAACtC;AAFoD,WAAL;AAAA,SAAzD,CAAlB;AAIA,gBAAK8Z,MAAL,GAAc,CAAC+F,QAAQ,CAAC/F,MAAT,IAAmB2wB,SAAS,CAAC3wB,MAA7B,IAAuC,EAAxC,EAA4ChQ,GAA5C,CAAgD,UAAAxH,CAAC;AAAA,iBAAI,IAAI,cAAA0nC,aAAJ,CAAkB,MAAD,OAAC,CAAD,kBAC7E1nC,CAD6E,CAAC,EAC7E;AACJgoC,uBAAW,EAAE,QAAKp0B;AADd,WAD6E,CAAlB,CAAJ;AAAA,SAAjD,CAAd;AAIA,gBAAK60B,MAAL,GAAclrB,QAAQ,CAACmrB,KAAT,IAAkBP,SAAS,CAACO,KAA5B,IAAqC,EAAnD;AACA,gBAAKC,QAAL,GAAgBprB,QAAQ,CAACqrB,OAAT,IAAoBrrB,QAAQ,CAACsrB,gBAA7B,IAAiDV,SAAS,CAACU,gBAA3D,IAA+E,EAA/F;AACA,gBAAKC,QAAL,GAAgBvrB,QAAQ,CAACwrB,OAAT,IAAoBZ,SAAS,CAACY,OAA9B,IAAyC,EAAzD;AACA,gBAAKrwB,SAAL,GAAiBoC,QAAjB;AACA,gBAAKkuB,cAAL,GAAsBzrB,QAAQ,CAAC0rB,aAAT,IAA0Bd,SAAS,CAACc,aAApC,IAAqD,EAA3E;AACA,gBAAKC,SAAL,GAAiB3rB,QAAQ,CAACvC,QAAT,IAAqBmtB,SAAS,CAACntB,QAA/B,IAA2C;AAAEmuB,mBAAS,EAAE,IAAb;AAAmBC,kBAAQ,EAAE;AAA7B,SAA5D;AACA,gBAAK5a,cAAL,GAAsBjR,QAAQ,CAACiR,cAAT,IAA2B2Z,SAAS,CAAC3Z,cAArC,IAAuD1T,QAAQ,CAAC0T,cAAhE,IAAkF;AACpG3sB,eAAK,EAAE,CAD6F;AAEpGgtB,aAAG,EAAE;AAF+F,SAAxG;AAIA,YAAMwa,WAAW,GAAG,EAApB;;AACA,YAAI9rB,QAAQ,CAAC+rB,cAAb,EAA6B;AACzB,eAAK,IAAMC,GAAX,IAAkBhsB,QAAQ,CAAC+rB,cAA3B,EAA2C;AACvC,gBAAI/rB,QAAQ,CAAC+rB,cAAT,CAAwBhsC,cAAxB,CAAuCisC,GAAvC,CAAJ,EAAiD;AAC7C,kBAAMC,YAAY,GAAGjsB,QAAQ,CAAC+rB,cAAT,CAAwBC,GAAxB,KAAgC,EAArD;;AACA,mBAAK,IAAMvnB,OAAX,IAAsBwnB,YAAtB,EAAoC;AAChC,oBAAIA,YAAY,CAAClsC,cAAb,CAA4B0kB,OAA5B,CAAJ,EAA0C;AACtCqnB,6BAAW,CAAC7/B,IAAZ,CAAiB;AACboK,sBAAE,EAAE41B,YAAY,CAACxnB,OAAD,CADH;AAEbtkB,wBAAI,EAAEskB,OAFO;AAGbynB,4BAAQ,EAAEF;AAHG,mBAAjB;AAKH;AACJ;AACJ;AACJ;AACJ;;AACD,gBAAKF,WAAL,GAAmBA,WAAnB;AACA,gBAAK3d,IAAL,GAAYnO,QAAQ,CAACmO,IAAT,IAAiByc,SAAS,CAACzc,IAA3B,IAAmC5Q,QAAQ,CAAC4Q,IAA5C,IAAoD,EAAhE;AACA,gBAAKC,OAAL,GAAepO,QAAQ,CAACoO,OAAT,IAAoBwc,SAAS,CAACxc,OAA9B,IAAyC7Q,QAAQ,CAAC6Q,OAAlD,IAA6D,EAA5E;AACA,gBAAK+d,eAAL,GAAuBnsB,QAAQ,CAACmsB,eAAT,IAA4BvB,SAAS,CAACuB,eAAtC,IAAyD5uB,QAAQ,CAAC4uB,eAAlE,IAAqF,EAA5G;AACA,gBAAKtkB,aAAL,GAAqB7H,QAAQ,CAAC6H,aAAT,IAA0B+iB,SAAS,CAAC/iB,aAApC,IAAqDtK,QAAQ,CAACsK,aAA9D,IAA+E,EAApG;AACA,gBAAKukB,wBAAL,GAAgCpsB,QAAQ,CAACosB,wBAAT,IAAqCxB,SAAS,CAACwB,wBAA/C,IAA2E7uB,QAAQ,CAAC6uB,wBAApF,IAAgH,CAAhJ;AACA,gBAAKC,QAAL,GAAgBrsB,QAAQ,CAACqsB,QAAT,IAAqBzB,SAAS,CAACyB,QAA/B,IAA2C9uB,QAAQ,CAAC8uB,QAApD,IAAgE,KAAhF;AACA,gBAAKnN,QAAL,GAAgBlf,QAAQ,CAACkf,QAAT,IAAqB0L,SAAS,CAAC1L,QAA/B,IAA2C3hB,QAAQ,CAAC2hB,QAApD,IAAgE,EAAhF;;AACA,YAAI0L,SAAS,CAAC0B,uBAAd,EAAuC;AACnC,kBAAKpN,QAAL,CAAcqN,cAAd,GAA+B,IAA/B;AACH;;AACD,YAAI3B,SAAS,CAAC4B,2BAAd,EAA2C;AACvC,kBAAKtN,QAAL,CAAcnG,kBAAd,GAAmC,IAAnC;AACH;;AACD,gBAAK/vB,QAAL,GAAgBgX,QAAQ,CAAChX,QAAT,IAAqB4hC,SAAS,CAAC5hC,QAA/B,IAA2CuU,QAAQ,CAACvU,QAApD,IAAgE,EAAhF;AACA,gBAAK2f,YAAL,GAAoB3I,QAAQ,CAAC2I,YAAT,IAAyBiiB,SAAS,CAACjiB,YAAnC,IAAmDpL,QAAQ,CAACoL,YAA5D,IAA4E,KAAhG;AACA,gBAAK8jB,WAAL,GAAmBzsB,QAAQ,CAACysB,WAAT,IAAwB7B,SAAS,CAAC6B,WAAlC,IAAiDlvB,QAAQ,CAACkvB,WAA1D,IAAyE,EAA5F;AACA,gBAAKC,aAAL,GAAqB1sB,QAAQ,CAAC0sB,aAAT,IAA0B9B,SAAS,CAAC8B,aAApC,IAAqDnvB,QAAQ,CAACmvB,aAA9D,IAA+E,EAApG;AACA,gBAAKC,UAAL,GAAkB3sB,QAAQ,CAAC2sB,UAAT,IAAuB/B,SAAS,CAAC+B,UAAjC,IAA+CpvB,QAAQ,CAACovB,UAAxD,IAAsE,EAAxF;AACA,gBAAK9yB,IAAL,GAAYmG,QAAQ,CAACnG,IAAT,IAAiB+wB,SAAS,CAAC/wB,IAA3B,IAAmC,SAA/C;AA/D2B;AAgE9B;AA1HD;;;;;;AA4HA;;;;gCAIe/Z,G,EAAW;AACtB,cAAMkK,IAAI,GAAGlK,GAAG,CAACsG,KAAJ,CAAU,GAAV,CAAb;AACA,cAAMkB,KAAK,GAAG,OAAAyC,eAAA,CAAgBC,IAAhB,EAAsB,KAAKmR,SAA3B,KAAyC,OAAApR,eAAA,EAAiB,gBAAjB,4BAAsCC,IAAtC,IAA6C,KAAKmR,SAAlD,CAAvD;AACA,iBAAO7T,KAAP;AACH;AAED;;;;;;;6BAIYnH,I,EAAY;AACpB,oCAAY,KAAK+qC,MAAL,CAAY/qC,IAAZ,KAAqB,EAAjC;AACH;AAED;;;;;;;AA2BA;;;;yCAIwB+rC,Q,EAAgB;AACpC,iBAAO,CAAC,KAAKJ,WAAL,IAAoB,EAArB,EAAyB9gC,MAAzB,CAAgC,UAAAvI,CAAC;AAAA,mBAAIA,CAAC,CAACypC,QAAF,KAAeA,QAAnB;AAAA,WAAjC,CAAP;AACH;AAED;;;;;;+BAGiB;;;;;;0BACP,IAAI1rC,KAAJ,CAAU,qDAAV,C;;;;;;;;;AACT;AAED;;;;;;kCAGmB;;;;;;0BACT,IAAIA,KAAJ,CAAU,qDAAV,C;;;;;;;;;AACT;;;4BA5LwB;AACrB,iBAAO,wBAAA8gB,cAAA,CAAeC,UAAf,CAA0BopB,QAA1B,CAAP;AACH;;;4BA8IoB;AAAA;;AACjB,iBAAOv5B,MAAM,CAACpH,IAAP,CAAY,KAAKkhC,MAAjB,EAAyBlgC,MAAzB,CAAgC,UAAAvI,CAAC;AAAA,mBAAI,OAAI,CAACyoC,MAAL,CAAYnrC,cAAZ,CAA2B0C,CAA3B,CAAJ;AAAA,WAAjC,CAAP;AACH;AAED;;;;4BACkB;AACd,iBAAO,MAAP,OAAO,CAAP,EAAO,EAAM,KAAK2oC,QAAL,IAAiB,EAAvB,CAAP;AACH;AAED;;;;4BACkB;AACd,iBAAO,MAAP,OAAO,CAAP,EAAO,EAAM,KAAKG,QAAL,IAAiB,EAAvB,CAAP;AACH;AAED;;;;4BACwB;AACpB,iBAAO,MAAP,OAAO,CAAP,EAAO,EAAM,KAAKE,cAAL,IAAuB,EAA7B,CAAP;AACH;AAED;;;;4BACmB;AACf,iBAAO,MAAP,OAAO,CAAP,EAAO,EAAK,KAAKE,SAAV,CAAP;AACH;;;;MAxKyB,iBAAA5rB,a;;AAA9B;;;;;;;;;;;;;;;;;;;;;;;;AC3DA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;ACDA;;QACaoqB,a,GAgBT,yBAAiC;AAAA,UAArByC,KAAqB,uEAAJ,EAAI;;AAAA;;AAC7B,WAAKv2B,EAAL,GAAUu2B,KAAK,CAACv2B,EAAN,IAAYu2B,KAAK,CAACV,QAAlB,IAA8B,EAAxC;AACA,WAAKzB,WAAL,GAAmBmC,KAAK,CAACC,MAAN,IAAgBD,KAAK,CAACnC,WAAtB,IAAqC,EAAxD;AACA,WAAKtqC,IAAL,GAAYysC,KAAK,CAACzsC,IAAN,IAAcysC,KAAK,CAACE,UAApB,IAAkC,EAA9C;AACA,UAAMC,UAAU,GAAG,KAAK5sC,IAAL,CAAU2L,WAAV,EAAnB;AACA,UAAM4jB,GAAG,GAAGqd,UAAU,CAACvlC,OAAX,CAAmB,OAAnB,KAA+B,CAA/B,GAAmCulC,UAAU,CAAC1/B,OAAX,CAAmB,aAAnB,EAAkC,EAAlC,CAAnC,GAA2E0/B,UAAU,CAAC5F,MAAX,CAAkB,CAAlB,EAAqB,CAArB,EAAwB3zB,WAAxB,EAAvF;AACA,WAAKsf,UAAL,GAAkB8Z,KAAK,CAAC9Z,UAAN,IAAoBpD,GAApB,IAA2B,EAA7C;AACA,WAAKsd,OAAL,GAAeJ,KAAK,CAACI,OAAN,IAAiB,EAAhC;AACA,WAAK3jC,IAAL,GAAYujC,KAAK,CAACvjC,IAAN,IAAcujC,KAAK,CAACK,UAApB,IAAkC,KAA9C;AACA,WAAK1vB,QAAL,GAAgBqvB,KAAK,CAACrvB,QAAtB;AACH,K;;AA1BL;;;;;;;;;;;;;;;;;;;;ACHA;AAAA;AAAA;;AACA;AAAA;AAAA;AAKA;;;QAEa2sB,Y;;;;;AAMX,8BAAoC;AAAA;;AAAA,YAAxBlqB,QAAwB,uEAAJ,EAAI;;AAAA;;;;AAClC,sCAAMA,QAAN;AACA,gBAAK7E,SAAL,GAAiB6E,QAAQ,CAACzC,QAAT,IAAqB,EAAtC;AACA,gBAAK2vB,mBAAL,GAA2B,CAAC,aAAAltB,QAAQ,CAACzC,QAAT,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEstB,cAAnB,MAAiC,IAAjC,IAAiC,aAAjC,GAAiC,MAAjC,GAAiC,GAAE3xB,SAAnC,KAAgD,EAAjD,EAAqDjP,GAArD,CACzB,UAACugC,GAAD;AAAA,iBAASA,GAAG,CAACnqB,OAAb;AAAA,SADyB,CAA3B;AAHkC;AAMnC;AAED;;;;;;;;gCAIevgB,G,EAAW;AACxB,cAAMkK,IAAI,GAAGlK,GAAG,CAACsG,KAAJ,CAAU,GAAV,CAAb;AACA,cAAMkB,KAAK,GAAG,OAAAyC,eAAA,CAAgBC,IAAhB,EAAsB,KAAKmR,SAA3B,CAAd;AACA,iBAAO7T,KAAP;AACD;;;;MAtB+B,iBAAAyY,a;;AAAlC;;;;;;;;;;;;;;;;;;;;;;;;ACRA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;QAKaotB,mB;;;;;AAQX,mCACY9xB,SADZ,EAEUiF,QAFV,EAGU8sB,MAHV,EAIE3rB,eAJF,EAIkC;AAAA;;AAAA;;AAEhC,sCAAMpG,SAAN,EAAiBoG,eAAjB;AALU,gBAAApG,SAAA,GAAAA,SAAA;AACF,gBAAAiF,QAAA,GAAAA,QAAA;AACA,gBAAA8sB,MAAA,GAAAA,MAAA;AALF,gBAAAC,kBAAA,GAA0C,IAAI,OAAAntB,OAAJ,EAA1C;AASN,gCAAAoB,cAAA,CAAesiB,UAAf,CAA0B,qBAAAsG,YAA1B;AACA,gCAAA5oB,cAAA,CAAesiB,UAAf,CAA0B,iBAAA+G,QAA1B;AACA,gBAAK7oB,KAAL,GAAa,cAAb;AACA,gBAAKC,UAAL,GAAkB,OAAlB;;AACA,gBAAKhe,GAAL,CAAS,WAAT,EAAsB,EAAtB;;AACA,gBAAKA,GAAL,CAAS,iBAAT,EAA4B,IAA5B;;AACA,gBAAKqpC,MAAL,CAAYzwB,WAAZ,CAAwBzH,IAAxB,CAA6B,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,iBAAOA,CAAP;AAAA,SAAN,CAA7B,EAA8CvZ,SAA9C,CAAwD;AAAA,iBAAM,QAAKua,IAAL,EAAN;AAAA,SAAxD;;AATgC;AAUjC;AAED;;;;;;;4BAGiBoF,S,EAAoBM,Y,EAAsB;;;;;;0BACnD,IAAI9hB,KAAJ,CAAU,kDAAV,C;;;;;;;;;AACP;AAED;;;;;;+BAIE6V,E,EACA2L,S,EACAM,Y,EAAsB;;;;;;0BAEhB,IAAI9hB,KAAJ,CAAU,qDAAV,C;;;;;;;;;AACP;AAED;;;;;;gCAGoB6V,E,EAAU;;;;;;0BACtB,IAAI7V,KAAJ,CAAU,qDAAV,C;;;;;;;;;AACP;AAED;;;;;;;+BAIcqsC,M,EAAc;AAC1B,iBAAO,CAAC,KAAK3zB,SAAL,CAAetR,IAAf,CAAoB,UAACnF,CAAD;AAAA,mBAAOA,CAAC,CAAC4T,EAAF,KAASw2B,MAAhB;AAAA,WAApB,KAAgD,EAAjD,EAAkE5yB,MAAzE;AACD;AAED;;;;;;;gCAIena,G,EAAa;AAC1B,iBAAO,KAAK2nB,QAAL,CAAcjI,OAAd,CAAsB1f,GAAtB,KAA8B,KAAKwtC,aAAL,CAAmB9tB,OAAnB,CAA2B1f,GAA3B,CAArC;AACD;AAED;;;;;AA2BA;;;;kCAIiBuW,E,EAAYw2B,M,EAAiB;AAC5C,cAAMrC,GAAG,GAAG,KAAKtxB,SAAL,CAAetR,IAAf,CAAoB,UAACnF,CAAD;AAAA,mBAAOA,CAAC,CAAC4T,EAAF,KAASw2B,MAAhB;AAAA,WAApB,KAA+C,KAAKplB,QAAhE;;AACA,cAAI+iB,GAAG,IAAIn0B,EAAX,EAAe;AACb,mBAAOm0B,GAAG,CAACM,MAAJ,CAAW9/B,MAAX,CAAkB,UAACvI,CAAD;AAAA,qBAAO,UAAGA,CAAC,CAAC4T,EAAL,EAAU7O,OAAV,CAAkB6O,EAAlB,KAAyB,CAAhC;AAAA,aAAlB,CAAP;AACD;;AACD,iBAAO,EAAP;AACD;AAED;;;;;;;oCAImBk3B,G,EAAsB;AACvC,cAAMjrC,IAAI,GAAGirC,GAAG,YAAYp8B,KAAf,GAAuBo8B,GAAvB,GAA6B,CAACA,GAAD,CAA1C;AACA,cAAMC,QAAQ,GAAG,KAAKt0B,SAAtB;;AAFuC,uDAGtB5W,IAHsB;AAAA;;AAAA;AAGvC,sEAAuB;AAAA,kBAAZ+T,EAAY;;AAAA,2DACHm3B,QADG;AAAA;;AAAA;AACrB,0EAA4B;AAAA,sBAAjBhD,GAAiB;;AAAA,+DACRA,GAAG,CAACvwB,MADI;AAAA;;AAAA;AAC1B,8EAA8B;AAAA,0BAAnB+xB,GAAmB;;AAC5B,0BAAIA,GAAG,CAAC31B,EAAJ,KAAWA,EAAf,EAAmB;AACjB,+BAAO21B,GAAP;AACD;AACF;AALyB;AAAA;AAAA;AAAA;AAAA;AAM3B;AAPoB;AAAA;AAAA;AAAA;AAAA;AAQtB;AAXsC;AAAA;AAAA;AAAA;AAAA;;AAYvC,iBAAO,IAAP;AACD;AAED;;;;;;+BAGoB;;;;;;;AAClB;AACA,wBAAI3tB,YAAJ,EAAkB;AAChB,2BAAKovB,gBAAL,GAAwBpvB,YAAY,CAACC,OAAb,WAAwB,KAAKmD,eAAL,CAAqBrC,QAArB,CAA8B5L,WAA9B,EAAxB,eAAxB;AACD;;AACK6J,2B,GAAmC,KAAKiD,QAAL,CAAcxG,GAAd,CAAkB,SAAlB,KAAgC,E;AACzEuD,2BAAO,CAACqwB,YAAR,GAAuB;AAAE3xB,6BAAO,EAAE,2BAAX;AAAwC5c,2BAAK,EAAE;AAA/C,qBAAvB;;AACA,2BAAM,KAAKwuC,gBAAL,EAAN;;;AACAtwB,2BAAO,CAACqwB,YAAR,GAAuB;AAAE3xB,6BAAO,EAAE,2BAAX;AAAwC5c,2BAAK,EAAE;AAA/C,qBAAvB;AACAke,2BAAO,CAACnE,SAAR,GAAoB;AAAE6C,6BAAO,EAAE,uBAAX;AAAoC5c,2BAAK,EAAE;AAA3C,qBAApB;;AACA,yBAAKmhB,QAAL,CAAcvc,GAAd,CAAkB,SAAlB,EAA6BsZ,OAA7B;;;AACA,2BAAM,KAAKrE,aAAL,EAAN;;;AACAqE,2BAAO,CAACnE,SAAR,GAAoB;AAAE6C,6BAAO,EAAE,uBAAX;AAAoC5c,2BAAK,EAAE;AAA3C,qBAApB;AACAke,2BAAO,CAACpD,MAAR,GAAiB;AAAE8B,6BAAO,EAAE,6BAAX;AAA0C5c,2BAAK,EAAE;AAAjD,qBAAjB;;AACA,yBAAKmhB,QAAL,CAAcvc,GAAd,CAAkB,SAAlB,EAA6BsZ,OAA7B;;;AACA,2BAAM,KAAKuwB,UAAL,EAAN;;;AACAvwB,2BAAO,CAACpD,MAAR,GAAiB;AAAE8B,6BAAO,EAAE,6BAAX;AAA0C5c,2BAAK,EAAE;AAAjD,qBAAjB;;AACA,yBAAKmhB,QAAL,CAAcvc,GAAd,CAAkB,SAAlB,EAA6BsZ,OAA7B;;AACAA,2BAAO,CAACwwB,WAAR,GAAsB;AAAE9xB,6BAAO,EAAE,yBAAX;AAAsC5c,2BAAK,EAAE;AAA7C,qBAAtB;;AACA,yBAAKmhB,QAAL,CAAcvc,GAAd,CAAkB,SAAlB,EAA6BsZ,OAA7B;;;AACA,2BAAM,KAAKywB,cAAL,EAAN;;;AACAzwB,2BAAO,CAACwwB,WAAR,GAAsB;AAAE9xB,6BAAO,EAAE,yBAAX;AAAsC5c,2BAAK,EAAE;AAA7C,qBAAtB;;AACA,yBAAKmhB,QAAL,CAAcvc,GAAd,CAAkB,SAAlB,EAA6BsZ,OAA7B;;AACML,wB,GAAO,KAAKowB,MAAL,CAAYtO,O;;AAEzB,wBAAI9hB,IAAJ,EAAU;AACF3G,wBADE,GACGgI,YAAY,CAACC,OAAb,CAAqB,kBAArB,CADH;AAEFmJ,8BAFE,GAES,KAAKvO,SAAL,CAAetR,IAAf,CAAoB,UAAA4iC,GAAG;AAAA,+BAAIn0B,EAAE,IAAIm0B,GAAG,CAACn0B,EAAJ,KAAWA,EAArB;AAAA,uBAAvB,KAAmD,KAAK6C,SAAL,CAAetR,IAAf,CAAoB,UAAC4iC,GAAD;AAAA,+BAASA,GAAG,CAACrc,IAAJ,KAAanR,IAAI,CAACS,QAA3B;AAAA,uBAApB,CAF5D;;AAGR,0BAAIgK,QAAJ,EAAc;AACZ,6BAAKgmB,gBAAL,GAAwBhmB,QAAQ,CAACpR,EAAjC;AACA,6BAAKtS,GAAL,CAAS,iBAAT,EAA4B0jB,QAA5B;AACD,uBAHD,MAGO,IAAG,KAAKA,QAAR,EAAkB;AACvB;AACA,6BAAKgmB,gBAAL,GAAwB,KAAKhmB,QAAL,CAAcpR,EAAtC;AACA,6BAAKtS,GAAL,CAAS,iBAAT,EAA4B,KAAK0jB,QAAjC;AACD;AACF;;;;;;;;;AACF;AAED;;;;;;2CAG6B;;;;;;;;AACV,2BAAM,KAAKjQ,KAAL,CAAW;AAAEu2B,0BAAI,EAAE,KAAR;AAAe5rB,4BAAM,EAAE;AAAvB,qBAAX,CAAN;;;AAAX6rB,4B;AACN,yBAAKV,aAAL,GAAqB,IAAI,qBAAApD,YAAJ,CAAiB8D,QAAQ,CAAC,CAAD,CAAzB,CAArB;AACA,yBAAKjqC,GAAL,CAAS,cAAT,EAAyB,KAAKupC,aAA9B;sDACO,KAAKA,a;;;;;;;;;AACb;AAED;;;;;;wCAG0B;;;;;;sDACjB,KAAKjzB,oBAAL,CAA0B,KAAKizB,aAA/B,C;;;;;;;;;AACR;AAED;;;;;;6CAGkCI,Y,EAA0B;;;;;;;;AACzC,2BAAM,KAAKl2B,KAAL,CAAW;AAAEu2B,0BAAI,EAAE,UAAR;AAAoB5rB,4BAAM,EAAE,IAA5B;AAAkCzM,2BAAK,EAAE;AAAzC,qBAAX,CAAN;;;AAAXu4B,4B;AACA/0B,6B,GAAa+0B,QAAsB,CACtChkC,GADgB,CACZ,UAACxH,CAAD;AAAA,6BAAO,IAAI,iBAAAkoC,QAAJ,CAAaloC,CAAb,CAAP;AAAA,qBADY,EAEhBuI,MAFgB,CAET,UAACw/B,GAAD;AAAA,6BAASkD,YAAY,CAACR,mBAAb,CAAiChvB,QAAjC,CAA0CssB,GAAG,CAACn0B,EAA9C,CAAT;AAAA,qBAFS,C;AAGnB,yBAAKtS,GAAL,CAAS,WAAT,EAAsBmV,SAAtB;AACA;;AACA,wBAAI,CAAC,KAAKu0B,gBAAN,IAA0Bv0B,SAA1B,IAAuCA,SAAS,CAAC5S,MAAV,GAAmB,CAA9D,EAAiE;AAC/D,2BAAKmnC,gBAAL,GAAwBv0B,SAAS,CAAC,CAAD,CAAT,CAAa7C,EAArC;AACD;;uDACM6C,S;;;;;;;;;AACR;AAED;;;;;;qCAGuB;;;;;;;;AACJ,2BAAM,KAAK1B,KAAL,CAAW;AAAEu2B,0BAAI,EAAE,OAAR;AAAiB5rB,4BAAM,EAAE,IAAzB;AAA+BzM,2BAAK,EAAE;AAAtC,qBAAX,CAAN;;;AAAXw4B,4B;AACAj0B,0B,GAAUi0B,QAAsB,CAACjkC,GAAvB,CAA2B,UAACxH,CAAD;AAAA,6BAAO,IAAI,cAAA0nC,aAAJ,CAAkB1nC,CAAlB,CAAP;AAAA,qBAA3B,C;AAChB,yBAAKsB,GAAL,CAAS,QAAT,EAAmBkW,MAAnB;uDACOA,M;;;;;;;;;AACR;AAED;;;;;;yCAG2B;;;;;;;;AACP,2BAAM,KAAKzC,KAAL,CAAW;AAAEu2B,0BAAI,EAAE,MAAR;AAAgB5rB,4BAAM,EAAE,IAAxB;AAA8BzM,2BAAK,EAAE,IAArC;AAA2C+0B,iCAAW,EAAE,KAAKgD;AAA7D,qBAAX,CAAN;;;AAAZU,6B;AACAC,yB,GAASD,SAAuB,CAAClkC,GAAxB,CAA4B,UAACxH,CAAD;AAAA,6BAAQ;AAAE4T,0BAAE,EAAE5T,CAAC,CAAC4T,EAAR;AAAYlW,4BAAI,EAAEsC,CAAC,CAACtC;AAApB,uBAAR;AAAA,qBAA5B,C;AACf,yBAAK4D,GAAL,CAAS,aAAT,EAAwBqqC,KAAxB,E,CACA;;AACA,yBAAKf,kBAAL,CAAwB96B,IAAxB,CAA6B67B,KAA7B;;;;;;;;;AACD;AAEC;;;;;;yDAOsCtuC,G,EAAa;AACnD,cAAI,CAAC,KAAKwtC,aAAV,EAAyB;AACvB,mBAAO,EAAP;AACD;;AACD,cAAMzC,cAAc,GAAG,KAAKyC,aAAL,CAAmB9tB,OAAnB,CAA2B,gBAA3B,CAAvB;;AAEA,iBAAOqrB,cAAc,IAAIA,cAAc,CAAC/qC,GAAD,CAAhC,GAAwC+qC,cAAc,CAAC/qC,GAAD,CAAtD,GAA8D,EAArE;AACD;;;mDAEiCuJ,I,EAAa;AAC7C,cAAMwC,OAAO,GAAG,KAAKwiC,gCAAL,CAAsChlC,IAAtC,KAA+C,EAA/D;AACA,oCAAW+H,MAAM,CAACpH,IAAP,CAAY6B,OAAZ,EAAqB5B,GAArB,CAAyB,UAACnK,GAAD,EAAS;AACzC,gBAAMuQ,OAAO,GAAGxE,OAAO,CAAC/L,GAAD,CAAP,CAAa+K,QAAb,EAAhB;AACA,mBAAO;AACHwF,qBAAO,EAAPA,OADG;AAEH/I,mBAAK,EAAExH,GAFJ;AAGHqpB,kBAAI,EAAE;AAHH,aAAP;AAKH,WAPU,CAAX;AAQD;;;4BAnLkB;AAAA;;AACjB,iBAAO,KAAKjQ,SAAL,CAAetR,IAAf,CAAoB,UAACnF,CAAD;AAAA,mBAAOA,CAAC,CAAC4T,EAAF,KAAS,OAAI,CAACo3B,gBAArB;AAAA,WAApB,CAAP;AACD;AAED;;0BAKoBjD,G,EAAe;AACjC,cAAIA,GAAG,YAAY,iBAAAG,QAAnB,EAA6B;AAC3B,iBAAK8C,gBAAL,GAAwBjD,GAAG,CAACn0B,EAA5B;AACD,WAFD,MAEO;AACL,iBAAKo3B,gBAAL,GAAwBjD,GAAxB;AACD;;AACD,eAAKzmC,GAAL,CAAS,iBAAT,EAA4B,KAAK0jB,QAAjC;AACA,eAAKqmB,cAAL;AACAzvB,sBAAY,CAACiwB,OAAb,CAAqB,kBAArB,EAAyC,KAAKb,gBAA9C;AACApvB,sBAAY,CAACiwB,OAAb,CAAqB,oBAArB,EAA2C9D,GAAG,CAACxhC,QAA/C;AACD;AAED;;;;4BAhBsB;AACpB,iBAAO,KAAK8Q,GAAL,CAAS,aAAT,KAA2B,EAAlC;AACD;;;4BAemB;AAClB,iBAAO,KAAKA,GAAL,CAAqB,WAArB,KAAqC,EAA5C;AACD;;;4BAoIgC;AAC7B,iBAAO,KAAKuzB,kBAAL,CAAwB3wB,YAAxB,EAAP;AACD;;;;MAhOoC,eAAA8E,c;;AAHzC;;;uBAGa2rB,mB,EAAmB,+B,EAAA,kC,EAAA,4B,EAAA,+B;AAAA,K;;;aAAnBA,mB;AAAmB,eAAnBA,mBAAmB,K;AAAA,kBAFlB;;;;;2BAEDA,mB,EAAmB;cAH/B,OAAAl2B,UAG+B;eAHpB;AACV6I,oBAAU,EAAE;AADF,S;AAGoB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtBhC;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;QAOa2kB,mB;;;;;AA0BX,mCAAsBppB,SAAtB,EACsBoG,eADtB,EACwD;AAAA;;AAAA;;AACtD;AAFoB,gBAAApG,SAAA,GAAAA,SAAA;AACA,gBAAAoG,eAAA,GAAAA,eAAA;AApBtB;;AACU,gBAAAjG,SAAA,GAAoE,EAApE;AACV;;AACU,gBAAAC,UAAA,GAAiD,EAAjD;AACV;;AACU,gBAAAiG,YAAA,GAAmD,EAAnD;AACV;;AACU,gBAAAC,SAAA,GAA6C,EAA7C;AACV;;AACU,gBAAAC,QAAA,GAAoC,UAACrV,CAAD,EAAIC,CAAJ;AAAA,iBAC5CD,CAAC,KAAKC,CAAN,IAAYD,CAAS,CAAC8J,EAAV,KAAkB7J,CAAS,CAAC6J,EADI;AAAA,SAApC;AAEV;;;AACU,gBAAAwL,YAAA,GAAkC,UAACtV,CAAD;AAAA,iBAAO,CAAC,CAACA,CAAT;AAAA,SAAlC;;AAUR,gBAAKuV,KAAL,GAAa,MAAb;AACA,gBAAKC,UAAL,GAAkB,MAAlB;;AACA,gBAAKhe,GAAL,CAAS,MAAT,EAAiB,EAAjB;;AAJsD;AAKvD;AAXD;;;;;;AAaA;;;wCAGwBie,S,EAAoB;AACxC;AACA;AACA,cAAI,KAAKP,eAAL,CAAqBQ,SAAzB,EAAoC;AAChC,mBAAO,MAAP,OAAO,CAAP,kBAAYD,SAAZ,CAAO,EAAc;AAAEC,uBAAS,EAAE;AAAb,aAAd,CAAP;AACH;;AACD,iBAAOD,SAAP;AACH;AAED;;;;;;+BAGc;AAAA;;AACZ,eAAK9C,IAAL,GAAY4B,IAAZ,CACE,UAAClF,CAAD;AAAA,mBAAO,OAAI,CAAChc,YAAL,CAAkB2S,IAAlB,CAAuB,IAAvB,CAAP;AAAA,WADF,EAEE,UAAC2P,GAAD;AAAA,mBAAS,OAAI,CAACnf,OAAL,CAAa,MAAb,EAAqB;AAAA,qBAAM,OAAI,CAAC6Z,IAAL,EAAN;AAAA,aAArB,EAAwC,IAAxC,CAAT;AAAA,WAFF;AAID;AAED;;;;;;;gCAIsC;AAAA,cAAzBuF,MAAyB,uEAAP,KAAO;AACpC,cAAMC,QAAQ,GAAGD,MAAM,GACnB,KAAK9G,SAAL,CAAesE,IAAf,CAAoBC,YADD,GAEnB,YAFJ;AAGA,2BAAUwC,QAAV,cAAsB,KAAKL,UAA3B;AACD;AAED;;;;;AAKA;;;;4BAIoB5hB,I,EAAY;AAC9B,cAAI,CAAC,KAAKsb,UAAL,CAAgBtb,IAAhB,CAAL,EAA4B;AAC1B,iBAAK4D,GAAL,CAAY5D,IAAZ,EAAkB,IAAlB;AACD;;AACD,iBAAQ,KAAKqb,SAAL,CAAerb,IAAf,EAA4CS,QAA5C,EAAR;AACD;AAED;;;;;;;;+BAKuBT,I,EAAY;AACjC,cAAI,CAAC,KAAKsb,UAAL,CAAgBtb,IAAhB,CAAL,EAA4B;AAC1B,iBAAK4D,GAAL,CAAY5D,IAAZ,EAAkB,IAAlB;AACD;;AACD,iBAAO,KAAKsb,UAAL,CAAgBtb,IAAhB,CAAP;AACD;AAED;;;;;;;;4BAKuBA,I,EAAcmH,K,EAAQ;AAC3C,cAAI,CAAC,KAAKkU,SAAL,CAAerb,IAAf,CAAL,EAA2B;AACzB,iBAAKqb,SAAL,CAAerb,IAAf,IAAuB,IAAI,OAAAN,eAAJ,CAAuByH,KAAvB,CAAvB;AACA,iBAAKmU,UAAL,CAAgBtb,IAAhB,IAAwB,KAAKqb,SAAL,CAAerb,IAAf,EAAqBuc,YAArB,EAAxB;AACD,WAHD,MAGO;AACL,iBAAKlB,SAAL,CAAerb,IAAf,EAAqBoS,IAArB,CAA0BjL,KAA1B;AACD;AACF;AAED;;;;;;;iCAI8D;AAAA,cAAhD+a,SAAgD,uEAAjB,KAAKR,YAAY;AACxD,cAAMvf,IAAI,GAAQ,KAAKwX,GAAL,CAAS,MAAT,CAAlB;AACA,iBAAOxX,IAAI,CAAC0I,MAAL,CAAYqX,SAAZ,CAAP;AACL;AAED;;;;;;;6BAIYhM,E,EAAU;AACpB,cAAM/T,IAAI,GAAG,KAAKwX,GAAL,CAAS,MAAT,CAAb;AACA,iBAAOxX,IAAI,CAACsF,IAAL,CAAU,UAACnF,CAAD,EAAO;AAAD;;AAAC,mBAAAA,CAAC,CAAC4T,EAAF,KAASA,EAAT,IAAgB,OAAA5T,CAAC,CAAC+S,KAAF,MAAO,IAAP,IAAO,aAAP,GAAO,MAAP,GAAO,GAAE1J,WAAF,EAAP,OAA2BuK,EAAE,SAAF,IAAAA,EAAE,WAAF,GAAE,MAAF,GAAAA,EAAE,CAAEvK,WAAJ,EAA3B,CAAhB;AAA6D,WAA9E,CAAP;AACD;AAED;;;;;;;gCAIsE;AAAA;;AAAA,cAAzDwW,YAAyD,uEAAjC,EAAiC;AAAA,cAA7B/D,MAA6B,uEAAF,EAAE;AACpE,cAAI4D,MAAM,GAAG,KAAb;AACA,cAAII,KAAK,GAAG,IAAZ;AACA;;AACA,cAAID,YAAJ,EAAkB;AAChBH,kBAAM,GAAG,CAAC,CAACG,YAAY,CAACH,MAAxB;AACA,mBAAOG,YAAY,CAACH,MAApB;AACAI,iBAAK,GAAGD,YAAY,CAACC,KAAb,IAAsB,IAA9B;AACA,mBAAOD,YAAY,CAACC,KAApB;AACD;;AACD,cAAM/K,KAAK,GAAG,gBAAAoD,aAAA,CAAc0H,YAAd,CAAd;AACA,cAAMxiB,GAAG,mBAAY0X,KAAZ,CAAT;;AACA,cAAI,CAAC,KAAKmK,SAAL,CAAe7hB,GAAf,CAAL,EAA0B;AACxB,iBAAK6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAAI2gB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACrD,kBAAM7C,GAAG,GAAGS,MAAM,IAAIA,MAAM,CAACT,GAAjB,aAA0BS,MAAM,CAACT,GAAjC,SAAuCtG,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAA7D,cAAuE,OAAI,CAACyG,KAAL,CAAWkE,MAAX,CAAvE,SAA4F3K,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAAlH,CAAZ;AACA,kBAAIgL,MAAJ;;AACA,qBAAI,CAACC,IAAL,CAAU3I,GAAV,CAAcgE,GAAd,EAAmBzb,SAAnB,CACE,UAACkD,CAAD,EAAoC;AAClC,oBAAIA,CAAC,IAAIA,CAAC,YAAY4L,KAAtB,EAA6B;AAC3B,sBAAMvF,OAAO,GAAGrG,CAAC,CAAC0E,GAAF,CAAM,UAACxH,CAAD;AAAA,2BAAO,OAAI,CAACigB,OAAL,CAAajgB,CAAb,CAAP;AAAA,mBAAN,CAAhB;AACA+f,wBAAM,GAAG;AACP5W,2BAAO,EAAPA,OADO;AAEPo8B,yBAAK,EAAEp8B,OAAO,CAACtF;AAFR,mBAAT;AAID,iBAND,MAMO,IAAIf,CAAC,IAAI,EAAEA,CAAC,YAAY4L,KAAf,CAAL,IAA8B5L,CAAC,CAACqG,OAAhC,IAA2CrG,CAAC,CAACyiC,KAAjD,EAAwD;AAC7D,sBAAMp8B,QAAO,GAAGrG,CAAC,CAACqG,OAAF,CAAU3B,GAAV,CAAc,UAACxH,CAAD;AAAA,2BAAO,OAAI,CAACigB,OAAL,CAAajgB,CAAb,CAAP;AAAA,mBAAd,CAAhB;;AACA+f,wBAAM,GAAG;AACP5W,2BAAO,EAAPA,QADO;AAEPo8B,yBAAK,EAAEziC,CAAC,CAACyiC;AAFF,mBAAT;AAID,iBANM,MAMA,IAAIziC,CAAC,IAAI,EAAEA,CAAC,YAAY4L,KAAf,CAAL,IAA8B5L,CAAC,CAACqG,OAApC,EAA6C;AAClD,sBAAMA,SAAO,GAAGrG,CAAC,CAACqG,OAAF,CAAU3B,GAAV,CAAc,UAACxH,CAAD;AAAA,2BAAO,OAAI,CAACigB,OAAL,CAAajgB,CAAb,CAAP;AAAA,mBAAd,CAAhB;;AACA+f,wBAAM,GAAG;AACP5W,2BAAO,EAAPA,SADO;AAEPo8B,yBAAK,EAAEp8B,SAAO,CAACtF;AAFR,mBAAT;AAID,iBANM,MAMA;AACLkc,wBAAM,GAAG;AACP5W,2BAAO,EAAE,EADF;AAEPo8B,yBAAK,EAAE;AAFA,mBAAT;AAID;AACF,eA1BH,EA2BE,UAACv5B,CAAD,EAAO;AACLkS,sBAAM,CAAClS,CAAD,CAAN;AACA,uBAAI,CAACkT,SAAL,CAAe7hB,GAAf,IAAsB,IAAtB;AACD,eA9BH,EA+BE,YAAM;AACJ4gB,uBAAO,CAAC8B,MAAD,CAAP;;AACA,uBAAI,CAACzf,OAAL,CAAajD,GAAb,EAAkB;AAAA,yBAAO,OAAI,CAAC6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAA7B;AAAA,iBAAlB,EAAsDyiB,KAAtD;AACD,eAlCH;AAoCD,aAvCqB,CAAtB;AAwCD;;AACD,iBAAO,KAAKZ,SAAL,CAAe7hB,GAAf,CAAP;AACD;AAED;;;;;;;;;0CAMyE;AAAA;;AAAA,cAAzDwiB,YAAyD,uEAAjC,EAAiC;AAAA,cAA7B/D,MAA6B,uEAAF,EAAE;AACvE,cAAM/G,KAAK,GAAG,gBAAAoD,aAAA,CAAc0H,YAAd,CAAd;AACA,cAAMxE,GAAG,aAAOS,MAAM,CAACT,GAAd,SAAoBtG,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAA1C,CAAT;AACA,iBAAO,KAAKiL,IAAL,CAAU3I,GAAV,CAAcgE,GAAd,EAAmB5I,IAAnB,CACL,YAAAjL,GAAA,CAAI,UAAC1E,CAAD;AAAA,mBAAqC,OAAI,CAACod,gBAAL,CAAsBpd,CAAtB,CAArC;AAAA,WAAJ,CADK,EAEL,YAAAqd,UAAA,CAAW,UAAIC,KAAJ,EAAgBL,MAAhB,EAA+B;AACxC1Y,mBAAO,CAACV,GAAR,CAAYyZ,KAAZ;AACA,mBAAO,OAAAC,EAAA,CAAGN,MAAH,CAAP;AACC,WAHH,CAFK,CAAP;AAOD;AAED;;;;;;;;yCAKiBjd,C,EAA8B;AAAA;;AAC7C,cAAIid,MAAJ;;AACA,cAAIjd,CAAC,IAAIA,CAAC,YAAY4L,KAAtB,EAA6B;AAC3B,gBAAMvF,OAAO,GAAGrG,CAAC,CAAC0E,GAAF,CAAM,UAACxH,CAAD;AAAA,qBAAO,OAAI,CAACigB,OAAL,CAAajgB,CAAb,CAAP;AAAA,aAAN,CAAhB;AACA+f,kBAAM,GAAG;AACP5W,qBAAO,EAAPA,OADO;AAEPo8B,mBAAK,EAAEp8B,OAAO,CAACtF;AAFR,aAAT;AAID,WAND,MAMO,IAAIf,CAAC,IAAI,EAAEA,CAAC,YAAY4L,KAAf,CAAL,IAA8B5L,CAAC,CAACqG,OAAhC,IAA2CrG,CAAC,CAACyiC,KAAjD,EAAwD;AAC7D,gBAAMp8B,SAAO,GAAGrG,CAAC,CAACqG,OAAF,CAAU3B,GAAV,CAAc,UAACxH,CAAD;AAAA,qBAAO,OAAI,CAACigB,OAAL,CAAajgB,CAAb,CAAP;AAAA,aAAd,CAAhB;;AACA+f,kBAAM,GAAG;AACP5W,qBAAO,EAAPA,SADO;AAEPo8B,mBAAK,EAAEziC,CAAC,CAACyiC;AAFF,aAAT;AAID,WANM,MAMA,IAAIziC,CAAC,IAAI,EAAEA,CAAC,YAAY4L,KAAf,CAAL,IAA8B5L,CAAC,CAACqG,OAApC,EAA6C;AAClD,gBAAMA,SAAO,GAAGrG,CAAC,CAACqG,OAAF,CAAU3B,GAAV,CAAc,UAACxH,CAAD;AAAA,qBAAO,OAAI,CAACigB,OAAL,CAAajgB,CAAb,CAAP;AAAA,aAAd,CAAhB;;AACA+f,kBAAM,GAAG;AACP5W,qBAAO,EAAPA,SADO;AAEPo8B,mBAAK,EAAEp8B,SAAO,CAACtF;AAFR,aAAT;AAID,WANM,MAMA;AACLkc,kBAAM,GAAG;AACP5W,qBAAO,EAAE,EADF;AAEPo8B,mBAAK,EAAE;AAFA,aAAT;AAID;;AACD,iBAAOxlB,MAAP;AACD;AAGD;;;;;;;;6BAKYnM,E,EAAsC;AAAA;;AAAA,cAA1BiM,YAA0B,uEAAF,EAAE;AAChD,cAAIH,MAAM,GAAG,KAAb;AACA;;AACA,cAAIG,YAAJ,EAAkB;AAChBH,kBAAM,GAAG,CAAC,CAACG,YAAY,CAACH,MAAxB;AACA,mBAAOG,YAAY,CAACH,MAApB;AACD;;AACD,cAAM3K,KAAK,GAAG,gBAAAoD,aAAA,CAAc0H,YAAd,CAAd;AACA,cAAMxiB,GAAG,kBAAWuW,EAAX,cAAiBmB,KAAjB,CAAT;AACA;;AACA,cAAI,CAAC,KAAKmK,SAAL,CAAe7hB,GAAf,CAAL,EAA0B;AACxB,iBAAK6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAAI2gB,OAAJ,CAAe,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACxD,kBAAM7C,GAAG,aAAM,OAAI,CAACG,KAAL,CAAWkE,MAAX,CAAN,cAA4B9L,EAA5B,SAAiCmB,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAAvD,CAAT;AACA,kBAAIgL,MAAM,GAAM,IAAhB;;AACA,qBAAI,CAACC,IAAL,CAAU3I,GAAV,CAAcgE,GAAd,EAAmBzb,SAAnB,CACE,UAACkD,CAAD,EAAO;AACLid,sBAAM,GAAG,OAAI,CAACE,OAAL,CAAand,CAAb,CAAT;AACD,eAHH,EAIE,UAACkJ,CAAD,EAAO;AACLkS,sBAAM,CAAClS,CAAD,CAAN;AACA,uBAAI,CAACkT,SAAL,CAAeoB,QAAf,GAA0B,IAA1B;AACD,eAPH,EAQE,YAAM;AACJrC,uBAAO,CAAC8B,MAAD,CAAP;;AACA,uBAAI,CAACzf,OAAL,CAAajD,GAAb,EAAkB;AAAA,yBAAO,OAAI,CAAC6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAA7B;AAAA,iBAAlB,EAAsD,IAAtD;AACD,eAXH;AAaD,aAhBqB,CAAtB;AAiBD;;AACD,iBAAO,KAAK6hB,SAAL,CAAe7hB,GAAf,CAAP;AACD;AAED;;;;;;;;4BAKWkiB,S,EAA8C;AAAA;;AAAA,cAA1BM,YAA0B,uEAAF,EAAE;;AACvD;AACA,cAAI,CAAC,KAAKX,SAAL,CAAeoB,QAApB,EAA8B;AAC5B,iBAAKpB,SAAL,CAAeoB,QAAf,GAA0B,IAAItC,OAAJ,CAAe,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC5D,kBAAMnJ,KAAK,GAAG,gBAAAoD,aAAA,CAAc0H,YAAd,CAAd;AACA,kBAAMxE,GAAG,aAAM,OAAI,CAACG,KAAL,CAAWqE,YAAY,CAACH,MAAxB,CAAN,SAAwC3K,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAA9D,CAAT;AACA,kBAAIgL,MAAM,GAAM,IAAhB;;AACA,qBAAI,CAACC,IAAL,CAAUO,IAAV,CAAelF,GAAf,EAAoB,OAAI,CAACmF,eAAL,CAAqBjB,SAArB,CAApB,EAAqD3f,SAArD,CACE,UAACkD,CAAD;AAAA,uBAAQid,MAAM,GAAG,OAAI,CAACE,OAAL,CAAand,CAAb,CAAjB;AAAA,eADF,EAEE,UAACkJ,CAAD,EAAO;AACLkS,sBAAM,CAAClS,CAAD,CAAN;;AACA,uBAAI,CAACyU,cAAL,kBAA8B,OAAI,CAACpB,KAAL,CAAWhW,WAAX,EAA9B;;AACA,uBAAI,CAAC6V,SAAL,CAAeoB,QAAf,GAA0B,IAA1B;AACD,eANH,EAOE,YAAM;AACJrC,uBAAO,CAAC8B,MAAD,CAAP;;AACA,uBAAI,CAACze,GAAL,CAAS,MAAT,EAAiB,OAAI,CAACof,UAAL,CAAgB,OAAI,CAACrJ,GAAL,CAAS,MAAT,CAAhB,EAAkC,CAAC0I,MAAD,CAAlC,CAAjB;;AACA,uBAAI,CAACU,cAAL,kBAA8B,OAAI,CAACpB,KAAL,CAAWhW,WAAX,EAA9B;;AACA,uBAAI,CAAC6V,SAAL,CAAeoB,QAAf,GAA0B,IAA1B;AACD,eAZH;AAcD,aAlByB,CAA1B;AAmBD;;AACD,iBAAO,KAAKpB,SAAL,CAAeoB,QAAtB;AACD;AAED;;;;;;;;;;6BAQE1M,E,EACA2K,S,EAE+B;AAAA;;AAAA,cAD/BgB,SAC+B,uEADV,EACU;AAAA,cAA/BoB,MAA+B,uEAAN,MAAM;AAE/B,cAAM5L,KAAK,GAAG,gBAAAoD,aAAA,CAAc,KAAKqI,eAAL,CAAqBjB,SAArB,CAAd,CAAd;AACA,cAAMliB,GAAG,kBAAWuW,EAAX,cAAiB2K,SAAjB,cAA8BxJ,KAA9B,CAAT;AACA;;AACA,cAAI,CAAC,KAAKmK,SAAL,CAAe7hB,GAAf,CAAL,EAA0B;AACxB,iBAAK6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAAI2gB,OAAJ,CAAe,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACxD,kBAAM0C,SAAS,GAAG,MAAH,OAAG,CAAH,kBAAQrB,SAAR,CAAG,EAAc;AAAE3L,kBAAE,EAAFA,EAAF;AAAMiN,qBAAK,EAAEtC;AAAb,eAAd,CAAlB;AACA,kBAAMlD,GAAG,aAAM,OAAI,CAACG,KAAL,CAAW,KAAX,CAAN,cAA2B5H,EAA3B,cAAiC2K,SAAjC,CAAT;AACA,kBAAIwB,MAAJ;AACA,kBAAMhM,OAAO,GACX4M,MAAM,KAAK,MAAX,GACI,OAAI,CAACX,IAAL,CAAUO,IAAV,CAAelF,GAAf,EAAoBuF,SAApB,CADJ,GAEI,OAAI,CAACZ,IAAL,CAAU3I,GAAV,WAAiBgE,GAAjB,SAAuBtG,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAA7C,EAHN;AAIAhB,qBAAO,CAACnU,SAAR,CACE,UAACkD,CAAD;AAAA,uBAAQid,MAAM,GAAGjd,CAAjB;AAAA,eADF,EAEE,UAACkJ,CAAD,EAAO;AACLkS,sBAAM,CAAClS,CAAD,CAAN;;AACA,uBAAI,CAACyU,cAAL,WACK,OAAI,CAACpB,KAAL,CAAWhW,WAAX,EADL,mBACsCkV,SADtC,cAEE3K,EAFF;;AAIA,uBAAO,OAAI,CAACsL,SAAL,CAAe7hB,GAAf,CAAP;AACD,eATH,EAUE,YAAM;AACJ4gB,uBAAO,CAAC8B,MAAD,CAAP;;AACA,uBAAI,CAACU,cAAL,WACK,OAAI,CAACpB,KAAL,CAAWhW,WAAX,EADL,mBACsCkV,SADtC,eAEE3K,EAFF;;AAIA,uBAAI,CAACtT,OAAL,CAAajD,GAAb,EAAkB;AAAA,yBAAM,OAAO,OAAI,CAAC6hB,SAAL,CAAe7hB,GAAf,CAAb;AAAA,iBAAlB,EAAoD,IAApD;AACD,eAjBH;AAmBD,aA3BqB,CAAtB;AA4BD;;AACD,iBAAO,KAAK6hB,SAAL,CAAe7hB,GAAf,CAAP;AACD;AAGD;;;;;;;;;+BAMcuW,E,EAAY2L,S,EAA8C;AAAA;;AAAA,cAA1BM,YAA0B,uEAAF,EAAE;AACtE,cAAMxiB,GAAG,oBAAauW,EAAb,CAAT;AACA;;AACA,cAAI,CAAC,KAAKsL,SAAL,CAAe7hB,GAAf,CAAL,EAA0B;AACxB,iBAAK6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAAI2gB,OAAJ,CAAe,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACxD,kBAAMnJ,KAAK,GAAG,gBAAAoD,aAAA,CAAc,OAAI,CAACqI,eAAL,CAAqBX,YAArB,CAAd,CAAd;AACA,kBAAMxE,GAAG,aAAM,OAAI,CAACG,KAAL,CAAWqE,YAAY,CAACH,MAAxB,CAAN,cAAyC9L,EAAzC,SAA8CmB,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAApE,CAAT;AACA,kBAAIgL,MAAM,GAAM,IAAhB;;AACA,qBAAI,CAACC,IAAL,CAAUc,GAAV,CAAczF,GAAd,EAAmB,OAAI,CAACmF,eAAL,CAAqBjB,SAArB,CAAnB,EAAoD3f,SAApD,CACE,UAACkD,CAAD;AAAA,uBAAQid,MAAM,GAAG,OAAI,CAACE,OAAL,CAAand,CAAb,CAAjB;AAAA,eADF,EAEE,UAACkJ,CAAD,EAAO;AACLkS,sBAAM,CAAClS,CAAD,CAAN;;AACA,uBAAI,CAACyU,cAAL,kBAA8B,OAAI,CAACpB,KAAL,CAAWhW,WAAX,EAA9B,cAAiEuK,EAAjE;;AACA,uBAAI,CAACsL,SAAL,CAAe7hB,GAAf,IAAsB,IAAtB;AACD,eANH,EAOE,YAAM;AACJ4gB,uBAAO,CAAC8B,MAAD,CAAP;;AACA,uBAAI,CAACze,GAAL,CACE,MADF,EAEE,OAAI,CAACof,UAAL,CAAgB,OAAI,CAACK,UAAL,CAAgB,OAAI,CAAC1J,GAAL,CAAS,MAAT,CAAhB,EAAkC;AAAEzD,oBAAE,EAAFA;AAAF,iBAAlC,CAAhB,EAAkE,CAChEmM,MADgE,CAAlE,CAFF;;AAMA,uBAAI,CAACU,cAAL,kBAA8B,OAAI,CAACpB,KAAL,CAAWhW,WAAX,EAA9B,eAAkEuK,EAAlE;;AACA,uBAAI,CAACsL,SAAL,CAAe7hB,GAAf,IAAsB,IAAtB;AACD,eAjBH;AAmBD,aAvBqB,CAAtB;AAwBD;;AACD,iBAAO,KAAK6hB,SAAL,CAAe7hB,GAAf,CAAP;AACD;AAED;;;;;;;gCAIcuW,E,EAA2B;AAAA;;AAAA,cAAf4N,CAAe,uEAAF,EAAE;AACvC,cAAMnkB,GAAG,oBAAauW,EAAb,CAAT;AACA;;AACA,cAAI,CAAC,KAAKsL,SAAL,CAAe7hB,GAAf,CAAL,EAA0B;AACxB,iBAAK6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAAI2gB,OAAJ,CAAkB,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC3D,kBAAMnJ,KAAK,GAAG,gBAAAoD,aAAA,CAAcqJ,CAAd,CAAd;AACA,kBAAMnG,GAAG,aAAM,OAAI,CAACG,KAAL,EAAN,cAAsB5H,EAAtB,SAA2BmB,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAAjD,CAAT;;AACA,qBAAI,CAACiL,IAAL,WAAiB3E,GAAjB,EAAsBzb,SAAtB,CACE,UAACuZ,CAAD;AAAA,uBAAO,IAAP;AAAA,eADF,EAEE,UAACnN,CAAD,EAAO;AACLkS,sBAAM,CAAClS,CAAD,CAAN;AACA,uBAAI,CAACkT,SAAL,CAAe7hB,GAAf,IAAsB,IAAtB;AACD,eALH,EAME,YAAM;AACJ,uBAAI,CAACiE,GAAL,CAAS,MAAT,EAAiB,OAAI,CAACyf,UAAL,CAAgB,OAAI,CAAC1J,GAAL,CAAS,MAAT,CAAhB,EAAkC;AAAEzD,oBAAE,EAAFA;AAAF,iBAAlC,CAAjB;;AACA,uBAAI,CAACsL,SAAL,CAAe7hB,GAAf,IAAsB,IAAtB;AACA4gB,uBAAO;AACR,eAVH;AAYD,aAfqB,CAAtB;AAgBD;;AACD,iBAAO,KAAKiB,SAAL,CAAe7hB,GAAf,CAAP;AACD;AAED;;;;;;+BAGoB;;;;;;;;;;;;AACnB;AAED;;;;;;;uCAIyBuV,M,EAAgB6O,K,EAAgB,CACvD;AACA;AACA;AACD;AAED;;;;;;;gCAIkBC,Q,EAAiB;AACjC,iBAAOA,QAAP;AACD;AAED;;;;;;;;;mCAOEC,Q,EACA9hB,I,EACkD;AAAA,cAAlD+hB,SAAkD,uEAAb,KAAKzC,QAAQ;;AAElD;AACA,cAAI,CAACtf,IAAD,IAASA,IAAI,CAACgE,MAAL,KAAgB,CAA7B,EAAgC;AAC9B,mBAAO8d,QAAP;AACD;;AACD,cAAME,QAAQ,GAAQ,EAAtB;AACA,cAAMC,UAAU,gCAAOjiB,IAAP,sBAAgB8hB,QAAhB,EAAhB;AACA;;AACA,cAAI,CAACC,SAAL,EAAgB;AACdA,qBAAS,GAAG,KAAKzC,QAAjB;AACD;;AAXiD,uDAY/B2C,UAZ+B;AAAA;;AAAA;AAAA;AAAA,kBAYvCzX,IAZuC;AAahD,kBAAM8M,KAAK,GAAG0K,QAAQ,CAAC1c,IAAT,CAAc,UAACnF,CAAD;AAAA,uBAAO4hB,SAAS,CAAC5hB,CAAD,EAAIqK,IAAJ,CAAhB;AAAA,eAAd,CAAd;AACA;;AACA,kBAAI,CAAC8M,KAAL,EAAY;AACV0K,wBAAQ,CAACrY,IAAT,CAAca,IAAd;AACD;AAjB+C;;AAYlD,sEAA+B;AAAA;AAM9B;AAlBiD;AAAA;AAAA;AAAA;AAAA;;AAmBlD,iBAAOwX,QAAP;AACD;AAED;;;;;;;;;mCAMqBhiB,I,EAAWwK,I,EAASuX,S,EAAqC;AAC5E,cAAMC,QAAQ,GAAG,EAAjB;AACA;;AACA,cAAI,CAACD,SAAL,EAAgB;AACdA,qBAAS,GAAG,KAAKzC,QAAjB;AACD;;AACDtf,cAAI,CAACE,OAAL,CAAa,UAACC,CAAD;AAAA,mBAAQ4hB,SAAS,CAACvX,IAAD,EAAOrK,CAAP,CAAT,GAAqB,IAArB,GAA4B6hB,QAAQ,CAACrY,IAAT,CAAcxJ,CAAd,CAApC;AAAA,WAAb;AACA,iBAAO6hB,QAAP;AACD;;;4BAxdoB;AACnB,iBAAO,KAAKjJ,SAAL,CAAeoH,IAAtB;AACD;;;4BA4CsB;AACrB,iBAAO,KAAKV,UAAZ;AACD;;;;MAtEqE,OAAAviB,S;;AAAxE;;;;;;;;;;;;;;;;;;;;ACbA;AAAA;AAAA;;AAEA,QAAYmhC,gBAAZ;;AAAA,eAAYA,gBAAZ,EAA4B;AACxB;AACA;AACA,4CAHwB,CAIxB;;AACA;AACH,KAND,EAAYA,gBAAgB,GAAhB,QAAAA,gBAAA,aAAAA,gBAAA,GAAgB,EAAhB,CAAZ;;AAQA,QAAY4N,UAAZ;;AAAA,eAAYA,UAAZ,EAAsB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AAEH,KATD,EAAYA,UAAU,GAAV,QAAAA,UAAA,aAAAA,UAAA,GAAU,EAAV,CAAZ;;AAWA,QAAY1iB,YAAZ;;AAAA,eAAYA,YAAZ,EAAwB;AACpB;AACA;AACH,KAHD,EAAYA,YAAY,GAAZ,QAAAA,YAAA,aAAAA,YAAA,GAAY,EAAZ,CAAZ;;AAKA,QAAYkV,aAAZ;;AAAA,eAAYA,aAAZ,EAAyB;AACrB;AACA;AACH,KAHD,EAAYA,aAAa,GAAb,QAAAA,aAAA,aAAAA,aAAA,GAAa,EAAb,CAAZ;;AAiBA,QAAYyN,SAAZ;;AAAA,eAAYA,SAAZ,EAAqB;AACjB;AACA;AACH,KAHD,EAAYA,SAAS,GAAT,QAAAA,SAAA,aAAAA,SAAA,GAAS,EAAT,CAAZ;;AAqBa,YAAAC,8BAAA,GAAiC,UAAClY,MAAD,EAA6B;AACvE,cAAQA,MAAR;AACI,aAAKoK,gBAAgB,CAAC+N,KAAtB;AACI,iBAAO,MAAP;;AACJ,aAAK/N,gBAAgB,CAACU,MAAtB;AACI,iBAAO,OAAP;;AACJ,aAAKV,gBAAgB,CAACgO,gBAAtB;AACI,iBAAO,QAAP;;AACJ;AACI,iBAAO,MAAP;AARR;AAUH,KAXY;AAab;;;;;AAGa,YAAAC,gBAAA,GAAmB,UAACxqC,IAAD,EAAyE;AAAA,UAA1DyqC,MAA0D,uEAAvB,EAAuB;AAAA,UAC7FnjB,WAD6F,GAC7EmjB,MAD6E,CAC7FnjB,WAD6F;AAErG,UAAIojB,UAAU,GAAG,UAAAjhC,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB8J,YAApB,CAAiC,MAAjC,EAAyC7I,QAAzC,CAAkD;AAACwwB,YAAI,EAAG;AAAR,OAAlD,CAAjB,CAFqG,CAErB;;AAChF,UAAMsZ,SAAS,GAAoB,EAAnC;;AACA,WAAK,IAAItsC,GAAC,GAAG,CAAb,EAAgBA,GAAC,IAAI,CAArB,EAAwBA,GAAC,EAAzB,EAA6B;AACzB,YAAMusC,UAAU,GAAG,IAAI,UAAA15B,MAAJ,CAAW;AAAClR,cAAI,EAAJA,IAAD;AAAOsnB,qBAAW,EAAXA,WAAP;AAAoBD,qBAAW,EAAE;AAAjC,SAAX,CAAnB;AACA,YAAMwjB,MAAM,GAAGD,UAAU,CAACzX,WAAX,KAA2B90B,GAA1C;AACA,YAAMysC,SAAS,GAAGJ,UAAU,CAACppC,UAAX,CAAsB,MAAtB,CAAlB;AACA,YAAMypC,SAAS,GAAG1sC,GAAC,KAAK,CAAN,GAAU,CAAV,GAAcA,GAAhC,CAJyB,CAIS;;AAClCssC,iBAAS,CAAC9iC,IAAV,CAAe;AAACoK,YAAE,EAAE64B,SAAS,CAACz9B,SAAV,CAAoB,CAApB,EAAuB,CAAvB,CAAL;AAAgCw9B,gBAAM,EAANA,MAAhC;AAAwCE,mBAAS,EAATA,SAAxC;AAAmDD,mBAAS,EAAEA,SAAS,CAACrgC,iBAAV;AAA9D,SAAf;AACAigC,kBAAU,GAAGA,UAAU,CAAC7pC,QAAX,CAAoB;AAAEwwB,cAAI,EAAG;AAAT,SAApB,CAAb;AACH;;AACD,aAAOsZ,SAAP;AACH,KAbY;;AAeA,YAAAK,oBAAA,GAAuB,UAAC9sC,IAAD,EAAyB;AACzD,aAAOA,IAAI,CAACyF,MAAL,CAAY,UAACwE,CAAD,EAAIC,CAAJ,EAAU;AAAE,eAAOD,CAAC,CAACmwB,YAAF,CAAelwB,CAAf,IAAoBD,CAApB,GAAwBC,CAA/B;AAAmC,OAA3D,CAAP;AACH,KAFY;;AAIA,YAAA6iC,mBAAA,GAAsB,UAAC/sC,IAAD,EAAyB;AACxD,aAAOA,IAAI,CAACyF,MAAL,CAAY,UAACwE,CAAD,EAAIC,CAAJ,EAAU;AAAE,eAAOD,CAAC,CAACowB,WAAF,CAAcnwB,CAAd,IAAmBD,CAAnB,GAAuBC,CAA9B;AAAkC,OAA1D,CAAP;AACH,KAFY;;AAIA,YAAA8iC,iBAAA,GAAoB,UAACC,MAAD,EAAuC;AACpE,UAAMje,GAAG,GAAG,QAAA+d,mBAAA,CAAoBE,MAAM,CAACjtC,IAA3B,EAAiCoD,UAAjC,CAA4C,iBAA5C,CAAZ;;AACA,UAAM8pC,SAAS,GAAG,SAAZA,SAAY,CAACjZ,MAAD,EAAoB;AAClC,YAAGgZ,MAAM,CAACxZ,QAAP,KAAoB,CAAvB,EAAyB;AACrB,wCAAuBQ,MAAvB,oBAAuCjF,GAAvC;AACH,SAFD,MAEK;AACD,wCAAuBie,MAAM,CAACxZ,QAA9B,cAA0CQ,MAA1C,qBAA2DjF,GAA3D;AACH;AACJ,OAND;;AAQA,cAAQie,MAAM,CAAChZ,MAAf;AACI,aAAKoK,gBAAgB,CAAC+N,KAAtB;AACI,iBAAOc,SAAS,CAAC,KAAD,CAAhB;;AACJ,aAAK7O,gBAAgB,CAACU,MAAtB;AACI,iBAAOmO,SAAS,CAAC,MAAD,CAAhB;;AACJ,aAAK7O,gBAAgB,CAACgO,gBAAtB;AACI,iBAAOa,SAAS,CAAC,OAAD,CAAhB;;AACJ,aAAK7O,gBAAgB,CAACC,IAAtB;AACI,0DAAyC,QAAAyO,mBAAA,CAAoBE,MAAM,CAACjtC,IAA3B,EAAiCoD,UAAjC,CAA4C,iBAA5C,CAAzC;;AACJ;AACI,iBAAO,EAAP;AAVR;AAYH,KAtBY;;AAwBA,YAAA+pC,0BAAA,GAA6B,UAACF,MAAD,EAAgD;AACtF,UAAMje,GAAG,GAAGie,MAAM,CAACje,GAAnB;AACA,UAAMhtB,KAAK,GAAG,IAAI,UAAAgR,MAAJ,CAAW;AAAElR,YAAI,EAAEmrC,MAAM,CAACjrC;AAAf,OAAX,CAAd;;AAEA,UAAMkrC,SAAS,GAAG,SAAZA,SAAY,CAACjZ,MAAD,EAAoB;AAClC,YAAGgZ,MAAM,CAACxZ,QAAP,KAAoB,CAAvB,EAAyB;AACrB,wCAAuBQ,MAAvB,wBAA2CjyB,KAAK,CAACoB,UAAN,CAAiB,aAAjB,CAA3C,oBAAoF4rB,GAAG,CAAC5rB,UAAJ,CAAe,aAAf,CAApF;AACH,SAFD,MAEK;AACD,wCAAuB6pC,MAAM,CAACxZ,QAA9B,cAA0CQ,MAA1C,yBAA+DjyB,KAAK,CAACoB,UAAN,CAAiB,aAAjB,CAA/D,oBAAwG4rB,GAAG,CAAC5rB,UAAJ,CAAe,aAAf,CAAxG;AACH;AACJ,OAND;;AAQA,cAAQ6pC,MAAM,CAAChZ,MAAf;AACI,aAAKoK,gBAAgB,CAAC+N,KAAtB;AACI,iBAAOc,SAAS,CAAC,KAAD,CAAhB;;AACJ,aAAK7O,gBAAgB,CAACU,MAAtB;AACI,iBAAOmO,SAAS,CAAC,MAAD,CAAhB;;AACJ,aAAK7O,gBAAgB,CAACgO,gBAAtB;AACI,iBAAOa,SAAS,CAAC,OAAD,CAAhB;;AACJ,aAAK7O,gBAAgB,CAACC,IAAtB;AACI;;AACJ;AACI,iBAAO,EAAP;AAVR;AAYH,KAxBY;;AA0BA,YAAA7F,sBAAA,GAAyB,UAACpgB,IAAD,EAAmB;AACrD,UAAGA,IAAI,CAACgQ,YAAR,EAAqB;AACjB,YAAGhQ,IAAI,CAACiQ,iBAAL,KAA2B+V,gBAAgB,CAACC,IAA/C,EAAoD;AAChD,iBAAOjmB,IAAI,CAACqQ,iBAAZ;AACA,iBAAOrQ,IAAI,CAACmQ,gBAAZ;;AACA,cAAGnQ,IAAI,CAACiQ,iBAAL,KAA2B+V,gBAAgB,CAACU,MAA/C,EAAsD;AAClD,mBAAO1mB,IAAI,CAACuQ,eAAZ;AACH;AACJ,SAND,MAMO,IAAGvQ,IAAI,CAACiQ,iBAAR,EAA0B;AAC7BjQ,cAAI,CAACqgB,eAAL,sBAA2B,CAACrgB,IAAI,CAACqQ,iBAAL,IAA0B,EAA3B,EAA+B/gB,GAA/B,CAAmC,UAAC7F,IAAD;AAAA,mBAAkBA,IAAI,CAAC0J,YAAL,CAAkB,QAAlB,EAA4BgI,OAA9C;AAAA,WAAnC,CAA3B;AACA,iBAAO6E,IAAI,CAACkQ,mBAAZ;AACA,iBAAOlQ,IAAI,CAACmQ,gBAAZ;AACA,iBAAOnQ,IAAI,CAACoQ,gBAAZ;AACA,iBAAOpQ,IAAI,CAACqQ,iBAAZ;AACA,iBAAOrQ,IAAI,CAACuQ,eAAZ;AACH;;AACD,eAAOvQ,IAAI,CAACgQ,YAAZ;AACH,OAhBD,MAgBK;AACD,eAAOhQ,IAAI,CAACiQ,iBAAZ;AACA,eAAOjQ,IAAI,CAACkQ,mBAAZ;AACA,eAAOlQ,IAAI,CAACmQ,gBAAZ;AACA,eAAOnQ,IAAI,CAACoQ,gBAAZ;AACA,eAAOpQ,IAAI,CAACqQ,iBAAZ;AACA,eAAOrQ,IAAI,CAACgQ,YAAZ;AACA,eAAOhQ,IAAI,CAACsQ,qBAAZ;AACA,eAAOtQ,IAAI,CAACuQ,eAAZ;AACH;;AAED,aAAOvQ,IAAP;AACH,KA7BY;AA+Bb;;;AACa,YAAA+0B,uBAAA,GAA0B,UAACnvB,IAAD,EAAoB;;;AACvD,UAAG,OAAAA,IAAI,CAACovB,QAAL,CAAct6B,MAAd,MAAoB,IAApB,IAAoB,aAApB,GAAoB,MAApB,GAAoB,GAAE/N,KAAtB,MAAgCukB,YAAY,CAACiV,KAAhD,EAAuD;AACnD,YAAM8O,EAAE,GAAGrvB,IAAI,CAACovB,QAAL,CAAcra,UAAd,CAAyBhuB,KAAzB,CAA+B,CAA/B,EAAkC0B,QAA7C;AACA,YAAM6mC,QAAQ,GAAG,IAAI,UAAAv6B,MAAJ,CAAW;AAAEmW,qBAAW,EAAE,KAAf;AAAsBC,qBAAW,EAAEkkB;AAAnC,SAAX,CAAjB;AACA,YAAMlP,WAAW,GAAGngB,IAAI,CAACovB,QAAL,CAAc3kB,iBAAd,CAAgC1jB,KAAhC,CAAsC0D,MAAtC,CAA6C,UAAC5G,IAAD;AAAA,iBAC7DyrC,QAAQ,CAACnT,YAAT,CAAsBt4B,IAAtB,EAA4B,KAA5B,KAAsCyrC,QAAQ,CAAClO,UAAT,CAAoBv9B,IAApB,EAA0B,KAA1B,CADuB;AAAA,SAA7C,CAApB;AAGAmc,YAAI,CAACovB,QAAL,CAAc3kB,iBAAd,CAAgChmB,QAAhC,CAAyC07B,WAAzC;;AANmD,oCAO5B,QAAAoP,2BAAA,CAA4BpP,WAA5B,EAAyCkP,EAAzC,CAP4B;AAAA,YAO3CtrC,KAP2C,yBAO3CA,KAP2C;AAAA,YAOpCgtB,GAPoC,yBAOpCA,GAPoC;;AAQnD/Q,YAAI,CAACovB,QAAL,CAAc5qC,MAAd,CAAqBC,QAArB,CAA8BV,KAA9B;AACAic,YAAI,CAACovB,QAAL,CAAc7kB,gBAAd,CAA+B9lB,QAA/B,CAAwCssB,GAAxC;AACH;AACJ,KAZY;AAcb;;;;;AAGc,YAAAwe,2BAAA,GAA8B,UAACC,KAAD,EAAuBH,EAAvB,EAAmE;AAC3G,UAAGG,KAAK,CAACzpC,MAAN,KAAiB,CAApB,EAAsB;AAClB,eAAO;AACHhC,eAAK,EAAEyrC,KAAK,CAACzjC,IAAN,CAAW,UAAC20B,EAAD,EAAKC,EAAL;AAAA,mBAAYD,EAAE,CAAClzB,EAAH,GAAQmzB,EAAE,CAACnzB,EAAvB;AAAA,WAAX,EAAsC,CAAtC,CADJ;AAEHujB,aAAG,EAAEye,KAAK,CAACzjC,IAAN,CAAW,UAAC20B,EAAD,EAAKC,EAAL;AAAA,mBAAYA,EAAE,CAACnzB,EAAH,GAAQkzB,EAAE,CAAClzB,EAAvB;AAAA,WAAX,EAAsC,CAAtC;AAFF,SAAP;AAIH,OAN0G,CAO3G;;;AACA,UAAMqd,GAAG,GAAG,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoBwK,MAApB,CAA2BohC,EAA3B,CAAZ;AACA,aAAO;AAACtrC,aAAK,EAAE8mB,GAAR;AAAakG,WAAG,EAAElG,GAAG,CAACnmB,QAAJ,CAAa;AAACwwB,cAAI,EAAE;AAAP,SAAb;AAAlB,OAAP;AACH,KAVa;;AAYD,YAAAua,uBAAA,GAA0B,UAACzvB,IAAD,EAAqB;AAAA,wBAClBA,IAAI,CAACjZ,KADa;AAAA,UAChD0jB,iBADgD,eAChDA,iBADgD;AAAA,UAC7BjmB,MAD6B,eAC7BA,MAD6B;AAExD,UAAMzC,IAAI,GAAG,CAAC0oB,iBAAiB,IAAI,EAAtB,EAA0B/gB,GAA1B,CAA8B,UAAC7F,IAAD;AAAA,eAAkBA,IAAI,CAACY,QAAL,CAAc;AAAC0B,cAAI,EAAE3B,MAAM,CAACkrC,QAAd;AAAwBxrC,gBAAM,EAAEM,MAAM,CAACF;AAAvC,SAAd,CAAlB;AAAA,OAA9B,CAAb;AACA0b,UAAI,CAACovB,QAAL,CAAc3kB,iBAAd,CAAgChmB,QAAhC,CAAyC1C,IAAzC;AACH,KAJY;;;;;;;;;;;;;;;;;;;;;;;;;ACxNb;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACDA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;QAEa4tC,M;AAMT,wBAAoC;AAAA,YAAxBlwB,QAAwB,uEAAJ,EAAI;;AAAA;;AAChC,aAAK3W,IAAL,GAAY2W,QAAQ,CAAC3W,IAAT,IAAiB,EAA7B;AACA,aAAKsR,IAAL,GAAY,KAAKw1B,SAAL,CAAenwB,QAAQ,CAACrF,IAAxB,CAAZ;AACH;AAED;;;;;;AAMA;sCAC+C;AAAA,cAA5Bxa,IAA4B,uEAAb,aAAa;AAC3C,iBAAA4P,YAAA,CAAa5P,IAAb,EAAmB,OAAA8Q,SAAA,CAAU,KAAK0J,IAAf,CAAnB;AACH;AAED;;;;uCACiD;AAAA,cAA7Bxa,IAA6B,uEAAd,cAAc;AAC7C,iBAAA4P,YAAA,CAAa5P,IAAb,EAAmBwM,IAAI,CAACE,SAAL,CAAe,KAAK8N,IAApB,EAA0BtU,SAA1B,EAAqC,CAArC,CAAnB;AACH;;;0CAEwBmP,K,EAAe;AACpC,cAAIA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAKnP,SAAhC,EAA2C;AACvC,gBAAIlG,IAAI,GAAGqV,KAAK,CAACpP,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAAX;AACAjG,gBAAI,GAAGA,IAAI,CAACiG,KAAL,CAAW,GAAX,EAAgBqH,IAAhB,CAAqB,GAArB,CAAP,CAFuC,CAEL;;AAClCtN,gBAAI,GAAGA,IAAI,CAACkN,OAAL,CAAa,QAAb,EAAuB,UAAU+iC,GAAV,EAAe;AACzC,+BAAUA,GAAG,CACRC,MADK,CACE,CADF,EAEL78B,WAFK,EAAV,SAEqB48B,GAAG,CAACjJ,MAAJ,CAAW,CAAX,EAAcr7B,WAAd,EAFrB;AAGH,aAJM,CAAP;AAKA,mBAAO3L,IAAP;AACH,WATD,MASO;AACH,mBAAOqV,KAAP;AACH;AACJ;;;sCAEqB86B,c,EAAsB;AACxC,cAAI/jC,CAAC,GAAG,IAAIvI,IAAJ,CAASssC,cAAc,GAAG,IAA1B,CAAR;AACA,cAAI5S,MAAM,GAAG,CAAC,KAAD,EAAO,KAAP,EAAa,KAAb,EAAmB,KAAnB,EAAyB,KAAzB,EAA+B,KAA/B,EAAqC,KAArC,EAA2C,KAA3C,EAAiD,KAAjD,EAAuD,KAAvD,EAA6D,KAA7D,EAAmE,KAAnE,CAAb;AACA,cAAIj3B,IAAI,GAAG8F,CAAC,CAAC7D,WAAF,EAAX;AACA,cAAIlC,KAAK,GAAGk3B,MAAM,CAACnxB,CAAC,CAACgkC,QAAF,EAAD,CAAlB;AACA,cAAInsC,IAAI,GAAGmI,CAAC,CAAC/D,OAAF,EAAX;AACA,cAAI9B,IAAI,GAAI,CAAC6F,CAAC,CAACikC,QAAF,KAAe,EAAhB,IAAsB,EAAtB,GAA2B,CAAvC;AACA,cAAIC,MAAM,GAAGlkC,CAAC,CAACikC,QAAF,MAAgB,EAAhB,GAAqB,IAArB,GAA0B,IAAvC;AACA,cAAIzO,GAAG,GAAGx1B,CAAC,CAACmkC,UAAF,EAAV;AACA,cAAI9iC,IAAI,GAAGxJ,IAAI,GAAG,GAAP,GAAaoC,KAAb,GAAqB,GAArB,GAA2BC,IAA3B,GAAkC,KAAlC,GAA0CC,IAA1C,GAAiD,GAAjD,GAAuDq7B,GAAvD,GAA6D,GAA7D,GAAmE0O,MAA9E;AACA,iBAAO7iC,IAAP;AACH;;;oCAEiC;AAAA;;AAAA,cAAhB+M,IAAgB,uEAAJ,EAAI;;AAC9B,cAAIA,IAAI,CAACrU,MAAL,GAAc,CAAd,IAAmB,KAAK+C,IAAL,KAAc,KAArC,EAA4C;AACxC,iBAAK,IAAI5G,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGkY,IAAI,CAACrU,MAAzB,EAAiC7D,GAAC,EAAlC,EAAsC;AAClCkY,kBAAI,CAAClY,GAAD,CAAJ,CAAQ,QAAR,IAAoBkY,IAAI,CAAClY,GAAD,CAAJ,CAAQ,QAAR,EAAkBtC,IAAtC;AACAwa,kBAAI,CAAClY,GAAD,CAAJ,CAAQ,oBAAR,IAAgC2O,MAAM,CAACkpB,MAAP,CAAc3f,IAAI,CAAClY,GAAD,CAAJ,CAAQ,oBAAR,CAAd,EAA6C,CAA7C,CAAhC;AACH;AACJ,WALD,MAKO,IAAIkY,IAAI,CAACrU,MAAL,GAAc,CAAd,IAAmB,KAAK+C,IAAL,KAAc,OAArC,EAA8C;AACjD,iBAAK,IAAI5G,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGkY,IAAI,CAACrU,MAAzB,EAAiC7D,GAAC,EAAlC,EAAsC;AAClCkY,kBAAI,CAAClY,GAAD,CAAJ,CAAQ,YAAR,IAAwB,KAAKkuC,aAAL,CAAmBh2B,IAAI,CAAClY,GAAD,CAAJ,CAAQ,YAAR,CAAnB,CAAxB;AACH;AACJ,WAJM,MAIA,IAAIkY,IAAI,CAACrU,MAAL,GAAc,CAAd,IAAmB,KAAK+C,IAAL,KAAc,UAArC,EAAiD;AACpD,iBAAK,IAAI5G,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAGkY,IAAI,CAACrU,MAAzB,EAAiC7D,GAAC,EAAlC,EAAsC;AAClCkY,kBAAI,CAAClY,GAAD,CAAJ,CAAQ,cAAR,IAA0B,KAAKmuC,iBAAL,CACtBj2B,IAAI,CAAClY,GAAD,CAAJ,CAAQ,cAAR,CADsB,CAA1B;AAGH;;AACD,gBAAMkJ,MAAM,GAAGyF,MAAM,CAACpH,IAAP,CAAY2Q,IAAI,CAAC,CAAD,CAAhB,CAAf;AACA,gBAAMk2B,UAAU,GAAGllC,MAAM,CAAC/D,IAAP,CACf,UAAC9H,GAAD;AAAA,qBACIA,GAAG,CAACgM,WAAJ,GAAkBoS,QAAlB,CAA2B,MAA3B,KACApe,GAAG,CAACgM,WAAJ,GAAkBoS,QAAlB,CAA2B,OAA3B,CAFJ;AAAA,aADe,CAAnB;AAKA,gBAAM4yB,WAAW,GAAGnlC,MAAM,CAAC/D,IAAP,CAAY,UAAC9H,GAAD;AAAA,qBAC5BA,GAAG,CAACgM,WAAJ,GAAkBoS,QAAlB,CAA2B,OAA3B,CAD4B;AAAA,aAAZ,CAApB;;AAZoD,yDAgBpCvD,IAhBoC;AAAA;;AAAA;AAgBpD,wEAAsB;AAAA,oBAAbo2B,GAAa;;AAClB;AACA,oBAAMC,aAAa,GAAG,wBAAA1vB,cAAA,CAAeC,UAAf,CAA0B,SAAAgG,KAA1B,CAAtB;;AACA,oBAAIspB,UAAU,IAAIC,WAAd,IAA6BE,aAAjC,EAAgD;AAAA;AAC5C,wBAAMja,IAAI,GAAGia,aAAa,CAACppC,IAAd,CACTmpC,GAAG,CAACF,UAAD,CAAH,CAAgB/kC,WAAhB,EADS,CAAb;AAGA,wBAAMmlC,WAAW,GAAG,wBAAA3vB,cAAA,CAAeC,UAAf,CAA0B,eAAA2oB,YAA1B,CAApB;AACA,wBAAMM,GAAG,GAAGyG,WAAW,CAAC/3B,SAAZ,CAAsBtR,IAAtB,CACR,UAAC4iC,GAAD,EAAqB;AAAA;;AACjB,6BAAAA,GAAG,CAACn0B,EAAJ,MAAM,MAAK0gB,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEzH,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEmb,WAAxB;AAAmC,qBAF/B,CAAZ;AAIAsG,uBAAG,CAACD,WAAD,CAAH,GAAmB,IAAI,SAAAI,YAAJ,CAAiB,OAAjB,EAA0BC,SAA1B,CACfJ,GAAG,CAACD,WAAD,CAAH,GAAmB,GADJ,EAEftG,GAAG,SAAH,IAAAA,GAAG,WAAH,GAAG,MAAH,GAAAA,GAAG,CAAE6B,QAFU,CAAnB;AAT4C;AAa/C;AACD;;;AAjBkB,6DAkBA1gC,MAlBA;AAAA;;AAAA;AAkBlB,4EAA0B;AAAA,wBAAjBwB,KAAiB;AACtB4jC,uBAAG,CAAC5jC,KAAD,CAAH,GACI,OAAO4jC,GAAG,CAAC5jC,KAAD,CAAV,KAAsB,QAAtB,GACM4jC,GAAG,CAAC5jC,KAAD,CAAH,CAAWE,OAAX,CAAmB,KAAnB,EAA0B,GAA1B,CADN,GAEM0jC,GAAG,CAAC5jC,KAAD,CAHb;AAIH;AAvBiB;AAAA;AAAA;AAAA;AAAA;AAwBrB;AAxCmD;AAAA;AAAA;AAAA;AAAA;AAyCvD,WAzCM,MAyCA,IAAI,KAAK9D,IAAL,KAAc,UAAlB,EAA8B;AACjCsR,gBAAI,GAAGA,IAAI,CAAC1Q,GAAL,CAAS,UAACxH,CAAD,EAAgB;;;AAC5B,kBAAMsW,OAAO,GAAGtW,CAAhB;;AACA,kBAAI;AACA,oBAAIsW,OAAO,CAAC+F,KAAR,YAAyB1N,MAA7B,EAAqC;AACjC2H,yBAAO,CAAC+F,KAAR,GAAgB/F,OAAO,CAAC+F,KAAR,CAAc/F,OAAO,CAAC0d,UAAtB,CAAhB;AACH;;AACD,oBAAI1d,OAAO,CAACiZ,SAAR,YAA6B5gB,MAAjC,EAAyC;AACrC2H,yBAAO,CAACiZ,SAAR,GACIjZ,OAAO,CAACiZ,SAAR,CAAkBjZ,OAAO,CAAC0d,UAA1B,CADJ;AAEH;;AACD1d,uBAAO,CAAC+F,KAAR,GAAgB,OAAA1T,gBAAA,CAAiB,CAAC2N,OAAO,CAAC+F,KAAR,IAAiB,CAAlB,IAAuB,EAAxC,CAAhB;AACA/F,uBAAO,CAACiZ,SAAR,GAAoB,OAAA5mB,gBAAA,CAChB,CAAC2N,OAAO,CAACiZ,SAAR,IAAqB,CAAtB,IAA2B,EADX,CAApB;AAGAjZ,uBAAO,CAACgtB,WAAR,GAAsB,CAAChtB,OAAO,CAACgtB,WAAR,IAAuB,EAAxB,EACjB14B,OADiB,CACT,YADS,EACK,EADL,EAEjBA,OAFiB,CAET,KAFS,EAEF,GAFE,EAGjBA,OAHiB,CAGT,WAHS,EAGI,GAHJ,CAAtB;AAIA0L,uBAAO,CAAC,cAAD,CAAP,GACI,OAAAA,OAAO,CAACq4B,SAAR,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEjxC,IAAnB,KAA2B4Y,OAAO,CAACq4B,SADvC;AAEAr4B,uBAAO,CAAC,WAAD,CAAP,GACI,OAAAA,OAAO,CAAC6f,SAAR,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEz4B,IAAnB,MAAuB,MACvB4Y,OAAO,CAAC6f,SADe,MACN,IADM,IACN,aADM,GACN,MADM,GACN,GAAEpjB,KADnB,KAEA,EAHJ;AAIAuD,uBAAO,CAAC6uB,WAAR,GACI7uB,OAAO,CAAC+f,eAAR,CAAwB/f,OAAO,CAAC0d,UAAhC,KAA+C,EADnD,CAtBA,CAwBA;;AACA1d,uBAAO,CAAC0f,SAAR,GAAoB,CAAC1f,OAAO,CAAC0f,SAAR,IAAqB,EAAtB,EACfxuB,GADe,CACX,UAAConC,MAAD;AAAA,yBAAYA,MAAM,CAAClxC,IAAP,IAAekxC,MAAM,CAAC77B,KAAtB,IAA+B67B,MAA3C;AAAA,iBADW,EAEf5jC,IAFe,CAEV,IAFU,CAApB;AAGAsL,uBAAO,CAAC8f,KAAR,GAAgB,CAAC9f,OAAO,CAAC8f,KAAR,IAAiB,EAAlB,EACX5uB,GADW,CACP,UAAC6wB,IAAD;AAAA,yBACDA,IAAI,CAACH,MAAL,KACCG,IAAI,CAACzxB,IAAL,KAAc,aAAd,IACGyxB,IAAI,CAACzxB,IAAL,KAAc,SAFlB,eAGUyxB,IAAI,CAACH,MAHf,cAGyBG,IAAI,CAACzxB,IAH9B,cAGsCyxB,IAAI,CAAC/e,OAAL,CAC3B1O,OAD2B,CACnB,YADmB,EACL,EADK,EAE3BA,OAF2B,CAEnB,KAFmB,EAEZ,GAFY,EAG3BA,OAH2B,CAGnB,WAHmB,EAGN,GAHM,CAHtC,IAOM,EARL;AAAA,iBADO,EAWXI,IAXW,CAWN,KAXM,CAAhB;AAYAsL,uBAAO,CAACjB,SAAR,GAAoBiB,OAAO,CAACu4B,WAA5B;AACAv4B,uBAAO,CAAC6P,MAAR,GAAiB7P,OAAO,CAAC6P,MAAR,CAAe7P,OAAO,CAAC0d,UAAvB,KAAsC,EAAvD;AACA1d,uBAAO,CAACmgB,OAAR,GAAkBngB,OAAO,CAACmgB,OAAR,CAAgBzrB,IAAhB,CAAqB,IAArB,CAAlB;;AACA,oBAAIsL,OAAO,CAACw4B,YAAZ,EAA0B;AACtBx4B,yBAAO,CAACw4B,YAAR,GAAuB,OAAI,CAACX,iBAAL,CACnB73B,OAAO,CAACw4B,YADW,CAAvB;AAGH;;AACD,oBAAIx4B,OAAO,CAACu4B,WAAZ,EAAyB;AACrBv4B,yBAAO,CAACy4B,kBAAR,GAA6B,IAAIxtC,IAAJ,CACzB+U,OAAO,CAACy4B,kBAAR,GAA6B,IADJ,EAE3B/oC,cAF2B,EAA7B;AAGH;;AACDsQ,uBAAO,CAAC04B,cAAR,GAAyB14B,OAAO,CAACy4B,kBAAjC;AACH,eAtDD,CAsDE,OAAO/iC,CAAP,EAAU,CAAE;;AACd,kBAAMijC,aAAa,GAAG,CAClB,IADkB,EAElB,SAFkB,EAGlB,aAHkB,EAIlB,aAJkB,EAKlB,WALkB,EAMlB,WANkB,EAOlB,SAPkB,EAQlB,cARkB,EASlB,cATkB,EAUlB,WAVkB,EAWlB,eAXkB,EAYlB,aAZkB,EAalB,oBAbkB,EAclB,UAdkB,EAelB,aAfkB,EAgBlB,MAhBkB,EAiBlB,SAjBkB,EAkBlB,sBAlBkB,EAmBlB,cAnBkB,EAoBlB,WApBkB,EAqBlB,WArBkB,EAsBlB,WAtBkB,EAuBlB,qBAvBkB,EAwBlB,uBAxBkB,EAyBlB,qBAzBkB,EA0BlB,YA1BkB,EA2BlB,aA3BkB,EA4BlB,SA5BkB,EA6BlB,aA7BkB,EA8BlB,gBA9BkB,EA+BlB,SA/BkB,EAgClB,OAhCkB,EAiClB,SAjCkB,EAkClB,MAlCkB,EAmClB,kBAnCkB,EAoClB,UApCkB,EAqClB,gBArCkB,EAsClB,iBAtCkB,EAuClB,oBAvCkB,CAAtB;;AAyCA,kDAAoBA,aAApB,wCAAmC;AAA9B,oBAAMvkC,OAAK,uBAAX;;AACD,oBAAI4L,OAAO,CAAC5L,OAAD,CAAP,KAAmB9G,SAAvB,EAAkC;AAC9B,yBAAO0S,OAAO,CAAC5L,OAAD,CAAd;AACH;AACJ;;AACD,kBAAMwkC,MAAM,GAAG,EAAf;AACA,kBAAM3U,KAAK,GAAG,CACV,OADU,EAEV,OAFU,EAGV,KAHU,EAIV,UAJU,EAKV,cALU,EAMV,WANU,EAOV,WAPU,EAQV,iBARU,EASV,SATU,EAUV,WAVU,EAWV,SAXU,EAYV,aAZU,EAaV,WAbU,EAcV,cAdU,EAeV,gBAfU,CAAd;AAiBA,kBAAMhzB,IAAI,GAAGoH,MAAM,CAACpH,IAAP,CAAY+O,OAAZ,CAAb;AACA/O,kBAAI,CAACsC,IAAL,CAAU,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAChB,oBAAMolC,KAAK,GAAG5U,KAAK,CAACx1B,OAAN,CAAc+E,CAAd,CAAd;AACA,oBAAMslC,KAAK,GAAG7U,KAAK,CAACx1B,OAAN,CAAcgF,CAAd,CAAd;AACA,uBACI,CAAColC,KAAK,KAAK,CAAC,CAAX,GAAe5nC,IAAI,CAAC1D,MAApB,GAA6BsrC,KAA9B,KACCC,KAAK,KAAK,CAAC,CAAX,GAAe7nC,IAAI,CAAC1D,MAApB,GAA6BurC,KAD9B,CADJ;AAIH,eAPD;;AAQA,0CAAkB7nC,IAAlB,gCAAwB;AAAnB,oBAAMlK,GAAG,eAAT;AACD6xC,sBAAM,CAAC7xC,GAAD,CAAN,GAAciZ,OAAO,CAACjZ,GAAD,CAArB;AACH;;AACD,qBAAO6xC,MAAP;AACH,aAtIM,CAAP;AAuIH;;AACD,iBAAOh3B,IAAP;AACH;;;gCAxOqBtR,I,EAAcsR,I,EAAY;AAC5C,cAAMm3B,QAAQ,GAAG,OAAAphC,SAAA,CAAUiK,IAAV,CAAjB;AACA,iBAAO,IAAIu1B,MAAJ,CAAW;AAAE7mC,gBAAI,EAAJA,IAAF;AAAQsR,gBAAI,EAAEm3B;AAAd,WAAX,CAAP;AACH;;;;;;AAfL;;;;;;;;;;;;;;;;;;;;ACdA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;QAKaC,c;;;;;AACT,8BAAsB12B,SAAtB,EACYoG,eADZ,EAC8C;AAAA;;AAAA;;AAC1C,sCAAMpG,SAAN,EAAiBoG,eAAjB;AAFkB,gBAAApG,SAAA,GAAAA,SAAA;AAGlB,gBAAKyG,KAAL,GAAa,SAAb;AACA,gBAAKC,UAAL,GAAkB,SAAlB;AAH0C;AAI7C;;;;gCAEiB/B,Q,EAAa;AAC3B,iBAAOA,QAAQ,YAAY7O,KAApB,GACD,IAAI,eAAA++B,MAAJ,CAAW;AAAEv1B,gBAAI,EAAEqF;AAAR,WAAX,CADC,GAED,eAAAkwB,MAAA,CAAO8B,OAAP,CAAe,EAAf,EAAmBhyB,QAAnB,CAFN;AAGH;;;;MAZ+B,eAAAwB,c;;AAHpC;;;uBAGauwB,c,EAAc,+B,EAAA,+B;AAAA,K;;;aAAdA,c;AAAc,eAAdA,cAAc,K;AAAA,kBAFX;;;;;2BAEHA,c,EAAc;cAH1B,OAAA96B,UAG0B;eAHf;AACR6I,oBAAU,EAAE;AADJ,S;AAGe,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;QCSdwB,c;AAuBT,gCAAc;AAAA;;AACV,cAAM,IAAI9gB,KAAJ,CAAU,iCAAV,CAAN;AACH;AArBD;;;;;mCACyB6I,I,EAAiBwoB,O,EAAY;AAClD,cAAIloB,MAAM,CAACC,KAAX,EAAkB;AACbD,kBAAc,CAAC2X,cAAf,GAAgC,KAAK2wB,aAArC;AACJ;;AACD,cAAMvvC,KAAK,GAAG4e,cAAc,CAAC2wB,aAAf,CAA6BC,SAA7B,CAAuC,UAAAC,QAAQ;AAAA,mBAAIA,QAAQ,CAACC,UAAT,KAAwB/oC,IAA5B;AAAA,WAA/C,CAAd;;AACA,cAAI3G,KAAK,IAAI,CAAb,EAAgB;AACZ4e,0BAAc,CAAC2wB,aAAf,CAA6BphC,MAA7B,CAAoCnO,KAApC,EAA2C,CAA3C,EAA8C;AAAE0vC,wBAAU,EAAE/oC,IAAd;AAAoBgpC,sBAAQ,EAAExgB;AAA9B,aAA9C;AACH,WAFD,MAEO;AACHvQ,0BAAc,CAAC2wB,aAAf,CAA6BhmC,IAA7B,CAAkC;AAAEmmC,wBAAU,EAAE/oC,IAAd;AAAoBgpC,sBAAQ,EAAExgB;AAA9B,aAAlC;AACH;AACJ;AAED;;;;mCACyBxoB,I,EAAe;AACpC,cAAM8oC,QAAQ,GAAG7wB,cAAc,CAAC2wB,aAAf,CAA6BrqC,IAA7B,CAAkC,UAAAuqC,QAAQ;AAAA,mBAAIA,QAAQ,CAACC,UAAT,KAAwB/oC,IAA5B;AAAA,WAA1C,KAA+E;AAAEgpC,oBAAQ,EAAE;AAAZ,WAAhG;AACA,iBAAOF,QAAQ,CAACE,QAAhB;AACH;;;;;;AArBL;AACI;;AACe,mBAAAJ,aAAA,GAAwC,EAAxC;;;;;;;;;;;;;;;;;;;;;;;;ACtBnB;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;AAQa,YAAAK,cAAA,GAAiB,uBAAjB;;QAwCAC,c,GACT,wBAAmB53B,IAAnB,EAA4C;AAAA;;AAAzB,WAAAA,IAAA,GAAAA,IAAA;AAClB,K;;AAFL;;QAQa8c,e;;;;;AAmDT,+BAAoBvc,MAApB,EAEoBqC,QAFpB,EAE8C;AAAA;;AAAA;;AAC1C;AAHgB,gBAAArC,MAAA,GAAAA,MAAA;AAEA,gBAAAqC,QAAA,GAAAA,QAAA;AApDpB;;AACQ,gBAAAi1B,SAAA,GAAY,UAAZ;AACR;;AACQ,gBAAAC,UAAA,GAAa,IAAI,OAAA5yC,eAAJ,CAA+B,EAA/B,CAAb;AACR;;AACQ,gBAAA2b,SAAA,GAA2C,EAA3C;AACR;;AACQ,gBAAAk3B,YAAA,GAAyC,EAAzC;AAGA,gBAAAC,gBAAA,GAA4B,KAA5B;AA4CJ,gCAAArxB,cAAA,CAAesiB,UAAf,CAA0BnM,eAA1B;AACA,YAAM7pB,IAAI,GAAG,IAAI,UAAA0H,MAAJ,CAAW;AAAClR,cAAI,EAAE,cAAAwuC,OAAA,CAAQhlC;AAAf,SAAX,CAAb;AACA,YAAMilC,KAAK,GAAG,UAAAhlC,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB29B,UAApB,CAA+B/zB,IAA/B,EAAqC,KAArC,uBACIA,IAAI,CAAClI,UAAL,CAAgB,OAAhB,CADJ,IAERkI,IAAI,CAAClI,UAAL,CAAgB,oBAAhB,CAFN;AAGA,YAAM0Z,QAAQ,GAAG,QAAKtF,GAAL,CAAS,UAAT,KAAwB,SAAzC;AACA,gBAAKsF,QAAL,GAAgBA,QAAhB;AACA,eAAAhW,GAAA,CAAI,MAAJ,YAAe,cAAAwpC,OAAA,CAAQE,MAAvB,GAAiC,IAAjC,EAAuC,OAAvC,EAAgD,IAAhD,EAAsD1zB,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAE5L,WAAV,EAAtD;AACA,eAAApK,GAAA,CAAI,KAAJ,YAAc,cAAAwpC,OAAA,CAAQG,IAAtB,uBAAuCF,KAAvC,GAAgD,IAAhD,EAAsD,OAAtD,EAA+D,IAA/D,EAAqEzzB,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAE5L,WAAV,EAArE;;AACA,gBAAKoJ,IAAL;;AAX0C;AAY7C;AApDD;;;;;;;;AAOA;+BACuBzc,I,EAAY;AAC/B,cAAI,CAAC,KAAKuyC,YAAL,CAAkBvyC,IAAlB,CAAL,EAA8B;AAC1B,iBAAKqb,SAAL,CAAerb,IAAf,IAAuB,IAAI,OAAAN,eAAJ,CAAuB,IAAvB,CAAvB;AACA,iBAAK6yC,YAAL,CAAkBvyC,IAAlB,IAA0B,KAAKqb,SAAL,CAAerb,IAAf,EAAqBuc,YAArB,EAA1B;AACH;;AACD,iBAAO,KAAKg2B,YAAL,CAAkBvyC,IAAlB,CAAP;AACH;AAED;;;;6BACeA,I,EAAcmH,K,EAAQ;AACjC,cAAI,CAAC,KAAKorC,YAAL,CAAkBvyC,IAAlB,CAAL,EAA8B;AAC1B,iBAAKqb,SAAL,CAAerb,IAAf,IAAuB,IAAI,OAAAN,eAAJ,CAAuB,IAAvB,CAAvB;AACA,iBAAK6yC,YAAL,CAAkBvyC,IAAlB,IAA0B,KAAKqb,SAAL,CAAerb,IAAf,EAAqBuc,YAArB,EAA1B;AACH;;AACD,eAAKlB,SAAL,CAAerb,IAAf,EAAqBoS,IAArB,CAA0BjL,KAA1B;AACH;;;8BAEqBnH,I,EAAY;AAC9B,iBAAO,CAAC,KAAKuyC,YAAL,CAAkBvyC,IAAlB,CAAD,GAA2B,IAA3B,GAAkC,KAAKqb,SAAL,CAAerb,IAAf,EAAqBS,QAArB,EAAzC;AACH;AAED;;;;;AAyBA;;;+BAGoB;;;;;;;;AAChB,wBAAI,KAAKkZ,GAAL,CAAS,OAAT,CAAJ,EAAuB;AACnBnQ,4BAAM,CAACC,KAAP,GAAe,IAAf;AACH;;AACD,wBAAI,CAAJ,KAAI,KAAKkQ,GAAL,CAAS,KAAT,OAAe,IAAf,IAAe,aAAf,GAAe,MAAf,GAAe,GAAE3Z,IAArB,EAA2B;AACvB,2BAAKqyC,SAAL,GAAiB,KAAK14B,GAAL,CAAS,KAAT,EAAgB3Z,IAAjC;AACH;;AACD,2BAAAiJ,GAAA,CAAI,UAAJ,EAAgB,8BAAhB;;AACA,yBAAKxJ,YAAL,CAAkB2S,IAAlB,CAAuB,IAAvB;;;;;;;;;AACH;AAED;;;;;AAiBA;;;;4BAIWzS,G,EAAW;AAClB,cAAMkK,IAAI,GAAGlK,GAAG,CAACsG,KAAJ,CAAU,GAAV,CAAb;;AACA,cAAI4D,IAAI,CAAC,CAAD,CAAJ,KAAY,KAAhB,EAAuB;AACnB,mBAAO,OAAAD,eAAA,CAAgBC,IAAhB,EAAsB,KAAKuT,QAAL,CAAc5C,IAApC,CAAP;AACH;;AACD,cAAMq4B,iBAAiB,GAAG,KAAKP,UAAL,CAAgB7xC,QAAhB,EAA1B;;AALkB,uDAMKoyC,iBANL;AAAA;;AAAA;AAMlB,sEAA0C;AAAA,kBAA/B5K,QAA+B;AACtC,kBAAM9gC,KAAK,GAAG,OAAAyC,eAAA,CAAgBC,IAAI,CAACE,KAAL,CAAW,CAAX,CAAhB,EAA+Bk+B,QAA/B,CAAd;;AACA,kBAAI9gC,KAAK,IAAI,IAAb,EAAmB;AACf,uBAAOA,KAAP;AACH;AACJ;AAXiB;AAAA;AAAA;AAAA;AAAA;;AAYlB,iBAAO,OAAAyC,eAAA,CAAgBC,IAAhB,EAAsB,KAAKuT,QAAL,CAAc5C,IAApC,CAAP;AACH;;;0BAnGoBrT,K,EAAkB;AACnC,eAAKmrC,UAAL,CAAgBlgC,IAAhB,CAAqBjL,KAArB;AACH;;;4BAyBkB;AACf,iBAAO,KAAK4T,MAAL,CAAYwE,QAAZ,EAAP;AACH,S;0BAEgBpY,K,EAAe;AAC5B,eAAK4T,MAAL,CAAYuE,QAAZ,WAAwBnY,KAAxB,gBAAmC,KAAKkrC,SAAxC;AACH;;;4BAiCqB;AAClB,iBAAO,KAAKA,SAAZ;AACH;;;4BAEsB;AACnB,iBAAO,KAAKpzB,QAAL,KAAkB,WAAzB;AACH;;;0BAE0B9X,K,EAAgB;AACvC,eAAKqrC,gBAAL,GAAwBrrC,KAAxB;AACH,S;4BAE4B;AAC1B,iBAAO,KAAKqrC,gBAAZ;AACF;;;;MAhGgC,OAAAnzC,S;;AAHrC;;;uBAGai4B,e,EAAe,qB,EAAA,YAoDJ,QAAA6a,cApDI,C;AAoDU,K;;;aApDzB7a,e;AAAe,eAAfA,eAAe,K;AAAA,kBAFZ;;;;;2BAEHA,e,EAAe;cAH3B,OAAAxgB,UAG2B;eAHhB;AACR6I,oBAAU,EAAE;AADJ,S;AAGgB,Q;;;;gBAqDMyyB,c;AAAc;kBAD/B,OAAAU,MAC+B;mBADxB,QAAAX,c;AACwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/HhD;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACFA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAiDa,YAAAY,eAAA,GAA6C;AACtD/tC,cAAQ,EAAE;AAD4C,KAA7C;AAoDb;;;;;;AAKA,QAAYuf,aAAZ;;AAAA,eAAYA,aAAZ,EAAyB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH,KAnBD,EAAYA,aAAa,GAAb,QAAAA,aAAA,aAAAA,aAAA,GAAa,EAAb,CAAZ;;AAqBA,QAAYyuB,eAAZ;;AAAA,eAAYA,eAAZ,EAA2B;AACvB;AACA;AACA;AACA;AACA;AACA;AACH,KAPD,EAAYA,eAAe,GAAf,QAAAA,eAAA,aAAAA,eAAA,GAAe,EAAf,CAAZ;;AAQA,QAAYC,WAAZ;;AAAA,eAAYA,WAAZ,EAAuB;AACnB;AACA;AACA;AACA;AACA;AACA,8DANmB,CAOnB;;AACA;AACA;AACA;AACH,KAXD,EAAYA,WAAW,GAAX,QAAAA,WAAA,aAAAA,WAAA,GAAW,EAAX,CAAZ;;AAaA,QAAMC,WAAW,GAAG,EAApB;;QAEa9rB,K;;;;;AAkET,uBAAoC;AAAA;;AAAA,YAAxBvH,QAAwB,uEAAJ,EAAI;;AAAA;;;;AAChC,sCAAMA,QAAN;AAtDJ;;AACO,gBAAA0X,YAAA,GAAwB,KAAxB;AACP;;AACO,gBAAA4b,0BAAA,GAAsC,KAAtC;AAOP;;;AAEO,gBAAAC,UAAA,GAAuB,EAAvB;AAEP;;;AAEO,gBAAAC,SAAA,GAAsB,EAAtB,CAqC6B,CAGhC;;AACA,YAAM/xB,eAAe,GAAG,wBAAAH,cAAA,CAAeC,UAAf,CAA0B,mBAAAkW,eAA1B,CAAxB;AACA,gBAAKC,YAAL,GAAoB,CAAC,EAACjW,eAAe,SAAf,IAAAA,eAAe,WAAf,GAAe,MAAf,GAAAA,eAAe,CAAEQ,SAAlB,CAArB;AACA,gBAAKqxB,0BAAL,GAAkC,CAAA7xB,eAAe,SAAf,IAAAA,eAAe,WAAf,GAAe,MAAf,GAAAA,eAAe,CAAEgyB,eAAjB,KAAoC,KAAtE;AAEA,YAAMC,iBAAiB,GAAG1zB,QAAQ,CAAC7f,IAAT,IAAiB6f,QAAQ,CAACxK,KAA1B,IAAmC,cAA7D;AACA,YAAMm+B,eAAe,GAAG;AACpBC,mBAAS,EAAEF;AADS,SAAxB;AAGA;;;;;;;;;AAQA;;;;;;;;AAOA,gBAAKn2B,QAAL,GAAgByC,QAAQ,CAACzC,QAAT,IAAqBo2B,eAArC;AACA,gBAAK9nC,OAAL,GAAemU,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEnU,OAAzB,CA5BgC,CA6BhC;;AACA,gBAAKyc,QAAL,GAAgBtI,QAAQ,CAACsI,QAAT,IAAqB,KAArC;AACA,gBAAKmC,QAAL,GAAgBzK,QAAQ,CAACyK,QAAT,IAAqB,CAArC;AACA,gBAAKopB,WAAL,GAAmB7zB,QAAQ,CAAC6zB,WAA5B;AACA,gBAAKnsB,KAAL,GAAa1H,QAAQ,CAAC0H,KAAT,YAA0BvW,KAA1B,GAAkC6O,QAAQ,CAAC0H,KAA3C,GAAmD,EAAhE,CAjCgC,CAkChC;;AACA,gBAAKosB,QAAL,GAAgB9zB,QAAQ,CAAC8zB,QAAT,IAAqB,EAArC;AACA,gBAAKC,cAAL,GAAsB,OAAA/zB,QAAQ,CAACzC,QAAT,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEw2B,cAAnB,KAAqC,EAA3D;AAEN,gBAAKC,SAAL,GAAiBh0B,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEg0B,SAA3B;AACM,gBAAKC,WAAL,GAAmBj0B,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEi0B,WAA7B;AACA,gBAAKnK,MAAL,GAAc,CAAA9pB,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAE8pB,MAAV,MAAgB,MAAI9pB,QAAQ,CAACzC,QAAb,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAEusB,MAAvC,KAAiD,EAA/D;AACA,gBAAKyJ,UAAL,GAAkB,CAAAvzB,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEuzB,UAAV,KAAwB,EAA1C;AACA,gBAAKC,SAAL,GAAiB,CAAAxzB,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEwzB,SAAV,KAAuB,EAAxC;AA1CgC;AA4CnC;AA7DD;;;;;;AA2MA;;;gCAGY;AACR,iBAAO,IAAIjsB,KAAJ,CAAU,IAAV,CAAP;AACH;AAED;;;;;;oCAGgB;AACZ,cAAMD,KAAK,GAAG,MAAH,OAAG,CAAH,EAAG,EAAK,IAAL,CAAd;AACAA,eAAK,CAAC/J,QAAN,CAAepJ,QAAf,GAA0B,EAA1B,CAFY,CAEkB;;AAC9B,iBAAO,IAAIoT,KAAJ,CAAU,MAAD,OAAC,CAAD,kBAAMD,KAAN,CAAC,EAAU;AAAEjR,cAAE,EAAE,IAAN;AAAYb,iBAAK,EAAE;AAAnB,WAAV,CAAV,CAAP;AACH;AAED;;;;;;;iCAIgBwR,O,EAAgC;AAC5C,cAAI,CAAC,KAAK1G,QAAN,IAAkB,CAAC,KAAKgP,KAA5B,EAAmC;AAC/B,mBAAO;AAAEvG,0BAAY,EAAE,IAAhB;AAAsBf,kBAAI,EAAE;AAA5B,aAAP;AACH;;AAED,cAAMP,QAAQ,GAAG,KAAKiQ,YAAL,GAAoB,KAAKpI,KAAL,CAAWmb,WAA/B,GAA6C,KAAKhjB,QAAnE;;AAEA,cAAI,CAACA,QAAL,EAAe;AACX,mBAAO;AAAEsB,0BAAY,EAAE,IAAhB;AAAsBf,kBAAI,EAAE;AAA5B,aAAP;AACH;;AAT2C,cAUpCjjB,MAVoC,GAUTiiB,OAVS,CAUpCjiB,MAVoC;AAAA,cAU5BI,QAV4B,GAUT6hB,OAVS,CAU5B7hB,QAV4B;AAAA,cAUlBuY,IAVkB,GAUTsJ,OAVS,CAUlBtJ,IAVkB;AAW5C,cAAMiK,KAAK,GAAe,kBAAAC,aAAA,CAAc;AACpCha,gBAAI,EAAE7I,MAAM,CAACgJ,EADuB;AAEpC5I,oBAAQ,EAARA,QAFoC;AAGpCmiB,iBAAK,EAAE,IAH6B;AAIpCtK,gBAAI,EAAEU,IAJ8B;AAKpCiK,iBAAK,EAAEF,QAAQ,CAACI;AALoB,WAAd,CAA1B;AAOA,iBAAOF,KAAP;AACH;AAED;;;;;;;kCAIiBX,O,EAAkC;AAC/C,cAAMW,KAAK,GAAG,KAAKusB,QAAL,CAAcltB,OAAd,CAAd;AACA,iBAAO,CAACW,KAAK,CAACoB,YAAd;AACH;AAED;;;;;;iCAGa;AACT,iBAAO,MAAP,OAAO,CAAP,oFAAO,EAAmB;AAAExL,oBAAQ,EAAE,MAAF,OAAE,CAAF,kBAAO,KAAKA,QAAZ,CAAE,EAAkB;AAAEpJ,sBAAQ,EAAE;AAAZ,aAAlB,CAAZ;AAAgDtI,mBAAO,EAAE,MAAF,OAAE,CAAF,EAAE,EAAK,KAAKA,OAAV,CAAzD;AAA8E2nC,qBAAS,qBAAO,KAAKA,SAAZ;AAAvF,WAAnB,CAAP;AACH;;;4BAjQwB;AACrB,iBAAO,wBAAAlyB,cAAA,CAAeC,UAAf,CAA0B,eAAAopB,QAA1B,CAAP;AACH;AAED;;;;4BACsB;AAAA;;;;AAClB,iBAAO,CAAP,KAAO,KAAKrqB,QAAL,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEpH,SAAF,CAAYtR,IAAZ,CAAiB,UAAC4iC,GAAD,EAAS;AAC1C,mBAAO,OAAI,CAAC9iB,KAAL,CAAWxJ,QAAX,CAAoBssB,GAAG,CAACn0B,EAAxB,CAAP;AACH,WAFmB,CAApB;AAGH;AAED;;;;4BACsB;;;AAClB,iBAAO,CAAP,KAAO,KAAKoR,QAAL,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEze,QAAtB;AACH;AAgDD;;;;;;;4BAIsB;AAClB,iBAAO,KAAK7I,IAAL,IAAa,EAApB;AACH;AAED;;;;;;;;4BAKqB;AACjB,iBAAO,KAAK8zC,WAAL,IAAoB,KAAK9zC,IAAzB,IAAiC,EAAxC,CADiB,CAC2B;AAC/C;;;4BAEyB;AACtB,iBAAO,KAAKsnB,QAAL,aAAmB,KAAKA,QAAL,CAAc2G,OAAjC,eAA6C,KAAK3G,QAAL,CAAc5N,IAA3D,IAAoE,EAA3E;AACH;AAED;;;;AAIA;AACA;AACA;;AAEA;;;;4BAC+B;;;AAC3B,cAAO2iB,QAAQ,SAAI,KAAK3wB,OAAT,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAE2wB,QAAjC;AACA,iBAAOA,QAAQ,GAAG,UAAH,GAAgB,UAA/B,CAF2B,CAEgB;AAC9C;AAED;;;;;;;;;4BAMoB;;;AAChB,iBAAO,CAAP,WAAO,KAAKjf,QAAZ,MAAoB,IAApB,IAAoB,aAApB,GAAoB,MAApB,GAAoB,GAAE0L,SAAf,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,EAAxB,GAA4B,KAAnC;AACH;;;4BAE0B;;;AACvB,cAAMkrB,KAAK,GAAG,IAAI,UAAA7+B,MAAJ,CAAW;AAAElR,gBAAI,EAAE,QAAA2C,QAAA,CAASqkB,GAAT,EAAR;AAAwBK,uBAAW,EAAE,KAArC;AAA4CC,uBAAW,EAAE,KAAK1iB;AAA9D,WAAX,EAAqF+E,EAAnG;AACA,cAAMqmC,eAAe,GAAG,CAAH,WAAG,KAAK72B,QAAR,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEpJ,QAAf,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAEnJ,MAAF,CAAU,UAAAqpC,GAAG,EAAI;AAC5D,gBAAMC,UAAU,GAAG,IAAI,UAAAh/B,MAAJ,CAAW;AAAElR,kBAAI,EAAEiwC,GAAG,CAACn+B,WAAJ,GAAkB,IAA1B;AAAgCuV,yBAAW,EAAE,KAA7C;AAAoDC,yBAAW,EAAE2oB,GAAG,CAACrrC;AAArE,aAAX,EAA2F+E,EAA9G;AACA,gBAAMwmC,QAAQ,GAAG,IAAI,UAAAj/B,MAAJ,CAAW;AAAElR,kBAAI,EAAEiwC,GAAG,CAACz+B,SAAJ,GAAgB,IAAxB;AAA8B6V,yBAAW,EAAE,KAA3C;AAAkDC,yBAAW,EAAE2oB,GAAG,CAACrrC;AAAnE,aAAX,EAAyF+E,EAA1G;AACC,mBAAOumC,UAAU,IAAIH,KAAd,IAAuBI,QAAQ,IAAIJ,KAA1C;AACJ,WAJ8C,CAA/C,CAFuB,CAOvB;AACA;;AACA,iBAAO,CAAC,CAACC,eAAe,CAAC9tC,MAAzB;AACH;AAED;;;;4BAC0B;;;AACtB,iBAAO,CAAP,KAAO,KAAKiX,QAAL,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEulB,eAAtB;AACH;AAED;;;;4BACmB;yBAAA,CACf;;;AACA,cAAI,CAAC,KAAKpL,YAAN,IAAsB,CAAC,KAAK4b,0BAAhC,EAA4D;AACxD,mBAAOD,WAAP;AACH;;AAED,cAAI,CAAJ,WAAI,KAAK91B,QAAT,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEpJ,QAAf,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAE7N,MAA7B,EAAqC;AACjC;;;;;;;;AAQA,gBAAMkuC,iBAAiB,GAAI,IAAIjtB,KAAJ,CAAU,KAAK/G,MAAL,EAAV,CAA3B;AACA,mBAAO,CAAP,KAAO,KAAKjD,QAAL,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEpJ,QAAF,CAAWlK,GAAX,CAAe,UAAAuC,CAAC,EAAI;AACpCA,eAAC,CAACuqB,IAAF,GAASyd,iBAAT;AACA,qBAAOhoC,CAAP;AACH,aAHmB,CAApB;AAIH;;AACD,iBAAO6mC,WAAP;AACH;AAED;;;;;;;4BAIuB;;;AACnB,iBAAO,YAAKxnC,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAEquB,QAAd,MAAsB,MAAI,KAAK3c,QAAT,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAE2c,QAAzC,KAAqD,KAA5D;AACH;AAEA;;;;;;4BAGuB;qBAAA,CACpB;;;AACA,cAAMua,QAAQ,GAAGtjC,KAAK,CAACsB,OAAN,CAAc,KAAKuhC,SAAnB,IAAiC,KAAKA,SAAtC,GAAkD,CAAC,KAAKA,SAAN,CAAnE;AACA,cAAMF,QAAQ,GAAG,6BACN,KAAKA,QAAL,CAAc1tC,KAAd,CAAoB,GAApB,CADM,sBAEN,CAAH,KAAG,KAAK2tC,cAAL,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAE3tC,KAAF,CAAQ,GAAR,CAFb,sBAINquC,QAJM,sBAKN,SAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMlB,UALA,sBAMN,SAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMC,SANA,IAQT,CAAC,CAAD,KAAC,KAAK3nC,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAE6oC,aAAf,KAAiChwB,aAAa,CAACW,YAA/C,IAA+Dhf,SARtD,GAWX2E,MAXW,CAWJ,UAAAe,CAAC;AAAA,mBAAI,CAAC,CAACA,CAAN;AAAA,WAXG,EAWM9B,GAXN,CAWU,UAAA8B,CAAC;AAAA,mBAAIA,CAAC,CAACD,WAAF,EAAJ;AAAA,WAXX,CAAjB,CAHoB,CAepB;;AACA,oCAAY,IAAI6oC,GAAJ,CAAQb,QAAR,CAAZ;AACH;AAED;;;;4BACgB;AACZ,cAAMjiB,OAAO,GAAG,wBAAAvQ,cAAA,CAAeC,UAAf,CAA0B,eAAA2oB,YAA1B,CAAhB;AACA,iBAAO,CAACrY,OAAO,GAAGA,OAAO,CAACuY,WAAR,CAAoB,KAAK1iB,KAAzB,CAAH,GAA4C,IAApD,KAA6D,IAAI,eAAAyiB,aAAJ,CAAkB,EAAlB,CAApE;AACH;AAED;;;;;;4BAGkC;;;AAC9B,iBAAO,YAAK5sB,QAAL,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEq3B,uBAAf,KAA0C,EAAjD;AACH;;;4BAE8B;;;AAC3B,cAAG,SAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMA,uBAAT,EAAkC;AAC9B,mBAAO,CAAP,KAAO,SAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMA,uBAAN,MAA6B,IAA7B,IAA6B,aAA7B,GAA6B,MAA7B,GAA6B,GAAE5pC,MAAF,CAAS,UAAAukC,MAAM;AAAA,qBAAIA,MAAM,CAACtmB,SAAX;AAAA,aAAf,EAAqC3iB,MAAzE;AACH;AACJ;;;4BAE0B;AACvB,iBAAO,SAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMsuC,uBAAN,CAA8BtuC,MAArC;AACH;;;;MA1PsB,iBAAAyZ,a;;AAA3B;;;;;;;;;;;;;;;;;;;;AC/JA;AAAA;AAAA;;AAEA,aAAgB80B,0BAAhB,CAA2C7tB,OAA3C,EAA6E;AACzE,UAAIxP,KAAK,GAAY,EAArB;;AACA,UAAIwP,OAAJ,EAAa;AACTxP,aAAK,GAAG,MAAH,OAAG,CAAH,EAAG,EAAKwP,OAAL,CAAR;;AACA,YAAIA,OAAO,CAACjiB,MAAZ,EAAoB;AAChB,cAAMX,IAAI,GAAG4iB,OAAO,CAACjiB,MAAR,CAAe+I,YAAf,CAA4B,QAA5B,CAAb;AACA0J,eAAK,CAAC0d,cAAN,GAAuB9wB,IAAI,CAAC0R,OAA5B,CAFgB,CAEqB;;AACrC0B,eAAK,CAAC2d,YAAN,GAAqB/wB,IAAI,CAACa,QAAL,CAAc;AAAEJ,mBAAO,EAAEmiB,OAAO,CAAC7hB,QAAR,IAAoB;AAA/B,WAAd,EAAmD0Q,aAAnD,CAAiE;AAAEC,mBAAO,EAAE;AAAX,WAAjE,EAAiFA,OAAtG;AAEA,cAAIkR,OAAO,CAAClI,KAAZ,EAAmBtH,KAAK,CAACsH,KAAN,GAAckI,OAAO,CAAClI,KAAtB;AACnB,cAAIkI,OAAO,CAACgL,SAAZ,EAAuBxa,KAAK,CAACwa,SAAN,GAAkBhL,OAAO,CAACgL,SAA1B;AAEvB,iBAAOxa,KAAK,CAACzS,MAAb;AACA,iBAAOyS,KAAK,CAACrS,QAAb;AACH;;AAED,YAAI,CAAC6hB,OAAO,CAAC0D,YAAb,EAA2B,OAAOlT,KAAK,CAACkT,YAAb;AAE3B,YAAI1D,OAAO,CAAC8tB,aAAZ,EAA2Bt9B,KAAK,CAACs9B,aAAN,GAAsB9tB,OAAO,CAAC8tB,aAA9B;AAC3Bt9B,aAAK,GAAG,mBAAAujB,sBAAA,CAAuBvjB,KAAvB,CAAR;AACH;;AACD,aAAOA,KAAP;AACH;;AAtBD;AAwBA;;;;;;AAKA,aAAgBlL,IAAhB,CAAqBqP,KAArB,EAAmCnX,MAAnC,EAAyE;AAAA,UAAvBuwC,IAAuB,uEAAJ,EAAI;AACrE,UAAMvK,GAAG,GAAGuK,IAAI,CAACntC,IAAL,CAAU,UAAA4iC,GAAG;AAAA,eAAI7uB,KAAK,CAAC+L,KAAN,CAAYxJ,QAAZ,CAAqBssB,GAAG,CAACn0B,EAAzB,CAAJ;AAAA,OAAb,CAAZ;AACA,UAAM2+B,KAAK,GAAGD,IAAI,CAACntC,IAAL,CAAU,UAAA4iC,GAAG;AAAA,eAAIhmC,MAAM,CAACkjB,KAAP,CAAaxJ,QAAb,CAAsBssB,GAAG,CAACn0B,EAA1B,CAAJ;AAAA,OAAb,CAAd;;AACA,UAAIm0B,GAAJ,EAAS;AACL,YAAIA,GAAG,KAAKwK,KAAZ,EAAmB;AACf,iBAAQxK,GAAG,CAACrqC,IAAL,CAAWsM,aAAX,CAAyBuoC,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAE70C,IAAhC,CAAP;AACH;;AACD,YAAMwsC,UAAU,GAAG,mBAAInC,GAAG,CAACmC,UAAR,EAAoBj6B,OAApB,EAAnB;;AAJK,qDAKiBi6B,UALjB;AAAA;;AAAA;AAKL,oEAAkC;AAAA,gBAAvBtsB,OAAuB;;AAC9B,gBAAIA,OAAO,KAAK,GAAhB,EAAqB;AACjB;AACH;;AACD,gBAAM40B,UAAU,GAAGt5B,KAAK,CAAC+L,KAAN,CAAYlgB,OAAZ,CAAoB6Y,OAApB,KAAgC,CAAnD;AACA,gBAAM60B,UAAU,GAAG1wC,MAAM,CAACkjB,KAAP,CAAalgB,OAAb,CAAqB6Y,OAArB,KAAiC,CAApD;;AACA,gBAAI40B,UAAU,IAAI,CAACC,UAAnB,EAA+B;AAC3B,qBAAO,CAAP;AACH,aAFD,MAEO,IAAIA,UAAU,IAAI,CAACD,UAAnB,EAA+B;AAClC,qBAAO,CAAC,CAAR;AACH;AACJ;AAhBI;AAAA;AAAA;AAAA;AAAA;AAiBR;;AACD,aAAOt5B,KAAK,CAACxb,IAAN,CAAWsM,aAAX,CAAyBjI,MAAM,CAACrE,IAAhC,CAAP;AACH;;AAtBD;;;;;;;;;;;;;;;;;;;;;;;;ACtCA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;AAIA,QAAIg1C,UAAU,GAAG,EAAjB;;AAEA,aAAgB3b,SAAhB,CAA0BnjB,EAA1B,EAAsC;AAClC,aAAO8+B,UAAU,CAACvtC,IAAX,CAAgB,UAACgU,CAAD;AAAA,eAAOA,CAAC,CAACvF,EAAF,KAASA,EAAT,IAAeuF,CAAC,CAACpG,KAAF,KAAYa,EAAlC;AAAA,OAAhB,CAAP;AACH;;AAFD;;QAOa++B,a;;;;;AACT,6BACc/5B,SADd,EAEY8X,IAFZ,EAGY7S,QAHZ,EAIImB,eAJJ,EAIoC;AAAA;;AAAA;;AAGhC,sCAAMpG,SAAN,EAAiBoG,eAAjB;AANU,gBAAApG,SAAA,GAAAA,SAAA;AACF,gBAAA8X,IAAA,GAAAA,IAAA;AACA,gBAAA7S,QAAA,GAAAA,QAAA;AAqHZ;;;;;;;AAMO,gBAAA+0B,UAAA,GAAa;AAAA,cAAC79B,KAAD,uEAAkB,EAAlB;AAAA,gKAAoEA,KAApE;AAAA,SAAb;;AAOA,gBAAAwd,YAAA,GAAe;AAAA,cAACxd,KAAD,uEAAkB,EAAlB;AAAA,6JAAkFA,KAAlF;AAAA,SAAf;;AACA,gBAAA89B,WAAA,GAAc,UAACj/B,EAAD,EAAa2L,SAAb;AAAA,cAAiCyB,uBAAjC,uEAAoE,KAApE;AAAA,cAA2EnB,YAA3E,uEAAmG,EAAnG;AAAA,8JAAoKjM,EAApK,EAAwK2L,SAAxK,EAAmLyB,uBAAnL,EAA4MnB,YAA5M;AAAA,SAAd;;AACA,gBAAAizB,iBAAA,GAAoB,UAAC7xB,WAAD,EAAsB1B,SAAtB;AAAA,cAA0CyB,uBAA1C,uEAA6E,KAA7E;AAAA,cAAoFnB,YAApF,uEAA4G,EAA5G;AAAA,qKAAgLoB,WAAhL,EAA6L1B,SAA7L,EAAwMyB,uBAAxM,EAAiOnB,YAAjO;AAAA,SAApB;;AA/HH,gCAAAhB,cAAA,CAAesiB,UAAf,CAA0B,cAAArc,KAA1B;AACA,gBAAKzF,KAAL,GAAa,OAAb;AACA,gBAAKC,UAAL,GAAkB,OAAlB;;AACA,gBAAKH,QAAL,GAAgB,UAACrV,CAAD,EAAIC,CAAJ;AAAA,iBACZ,CAACD,CAAC,CAAC8J,EAAF,CAAK5J,aAAL,CAAmBD,CAAC,CAAC6J,EAArB,CAAD,IAA6B,CAAC9J,CAAC,CAACiJ,KAAF,CAAQ/I,aAAR,CAAsBD,CAAC,CAACgJ,KAAxB,CADlB;AAAA,SAAhB;;AAEA,gBAAKqM,YAAL,GAAoB,UAACtV,CAAD,EAAc;AAC9B,cAAMi+B,GAAG,GAAG,QAAKrX,IAAL,CAAU1L,QAAtB;AACA,iBAAOlb,CAAC,CAAC+iB,KAAF,CAAQmb,WAAR,KAAwBD,GAAG,CAACn0B,EAAnC;AACH,SAHD;;AAIA,gBAAK8c,IAAL,CAAUxW,WAAV,CACKzH,IADL,CACU,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,iBAAOA,CAAP;AAAA,SAAN,CADV,EAEKvZ,SAFL,CAEe;AAAA,iBAAM,QAAKua,IAAL,EAAN;AAAA,SAFf;;AAbgC;AAgBnC;;;;gCAEgE;AAAA;;AAAA,cAA9CpF,MAA8C,uEAA7B,EAA6B;;AAAA,cAAzBg+B,OAAyB,uEAAP,KAAO;;;;;;;;;;;;;;;;;AAChD,2BAAM,OAAMh+B,KAAN,CAAW,IAAX,CAAW,IAAX,EAAYA,MAAZ,CAAN;;;AAAPlV,wB;;AACN,wBAAMkV,MAAK,CAACzX,cAAN,CAAqB,OAArB,KAAiCyX,MAAK,CAAC+K,KAAN,KAAgB,KAAlD,IAA4D,CAACnR,MAAM,CAACpH,IAAP,CAAYwN,MAAZ,EAAmBlR,MAAhF,IAA0FkvC,OAA/F,EAAwG;AACpG,2BAAKzxC,GAAL,CAAS,MAAT,EAAiBzB,IAAjB;AACA6yC,gCAAU,GAAG7yC,IAAb;AACH;;uDACMA,I;;;;;;;;;AACV;;;8CAE4BA,I,EAAe;AACxC,iBAAOA,IAAI,CAAC0I,MAAL,CAAY,UAACvI,CAAD,EAAO;;;AACtB,gBAAI,CAAJ,KAAIA,CAAC,CAACmyC,uBAAF,MAAyB,IAAzB,IAAyB,aAAzB,GAAyB,MAAzB,GAAyB,GAAEtuC,MAA/B,EAAuC,OAAO7D,CAAP,CADjB,CAC2B;;AACjD,mBAAOA,CAAC,CAACwmB,SAAT;AACH,WAHM,CAAP;AAIH;AAED;;;;;;;kCAKIjC,O,EACA6c,Q,EACsB;AAAA;;AAAA,cAAtB74B,MAAsB,uEAAJ,IAAI;;AAEtB,cAAI,CAACgc,OAAL,EAAc;AACV,kBAAM,IAAIxmB,KAAJ,CAAU,4CAAV,CAAN;AACH;;AAED,cAAM4qB,GAAG,GAAG,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAZ;;AACA,cAAI,CAACgjB,OAAO,CAACjiB,MAAb,EAAqB;AACjBiiB,mBAAO,CAACjiB,MAAR,GAAiBqmB,GAAG,CAACtd,YAAJ,CAAiB,QAAjB,CAAjB;AACH;;AAED,cAAIkZ,OAAO,CAAC8tB,aAAR,KAA0BzuC,SAA9B,EAAyC;AACrC2gB,mBAAO,CAAC8tB,aAAR,GAAwB,IAAxB;AACH;;AAED,cAAMh1C,GAAG,uBAAgBknB,OAAO,CAAC3Q,EAAR,GAAa2Q,OAAO,CAAC3Q,EAArB,GAA0B,EAA1C,cACLwtB,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAAA,QAAA,GAAY,EADP,CAAT;;AAGA,cAAI,CAAC,KAAKliB,SAAL,CAAe7hB,GAAf,CAAL,EAA0B;AACtB,iBAAK6hB,SAAL,CAAe7hB,GAAf,IAAsB,IAAI2gB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACnD,kBAAMmjB,OAAO,GAAG,SAAVA,OAAU,CAACxhC,IAAD,EAAmB;AAC/B,uBAAO,OAAI,CAACqf,SAAL,CAAe7hB,GAAf,CAAP;AACA4gB,uBAAO,CAAC1V,MAAM,GAAG,OAAI,CAACyqC,qBAAL,CAA2BnzC,IAA3B,CAAH,GAAsCA,IAA7C,CAAP;AACH,eAHD;;AAIA,kBAAMugB,KAAK,GAAG,SAARA,KAAQ,CAACpU,CAAD,EAAO;AACjBkS,sBAAM,CAAClS,CAAD,CAAN;AACA,uBAAO,OAAI,CAACkT,SAAL,CAAe7hB,GAAf,CAAP;AACH,eAHD;;AAIA,kBAAM0X,KAAK,GAAG,kBAAAq9B,0BAAA,CAA2B7tB,OAA3B,CAAd;;AACA,kBAAIA,OAAO,CAAC3Q,EAAZ,EAAgB;AACZ,uBAAI,CAACghB,IAAL,CAAUrQ,OAAO,CAAC3Q,EAAlB,EAAsBmB,KAAtB,EAA6BsJ,IAA7B,CACI,UAACre,CAAD;AAAA,yBAAOqhC,OAAO,CAAC,CAACrhC,CAAD,CAAD,CAAd;AAAA,iBADJ,EAEIogB,KAFJ;AAIH,eALD,MAKO;AACH,uBAAI,CAACrL,KAAL,CAAWA,KAAX,EAAkBsJ,IAAlB,CAAuBgjB,OAAvB,EAAgCjhB,KAAhC;AACH;AACJ,aAlBqB,CAAtB;AAmBH;;AAED,iBAAO,KAAKlB,SAAL,CAAe7hB,GAAf,CAAP;AACH;AAED;;;;;;+BAGoB;;;;;;;;;AACVud,2B,GACF,KAAKiD,QAAL,CAAcxG,GAAd,CAAkB,SAAlB,KAAgC,E;;AACpC,wBAAI,CAACuD,OAAO,CAACoJ,MAAb,EAAqB;AACjBpJ,6BAAO,CAACoJ,MAAR,GAAiB;AACb1K,+BAAO,EAAE,oBADI;AAEb5c,6BAAK,EAAE;AAFM,uBAAjB;;AAIA,2BAAKmhB,QAAL,CAAcvc,GAAd,CAAkB,SAAlB,EAA6BsZ,OAA7B;AACH,qB,CACD;;;AACMsR,0B,GAAS;AACXsG,8BAAQ,EAAE,KAAK9B,IAAL,CAAU1L,QAAV,CAAmBpR;AADlB,qB;;AAGf,2BAAM,KAAKmB,KAAL,CAAWmX,MAAX,EAAmB,IAAnB,WAA+B,YAAM;AACvCtR,6BAAO,CAACoJ,MAAR,GAAiB;AAAE1K,+BAAO,EAAE,oBAAX;AAAiC5c,6BAAK,EAAE;AAAxC,uBAAjB;;AACA,6BAAI,CAACmhB,QAAL,CAAcvc,GAAd,CAAkB,SAAlB,EAA6BsZ,OAA7B;AACH,qBAHK,CAAN;;;AAIAA,2BAAO,CAACoJ,MAAR,GAAiB;AAAE1K,6BAAO,EAAE,oBAAX;AAAiC5c,2BAAK,EAAE;AAAxC,qBAAjB;;AACA,yBAAKmhB,QAAL,CAAcvc,GAAd,CAAkB,SAAlB,EAA6BsZ,OAA7B;;;;;;;;;AACH;AAED;;;;;;;gCAIe2C,Q,EAAiB;AAC5B,iBAAO,IAAI,cAAAuH,KAAJ,CAAUvH,QAAV,CAAP;AACH;;;qCASmB1d,I,EAAM;AACtB,eAAKyB,GAAL,CAAS,MAAT,EAAiBzB,IAAjB;AACA6yC,oBAAU,GAAG7yC,IAAb;AACH;;;yCAMuB;AACpB,eAAK4c,IAAL,GAAY4B,IAAZ,CAAiB,UAAClF,CAAD;AAAA,mBAAO,IAAP;AAAA,WAAjB;AACH;;;;MA5I8B,eAAA4F,c;;AAHnC;;;uBAGa4zB,a,EAAa,+B,EAAA,mC,EAAA,kC,EAAA,+B;AAAA,K;;;aAAbA,a;AAAa,eAAbA,aAAa,K;AAAA,kBAFV;;;;;2BAEHA,a,EAAa;cAHzB,OAAAn+B,UAGyB;eAHd;AACR6I,oBAAU,EAAE;AADJ,S;AAGc,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzB1B;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAOA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA41B,SAAK,CAAC/iC,IAAN,CAAW,IAAX;AAEA,QAAIgjC,OAAJ;AAWA;;AAEA,aAAgBC,+BAAhB,GAA+C;AAC3C,aAAO,MAAP,OAAO,CAAP;AACIxL,mBAAW,EAAEyL,IAAI,CAACz1C,EAAL,EADjB;AAEIuC,cAAM,EAAEkzC,IAAI,CAACz1C,EAAL,EAFZ;AAGIutC,wBAAgB,EAAEkI,IAAI,CAACz1C,EAAL,EAHtB;AAIIuc,mBAAW,EAAE,OAAAmG,EAAA,CAAG,IAAH,CAJjB;AAKI2E,gBAAQ,EAAE,IAAI,eAAAkjB,QAAJ,CAAamL,oBAAoB,CAAC;AAAEz/B,YAAE,EAAE;AAAN,SAAD,CAAjC,CALd;AAMIgE,4BAAoB,EAAEw7B,IAAI,CAACz1C,EAAL,EAN1B;AAOIiuC,wCAAgC,EAAEwH,IAAI,CAACz1C,EAAL,EAPtC;AAQI21C,kCAA0B,EAAEF,IAAI,CAACz1C,EAAL;AARhC,OAAO,EASA41C,uBAAuB,CAAC,qBAAD,CATvB,CAAP;AAWH;;AAZD;;AAca,YAAAC,yBAAA,GAA4B;AAAA,aAAgB,MAAD,OAAC,CAAD;AACpDhtB,iBAAS,EAAE4sB,IAAI,CAACz1C,EAAL;AADyC,OAAC,EAElD41C,uBAAuB,CAAC,eAAD,CAF2B,CAAhB;AAAA,KAA5B;;AAKA,YAAAE,wBAAA,GAA2B;AAAA,aAAgB,MAAD,OAAC,CAAD;AACnDC,uBAAe,EAAEN,IAAI,CAACz1C,EAAL;AADkC,OAAC,EAEjD41C,uBAAuB,CAAC,cAAD,CAF0B,CAAhB;AAAA,KAA3B;;AAKA,YAAAI,YAAA,GAAe;AAAA,aAAO;AAC/BjiC,gBAAQ,EAAE,OAAA2O,EAAA,CAAG,EAAH,CADqB;AAE/BkR,gBAAQ,EAAE,OAAAlR,EAAA,CAAG,EAAH,CAFqB;AAG/B0R,qBAAa,EAAE,OAAA1R,EAAA,CAAG,EAAH,CAHgB;AAI/B6R,sBAAc,EAAE,OAAA7R,EAAA,CAAG,EAAH,CAJe;AAK/BuzB,eAAO,EAAER,IAAI,CAACz1C,EAAL,EALsB;AAM/Bk2C,eAAO,EAAET,IAAI,CAACz1C,EAAL,EANsB;AAO/Bm2C,kBAAU,EAAEV,IAAI,CAACz1C,EAAL,EAPmB;AAQ/BqH,WAAG,EAAEouC,IAAI,CAACz1C,EAAL,EAR0B;AAS/BiN,eAAO,EAAEwoC,IAAI,CAACz1C,EAAL,EATsB;AAU/Bo2C,cAAM,EAAEX,IAAI,CAACz1C,EAAL,EAVuB;AAW/Bq2C,oBAAY,EAAEZ,IAAI,CAACz1C,EAAL,EAXiB;AAY/Bs2C,yBAAiB,EAAEb,IAAI,CAACz1C,EAAL,EAZY;AAa/Bu2C,wBAAgB,EAAEd,IAAI,CAACz1C,EAAL,EAba;AAc/Bw2C,gCAAwB,EAAEf,IAAI,CAACz1C,EAAL,EAdK;AAe/BszB,qBAAa,EAAE,OAAA5Q,EAAA,CAAG,EAAH;AAfgB,OAAP;AAAA,KAAf;;AAkBb,QAAM+zB,QAAQ,GAAG;AACb9lB,WAAK,EAAE,oBADM;AAEbgV,iBAAW,EAAE,4DAFA;AAGbjT,gBAAU,EAAE,OAHC;AAIbgkB,gBAAU,EAAE;AACRztC,YAAI,EAAE,KADE;AAERsnB,WAAG,EAAE,qBAFG;AAGRomB,kBAAU,EAAE;AAHJ,OAJC;AASbC,eAAS,EAAE;AACP3tC,YAAI,EAAE,KADC;AAEPsnB,WAAG,EAAE,6BAFE;AAGPomB,kBAAU,EAAE;AAHL,OATE;AAcbE,aAAO,EAAE;AACLh4B,cAAM,EAAE,UADH;AAELi4B,iBAAS,EAAE,IAFN;AAGLC,qBAAa,EAAE,IAHV;AAILC,4BAAoB,EAAE,IAJjB;AAKLC,mBAAW,EAAE;AALR;AAdI,KAAjB;AAuBa,YAAAC,aAAA,GAA+C;AACxD1tC,WAAK,EAAE,IADiD;AAExD0T,cAAQ,EAAE;AACNK,cAAM,EAAE,EADF;AAENM,aAAK,EAAE,OAFD;AAGNT,gBAAQ,EAAE,EAHJ;AAINK,YAAI,EAAE,EAJA;AAKNE,kBAAU,EAAE,KALN;AAMNc,mBAAW,EAAE;AANP,OAF8C;AAUxD04B,SAAG,EAAEV,QAVmD;AAWxD14B,UAAI,EAAE,KAXkD;AAYxDiB,cAAQ,EAAE;AAZ8C,KAA/C;;AAeA,YAAAo4B,2BAAA,GAA8B;AAAA,UAACC,SAAD,uEAAyC,EAAzC;AAAA,aAAgD,IAAI,mBAAAhgB,eAAJ,CAAoB;AAAE/X,gBAAQ,EAAE;AAAA,iBAAMm2B,IAAI,CAACz1C,EAAL,EAAN;AAAA;AAAZ,OAApB,EACvF,IAAI,mBAAAmyC,cAAJ,CAAmB,MAAD,OAAC,CAAD,kBACX,QAAA+E,aADW,CAAC,EAEZG,SAFY,CAAnB,CADuF,CAAhD;AAAA,KAA9B;AAMb;;;;;AAGa,YAAAC,yBAAA,GAA4B;AAAA,UAACn6B,QAAD,uEAAwC,EAAxC;AAAA,aAAgD;AACrFo6B,eAAO,EAAE,mBAAArF,cAD4E;AAErFD,gBAAQ,EAAE,IAAI,mBAAAE,cAAJ,CAAmB,MAAD,OAAC,CAAD,kBACrB,QAAA+E,aADqB,CAAC,EAEtB/5B,QAFsB,CAAnB;AAF2E,OAAhD;AAAA,KAA5B;AAQb;;;;;AAGA,aAAgBq6B,sBAAhB,GAA2F;AAAA,UAApDC,iBAAoD,uEAAJ,EAAI;AACvFlC,aAAO,GAAG;AACNn2B,eAAO,EAAEq2B,IAAI,CAACz1C,EAAL,EADH;AAENqc,cAAM,EAAEo5B,IAAI,CAACz1C,EAAL,EAFF;AAGN03C,kBAAU,EAAEjC,IAAI,CAACz1C,EAAL,EAHN;AAIN23C,kBAAU,EAAElC,IAAI,CAACz1C,EAAL,EAJN;AAKN43C,qBAAa,EAAEnC,IAAI,CAACz1C,EAAL,EALT;AAMN63C,mBAAW,EAAEpC,IAAI,CAACz1C,EAAL,EANP;AAONgJ,WAAG,EAAEysC,IAAI,CAACz1C,EAAL,EAPC;AAQN83C,gBAAQ,EAAErC,IAAI,CAACz1C,EAAL,EARJ;AASN+3C,oBAAY,EAAEtC,IAAI,CAACz1C,EAAL,EATR;AAUN0Z,WAAG,EAAE+7B,IAAI,CAACz1C,EAAL,EAVC;AAWNuC,cAAM,EAAEkzC,IAAI,CAACz1C,EAAL,EAXF;AAYN2D,WAAG,EAAE8xC,IAAI,CAACz1C,EAAL,EAZC;AAaNg4C,gBAAQ,EAAE;AAAEz4B,cAAI,EAAE;AAAEgE,iBAAK,EAAE;AAAT;AAAR,SAbJ;AAcN00B,eAAO,EAAE;AAAE11C,gBAAM,EAAEkzC,IAAI,CAACz1C,EAAL;AAAV,SAdH;AAeNk4C,aAAK,EAAE,QAAApC,wBAAA,EAfD;AAgBNhM,oBAAY,EAAE0L,+BAA+B,EAhBvC;AAiBN2C,iBAAS,EAAEvC,uBAAuB,CAAC,kBAAD,CAjB5B;AAkBNwC,YAAI,EAAExC,uBAAuB,CAAC,aAAD,CAlBvB;AAmBNyC,YAAI,EAAEzC,uBAAuB,CAAC,qBAAD,CAnBvB;AAoBN0C,cAAM,EAAE,QAAAzC,yBAAA,EApBF;AAqBN0C,gBAAQ,EAAE3C,uBAAuB,CAAC,iBAAD,CArB3B;AAsBN4C,eAAO,EAAE5C,uBAAuB,CAAC,gBAAD,CAtB1B;AAuBN6C,qBAAa,EAAE7C,uBAAuB,CAAC,sBAAD,CAvBhC;AAwBN8C,0BAAkB,EAAE9C,uBAAuB,CAAC,2BAAD,CAxBrC;AAyBN+C,gBAAQ,EAAE,QAAAvB,2BAAA,CAA4BK,iBAA5B,CAzBJ;AA0BNl7B,mBAAW,EAAE,OAAAmG,EAAA,CAAG,IAAH;AA1BP,OAAV;AA4BA,8BAAAxB,cAAA,CAAesiB,UAAf,CAA0B,iBAAA7jB,aAA1B,EAAyC41B,OAAO,CAAC6C,IAAjD;AACA,8BAAAl3B,cAAA,CAAesiB,UAAf,CAA0B,eAAAsG,YAA1B,EAAwCyL,OAAO,CAACzL,YAAhD;AACA,8BAAA5oB,cAAA,CAAesiB,UAAf,CAA0B,eAAA+G,QAA1B,EAAoCgL,OAAO,CAACzL,YAA5C;AACA,8BAAA5oB,cAAA,CAAesiB,UAAf,CAA0B,QAAAxL,IAA1B,EAAgCud,OAAO,CAAC2C,KAAxC;AACA,8BAAAh3B,cAAA,CAAesiB,UAAf,CAA0B,WAAA9a,OAA1B,EAAmC6sB,OAAO,CAACgD,QAA3C;AACA,8BAAAr3B,cAAA,CAAesiB,UAAf,CAA0B,SAAArc,KAA1B,EAAiCouB,OAAO,CAAC+C,MAAzC;AACA,8BAAAp3B,cAAA,CAAesiB,UAAf,CAA0B,WAAAiG,WAA1B,EAAuC8L,OAAO,CAAC4C,SAA/C;AACA,8BAAAj3B,cAAA,CAAesiB,UAAf,CAA0B,UAAAsM,MAA1B,EAAkCyF,OAAO,CAACiD,OAA1C;AACA,8BAAAt3B,cAAA,CAAesiB,UAAf,CAA0B,WAAA8B,YAA1B,EAAwCiQ,OAAO,CAACkD,aAAhD;AACA,8BAAAv3B,cAAA,CAAesiB,UAAf,CAA0B,WAAA0B,gBAA1B,EAA4CqQ,OAAO,CAACmD,kBAApD;AACAnD,aAAO,CAACzL,YAAR,CAAqBhxB,SAArB,GAAiC,CAACy8B,OAAO,CAACzL,YAAR,CAAqBziB,QAAtB,CAAjC;AACAkuB,aAAO,CAAC2C,KAAR,CAAcxZ,OAAd,GAAwB,IAAI,QAAA1G,IAAJ,CAAS4gB,gBAAgB,EAAzB,CAAxB;AACArD,aAAO,CAAC2C,KAAR,CAAc37B,WAAd,GAA4B,OAAAmG,EAAA,CAAG,IAAH,CAA5B;AACA6yB,aAAO,CAACgD,QAAR,CAAiBM,YAAjB,GAAgC,IAAI,OAAAp5C,eAAJ,CAAoB,IAAIsR,KAAJ,CAAU,EAAV,EAAc+nC,IAAd,CAAmB,CAAnB,EAAsBjvC,GAAtB,CAA0B,UAAA2R,CAAC;AAAA,eAAI,IAAI,WAAAkN,OAAJ,CAAYqwB,mBAAmB,EAA/B,CAAJ;AAAA,OAA3B,CAApB,CAAhC;AACAxD,aAAO,CAAChzC,MAAR,CAAey2C,eAAf,CAA+B,OAAAt2B,EAAA,CAAG,IAAH,EAAS,EAAT,CAA/B;AACA,aAAO6yB,OAAP;AACH;;AA7CD;;AA+CA,aAAgBK,uBAAhB,CAAwC71C,IAAxC,EAAsD;AAClD,UAAM0xB,OAAO,GAAG;AACZjqB,YAAI,EAAEiuC,IAAI,CAACz1C,EAAL,EADM;AAEZ4K,cAAM,EAAE6qC,IAAI,CAACz1C,EAAL,EAFI;AAGZuC,cAAM,EAAEkzC,IAAI,CAACz1C,EAAL,EAHI;AAIZ0Z,WAAG,EAAE+7B,IAAI,CAACz1C,EAAL,EAJO;AAKZ2D,WAAG,EAAE8xC,IAAI,CAACz1C,EAAL,EALO;AAMZof,eAAO,EAAEq2B,IAAI,CAACz1C,EAAL,EANG;AAOZoX,aAAK,EAAEq+B,IAAI,CAACz1C,EAAL,EAPK;AAQZi3B,YAAI,EAAEwe,IAAI,CAACz1C,EAAL,EARM;AASZqH,WAAG,EAAEouC,IAAI,CAACz1C,EAAL,EATO;AAUZi5C,YAAI,EAAExD,IAAI,CAACz1C,EAAL,EAVM;AAWZo2C,cAAM,EAAEX,IAAI,CAACz1C,EAAL,EAXI;AAYZ,kBAAQy1C,IAAI,CAACz1C,EAAL,EAZI;AAaZygB,cAAM,EAAEg1B,IAAI,CAACz1C,EAAL,EAbI;AAcZk5C,eAAO,EAAEzD,IAAI,CAACz1C,EAAL,EAdG;AAeZm5C,kBAAU,EAAE1D,IAAI,CAACz1C,EAAL,EAfA;AAgBZ8gB,YAAI,EAAE20B,IAAI,CAACz1C,EAAL,EAhBM;AAiBZ6oB,iBAAS,EAAE4sB,IAAI,CAACz1C,EAAL,EAjBC;AAkBZsiB,eAAO,EAAEmzB,IAAI,CAACz1C,EAAL,EAlBG;AAmBZ+iB,kBAAU,EAAE0yB,IAAI,CAACz1C,EAAL,EAnBA;AAoBZo5C,iBAAS,EAAE3D,IAAI,CAACz1C,EAAL,EApBC;AAqBZq5C,sBAAc,EAAE5D,IAAI,CAACz1C,EAAL,EArBJ;AAsBZs5C,cAAM,EAAE7D,IAAI,CAACz1C,EAAL,EAtBI;AAuBZu5C,eAAO,EAAE9D,IAAI,CAACz1C,EAAL,EAvBG;AAwBZw5C,eAAO,EAAE/D,IAAI,CAACz1C,EAAL,EAxBG;AAyBZy5C,oBAAY,EAAE,KAzBF;AA0BZl9B,mBAAW,EAAE,OAAAmG,EAAA,CAAG,IAAH,CA1BD;AA2BZwhB,qBAAa,EAAEuR,IAAI,CAACz1C,EAAL,EA3BH;AA4BZD,YAAI,EAAJA,IA5BY;AA6BZk1C,kBAAU,EAAE,OAAAvyB,EAAA,CAAG,IAAH,CA7BA;AA8BZg3B,uBAAe,EAAE,OAAAh3B,EAAA,CAAG,EAAH,CA9BL;AA+BZi3B,iBAAS,EAAE,OAAAj3B,EAAA,CAAG,EAAH,CA/BC;AAgCZkS,oBAAY,EAAE,OAAAlS,EAAA,CAAG,IAAH,CAhCF;AAiCZk3B,gCAAwB,EAAEnE,IAAI,CAACz1C,EAAL,EAjCd;AAkCZ6jC,gBAAQ,EAAE,OAAAnhB,EAAA,CAAG,IAAH,CAlCE;AAmCZwyB,mBAAW,EAAEO,IAAI,CAACz1C,EAAL,EAnCD;AAoCZ65C,kBAAU,EAAE,OAAAn3B,EAAA,CAAG,EAAH,CApCA;AAqCZyyB,yBAAiB,EAAE,OAAAzyB,EAAA,CAAG,EAAH;AArCP,OAAhB;AAyCA+O,aAAO,CAACyS,aAAR,CAAsB4V,kBAAtB,CAAyC,UAAAt+B,CAAC;AAAA,eAAI6E,OAAO,CAACC,OAAR,CAAgB,CAAC,IAAI,WAAAoI,OAAJ,CAAY,EAAZ,CAAD,CAAhB,CAAJ;AAAA,OAA1C;AACA+I,aAAO,CAACwnB,IAAR,CAAaa,kBAAb,CAAgC,UAAAt+B,CAAC;AAAA,eAAI6E,OAAO,CAACC,OAAR,CAAgB,IAAI,WAAAoI,OAAJ,CAAY,EAAZ,CAAhB,CAAJ;AAAA,OAAjC;AAEA+I,aAAO,CAAClvB,MAAR,CAAey2C,eAAf,CAA+B,OAAAt2B,EAAA,CAAG,IAAH,CAA/B;AACA+O,aAAO,CAAC7mB,MAAR,CAAeouC,eAAf,CAA+B,EAA/B;AACA,aAAOvnB,OAAP;AACH;;AAhDD;AAkDA,QAAIsoB,WAAW,GAAW,CAA1B;;AAEA,aAAgBC,0BAAhB,CAA2CjuC,KAA3C,EAA0D;AACtD,aAAO;AACHhM,YAAI,mBAAYgM,KAAZ,CADD;AAEHqJ,aAAK,mBAAYrJ,KAAZ,cAFF;AAGHoR,gBAAQ,EAAE;AACNpd,cAAI,uBAAgBgM,KAAhB,CADE;AAEN+tB,kBAAQ,EAAE;AAFJ;AAHP,OAAP;AAQH;;AATD;;AAWA,aAAgBmgB,iBAAhB,GAAqH;AAAA,UAAnF5C,SAAmF,uEAA9D,EAA8D;AAAA,UAA1D6C,QAA0D,uEAAvC,IAAuC;AAAA,UAAjCC,gBAAiC,uEAAL,KAAK;AACjH,UAAMlkC,EAAE,mBAAYikC,QAAQ,IAAIH,WAAW,EAAnC,CAAR;AACA,UAAMh6C,IAAI,GAAGs3C,SAAS,CAACt3C,IAAV,cAAqBu1C,KAAK,CAACv1C,IAA3B,cAAmCu1C,KAAK,CAACv1C,IAAN,CAAWq6C,QAAX,EAAnC,WAAb;AACA,UAAM/oB,UAAU,GAAG,UAAA5jB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB8J,YAApB,CAAiC,KAAjC,CAAnB;AACA,UAAIyP,QAAQ,GAAiB;AACzB0L,iBAAS,EAAE,IADc;AAEzB6Z,uBAAe,EAAErR,UAAU,CAACxsB,QAAX,CAAoB;AAAEwwB,cAAI,EAAE;AAAR,SAApB,EAAiC3f,OAFzB;AAGzB3B,gBAAQ,EAAEhD,KAAK,CAAC,EAAD,CAAL,CAAU+nC,IAAV,CAAe,CAAf,EAAkBjvC,GAAlB,CAAsB,UAAAxH,CAAC;AAAA,iBAAI02C,mBAAmB,EAAvB;AAAA,SAAvB,CAHe;AAIzBjf,gBAAQ,EAAE,IAJe;AAKzB0N,mBAAW,EAAE,IALY;AAMzBmM,sBAAc,EAAE,wBANS;AAOzBtrB,4BAAoB,EAAE,UAPG;AAQzBqhB,cAAM,EAAE,GARiB;AASzB4K,qBAAa,EAAE,KATU;AAUzB+F,2BAAmB,EAAE,IAVI;AAWzB7G,iBAAS,YAAKzzC,IAAL,kBAXgB;AAYzBu6C,UAAE,EAAE;AAZqB,OAA7B;;AAcA,UAAIjD,SAAS,CAACl6B,QAAd,EAAwB;AACpBA,gBAAQ,GAAG,MAAH,OAAG,CAAH,kBAAQA,QAAR,CAAG,EAAkBk6B,SAAS,CAACl6B,QAA5B,CAAX;AACA,eAAOk6B,SAAS,CAACl6B,QAAjB;AACH;;AACD,UAAIg9B,gBAAJ,EAAsB;AAClBh9B,gBAAQ,CAACq3B,uBAAT,GAAmC,CAC/B;AACIxwC,cAAI,EAAEqtB,UAAU,CAAC3b,OADrB;AAEImT,mBAAS,EAAE;AAFf,SAD+B,EAK/B;AACI7kB,cAAI,EAAEqtB,UAAU,CAACxsB,QAAX,CAAoB;AAAEwwB,gBAAI,EAAE;AAAR,WAApB,EAAiC3f,OAD3C;AAEImT,mBAAS,EAAE;AAFf,SAL+B,EAS/B;AACI7kB,cAAI,EAAEqtB,UAAU,CAACxsB,QAAX,CAAoB;AAAEwwB,gBAAI,EAAE;AAAR,WAApB,EAAiC3f,OAD3C;AAEImT,mBAAS,EAAE;AAFf,SAT+B,EAa/B;AACI7kB,cAAI,EAAEqtB,UAAU,CAACxsB,QAAX,CAAoB;AAAEwwB,gBAAI,EAAE;AAAR,WAApB,EAAiC3f,OAD3C;AAEImT,mBAAS,EAAE;AAFf,SAb+B,CAAnC;AAkBH;;AAED,UAAM0xB,MAAM,GAAGj2C,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,KAArB,CAAX,IAA0C,CAA1C,KAAgD,CAAhD,IAAqDonC,WAAW,GAAG,CAAlF;AACA,aAAO,IAAI,SAAA5yB,KAAJ,CAAU,MAAD,OAAC,CAAD;AACZlR,UAAE,EAAFA,EADY;AAEZlW,YAAI,YAAKA,IAAL,mBAFQ;AAGZ2pC,cAAM,YAAKwQ,QAAQ,IAAIH,WAAjB,CAHM;AAIZ9wC,YAAI,EAAEqsC,KAAK,CAACkF,QAAN,CAAeC,WAAf,EAJM;AAKZC,kBAAU,EAAEp2C,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,KAArB,CAAX,IAA0C,CAA1C,KAAgD,CALhD;AAMZgoC,mBAAW,EAAEr2C,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,KAArB,CAAX,IAA0C,CAA1C,KAAgD,CANjD;AAOZioC,mBAAW,EAAEt2C,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,GAArB,CAAX,IAAwC,GAPzC;AAQZuV,gBAAQ,EAAE5jB,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,KAArB,CAAX,IAA0C,CAA1C,KAAgD,CAR9C;AASZ0X,gBAAQ,EAAE,EATE;AAUZwwB,qBAAa,EAAE,CAVH;AAWZn8B,aAAK,EAAEpa,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,CAArB,CAAX,IAAsC,CAXjC;AAYZif,iBAAS,EAAEttB,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,CAArB,CAAX,IAAsC,CAZrC;AAaZ8gC,mBAAW,uBAAgBx9B,EAAhB,CAbC;AAcZwa,aAAK,EAAE6kB,KAAK,CAAC7kB,KAAN,CAAYqqB,QAAZ,EAdK;AAeZxzB,aAAK,EAAE,CAAC,YAAD,CAfK;AAgBZosB,gBAAQ,YAAK,SAAApvB,aAAA,CAAcY,SAAnB,cAAgC,SAAAZ,aAAA,CAAcM,oBAA9C,CAhBI;AAiBZxP,aAAK,YAAKrV,IAAI,CAAC2L,WAAL,GAAmB1F,KAAnB,CAAyB,GAAzB,EAA8BqH,IAA9B,CAAmC,GAAnC,CAAL,cAAgD,QAAA0tC,WAAhD,CAjBO;AAkBZ59B,gBAAQ,EAARA;AAlBY,OAAC,EAmBVk6B,SAnBU,CAAV,CAAP;AAqBH;;AAjED;AAmEA,QAAI2D,aAAa,GAAG,CAApB;AACA,QAAIC,YAAY,GAAI,UAAAxtC,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoBgB,QAApB,CAA6B;AAAE0B,UAAI,EAAE;AAAR,KAA7B,EAA0C1B,QAA1C,CAAmD;AAACP,YAAM,EAAE;AAAT,KAAnD,EAAgEoR,aAAhE,CAA8E;AAAE4f,UAAI,EAAE;AAAR,KAA9E,EAA4F3nB,YAA5F,CAAyG,QAAzG,CAApB;AAEA;;;;;AAIA,aAAgBwtC,2BAAhB,CAA4C1tC,IAA5C,EAA0D;AACtD,UAAMxJ,IAAI,GAAG,IAAI,UAAAkR,MAAJ,CAAW;AAAClR,YAAI,EAAEwJ;AAAP,OAAX,CAAb;AACAytC,kBAAY,GAAGj3C,IAAI,CAAC0J,YAAL,CAAkB,QAAlB,CAAf;AACH;;AAHD;AAKA;;;;;AAIA,aAAgBqrC,mBAAhB,GAA4D;AAAA,UAAxB/Q,QAAwB,uEAAJ,EAAI;AACxD,UAAM/xB,EAAE,qBAAc+kC,aAAa,EAA3B,CAAR;AACAC,kBAAY,GAAGA,YAAY,CAACp2C,QAAb,CAAsB;AAAEJ,eAAO,EAAEH,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,CAArB,IAA0B,CAArC,IAA0C;AAArD,OAAtB,CAAf;AACA,UAAMzO,KAAK,GAAG+2C,YAAY,CAACttC,EAA3B;AACA,UAAM5I,QAAQ,GAAGT,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,CAArB,IAA0B,CAArC,IAA0C,EAA3D;AACAsoC,kBAAY,GAAGA,YAAY,CAACp2C,QAAb,CAAsB;AAAEJ,eAAO,EAAEH,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,CAArB,CAAX,IAAsC;AAAjD,OAAtB,CAAf;AACA,UAAM2lB,SAAS,GAAGsgB,gBAAgB,CAAC;AAAExc,gBAAQ,EAAE,KAAZ;AAAmB+e,eAAO,EAAE;AAA5B,OAAD,CAAlC;AACA,UAAMxe,MAAM,GAAG5rB,KAAK,CAACzM,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,CAArB,CAAX,CAAD,CAAL,CACVmmC,IADU,CACL,CADK,EAEVjvC,GAFU,CAEN,UAAA2R,CAAC;AAAA,eAAI4/B,yBAAyB,CAAC;AAAEtnB,sBAAY,EAAE5vB;AAAhB,SAAD,EAA0B8jC,QAAQ,CAACrW,QAAnC,EAA6CqW,QAAQ,CAACqT,IAAtD,CAA7B;AAAA,OAFK,CAAf;AAGA,UAAM/yB,WAAW,GAAGhkB,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,KAArB,CAAX,IAA0C,CAA1C,KAAgD,CAApE;AACA,UAAM2oC,UAAU,GAAG,IAAI,UAAApmC,MAAJ,CAAW;AAAClR,YAAI,EAAEE;AAAP,OAAX,CAAnB;AACA,aAAO,MAAP,OAAO,CAAP;AACI+R,UAAE,EAAFA,EADJ;AAEI0a,aAAK,YAAK2kB,KAAK,CAACkF,QAAN,CAAeC,WAAf,EAAL,aAFT;AAGIpiB,iBAAS,EAAEtnB,KAAK,CAACzM,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,CAArB,IAA0B,CAArC,CAAD,CAAL,CACNmmC,IADM,CACD,CADC,EAENjvC,GAFM,CAEF,UAAC2R,CAAD,EAAInZ,CAAJ;AAAA,iBAAUu2C,gBAAgB,CAAC5Q,QAAQ,CAACuT,KAAV,CAA1B;AAAA,SAFE,CAHf;AAMIjjB,iBAAS,EAATA,SANJ;AAOIxiB,mBAAW,EAAEwlC,UAAU,CAAC5lC,OAP5B;AAQIF,iBAAS,EAAE8lC,UAAU,CAACz2C,QAAX,CAAoB;AAAEJ,iBAAO,EAAEM;AAAX,SAApB,EAA2C2Q,OAR1D;AASIxF,YAAI,EAAEolC,KAAK,CAACkG,KAAN,CAAYC,SAAZ,EATV;AAUIhjB,aAAK,EAAE,CAAC;AAAExvB,cAAI,EAAE,OAAR;AAAiB0S,iBAAO,EAAE25B,KAAK,CAACkG,KAAN,CAAYC,SAAZ;AAA1B,SAAD,CAVX;AAWIp+B,gBAAQ,EAAEi4B,KAAK,CAACtnB,OAAN,CAAcvU,IAAd,EAXd;AAYI;AACA2e,oBAAY,EAAE,CAAC,UAAD,EAAa,UAAb,EAAyB,OAAAzlB,oBAAA,CAAqB,CAArB,CAAzB,CAblB;AAcI+L,aAAK,EAAE;AAAE,sBAAYpa,IAAI,CAACmD,GAAL,CAAS,CAAT,EAAY,CAAC,OAAAkL,oBAAA,CAAqB,EAArB,IAA2B,CAA5B,IAAiC,CAA7C;AAAd,SAdX;AAeIif,iBAAS,EAAE;AAAE,sBAAYttB,IAAI,CAACmD,GAAL,CAAS,CAAT,EAAY,CAAC,OAAAkL,oBAAA,CAAqB,EAArB,IAA2B,CAA5B,IAAiC,CAA7C;AAAd,SAff;AAgBI6V,cAAM,EAAE,UAhBZ;AAiBIsR,gBAAQ,EAAExR,WAAW,GAAGqU,MAAH,GAAY,EAjBrC;AAkBIhG,YAAI,EAAE,IAAI,SAAAxP,KAAJ,CAAU6yB,0BAA0B,CAAC,CAAD,CAApC,CAlBV;AAmBIthB,uBAAe,EAAE,EAnBrB;AAoBII,eAAO,EAAC;AApBZ,OAAO,EAqBAkP,QArBA,CAAP;AAuBH;;AAnCD;AAqCA,QAAI0T,SAAS,GAAG,CAAhB;AACA,QAAIC,SAAS,GAAG,CAAhB;AAEA;;;;;;;AAMA,aAAgBjG,oBAAhB,GAA4D;AAAA,UAAvB2B,SAAuB,uEAAF,EAAE;AACxD,UAAMphC,EAAE,sBAAeylC,SAAS,EAAxB,CAAR;AACA,UAAM7hC,MAAM,GAAG9I,KAAK,CAAC,EAAD,CAAL,CACV+nC,IADU,CACL,CADK,EAEVjvC,GAFU,CAEN,UAAC2R,CAAD,EAAInZ,CAAJ,EAAU;AAAD;;AAAC,eAAAu5C,iBAAiB,CAAC31C,SAAD,EAAY,CAAF,KAAEoxC,SAAS,CAACwE,cAAV,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,QAAxBxE,SAAwB,EAAGh1C,CAAH,CAApC,CAAjB;AAA2D,OAF/D,CAAf;AAGA,UAAMqxC,QAAQ,GAAQ,EAAtB;;AALwD,mDAMtC75B,MANsC;AAAA;;AAAA;AAMxD,kEAA0B;AAAA,cAAf+xB,GAAe;AACtB,cAAM7/B,KAAK,GAAGzH,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,CAArB,IAA0B,CAArC,CAAd;AACA+gC,kBAAQ,CAAC9H,GAAG,CAACE,QAAL,CAAR,GAAyB,EAAzB;;AACA,eAAK,IAAIzpC,IAAC,GAAG,CAAb,EAAgBA,IAAC,GAAG0J,KAApB,EAA2B1J,IAAC,EAA5B,EAAgC;AAC5BqxC,oBAAQ,CAAC9H,GAAG,CAACE,QAAL,CAAR,CAAuBwJ,KAAK,CAACkF,QAAN,CAAeC,WAAf,EAAvB,sBAAkEp4C,IAAC,GAAG,CAAtE;AACH;AACJ;AAZuD;AAAA;AAAA;AAAA;AAAA;;AAaxD,aAAO,MAAP,OAAO,CAAP;AACI4T,UAAE,EAAFA,EADJ;AAEIgK,eAAO,EAAEhK,EAFb;AAGIy0B,cAAM,EAAE35B,KAAK,CAAC,EAAD,CAAL,CACH+nC,IADG,CACE,CADF,EAEHjvC,GAFG,CAEC,UAAAxH,CAAC,EAAI;AACN,cAAMtC,IAAI,GAAGu1C,KAAK,CAACkF,QAAN,CAAeC,WAAf,EAAb;AACA,iBAAO;AACH9P,oBAAQ,EAAE5qC,IAAI,CACTiG,KADK,CACC,GADD,EAELqH,IAFK,CAEA,GAFA,EAGL3B,WAHK,EADP;AAKHk/B,sBAAU,EAAE7qC;AALT,WAAP;AAOH,SAXG,CAHZ;AAeIguB,YAAI,EAAE,KAfV;AAgBIhuB,YAAI,EAAEu1C,KAAK,CAACv1C,IAAN,CAAW+7C,SAAX,EAhBV;AAiBI9tB,eAAO,EAAE,wBAjBb;AAkBIvU,YAAI,EAAE,eAlBV;AAmBIoxB,kBAAU,EAAE95B,KAAK,CAAC,EAAD,CAAL,CACP+nC,IADO,CACF,CADE,EAEPjvC,GAFO,CAEH,UAAAxH,CAAC,EAAI;AACN,cAAMtC,IAAI,GAAGu1C,KAAK,CAACkF,QAAN,CAAeC,WAAf,EAAb;AACA,iBAAO;AACH9P,oBAAQ,EAAE5qC,IAAI,CACTiG,KADK,CACC,GADD,EAELqH,IAFK,CAEA,GAFA,EAGL3B,WAHK,EADP;AAKHk/B,sBAAU,EAAE7qC;AALT,WAAP;AAOH,SAXO,CAnBhB;AA+BI8Z,cAAM,EAANA,MA/BJ;AAgCIkxB,aAAK,EAAE;AACH,0BAAgBh6B,KAAK,CAAC,EAAD,CAAL,CACX+nC,IADW,CACN,CADM,EAEXjvC,GAFW,CAEP,UAAAxH,CAAC;AAAA,mBAAIu2C,gBAAgB,EAApB;AAAA,WAFM;AADb,SAhCX;AAqCIjN,sBAAc,EAAE+H,QArCpB;AAsCIv2B,gBAAQ,EAAE;AACN4+B,cAAI,EAAE;AACFC,kBAAM,EAAE;AACJC,oBAAM,EAAE,IADJ;AAEJC,iBAAG,EAAE;AAFD;AADN,WADA;AAONziC,cAAI,EAAE67B,KAAK,CAACtnB,OAAN,CAAcvU,IAAd;AAPA,SAtCd;AA+CI7Q,gBAAQ,EAAE;AA/Cd,OAAO,EAgDAyuC,SAhDA,CAAP;AAkDH;;AA/DD;AAiEA;;;;;;AAKA,aAAgBuE,iBAAhB,CAAkC3lC,EAAlC,EAAsE;AAAA,UAAvBohC,SAAuB,uEAAF,EAAE;;AAClE,UAAI,CAACphC,EAAL,EAAS;AACLA,UAAE,sBAAe0lC,SAAS,EAAxB,CAAF;AACH;;AACD,aAAO,MAAP,OAAO,CAAP;AACI1lC,UAAE,EAAFA,EADJ;AAEI61B,gBAAQ,EAAE71B,EAFd;AAGIy2B,kBAAU,kBAAWiP,SAAX,CAHd;AAIIjpB,kBAAU,cAAOipB,SAAP;AAJd,OAAO,EAKAtE,SALA,CAAP;AAOH;;AAXD;AAaA,QAAI8E,UAAU,GAAG,CAAjB;AAEW,YAAApB,WAAA,GAAc,iBAAd;AAEX,QAAMqB,WAAW,GAAa,EAA9B;AAEA;;;;;;;AAMA,aAAgBxD,gBAAhB,GAAuD;AAAA,UAAtB5Q,QAAsB,uEAAF,EAAE;AACnD,UAAM/xB,EAAE,kBAAWkmC,UAAU,EAArB,CAAR;AACA,UAAMp8C,IAAI,aAAMu1C,KAAK,CAACv1C,IAAN,CAAW+7C,SAAX,EAAN,cAAgCxG,KAAK,CAACv1C,IAAN,CAAWq6C,QAAX,EAAhC,CAAV;AACA,UAAMhe,QAAQ,GAAG4L,QAAQ,CAAC5L,QAAT,IAAqB,EAAE,OAAAzpB,oBAAA,CAAqB,KAArB,IAA8B,CAAhC,CAAtC;AACA,UAAM26B,YAAY,GAAGlR,QAAQ,GAAGkZ,KAAK,CAACxc,OAAN,CAAcujB,WAAd,EAAH,GAAiC,QAAAtB,WAAA,CAAY/0C,KAAZ,CAAkB,GAAlB,EAAuB,CAAvB,CAA9D;AACA,UAAIs2C,SAAS,GAAwC,EAArD;AACA,UAAMC,cAAc,GAAGj4C,IAAI,CAACq9B,GAAL,CAAS,OAAAhvB,oBAAA,CAAqB,CAArB,IAA0B,CAAnC,EAAsCypC,WAAW,CAACl2C,MAAlD,CAAvB;;AACA,WAAK,IAAI7D,IAAC,GAAG,CAAb,EAAgBA,IAAC,GAAGk6C,cAApB,EAAoCl6C,IAAC,EAArC,EAAyC;AACrCi6C,iBAAS,CAACzwC,IAAV,CAAe;AAACuJ,eAAK,EAAEgnC,WAAW,CAAC93C,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqBypC,WAAW,CAACl2C,MAAjC,CAAX,CAAD,CAAnB;AAA2EgzB,iBAAO,EAAE;AAApF,SAAf;AACH;;AACDojB,eAAS,GAAG,OAAA5xC,MAAA,CAAO4xC,SAAP,CAAZ;AACA,UAAMlnC,KAAK,aAAMrV,IAAI,CAChBiG,KADY,CACN,GADM,EAEZqH,IAFY,CAEP,GAFO,EAGZ3B,WAHY,EAAN,cAGW0wB,QAAQ,GAAG,MAAH,GAAY,EAH/B,SAGoC,QAAA2e,WAHpC,CAAX;AAIAqB,iBAAW,CAACvwC,IAAZ,CAAiBuJ,KAAjB;AACA,aAAO,MAAP,OAAO,CAAP;AACIa,UAAE,EAAFA,EADJ;AAEIlW,YAAI,EAAJA,IAFJ;AAGIy8C,kBAAU,EAAEz8C,IAAI,CAACiG,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAHhB;AAIIy2C,iBAAS,EAAE18C,IAAI,CAACiG,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAJf;AAKIoP,aAAK,EAALA,KALJ;AAMIsnC,aAAK,EAAEpH,KAAK,CAACoH,KAAN,CAAYC,WAAZ,EANX;AAOIxB,eAAO,EAAE/e,QAPb;AAQIkR,oBAAY,EAAE;AACVr3B,YAAE,EAAEq3B,YAAY,CACXtnC,KADD,CACO,GADP,EAECqH,IAFD,CAEM,GAFN,EAGC3B,WAHD,EADM;AAKV3L,cAAI,EAAEutC;AALI,SARlB;AAeIsP,kBAAU,EAAEtH,KAAK,CAACkF,QAAN,CAAeoC,UAAf,EAfhB;AAgBIC,kBAAU,EAAE,OAAAtyC,OAAA,CAAQjG,IAAI,CAACY,KAAL,CAAW,OAAAyN,oBAAA,CAAqB,KAArB,CAAX,CAAR,EAAiD,CAAjD,CAhBhB;AAiBI2pC,iBAAS,EAATA,SAjBJ;AAkBI7rB,aAAK,EAAE6kB,KAAK,CAAC7kB,KAAN,CAAYqsB,MAAZ;AAlBX,OAAO,EAmBA9U,QAnBA,CAAP;AAqBH;;AArCD;;AAuCA,aAAgBoT,yBAAhB,GAAwH;AAAA,UAA9E/D,SAA8E,uEAAzD,EAAyD;AAAA,UAArDle,OAAqD,uEAAnC,EAAmC;AAAA,UAA/BkiB,IAA+B,uEAAJ,EAAI;AACpH,aAAO,MAAP,OAAO,CAAP;AACIplC,UAAE,kBAAW,OAAAtD,oBAAA,CAAqB,QAArB,CAAX,CADN;AAEIopB,qBAAa,EAAE,OAAAppB,oBAAA,CAAqB,CAArB,IAA0B,CAF7C;AAGIkqB,mBAAW,EAAE1D,OAHjB;AAIIn3B,aAAK,EAAE,IAAI+O,KAAJ,CAAU,OAAA4B,oBAAA,CAAqB,CAArB,EAAwB,CAAxB,CAAV,EAAsCmmC,IAAtC,CAA2C,CAA3C,EAA8CjvC,GAA9C,CAAkD,UAAAxH,CAAC;AAAA,iBAAI06C,YAAY,CAAC1B,IAAD,CAAhB;AAAA,SAAnD;AAJX,OAAO,EAKAhE,SALA,CAAP;AAOH;;AARD;;AAUA,aAAS0F,YAAT,GAAyD;AAAA,UAAnCC,QAAmC,uEAAJ,EAAI;;;;AACrD,UAAM11B,KAAK,GAAGtW,MAAM,CAACpH,IAAP,CAAYozC,QAAZ,CAAd;AACA,UAAM3B,IAAI,GAAG2B,QAAQ,CAAC11B,KAAK,CAAC,OAAA3U,oBAAA,CAAqB2U,KAAK,CAACphB,MAA3B,CAAD,CAAN,CAAR,IAAuD,EAApE;AACA,UAAM+2C,QAAQ,GAAG5B,IAAI,CAAC,OAAA1oC,oBAAA,CAAqB0oC,IAAI,CAACn1C,MAA1B,CAAD,CAAJ,IAA2C;AAAElE,aAAK,EAAE;AAAT,OAA5D;AACA,UAAM4mB,KAAK,GAAG,MAAH,OAAG,CAAH,EAAG,EAAMq0B,QAAQ,CAACj7C,KAAT,CAAe,OAAA2Q,oBAAA,CAAqBsqC,QAAQ,CAACj7C,KAAT,CAAekE,MAApC,CAAf,KAA+D,EAArE,CAAd;;AACA,UAAI,CAAC0iB,KAAK,WAAN,KAAc,MAAIA,KAAK,CAAC5mB,KAAV,MAAe,IAAf,IAAe,aAAf,GAAe,MAAf,GAAe,GAAEkE,MAA/B,CAAJ,EAA2C;AACvC,YAAMwG,IAAI,GAAG,MAAH,OAAG,CAAH,EAAG,EAAKkc,KAAK,CAAC5mB,KAAN,CAAY,OAAA2Q,oBAAA,CAAqBiW,KAAK,CAAC5mB,KAAN,CAAYkE,MAAjC,CAAZ,CAAL,CAAb;AACAwG,YAAI,CAAC+5B,MAAL,GAAc,OAAA9zB,oBAAA,CAAqB,CAArB,EAAwB,CAAxB,CAAd;AACA,eAAOjG,IAAP;AACH;;AACDkc,WAAK,CAAC6d,MAAN,GAAe,OAAA9zB,oBAAA,CAAqB,CAArB,EAAwB,CAAxB,CAAf;AACA,aAAOiW,KAAP;AACH;;AAED,aAAgBs0B,oBAAhB,CAAqC7F,SAArC,EAAyD8F,eAAzD,EAAoFC,IAApF,EAAkG;AAC9F,UAAMnT,KAAK,GAAG,OAAAt3B,oBAAA,CAAqB,SAArB,IAAoC,CAApC,KAA0C,CAAxD;;AACA,UAAIs3B,KAAK,KAAK,CAACoN,SAAD,IAAcA,SAAS,CAACpN,KAA7B,CAAT,EAA8C;AAC1C,eAAO,MAAP,OAAO,CAAP;AACIP,gBAAM,EAAEyT,eAAe,CAAC,OAAAxqC,oBAAA,CAAqBwqC,eAAe,CAACj3C,MAArC,CAAD,CAD3B;AAEIgpB,eAAK,EAAEkuB,IAAI,CAAC,OAAAzqC,oBAAA,CAAqByqC,IAAI,CAACl3C,MAA1B,CAAD;AAFf,SAAO,EAGAmxC,SAHA,CAAP;AAKH,OAND,MAMO;AACH,eAAO,MAAP,OAAO,CAAP;AACI71C,WAAC,EAAE,OAAAmR,oBAAA,CAAqB,GAArB,EAA0B,GAA1B,CADP;AAEIk3B,eAAK,EAAE,IAFX;AAGIpoC,WAAC,EAAE,OAAAkR,oBAAA,CAAqB,GAArB,EAA0B,GAA1B,CAHP;AAIIuc,eAAK,EAAEkuB,IAAI,CAAC,OAAAzqC,oBAAA,CAAqByqC,IAAI,CAACl3C,MAA1B,CAAD,CAJf;AAKIgkC,oBAAU,EAAE,OAAAv3B,oBAAA,CAAqB,EAArB;AALhB,SAAO,EAMA0kC,SANA,CAAP;AAQH;AACJ;;AAlBD;AAoBA,QAAIgG,SAAS,GAAG,CAAhB;;AAEA,aAAgBC,wBAAhB,GAAwC;AACpC,UAAMxkC,SAAS,GAAG/H,KAAK,CAAC,CAAD,CAAL,CAAS+nC,IAAT,CAAc,CAAd,EAAiBjvC,GAAjB,CAAqB,UAAAxH,CAAC;AAAA,eAAIqzC,oBAAoB,EAAxB;AAAA,OAAtB,CAAlB;AACA,aAAO;AACHz/B,UAAE,qBAAconC,SAAS,EAAvB,CADC;AAEHt9C,YAAI,yBAAkBs9C,SAAlB,CAFD;AAGHvkC,iBAAS,EAATA,SAHG;AAIHqE,gBAAQ,EAAE;AACNstB,wBAAc,EAAE;AACZ3xB,qBAAS,EAATA;AADY,WADV;AAINijC,cAAI,EAAE;AACFC,kBAAM,EAAE;AACJE,iBAAG,EAAE;AADD;AADN;AAJA;AAJP,OAAP;AAeH;;AAjBD;;AAoBa,YAAAqB,6BAAA,GAAgC,YAAM;AAC/C,UAAMzkC,SAAS,GAAe/H,KAAK,CAAC,EAAD,CAAL,CAAU+nC,IAAV,CAAe,CAAf,EACzBjvC,GADyB,CACrB;AAAA,eAAM,IAAI,eAAA0gC,QAAJ,CAAamL,oBAAoB,EAAjC,CAAN;AAAA,OADqB,CAA9B;AAEA58B,eAAS,CAACjN,IAAV,OAAAiN,SAAS,qBAAS/H,KAAK,CAAC,CAAD,CAAL,CAAS+nC,IAAT,CAAc,CAAd,EAAiBjvC,GAAjB,CAAqB;AAAA,eAAM,IAAI,eAAA0gC,QAAJ,CAAamL,oBAAoB,CAAC;AAC3Ev4B,kBAAQ,EAAE;AACN1D,gBAAI,EAAE;AADA,WADiE;AAI3EA,cAAI,EAAE;AAJqE,SAAD,CAAjC,CAAN;AAAA,OAArB,CAAT,EAAT;AAMAX,eAAS,CAACjN,IAAV,OAAAiN,SAAS,qBAAS/H,KAAK,CAAC,CAAD,CAAL,CAAS+nC,IAAT,CAAc,CAAd,EAAiBjvC,GAAjB,CAAqB;AAAA,eAAM,IAAI,eAAA0gC,QAAJ,CAAamL,oBAAoB,CAAC;AAC3Ev4B,kBAAQ,EAAE;AACN1D,gBAAI,EAAE;AADA,WADiE;AAI3EA,cAAI,EAAE;AAJqE,SAAD,CAAjC,CAAN;AAAA,OAArB,CAAT,EAAT;AAMA,aAAOX,SAAP;AACH,KAhBY;;AAkBb,aAAgB0kC,qBAAhB,GAAiE;AAAA,UAA3BjjC,IAA2B,uEAAN,IAAM;;AAC7D,UAAIA,IAAJ,EAAU;AACN,eAAOA,IAAP;AACH;;AACD,aAAO;AACHkjC,mBAAW,EAAE,IAAI75C,IAAJ,CAAS,aAAc,OAAO,EAAP,GAAY,EAAnC,CADV;AAEH85C,uBAAe,EAAE,EAFd;AAGH15C,YAAI,EAAE,UAHH;AAIHe,gBAAQ,EAAE;AAJP,OAAP;AAMH;;AAVD;;AAYa,YAAA44C,oBAAA,GAAuB,UAAC35C,IAAD,EAAkB;AAClD,aAAO,IAAI,UAAAkR,MAAJ,CAAW;AAAClR,YAAI,EAAJA,IAAD;AAAOsnB,mBAAW,EAAE,iBAApB;AAAuCD,mBAAW,EAAE;AAApD,OAAX,CAAP;AACH,KAFY;;;;;;;;;;;;;;;;;;;;;;;;;AChnBb;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACFA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;QAEa2M,I;;;;;AA8CX,sBAAoC;AAAA;;AAAA,YAAxBpY,QAAwB,uEAAJ,EAAI;;AAAA;;AAClC,sCAAMA,QAAN;AACA,gBAAK48B,UAAL,GAAkB58B,QAAQ,CAAC48B,UAAT,IAAuB,EAAzC;AACA,gBAAKC,SAAL,GAAiB78B,QAAQ,CAAC68B,SAAT,IAAsB,EAAvC;AACA,gBAAKmB,UAAL,GAAkBh+B,QAAQ,CAACxK,KAAT,IAAkB,EAApC;AACA,gBAAK2H,IAAL,GAAY6C,QAAQ,CAAC7C,IAArB;AACA,gBAAKqf,QAAL,GAAgBxc,QAAQ,CAACwc,QAAT,IAAqB,KAArC;AACA,gBAAK+e,OAAL,GAAev7B,QAAQ,CAACu7B,OAAT,IAAoB,KAAnC;AAGA,gBAAKlyC,IAAL,GAAY,QAAKkyC,OAAL,GAAe,UAAf,GAA4B,UAAxC;AACA,gBAAKuB,KAAL,GAAa98B,QAAQ,CAAC88B,KAAT,IAAkB98B,QAAQ,CAACi+B,MAA3B,IAAqC,EAAlD;AACA,gBAAKC,aAAL,GAAqBl+B,QAAQ,CAACk+B,aAAT,IAA0Bl+B,QAAQ,CAACg9B,UAAnC,IAAiD,EAAtE;AACA,gBAAK1P,aAAL,GAAqBttB,QAAQ,CAAC0tB,YAAT,IAAyB;AAC5Cr3B,YAAE,EAAE2J,QAAQ,CAACm+B,eAD+B;AAE5Ch+C,cAAI,EAAE6f,QAAQ,CAACo+B;AAF6B,SAA9C;AAKA,gBAAKzS,SAAL,GAAiB,IAAjB;AACA,gBAAK9a,KAAL,GAAa7Q,QAAQ,CAAC6Q,KAAT,IAAkB,EAA/B;AACA,gBAAKosB,UAAL,GAAkBj9B,QAAQ,CAACi9B,UAAT,IAAuBj9B,QAAQ,CAAC7C,IAAhC,IAAwC,EAA1D;AACA,gBAAKu/B,SAAL,GAAiB18B,QAAQ,CAAC08B,SAAT,IAAsB,EAAvC;AACA,gBAAK/Q,SAAL,GAAiB,IAAI,WAAA9B,WAAJ,CACf7pB,QAAQ,CAACvC,QAAT,IAAqBuC,QAAQ,CAACvC,QAAT,YAA6BrM,MAAlD,GACI4O,QAAQ,CAACvC,QADb,GAEI;AAAEtd,cAAI,EAAE6f,QAAQ,CAACvC;AAAjB,SAHW,CAAjB;AAKA,gBAAKwnB,MAAL,GAAcjlB,QAAQ,CAACilB,MAAT,IAAmB,EAAjC;AACA,gBAAKxnB,QAAL,GAAgBuC,QAAQ,CAACvC,QAAT,IAAqBuC,QAAQ,CAACq+B,cAA9B,IAAgD,EAAhE;AACA,gBAAK/kB,OAAL,GAAetZ,QAAQ,CAACsZ,OAAxB;AA7BkC;AA8BnC;AA1ED;;;;;;AAsFA;;;iCAGa;AAAA;;AACX,cAAMzH,OAAO,GAAQ,wBAAAvQ,cAAA,CAAeC,UAAf,CAA0B,WAAAsoB,WAA1B,CAArB;AACA,iBAAO,IAAIppB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,gBAAIkR,OAAJ,EAAa;AACXA,qBAAO,CAACwF,IAAR,CAAa,OAAI,CAAChhB,EAAlB,EAAsB;AAAEioC,oBAAI,EAAE,OAAI,CAAC9oC;AAAb,eAAtB,EAA4CsL,IAA5C,CACE,UAAA5G,CAAC,EAAI;AACH,uBAAI,CAACyxB,SAAL,GAAiBzxB,CAAjB;AACAwG,uBAAO,CAACxG,CAAD,CAAP;AACD,eAJH,EAKE,UAAAzL,CAAC;AAAA,uBAAIkS,MAAM,CAAClS,CAAD,CAAV;AAAA,eALH;AAOD,aARD,MAQO;AACLiS,qBAAO,CAAC,IAAD,CAAP;AACD;AACF,WAZM,CAAP;AAaD;AAED;;;;;;;;kCAKiBpc,K,EAAgBgtB,G,EAAY;AAAA;;AAC3C,iBAAO,IAAI7Q,OAAJ,CAAqB,UAAAC,OAAO,EAAI;AACrC,mBAAI,CAACJ,QAAL,CAAc9I,KAAd,CAAoB;AAAEhC,mBAAK,EAAE,OAAI,CAACA,KAAd;AAAqBlR,mBAAK,EAALA,KAArB;AAA4BgtB,iBAAG,EAAHA;AAA5B,aAApB,EAAuDxQ,IAAvD,CACE,UAAA5G,CAAC;AAAA,qBAAIwG,OAAO,CAACxG,CAAC,IAAIA,CAAC,CAAC5T,MAAF,GAAW,CAAjB,CAAX;AAAA,aADH,EAEE,UAAAsV,CAAC;AAAA,qBAAI8E,OAAO,CAAC,KAAD,CAAX;AAAA,aAFH;AAID,WALM,CAAP;AAMD;AAED;;;;;;gCAGY;AACV,iBAAO,IAAI0X,IAAJ,CAAS,IAAT,CAAP;AACD;AAED;;;;;;oCAGgB;AACd,iBAAO,IAAIA,IAAJ,CAAS,MAAD,OAAC,CAAD,kBAAM,IAAN,CAAC,EAAS;AAAE/hB,cAAE,EAAE,IAAN;AAAYb,iBAAK,EAAE;AAAnB,WAAT,CAAT,CAAP;AACD;AAED;;;;;;iCAGa;AACX,cAAMmF,IAAI,mEAAV;;AACA,iBAAOA,IAAI,CAAC8C,QAAZ;AACA,iBAAO9C,IAAP;AACD;;;;AAjED;4BAC0B;AACxB,iBAAO,KAAK2yB,aAAZ;AACD;AAED;;;;4BACwB;AACtB,iBAAO,IAAI,WAAAzD,WAAJ,CAAgB,KAAK8B,SAAL,IAAkB,EAAlC,CAAP;AACD;;;4BAnF4B;AAC3B,cAAM9Z,OAAO,GAAG,wBAAAvQ,cAAA,CAAeC,UAAf,CAA0B6W,IAA1B,CAAhB;AACA,iBAAOvG,OAAO,GAAGA,OAAO,CAACiN,OAAX,GAAqB,IAAnC;AACD;;;;MANuB,iBAAA/e,a;;AAA1B,wB,CAkJA;;;;;;;;;;;;;;;;;;;;;AC1JA;AAAA;AAAA;AASA;;;;;;AAIA,aAAgBw+B,gBAAhB,CAAiCvhC,IAAjC,EAA2C;AACzC,UAAI,CAACA,IAAL,EAAW;AACT,cAAMxc,KAAK,CAAC,gBAAD,CAAX;AACD;;AACD,UAAMmL,MAAM,GAAyB;AACnC0K,UAAE,EAAE,IAAI,QAAA0oB,WAAJ,CAAgB/hB,IAAI,CAAC3G,EAAL,IAAW,EAA3B,CAD+B;AAEnClW,YAAI,EAAE,IAAI,QAAA4+B,WAAJ,CAAgB/hB,IAAI,CAAC7c,IAAL,IAAa,EAA7B,CAF6B;AAGnCy8C,kBAAU,EAAE,IAAI,QAAA7d,WAAJ,CAAgB/hB,IAAI,CAAC4/B,UAAL,IAAmB,EAAnC,EAAuC,CAAC,QAAA3d,UAAA,CAAWC,QAAZ,EAAsB,QAAAD,UAAA,CAAWuf,OAAX,CAAmB,sBAAnB,CAAtB,EAAkE,QAAAvf,UAAA,CAAWwf,SAAX,CAAqB,EAArB,CAAlE,CAAvC,CAHuB;AAInC5B,iBAAS,EAAE,IAAI,QAAA9d,WAAJ,CAAgB/hB,IAAI,CAAC6/B,SAAL,IAAkB,EAAlC,EAAsC,CAAC,QAAA5d,UAAA,CAAWC,QAAZ,EAAsB,QAAAD,UAAA,CAAWuf,OAAX,CAAmB,sBAAnB,CAAtB,EAAkE,QAAAvf,UAAA,CAAWwf,SAAX,CAAqB,EAArB,CAAlE,CAAtC,CAJwB;AAKnCjpC,aAAK,EAAE,IAAI,QAAAupB,WAAJ,CAAgB/hB,IAAI,CAACxH,KAAL,IAAc,EAA9B,EAAkC,CAAC,QAAAypB,UAAA,CAAWzpB,KAAZ,CAAlC;AAL4B,OAArC,CAJyC,CAWzC;;AACE,aAAO,IAAI,QAAAgsB,SAAJ,CAAc71B,MAAd,CAAP;AACH;;AAbD;;;;;;;;;;;;;;;;;;;;;;;;ACbA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;QAca+yC,Y;;;;;AACT,4BACcrjC,SADd,EAEcsjC,KAFd,EAGclhC,QAHd,EAIY6C,QAJZ,EAKImB,eALJ,EAKoC;AAAA;;AAAA;;AAEhC,sCAAMpG,SAAN,EAAiBoG,eAAjB;AANU,gBAAApG,SAAA,GAAAA,SAAA;AACA,gBAAAsjC,KAAA,GAAAA,KAAA;AACA,gBAAAlhC,QAAA,GAAAA,QAAA;AACF,gBAAA6C,QAAA,GAAAA,QAAA;AAIR,gCAAAgB,cAAA,CAAesiB,UAAf,CAA0B,aAAAxL,IAA1B;AACA,gBAAKtW,KAAL,GAAa,OAAb;AACA,gBAAKC,UAAL,GAAkB,OAAlB;;AACA,gBAAKH,QAAL,GAAgB,UAACrV,CAAD,EAAIC,CAAJ;AAAA,iBAAU,CAACD,CAAC,CAAC8J,EAAF,CAAK5J,aAAL,CAAmBD,CAAC,CAAC6J,EAArB,CAAD,IAA6B,CAAC9J,CAAC,CAACiJ,KAAF,CAAQ/I,aAAR,CAAsBD,CAAC,CAACgJ,KAAxB,CAAxC;AAAA,SAAhB;;AACA,gBAAKzR,GAAL,CAAS,MAAT,EAAiB,EAAjB;;AACA,gBAAKA,GAAL,CAAS,cAAT,EAAyB,IAAI,aAAAq0B,IAAJ,CAAS;AAAE/hB,YAAE,EAAE,YAAN;AAAoBlW,cAAI,EAAE;AAA1B,SAAT,CAAzB;;AACA,gBAAK4D,GAAL,CAAS,WAAT,EAAsB,IAAtB;;AACA,gBAAKsX,SAAL,CAAesB,WAAf,CAA2BzH,IAA3B,CAAgC,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,iBAAOA,CAAP;AAAA,SAAN,CAAhC,EAAiDvZ,SAAjD,CAA2D;AAAA,iBAAM,QAAKua,IAAL,EAAN;AAAA,SAA3D;;AAVgC;AAWnC;AAED;;;;;;AAUA;;AACA;;;;;;iCAMgB+G,K,EAAei7B,M,EAAyC;AAAA,cAAxBC,MAAwB,uEAAN,IAAM;;AACpE,cAAI,CAACD,MAAL,EAAa;AACT,gBAAMxzB,GAAG,GAAG,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAZ;AACA46C,kBAAM,GAAGxzB,GAAG,CAACnmB,QAAJ,CAAa;AAAEwwB,kBAAI,EAAE;AAAR,aAAb,EAA0BpB,UAA1B,CAAqC,KAArC,EAA4CtmB,EAArD;AACH;;AACD,cAAMmiB,IAAI,aAAMzS,QAAQ,CAACO,MAAf,SACN,KAAKsC,QAAL,CAAcd,OAAd,CAAsB,gBAAtB,KAA2C,EADrC,qBAAV;AAGA,cAAMs/B,SAAS,GAAG,MAAAC,GAAA,CAAIC,OAAJ,CAAY9uB,IAAZ,CAAlB;;AACA,cAAItM,cAAJ,EAAoB;AAChBA,0BAAc,CAAC0qB,OAAf,WAA0BwQ,SAA1B,oBAAoDn7B,KAApD;AACAC,0BAAc,CAAC0qB,OAAf,WAA0BwQ,SAA1B,4BAAqDF,MAArD;AACH;;AACD,cAAIvgC,YAAJ,EAAkB;AACdA,wBAAY,CAACiwB,OAAb,WAAwBwQ,SAAxB,oBAAkDn7B,KAAlD;AACAtF,wBAAY,CAACiwB,OAAb,WAAwBwQ,SAAxB,4BAAmDF,MAAnD;AACH;;AACD,cAAIC,MAAJ,EAAY;AACR,iBAAKphC,QAAL,CAAcwhC,EAAd,CAAiB,KAAKxhC,QAAL,CAAcyS,IAAd,EAAjB;AACH;;AACD,iBAAOA,IAAP;AACH;AAED;;;;;;;;8BAKmB5N,Y,EAAkD;AAAA,cAA3B0E,OAA2B,uEAAF,EAAE;;;;;;;;yBAC7D,KAAKvF,eAAL,CAAqBQ,S;;;;;AACrB,wBAAI,CAAC,KAAKN,SAAL,CAAe,OAAf,CAAL,EAA8B;AAC1B,2BAAKA,SAAL,CAAe,OAAf,IAA0B,IAAIlB,OAAJ,CAAkB,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC7D,+BAAI,CAAC5c,GAAL,CAAS,QAAT,EAAmB,SAAnB;;AACA,4BAAI+f,OAAO,GAAG,IAAI,OAAAC,WAAJ,EAAd;;AACA,4BAAI,CAACiD,OAAD,IAAYA,OAAO,CAACzG,IAAR,KAAiB,KAAjC,EAAwC;AACpCuD,iCAAO,GAAGA,OAAO,CAACo7B,MAAR,CAAe,cAAf,EAA+B,mCAA/B,CAAV;AACH;;AACD,4BAAMphC,GAAG,GAAG,CAACkJ,OAAO,GAAGA,OAAO,CAAClJ,GAAX,GAAiB,EAAzB,KAAgC,cAA5C;;AACA,+BAAI,CAAC6gC,KAAL,CAAW37B,IAAX,CAAgBlF,GAAhB,EAAqBwE,YAArB,EAAmC;AAAEwB,iCAAO,EAAPA;AAAF,yBAAnC,EAAgDzhB,SAAhD,CACI,UAACuZ,CAAD;AAAA,iCAAO,IAAP;AAAA,yBADJ,EAEI,UAACnN,CAAD;AAAA,iCAAOkS,MAAM,CAAClS,CAAD,CAAb;AAAA,yBAFJ,EAGI,YAAM;AACF,iCAAI,CAAC4M,SAAL,CAAesE,IAAf,CAAoBw/B,SAApB;;AACAz+B,iCAAO;AACV,yBANL;AAQH,uBAfyB,CAA1B;AAgBH;;uDACM,KAAKiB,SAAL,CAAe,OAAf,C;;;;;;;;;AAEd;AAGD;;;;;;iCAGgB;AACZ,eAAKtG,SAAL,CAAesE,IAAf,CAAoBy/B,MAApB;AACH;AAED;;;;;;;0CAI4B;;;;;;uDACjB,KAAK/nB,IAAL,CAAU,SAAV,C;;;;;;;;;AACV;AAED;;;;;;+BAGgC;AAAA;;AAAA,cAAjBgoB,KAAiB,uEAAD,CAAC;AAC5B,cAAMhiC,OAAO,GAA4B,KAAKiD,QAAL,CAAcxG,GAAd,CAAkB,SAAlB,KAAgC,EAAzE;AACAuD,iBAAO,CAACL,IAAR,GAAe;AAAEjB,mBAAO,EAAE,0BAAX;AAAuC5c,iBAAK,EAAE;AAA9C,WAAf;;AACA,eAAKmhB,QAAL,CAAcvc,GAAd,CAAkB,SAAlB,EAA6BsZ,OAA7B;;AACA,eAAKtZ,GAAL,CAAS,QAAT,EAAmB,SAAnB;AACA,iBAAO,IAAI0c,OAAJ,CAAkB,UAACC,OAAD,EAAa;AAClC;AACA;AACA,gBAAI,OAAI,CAACe,eAAL,CAAqBQ,SAArB,IAAkCo9B,KAAK,GAAG,CAA9C,EAAiD;AAC7C,qBAAI,CAACt7C,GAAL,CAAS,QAAT,EAAmB,SAAnB;;AACAsZ,qBAAO,CAACL,IAAR,GAAe;AAAEjB,uBAAO,EAAE,0BAAX;AAAuC5c,qBAAK,EAAE;AAA9C,eAAf;;AACA,qBAAI,CAACmhB,QAAL,CAAcvc,GAAd,CAAkB,SAAlB,EAA6BsZ,OAA7B;;AACA,qBAAOqD,OAAO,EAAd;AACH;;AACD,mBAAI,CAAC2W,IAAL,CAAU,SAAV,EAAqBvW,IAArB,CACI,UAAO+d,YAAP;AAAA,qBAAwB,OAAD,UAAC,CAAD,OAAC,EAAD,MAAC,EAAD,MAAC,uCAAD;AAAA;;AAAA;AAAA;AAAA;AAAA;AACnB,6BAAK96B,GAAL,CAAS,QAAT,EAAmB,WAAnB;AACA,6BAAKA,GAAL,CAAS,cAAT,EAAyB86B,YAAzB;;AACA,6BAAKj/B,YAAL,CAAkB2S,IAAlB,CAAuB,IAAvB;;AAHmB,8BAIf,KAAK+N,QAAL,IAAiB,KAAKA,QAAL,CAAcd,OAAd,CAAsB,2BAAtB,CAJF;AAAA;AAAA;AAAA;;AAKf,6BAAK6X,IAAL,CAAUwH,YAAY,CAACrpB,KAAvB,EAA8BsL,IAA9B,CACI,UAAO9D,IAAP;AAAA,iCAAgB,OAAD,UAAC,CAAD,OAAC,EAAD,MAAC,EAAD,MAAC,uCAAD;AAAA;AAAA;AAAA;AAAA;AACX,yCAAKjZ,GAAL,CAAS,cAAT,EAAyBiZ,IAAzB;;AACA,wCAAI,KAAKsD,QAAL,CAAcd,OAAd,CAAsB,0BAAtB,CAAJ,EAAuD;AACnD,2CAAKuW,QAAL,CAAc,UAAd,EAA0B;AAAA,+CAAM/Y,IAAI,CAACsiC,MAAL,EAAN;AAAA,uCAA1B,EAA+C,IAA/C;AACH;;AAJU;AAKX,2CAAM,KAAKC,aAAL,YAA2B,UAAA3jC,CAAC;AAAA,6CAAI,IAAJ;AAAA,qCAA5B,CAAN;;AALW;AAMX8E,2CAAO;AACPrD,2CAAO,CAACL,IAAR,GAAe;AACXjB,6CAAO,EAAE,0BADE;AAEX5c,2CAAK,EAAE;AAFI,qCAAf;;AAIA,yCAAKmhB,QAAL,CAAcvc,GAAd,CAAkB,SAAlB,EAA6BsZ,OAA7B;;AAXW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAAC,EAAhB;AAAA,yBADJ,EAcI;AAAA,iCAAM,OAAI,CAACta,OAAL,CAAa,MAAb,EAAqB;AAAA,mCAAM,OAAI,CAACmc,IAAL,CAAU,EAAEmgC,KAAZ,EAAmBv+B,IAAnB,CAAwB;AAAA,qCAAMJ,OAAO,EAAb;AAAA,6BAAxB,CAAN;AAAA,2BAArB,EAAqEhc,IAAI,CAACq9B,GAAL,CAAS,IAAT,EAAe,MAAMsd,KAArB,CAArE,CAAN;AAAA,yBAdJ;AALe;AAAA;;AAAA;AAuBf;AACA,4BAAI,KAAK/+B,QAAL,CAAcd,OAAd,CAAsB,0BAAtB,CAAJ,EAAuD;AACnD,+BAAKuW,QAAL,CAAc,UAAd,EAA0B;AAAA,mCAAM8I,YAAY,CAACygB,MAAb,EAAN;AAAA,2BAA1B,EAAuD,IAAvD;AACH;;AA1Bc;AA2Bf,+BAAM,KAAKC,aAAL,YAA2B,UAAA3jC,CAAC;AAAA,iCAAI,IAAJ;AAAA,yBAA5B,CAAN;;AA3Be;AA4Bf8E,+BAAO;AACPrD,+BAAO,CAACL,IAAR,GAAe;AAAEjB,iCAAO,EAAE,0BAAX;AAAuC5c,+BAAK,EAAE;AAA9C,yBAAf;;AACA,6BAAKmhB,QAAL,CAAcvc,GAAd,CAAkB,SAAlB,EAA6BsZ,OAA7B;;AA9Be;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAC,EAAxB;AAAA,aADJ,EAkCI;AAAA,qBAAM,OAAI,CAACta,OAAL,CAAa,MAAb,EAAqB;AAAA,uBAAM,OAAI,CAACmc,IAAL,CAAU,EAAEmgC,KAAZ,EAAmBv+B,IAAnB,CAAwB;AAAA,yBAAMJ,OAAO,EAAb;AAAA,iBAAxB,CAAN;AAAA,eAArB,EAAqEhc,IAAI,CAACq9B,GAAL,CAAS,IAAT,EAAe,MAAMsd,KAArB,CAArE,CAAN;AAAA,aAlCJ;AAoCH,WA7CM,CAAP;AA8CH;;;wCAE6B;;;;;;;;AACpB3C,6B,GAAY,KAAK5d,OAAL,CAAa4d,S;;0BAC3B,CAACA,SAAD,IAAc,CAACA,SAAS,CAACp2C,M;;;;;uDAClB,E;;;AAELk5C,4B,GAA4B,E;6DAChB9C,S;;;AAAlB,gFAA6B;AAAlB+C,2BAAkB;AACzBD,gCAAQ,CAACvzC,IAAT,CAAc,KAAKorB,IAAL,CAAUooB,GAAG,CAACjqC,KAAd,CAAd;AACH;;;;;;;;AACY,2BAAMiL,OAAO,CAACi/B,GAAR,CAAYF,QAAZ,CAAN;;;AAAPl9C,wB;AACN,yBAAKyB,GAAL,CAAS,WAAT,EAAsBzB,IAAtB;AACA,yBAAKyB,GAAL,CAAS,MAAT,EAAiB,OAAA+G,MAAA,CAAO,CAAC,KAAKgP,GAAL,CAAS,MAAT,KAAoB,EAArB,EAAyBoc,MAAzB,CAAgC5zB,IAAhC,CAAP,CAAjB;uDACOA,I;;;;;;;;;AACV;AAED;;;;;;;gCAIkB0d,Q,EAAa;AAC3B,iBAAO,IAAI,aAAAoY,IAAJ,CAASpY,QAAT,CAAP;AACH;;;4BAjKiB;AACd,iBAAO,KAAKlG,GAAL,CAAS,cAAT,CAAP;AACH;AAED;;;;4BACuB;AACnB,iBAAO,KAAKglB,OAAL,IAAgB,KAAKA,OAAL,CAAazoB,EAAb,KAAoB,YAA3C;AACH;;;;MA3B6B,eAAAmL,c;;AAHlC;;;uBAGak9B,Y,EAAY,+B,EAAA,0B,EAAA,wB,EAAA,kC,EAAA,+B;AAAA,K;;;aAAZA,Y;AAAY,eAAZA,YAAY,K;AAAA,kBAFT;;;;;2BAEHA,Y,EAAY;cAHxB,OAAAznC,UAGwB;eAHb;AACR6I,oBAAU,EAAE;AADJ,S;AAGa,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChCzB;AAAA;AAAA;;AAGA,QAAM6/B,SAAS,GAAG,IAAlB;AAEA;;;;;AAIA,aAAgBC,iBAAhB,CAAkCx7C,IAAlC,EAAiD;AAC/C,UAAM2P,IAAI,GAAG,IAAI,UAAAuB,MAAJ,CAAW;AAAElR,YAAI,EAAJA;AAAF,OAAX,CAAb;AACA,aAAO,UAAC8O,CAAD;AAAA,eAAO2sC,YAAY,CAAC3sC,CAAD,EAAI9O,IAAJ,CAAnB;AAAA,OAAP;AACD;;AAHD;AAKA;;;;;;AAKA,aAAgBy7C,YAAhB,CAA6Bpe,OAA7B,EAAuDqe,OAAvD,EAAyE;AACvE,UAAM/rC,IAAI,GAAG,IAAI,UAAAuB,MAAJ,CAAW;AAAClR,YAAI,EAAE07C;AAAP,OAAX,CAAb;AACA,UAAM17C,IAAI,GAAG,IAAI,UAAAkR,MAAJ,CAAW;AAAClR,YAAI,EAAEq9B,OAAO,CAACn6B;AAAf,OAAX,CAAb;AACA,aAAOlD,IAAI,CAACs4B,YAAL,CAAkB3oB,IAAlB,IAA0B;AAAE3P,YAAI,EAAEu7C,SAAR;AAAmB5jC,eAAO,EAAE;AAA5B,OAA1B,GAAmG,IAA1G;AACD;;AAJD;AAMA;;;;;;AAKA,aAAgBgkC,sBAAhB,CAAuC37C,IAAvC,EAAqD07C,OAArD,EAAuE;AACrE,UAAM/rC,IAAI,GAAG,IAAI,UAAAuB,MAAJ,CAAW;AAAClR,YAAI,EAAE07C;AAAP,OAAX,CAAb;AACA,aAAO,UAAC5sC,CAAD;AAAA,eAAO8sC,iBAAiB,CAAC9sC,CAAD,EAAI9O,IAAJ,EAAU2P,IAAI,CAAChG,EAAf,CAAxB;AAAA,OAAP;AACD;;AAHD;AAKA;;;;;;;AAMA,aAAgBiyC,iBAAhB,CAAkCve,OAAlC,EAA4Dr9B,IAA5D,EAA0E07C,OAA1E,EAA4F;AAC1F,UAAM10B,GAAG,GAAG,IAAI,UAAA9V,MAAJ,CAAW;AAAClR,YAAI,EAAE07C;AAAP,OAAX,CAAZ;AACA,UAAM9zC,KAAK,GAAGy1B,OAAO,CAACn6B,KAAR,CAAclB,KAAd,CAAoB,GAApB,CAAd;AACA,UAAM65C,QAAQ,GAAG,IAAI,UAAA3qC,MAAJ,CAAW;AAAClR,YAAI,EAAJA;AAAD,OAAX,CAAjB;AACA,aAAO67C,QAAQ,CAACj7C,QAAT,CAAkB;AAAE0B,YAAI,EAAE,CAACsF,KAAK,CAAC,CAAD,CAAd;AAAmBvH,cAAM,EAAE,CAACuH,KAAK,CAAC,CAAD;AAAjC,OAAlB,EAA0D0wB,YAA1D,CAAuEtR,GAAvE,IAA8E;AACnF9mB,aAAK,EAAEq7C,SAD4E;AAEnF5jC,eAAO,EAAE;AAF0E,OAA9E,GAGH,IAHJ;AAID;;AARD;;AAUA,aAAgBmkC,qBAAhB,GAA2E;AAAA,UAArCne,GAAqC,uEAAvB,EAAuB;AAAA,UAAnBl6B,GAAmB,uEAAL,GAAK;AACzE,aAAO,UAACqL,CAAD;AAAA,eAAOitC,gBAAgB,CAACjtC,CAAD,EAAI6uB,GAAJ,EAASl6B,GAAT,CAAvB;AAAA,OAAP;AACD;;AAFD;;AAIA,aAAgBs4C,gBAAhB,CAAiC1e,OAAjC,EAAgG;AAAA,UAArCM,GAAqC,uEAAvB,EAAuB;AAAA,UAAnBl6B,GAAmB,uEAAL,GAAK;;AAC9F,UAAI45B,OAAO,CAACn6B,KAAR,IAAiBy6B,GAAG,IAAI,EAAxB,CAAJ,EAAiC;AAC/B,eAAO;AAAE58B,kBAAQ,EAAEw6C,SAAZ;AAAuB5jC,iBAAO,wCAAiCgmB,GAAjC,oBAA8CA,GAAG,KAAK,CAAR,GAAY,GAAZ,GAAkB,EAAhE;AAA9B,SAAP;AACD,OAFD,MAEO,IAAIN,OAAO,CAACn6B,KAAR,IAAiBO,GAAG,IAAI,GAAxB,CAAJ,EAAkC;AACvC,eAAO;AAAEvB,gBAAM,EAAEq5C,SAAV;AAAqB5jC,iBAAO,wCAAiClU,GAAjC,oBAA8CA,GAAG,KAAK,CAAR,GAAY,GAAZ,GAAkB,EAAhE;AAA5B,SAAP;AACD;;AACD,aAAO,IAAP;AACD;;AAPD;;AASA,aAAgBu4C,sBAAhB,CAAuC1iC,IAAvC,EAAoE;AAAA,UAAjBqkB,GAAiB,uEAAH,CAAG;AAClE,aAAO,UAAC7uB,CAAD;AAAA,eAAOmtC,iBAAiB,CAACntC,CAAD,EAAIwK,IAAJ,EAAUqkB,GAAV,CAAxB;AAAA,OAAP;AACD;;AAFD;;AAIA,aAAgBse,iBAAhB,CAAkC5e,OAAlC,EAA4D/jB,IAA5D,EAAyF;AAAA,UAAjBqkB,GAAiB,uEAAH,CAAG;;AACvF,UAAI,CAACN,OAAD,IAAY,EAAEA,OAAO,CAACn6B,KAAR,YAAyB6J,KAA3B,CAAhB,EAAmD;AACjD,eAAO4wB,GAAG,GAAG,CAAN,GACH;AAAEue,iBAAO,EAAE,IAAX;AAAiBvkC,iBAAO,uBAAgBgmB,GAAhB,sBAA+BA,GAAG,KAAK,CAAR,GAAY,KAAZ,GAAoB,OAAnD;AAAxB,SADG,GAEH,IAFJ;AAGD;;AACD,UAAMz/B,IAAI,GAAWm/B,OAAO,CAACn6B,KAA7B;;AACA,UAAIoW,IAAJ,EAAU;AACR,YAAM8E,MAAM,GAAGlgB,IAAI,CAACsF,IAAL,CAAU,UAAA2E,CAAC;AAAA,iBAAIA,CAAC,CAACiJ,KAAF,KAAYkI,IAAI,CAAClI,KAArB;AAAA,SAAX,CAAf;;AACA,YAAIgN,MAAJ,EAAY;AACVlgB,cAAI,CAACuO,MAAL,CAAYvO,IAAI,CAACkF,OAAL,CAAagb,MAAb,CAAZ,EAAkC,CAAlC;AACD;AACF;;AACD,aAAOlgB,IAAI,CAACgE,MAAL,IAAey7B,GAAf,GAAqB,IAArB,GAA4B;AACjC51B,aAAK,EAAE,IAD0B;AAEjC4P,eAAO,uBAAgBgmB,GAAhB,sBAA+BA,GAAG,KAAK,CAAR,GAAY,KAAZ,GAAoB,OAAnD;AAF0B,OAAnC;AAID;;AAjBD;;AAmBA,aAAgBtC,eAAhB,CAAgC8gB,aAAhC,EAAgE;AAC9D,aAAO,UAAC9e,OAAD,EAA8B;AACnC;AACA,YAAMrW,GAAG,GAAG,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAZ;AACA,eAAOu8C,aAAa,CAACj5C,KAAd,CAAoBrC,QAApB,CAA6B;AAAEJ,iBAAO,EAAE48B,OAAO,CAACn6B,KAAR,IAAiB;AAA5B,SAA7B,EAA+Do1B,YAA/D,CAA4EtR,GAA5E,IAAkF;AAAEiH,kBAAQ,EAAE;AAAZ,SAAlF,GAAuG,IAA9G;AACD,OAJD;AAKD;;AAND;;AAQA,aAAgBmuB,qBAAhB,CAAsC/e,OAAtC,EAAgE;AAC9D,UAAMn6B,KAAK,GAAGm6B,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEn6B,KAAvB;;AACA,UAAKA,KAAK,KAAK,EAAf,EAAmB;AACf,eAAO,IAAP,CADe,CACF;AAChB;;AACD,UAAMm5C,YAAY,GAAGn5C,KAAK,CAACo5C,IAAN,GAAap6C,MAAb,KAAwB,CAA7C,CAL8D,CAM9D;;AACA,aAAO,CAACm6C,YAAD,GAAgB,IAAhB,GAAuB;AAAEE,kBAAU,EAAE;AAAd,OAA9B;AACD;;AARD;;;;;;;;;;;;;;;;;;;;;;;;ACnGA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACAA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA,aAASh2C,OAAT,CAAiBrD,KAAjB,EAAgChB,MAAhC,EAA8C;AAC1C,UAAIsE,GAAG,aAAMtD,KAAN,CAAP;;AACA,aAAOsD,GAAG,CAACtE,MAAJ,GAAaA,MAApB;AAA4BsE,WAAG,cAAOA,GAAP,CAAH;AAA5B;;AACA,aAAOA,GAAP;AACH;;AASD,QAAMwgB,GAAG,GAAG,IAAIpnB,IAAJ,EAAZ;;QAEasR,M;AAST,sBAAYqF,IAAZ,EAAiC;AAAA;;AALjC,aAAA8Q,WAAA,GAAuB,IAAvB;AAMI,aAAKm1B,QAAL,GAAgB,QAAOjmC,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEvW,IAAb,MAAsB,QAAtB,GAAiC,QAAA2C,QAAA,CAASC,UAAT,CAAoB2T,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEvW,IAA1B,CAAjC,GAAmE,CAAAuW,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEvW,IAAN,IAAauW,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEvW,IAAnB,GAA0B,QAAA2C,QAAA,CAASC,UAAT,CAAoBokB,GAAG,CAACnkB,OAAJ,EAApB,CAA7G;AACA,aAAKwkB,WAAL,GAAmB,CAAA9Q,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAE8Q,WAAN,MAAsB,KAAtB,GAA8B9Q,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAE8Q,WAApC,GAAkD,IAArE;AACA,aAAKqO,OAAL,GAAe,CAAAnf,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEmf,OAAN,KAAiB,KAAhC;AACA,aAAK+mB,QAAL,GAAgB,QAAA95C,QAAA,CAASqkB,GAAT,GAAe01B,QAA/B;AACA,aAAKp1B,WAAL,GAAmB,CAAA/Q,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAE+Q,WAAN,KAAqB,KAAKm1B,QAA7C;AACA,aAAKz8C,IAAL,GAAY,CAAC,KAAKqnB,WAAN,GAAoB,KAAKm1B,QAAL,CAAcvK,OAAd,CAAsB,KAAK3qB,WAA3B,CAApB,GAA8D,KAAKk1B,QAA/E;AACA,aAAK74B,KAAL,GAAa,KAAK3jB,IAAL,CAAU6B,OAAvB;AACH,O,CAED;;;;;iCAsDiB86C,U,EAAoBC,I,EAAyC;AAAA,cAApBC,QAAoB,uEAAT,SAAS;AAC1E,iBAAO,KAAK78C,IAAL,CAAUsD,IAAV,CAAeq5C,UAAU,CAAC38C,IAA1B,EAAgC48C,IAAhC,EAAsCC,QAAtC,CAAP;AACH,S,CAED;;;;qCACqBD,I,EAAoB;AACrC;AACA,cAAIE,OAAO,GAAG,IAAI5rC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBAAK,IAAL,CAAC,EAAQ;AAAElR,gBAAI,EAAE,KAAKA,IAAL,CAAU+8C,OAAV,CAAkBH,IAAlB;AAAR,WAAR,CAAX,CAAd,CAFqC,CAGrC;;AACA,cAAIA,IAAI,KAAK,MAAb,EAAqB;AACjB,gBAAI,KAAKzpB,WAAL,KAAqB,CAAzB,EAA4B;AACxB;AACA2pB,qBAAO,GAAI,IAAI5rC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBAAM,IAAN,CAAC,EAAS;AAAElR,oBAAI,EAAE,KAAKA;AAAb,eAAT,CAAX,CAAX;AACH,aAHD,MAGO,IAAI,KAAKmzB,WAAL,KAAqB,CAAzB,EAA4B;AAC/B;AACA,kBAAM6pB,MAAM,GAAI,IAAI9rC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBAAM,IAAN,CAAC,EAAS;AAAElR,oBAAI,EAAE,KAAKA;AAAb,eAAT,CAAX,CAAhB;AACA88C,qBAAO,GAAGE,MAAM,CAACvrC,aAAP,CAAqB;AAAE4f,oBAAI,EAAE;AAAR,eAArB,CAAV;AACH,aAJM,MAIA;AACH;AACA,kBAAM2rB,OAAM,GAAG,IAAI9rC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBAAK,IAAL,CAAC,EAAQ;AAAElR,oBAAI,EAAE,KAAKA,IAAL,CAAU+8C,OAAV,CAAkBH,IAAlB;AAAR,eAAR,CAAX,CAAf;;AACAE,qBAAO,GAAGE,OAAM,CAACvrC,aAAP,CAAqB;AAAE4f,oBAAI,EAAE;AAAR,eAArB,CAAV;AACH;AACJ;;AAED,iBAAOyrB,OAAP;AACH,S,CAED;;;;mCACmBF,I,EAAoB;AACnC;AACA,cAAIE,OAAO,GAAG,IAAI5rC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBAAK,IAAL,CAAC,EAAQ;AAAElR,gBAAI,EAAE,KAAKA,IAAL,CAAU+8C,OAAV,CAAkBH,IAAlB;AAAR,WAAR,CAAX,CAAd,CAFmC,CAGnC;;AACA,cAAIA,IAAI,KAAK,MAAb,EAAqB;AACjB,gBAAI,KAAKzpB,WAAL,KAAqB,CAAzB,EAA4B;AACxB;AACA2pB,qBAAO,GAAI,IAAI5rC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBAAM,IAAN,CAAC,EAAS;AAAElR,oBAAI,EAAE,KAAKA;AAAb,eAAT,CAAX,CAAX;AACH,aAHD,MAGO,IAAI,KAAKmzB,WAAL,KAAqB,CAAzB,EAA4B;AAC/B;AACA;AACA,kBAAM8pB,MAAM,GAAI,IAAI/rC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBAAM,IAAN,CAAC,EAAS;AAAElR,oBAAI,EAAE,KAAKA;AAAb,eAAT,CAAX,EAAyCa,QAAzC,CAAkD;AAAEwwB,oBAAI,EAAE;AAAR,eAAlD,CAAhB;AACAyrB,qBAAO,GAAGG,MAAM,CAAChtB,UAAP,CAAkB2sB,IAAlB,EAAwBnrC,aAAxB,CAAsC;AAAE4f,oBAAI,EAAE;AAAR,eAAtC,CAAV,CAJ+B,CAI+B;AACjE,aALM,MAKA;AACH;AACA;AACA,kBAAM6rB,KAAK,GAAG,IAAIhsC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBAAK,IAAL,CAAC,EAAQ;AAAElR,oBAAI,EAAE,KAAKA,IAAL,CAAUm9C,KAAV,CAAgBP,IAAhB;AAAR,eAAR,CAAX,CAAd;AACAE,qBAAO,GAAGI,KAAK,CAACzrC,aAAN,CAAoB;AAAE4f,oBAAI,EAAE;AAAR,eAApB,CAAV;AACH;AACJ,WAfD,MAeO;AACHyrB,mBAAO,GAAI,IAAI5rC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBAAK,IAAL,CAAC,EAAQ;AAAElR,kBAAI,EAAE,KAAKA,IAAL,CAAUm9C,KAAV,CAAgBP,IAAhB;AAAR,aAAR,CAAX,CAAX;AACH;;AAED,iBAAOE,OAAP;AACH;;;qCAEgB;AACb,cAAM5E,GAAG,GAAG,IAAIhnC,MAAJ,CAAW;AAAClR,gBAAI,EAAE,KAAKw8C;AAAZ,WAAX,CAAZ;AACA,iBAAO,KAAK9mB,OAAL,GACL,KAAKhsB,YAAL,CAAkB,KAAlB,EAAyBC,EAAzB,GAA8B,KAAKuuB,QAAL,CAAcggB,GAAd,EAAmB,SAAnB,CADzB,GAEL,KAAKvuC,EAFP;AAGH,S,CAED;;;;gCACY;AACR;AACA,iBAAO,KAAK9I,QAAL,CAAc;AAAE6Q,mBAAO,EAAE;AAAX,WAAd,CAAP;AACH,S,CAED;;;;iCACiB3Q,Q,EAAwBq8C,gB,EAA0B;AAC/D,iBAAO,IAAIlsC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBAAK,IAAL,CAAC,EAAQ;AAAElR,gBAAI,EAAEo9C,gBAAgB,GAAG,KAAKp9C,IAAL,CAAUQ,IAAV,CAAeO,QAAf,EAAyBo8C,KAAzB,CAA+B,OAA/B,CAAH,GAA6C,KAAKn9C,IAAL,CAAUQ,IAAV,CAAeO,QAAf;AAArE,WAAR,CAAX,CAAP;AACH,S,CAED;;;;sCACsBA,Q,EAAsB;AACxC,cAAM+7C,OAAO,GAAG,IAAI5rC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBAAK,IAAL,CAAC,EAAQ;AAAElR,gBAAI,EAAE,KAAKA,IAAL,CAAUq9C,KAAV,CAAgBt8C,QAAhB;AAAR,WAAR,CAAX,CAAhB;AACA,iBAAO+7C,OAAP;AACH;;;iCAEgB//B,G,EAAoB;AACjC,cAAM+/B,OAAO,GAAG,IAAI5rC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBAAK,IAAL,CAAC,EAAQ;AAAElR,gBAAI,EAAE,KAAKA,IAAL,CAAUL,GAAV,CAAcod,GAAd;AAAR,WAAR,CAAX,CAAhB;AACA,iBAAO+/B,OAAP;AACH;;;mCAEkB11C,M,EAAc;AAC7B;AACA;AACA;AACA,iBAAO,KAAKpH,IAAL,CAAUQ,IAAV,CAAe;AAAEkR,mBAAO,EAAE;AAAX,WAAf,EAA+B3O,QAA/B,CAAwCqE,MAAxC,CAAP;AACH;;;wCAEuBA,M,EAAc;AAClC;AACA,iBAAO,KAAKpH,IAAL,CAAUQ,IAAV,CAAe;AAAEkR,mBAAO,EAAE;AAAX,WAAf,EAA+BugC,OAA/B,CAAuC,KAAKwK,QAA5C,EAAsD15C,QAAtD,CAA+DqE,MAA/D,CAAP;AACH;;;mCAEiBu1C,U,EAAoBz5C,K,EAAmB;AACrD,iBAAO,KAAKlD,IAAL,CAAUs9C,OAAV,CAAkBX,UAAU,CAAC38C,IAA7B,EAAmCkD,KAAnC,CAAP;AACH;;;oCAEkBy5C,U,EAAoBC,I,EAAmB;AACtD,kBAAQA,IAAR;AACI,iBAAK,MAAL;AACI,qBAAO,KAAKW,QAAL,GAAgBZ,UAAU,CAACY,QAAlC;;AACJ,iBAAK,OAAL;AACI,kBAAG,KAAKhlB,WAAL,CAAiBokB,UAAjB,EAA6B,MAA7B,CAAH,EAAwC;AACpC,uBAAO,IAAP;AACH,eAFD,MAEM,IAAG,CAAC,KAAKpf,UAAL,CAAgBof,UAAhB,EAA4B,MAA5B,CAAJ,EAAwC;AAC1C,uBAAO,KAAP;AACH,eAFK,MAED;AACD,uBAAO,KAAKa,SAAL,GAAiBb,UAAU,CAACa,SAAnC;AACH;;AACL,iBAAK,KAAL;AACI,kBAAG,KAAKjlB,WAAL,CAAiBokB,UAAjB,EAA6B,OAA7B,CAAH,EAAyC;AACrC,uBAAO,IAAP;AACH,eAFD,MAEM,IAAG,CAAC,KAAKpf,UAAL,CAAgBof,UAAhB,EAA4B,OAA5B,CAAJ,EAAyC;AAC3C,uBAAO,KAAP;AACH,eAFK,MAED;AACD,uBAAO,KAAKc,OAAL,GAAed,UAAU,CAACc,OAAjC;AACH;;AACL,iBAAK,MAAL;AACI,kBAAG,KAAKllB,WAAL,CAAiBokB,UAAjB,EAA6B,KAA7B,CAAH,EAAuC;AACnC,uBAAO,IAAP;AACH,eAFD,MAEM,IAAG,CAAC,KAAKpf,UAAL,CAAgBof,UAAhB,EAA4B,KAA5B,CAAJ,EAAuC;AACzC,uBAAO,KAAP;AACH,eAFK,MAED;AACD,uBAAO,KAAK9Q,QAAL,GAAgB8Q,UAAU,CAAC9Q,QAAlC;AACH;;AACL,iBAAK,QAAL;AACI,kBAAG,KAAKtT,WAAL,CAAiBokB,UAAjB,EAA6B,MAA7B,CAAH,EAAwC;AACpC,uBAAO,IAAP;AACH,eAFD,MAEM,IAAG,CAAC,KAAKpf,UAAL,CAAgBof,UAAhB,EAA4B,MAA5B,CAAJ,EAAwC;AAC1C,uBAAO,KAAP;AACH,eAFK,MAED;AACD,uBAAO,KAAKl8C,OAAL,GAAek8C,UAAU,CAACl8C,OAAjC;AACH;;AACL;AACI,qBAAO,KAAKkJ,EAAL,GAAUgzC,UAAU,CAAChzC,EAA5B;AApCR;AAsCH;;;qCAEmBgzC,U,EAAoBC,I,EAAmB;AACvD,kBAAQA,IAAR;AACI,iBAAK,MAAL;AACI,qBAAO,KAAKW,QAAL,GAAgBZ,UAAU,CAACY,QAAlC;;AACJ,iBAAK,OAAL;AACI,kBAAG,KAAKjlB,YAAL,CAAkBqkB,UAAlB,EAA8B,MAA9B,CAAH,EAAyC;AACrC,uBAAO,IAAP;AACH,eAFD,MAEM,IAAG,CAAC,KAAKpf,UAAL,CAAgBof,UAAhB,EAA4B,MAA5B,CAAJ,EAAwC;AAC1C,uBAAO,KAAP;AACH,eAFK,MAED;AACD,uBAAO,KAAKa,SAAL,GAAiBb,UAAU,CAACa,SAAnC;AACH;;AACL,iBAAK,KAAL;AACI,kBAAG,KAAKllB,YAAL,CAAkBqkB,UAAlB,EAA8B,OAA9B,CAAH,EAA0C;AACtC,uBAAO,IAAP;AACH,eAFD,MAEM,IAAG,CAAC,KAAKpf,UAAL,CAAgBof,UAAhB,EAA4B,OAA5B,CAAJ,EAAyC;AAC3C,uBAAO,KAAP;AACH,eAFK,MAED;AACD,uBAAO,KAAKc,OAAL,GAAed,UAAU,CAACc,OAAjC;AACH;;AACL,iBAAK,MAAL;AACI,kBAAG,KAAKnlB,YAAL,CAAkBqkB,UAAlB,EAA8B,KAA9B,CAAH,EAAwC;AACpC,uBAAO,IAAP;AACH,eAFD,MAEM,IAAG,CAAC,KAAKpf,UAAL,CAAgBof,UAAhB,EAA4B,KAA5B,CAAJ,EAAuC;AACzC,uBAAO,KAAP;AACH,eAFK,MAED;AACD,uBAAO,KAAK9Q,QAAL,GAAgB8Q,UAAU,CAAC9Q,QAAlC;AACH;;AACL,iBAAK,QAAL;AACI,kBAAG,KAAKvT,YAAL,CAAkBqkB,UAAlB,EAA8B,MAA9B,CAAH,EAAyC;AACrC,uBAAO,IAAP;AACH,eAFD,MAEM,IAAG,CAAC,KAAKpf,UAAL,CAAgBof,UAAhB,EAA4B,MAA5B,CAAJ,EAAwC;AAC1C,uBAAO,KAAP;AACH,eAFK,MAED;AACD,uBAAO,KAAKl8C,OAAL,GAAek8C,UAAU,CAACl8C,OAAjC;AACH;;AACL;AACI,qBAAO,KAAKkJ,EAAL,GAAUgzC,UAAU,CAAChzC,EAA5B;AApCR;AAsCH;;;+BAEa6hC,E,EAAU;AACpB,cAAMsR,OAAO,GAAG,IAAI5rC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBACnB,IADmB,CAAC,EAChB;AACPlR,gBAAI,EAAE,KAAKA,IAAL,CAAUiyC,OAAV,CAAkBzG,EAAlB,CADC;AAEPlkB,uBAAW,EAAEkkB,EAFN;AAGPnkB,uBAAW,EAAE;AAHN,WADgB,CAAX,CAAhB;AAMA,iBAAOy1B,OAAP;AACH;;;qCAEmB/4C,S,EAAiB;AACjC,cAAM+4C,OAAO,GAAG,IAAI5rC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBACnB,IADmB,CAAC,EAChB;AACPlR,gBAAI,EAAE+D;AADC,WADgB,CAAX,CAAhB;AAIA,iBAAO+4C,OAAP;AACH;;;AAMD;oCACoC;AAAA,cAAlBh9B,KAAkB,uEAAF,EAAE;AAChCpa,iBAAO,CAACV,GAAR,WAAe8a,KAAf,0BAA2C,KAAKjf,QAAL,CAAc;AAAE6Q,mBAAO,EAAE;AAAX,WAAd,EAA8BzG,eAA9B,CAA8C,wBAA9C,CAA3C,EAAoH,KAAKwxC,QAAzH;AACA/2C,iBAAO,CAACV,GAAR,WAAe8a,KAAf,6BAA8C,KAAKjf,QAAL,CAAc;AAAE6Q,mBAAO,EAAE;AAAX,WAAd,EAA8BpQ,UAA9B,CAAyC,wBAAzC,CAA9C,EAAkH,KAAKgmB,WAAvH;AACH;;;4BApQY;AACT,iBAAO,KAAKtnB,IAAL,CAAU6C,OAAV,EAAP;AACH,S,CAED;;;;4BACkB;AACd,iBAAOvC,IAAI,CAACo9C,KAAL,CAAW,KAAK19C,IAAL,CAAU29C,SAAV,EAAX,CAAP;AACH,S,CAED;;;;4BACiB;AACb,iBAAO,KAAK39C,IAAL,CAAUI,MAAjB;AACH,S,CAED;;;;4BACkB;AACd,iBAAO,KAAKJ,IAAL,CAAUK,MAAjB;AACH,S,CAED;;;;4BACgB;AACZ,iBAAO,KAAKL,IAAL,CAAUsC,IAAjB;AACH;;;4BAEa;AACV,cAAMw6C,OAAO,GAAG,IAAI5rC,MAAJ,CAAW,MAAD,OAAC,CAAD,kBAAK,IAAL,CAAC,EAAQ;AAAElR,gBAAI,EAAE,KAAKA,IAAL,CAAU49C,KAAV;AAAR,WAAR,CAAX,CAAhB;AACA,iBAAOd,OAAO,CAACprC,OAAf;AACH;;;4BAEiB;AACd,iBAAO,KAAK1R,IAAL,CAAUmE,GAAjB;AACH;;;4BAEkB;AACf,iBAAO,KAAKnE,IAAL,CAAUsC,IAAjB;AACH;;;4BAEkB;AACf,iBAAO,KAAKtC,IAAL,CAAUqC,IAAjB;AACH;;;4BAEqB;AAClB,cAAI;AACA,mBAAO,KAAKrC,IAAL,CAAU8E,OAAjB;AACH,WAFD,CAEE,OAAOuF,CAAP,EAAU;AACR,mBAAO,KAAKrK,IAAL,CAAU69C,QAAV,GAAqBC,MAArB,EAAP;AACH;AACJ;;;4BAEmB;AAChB,iBAAO,KAAK99C,IAAL,CAAUoC,KAAjB;AACH;;;4BAyMgB;AACb,iBAAO,KAAKpC,IAAL,CAAU69C,QAAV,EAAP;AACH;;;;;;AAlRL;;AA2Ra,YAAAp0C,OAAA,GAAU,YAA6B;AAAA,UAA5BzJ,IAA4B,uEAAf,IAAIJ,IAAJ,EAAe;AAChD,aAAO,IAAIsR,MAAJ,CAAW;AAAClR,YAAI,EAAEA,IAAI,CAAC6C,OAAL;AAAP,OAAX,CAAP;AACH,KAFY,C,CAIb;;;AACa,YAAAk7C,sCAAA,GAAyC,UAACh6C,SAAD,EAAoBi6C,gBAApB,EAAyD;AAC3G,UAAMh+C,IAAI,GAAG,IAAIJ,IAAJ,CAASmE,SAAT,CAAb;AACA,aAAO,IAAImN,MAAJ,CAAW;AAAElR,YAAI,EAAE+D,SAAR;AAAmBujB,mBAAW,EAAE02B,gBAAhC;AAAkD32B,mBAAW,EAAE;AAA/D,OAAX,EAAmFzmB,QAAnF,CAA4F;AAC/FuD,WAAG,EAAEnE,IAAI,CAACoE,OAAL,EAD0F;AAE/F9B,YAAI,EAAEtC,IAAI,CAACosC,QAAL,EAFyF;AAG/F/rC,cAAM,EAAEL,IAAI,CAACssC,UAAL;AAHuF,OAA5F,CAAP;AAKH,KAPY,C,CASb;;;AACa,YAAA2R,sCAAA,GAAyC,UAACl6C,SAAD,EAAoBi6C,gBAApB,EAAyD;AAC3G,UAAMvB,QAAQ,GAAG,QAAA95C,QAAA,CAASqkB,GAAT,GAAe01B,QAAhC;AACA,UAAMwB,WAAW,GAAG,cAAAC,iBAAA,CAAkB1B,QAAlB,EAA4B,IAAI78C,IAAJ,CAASmE,SAAT,CAA5B,CAApB;AACA,UAAMq6C,aAAa,GAAG,cAAAD,iBAAA,CAAkBH,gBAAlB,EAAoC,IAAIp+C,IAAJ,CAASmE,SAAT,CAApC,CAAtB;;AACA,UAAIm6C,WAAW,GAAGE,aAAlB,EAAiC;AAC7B,YAAMC,IAAI,GAAGt6C,SAAS,IAAIm6C,WAAW,GAAGE,aAAlB,CAAtB;AACA,eAAQ,IAAIltC,MAAJ,CAAW;AAAClR,cAAI,EAAEq+C,IAAP;AAAa/2B,qBAAW,EAAE02B,gBAA1B;AAA4C32B,qBAAW,EAAE;AAAzD,SAAX,CAAR;AACH,OAHD,MAGO;AACH,YAAMg3B,KAAI,GAAGt6C,SAAS,IAAIq6C,aAAa,GAAGF,WAApB,CAAtB;;AACA,eAAQ,IAAIhtC,MAAJ,CAAW;AAAClR,cAAI,EAAEq+C,KAAP;AAAa/2B,qBAAW,EAAE02B,gBAA1B;AAA4C32B,qBAAW,EAAE;AAAzD,SAAX,CAAR;AACH;AACJ,KAXY;;AAaA,YAAAi3B,aAAA,GAAgB,YAAM;AAC/B,aAAO5qB,IAAI,CAACC,cAAL,GAAsBC,eAAtB,GAAwCC,QAA/C;AACH,KAFY;;AAIA,YAAAmE,uBAAA,GAA0B,UAACwT,EAAD,EAAgB;AACnD,UAAM+S,cAAc,GAAGj+C,IAAI,CAACY,KAAL,CAAW,cAAAi9C,iBAAA,CAAkB3S,EAAlB,IAAwB,IAAxB,GAA+B,EAA1C,CAAvB;AACA,UAAMnkC,KAAK,GAAG/G,IAAI,CAACY,KAAL,CAAWq9C,cAAc,GAAC,EAA1B,CAAd;AACA,UAAM99C,OAAO,GAAG89C,cAAc,GAAG,EAAjC;AACA,uBAAUA,cAAc,GAAG,CAAjB,GAAqB,GAArB,GAA2B,GAArC,SAA2Ch4C,OAAO,CAACjG,IAAI,CAAC23B,GAAL,CAAS5wB,KAAT,CAAD,EAAkB,CAAlB,CAAlD,SAAyEd,OAAO,CAAC9F,OAAD,EAAU,CAAV,CAAhF;AACH,KALY;;AAOb,aAAgB+9C,WAAhB,GAAuD;AAAA,UAA3Bt7C,KAA2B,uEAAX,QAAAuG,OAAA,EAAW;AACnD;AACA,aAAOvG,KAAK,CAACokB,WAAN,CAAkBxN,QAAlB,CAA2B,UAA3B,IAAyC5W,KAAzC,GAAkD,IAAIgO,MAAJ,CAAW;AAChElR,YAAI,EAAEkD,KAAK,CAACtC,QAAN,CAAe;AAAE0B,cAAI,EAAE,EAAR;AAAYjC,gBAAM,EAAE;AAApB,SAAf,EAAwCsJ,EADkB;AAEhE0d,mBAAW,EAAE,KAFmD;AAGhEC,mBAAW,EAAE;AAHmD,OAAX,EAItD1mB,QAJsD,CAI7C;AAAE0B,YAAI,EAAE,EAAR;AAAYjC,cAAM,EAAE;AAApB,OAJ6C,CAAzD;AAKH;;AAPD;AASA;;AACA,aAAgBo+C,cAAhB,CAA+BjT,EAA/B,EAAyC;AACrC,UAAMjY,KAAK,GAAG,QAAA9pB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAd;AACA,UAAM8D,MAAM,GAAG6vB,KAAK,CAACvzB,IAAN,CAAW0D,MAAX,GAAoB6vB,KAAK,CAACnpB,MAAN,CAAaohC,EAAb,EAAiBxrC,IAAjB,CAAsB0D,MAAzD;AACA,aAAO;AAACjD,eAAO,EAAEiD,MAAV;AAAkB2D,aAAK,EAAE3D,MAAM,GAAC;AAAhC,OAAP;AACH;;AAJD;;AAMA,aAAgBmB,OAAhB,CAAyB7E,IAAzB,EAA+B4E,QAA/B,EAAyC;AAErC,aAAO,IAAIsM,MAAJ,CAAW;AACdlR,YAAI,EAAEw+C,WAAW,CAACx+C,IAAD,CAAX,CAAkB2J,EADV;AAEd0d,mBAAW,EAAE,KAFC;AAGdC,mBAAW,EAAE1iB;AAHC,OAAX,EAIJ24B,UAJI,CAKH,IAAIrsB,MAAJ,CAAW;AACPlR,YAAI,EAAEJ,IAAI,CAAConB,GAAL,EADC;AAEPK,mBAAW,EAAE,KAFN;AAGPC,mBAAW,EAAE1iB;AAHN,OAAX,CALG,EAUH,KAVG,CAAP;AAYH;;AAdD;;;;;;;;;;;;;;;;;;;;;;;;ACpWA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACFA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;QAMa85C,iB;;;;AAJb;;YAIaA;;;;yBAAAA,iB;AAAiB,O;AAAA,iBAFf,E;AAAE,gBADJ,CAAC,SAAAzjD,YAAD,CACI;;;;+EAEJyjD,iB,EAAiB;AAAA,kBAHhB,SAAAzjD,YAGgB;AAAA,O;AAHJ,K;;;;;2BAGbyjD,iB,EAAiB;cAJ7B,OAAAxjD,QAI6B;eAJpB;AACNC,iBAAO,EAAE,CAAC,SAAAF,YAAD,CADH;AAEN0jD,mBAAS,EAAE;AAFL,S;AAIoB,Q;;;;;;;;;;;;;;;;;;;;;;ACP9B;AAAA;AAAA;;;;;;AAMa,YAAAC,iBAAA,GAAoB,2BAApB;;QAKAC,kB;AAUT,kCAA+CC,WAA/C,EAA6E;AAAA;;AAA9B,aAAAA,WAAA,GAAAA,WAAA;AAC9C;;;;4BAToB;AACjB,iBAAO,KAAKA,WAAL,CAAiBC,UAAxB;AACH;;;4BAEoB;AACjB,iBAAO,KAAKD,WAAL,CAAiBnkC,UAAxB;AACH;;;;;;AAXL;;;uBAGakkC,kB,EAAkB,YAUP,QAAAD,iBAVO,C;AAUU,K;;;aAV5BC,kB;AAAkB,eAAlBA,kBAAkB,K;AAAA,kBAFf;;;;;2BAEHA,kB,EAAkB;cAH9B,OAAAhsC,UAG8B;eAHnB;AACR6I,oBAAU,EAAE;AADJ,S;AAGmB,Q;;;;kBAUd,OAAAmzB,M;mBAAO,QAAA+P,iB;;;;;;;;;;;;;;;;;;;;;;;QCrBxB;;AACA;;AACa,YAAApQ,OAAA,GAAU;AACnB,eAAS,KADU;AAEnB,aAAO,WAFY;AAGnB,cAAQ,WAHW;AAInB,kBAAY,IAJO;AAKnB,aAAO,IALY;AAMnB,gBAAU,IANS;AAOnB,gBAAU,WAPS;AAQnB,sBAAgB,IARG;AASnB,iBAAW,OATQ;AAUnB,cAAQ;AAVW,KAAV;AAYb;;;;;;;;;;;;;;;;;;;;;;;;;ACdA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;ACTA;AAAA;AAAA;;AAOA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAqBA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvBgB;AAAqC;AAAU;;;;;;AAC/C;AAAoD;AAAU;;;;;;AAElE;AAAgD;AAAiC;;;;;;AAGrE;AAA4B;AAAC;;;;;;AAI9B;AAA2B;AAAC;;;;;;AAItB;AAAiC;AAAC;;;;;;;;AAEnD;AAGI;AAAA;AAAA;AAAA;AAAA;AAEA;AACJ;;;;;;AATJ;AACI;AAAO;AAAU;AAAyC;AAAC;AAC3D;AAAmB;AAAgB;AACnC;AAOJ;;;;;AAT2B;AAAA;AACJ;AAAA;AAGf;AAAA;;;;;;AAOW;AAA+B;AAAC;;;;;;AAKL;AAA+B;AAAC;;;;;;AAO9D;AAKI;AACJ;;;;;;AAHI;;;;;;AAIJ;AAeI;AACJ;;;;;;AAbI;;;;;;AAZR;AACI;AAAuC;AAAsB;AAC7D;AAOA;AAiBJ;;;;;;AAzBsB;AAAA;AAAqB;AAAA;AAGnC;AAAA;AAOA;AAAA;;;;;;AAgBR;AAA8C;AAAY;;;;;;;;AAE9D;AAGI;AAAA;AAAA;AAAA;AAAA;AAEA;AACJ;;;;;AADI;AAAA;;;;;;AAKG;AAAgC;AAAC;;;;;;AAI5B;AAAgC;AAAC;;;;;;AADrD;AACI;AAAO;AAAS;AAAwC;AAAC;AACzD;AACI;AACJ;AACJ;;;;;AAJ0B;AAAA;AACH;AAAA;AACf;AAAA;;;;;;AAKyC;AAAgC;AAAC;;;;;;AAI1E;AAA8C;AAAoB;;;;;;AAStD;AACI;AAAiE;AAE/D;AACN;;;;;;AAHO;AAAA;AAA8D;AAAA;;;;;;AAR7E;AAKI;AACI;AAAkB;AAAe;AACjC;AAKJ;AACJ;;;;;AAVI;AAGsB;AAAA;AACC;AAAA;;;;;;;;AAQ/B;AAGI;AAAA;AAAA;AAAA;AAAA;AAEA;AACJ;;;;;AADI;AAAA;;;;;;AAO2D;AAAsB;AAAE;;;;;;AAAvF;AAAmD;AAAY;AACnE;;;;;;AADuD;AAAA;AAAkB;AAAA;;;;;;AAK7D;AAA2B;AAAC;;;;;;AAKU;AAA+B;AAAC;;;;;;AAK1E;AACI;AACI;AAAkB;AAAyC;AAC3D;AACI;;AAEJ;AACJ;AACJ;;;;;AAN0B;AAAA;AAEd;AAAA;;;;;;;;AAMhB;AAGI;AAAA;AAAA;AAAA;AAAA;AAEA;AACJ;;;;;AADI;AAAA;;;;;;;;;;;;;;AAvKpB;AACI;AACI;AACI;AAGJ;AACA;AACI;AASA;AACI;AACA;AACA;AACJ;AACA;AACJ;AACA;AACI;AAAO;AAAK;AAAoC;AAAC;AACjD;AAAmB;AAAyB;AAChD;AACA;AACI;AAAO;AAAI;AAAmC;AAAC;AAC/C;AAAmB;AAAU;AACjC;AACA;AAWA;AACI;AAAO;AAAQ;AAAuC;AAAC;AACvD;AAAmB;AAAc;AACrC;AACA;AACI;AACK;AAAqC;AACrC;AAAC;AAEN;AACI;AACI;AA2BA;AACJ;AACA;AAOJ;AACJ;AACA;AACI;AAAO;AAAI;AAAwC;AAAC;AACpD;AAAmB;AAAyC;AAChE;AACA;AAMA;AACI;AACK;AAAwC;AACxC;AAAC;AAEN;AACI;AACA;AACI;AAcJ;AACA;AAOJ;AACJ;AACA;AACI;AAAO;AAAyC;AAChD;AACI;AAEJ;AACJ;AACA;AACI;AAAO;AAAK;AAAmC;AAAC;AAChD;AACJ;AACA;AACI;AACK;AAA6C;AAC7C;AAAC;AAEN;AACI;AACI;AASJ;AACA;AAOJ;AACJ;AACJ;AACJ;;;;;AAxKgB;AAAA;AAKA;AAAA;AAUM;AAAA;AACgB;AAAA;AAER;AAAA;AAGA;AAAA;AACC;AAAA;AAGF;AAAA;AACE;AAAA;AAEQ;AAAA;AAYN;AAAA;AACF;AAAA;AAId;AAAA;AAA2C;AAAA;AAI1B;AAAA;AACS;AAAA;AA2BA;AAAA;AAIvB;AAAA;AAQS;AAAA;AACE;AAAA;AAEQ;AAAA;AAQtB;AAAA;AAA8C;AAAA;AAIzC;AAAA;AACY;AAAA;AAGV;AAAA;AAeJ;AAAA;AAQD;AAAA;AAEG;AAAA;AAKQ;AAAA;AACC;AAAA;AAId;AAAA;AAAmD;AAAA;AAIlC;AAAA;AACS;AAAA;AAYvB;AAAA;;;;;;;;AAWZ;AACI;AAAoF;AAAI;AACxF;AAA+D;AAAA;AAAA;AAAA;AAAA;AAAwB;AAAI;AAC/F;;;;;AAFuC;AAAA;AACJ;AAAA;;;;;;AAJ3C;AACI;AACI;AAIJ;AACJ;;;;;;;;AALsB;AAAA,+CAAsC,UAAtC,EAAsC,GAAtC;;;;;;AAOlB;AACI;AACI;AACI;AACJ;AACA;AACI;AACJ;AACJ;AACJ;;;;;AAHY;AAAA;;;;;;AAMZ;AAA+D;AAAK;;;;;;;;AACpE;AACI;AAA8C;AAAA;AAAA;AAAA;AAAA;AAAuB;AAAW;AAChF;AAAsC;AAAA;AAAA;AAAA;AAAA;AAAuB;AAAM;AACvE;;;;;;AAJA;AACA;;;;;AADoC;AACtB;AAAA;;;;QDpILwQ,uB;;;;;AA4JT,uCACY9iC,QADZ,EAEY8sB,MAFZ,EAGYja,IAHZ,EAIYM,SAJZ,EAKY4vB,sBALZ,EAMYjwB,OANZ,EAOYkwB,OAPZ,EAQYC,OARZ,EASYC,WATZ,EAUqC5W,KAVrC,EAWWrvB,QAXX,EAYYkmC,kBAZZ,EAYkD;AAAA;;AAAA;;AAE9C;AAbQ,gBAAAnjC,QAAA,GAAAA,QAAA;AACA,gBAAA8sB,MAAA,GAAAA,MAAA;AACA,gBAAAja,IAAA,GAAAA,IAAA;AACA,gBAAAM,SAAA,GAAAA,SAAA;AACA,gBAAA4vB,sBAAA,GAAAA,sBAAA;AACA,gBAAAjwB,OAAA,GAAAA,OAAA;AACA,gBAAAkwB,OAAA,GAAAA,OAAA;AACA,gBAAAC,OAAA,GAAAA,OAAA;AACA,gBAAAC,WAAA,GAAAA,WAAA;AACyB,gBAAA5W,KAAA,GAAAA,KAAA;AAC1B,gBAAArvB,QAAA,GAAAA,QAAA;AACC,gBAAAkmC,kBAAA,GAAAA,kBAAA;AAvKZ;;AACiB,gBAAA3xC,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AAmBjB,gBAAAC,kBAAA,GAA8B,KAA9B;AAsJI,gBAAK5qC,OAAL,CAAaye,YAAb,GACI,QAAKosB,WAAL,KACC,QAAKA,WAAL,CAAiB50C,WAAjB,CAA6BjB,EAA7B,KAAoC,QAAKgL,OAAL,CAAa/J,WAAb,CAAyBjB,EAA7D,IACG,QAAK61C,WAAL,CAAiBz+C,QAAjB,KAA8B,QAAK4T,OAAL,CAAa5T,QAF/C,CADJ,CAH8C,CAO9C;;AAEA,YAAMwiB,KAAK,GAAG,cAAAC,aAAA,CAAc;AAAE5K,cAAI,EAAE,QAAKA,IAAb;AAAmBsK,eAAK,EAAE,QAAKvO,OAAL,CAAage,IAAvC;AAA6C5xB,kBAAQ,EAAE;AAAvD,SAAd,CAAd;AACA,gBAAK0+C,UAAL,GAAkB,QAAKtmC,QAAL,CAAc0E,SAAd,GAA0B,KAA1B,GAAkC0F,KAAK,CAACoB,YAA1D;AAV8C;AAWjD;AA5JD;;;;;mCA8JQ;AACJ,eAAK+6B,QAAL,GAAgB,KAAK/qC,OAAL,CAAa6P,MAAb,KAAwB,cAAAuU,cAAA,CAAe2mB,QAAvD;AACA,eAAK3sB,QAAL,GAAgB,KAAKpe,OAAL,CAAa6P,MAAb,KAAwB,cAAAuU,cAAA,CAAehG,QAAvD,CAFI,CAGJ;;AAHI,8BAI2C,KAAKpe,OAJhD;AAAA,cAIG4f,OAJH,iBAIGA,OAJH;AAAA,cAIYD,SAJZ,iBAIYA,SAJZ;AAAA,cAIuBU,gBAJvB,iBAIuBA,gBAJvB;AAKJ,eAAK2qB,cAAL,GAAsB;AAClBC,oBAAQ,EAAE;AACN3zC,qBAAO,EAAEsoB,OAAO,KAAMA,OAAO,CAACnjB,KAAR,KAAkBkjB,SAAS,CAACljB,KAA5B,IAAsCmjB,OAAO,CAACnjB,KAAR,KAAkBkjB,SAAS,CAACljB,KAA5B,IAAsC4jB,gBAAgB,KAAK,IAArB,IAA6BA,gBAAgB,KAAI/yB,SAAvF,IAAsGqyB,SAAS,CAACljB,KAAV,KAAmB4jB,gBAAgB,CAAC,OAAD,CAArL,CADV;AAEN9xB,mBAAK,EAAGqxB,OAAO,CAACnjB,KAAR,KAAkBkjB,SAAS,CAACljB,KAA5B,IAAqC4jB,gBAAgB,KAAK,IAA1D,IAAmEA,gBAAgB,CAAC,OAAD,CAAhB,IAA6BV,SAAS,CAACljB,KAAV,KAAmB4jB,gBAAgB,CAAC,OAAD,CAApI,GAAoJA,gBAAgB,CAAC,MAAD,CAAhB,IAA4BA,gBAAgB,CAAC,OAAD,CAAhM,GAA8M,CAAAT,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEx4B,IAAT,KAAiBw4B,OAAO,CAACnjB;AAFxO;AADQ,WAAtB;AAMH;AAED;;;;;;sCAGqB;AAAA;;AACjB,eAAK6H,OAAL,GAAe,0CAAf;AACA,eAAKmmC,WAAL,CAAiBS,YAAjB,GAAgC,IAAhC;AACA,eAAKC,sBAAL,GAA8BpjC,IAA9B,CACI,YAAM;;;AACF,mBAAI,CAACzD,OAAL,GAAe,+BAAf,CADE,CAEF;;AACA,gBAAM8mC,QAAQ,GAAG,OAAI,CAACprC,OAAL,CAAauO,KAAb,CAAmB9R,KAApC;AACA,gBAAM4uC,cAAc,GAAG,CAAC,OAAD,EAAU,WAAV,EAAuB,iBAAvB,CAAvB;AACAA,0BAAc,CAAC5hD,OAAf,CAAuB,UAAA1C,GAAG,EAAI;AAC1B,kBAAMqhB,GAAG,GAAG,OAAI,CAACpI,OAAL,CAAajZ,GAAb,CAAZ;;AACA,kBAAIqhB,GAAG,IAAIA,GAAG,CAACkjC,WAAJ,KAAoBjzC,MAA/B,EAAuC;AACnC,oBAAMpH,IAAI,GAAGoH,MAAM,CAACpH,IAAP,CAAYmX,GAAZ,CAAb;;AACA,oBAAInX,IAAI,CAAC1D,MAAL,GAAc,CAAlB,EAAqB;AACjB,sBAAMg+C,WAAW,GAAG,EAApB;AACAt6C,sBAAI,CAACxH,OAAL,CAAa,UAAA+hD,EAAE,EAAI;AACfD,+BAAW,CAACH,QAAD,CAAX,GAAwBhjC,GAAG,CAACojC,EAAD,CAA3B;AACH,mBAFD;AAGA,yBAAI,CAACxrC,OAAL,CAAajZ,GAAb,IAAoBwkD,WAApB;AACH;AACJ;AACJ,aAZD,EALE,CAmBF;;AACA,gBAAME,eAAe,GAAI,OAAI,CAACzrC,OAAL,CAAa8f,KAAb,KAAkB,MAAI,OAAI,CAAC9f,OAAL,CAAa8f,KAAjB,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAEvyB,MAA1C,CAAD,IAAuD,OAAI,CAACyS,OAAL,CAAamhB,QAAb,KAAqB,MAAI,OAAI,CAACnhB,OAAL,CAAamhB,QAAjB,MAAyB,IAAzB,IAAyB,aAAzB,GAAyB,MAAzB,GAAyB,GAAE5zB,MAAhD,CAAvD,uBAAmH,CAAD,WAAC,OAAI,CAACyS,OAAN,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEuO,KAAd,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAE9R,KAAxI,EAAgJ,GAAhJ,IAAwJ,IAAhL,CApBE,CAoBoL;;AACtL,gBAAIgvC,eAAJ,EAAqB;AACnB,qBAAI,CAACzrC,OAAL,CAAa+F,KAAb,GAAqB0lC,eAArB;AACA,qBAAI,CAACzrC,OAAL,CAAaiZ,SAAb,GAAyBwyB,eAAzB;AACD;;AAED,mBAAI,CAAC/wB,SAAL,CAAe4lB,IAAf,CAAoB,OAAI,CAACtgC,OAAzB,EAAkC,OAAI,CAAC6zB,KAAL,CAAWv3B,MAAX,KAAsB,cAAAwW,YAAA,CAAaC,IAArE,EAA2EhL,IAA3E,CACI,UAAOyR,GAAP;AAAA,qBAAe,OAAD,UAAC,CAAD,OAAC,EAAD,MAAC,EAAD,MAAC,uCAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AACV,6BAAKlV,OAAL,GAAe,IAAf;AACA,6BAAK7D,OAAL,GAAe,IAAf;AACA,6BAAKgqC,WAAL,CAAiBS,YAAjB,GAAgC,KAAhC;AACMQ,+BAJI,GAIM,IAAI,cAAA37B,OAAJ,CAAY,MAAD,OAAC,CAAD,kBAAM,KAAK/P,OAAX,CAAC,EAAsBwZ,GAAG,CAACyR,SAAJ,EAAtB,CAAZ,CAJN;;AAKV,6BAAKqf,sBAAL,CAA4Bh2C,OAA5B,CAAoCo3C,OAApC;AAEA;;;;;AAPU,8BAUPA,OAAO,CAAC/xB,oBAAR,KAAiC,IAV1B;AAAA;AAAA;AAAA;;AAAA;AAYiB,+BAAM,KAAKe,SAAL,CAAe4D,IAAf,CAAoBotB,OAAO,CAAC/xB,oBAA5B,CAAN;;AAZjB;AAYAgyB,sCAZA;;AAaN,6BAAKrB,sBAAL,CAA4Bh2C,OAA5B,CAAoCq3C,cAApC;;AAbM;AAgBV,4BAAInyB,GAAG,CAAC5H,YAAJ,IAAoB4H,GAAG,CAACL,eAAJ,KAAwB,QAAhD,EAA0D;AACtD,+BAAKmxB,sBAAL,CAA4BsB,QAA5B;;AACA,+BAAKlB,kBAAL,CAAwBmB,WAAxB,CAAoC,cAAAnc,SAAA,CAAUoc,cAA9C;AACH;;AAEDxmC,oCAAY,CAACmF,UAAb,CAAwB,6BAAxB;AACA,6BAAK1R,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,gCAAM,EAAE;AAAV,yBAAhB;;AACA,6BAAKxH,QAAL,CAAc03B,aAAd,wBACoB,KAAKj/B,OAAL,CAAa1C,EAAb,GAAkB,SAAlB,GAA8B,SADlD;;AAvBU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAC,EAAf;AAAA,aADJ,EA4BI,UAAC6L,GAAD,EAAS;AAEL,qBAAI,CAACshC,WAAL,CAAiBS,YAAjB,GAAgC,KAAhC;AACA,kBAAIc,WAAW,GAAW,EAA1B;;AACA,sBAAO7iC,GAAG,CAAC0G,MAAX;AACX,qBAAK,GAAL;AACCm8B,6BAAW,GAAG,+IAAd;AACA;;AACD,qBAAK,GAAL;AACCA,6BAAW,GAAG,wFAAd;AACA,yBAAI,CAACpB,kBAAL,GAA0B,IAA1B;AACA;AAPU;;AASA,qBAAI,CAACtmC,OAAL,GAAe0nC,WAAf;;AACA,qBAAI,CAACzkC,QAAL,CAAc23B,WAAd,iBACa,OAAI,CAACl/B,OAAL,CAAa1C,EAAb,GAAkB,UAAlB,GAA+B,UAD5C,uBACmE0uC,WADnE;;AAGDxkD,wBAAU,CAAC,YAAK;AACf,uBAAI,CAAC8c,OAAL,GAAe,IAAf;;AACA,uBAAI,CAACvL,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,wBAAM,EAAE;AAAV,iBAAhB;AACA,eAHS,EAGP,IAHO,CAAV;AAIF,aAjDL;AAmDH,WA9EL,EA+EI,UAAC5F,GAAD,EAAS;AAEL,mBAAI,CAACyhC,kBAAL,GAA0B,IAA1B;AACA,mBAAI,CAACH,WAAL,CAAiBS,YAAjB,GAAgC,KAAhC;AACA,gBAAMc,WAAW,GAAG,wFAApB;AACA,mBAAI,CAAC1nC,OAAL,GAAe0nC,WAAf;;AACA,mBAAI,CAACzkC,QAAL,CAAc23B,WAAd,iBACa,OAAI,CAACl/B,OAAL,CAAa1C,EAAb,GAAkB,UAAlB,GAA+B,UAD5C,uBACmE0uC,WADnE;;AAGDxkD,sBAAU,CAAC,YAAK;AACf,qBAAI,CAAC8c,OAAL,GAAe,IAAf;;AACA,qBAAI,CAACvL,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,sBAAM,EAAE;AAAV,eAAhB;AACA,aAHS,EAGP,IAHO,CAAV;AAIF,WA5FL;AA8FH;AAED;;;;;;qCAGoB;AAChB,eAAKw7B,OAAL,CAAapL,QAAb,CAAsB,CAAC,OAAD,EAAU,QAAV,CAAtB;;AACA,eAAKsL,WAAL,CAAiBhb,KAAjB;AACH;AAED;;;;;;qCAGoB;AAChB,eAAK8a,OAAL,CAAapL,QAAb,CAAsB,CAAC,WAAD,CAAtB,EAAqC;AACjC8M,uBAAW,EAAE;AAAExvC,mBAAK,EAAE,KAAKuD,OAAL,CAAa2f,SAAb,CAAuBljB;AAAhC;AADoB,WAArC;;AAGA,eAAKguC,WAAL,CAAiBhb,KAAjB;AACH;AAED;;;;;;iDAG6B;AAAA;;AACzB,cAAM/hB,MAAM,GAAY,KAAKA,MAA7B;;AACA,cACK,KAAK1N,OAAL,CAAa1C,EAAb,IACI,KAAK0C,OAAL,CAAa/J,WAAb,CAAyBjB,EAAzB,KAAgC,KAAK61C,WAAL,CAAiB50C,WAAjB,CAA6BjB,EAA7D,IACG,KAAKgL,OAAL,CAAa5T,QAAb,KAA0B,KAAKy+C,WAAL,CAAiBz+C,QAFnD,IAGCshB,MAAM,IAAIA,MAAM,CAACngB,MAAP,IAAiB,CAJhC,EAKE;AACE,mBAAOma,OAAO,CAACC,OAAR,EAAP;AACH;;AACD,iBAAO,IAAID,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC;AACA,gBAAMmZ,OAAO,GAAG,OAAI,CAAC/gB,OAAL,CAAa+gB,OAA7B,CAFoC,CAGpC;;AACA,mBAAI,CAAC1G,OAAL,CACKnK,SADL,CACe;AACP8I,sBAAQ,EAAEtL,MAAM,CAACxc,GAAP,CAAW,UAACqd,KAAD;AAAA,uBAAWA,KAAK,CAACjR,EAAjB;AAAA,eAAX,EAAgC5I,IAAhC,CAAqC,GAArC,CADH;AAEP1I,oBAAM,EAAE,OAAI,CAACgU,OAAL,CAAa/J,WAFd;AAGP7J,sBAAQ,EAAE20B,OAAO,GAAG,KAAK,EAAR,GAAa,OAAI,CAAC/gB,OAAL,CAAa5T,QAHpC;AAIPgmB,oBAAM,EAAE,OAAI,CAACpS,OAAL,CAAaoZ,OAJd;AAKPpH,8BAAgB,EAAE,OAAI,CAAChS,OAAL,CAAagS,gBALxB;AAMPH,+BAAiB,EAAE,OAAI,CAAC7R,OAAL,CAAa6R,iBANzB;AAOPE,8BAAgB,EAAE,OAAI,CAAC/R,OAAL,CAAa+R,gBAPxB;AAQPD,iCAAmB,EAAE,OAAI,CAAC9R,OAAL,CAAa8R,mBAR3B;AASPG,+BAAiB,EAAE,OAAI,CAACjS,OAAL,CAAaiS,iBATzB;AAUPL,0BAAY,EAAE,OAAI,CAAC5R,OAAL,CAAa4R,YAVpB;AAWPO,6BAAe,EAAE,OAAI,CAACnS,OAAL,CAAamS;AAXvB,aADf,EAcKpK,IAdL,CAeQ,UAACwU,UAAD,EAAgB;AAAA,2DACQA,UADR;AAAA;;AAAA;AACZ,0EAAgC;AAAA,sBAArBhO,KAAqB;;AAC5B,sBAAI,CAACA,KAAK,CAACgB,QAAX,EAAqB;AACjB,2BAAI,CAACq7B,kBAAL,GAA0B,IAA1B;AACA,2BAAOhjC,MAAM,WACN2G,KAAK,CAACnnB,IADA,kDAAb;AAGH;AACJ;AARW;AAAA;AAAA;AAAA;AAAA;;AASZ,kBAAIm1B,UAAU,CAAChvB,MAAX,GAAoBmgB,MAAM,CAACngB,MAA/B,EAAuC;AACnC,uBAAI,CAACq9C,kBAAL,GAA0B,IAA1B;AACA,uBAAOhjC,MAAM,WACN8F,MAAM,CAAC,CAAD,CAAN,CAAUtmB,IADJ,kDAAb;AAGH;;AACDugB,qBAAO;AACV,aA/BT,EAgCQ,UAACwB,GAAD;AAAA,qBAASvB,MAAM,CAACuB,GAAD,CAAf;AAAA,aAhCR;AAkCH,WAtCM,CAAP;AAuCH;;;6CAEwB;AAAA;;AACrB,cAAM+iC,GAAG,GAAG,KAAK1B,OAAL,CAAannC,IAAb,CACiB,KAAA8oC,uBADjB,EAC0C;AACtDC,oBAAQ,EAAE,MAD4C;AAEtDC,iBAAK,EAAE,MAF+C;AAGtDzqC,gBAAI,EAAE;AACFi5B,uBAAS,EAAE,KAAK76B,OAAL,CAAage,IAAb,CAAkBhE,UAD3B;AAEFsyB,uBAAS,EAAE,KAAKtsC,OAAL,CAAakS,qBAFtB;AAGFq6B,4BAAc,EAAE,IAHd;AAIFt8C,sBAAQ,EAAE,KAAK+P,OAAL,CAAa/P;AAJrB;AAHgD,WAD1C,CAAZ;;AAYA,eAAK7G,YAAL,CACA,cADA,EAEA8iD,GAAG,CAACM,iBAAJ,CAAsBzzC,KAAtB,CAA4BzP,SAA5B,CAAsC,UAACyP,KAAD,EAAwB;AAC1D,gBAAGA,KAAK,CAACgW,MAAN,KAAiB,OAApB,EAA4B;AACxBm9B,iBAAG,CAACzc,KAAJ;AACH,aAFD,MAEM,IAAG12B,KAAK,CAACgW,MAAN,KAAkB,QAArB,EAA8B;AAChCzd,uBAAS,CAACm7C,SAAV,CAAoBC,SAApB,CAA8B,OAAI,CAACC,aAAnC;AACH;AAEJ,WAPD,CAFA;AAWAT,aAAG,CAACU,WAAJ,GAAkBtjD,SAAlB,CAA4B;AAAA,mBAAM,OAAI,CAACnC,KAAL,CAAW,cAAX,CAAN;AAAA,WAA5B;AACH;;;4BAjXqB;AAClB,iBAAO,KAAK0sC,KAAL,CAAWgX,WAAlB;AACH;AAED;;;;4BACkB;AACd,iBAAO,KAAKhX,KAAL,CAAW7zB,OAAlB;AACH;AAED;;;;4BACe;AACX,iBAAO,KAAKq0B,MAAL,CAAYtO,OAAnB;AACH;AAED;;;;4BACgB;AACZ,iBAAO,KAAK/lB,OAAL,CAAagY,KAApB;AACH;AAED;;;;4BACkB;AACd,iBAAO,KAAKhY,OAAL,CAAamgB,OAApB;AACH;AAGD;;;;4BACe;AACX,cAAM0sB,cAAc,GAAG,KAAK7sC,OAAL,CAAa5T,QAApC;AACA,cAAM20B,OAAO,GAAG,KAAK/gB,OAAL,CAAa+gB,OAAb,IAAwB8rB,cAAc,GAAG,KAAK,EAA9D;;AACA,cAAG,KAAK7sC,OAAL,CAAa4R,YAAb,IAA6B,KAAK5R,OAAL,CAAaiS,iBAA1C,IAA+D,KAAKjS,OAAL,CAAaiS,iBAAb,CAA+B1kB,MAAjG,EAAwG;AACpG,mBAAO,cAAAi9B,UAAA,CAAW,MAAD,OAAC,CAAD;AAAEzJ,qBAAO,EAAPA;AAAF,aAAC,EAAa,KAAK+rB,eAAlB,CAAX,CAAP;AACH;;AACD,iBAAO,cAAAtiB,UAAA,CAAW;AACdzJ,mBAAO,EAAPA,OADc;AAEd0J,mBAAO,EAAE,KAAKzqB,OAAL,CAAa/J,WAFR;AAGdy0B,iBAAK,EAAE,KAAK1qB,OAAL,CAAa9J,SAHN;AAIdy0B,wBAAY,EAAE,KAAK3qB,OAAL,CAAawjB;AAJb,WAAX,CAAP;AAKH;;;4BAEyB;AACtB,cAAMiH,OAAO,GAAG,cAAA4L,oBAAA,CAAqB,KAAKr2B,OAAL,CAAaiS,iBAAlC,CAAhB;AACA,cAAMyY,KAAK,GAAGD,OAAO,CAACv+B,QAAR,CAAiB;AAACJ,mBAAO,EAAE,KAAKkU,OAAL,CAAa5T;AAAvB,WAAjB,CAAd;AACA,iBAAO;AAACq+B,mBAAO,EAAPA,OAAD;AAAUC,iBAAK,EAALA,KAAV;AAAiBC,wBAAY,EAAED;AAA/B,WAAP;AACH;AAED;;;;4BACqB;AACjB,iBAAO,cAAA6L,iBAAA,CAAkB;AACrB/Y,kBAAM,EAAE,KAAKxd,OAAL,CAAa6R,iBADA;AAErB0G,eAAG,EAAE,KAAKvY,OAAL,CAAa+R,gBAFG;AAGrBxoB,gBAAI,EAAE,KAAKyW,OAAL,CAAaiS,iBAHE;AAIrB+K,oBAAQ,EAAE,KAAKhd,OAAL,CAAa8R;AAJF,WAAlB,CAAP;AAMH;AAED;;;;4BACmB;AACf,cAAM+6B,cAAc,GAAG,KAAK7sC,OAAL,CAAa5T,QAApC;AACA,iBAAO,KAAK4T,OAAL,CAAa+gB,OAAb,GAAuB,SAAvB,GAAmC,OAAA1uB,gBAAA,CAAiBw6C,cAAjB,CAA1C;AACH;AAED;;;;4BACiB;AACb,iBAAO,CAAC,KAAK7sC,OAAL,CAAage,IAAd,CAAP;AACH;AAED;;;;4BACoB;AAAA;;AAChB,cAAM0B,SAAS,GAAG,KAAK1f,OAAL,CAAa0f,SAA/B;AACA,iBAAOA,SAAS,CAACztB,MAAV,CAAiB,UAACvI,CAAD;AAAA,mBAAOA,CAAC,CAAC+S,KAAF,KAAY,OAAI,CAACkjB,SAAL,CAAeljB,KAAlC;AAAA,WAAjB,CAAP;AACH;AAED;;;;4BACoB;AAChB,iBAAO,KAAKuD,OAAL,CAAa2f,SAAb,IAA0B,KAAK0U,MAAL,CAAYtO,OAA7C;AACH;AAED;;;;4BAC0B;AACtB,iBAAO,KAAK/lB,OAAL,CAAa+f,eAAb,IAAgC,EAAvC;AACH;AAED;;;;4BACyB;AACrB,cAAMoB,QAAQ,GAAG,KAAKA,QAAtB;AACA,cAAMgG,KAAK,GAAG,EAAd;;AAFqB,uDAGD,KAAKhG,QAHJ;AAAA;;AAAA;AAGrB,sEAAmC;AAAA,kBAAxB8C,KAAwB;AAC/BkD,mBAAK,CAAClD,KAAK,CAACC,WAAP,CAAL,GAA2BD,KAAK,CAAC4K,WAAjC;AACH;AALoB;AAAA;AAAA;AAAA;AAAA;;AAMrB,iBAAO1H,KAAP;AACH;AAED;;;;4BAC0B;AACtB,iBAAO,KAAKnnB,OAAL,CAAa8f,KAAb,CACF7tB,MADE,CACK,UAAC8vB,IAAD;AAAA,mBAAUA,IAAI,CAACzxB,IAAL,KAAc,WAAxB;AAAA,WADL,EAEFtB,MAFE,CAEK,UAACkC,GAAD,EAAM4uB,KAAN,EAAgB;AACpB5uB,eAAG,CAAC4uB,KAAK,CAACvR,KAAP,CAAH,GAAmBuR,KAAK,CAAC9c,OAAzB;AACA,mBAAO9R,GAAP;AACH,WALE,EAKA,EALA,CAAP;AAMH;AAED;;;;4BACgB;AACZ,iBAAO,KAAK8O,OAAL,CAAazI,IAApB;AACH;AAED;;;;4BACmB;AAAA;;AACf,iBAAO,CAAC,KAAKyI,OAAL,CAAamhB,QAAb,IAAyB,EAA1B,EAA8BjwB,GAA9B,CAAkC,UAAC+yB,KAAD,EAAW;AAChD,gBAAM1V,KAAK,GAAQ,OAAI,CAACb,MAAL,CAAY7e,IAAZ,CACf,UAACk+C,OAAD;AAAA,qBAAaA,OAAO,CAACtwC,KAAR,KAAkBwnB,KAAK,CAACC,WAArC;AAAA,aADe,KAEd;AACD3N,mBAAK,EAAE;AADN,aAFL;AAKA,gBAAM7H,QAAQ,GACV,OAAI,CAAC0L,IAAL,CAAUja,SAAV,CAAoBtR,IAApB,CAAyB,UAAC4iC,GAAD;AAAA,qBAASA,GAAG,CAACn0B,EAAJ,KAAWiR,KAAK,CAACgI,KAAN,CAAYmb,WAAhC;AAAA,aAAzB,KAAyE,EAD7E;AAEA,mBAAO,IAAI,cAAAtQ,aAAJ,CAAkB,MAAD,OAAC,CAAD,kBACjB6C,KADiB,CAAC,EACb;AACRvf,sBAAQ,EAAE6J,KAAK,CAACyL,UADR;AAERgV,oBAAM,EAAEtgB,QAAQ,CAAC4kB,QAFT;AAGRnY,0BAAY,EAAE,OAAI,CAACnb,OAAL,CAAa/J,WAAb,CAAyBjB,EAH/B;AAIRmvB,8BAAgB,EAAE,OAAI,CAACnkB,OAAL,CAAa/P;AAJvB,aADa,CAAlB,CAAP;AAOH,WAfM,CAAP;AAgBH;AAED;;;;4BACkB;AACd,iBAAO,EAAP;AACH;;;4BAiPuB;AACpB,cAAI8nB,IAAI,GAAG,EAAX;AACA,eAAK/X,OAAL,CAAakS,qBAAb,CAAmChhB,GAAnC,CAAuC,UAAC7F,IAAD,EAAQ;AAC3C,gBAAM2hD,MAAM,GAAG,IAAI,UAAAzwC,MAAJ,CAAW;AAAClR,kBAAI,EAAEA,IAAI,GAAC;AAAZ,aAAX,CAAf;AACA,gBAAMiM,OAAO,GAAG01C,MAAM,CAACrgD,UAAP,CAAkB,iBAAlB,CAAhB;AACAorB,gBAAI,aAAMA,IAAN,eAAezgB,OAAf,SAAyB01C,MAAM,CAACpkB,UAAP,CAAkB,UAAA9zB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAlB,EAAuC,KAAvC,IAAgD,UAAhD,GAA6D,EAAtF,CAAJ;AACH,WAJD;AAKA,iBAAO8sB,IAAP;AACH;;;;MAnZwC,OAAAjwB,a;;AAL7C;;;uBAKauiD,uB,EAAuB,2C,EAAA,qC,EAAA,4C,EAAA,wC,EAAA,4C,EAAA,sC,EAAA,+B,EAAA,kC,EAAA,qC,EAAA,qBAsKpB,SAAA4C,eAtKoB,C,EAsKL,wC,EAAA,2C;AAAA,K;;;YAtKlB5C,uB;AAAuB,8C;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,itD;AAAA;AAAA;AC/DpC;AA6KA;AAQA;AAYA;;;;;;AAjMoB,8CAAiC,UAAjC,EAAiC,GAAjC;AA6KA;AAAA;;;;;;;;;;2BD9GPA,uB,EAAuB;cALnC,OAAA6C,SAKmC;eALzB;AACPjlD,kBAAQ,EAAE,yBADH;AAEPklD,qBAAW,EAAE,kCAFN;AAGPC,mBAAS,EAAE,CAAC,kCAAD;AAHJ,S;AAKyB,Q;;;;;;;;;;;;;;;;;;;;;;kBAsK3B,OAAAlT,M;mBAAO,SAAA+S,e;;;;;;;;;gBApKX,OAAAI;;;;;;;;;;;;;;;;;;;;;;;;AEjEL;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAWA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/BI;AAII;AAAA;AAA6D;AAC7D;AAGI;AAAA;AAAA;AAAA;AAAA;AACH;AACL;;;;;AAHQ;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAeA;AAAA;AAIA;;;;;AAAA;AAAA;AAAA;;;;;;;;AAfR;AACI;AAAA;AAKS;AACT;AAAA;AACA;AACI;AAAA;AAAkG;AAAA;AAAA;AAAA,8BAAa,OAAb;AAAoB,SAApB;AAAlG;AAEA;AAMJ;AACJ;;;;;AAfQ;AAAA;AAQW;AAAA;;;;;;;;;;;;;;;;;;AAwBX;AACI;AACJ;;;;;;AAfJ;AACI;AAAA;AAAuD;AACvD;AAWA;AAGJ;;;;;AAZQ;AAAA;AADA,yJAA0G,YAA1G,EAA0G,kBAA1G,EAA0G,aAA1G,EAA0G,gDAA1G,EAA0G,SAA1G,EAA0G,oCAA1G,EAA0G,gBAA1G,EAA0G,KAA1G;AAUoB;AAAA;;;;;;AAfhC;AAEI;AAiBJ;;;;;AAjBwC;AAAA;;;;;;;;;;;;;;;;;;AAwChC;AACI;AACJ;;;;;;;;;;;;;;AAvBJ;AACI;AAAA;AAAyE;AACzE;AAeI;AAAA;AAAA;AAAA,iBAAiB,QAAA7lC,IAAA,iCAAjB;AAAsD,SAAtD;AAGH;AACD;AAGJ;;;;;AApBQ;AAAA,wCAAiB,YAAjB,EAAiB,iBAAjB,EAAiB,iBAAjB,EAAiB,6SAAjB,EAAiB,SAAjB,EAAiB,gFAAjB,EAAiB,SAAjB,EAAiB,iCAAjB,EAAiB,UAAjB,EAAiB,yBAAjB,EAAiB,gBAAjB,EAAiB,2BAAjB,EAAiB,cAAjB,EAAiB,wDAAjB;AAiBoB;AAAA;;;;;;;;;;;;;;;;;;AAwBxB;AACI;AACJ;;;;;;AAtBJ;AACI;AACI;AAAA;AAAmE;AASvE;AACA;AAQA;AAGJ;;;;;AARQ;AAAA,wEAA0C,UAA1C,EAA0C,IAA1C,EAA0C,SAA1C,EAA0C,gFAA1C;AAKoB;AAAA;;;;;;AAI5B;AACI;AACJ;;;;;AADI;AAAA;;;;;;AAYR;;;;;AAAiE;;;;;;;;;;;;;;;;;;AAG7D;;;;;;AAOQ;AACI;AACJ;;;;;AAF2C;AACvC;AAAA;;;;;;AAPZ;AACI;AAKI;AAGJ;AACJ;;;;;AANQ;AAAA;AAEY;AAAA;;;;;;AATxB;AACI;AAAA;AAAiE;AACjE;AACA;AAWJ;;;;;AAZsE;AAAA;AAC7B;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmBrC;AAAA;AAEA;;;;;AAAA;AAAA;AAAA;;;;;;;;AATJ;AACI;AAAA;AAAsE;AACtE;AAGI;AAAA;AAAA;AAAA;AAAA;AACH;AACD;AAGJ;;;;;AAHe;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAeP;AAAA;AAGA;;;;;AAAA;AAAA;AAAA;;;;;;;;AAKA;AAAyD;AAAA;AAAA;AAAA;AAAA;AAAA;AACrD;AACA;AAA0C;AAAQ;AACtD;;;;;AAFI;AAAA;;;;;;;;AApBZ;AACI;AAAA;AAGA;AACA;AACA;AACI;AACI;AAAA;AAAA;AACJ;AAEA;AAIJ;AACA;AAAwC;AAAA;;AAAA;;AAAA;AAAA;AAAA,8BAA0D,EAA1D;AAA4D,SAA5D;AAA8D;AAAG;AAC7G;AACI;AACI;AAIJ;AACJ;;;;;;;AAvByB;AAAA;AAOuE;AAAA;AAG7E;AAAA;AAQD;AAAA;;;;;;;;;;;;;;;;;;AAWN;AACI;AACJ;;;;;AAF+C;AAC3C;AAAA;;;;;;AALhB;AACI;AAAA;AAA+E;AAC/E;AACI;AACI;AAGJ;AACJ;AACJ;;;;;AALwB;AAAA;;;;;;;;;;;;;;;;;;AAMxB;AACI;AAAA;AAEA;AAEJ;;;;;;;;;;;;;;;;;;AACA;AAEI;AAAA;AAMA;AACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGI;AACI;AAAA;AAMI;AAAA;AAAA;AAAA,8BAAa,MAAb;AAAmB,SAAnB;AACH;AACL;;;;;;AAEI;;;;;;AAbR;AACI;AAAA;AAAyD;AACzD;AAUA;AAGJ;;;;;;;AAbqD;AAAA,iDAAmC,UAAnC,EAAmC,IAAnC;;;;;;AApMzD;AACI;AAWA;AAoBA;AAoBA;AACI;AAyBA;AAwBA;AAGJ;AACA;AACI;AAKC;AAAiB;AACtB;AAEA;AACA;AAeA;AAWA;AA0BA;AAUA;AAMA;AAUA;AAgBJ;;;;;;;;;AAlNuC;AAG/B;AAAA;AAS4B;AAAA;AAoBR;AAAA;AAqBiB;AAAA;AAyBF;AAAA;AAwB9B;AAAA;AAagB;AAAA;AACW;AAAA;AAeA;AAAA;AAWW;AAAA;AA0BR;AAAA;AAUF;AAAA;AAME;AAAA;AAUR;AAAA;;;;QDxJtB8lC,oB;;;;;AAiBT,oCACY/lC,QADZ,EAEY8sB,MAFZ,EAGYmW,OAHZ,EAIY9hC,eAJZ,EAKY6kC,KALZ,EAKoC;AAAA;;AAAA;;AAEhC;AANQ,gBAAAhmC,QAAA,GAAAA,QAAA;AACA,gBAAA8sB,MAAA,GAAAA,MAAA;AACA,gBAAAmW,OAAA,GAAAA,OAAA;AACA,gBAAA9hC,eAAA,GAAAA,eAAA;AACA,gBAAA6kC,KAAA,GAAAA,KAAA;AAnBZ;;AACO,gBAAAC,SAAA,GAAoB,EAApB;AACA,gBAAA5uB,KAAA,GAAgB,UAAA9pB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAhB;AACP;;AACO,gBAAAwiD,UAAA,GAAqB,QAAK7uB,KAAL,CAAW3yB,QAAX,CAAoB;AAAEP,gBAAM,EAAEC,IAAI,CAACC,IAAL,CAAU,QAAKgzB,KAAL,CAAW9yB,OAAX,GAAqB,CAA/B,IAAoC;AAA9C,SAApB,CAArB;AACP;;AACgB,gBAAA4hD,WAAA,GAAc,UAAA54C,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoBiB,QAApB,CAA6B;AAAEwwB,cAAI,EAAE;AAAR,SAA7B,EAA4CpB,UAA5C,CAAuD,KAAvD,CAAd;AAET,gBAAAquB,aAAA,GAAgB,UAAA70C,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB0nB,WAApC;AACA,gBAAAg7B,UAAA,GAAa,EAAb;AACA,gBAAAC,QAAA,GAAW,EAAX,CAS6B,CARpC;;AACO,gBAAAC,WAAA,GAAqB,EAArB;AAUH,gBAAKloB,WAAL,GAAmB,QAAKjd,eAAL,CAAqBQ,SAAxC;AAHgC;AAInC;;;;mCAEc;AAAA;;AACX;AACA;;;AAEA,eAAK2kC,WAAL,sBAAuB,KAAKrmC,IAAL,CAAUovB,QAAV,CAAmBzW,OAAnB,CAA2B5xB,KAAlD;AAEA,eAAKo7C,aAAL,GAAqB,UAAA70C,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB0nB,WAAzC;AACA,cAAMA,WAAW,GACb,KAAKnL,IAAL,CAAUovB,QAAV,CAAmBt6B,MAAnB,KAEI,KAAKkL,IAAL,CAAUovB,QAAV,CAAmBt6B,MAAnB,CAA0B/N,KAA1B,KAAoC,eAApC,IACA,KAAKiZ,IAAL,CAAUovB,QAAV,CAAmBt6B,MAAnB,CAA0B/N,KAA1B,KAAoC,OADpC,IAEA,KAAKiZ,IAAL,CAAUovB,QAAV,CAAmBt6B,MAAnB,CAA0B/N,KAA1B,KAAoC,MAFpC,IAGA,KAAKiZ,IAAL,CAAUovB,QAAV,CAAmBt6B,MAAnB,CAA0B/N,KAA1B,KAAoC,cALxC,KAOA,KAAKiZ,IAAL,CAAUovB,QAAV,CAAmB5qC,MAPnB,IAQA,KAAKwb,IAAL,CAAUovB,QAAV,CAAmB5qC,MAAnB,CAA0BuC,KATV,GAUhB,KAAKiZ,IAAL,CAAUovB,QAAV,CAAmB5qC,MAAnB,CAA0BuC,KAA1B,CAAgCokB,WAVhB,GAU8B,KAAKg3B,aAVvD;AAYA,eAAK/qB,KAAL,GAAa,IAAI,UAAAriB,MAAJ,CAAW;AAAElR,gBAAI,EAAEJ,IAAI,CAAConB,GAAL,EAAR;AAAoBK,uBAAW,EAAE,KAAjC;AAAwCC,uBAAW,EAAXA;AAAxC,WAAX,CAAb;AACA,eAAK86B,UAAL,GAAkB,OAAA1hD,mBAAA,CAAoB,KAAK6yB,KAAzB,EAAgC,EAAhC,CAAlB;;AAEA,eAAKyV,MAAL,CAAYzwB,WAAZ,CAAwBzH,IAAxB,CAA6B,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,mBAAOA,CAAP;AAAA,WAAN,CAA7B,EAA8CvZ,SAA9C,CAAwD,YAAM;AAC1D,gBAAM2a,IAAI,GAAS,OAAI,CAACowB,MAAL,CAAYtO,OAA/B;AACA,gBAAM4d,SAAS,GAAG1/B,IAAI,CAAC0/B,SAAL,CAAezyC,GAAf,CACd,UAACw1C,GAAD;AAAA,qBAAS,OAAI,CAACrS,MAAL,CAAYxlC,IAAZ,CAAiB63C,GAAG,CAACjqC,KAArB,KAA+B,IAAI,cAAA4iB,IAAJ,CAAS;AAAE5iB,qBAAK,EAAEiqC,GAAG,CAACjqC,KAAb;AAAoBrV,oBAAI,EAAEs/C,GAAG,CAACjqC,KAAJ,CAAUpP,KAAV,CAAgB,GAAhB,EAAqB,CAArB;AAA1B,eAAT,CAAxC;AAAA,aADc,CAAlB;AAGA,mBAAI,CAACmgD,SAAL,GAAiB,CAACvpC,IAAD,EAAOkZ,MAAP,CAAcwmB,SAAd,CAAjB;AACH,WAND;;AAQA,eAAKmK,oBAAL,CAA0B,KAAKtmC,IAAL,CAAUovB,QAAV,CAAmB3mC,QAAnB,CAA4B1B,KAAtD;AACA,eAAKnF,YAAL,CAAkB,aAAlB,EAAkC,KAAKoe,IAAL,CAAUyf,YAAV,CAC7B9qB,IAD6B,CAE1B,YAAA4xC,IAAA,CAAK,CAAL,CAF0B,EAEjB;AACT,sBAAAC,oBAAA,EAH0B,EAI7B1kD,SAJ6B,CAInB,YAAM;AACb,mBAAI,CAACU,OAAL,CAAa,kBAAb,EAAiC,YAAM;AACnC,qBAAI,CAAC8jD,oBAAL,CAA0B,OAAI,CAACtmC,IAAL,CAAUovB,QAAV,CAAmB3mC,QAAnB,CAA4B1B,KAAtD;AACH,aAFD,EAEG,GAFH;AAGH,WAR6B,CAAlC;AAWA,eAAKnF,YAAL,CAAkB,oBAAlB,EAAyC,KAAKoe,IAAL,CAAUovB,QAAV,CAAmBhlB,YAAnB,CAAgCqV,YAAhC,CACpC39B,SADoC,CAC1B,YAAM;AACb,gBAAM2kD,gBAAgB,GAAG,OAAI,CAACzmC,IAAL,CAAUovB,QAAV,CAAmB3kB,iBAA5C;;AACA,gBAAG,CAAC,OAAI,CAACzK,IAAL,CAAUovB,QAAV,CAAmBhlB,YAAnB,CAAgCrjB,KAApC,EAA0C;AACtC0/C,8BAAgB,CAACC,eAAjB;AACH,aAFD,MAEK;AACD,kBAAMC,eAAe,GAAG,CAAC,QAAAjoB,UAAA,CAAWC,QAAZ,CAAxB;AACAgoB,6BAAe,CAACj7C,IAAhB,CAAqB,cAAAs1B,eAArB;AACAylB,8BAAgB,CAACxnB,aAAjB,CAA+B0nB,eAA/B;AACH;;AACDF,4BAAgB,CAAClnB,sBAAjB;AACH,WAXoC,CAAzC;AAcA;;AACA,eAAKqnB,aAAL;AAEA;;AACA,cAAG,YAAK5mC,IAAL,CAAUovB,QAAV,CAAmBt5B,EAAnB,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAE/O,KAAvB,KAAgC,QAAC,KAAKiZ,IAAL,CAAUovB,QAAV,CAAmBt6B,MAApB,MAA0B,IAA1B,IAA0B,aAA1B,GAA0B,MAA1B,GAA0B,GAAE/N,KAA5B,CAAnC,EAAqE;AACjE,iBAAKiZ,IAAL,CAAUovB,QAAV,CAAmBhlB,YAAnB,CAAgC3lB,QAAhC,CAAyC,KAAzC;AACH;AACJ;AAED;;;;;;;;6BAKYlF,G,EAAW;AACnB,eAAKygB,IAAL,CAAUzG,GAAV,CAAcha,GAAd,EAAmBkF,QAAnB,CAA4B,KAAKub,IAAL,CAAUzG,GAAV,CAAcha,GAAd,EAAmBwH,KAAnB,CAAyBo5C,IAAzB,EAA5B;AACH;AAED;;;;wCAoBuB;;;AAAA,iCAC+B,KAAKngC,IAAL,CAAUjZ,KADzC;AAAA,cACX+O,EADW,oBACXA,EADW;AAAA,cACPhB,MADO,oBACPA,MADO;AAAA,cACCiqB,WADD,oBACCA,WADD;AAAA,cACc3U,YADd,oBACcA,YADd;AAEnB,cAAMy8B,MAAM,GAAG,CAAC,CAAC/wC,EAAjB;AACA,cAAMgxC,OAAO,GAAGhyC,MAAM,KAAK,cAAA0rB,aAAA,CAAcjV,IAAzC;;AACA,cAAIs7B,MAAJ,EAAY;AACR,uBAAK7mC,IAAL,CAAUzG,GAAV,CAAc,cAAd,OAA6B,IAA7B,IAA6B,aAA7B,GAA6B,MAA7B,GAA6B,GAAE4lB,OAAF,EAA7B;AACH;;AAED,cAAI,CAAC,KAAKhB,WAAN,IAAqB,CAACY,WAA1B,EAAuC;AACnC,uBAAK/e,IAAL,CAAUzG,GAAV,CAAc,cAAd,OAA6B,IAA7B,IAA6B,aAA7B,GAA6B,MAA7B,GAA6B,GAAE4lB,OAAF,EAA7B;AACH;;AACD,cAAG0nB,MAAM,IAAIC,OAAV,IAAqB18B,YAAxB,EAAqC;AACjC,uBAAKpK,IAAL,CAAUzG,GAAV,CAAc,QAAd,OAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAE4lB,OAAF,EAAvB;AACA,iBAAKnf,IAAL,CAAU+mC,UAAV,CAAqB;AAAEjyC,oBAAM,EAAE;AAAV,aAArB;AACH;AACJ;AAED;;;;;;0CAGsB;AAAA;;;;AAClB,cAAM4vC,GAAG,GAAG,KAAK1B,OAAL,CAAannC,IAAb,CACR,+BAAAmrC,yBADQ,EAER;AACInC,iBAAK,EAAE,MADX;AAEIpmD,kBAAM,EAAE,MAFZ;AAGImmD,oBAAQ,EAAE,MAHd;AAIIxqC,gBAAI,EAAE;AACF8L,oBAAM,EAAE,KAAKlG,IAAL,CAAUovB,QAAV,CAAmBra,UAAnB,CAA8BhuB,KADpC;AAEFvC,oBAAM,EAAE,KAAKwb,IAAL,CAAUovB,QAAV,CAAmB5qC,MAAnB,CAA0BuC,KAFhC;AAGFnC,sBAAQ,EAAE,KAAKob,IAAL,CAAUovB,QAAV,CAAmBxqC,QAAnB,CAA4BmC,KAHpC;AAIFoW,kBAAI,EAAE,KAAK6C,IAAL,CAAUovB,QAAV,CAAmBjX,SAAnB,CAA6BpxB,KAJjC;AAKFkgD,sBAAQ,EAAE,IALR;AAMFC,2BAAa,EAAE,CAAC,cAAC,KAAKlnC,IAAL,CAAUovB,QAAV,CAAmBzV,QAApB,MAA4B,IAA5B,IAA4B,aAA5B,GAA4B,MAA5B,GAA4B,GAAE5yB,KAA9B,MAAmC,IAAnC,IAAmC,aAAnC,GAAmC,MAAnC,GAAmC,GAAEhB,MAArC;AANd;AAJV,WAFQ,CAAZ;;AAgBA,eAAKnE,YAAL,CACI,YADJ,EAEI8iD,GAAG,CAACM,iBAAJ,CAAsBzzC,KAAtB,CAA4BzP,SAA5B,CAAsC,UAACyP,KAAD,EAAW;;AAC7C;;;AACA,gBAAIA,KAAK,CAACgW,MAAN,KAAiB,MAArB,EAA6B;AACzB,kBAAIwN,UAAU,GAAG,OAAI,CAAC/U,IAAL,CAAUovB,QAAV,CAAmBra,UAAnB,CAA8BhuB,KAA/C;AACAguB,wBAAU,GAAGxjB,KAAK,CAACiP,QAAnB;;AACA,qBAAI,CAACR,IAAL,CAAUovB,QAAV,CAAmBra,UAAnB,CAA8BtwB,QAA9B,CAAuC,OAAA8F,MAAA,CAAOwqB,UAAP,EAAmB,IAAnB,CAAvC;;AACA,kBAAM4E,QAAQ,GAAG,CAAH,WAAG,OAAI,CAAC3Z,IAAL,CAAUovB,QAAb,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAEzV,QAApB,MAA4B,IAA5B,IAA4B,aAA5B,GAA4B,MAA5B,GAA4B,GAAE5yB,KAAF,CAAQ2C,GAAR,CAAY,UAAC+yB,KAAD,EAA0B;AAC/EA,qBAAK,CAACvf,QAAN,GAAiB6X,UAAU,CAAC,CAAD,CAAV,CAAcn1B,IAA/B;AACA68B,qBAAK,CAACC,WAAN,GAAoB3H,UAAU,CAAC,CAAD,CAAV,CAAc9f,KAAlC;AACA,uBAAOwnB,KAAP;AACH,eAJ4C,CAA7C;AAKA,2BAAI,CAACzc,IAAL,CAAUovB,QAAV,CAAmBzV,QAAnB,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAEl1B,QAAF,CAAWk1B,QAAQ,IAAI,EAAvB,CAA3B;AACA+qB,iBAAG,CAACzc,KAAJ;;AACA,qBAAI,CAACtoC,KAAL,CAAW,YAAX;AACH;;AACD,gBAAI4R,KAAK,CAACgW,MAAN,KAAiB,OAArB,EAA8B;AAC1Bm9B,iBAAG,CAACzc,KAAJ;;AACA,qBAAI,CAACtoC,KAAL,CAAW,YAAX;AACH;AACJ,WAnBD,CAFJ;AAuBH;AAED;;;;;;2CAG0B;AAAA;;AACtB,cAAM+kD,GAAG,GAAG,KAAK1B,OAAL,CAAannC,IAAb,CAAyC,2BAAAsrC,qBAAzC,EAAgE;AACxEtC,iBAAK,EAAE,MADiE;AAExEpmD,kBAAM,EAAE;AAFgE,WAAhE,CAAZ;;AAIA,eAAKmD,YAAL,CACI,UADJ,EAEI8iD,GAAG,CAACM,iBAAJ,CAAsBzzC,KAAtB,CAA4BzP,SAA5B,CAAsC,UAACyP,KAAD,EAAW;AAC7C;AACA,gBAAIA,KAAK,CAACgW,MAAN,KAAiB,MAArB,EAA6B;AACzB,kBAAM2Q,SAAS,GAAG,OAAI,CAAClY,IAAL,CAAUovB,QAAV,CAAmBlX,SAAnB,CAA6BnxB,KAA/C;AACAmxB,uBAAS,CAACxsB,IAAV,CAAe6F,KAAK,CAACiP,QAArB;;AACA,qBAAI,CAACR,IAAL,CAAUovB,QAAV,CAAmBlX,SAAnB,CAA6BzzB,QAA7B,CAAsC,OAAA8F,MAAA,CAAO2tB,SAAP,EAAkB,OAAlB,CAAtC;;AACAwsB,iBAAG,CAACzc,KAAJ;;AACA,qBAAI,CAACtoC,KAAL,CAAW,UAAX;;AACA,qBAAI,CAAComD,KAAL,CAAWqB,aAAX;AACH;AACJ,WAVD,CAFJ;AAcH,S,CAED;;;;mCACW71C,K,EAAOonB,O,EAAO;AACrB,cAAIA,OAAJ,EAAa;AACT,iBAAK0tB,WAAL,CAAiB36C,IAAjB,CAAsBitB,OAAtB;AACA,iBAAK3Y,IAAL,CAAUovB,QAAV,CAAmBzW,OAAnB,CAA2Bl0B,QAA3B,CAAoC,KAAK4hD,WAAzC;AACH;;AACD90C,eAAK,CAACs3B,cAAN;AACH;;;qCAEYza,M,EAAW;AACpB,cAAMjsB,KAAK,GAAG,KAAKkkD,WAAL,CAAiBp/C,OAAjB,CAAyBmnB,MAAzB,CAAd;;AACA,cAAIjsB,KAAK,IAAI,CAAb,EAAgB;AACZ,iBAAKkkD,WAAL,CAAiB/1C,MAAjB,CAAwBnO,KAAxB,EAA+B,CAA/B;AACH;;AACD,eAAK6d,IAAL,CAAUovB,QAAV,CAAmBzW,OAAnB,CAA2Bl0B,QAA3B,CAAoC,KAAK4hD,WAAzC;AACH;;;6CAE4B59C,Q,EAAkB;AAC3C,cAAI,CAACA,QAAL,EAAeA,QAAQ,GAAG,KAAK05C,aAAhB,CAD4B,CAE3C;;AACA,cAAMkF,aAAa,GAAG,QAAA7gD,QAAA,CAASqkB,GAAT,GAAeirB,OAAf,CAAuB,KAAKqM,aAA5B,EAA2C56C,MAAjE;AACA,cAAM+/C,gBAAgB,GAAG,QAAA9gD,QAAA,CAASqkB,GAAT,GAAeirB,OAAf,CAAuBrtC,QAAvB,EAAiClB,MAA1D;AACA,cAAM/C,MAAM,GAAG,KAAKwb,IAAL,CAAUovB,QAAV,CAAmB5qC,MAAnB,CAA0BuC,KAAzC;;AACA,cAAIvC,MAAM,IAAI6iD,aAAa,KAAKC,gBAAhC,EAAkD;AAC9C,gBAAM/hD,SAAS,GAAGf,MAAM,CAACy7B,KAAP,EAAlB;AACA,iBAAKkmB,UAAL,GAAkB5gD,SAAS,CAACuJ,eAAV,CAA0B,OAA1B,CAAlB;AACA,iBAAKs3C,QAAL,GAAgB7gD,SAAS,CAACb,QAAV,CAAmB;AAAEJ,qBAAO,EAAE,KAAK0b,IAAL,CAAUjZ,KAAV,CAAgBnC;AAA3B,aAAnB,EAA0DkK,eAA1D,CAA0E,OAA1E,CAAhB;AACH,WAJD,MAIO;AACH;AACA,iBAAKq3C,UAAL,GAAkB,EAAlB;AACA,iBAAKC,QAAL,GAAgB,EAAhB;AACH;;AACD,eAAKL,KAAL,CAAWqB,aAAX;AACH;;;4BA1IkB;AACf,iBAAO,KAAKrnC,QAAL,CAAcd,OAAd,CAAsB,uBAAtB,KAAkD,KAAzD;AACH;AAED;;;;4BACwB;AACpB,iBAAO,KAAKc,QAAL,CAAcd,OAAd,CAAsB,2BAAtB,KAAsD,EAA7D;AACH;AAED;;;;4BACiB;AACb,cAAMiH,MAAM,GAAG,KAAKlG,IAAL,CAAUovB,QAAV,CAAmBra,UAAnB,CAA8BhuB,KAA7C;AACA,iBAAOmf,MAAM,CAACngB,MAAP,KAAkB,CAAlB,GACDmgB,MAAM,CAAC,CAAD,CAAN,CAAUsM,UADT,GAEDtM,MAAM,CAACngB,MAAP,GAAgB,CAAhB,aACOmgB,MAAM,CAACngB,MADd,wBAEI,oBAJV;AAKH;;;4BA2HwB;AACrB,iBAAO,KAAKia,IAAL,CAAUjZ,KAAV,CAAgB+N,MAAhB,KAA2B,cAAAwW,YAAA,CAAaiV,KAAxC,IAAiD,KAAKvgB,IAAL,CAAUjZ,KAAV,CAAgB+N,MAAhB,KAA2B,cAAAwW,YAAA,CAAaC,IAAhG;AACH;;;;MArPqC,OAAAjrB,a;;AAN1C;;;uBAMawlD,oB,EAAoB,2C,EAAA,qC,EAAA,kC,EAAA,wC,EAAA,0C;AAAA,K;;;YAApBA,oB;AAAoB,qC;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,k8G;AAAA;AAAA;AC1CjC;;;;AAA0B;;;;;;;;;;2BD0CbA,oB,EAAoB;cANhC,OAAAJ,SAMgC;eANtB;AACPjlD,kBAAQ,EAAE,gBADH;AAEPklD,qBAAW,EAAE,+BAFN;AAGPC,mBAAS,EAAE,CAAC,+BAAD,CAHJ;AAIP2B,yBAAe,EAAE,OAAAC,uBAAA,CAAwBC;AAJlC,S;AAMsB,Q;;;;;;;;;;;;;;gBAE5B,OAAAtkD;;;;;;;;;;;;;;;;;;;;;;;;AE5CL;AAAA;AAAA;;AAOA;AAAA;AAAA;;AASA;AAAA;AAAA;;AAOA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXY;;;;;;AAEI,kDAAoB,SAApB,EAAoB,IAApB,EAAoB,MAApB,EAAoB,OAApB,EAAoB,QAApB,EAAoB,aAApB;;;;;;;;;;;QD2BHukD,oC;;;;;AA6CT,oDACY3nC,QADZ,EAEY6S,IAFZ,EAGYC,OAHZ,EAIYowB,WAJZ,EAKqC5W,KALrC,EAKoE;AAAA;;AAAA;;AAEhE;AANQ,gBAAAtsB,QAAA,GAAAA,QAAA;AACA,gBAAA6S,IAAA,GAAAA,IAAA;AACA,gBAAAC,OAAA,GAAAA,OAAA;AACA,gBAAAowB,WAAA,GAAAA,WAAA;AACyB,gBAAA5W,KAAA,GAAAA,KAAA;AAjDrC;;AACiB,gBAAA96B,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AACjB;;AACO,gBAAAh3C,SAAA,GAA4B,EAA5B;;AAiDH,YAAI,CAAC,QAAKkgC,KAAL,CAAWrsB,IAAhB,EAAsB;AAClB,kBAAKD,QAAL,CAAc23B,WAAd,CAA0B,wBAA1B;;AACA,kBAAKuL,WAAL,CAAiBhb,KAAjB;AACH;;AAN+D;AAOnE;AAnDD;;;;;mCAqDe;AAAA;;AACX;AACA,cAAI,KAAKoE,KAAL,CAAWrsB,IAAX,CAAgBovB,QAAhB,CAAyBvtC,KAA7B,EAAoC;AAChC,iBAAKD,YAAL,CACI,WADJ,EAEI,KAAKyqC,KAAL,CAAWrsB,IAAX,CAAgBovB,QAAhB,CAAyBvtC,KAAzB,CAA+B49B,YAA/B,CAA4C39B,SAA5C,CAAsD,UAACD,KAAD,EAAW;AAC7D;AACA,kBAAI,CAACA,KAAD,IAAUA,KAAK,CAACkE,MAAN,IAAgB,CAA9B,EAAiC;AAC7B,uBAAI,CAACk9C,WAAL,CAAiBhb,KAAjB;AACH;AACJ,aALD,CAFJ;AASH;;AACD,eAAK97B,SAAL,GAAiB,KAAKkgC,KAAL,CAAWrsB,IAAX,CAAgBovB,QAAhB,CAAyBvtC,KAAzB,CAA+BkF,KAA/B,CAAqC2C,GAArC,CAAyC,UAAC6C,IAAD;AAAA,mBAAU,IAAI,cAAA44B,YAAJ,CAAiB54B,IAAI,CAAC0T,MAAL,EAAjB,CAAV;AAAA,WAAzC,CAAjB;AACH;;;4BAlEe;;;AACZ,iBAAO,KAAK4S,OAAL,CAAaxrB,IAAb,CAAkB,CAAD,iBAAC,KAAKglC,KAAL,CAAWrsB,IAAZ,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEovB,QAAlB,MAA0B,IAA1B,IAA0B,aAA1B,GAA0B,MAA1B,GAA0B,GAAE1S,WAA3B,MAAsC,IAAtC,IAAsC,aAAtC,GAAsC,MAAtC,GAAsC,GAAE31B,KAA1D,CAAP;AACH;AAED;;;;4BACwB;AACpB,cAAIlD,IAAI,GAAG,KAAKwoC,KAAL,CAAW7nC,MAAtB;;AACA,cAAI,KAAK6nC,KAAL,CAAWrsB,IAAX,IAAmB,KAAKqsB,KAAL,CAAWrsB,IAAX,CAAgBovB,QAAhB,CAAyBxT,aAAhD,EAA+D;AAC3D/3B,gBAAI,GAAGA,IAAI,CAACa,QAAL,CAAc;AAAEJ,qBAAO,EAAE,KAAK+nC,KAAL,CAAWrsB,IAAX,CAAgBovB,QAAhB,CAAyBxT,aAAzB,CAAuC70B;AAAlD,aAAd,CAAP;AACH;;AACD,iBAAOlD,IAAI,CAACsB,UAAL,CAAgB,OAAhB,EAAyBmJ,iBAAzB,EAAP;AACH;AAED;;;;4BACqB;AACjB,iBAAO,KAAK+9B,KAAL,CAAWrsB,IAAX,CAAgBovB,QAAhB,CAAyBvtC,KAAhC;AACH;AAED;;;;4BACqB;AACjB,iBAAO,KAAKsK,SAAL,CAAe3E,MAAf,CAAsB,UAAC8+B,MAAD,EAAS/5B,IAAT,EAAkB;AAC3C,gBAAMq5B,KAAK,GAAGr5B,IAAI,CAACq5B,KAAnB;AACA,mBAAOU,MAAM,GAAG/5B,IAAI,CAAC+5B,MAAL,GAAcV,KAA9B;AACH,WAHM,EAGJ,CAHI,CAAP;AAIH;AAED;;;;4BACiB;AAAA;;AACb;AACA,cAAI,CAAC,KAAK7e,KAAN,IAAe,CAAC,KAAKA,KAAL,CAAWgI,KAA/B,EAAsC;AAClC,mBAAO,KAAP;AACH;;AACD,cAAM7H,QAAQ,GAAG,KAAK0L,IAAL,CAAUja,SAAV,CAAoBtR,IAApB,CACb,UAAC4iC,GAAD;AAAA,mBAASA,GAAG,CAACn0B,EAAJ,KAAW,OAAI,CAACiR,KAAL,CAAWgI,KAAX,CAAiBmb,WAArC;AAAA,WADa,KAEZ;AAAE4B,oBAAQ,EAAE;AAAZ,WAFL;AAGA,iBAAO5kB,QAAQ,CAAC4kB,QAAhB;AACH;;;;MA3CqD,OAAAxrC,a;;AAL1D;;;uBAKaonD,oC,EAAoC,2C,EAAA,4C,EAAA,sC,EAAA,qC,EAAA,qBAkDjC,SAAAjC,eAlDiC,C;AAkDlB,K;;;YAlDlBiC,oC;AAAoC,+C;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,e;AAAA,a;AAAA,kS;AAAA;AAAA;ACzCjD;AACI;AAAA;AAAgE;AAChE;AACI;AACJ;AACJ;AACA;AACI;AACI;AACI;AAAc;AAAM;AAA0C;AAAQ;AAAG;AAAM;AAAmB;AACtG;AACA;AACI;AAOJ;AACA;AACI;AAAO;AAAY;AACnB;AAAmB;;AAAwC;AAC/D;AACJ;AACJ;AACA;AACI;AACI;AAAmB;AAAA,mBAAS,IAAAn2C,KAAA;AAAA,sBAAqB;AAArB,cAAT;AAAuC,WAAvC;AAAnB;AAA0G;AAC9G;AACJ;;;;AA3BkB;AAAA;AAMc;AAAA;AAA2D;AAAA;AAI3E;AAAA;AASe;AAAA;;;;;;;;;;2BDmBlBm2C,oC,EAAoC;cALhD,OAAAhC,SAKgD;eALtC;AACPjlD,kBAAQ,EAAE,0BADH;AAEPklD,qBAAW,EAAE,yCAFN;AAGPC,mBAAS,EAAE,CAAC,yCAAD;AAHJ,S;AAKsC,Q;;;;;;;;;;;;kBAkDxC,OAAAlT,M;mBAAO,SAAA+S,e;;;;;gBAhDX,OAAAI;;;;;;;;;;;;;;;;;;;;;;;;AE3CL;AAAA;AAAA;;AASA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAcA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5BY;;;;;;AAEI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCI;;;;;;;AAzBZ;AACI;AACI;AAAA;AAGA;AACA;AACI;AAAA;AAMC;AACL;AACJ;AACA;AACI;AAAA;AAQI;AACJ;AAAA;AACA;AACI;AAAA;AAAA;AAOA;AAAA;AACI;AACJ;AAAA;AACA;AAAA;AAEA;AACJ;AACJ;AACJ;;;;;AA3CsD;AAmB1C;AAAA;AAMM;AAAA;AAeN;AAAA;AAAA;;;;;;;;;;;QDbP8B,6B;AAyCT,6CACY/0B,IADZ,EAEYia,MAFZ,EAGY+a,qBAHZ,EAIqCvb,KAJrC,EAIoE;AAAA;;AAHxD,aAAAzZ,IAAA,GAAAA,IAAA;AACA,aAAAia,MAAA,GAAAA,MAAA;AACA,aAAA+a,qBAAA,GAAAA,qBAAA;AACyB,aAAAvb,KAAA,GAAAA,KAAA;AA5CrC;;AACiB,aAAA96B,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AACjB;;AACO,aAAA7qB,KAAA,GAAyB,EAAzB;AACP;;AACO,aAAAqH,KAAA,GAAyB,EAAzB;AACP;;AACO,aAAAkoB,WAAA,GAA+B,EAA/B;AACP;;AACO,aAAA7nC,IAAA,GAA2B,EAA3B;AACP;;AACO,aAAA8nC,iBAAA,GAAsC,EAAtC;AACP;;AACO,aAAAC,YAAA,GAAuB,CAAvB;AAiCN;AA7BD;;;;;mCA+Be;AACX,cAAMC,SAAS,GAAG,KAAK3b,KAAL,CAAW4b,WAAX,CAAuBlhD,KAAvB,CAA6B0D,MAA7B,CACd,UAAC8vB,IAAD;AAAA,mBAAuBA,IAAI,CAACzxB,IAAL,KAAc,UAArC;AAAA,WADc,CAAlB;;AAGA,eAAKwvB,KAAL,GAAa0vB,SAAS,CAACxgD,MAAV,CAAiB,UAACkC,GAAD,EAAM6wB,IAAN,EAAe;AACzC7wB,eAAG,CAAC6wB,IAAI,CAACxT,KAAN,CAAH,GAAkBwT,IAAI,CAAC/e,OAAvB;AACA,mBAAO9R,GAAP;AACH,WAHY,EAGV,EAHU,CAAb;AAIA,eAAKi2B,KAAL,GAAa,KAAK0M,KAAL,CAAW1S,QAAX,CAAoB5yB,KAApB,CAA0BS,MAA1B,CAAiC,UAACkC,GAAD,EAAM+yB,KAAN,EAA+B;AACzE/yB,eAAG,CAAC+yB,KAAK,CAACC,WAAP,CAAH,GAAyBD,KAAK,CAAC4K,WAA/B;AACA,mBAAO39B,GAAP;AACH,WAHY,EAGV,EAHU,CAAb;AAIA,eAAKw+C,kBAAL;AACH;;;iCAEY;AAAA;;AACT,eAAKnzB,UAAL,CAAgB9yB,OAAhB,CAAwB,UAAC8kB,KAAD;AAAA,mBAAW,OAAI,CAAC/G,IAAL,CAAU+G,KAAK,CAAC9R,KAAhB,EAAuBkzC,gBAAvB,EAAX;AAAA,WAAxB;AACA;;AACA,cAAI,KAAKC,QAAT,EAAmB;AACf;AACA,gBAAM9vB,KAAK,GAAG,KAAK+T,KAAL,CAAW4b,WAAX,CAAuBlhD,KAAvB,CAA6B0D,MAA7B,CACV,UAAC8vB,IAAD;AAAA,qBAAuBA,IAAI,CAACzxB,IAAL,KAAc,UAArC;AAAA,aADU,CAAd;;AAGA,gBAAMu/C,SAAS,GAAG,KAAKtzB,UAAL,CAAgBrrB,GAAhB,CACd,UAACqd,KAAD;AAAA,qBACK;AACGqT,sBAAM,EAAE,OAAI,CAACiS,KAAL,CAAW7zB,OAAX,CAAmB6f,SAAnB,GAA+B,OAAI,CAACgU,KAAL,CAAW7zB,OAAX,CAAmB6f,SAAnB,CAA6B,MAA7B,CAA/B,GAAsE,OAAI,CAACwU,MAAL,CAAYtO,OAAZ,CAAoB3+B,IADrG;AAEGkJ,oBAAI,EAAE,UAFT;AAGG0S,uBAAO,EAAE,OAAI,CAACwE,IAAL,CAAU+G,KAAK,CAAC9R,KAAhB,EAAuBm6B,QAAvB,CAAgC9W,KAAhC,CAAsCvxB,KAHlD;AAIGggB,qBAAK,EAAEA,KAAK,CAAC9R,KAJhB;AAKGpR,oBAAI,EAAE,UAAAyJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J;AAL7B,eADL;AAAA,aADc,CAAlB;;AAUA,iBAAKo6C,qBAAL,CAA2BU,QAA3B,CAAoCD,SAApC;;AACA,iBAAKhc,KAAL,CAAW4b,WAAX,CAAuBxjD,QAAvB,CAAgC6zB,KAAK,CAAC3C,MAAN,CAAa0yB,SAAb,EAAwB59C,MAAxB,CAA+B,UAAC8vB,IAAD;AAAA,qBAAUA,IAAI,CAAC/e,OAAf;AAAA,aAA/B,CAAhC,EAhBe,CAiBf;;;AACA,gBAAMghB,MAAM,GAAG,KAAK6P,KAAL,CAAW1S,QAAX,CAAoB5yB,KAApB,CAA0B2C,GAA1B,CACX,UAAC+yB,KAAD;AAAA,qBACI,IAAI,cAAA7C,aAAJ,CAAkB,MAAD,OAAC,CAAD,kBACV6C,KADU,CAAC,EACN;AACR4K,2BAAW,EAAE,OAAI,CAACrnB,IAAL,CAAUyc,KAAK,CAACC,WAAhB,IACP,OAAI,CAAC1c,IAAL,CAAUyc,KAAK,CAACC,WAAhB,EAA6B0S,QAA7B,CAAsCxhB,IAAtC,CAA2C7mB,KADpC,GAEP;AAHE,eADM,CAAlB,CADJ;AAAA,aADW,CAAf;;AAUA,iBAAKslC,KAAL,CAAW1S,QAAX,CAAoBl1B,QAApB,CAA6B+3B,MAA7B,EA5Be,CA6Bf;;;AACA,iBAAKjrB,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,oBAAM,EAAE;AAAV,aAAhB;AACH,WA/BD,MA+BO;AACH,iBAAKghC,eAAL;AACH;AACJ;AAED;;;;6CAC0B;AAAA;;;;AAAA,uDACF,KAAKxzB,UADH;AAAA;;AAAA;AAAA;AAAA,kBACXhO,KADW;;AAElB,kBAAMG,QAAQ,GAAG,OAAI,CAAC0L,IAAL,CAAUja,SAAV,CAAoBtR,IAApB,CACb,UAAA4iC,GAAG;AAAA,uBAAIA,GAAG,CAACn0B,EAAJ,KAAWiR,KAAK,CAACgI,KAAN,CAAYmb,WAA3B;AAAA,eADU,CAAjB;;AAIA,qBAAI,CAAC4d,iBAAL,CAAuB/gC,KAAK,CAAC9R,KAA7B,IAAsC,OAAA8R,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAEzb,OAAP,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAE+7B,WAAhB,MAA2B,MAAItgB,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAE/J,QAAX,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAEqqB,WAAhD,KAA+D,KAArG;AACA,qBAAI,CAACrnB,IAAL,CAAU+G,KAAK,CAAC9R,KAAhB,IAAyB,IAAI,QAAAgsB,SAAJ,CAAc;AACnC3I,qBAAK,EAAE,IAAI,QAAAkG,WAAJ,CAAgB,OAAI,CAAClG,KAAL,CAAWvR,KAAK,CAAC9R,KAAjB,KAA2B,EAA3C,CAD4B;AAEnC2Y,oBAAI,EAAE,IAAI,QAAA4Q,WAAJ,CAAgB,OAAI,CAACmB,KAAL,CAAW5Y,KAAK,CAAC9R,KAAjB,KAA2B,EAA3C,EACF,OAAI,CAAC6yC,iBAAL,CAAuB/gC,KAAK,CAAC9R,KAA7B,IACI,CAAC,QAAAypB,UAAA,CAAWuf,OAAX,CAAmB,mBAAnB,CAAD,EAA0C,QAAAvf,UAAA,CAAWG,SAAX,CAAqB,CAArB,CAA1C,EAAoE,QAAAH,UAAA,CAAWC,QAA/E,CADJ,GACgG,CAAC,QAAAD,UAAA,CAAWuf,OAAX,CAAmB,mBAAnB,CAAD,EAA0C,QAAAvf,UAAA,CAAWG,SAAX,CAAqB,CAArB,CAA1C,CAF9F;AAF6B,eAAd,CAAzB;AAPkB;;AACtB,sEAAqC;AAAA;AAYpC;AAbqB;AAAA;AAAA;AAAA;AAAA;AAczB;AAED;;;;0CACuB;;;AACnB,qBAAK2pB,WAAL,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAE9mD,aAAF,CAAgB+mD,QAAhB,CAAyB;AACrCC,eAAG,EAAE,KAAKF,WAAL,CAAiB9mD,aAAjB,CAA+BinD,YADC;AAErCC,gBAAI,EAAE,CAF+B;AAGrCC,oBAAQ,EAAE;AAH2B,WAAzB,CAAhB;AAKH;;;4BA5GoB;AAAA;;AACjB,iBAAO,CAAC,KAAKxc,KAAL,CAAWnmB,MAAX,IAAqB,EAAtB,EAA0Bzb,MAA1B,CAAiC,UAACsc,KAAD;AAAA,mBACpC,OAAI,CAACslB,KAAL,CAAW1S,QAAX,CAAoB5yB,KAApB,CAA0BM,IAA1B,CAA+B,UAACo1B,KAAD;AAAA,qBAAWA,KAAK,CAACC,WAAN,KAAsB3V,KAAK,CAAC9R,KAAvC;AAAA,aAA/B,CADoC;AAAA,WAAjC,CAAP;AAGH;;;4BAEqB;AAClB,iBAAO,KAAK+K,IAAL,CAAU,KAAK+U,UAAL,CAAgB,KAAKgzB,YAArB,EAAmC9yC,KAA7C,CAAP;AACH;;;4BAE6B;;;AAC1B,iBAAO,YAAK6zC,WAAL,CAAiB1Z,QAAjB,CAA0BxhB,IAA1B,CAA+Bm7B,MAA/B,MAAqC,IAArC,IAAqC,aAArC,GAAqC,MAArC,GAAqC,GAAE9K,OAAvC,MAA8C,MAAI,KAAK6K,WAAL,CAAiB1Z,QAAjB,CAA0BxhB,IAA1B,CAA+Bm7B,MAAnC,MAAyC,IAAzC,IAAyC,aAAzC,GAAyC,MAAzC,GAAyC,GAAEC,SAAzF,CAAP;AACH;AAED;;;;4BACmB;AAAA;;AACf,iBAAO,KAAKj0B,UAAL,CAAgBvtB,MAAhB,CACH,UAACggB,KAAD,EAAQT,KAAR;AAAA,mBAAkBS,KAAK,IAAI,OAAI,CAACxH,IAAL,CAAU+G,KAAK,CAAC9R,KAAhB,EAAuBuS,KAAlD;AAAA,WADG,EAEH,IAFG,CAAP;AAIH;;;;;;AA5CL;;;uBAKamgC,6B,EAA6B,4C,EAAA,qC,EAAA,6C,EAAA,qBA6C1B,SAAAlC,eA7C0B,C;AA6CX,K;;;YA7ClBkC,6B;AAA6B,+C;AAAA;AAAA;;;;;;;;;;;;;;;;;;AC9C1C;AACI;AACI;AAAe;AAAA;AAAA;AACX;AAIJ;AACJ;AACA;AACI;AACJ;AACJ;AACA;AACI;AACI;AACI;AACA;AAAkB;AAAmD;AACzE;AACA;AA4CJ;AACJ;AACA;AACI;AACI;AAA+B;AAAA,mBAAS,IAAAsB,MAAA,EAAT;AAAiB,WAAjB;AAA/B;AAEA;AACJ;AACJ;;;;AArEuB;AAAA;AAEP;AAAA;AAME;AAAA;AASJ;AAAA;;;;;;;;;2BD2BDtB,6B,EAA6B;cALzC,OAAAjC,SAKyC;eAL/B;AACPjlD,kBAAQ,EAAE,0BADH;AAEPklD,qBAAW,EAAE,yCAFN;AAGPC,mBAAS,EAAE,CAAC,yCAAD;AAHJ,S;AAK+B,Q;;;;;;;;;;kBA6CjC,OAAAlT,M;mBAAO,SAAA+S,e;;;;;gBA3CX,OAAAI;;;gBAcA,OAAAqD,S;iBAAU,S,EAAW;AAAE,sBAAQ;AAAV,W;;;;;;;;;;;;;;;;;;;;;;;;AE9D1B;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAMA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACPQ;;;;;AAAuB;;;;;;AAD3B;AACI;AACA;AACI;AACJ;AACJ;;;;;AAJc;AAAA;AAEH;AAAA;;;;;;;;;;;;;;;;;;;;AAIf;AACI;AACI;AAAA;AAAqF;AACrF;AAAiC;AAAA;AAAA;AAAA;AAAA;AAAmB;AAAoB;AAC5E;AACJ;;;;;AAF4D;AAAA;;;;;;AAIxD;AACI;AACI;AACI;AACJ;AACA;AAAkB;AAAa;AACnC;AACJ;;;;;AAF0B;AAAA;;;;ADKjB,YAAAC,gBAAA,GAAmB;AAC5B1qD,YAAM,EAAE,MADoB;AAE5BomD,WAAK,EAAE,MAFqB;AAG5BuE,eAAS,EAAE,mBAHiB;AAI5BxE,cAAQ,EAAE;AAJkB,KAAnB;;QAYAyE,qB;;;;;AA0BT,qCACYrG,OADZ,EAEqC3W,KAFrC,EAE4D;AAAA;;AAAA;;AAExD;AAHQ,gBAAA2W,OAAA,GAAAA,OAAA;AACyB,gBAAA3W,KAAA,GAAAA,KAAA;AA3BrC;;AACiB,gBAAA96B,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AA0B2C;AAG3D;AAzBD;;;;;;AA2BA;;;iCAGgB;AACZ,eAAK5xC,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,kBAAM,EAAE;AAAV,WAAhB;AACH;;;4BA/Be;AACZ,iBAAO,CAAC,KAAK8kB,KAAL,GAAa,KAAKA,KAAL,CAAW7b,KAAxB,GAAgC,IAAjC,KAA0C,SAAjD;AACH;AAED;;;;4BACkB;AACd,iBAAO,CAAC,KAAK6b,KAAL,GAAa,KAAKA,KAAL,CAAW1wB,OAAxB,GAAkC,IAAnC,KAA4C,eAAnD;AACH;AAED;;;;4BACiB;AACb,iBAAO,CAAC,KAAK0wB,KAAL,GAAa,KAAKA,KAAL,CAAWv3B,MAAxB,GAAiC,IAAlC,KAA2C,IAAlD;AACH;AAED;;;;4BACe;AACX,iBAAO,CAAC,KAAKu3B,KAAL,GAAa,KAAKA,KAAL,CAAW3wB,IAAxB,GAA+B,IAAhC,KAAyC,IAAhD;AACH;;;;MAxBsC,OAAApb,a;;AAL3C;;;uBAKa+oD,qB,EAAqB,qC,EAAA,qBA4BlB,SAAA5D,eA5BkB,C;AA4BH,K;;;YA5BlB4D,qB;AAAqB,oC;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,oX;AAAA;AAAA;ACxClC;AACI;AAAqB;AAAwB;AACjD;AACA;AACI;AAMJ;AACA;AAMA;;;;;;AAhByB;AAAA;AAGH;AAAA,8CAAiC,UAAjC,EAAiC,GAAjC;AAOF;AAAA;;;;;;;;;2BD6BPA,qB,EAAqB;cALjC,OAAA3D,SAKiC;eALvB;AACPjlD,kBAAQ,EAAE,eADH;AAEPklD,qBAAW,EAAE,gCAFN;AAGPC,mBAAS,EAAE,CAAC,gCAAD;AAHJ,S;AAKuB,Q;;;;;;kBA4BzB,OAAAlT,M;mBAAO,SAAA+S,e;;;;;gBA1BX,OAAAI;;;;;;;;;;;;;;;;;;;;;;;;AE1CL;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;AAEA,QAAMyD,YAAY,GAAG,CACjB,+BAAAtC,yBADiB,EAEjB,2BAAAG,qBAFiB,EAGjB,0BAAAkC,qBAHiB,EAIjB,8BAAAE,wBAJiB,EAKjB,mCAAA7B,oCALiB,EAMjB,mCAAAC,6BANiB,EAOjB,sCAAA6B,gCAPiB,EAQjB,4BAAA3G,uBARiB,EASjB,sBAAA4G,iBATiB,EAUjB,yBAAA3D,oBAViB,CAArB;;QA+Ba4D,oB;;;;AAlBb;;YAkBaA;;;;yBAAAA,oB;AAAoB,O;AAAA,gBAjBpB,CACL,YAAAC,cADK,EAEL,QAAAC,WAFK,EAGL,QAAAC,mBAHK,EAIL,SAAA/qD,YAJK,EAKL,KAAAgrD,QALK,EAML,OAAAppD,UANK,EAOL,kBAAAqpD,YAPK,CAiBoB,EAHzB,OAAArpD,UAGyB;;;;+EAApBgpD,oB,EAAoB;AAAA,uBA9B7B,+BAAA1C,yBA8B6B,EA7B7B,2BAAAG,qBA6B6B,EA5B7B,0BAAAkC,qBA4B6B,EA3B7B,8BAAAE,wBA2B6B,EA1B7B,mCAAA7B,oCA0B6B,EAzB7B,mCAAAC,6BAyB6B,EAxB7B,sCAAA6B,gCAwB6B,EAvB7B,4BAAA3G,uBAuB6B,EAtB7B,sBAAA4G,iBAsB6B,EArB7B,yBAAA3D,oBAqB6B;AArBT,kBAKhB,YAAA6D,cALgB,EAMhB,QAAAC,WANgB,EAOhB,QAAAC,mBAPgB,EAQhB,SAAA/qD,YARgB,EAShB,KAAAgrD,QATgB,EAUhB,OAAAppD,UAVgB,EAWhB,kBAAAqpD,YAXgB,CAqBS;AAVb,kBApBhB,+BAAA/C,yBAoBgB,EAnBhB,2BAAAG,qBAmBgB,EAlBhB,0BAAAkC,qBAkBgB,EAjBhB,8BAAAE,wBAiBgB,EAhBhB,mCAAA7B,oCAgBgB,EAfhB,mCAAAC,6BAegB,EAdhB,sCAAA6B,gCAcgB,EAbhB,4BAAA3G,uBAagB,EAZhB,sBAAA4G,iBAYgB,EAXhB,yBAAA3D,oBAWgB,EAOZ,OAAAplD,UAPY;AAUa,O;AAHf,K;;;;;2BAGLgpD,oB,EAAoB;cAlBhC,OAAA3qD,QAkBgC;eAlBvB;AACNC,iBAAO,EAAE,CACL,YAAA2qD,cADK,EAEL,QAAAC,WAFK,EAGL,QAAAC,mBAHK,EAIL,SAAA/qD,YAJK,EAKL,KAAAgrD,QALK,EAML,OAAAppD,UANK,EAOL,kBAAAqpD,YAPK,CADH;AAUNnpD,sBAAY,YACL0oD,YADK,CAVN;AAaNzoD,iBAAO,YACAyoD,YADA,GAEH,OAAA5oD,UAFG;AAbD,S;AAkBuB,Q;;;;;;;;;;;;;;;;;;;;;;ACpDjC;AAAA;AAAA;;AAGA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACFI;AACI;AACJ;;;;AADc;AAAA;;;;;;AAGlB;AACI;AACJ;;;;;AADe;AAAA;;;;;;;;AAEf;AACI;AAAoE;AAAM;AAC1E;AAA+B;AAAA;AAAA;AAAA;AAAA;AAAwB;AAAI;AAC/D;;;;;;AAEI;AACI;AACI;AACI;AACJ;AACA;AACI;AACJ;AACJ;AACJ;;;;QDZSymD,qB;;;;;AALb;AAAA;;AAAA;;;AAMI;;AACiB,gBAAA51C,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AAPrB;AAsCC;;;;mCAvBkB;AACX,eAAK1mC,IAAL,GAAY,IAAI,cAAAob,IAAJ,EAAZ;AACA,eAAK7X,IAAL,GAAY,cAAAg+B,gBAAA,CAAiB,KAAKvhC,IAAtB,CAAZ;AACH;;;sCAEoB;AACjB,eAAKuD,IAAL,CAAUmoC,gBAAV;;AACA,cAAI,KAAKnoC,IAAL,CAAUwH,KAAd,EAAqB;AACjB,gBAAI,CAAC,KAAKxH,IAAL,CAAUovB,QAAV,CAAmBn6B,KAAnB,CAAyBlO,KAA9B,EAAqC;AACjC,mBAAKiZ,IAAL,CAAUovB,QAAV,CAAmBn6B,KAAnB,CAAyBxQ,QAAzB,WACON,IAAI,CAACY,KAAL,CAAWZ,IAAI,CAACuJ,MAAL,KAAgB,KAA3B,CADP;AAGH;;AACD,gBAAMs8C,QAAQ,GAAG,IAAI,cAAAnyB,IAAJ,CAAS,MAAD,OAAC,CAAD,kBAClB,KAAK7X,IAAL,CAAUjZ,KADQ,CAAC,EACJ;AAClBnH,kBAAI,YAAK,KAAKogB,IAAL,CAAUjZ,KAAV,CAAgBs1C,UAArB,cAAmC,KAAKr8B,IAAL,CAAUjZ,KAAV,CAAgBu1C,SAAnD,CADc;AAElBxzC,kBAAI,EAAE,UAFY;AAGlBmzB,sBAAQ,EAAE,IAHQ;AAIlB+e,qBAAO,EAAE;AAJS,aADI,CAAT,CAAjB;AAOA,iBAAKzpC,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,oBAAM,EAAE,MAAV;AAAkB/G,sBAAQ,EAAEwpC;AAA5B,aAAhB;AACH;AACJ;;;;MAhCsC,OAAA1pD,a;;AAL3C;;;qDAKa6mD,qB;AAAqB,K;;;YAArBA,qB;AAAqB,qC;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,sc;AAAA;AAAA;ACXlC;AACI;AAAqB;AAAqB;AAC1C;AAGJ;AACA;AAGA;AAIA;;;;;;AAX6C;AAAA;AAI3B;AAAA,8CAAiC,UAAjC,EAAiC,GAAjC;AAGV;AAAA;;;;;;sEDEKA,qB;;;;2BAAAA,qB,EAAqB;cALjC,OAAAzB,SAKiC;eALvB;AACPjlD,kBAAQ,EAAE,gBADH;AAEPklD,qBAAW,EAAE,iCAFN;AAGPC,mBAAS,EAAE,CAAC,iCAAD;AAHJ,S;AAKuB,Q;;gBAE7B,OAAAC;;;;;;;;;;;;;;;;;;;;;;;;AEbL;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAGA;AAAA;AAAA;;;;;;;;;;;;;;QAUa0D,wB;;;;;AACT,wCACYtG,WADZ,EAC+D;AAAA;;AAAA;;AAE3D;AAFQ,gBAAAA,WAAA,GAAAA,WAAA,CAAmD,CAK/D;;AACiB,gBAAA1xC,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AAN8C;AAG9D,O,CAKD;;;;;kCACiB;AACb,eAAK5xC,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,kBAAM,EAAE;AAAV,WAAhB;;AACA,eAAK07B,WAAL,CAAiBhb,KAAjB;AACH,S,CAED;;;;iCACgB;AACZ,eAAK12B,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,kBAAM,EAAE;AAAV,WAAhB;;AACA,eAAK07B,WAAL,CAAiBhb,KAAjB;AACH;;;;MApByC,OAAA3nC,a;;AAL9C;;;uBAKaipD,wB,EAAwB,qC;AAAA,K;;;YAAxBA,wB;AAAwB,wC;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,e;AAAA,a;AAAA,mO;AAAA;AAAA;AClBrC;AACI;AACI;AACI;AACI;AACI;AACA;AAAG;AACH;AAAI;AAAsC;AAC9C;AACJ;AACA;AACI;AACgC;AAAA,mBAAiB,IAAAU,OAAA,EAAjB;AAA0B,WAA1B,EAA2B,iBAA3B,EAA2B;AAAA,mBACZ,IAAAC,MAAA,EADY;AACJ,WADvB;AAE/B;AACL;AACJ;AACJ;AACJ;;;;;;;;;2BDAaX,wB,EAAwB;cALpC,OAAA7D,SAKoC;eAL1B;AACPjlD,kBAAQ,EAAE,mBADH;AAEPklD,qBAAW,EAAE,oCAFN;AAGPC,mBAAS,EAAE,CAAC,oCAAD;AAHJ,S;AAK0B,Q;;;;;;gBAQhC,OAAAC;;;;;;;;;;;;;;;;;;;;;;;;AE1BL;AAAA;AAAA;;AASA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAYA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxBoB;AACI;AAIJ;;;;;;AALM;AACF;AAAA;;;;;;AAHZ;AACI;AAQJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoBA;AACI;AAAA;AAGA;AACA;AACI;AAAA;AAMC;AACL;AACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAcuB;;;;;;;AAZnB;AAKI;AAAA;AAOe;AAGf;AAAA;AACA;AACI;AAAA;AAAA;AAOA;AAAA;AACI;AAEJ;AAAA;AACA;AAAA;AAEA;AACJ;AACJ;;;;;AAzBQ;AAAA;AAKiB;AAAA;AAkBjB;AAAA;AAAA;;;;;;AA/ChB;AACI;AAeA;AACI;AAiCA;AACI;AAAA;AAQsB;AACtB;AAAA;AACA;AACI;AAAA;AAAA;AASA;AAAA;AACI;AAEJ;AAAA;AACA;AAAA;AAEA;AACJ;AACJ;AACJ;AACJ;;;;;AAjFsD;AAC/B;AAAA;AAmBX;AAAA;AAiCI;AAAA;;;;;;;;;;;QDvCX2D,gC;AA2CT,gDACY52B,IADZ,EAEYia,MAFZ,EAGqCR,KAHrC,EAIYzxB,SAJZ,EAIsC;AAAA;;AAH1B,aAAAgY,IAAA,GAAAA,IAAA;AACA,aAAAia,MAAA,GAAAA,MAAA;AACyB,aAAAR,KAAA,GAAAA,KAAA;AACzB,aAAAzxB,SAAA,GAAAA,SAAA;AA9CZ;;AACiB,aAAArJ,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AACjB;;AACO,aAAA7qB,KAAA,GAAyB,EAAzB;AACP;;AACO,aAAAqH,KAAA,GAAyB,EAAzB;AACP;;AACO,aAAAkoB,WAAA,GAA+B,EAA/B;AACP;;AACO,aAAA7nC,IAAA,GAA2B,EAA3B;AACP;;AACO,aAAA8nC,iBAAA,GAAsC,EAAtC;AACP;;AACO,aAAAC,YAAA,GAAuB,CAAvB;AAmCH,aAAK5pB,WAAL,GAAmBvjB,SAAS,CAAC8G,SAA7B;AACA,aAAK7C,QAAL,GAAgBjE,SAAS,CAACiE,QAA1B;AACH;AAjCD;;;;;mCAmCe;AACX,cAAMmpC,SAAS,GAAG,KAAK3b,KAAL,CAAW4b,WAAX,CAAuBlhD,KAAvB,CACb0D,MADa,CACN,UAAC8vB,IAAD;AAAA,mBAAuBA,IAAI,CAACzxB,IAAL,KAAc,WAArC;AAAA,WADM,CAAlB;;AAEA,eAAKwvB,KAAL,GAAa0vB,SAAS,CAACxgD,MAAV,CAAiB,UAACkC,GAAD,EAAM6wB,IAAN,EAAe;AACzC7wB,eAAG,CAAC6wB,IAAI,CAACxT,KAAN,CAAH,GAAkBwT,IAAI,CAAC/e,OAAvB;AACA,mBAAO9R,GAAP;AACH,WAHY,EAGV,EAHU,CAAb;AAIA,eAAKi2B,KAAL,GAAa,MAAH,OAAG,CAAH,EAAG,EAAK,KAAK0M,KAAL,CAAW8d,WAAX,CAAuBpjD,KAA5B,CAAb;AACA,eAAK8gD,WAAL,GAAmB,MAAH,OAAG,CAAH,EAAG,EAAK,KAAKxb,KAAL,CAAW+d,iBAAX,CAA6BrjD,KAAlC,CAAnB;AACA,eAAKmhD,kBAAL;AACH;;;iCAEY;AAAA;;AACT,eAAKnzB,UAAL,CAAgB9yB,OAAhB,CAAwB,UAAA8kB,KAAK;AAAA,mBAAI,QAAI,CAAC/G,IAAL,CAAU+G,KAAK,CAAC9R,KAAhB,EAAuBkzC,gBAAvB,EAAJ;AAAA,WAA7B;AACA;;AACA,cAAI,KAAKC,QAAT,EAAmB;AACf;AACA,gBAAM9vB,KAAK,GAAG,KAAK+T,KAAL,CAAW4b,WAAX,CAAuBlhD,KAAvB,CACT0D,MADS,CACF,UAAC8vB,IAAD;AAAA,qBAAuBA,IAAI,CAACzxB,IAAL,KAAc,WAArC;AAAA,aADE,CAAd;;AAEA,gBAAMu/C,SAAS,GAAG,KAAKtzB,UAAL,CAAgBrrB,GAAhB,CAAoB,UAAAqd,KAAK;AAAA,qBAAK;AAC5CqT,sBAAM,EAAE,QAAI,CAACyS,MAAL,CAAYtO,OAAZ,CAAoB3+B,IADgB;AAE5CkJ,oBAAI,EAAE,WAFsC;AAG5C0S,uBAAO,EAAE,QAAI,CAACwE,IAAL,CAAU+G,KAAK,CAAC9R,KAAhB,EAAuBm6B,QAAvB,CAAgC9W,KAAhC,CAAsCvxB,KAAtC,CAA4Co5C,IAA5C,EAHmC;AAI5Cp5B,qBAAK,EAAEA,KAAK,CAAC9R,KAJ+B;AAK5CpR,oBAAI,EAAE,UAAAyJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J;AALkB,eAAL;AAAA,aAAzB,CAAlB;;AAOA,iBAAK6+B,KAAL,CAAW4b,WAAX,CAAuBxjD,QAAvB,CAAgC6zB,KAAK,CAAC3C,MAAN,CAAa0yB,SAAb,EAAwB59C,MAAxB,CAA+B,UAAA8vB,IAAI;AAAA,qBAAIA,IAAI,CAAC/e,OAAT;AAAA,aAAnC,CAAhC;;AACA,iBAAK6wB,KAAL,CAAW8d,WAAX,CAAuB1lD,QAAvB,CAAgC,KAAKswB,UAAL,CAAgBvtB,MAAhB,CAAuB,UAACkC,GAAD,EAAMqd,KAAN,EAAgB;AACnErd,iBAAG,CAACqd,KAAK,CAAC9R,KAAP,CAAH,GAAmB,QAAI,CAAC+K,IAAL,CAAU+G,KAAK,CAAC9R,KAAhB,EAAuBm6B,QAAvB,CAAgCxhB,IAAhC,CAAqC7mB,KAAxD;AACA,qBAAO2C,GAAP;AACH,aAH+B,EAG7B,EAH6B,CAAhC;;AAIA,iBAAK2iC,KAAL,CAAW+d,iBAAX,CAA6B3lD,QAA7B,CAAsC,KAAKswB,UAAL,CAAgBvtB,MAAhB,CAAuB,UAACkC,GAAD,EAAMqd,KAAN,EAAgB;AACzErd,iBAAG,CAACqd,KAAK,CAAC9R,KAAP,CAAH,GAAmB,QAAI,CAAC+K,IAAL,CAAU+G,KAAK,CAAC9R,KAAhB,EAAuBm6B,QAAvB,CAAgCib,UAAhC,CAA2CtjD,KAA9D;AACA,qBAAO2C,GAAP;AACH,aAHqC,EAGnC,EAHmC,CAAtC;;AAIA,iBAAK6H,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,oBAAM,EAAE;AAAV,aAAhB;AACH,WArBD,MAqBO;AACH,iBAAKihC,WAAL,CAAiB9mD,aAAjB,CAA+B+mD,QAA/B,CAAwC;AACpCC,iBAAG,EAAE,KAAKF,WAAL,CAAiB9mD,aAAjB,CAA+BinD,YADA;AAEpCC,kBAAI,EAAE,CAF8B;AAGpCC,sBAAQ,EAAE;AAH0B,aAAxC;AAKH;AACJ;AAED;;;;6CAC0B;AAAA;;;;AAAA,uDACF,KAAK9zB,UADH;AAAA;;AAAA;AAAA;AAAA,kBACXhO,KADW;;AAElB,kBAAMG,QAAQ,GAAG,QAAI,CAAC0L,IAAL,CAAUja,SAAV,CAAoBtR,IAApB,CACb,UAAA4iC,GAAG;AAAA,uBAAIA,GAAG,CAACn0B,EAAJ,KAAWiR,KAAK,CAACgI,KAAN,CAAYmb,WAA3B;AAAA,eADU,CAAjB,CAFkB,CAKlB;;;AALkB,kBAMV5+B,OANU,GAMYyb,KANZ,CAMVzb,OANU;AAAA,kBAMD0R,QANC,GAMY+J,KANZ,CAMD/J,QANC;AAOlB,kBAAMstC,eAAe,GAAG,CAAAh/C,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE0gC,cAAT,MAA2BhvB,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEgvB,cAArC,CAAxB;AACA,kBAAMue,iBAAiB,GAAG,CAAH,KAAGrjC,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEyX,QAAV,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEqN,cAA9C;AACA,sBAAI,CAAC8b,iBAAL,CAAuB/gC,KAAK,CAAC9R,KAA7B,IAAsCq1C,eAAe,KAAKxkD,SAApB,GAAgCwkD,eAAhC,GAAkDC,iBAAiB,KAAKzkD,SAAtB,GAAkCykD,iBAAlC,GAAqD,KAA7I;AAEA,sBAAI,CAACvqC,IAAL,CAAU+G,KAAK,CAAC9R,KAAhB,IAAyB,IAAI,QAAAgsB,SAAJ,CAAc;AACnC3I,qBAAK,EAAE,IAAI,QAAAkG,WAAJ,CAAgB,QAAI,CAAClG,KAAL,CAAWvR,KAAK,CAAC9R,KAAjB,KAA2B,EAA3C,CAD4B;AAEnC2Y,oBAAI,EAAE,IAAI,QAAA4Q,WAAJ,CACF,QAAI,CAACmB,KAAL,CAAW5Y,KAAK,CAAC9R,KAAjB,KAA2B,EADzB,EAEF,QAAI,CAAC6yC,iBAAL,CAAuB/gC,KAAK,CAAC9R,KAA7B,IACI,CAAC,QAAAypB,UAAA,CAAWuf,OAAX,CAAmB,gBAAnB,CAAD,EAAuC,QAAAvf,UAAA,CAAWG,SAAX,CAAqB,CAArB,CAAvC,EAAiE,QAAAH,UAAA,CAAWC,QAA5E,CADJ,GAC4F,CAAC,QAAAD,UAAA,CAAWG,SAAX,CAAqB,CAArB,CAAD,EAA0B,QAAAH,UAAA,CAAWuf,OAAX,CAAmB,gBAAnB,CAA1B,CAH1F,CAF6B;AAOnCoM,0BAAU,EAAE,IAAI,QAAA7rB,WAAJ,CAAgB,QAAI,CAACqpB,WAAL,CAAiB9gC,KAAK,CAAC9R,KAAvB,KAAiC,EAAjD,EAAqD,CAAC,QAAAypB,UAAA,CAAWC,QAAZ,EAAsB,QAAAD,UAAA,CAAWuf,OAAX,CAAmB,UAAnB,CAAtB,CAArD;AAPuB,eAAd,CAAzB;AAXkB;;AACtB,sEAAqC;AAAA;AAmBpC;AApBqB;AAAA;AAAA;AAAA;AAAA;AAqBzB;;;4BArGoB;AACjB,iBAAO,KAAK5R,KAAL,CAAWnmB,MAAlB;AACH;;;4BAEwB;AACrB,iBAAO,KAAP;AACH;;;4BAEqB;AAClB,iBAAO,KAAKlG,IAAL,CAAU,KAAK+U,UAAL,CAAgB,KAAKgzB,YAArB,EAAmC9yC,KAA7C,CAAP;AACH;;;4BAE6B;;;AAC1B,iBAAO,YAAK6zC,WAAL,CAAiB1Z,QAAjB,CAA0BxhB,IAA1B,CAA+Bm7B,MAA/B,MAAqC,IAArC,IAAqC,aAArC,GAAqC,MAArC,GAAqC,GAAEC,SAAvC,MAAgD,MAAI,KAAKF,WAAL,CAAiB1Z,QAAjB,CAA0BxhB,IAA1B,CAA+Bm7B,MAAnC,MAAyC,IAAzC,IAAyC,aAAzC,GAAyC,MAAzC,GAAyC,GAAE9K,OAA3F,CAAP;AACH;AAED;;;;4BACmB;AAAA;;AACf,iBAAO,KAAKlpB,UAAL,CAAgBvtB,MAAhB,CAAuB,UAACggB,KAAD,EAAQT,KAAR;AAAA,mBAAkBS,KAAK,IAAI,QAAI,CAACxH,IAAL,CAAU+G,KAAK,CAAC9R,KAAhB,EAAuBuS,KAAlD;AAAA,WAAvB,EAAgF,IAAhF,CAAP;AACH;;;;;;AA3CL;;;uBAKagiC,gC,EAAgC,4C,EAAA,qC,EAAA,qBA8C7B,SAAA/D,eA9C6B,C,EA8Cd,wC;AAAA,K;;;YA9ClB+D,gC;AAAgC,kD;AAAA;AAAA;;;;;;;;;;;;;;;;;;AC7C7C;AACI;AACI;AAAe;AAAA;AAAA;AACX;AAUJ;AACJ;AACA;AACI;AACJ;AACJ;AACA;AACI;AACI;AACI;AACA;AAAA;AAMA;AACJ;AACA;AAkFJ;AACJ;AACA;AACI;AACI;AAA+B;AAAA,mBAAS,IAAAP,MAAA,EAAT;AAAiB,WAAjB;AAAmB;AAAc;AACpE;AACJ;;;;AArHuB;AAAA;AACF;AAAA;AAaH;AAAA;AAIR;AAAA;AAGO;AAAA;AAML;AAAA;AAAA;AAEE;AAAA;;;;;;;;;2BDcDO,gC,EAAgC;cAL5C,OAAA9D,SAK4C;eALlC;AACPjlD,kBAAQ,EAAE,6BADH;AAEPklD,qBAAW,EAAE,4CAFN;AAGPC,mBAAS,EAAE,CAAC,4CAAD;AAHJ,S;AAKkC,Q;;;;;;;;kBA8CpC,OAAAlT,M;mBAAO,SAAA+S,e;;;;;;;gBA5CX,OAAAI;;;gBAcA,OAAAqD,S;iBAAU,S,EAAW;AAAE,sBAAQ;AAAV,W;;;;;;;;;;;;;;;;;;;;;;;;;;;;AE7D1B;AAAA;AAAA;;AAOA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAaA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtBgB;AAA6C;AAAI;;;;;;AAOzC;AACI;AACJ;;;;;AAFuC;AACnC;AAAA;;;;;;;;AAPZ;AACI;AAEI;AAAA;AAAA;AAAA;AAAA,WAAuB,aAAvB,EAAuB;AAAA;AAAA;AAAA,iBACR,QAAAsB,OAAA,mCAAkC,GAAlC,GAAwC,OAAH,YAAG,CAAH,EAArC,CADQ;AAC+C,SADtE;AAGA;AAGJ;AACJ;;;;;AAPQ;AAAA;AAGY;AAAA;;;;;;;;AAvBxB;AACI;AASI;AAAA;AAAA;AAAA;AAAA,WAAiC,cAAjC,EAAiC;AAAA;AAAA;AAAA;AAAA,SAAjC,EAAiC,gBAAjC,EAAiC;AAAA;AAAA;AAAA;AAAA,SAAjC;AAKH;AACD;AACA;AAWJ;;;;;AAxBQ;AAAA,wCAAiB,oBAAjB,EAAiB,IAAjB,EAAiB,SAAjB,EAAiB,cAAjB,EAAiB,iBAAjB,EAAiB,sBAAjB,EAAiB,YAAjB,EAAiB,IAAjB,EAAiB,SAAjB,EAAiB,IAAjB;AAYO;AAAA;AAC0B;AAAA;;;;;;;;;;;;;;AAoBzB;AACI;AAIJ;;;;AAHQ;AAAA;;;;;;;;;;;;;;;;AAPZ;AACI;AACI;AAAkB;AAAsB;AACxC;AAAkB;AAAsB;AAC5C;AACA;AAMA;AACI;AAIA;AAAkB;AAA2B;AACjD;AACA;AACI;AAII;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACJ;AACJ;AACJ;;;;;;AA1B0B;AAAA;AACA;AAAA;AAEI;AAAA;AAQlB;AAAA;AAGc;AAAA;AAEjB;AAAA;AAEG;AAAA;AAKA;AAAA;;;;;;AA1BhB;AACI;AA6BJ;;;;;AA7BsB;AAAA;;;;;;AAF1B;AACI;AA+BJ;;;;;;;;AA/BkB;AAAA,qEAAiD,UAAjD,EAAiD,GAAjD;;;;;;;;;;;;;;;;;;;;;;AAwCd;AACI;AASI;AAMJ;AACA;AACI;AAAkB;AAAgB;AAClC;AAAkB;AAAsB;AAC5C;AACA;AACI;AAGA;AAAkB;AAA2B;AACjD;AACA;AACI;AAAsC;AAAA;AAAA;AAAA;AAAA;AAAA;AAClC;AAGJ;AACJ;AACJ;;;;;;AA/BQ;AAAA;AACA;AAOI;AAAA;AAOc;AAAA;AACA;AAAA;AAId;AAAA;AAEc;AAAA;AAEjB;AAAA;AAGO;AAAA;;;;;;AAjCpB;AAGI;AAmCJ;;;;;AAnCsB;AAAA;;;;;;;;;;;;;;;AAN9B;AACI;AAAI;AAAe;AACnB;AACI;AAuCJ;AACA;AACI;AAA+B;AAAA;AAAA;AAAA;AAAA;AAAqC;AAAc;AACtF;AACA;AAAwE;AAAA;AAAA;AAAA,qCAAqB,KAArB;AAA0B,SAA1B;AACpE;AACJ;AACA;AACI;AAAwB;AAAA;AAAA;AAAA,qCAAqB,IAArB;AAAyB,SAAzB;AACpB;AACJ;AACJ;AACJ;;;;;;;;AAtDK;AAAqD;AAI9C;AAAA,uFAA0E,UAA1E,EAA0E,GAA1E;AA0CgB;AAAA,sCAAoB,aAApB,EAAoB,IAApB;AACV;AAAA;AAII;AAAA;;;;;;AAO1B;AACI;AACI;AACJ;AACA;AAAkB;AAA2B;AACjD;;;;;;AAGA;AACI;AACI;AACJ;AACA;AAAkB;AAAoD;AAC1E;;;;AAHkB;AAAA;;;;;;AAMlB;AACI;AACI;AACJ;AACA;AAAkB;AAAkB;AACxC;;;;AAHkB;AAAA;;;;QD9ETxD,yB;;;;;AAkET,yCACYp0B,IADZ,EAEYia,MAFZ,EAGYha,OAHZ,EAIYjY,SAJZ,EAKYooC,OALZ,EAMqC3W,KANrC,EAMgE;AAAA;;AAAA;;AAE5D;AAPQ,iBAAAzZ,IAAA,GAAAA,IAAA;AACA,iBAAAia,MAAA,GAAAA,MAAA;AACA,iBAAAha,OAAA,GAAAA,OAAA;AACA,iBAAAjY,SAAA,GAAAA,SAAA;AACA,iBAAAooC,OAAA,GAAAA,OAAA;AACyB,iBAAA3W,KAAA,GAAAA,KAAA;AAvErC;;AACiB,iBAAA96B,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AAGjB;;AACO,iBAAAj9B,MAAA,GAAkB,EAAlB;AAOP;;AACgB,iBAAAskC,OAAA,GAAU,IAAI,OAAA7qC,OAAJ,EAAV;AAChB;;AACO,iBAAA8qC,eAAA,GAA2B,EAA3B;AACP;;AACO,iBAAAC,WAAA,GAAgC,EAAhC;AAOP;;AACO,iBAAA7c,KAAA,GAAoB,EAApB;AAmBA,iBAAA8c,SAAA,GAAY,IAAI,QAAA1pB,SAAJ,CAAc;AAC7B/jB,kBAAQ,EAAE,IAAI,QAAAshB,WAAJ,CAAgB,EAAhB;AADmB,SAAd,CAAZ;AAIA,iBAAA/X,OAAA,GAAU,IAAI,OAAAnnB,eAAJ,CAAyC,EAAzC,CAAV;AAEA,iBAAA6uB,eAAA,GAAkB,IAAI,OAAA7uB,eAAJ,CAAyC,EAAzC,CAAlB;AAKP;;AACO,iBAAAo1B,QAAA,GAAqB,EAArB;;AAuPA,iBAAAk2B,aAAA,GAAgB,YAAM;AACzB,cAAI,SAAKC,cAAL,CAAoB9kD,MAAxB,EAAgC;AAC5B,qBAAKykD,OAAL,CAAax4C,IAAb,CAAkB,SAAK64C,cAAvB;AACH,WAFD,MAEO;AACH,qBAAK3kC,MAAL,GAAc,EAAd;AACH;AACJ,SANM;;AArOH,iBAAKiY,WAAL,GAAmBvjB,SAAS,CAAC8G,SAA7B;AACA,iBAAK7C,QAAL,GAAgBjE,SAAS,CAACiE,QAA1B;AAJ4D;AAK/D;AA9CD;;;;;mCAgDe;AAAA;;AACX,eAAKgU,OAAL,CAAazW,WAAb,CAAyBzH,IAAzB,CAA8B,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,mBAAOA,CAAP;AAAA,WAAN,CAA9B,EAA+CvZ,SAA/C,CAAyD,YAAM;;;AAC3D,gBAAIgpD,UAAU,GAAG,CAAjB,CAD2D,CAE3D;;AACA,oBAAI,CAACC,eAAL,GAAuB,QAAI,CAACP,OAAL,CAAa71C,IAAb,CACnB,YAAA2f,YAAA,CAAa,GAAb,CADmB,EAEnB,YAAAkyB,oBAAA,EAFmB,EAGnB,YAAAjyB,SAAA,CAAU,UAAC0V,GAAD,EAAS;AACf,sBAAI,CAACntB,OAAL,GAAe,IAAf;AACA,kBAAM4X,QAAQ,GAAa,EAA3B;AACA;;AACA,kBAAI,QAAI,CAACs2B,eAAT,EAA0B;AACtBt2B,wBAAQ,CAAChpB,IAAT,CAAc,QAAI,CAACs/C,eAAL,CAAqBl1C,EAAnC;AACH;;AAED,kBAAIm0B,GAAG,SAAH,IAAAA,GAAG,WAAH,GAAG,MAAH,GAAAA,GAAG,CAAEtsB,QAAL,CAAc,GAAd,CAAJ,EAAwB;AACpBssB,mBAAG,GAAG,QAAI,CAAC4gB,cAAX;AACH;;AAED,kBAAM/0C,EAAE,GAAGg1C,UAAX;AACA,qBAAO,QAAI,CAACj4B,OAAL,CAAanK,SAAb,CAAuB;AAC1BgM,wBAAQ,EAAE,CAAAuV,GAAG,SAAH,IAAAA,GAAG,WAAH,GAAG,MAAH,GAAAA,GAAG,CAAElkC,MAAL,IAAckkC,GAAd,GAAoB,QAAI,CAACoC,KAAL,CAAWnmB,MAAX,CAAkB,CAAlB,EAAqBgB,QAArB,CAA8BpR,EAA9B,IAAoC4e,QAAQ,CAACxnB,IAAT,CAAc,GAAd,CADxC;AAE1B1I,sBAAM,EAAE,QAAI,CAAC6nC,KAAL,CAAW7nC,MAFO;AAG1BI,wBAAQ,EAAE,QAAI,CAACynC,KAAL,CAAWznC;AAHK,eAAvB,EAIJ2b,IAJI,CAIC,UAAOxe,IAAP;AAAA,uBAAgB,OAAD,UAAC,CAAD,QAAC,EAAD,MAAC,EAAD,MAAC,uCAAD;AAAA;AAAA;AAAA;AAAA;AAAA,6DAAE;AAAE+T,8BAAE,EAAFA,EAAF;AAAM/T,gCAAI,EAAJA;AAAN,2BAAF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAC,EAAhB;AAAA,eAJD,CAAP;AAKH,aAlBD,CAHmB,EAsBnB,YAAAsgB,UAAA,CAAW,UAAChH,CAAD;AAAA,qBAAO,OAAAkH,EAAA,CAAG;AAAEzM,kBAAE,EAAEg1C,UAAN;AAAkB/oD,oBAAI,EAAE,EAAxB;AAA4BugB,qBAAK,EAAEjH;AAAnC,eAAH,CAAP;AAAA,aAAX,CAtBmB,EAuBnB,YAAA3R,GAAA,CAAI,UAACuhD,IAAD,EAAyC;AACzC,sBAAI,CAACnuC,OAAL,GAAe,KAAf;AACA,kBAAM4lB,aAAa,GAAGuoB,IAAI,CAAClpD,IAAL,CAAU0I,MAAV,CAAiB,UAACsc,KAAD,EAAkB;AACrD;AACA,oBAAI,QAAI,CAACnM,SAAL,CAAe8G,SAAnB,EAA8B;AAC1B,yBAAO,CAAC,QAAI,CAACwpC,WAAL,IAAoB,QAAI,CAACA,WAAL,CAAiBp1C,EAArC,GAA0CiR,KAAK,CAACI,KAAN,CAAYxJ,QAAZ,WAAwB,QAAI,CAACutC,WAAL,CAAiBp1C,EAAzC,EAA1C,GAA2F,IAA5F,KACH,CAAC,QAAI,CAAC20C,eAAL,CAAqBpjD,IAArB,CAA0B,UAAC+R,CAAD;AAAA,2BAAOA,CAAC,CAACtD,EAAF,KAASiR,KAAK,CAACjR,EAAtB;AAAA,mBAA1B,CADL;AAEH;;AAED,oBAAMsR,KAAK,GAAGL,KAAK,CAAC4sB,QAAN,CAAe;AACzBnvC,wBAAM,EAAE,QAAI,CAAC6nC,KAAL,CAAW7nC,MADM;AAEzBI,0BAAQ,EAAE,QAAI,CAACynC,KAAL,CAAWznC,QAFI;AAGzBuY,sBAAI,EAAE,QAAI,CAACA,IAAL,IAAa,QAAI,CAACkvB,KAAL,CAAWlvB;AAHL,iBAAf,CAAd;AAKA,uBACIiK,KAAK,CAACK,IAAN,KAAe,IAAf,KACC,QAAI,CAACyjC,WAAL,IAAoB,QAAI,CAACA,WAAL,CAAiBp1C,EAArC,GACKiR,KAAK,CAACI,KAAN,CAAYxJ,QAAZ,WAAwB,QAAI,CAACutC,WAAL,CAAiBp1C,EAAzC,EADL,GAEK,IAHN,KAIA,CAAC,QAAI,CAAC20C,eAAL,CAAqBpjD,IAArB,CAA0B,UAAC8jD,MAAD;AAAA,yBAAYA,MAAM,CAACr1C,EAAP,KAAciR,KAAK,CAACjR,EAAhC;AAAA,iBAA1B,CALL;AAOH,eAnBqB,CAAtB;AAoBA,qBAAOm1C,IAAI,CAACn1C,EAAL,KAAYg1C,UAAZ,GAAyBpoB,aAAzB,GAAyC,QAAI,CAACxc,MAArD;AACH,aAvBD,CAvBmB,CAAvB,CAH2D,CAmD3D;;AACA,oBAAI,CAACtkB,YAAL,CACI,gBADJ,EAEI,QAAI,CAACmpD,eAAL,CAAqBjpD,SAArB,CAA+B,UAACC,IAAD,EAAU;AACrC,sBAAI,CAACmkB,MAAL,GAAcnkB,IAAI,CAAC0I,MAAL,CAAY,UAACsc,KAAD,EAAW;AACjC,oBAAI,CAACA,KAAK,CAAC2B,SAAX,EAAsB;AAClB,yBAAO,KAAP;AACH;;AAHgC,6DAId,QAAI,CAACgM,QAJS;AAAA;;AAAA;AAIjC,4EAAkC;AAAA,wBAAvB1mB,IAAuB;;AAC9B,wBAAI+Y,KAAK,CAACI,KAAN,CAAYxJ,QAAZ,CAAqB3P,IAArB,CAAJ,EAAgC;AAC5B,6BAAO,IAAP;AACH;AACJ;AARgC;AAAA;AAAA;AAAA;AAAA;;AASjC,uBAAO,CAAC,QAAI,CAAC0mB,QAAL,CAAc3uB,MAAtB;AACH,eAVa,CAAd;;AAWA,sBAAI,CAACmgB,MAAL,CAAYna,IAAZ,CAAiB,UAACC,CAAD,EAAIC,CAAJ;AAAA,uBAAU,QAAI,CAACF,IAAL,CAAUC,CAAV,EAAaC,CAAb,CAAV;AAAA,eAAjB;;AACA,kBAAI,CAAC,QAAI,CAACkiB,eAAL,CAAqBpnB,KAArB,CAA2BhB,MAAhC,EAAwC;AACpC,wBAAI,CAACqlD,kBAAL;AACH;AACJ,aAhBD,CAFJ;;AAoBA,oBAAI,CAACJ,eAAL,GAAuB,eAAI,CAAC3e,KAAL,CAAWnmB,MAAX,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEngB,MAAnB,IACjB,QAAI,CAAC6sB,IAAL,CAAUja,SAAV,CAAoBtR,IAApB,CAAyB,UAACnF,CAAD;AAAA,qBAAOA,CAAC,CAAC4T,EAAF,KAAS,QAAI,CAACu2B,KAAL,CAAWnmB,MAAX,CAAkB,CAAlB,EAAqB6I,KAArB,CAA2Bmb,WAA3C;AAAA,aAAzB,CADiB,GAEjB,QAAI,CAACtX,IAAL,CAAU1L,QAFhB;AAGA,oBAAI,CAAC2mB,KAAL,GAAa,CAAC;AAAE/3B,gBAAE,EAAE,EAAN;AAAUlW,kBAAI,EAAE;AAAhB,aAAD,EAA4C+1B,MAA5C,CACT,QAAI,CAAC/C,IAAL,CAAU0a,WAAV,IAAyB,EADhB,CAAb;AAGA,oBAAI,CAAC4d,WAAL,GAAmB,QAAI,CAACrd,KAAL,CAAW,CAAX,CAAnB;;AACA,oBAAI,CAAC2c,OAAL,CAAax4C,IAAb,CAAkB,EAAlB;AACH,WAhFD;;AAkFA,eAAKpQ,YAAL,CAAkB,WAAlB,EAA+B,KAAKgxB,IAAL,CAAUxwB,MAAV,CAAiB,WAAjB,EAA8BN,SAA9B,CAAwC,UAACmrC,QAAD,EAAc;AACjF,gBAAM3zB,IAAI,GAAG,QAAI,CAACsZ,IAAL,CAAU1L,QAAV,CAAmB5N,IAAhC;AACA,gBAAM7Q,QAAQ,GAAG,QAAI,CAACmqB,IAAL,CAAU1L,QAAV,CAAmBze,QAApC;AACA,gBAAM4iD,eAAe,GAAG;AACpB9rD,iBAAG,EAAE;AAAEK,oBAAI,EAAE0Z,IAAR;AAAc7Q,wBAAQ,EAARA;AAAd,eADe;AAEpB1B,mBAAK,EAAE,CAAAkmC,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAExiC,MAAV,CAAiB,UAACw/B,GAAD;AAAA,uBAASA,GAAG,CAAC3wB,IAAJ,KAAaA,IAAtB;AAAA,eAAjB,MAAgD;AAFnC,aAAxB;AAIA,gBAAMgyC,cAAc,GAAGD,eAAe,CAACtkD,KAAhB,CAAsB2C,GAAtB,CACnB,UAACugC,GAAD;AAAA,qBAAS,cAAAvc,yBAAA,CAA0B29B,eAAe,CAAC9rD,GAAhB,CAAoBK,IAA9C,EAAoDqqC,GAApD,CAAT;AAAA,aADmB,CAAvB;AAGA,gBAAMtxB,SAAS,IACX,cAAAoV,wBAAA,CAAyBs9B,eAAe,CAAC9rD,GAAzC,CADW,4BAER+rD,cAFQ,EAAf;;AAIA,oBAAI,CAAC7kC,OAAL,CAAazU,IAAb,CAAkB2G,SAAlB;AACH,WAf8B,CAA/B;AAiBH;AAED;;;;iCACgBoO,K,EAAc;AAC1B,eAAK0jC,eAAL,CAAqB/+C,IAArB,CAA0Bqb,KAA1B;AACA,eAAK0jC,eAAL,GAAuB,OAAAlgD,MAAA,CAAO,KAAKkgD,eAAZ,EAA6B,IAA7B,CAAvB;AACH;AAED;;;;oCACmB1jC,K,EAAc;AAC7B,eAAK0jC,eAAL,GAAuB,KAAKA,eAAL,CAAqBhgD,MAArB,CAA4B,UAAC86C,OAAD;AAAA,mBAAaA,OAAO,CAACzvC,EAAR,KAAeiR,KAAK,CAACjR,EAAlC;AAAA,WAA5B,CAAvB;AACH;AAED;;;;6BACY/T,I,EAAe;AAAA;;AACvB,cAAI,CAAC,KAAKsqC,KAAL,CAAW6a,aAAhB,EAA+B;AAC3B;AACA,iBAAK31C,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,oBAAM,EAAE,MAAV;AAAkB/G,sBAAQ,EAAEze;AAA5B,aAAhB;AACA;AACH,WALsB,CAMvB;;;AACA,cAAIA,IAAI,CAAC,CAAD,CAAJ,CAAQqmB,YAAZ,EAA0B;AACtB,iBAAK7W,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,oBAAM,EAAE,MAAV;AAAkB/G,sBAAQ,EAAEze;AAA5B,aAAhB;AACA;AACH,WAVsB,CAWvB;;;AACA,eAAKwpD,mBAAL,GAA2B,KAAKvI,OAAL,CAAannC,IAAb,CAAkB,8BAAA0tC,wBAAlB,EAA4C;AACnEztC,sBAAU,EAAE,gBADuD;AAEnE0vC,qBAAS,EAAE,KAFwD;AAGnEC,yBAAa,EAAE;AAHoD,WAA5C,CAA3B;AAKA,eAAK7pD,YAAL,CACI,mBADJ,EAEI,KAAK2pD,mBAAL,CAAyBvG,iBAAzB,CAA2CzzC,KAA3C,CAAiDzP,SAAjD,CAA2D,UAACyP,KAAD,EAAW;AAClE,gBAAIA,KAAK,CAACgW,MAAN,KAAiB,MAArB,EAA6B;AACzB,sBAAI,CAAChW,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,sBAAM,EAAE,MAAV;AAAkB/G,wBAAQ,EAAEze;AAA5B,eAAhB;AACH;;AACD,gBAAIwP,KAAK,CAACgW,MAAN,KAAiB,OAArB,EAA8B;AAC1B,sBAAI,CAAChW,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,sBAAM,EAAE;AAAV,eAAhB;AACH;AACJ,WAPD,CAFJ;AAWH;;;iCAEgB;AACb,cAAM7d,GAAG,GAAG,EAAZ;AACA,cAAM+c,OAAO,GAA4B;AACrCjiB,kBAAM,EAAE,KAAK6nC,KAAL,CAAW7nC,MADkB;AAErCI,oBAAQ,EAAE,KAAKynC,KAAL,CAAWznC,QAFgB;AAGrCuY,gBAAI,EAAE,KAAKkvB,KAAL,CAAWlvB;AAHoB,WAAzC;AAKA,eAAKstC,eAAL,CAAqBxoD,OAArB,CAA6B,UAAC8kB,KAAD;AAAA,mBAAYrd,GAAG,CAACqd,KAAK,CAACjR,EAAP,CAAH,GAAgBiR,KAAK,CAAC2U,SAAN,CAAgBjV,OAAhB,CAA5B;AAAA,WAA7B;AACA,eAAKP,MAAL,CAAYjkB,OAAZ,CAAoB,UAAC8kB,KAAD;AAAA,mBAAYrd,GAAG,CAACqd,KAAK,CAACjR,EAAP,CAAH,GAAgBiR,KAAK,CAAC2U,SAAN,CAAgBjV,OAAhB,CAA5B;AAAA,WAApB;AACA,eAAKikC,WAAL,GAAmBhhD,GAAnB;AACH;;;6CAE2B;AAAA;;AACxB,cAAMgiD,UAAU,GAAG,KAAKjlC,OAAL,CAAa1f,KAAb,CAAmB0D,MAAnB,CAA0B,UAAAkhD,GAAG;AAAA,mBAAIA,GAAG,CAAC5kD,KAAJ,KAAc,QAAI,CAAC6rB,IAAL,CAAU1L,QAAV,CAAmBpR,EAArC;AAAA,WAA7B,CAAnB;AACA,eAAKqY,eAAL,CAAqBnc,IAArB,CAA0B05C,UAA1B;AACH;AAED;;;;;;;;6BAKYE,O,EAAgBC,O,EAAgB;AACxC,cAAM5hB,GAAG,GAAG,KAAKrX,IAAL,CAAUja,SAAV,CAAoBtR,IAApB,CAAyB,UAAC4iC,GAAD;AAAA,mBAAS2hB,OAAO,CAACzkC,KAAR,CAAcxJ,QAAd,CAAuBssB,GAAG,CAACn0B,EAA3B,CAAT;AAAA,WAAzB,KAAqE;AAAElW,gBAAI,EAAE,EAAR;AAAYwsC,sBAAU,EAAE;AAAxB,WAAjF;;AACA,cAAMqI,KAAK,GAAG,KAAK7hB,IAAL,CAAUja,SAAV,CAAoBtR,IAApB,CAAyB,UAAC4iC,GAAD;AAAA,mBAAS4hB,OAAO,CAAC1kC,KAAR,CAAcxJ,QAAd,CAAuBssB,GAAG,CAACn0B,EAA3B,CAAT;AAAA,WAAzB,CAAd;;AACA,cAAIm0B,GAAG,IAAIA,GAAG,KAAKwK,KAAnB,EAA0B;AACtB,mBAAOxK,GAAG,CAACrqC,IAAJ,CAASsM,aAAT,CAAuBuoC,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAE70C,IAA9B,CAAP;AACH;;AACD,cAAMwsC,UAAU,GAAG,mBAAInC,GAAG,CAACmC,UAAR,EAAoBj6B,OAApB,EAAnB;;AANwC,uDAOlBi6B,UAPkB;AAAA;;AAAA;AAOxC,sEAAkC;AAAA,kBAAvBtsB,OAAuB;;AAC9B,kBAAIA,OAAO,KAAK,GAAhB,EAAqB;AACjB;AACH;;AACD,kBAAM40B,UAAU,GAAGkX,OAAO,CAACzkC,KAAR,CAAclgB,OAAd,CAAsB6Y,OAAtB,KAAkC,CAArD;AACA,kBAAM60B,UAAU,GAAGkX,OAAO,CAAC1kC,KAAR,CAAclgB,OAAd,CAAsB6Y,OAAtB,KAAkC,CAArD;;AACA,kBAAI40B,UAAU,IAAI,CAACC,UAAnB,EAA+B;AAC3B,uBAAO,CAAP;AACH,eAFD,MAEO,IAAIA,UAAU,IAAI,CAACD,UAAnB,EAA+B;AAClC,uBAAO,CAAC,CAAR;AACH;AACJ;AAlBuC;AAAA;AAAA;AAAA;AAAA;;AAmBxC,iBAAOkX,OAAO,CAAChsD,IAAR,CAAasM,aAAb,CAA2B2/C,OAAO,CAACjsD,IAAnC,CAAP;AACH;;;+BAEawuB,M,EAA2B;AAAA;;AACrC;AACA,eAAKD,eAAL,CAAqBxZ,IAArB,CACI,YAAA+H,IAAA,CAAK,CAAL,CADJ,EAEI,YAAAovC,cAAA,CAAe,KAAKrlC,OAApB,CAFJ,EAGI,YAAA/c,GAAA,CAAI,iBAAgC;AAAA;AAAA,gBAA9BykB,eAA8B;AAAA,gBAAb1H,OAAa;;AAChC,mBAAO,cAAAyH,qBAAA,CAAsBzH,OAAtB,EAA+B0H,eAA/B,EAAgDC,MAAhD,CAAP;AACH,WAFD,CAHJ,EAMEtsB,SANF,CAMY,UAAAkQ,IAAI,EAAI;AAChB,gBAAM+5C,QAAQ,GAAG,QAAI,CAACpB,SAAL,CAAe5jD,KAAhC;;AACA,oBAAI,CAAC4jD,SAAL,CAAelmD,QAAf,CAAwB;AACpByY,sBAAQ,EAAE6uC,QAAQ,CAAC7uC;AADC,aAAxB;;AAGA,oBAAI,CAACiR,eAAL,CAAqBnc,IAArB,CAA0BA,IAA1B;;AACA,oBAAI,CAAC64C,cAAL,GAAsB74C,IAAI,CAACtI,GAAL,CAAS,UAACugC,GAAD;AAAA,qBAASA,GAAG,CAACljC,KAAb;AAAA,aAAT,CAAtB;AAEH,WAdD;AAeH;AAED;;;;;;;oCAImBggB,K,EAAc;AAC7B,cAAMhlB,IAAI,GAAG,KAAKmkB,MAAlB;;AACA,cAAInkB,IAAI,CAACsF,IAAL,CAAU,UAACkF,IAAD;AAAA,mBAAUA,IAAI,CAACuJ,EAAL,KAAYiR,KAAK,CAACjR,EAA5B;AAAA,WAAV,CAAJ,EAA+C;AAC3C,iBAAKoQ,MAAL,GAAcnkB,IAAI,CAAC0I,MAAL,CAAY,UAAC8B,IAAD;AAAA,qBAAUA,IAAI,CAACuJ,EAAL,KAAYiR,KAAK,CAACjR,EAA5B;AAAA,aAAZ,CAAd;AACH,WAFD,MAEO;AACH,iBAAKoQ,MAAL,GAAc,CAACa,KAAD,CAAd;AACH;AACJ;;;oCAEkB;AACf,eAAKb,MAAL,GAAc,EAAd;AACA,eAAK2kC,cAAL,GAAsB,EAAtB;AACH;;;4BA9QmB;AAChB,iBAAO,KAAKj4B,IAAL,CAAUja,SAAjB;AACH;AAED;;;;4BACmB;AACf,iBAAO,KAAP;AACH;;;4BAEkB;AACf,iBAAO,CAAC,CAAC,KAAK0zB,KAAL,CAAW3X,QAApB;AACH;;;4BAiB4B;AACzB,iBAAO,KAAK9B,IAAL,CAAU1L,QAAV,GAAqB,CAAC,KAAK0L,IAAL,CAAU1L,QAAV,CAAmBpR,EAApB,CAArB,GAA+C,EAAtD;AACH;;;;MA9D0C,OAAAxV,a;;AAL/C;;;uBAKa0mD,yB,EAAyB,4C,EAAA,qC,EAAA,sC,EAAA,wC,EAAA,kC,EAAA,qBAwEtB,SAAAvB,eAxEsB,C;AAwEP,K;;;YAxElBuB,yB;AAAyB,2C;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,e;AAAA,c;AAAA,+yC;AAAA;AAAA;ACxEtC;AACI;AAAqB;AAA6C;AAClE;AACI;AACJ;AACJ;AACA;AACI;AACI;AACI;AA6BA;AACI;AAiCJ;AACJ;AACA;AAuDJ;AACJ;AACA;AAQA;AAQA;;;;;;AAlJyB;AAAA;AAEP;AAAA;AAKL;AAAA;AAAqC;AACxB;AAAA;AA8BI;AAAA,8CAAiC,UAAjC,EAAiC,GAAjC;AAmCmB;AAAA;;;;;;;;;2BDFpCA,yB,EAAyB;cALrC,OAAAtB,SAKqC;eAL3B;AACPjlD,kBAAQ,EAAE,sBADH;AAEPklD,qBAAW,EAAE,qCAFN;AAGPC,mBAAS,EAAE,CAAC,qCAAD;AAHJ,S;AAK2B,Q;;;;;;;;;;;;;;kBAwE7B,OAAAlT,M;mBAAO,SAAA+S,e;;;;;gBAtEX,OAAAI;;;;;;;;;;;;;;;;;;;;;;;;AE1EL;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACCQ;AACI;AAAA;AAOgB;AAEhB;AACI;AAAA;AAAA;AAQA;AAAA;AAEA;AACJ;AACJ;;;;;AApBQ;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqBR;AACI;AAAA;AAOe;AAEf;AACI;AAAA;AAAA;AAQA;AAAA;AAC0B;AAE9B;AACJ;;;;;AApBQ;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqBR;AACI;AAAA;AAMW;AAEX;AACI;AAAA;AAAA;AAOA;AAAA;AAC8B;AAElC;AACJ;;;;;AAlBQ;AAAA;;;;;;AArDhB;AACI;AACI;AAwBA;AAwBA;AAsBJ;AACJ;;;;;AAxEU;AAAA;AACiB;AAAA;AAwBA;AAAA;AAwBA;AAAA;;;;QD1Cd4D,iB;;;;AALb;;;uBAKaA,iB;AAAiB,K;;;YAAjBA,iB;AAAiB,gC;AAAA;AAAA;AAAA,O;AAAA,c;AAAA,a;AAAA,4gB;AAAA;AAAA;ACR9B;;;;AAAuB;;;;;;;;;2BDQVA,iB,EAAiB;cAL7B,OAAA/D,SAK6B;eALnB;AACTjlD,kBAAQ,EAAE,WADD;AAETklD,qBAAW,EAAE,4BAFJ;AAGTC,mBAAS,EAAE,CAAC,4BAAD;AAHF,S;AAKmB,Q;;gBAEzB,OAAAziD;;;;;;;;;;;;;;;;;;;;;;;;;;;;AEVL;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACNA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;ACEI;AACI;AACJ;;;;;AADc;AAAA;;;;;;AAEd;AACI;AACJ;;;;AADiB;AAAA;;;;QDER6oD,mB;AAQT,qCAAc;AAAA;;AAHd;AACgB,aAAAptD,KAAA,GAAkC,EAAlC;AAEA;;;;mCAER,CAAW;;;;;;AAfvB;;;uBAKaotD,mB;AAAmB,K;;;YAAnBA,mB;AAAmB,kC;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA,c;AAAA,a;AAAA,6N;AAAA;AAAA;ACRhC;AACI;AACA;AAGA;AAGJ;;;;AARyB;AACX;AAAA;AAC2B;AAAA;AAGV;AAAA;;;;;;;;;2BDGlBA,mB,EAAmB;cAL/B,OAAAtG,SAK+B;eALrB;AACPjlD,kBAAQ,EAAE,aADH;AAEPklD,qBAAW,EAAE,8BAFN;AAGPC,mBAAS,EAAE,CAAC,8BAAD;AAHJ,S;AAKqB,Q;;;;gBAE3B,OAAAziD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AEdL;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACVI;;AAIC;;;;;AADG;;;;;;AAMI;AACI;;AACJ;;;;;AADI;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEJ;AAAA;AAQA;;;;;AALI;AAKJ;AAAA,wDAAM,iCAAN;AAAA;;;;;;;;;;;;;;;;;;AACA;AAKI;AACA;AAAA;AAEA;AACJ;;;;;AANI;AAEA;AAAA;;;;;;;;;;;;;;;;;;;;AAKJ;AAGI;AAAA;AAAA;AAAA;AAAA;AAHJ;AAOA;;;;;;AAGR;AACI;;AACJ;;;;;AADI;AAAA;;;;;;;;AAEJ;AAKI;AAAA;AAAA;AAAA;AAAA;AACH;;;;;AAJG,4GAAuE,KAAvE,EAAuE,4BAAvE,EAAuE,SAAvE,EAAuE,kBAAvE;;;;;;;;;;;;;;;AAKJ;AAGI;AAAA;AAAA;AAAA;AAAA;AAEA;AAMJ;;;;;AALQ;AAAA;;;;;;AAhEZ;AAOI;AAKA;AACI;AAAkB;AAAe;AACjC;AAAyB;AAA4D;AACrF;AACI;AAGA;AASA;AAUA;AAQJ;AACJ;AACA;AAGA;AAOA;AAYJ;;;;;AAnEI,kDAAyB,SAAzB,EAAyB,cAAzB;AAEA;AAII;AAAA;AAIkB;AAAA;AACO;AAAA;AAEiB;AAAA;AAKlC;AAAA;AASA;AAAA;AAUA;AAAA;AAQyB;AAAA;AAIjC;AAAA;AAQA;AAAA;;;;;;AAYJ;;;;;;AAEI,iDAAmB,SAAnB,EAAmB,IAAnB,EAAmB,QAAnB,EAAmB,aAAnB,EAAmB,MAAnB,EAAmB,YAAnB,EAAmB,UAAnB,EAAmB,6CAAnB,EAAmB,OAAnB,EAAmB,YAAnB;;;;ADvDR,aAAS8oD,wBAAT,CAAkCnP,QAAlC,EAA8D;AAC1D,aACIA,QAAQ,CAAC7X,WAAT,GAAuB6X,QAAQ,CAACj7C,KAAT,CAAekE,MAAtC,IACC+2C,QAAQ,CAAC7X,WAAT,KAAyB6X,QAAQ,CAACj7C,KAAT,CAAekE,MAAxC,IACG+2C,QAAQ,CAACj7C,KAAT,CAAewF,IAAf,CAAoB,UAACkF,IAAD;AAAA,eAAeA,IAAI,CAAC1K,KAAL,IAAc0K,IAAI,CAAC04B,WAAL,GAAmB14B,IAAI,CAAC1K,KAAL,CAAWkE,MAA3D;AAAA,OAApB,CAHR;AAKH;;AAED,aAASmmD,aAAT,CAAuBpP,QAAvB,EAAmD;AAC/C,UAAMj7C,KAAK,GAAGi7C,QAAQ,CAACj7C,KAAT,IAAkB,EAAhC;AACA,UAAIE,IAAI,GAAGF,KAAK,CAAC4I,MAAN,CAAa,UAAC8B,IAAD;AAAA,eAAUA,IAAI,CAAC+5B,MAAL,GAAc,CAAxB;AAAA,OAAb,EAAwC58B,GAAxC,CAA4C,UAAC6C,IAAD;AAAA,eAAUA,IAAI,CAACuJ,EAAf;AAAA,OAA5C,CAAX;;AAF+C,mDAG5BjU,KAH4B;AAAA;;AAAA;AAG/C,kEAA0B;AAAA,cAAf0K,IAAe;;AACtB,cAAKA,IAAY,CAAC1K,KAAb,IAAuB0K,IAAY,CAAC1K,KAAb,CAAmBkE,MAA/C,EAAuD;AACnDhE,gBAAI,GAAGA,IAAI,CAAC4zB,MAAL,CAAYu2B,aAAa,CAAC3/C,IAAD,CAAzB,CAAP;AACH;AACJ;AAP8C;AAAA;AAAA;AAAA;AAAA;;AAQ/C,aAAOxK,IAAP;AACH;;QAQYoqD,yB;;;;;AAsCT,yCAAoBpsC,QAApB,EAA0DijC,OAA1D,EACmBhmC,QADnB,EAC8C;AAAA;;AAAA;;AAC1C;AAFgB,iBAAA+C,QAAA,GAAAA,QAAA;AAAsC,iBAAAijC,OAAA,GAAAA,OAAA;AACvC,iBAAAhmC,QAAA,GAAAA,QAAA;AAxBZ,iBAAAovC,aAAA,GAAgB,IAAhB,CAwBuC,CAE1C;;AACA,iBAAKA,aAAL,GAAqB,SAAK7/C,IAA1B;AAH0C;AAI7C;AA1BD;;;;;oCA4BmBhL,O,EAAsB;AAAA;;AACrC;AACA,cAAIA,OAAO,CAACqL,KAAR,IAAiB,KAAKA,KAA1B,EAAiC;AAC7B,gBAAM7K,IAAI,GAAG,KAAK6K,KAAL,CAAW7F,KAAxB,CAD6B,CAE7B;;AACA,gBAAIwF,IAAI,GAAGxK,IAAI,CAACsF,IAAL,CAAU,UAACglD,MAAD;AAAA,qBAAYA,MAAM,CAACv2C,EAAP,KAAc,QAAI,CAACvJ,IAAL,CAAUuJ,EAApC;AAAA,aAAV,CAAX;;AACA,gBAAIvJ,IAAJ,EAAU;AACN;AACA,mBAAKA,IAAL,CAAU+/C,SAAV,CAAoB//C,IAAI,GAAGA,IAAI,CAAC+5B,MAAR,GAAiB,CAAzC;AACH,aAHD,MAGO;AACH;AADG,2DAEavkC,IAFb;AAAA;;AAAA;AAEH,0EAAsB;AAAA,sBAAbwqD,GAAa;AAClBhgD,sBAAI,GAAGggD,GAAG,SAAH,IAAAA,GAAG,WAAH,GAAG,MAAH,GAAAA,GAAG,CAAE1qD,KAAL,CAAWwF,IAAX,CAAgB,UAACmlD,OAAD;AAAA,2BAAaA,OAAO,CAAC12C,EAAR,KAAe,QAAI,CAACvJ,IAAL,CAAUuJ,EAAtC;AAAA,mBAAhB,CAAP;;AACA,sBAAIvJ,IAAJ,EAAU;AACN,yBAAKA,IAAL,CAAU+/C,SAAV,CAAoB//C,IAAI,GAAGA,IAAI,CAAC+5B,MAAR,GAAiB,CAAzC;AACA;AACH;AACJ;AARE;AAAA;AAAA;AAAA;AAAA;;AAQF;AACJ,aAhB4B,CAkB7B;;;AACA,gBAAI,CAAC,KAAK8lB,aAAN,IAAuB,KAAK7/C,IAAL,CAAU+5B,MAArC,EAA6C;AACzC,mBAAK8lB,aAAL,GAAqB,KAAK7/C,IAA1B;AACH;;AAED,iBAAK3K,YAAL,CACI,cADJ,EAEI,KAAKgL,KAAL,CAAW6yB,YAAX,CAAwB39B,SAAxB,CAAkC,UAACC,IAAD,EAAU;AACxC,kBAAMwK,IAAI,GAAGxK,IAAI,CAACsF,IAAL,CAAU,UAACmlD,OAAD;AAAA,uBAAaA,OAAO,CAAC12C,EAAR,KAAe,QAAI,CAACvJ,IAAL,CAAUuJ,EAAtC;AAAA,eAAV,CAAb;;AACA,sBAAI,CAACvJ,IAAL,CAAU+/C,SAAV,CAAoB//C,IAAI,GAAGA,IAAI,CAAC+5B,MAAR,GAAiB,CAAzC;;AACA,sBAAI,CAACmmB,sBAAL;AACH,aAJD,CAFJ;AAQH;AACJ;AAED;;;;;;;qCAIoB1lD,K,EAAe;AAAA;;AAC/B;AACA,cAAI,KAAK6F,KAAT,EAAgB;AACZ,gBAAM7K,IAAI,GAAmB,KAAK6K,KAAL,CAAW7F,KAAxC;AACA,gBAAMwF,IAAI,GAAGxK,IAAI,CAACsF,IAAL,CAAU,UAACmlD,OAAD;AAAA,qBAAaA,OAAO,CAAC12C,EAAR,KAAe,QAAI,CAACvJ,IAAL,CAAUuJ,EAAtC;AAAA,aAAV,CAAb;;AACA,gBAAIvJ,IAAJ,EAAU;AACN,mBAAKA,IAAL,CAAU+/C,SAAV,CAAoBvlD,KAApB;AACAwF,kBAAI,CAAC+/C,SAAL,CAAevlD,KAAf,EAFM,CAGN;;AACA,kBAAM6+B,KAAK,GAAG,KAAKr5B,IAAL,CAAUq5B,KAAxB;AACAr5B,kBAAI,CAACmgD,QAAL,CAAc9mB,KAAd;AACH,aAND,MAMO;AACH,kBAAMU,MAAM,GAAG,KAAK/5B,IAAL,CAAU+5B,MAAzB;AACA,mBAAK/5B,IAAL,CAAU+/C,SAAV,CAAoBvlD,KAApB;;AACA,kBACI,KAAKwF,IAAL,eACA+5B,MAAM,GAAGv/B,KADT,IAEA,KAAKwF,IAAL,CAAU1K,KAFV,IAGA,KAAK0K,IAAL,CAAU1K,KAAV,CAAgBkE,MAHhB,IAIAkmD,wBAAwB,CAAC,KAAK1/C,IAAN,CAL5B,EAME;AACE,qBAAKogD,oBAAL,GAA4BpsC,IAA5B,CACI,UAACqsC,cAAD,EAAoB;AAChB7qD,sBAAI,CAAC2J,IAAL,CAAU,IAAI,cAAAq5B,gBAAJ,CAAqB6nB,cAArB,CAAV;;AACA,0BAAI,CAAChgD,KAAL,CAAWnI,QAAX,CAAoB1C,IAAI,CAAC0I,MAAL,CAAY,UAAC+hD,OAAD;AAAA,2BAAaA,OAAO,CAAClmB,MAArB;AAAA,mBAAZ,CAApB;AACH,iBAJL,EAKI,YAAM;AACF,0BAAI,CAAC/5B,IAAL,CAAU+/C,SAAV,CAAoB,GAApB;;AACA,0BAAI,CAAC9pD,OAAL,CAAa,QAAb,EAAuB;AAAA,2BAAM,QAAI,CAAC+J,IAAL,CAAU+/C,SAAV,CAAoB,CAApB,CAAN;AAAA,mBAAvB,EAAqD,CAArD;;AACA,0BAAI,CAACvsC,QAAL,CAAcy3B,UAAd,CACI,uDADJ;AAGH,iBAXL;AAaH,eApBD,MAoBO;AACHz1C,oBAAI,CAAC2J,IAAL,CAAU,IAAI,cAAAy5B,YAAJ,CAAiB,KAAK54B,IAAtB,CAAV;AACH;AACJ;;AACD,iBAAKK,KAAL,CAAWnI,QAAX,CAAoB1C,IAAI,CAAC0I,MAAL,CAAY,UAAC+hD,OAAD;AAAA,qBAAaA,OAAO,CAAClmB,MAArB;AAAA,aAAZ,CAApB;AACH;AACJ;;;iDAE+B;AAAA;;AAC5B,cAAMumB,SAAS,GAAG,KAAKjgD,KAAL,CAAW7F,KAAX,CAAiBM,IAAjB,CAAsB,UAACkF,IAAD;AAAA,mBAAUA,IAAI,CAACuJ,EAAL,KAAY,QAAI,CAACvJ,IAAL,CAAUuJ,EAAhC;AAAA,WAAtB,CAAlB;;AACA,cAAI+2C,SAAJ,EAAe;AACX,gBAAMC,YAAY,GAAGZ,aAAa,CAACW,SAAD,CAAlC;AACA,iBAAKrqD,OAAL,CACI,gBADJ,EAEI,YAAM;AACF,sBAAI,CAAC+J,IAAL,CAAU1K,KAAV,CAAgBI,OAAhB,CAAwB,UAACsK,IAAD,EAAU;AAC9BA,oBAAI,CAAC+/C,SAAL,CAAeQ,YAAY,CAACnvC,QAAb,CAAsBpR,IAAI,CAACuJ,EAA3B,IAAiC,CAAjC,GAAqC,CAApD;;AACA,oBAAKvJ,IAAY,CAAC1K,KAAlB,EAAyB;AACpB0K,sBAAY,CAAC1K,KAAb,CAAmBI,OAAnB,CAA2B,UAACsK,IAAD,EAAU;AAClCA,wBAAI,CAAC+/C,SAAL,CAAeQ,YAAY,CAACnvC,QAAb,CAAsBpR,IAAI,CAACuJ,EAA3B,IAAiC,CAAjC,GAAqC,CAApD;AACH,mBAFA;AAGJ;AACJ,eAPD;AAQH,aAXL,EAYI,CAZJ;AAcH;AACJ;AAED;;;;+CAC2B;AAAA;;AACvB,cAAIi3C,WAAW,GAAmB,EAAlC;AACA,eAAKJ,oBAAL,GAA4BpsC,IAA5B,CACI,UAACqsC,cAAD,EAAoB;AAChB;AACA,oBAAI,CAAChgD,KAAL,CAAW7F,KAAX,CAAiB9E,OAAjB,CAAyB,UAAC66C,QAAD,EAAgC;AACrD,kBAAIA,QAAQ,CAAChnC,EAAT,KAAgB82C,cAAc,CAAC92C,EAAnC,EAAuC;AACnCi3C,2BAAW,CAACrhD,IAAZ,CAAiB,IAAI,cAAAq5B,gBAAJ,CAAqB6nB,cAArB,CAAjB;AACH,eAFD,MAEO;AACHG,2BAAW,CAACrhD,IAAZ,CAAiBoxC,QAAjB;AACH;AACJ,aAND;;AAOA,oBAAI,CAAClwC,KAAL,CAAWnI,QAAX,CAAoBsoD,WAAW,CAACtiD,MAAZ,CAAmB,UAAC+hD,OAAD;AAAA,qBAAaA,OAAO,CAAClmB,MAArB;AAAA,aAAnB,CAApB;AACH,WAXL,EAYI,YAAM;AACF,oBAAI,CAAC/5B,IAAL,CAAU+/C,SAAV,CAAoB,GAApB;;AACA,oBAAI,CAAC9pD,OAAL,CAAa,QAAb,EAAuB;AAAA,qBAAM,QAAI,CAAC+J,IAAL,CAAU+/C,SAAV,CAAoB,CAApB,CAAN;AAAA,aAAvB,EAAqD,CAArD;;AACA,oBAAI,CAACvsC,QAAL,CAAcy3B,UAAd,CACI,uDADJ;AAGH,WAlBL;AAoBH;AAED;;;;;;+CAG4B;AAAA;;AACxB,iBAAO,IAAIt3B,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC,gBAAMskC,GAAG,GAAG,QAAI,CAAC1B,OAAL,CAAannC,IAAb,CAAkB,kCAAAmxC,4BAAlB,EAAgD;AACxDpI,sBAAQ,EAAE,MAD8C;AAExDxqC,kBAAI,EAAE;AACF7N,oBAAI,EAAE,IAAI,cAAAw4B,gBAAJ,CAAqB,QAAI,CAACx4B,IAA1B;AADJ,eAFkD;AAKxDi/C,uBAAS,EAAE,KAL6C;AAMxDC,2BAAa,EAAE;AANyC,aAAhD,CAAZ;;AAQA,gBAAIwB,IAAI,GAAG,KAAX;AACAvI,eAAG,CAACM,iBAAJ,CAAsBzzC,KAAtB,CAA4BzP,SAA5B,CAAsC,UAACyP,KAAD,EAAW;AAC7C;AACA,kBAAIA,KAAK,CAACgW,MAAN,KAAiB,MAArB,EAA6B;AACzB0lC,oBAAI,GAAG,IAAP;AACA9sC,uBAAO,CAACukC,GAAG,CAACM,iBAAJ,CAAsBz4C,IAAvB,CAAP;AACA,wBAAI,CAAC6/C,aAAL,GAAqB,QAAI,CAAC7/C,IAA1B;AACAm4C,mBAAG,CAACzc,KAAJ;AACH;AACJ,aARD;AASAyc,eAAG,CAACU,WAAJ,GAAkBtjD,SAAlB,CAA4B,YAAM;AAC9B;AACA,kBAAI,CAACmrD,IAAL,EAAW;AACP,oBAAI,QAAI,CAACb,aAAT,EAAwB;AACpBjsC,yBAAO,CAAC,QAAI,CAACisC,aAAN,CAAP;AACH,iBAFD,MAEO;AACHhsC,wBAAM;AACT;AACJ;AACJ,aATD;AAUH,WA7BM,CAAP;AA8BH;;;4BA7LkB;AACf,iBAAO,KAAK7T,IAAL,CAAU1K,KAAV,GACD,KAAK0K,IAAL,CAAU1K,KAAV,CAAgB2F,MAAhB,CAAuB,UAACzF,IAAD,EAAOwK,IAAP,EAAgB;AACrC;AACA,gBAAIxK,IAAJ,EAAU;AACNA,kBAAI,IAAI,MAAR;AACH;;AACD,mBAAQA,IAAI,cAAOwK,IAAI,CAAC3M,IAAZ,SACP2M,IAAY,CAAC1K,KAAb,GACM0K,IAAY,CAAC1K,KAAb,CAAmB2F,MAAnB,CACH,UAAC0lD,MAAD,EAASV,OAAT;AAAA,qBACKU,MAAM,iBAAUV,OAAO,CAAClmB,MAAR,GAAiB,GAAjB,GAAuB,GAAjC,cAAwCkmB,OAAO,CAAC5sD,IAAhD,MADX;AAAA,aADG,EAGH,EAHG,CADN,GAMK,EAPE,cAQR2M,IAAI,CAAC+5B,MAAL,GAAc,GAAd,GAAoB,EARZ,CAAZ;AASH,WAdC,EAcC,EAdD,CADC,GAgBD,EAhBN;AAiBH;;;;MApC0C,OAAAhmC,a;;AAN/C;;;uBAMa6rD,yB,EAAyB,2C,EAAA,kC,EAAA,wC;AAAA,K;;;YAAzBA,yB;AAAyB,2C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA,wE;AAAA,c;AAAA,a;AAAA,y8B;AAAA;AAAA;AC5CtC;AAuEA;AACI;AASJ;;;;AA/EI;AAqEkB;AAAA;AAEd;AAAA;;;4ID7BKA,yB;AAAyB,2C;AAAA,w9U;AAAA;AAAA,mBAFtB,CAAC,aAAAxtD,8BAAD;AAEsB;;;;;2BAAzBwtD,yB,EAAyB;cANrC,OAAAzG,SAMqC;eAN3B;AACPjlD,kBAAQ,EAAE,sBADH;AAEPklD,qBAAW,EAAE,uBAFN;AAGPC,mBAAS,EAAE,CAAC,uBAAD,CAHJ;AAIPuH,oBAAU,EAAE,CAAC,aAAAxuD,8BAAD;AAJL,S;AAM2B,Q;;;;;;;;;;gBAEjC,OAAAwE;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AExDL;AAAA;AAAA;;AAMA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACEQ;;;;;;;;AAqBQ;AAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACJ;;;;;AAJI;AAGA;AAAA;;;;;;;;AAEJ;AAGI;AAAA;AAAA;AAAA;AAAA;AAAA,6DAAwC,IAAxC;AAA4C,SAA5C;AAEA;AACJ;;;;;AAJI;AAGA;AAAA;;;;;;AAnBR;AAOI;AAOA;AAOJ;;;;;AAbQ;AAAA;AAOA;AAAA;;;;;;AAOR;AACI;AACJ;;;;;AADI;AAAA;;;;;;AAEJ;;;;;;;;;;;;AA1BA;AACA;AAsBA;AAGA;AAGJ;;;;;;;;;;AA7BoE;AAE5D;AAAA;AAqBU;AAAA;AAIV;AAAA,+CAA8D,yBAA9D,EAA8D,qCAA9D;;;;;;AA7BZ;AACI;AACI;AA8BR;AACA;;;;;;AAhCqB;AAAA;AACK;AAAA;;;;;;AAF1B;;;;;AAAc;;;;;;;;;;;ADElB,aAAgBiqD,qBAAhB,CAAsCtQ,QAAtC,EAAgE;AAC5D,UAAMj7C,KAAK,GAAGi7C,QAAQ,CAACj7C,KAAT,IAAkB,EAAhC;AACA,aAAOi7C,QAAQ,CAAC7X,WAAT,IAAwBpjC,KAAK,CAACkE,MAA9B,GACDlE,KAAK,CAAC2F,MAAN,CAAa,UAACggB,KAAD,EAAQjb,IAAR;AAAA,eAAiBib,KAAK,IAAI4lC,qBAAqB,CAAC7gD,IAAD,CAA/C;AAAA,OAAb,EAA2E,IAA3E,CADC,GAED1K,KAAK,CAAC2F,MAAN,CAAa,UAAC8+B,MAAD,EAAS/5B,IAAT;AAAA,eAAkB+5B,MAAM,IAAI/5B,IAAI,CAAC+5B,MAAL,GAAc,CAAd,GAAkB,CAAtB,CAAxB;AAAA,OAAb,EAA+D,CAA/D,MACFwW,QAAQ,CAAC7X,WAHb;AAIH;;AAND;;AAQA,aAAgBooB,cAAhB,CAA+BvQ,QAA/B,EAAyD;AACrD,UAAIpzC,GAAG,GAAG,EAAV;;AACA,UAAIozC,QAAQ,CAACj7C,KAAb,EAAoB;AAChB,YAAM0K,IAAI,GAAGuwC,QAAQ,CAACj7C,KAAT,CAAewF,IAAf,CAAoB,UAAAkF,IAAI;AAAA,iBAAIA,IAAI,CAAC+5B,MAAL,GAAc,CAAlB;AAAA,SAAxB,CAAb;;AACA,YAAI/5B,IAAJ,EAAU;AACN7C,aAAG,CAACozC,QAAQ,CAAChnC,EAAV,CAAH,GAAmBvJ,IAAI,CAACuJ,EAAxB;AACH;;AACDgnC,gBAAQ,CAACj7C,KAAT,CAAeI,OAAf,CAAuB,UAAAsK,IAAI;AAAA,iBAAI7C,GAAG,GAAG,MAAH,OAAG,CAAH,kBAAQA,GAAR,CAAG,EAAa2jD,cAAc,CAAC9gD,IAAD,CAA3B,CAAV;AAAA,SAA3B;AACH;;AACD,aAAO7C,GAAP;AACH;;AAVD;;QAiBasjD,4B;AAkBT,4CAA6C3gB,KAA7C,EAA6E;AAAA;;AAAhC,aAAAA,KAAA,GAAAA,KAAA;AAjB7C;;AACiB,aAAA96B,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AAiBhB;AAfD;;;;;;AAiBA;;;qCAGoBmK,S,EAA6Bl/B,M,EAAsBxvB,K,EAAgB;AACnF,cAAIA,KAAJ,EAAW;AACP,gBAAM2uD,MAAM,GAAGD,SAAS,CAACroB,WAAzB;AACA,gBAAMyJ,MAAM,GAAG4e,SAAS,CAACzrD,KAAV,CAAgB4I,MAAhB,CAAuB,UAAA+hD,OAAO;AAAA,qBAAIA,OAAO,CAAClmB,MAAR,GAAiB,CAArB;AAAA,aAA9B,EAAsDvgC,MAArE;;AACA,gBAAI2oC,MAAM,IAAI6e,MAAd,EAAsB;AAClB,kBAAMhhD,IAAI,GAAG+gD,SAAS,CAACzrD,KAAV,CAAgBwF,IAAhB,CAAqB,UAAAmlD,OAAO;AAAA,uBAAIA,OAAO,CAAClmB,MAAR,GAAiB,CAArB;AAAA,eAA5B,CAAb;AACA/5B,kBAAI,CAAC+/C,SAAL,CAAe,CAAf;AACH;;AACDl+B,kBAAM,CAACk+B,SAAP,CAAiB,CAAjB;AACH,WARD,MAQO;AACHl+B,kBAAM,CAACk+B,SAAP,CAAiB,CAAjB;AACH;AACJ;;;4BA/Bc;AACX,iBAAO,KAAKjgB,KAAL,CAAW9/B,IAAlB;AACH;AAED;;;;4BAC2B;AACvB,iBAAO6gD,qBAAqB,CAAC,KAAK7gD,IAAN,CAA5B;AACH;;;4BAEsB;AACnB,iBAAO8gD,cAAc,CAAC,KAAK9gD,IAAN,CAArB;AACH;;;;;;AArBL;;;uBAKaygD,4B,EAA4B,qBAkBjB,SAAAvH,eAlBiB,C;AAkBF,K;;;YAlB1BuH,4B;AAA4B,8C;AAAA;AAAA;AAAA,O;AAAA,e;AAAA,a;AAAA,wa;AAAA;AAAA;AC9CzC;AACI;AAAA;AAA0D;AAC1D;AACI;AACJ;AACJ;AACA;AACI;AACI;AACJ;AACJ;AACA;AACI;AACI;AAAkD;AAAA,mBAAS,IAAAz7C,KAAA;AAAA,sBAAqB;AAArB,cAAT;AAAuC,WAAvC;AAAlD;AAEA;AACJ;AACJ;AACA;;;;;;AAfkB;AAAA;AAKI;AAAA,iDAA4D,yBAA5D,EAA4D,oCAA5D;AAKK;AAAA;;;;;;;;;2BDiCdy7C,4B,EAA4B;cALxC,OAAAtH,SAKwC;eAL9B;AACPjlD,kBAAQ,EAAE,yBADH;AAEPklD,qBAAW,EAAE,wCAFN;AAGPC,mBAAS,EAAE,CAAC,wCAAD;AAHJ,S;AAK8B,Q;;;;kBAkBxB,OAAAlT,M;mBAAO,SAAA+S,e;;;;;gBAhBnB,OAAAI;;;;;;;;;;;;;;;;;;;;;;;;AEhDL;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;QAOa2H,oB;;;;;AALb;AAAA;;AAAA;;;AAYI;;AAC2B,iBAAA/xC,SAAA,GAAY,IAAI,OAAA0nC,YAAJ,EAAZ;AAC3B;;AACO,iBAAAsK,YAAA,GAAe,KAAf;AAfX;AAwBC;AAPG;;;;;;;wCAGuB;AACnB,eAAKA,YAAL,GAAoB,CAAC,KAAKA,YAA1B;AACA,eAAKhyC,SAAL,CAAe8oC,IAAf;AACH;;;;MAlBqC,OAAAjkD,a;;AAL1C;;;oDAKaktD,oB;AAAoB,K;;;YAApBA,oB;AAAoB,sC;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,+J;AAAA;AAAA;ACTjC;AAMI;AAAA,mBAAiB,IAAAE,aAAA,EAAjB;AAAgC,WAAhC,EAAiC,OAAjC,EAAiC;AAAA,mBACxB,IAAAA,aAAA,EADwB;AACT,WADxB;AAGA;AAAqB;AAAiB;AACtC;AACI;AAOJ;AACJ;;;;AAhBI;AAMqB;AAAA;AAGb;AAAA;;;;;;qEDHCF,oB;;;;2BAAAA,oB,EAAoB;cALhC,OAAA9H,SAKgC;eALtB;AACTjlD,kBAAQ,EAAE,iBADD;AAETklD,qBAAW,EAAE,+BAFJ;AAGTC,mBAAS,EAAE,CAAC,+BAAD;AAHF,S;AAKsB,Q;;gBAE5B,OAAAziD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD,M;iBAAO,U;;;;;;;;;;;;;;;;;;;;;;;;AEjBZ;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;ACWI;AAII;AAAA;;AAAA;;AAAA;AAAA;AAAA,WAA+C,MAA/C,EAA+C;AAAA;;AAAA;;AAAA;AAAA;AAAA,SAA/C,EAA+C,eAA/C,EAA+C;AAAA;AAAA;AAAA;AAAA,SAA/C,EAA+C,eAA/C,EAA+C;AAAA;AAAA;AAAA;AAAA,SAA/C;AAJJ;;;;;AAOI;;;;;;AAEJ;AACI;AACJ;;;;;AADI;AAAA;;;;;;;;;;;;;;;;;;QDNK8H,gB;AAbb;AAAA;;AAcI;AACgB,aAAArmD,GAAA,GAAc,EAAd;AAChB;;AACgB,aAAAk6B,GAAA,GAAc,CAAd;AAEA,aAAAosB,QAAA,GAAW,KAAX;AAIT,aAAAC,cAAA,GAAyB,CAAzB;AAuCA,aAAAC,aAAA,GAAgB,IAAhB;AA8DV;AA1FG;;;;;;;8BAGa;AACT,cAAI,CAAC,KAAK/mD,KAAV,EAAiB;AACb,iBAAKA,KAAL,GAAa,KAAKy6B,GAAL,IAAY,CAAzB;AACH;;AACD,cAAMn7B,IAAI,GAAG,KAAK0nD,QAAL,GAAgB,GAAhB,GAAsB,KAAKC,SAAL,GAAiB,EAAjB,GAAsB,CAAzD;AACA,eAAKjnD,KAAL,IAAcV,IAAd;;AACA,cAAI,KAAKU,KAAL,GAAa,KAAKO,GAAtB,EAA2B;AACvB,iBAAKP,KAAL,GAAa,KAAKO,GAAL,IAAY,EAAzB;AACH;;AACD,eAAK7C,QAAL,CAAc,KAAKsC,KAAnB;AACH;AAED;;;;iCACgB;AACZ,cAAI,CAAC,KAAKA,KAAV,EAAiB;AACb,iBAAKA,KAAL,GAAa,KAAKy6B,GAAL,IAAY,CAAzB;AACH;;AACD,cAAMn7B,IAAI,GAAG,KAAK0nD,QAAL,GAAgB,GAAhB,GAAsB,KAAKC,SAAL,GAAiB,EAAjB,GAAsB,CAAzD;AACA,eAAKjnD,KAAL,IAAcV,IAAd;;AACA,cAAI,KAAKU,KAAL,GAAa,KAAKy6B,GAAtB,EAA2B;AACvB,iBAAKz6B,KAAL,GAAa,KAAKy6B,GAAL,IAAY,CAAzB;AACH;;AACD,eAAK/8B,QAAL,CAAc,KAAKsC,KAAnB;AACH;;;sCAIoBknD,S,EAAmB;AAAA;;AACpC,cAAI,KAAKH,aAAT,EAAwB;AACpBruD,wBAAY,CAAC,KAAKquD,aAAN,CAAZ;AACA,iBAAKA,aAAL,GAAqB,IAArB;AACH;;AACD,eAAKA,aAAL,GAAqB9tD,UAAU,CAAC;AAAA,mBAAM,QAAI,CAACkuD,WAAL,CAAiBD,SAAjB,CAAN;AAAA,WAAD,EAAoC,GAApC,CAA/B;AACH;;;oCAEkBA,S,EAAmB;AAClC,cAAIlnD,KAAK,GAAGonD,MAAM,CAACF,SAAD,CAAlB;;AACA,cAAIG,KAAK,CAACrnD,KAAD,CAAT,EAAkB;AACdA,iBAAK,GAAG,KAAK8mD,cAAb;AACH;;AACD,cAAI9mD,KAAK,GAAG,KAAKy6B,GAAjB,EAAsB;AAClBz6B,iBAAK,GAAG,KAAKy6B,GAAL,IAAY,CAApB;AACH;;AACD,cAAIz6B,KAAK,GAAG,KAAKO,GAAjB,EAAsB;AAClBP,iBAAK,GAAG,KAAKO,GAAL,IAAY,EAApB;AACH;;AACD,eAAK7C,QAAL,CAAcsC,KAAd;AACH;AAED;;;;;;;iCAIgBknD,S,EAAiB;AAC7B,eAAKJ,cAAL,GAAsBI,SAAtB;AACA,eAAKlnD,KAAL,GAAaknD,SAAb;AACA;;AACA,cAAI,KAAKI,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAeJ,SAAf;AACH;AACJ;AAED;;;;;;;mCAIkBlnD,K,EAAe;AAC7B,eAAKA,KAAL,GAAaA,KAAb;AACH;AAED;;AACA;;;;;;;yCAIwBlH,E,EAAuB;AAC3C,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;AAED;;AACA;;;;;;;0CAIyBA,E,EAAuB;AAC5C,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;;;;;;AA3HL;;;uBAaa8tD,gB;AAAgB,K;;;YAAhBA,gB;AAAgB,gC;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA,uCATd,CACP;AACIvW,eAAO,EAAE,QAAAmX,iBADb;;AAEI;AACAC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAMd,gBAAN;AAAA,SAAX,CAHjB;AAIIe,aAAK,EAAE;AAJX,OADO,CASc,E;AAFxB,c;AAAA,a;AAAA,qlB;AAAA;AAAA;ACdL;AAEI;AAAA,mCAAoC,IAApC;AAAwC,WAAxC,EAAwC,KAAxC,EAAwC,kBAAxC,EAAyC,iBAAzC,EAAyC;AAAA,kCACJ,IADI;AACA,WADzC,EACyC,KADzC,EACyC,kBADzC,EAAyC,cAAzC,EAAyC;AAAA,kCAEP,IAFO;AAEH,WAFtC,EAEsC,KAFtC,EAEsC,kBAFtC,EAAyC,aAAzC,EAAyC;AAAA,mCAGP,KAHO;AAGF,WAHvC,EAGuC,KAHvC,EAGuC,kBAHvC,EAAyC,eAAzC,EAAyC;AAAA,kCAIN,KAJM;AAID,WAJxC,EAIwC,KAJxC,EAIwC,kBAJxC,EAAyC,YAAzC,EAAyC;AAAA,kCAKT,KALS;AAKJ,WALrC,EAKqC,KALrC,EAKqC,kBALrC;AAOA;AAA2E;AAAA,mBAAS,IAAAzY,MAAA,EAAT;AAAiB,WAAjB;AACvE;AACJ;AACA;AASA;AAGA;AAA8D;AAAA,mBAAS,IAAA/uC,GAAA,EAAT;AAAc,WAAd;AAC1D;AACJ;AACJ;;;;AAlB0C;AAAA;AACxB;AAAA;AAKV;AAAA;AAMe;AAAA;AAGgB;AAAA;AACrB;AAAA;;;;;;;;;2BDTLymD,gB,EAAgB;cAb5B,OAAAjI,SAa4B;eAblB;AACPjlD,kBAAQ,EAAE,WADH;AAEPklD,qBAAW,EAAE,0BAFN;AAGPC,mBAAS,EAAE,CAAC,0BAAD,CAHJ;AAIPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;;AAEI;AACAC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAMd,gBAAN;AAAA,aAAX,CAHjB;AAIIe,iBAAK,EAAE;AAJX,WADO;AAJJ,S;AAakB,Q;;gBAExB,OAAAvrD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AEtBL;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAcawrD,kB;;;;;AAZb;AAAA;;AAAA;;;AAaI;;AACsB,iBAAAC,KAAA,GAAgB,UAAAthD,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAApC;AAGtB;;AACgB,iBAAAqhD,QAAA,GAA6B,OAA7B;AAChB;;AACgB,iBAAAtnD,MAAA,GAA2B,QAA3B;AAKhB;;AACiB,iBAAAunD,QAAA,GAAW,IAAI,OAAA3L,YAAJ,EAAX;AA1BrB;AA+HC;AAxFG;;;;;mCAoBkB;AACd,eAAKt/C,IAAL,GAAY,UAAAyJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAAhC;AACH;AAED;;;;;;;iCAIgBygD,S,EAAmB;AAC/B;AACA,cAAMc,QAAQ,GAAG,IAAI,UAAAh6C,MAAJ,CAAW;AAAClR,gBAAI,EAAE,KAAKA;AAAZ,WAAX,CAAjB;AACA,cAAMmrD,KAAK,GAAG,IAAI,UAAAj6C,MAAJ,CAAW;AAAClR,gBAAI,EAAEoqD;AAAP,WAAX,CAAd;AACA,cAAIgB,QAAQ,GAAGD,KAAK,CACfvqD,QADU,CACD;AAAE0B,gBAAI,EAAE4oD,QAAQ,CAACrf,QAAjB;AAA2BxrC,kBAAM,EAAE6qD,QAAQ,CAACzqD;AAA5C,WADC,EAEVkJ,EAFL,CAJ+B,CAO/B;;AACA,cAAIyhD,QAAQ,GAAG,KAAKz7C,IAApB,EAA0B;AACtBy7C,oBAAQ,GAAG,KAAKz7C,IAAhB;AACH;;AACD,eAAK3P,IAAL,GAAYorD,QAAZ;;AACA,cAAI,KAAKZ,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAeY,QAAf;;AACA,iBAAKH,QAAL,CAAcvK,IAAd,CAAmB0K,QAAnB;AACH;;AACD,eAAKxB,YAAL,GAAoB,KAApB;AACH;AAED;;AACA;;;;;;;mCAIkB1mD,K,EAAe;AAC7B,eAAKlD,IAAL,GAAYkD,KAAZ;AACA,eAAK0mD,YAAL,GAAoB,KAApB;AACH;AAED;;AACA;;;;;;;yCAIwB5tD,E,EAAuB;AAC3C,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;AAED;;AACA;;;;;;;0CAIyBA,E,EAAuB;AAC5C,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;;;yCAEuB4+B,Q,EAAmB;AACvC,eAAKA,QAAL,GAAgBA,QAAhB;AACH;AAED;;;;0CACyB;AACrB,eAAKywB,QAAL,CAAcC,SAAd;AACH;AAED;;;;yCACwB;AACpB,eAAKD,QAAL,CAAcE,QAAd;AACH;;;4BAtFc;AACX,iBAAO,KAAKR,KAAL,IAAc,UAAAthD,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB8J,YAApB,CAAiC,KAAjC,EAAwCC,EAA7D;AACH;AACD;;;;4BACgB;AACZ,iBAAO,KAAK6hD,GAAL,IAAY,UAAA/hD,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoBqwB,UAApB,CAA+B,KAA/B,EAAsCpvB,QAAtC,CAA+C;AAAE4qD,iBAAK,EAAE;AAAT,WAA/C,EAA6D9hD,EAAhF;AACH;AACD;;;;4BACsB;AAClB;AACA,cAAM3J,IAAI,GAAG,IAAI,UAAAkR,MAAJ,CAAW;AAAClR,gBAAI,EAAE,KAAKA;AAAZ,WAAX,CAAb;AACA,iBAAOA,IAAI,CAACsB,UAAL,CAAgB,aAAhB,CAAP;AACH;AAED;;;;4BACkB;AACd,iBAAO,KAAK+pD,QAAL,CAAcK,QAArB;AACH;;;;MA7CmC,OAAAjvD,a;;AAZxC;;;kDAYaquD,kB;AAAkB,K;;;YAAlBA,kB;AAAkB,mC;AAAA;AAAA;+BAyBhB,OAAAa,c,EAAgB,I;;;;;;;;;;;;;;;;;;;;uCAjChB,CACP;AACIpY,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAME,kBAAN;AAAA,SAAX,CAFjB;AAGID,aAAK,EAAE;AAHX,OADO,C,GAMV,6B;AAAA,c;AAAA,c;AAAA,kS;AAAA;AAAA;ACjBL;AAQI;AAAA,mBAAiB,IAAAe,cAAA,EAAjB;AAAiC,WAAjC;AAGA;AAAqB;AAAiB;AACtC;AACI;AAOJ;AACJ;AACA;AACI;AAAuC;AAAA,mBAASC,MAAM,CAACr8C,eAAP,EAAT;AAAiC,WAAjC;AACnC;AAGI;AAAiB,gBAAA5O,QAAA;AAAkB,uBAAAkrD,eAAA;AAAiB,WAApD;AACH;AACL;AACJ;;;;;;AAzBI,gDAAwB,OAAxB,EAAwB,SAAxB;AAIA;AAFA;AAIqB;AAAA;AAGb;AAAA;AAWA;AAAA,6CAAgB,SAAhB,EAAgB,gDAAhB;;;;;;mEDNChB,kB;;;;2BAAAA,kB,EAAkB;cAZ9B,OAAAjJ,SAY8B;eAZpB;AACPjlD,kBAAQ,EAAE,cADH;AAEPklD,qBAAW,EAAE,6BAFN;AAGPC,mBAAS,EAAE,CAAC,6BAAD,CAHJ;AAIPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAME,kBAAN;AAAA,aAAX,CAFjB;AAGID,iBAAK,EAAE;AAHX,WADO;AAJJ,S;AAYoB,Q;;gBAE1B,OAAAvrD,K;iBAAM,M;;;gBAEN,OAAAA,K;iBAAM,I;;;gBAEN,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;gBAWA,OAAAqD,S;iBAAU,OAAAsG,c,EAAgB;AAAE,sBAAQ;AAAV,W;;;;;;;;;;;;;;;;;;;;;;;;AE5C/B;AAAA;AAAA;;AAQA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;AChBY;AACI;AACJ;;;;;AAFoD;AAChD;AAAA;;;;QD6BHI,sB;;;;;AAZb;AAAA;;AAAA;;;AAcI;;AACgB,iBAAAtoD,GAAA,GAAc,GAAd;AAChB;;AACgB,iBAAAk6B,GAAA,GAAc,EAAd;AAChB;;AACgB,iBAAAn7B,IAAA,GAAe,EAAf;AAKhB;;AACgB,iBAAAwpD,eAAA,GAAiC,EAAjC;AAChB;;AACgB,iBAAAt2B,OAAA,GAAmB,KAAnB;AAET,iBAAA30B,QAAA,GAAmB,EAAnB;AA7BX;AA4HC;;;;mCAtFkB;AACX,eAAKkrD,gBAAL,GAAwB,KAAKC,uBAAL,CAA6B,KAAKzoD,GAAlC,EAAuC,KAAKk6B,GAA5C,EAAiD,KAAKn7B,IAAtD,EAA4D,KAAKkzB,OAAjE,CAAxB;AACH;;;oCAEkBh4B,O,EAAsB;AACrC;AACA,cAAIA,OAAO,CAAC+F,GAAR,IAAe/F,OAAO,CAACigC,GAAvB,IAA8BjgC,OAAO,CAAC8E,IAAtC,IAA8C9E,OAAO,CAAC8L,IAAtD,IAA8D9L,OAAO,CAACg4B,OAA1E,EAAmF;AAC/E,iBAAKu2B,gBAAL,GAAwB,KAAKC,uBAAL,CAA6B,KAAKzoD,GAAlC,EAAuC,KAAKk6B,GAA5C,EAAiD,KAAKn7B,IAAtD,EAA4D,KAAKkzB,OAAjE,CAAxB;AACH;AACJ;AAED;;;;;;;iCAIgB00B,S,EAAiB;AAC7B,eAAKrpD,QAAL,GAAgBqpD,SAAhB;AACA;;AACA,cAAI,KAAKI,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAe,CAACJ,SAAhB;AACH;AACJ;AAED;;AACA;;;;;;;mCAIkBlnD,K,EAAe;AAC7B,eAAKnC,QAAL,GAAgBmC,KAAhB;AACH;;;yCAEuB03B,Q,EAAmB;AACvC,eAAKA,QAAL,GAAgBA,QAAhB;AACH;AAED;;AACA;;;;;;;yCAIwB5+B,E,EAAuB;AAC3C,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;AAED;;AACA;;;;;;;0CAIyBA,E,EAAuB;AAC5C,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;;;gDAE+ByH,G,EAAak6B,G,EAAan7B,I,EAAsC;AAAA,cAAxBkzB,OAAwB,uEAAL,KAAK;AAC5F,cAAMy2B,MAAM,GAAe,EAA3B;AACA,cAAI3iD,IAAI,GAAGm0B,GAAX,CAF4F,CAG5F;;AACA,cAAI39B,IAAI,GAAG,KAAKwJ,IAAL,GAAY,IAAI,UAAA0H,MAAJ,CAAW;AAAClR,gBAAI,EAAE,KAAKwJ;AAAZ,WAAX,CAAZ,GAA4C,IAAvD,CAJ4F,CAM5F;;AAN4F,uDAOvE,KAAKwiD,eAPkE;AAAA;;AAAA;AAO5F,sEAA2C;AAAA,kBAAhCzhC,MAAgC;AACvC4hC,oBAAM,CAACtkD,IAAP,CAAY;AACRoK,kBAAE,EAAEsY,MADI;AAERxuB,oBAAI,EAAEiE,IAAI,aACDA,IAAI,CAACa,QAAL,CAAc;AAAEJ,yBAAO,EAAE8pB;AAAX,iBAAd,EAAmCjpB,UAAnC,CAA8C,OAAAwI,gBAAA,EAA9C,EAAkEW,iBAAlE,EADC,eACyF,OAAAzD,gBAAA,CAAiBujB,MAAjB,CADzF,mBAED,OAAAvjB,gBAAA,CAAiBujB,MAAjB,CAFC;AAFF,eAAZ;AAMH;AAd2F;AAAA;AAAA;AAAA;AAAA;;AAiB5F,iBAAO/gB,IAAI,IAAI/F,GAAf,EAAoB;AAChB0oD,kBAAM,CAACtkD,IAAP,CAAY;AACRoK,gBAAE,EAAEzI,IADI;AAERzN,kBAAI,EAAEiE,IAAI,aACDA,IAAI,CAACa,QAAL,CAAc;AAAEJ,uBAAO,EAAE+I;AAAX,eAAd,EAAiClI,UAAjC,CAA4C,OAAAwI,gBAAA,EAA5C,EAAgEW,iBAAhE,EADC,eACuF,OAAAzD,gBAAA,CAAiBwC,IAAjB,CADvF,mBAED,OAAAxC,gBAAA,CAAiBwC,IAAjB,CAFC;AAFF,aAAZ;AAMAA,gBAAI,IAAIhH,IAAR;AACH;;AACD,cAAIkzB,OAAJ,EAAa;AACVy2B,kBAAM,CAACtkD,IAAP,CAAY;AAAEoK,gBAAE,EAAE,KAAK,EAAX;AAAelW,kBAAI,EAAE;AAArB,aAAZ;AACF;;AACDowD,gBAAM,CAACtkD,IAAP,CAAY;AAAEoK,cAAE,EAAE,IAAI,EAAJ,GAAS,EAAf;AAAmBlW,gBAAI,EAAE;AAAzB,WAAZ;AACA,iBAAOowD,MAAP;AACH;;;;MA/GuC,OAAA1vD,a;;AAZ5C;;;sDAYasvD,sB;AAAsB,K;;;YAAtBA,sB;AAAsB,uC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA,uCARpB,CACP;AACIxY,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAMmB,sBAAN;AAAA,SAAX,CAFjB;AAGIlB,aAAK,EAAE;AAHX,OADO,CAQoB,GAF9B,6BAE8B,EAF9B,uBAE8B,C;AAF9B,c;AAAA,a;AAAA,4K;AAAA;AAAA;AC/BL;AACI;AACI;AAA6D;AAAA,mBAAe,IAAAjqD,QAAA,QAAf;AAA+B,WAA/B;AACzD;AAGJ;AACJ;AACJ;;;;AAR4B;AAEA;AAAA,+CAAkB,UAAlB,EAAkB,YAAlB;AACJ;AAAA;;;;;;uED8BXmrD,sB;;;;2BAAAA,sB,EAAsB;cAZlC,OAAAlK,SAYkC;eAZxB;AACPjlD,kBAAQ,EAAE,kBADH;AAEPklD,qBAAW,EAAE,iCAFN;AAGPC,mBAAS,EAAE,CAAC,iCAAD,CAHJ;AAIPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAMmB,sBAAN;AAAA,aAAX,CAFjB;AAGIlB,iBAAK,EAAE;AAHX,WADO;AAJJ,S;AAYwB,Q;;gBAG9B,OAAAvrD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AEhDL;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACNA;AAAA;AAAA;;AASA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACUQ;AACI;AACJ;;;;;AAFgD;AAC5C;AAAA;;;;;;;;AAHZ;AACI;AAAyD;AAAA;AAAA;AAAA;AAAA;AACrD;AAGJ;AACJ;;;;;AALwB;AAAA,4CAAc,UAAd,EAAc,eAAd;AACJ;AAAA;;;;;;;;;;;;QDIP8sD,kB;;;;;AAZb;AAAA;;AAAA;;;AAaI;;AACgB,iBAAA5pD,IAAA,GAAe,EAAf;AAGhB;;AACgB,iBAAA6pD,aAAA,GAAyB,IAAzB;AAChB;;AACO,iBAAArsD,IAAA,GAAe,UAAAyJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAAnC;AACP;;AACO,iBAAAH,IAAA,GAAe,UAAAC,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB0B,UAApB,CAA+B,OAA/B,CAAf;AAtBX;AA8JC,O,CA3HG;;;;;mCACe;AAAA;;AACX,eAAKgrD,WAAL,GAAmB,IAAnB;AACA,eAAKC,aAAL,GAAqB,KAAKC,sBAAL,CAA4B,KAAKxsD,IAAjC,EAAuC,CAAC,KAAKqsD,aAA7C,EAA4D,KAAK7pD,IAAjE,CAArB;AACA,eAAK7D,OAAL,CAAa,MAAb,EAAqB;AAAA,mBAAM,QAAI,CAAC2tD,WAAL,GAAmB,KAAzB;AAAA,WAArB;AACH;;;oCAEkB5uD,O,EAAsB;AACrC,cAAIA,OAAO,CAAC2uD,aAAR,IAAyB3uD,OAAO,CAAC8E,IAArC,EAA2C;AACvC,iBAAK+pD,aAAL,GAAqB,KAAKC,sBAAL,CAA4B,KAAKxsD,IAAjC,EAAuC,CAAC,KAAKqsD,aAA7C,EAA4D,KAAK7pD,IAAjE,CAArB;AACH;AACJ;;;;AAqBD;;;;iCAIgB4nD,S,EAAiB;AAC7B,eAAK5gD,IAAL,GAAY4gD,SAAZ;;AACA,cAAI,KAAKI,SAAT,EAAoB;AAChB,gBAAMhhD,IAAI,GAAG,CAAC,KAAKA,IAAL,IAAa,OAAd,EAAuBxH,KAAvB,CAA6B,GAA7B,CAAb;AACA,gBAAMhC,IAAI,GAAG,KAAKk6B,KAAL,CAAWt5B,QAAX,CAAoB;AAAE0B,kBAAI,EAAE,CAACkH,IAAI,CAAC,CAAD,CAAb;AAAkBnJ,oBAAM,EAAE,CAACmJ,IAAI,CAAC,CAAD;AAA/B,aAApB,EAA0DE,YAA1D,CAAuE,QAAvE,CAAb;;AACA,iBAAK8gD,SAAL,CAAexqD,IAAI,CAAC2J,EAApB;AACH;AACJ;AAED;;;;;;;mCAIkBzG,K,EAAe;AAC7B,cAAI,CAACA,KAAL,EAAY;AACR;AACH;;AACD,eAAKlD,IAAL,GAAYkD,KAAZ;AACA,cAAIlD,IAAI,GAAG,KAAKk6B,KAAL,CAAWxwB,YAAX,CAAwB,QAAxB,CAAX;AACA1J,cAAI,GAAGA,IAAI,CAACY,QAAL,CAAc;AAAEP,kBAAM,EAAEC,IAAI,CAACC,IAAL,CAAUP,IAAI,CAACS,OAAL,GAAe,CAAzB,IAA8B;AAAxC,WAAd,CAAP;AACA,eAAK+I,IAAL,GAAYxJ,IAAI,CAACsB,UAAL,CAAgB,OAAhB,CAAZ;AACA,eAAKirD,aAAL,GAAqB,KAAKC,sBAAL,CAA4B,KAAKxsD,IAAjC,EAAuC,CAAC,KAAKqsD,aAA7C,EAA4D,KAAK7pD,IAAjE,CAArB;AACH;;;yCAEuBo4B,Q,EAAmB;AACvC,eAAKA,QAAL,GAAgBA,QAAhB;AACH;AAED;;;;;;;yCAIwB5+B,E,EAAuB;AAC3C,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;AAED;;;;;;;0CAIyBA,E,EAAuB;AAC5C,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;AAED;;;;;;qCAGoB;AAAA;;AAChB,eAAKswD,WAAL,GAAmB,IAAnB;AACA,eAAK3tD,OAAL,CAAa,UAAb,EAAyB,YAAM;AAC3B,gBAAI,QAAI,CAAC8tD,YAAT,EAAuB;AACnB,sBAAI,CAACA,YAAL,CAAkBC,KAAlB;;AACA,sBAAI,CAACD,YAAL,CAAkBz0C,IAAlB;;AACA,sBAAI,CAACja,YAAL,CAAkB,cAAlB,EAAkC,QAAI,CAAC0uD,YAAL,CAAkBE,YAAlB,CAA+B1uD,SAA/B,CAAyC,UAAClD,KAAD,EAAW;AAClF,oBAAI,CAACA,KAAL,EAAY;AACR,0BAAI,CAACuxD,WAAL,GAAmB,KAAnB;AACH;AACJ,eAJiC,CAAlC;AAKH;AACJ,WAVD;AAWH;AAED;;;;;;;;+CAK+BM,S,EAAmBC,S,EAAqC;AAAA,cAAjBrqD,IAAiB,uEAAF,EAAE;AACnF,cAAIxC,IAAI,GAAG,IAAI,UAAAkR,MAAJ,CAAW;AAAClR,gBAAI,EAAE4sD;AAAP,WAAX,CAAX;AACA,cAAMT,MAAM,GAAG,EAAf;;AACA,cAAIU,SAAS,IAAI7sD,IAAI,CAACu4B,WAAL,CAAiB,UAAA9uB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAjB,CAAjB,EAAwD;AACpDI,gBAAI,GAAGA,IAAI,CAAC0J,YAAL,CAAkB,KAAlB,CAAP;AACH,WAFD,MAEO,IAAI1J,IAAI,CAACu4B,WAAL,CAAiB,UAAA9uB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAjB,CAAJ,EAA2C;AAC9CI,gBAAI,GAAG,UAAAyJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAP;AACH;;AACDI,cAAI,GAAGA,IAAI,CAACY,QAAL,CAAc;AAAEP,kBAAM,EAAEC,IAAI,CAACC,IAAL,CAAUP,IAAI,CAACS,OAAL,GAAe+B,IAAzB,IAAiCA;AAA3C,WAAd,CAAP;AACA,cAAM0qB,GAAG,GAAGltB,IAAI,CAACiwB,UAAL,CAAgB,KAAhB,CAAZ,CATmF,CAUnF;;AACA,iBAAOjwB,IAAI,CAACs4B,YAAL,CAAkBpL,GAAlB,CAAP,EAA+B;AAC3Bi/B,kBAAM,CAACtkD,IAAP,CAAY;AACR9L,kBAAI,YAAKiE,IAAI,CAACsB,UAAL,CAAgB,OAAAwI,gBAAA,EAAhB,EAAoCW,iBAApC,EAAL,CADI;AAERwH,gBAAE,EAAEjS,IAAI,CAACsB,UAAL,CAAgB,OAAhB;AAFI,aAAZ;AAIAtB,gBAAI,GAAGA,IAAI,CAACa,QAAL,CAAc;AAAEJ,qBAAO,EAAE+B;AAAX,aAAd,CAAP;AACH;;AACD,iBAAO2pD,MAAP;AACH;;;4BA7Ge;AACZ,iBAAO,IAAI,UAAAj7C,MAAJ,CAAW;AAAClR,gBAAI,EAAE,KAAKA;AAAZ,WAAX,CAAP;AACH;AAED;;;;4BAC0B;AACtB,cAAMwJ,IAAI,GAAG,CAAC,KAAKA,IAAL,IAAa,OAAd,EAAuBxH,KAAvB,CAA6B,GAA7B,CAAb;AACA,cAAMhC,IAAI,GAAG,KAAKk6B,KAAL,CAAWt5B,QAAX,CAAoB;AAAE0B,gBAAI,EAAE,CAACkH,IAAI,CAAC,CAAD,CAAb;AAAkBnJ,kBAAM,EAAE,CAACmJ,IAAI,CAAC,CAAD;AAA/B,WAApB,CAAb;;AACA,cAAIxJ,IAAI,CAACS,OAAL,GAAe,EAAf,KAAsB,CAAtB,IAA2B,CAAC,KAAK8rD,aAAL,CAAmB/oD,IAAnB,CAAwB,UAAAgG,IAAI;AAAA,mBAAIA,IAAI,CAACyI,EAAL,KAAYjS,IAAI,CAACsB,UAAL,CAAgB,OAAhB,CAAhB;AAAA,WAA5B,CAAhC,EAAuG;AACnG,iBAAKirD,aAAL,CAAmB1kD,IAAnB,CAAwB;AACpB9L,kBAAI,YAAKiE,IAAI,CAACsB,UAAL,CAAgB,OAAAwI,gBAAA,EAAhB,CAAL,CADgB;AAEpBmI,gBAAE,EAAEjS,IAAI,CAACsB,UAAL,CAAgB,OAAhB;AAFgB,aAAxB;;AAIA,iBAAKirD,aAAL,CAAmBrkD,IAAnB,CAAwB,UAACC,CAAD,EAAIC,CAAJ;AAAA,qBAAU,UAAGD,CAAC,CAAC8J,EAAL,EAAU5J,aAAV,WAA2BD,CAAC,CAAC6J,EAA7B,EAAV;AAAA,aAAxB;AACH;;AACD,iBAAO,KAAKs6C,aAAZ;AACH;;;;MApDmC,OAAA9vD,a;;AAZxC;;;kDAYa2vD,kB;AAAkB,K;;;YAAlBA,kB;AAAkB,mC;AAAA;AAAA;;;;;;;;;;;;;;;uCARhB,CACP;AACI7Y,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAMwB,kBAAN;AAAA,SAAX,CAFjB;AAGIvB,aAAK,EAAE;AAHX,OADO,C,GAMV,6B,EAAA,uB;AAAA,c;AAAA,a;AAAA,0Z;AAAA;AAAA;AChCL;AAOI;AAAA,mBAAiB,IAAAiC,UAAA,EAAjB;AAA6B,WAA7B;AAEA;AACI;AAKI;AAAA,mBAAiB,IAAAlsD,QAAA,QAAjB;AAAiC,WAAjC;AALJ;AAOJ;AACA;AAAkB;AAAA,mBAAS,IAAAksD,UAAA,EAAT;AAAqB,WAArB;AACd;AAOJ;AACJ;AACA;;;;AAzBI;AACA;AASQ;AAAA,kDAAqB,SAArB,EAAqB,QAArB;AAOA;AAAA;AAQyB;AAAA;;;;;;mEDMxBV,kB;;;;2BAAAA,kB,EAAkB;cAZ9B,OAAAvK,SAY8B;eAZpB;AACPjlD,kBAAQ,EAAE,cADH;AAEPklD,qBAAW,EAAE,6BAFN;AAGPC,mBAAS,EAAE,CAAC,6BAAD,CAHJ;AAIPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAMwB,kBAAN;AAAA,aAAX,CAFjB;AAGIvB,iBAAK,EAAE;AAHX,WADO;AAJJ,S;AAYoB,Q;;gBAE1B,OAAAvrD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAeA,OAAA+lD,S;iBAAU,Q;;;;;;;;;;;;;;;;;;;;;;;;AEvDf;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAUA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAMA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvBQ;AACI;AACJ;;;;;;AAGA;AACI;AAAkB;AAAiB;AACnC;AAAmB;AAAkB;AACzC;;;;;AAH6C;AACvB;AAAA;AACC;AAAA;;;;;;;;;;;;;;;;AAoBnB;AAKI;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAIJ;;;;;AAVI,2CAAiB,OAAjB,EAAiB,uCAAjB,EAAiB,WAAjB,EAAiB,IAAjB;AAKA;AAAA;AAGI;AAAA;;;;;;AAdZ;AAII;AAaJ;;;;;AAZQ;AAAA;;;;;;;;;;;;;;;;;;AAgBZ;AAAA;AAA6C;;;;;;;;;;;;QDPpC0H,sB;;;;;AA4BT,sCAAoB7wC,QAApB,EAA0D8sB,MAA1D,EAAyFkZ,KAAzF,EAAmH;AAAA;;AAAA;;AAC/G;AADgB,iBAAAhmC,QAAA,GAAAA,QAAA;AAAsC,iBAAA8sB,MAAA,GAAAA,MAAA;AAA+B,iBAAAkZ,KAAA,GAAAA,KAAA;AAzBzF;;AACgB,iBAAA5wC,KAAA,GAAgB,CAAhB;AAChB;;AAC0B,iBAAA60C,QAAA,GAAW,IAAI,OAAA7G,YAAJ,EAAX;AAY1B;;AACO,iBAAA0N,OAAA,GAAU,IAAI,OAAAlxC,OAAJ,EAAV;AAS4G;AAElH;;;;mCAEU;AAAA;;AACP;AACA,eAAKorC,eAAL,GAAuB,KAAK8F,OAAL,CAAal8C,IAAb,CACnB,YAAA2f,YAAA,CAAa,GAAb,CADmB,EAEnB,YAAAkyB,oBAAA,EAFmB,EAGnB,YAAAjyB,SAAA,CAAU,UAACtd,KAAD,EAAW;AACjB,oBAAI,CAAC6F,OAAL,GAAe,IAAf;AACA,mBAAO7F,KAAK,CAAClR,MAAN,IAAgB,QAAI,CAACoP,KAArB,GACD,QAAI,CAAC03B,MAAL,CAAY51B,KAAZ,CAAkB;AAChByM,eAAC,EAAEzM,KAAK,CAACtN,KAAN,CAAY,CAAZ,EAAexF,IAAI,CAACmD,GAAL,CAAS,QAAI,CAAC6N,KAAd,EAAqB,CAArB,CAAf,CADa;AAEhB6M,mBAAK,EAAE,KAAK;AAFI,aAAlB,CADC,GAKD9B,OAAO,CAACC,OAAR,CAAgB,EAAhB,CALN;AAMH,WARD,CAHmB,EAYnB,YAAAkC,UAAA,CAAW,UAAChH,CAAD;AAAA,mBAAO,OAAAkH,EAAA,CAAG,EAAH,CAAP;AAAA,WAAX,CAZmB,EAanB,YAAA7Y,GAAA,CAAI,UAAC3H,IAAD,EAAkB;AAClB,oBAAI,CAAC+a,OAAL,GAAe,KAAf;AACA,mBAAO,OAAA3R,UAAA,CAAW,QAAI,CAAC2lD,UAAhB,EAA4B/uD,IAA5B,EAAkC,CAAC,MAAD,EAAS,OAAT,CAAlC,CAAP;AACH,WAHD,CAbmB,CAAvB,CAFO,CAoBP;;AACA,eAAKH,YAAL,CACI,gBADJ,EAEI,KAAKmpD,eAAL,CAAqBjpD,SAArB,CAA+B,UAACC,IAAD,EAAU;AACrC,oBAAI,CAACikD,SAAL,GAAiBjkD,IAAjB;;AACA,oBAAI,CAACikD,SAAL,CAAe/jD,OAAf,CAAuB,UAACC,CAAD,EAAY;AAC/BA,eAAC,CAAC6uD,UAAF,GAAe,OAAA5jD,gBAAA,CAAiBjL,CAAC,CAAC6uD,UAAnB,CAAf;AACA7uD,eAAC,CAAC8uD,WAAF,GAAgB,OAAA7jD,gBAAA,CAAiBjL,CAAC,CAAC8uD,WAAnB,CAAhB;AACA,qBAAO9uD,CAAP;AACH,aAJD;;AAKA,oBAAI,CAAC8jD,SAAL,CAAejgD,MAAf,GAAwB,QAAI,CAACkrD,iBAAL,CAAuBC,SAAvB,EAAxB,GAA6D,QAAI,CAACD,iBAAL,CAAuBE,UAAvB,EAA7D;AACH,WARD,CAFJ;AAYH;AAED;;;;;;;gCAIe10C,I,EAAY;AACvB;AACA,cAAI,CAAC,KAAK20C,WAAV,EAAuB;AACnB,iBAAKA,WAAL,GAAmB,EAAnB;AACH;;AACD,cAAMjvD,KAAK,GAAG,KAAKivD,WAAL,CAAiBzf,SAAjB,CAA2B,UAAC0f,MAAD;AAAA,mBAAYA,MAAM,CAACv7C,EAAP,KAAc2G,IAAI,CAAC3G,EAA/B;AAAA,WAA3B,CAAd;AACA;;AACA,cAAI3T,KAAK,GAAG,CAAZ,EAAe;AACX,iBAAKivD,WAAL,gCAAuB,KAAKA,WAA5B,IAAyC30C,IAAzC;AACH;;AACD,eAAKhY,QAAL,CAAc,KAAK2sD,WAAnB;AACA,eAAKN,UAAL,GAAkB,EAAlB;AACH;AAED;;;;;;;mCAIkBr0C,I,EAAY;AAC1B,eAAK20C,WAAL,GAAmB,KAAKA,WAAL,CAAiB3mD,MAAjB,CAAwB,UAAC4mD,MAAD;AAAA,mBAAYA,MAAM,CAACv7C,EAAP,KAAc2G,IAAI,CAAC3G,EAA/B;AAAA,WAAxB,CAAnB;AACA,eAAKrR,QAAL,CAAc,KAAK2sD,WAAnB;AACH;AAED;;;;;;;yCAIwB7/C,K,EAAO;AAAA;;AAC3B;AACA,cAAIA,KAAK,CAACyE,MAAV,EAAkB;AACd,gBAAMs7C,IAAI,GAAG//C,KAAK,CAACyE,MAAN,CAAau7C,KAAb,CAAmB,CAAnB,CAAb;AACA;;AACA,gBAAID,IAAJ,EAAU;AACN,kBAAME,MAAM,GAAG,IAAIC,UAAJ,EAAf;AACAD,oBAAM,CAACE,UAAP,CAAkBJ,IAAlB,EAAwB,OAAxB;AACAE,oBAAM,CAAC9oB,gBAAP,CAAwB,MAAxB,EAAgC,UAACipB,GAAD,EAAS;AACrC,wBAAI,CAACC,cAAL,CAAqBD,GAAG,CAACE,UAAJ,CAAuB5vC,MAA5C;;AACA1Q,qBAAK,CAACyE,MAAN,CAAajP,KAAb,GAAqB,EAArB;;AACA,wBAAI,CAACg/C,KAAL,CAAWqB,aAAX;AACH,eAJD;AAKAoK,oBAAM,CAAC9oB,gBAAP,CAAwB,OAAxB,EAAiC,UAACrtB,CAAD;AAAA,uBAC7B,QAAI,CAAC0E,QAAL,CAAc23B,WAAd,CAA0B,qBAA1B,CAD6B;AAAA,eAAjC;AAGH;AACJ;AACJ;AAED;;;;;;;uCAIuBt9B,I,EAAc;AAAA;;AACjC,cAAMrY,IAAI,GAAG,OAAAoO,SAAA,CAAUiK,IAAV,KAAmB,EAAhC;AACA,cAAMtE,EAAE,GAAG,KAAK+2B,MAAL,CAAYtO,OAAZ,CAAoBme,UAA/B;AACA36C,cAAI,CAACE,OAAL,CAAa,UAACyI,EAAD,EAAQ;AACjBA,cAAE,CAAC9K,IAAH,GAAU8K,EAAE,CAAC9K,IAAH,cAAc8K,EAAE,CAAC2xC,UAAjB,cAA+B3xC,EAAE,CAAC4xC,SAAlC,CAAV;AACA,gBAAMxsC,OAAO,GAAG,CAACpF,EAAE,CAAC9K,IAAH,cAAcuE,IAAI,CAACY,KAAL,CAAWZ,IAAI,CAACuJ,MAAL,KAAgB,QAA3B,CAAd,CAAD,EACX7H,KADW,CACL,GADK,EAEXqH,IAFW,CAEN,GAFM,EAGX3B,WAHW,EAAhB;AAIA;;AACA,gBAAI,CAACb,EAAE,CAACuK,KAAR,EAAe;AACXvK,gBAAE,CAACuK,KAAH,aAAcnF,OAAd,cAAyBgG,EAAzB;AACH;;AACDpL,cAAE,CAAC5B,IAAH,GAAU,UAAV;AACA4B,cAAE,CAACuxB,QAAH,GAAc,CAACvxB,EAAE,CAACuK,KAAH,CAAS68C,QAAT,CAAkB,eAAlB,CAAD,IAAuC,CAACpnD,EAAE,CAACuK,KAAH,CAAS68C,QAAT,CAAkB,wBAAlB,CAAtD;;AACA,oBAAI,CAACC,OAAL,CAAa,IAAI,cAAAl6B,IAAJ,CAASntB,EAAT,CAAb;AACH,WAbD;AAcH;AAED;;AACA;;;;8CAC6B;AACzB,cAAMsnD,QAAQ,+GAAd;AACA,iBAAAxiD,YAAA,CAAa,cAAb,EAA6BwiD,QAA7B;AACH;AAED;;;;;;;iCAIgB/D,S,EAAiB;AAC7B,eAAKmD,WAAL,GAAmBnD,SAAnB;;AACA,cAAI,KAAKI,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAeJ,SAAf;AACH;AACJ;AAED;;AACA;;;;;;;mCAIkBlnD,K,EAAe;AAC7B,eAAKqqD,WAAL,GAAmBrqD,KAAnB;AACH;;;yCAEuB03B,Q,EAAmB;AACvC,eAAKA,QAAL,GAAgBA,QAAhB;AACH;AAED;;AACA;;;;;;;yCAIwB5+B,E,EAAuB;AAC3C,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;AAED;;AACA;;;;;;;0CAIyBA,E,EAAuB;AAC5C,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;;;;MA5LuC,OAAAS,a;;AAZ5C;;;uBAYaswD,sB,EAAsB,2C,EAAA,qC,EAAA,0C;AAAA,K;;;YAAtBA,sB;AAAsB,wC;AAAA;AAAA;yBA0BpB,eAAAqB,sB,EAAwB,I,EAAO,eAAAA,sB;;;;;;;;;;;;;;;;uCAlC/B,CACP;AACI7a,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAMmC,sBAAN;AAAA,SAAX,CAFjB;AAGIlC,aAAK,EAAE;AAHX,OADO,C,GAMV,6B;AAAA,e;AAAA,c;AAAA,giC;AAAA;AAAA;ACtDL;AACI;AACI;AAAA;AAII;AAAA;AAAA,aAAwB,eAAxB,EAAwB;AAAA,mBACP,IAAAmC,OAAA,MAAanB,MAAM,CAACvP,IAAP,EAAb,CADO;AACoB,WAD5C;AAJJ;AAYA;AACI;AAGJ;AACA;AAGJ;AACA;AAA0C;AAAA,mBAAkB,IAAA4R,OAAA,qBAAlB;AAA8C,WAA9C;AACtC;AAIJ;AACA;AACI;AAAmD;AAAA,mBAAS,IAAA/H,QAAA,OAAT;AAAwB,WAAxB;AAAnD;AAEA;AACA;AAAA;AAEI;AAAmB;AAAA,mBAAU,IAAAkI,gBAAA,QAAV;AAAkC,WAAlC;AAAnB;AACJ;AAAA;AACA;AAAyD;AAAA,mBAAS,IAAAC,mBAAA,EAAT;AAA8B,WAA9B;AAAzD;AAEA;AACJ;AACA;AACI;AAkBJ;AACJ;AACA;;;;;;;;AA9DwC;AAM5B;AAAA,mDAAwB,UAAxB,EAAwB,YAAxB,EAAwB,iBAAxB,EAAwB,GAAxB;AAUI;AAAA;AAGsB;AAAA;AAKlB;AAAA;AAoBR;AAAA,2EAA2D,UAA3D,EAA2D,GAA3D;;;;;;;;;2BDYCvB,sB,EAAsB;cAZlC,OAAAlL,SAYkC;eAZxB;AACPjlD,kBAAQ,EAAE,mBADH;AAEPklD,qBAAW,EAAE,kCAFN;AAGPC,mBAAS,EAAE,CAAC,kCAAD,CAHJ;AAIPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAMmC,sBAAN;AAAA,aAAX,CAFjB;AAGIlC,iBAAK,EAAE;AAHX,WADO;AAJJ,S;AAYwB,Q;;;;;;;;;;gBAE9B,OAAAvrD;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD,M;iBAAO,S;;;gBAoBP,OAAAqD,S;iBAAU,eAAA+I,sB,EAAwB;AAACG,gBAAI,EAAE,eAAAH;AAAP,W;;;;;;;;;;;;;;;;;;;;;;;;AElFvC;AAAA;AAAA;;AAOA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAIA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChBQ;AACI;AACJ;;;;;;AAGA;AACI;AAAkB;AAAiB;AACnC;AAAmB;AAAkB;AACzC;;;;;AAH6C;AACvB;AAAA;AACC;AAAA;;;;;;;;;;;;QDuBlBI,wB;;;;;AAwBT,wCAAoBxlB,MAApB,EAA0C;AAAA;;AAAA;;AACtC;AADgB,iBAAAA,MAAA,GAAAA,MAAA;AATpB;;AACO,iBAAAgkB,OAAA,GAAU,IAAI,OAAAlxC,OAAJ,EAAV;AAQmC;AAEzC;;;;mCAEc;AAAA;;AAEX;AACA,eAAKorC,eAAL,GAAuB,KAAK8F,OAAL,CAAal8C,IAAb,CACnB,YAAA2f,YAAA,CAAa,GAAb,CADmB,EAEnB,YAAAkyB,oBAAA,EAFmB,EAGnB,YAAAjyB,SAAA,CAAU,UAAAtd,KAAK,EAAI;AACf,oBAAI,CAAC6F,OAAL,GAAe,IAAf;AACA,mBAAO,QAAI,CAAC2J,OAAL,IAAgB,QAAI,CAACA,OAAL,CAAa1gB,MAAb,GAAsB,CAAtC,GACDma,OAAO,CAACC,OAAR,CAAgB,QAAI,CAACsG,OAArB,CADC,GAEDxP,KAAK,CAAClR,MAAN,IAAgB,CAAhB,GACK,QAAI,CAAC8mC,MAAL,CAAY51B,KAAZ,CAAkB;AAAEyM,eAAC,EAAEzM,KAAL;AAAY+K,mBAAK,EAAE,KAAK;AAAxB,aAAlB,CADL,GAEI9B,OAAO,CAACC,OAAR,CAAgB,EAAhB,CAJV;AAKH,WAPD,CAHmB,EAWnB,YAAAkC,UAAA,CAAW,UAACV,GAAD;AAAA,mBAAS,OAAAY,EAAA,CAAG,EAAH,CAAT;AAAA,WAAX,CAXmB,EAYnB,YAAA7Y,GAAA,CAAI,UAAC3H,IAAD,EAAkB;AAClB,oBAAI,CAAC+a,OAAL,GAAe,KAAf;AACA,mBAAO,OAAA3R,UAAA,CAAW,QAAI,CAAC2lD,UAAhB,EAA4B/uD,IAA5B,EAAkC,CAAC,MAAD,EAAS,OAAT,CAAlC,CAAP;AACH,WAHD,CAZmB,CAAvB,CAHW,CAoBX;;AACA,eAAKH,YAAL,CAAkB,gBAAlB,EAAoC,KAAKmpD,eAAL,CAAqBjpD,SAArB,CAA+B,UAAAC,IAAI,EAAI;AACvE,oBAAI,CAACikD,SAAL,GAAiBjkD,IAAjB;;AACA,oBAAI,CAACikD,SAAL,CAAe/jD,OAAf,CAAuB,UAACC,CAAD,EAAY;AAC/BA,eAAC,CAAC6uD,UAAF,GAAe,OAAA5jD,gBAAA,CAAiBjL,CAAC,CAAC6uD,UAAnB,CAAf;AACA7uD,eAAC,CAAC8uD,WAAF,GAAgB,OAAA7jD,gBAAA,CAAiBjL,CAAC,CAAC8uD,WAAnB,CAAhB;AACA,qBAAO9uD,CAAP;AACH,aAJD;;AAKA,oBAAI,CAAC8jD,SAAL,CAAejgD,MAAf,GAAwB,QAAI,CAACkrD,iBAAL,CAAuBC,SAAvB,EAAxB,GAA6D,QAAI,CAACD,iBAAL,CAAuBE,UAAvB,EAA7D;AACH,WARmC,CAApC;AASH;AAED;;;;;;4CAG2B;AACvB,cAAI,KAAKr5B,WAAT,EAAsB;AAClB,iBAAKg5B,UAAL,GAAkB,KAAKh5B,WAAL,CAAiBl4B,IAAnC;AACH;AACJ;AAED;;;;;;;iCAIgBquD,S,EAAe;AAC3B,eAAKn2B,WAAL,GAAmBm2B,SAAnB;;AACA,cAAI,KAAKI,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAeJ,SAAf;AACH;;AACD,eAAKqE,iBAAL;AACH;AAED;;;;;;;mCAIkBvrD,K,EAAa;AAC3B,eAAK+wB,WAAL,GAAmB/wB,KAAnB;AACA,eAAKurD,iBAAL;AACH;;;yCAEuB7zB,Q,EAAmB;AACvC,eAAKA,QAAL,GAAgBA,QAAhB;AACH;AAED;;;;;;;yCAIwB5+B,E,EAAqB;AACzC,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;AAED;;;;;;;0CAIyBA,E,EAAqB;AAC1C,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;;;;MA5GyC,OAAAS,a;;AAZ9C;;;uBAYa+xD,wB,EAAwB,qC;AAAA,K;;;YAAxBA,wB;AAAwB,0C;AAAA;AAAA;yBAsBtB,eAAAJ,sB,EAAwB,I,EAAO,eAAAA,sB;;;;;;;;;;;;;uCA9B/B,CACP;AACI7a,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAM4D,wBAAN;AAAA,SAAX,CAFjB;AAGI3D,aAAK,EAAE;AAHX,OADO,C,GAMV,6B;AAAA,e;AAAA,a;AAAA,ihB;AAAA;AAAA;AC7CL;AACI;AACI;AAAA;AAGI;AAAA;AAAA,aAAwB,eAAxB,EAAwB;AAAA,mBACP,IAAAmC,OAAA,aADO;AACa,WADrC,EAAwB,MAAxB,EAAwB;AAAA,mBAMhB,IAAAyB,iBAAA,EANgB;AAMG,WAN3B;AAHJ;AAYA;AACI;AACJ;AACA;AAGJ;AACA;AAA0C;AAAA,mBAAkB,IAAA7tD,QAAA,qBAAlB;AAA+C,WAA/C;AACtC;AAIJ;AACJ;;;;;;AAtBY;AAAA,mDAAwB,UAAxB,EAAwB,YAAxB,EAAwB,iBAAxB,EAAwB,GAAxB;AAUU;AAAA;AAEgB;AAAA;AAKlB;AAAA;;;;;;;;;2BDyBP4tD,wB,EAAwB;cAZpC,OAAA3M,SAYoC;eAZ1B;AACPjlD,kBAAQ,EAAE,qBADH;AAEPklD,qBAAW,EAAE,oCAFN;AAGPC,mBAAS,EAAE,CAAC,oCAAD,CAHJ;AAIPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAM4D,wBAAN;AAAA,aAAX,CAFjB;AAGI3D,iBAAK,EAAE;AAHX,WADO;AAJJ,S;AAY0B,Q;;;;;;gBAEhC,OAAAvrD;;;gBAEA,OAAAA;;;gBAkBA,OAAA+lD,S;iBAAU,eAAA+I,sB,EAAwB;AAACG,gBAAI,EAAE,eAAAH;AAAP,W;;;;;;;;;;;;;;;;;;;;;;;;AErEvC;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAOaM,iB;;;;;AAIT,iCAAoBxP,OAApB,EAAqC;AAAA;;AAAA;;AACjC;AADgB,iBAAAA,OAAA,GAAAA,OAAA;AAAiB;AAEpC;;;;mCAEc;AAAA;;AACX,eAAKvgD,OAAL,CAAa,eAAb,EAA8B;AAAA,mBAAM,QAAI,CAACgwD,WAAL,CAAiBpjD,QAAQ,CAACohB,KAA1B,CAAN;AAAA,WAA9B,EAAsE,IAAtE;;AACA,eAAKuyB,OAAL,CAAanjC,MAAb,CAAoB9d,SAApB,CAA8B,UAACyP,KAAD,EAA0B;AACpD;AACA,gBAAIA,KAAK,YAAY,SAAAkhD,aAArB,EAAoC;AAChC,sBAAI,CAACjwD,OAAL,CAAa,eAAb,EAA8B;AAAA,uBAAM,QAAI,CAACgwD,WAAL,CAAiBpjD,QAAQ,CAACohB,KAA1B,CAAN;AAAA,eAA9B;AACH;AACJ,WALD;AAMH;;;oCAEkBtT,Q,EAAU;AACzBA,kBAAQ,GAAGA,QAAQ,CAAC0pB,MAAT,CAAgB,CAAhB,EAAmB1pB,QAAQ,CAACjW,OAAT,CAAiB,IAAjB,CAAnB,CAAX;AACA,eAAKyrD,YAAL,GAAoBx1C,QAApB;AACH;;;;MArBkC,OAAA5c,a;;AALvC;;;uBAKaiyD,iB,EAAiB,+B;AAAA,K;;;YAAjBA,iB;AAAiB,+B;AAAA,+C;AAAA,c;AAAA,a;AAAA,0F;AAAA;AAAA;ACV9B;AACI;AACI;AAAA;AAAgC;AAChC;AACI;AACJ;AACJ;AACJ;;;;AAPG;AAImB;AAAA;;;;;;;;;2BDMTA,iB,EAAiB;cAL7B,OAAA7M,SAK6B;eALnB;AACPjlD,kBAAQ,EAAE,UADH;AAEPklD,qBAAW,EAAE,2BAFN;AAGPC,mBAAS,EAAE,CAAC,2BAAD;AAHJ,S;AAKmB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;AEV9B;AAAA;AAAA;;AAKA;AAAA;AAAA;;;;;;;;;;;;;;;;ACJI;AAAoD;AAAkB;;;;;AAAvC;AAAqB;AAAA;;;;;;AACpD;;;;;;AAAiC;;;;;;AAFrC;AACI;AACA;AACJ;;;;;AAFO;AAAA;AACE;AAAA;;;;QDUI+M,a;;;;;;;;;;;;MAAsB,OAAAryD,a;;AALnC;;;6CAKaqyD,a;AAAa,K;;;YAAbA,a;AAAa,+B;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,6H;AAAA;AAAA;ACZ1B;;;;AAAsB;;;;;;;8DDYTA,a;;;;2BAAAA,a,EAAa;cALzB,OAAAjN,SAKyB;eALf;AACPjlD,kBAAQ,EAAE,UADH;AAEPklD,qBAAW,EAAE,uBAFN;AAGPC,mBAAS,EAAE,CAAC,uBAAD;AAHJ,S;AAKe,Q;;gBACrB,OAAAziD;;;;;;;;;;;;;;;;;;;;;;;;AEbL;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AASA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;AAEA,QAAMmmD,YAAY,GAAG,CACjB,gBAAAkE,oBADiB,EAEjB,iBAAAmF,aAFiB,EAGjB,gBAAAhF,gBAHiB,EAIjB,gBAAAgB,kBAJiB,EAKjB,gBAAAiB,sBALiB,EAMjB,gBAAAK,kBANiB,EAOjB,gBAAAoC,wBAPiB,EAQjB,gBAAAzB,sBARiB,EASjB,qBAAA2B,iBATiB,EAUjB,wBAAAvG,mBAViB,EAWjB,wBAAA4G,mBAXiB,EAYjB,sBAAAC,kBAZiB,EAajB,wBAAAC,mBAbiB,EAcjB,iBAAA3G,yBAdiB,EAejB,kCAAAa,4BAfiB,CAArB;AAkBA,QAAM+F,gBAAgB,GAAU,CAC5B,SAAAC,eAD4B,EAE5B,YAAAC,iBAF4B,EAG5B,SAAAC,eAH4B,EAI5B,aAAAC,kBAJ4B,EAK5B,QAAAC,cAL4B,EAM5B,mBAAAC,wBAN4B,EAO5B,eAAAC,oBAP4B,EAQ5B,eAAAC,qBAR4B,EAS5B,SAAAC,eAT4B,EAU5B,QAAAC,cAV4B,EAW5B,OAAAC,eAX4B,EAY5B,OAAAC,aAZ4B,EAa5B,WAAAC,iBAb4B,EAc5B,UAAAC,gBAd4B,EAe5B,QAAAC,cAf4B,EAgB5B,OAAAC,aAhB4B,EAiB5B,eAAAC,oBAjB4B,CAAhC;;QAwCarK,c;;;;AApBb;;YAoBaA;;;;yBAAAA,c;AAAc,O;AAAA,iBAlBnB,SAAA7qD,YAkBmB,EAjBnB,YAAAm1D,gBAiBmB,EAhBnB,QAAArK,WAgBmB,EAfnB,QAAAC,mBAemB,SAdhBkJ,gBAcgB,GAbnB,OAAAryD,UAamB,EAZnB,KAAAopD,QAYmB,IANnB,YAAAmK,gBAMmB,EAvCvB,SAAAjB,eAuCuB,EAtCvB,YAAAC,iBAsCuB,EArCvB,SAAAC,eAqCuB,EApCvB,aAAAC,kBAoCuB,EAnCvB,QAAAC,cAmCuB,EAlCvB,mBAAAC,wBAkCuB,EAjCvB,eAAAC,oBAiCuB,EAhCvB,eAAAC,qBAgCuB,EA/BvB,SAAAC,eA+BuB,EA9BvB,QAAAC,cA8BuB,EA7BvB,OAAAC,eA6BuB,EA5BvB,OAAAC,aA4BuB,EA3BvB,WAAAC,iBA2BuB,EA1BvB,UAAAC,gBA0BuB,EAzBvB,QAAAC,cAyBuB,EAxBvB,OAAAC,aAwBuB,EAvBvB,eAAAC,oBAuBuB,EAHnB,OAAAtzD,UAGmB;;;;+EAAdipD,c,EAAc;AAAA,uBAzDvB,gBAAA6D,oBAyDuB,EAxDvB,iBAAAmF,aAwDuB,EAvDvB,gBAAAhF,gBAuDuB,EAtDvB,gBAAAgB,kBAsDuB,EArDvB,gBAAAiB,sBAqDuB,EApDvB,gBAAAK,kBAoDuB,EAnDvB,gBAAAoC,wBAmDuB,EAlDvB,gBAAAzB,sBAkDuB,EAjDvB,qBAAA2B,iBAiDuB,EAhDvB,wBAAAvG,mBAgDuB,EA/CvB,wBAAA4G,mBA+CuB,EA9CvB,sBAAAC,kBA8CuB,EA7CvB,wBAAAC,mBA6CuB,EA5CvB,iBAAA3G,yBA4CuB,EA3CvB,kCAAAa,4BA2CuB;AA3CK,kBAyBxB,SAAAluD,YAzBwB,EA0BxB,YAAAm1D,gBA1BwB,EA2BxB,QAAArK,WA3BwB,EA4BxB,QAAAC,mBA5BwB,EAI5B,SAAAmJ,eAJ4B,EAK5B,YAAAC,iBAL4B,EAM5B,SAAAC,eAN4B,EAO5B,aAAAC,kBAP4B,EAQ5B,QAAAC,cAR4B,EAS5B,mBAAAC,wBAT4B,EAU5B,eAAAC,oBAV4B,EAW5B,eAAAC,qBAX4B,EAY5B,SAAAC,eAZ4B,EAa5B,QAAAC,cAb4B,EAc5B,OAAAC,eAd4B,EAe5B,OAAAC,aAf4B,EAgB5B,WAAAC,iBAhB4B,EAiB5B,UAAAC,gBAjB4B,EAkB5B,QAAAC,cAlB4B,EAmB5B,OAAAC,aAnB4B,EAoB5B,eAAAC,oBApB4B,EA8BxB,OAAAtzD,UA9BwB,EA+BxB,KAAAopD,QA/BwB,CA2CL;AAZX,kBAMR,YAAAmK,gBANQ,EA7CZ,gBAAAzG,oBA6CY,EA5CZ,iBAAAmF,aA4CY,EA3CZ,gBAAAhF,gBA2CY,EA1CZ,gBAAAgB,kBA0CY,EAzCZ,gBAAAiB,sBAyCY,EAxCZ,gBAAAK,kBAwCY,EAvCZ,gBAAAoC,wBAuCY,EAtCZ,gBAAAzB,sBAsCY,EArCZ,qBAAA2B,iBAqCY,EApCZ,wBAAAvG,mBAoCY,EAnCZ,wBAAA4G,mBAmCY,EAlCZ,sBAAAC,kBAkCY,EAjCZ,wBAAAC,mBAiCY,EAhCZ,iBAAA3G,yBAgCY,EA/BZ,kCAAAa,4BA+BY,EA3BZ,SAAAgG,eA2BY,EA1BZ,YAAAC,iBA0BY,EAzBZ,SAAAC,eAyBY,EAxBZ,aAAAC,kBAwBY,EAvBZ,QAAAC,cAuBY,EAtBZ,mBAAAC,wBAsBY,EArBZ,eAAAC,oBAqBY,EApBZ,eAAAC,qBAoBY,EAnBZ,SAAAC,eAmBY,EAlBZ,QAAAC,cAkBY,EAjBZ,OAAAC,eAiBY,EAhBZ,OAAAC,aAgBY,EAfZ,WAAAC,iBAeY,EAdZ,UAAAC,gBAcY,EAbZ,QAAAC,cAaY,EAZZ,OAAAC,aAYY,EAXZ,eAAAC,oBAWY,EASR,OAAAtzD,UATQ;AAYW,O;AAHT,K;;;;;2BAGLipD,c,EAAc;cApB1B,OAAA5qD,QAoB0B;eApBjB;AACNC,iBAAO,GACH,SAAAF,YADG,EAEH,YAAAm1D,gBAFG,EAGH,QAAArK,WAHG,EAIH,QAAAC,mBAJG,SAKAkJ,gBALA,GAMH,OAAAryD,UANG,EAOH,KAAAopD,QAPG,EADD;AAUNlpD,sBAAY,YACL0oD,YADK,CAVN;AAaNzoD,iBAAO,GACH,YAAAozD,gBADG,SAEA3K,YAFA,EAGAyJ,gBAHA,GAIH,OAAAryD,UAJG;AAbD,S;AAoBiB,Q;;;;;;;;;;;;;;;;;;;;;;ACtG3B;AAAA;AAAA;;AAOA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;ACPA;AAMI;AAAA;AAAA;AAAA;AAAS,iBAAAoU,MAAA;AAAsB,iBAAF,cAAS,KAAP;AAAY,SAA3C;AAEA;AACJ;;;;;;;AAJI;AAHA;AAMU;AAAA;;;;;;;;;;;QDWD89C,mB;;;;;AALb;AAAA;;AAAA;;;AAMI;;AACgB,iBAAAp+C,OAAA,GAA0B,EAA1B;AAChB;;AACiB,iBAAAM,MAAA,GAAS,IAAI,OAAAquC,YAAJ,EAAT;AATrB;AAkBC;;;;gCALkB;AAAA;;AACX,eAAK3gD,OAAL,CAAa,OAAb,EAAsB,YAAM;AACxB,oBAAI,CAACs0B,IAAL,GAAY,KAAZ;AACH,WAFD;AAGH;;;;MAZoC,OAAAx2B,a;;AALzC;;;mDAKasyD,mB;AAAmB,K;;;YAAnBA,mB;AAAmB,oC;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,qO;AAAA;AAAA;ACnBhC;AAUA;AAAwD;AAAA;AAAA,aAAsB,OAAtB,EAAsB;AAAA,8BAAwB,IAAA3qB,KAAA,EAAxB,GAAkC,EAAlC;AAAoC,WAA1D,EAA0D,KAA1D,EAA0D,kBAA1D;AACpD;AACJ;;;;AARI;AAMgC;AAAA;AACtB;AAAA;;;;;;oEDQD2qB,mB;;;;2BAAAA,mB,EAAmB;cAL/B,OAAAlN,SAK+B;eALrB;AACPjlD,kBAAQ,EAAE,eADH;AAEPklD,qBAAW,EAAE,8BAFN;AAGPC,mBAAS,EAAE,CAAC,8BAAD;AAHJ,S;AAKqB,Q;;gBAE3B,OAAAziD;;;gBAEA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AEvBL;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;ACYI;AACI;AACJ;;;;;;;;;;;;QDPSgN,kB;;;;;AALb;AAAA;;AAAA;;;AAcI;;AACiB,iBAAAqB,WAAA,GAAc,IAAI,OAAA/Q,YAAJ,EAAd;AAfrB;AAgCC;;;;oCAbsB5hD,O,EAAsB;AACrC;AACA,cAAIA,OAAO,CAAC4yD,SAAR,IAAqB,KAAKA,SAA9B,EAAyC;AACrC,iBAAKC,UAAL;AACH;AACJ;;;qCAEmB;AAChB;AACA,cAAI,KAAKC,WAAL,IAAoB,KAAKA,WAAL,CAAiB3yD,aAAzC,EAAwD;AACpD,iBAAK2yD,WAAL,CAAiB3yD,aAAjB,CAA+B6uD,KAA/B;AACH;AACJ;;;;MA1BmC,OAAAjwD,a;;AALxC;;;kDAKauyD,kB;AAAkB,K;;;YAAlBA,kB;AAAkB,kC;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;ACR/B;AAAoC;AAAA,mBAAS,IAAAuB,UAAA,EAAT;AAAqB,WAArB,EAAsB,OAAtB,EAAsB;AAAA,mBAAU,IAAAA,UAAA,EAAV;AAAsB,WAA5C;AAChC;AACI;AACJ;AACA;AACI;AAEI;AAAA;AAAA,aAAmB,eAAnB,EAAmB;AAAA,mBACF,IAAAF,WAAA,aADE;AACsB,WADzC;AAFJ;AAOJ;AACA;AAGJ;;;;AAdkB;AAAA;AAKN;AAAA,8CAAmB,aAAnB,EAAmB,8BAAnB;AAMY;AAAA;;;;;;mEDLXrB,kB;;;;2BAAAA,kB,EAAkB;cAL9B,OAAAnN,SAK8B;eALpB;AACPjlD,kBAAQ,EAAE,aADH;AAEPklD,qBAAW,EAAE,4BAFN;AAGPC,mBAAS,EAAE,CAAC,4BAAD;AAHJ,S;AAKoB,Q;;gBAE1B,OAAAziD,K;iBAAM,O;;;gBAEN,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;gBAEA,OAAAqD,S;iBAAU,O,EAAS;AAAE,sBAAQ;AAAV,W;;;;;;;;;;;;;;;;;;;;;;;;AEpBxB;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;ACAI;AAA4D;AAAc;;;;;AAAd;AAAA;;;;;;AADhE;AACI;AACJ;;;;;;;;AAFsC;AACZ;AAAA,kDAAqC,UAArC,EAAqC,GAArC;;;;;;AAGtB;;;;;;AAAK;;;;QDII4J,mB;;;;;;;4BAIU;AACf,cAAI,CAAC,KAAKr2C,IAAV,EAAgB;AACZ,mBAAO,IAAP;AACH;;AACD,cAAMhR,KAAK,GAAG,KAAKgR,IAAL,CAAU7c,IAAV,CAAeiG,KAAf,CAAqB,GAArB,CAAd;AACA,iBAAO4F,KAAK,CAAC1F,MAAN,GAAe,CAAf,aACE0F,KAAK,CAAC,CAAD,CAAL,CAAS,CAAT,CADF,SACgBA,KAAK,CAACA,KAAK,CAAC1F,MAAN,GAAe,CAAhB,CAAL,CAAwB,CAAxB,CADhB,IAED,KAAK0W,IAAL,CAAU7c,IAAV,CAAe+J,KAAf,CAAqB,CAArB,EAAwB,CAAxB,CAFN;AAGH;;;;;;AAjBL;;;uBAKampD,mB;AAAmB,K;;;YAAnBA,mB;AAAmB,oC;AAAA;AAAA;AAAA,O;AAAA,c;AAAA,a;AAAA,uK;AAAA;AAAA;ACRhC;AAGA;;;;AAHyB;;;;;;;;;;2BDQZA,mB,EAAmB;cAL/B,OAAApN,SAK+B;eALrB;AACPjlD,kBAAQ,EAAE,eADH;AAEPklD,qBAAW,EAAE,8BAFN;AAGPC,mBAAS,EAAE,CAAC,8BAAD;AAHJ,S;AAKqB,Q;;gBAE3B,OAAAziD;;;;;;;;;;;;;;;;;;;;;;;;;;;;AEVL;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;ACJA;AAAA;AAAA;;AAOA;AAAA;AAAA;;AAIA;AAAA;AAAA;AA0CA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDa,YAAA8Q,mBAAA,GAAsB,UAC/BqgD,YAD+B,EAE/BC,QAF+B,EAGmB;AAClD,UAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,OAAD;AAAA,0BAAyBH,YAAzB,eAA0CG,OAA1C;AAAA,OAApB,CADkD,CAElD;;;AACA,UAAMx+C,OAAO,GAAG,QAAAnC,YAAA,CAAa0gD,WAAW,CAAC,SAAD,CAAxB,EAAqC,QAAAzgD,KAAA,EAArC,CAAhB;AACA,UAAMkF,OAAO,GAAG,QAAAnF,YAAA,CAAa0gD,WAAW,CAAC,SAAD,CAAxB,EAAqC,QAAAzgD,KAAA,EAArC,CAAhB;AACA,UAAMuO,KAAK,GAAG,QAAAxO,YAAA,CAAa0gD,WAAW,CAAC,OAAD,CAAxB,EAAmC,QAAAzgD,KAAA,EAAnC,CAAd;AACA,UAAM2gD,KAAK,GAAG,QAAA5gD,YAAA,CAAa0gD,WAAW,CAAC,OAAD,CAAxB,CAAd;AACA,UAAM78C,GAAG,GAAiB,CACtB,QAAAD,EAAA,CAAGzB,OAAH,EAAY,UAACrX,KAAD,EAAkDkW,MAAlD;AAAA,eACP,MAAD,OAAC,CAAD,kBACOlW,KADP,CAAC,sBAEI21D,QAFJ,EAEe,gBAAAI,WAAA,CAAsB/1D,KAAK,CAAC21D,QAAD,CAA3B,EAAuCz3C,OAAvC,EAFf,EADO;AAAA,OAAZ,CADsB,EAMtB,QAAApF,EAAA,CAAGuB,OAAH,EAAY,UAACra,KAAD,EAAkDkW,MAAlD;AAAA,eAAgG,MAAD,OAAC,CAAD,kBACpGlW,KADoG,CAAC,sBAEvG21D,QAFuG,EAE5F,gBAAAr9C,YAAA,CAAa+B,OAAb,CAAqBnE,MAAM,CAACmD,OAA5B,CAF4F,EAAhG;AAAA,OAAZ,CANsB,EAUtB;AACA,cAAAP,EAAA,CAAG4K,KAAH,EAAU,UAAC1jB,KAAD,EAAakW,MAAb;AAAA,eAAwD,MAAD,OAAC,CAAD,kBAC1DlW,KAD0D,CAAC,sBAE7D21D,QAF6D,EAElD,gBAAAr9C,YAAA,CAAaoL,KAAb,CAA6BxN,MAAM,CAACmD,OAApC,CAFkD,EAAxD;AAAA,OAAV,CAXsB,EAetB,QAAAP,EAAA,CAAGg9C,KAAH,EAAU;AAAA,eAAO,MAAD,OAAC,CAAD,kBACT,QAAI,CAAC91D,KADI,CAAC,sBAEZ21D,QAFY,EAED,gBAAAr9C,YAAA,CAAaC,KAAb,EAFC,EAAP;AAAA,OAAV,CAfsB,CAA1B;;AAoBA,UAAMy9C,UAAU,GAAG,SAAbA,UAAa,CAACh2D,KAAD,EAAmB;AAClC,YAAI,CAACA,KAAL,EAAY;AACR2K,iBAAO,CAACsrD,IAAR,CAAa,yCAAb,EAAwDN,QAAxD;AACH;;AACD,eAAO,gBAAAI,WAAA,CAAsB/1D,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAG21D,QAAH,CAA3B,CAAP;AACH,OALD;;AAMA,UAAMO,UAAU,GAAG,QAAAj8C,cAAA,CACf+7C,UADe,EAEf,oBAAAG,aAFe,CAAnB;AAIA,UAAMC,kBAAkB,GAAG,QAAAn8C,cAAA,CACvB+7C,UADuB,EAEvB,oBAAAK,qBAFuB,CAA3B;AAIA,UAAMC,QAAQ,GAAG,QAAAr8C,cAAA,CACb+7C,UADa,EAEb,oBAAAO,mBAFa,CAAjB;AAIA,UAAMC,UAAU,GAAG,QAAAv8C,cAAA,CACf+7C,UADe,EAEf,oBAAAS,eAFe,CAAnB;AAIA,aAAO;AACHp/C,eAAO,EAAPA,OADG;AAEHgD,eAAO,EAAPA,OAFG;AAGHqJ,aAAK,EAALA,KAHG;AAIHoyC,aAAK,EAALA,KAJG;AAKH/8C,WAAG,EAAHA,GALG;AAMHmB,iBAAS,EAAE;AACPG,iBAAO,EAAE67C,UADF;AAEP/7C,yBAAe,EAAEi8C,kBAFV;AAGP1yC,eAAK,EAAE4yC,QAHA;AAIPp4C,iBAAO,EAAEs4C,UAJF;AAKPppC,eAAK,EAAE4oC;AALA;AANR,OAAP;AAcH,KAlEY;;;;;;;;;;;;;;;;;;;;;ACvGb;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAKA;AAAA;AAAA;AAMA;;;;;;;;;;AAQa,YAAAz+C,mBAAA,GAAsB,UACjC3B,OADiC,EACf8gD,YADe,EAEjCC,MAFiC;AAAA,aAEmE/gD,OAAO,CAACG,IAAR,CACpG,UAAAC,MAAA,CAAO0gD,YAAY,CAACr/C,OAApB,CADoG,EAEpG,YAAAu/C,OAAA,CAAQ,UAAC1gD,MAAD;AAAA,eAAYygD,MAAM,CAACzgD,MAAD,CAAlB;AAAA,OAAR,CAFoG,EAGpG,YAAApL,GAAA,CAAI,UAACu6B,QAAD;AAAA,eAAwBqxB,YAAY,CAACr8C,OAAb,CAAqB;AAAEhB,iBAAO,EAAEgsB;AAAX,SAArB,CAAxB;AAAA,OAAJ,CAHoG,EAIpG,YAAA5hB,UAAA,CAAW,UAAAV,GAAG,EAAI;AAChB,eAAO,OAAAY,EAAA,CAAG+yC,YAAY,CAAChzC,KAAb,CAAmB;AAAErK,iBAAO,EAAE0J;AAAX,SAAnB,CAAH,CAAP;AACD,OAFD,CAJoG,CAFnE;AAAA,KAAtB;;;;;;;;;;;;;;;;;;;;AC7Bb;;AACA;;;;;QAIazK,Y;AAqCT,4BACWu+C,SADX,EAEYC,QAFZ,EAGYC,UAHZ,EAIYC,QAJZ,EAKWtzC,KALX,EAKwB;AAAA;;AAAA;;AAJb,aAAAmzC,SAAA,GAAAA,SAAA;AACC,aAAAC,QAAA,GAAAA,QAAA;AACA,aAAAC,UAAA,GAAAA,UAAA;AACA,aAAAC,QAAA,GAAAA,QAAA;AACD,aAAAtzC,KAAA,GAAAA,KAAA;AAjCX;;;;;AAIA,aAAA2K,MAAA,GAAS,UACLhU,OADK;AAAA,iBACkB,IAAI/B,YAAJ,CACvB,QAAI,CAACu+C,SADkB,EAEvB,QAAI,CAACC,QAFkB,EAGvB,CAAC,CAACz8C,OAHqB,EAIvB,CAACA,OAAD,GAAWnT,SAAX,GAAuBmT,OAJA,CADlB;AAAA,SAAT;;AAQA,aAAA6D,OAAA,GAAU;AAAA,cAAC7D,OAAD,uEAAqB,QAAI,CAACA,OAA1B;AAAA,iBACN,IAAI/B,YAAJ,CACI,IADJ,EAEI,KAFJ,EAGI,CAAC,CAAC+B,OAAF,IAAa,QAAI,CAAC08C,UAHtB,EAII,CAAC18C,OAAD,GAAWnT,SAAX,GAAuBmT,OAJ3B,CADM;AAAA,SAAV;;AAyBA,aAAA48C,OAAA,GAAU;AAAA,iBAAM,CAAC,QAAI,CAACC,SAAL,EAAD,IAAqB,CAAC,QAAI,CAACC,OAAL,EAA5B;AAAA,SAAV;;AAEA,aAAAC,SAAA,GAAY;AAAA,iBAAM,CAAC,QAAI,CAACH,OAAL,EAAD,IAAmB,CAAC,QAAI,CAACJ,SAA/B;AAAA,SAAZ;;AAEA,aAAAK,SAAA,GAAY;AAAA,iBAAM,QAAI,CAACH,UAAX;AAAA,SAAZ;;AAEA,aAAAI,OAAA,GAAU;AAAA,iBAAM,QAAI,CAACL,QAAX;AAAA,SAAV;;AAEA,aAAAO,UAAA,GAAa;AAAA,iBAAM,CAAC,QAAI,CAACH,SAAL,EAAD,IAAqB,CAAC,QAAI,CAACL,SAAjC;AAAA,SAAb;;AAEO,aAAAnrD,QAAA,GAAW;AAAA,iBACd,mBAAY,QAAI,CAACmrD,SAAjB,wBAAwC,QAAI,CAACE,UAA7C,gBAA6D,QAAI,CAACC,QAAlE,6BACU,QAAI,CAACF,QADf,cAC2B,QAAI,CAACpzC,KADhC,CADc;AAAA,SAAX;AAZN;;;;4BAfiB;AACd,iBAAO,KAAKszC,QAAZ;AACH;;;4BAEyB;AACtB,iBAAO,KAAKA,QAAZ;AACH;;;;;;AAnCL;;AACW,iBAAAz+C,KAAA,GAAQ;AAAA,aAAS,IAAID,YAAJ,CAAoB,KAApB,EAA2B,KAA3B,EAAkC,KAAlC,EAAyCpR,SAAzC,CAAT;AAAA,KAAR;;AAEA,iBAAAmT,OAAA,GAAU,UAAIA,OAAJ;AAAA,aACb,IAAI/B,YAAJ,CAAiB,KAAjB,EAAwB,KAAxB,EAA+B,IAA/B,EAAqC+B,OAArC,CADa;AAAA,KAAV;;AAGA,iBAAAqJ,KAAA,GAAQ,UAAIA,KAAJ,EAAmBvJ,eAAnB;AAAA,aACX,IAAI7B,YAAJ,CAAoB,KAApB,EAA2B,IAA3B,EAAiC,KAAjC,EAAwC6B,eAAxC,EAAyDuJ,KAAzD,CADW;AAAA,KAAR;AAuDX;;;;;;AAIa,YAAAqyC,WAAA,GAAc,UAAgB73C,OAAhB,EAAkD;AACzE,UAAIA,OAAO,YAAY5F,YAAvB,EAAqC;AACjC,eAAO4F,OAAP;AACH,OAFD,MAEO;AACH,YAAI,CAACA,OAAL,EAAc;AACV,iBAAO5F,YAAY,CAACC,KAAb,EAAP;AACH,SAFD,MAEO;AACH,iBAAO,IAAID,YAAJ,CACH4F,OAAO,CAAC24C,SAAR,IAAqB,KADlB,EAEH34C,OAAO,CAAC44C,QAAR,IAAoB,KAFjB,EAGH54C,OAAO,CAAC64C,UAAR,IAAsB,KAHnB,EAIH74C,OAAO,CAAC84C,QAJL,EAKH94C,OAAO,CAACwF,KALL,CAAP;AAOH;AACJ;AACJ,KAhBY;;;;;;;;;;;;;;;;;;;;;ACtEb;AAAA;AAAA;;AAEa,YAAAyyC,aAAA,GAAgB,UAAIn2D,KAAJ;AAAA,aAC3B,gBAAA+1D,WAAA,CAAe/1D,KAAf,EAAsBqa,OADK;AAAA,KAAhB;;AAEA,YAAAg8C,qBAAA,GAAwB,UAAIr2D,KAAJ;AAAA,aACnC,gBAAA+1D,WAAA,CAAe/1D,KAAf,EAAsBma,eADa;AAAA,KAAxB;;AAEA,YAAAs8C,eAAA,GAAkB,UAAIz2D,KAAJ;AAAA,aAC7B,gBAAA+1D,WAAA,CAAe/1D,KAAf,EAAsB62D,SADO;AAAA,KAAlB;;AAEA,YAAAS,eAAA,GAAkB,UAAIt3D,KAAJ;AAAA,aAC7B,gBAAA+1D,WAAA,CAAe/1D,KAAf,EAAsBk3D,SAAtB,EAD6B;AAAA,KAAlB;;AAEA,YAAAX,mBAAA,GAAsB,UAACv2D,KAAD;AAAA,aACjC,gBAAA+1D,WAAA,CAAiB/1D,KAAjB,EAAwB0jB,KADS;AAAA,KAAtB;;AAEA,YAAA6zC,aAAA,GAAgB,UAAIv3D,KAAJ;AAAA,aAC3B,gBAAA+1D,WAAA,CAAe/1D,KAAf,EAAsBm3D,OAAtB,EAD2B;AAAA,KAAhB;;AAEA,YAAAK,eAAA,GAAkB,UAAIx3D,KAAJ;AAAA,aAC7B,gBAAA+1D,WAAA,CAAe/1D,KAAf,EAAsBo3D,SAAtB,EAD6B;AAAA,KAAlB;;AAEA,YAAAK,aAAA,GAAgB,UAAIz3D,KAAJ;AAAA,aAC3B,gBAAA+1D,WAAA,CAAe/1D,KAAf,EAAsBi3D,OAAtB,EAD2B;AAAA,KAAhB;;;;;;;;;;;;;;;;;;;;;AChBb;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAKa,YAAAS,mBAAA,GAAsB,YAAM;AACvC,UAAMC,UAAU,GAAG,IAAI,OAAA52C,OAAJ,EAAnB;AACA,aAAO;AACL42C,kBAAU,EAAVA,UADK;AAEL/hD,eAAO,EAAE,IAAI,UAAAgiD,OAAJ,CAAYD,UAAZ;AAFJ,OAAP;AAID,KANY;AAQb;;;;;AAGa,YAAAE,mBAAA,GAAsB,UACjC3hD,MADiC,EAEjC4hD,MAFiC,EAGjCH,UAHiC,EAIjC9vC,OAJiC,EAO3B;AACN,UAAIxE,MAAJ;AACAy0C,YAAM,CACH/hD,IADH,CACQ,YAAA+H,IAAA,CAAK,CAAL,CADR,EAEG5a,SAFH,CAEa,UAAAkQ,IAAI,EAAI;AACjBiQ,cAAM,GAAGjQ,IAAT;AACD,OAJH,EAFM,CAON;;AACAukD,gBAAU,CAACvkD,IAAX,CAAgB8C,MAAM,CAACmB,OAAP,CAAgBwQ,OAAO,CAACxO,OAAR,IAAmB,EAAnC,CAAhB;AAEA0+C,YAAM,CAAC10C,MAAD,CAAN,CAAe20C,WAAf;AACAD,YAAM,CAAC10C,MAAD,CAAN,CAAe40C,aAAf,CAA6B/hD,MAAM,CAACmE,OAAP,CAAe;AAAEhB,eAAO,EAAEwO,OAAO,CAACrM;AAAnB,OAAf,CAA7B;AACD,KAnBY;AAqBb;;;;;AAGa,YAAA08C,iBAAA,GAAoB,UAC/BhiD,MAD+B,EAE/B4hD,MAF+B,EAG/BH,UAH+B,EAI/B9vC,OAJ+B,EAOzB;AACN,UAAIxE,MAAJ;AACAy0C,YAAM,CACH/hD,IADH,CACQ,YAAA+H,IAAA,CAAK,CAAL,CADR,EAEG5a,SAFH,CAEa,UAAAkQ,IAAI,EAAI;AACjBiQ,cAAM,GAAGjQ,IAAT;AACD,OAJH,EAFM,CAON;;AACAukD,gBAAU,CAACvkD,IAAX,CAAgB8C,MAAM,CAACmB,OAAP,CAAgBwQ,OAAO,CAACxO,OAAR,IAAmB,EAAnC,CAAhB;AAEA0+C,YAAM,CAAC10C,MAAD,CAAN,CAAe20C,WAAf;AACAD,YAAM,CAAC10C,MAAD,CAAN,CAAe40C,aAAf,CAA6B/hD,MAAM,CAACwN,KAAP,CAAa;AAAErK,eAAO,EAAEwO,OAAO,CAACnE;AAAnB,OAAb,CAA7B;AACD,KAnBY;;;;;;;;;;;;;;;;;;;;;;;;;AC/Cb;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;ACAA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACAA;AAAA;AAAA;;AAGa,YAAAy0C,yBAAA,GAA4B,UAACn4D,KAAD;AAAA,aAAgDA,KAAK,CAACuuC,YAAtD;AAAA,KAA5B;;AAEA,YAAAnzB,iBAAA,GAAoB,UAAA/F,mBAAA,CAAqD,cAArD,EAAqE,MAArE,CAApB;;;;;;;;;;;;;;;;;;;;;;;;ACNb;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;QAIa+iD,mB,GAEX,6BAAoBxiD,OAApB,EACoByiD,mBADpB,EAC8D;AAAA;;AAAA;;AAD1C,WAAAziD,OAAA,GAAAA,OAAA;AACA,WAAAyiD,mBAAA,GAAAA,mBAAA;AAIb,WAAAj9C,iBAAA,GAAoB,UAAA7D,mBAAA,CAAoB,KAAK3B,OAAzB,EAAkC,uBAAAwF,iBAAlC,EACzB;AAAA,eAAM,QAAI,CAACi9C,mBAAL,CAAyB7pB,gBAAzB,EAAN;AAAA,OADyB,CAApB;AAHN,K;;;uBAJU4pB,mB,EAAmB,uB,EAAA,mC;AAAA,K;;;aAAnBA,mB;AAAmB,eAAnBA,mBAAmB;;;AAO9B,wBADC,UAAAvgD,MAAA,EACD,E,yCAAA,G,6BAAA,E,mBAAA,E,MAAA;;AARF;;;;2BACaugD,mB,EAAmB;cAD/B,OAAAtgD;AAC+B,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXhC;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;QAWawgD,kB;;;;AATb;;YASaA;;;;yBAAAA,kB;AAAkB,O;AAAA,gBARpB,CACP,SAAAp4D,YADO,EAEP,UAAA8X,aAAA,CAAcC,UAAd,CAAyB,CACvB,uBAAAmgD,mBADuB,CAAzB,CAFO,EAKP,QAAAlgD,WAAA,CAAYD,UAAZ,CAAuB,cAAvB,EAAuC,uBAAAsgD,mBAAvC,CALO,CAQoB;;;;+EAAlBD,kB,EAAkB;AAAA,kBAP3B,SAAAp4D,YAO2B,EAPf,uBAOe,EAPf,qBAOe;AAAA,O;AAPf,K;;;;;2BAOHo4D,kB,EAAkB;cAT9B,OAAAn4D,QAS8B;eATrB;AACRC,iBAAO,EAAE,CACP,SAAAF,YADO,EAEP,UAAA8X,aAAA,CAAcC,UAAd,CAAyB,CACvB,uBAAAmgD,mBADuB,CAAzB,CAFO,EAKP,QAAAlgD,WAAA,CAAYD,UAAZ,CAAuB,cAAvB,EAAuC,uBAAAsgD,mBAAvC,CALO;AADD,S;AASqB,Q;;;;;;;;;;;;;;;;;;;;;;AChB/B;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAMA,QAAMC,YAAY,GAAsB;AACtCh9C,UAAI,EAAE,UAAAlD,YAAA,CAAaC,KAAb;AADgC,KAAxC;AAIa,YAAAggD,mBAAA,GAAsB,QAAA1/C,aAAA,iBAAc2/C,YAAd,4BAC9B,uBAAAp9C,iBAAA,CAAkBrC,GADY,GAAtB;;;;;;;;;;;;;;;;;;;;;;;;ACbb;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACJA;AAAA;AAAA;;AAOA;AAAA;AAAA;;AAMa,YAAAmU,iBAAA,GAAoB,UAACltB,KAAD;AAAA,aAA2BA,KAAK,CAACy4D,KAAjC;AAAA,KAApB;;AAEA,YAAAC,kBAAA,GAAqB,QAAAxjD,YAAA,CAAa,+BAAb,EAA8C,QAAAC,KAAA,EAA9C,CAArB;AAEA,YAAAgY,mBAAA,GAAsB,kBAAA9X,mBAAA,CAA0D,OAA1D,EAAmE,OAAnE,CAAtB;AAEA,YAAAiY,sBAAA,GAAyB,kBAAAjY,mBAAA,CAA0D,eAA1D,EAA2E,OAA3E,CAAzB;AAGA,YAAAmY,uBAAA,GAA0B,kBAAAnY,mBAAA,CAA0D,aAA1D,EAAyE,OAAzE,CAA1B;AAEA,YAAAqY,kBAAA,GAAqB,kBAAArY,mBAAA,CAA0D,gBAA1D,EAA4E,MAA5E,CAArB;AAEA,YAAAuY,eAAA,GAAkB,kBAAAvY,mBAAA,CAA0D,aAA1D,EAAyE,MAAzE,CAAlB;AAEA,YAAAsjD,wBAAA,GAA2B,QAAA1+C,cAAA,CAAe,QAAAiT,iBAAf,EACpC,QAAAC,mBAAA,CAAoBjT,SAApB,CAA8BC,eADM,CAA3B;AAGA,YAAA2T,mBAAA,GAAsB,kBAAAzY,mBAAA,CAA0D,sBAA1D,EAAkF,MAAlF,CAAtB;;;;;;;;;;;;;;;;;;;;;;;;AC/Bb;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AASA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;;;;;;;;;;;;;QAOaujD,Y,GACT,sBAAoBhjD,OAApB,EACoBijD,YADpB,EACiD;AAAA;;AAAA;;AAD7B,WAAAjjD,OAAA,GAAAA,OAAA;AACA,WAAAijD,YAAA,GAAAA,YAAA;AAIb,WAAAC,mCAAA,GAAsC,KAAKljD,OAAL,CAAaG,IAAb,CACzC,UAAAC,MAAA,CAAO,gBAAA0iD,kBAAP,CADyC,EAEzC,YAAAziD,QAAA,CAAS,UAACC,MAAD,EAA6C;AAClD,eAAO,CACH,gBAAAiX,mBAAA,CAAoB9V,OAApB,CAA4B,MAAD,OAAC,CAAD,kBACpBnB,MADoB,CAAC,EACf;AACTtQ,gBAAM,EAAEsQ,MAAM,CAACtQ;AADN,SADe,CAA5B,CADG,EAKH;AACA;AACA;AACA;AACA,wBAAA4nB,uBAAA,CAAwBnW,OAAxB,CAAgC,MAAD,OAAC,CAAD,kBACxBnB,MADwB,CAAC,EACnB;AACTtQ,gBAAM,EAAE,cAAAmzD,sBAAA,CAAuB7iD,MAAM,CAACtQ,MAA9B;AADC,SADmB,CAAhC,CATG,EAaH,gBAAA8nB,kBAAA,CAAmBrW,OAAnB,CAA2B,MAAD,OAAC,CAAD,kBACnBnB,MADmB,CAAC,EACd;AACTtQ,gBAAM,EAAE,cAAAozD,eAAA,CAAgB9iD,MAAM,CAACtQ,MAAvB;AADC,SADc,CAA3B,CAbG,EAiBH,gBAAAkoB,mBAAA,CAAoBzW,OAApB,CAA4B,MAAD,OAAC,CAAD,kBACpBnB,MADoB,CAAC,EACf;AACTtQ,gBAAM,EAAEsQ,MAAM,CAACtQ,MADN;AAETqzD,uBAAa,EAAE;AAFN,SADe,CAA5B,CAjBG,CAAP;AAuBH,OAxBD,CAFyC,CAAtC;AA8BA,WAAAC,yBAAA,GAA4B,UAAA3hD,mBAAA,CAAoB,KAAK3B,OAAzB,EAAkC,gBAAAuX,mBAAlC,EAC/B,UAACjX,MAAD;AAAA,eAAY,QAAI,CAAC2iD,YAAL,CAAkB/uC,SAAlB,CAA4B,cAAAqvC,0CAAA,CAA2CjjD,MAA3C,CAA5B,EAAgF,OAAhF,CAAZ;AAAA,OAD+B,CAA5B;AAIA,WAAAkjD,4BAAA,GAA+B,UAAA7hD,mBAAA,CAAoB,KAAK3B,OAAzB,EAAkC,gBAAA0X,sBAAlC,EAClC,UAACpX,MAAD;AAAA,eAAY,QAAI,CAAC2iD,YAAL,CAAkB/uC,SAAlB,CAA4B,cAAAqvC,0CAAA,CAA2CjjD,MAA3C,CAA5B,EAAgF,gBAAhF,EAAkG,KAAlG,CAAZ;AAAA,OADkC,CAA/B;AAIA,WAAAmjD,6BAAA,GAAgC,UAAA9hD,mBAAA,CAAoB,KAAK3B,OAAzB,EAAkC,gBAAA4X,uBAAlC,EACnC,UAACtX,MAAD;AAAA,eACI,QAAI,CAAC2iD,YAAL,CAAkB/uC,SAAlB,CAA4B,cAAAqvC,0CAAA,CAA2CjjD,MAA3C,CAA5B,EAAgF,cAAhF,CADJ;AAAA,OADmC,CAAhC;AAKA,WAAAojD,wBAAA,GAA2B,UAAA/hD,mBAAA,CAAoB,KAAK3B,OAAzB,EAAkC,gBAAA8X,kBAAlC,EAC9B,UAACxX,MAAD;AAAA,eACI,QAAI,CAAC2iD,YAAL,CAAkB/uC,SAAlB,CAA4B,cAAAqvC,0CAAA,CAA2CjjD,MAA3C,CAA5B,EAAgF,SAAhF,CADJ;AAAA,OAD8B,CAA3B;AAKA,WAAAqjD,yBAAA,GAA4B,UAAAhiD,mBAAA,CAAoB,KAAK3B,OAAzB,EAAkC,gBAAAkY,mBAAlC,EAC/B,UAAC5X,MAAD;AAAA,eACI,QAAI,CAAC2iD,YAAL,CAAkB/uC,SAAlB,CAA4B,cAAAqvC,0CAAA,CAA2CjjD,MAA3C,CAA5B,EAAgF,UAAhF,CADJ;AAAA,OAD+B,CAA5B;AAKA,WAAAsjD,yBAAA,GAA4B,UAAAjiD,mBAAA,CAAoB,KAAK3B,OAAzB,EAAkC,gBAAAgY,eAAlC,EAC/B,UAAC1X,MAAD;AAAA,eACI,QAAI,CAAC2iD,YAAL,CAAkB/uC,SAAlB,CAA4B,cAAA2vC,8CAAA,CAA+CvjD,MAA/C,CAA5B,EAAoF,MAApF,EAA4F,KAA5F,CADJ;AAAA,OAD+B,CAA5B;AAxDN,K;;;uBAHQ0iD,Y,EAAY,uB,EAAA,6B;AAAA,K;;;aAAZA,Y;AAAY,eAAZA,YAAY;;;AAMrB,wBADC,UAAA/gD,MAAA,EACD,E,yCAAA,G,sBAAA,E,qCAAA,E,MAAA;;AA8BA,wBADC,UAAAA,MAAA,EACD,E,yCAAA,G,sBAAA,E,2BAAA,E,MAAA;;AAIA,wBADC,UAAAA,MAAA,EACD,E,yCAAA,G,sBAAA,E,8BAAA,E,MAAA;;AAIA,wBADC,UAAAA,MAAA,EACD,E,yCAAA,G,sBAAA,E,+BAAA,E,MAAA;;AAKA,wBADC,UAAAA,MAAA,EACD,E,yCAAA,G,sBAAA,E,0BAAA,E,MAAA;;AAKA,wBADC,UAAAA,MAAA,EACD,E,yCAAA,G,sBAAA,E,2BAAA,E,MAAA;;AAKA,wBADC,UAAAA,MAAA,EACD,E,yCAAA,G,sBAAA,E,2BAAA,E,MAAA;;AA5DJ;;;;2BACa+gD,Y,EAAY;cADxB,OAAA9gD;AACwB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChCzB;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;QASa4hD,W;;;;AAPb;;YAOaA;;;;yBAAAA,W;AAAW,O;AAAA,gBANX,CACL,SAAAx5D,YADK,EAEL,UAAA8X,aAAA,CAAcC,UAAd,CAAyB,CAAC,gBAAA2gD,YAAD,CAAzB,CAFK,EAGL,QAAA1gD,WAAA,CAAYD,UAAZ,CAAuB,OAAvB,EAAgC,gBAAA0hD,YAAhC,CAHK,CAMW;;;;+EAAXD,W,EAAW;AAAA,kBALhB,SAAAx5D,YAKgB,EALJ,uBAKI,EALJ,qBAKI;AAAA,O;AALJ,K;;;;;2BAKPw5D,W,EAAW;cAPvB,OAAAv5D,QAOuB;eAPd;AACNC,iBAAO,EAAE,CACL,SAAAF,YADK,EAEL,UAAA8X,aAAA,CAAcC,UAAd,CAAyB,CAAC,gBAAA2gD,YAAD,CAAzB,CAFK,EAGL,QAAA1gD,WAAA,CAAYD,UAAZ,CAAuB,OAAvB,EAAgC,gBAAA0hD,YAAhC,CAHK;AADH,S;AAOc,Q;;;;;;;;;;;;;;;;;;;;;;ACdxB;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAUa,YAAAC,iBAAA,GAA+B;AACxCvhD,WAAK,EAAE,UAAAC,YAAA,CAAaC,KAAb,EADiC;AAExC4pC,WAAK,EAAE,UAAA7pC,YAAA,CAAaC,KAAb,EAFiC;AAGxCnF,UAAI,EAAE,UAAAkF,YAAA,CAAaC,KAAb,EAHkC;AAIxCshD,UAAI,EAAE,UAAAvhD,YAAA,CAAaC,KAAb,EAJkC;AAKxCpM,UAAI,EAAE,UAAAmM,YAAA,CAAaC,KAAb;AALkC,KAA/B;AAQA,YAAAohD,YAAA,GAAe,QAAA9gD,aAAA,iBAAc,QAAA+gD,iBAAd,4BACrB,gBAAAzsC,mBAAA,CAAoBpU,GADC,sBAErB,gBAAAuU,sBAAA,CAAuBvU,GAFF,sBAIrB,gBAAAyU,uBAAA,CAAwBzU,GAJH,sBAKrB,gBAAA2U,kBAAA,CAAmB3U,GALE,sBAMrB,gBAAA6U,eAAA,CAAgB7U,GANK,sBAOrB,gBAAA+U,mBAAA,CAAoB/U,GAPC,GAAf;;;;;;;;;;;;;;;;;;;;ACyBA,YAAAogD,0CAAA,GAA6C,UAACtxC,OAAD;AAAA,aAA2D;AACjHjiB,cAAM,EAAEiiB,OAAO,CAACjiB,MADiG;AAEjHI,gBAAQ,EAAE6hB,OAAO,CAAC7hB,QAF+F;AAGjHslB,gBAAQ,EAAEzD,OAAO,CAACyD,QAH+F;AAIjHwK,gBAAQ,EAAEjO,OAAO,CAACwD,SAJ+F;AAKjHE,oBAAY,EAAE1D,OAAO,CAAC0D,YAL2F;AAMjH0tC,qBAAa,EAAEpxC,OAAO,CAACoxC,aAN0F;;AAOjH;AACAztC,oBAAY,EAAE3D,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE2D,YAR0F;AASjHC,yBAAiB,EAAE5D,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE4D,iBATqF;AAUjHC,2BAAmB,EAAE7D,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE6D,mBAVmF;AAWjHC,wBAAgB,EAAE9D,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE8D,gBAXsF;AAYjHC,wBAAgB,EAAE/D,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE+D,gBAZsF;AAajHC,yBAAiB,EAAEhE,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEgE,iBAbqF;AAcjHE,uBAAe,EAAElE,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEkE,eAduF;AAejH5C,gBAAQ,EAAEtB,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEsB,QAf8F;AAgBjH6C,cAAM,EAAEnE,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEmE;AAhBgG,OAA3D;AAAA,KAA7C;;AAmBA,YAAAytC,8CAAA,GAAiD,UAAC5xC,OAAD;AAAA,aAA2D;AACrHjiB,cAAM,EAAEiiB,OAAO,CAACjiB,MADqG;AAErHI,gBAAQ,EAAE6hB,OAAO,CAAC7hB,QAFmG;AAGrHslB,gBAAQ,EAAEzD,OAAO,CAACyD,QAHmG;AAIrHsH,gBAAQ,EAAE/K,OAAO,CAACwD,SAJmG;AAKrHE,oBAAY,EAAE1D,OAAO,CAAC0D;AAL+F,OAA3D;AAAA,KAAjD;;;;;;;;;;;;;;;;;;;;;AC9Db;AAAA;AAAA;;AAEa,YAAAuuC,aAAA,GAAgB,UAAC70D,IAAD;AAAA,aAAkB,IAAI,UAAAkR,MAAJ,CAAW;AAAClR,YAAI,EAAJA;AAAD,OAAX,CAAlB;AAAA,KAAhB;AAEb;;;;;AAGa,YAAA8zD,sBAAA,GAAyB,UAACnzD,MAAD,EAAoB;AACtD,aAAOA,MAAM,CAACE,QAAP,CAAgB;AAAEJ,eAAO,EAAE;AAAX,OAAhB,CAAP;AACH,KAFY;AAIb;;;;;;AAIa,YAAAszD,eAAA,GAAkB,UAACpzD,MAAD,EAAoB;AAC/C,UAAIm0D,OAAO,GAAGn0D,MAAM,CAACE,QAAP,CAAgB;AAAEwwB,YAAI,EAAE;AAAR,OAAhB,CAAd;;AACA,UAAIyjC,OAAO,CAAC3hC,WAAR,IAAuB,CAA3B,EAA8B;AAC1B2hC,eAAO,GAAGA,OAAO,CAACl0D,QAAR,CAAiB;AAAEkE,iBAAO,EAAE;AAAX,SAAjB,CAAV;AACH;;AACD,aAAOgwD,OAAP;AACH,KANY;;AAQA,YAAAC,qBAAA,GAAwB,UAACpiC,IAAD,EAAqC;;;AAAA,aAAAA,IAAI,GAAI;AAC9EzvB,aAAK,EAAEyvB,IAAI,CAAC1gB,EADkE;AAE9EyP,oBAAY,EAAEiR,IAAI,CAAChE,UAF2D;AAG9E1iB,eAAO,YAAK0mB,IAAI,CAAChE,UAAV,eAAyB,MAAAgE,IAAI,CAACzH,KAAL,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAEnvB,IAArC;AAHuE,OAAJ,GAIzEkG,SAJqE;AAI5D,KAJD;;;;;;;;;;;;;;;;;;;;;;;;;ACzBb;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACFA;AAAA;AAAA;;AAIA;AAAA;AAAA;AAGA;;;;;;AAIa,YAAA+yD,qBAAA,GAAwB,UAAIC,iBAAJ,EACIC,iBADJ;AAAA,aAEA,OAAAvlC,aAAA,CAAc,CAC/CslC,iBAAiB,CAACnkD,IAAlB,CAAuB,YAAAjL,GAAA,CAAI,UAAAG,CAAC;AAAA,eAAIA,CAAC,CAACmsD,SAAF,EAAJ;AAAA,OAAL,CAAvB,CAD+C,EAE/C+C,iBAAiB,CAACpkD,IAAlB,CAAuB,YAAAjL,GAAA,CAAI,UAAA6G,CAAC;AAAA,eAAIA,CAAC,SAAD,IAAAA,CAAC,WAAD,GAAC,MAAD,GAAAA,CAAC,CAAExK,MAAP;AAAA,OAAL,CAAvB,CAF+C,CAAd,EAGlC4O,IAHkC,CAG7B,YAAAjL,GAAA,CAAI;AAAA;AAAA,YAAE+rD,SAAF;AAAA,YAAauD,eAAb;;AAAA,eAAkCvD,SAAS,GAAGuD,eAAH,GAAqBlzD,SAAhE;AAAA,OAAJ,CAH6B,CAFA;AAAA,KAAxB;;;;;;;;;;;;;;;;;;;;;ACXb;AAAA;AAAA;;AAIA;AAAA;AAAA;AAEA;;;;;AAGa,YAAAmzD,wBAAA,GAA2B;AAAA,aAAM,YAAAzS,oBAAA,CAAqB0S,SAArB,CAAN;AAAA,KAA3B;AAEb;;;;;AAGa,YAAAC,eAAA,GAAkB;AAAA,aAAS,YAAA1uD,MAAA,CAAU,UAAAe,CAAC;AAAA,eAAI,CAAC,CAACA,CAAN;AAAA,OAAX,CAAT;AAAA,KAAlB;;;;;;;;;;;;;;;;;;;;;ACdb;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;QAKa4tD,a;;;;AAHb;;YAGaA;;;;yBAAAA,a;AAAa,O;AAAA,gBAFf,CAAC,SAAAt6D,YAAD,CAEe;;;;+EAAbs6D,a,EAAa;AAAA,kBAFd,SAAAt6D,YAEc;AAAA,O;AAFF,K;;;;;2BAEXs6D,a,EAAa;cAHzB,OAAAr6D,QAGyB;eAHhB;AACRC,iBAAO,EAAE,CAAC,SAAAF,YAAD;AADD,S;AAGgB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;ACN1B;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACbA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;ACSQ;AAAqD;AAAQ;;;;;AAAR;AAAA;;;;;;AAW7C;;;;;;AACA;AAAsC;AAAsC;;;;;AAAtC;AAAA;;;;;;;;AAT9C;AACI;AACI;AAAA;AAAA;AAAA;AAAA,oCAAyB,IAAzB,GAAgC,MAAH,QAAG,CAAH,OAAG,CAAhC;AAA6B,SAA7B,EAA8C,UAA9C,EAA8C;AAAA;AAAA;AAAA;AAAA,oCAClB,IADkB,GACX,MAAH,QAAG,CAAH,OAAG,CADW;AACd,SADhC;AAKA;AACA;AACA;AACJ;AACJ;;;;;AAPQ;AAAA,uDAAkC,QAAlC,EAAkC,cAAlC;AAGA;AAAA;AACiB;AAAA;AACE;AAAA;;;;QDqBtBu6D,sB;AAZb;AAAA;;AAaI;AACgB,aAAAC,KAAA,GAAQ,SAAR;AAKhB;;AACiB,aAAArzD,KAAA,GAAQ,IAAI,OAAAk9C,YAAJ,EAAR;AACjB;;AACgB,aAAAoW,mBAAA,GAAgC,IAAhC;AAET,aAAA11D,IAAA,GAAe,UAAAyJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAAnC,CAxBX,CA0BI;;AACA;;AACO,aAAAjG,MAAA,GAAS,CAAT;AACP;;AACO,aAAAiyD,UAAA,GAAa,CAAC,MAAd;AACP;;AACO,aAAAC,UAAA,GAAa,MAAb;AACP;;AACO,aAAAC,SAAA,GAA0B,EAA1B;AACP;;AACO,aAAAC,UAAA,GAAa,UAAArsD,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB0B,UAApB,CAA+B,WAA/B,CAAb;AACP;;AACO,aAAAy0D,YAAA,GAAe,EAAf;AAKP;;AACQ,aAAAC,UAAA,GAAa,KAAb;AACR;;AACQ,aAAAC,YAAA,GAAe,WAAf;AA+LX;;;;mCAvLkB;AACX,eAAKC,aAAL;AACA,eAAKC,qBAAL;AACH;;;oCAEkBz4D,O,EAAsB;AACrC,cAAIA,OAAO,CAACklB,OAAZ,EAAqB;AACjB,iBAAKwzC,aAAL;AACH;;AACD,cAAI14D,OAAO,CAAC24D,QAAZ,EAAsB;AAClB,iBAAKH,aAAL;AACH;AACJ;AAED;;;;gCACextD,I,EAAkB;AAC7B,eAAK1I,IAAL,GAAY0I,IAAI,CAACxF,KAAjB;;AACA,cAAI,KAAKsnD,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAe,KAAKxqD,IAApB;AACH;;AACD,eAAKk2D,aAAL;AACH;AAED;;;;;;qCAGiB;AAEb,cAAI,CAAC,KAAKl2D,IAAV,EAAgB;AACZ;AACH;;AACD,cAAMgnB,GAAG,GAAG,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB8J,YAApB,CAAiC,OAAjC,CAAZ;AACA,cAAMwwB,KAAK,GAAG,IAAI,UAAAhpB,MAAJ,CAAW;AAAClR,gBAAI,EAAE,KAAKA;AAAZ,WAAX,CAAd;AACA,cAAMA,IAAI,GAAGk6B,KAAK,CAACxwB,YAAN,CAAmB,OAAnB,CAAb;;AACA,cAAI1J,IAAI,CAAC2jB,KAAT,EAAgB;AACZ,gBAAM2yC,UAAU,GAAGt2D,IAAI,CAACk4B,QAAL,CAAclR,GAAd,EAAmB,QAAnB,EAA6B,QAA7B,CAAnB;;AACA,gBAAI,KAAKtjB,MAAL,KAAgB4yD,UAApB,EAAgC;AAC5B,mBAAK5yD,MAAL,GAAc4yD,UAAd;AACA,mBAAKl0D,KAAL,CAAWs+C,IAAX,CAAgB,KAAKh9C,MAArB;AACH;;AACD,iBAAKwyD,aAAL;AACH;AACJ;AAED;;;;;;wCAGoB;AAChB,cAAI,KAAKtzC,OAAT,EAAkB;AACd;AACA,gBAAI,KAAKA,OAAL,CAAajT,IAAjB,EAAuB;AACnB,kBAAMuqB,KAAK,GAAG,IAAI,UAAAhpB,MAAJ,CAAW;AAAClR,oBAAI,EAAE,KAAK4iB,OAAL,CAAajT;AAApB,eAAX,CAAd;AACA,mBAAKA,IAAL,GAAYuqB,KAAK,CAACxwB,YAAN,CAAmB,KAAnB,CAAZ;AAAsC;AACtC,kBAAM6sD,KAAK,GAAG,UAAA9sD,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB8J,YAApB,CAAiC,OAAjC,CAAd;AACA,kBAAM1J,IAAI,GAAG,KAAK2P,IAAL,CAAUjG,YAAV,CAAuB,OAAvB,CAAb;AACA,mBAAKisD,UAAL,GAAkB31D,IAAI,CAACk4B,QAAL,CAAcq+B,KAAd,EAAqB,QAArB,EAA+B,QAA/B,CAAlB;AACH,aAND,MAMO,IAAI,KAAK5mD,IAAT,EAAe;AAClB,mBAAKA,IAAL,GAAY,IAAZ;AACA,mBAAKgmD,UAAL,GAAkB,CAAC,MAAnB;AACH,aAXa,CAYd;;;AACA,gBAAI,KAAK/yC,OAAL,CAAahT,EAAjB,EAAqB;AACjB,kBAAMsqB,MAAK,GAAG,IAAI,UAAAhpB,MAAJ,CAAW;AAAClR,oBAAI,EAAE,KAAK4iB,OAAL,CAAahT;AAApB,eAAX,CAAd;;AACA,mBAAKA,EAAL,GAAUsqB,MAAK,CAACxwB,YAAN,CAAmB,KAAnB,CAAV;;AACA,kBAAM6sD,MAAK,GAAG,UAAA9sD,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB8J,YAApB,CAAiC,OAAjC,CAAd;;AACA,kBAAM1J,KAAI,GAAG,KAAK4P,EAAL,CAAQlG,YAAR,CAAqB,OAArB,CAAb;;AACA,mBAAKksD,UAAL,GAAkB51D,KAAI,CAACk4B,QAAL,CAAcq+B,MAAd,EAAqB,QAArB,EAA+B,QAA/B,CAAlB;AACH,aAND,MAMO,IAAI,KAAK3mD,EAAT,EAAa;AAChB,mBAAKA,EAAL,GAAU,IAAV;AACA,mBAAKgmD,UAAL,GAAkB,MAAlB;AACH;;AACD,gBAAI,KAAKhzC,OAAL,CAAaqzC,YAAjB,EAA+B;AAC3B,mBAAKA,YAAL,GAAoB,KAAKrzC,OAAL,CAAaqzC,YAAb,IAA6B,WAAjD;AACH;;AACD,gBAAI,KAAKrzC,OAAL,CAAaozC,UAAjB,EAA6B;AACzB,mBAAKA,UAAL,GAAkB,KAAKpzC,OAAL,CAAaozC,UAAb,IAA2B,KAA7C;AACA,mBAAKG,qBAAL;AACH,aA7Ba,CA8Bd;;;AACA,iBAAKD,aAAL;AACH;AACJ;AAED;;;;;;wCAGqB;AACjB,cAAI,CAAC,KAAKl2D,IAAV,EAAgB;AACZ;AACH;;AACD,cAAMA,IAAI,GAAG,UAAAyJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoBiB,QAApB,CAA6B;AAAEy4B,kBAAM,EAAG,KAAK51B;AAAhB,WAA7B,CAAb;AACA,cAAMmnC,MAAM,GAAG,IAAI,UAAA35B,MAAJ,CAAW;AAAClR,gBAAI,EAAE,KAAKA;AAAZ,WAAX,CAAf;AACA,cAAIE,KAAK,GAAGF,IAAI,CAACY,QAAL,CAAc;AAAEuD,eAAG,EAAE;AAAP,WAAd,EAA0BvD,QAA1B,CAAmC;AAAEkE,mBAAO,EAAE;AAAX,WAAnC,EAAmD2M,aAAnD,CAAiE;AAAE+nB,iBAAK,EAAE;AAAT,WAAjE,CAAZ;AACA,cAAMg9B,IAAI,GAAG,IAAI,UAAAtlD,MAAJ,CAAW;AAAClR,gBAAI,EAAEE,KAAK,CAACyJ;AAAb,WAAX,CAAb;AACA,cAAMujB,GAAG,GAAGspC,IAAI,CAAC31D,QAAL,CAAc;AAAE24B,iBAAK,EAAE;AAAT,WAAd,EAA4BvJ,UAA5B,CAAuC,OAAvC,EAAgDpvB,QAAhD,CAAyD;AAAEwwB,gBAAI,EAAE;AAAR,WAAzD,EAAsEpB,UAAtE,CAAiF,MAAjF,CAAZ;AACA,eAAK4lC,SAAL,GAAiB,EAAjB;;AACA,iBAAO31D,KAAK,CAACo4B,YAAN,CAAmBpL,GAAnB,KAA2BhtB,KAAK,CAACq9B,UAAN,CAAiBrQ,GAAjB,EAAsB,KAAtB,CAAlC,EAAgE;AAC5D,iBAAK2oC,SAAL,CAAehuD,IAAf,CAAoB;AAChB3E,mBAAK,EAAEhD,KAAK,CAACyJ,EADG;AAEhBsC,qBAAO,EAAE/L,KAAK,CAACoB,UAAN,CAAiB,GAAjB,CAFO;AAGhBupC,oBAAM,EAAG,KAAK6qB,mBAAL,IAA4B7qB,MAAM,CAACtN,UAAP,CAAkBr9B,KAAlB,EAAyB,KAAzB,CAHrB;AAIhBu2D,uBAAS,EAAE,CAACz2D,IAAI,CAACu9B,UAAL,CAAgBr9B,KAAhB,EAAuB,OAAvB,CAJI;AAKhB6H,mBAAK,EAAE,KAAKsuD,QAAL,GAAgB,KAAKA,QAAL,CAAcn2D,KAAK,CAACoB,UAAN,CAAiB,YAAjB,CAAd,KAAiD,CAAjE,GAAqE,CAL5D;AAMhBs5B,sBAAQ,EAAE,CAAC,KAAKjrB,IAAL,GAAYzP,KAAK,CAACo4B,YAAN,CAAmB,KAAK3oB,IAAxB,EAA8B,KAA9B,CAAZ,GAAmD,KAApD,MAA+D,KAAKC,EAAL,GAAU1P,KAAK,CAACq4B,WAAN,CAAkB,KAAK3oB,EAAvB,EAA2B,KAA3B,CAAV,GAA8C,KAA7G,CANM;AAOhB2mD,mBAAK,EAAE,UAAA9sD,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB29B,UAApB,CAA+Br9B,KAA/B,EAAsC,KAAtC;AAPS,aAApB;AASAA,iBAAK,GAAGA,KAAK,CAACW,QAAN,CAAe;AAAEwwB,kBAAI,EAAG;AAAT,aAAf,CAAR;AACH;;AACD,eAAKykC,UAAL,GAAkB91D,IAAI,CAACsB,UAAL,CAAgB,KAAK20D,YAArB,CAAlB;AACH;AAED;;;;;;gDAGgC;AAC5B,cAAIj2D,IAAI,GAAG,UAAAyJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB8J,YAApB,CAAiC,MAAjC,CAAX;AACA,eAAKqsD,YAAL,GAAoB,EAApB;;AACA,eAAK,IAAI13D,IAAC,GAAG,CAAb,EAAgBA,IAAC,GAAG,CAApB,EAAuBA,IAAC,EAAxB,EAA4B;AACxB,iBAAK03D,YAAL,CAAkBluD,IAAlB,CAAuB7H,IAAI,CAACsB,UAAL,CAAgB,KAAK00D,UAArB,CAAvB;AACAh2D,gBAAI,GAAGA,IAAI,CAACa,QAAL,CAAc;AAAEwwB,kBAAI,EAAG;AAAT,aAAd,CAAP;AACH;AACJ;AAED;;;;;;;;oCAKmBnuB,K,EAAa;AAAA;;AAC5B,cAAI,KAAKwzD,aAAT,EAAwB;AACpB96D,wBAAY,CAAC,KAAK86D,aAAN,CAAZ;AACH;;AACD,eAAKA,aAAL,GAA0Bv6D,UAAU,CAAC,YAAM;AACvC,gBAAMw6D,UAAU,GAAG,QAAI,CAACjzD,MAAL,GAAcR,KAAjC;AACA,gBAAM8jB,GAAG,GAAG,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAZ;AACA,gBAAMI,IAAI,GAAGgnB,GAAG,CAACnmB,QAAJ,CAAa;AAAEy4B,oBAAM,EAAGq9B,UAAX;AAAuBtlC,kBAAI,EAAErK,GAAG,CAACw2B,SAAJ,KAAkB,CAAlB,GAAsB,CAAtB,GAA0B;AAAvD,aAAb,CAAb,CAHuC,CAGgD;;AACvF,gBAAI,QAAI,CAAC7tC,IAAL,IAAa3P,IAAI,CAACs4B,YAAL,CAAkB,QAAI,CAAC3oB,IAAvB,EAA6B,OAA7B,CAAjB,EAAwD;AAAE;AAAS;;AACnE,gBAAI,QAAI,CAACC,EAAL,IAAW5P,IAAI,CAACu4B,WAAL,CAAiB,QAAI,CAAC3oB,EAAtB,EAA0B,OAA1B,CAAf,EAAmD;AAAE;AAAS;;AAC9D,oBAAI,CAAClM,MAAL,GAAcizD,UAAd;;AACA,oBAAI,CAACv0D,KAAL,CAAWs+C,IAAX,CAAgB,QAAI,CAACh9C,MAArB;;AACA,oBAAI,CAACwyD,aAAL;;AACA,oBAAI,CAACQ,aAAL,GAAqB,IAArB;AACH,WAVmC,EAUjC,GAViC,CAApC;AAWH;AAED;;;;;;gCAGe;AACX,cAAM12D,IAAI,GAAG,IAAI,UAAAkR,MAAJ,CAAW;AAAClR,gBAAI,EAAE,KAAKA;AAAZ,WAAX,CAAb;AACA,cAAM0D,MAAM,GAAG,KAAKA,MAApB;AACA,eAAKA,MAAL,GAAc,UAAA+F,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoBs4B,QAApB,CAA6Bl4B,IAA7B,EAAmC,QAAnC,EAA6C,QAA7C,CAAd;;AACA,cAAI0D,MAAM,KAAK,KAAKA,MAApB,EAA4B;AACxB,iBAAKwyD,aAAL;AACH;;AACD,eAAK9zD,KAAL,CAAWs+C,IAAX,CAAgB,KAAKh9C,MAArB;AACH;AAED;;;;;;;mCAIkBR,K,EAAe;AAC7B,eAAKlD,IAAL,GAAYkD,KAAZ;AACA,eAAK0zD,UAAL;AACA,eAAKV,aAAL;AACH;AAED;;;;;;;yCAIwBl6D,E,EAAuB;AAC3C,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;AAED;;;;;;;0CAIyBA,E,EAAuB;AAC5C,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;;;;;;AA5OL;;;uBAYaw5D,sB;AAAsB,K;;;YAAtBA,sB;AAAsB,sC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,uCARpB,CACP;AACIjiB,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAM4K,sBAAN;AAAA,SAAX,CAFjB;AAGI3K,aAAK,EAAE;AAHX,OADO,CAQoB,GAF9B,uBAE8B,C;AAF9B,e;AAAA,a;AAAA,sa;AAAA;AAAA;AC1CL;AACI;AACI;AAAoE;AAAA,mBAAS,IAAAgM,WAAA,CAAY,IAAC,CAAb,CAAT;AAAwB,WAAxB,EAAyB,UAAzB,EAAyB;AAAA,mBAAa,IAAAA,WAAA,CAAY,IAAC,CAAb,CAAb;AAA4B,WAArD;AAChE;AACJ;AACA;AAAmB;AAAA,mBAAY,IAAA/2D,KAAA,EAAZ;AAAmB,WAAnB;AAAqB;AAAc;AACtD;AAAgE;AAAA,mBAAS,IAAA+2D,WAAA,CAAY,CAAZ,CAAT;AAAuB,WAAvB,EAAwB,UAAxB,EAAwB;AAAA,mBAAa,IAAAA,WAAA,CAAY,CAAZ,CAAb;AAA2B,WAAnD;AAC5D;AACJ;AACJ;AACA;AACI;AACJ;AACA;AACI;AAYJ;AACJ;;;;AA3BK;AAE+B;AAAA;AAGY;AAAA;AAChB;AAAA;AAKL;AAAA;AAGA;AAAA;;;;;;;;;2BD8BdrB,sB,EAAsB;cAZlC,OAAA3T,SAYkC;eAZxB;AACPjlD,kBAAQ,EAAE,iBADH;AAEPklD,qBAAW,EAAE,kCAFN;AAGPC,mBAAS,EAAE,CAAC,kCAAD,CAHJ;AAIPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAM4K,sBAAN;AAAA,aAAX,CAFjB;AAGI3K,iBAAK,EAAE;AAHX,WADO;AAJJ,S;AAYwB,Q;;gBAE9B,OAAAvrD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;gBAEA,OAAA1iD;;;;;;;;;;;;;;;;;;;;;;;;AEtDL;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;AAsCgB;AACI;AAMQ;AAAA;AAAA;AAAA,iBAAS,OAAA2R,MAAA,aAAT;AAA4B,SAA5B;AAA8B;AAAc;AACxD;;;;;AARK;AAGO;AAAA;AACA,sEAA6C,WAA7C,EAA6C,uBAA7C;AAFA;AAK8B;AAAA;;;;;;;;AAG9C;AAKI;AAAA;AAAA;AAAA,iBAAS,OAAAmzB,KAAA,aAAT;AAA2B,SAA3B;AACA;AACJ;;;;;AAHI;AAEK;AAAA;;;;AA5CrB,QAAY0yB,SAAZ;;AAAA,eAAYA,SAAZ,EAAqB;AACjB;AACA;AACA;AACA;AACH,KALD,EAAYA,SAAS,GAAT,QAAAA,SAAA,aAAAA,SAAA,GAAS,EAAT,CAAZ;;AAOA,QAAYC,kBAAZ;;AAAA,eAAYA,kBAAZ,EAA8B;AAC1B;;;AAGA;AAEA;;;;AAGA;AACH,KAVD,EAAYA,kBAAkB,GAAlB,QAAAA,kBAAA,aAAAA,kBAAA,GAAkB,EAAlB,CAAZ;;QA2CaC,oB;AA/Bb;AAAA;;AAkCW,aAAAC,IAAA,GAAkBH,SAAS,CAACI,OAA5B;AAGA,aAAA9yB,KAAA,GAAQ,IAAI,OAAAkb,YAAJ,EAAR;AAGA,aAAAruC,MAAA,GAAS,IAAI,OAAAquC,YAAJ,EAAT;AASA,aAAA6X,SAAA,GAAY,IAAZ;AAGA,aAAAlrD,OAAA,GAA8B8qD,kBAAkB,CAACK,EAAjD;AAEA,aAAAC,QAAA,GAAmB,gCAAnB;AACA,aAAAC,aAAA,GAAwB,OAAxB;AACA,aAAAC,SAAA,GAAoB,mBAApB;AAoCV;;;;mCAlCkB;AACX,eAAKC,aAAL;AACH;;;oCAEkB95D,O,EAAwB;AACvC,cAAIA,OAAO,CAACu5D,IAAZ,EAAkB;AACd,iBAAKO,aAAL;AACH;AACJ;;;wCAEuB;AACpB,eAAKH,QAAL,GAAgB,gCAAhB;AACA,eAAKE,SAAL,GAAiB,mBAAjB;;AACA,kBAAQ,KAAKN,IAAb;AACI,iBAAKH,SAAS,CAACI,OAAf;AACI,mBAAKI,aAAL,GAAqB,OAArB;AACA;;AACJ,iBAAKR,SAAS,CAACW,SAAf;AACI,mBAAKH,aAAL,GAAqB,WAArB;AACA,mBAAKC,SAAL,GAAiB,6BAAjB;AACA;;AACJ,iBAAKT,SAAS,CAACY,aAAf;AACI,mBAAKL,QAAL,GAAgB,8BAAhB;AACA,mBAAKC,aAAL,GAAqB,gBAArB;AACA;;AACJ,iBAAKR,SAAS,CAAC16D,KAAf;AACI,mBAAKi7D,QAAL,GAAgB,2BAAhB;AACA,mBAAKC,aAAL,GAAqB,OAArB;AACA;;AACJ;AACI,mBAAKA,aAAL,GAAqB,OAArB;AAjBR;AAmBH;;;;;;AA1FL;;;uBA+BaN,oB;AAAoB,K;;;YAApBA,oB;AAAoB,uC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA;AAAA,O;AAAA,yC;AAAA,c;AAAA,c;AAAA,0b;AAAA;AAAA;AA5BzB;AACI;AACI;AACJ;AACA;AACI;;AACA;AASJ;AACA;AAQJ;;;;AAxBK;AACI;AAAA;AACI;AAAA;AAGe;AAAA;AAAqC;AACP;AAAA;AAWlD;AAAA;;;;;;;;;;2BAWHA,oB,EAAoB;cA/BhC,OAAAnV,SA+BgC;eA/BtB;AACPjlD,kBAAQ,EAAE,kBADH;AAEPuxD,kBAAQ,yyCAFD;AA6BPpM,mBAAS,EAAE,CAAC,+BAAD;AA7BJ,S;AA+BsB,Q;;gBAE5B,OAAAziD;;;gBAGA,OAAA0iD;;;gBAGA,OAAAA;;;gBAGA,OAAA1iD;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AChFL;AAAA;AAAA;;AAeA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMY;AAAyF;AAAA;AAAA;AAAA;AAAA;AACrF;AACJ;;;;;;AA0BY;AACI;AACJ;;;;;;;;AACA;AACI;AAAA;AAAA;AAAA;AAAA;;AAEuC;;;;;AAAvC;;;;;;;;AACJ;AACK;AAAA;AAAA;AAAA;AAAA;AACD;AAEJ;;;;;AAJK;AAEiB;AAAA;;;;;;AAK9B;;;;;;AAGI;;;;AACU;;;;;;;;AACV;AACU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgG;AACtG;AAAgF;AAAK;AACzF;;;;;;AAF6C;AAA6D;AAAA;AACxE;AAAA;;;;;;AAGtC;;;;;;;;AASQ;AAGI;AAAA;AAAA,iBAASusD,MAAM,CAACr8C,eAAP,EAAT;AAAiC,SAAjC;AAGA;AAKI;AAAA;AAAA;AAAA;AAAA;AAAA,WAAoC,OAApC,EAAoC;AAAA;AAAA,iBAC3Bq8C,MAAM,CAACr8C,eAAP,EAD2B;AACH,SADjC;AAEA;AACJ;AACJ;;;;;AAbI;AADA,uDAA4B,OAA5B,EAA4B,gBAA5B;AAQI;AAAA;AAFA,iFAAsD,UAAtD,EAAsD,mBAAtD,EAAsD,SAAtD,EAAsD,mBAAtD;AAMA;AAAA;;;;;;;;AAIZ;AACI;AAEI;AAAA;AAAA;AAAA;AAAA;AAGA;AACJ;AACA;AAEI;AAAA;AAAA;AAAA,iCAAiB,KAAjB;AAAsB,SAAtB;AAGA;AACJ;AACJ;;;;;AAXQ;AAAA;AAOA;AAAA;;;;;;AAOhB;AAAqC;AAAgB;;;;;AAAhB;AAAA;;;;QAMpCmoD,mC;;;;;AA6FT,mDAAwCt6B,OAAxC,EAA4D;AAAA;;AAAA;;AACxD;AADoC,iBAAAA,OAAA,GAAAA,OAAA;AA5DxC,iBAAAu6B,cAAA,GAAiB,IAAI,OAAAtY,YAAJ,EAAjB;AAGA,iBAAAuY,cAAA,GAAiB,IAAI,OAAAvY,YAAJ,EAAjB;AAGA,iBAAAwY,YAAA,GAAmC,IAAI,OAAAxY,YAAJ,EAAnC;AAGA,iBAAAyY,cAAA,GAAqC,IAAI,OAAAzY,YAAJ,EAArC;AAEA;;;;AAIA,iBAAA0Y,kBAAA,GAAqB,KAArB;AAKgB,iBAAAC,WAAA,GAAuB,IAAvB;AAcR,iBAAAC,wBAAA,GAA2B,IAAI,OAAAz8D,eAAJ,CAAoB,KAApB,CAA3B;AAER,iBAAA08D,kBAAA,GAAqB,CAAC,WAAAC,KAAD,EAAQ,WAAAC,KAAR,CAArB;AAEO,iBAAAC,iBAAA,GAAiC,IAAI,QAAA39B,WAAJ,EAAjC;AAEA,iBAAA49B,OAAA,GAAU,KAAV;AACA,iBAAAC,gBAAA,GAAmB,KAAnB;AAEA,iBAAAC,mBAAA,GAAsB,IAAI,OAAAh9D,eAAJ,CAAyC,EAAzC,CAAtB;AACA,iBAAAi9D,2BAAA,GAA8B,IAAI,OAAAj9D,eAAJ,CAAyC,EAAzC,CAA9B;AAEP;;AACO,iBAAA+mD,WAAA,GAAc,IAAI,OAAA/mD,eAAJ,CAAyC,EAAzC,CAAd;AAOC,iBAAAyH,KAAA,GAAQ,IAAI,OAAAzH,eAAJ,CAAyC,EAAzC,CAAR;AAED,iBAAAk9D,UAAA,GAAsB,KAAtB;AAEA,iBAAAC,QAAA,GAAoB,KAApB;;AAiSC,iBAAAC,WAAA,GAAc,UAACnrD,KAAD,EAAiB;AACnC,cAAI,SAAKlT,OAAL,KAAiB,IAArB,EAA2B;AACzB;AACD;AACD;;;;;AAGA,cAAI,SAAKA,OAAL,CAAas+D,SAAb,IAA0BprD,KAAK,CAACyE,MAAN,CAAarU,OAAb,CAAqB,yBAArB,MAAoD,IAA9E,IAAsF,CAAC4P,KAAK,CAACsgD,UAAN,CAAiB+K,SAAjB,CAA2BC,QAA3B,CAAoC,iCAApC,CAA3F,EAAmK;AAC/J,qBAAKC,OAAL,CAAa,KAAb;;AACA,qBAAKz+D,OAAL,CAAa,UAAb,EAAyBqD,aAAzB,CAAuCq7D,IAAvC;AACH;AACF,SAXK;;AA7RJ,YAAI,SAAK77B,OAAT,EAAkB;AACd,mBAAKA,OAAL,CAAa87B,aAAb;AACH;;AAJuD;AAK3D;;;;sCAgBoBC,K,EAAc;AAC/B,iBAAOA,KAAK,KAAK,UAAV,GAAuB,oBAAvB,GAA8C,qBAArD;AACH;;;mCAEU;AAAA;;AACP,eAAKr7D,YAAL,CAAkB,qBAAlB,EAAyC,OAAA4xB,aAAA,CAAc,CACnD,KAAK/M,OAD8C,EAEnD,KAAK0H,eAF8C,EAGnD,KAAK4tC,wBAH8C,CAAd,EAKpCpnD,IALoC,CAMjC,YAAAjL,GAAA,CAAI,iBAAoD;AAAA;AAAA,gBAAlD+c,OAAkD;AAAA,gBAAzC0H,eAAyC;AAAA,gBAAxB0tC,kBAAwB;;AACpD,oBAAI,CAACY,QAAL,GAAgB,CAAC,CAACtuC,eAAe,CAACpoB,MAAlC;AACA,mBAAO0gB,OAAO,CAAC/c,GAAR,CAAY,UAAA0kB,MAAM,EAAI;AACzB,kBAAME,QAAQ,GAAG,CAAC,CAACH,eAAe,CAAC9mB,IAAhB,CAAqB,UAAA+R,CAAC;AAAA,uBAAIA,CAAC,CAACrS,KAAF,KAAYqnB,MAAM,CAACrnB,KAAvB;AAAA,eAAtB,CAAnB;AACA,kBAAIm2D,OAAO,GAAG,IAAd;;AACA,kBAAIrB,kBAAJ,EAAwB;AACpB;AACA,oBAAMsB,mBAAmB,GAAGhvC,eAAe,CAAC9mB,IAAhB,CAAqB,UAAA+R,CAAC;AAAA,yBAAIA,CAAC,CAACsS,WAAF,IAAiBtS,CAAC,CAAC0U,OAAF,KAAcM,MAAM,CAACN,OAA1C;AAAA,iBAAtB,CAA5B,CAFoB,CAIpB;;AACAovC,uBAAO,GACH/uC,eAAe,CAACpoB,MAAhB,KAA2B,CAA3B,KACCo3D,mBAAmB,GAAGA,mBAAmB,CAACrvC,OAApB,KAAgCM,MAAM,CAACN,OAA1C,GAAoD,KADxE,CADJ;AAGA,wBAAI,CAAC0uC,UAAL,GAAkBruC,eAAe,CAACpoB,MAAhB,KAA2B,CAA7C;AACH;;AAED,qBAAO,gCACAqoB,MADA,GACM;AACT8uC,uBAAO,EAAPA,OADS;AAET5uC,wBAAQ,EAARA;AAFS,eADN,CAAP;AAKH,aAnBM,CAAP;AAoBH,WAtBD,CANiC,EA6BnCxsB,SA7BmC,CA6BzB,UAAAkQ,IAAI,EAAI;;;AAChB,gBAAMyU,OAAO,GAAGzU,IAAI,CAACjG,IAAL,CAAU,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAChC,kBAAID,CAAC,CAAC8hB,OAAF,KAAc7hB,CAAC,CAAC6hB,OAApB,EAA6B;AACzB,uBAAO7hB,CAAC,CAAC6D,OAAF,GAAY9D,CAAC,CAAC8D,OAAd,GAAwB,CAAC,CAAzB,GAA6B,CAApC;AACH;;AACD,qBAAO7D,CAAC,CAAC6hB,OAAF,GAAY9hB,CAAC,CAAC8hB,OAAd,GAAwB,CAAC,CAAzB,GAA6B,CAApC;AACH,aALe,CAAhB;;AAMA,oBAAI,CAACwuC,mBAAL,CAAyBtqD,IAAzB,CAA8ByU,OAA9B;;AACA,oBAAI,CAAC81C,2BAAL,CAAiCvqD,IAAjC,CAAsC,QAAI,CAACorD,8BAAL,CAAoC,CAAD,KAAC,QAAI,CAACjB,iBAAL,CAAuBp1D,KAAvB,MAA4B,IAA5B,IAA4B,aAA5B,GAA4B,MAA5B,GAA4B,GAAEo5C,IAAF,EAAhE,CAAtC;AACH,WAtCoC,CAAzC;AAuCA,eAAKv+C,YAAL,CAAkB,0BAAlB,EACI,KAAKu6D,iBAAL,CAAuB18B,YAAvB,CAAoC39B,SAApC,CAA8C,UAAAiF,KAAK,EAAI;AACnD,gBAAI,QAAI,CAAC+0D,WAAL,IAAoB/0D,KAAK,CAAChB,MAA9B,EAAsC;AAClC,sBAAI,CAACw2D,2BAAL,CAAiCvqD,IAAjC,CAAsC,QAAI,CAACorD,8BAAL,CAAoCr2D,KAApC,CAAtC;AACH,aAFD,MAEO;AACH,sBAAI,CAACw1D,2BAAL,CAAiCvqD,IAAjC,CAAsC,QAAI,CAACorD,8BAAL,EAAtC;AACH;AACJ,WAND,CADJ;AAQA,eAAKx7D,YAAL,CAAkB,aAAlB,EAAiC,KAAKusB,eAAL,CAC5BxZ,IAD4B,CACvB,YAAAjL,GAAA,CAAI,UAAAykB,eAAe,EAAI;AACzB;AACA;AACA,gBAAMkvC,YAAY,GAAGlvC,eAAe,CAAC1jB,MAAhB,CAAuB,UAAA2O,CAAC;AAAA,qBAAIA,CAAC,CAACsS,WAAN;AAAA,aAAxB,KAA8C,EAAnE;AACA,mBAAOyC,eAAe,CAAC1jB,MAAhB,CAAuB,UAAA2O,CAAC;AAAA,qBAAIA,CAAC,CAACsS,WAAF,IAAiBtS,CAAC,CAAC4Q,UAAF,IAAgB,CAAEqzC,YAAY,CAACh2D,IAAb,CAAkB,UAAAi2D,CAAC;AAAA,uBAAIA,CAAC,CAACxvC,OAAF,KAAc1U,CAAC,CAAC0U,OAApB;AAAA,eAAnB,CAAvC;AAAA,aAAxB,CAAP;AACH,WALK,CADuB,EAO5BhsB,SAP4B,CAOlB,UAAAkQ,IAAI,EAAI;AACf,oBAAI,CAACq0C,WAAL,CAAiBr0C,IAAjB,CAAsBA,IAAtB;AACH,WAT4B,CAAjC;AAWA,eAAKpQ,YAAL,CAAkB,UAAlB,EAA8B,KAAKusB,eAAL,CACzBxZ,IADyB,CACpB,YAAAjL,GAAA,CAAI,UAAA4kB,QAAQ,EAAI;AAClB;AACA,mBAAOA,QAAP;AACH,WAHK,CADoB,EAKzBxsB,SALyB,CAKf,UAAAkQ,IAAI,EAAI;AACf,oBAAI,CAACjL,KAAL,CAAWiL,IAAX,CAAgBA,IAAhB;AACH,WAPyB,CAA9B,EA3DO,CAoEP;;AACA,eAAKpQ,YAAL,CAAkB,cAAlB,EAAkC,KAAKmF,KAAL,CAC7B4N,IAD6B,CACxB,YAAA6xC,oBAAA,EADwB,EAE7B1kD,SAF6B,CAEnB,UAAAkQ,IAAI,EAAI;AACf,gBAAI,QAAI,CAACq8C,SAAT,EAAoB;AAChB;AACA,kBAAMt0B,MAAM,GAAG,EAAf;AACA/nB,kBAAI,CAAC/P,OAAL,CAAa,UAACsO,CAAD,EAAIrO,CAAJ,EAAU;;;AACnB,oBAAM6E,KAAK,GAAG,MAAH,OAAG,CAAH,EAAG,EAAKwJ,CAAL,CAAd;;AACA,oBAAI,CAAJ,KAAIA,CAAC,CAACqY,IAAF,MAAM,IAAN,IAAM,aAAN,GAAM,MAAN,GAAM,GAAEnM,IAAZ,EAAkB;AACd1V,uBAAK,CAAC+I,OAAN,GAAgBS,CAAC,CAACqY,IAAF,CAAOnM,IAAP,CAAY7c,IAA5B;AACH;;AACDm6B,sBAAM,CAACruB,IAAP,CAAY3E,KAAZ;AACH,eAND;;AAOA,sBAAI,CAACsnD,SAAL,CAAet0B,MAAf;AACH;AACJ,WAf6B,CAAlC;AAiBA3wB,gBAAM,CAACs/B,gBAAP,CAAwB,QAAxB,EAAkC,KAAKg0B,WAAvC,EAAoD,IAApD;AACH;;;yDAEyD;AAAA,cAA3Ba,YAA2B,uEAAJ,EAAI;AACtD;AACA,cAAMC,YAAY,GAAG,KAAKlB,mBAAL,CAAyBv1D,KAAzB,CAA+B0D,MAA/B,CAAsC,UAAAgkB,CAAC,EAAI;AAC5D,gBAAI8uC,YAAY,IAAIA,YAAY,CAACx3D,MAAjC,EAAyC;AACrC,qBAAO0oB,CAAC,CAACX,OAAF,CAAUviB,WAAV,GAAwBtE,OAAxB,CAAgCs2D,YAAY,CAAChyD,WAAb,EAAhC,MAAgE,CAAhE,IAAqEkjB,CAAC,CAAC3e,OAAF,CAAUvE,WAAV,GAAwBtE,OAAxB,CAAgCs2D,YAAY,CAAChyD,WAAb,EAAhC,MAAgE,CAA5I;AACH;;AACD,mBAAOkjB,CAAC,CAACX,OAAF,IAAaW,CAAC,CAAC3e,OAAtB;AACH,WALoB,CAArB,CAFsD,CAQtD;;AACA,cAAM2tD,WAAW,GAAG,KAAKnB,mBAAL,CAAyBv1D,KAAzB,CAA+B0D,MAA/B,CAAsC,UAAAgkB,CAAC,EAAI;;;AAC3D,gBAAI,OAAAA,CAAC,SAAD,IAAAA,CAAC,WAAD,GAAC,MAAD,GAAAA,CAAC,CAAEd,gBAAH,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAE5nB,MAArB,KAA+Bw3D,YAAnC,EAAiD;AAC7C,kBAAMvzD,KAAK,GAAG,OAAAykB,CAAC,CAACd,gBAAF,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEpiB,WAAF,GAAgBtE,OAAhB,CAAwBs2D,YAAY,CAAChyD,WAAb,EAAxB,CAAlB,IAAwE,CAAC,CAAvF,CAD6C,CAE7C;;AACA,qBAAOvB,KAAK,IAAI,CAACwzD,YAAY,CAACn2D,IAAb,CAAkB,UAAA6G,CAAC,EAAI;AACpC,uBAAOA,CAAC,CAACnH,KAAF,KAAY0nB,CAAC,CAAC1nB,KAArB;AACH,eAFgB,CAAjB;AAGH;;AACD,mBAAO,KAAP;AACH,WATmB,CAApB,CATsD,CAoBtD;;AACA,cAAI22D,aAAa,GAAGF,YAAY,CAAC7nC,MAAb,CAAoB8nC,WAApB,EAAiC1xD,IAAjC,CAAsC,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAChE,gBAAID,CAAC,CAAC8hB,OAAF,KAAc7hB,CAAC,CAAC6hB,OAApB,EAA6B;AACzB,qBAAO7hB,CAAC,CAAC6D,OAAF,GAAY9D,CAAC,CAAC8D,OAAd,GAAwB,CAAC,CAAzB,GAA6B,CAApC;AACH;;AACD,mBAAO7D,CAAC,CAAC6hB,OAAF,GAAY9hB,CAAC,CAAC8hB,OAAd,GAAwB,CAAC,CAAzB,GAA6B,CAApC;AACH,WALmB,CAApB,CArBsD,CA4BtD;;AACA,cAAM6vC,QAAQ,GAAGD,aAAa,CAACh0D,GAAd,CAAkB,UAAA+kB,CAAC;AAAA,mBAAIA,CAAC,CAACX,OAAN;AAAA,WAAnB,CAAjB,CA7BsD,CA8BtD;;AACA,cAAM8vC,OAAO,GAAG,KAAKtB,mBAAL,CAAyBv1D,KAAzB,CAA+B0D,MAA/B,CAAsC,UAAAgkB,CAAC,EAAI;AACvD,mBAAO,CAAAA,CAAC,SAAD,IAAAA,CAAC,WAAD,GAAC,MAAD,GAAAA,CAAC,CAAE/C,WAAH,KAAkBiyC,QAAQ,CAAC12D,OAAT,CAAiBwnB,CAAC,CAACX,OAAnB,MAAgC,CAAC,CAA1D;AACH,WAFe,CAAhB,CA/BsD,CAmCtD;AACA;;AACA,cAAMyuC,2BAA2B,GAAGqB,OAAO,CAACjoC,MAAR,CAAe+nC,aAAa,CAACjzD,MAAd,CAAqB,UAAAozD,EAAE;AAAA,mBAAI,CAAC,CAACA,EAAE,CAAClwC,gBAAT;AAAA,WAAvB,CAAf,EAAkE5hB,IAAlE,CAAuE,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACjH,mBAAOA,CAAC,CAAC6hB,OAAF,GAAY9hB,CAAC,CAAC8hB,OAAd,GAAwB,CAAC,CAAzB,GAA6B,CAApC;AACH,WAFmC,CAApC;AAGA,iBAAOyuC,2BAAP;AACH;;;oCAEQ;AACL,eAAKF,gBAAL,GAAwB,KAAxB;AACA,eAAKD,OAAL,GAAe,KAAf;AACH;;;oCAEW76D,O,EAAsB;AAC9B,cAAIA,OAAO,CAACs6D,kBAAZ,EAAgC;AAC5B,iBAAKE,wBAAL,CAA8B/pD,IAA9B,CAAmC,KAAK6pD,kBAAxC;AACH;AACJ;;;mCAEUiC,Q,EAAkB;AACzB,cAAI,KAAKC,aAAT,EAAwB;AACpB,iBAAKrC,cAAL,CAAoBnX,IAApB,CAAyBuZ,QAAzB;AACH;AACJ;;;qCAEY/2D,K,EAAe;AAAA;;AACxB,eAAK0f,OAAL,CAAa9R,IAAb,CACI,YAAA+H,IAAA,CAAK,CAAL,CADJ,EAEI,YAAAhT,GAAA,CAAI,UAAC+c,OAAD;AAAA,mBAAkCA,OAAO,CAACpf,IAAR,CAAa,UAAAonB,CAAC;AAAA,qBAAIA,CAAC,CAAC1nB,KAAF,KAAYA,KAAhB;AAAA,aAAd,CAAlC;AAAA,WAAJ,CAFJ,EAGEjF,SAHF,CAGY,UAAAkQ,IAAI,EAAI;AAChB,gBAAIA,IAAJ,EAAU;AACN,sBAAI,CAACypD,cAAL,CAAoBlX,IAApB,CAAyBvyC,IAAzB;AACH;AACJ,WAPD;AAQH;;;qCAEYjL,K,EAA0B;AACnC,eAAK00D,cAAL,CAAoBlX,IAApB,CAAyBx9C,KAAzB;;AACA,cAAI,KAAKi3D,OAAT,EAAkB;AACd,iBAAKpC,cAAL,CAAoBrX,IAApB;AACH;AAEJ;;;0CAEiB;AACd,eAAKp2B,eAAL,CAAqBnc,IAArB,CAA0B,EAA1B;AACA,eAAK2pD,YAAL,CAAkBpX,IAAlB;AACH;;;uCAEc;AACX;AACA,cAAI,KAAK6X,OAAT,EAAkB;AACd,iBAAKU,OAAL,CAAa,KAAb;AACH;AACJ;;;2CAEkBmB,O,EAAkB;AACjC,eAAKnB,OAAL,CAAamB,OAAb,EAAsB,IAAtB;AACH;;;gCAEOA,O,EAAkBC,S,EAAqB;AAAA;;AAC3C,cAAI,CAACD,OAAD,IAAY,KAAKD,OAArB,EAA8B;AAC1B,iBAAKpC,cAAL,CAAoBrX,IAApB;AACH,WAH0C,CAI3C;;;AACA,cAAI,KAAKuX,WAAL,IAAoBoC,SAApB,IAAiCD,OAArC,EAA8C;AAC1C;AACA,iBAAK5B,gBAAL,GAAwB,IAAxB;AACA,iBAAK75D,OAAL,CAAa,cAAb,EAA6B,YAAM;AAC/B;AACA;AACA,sBAAI,CAACs6D,OAAL,CAAa,IAAb;AACH,aAJD,EAIG,GAJH;AAKH;;AAED,cAAI,KAAKiB,aAAL,IAAsB,CAACG,SAA3B,EAAsC;AAClC;AACA,iBAAKC,cAAL,CAAoBp3D,KAApB,GAA4B,EAA5B;AACA,iBAAKo1D,iBAAL,CAAuB13D,QAAvB,CAAgC,EAAhC;AACA,iBAAKi3D,cAAL,CAAoBnX,IAApB,CAAyB,EAAzB;AACH;;AAED,cAAI,KAAK6X,OAAL,KAAiB6B,OAArB,EAA8B;AAC1B,iBAAK7B,OAAL,GAAe6B,OAAf,CAD0B,CAE1B;;AACA,gBAAI,CAACA,OAAL,EAAc;AACV,mBAAKE,cAAL,CAAoBp3D,KAApB,GAA4B,EAA5B;AACA,mBAAKo1D,iBAAL,CAAuB13D,QAAvB,CAAgC,EAAhC;AACH;;AACD,gBAAI,CAACy5D,SAAL,EAAgB;AACZ,kBAAID,OAAJ,EAAa;AACT,qBAAK5/D,OAAL,CAAa6yD,SAAb;AACH,eAFD,MAEO;AACH,qBAAK7yD,OAAL,CAAa8yD,UAAb,GADG,CAEH;;AACA,qBAAKiN,SAAL;AACH;AACJ;AACJ;AACJ;;;kCAESr3D,K,EAA0BwK,K,EAA0B;AAC1D,eAAKkqD,cAAL,CAAoBlX,IAApB,CAAyBx9C,KAAzB;AACH;;;4BAEGwK,K,EAA0B;AAC1B;AACA,cAAIA,KAAK,CAAClM,KAAV,EAAiB;AACbkM,iBAAK,CAAClM,KAAN,CAAY0B,KAAZ,GAAoB,EAApB;AACH;;AACD,eAAKo1D,iBAAL,CAAuB13D,QAAvB,CAAgC,EAAhC;AACH;;;yCAEgB5E,E,EAAO;AACpB,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;;;0CAEiBA,E,EAAO;AACrB,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;;;yCAEgBw+D,U,EAAmB;AAChC;AACA,eAAK5/B,QAAL,GAAgB4/B,UAAhB;AACH;;;mCAEUz9C,G,EAAoC;AAAA;;iBAAA,CAC3C;;;AACA,qBAAK6F,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAE9R,IAAF,CACR,YAAA+H,IAAA,CAAK,CAAL,CADQ,EAER,YAAAhT,GAAA,CAAI,UAAC+c,OAAD,EAAkC;AAClC,mBAAOA,OAAO,CAAChc,MAAR,CAAe,UAAAgkB,CAAC;AAAA,qBAAI7N,GAAG,GAAG,CAAC,CAACA,GAAG,CAACvZ,IAAJ,CAAS,UAAAi3D,GAAG;AAAA,uBAAI7vC,CAAC,CAAC1nB,KAAF,KAAYu3D,GAAG,CAACv3D,KAApB;AAAA,eAAZ,CAAL,GAA8C,KAArD;AAAA,aAAhB,CAAP;AACH,WAFD,CAFQ,EAKVjF,SALU,CAKA,UAAAkQ,IAAI,EAAI;AAChB,oBAAI,CAACmc,eAAL,CAAqBnc,IAArB,CAA0BA,IAA1B;AACH,WAPW,CAAZ;AAQH;;;sCAcmB;AAChB5I,gBAAM,CAACm1D,mBAAP,CAA2B,QAA3B,EAAqC,KAAK7B,WAA1C,EAAuD,IAAvD;AACD;;;4BAtSe;AACd,iBAAO,KAAKx7B,OAAL,GAAe,KAAKA,OAAL,CAAa6e,OAA5B,GAAsC,KAA7C;AACH;;;4BAEmB;AAChB,cAAI,CAAC,KAAK7e,OAAV,EAAmB;AACf,mBAAO,KAAP;AACH;;AAHe,8BAKW,KAAKA,OALhB;AAAA,cAKRs9B,KALQ,iBAKRA,KALQ;AAAA,cAKDC,OALC,iBAKDA,OALC;AAOhB,iBAAO,KAAK1e,OAAL,GAAgBye,KAAK,IAAIC,OAAzB,GAAoC,KAA3C;AACH;;;;MAhHoD,OAAAn+D,a;;AA1GzD;;;uBA0Gak7D,mC,EAAmC,sC;AAAA,K;;;YAAnCA,mC;AAAmC,wD;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAvGxC;AACI;AAGA;AAAiC;AAAS;AAC1C;AAMI;AACI;AASI;AAAA,mBAAW,IAAAsB,OAAA,CAAQ,IAAR,CAAX;AAAwB,WAAxB,EAAyB,OAAzB,EAAyB;AAAA,mBAChB,IAAA4B,UAAA,qBADgB;AACe,WADxC,EAAyB,sBAAzB,EAAyB;AAAA,mBAKD,IAAAx3D,GAAA,QALC;AAKU,WALnC;AATJ;AAgBA;AACI;AAGA;AAIA;AAKJ;AACJ;AACA;AACA;AAEI;AAEA;;AAIJ;AACA;AACA;AAGI;AAAA,mBAAU,IAAAy3D,kBAAA,CAAmB,IAAnB,CAAV;AAAkC,WAAlC,EAAmC,QAAnC,EAAmC;AAAA,mBACzB,IAAAA,kBAAA,CAAmB,KAAnB,CADyB;AACA,WADnC,EAAmC,gBAAnC,EAAmC;AAAA,mBAEjB,IAAAC,YAAA,qBAFiB;AAEgB,WAFnD;AAIA;AACI;;;AAgBJ;AACA;AAgBJ;AACJ;AACA;AACJ;;;;;;;;;;AAlGuC;AAC3B;AAAA;AAGG;AAAA;AAAsB;AAAA;AAI7B;AAAA;AAQQ;AAAA,0CAAsB,QAAtB,EAAsB,GAAtB;AAGA;AADA,8DAAiC,iBAAjC,EAAiC,IAAjC,EAAiC,4BAAjC,EAAiC,GAAjC,EAAiC,iBAAjC,EAAiC,GAAjC;AAW8B;AAAA;AAK1B;AAAA;AAG0B;AAAA;AAMf;AAAA;AAGT;AAAA;AAEA;AAAA;AAKS;AAAA;AAEnB;AAAA;AAWQ;AAAA;AAa4B;AAAA;AAkBzB;AAAA;;;;;;;;;;;2BAMlBpD,mC,EAAmC;cA1G/C,OAAA9V,SA0G+C;eA1GrC;AACPjlD,kBAAQ,EAAE,mCADH;AAEPuxD,kBAAQ,gtLAFD;AAuGPpM,mBAAS,EAAE,CAAC,iDAAD,CAvGJ;AAwGPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AAxG1B,S;AA0GqC,Q;;;;kBA6F/B,OAAA+1C;;kBAAQ,OAAAC;;;;;gBA3FpB,OAAA9V,S;iBAAU,S;;;gBAGV,OAAAA,S;iBAAU,gB;;;gBAGV,OAAA/lD;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAA0iD;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAMA,OAAA1iD;;;gBAIA,OAAAA;;;gBAEA,OAAAA;;;gBAKA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;ACnNL;AAAA;AAAA;;;;;AAMA;;;;;;;;QASa87D,e;;;;;;;kCACCp9D,K,EAA0B;AAChC,cAAI,CAACA,KAAL,EAAY;AACR,mBAAO,EAAP;AACH;;AAED,iBAAOA,KAAK,CAAC6H,GAAN,CAAU,UAAA6G,CAAC,EAAI;AAClB,gBAAM2uD,SAAS,GAAG,CAAC,CAACr9D,KAAK,CAACwF,IAAN,CAAW,UAAAnF,CAAC;AAAA,qBAAIA,CAAC,CAACwpB,WAAF,IAAiBxpB,CAAC,CAAC4rB,OAAF,KAAcvd,CAAC,CAACud,OAArC;AAAA,aAAZ,CAApB;AACA,mBAAO,MAAP,OAAO,CAAP,kBACOvd,CADP,CAAO,EACC;AACJ4uD,6BAAe,EAAE,CAACD;AADd,aADD,CAAP;AAIH,WANM,CAAP;AAOH;;;;;;AAhBL;;;uBAGaD,e;AAAe,K;;;;YAAfA,e;AAAe;;;;;2BAAfA,e,EAAe;cAH3B,OAAAvrD,IAG2B;eAHtB;AACF9T,cAAI,EAAE;AADJ,S;AAGsB,Q;;;;;;;;;;;;;;;;;;;;;;ACf5B;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACLI;AAA+C;AAAS;;;;;AAA/B;AAAsB;AAAA;;;;;;AAoB3C;AACE;AACF;;;;;AAF2D;AACzD;AAAA;;;ADZV;;;;;QAeaw/D,iC;AAZb;AAAA;;AAAA;;AAoBS,aAAA34C,OAAA,GAA+B,EAA/B;AAeA,aAAA44C,qBAAA,GAAwB,IAAI,OAAAlc,YAAJ,EAAxB;AAGA,aAAAmc,eAAA,GAAkB,IAAI,OAAAnc,YAAJ,EAAlB;AAEG,aAAAoc,aAAA,GAAgB,IAAI,OAAApc,YAAJ,EAAhB;AAOV,aAAAgZ,iBAAA,GAAoB,IAAI,QAAA39B,WAAJ,EAApB;AAGA;;AACO,aAAAz3B,KAAA,GAAQ,IAAI,OAAAzH,eAAJ,CAAqC,EAArC,CAAR;AAEP;;AACO,aAAAkgE,QAAA,GAAW,IAAI,OAAAlgE,eAAJ,CAAyC,KAAKmnB,OAA9C,CAAX;;AA0GC,aAAAi2C,WAAA,GAAc,UAACnrD,KAAD,EAAiB;AACrC,cAAI,QAAI,CAAClT,OAAL,KAAiB,IAArB,EAA2B;AACzB;AACD;AACD;;;;;AAGA,cAAI,QAAI,CAACA,OAAL,CAAas+D,SAAb,IAA0BprD,KAAK,CAACyE,MAAN,CAAarU,OAAb,CAAqB,yBAArB,MAAoD,IAAlF,EAAyF;AACvF,oBAAI,CAACtD,OAAL,CAAa8yD,UAAb;;AACE,oBAAI,CAAC9yD,OAAL,CAAa,UAAb,EAAyBqD,aAAzB,CAAuCq7D,IAAvC;AACH;AACF,SAXO;AAgBT;;;;mCAtHY;AACT,eAAK0C,qBAAL;AACAr2D,gBAAM,CAACs/B,gBAAP,CAAwB,QAAxB,EAAkC,KAAKg0B,WAAvC,EAAoD,IAApD;AACD;;;oCAEkBn7D,O,EAAsB;AACvC;AACA,cAAIA,OAAO,CAACklB,OAAR,IAAmBllB,OAAO,CAACm+D,aAA/B,EAA8C;AAC5C,gBAAIn+D,OAAO,CAACklB,OAAR,IAAmB,CAACllB,OAAO,CAACm+D,aAAhC,EAA+C;AAC7C,mBAAKvD,iBAAL,CAAuB13D,QAAvB,CAAgC,EAAhC;AACD;;AACD,iBAAKg7D,qBAAL;AACD;;AACD,cAAIl+D,OAAO,CAACo+D,UAAZ,EAAwB;AACtB,iBAAKxD,iBAAL,CAAuB13D,QAAvB,CAAgC,EAAhC;AACA,iBAAKg7D,qBAAL;AACD;AAEF;;;gDAE+B;AAAA;;AAC9B,eAAKG,eAAL,GAAuB,KAAKzD,iBAAL,CAAuB18B,YAAvB,CACpB9qB,IADoB,CAEnB,YAAAkrD,SAAA,CAAU,EAAV,CAFmB,EAGnB,YAAAn2D,GAAA,CAAI,UAAA3C,KAAK;AAAA,mBAAI,OAAOA,KAAP,KAAiB,QAAjB,GAA4BA,KAA5B,GAAoCA,KAAK,KAAIA,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAE+I,OAAX,CAAL,GAA0B/I,KAAK,CAAC+I,OAAhC,GAA0C,EAAlF;AAAA,WAAT,CAHmB,EAInB,YAAApG,GAAA,CAAI,UAAA9J,IAAI;AAAA,mBAAIA,IAAI,GAAG,QAAI,CAACkgE,OAAL,CAAalgE,IAAb,CAAH,GAAwB,QAAI,CAAC6mB,OAAL,CAAa9c,KAAb,EAAhC;AAAA,WAAR,CAJmB,CAAvB;AAMD;;;kCAESyQ,I,EAAuB;AAC/B,iBAAOA,IAAI,KAAIA,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEtK,OAAV,CAAJ,GAAwBsK,IAAI,CAACtK,OAA7B,GAAuC,EAA9C;AACD;;;gCAEeA,O,EAAe;AAC7B,cAAMiwD,WAAW,GAAGjwD,OAAO,CAACvE,WAAR,EAApB,CAD6B,CAE7B;;AACA,cAAMkoB,QAAQ,GAAG,KAAKhN,OAAL,CAAahc,MAAb,CAAoB,UAAA2jB,MAAM,EAAI;AAC7C;AACA;AACA,gBAAI2xC,WAAW,CAACpiD,QAAZ,CAAqB,GAArB,CAAJ,EAA+B;AAC7B,kBAAMqiD,YAAY,GAAED,WAAW,CAACl6D,KAAZ,CAAkB,GAAlB,CAApB;AACA,kBAAIo6D,UAAU,GAAG,IAAjB;;AACA,mBAAK,IAAI5+D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2+D,YAAY,CAACj6D,MAAjC,EAAyC1E,CAAC,EAA1C,EAA8C;AAC5C,oBAAI+sB,MAAM,CAACte,OAAP,CAAevE,WAAf,GAA6BtE,OAA7B,CAAqC+4D,YAAY,CAAC3+D,CAAD,CAAjD,MAA0D,CAAC,CAA/D,EAAkE;AAChE4+D,4BAAU,GAAG,KAAb;AACD;AACF;;AACD,kBAAIA,UAAJ,EAAgB;AACd,uBAAO,IAAP;AACD;AACF,aAd4C,CAe7C;;;AACA,mBAAO7xC,MAAM,CAACte,OAAP,CAAevE,WAAf,GAA6BtE,OAA7B,CAAqC84D,WAArC,IAAoD,CAAC,CAA5D;AACD,WAjBgB,CAAjB;AAkBA,eAAKT,eAAL,CAAqB/a,IAArB,CAA0Bwb,WAA1B;AACA,eAAKV,qBAAL,CAA2B9a,IAA3B,CAAgC9wB,QAAhC;AACA,iBAAOA,QAAP;AACD;AAED;;;;;;;iCAIgBw6B,S,EAA4B;AAC1C,eAAKlnD,KAAL,CAAWiL,IAAX,CAAgBi8C,SAAhB;;AACA,cAAI,KAAKI,SAAT,EAAoB;AAClB,iBAAKA,SAAL,CAAe,KAAK5nC,OAAL,CAAapf,IAAb,CAAkB,UAAAmE,CAAC;AAAA,qBAAIA,CAAC,CAACzE,KAAF,KAAYknD,SAAS,CAAClnD,KAA1B;AAAA,aAAnB,CAAf;AACD;AACF;AAED;;;;;;;mCAIkBA,K,EAAiC;AACjD,cAAIA,KAAK,IAAI,IAAb,EAAmB;AACjB,iBAAKA,KAAL,CAAWiL,IAAX,CAAgBjL,KAAK,CAACA,KAAtB;AACD;AACF;AAED;;;;;;;yCAIwBlH,E,EAAkC;AACxD,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACD;AAED;;;;;;;0CAIyBA,E,EAAkC;AACzD,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACD;;;wCAEsB;AACrB,cAAI,KAAKs8D,iBAAL,CAAuBp1D,KAAvB,KAAiC,EAArC,EAAyC;AACvC,iBAAKw4D,aAAL,CAAmBhb,IAAnB,CAAwB,IAAxB;AACD;AACF;;;sCAciB;AAChBn7C,gBAAM,CAACm1D,mBAAP,CAA2B,QAA3B,EAAqC,KAAK7B,WAA1C,EAAuD,IAAvD;AACD;;;;;;AA9KH;;;uBAYa0C,iC;AAAiC,K;;;YAAjCA,iC;AAAiC,qD;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;uCARjC,CACT;AACEhoB,eAAO,EAAE,QAAAmX,iBADX;AAEEC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAM2Q,iCAAN;AAAA,SAAX,CAFf;AAGE1Q,aAAK,EAAE;AAHT,OADS,C,GAMV,uB;AAAA,c;AAAA,a;AAAA,+a;AAAA;AAAA;ACvBH;AACI;AACA;AAGE;AASE;AAAA,mBAAS,IAAAwR,aAAA,EAAT;AAAwB,WAAxB;AATF;AAWA;AAGE;AAAA,mBAAkB,IAAAz7D,QAAA,qBAAlB;AAA+C,WAA/C;AAEA;;AAGF;AACF;AACJ;;;;;;AAzBe;AAAA;AAYP;AAAA;AAHA,8DAAiC,iBAAjC,EAAiC,GAAjC,EAAiC,aAAjC,EAAiC,eAAjC;AAQA;AAAA;AAGY;AAAA;;;;;;;;;;2BDIP26D,iC,EAAiC;cAZ7C,OAAA1Z,SAY6C;eAZnC;AACTjlD,kBAAQ,EAAE,gCADD;AAETklD,qBAAW,EAAE,4CAFJ;AAGTC,mBAAS,EAAE,CAAC,4CAAD,CAHF;AAITpD,mBAAS,EAAE,CACT;AACEpL,mBAAO,EAAE,QAAAmX,iBADX;AAEEC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAM2Q,iCAAN;AAAA,aAAX,CAFf;AAGE1Q,iBAAK,EAAE;AAHT,WADS;AAJF,S;AAYmC,Q;;gBAC3C,OAAAvrD;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAA0iD;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAeA,OAAAqD,S;iBAAU,S;;;;;;;;;;;;;;;;;;;;;;;;AEpEb;AAAA;AAAA;;AAQA;AAAA;AAAA;;;;;AAEA;;;;;;;;;;;QASaiX,qB;;;;;AAMT,qCAAoBC,KAApB,EAA6C;AAAA;;AAAA;;AACzC;AADgB,iBAAAA,KAAA,GAAAA,KAAA;AAFZ,iBAAAC,UAAA,GAAa,KAAb;AAEqC;AAE5C;;;;mCAEc;AACX;AACA,eAAKC,gBAAL;AACH;;;2CAEyB;AACtB,cAAI,KAAKtO,QAAL,IAAiB,CAAC,KAAKqO,UAA3B,EAAuC;AACnC,iBAAKA,UAAL,GAAkB,IAAlB;AACA,iBAAKD,KAAL,CAAWG,kBAAX,CAA8B,KAAKvO,QAAnC;AACA,mBAAO,IAAP;AACH;;AACD,iBAAO,KAAP;AACH;;;0CAEqB;AAAA;;AAClB,cAAI,CAAC,KAAKqO,UAAV,EAAsB;AAClB92D,mBAAO,CAACV,GAAR,CAAY,0DAAZ;AACA7I,sBAAU,CAAC,YAAM;AACbuJ,qBAAO,CAACV,GAAR,CAAY,6BAAZ,EAA2C,QAAI,CAACmpD,QAAhD;;AACA,kBAAI,CAAC,QAAI,CAACsO,gBAAL,EAAL,EAA8B;AAC1B/2D,uBAAO,CAACV,GAAR,CAAY,gDAAZ;AACA7I,0BAAU,CAAC,YAAM;AACb,sBAAI,CAAC,QAAI,CAACsgE,gBAAL,EAAL,EAA8B;AAC1B/2D,2BAAO,CAAC+Y,KAAR,CAAc,yBAAd;AACH;AACJ,iBAJS,EAIP,IAJO,CAAV;AAKH;AACJ,aAVS,CAAV;AAWH;AACJ;;;sCAEiB;AACd;;AACA,eAAK+9C,UAAL,GAAkB,KAAlB;AACH;;;;MA5CsC,OAAA//D,a;;AAA3C;;;uBAAa6/D,qB,EAAqB,yC;AAAA,K;;;YAArBA,qB;AAAqB;AAAA;+BACnB,OAAAK,W,EAAa,I;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpB5B;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;ACCI;AAAK;AAAA;AAAA;AAAA,iBAAS,OAAA1vC,MAAA,OAAT;AAAsB,SAAtB;AACH;AACF;;;;;AAFkE;;;;;;QDcvD2vC,yB,GAKX,qCAAc;AAAA;;AAHJ,WAAA3vC,MAAA,GAAS,IAAI,OAAAqyB,YAAJ,EAAT;AAGM,K;;AAVlB;;;uBAKasd,yB;AAAyB,K;;;YAAzBA,yB;AAAyB,yC;AAAA;AAAA;yBACzB,OAAAD,W,EAAW,I;;;;;;;;;;;;;;;;;;;;;;AChB1B;;;;;;;;;2BDeeC,yB,EAAyB;cALrC,OAAA/a,SAKqC;eAL3B;AACTjlD,kBAAQ,EAAE,oBADD;AAETklD,qBAAW,EAAE,qCAFJ;AAGTC,mBAAS,EAAE,CAAC,qCAAD;AAHF,S;AAK2B,Q;;;;gBACnC,OAAAsD,S;iBAAU,OAAAsX,W;;;gBACV,OAAA3a;;;gBACA,OAAA1iD;;;;;;;;;;;;;;;;;;;;;;;;AElBL;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACSI;AAAkD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuK;AAAiB;;;;;;AAAzH;AAA+B;AAAyE;AAAA;;;;;;;;;;;QDO9Mu9D,kB;AAIX,oCAAc;AAAA;;AAFP,aAAAC,QAAA,GAAoB,KAApB;AAIN;;;;mCACO;AACN,eAAKryC,QAAL,GAAgB,KAAKlU,IAAL,CAAUwmD,eAA1B;AACD;;;uCAEqBr0D,I,EAAqB;qBAAA,CACzC;;;AACA,eAAK6N,IAAL,CAAUwmD,eAAV,GAA4Br0D,IAA5B;AACA,sBAAK6N,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEymD,gBAAX,MAA2B,MAAI,KAAKzmD,IAAT,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEymD,gBAAF,CAAmBt0D,IAAnB,CAAxC;AACD;;;;;;AApBH;;;uBAKam0D,kB;AAAkB,K;;;YAAlBA,kB;AAAkB,iC;AAAA;AAAA;AAAA,O;AAAA,c;AAAA,c;AAAA,+e;AAAA;AAAA;ACdjC;AAAgL;AAAA;AAAA;AAC9K;AAAoD;AAAkC;AACtF;AACI;AACJ;AACF;AACA;AACI;AACJ;;;;;;AAR8E;AAA5D,mDAA+B,SAA/B,EAA+B,qFAA/B;AACoC;AAAA;AAE9B;AAAA;AAIL;AAAA;;;;;;;;;2BDOJA,kB,EAAkB;cAL9B,OAAAhb,SAK8B;eALpB;AACTjlD,kBAAQ,EAAE,YADD;AAETklD,qBAAW,EAAE,6BAFJ;AAGTC,mBAAS,EAAE,CAAC,6BAAD;AAHF,S;AAKoB,Q;;;;gBAC5B,OAAAziD;;;;;;;;;;;;;;;;;;;;;;;;AEjBL;AAAA;AAAA;;AAaE;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;QAQa29D,2B;AAOX,2CACUC,OADV,EAEUC,UAFV,EAGUC,gBAHV,EAIUC,QAJV,EAI6B;AAAA;;AAHnB,aAAAH,OAAA,GAAAA,OAAA;AACA,aAAAC,UAAA,GAAAA,UAAA;AACA,aAAAC,gBAAA,GAAAA,gBAAA;AACA,aAAAC,QAAA,GAAAA,QAAA;AAVF,aAAAC,cAAA,GAAiB,KAAjB;AAEA,aAAAC,yBAAA,GAA4B,OAAAjhE,YAAA,CAAakhE,KAAzC;AAGE,aAAAC,aAAA,GAAgB,IAAI,OAAAne,YAAJ,EAAhB;AAQT;;;;mCACO,CACN;AACA;AACA;AACD;;;0CACc,CAEd;;;yCAGa;AACZ,eAAKge,cAAL,GAAsB,KAAKI,eAAL,EAAtB,GAA+C,KAAKC,YAAL,EAA/C;AAED;;;uCAEW;AAAA;;AAAA,cACLC,OADK,GACM,KAAKC,aADX,CACLD,OADK;AAEV,eAAKC,aAAL,CAAmBD,OAAnB,GAA6BA,OAAO,KAAI,EAAX,GAAgBA,OAAhB,aAA6B,KAAKT,UAAL,CAAgBt/D,aAAhB,CAA8BigE,WAA3D,OAA7B;AACA,eAAKR,cAAL,GAAsB,IAAtB;AACA,eAAKG,aAAL,CAAmB/c,IAAnB,CAAwB,KAAK4c,cAA7B;AACA,eAAKS,UAAL,GAAkB,KAAKb,OAAL,CAAac,MAAb,CAAoB;AACpCC,uBAAW,EAAE,IADuB;AAEpCrW,yBAAa,EAAE,kCAFqB;AAGpCsW,0BAAc,EAAE,KAAKhB,OAAL,CAAaiB,gBAAb,CAA8B/5B,KAA9B,EAHoB;AAIpCg6B,4BAAgB,EAAE,KAAKlB,OAAL,CACflS,QADe,GAEfqT,mBAFe,CAEK,KAAKlB,UAFV,EAGfmB,aAHe,CAGD,CACb;AACEC,qBAAO,EAAE,KADX;AAEEC,qBAAO,EAAE,QAFX;AAGEC,sBAAQ,EAAE,KAHZ;AAIEC,sBAAQ,EAAE,KAJZ;AAKEC,qBAAO,EAAE;AALX,aADa,CAHC;AAJkB,WAApB,CAAlB;AAkBA,cAAMC,cAAc,GAAG,IAAI,SAAAC,cAAJ,CACrB,KAAKhB,aAAL,CAAmBiB,WADE,EAErB,KAAK1B,gBAFgB,CAAvB;AAIA,eAAKW,UAAL,CAAgBgB,MAAhB,CAAuBH,cAAvB;AAEA,eAAKrB,yBAAL,GAAiC,KAAKyB,sBAAL,GAA8B/gE,SAA9B,CAC/B;AAAA,mBAAM,QAAI,CAACy/D,eAAL,EAAN;AAAA,WAD+B,CAAjC;AAGD;;;iDAE6B;AAC5B,cAAMuB,cAAc,GAAG,KAAKlB,UAAL,CAAgBmB,aAAhB,EAAvB;AACA,cAAMC,WAAW,GAAG,KAAKpB,UAAL,CAAgBqB,WAAhB,EAApB;AACA,cAAMC,cAAc,GAAG,KAAKxB,aAAL,CAAmB5wC,MAA1C;AAEA,iBAAO,OAAAqyC,KAAA,CAAML,cAAN,EAAsBE,WAAtB,EAAmCE,cAAnC,CAAP;AACD;;;0CAEsB;AACrB,cAAI,CAAC,KAAKtB,UAAN,IAAoB,CAAC,KAAKT,cAA9B,EAA8C;AAC5C;AACD;;AAED,eAAKC,yBAAL,CAA+BhhE,WAA/B;AACA,eAAK+gE,cAAL,GAAsB,KAAtB;AACA,eAAKG,aAAL,CAAmB/c,IAAnB,CAAwB,KAAK4c,cAA7B;AACA,eAAKS,UAAL,CAAgBwB,MAAhB;AACD;;;sCAEU;AACT,cAAI,KAAKxB,UAAT,EAAqB;AACnB,iBAAKA,UAAL,CAAgByB,OAAhB;AACD;AACF;;;;;;AA7FH;;;uBAMavC,2B,EAA2B,gC,EAAA,mC,EAAA,yC,EAAA,kC;AAAA,K;;;YAA3BA,2B;AAA2B,iD;AAAA;AAAA;;mBAA3B,oB;AAAgB,W;;;;;;;;;;;;;2BAAhBA,2B,EAA2B;cANvC,OAAAtgE,SAMuC;eAN7B;AACTC,kBAAQ,EAAE,sBADD;AAET0c,cAAI,EAAE;AACJ,uBAAW;AADP;AAFG,S;AAM6B,Q;;;;;;;;;;;;gBAKrC,OAAAha,K;iBAAM,oB;;;gBACN,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AC7BL;AAAA;AAAA;;AAMA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;AAWY;AACI;AAAiB;AAAS;AAC1B;;AAAqE;AACzE;;;;;AAFqB;AAAA;AACc;AAAA;;;;;;AAEnC;AACI;AACI;AACJ;AACJ;;;;;;AACA;AAAmE;AAAe;;;;;AAAf;AAAA;;;;;;AAE/D;;;;;;QAMHyd,uB;AAgBT,yCAAc;AAAA;;AARd;;;AAIA,aAAA7N,SAAA,GAAY,KAAZ;AAEO,aAAA8N,UAAA,GAAa,IAAI,OAAAjkE,eAAJ,CAAoB,KAApB,CAAb;AAGN;;;;mCAEO,CACP;;;;;;AA9CL;;;uBA0BagkE,uB;AAAuB,K;;;YAAvBA,uB;AAAuB,0C;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA,6B;AAAA,c;AAAA,c;AAAA,sT;AAAA;AAAA;;AAvB5B;AAII;AAAA,mBAAU,IAAAC,UAAA,MAAgB,IAAhB,CAAV;AAA+B,WAA/B,EAAgC,QAAhC,EAAgC;AAAA,mBACtB,IAAAA,UAAA,MAAgB,KAAhB,CADsB;AACA,WADhC;;AAEA;AAIA;AAKA;;AACA;AAGJ;;;;AAhBI;AAFA;AAK4B;AAAA;AAIA;AAAA;AAKL;AAAA;;;;;;;;;;2BAQtBD,uB,EAAuB;cA1BnC,OAAA5d,SA0BmC;eA1BzB;AACPjlD,kBAAQ,EAAE,qBADH;AAEPuxD,kBAAQ,yoCAFD;AAwBPpM,mBAAS,EAAE,CAAC,kCAAD;AAxBJ,S;AA0ByB,Q;;;;gBAE/B,OAAAziD;;;gBAGA,OAAAA;;;gBAMA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AC7CL;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;QAgBaqgE,2B;AACT,2CAAmBx7B,SAAnB,EACoCy7B,UADpC,EACyE;AAAA;;AADtD,aAAAz7B,SAAA,GAAAA,SAAA;AACiB,aAAAy7B,UAAA,GAAAA,UAAA;AACnC;;;;mCACO,CAAW;;;+BAEL;;;AACV,qBAAKA,UAAL,MAAe,IAAf,IAAe,aAAf,GAAe,MAAf,GAAe,GAAEC,QAAF,EAAf;AAA6B,eAAK17B,SAAL,CAAeC,KAAf;AAChC;;;;;;AAdL;;;uBAMau7B,2B,EAA2B,qC,EAAA,qBAExB,SAAA/d,eAFwB,C;AAET,K;;;YAFlB+d,2B;AAA2B,2C;AAAA,e;AAAA,a;AAAA,+N;AAAA;AAAA;ACjBxC;AACI;AACI;AACH;AACE;AACE;AACA;AAAM;AAA0B;AAClC;AACA;AAA2B;AAAuB;AACpD;AACD;AACD;AACA;AACG;AAA+D;AAAA,mBAAiB,IAAAvW,IAAA,EAAjB;AAAuB,WAAvB;AAAyB;AAC3F;AACH;;;;AAde;AAAA;AAKA;AAAA;AAEmB;AAAA;AAKN;AAAA;;;;;;;;;;2BDIfuW,2B,EAA2B;cANvC,OAAA9d,SAMuC;eAN7B;AACPjlD,kBAAQ,EAAE,sBADH;AAEPklD,qBAAW,EAAE,qCAFN;AAGPC,mBAAS,EAAE,CAAC,uCAAD,CAHJ;AAIPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AAJ1B,S;AAM6B,Q;;;;;;kBAE/B,OAAA0pB,M;mBAAO,SAAA+S,e;;;;;;;;;;;;;;;;;;;;;;;;;AEnBhB;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACKQ;AACI;AACuB;AAAM;AAAe;AAAQ;AACxD;;;;;AAFI;AAAA;;;;;;AAGJ;AACI;AAEJ;;;;;AAFI;AAAA;;;;;;AASA;AACI;AACJ;;;;;;AADI;AAAA;;;;QDNHd,uB;AASX,uCAA6CtY,KAA7C,EAA+E;AAAA;;AAAlC,aAAAA,KAAA,GAAAA,KAAA;AAF5B,aAAA96B,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AAIhB;;;;mCAEc;AACb,eAAK16C,QAAL,GAAgB,KAAK4jC,KAAL,CAAW5jC,QAA3B;AACA,eAAK4qC,SAAL,GAAiB,KAAKhH,KAAL,CAAWgH,SAA5B;AACA,eAAKyR,SAAL,GAAiB,KAAKzY,KAAL,CAAWyY,SAA5B;AACA,eAAKC,cAAL,GAAsB,KAAK1Y,KAAL,CAAW0Y,cAAjC;AACD;;;mCAEiBlhD,I,EAAc;AAC9B,cAAM2hD,MAAM,GAAG,IAAI,UAAAzwC,MAAJ,CAAW;AAAClR,gBAAI,EAAEA,IAAI,GAAC,IAAZ;AAAmBqnB,uBAAW,EAAE,KAAhC;AAAuCC,uBAAW,EAAE,KAAKkhB,KAAL,CAAW5jC;AAA/D,WAAX,CAAf;AACA,cAAMk7D,WAAW,GAAG,UAAAj7D,OAAA,CAAQ88C,MAAR,EAAgB,KAAK/8C,QAArB,CAApB;AACA,cAAMqH,OAAO,GAAG01C,MAAM,CAACrgD,UAAP,CAAkB,iBAAlB,CAAhB;AACA,2BAAU2K,OAAV,SAAoB6zD,WAAW,GAAG,UAAH,GAAgB,EAA/C;AACD;;;oCAEc;AACb,eAAKpyD,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,kBAAM,EAAE;AAAV,WAAhB;AACD;;;gCAEW;AACV,eAAKhW,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,kBAAM,EAAE;AAAV,WAAhB;AACD;;;+BAEU;AACT,eAAKhW,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,kBAAM,EAAE;AAAV,WAAhB;AACD;;;;;;AA1CH;;;uBAKao9B,uB,EAAuB,qBASd,SAAAc,eATc,C;AASC,K;;;YATxBd,uB;AAAuB,0C;AAAA;AAAA;AAAA,O;AAAA,e;AAAA,c;AAAA,ya;AAAA;AAAA;ACjBpC;AACI;AACI;AACJ;AACJ;AACA;AACI;AACI;AAAI;AAAgC;AACpC;AAIA;AAIJ;AACA;AACI;AACI;AACJ;AACA;AACI;AAGJ;AACJ;AACJ;AACA;AACI;AAIQ;AAAA,wCAA0B,IAAAif,IAAA,EAA1B,GAAmC,IAAA37B,KAAA,EAAnC;AAA0C,WAA1C;AAJR;AAQA;AACA;AAIQ;AAAA,wCAA0B,IAAAA,KAAA,EAA1B,GAAoC,iBAApC;AAA8C,WAA9C;AAJR;AAQA;AACJ;;;;AAxCY;AAAA;AACc;AAAA;AAIA;AAAA;AAUI;AAAA;AAYlB;AAAA;AAGR;AAAA;AAAA;AAMQ;AAAA;AAGR;AAAA;AAAA;;;;;;;;;2BD7BS0c,uB,EAAuB;cALnC,OAAAe,SAKmC;eALzB;AACTjlD,kBAAQ,EAAE,qBADD;AAETklD,qBAAW,EAAE,kCAFJ;AAGTC,mBAAS,EAAE,CAAC,kCAAD;AAHF,S;AAKyB,Q;;;;kBASrB,OAAAlT,M;mBAAO,SAAA+S,e;;;;;gBAFnB,OAAAI;;;;;;;;;;;;;;;;;;;;;;;;AExBH;AAAA;AAAA;;AAUA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;ACUY;AAAsC;AAAU;;;;;AAAV;AAAA;;;;;;AAc1B;;;;;;AACA;AAAsC;AAAsC;;;;;AAAtC;AAAA;;;;;;;;AAX9C;AACI;AAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AACA;AACA;AACJ;AACJ;;;;;AAPQ;AAAA,uDAAkC,QAAlC,EAAkC,cAAlC;AADA;AAIA;AAAA;AACiB;AAAA;AACE;AAAA;;;;;;AAZ/B;AACI;;AAcJ;;;;;;AAdQ;AAAA;;;;QD4BPge,6B;;;;;AAZb;AAAA;;AAAA;;;AAgBI;;AACgB,iBAAAC,SAAA,GAAY,SAAZ;AAKhB;;AACiB,iBAAA79D,KAAA,GAAQ,IAAI,OAAAk9C,YAAJ,EAAR;AAED,iBAAA9lB,KAAA,GAAQ,IAAIzsB,KAAJ,CAAU,CAAV,EAAa+nC,IAAb,CAAkB,CAAlB,CAAR;AACT,iBAAAorB,cAAA,GAAyB,UAAAz2D,OAAA,EAAzB,CA1BX,CA4BI;;AACA;;AACO,iBAAA/F,MAAA,GAAS,CAAT;AACP;;AACO,iBAAAiyD,UAAA,GAAa,CAAC,MAAd;AACP;;AACO,iBAAAC,UAAA,GAAa,MAAb;AACP;;AACO,iBAAAC,SAAA,GAA0B,EAA1B;AACP;;AACO,iBAAAC,UAAA,GAAa,UAAArsD,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB0B,UAApB,CAA+B,WAA/B,CAAb;AACP;;AACO,iBAAAy0D,YAAA,GAAe,EAAf;AAKP;;AACQ,iBAAAC,UAAA,GAAa,KAAb;AACR;;AACQ,iBAAAC,YAAA,GAAe,WAAf;AAMA,iBAAAkK,MAAA,GAAS,UAAA12D,OAAA,EAAT;;AA+KQ,iBAAA22D,gBAAA,GAAmB,UAACpkE,EAAD;AAAA,iBAA6B,SAAKwuD,SAAL,GAAiBxuD,EAA9C;AAAA,SAAnB;;AACA,iBAAAqkE,iBAAA,GAAoB,UAACrkE,EAAD;AAAA,iBAA6B,SAAKyuD,QAAL,GAAgBzuD,EAA7C;AAAA,SAApB;;AAtOpB;AAuOC;;;;mCA3KkB;AACX,eAAKk6D,aAAL;AACA,eAAKC,qBAAL;AACH;;;oCAEkBz4D,O,EAAsB;AACrC,cAAIA,OAAO,CAACklB,OAAZ,EAAqB;AACjB,iBAAKwzC,aAAL;AACH;;AACD,cAAI14D,OAAO,CAAC24D,QAAZ,EAAsB;AAClB,iBAAKH,aAAL;AACH;AACJ;AAED;;;;gCACextD,I,EAAkB;AAC7B,eAAKw3D,cAAL,GAAsBx3D,IAAI,CAACxF,KAA3B;;AACA,cAAI,KAAKsnD,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAe,KAAK0V,cAApB;AACH;;AACD,eAAKhK,aAAL;AACH;AAED;;;;;;qCAGiB;AACb,cAAI,CAAC,KAAKgK,cAAV,EAA0B;AACtB;AACH;;AACD,cAAMl5C,GAAG,GAAG,KAAKm5C,MAAL,CAAYz2D,YAAZ,CAAyB,OAAzB,CAAZ;;AACA,cAAM42D,kBAAkB,GAAG,KAAKJ,cAAL,CAAoBx2D,YAApB,CAAiC,OAAjC,CAA3B;;AACA,cAAI42D,kBAAkB,CAAC38C,KAAvB,EAA8B;AAC1B,gBAAM2yC,UAAU,GAAGgK,kBAAkB,CAACpoC,QAAnB,CACflR,GADe,EAEf,QAFe,EAGf,QAHe,CAAnB;;AAKA,gBAAI,KAAKtjB,MAAL,KAAgB4yD,UAApB,EAAgC;AAC5B,mBAAK5yD,MAAL,GAAcpD,IAAI,CAACk1B,KAAL,CAAW8gC,UAAX,CAAd;AACA,mBAAKl0D,KAAL,CAAWs+C,IAAX,CAAgB,KAAKh9C,MAArB;AACH;;AACD,iBAAKwyD,aAAL;AACH;AACJ;AAED;;;;;;wCAGoB;AAChB,cAAI,KAAKtzC,OAAT,EAAkB;AACd;AACA,gBAAI,KAAKA,OAAL,CAAaw/B,UAAjB,EAA6B;AACzB,kBAAMmU,KAAK,GAAG,KAAK4J,MAAL,CAAYz2D,YAAZ,CAAyB,OAAzB,CAAd;;AACA,mBAAK4oB,MAAL,GAAc,KAAK1P,OAAL,CAAaw/B,UAAb,CAAwB14C,YAAxB,CAAqC,KAArC,CAAd;AACA,mBAAKisD,UAAL,GAAkBr1D,IAAI,CAACk1B,KAAL,CACd,KAAKlD,MAAL,CACK5oB,YADL,CACkB,OADlB,EAEKwuB,QAFL,CAEcq+B,KAFd,EAEqB,QAFrB,EAE+B,QAF/B,CADc,CAAlB;AAKH,aARD,MAQO,IAAI,KAAKjkC,MAAT,EAAiB;AACpB,mBAAKA,MAAL,GAAc,IAAd,CADoB,CACA;;AACpB,mBAAKqjC,UAAL,GAAkB,CAAC,MAAnB;AACH,aAba,CAcd;;;AACA,gBAAI,KAAK/yC,OAAL,CAAay/B,WAAjB,EAA8B;AAC1B,kBAAMkU,OAAK,GAAG,KAAK4J,MAAL,CAAYz2D,YAAZ,CAAyB,OAAzB,CAAd;;AACA,mBAAK6oB,IAAL,GAAY,KAAK3P,OAAL,CAAay/B,WAAb,CAAyB34C,YAAzB,CAAsC,KAAtC,CAAZ;AACA,mBAAKksD,UAAL,GAAkB,KAAKrjC,IAAL,CACb7oB,YADa,CACA,OADA,EAEbwuB,QAFa,CAEJq+B,OAFI,EAEG,QAFH,EAEa,QAFb,CAAlB;AAGH,aAND,MAMO,IAAI,KAAKhkC,IAAT,EAAe;AAClB,mBAAKA,IAAL,GAAY,IAAZ;AACA,mBAAKqjC,UAAL,GAAkB,MAAlB;AACH;;AACD,gBAAI,KAAKhzC,OAAL,CAAaqzC,YAAjB,EAA+B;AAC3B,mBAAKA,YAAL,GAAoB,KAAKrzC,OAAL,CAAaqzC,YAAb,IAA6B,WAAjD;AACH;;AACD,gBAAI,KAAKrzC,OAAL,CAAaozC,UAAjB,EAA6B;AACzB,mBAAKA,UAAL,GAAkB,KAAKpzC,OAAL,CAAaozC,UAAb,IAA2B,KAA7C;AACA,mBAAKG,qBAAL;AACH,aA/Ba,CAgCd;;;AACA,iBAAKD,aAAL;AACH;AACJ;AAED;;;;;;wCAGqB;AACjB,eAAKiK,MAAL,GAAc,IAAI,UAAAjvD,MAAJ,CAAW;AAAElR,gBAAI,EAAEJ,IAAI,CAAConB,GAAL,EAAR;AAAoBK,uBAAW,EAAE,CAAC,KAAKziB,QAAvC;AAAiD0iB,uBAAW,EAAE,KAAK1iB;AAAnE,WAAX,CAAd;;AACA,cAAM07D,kBAAkB,GAAG,KAAKH,MAAL,CAAYt/D,QAAZ,CAAqB;AAAEy4B,kBAAM,EAAE,KAAK51B;AAAf,WAArB,CAA3B;;AACA,cAAMmnC,MAAM,GAAG,KAAKq1B,cAAL,IAAuB,UAAAz2D,OAAA,EAAtC;AACA,cAAI/H,SAAS,GAAG4+D,kBAAkB,CAC7B1/D,QADW,CACF;AAAEuD,eAAG,EAAE;AAAP,WADE,EAEXvD,QAFW,CAEF;AAAEkE,mBAAO,EAAE;AAAX,WAFE,EAGX2M,aAHW,CAGG;AAAE+nB,iBAAK,EAAE;AAAT,WAHH,CAAhB;AAIA,eAAKq8B,SAAL,GAAiB,EAAjB;;AACA,eAAK,IAAIx3D,IAAC,GAAG,CAAb,EAAgBA,IAAC,GAAG,EAApB,EAAwBA,IAAC,EAAzB,EAA6B;AACzB,iBAAKw3D,SAAL,CAAehuD,IAAf,CAAoB;AAChB3E,mBAAK,EAAExB,SADS;AAEhBuK,qBAAO,EAAEvK,SAAS,CAACJ,UAAV,CAAqB,GAArB,CAFO;AAGhBupC,oBAAM,EAAEA,MAAM,CAACtN,UAAP,CAAkB77B,SAAlB,EAA6B,KAA7B,CAHQ;AAIhB+0D,uBAAS,EAAE,CAAC6J,kBAAkB,CAAC/iC,UAAnB,CAA8B77B,SAA9B,EAAyC,OAAzC,CAJI;AAKhBqG,mBAAK,EAAE,KAAKsuD,QAAL,GACD,KAAKA,QAAL,CAAc30D,SAAS,CAACJ,UAAV,CAAqB,YAArB,CAAd,KAAqD,CADpD,GAED,CAPU;AAQhBs5B,sBAAQ,EACJ,CAAC,KAAKtI,MAAL,GAAc5wB,SAAS,CAACiI,EAAV,GAAe,KAAK2oB,MAAL,CAAY3oB,EAAzC,GAA8C,KAA/C,MACC,KAAK4oB,IAAL,GAAY7wB,SAAS,CAACiI,EAAV,GAAe,KAAK4oB,IAAL,CAAU5oB,EAArC,GAA0C,KAD3C,CATY;AAWhB4sD,mBAAK,EAAE,KAAK4J,MAAL,CAAY5iC,UAAZ,CAAuB77B,SAAvB,EAAkC,KAAlC;AAXS,aAApB;AAaAA,qBAAS,GAAGA,SAAS,CAACb,QAAV,CAAmB;AAAEwwB,kBAAI,EAAE;AAAR,aAAnB,CAAZ;AACH;;AACD,eAAKykC,UAAL,GAAkBwK,kBAAkB,CAACh/D,UAAnB,CAA8B,KAAK20D,YAAnC,CAAlB;AACH;AAED;;;;;;gDAGgC;AAC5B,cAAIj2D,IAAI,GAAG,KAAKmgE,MAAL,CAAYz2D,YAAZ,CAAyB,MAAzB,CAAX;;AACA,eAAKqsD,YAAL,GAAoB,EAApB;;AACA,eAAK,IAAI13D,IAAC,GAAG,CAAb,EAAgBA,IAAC,GAAG,CAApB,EAAuBA,IAAC,EAAxB,EAA4B;AACxB,iBAAK03D,YAAL,CAAkBluD,IAAlB,CAAuB7H,IAAI,CAACsB,UAAL,CAAgB,KAAK00D,UAArB,CAAvB;AACAh2D,gBAAI,GAAGA,IAAI,CAACa,QAAL,CAAc;AAAEwwB,kBAAI,EAAE;AAAR,aAAd,CAAP;AACH;AACJ;AAED;;;;;;;;oCAKmBnuB,K,EAAa;AAC5B,cAAMyzD,UAAU,GAAGr2D,IAAI,CAACq9B,GAAL,CACf,KAAKi4B,UADU,EAEft1D,IAAI,CAACmD,GAAL,CAAS,KAAKkyD,UAAd,EAA0B,KAAKjyD,MAAL,GAAcR,KAAxC,CAFe,CAAnB;AAIA,eAAKQ,MAAL,GAAcpD,IAAI,CAACk1B,KAAL,CAAWmhC,UAAX,CAAd;AACA,eAAKT,aAAL;AACA,eAAK9zD,KAAL,CAAWs+C,IAAX,CAAgB,KAAKh9C,MAArB;AACH;AAED;;;;;;gCAGe;AACX,cAAMA,MAAM,GAAG,KAAKA,MAApB;AACA,eAAKA,MAAL,GAAcpD,IAAI,CAACk1B,KAAL,CACV,KAAK2qC,MAAL,CAAYjoC,QAAZ,CAAqB,KAAKgoC,cAA1B,EAA0C,QAA1C,EAAoD,QAApD,CADU,CAAd;AAGA,cAAIx8D,MAAM,KAAK,KAAKA,MAApB,EAA4B,KAAKwyD,aAAL;AAC5B,eAAK9zD,KAAL,CAAWs+C,IAAX,CAAgB,KAAKh9C,MAArB;AACH;AAED;;;;;;;mCAIkBR,K,EAAe;AAC7B,cAAIA,KAAJ,EAAW;AACP,iBAAKg9D,cAAL,GAAsBh9D,KAAtB;AACA,iBAAK0zD,UAAL;AACA,iBAAKV,aAAL;AACH;AACJ;;;4BA3KqB;;;AAClB,iBAAO,YAAKgK,cAAL,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAE54C,WAArB,KAAoC,EAA3C;AACH;;;;MA7CO,OAAAlsB,S;;AAbZ;;;6DAYa4kE,6B;AAA6B,K;;;YAA7BA,6B;AAA6B,8C;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,uCAR3B,CACP;AACIzsB,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAMoV,6BAAN;AAAA,SAAX,CAFjB;AAGInV,aAAK,EAAE;AAHX,OADO,CAQ2B,GAFrC,6BAEqC,EAFrC,uBAEqC,C;AAFrC,e;AAAA,a;AAAA,+Z;AAAA;AAAA;ACpDL;AACI;AACI;AAII;AAAA,mBAAS,IAAAgM,WAAA,CAAY,IAAC,CAAb,CAAT;AAAwB,WAAxB;AAEA;AACJ;AACA;AAAmB;AAAA,mBAAY,IAAA/2D,KAAA,EAAZ;AAAmB,WAAnB;AAAqB;AAAgB;AACxD;AAII;AAAA,mBAAS,IAAA+2D,WAAA,CAAY,CAAZ,CAAT;AAAuB,WAAvB;AAEA;AACJ;AACJ;AACA;AACI;AACI;AACJ;AACA;AACI;AAgBJ;AACJ;AACJ;;;;AA3CK;AAKO;AAAA;AAKoC;AAAA;AAIpC;AAAA;AAQI;AAAA;AAGA;AAAA;;;;;;;8ED6BHmJ,6B;;;;2BAAAA,6B,EAA6B;cAZzC,OAAAne,SAYyC;eAZ/B;AACPjlD,kBAAQ,EAAE,yBADH;AAEPklD,qBAAW,EAAE,0CAFN;AAGPC,mBAAS,EAAE,CAAC,0CAAD,CAHJ;AAIPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAMoV,6BAAN;AAAA,aAAX,CAFjB;AAGInV,iBAAK,EAAE;AAHX,WADO;AAJJ,S;AAY+B,Q;;gBAKrC,OAAAvrD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AEjEL;AAAA;AAAA;;AASA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAWY;AAAyD;AAAS;;;;;AAAvD;AAA8C;AAAA;;;;;;AAcrD;AAAwC;;AAAwB;;;;;AAAxB;AAAA;;;;;;;;AAgBpC;AAKI;AAAA;AAAA;AAAA;AAAA;AACH;AACD;;;;;;;;;;;;QAcPue,yB;;;;;AA5Db;AAAA;;AAAA;;;AA8DI;;AACgB,iBAAAne,UAAA,GAAqB,UAAA34C,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAArB;AAChB;;AACgB,iBAAAyiD,WAAA,GAAsB,UAAA54C,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoBqwB,UAApB,CAA+B,KAA/B,EAAsCpvB,QAAtC,CAA+C;AAAE4qD,eAAK,EAAE;AAAT,SAA/C,CAAtB;AAChB;;AACgB,iBAAAT,QAAA,GAA6B,OAA7B;AAChB;;AACgB,iBAAAtnD,MAAA,GAA2B,QAA3B,CArEpB,CAwEI;;AACgB,iBAAAgyB,OAAA,GAAmB,KAAnB;AAChB;;AACgB,iBAAA8qC,SAAA,GAAqB,KAArB;AAMC,iBAAAC,QAAA,GAAW,IAAI,OAAAnhB,YAAJ,EAAX;AAMD,iBAAAohB,cAAA,GAA0B,IAA1B;AAoBhB;;AACO,iBAAAC,mBAAA,GAAsB,IAAI,OAAAllE,eAAJ,CAA4B,UAAAgO,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAA5B,CAAtB;;AAoDA,iBAAAghE,oBAAA,GAAuB;AAAA,iBAAM,SAAKC,cAAL,CAAoBjK,UAApB,EAAN;AAAA,SAAvB;;AAeS,iBAAAwJ,gBAAA,GAAmB,UAACpkE,EAAD;AAAA,iBAA6B,SAAKwuD,SAAL,GAAiBxuD,EAA9C;AAAA,SAAnB;;AACA,iBAAAqkE,iBAAA,GAAoB,UAACrkE,EAAD;AAAA,iBAA6B,SAAKyuD,QAAL,GAAgBzuD,EAA7C;AAAA,SAApB;;AAhLpB;AA+LC;;;;mCAnGkB;AACX,cAAI,KAAK8kE,sBAAT,EAAiC;AAC7B,iBAAKC,UAAL,CAAgB,KAAKD,sBAArB;AACH;AACJ;AAcD;;;;;AAqBA;;;;iCAIgBE,U,EAAoB;AAChC;AACA,cAAM9V,QAAQ,GAAG,KAAKyV,mBAAL,CAAyBz9D,KAA1C;AACA,cAAI+9D,SAAS,GAAGD,UAAU,CAACpgE,QAAX,CAAoB;AAAE0B,gBAAI,EAAE4oD,QAAQ,CAACrf,QAAjB;AAA2BxrC,kBAAM,EAAE6qD,QAAQ,CAACzqD,OAA5C;AAAqDL,kBAAM,EAAE8qD,QAAQ,CAAC9qD;AAAtE,WAApB,CAAhB,CAHgC,CAKhC;;AACA,cAAI6gE,SAAS,CAACt3D,EAAV,GAAe,KAAKy4C,UAAL,CAAgBz4C,EAAnC,EAAuC;AACnCs3D,qBAAS,GAAG,KAAK7e,UAAjB;AACH;;AAED,eAAKue,mBAAL,CAAyBxyD,IAAzB,CAA8B8yD,SAA9B;;AACA,cAAI,KAAKzW,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAeyW,SAAf;AACH;;AAED,eAAKR,QAAL,CAAc/f,IAAd,CAAmBugB,SAAnB;AACA,eAAKrX,YAAL,GAAoB,KAApB;AACH;;;oCAEkB;AACf,cAAMtiC,WAAW,GAAG,KAAK1iB,QAAL,IAAiB,KAAKw9C,UAAL,CAAgB96B,WAArD;AACA,cAAMD,WAAW,GAAG,UAAA5d,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB0nB,WAApB,KAAoCA,WAAxD;AACA,eAAK1mB,QAAL,CAAc,IAAI,UAAAsQ,MAAJ,CAAW;AAAEmW,uBAAW,EAAXA,WAAF;AAAeC,uBAAW,EAAXA;AAAf,WAAX,CAAd;AACH;;;4CAI0B;AACvB,eAAKs5C,oBAAL;AACH;AACD;;AACA;;;;;;;mCAIkBV,c,EAAwB;AACtC,eAAKS,mBAAL,CAAyBxyD,IAAzB,CAA8B+xD,cAA9B;AACA,eAAKtW,YAAL,GAAoB,KAApB;AACH;;;yCAKuBhvB,Q,EAAmB;AACvC,eAAKA,QAAL,GAAgBA,QAAhB;AACH;AAED;;;;0CACyB;AACrB,eAAKywB,QAAL,CAAcC,SAAd;AACH;AAED;;;;yCACwB;AACpB,eAAKD,QAAL,CAAcE,QAAd;AACH;;;4BA/EoB;AACjB,iBAAO,KAAKoV,mBAAL,CAAyB7vD,IAAzB,CAA8B,YAAAjL,GAAA,CAAI,UAAA1E,CAAC,EAAI;AAC1C,gBAAM8K,OAAO,GAAG9K,CAAC,CAACG,UAAF,CAAa,iBAAb,CAAhB;AACA,6BAAU2K,OAAV,SAAoB9K,CAAC,CAACo8B,UAAF,CAAa,IAAI,UAAArsB,MAAJ,CAAW;AAAEmW,yBAAW,EAAE,KAAf;AAAsBC,yBAAW,EAAEnmB,CAAC,CAACmmB;AAArC,aAAX,CAAb,EAA6E,KAA7E,IAAsF,UAAtF,GAAmG,EAAvH;AACH,WAHoC,CAA9B,CAAP;AAIH;AAED;;;;4BACkB;AACd,iBAAO,KAAK+jC,QAAL,CAAcK,QAArB;AACH,S,CAED;;;;4BAC2B;AACvB,iBAAO,KAAKiV,mBAAL,CAAyB7vD,IAAzB,CAA8B,YAAAjL,GAAA,CAAI,UAAA1E,CAAC,EAAI;AAC1C,mBAAOA,CAAP;AACH,WAFoC,CAA9B,CAAP;AAIH;;;;MArE0C,OAAA1E,a;;AA5D/C;;;yDA4Da8jE,yB;AAAyB,K;;;YAAzBA,yB;AAAyB,0C;AAAA;AAAA;+BA6CvB,OAAA5U,c,EAAgB,I;+BAChB,oCAAAqU,6B,EAA+B,I;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uCAtD/B,CACP;AACIzsB,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAM2V,yBAAN;AAAA,SAAX,CAFjB;AAGI1V,aAAK,EAAE;AAHX,OADO,C,GAMV,6B;AAAA,e;AAAA,c;AAAA,wnB;AAAA;AAAA;AAvDG;AAMI;AACI;AAQI;AAAA,mBAAiB,IAAAe,cAAA,EAAjB;AAAiC,WAAjC;AAKJ;AACA;AACI;AAEJ;AACJ;AAEA;AAAgD;AAAA,mBAAS,IAAAsV,iBAAA,EAAT;AAA4B,WAA5B;AAC5C;AAAyB;AAAA,mBAASrV,MAAM,CAACr8C,eAAP,EAAT;AAAiC,WAAjC;AACrB;AAKI;AAAiB,gBAAA5O,QAAA;AAAkB,uBAAAkrD,eAAA;AAAiB,WAApD;;AACH;AACD;AAQJ;AACJ;AACJ;;;;;;AA7CI,qDAA6B,gBAA7B,EAA6B,cAA7B,EAA6B,YAA7B,EAA6B,cAA7B,EAA6B,OAA7B,EAA6B,SAA7B;AAK6B;AAAA;AAErB;AAAA,6DAAqC,WAArC,EAAqC,cAArC,EAAqC,QAArC,EAAqC,WAArC,EAAqC,YAArC,EAAqC,wBAArC;AAQA;AAFA;AAMiB;AAAA;AAGb;AAAA;AAQA;AAAA,kDAAqB,SAArB,EAAqB,+CAArB,EAAqB,SAArB,EAAqB,4DAArB;AASA;AAAA;;;;;;;0EAiBXyU,yB;;;;2BAAAA,yB,EAAyB;cA5DrC,OAAA1e,SA4DqC;eA5D3B;AACPjlD,kBAAQ,EAAE,qBADH;AAEPuxD,kBAAQ,6sEAFD;AAmDPpM,mBAAS,EAAE,CAAC,sCAAD,CAnDJ;AAoDPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAM2V,yBAAN;AAAA,aAAX,CAFjB;AAGI1V,iBAAK,EAAE;AAHX,WADO;AApDJ,S;AA4D2B,Q;;gBACjC,OAAAvrD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;gBAEA,OAAA1iD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAGA,OAAAA;;;gBAeA,OAAA+lD,S;iBAAU,OAAAsG,c,EAAgB;AAAE,sBAAQ;AAAV,W;;;gBAC1B,OAAAtG,S;iBAAU,oCAAA2a,6B,EAA+B;AAAC,sBAAQ;AAAT,W;;;;;;;;;;;;;;;;;;;;;;;;ACnI9C;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMY;AAA+C;AAAS;;;;;AAA/B;AAAsB;AAAA;;;;;;AAgBvC;AAII;;AAIJ;;;;;;AANI,gDAAsB,UAAtB,EAAsB,4BAAtB;AAGI;AAAA,2CAAiB,UAAjB,EAAiB,kDAAjB;;;;QAqBfmB,4B;;;;;AA9Cb;AAAA;;AAAA;;;AAyDI;AACA;;AACgB,iBAAAzrC,OAAA,GAAmB,KAAnB;AAEhB;;;;AAGgB,iBAAAzyB,cAAA,GAAkC,aAAAm+D,qBAAlC;AAUhB;;AACO,iBAAAl+D,KAAA,GAAQ,IAAI,OAAAzH,eAAJ,CAA4B,aAAA4lE,gBAA5B,CAAR;AAEA,iBAAAC,kBAAA,GAAqB,IAAI,OAAA7lE,eAAJ,CAAoB,UAAAgO,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAApB,CAArB;AAEA,iBAAA04D,iBAAA,GAAiC,IAAI,QAAA39B,WAAJ,EAAjC;AAEA,iBAAA4mC,WAAA,GAAc,OAAA5xC,aAAA,CAAc,CAAC,SAAK2oC,iBAAL,CAAuB18B,YAAxB,EAAsC,SAAK0lC,kBAA3C,CAAd,EAA8ExwD,IAA9E,CAEb,YAAAjL,GAAA,CAAI,kBAA+B;AAAA;AAAA,cAA7B3C,KAA6B;AAAA,cAAtBT,gBAAsB;;AAC/B;;;;AAIA,cAAMkH,EAAE,GAAG,UAAAs0C,sCAAA,CAAuCx7C,gBAAgB,CAACkH,EAAxD,EAA4DlH,gBAAgB,CAAC6kB,WAA7E,EAA0F3d,EAArG;AACA,iBAAO,OAAA3G,sBAAA,CAAuB,SAAKC,cAA5B,EAA4C0G,EAA5C,EAAgDzG,KAAhD,CAAP;AACH,SAPD,CAFa,CAAd;AAYA,iBAAA0f,OAAA,GAAU,IAAI,OAAAnnB,eAAJ,CAAyC,EAAzC,CAAV;AAEA,iBAAA+lE,iBAAA,GAAoB,SAAK5+C,OAAL,CAAa9R,IAAb,CACvB,YAAAjL,GAAA,CAAI,UAAA+c,OAAO;AAAA,iBAAIA,OAAO,CAACpf,IAAR,CAAa,UAAAonB,CAAC;AAAA,mBAAIA,CAAC,CAAC1nB,KAAF,KAAY,aAAAm+D,gBAAhB;AAAA,WAAd,CAAJ;AAAA,SAAX,CADuB,CAApB;AAIA,iBAAAI,cAAA,GAAiB,OAAA9xC,aAAA,CAAc,CAAC,SAAK/M,OAAN,EAAe,SAAK1f,KAApB,CAAd,EAA0C4N,IAA1C,CACpB,YAAAjL,GAAA,CAAI;AAAA;AAAA,cAAE+c,OAAF;AAAA,cAAW1f,KAAX;;AAAA,iBAAsB0f,OAAO,CAACpf,IAAR,CAAa,UAAAonB,CAAC;AAAA,mBAAIA,CAAC,CAAC1nB,KAAF,KAAYA,KAAhB;AAAA,WAAd,CAAtB;AAAA,SAAJ,CADoB,CAAjB;AAnGX;AA4KC;;;;mCArEqBqnB,M,EAA2B;AACzC,iBAAO,KAAKrnB,KAAL,CAAW4N,IAAX,CAAgB,YAAAjL,GAAA,CAAI,UAAAkJ,CAAC;AAAA,mBAAIA,CAAC,KAAKwb,MAAM,CAACrnB,KAAjB;AAAA,WAAL,CAAhB,CAAP;AACH;;;mCAEiBqnB,M,EAA2B;AACzC,iBAAO,KAAKmW,UAAL,GAAkBnW,MAAM,CAACrnB,KAAP,GAAe,KAAKw9B,UAAtC,GAAmD,KAA1D;AACH;;;mCAMO;AAAA;;AACJ,eAAK3iC,YAAL,CAAkB,oBAAlB,EACI,KAAKujE,kBAAL,CAAwBxwD,IAAxB,CACI,YAAAjL,GAAA,CAAI,UAAA1E,CAAC;AAAA,mBAAI,aAAAugE,iCAAA,CAAkCvgE,CAAlC,EAAqC,QAAI,CAAC8B,cAA1C,EAA0D,QAAI,CAAC0+D,QAA/D,CAAJ;AAAA,WAAL,CADJ,EAEE1jE,SAFF,CAEY,UAAAkQ,IAAI,EAAI;AAChB,oBAAI,CAACyU,OAAL,CAAazU,IAAb,CAAkBA,IAAlB;AACH,WAJD,CADJ;AAMH;;;oCAEkBzQ,O,EAAsB;AACrC,cAAIA,OAAO,CAACkH,QAAZ,EAAsB;AAClB,gBAAMg9D,IAAI,GAAG,aAAAF,iCAAA,CAAkC,KAAKJ,kBAAL,CAAwBp+D,KAA1D,EAAiE,KAAKD,cAAtE,EAAsF,KAAK0+D,QAA3F,CAAb;AACA,iBAAK/+C,OAAL,CAAazU,IAAb,CAAkByzD,IAAlB;AACH;;AACD,cAAIlkE,OAAO,CAACkN,WAAZ,EAAyB;AACrB,iBAAK02D,kBAAL,CAAwBnzD,IAAxB,CAA6BzQ,OAAO,CAACkN,WAAR,CAAoB/G,YAAjD;AACH;AACJ;AAED;;;;;;;iCAIgBumD,S,EAAiB;AAC7B,eAAK2W,UAAL,CAAgB3W,SAAhB;AACH;AAED;;;;;;;mCAIWrtC,G,EAAW;AAClB,eAAK7Z,KAAL,CAAWiL,IAAX,CAAgB4O,GAAhB;;AACA,cAAI,KAAKytC,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAeztC,GAAf;AACH;AACJ,S,CAED;AACA;AACA;;AAEA;;;;;;;yCAIwB/gB,E,EAAuB;AAC3C,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;AAED;;;;;;;0CAIyBA,E,EAAuB;AAC5C,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;;;4BA5DmB;;;AAChB,iBAAO,CAAP,WAAO,KAAKywD,YAAZ,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,GAAEqM,SAAnB,MAA4B,IAA5B,IAA4B,aAA5B,GAA4B,EAA5B,GAAgC,KAAvC;AACH;;;;MAnE6C,OAAAr8D,a;;AA9ClD;;;4DA8Ca0kE,4B;AAA4B,K;;;YAA5BA,4B;AAA4B,6C;AAAA;AAAA;;;;;;;;;;;;;;;;;;;uCAT1B,CACP;AACI5tB,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAMuW,4BAAN;AAAA,SAAX,CAFjB;AAGItW,aAAK,EAAE;AAHX,OADO,C,GAMV,6B,EAAA,uB;AAAA,e;AAAA,c;AAAA,gmB;AAAA;AAAA;AAxCG;AACI;AACA;AACI;AAMI;AAAA,mBAAe,IAAAjqD,QAAA,QAAf;AAA+B,WAA/B;;;AAEA;AACI;;AAIJ;AACA;;;;AASJ;AACA;AACI;AACJ;AACJ;AACJ;;;;;;;;AA9Be;AAAA;AAIH;AAAA,kDAAoD,UAApD,EAAoD,WAApD,EAAoD,OAApD,EAAoD,gCAApD;AASQ;AAAA,uDAAsD,aAAtD,EAAsD,qBAAtD;AAIJ;AAAA;AAUc;AAAA;;;;;;;;6EAezBugE,4B;;;;2BAAAA,4B,EAA4B;cA9CxC,OAAAtf,SA8CwC;eA9C9B;AACPjlD,kBAAQ,EAAE,wBADH;AAEPuxD,kBAAQ,8vDAFD;AAoCPpM,mBAAS,EAAE,CAAC,wCAAD,CApCJ;AAqCPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAMuW,4BAAN;AAAA,aAAX,CAFjB;AAGItW,iBAAK,EAAE;AAHX,WADO,CArCJ;AA4CPmQ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AA5C1B,S;AA8C8B,Q;;gBACpC,OAAA7lB;;;gBACA,OAAAA;;;gBACA,OAAAA;;;gBAKA,OAAAA;;;gBAEA,OAAAA;;;gBAGA,OAAAA;;;gBAKA,OAAAA;;;gBAQA,OAAA+lD,S;iBAAU,Q;;;;;;;;;;;;;;;;;;;;;;;;AC3Gf;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMY;AAA+C;AAE7C;;;;;AAFuB;AAAsB;AAAA;;;;;;AAwBvC;AAQI;AAIJ;;;;;;AANI;AAGI;AAAA,2CAAiB,UAAjB,EAAiB,4BAAjB;;;;QAyBfwc,wB;;;;;AA9Db;AAAA;;AAAA;;;AAoEI;;AACgB,iBAAAr/D,IAAA,GAAO,EAAP;AAChB;AACA;;AACA;;AACgB,iBAAAs/D,WAAA,GAAc,IAAd;AAChB;;AACgB,iBAAA1f,UAAA,GAAqB,UAAA34C,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAArB,CA3EpB,CA4EI;;AACgB,iBAAA81B,OAAA,GAAmB,KAAnB;AACA,iBAAAqsC,YAAA,GAAwB,KAAxB;AACA,iBAAAC,eAAA,GAA2B,KAA3B;AAShB;;AACO,iBAAA9B,cAAA,GAAiB,IAAI,OAAAzkE,eAAJ,CACpB,OAAAiF,mBAAA,CAAoB,UAAA+I,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAApB,EAAyC,SAAK4C,IAA9C,CADoB,CAAjB;AAIP;;AACO,iBAAAy/D,kBAAA,GAAqB,IAAI,OAAAxmE,eAAJ,CACxB,OAAAiP,6BAAA,CAA8B,SAAKw1D,cAAL,CAAoBh9D,KAAlD,CADwB,CAArB;AAIA,iBAAAo1D,iBAAA,GAAiC,IAAI,QAAA39B,WAAJ,EAAjC;AAEP;;AACO,iBAAA/X,OAAA,GAAU,IAAI,OAAAnnB,eAAJ,CACb,aAAAymE,wBAAA,CACI,UAAAz4D,OAAA,EADJ,EAEI,CAAC,SAAKq4D,WAFV,EAGI,SAAKt/D,IAHT,EAII,SAAKoC,QAJT,EAKI,SAAK8wB,OALT,EAMI,SAAKqsC,YAAL,GACM,CAACI,uBAAuB,CAAC,UAAA14D,OAAA,EAAD,CAAxB,CADN,GAEM,EARV,EASI,SAAKu4D,eATT,CADa,CAAV;AAyHP;;;;AAGO,iBAAAT,WAAA,GAAc,OAAA5xC,aAAA,CAAc,CAC/B,SAAK2oC,iBAAL,CAAuB18B,YADQ,EAE/B,SAAKskC,cAF0B,CAAd,EAGlBpvD,IAHkB,CAIjB,YAAAjL,GAAA,CAAI,kBAA6B;AAAA;AAAA,cAA3B3C,KAA2B;AAAA,cAApBg9D,cAAoB;;AAC7B,iBAAO,OAAA39D,kBAAA,CACH,SAAKC,IADF,EAEHU,KAFG,EAGH,QAAAP,QAAA,CAASqkB,GAAT,GAAenkB,OAAf,EAHG,CAAP;AAKH,SAND,CAJiB,CAAd;AAaP;;;;AAGO,iBAAA2+D,iBAAA,GAAoB,SAAK5+C,OAAL,CAAa9R,IAAb,CACvB,YAAAjL,GAAA,CAAI,UAACu8D,EAAD;AAAA,iBAAQA,EAAE,CAAClgE,MAAH,GAAY,CAAZ,IAAiBkgE,EAAE,CAAC,CAAD,CAA3B;AAAA,SAAJ,CADuB,CAApB;AAIP;;;;AAGO,iBAAAX,cAAA,GAAiB,OAAA9xC,aAAA,CAAc,CAClC,SAAK/M,OAD6B,EAElC,SAAKs9C,cAF6B,CAAd,EAGrBpvD,IAHqB,CAIpB,YAAAjL,GAAA,CAAI;AAAA;AAAA,cAAE+c,OAAF;AAAA,cAAWs9C,cAAX;;AAAA,iBACAt9C,OAAO,CAACpf,IAAR,CACI,UAAConB,CAAD;AAAA,mBACIA,CAAC,CAAC3e,OAAF,KAAc,OAAAvB,6BAAA,CAA8Bw1D,cAA9B,CADlB;AAAA,WADJ,CADA;AAAA,SAAJ,CAJoB,CAAjB;AAxPX;AA+VC;;;;mCA5OkB;AAAA;;AACX;AACA,eAAKt9C,OAAL,CAAazU,IAAb,CACI,aAAA+zD,wBAAA,CACI,KAAKhC,cAAL,CAAoBh9D,KADxB,EAEI,CAAC,KAAK4+D,WAFV,EAGI,KAAKt/D,IAHT,EAII,KAAKoC,QAJT,EAKI,KAAK8wB,OALT,EAMI,KAAKqsC,YAAL,GACM,CAACI,uBAAuB,CAAC,KAAKjC,cAAL,CAAoBh9D,KAArB,CAAxB,CADN,GAEM,EARV,EASI,KAAK8+D,eATT,CADJ,EAFW,CAeX;;AACA,eAAKjkE,YAAL,CACI,iBADJ,EAEI,OAAA4xB,aAAA,CAAc,CAAC,KAAKuwC,cAAN,CAAd,EACKpvD,IADL,CAEQ,YAAAjL,GAAA,CAAI,kBAAsB;AAAA;AAAA,gBAApBq6D,cAAoB;;AACtB;;;;AAIA,mBAAO,OAAAx/D,mBAAA,CAAoBw/D,cAApB,EAAoC,QAAI,CAAC19D,IAAzC,CAAP;AACH,WAND,CAFR,EASQ,YAAAylD,cAAA,CAAe,KAAKrlC,OAApB,CATR,EAUQ,YAAAhc,MAAA,CACI,kBAGM;AAAA;AAAA,gBAHJ5G,IAGI;AAAA,gBAHEqiE,WAGF;;AACF;AACA,mBAAO,CAACA,WAAW,CAAC7+D,IAAZ,CACJ,UAACuL,CAAD;AAAA,qBAAOA,CAAC,CAAC7L,KAAF,KAAYlD,IAAI,CAACsB,UAAL,CAAgB,OAAhB,CAAnB;AAAA,aADI,CAAR;AAGH,WATL,CAVR,EAqBQ,YAAAuE,GAAA,CAAI,kBAA2B;AAAA;AAAA,gBAAzBlF,MAAyB;AAAA,gBAAjB0hE,WAAiB;;AAC3B;AACA;AACAA,uBAAW,CAACx6D,IAAZ,CAAiB;AACboE,qBAAO,EAAE,OAAAvB,6BAAA,CAA8B/J,MAA9B,CADI;AAEb+gB,0BAAY,EAAE/gB,MAAM,CAACW,UAAP,CAAkB,QAAlB,CAFD;AAGb4B,mBAAK,EAAEvC;AAHM,aAAjB,EAH2B,CAS3B;;AACA0hE,uBAAW,CAACn6D,IAAZ,CAAiB,UAACC,CAAD,EAAIC,CAAJ;AAAA,qBACb,UAAGD,CAAC,CAACjF,KAAL,EAAamF,aAAb,WAA8BD,CAAC,CAAClF,KAAhC,EADa;AAAA,aAAjB;AAGA,mBAAOm/D,WAAP;AACH,WAdD,CArBR,EAqCKpkE,SArCL,CAqCe,UAACkQ,IAAD,EAAU;AACjB,mBAAO,QAAI,CAACyU,OAAL,CAAazU,IAAb,CAAkBA,IAAlB,CAAP;AACH,WAvCL,CAFJ;AA2CH;;;oCAEkBzQ,O,EAAsB;AACrC,cACIA,OAAO,CAAC2uD,aAAR,IACA3uD,OAAO,CAAC8E,IADR,IAEA9E,OAAO,CAAC0kD,UAFR,IAGA1kD,OAAO,CAACg4B,OAJZ,EAKE;AACE;AACA,iBAAK9S,OAAL,CAAazU,IAAb,CACI,aAAA+zD,wBAAA,CACI,KAAKhC,cAAL,CAAoBh9D,KADxB,EAEI,CAAC,KAAK4+D,WAFV,EAGI,KAAKt/D,IAHT,EAII,KAAKoC,QAJT,EAKI,KAAK8wB,OALT,EAMI,KAAKqsC,YAAL,GACM,CAACI,uBAAuB,CAAC,KAAKjC,cAAL,CAAoBh9D,KAArB,CAAxB,CADN,GAEM,EARV,EASI,KAAK8+D,eATT,CADJ,EAFF,CAeE;;AACA,gBACItkE,OAAO,CAACg4B,OAAR,IACA,CAACh4B,OAAO,CAACg4B,OAAR,CAAgB7xB,YADjB,IAEAnG,OAAO,CAACg4B,OAAR,CAAgB9xB,aAHpB,EAIE;AACE,mBAAKhD,QAAL,CAAc,KAAKgiB,OAAL,CAAa1f,KAAb,CAAmB,CAAnB,EAAsB+I,OAApC;AACH;AACJ;AACJ;AAED;;;;;;;AAoDA;;;;;;mCAMkBse,M,EAA8B;AAC5C,iBAAO,KAAK03C,kBAAL,CAAwB/+D,KAAxB,KAAkCqnB,MAAM,CAACte,OAAhD;AACH;AAED;;;;;;;yCAIwBjQ,E,EAAuB;AAC3C,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;AAED;;;;;;;0CAIyBA,E,EAAuB;AAC5C,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;AAED;;;;AAIA;AACA;AACA;;AAEA;;;;;;;0CAIyB2E,M,EAAgB;AACrC;AACA,eAAKshE,kBAAL,CAAwB9zD,IAAxB,CAA6B,OAAAzD,6BAAA,CAA8B/J,MAA9B,CAA7B;AACA,eAAKu/D,cAAL,CAAoB/xD,IAApB,CAAyBxN,MAAzB;;AACA,cAAI,KAAK6pD,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAe7pD,MAAf;AACH;AACJ;AAED;;;;;;;iCAIgB2hE,a,EAAqB;AACjC;AACA,cAAMC,SAAS,GAAG,KAAK3/C,OAAL,CAAa1f,KAAb,CAAmBM,IAAnB,CACd,UAACskD,GAAD;AAAA,mBAASA,GAAG,CAAC77C,OAAJ,KAAgBq2D,aAAzB;AAAA,WADc,EAEhBp/D,KAFF,CAFiC,CAKjC;;AACA,eAAKs/D,iBAAL,CAAuBD,SAAvB,EANiC,CAOjC;;AACA,cAAIA,SAAJ,EAAe;AACX,gBAAI,KAAK/X,SAAT,EAAoB;AAChB,mBAAKA,SAAL,CAAe+X,SAAf;AACH;AACJ;AACJ;AAED;;;;;;;mCAIkB5hE,M,EAAuB;AACrC;AACA,cAAIA,MAAM,IAAI,IAAd,EAAoB;AAChB;AACA,iBAAK6hE,iBAAL,CAAuB7hE,MAAvB,EAFgB,CAGhB;;AACA,iBAAKiiB,OAAL,CAAazU,IAAb,CACI,aAAA+zD,wBAAA,CACIvhE,MADJ,EAEI,CAAC,KAAKmhE,WAFV,EAGI,KAAKt/D,IAHT,EAII7B,MAAM,CAAC2mB,WAJX,EAKI,KAAKoO,OALT,EAMI,KAAKqsC,YAAL,GACM,CAACI,uBAAuB,CAACxhE,MAAD,CAAxB,CADN,GAEM,EARV,EASI,KAAKqhE,eATT,CADJ;AAaH;AACJ;;;4BA3ImB;;;AAChB,iBAAO,CAAP,WAAO,KAAKvV,YAAZ,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,GAAEqM,SAAnB,MAA4B,IAA5B,IAA4B,aAA5B,GAA4B,EAA5B,GAAgC,KAAvC;AACH;AAED;;;;;;4BAGmB;AACf,iBAAO,KAAK1W,UAAL,CAAgB96B,WAAvB;AACH;;;;MA7JO,OAAA7qB,a;;AA/DZ;;;wDA8DaolE,wB;AAAwB,K;;;YAAxBA,wB;AAAwB,yC;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;uCATtB,CACP;AACItuB,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAMiX,wBAAN;AAAA,SAAX,CAFjB;AAGIhX,aAAK,EAAE;AAHX,OADO,C,GAMV,6B,EAAA,uB;AAAA,e;AAAA,c;AAAA,wkB;AAAA;AAAA;AAxDG;AACI;AAGA;AACI;AAMI;AAAA,mBAAe,IAAAjqD,QAAA,QAAf;AAA+B,WAA/B;;;AAGA;AACI;;;AASJ;AACA;;;;AAaJ;AACA;AACI;AAKJ;AACJ;AACJ;;;;;;;;AA9Ce;AAAA;AAMH;AAAA,kDAAoD,UAApD,EAAoD,WAApD,EAAoD,OAApD,EAAoD,6CAApD;AAUQ;AAAA,uDAIC,aAJD,EAIC,qBAJD;AASJ;AAAA;AAeA;AAAA;;;;;;;;yEAkBXihE,wB;;;;2BAAAA,wB,EAAwB;cA9DpC,OAAAhgB,SA8DoC;eA9D1B;AACPjlD,kBAAQ,EAAE,oBADH;AAEPuxD,kBAAQ,2rEAFD;AAoDPpM,mBAAS,EAAE,CAAC,qCAAD,CApDJ;AAqDPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAMiX,wBAAN;AAAA,aAAX,CAFjB;AAGIhX,iBAAK,EAAE;AAHX,WADO,CArDJ;AA4DPmQ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AA5D1B,S;AA8D0B,Q;;gBAIhC,OAAA7lB;;;gBACA,OAAAA;;;gBAEA,OAAAA;;;gBAIA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBACA,OAAAA;;;gBACA,OAAAA;;;gBAQA,OAAA+lD,S;iBAAU,Q;;;;;AA0Qf,aAAS8c,uBAAT,CAAiCxhE,MAAjC,EAA+C;AAC3C,aAAO;AACHsL,eAAO,EAAE,OAAAvB,6BAAA,CAA8B/J,MAA9B,CADN;AAEH+gB,oBAAY,EAAE/gB,MAAM,CAACW,UAAP,CAAkB,QAAlB,CAFX;AAGH4B,aAAK,EAAEvC;AAHJ,OAAP;AAKH;;;;;;;;;;;;;;;;;;;;;ACzYD;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsBoB;AAII;;AAIJ;;;;;;AANI,gDAAsB,UAAtB,EAAsB,4BAAtB;AAGI;AAAA,2CAAiB,UAAjB,EAAiB,kDAAjB;;;;QAqBforD,sB;;;;;AA9Cb;AAAA;;AAAA;;;AA2DI;;AACgB,iBAAAnnD,QAAA,GAAoB,IAAI,UAAAsM,MAAJ,CAAW;AAAElR,cAAI,EAAEJ,IAAI,CAAConB,GAAL;AAAR,SAAX,EAAiCy1B,QAArD;AAEhB;;;;AAGgB,iBAAAx5C,cAAA,GAAkC,aAAAm+D,qBAAlC;AAUT,iBAAAl+D,KAAA,GAAQ,IAAI,OAAAzH,eAAJ,CAA4B,aAAA4lE,gBAA5B,CAAR;AAEA,iBAAA5+D,gBAAA,GAAmB,IAAI,OAAAhH,eAAJ,CAAoB,UAAAgO,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAApB,CAAnB;AAEA,iBAAA04D,iBAAA,GAAiC,IAAI,QAAA39B,WAAJ,EAAjC;AAEA,iBAAA4mC,WAAA,GAAc,OAAA5xC,aAAA,CAAc,CAAC,SAAK2oC,iBAAL,CAAuB18B,YAAxB,EAAsC,SAAKn5B,gBAA3C,CAAd,EAA4EqO,IAA5E,CACjB,YAAAjL,GAAA,CAAI;AAAA;AAAA,cAAE3C,KAAF;AAAA,cAAST,gBAAT;;AAAA,iBAA+B,OAAAO,sBAAA,CAAuB,SAAKC,cAA5B,EAA4CR,gBAAgB,CAACkH,EAA7D,EAAiEzG,KAAjE,CAA/B;AAAA,SAAJ,CADiB,CAAd;AAIA,iBAAA0f,OAAA,GAAU,IAAI,OAAAnnB,eAAJ,CAAyC,EAAzC,CAAV;AAEA,iBAAA+lE,iBAAA,GAAoB,SAAK5+C,OAAL,CAAa9R,IAAb,CACvB,YAAAjL,GAAA,CAAI,UAAA+c,OAAO;AAAA,iBAAIA,OAAO,CAACpf,IAAR,CAAa,UAAAonB,CAAC;AAAA,mBAAIA,CAAC,CAAC1nB,KAAF,KAAY,aAAAm+D,gBAAhB;AAAA,WAAd,CAAJ;AAAA,SAAX,CADuB,CAApB;AAIA,iBAAAI,cAAA,GAAiB,OAAA9xC,aAAA,CAAc,CAAC,SAAK/M,OAAN,EAAe,SAAK1f,KAApB,CAAd,EAA0C4N,IAA1C,CACpB,YAAAjL,GAAA,CAAI;AAAA;AAAA,cAAE+c,OAAF;AAAA,cAAW1f,KAAX;;AAAA,iBAAsB0f,OAAO,CAACpf,IAAR,CAAa,UAAAonB,CAAC;AAAA,mBAAIA,CAAC,CAAC1nB,KAAF,KAAYA,KAAhB;AAAA,WAAd,CAAtB;AAAA,SAAJ,CADoB,CAAjB;AA3FX;AAsKC;;;;mCAvEqBqnB,M,EAA2B;AACzC,iBAAO,KAAKrnB,KAAL,CAAW4N,IAAX,CAAgB,YAAAjL,GAAA,CAAI,UAAAkJ,CAAC;AAAA,mBAAIA,CAAC,KAAKwb,MAAM,CAACrnB,KAAjB;AAAA,WAAL,CAAhB,CAAP;AACH;;;mCAEiBqnB,M,EAA2B;AACzC,iBAAO,KAAKmW,UAAL,GAAkBnW,MAAM,CAACrnB,KAAP,GAAe,KAAKw9B,UAAtC,GAAmD,KAA1D;AACH;;;mCAMO;AAAA;;AACJ,eAAK3iC,YAAL,CAAkB,oBAAlB,EACI,KAAK0E,gBAAL,CAAsBqO,IAAtB,CACI,YAAAjL,GAAA,CAAI,UAAA1E,CAAC;AAAA,mBAAI,aAAAugE,iCAAA,CAAkCvgE,CAAC,CAACiJ,MAAF,CAAS,QAAI,CAACxF,QAAd,CAAlC,EAA2D,QAAI,CAAC3B,cAAhE,EAAgF,QAAI,CAAC0+D,QAArF,CAAJ;AAAA,WAAL,CADJ,EAEE1jE,SAFF,CAEY,UAAAkQ,IAAI,EAAI;AAChB,oBAAI,CAACyU,OAAL,CAAazU,IAAb,CAAkBA,IAAlB;AACH,WAJD,CADJ;AAMH;;;oCAEkBzQ,O,EAAsB;AACrC,cAAIA,OAAO,CAACkH,QAAZ,EAAsB;AAClB,gBAAMg9D,IAAI,GAAG,aAAAF,iCAAA,CAAkC,KAAKj/D,gBAAL,CAAsBS,KAAtB,CAA4BkH,MAA5B,CAAmC,KAAKxF,QAAxC,CAAlC,EAAqF,KAAK3B,cAA1F,EAA0G,KAAK0+D,QAA/G,CAAb;AACA,iBAAK/+C,OAAL,CAAazU,IAAb,CAAkByzD,IAAlB;AACH;;AACD,cAAIlkE,OAAO,CAACgE,SAAZ,EAAuB;AACnB;AACA,gBAAM1B,IAAI,GAAG,IAAI,UAAAkR,MAAJ,CAAW;AAAClR,kBAAI,EAAE,KAAK0B;AAAZ,aAAX,CAAb;AACA,iBAAKe,gBAAL,CAAsB0L,IAAtB,CAA2BnO,IAA3B;AACH;AACJ;AAED;;;;;;;iCAIgBoqD,S,EAAiB;AAC7B,eAAK2W,UAAL,CAAgB3W,SAAhB;AACH;AAED;;;;;;;mCAIWrtC,G,EAAW;AAClB,eAAK7Z,KAAL,CAAWiL,IAAX,CAAgB4O,GAAhB;;AACA,cAAI,KAAKytC,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAeztC,GAAf;AACH;AACJ;;;yCAEuB6d,Q,EAAmB;AACvC,eAAKA,QAAL,GAAgBA,QAAhB;AACH;AAED;;;;;;;yCAIwB5+B,E,EAAuB;AAC3C,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;AAED;;;;;;;0CAIyBA,E,EAAuB;AAC5C,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;;;4BA9DmB;;;AAChB,iBAAO,CAAP,WAAO,KAAKywD,YAAZ,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,GAAEqM,SAAnB,MAA4B,IAA5B,IAA4B,aAA5B,GAA4B,EAA5B,GAAgC,KAAvC;AACH;;;;MA3DuC,OAAAr8D,a;;AA9C5C;;;sDA8CasvD,sB;AAAsB,K;;;YAAtBA,sB;AAAsB,yC;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;uCATpB,CACP;AACIxY,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAMmB,sBAAN;AAAA,SAAX,CAFjB;AAGIlB,aAAK,EAAE;AAHX,OADO,C,GAMV,6B,EAAA,uB;AAAA,e;AAAA,c;AAAA,okB;AAAA;AAAA;AAxCG;AACI;AAAiC;AAAS;AAC1C;AACI;AAMI;AAAA,mBAAe,IAAAjqD,QAAA,QAAf;AAA+B,WAA/B;;;AAEA;AACI;;AAIJ;AACA;;;;AASJ;AACA;AACI;AACJ;AACJ;AACJ;;;;;;;;AA9Be;AAAA;AAAsB;AAAA;AAIzB;AAAA,kDAAoD,OAApD,EAAoD,gCAApD,EAAoD,UAApD,EAAoD,YAApD;AASQ;AAAA,uDAAsD,aAAtD,EAAsD,qBAAtD;AAIJ;AAAA;AAUc;AAAA;;;;;;;;uEAezBmrD,sB;;;;2BAAAA,sB,EAAsB;cA9ClC,OAAAlK,SA8CkC;eA9CxB;AACPjlD,kBAAQ,EAAE,oBADH;AAEPuxD,kBAAQ,+uDAFD;AAoCPpM,mBAAS,EAAE,CAAC,gCAAD,CApCJ;AAqCPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAMmB,sBAAN;AAAA,aAAX,CAFjB;AAGIlB,iBAAK,EAAE;AAHX,WADO,CArCJ;AA4CPmQ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AA5C1B,S;AA8CwB,Q;;gBAC9B,OAAA7lB;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAGA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAKA,OAAAA;;;gBAQA,OAAA+lD,S;iBAAU,Q;;;;;;;;;;;;;;;;;;;;;;;;AC9Gf;AAAA;AAAA;;;;;;;;QAgBaod,qB,GAET,iCAAc;AAAA;AACb,K;;AAjBL;;;uBAcaA,qB;AAAqB,K;;;YAArBA,qB;AAAqB,wC;AAAA,6B;AAAA,c;AAAA,a;AAAA,0F;AAAA;AAAA;;AAX1B;AACI;AACI;AACA;AACI;AACJ;AACJ;AACJ;;;;;;;;2BAIKA,qB,EAAqB;cAdjC,OAAA5gB,SAciC;eAdvB;AACPjlD,kBAAQ,EAAE,mBADH;AAEPuxD,kBAAQ,yRAFD;AAYPpM,mBAAS,EAAE,CAAC,gCAAD;AAZJ,S;AAcuB,Q;;;;;;;;;;;;;;;;;;;;;;;;AChBlC;AAAA;AAAA;;AAKA;AAAA;AAAA;;;;;;;;;;;;AAMY;AAAA;AACI;AAIJ;;;;;AAHU;AAAA;;;;QAOT2gB,qB;;;;;AAKT,qCAAYnG,KAAZ,EAAqC;AAAA;;AAAA,mCAC3BA,KAD2B;AAEpC;;;MAPsC,0BAAAD,qB;;AAb3C;;;uBAaaoG,qB,EAAqB,yC;AAAA,K;;;YAArBA,qB;AAAqB,wC;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,4nB;AAAA;AAAA;AAV1B;;;;;;;;;2BAUKA,qB,EAAqB;cAbjC,OAAA7gB,SAaiC;eAbvB;AACPjlD,kBAAQ,EAAE,mBADH;AAEPuxD,kBAAQ;AAFD,S;AAauB,Q;;;;;;gBAE7B,OAAA7uD;;;;;;;;;;;;;;;;;;;;;;;;ACtBL;AAAA;AAAA;;AAKA;AAAA;AAAA;;;;;;;;;;;;AAMY;AACI;AACI;AAAA;AACI;AAKJ;AACJ;AACJ;;;;;AATkC;AAAA;AAIlB;AAAA;;;;QAgBfqjE,oB;;;;;AAQT,oCAAYpG,KAAZ,EAAqC;AAAA;;AAAA,mCAC3BA,KAD2B;AAEpC;;;MAVqC,0BAAAD,qB;;AAzB1C;;;uBAyBaqG,oB,EAAoB,yC;AAAA,K;;;YAApBA,oB;AAAoB,uC;AAAA;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,yQ;AAAA;AAAA;AAtBzB;;;;;;;;;2BAsBKA,oB,EAAoB;cAzBhC,OAAA9gB,SAyBgC;eAzBtB;AACPjlD,kBAAQ,EAAE,kBADH;AAEPuxD,kBAAQ;AAFD,S;AAyBsB,Q;;;;;;gBAE5B,OAAA7uD;;;gBAGA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;ACrCL;AAAA;AAAA;;;;;;;;;;QAoBasjE,kB;AAKT,oCAAc;AAAA;AACb;;;;mCAEO,CACP;;;;;;AAvBL;;;uBAcaA,kB;AAAkB,K;;;YAAlBA,kB;AAAkB,qC;AAAA;AAAA;AAAA,O;AAAA,c;AAAA,a;AAAA,suB;AAAA;AAAA;AAXvB;AAAA;AACI;AAGA;AAIJ;;;;AALU;AAAA;AAGA;AAAA;;;;;;;;;2BAKLA,kB,EAAkB;cAd9B,OAAA/gB,SAc8B;eAdpB;AACPjlD,kBAAQ,EAAE,gBADH;AAEPuxD,kBAAQ;AAFD,S;AAcoB,Q;;;;gBAE1B,OAAA7uD;;;;;;;;;;;;;;;;;;;;;;;;ACtBL;AAAA;AAAA;;AAMA;AAAA;AAAA;;;;;;;;AAOgB;AACI;AACI;AACI;AACJ;AACJ;AACJ;;;;;AAHiB;AAAA,+CAAAitB,GAAA;;;;QAUpBs2C,2B;;;;;AAKT,2CAAYtG,KAAZ,EAAqC;AAAA;;AAAA,mCAC3BA,KAD2B;AAEpC;;;MAP4C,0BAAAD,qB;;AAlBjD;;;uBAkBauG,2B,EAA2B,yC;AAAA,K;;;YAA3BA,2B;AAA2B,8C;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,gG;AAAA;AAAA;AAd5B;;;;;;;;;2BAcCA,2B,EAA2B;cAlBvC,OAAAhhB,SAkBuC;eAjBpC;AACIjlD,kBAAQ,EAAE,yBADd;AAEIuxD,kBAAQ,mWAFZ;AAaIpM,mBAAS,EAAE,CAAC,sCAAD,CAbf;AAcIiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AAdrC,S;AAiBoC,Q;;;;;;gBAEnC,OAAA7lB;;;;;;;;;;;;;;;;;;;;;;;;AC5BL;AAAA;AAAA;;AAMA;AAAA;AAAA;;;;;;;;;;;;;;;;AAQgB;AAA6C;AAAC;;;;;;AAFlD;AACI;AACA;AACJ;;;;;AADgC;AAAA;;;;;;QAM/BwjE,c;;;;;AAKT,8BAAYvG,KAAZ,EAAqC;AAAA;;AAAA;;AACjC,uCAAMA,KAAN;AAHJ,iBAAAzhC,QAAA,GAAW,KAAX;AAEqC;AAEpC;;;MAP+B,0BAAAwhC,qB;;AAZpC;;;uBAYawG,c,EAAc,yC;AAAA,K;;;YAAdA,c;AAAc,gC;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,6B;AAAA,c;AAAA,a;AAAA,2E;AAAA;AAAA;;AATnB;;;;;;;;;2BASKA,c,EAAc;cAZ1B,OAAAjhB,SAY0B;eAZhB;AACPjlD,kBAAQ,EAAE,WADH;AAEPuxD,kBAAQ,kOAFD;AAUPpM,mBAAS,EAAE,CAAC,wBAAD;AAVJ,S;AAYgB,Q;;;;;;gBAEtB,OAAAziD;;;;;;;;;;;;;;;;;;;;;;;;ACtBL;AAAA;AAAA;;AAMA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAeoB;AAII;AAII;AACJ;AACJ;;;;;AATI,wCAAiB,OAAjB,EAAiB,eAAjB;AAII;AAAA,8CAAuB,QAAvB,EAAuB,SAAvB,EAAuB,UAAvB,EAAuB,KAAvB;AAGK;AAAA;;;;QAkBpByjE,uB;AAtCb;AAAA;;AA4CW,aAAAngD,OAAA,GAA+B,EAA/B;AAeV;;;;2CAH0B;AACnB,iBAAO,KAAKogD,MAAL,IAAe,KAAKC,eAApB,GAAsC,KAAKA,eAA3C,GAA6D,KAAKC,WAAzE;AACH;;;4BANmB;;;AAChB,iBAAO,CAAP,WAAO,KAAKzW,YAAZ,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,GAAEqM,SAAnB,MAA4B,IAA5B,IAA4B,aAA5B,GAA4B,EAA5B,GAAgC,KAAvC;AACH;;;;;;AAtDL;;;uBAsCaiK,uB;AAAuB,K;;;YAAvBA,uB;AAAuB,0C;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;AAnC5B;AACI;AAGI;AAKI;AAWJ;AACA;AAAiC;AAAwB;AACzD;AAIA;AACI;AACJ;AACJ;AACJ;;;;AAnBgB;AAAA;AAUyB;AAAA;AAG7B;AAAA;AAGkB;AAAA;;;;;;;;;;2BAQzBA,uB,EAAuB;cAtCnC,OAAAlhB,SAsCmC;eAtCzB;AACPjlD,kBAAQ,EAAE,qBADH;AAEPuxD,kBAAQ,khDAFD;AAmCPpM,mBAAS,EAAE,CAAC,kCAAD,CAnCJ;AAoCPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AApC1B,S;AAsCyB,Q;;gBAE/B,OAAA7lB;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAIA,OAAA+lD,S;iBAAU,Q;;;;;;;;;;;;;;;;;;;;;;;;AC3Df;AAAA;AAAA;;AASA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUY;AAAgD;AAAI;;;;AAAzC;;;;;;AAcP;AAAwC;;AAAwB;;;;;AAAxB;AAAA;;;;;;;;;;;;QAmC3C8d,sB;;;;;AAzDb;AAAA;;AAAA;;;AA0DI;;AACsB,iBAAApY,KAAA,GAAgB,UAAAthD,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAApC;AAGtB;;AACgB,iBAAAqhD,QAAA,GAA6B,OAA7B;AAChB;;AACgB,iBAAAtnD,MAAA,GAA2B,QAA3B;AAGhB;;AACgB,iBAAA88D,SAAA,GAAqB,KAArB;AAMC,iBAAAC,QAAA,GAAW,IAAI,OAAAnhB,YAAJ,EAAX;AAmBjB;;AACO,iBAAA8jB,SAAA,GAAY,IAAI,OAAA3nE,eAAJ,CAA4B,UAAAgO,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAA5B,CAAZ;;AA0DA,iBAAAghE,oBAAA,GAAuB;AAAA,iBAAM,SAAKC,cAAL,CAAoBjK,UAApB,EAAN;AAAA,SAAvB;;AAzJX;AAyMC,O,CA5HG;;;;;mCACe;AACX,cAAI,KAAKyM,oBAAT,EAA+B;AAC3B,iBAAKtC,UAAL,CAAgB,KAAKsC,oBAArB;AACH;AACJ;AAeD;;;;;AA4BA;;;;iCAIgBjZ,S,EAAmB;AAC/B;AACA,cAAMc,QAAQ,GAAG,KAAKkY,SAAL,CAAelgE,KAAhC;AACA,cAAM/B,CAAC,GAAG,IAAI,UAAA+P,MAAJ,CAAW;AAAClR,gBAAI,EAAEoqD;AAAP,WAAX,CAAV;AACA,cAAIgB,QAAQ,GAAGjqD,CAAC,CACXP,QADU,CACD;AAAE0B,gBAAI,EAAE4oD,QAAQ,CAACrf,QAAjB;AAA2BxrC,kBAAM,EAAE6qD,QAAQ,CAACzqD;AAA5C,WADC,EAEVkJ,EAFL,CAJ+B,CAO/B;;AACA,cAAIyhD,QAAQ,GAAG,KAAKz7C,IAApB,EAA0B;AACtBy7C,oBAAQ,GAAG,KAAKz7C,IAAhB;AACH;;AACD,cAAMw7C,KAAK,GAAG,IAAI,UAAAj6C,MAAJ,CAAW;AAAElR,gBAAI,EAAEorD;AAAR,WAAX,CAAd;AACA,eAAKgY,SAAL,CAAej1D,IAAf,CAAoBg9C,KAApB;;AACA,cAAI,KAAKX,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAeY,QAAf;AACH;;AACD,eAAKqV,QAAL,CAAc/f,IAAd,CAAmB0K,QAAnB;AACA,eAAKxB,YAAL,GAAoB,KAApB;AACH;;;oCAEkB;AACf,eAAKhpD,QAAL,CAAc,UAAA6I,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAAlC;AACH;;;4CAI0B;AACvB,eAAKi3D,oBAAL;AACH;AAED;;AACA;;;;;;;mCAIkB19D,K,EAAe;AAC7B,cAAMlD,IAAI,GAAG,IAAI,UAAAkR,MAAJ,CAAW;AAAClR,gBAAI,EAAEkD;AAAP,WAAX,CAAb;AACA,eAAKkgE,SAAL,CAAej1D,IAAf,CAAoBnO,IAApB;AACA,eAAK4pD,YAAL,GAAoB,KAApB;AACH;AAED;;AACA;;;;;;;yCAIwB5tD,E,EAAuB;AAC3C,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;AAED;;AACA;;;;;;;0CAIyBA,E,EAAuB;AAC5C,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;;;yCAEuB4+B,Q,EAAmB;AACvC,eAAKA,QAAL,GAAgBA,QAAhB;AACH;AAED;;;;0CACyB;AACrB,eAAKywB,QAAL,CAAcC,SAAd;AACH;AAED;;;;yCACwB;AACpB,eAAKD,QAAL,CAAcE,QAAd;AACH;;;4BAtGc;AACX,iBAAO,KAAKR,KAAL,IAAc,UAAAthD,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB8J,YAApB,CAAiC,KAAjC,EAAwCC,EAA7D;AACH;AAED;;;;4BACgB;AACZ,iBAAO,KAAK6hD,GAAL,IAAY,UAAA/hD,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoBqwB,UAApB,CAA+B,KAA/B,EAAsCpvB,QAAtC,CAA+C;AAAE4qD,iBAAK,EAAE;AAAT,WAA/C,EAA6D9hD,EAAhF;AACH;AAED;;;;4BACqB;AACjB,iBAAO,KAAKy5D,SAAL,CAAetyD,IAAf,CAAoB,YAAAjL,GAAA,CAAI,UAAA1E,CAAC,EAAI;AAChC,gBAAM8K,OAAO,GAAG9K,CAAC,CAACG,UAAF,CAAa,iBAAb,CAAhB;AACA,6BAAU2K,OAAV,SAAoB9K,CAAC,CAACo8B,UAAF,CAAa,UAAA9zB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAb,EAAkC,KAAlC,IAA2C,UAA3C,GAAwD,EAA5E;AACH,WAH0B,CAApB,CAAP;AAIH;AAED;;;;4BACkB;AACd,iBAAO,KAAKyrD,QAAL,CAAcK,QAArB;AACH;;;4BAEc;AACX,iBAAO,KAAK0X,SAAZ;AAEH;;;;MAlEuC,OAAA3mE,a;;AAzD5C;;;sDAyDa0mE,sB;AAAsB,K;;;YAAtBA,sB;AAAsB,sC;AAAA;AAAA;+BAkCpB,OAAAxX,c,EAAgB,I;+BAChB,4BAAA6J,sB,EAAwB,I;;;;;;;;;;;;;;;;;;;;;;;uCA3CxB,CACP;AACIjiB,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAMuY,sBAAN;AAAA,SAAX,CAFjB;AAGItY,aAAK,EAAE;AAHX,OADO,C,GAMV,6B;AAAA,e;AAAA,c;AAAA,whB;AAAA;AAAA;AApDG;AAKI;AACA;AASI;AAAA,mBAAiB,IAAAe,cAAA,EAAjB;AAAiC,WAAjC;AAIA;AACA;AACI;AAEJ;AACJ;AAEA;AAAgD;AAAA,mBAAS,IAAAsV,iBAAA,EAAT;AAA4B,WAA5B;AAC5C;AAAkD;AAAA,mBAASrV,MAAM,CAACr8C,eAAP,EAAT;AAAiC,WAAjC;AAC9C;AAII;AAAiB,gBAAA5O,QAAA;AAAkB,uBAAAkrD,eAAA;AAAiB,WAApD;;AACH;AACD;AAII;AAAA,mBAAS,IAAAwX,SAAA,EAAT;AAAoB,WAApB;AACH;AACD;AACJ;AACJ;AACJ;;;;;;AA1CI,qDAA6B,gBAA7B,EAA6B,cAA7B,EAA6B,YAA7B,EAA6B,cAA7B;AAI6B;AAAA;AAEzB;AAAA,6DAAqC,WAArC,EAAqC,cAArC,EAAqC,YAArC,EAAqC,WAArC,EAAqC,QAArC,EAAqC,WAArC;AASA;AAFA;AAKqB;AAAA;AAGb;AAAA;AAQA;AAAA,qEAAwB,SAAxB,EAAwB,gDAAxB;;;;;;;uEAwBXH,sB;;;;2BAAAA,sB,EAAsB;cAzDlC,OAAAthB,SAyDkC;eAzDxB;AACPjlD,kBAAQ,EAAE,iBADH;AAEPuxD,kBAAQ,q+DAFD;AAgDPpM,mBAAS,EAAE,CAAC,kCAAD,CAhDJ;AAiDPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAMuY,sBAAN;AAAA,aAAX,CAFjB;AAGItY,iBAAK,EAAE;AAHX,WADO;AAjDJ,S;AAyDwB,Q;;gBAE9B,OAAAvrD,K;iBAAM,M;;;gBAEN,OAAAA,K;iBAAM,I;;;gBAEN,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;gBAgBA,OAAAqD,S;iBAAU,OAAAsG,c,EAAgB;AAAE,sBAAQ;AAAV,W;;;gBAC1B,OAAAtG,S;iBAAU,4BAAAmQ,sB,EAAwB;AAAC,sBAAQ;AAAT,W;;;;;;;;;;;;;;;;;;;;;;;;ACrHvC;AAAA;AAAA;;AAOA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;AAeoB;AAII;AAAA;AAAA;AAAA,iBAAS,OAAA+N,eAAA,OAAT;AAA+B,SAA/B;AAGA;AACJ;;;;;AAHI;AAEA;AAAA;;;;;;;;AAEJ;AAII;AAAA;AAAA;AAAA,iBAAS,OAAAC,aAAA,OAAT;AAA6B,SAA7B;AAGA;AAEJ;;;;;AAJI;AAEA;AAAA;;;;;;AAzBZ;AAGI;AAKA;AACI;AASA;AAUJ;AACJ;;;;;AA3BI;AAEI;AAAA;AAIuC;AAAA;AAEnC;AAAA;AASA;AAAA;;;;QAeXC,uB;;;;;AAyCT,uCAAYlH,KAAZ,EAAqC;AAAA;;AAAA;;AACjC,uCAAMA,KAAN;AArCJ;;;;AAIA,iBAAAmH,eAAA,GAA4B,KAA5B;AAEA;;;;AAIO,iBAAAF,aAAA,GAAgB,IAAI,OAAAlkB,YAAJ,EAAhB;AASP,iBAAAqkB,YAAA,GAAwB,KAAxB;AAEA;;;;AAIA,iBAAAC,iBAAA,GAA8B,KAA9B;AAEA;;;;AAIO,iBAAAL,eAAA,GAAkB,IAAI,OAAAjkB,YAAJ,EAAlB;AAGP,iBAAAukB,YAAA,GAAyB,KAAzB;AAEqC;AAEpC;;;MA3CwC,0BAAAvH,qB;;AAtC7C;;;uBAsCamH,uB,EAAuB,yC;AAAA,K;;;YAAvBA,uB;AAAuB,2C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,+rB;AAAA;AAAA;AAnC5B;;;;;;;;;2BAmCKA,uB,EAAuB;cAtCnC,OAAA5hB,SAsCmC;eAtCzB;AACPjlD,kBAAQ,EAAE,sBADH;AAEPuxD,kBAAQ,g4CAFD;AAoCPpM,mBAAS,EAAE,CAAC,mCAAD;AApCJ,S;AAsCyB,Q;;;;;;gBAE/B,OAAAziD;;;gBAMA,OAAAA;;;gBAMA,OAAA0iD;;;gBAMA,OAAA1iD;;;gBAGA,OAAAA;;;gBAMA,OAAAA;;;gBAMA,OAAA0iD;;;gBAGA,OAAA1iD;;;;;;;;;;;;;;;;;;;;;;;;ACrFL;AAAA;AAAA;;AAIA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;AAQoB;AAA+D;AAAA;AAAA;AAAA;AAAA;AAC3D;AACJ;;;;;;AAGA;AAA2D;AAAU;;;;;AAAV;AAAA;;;;;;QAQlEwkE,c;AAMT,8BAAoB3/B,SAApB,EAA6D;AAAA;;AAAzC,aAAAA,SAAA,GAAAA,SAAA;AAFX,aAAA4/B,WAAA,GAAwB,IAAxB;AAGR;;;;gCAEc;AACX,eAAK5/B,SAAL,CAAeC,KAAf;AACH;;;;;;AA9BL;;;uBAmBa0/B,c,EAAc,qC;AAAA,K;;;YAAdA,c;AAAc,gC;AAAA;AAAA;AAAA;AAAA,O;AAAA,6B;AAAA,c;AAAA,a;AAAA,mb;AAAA;AAAA;;AAhBnB;AACI;AACI;AACI;AAGJ;AACA;AACI;AACJ;AACJ;AACA;AACJ;;;;AAToB;AAAA;AAKoC;AAAA;;;;;;;;;2BAQnDA,c,EAAc;cAnB1B,OAAAjiB,SAmB0B;eAnBhB;AACPjlD,kBAAQ,EAAE,WADH;AAEPuxD,kBAAQ,8rBAFD;AAiBPpM,mBAAS,EAAE,CAAC,wBAAD;AAjBJ,S;AAmBgB,Q;;;;;;gBAEtB,OAAAziD;;;gBAEA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AC7BL;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;ACsBY;AACI;AAAI;AAAoB;AAC5B;;;;;;AADQ;AAAA;;;;QDfP0kE,6B;AAOX,6CAA6Cx7B,KAA7C,EAAiF;AAAA;;AAApC,aAAAA,KAAA,GAAAA,KAAA;AAF5B,aAAA96B,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AAIhB;;;;mCAEc;AACX,eAAKrpB,KAAL,GAAa,KAAKuS,KAAL,CAAWvS,KAAX,CAAiB/tB,IAAjB,CAAsB,UAACC,CAAD,EAAIC,CAAJ;AAAA,mBAAWD,CAAC,GAAGC,CAAf;AAAA,WAAtB,CAAb;AACH;;;mCAEiBpI,I,EAAc;AAC9B,cAAM2hD,MAAM,GAAG,IAAI,UAAAzwC,MAAJ,CAAW;AAAClR,gBAAI,EAAEA,IAAI,GAAC,IAAZ;AAAkBqnB,uBAAW,EAAE,KAA/B;AAAsCC,uBAAW,EAAE,KAAKkhB,KAAL,CAAW5jC;AAA9D,WAAX,CAAf;AACA,cAAMk7D,WAAW,GAAG,UAAAj7D,OAAA,CAAQ88C,MAAR,EAAgB,KAAKnZ,KAAL,CAAW5jC,QAA3B,CAApB;AACA,cAAMqH,OAAO,GAAG01C,MAAM,CAACrgD,UAAP,CAAkB,iBAAlB,CAAhB;AACA,2BAAU2K,OAAV,SAAoB6zD,WAAW,GAAG,UAAH,GAAgB,EAA/C;AACD;;;oCAEc;AACb,eAAKpyD,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,kBAAM,EAAE;AAAV,WAAhB;AACD;;;gCAEW;AACV,eAAKhW,KAAL,CAAWgzC,IAAX,CAAgB;AAAEh9B,kBAAM,EAAE;AAAV,WAAhB;AACD;;;;;;AAjCH;;;uBAKasgD,6B,EAA6B,qBAOpB,SAAApiB,eAPoB,C;AAOL,K;;;YAPxBoiB,6B;AAA6B,6C;AAAA;AAAA;AAAA,O;AAAA,e;AAAA,a;AAAA,8nC;AAAA;AAAA;ACX1C;AACI;AAAuB;AAAO;AAC9B;AACI;AACI;AAAA;AACI;AACJ;AACJ;AACJ;AACJ;AACA;AAAA;AACI;AAAA;AACI;AACJ;AAEA;AAAA;AAAI;AAAkB;AACtB;AAAG;AAA4H;AAE/H;AACI;AACI;AACI;AAAI;AAAK;AACb;AACJ;AACA;AACI;AAGJ;AACJ;AACJ;AAEA;AACI;AAA2B;AAAA,mBAAS,IAAA5/B,KAAA,EAAT;AAAgB,WAAhB;AAAkB;AAAM;AAAI;AAAO;AAC9D;AAAmB;AAAA,mBAAS,iBAAT;AAAmB,WAAnB;AAAqB;AAAM;AAAa;AAAO;AACtE;;;;AAVgB;AAAA;;;;;;;;;2BDdH4/B,6B,EAA6B;cALzC,OAAAniB,SAKyC;eAL/B;AACTjlD,kBAAQ,EAAE,wBADD;AAETklD,qBAAW,EAAE,yCAFJ;AAGTC,mBAAS,EAAE,CAAC,yCAAD;AAHF,S;AAK+B,Q;;gBAOYiiB,6B;AAA6B;kBAApE,OAAAn1B,MAAoE;mBAA7D,SAAA+S,e;AAA6D;;;;gBAFhF,OAAAI;;;;;;;;;;;;;;;;;;;;;;;;AEhBH;AAAA;AAAA;;;;;AAKA;;;;;;;;QASaiiB,U;;;;;;;kCACCjmE,K,EAAckmE,U,EAAoBC,S,EAAkB;;;AAC1D,cAAI,CAACnmE,KAAL,EAAY,OAAO,EAAP;AACZ,cAAI,CAACkmE,UAAL,EAAiB,OAAOlmE,KAAP;AACjBkmE,oBAAU,GAAGA,UAAU,CAACx8D,WAAX,EAAb;AACA,cAAM08D,SAAS,GAAG,CAAH,KAAGD,SAAS,SAAT,IAAAA,SAAS,WAAT,GAAS,MAAT,GAAAA,SAAS,CAAEniE,KAAX,CAAiB,GAAjB,OAAoB,IAApB,IAAoB,aAApB,GAAoB,EAApB,GAAyB,EAA3C;AACA,iBAAOhE,KAAK,CAAC4I,MAAN,CAAa,UAAAy9D,EAAE,EAAI;AACtB,gBAAIC,QAAQ,GAAG,KAAf;AACAF,qBAAS,CAAChmE,OAAV,CAAkB,UAAC1C,GAAD,EAAS;;;AACvB,kBAAI,CAAJ,KAAI2oE,EAAE,CAAC3oE,GAAD,CAAF,MAAO,IAAP,IAAO,aAAP,GAAO,MAAP,GAAO,GAAEgM,WAAF,GAAgBoS,QAAhB,CAAyBoqD,UAAzB,CAAX,EAAiD;AAC7CI,wBAAQ,GAAG,IAAX;AACH;AACJ,aAJD;;AAKA,gBAAIF,SAAS,CAACliE,MAAV,KAAqB,CAAzB,EAA4B;AACxB,qBAAOmiE,EAAE,CAAC38D,WAAH,GAAiBoS,QAAjB,CAA0BoqD,UAA1B,CAAP;AACH;;AACD,mBAAOI,QAAP;AACH,WAXM,CAAP;AAYH;;;;;;AArBL;;;uBAGaL,U;AAAU,K;;;;YAAVA,U;AAAU;;;;;2BAAVA,U,EAAU;cAHtB,OAAAp0D,IAGsB;eAHjB;AACF9T,cAAI,EAAE;AADJ,S;AAGiB,Q;;;;;;;;;;;;;;;;;;;;;;ACdvB;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;AAQA,QAAYwoE,eAAZ;;AAAA,eAAYA,eAAZ,EAA2B;AACvB;AACA;AACA;AACA;AACA;AACA;AACH,KAPD,EAAYA,eAAe,GAAf,QAAAA,eAAA,aAAAA,eAAA,GAAe,EAAf,CAAZ;;QAYaC,Y;AACT,4BAAoBC,SAApB,EAA6C;AAAA;;AAAzB,aAAAA,SAAA,GAAAA,SAAA;AAA2B;;;;kCAG3CvhE,K,EAC+D;AAAA,cAA/D+B,IAA+D,uEAAN,MAAM;;AAE/D,kBAAQA,IAAR;AACI,iBAAK,UAAL;AACI,qBACI,KAAKw/D,SAAL,CAAeC,QAAf,CACIH,eAAe,CAACI,YADpB,EAEIzhE,KAFJ,KAGK,EAJT;;AAMJ,iBAAK,KAAL;AACI,qBACI,KAAKuhE,SAAL,CAAeC,QAAf,CAAwBH,eAAe,CAACK,GAAxC,EAA6C1hE,KAA7C,KAAuD,EAD3D;;AAGJ,iBAAK,QAAL;AACI,qBACI,KAAKuhE,SAAL,CAAeC,QAAf,CAAwBH,eAAe,CAACM,MAAxC,EAAgD3hE,KAAhD,KAA0D,EAD9D;;AAGJ,iBAAK,OAAL;AACI,qBACI,KAAKuhE,SAAL,CAAeC,QAAf,CAAwBH,eAAe,CAACO,KAAxC,EAA+C5hE,KAA/C,KAAyD,EAD7D;AAjBR;;AAqBA,iBAAO,KAAKuhE,SAAL,CAAeC,QAAf,CAAwBH,eAAe,CAACQ,IAAxC,EAA8C7hE,KAA9C,KAAwD,EAA/D;AACH;;;;;;AAhCL;;;uBAGashE,Y,EAAY,qC;AAAA,K;;;;YAAZA,Y;AAAY;;;;;2BAAZA,Y,EAAY;cAHxB,OAAA30D,IAGwB;eAHnB;AACF9T,cAAI,EAAE;AADJ,S;AAGmB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;ACrBzB;AAAA;AAAA;;AAQA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;AAWoB;AACyC;AAAkB;;;;;AAAzC;AAAuB;AAAA;;;;;;;;AANjD;AACI;AAAiC;AAAS;AAC1C;AAEiB;AAAA;AAAA;AAAA;AAAA;;AACb;AAEJ;AACJ;;;;;AAPe;AAAA;AAAsB;AAAA;AAChB;AAAA,mDAAqB,OAArB,EAAqB,wCAArB;AAGK;AAAA;;;;QAezBipE,oB;;;;;AAoBT,oCAAYzI,KAAZ,EAAqC;AAAA;;AAAA;;AACjC,uCAAMA,KAAN;AAVG,iBAAAr5D,KAAA,GAAQ,IAAI,OAAAzH,eAAJ,CAAmDwG,SAAnD,CAAR;AAS8B;AAEpC;;;;yCAEgBjG,E,EAAO;AACpB,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;;;0CAEiBA,E,EAAO;AACrB,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;;;yCAEgBw+D,U,EAAmB;AAChC,eAAK5/B,QAAL,GAAgB4/B,UAAhB;AACH;;;iCAEet3D,K,EAAe;AAC3B,cAAM6Z,GAAG,GAAG,KAAK6F,OAAL,CAAapf,IAAb,CAAkB,UAAAonB,CAAC;AAAA,mBAAIA,CAAC,CAAC1nB,KAAF,KAAYA,KAAhB;AAAA,WAAnB,CAAZ;AACA,eAAK69D,UAAL,CAAgBhkD,GAAhB;;AACA,cAAI,KAAKytC,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAeztC,GAAf;AACH;AACJ;;;mCAEUA,G,EAAsB;AAC7B,eAAK7Z,KAAL,CAAWiL,IAAX,CAAgB4O,GAAhB;AACH;;;;MA9CqC,0BAAAu/C,qB;;AAxB1C;;;uBAwBa0I,oB,EAAoB,yC;AAAA,K;;;YAApBA,oB;AAAoB,uC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA,uCARlB,CACP;AACIzxB,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAMoa,oBAAN;AAAA,SAAX,CAFjB;AAGIna,aAAK,EAAE;AAHX,OADO,CAQkB,GAF5B,6BAE4B,C;AAF5B,c;AAAA,a;AAAA,+K;AAAA;AAAA;AAnBG;;;;;;;;;;2BAqBKma,oB,EAAoB;cAxBhC,OAAAnjB,SAwBgC;eAxBtB;AACPjlD,kBAAQ,EAAE,kBADH;AAEPuxD,kBAAQ,snBAFD;AAePpM,mBAAS,EAAE,CAAC,+BAAD,CAfJ;AAgBPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAMoa,oBAAN;AAAA,aAAX,CAFjB;AAGIna,iBAAK,EAAE;AAHX,WADO;AAhBJ,S;AAwBsB,Q;;;;;;gBAE5B,OAAAvrD;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAMA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;ACrDL;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACmBA;AAAiC;AAAoC;;;;QDXxD2lE,oB;AAcT,oCACYl2C,IADZ,EACqC;AAAA;;AAAzB,aAAAA,IAAA,GAAAA,IAAA;AAVL,aAAAm2C,gBAAA,GAA0C,CAC7C;AAACjgE,cAAI,EAAE,cAAAmlC,SAAA,CAAU+6B,OAAjB;AAA0BrlD,eAAK,EAAE;AAAjC,SAD6C,EAE7C;AAAC7a,cAAI,EAAE,cAAAmlC,SAAA,CAAUg7B,IAAjB;AAAuBtlD,eAAK,EAAE;AAA9B,SAF6C,CAA1C;AAKA,aAAAwH,WAAA,GAAc,EAAd;AAMH;;;;mCAMW;AAAA;;AACX,eAAKyH,IAAL,CAAUxW,WAAV,CAAsBzH,IAAtB,CAA2B,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,mBAAOA,CAAP;AAAA,WAAN,CAA3B,EAA4CvZ,SAA5C,CAAsD,YAAM;;;AACxD,oBAAI,CAACqpB,WAAL,GAAmB,qBAAI,CAACyH,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE1L,QAAX,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAEze,QAArB,KAAiC,iBAApD;AACH,WAFD;;AAGA,cAAG,KAAKygE,gBAAL,CAAsBniE,KAAtB,KAAgC,cAAAq5B,gBAAA,CAAiBC,IAApD,EAAyD;AACrD,iBAAK8oC,YAAL,GAAoB,KAAKJ,gBAAL,CAAsB,CAAtB,CAApB;AACA,0BAAA55B,uBAAA,CAAwB,KAAKnvB,IAA7B;AACH,WAHD,MAGK;AACD,iBAAKmpD,YAAL,GAAoB,KAAKJ,gBAAL,CAAsB,CAAtB,CAApB;AACH;AACJ;;;qCAEmBhiE,K,EAAe;AAC/B,eAAKoiE,YAAL,GAAoB,KAAKJ,gBAAL,CAAsBt+D,MAAtB,CAA6B,UAAC3B,IAAD;AAAA,mBAAUA,IAAI,CAACA,IAAL,KAAc/B,KAAxB;AAAA,WAA7B,EAA4D,CAA5D,CAApB;;AACA,cAAG,KAAKoiE,YAAL,CAAkBrgE,IAAlB,KAA2B,cAAAmlC,SAAA,CAAU+6B,OAAxC,EAAgD;AAC5C,iBAAKE,gBAAL,CAAsBzkE,QAAtB,CAA+B,KAAK2kE,YAAL,CAAkBC,4BAAlB,CAA+CtiE,KAA9E;AACH,WAFD,MAEK;AACD,iBAAKmiE,gBAAL,CAAsBzkE,QAAtB,CAA+B,cAAA27B,gBAAA,CAAiBC,IAAhD;AACH;AACJ;;;yCAEuBx8B,I,EAAa;AACjC,iBAAO,IAAI,UAAAkR,MAAJ,CAAW;AAAClR,gBAAI,EAAJA,IAAD;AAAOsnB,uBAAW,EAAE,KAAKA,WAAzB;AAAsCD,uBAAW,EAAE;AAAnD,WAAX,CAAP;AACH;;;4BA3B0B;AACvB,iBAAO,KAAKlL,IAAL,CAAUzG,GAAV,CAAc,mBAAd,CAAP;AACH;;;4BA2Be;AACZ,cAAMkR,iBAAiB,GAAG,KAAKzK,IAAL,CAAUovB,QAAV,CAAmB3kB,iBAA7C;AACA,cAAME,eAAe,GAAG,KAAK3K,IAAL,CAAUovB,QAAV,CAAmBzkB,eAA3C;AACA,iBAAOF,iBAAiB,CAACs1B,OAAlB,IAA6Bp1B,eAAe,CAACo1B,OAApD;AACH;;;;;;AAzDL;;;uBAMa+oB,oB,EAAoB,4C;AAAA,K;;;YAApBA,oB;AAAoB,8C;AAAA;AAAA;yBAYlB,oCAAAQ,qB,EAAqB,I;;;;;;;;;;;;;;;;;ACzBpC;AACI;AAA6C;AAAA,mBAAU,IAAAC,YAAA,cAAV;AAAoC,WAApC;AACzC;AAEI;AACI;AACJ;AACA;AAIJ;AACA;AAEI;AACI;AACJ;AACA;AAIJ;AACJ;AACJ;AACA;;;;AAxBuC;AAClB;AAAA;AAGS;AAAA;AACd;AAAA;AAGA;AAAA,4FAA2D,MAA3D,EAA2D,QAA3D;AAMc;AAAA;AACd;AAAA;AAGA;AAAA,4FAA2D,MAA3D,EAA2D,QAA3D;AAMG;AAAA;;;;;;;;;2BDXNT,oB,EAAoB;cANhC,OAAApjB,SAMgC;eANtB;AACPjlD,kBAAQ,EAAE,yBADH;AAEPklD,qBAAW,EAAE,0CAFN;AAGPC,mBAAS,EAAE,CAAC,0CAAD;AAHJ,S;AAMsB,Q;;;;;;gBAE5B,OAAAziD;;;gBAUA,OAAA+lD,S;iBAAU,oCAAAogB,qB;;;;;;;;;;;;;;;;;;;;;;;;AEzBf;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACCQ;AACI;AAAI;AAAoB;AACxB;AAAkC;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2B;AAAM;AACvE;;;;;;AAFQ;AAAA;;;;;;;;;;;;QDMHE,kB;;;;;AAqBT,kCAAqB52C,IAArB,EAAgD;AAAA;;AAAA;;AAC5C;AADiB,iBAAAA,IAAA,GAAAA,IAAA;AAfd,iBAAA62C,cAAA,GAAgC,EAAhC;AACA,iBAAAhhE,QAAA,GAAmB,EAAnB;AACA,iBAAA2uB,KAAA,GAAgB,UAAA9pB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAhB;AACA,iBAAAwiD,UAAA,GAAqB,SAAK7uB,KAAL,CAAW6I,KAAX,EAArB;AACA,iBAAAimB,WAAA,GAAsB,SAAKD,UAAL,CAAgBnyB,UAAhB,CAA2B,KAA3B,EAAkCpvB,QAAlC,CAA2C;AAAE4qD,eAAK,EAAE;AAAT,SAA3C,CAAtB;AACA,iBAAA9qD,MAAA,GAAiB,UAAA8I,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAjB;AAmEP;;;;AAGO,iBAAAshE,iBAAA,GAAoB,YAAM;AAC7B,mBAAK2E,oBAAL,CAA0B,SAAKtyC,KAA/B;AACH,SAFM;;AA5DyC;AAE/C;;;;mCAEc;AAAA;;AACX;AACA,eAAK3uB,QAAL,GAAgB,KAAKuX,IAAL,CAAUzG,GAAV,CAAc,UAAd,EAA0BxS,KAA1C;AACA,eAAKqwB,KAAL,GAAa,IAAI,UAAAriB,MAAJ,CAAW;AAAElR,gBAAI,EAAEJ,IAAI,CAAConB,GAAL,EAAR;AAAoBK,uBAAW,EAAE,KAAjC;AAAwCC,uBAAW,EAAE,KAAK1iB;AAA1D,WAAX,CAAb,CAHW,CAIX;;AACA,eAAKw9C,UAAL,GAAkB,KAAK7uB,KAAL,CAAW6I,KAAX,EAAlB;AACA,eAAKimB,WAAL,GAAmB,KAAKD,UAAL,CAAgBnyB,UAAhB,CAA2B,KAA3B,EAAkCpvB,QAAlC,CAA2C;AAAE4qD,iBAAK,EAAE;AAAT,WAA3C,CAAnB;;AAEA,cAAG,KAAK7I,gBAAL,CAAsB1/C,KAAzB,EAA+B;AAC3B,gBAAM4iE,WAAW,sBAAO,KAAKljB,gBAAL,CAAsB1/C,KAA7B,CAAjB,CAD2B,CAC2B;;;AACtD,iBAAK0iE,cAAL,GAAsBE,WAAW,CAAC59D,IAAZ,CAAiB,UAAC20B,EAAD,EAAaC,EAAb;AAAA,qBAA4BD,EAAE,CAAClzB,EAAH,GAAQmzB,EAAE,CAACnzB,EAAvC;AAAA,aAAjB,CAAtB;AACH;;AACD,eAAK5L,YAAL,CAAkB,kBAAlB,EAAuC,KAAK6kD,gBAAL,CAAsBhnB,YAAtB,CAClC39B,SADkC,CACxB,YAAM;AACb,oBAAI,CAAC2nE,cAAL,sBAA0B,QAAI,CAAChjB,gBAAL,CAAsB1/C,KAAhD;AACH,WAHkC,CAAvC;AAKH;AAED;;;;;;;gCAIe+9D,S,EAAmB;AAC9B,cAAM9/D,CAAC,GAAG8/D,SAAS,CAAC7kC,KAAV,EAAV;AACA,cAAM2pC,UAAU,GAAG,KAAKC,UAAL,CAAgB9iE,KAAnC;AACA,cAAIkoD,QAAQ,GAAGjqD,CAAC,CAACP,QAAF,CAAW;AAAC0B,gBAAI,EAAEyjE,UAAU,CAACl6B,QAAlB;AAA4BxrC,kBAAM,EAAE0lE,UAAU,CAACtlE;AAA/C,WAAX,CAAf;AAEA;;AACA,cAAI2qD,QAAQ,CAAC9yB,YAAT,CAAsB,KAAK8pB,UAA3B,CAAJ,EAA4C;AACxCgJ,oBAAQ,GAAG,KAAKhJ,UAAhB;AACH;AAED;;;AACA,cAAM6jB,WAAW,GAAG,KAAKL,cAAL,CAAoBh/D,MAApB,CAA2B,UAAC5G,IAAD;AAAA,mBAAiBorD,QAAQ,CAAC7tB,UAAT,CAAoBv9B,IAApB,EAA0B,KAA1B,CAAjB;AAAA,WAA3B,CAApB;;AACA,cAAGimE,WAAW,CAAC/jE,MAAf,EAAsB;AAClB;AACH;;AAED,eAAK0jE,cAAL,CAAoB/9D,IAApB,CAAyBujD,QAAzB;AACA,eAAKxI,gBAAL,CAAsBhiD,QAAtB,CAA+B,KAAKglE,cAAL,CAAoB19D,IAApB,CAAyB,UAAC20B,EAAD,EAAKC,EAAL;AAAA,mBAAYD,EAAE,CAAClzB,EAAH,GAAQmzB,EAAE,CAACnzB,EAAvB;AAAA,WAAzB,CAA/B;AACA,eAAKu8D,aAAL;AACH;AAED;;;;;;;;6CAK6BC,W,EAAqB;AAC9C,eAAK/jB,UAAL,GAAkB+jB,WAAW,CAAC/pC,KAAZ,EAAlB;AACH;;;oCASkB;AACf,eAAKgqC,OAAL,CAAa,KAAK7yC,KAAlB;AACA,eAAKsyC,oBAAL,CAA0B,KAAKtyC,KAA/B;AACH;;;0CAEwB;AACrB,eAAK83B,QAAL,CAAcC,SAAd;AACH;;;yCAEuB;AACpB,eAAKD,QAAL,CAAcE,QAAd;AACH;;;mCAEiBvrD,I,EAAc;AAC5B,cAAM1B,KAAK,GAAG,KAAKsnE,cAAL,CAAoB//D,GAApB,CAAwB,UAAC1E,CAAD;AAAA,mBAAeA,CAAC,CAACwI,EAAjB;AAAA,WAAxB,EAA6CvG,OAA7C,CAAqDpD,IAAI,CAAC2J,EAA1D,CAAd;AACA,eAAKi8D,cAAL,CAAoBn5D,MAApB,CAA2BnO,KAA3B,EAAkC,CAAlC;AACA,eAAKskD,gBAAL,CAAsBhiD,QAAtB,CAA+B,KAAKglE,cAApC;AACA,eAAKM,aAAL;AACH;;;gCAEclmE,I,EAAM;AACjB,iBAAO,IAAI,UAAAkR,MAAJ,CAAW;AACdlR,gBAAI,EAAE,UAAAw+C,WAAA,CAAYx+C,IAAZ,EAAkB2J,EADV;AAEd0d,uBAAW,EAAE,KAFC;AAGdC,uBAAW,EAAE,KAAK1iB;AAHJ,WAAX,EAIJ24B,UAJI,CAKH,IAAI,UAAArsB,MAAJ,CAAW;AACPlR,gBAAI,EAAEJ,IAAI,CAAConB,GAAL,EADC;AAEPK,uBAAW,EAAE,KAFN;AAGPC,uBAAW,EAAE,KAAK1iB;AAHX,WAAX,CALG,EAUH,KAVG,CAAP;AAYH;;;mCAEiB5E,I,EAAY;AAC1B,cAAM6E,OAAO,GAAG,KAAKA,OAAL,CAAa7E,IAAb,CAAhB;AACA,cAAMiM,OAAO,GAAGjM,IAAI,CAACsB,UAAL,CAAgB,iBAAhB,CAAhB;AAEA,2BAAW2K,OAAX,SAAqBpH,OAAO,GAAG,UAAH,GAAgB,EAA5C;AACH;;;wCAEoB;AACjB,cAAI,KAAK+gE,cAAL,CAAoB1jE,MAApB,KAA+B,CAAnC,EACI;AAEJ,cAAMspC,EAAE,GAAG,KAAKzc,IAAL,CAAU1L,QAAV,CAAmBze,QAA9B;AACA,cAAM6mC,QAAQ,GAAG,UAAAhiC,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoBwK,MAApB,CAA2BohC,EAA3B,CAAjB;AACA,cAAI7qC,MAAM,GAAG,KAAKilE,cAAL,CAAoB,CAApB,EAAuBxpC,KAAvB,EAAb;AAEAz7B,gBAAM,GAAGA,MAAM,CAACC,QAAP,CAAgB;AACrB0B,gBAAI,EAAG,KAAK0jE,UAAL,CAAgB9iE,KAAhB,CAAiCmE,KADnB;AAErBhH,kBAAM,EAAG,KAAK2lE,UAAL,CAAgB9iE,KAAhB,CAAiCzC;AAFrB,WAAhB,CAAT;;AAKA,cAAI,KAAKmlE,cAAL,CAAoB,CAApB,EAAuBroC,UAAvB,CAAkC,KAAKhK,KAAvC,EAA8C,KAA9C,KAAwD5yB,MAAM,CAAC0G,KAAP,GAAeokC,QAAQ,CAACpkC,KAApF,EAA2F;AAAA,wCAC9C,OAAA3G,mBAAA,CAAoB,KAAK6yB,KAAzB,EAAgC,EAAhC,CAD8C;AAAA,gBACtElzB,MADsE,yBAC/EI,OAD+E;AAAA,gBACvD6B,IADuD,yBAC9D+E,KAD8D;;AAEvF1G,kBAAM,GAAGA,MAAM,CAACC,QAAP,CAAgB;AAAEP,oBAAM,EAANA,MAAF;AAAUiC,kBAAI,EAAJA,IAAV;AAAgBlC,oBAAM,EAAE;AAAxB,aAAhB,CAAT;AACH;;AAED,eAAK4lE,UAAL,CAAgBplE,QAAhB,CAAyBD,MAAzB;AACH;;;4BArI0B;AACvB,iBAAO,KAAKwb,IAAL,CAAUzG,GAAV,CAAc,mBAAd,CAAP;AACH;;;4BAEoB;AACjB,iBAAO,KAAKyG,IAAL,CAAUzG,GAAV,CAAc,QAAd,CAAP;AACH;;;;MAnBmC,OAAAjZ,a;;AANxC;;;uBAMakpE,kB,EAAkB,4C;AAAA,K;;;YAAlBA,kB;AAAkB,2C;AAAA;AAAA;+BAIhB,OAAAha,c,EAAgB,I;;;;;;;;;;;;;;;;;;;ACjB/B;AACI;AACI;AACI;AAAI;AAAI;AACR;AAAI;AAAM;AACd;AACA;AAIA;AACI;AACI;AAAK;AAAA,mBAAiB,IAAAC,cAAA,EAAjB;AAAiC,WAAjC;AACyB;AAAoB;AAClD;AAAiD;AAAA,mBAAU,IAAAsV,iBAAA,EAAV;AAA6B,WAA7B;AAC7C;AAAkD;AAAA,mBAASrV,MAAM,CAACr8C,eAAP,EAAT;AAAiC,WAAjC;AAC9C;AAII;AAAiB,gBAAA42D,OAAA;AAAiB,uBAAAta,eAAA;AAAiB,WAAnD;AACH;AACD;AAII;AAAA,mBAAS,IAAAwX,SAAA,EAAT;AAAoB,WAApB;AACH;AACD;AACJ;AACJ;AACJ;AACA;AACJ;AACJ;AACJ;;;;;;AAnCuB;AACZ;AAAA;AAKC;AAAA;AAOI;AAAA;AAKY;AAAA,mDAAsB,SAAtB,EAAsB,2DAAtB;;;;;;;;;2BDLfqC,kB,EAAkB;cAN9B,OAAA9jB,SAM8B;eANpB;AACPjlD,kBAAQ,EAAE,sBADH;AAEPklD,qBAAW,EAAE,uCAFN;AAGPC,mBAAS,EAAE,CAAC,uCAAD;AAHJ,S;AAMoB,Q;;;;;;gBAE1B,OAAAziD;;;gBACA,OAAAA;;;gBACA,OAAA+lD,S;iBAAU,OAAAsG,c,EAAgB;AAAE,sBAAQ;AAAV,W;;;;;;;;;;;;;;;;;;;;;;;;AEjB/B;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACOQ;AAAoE;AAAmC;;;;;;AAYvG;AAA4D;AAAmC;;;;;;AAQ/E;AACI;AACJ;;;;;AAFkE;AAC9D;AAAA;;;;;;AAMJ;AACI;AACJ;;;;;;AAFyD;AACrD;AAAA;;;;;;;;;;;;;;;;;;;;AASZ;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AACI;AACJ;;;;;AAHA;AAEI;AAAA;;;;;;AARZ;AACI;AAAA;AAA6C;AAC7C;AACI;AAOJ;AACJ;;;;;AANQ;AAAA;;;;QDtCH8Z,qB;;;;;AANb;AAAA;;AAAA;;;AAWI;;AACO,iBAAAlyC,KAAA,GAAgB,UAAA9pB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAhB;AACA,iBAAAymE,WAAA,GAAsB,SAAK9yC,KAAL,CAAW3yB,QAAX,CAAoB;AAAEP,gBAAM,EAAEC,IAAI,CAACC,IAAL,CAAU,SAAKgzB,KAAL,CAAW9yB,OAAX,GAAqB,CAA/B,IAAoC;AAA9C,SAApB,CAAtB;AACA,iBAAA6lE,OAAA,GAAkB,SAAK/yC,KAAL,CAAW1yB,QAAX,CAAoB;AAAE4qD,eAAK,EAAE;AAAT,SAApB,EAAkCx7B,UAAlC,CAA6C,KAA7C,CAAlB;AACA,iBAAArrB,QAAA,GAAmB,EAAnB;AAMA,iBAAA2hE,qBAAA,GAA6C,CAChD;AAACzmD,eAAK,EAAE,KAAR;AAAe7N,YAAE,EAAE,cAAAsqB,gBAAA,CAAiB+N;AAApC,SADgD,EAEhD;AAACxqB,eAAK,EAAE,MAAR;AAAe7N,YAAE,EAAE,cAAAsqB,gBAAA,CAAiBU;AAApC,SAFgD,EAGhD;AAACnd,eAAK,EAAE,OAAR;AAAiB7N,YAAE,EAAE,cAAAsqB,gBAAA,CAAiBgO;AAAtC,SAHgD,CAA7C;AAKA,iBAAAI,SAAA,GAA6B,EAA7B;AAyHP;;AACQ,iBAAA67B,0BAAA,GAA6B,YAAM;AACvC,cAAG,SAAKC,oBAAL,CAA0BvkE,MAA1B,GAAmC,SAAKwkE,6BAAL,CAAmCxjE,KAAzE,EAA+E;AAC3E,qBAAKwjE,6BAAL,CAAmC9lE,QAAnC,CAA4C,CAA5C;AACH;AACJ,SAJO;;AApJZ;AAoRC;;;;mCA7NkB;AAAA;;AACX;AACA,eAAKgE,QAAL,GAAgB,KAAKuX,IAAL,CAAUzG,GAAV,CAAc,UAAd,EAA0BxS,KAA1C;AACA,eAAKqwB,KAAL,GAAa,IAAI,UAAAriB,MAAJ,CAAW;AAAElR,gBAAI,EAAEJ,IAAI,CAAConB,GAAL,EAAR;AAAoBK,uBAAW,EAAE,KAAjC;AAAwCC,uBAAW,EAAE,KAAK1iB;AAA1D,WAAX,CAAb,CAHW,CAIX;;AACA,eAAK6hE,oBAAL,GAA4B,IAAI15D,KAAJ,CAAU,CAAV,CAA5B;AACA,eAAKs5D,WAAL,GAAmB,OAAA3lE,mBAAA,CAAoB,KAAK6yB,KAAzB,EAAgC,EAAhC,CAAnB;AACA,eAAK+yC,OAAL,GAAe,KAAK/yC,KAAL,CAAW1yB,QAAX,CAAoB;AAAE4qD,iBAAK,EAAE;AAAT,WAApB,EAAkCx7B,UAAlC,CAA6C,KAA7C,CAAf;AACA,eAAK02C,SAAL,GAAiB,KAAKN,WAAL,CAAiBxlE,QAAjB,CAA0B;AAACwwB,gBAAI,EAAE;AAAP,WAA1B,CAAjB;AAEA,eAAKu1C,uBAAL,CAA6B,KAAKC,gCAAL,CAAsC3jE,KAAnE,EAVW,CAU+D;;AAE1E,cAAG,CAAC,KAAK4jE,2BAAL,CAAiC5jE,KAArC,EAA2C;AACvC,iBAAK4jE,2BAAL,CAAiClmE,QAAjC,CAA0C,cAAA27B,gBAAA,CAAiBU,MAA3D;AACH;;AAED,cAAG,KAAK6pC,2BAAL,CAAiC5jE,KAAjC,KAA2C,cAAAq5B,gBAAA,CAAiBC,IAA/D,EAAoE;AAChE,iBAAKgpC,4BAAL,CAAkC5kE,QAAlC,CAA2C,KAAKkmE,2BAAL,CAAiC5jE,KAA5E;AACH;;AAED,eAAKynC,SAAL,GAAiB,cAAAH,gBAAA,CAAiB,KAAKq8B,gCAAL,CAAsC3jE,KAAtC,CAA4CyG,EAA7D,EAAiE;AAAE2d,uBAAW,EAAE,KAAK++C,WAAL,CAAiB/+C;AAAhC,WAAjE,CAAjB;AACA,eAAKy/C,oBAAL;;AAEA,cAAG,KAAKC,yBAAL,CAA+B9jE,KAA/B,CAAqChB,MAArC,GAA8C,CAAjD,EAAmD;AAC/C,iBAAKyoC,SAAL,GAAiB,KAAKA,SAAL,CAAe9kC,GAAf,CAAmB,UAAC1B,GAAD;AAAA,qBAC/B,MAAD,OAAC,CAAD,kBAAKA,GAAL,CAAC,EAAO;AAAE0mC,sBAAM,EAAE,QAAI,CAACm8B,yBAAL,CAA+B9jE,KAA/B,CAAqC4W,QAArC,CAA8C3V,GAAG,CAAC2mC,SAAlD;AAAV,eAAP,CAD+B;AAAA,aAAnB,CAAjB;AAGH;;AAED,cAAG,CAAC,KAAKk8B,yBAAL,CAA+B9jE,KAA/B,CAAqChB,MAAtC,IAAgD,KAAK4kE,2BAAL,CAAiC5jE,KAAjC,KAA2C,cAAAq5B,gBAAA,CAAiBU,MAA/G,EAAsH;AAClH,gBAAMgqC,YAAY,GAAG,KAAKt8B,SAAL,CAAe/jC,MAAf,CAAsB,UAACzC,GAAD;AAAA,qBAASA,GAAG,CAAC0mC,MAAb;AAAA,aAAtB,EAA2ChlC,GAA3C,CAA+C,UAAC1B,GAAD;AAAA,qBAAOA,GAAG,CAAC2mC,SAAX;AAAA,aAA/C,CAArB;AACA,iBAAKk8B,yBAAL,CAA+BpmE,QAA/B,CAAwCqmE,YAAxC;AACH;;AAED,eAAKC,qBAAL;AAEA,eAAKnpE,YAAL,CAAkB,kBAAlB,EAAuC,KAAK8oE,gCAAL,CAAsCjrC,YAAtC,CAClC39B,SADkC,CACxB,UAACkQ,IAAD,EAAU;AACjB,oBAAI,CAACy4D,uBAAL,CAA6Bz4D,IAA7B;AACH,WAHkC,CAAvC;AAMA,eAAKpQ,YAAL,CAAkB,gBAAlB,EAAqC,KAAKopE,wBAAL,CAA8BvrC,YAA9B,CAChC39B,SADgC,CACtB,YAAM;AACb,oBAAI,CAAC8oE,oBAAL;AACH,WAHgC,CAArC;AAMA,eAAKhpE,YAAL,CAAkB,oCAAlB,EAAyD,KAAK+oE,2BAAL,CAAiClrC,YAAjC,CACpD39B,SADoD,CAC1C,YAAM;AACb,oBAAI,CAAC8oE,oBAAL;AACH,WAHoD,CAAzD;AAKH;;;gDAE8Bn8D,W,EAAmB;AAC9C,cAAIw8D,QAAQ,GAAG,KAAKD,wBAAL,CAA8BjkE,KAA9B,CAAoCtC,QAApC,CAA6C;AAAC0B,gBAAI,EAAEsI,WAAW,CAACihC,QAAnB;AAA6BxrC,kBAAM,EAAEuK,WAAW,CAACnK;AAAjD,WAA7C,CAAf;AAEA;;AACA,eAAKkmE,SAAL,GAAiB/7D,WAAW,CAAC2yB,UAAZ,CAAuB,KAAK+oC,OAA5B,EAAoC,KAApC,IAA6C17D,WAA7C,GAA2DA,WAAW,CAAC/J,QAAZ,CAAqB;AAACwwB,gBAAI,EAAE;AAAP,WAArB,CAA5E;;AAEA,cAAG+1C,QAAQ,CAAC9uC,YAAT,CAAsB,KAAKquC,SAA3B,CAAH,EAAyC;AACrCS,oBAAQ,GAAG,KAAKT,SAAhB;AACH;;AAED,eAAKQ,wBAAL,CAA8BvmE,QAA9B,CAAuCwmE,QAAvC;AAEA,eAAKL,oBAAL;AACA,eAAKM,mBAAL;AACH;;;wCAEsBnkE,K,EAAuB;AAC1C,eAAKokE,gBAAL,CAAsBpkE,KAAtB;AACA,eAAK4jE,2BAAL,CAAiClmE,QAAjC,CAA0CsC,KAA1C;AACA,eAAKsiE,4BAAL,CAAkC5kE,QAAlC,CAA2CsC,KAA3C;AACA,eAAKwjE,6BAAL,CAAmC9lE,QAAnC,CAA4C,CAA5C;AACA,eAAKsmE,qBAAL;AACH;;;uCAEqBhkE,K,EAAa;AAC/B,eAAKwjE,6BAAL,CAAmC9lE,QAAnC,CAA4CsC,KAA5C;AACA,eAAKgkE,qBAAL;AACH;;;yCAEuBhkE,K,EAAa;AACjC,iBAAO,KAAKwjE,6BAAL,CAAmCxjE,KAAnC,KAA6C,CAA7C,aAAoDA,KAApD,WAAiEA,KAAxE;AACH;;;;AAaD;;;+CAG2B;AACvB,cAAMhD,KAAK,GAAG,KAAK2mE,gCAAL,CAAsC3jE,KAApD;AACA,cAAMqkE,SAAS,GAAG,KAAKJ,wBAAL,CAA8BjkE,KAA9B,CAAoCg1B,QAApC,CAA6Ch4B,KAA7C,EAAoD,KAAKsnE,oBAAzD,EAA+E,KAAKA,oBAApF,CAAlB,CAFuB,CAGvB;;AACA,eAAKf,oBAAL,GAA4B,IAAI15D,KAAJ,CAAUzM,IAAI,CAACk1B,KAAL,CAAW+xC,SAAX,KAAyB,CAAnC,CAA5B;AACA,eAAKf,0BAAL;;AACA,cAAG,KAAKM,2BAAL,CAAiC5jE,KAAjC,KAA2C,cAAAq5B,gBAAA,CAAiBC,IAA/D,EAAoE;AAChE,iBAAK0qC,qBAAL;AACH;AACJ;AAED;;;;;;gDAG+B;AAE3B;;AAEA,cAAG,KAAKJ,2BAAL,CAAiC5jE,KAAjC,KAA2C,cAAAq5B,gBAAA,CAAiBC,IAA/D,EAAoE;AAChE;AACH;;AAED,cAAMC,UAAU,GAAG,EAAnB;AACA,cAAMgrC,UAAU,GAAG,KAAKZ,gCAAL,CAAsC3jE,KAAzD;AACA,cAAIhD,KAAK,GAAGunE,UAAZ;AACA,cAAMv6C,GAAG,GAAG,KAAKi6C,wBAAL,CAA8BjkE,KAA1C;AACA,cAAMyuB,QAAQ,GAAG,KAAK+0C,6BAAL,CAAmCxjE,KAApD;AACA,cAAMwkE,WAAW,GAAG,KAAK/8B,SAAL,CAAe/jC,MAAf,CAAsB,UAAAzC,GAAG;AAAA,mBAAIA,GAAG,CAAC0mC,MAAR;AAAA,WAAzB,CAApB;AACA;;;;AAIA;;AACA,cAAMuS,gBAAgB,GAAGqqB,UAAU,CAAChqB,OAAX,KAAuB,EAAvB,IAA6B,KAAKqpB,2BAAL,CAAiC5jE,KAAjC,KAA2C,cAAAq5B,gBAAA,CAAiBgO,gBAAlH;;AAEA,cAAG,KAAKu8B,2BAAL,CAAiC5jE,KAAjC,KAA2C,cAAAq5B,gBAAA,CAAiBU,MAA/D,EAAsE;AAClE/8B,iBAAK,GAAGA,KAAK,CAACwJ,YAAN,CAAmB,MAAnB,CAAR;AACH;;AAED,iBAAOwjB,GAAG,CAACgL,QAAJ,CAAah4B,KAAK,CAACwJ,YAAN,CAAmB,KAAnB,CAAb,EAAwC,KAAK89D,oBAA7C,EAAmE,KAAKA,oBAAxE,KAAiG,CAAxG,EAA2G;AAEvG,gBAAG,KAAKV,2BAAL,CAAiC5jE,KAAjC,KAA2C,cAAAq5B,gBAAA,CAAiBU,MAA/D,EAAsE;AAClER,wBAAU,CAAC50B,IAAX,CAAgB3H,KAAhB;AACAA,mBAAK,GAAGA,KAAK,CAACW,QAAN,qBAAiB,KAAK2mE,oBAAtB,EAA6C71C,QAA7C,GAAwDyrB,gBAAxD,CAAR;AACD;;;;;;;;AAOC,kBAAGl9C,KAAK,CAACu9C,OAAN,KAAkBgqB,UAAU,CAAChqB,OAA7B,IAAwCv9C,KAAK,CAACu9C,OAAN,KAAkBv9C,KAAK,CAACF,IAAN,CAAW2nE,WAArE,IAAoF,KAAKb,2BAAL,CAAiC5jE,KAAjC,KAA2C,cAAAq5B,gBAAA,CAAiBgO,gBAAnJ,EAAqK;AACjKrqC,qBAAK,GAAGA,KAAK,CAACU,QAAN,CAAe;AAACuD,qBAAG,EAAEsjE,UAAU,CAAChqB;AAAjB,iBAAf,CAAR;AACH;AACJ,aAbD,MAaM;AACFiqB,yBAAW,CAACtpE,OAAZ,CAAoB,UAAC+F,GAAD,EAAO;AACvB,oBAAMnE,IAAI,GAAGE,KAAK,CAACW,QAAN,CAAe;AAACwwB,sBAAI,EAAEltB,GAAG,CAAC4mC;AAAX,iBAAf,CAAb;;AACA,oBAAG,CAAC/qC,IAAI,CAACu4B,WAAL,CAAiBkvC,UAAjB,KAAgCznE,IAAI,CAACu9B,UAAL,CAAgBkqC,UAAhB,EAA4B,KAA5B,CAAjC,MACAznE,IAAI,CAACs4B,YAAL,CAAkBpL,GAAlB,KAA0BltB,IAAI,CAACu9B,UAAL,CAAgBrQ,GAAhB,EAAqB,KAArB,CAD1B,CAAH,EAC0D;AACtDuP,4BAAU,CAAC50B,IAAX,CAAgB7H,IAAhB;AACH;AACJ,eAND;AAOAE,mBAAK,GAAGA,KAAK,CAACW,QAAN,qBAAiB,KAAK2mE,oBAAtB,EAA6C71C,QAA7C,EAAR;AACH;AACJ;;AAED,eAAKxV,IAAL,CAAUovB,QAAV,CAAmB5kB,gBAAnB,CAAoC/lB,QAApC,CAA6C67B,UAAU,CAACv6B,MAAxD;AACA,eAAKia,IAAL,CAAUovB,QAAV,CAAmB3kB,iBAAnB,CAAqChmB,QAArC,CAA8C67B,UAAU,CAACv0B,IAAX,CAAgB,UAAC20B,EAAD,EAAKC,EAAL;AAAA,mBAAYD,EAAE,CAAClzB,EAAH,GAAQmzB,EAAE,CAACnzB,EAAvB;AAAA,WAAhB,CAA9C;AAEH;;;;AAOD;;;8CAG+B;AAAA;;AAC3B,cAAMi+D,UAAU,GAAG,KAAKj9B,SAAL,CAAe9kC,GAAf,CAAmB,UAAC1B,GAAD,EAAO;AACzC,gBAAG,QAAI,CAAC6iE,yBAAL,CAA+B9jE,KAA/B,CAAqC4W,QAArC,CAA8C3V,GAAG,CAAC2mC,SAAlD,CAAH,EAAgE;AAC5D,qBAAO,MAAP,OAAO,CAAP,kBAAW3mC,GAAX,CAAO,EAAO;AAAE0mC,sBAAM,EAAE;AAAV,eAAP,CAAP;AACH,aAFD,MAEK;AACD,qBAAO,MAAP,OAAO,CAAP,kBAAW1mC,GAAX,CAAO,EAAO;AAAE0mC,sBAAM,EAAE;AAAV,eAAP,CAAP;AACH;AACJ,WANkB,CAAnB;;AAOA,eAAKF,SAAL,sBAAqBi9B,UAArB;AACH;;;oCAEkBC,O,EAAiB;AAChC,cAAMx2C,IAAI,GAAG,KAAK21C,yBAAL,CAA+B9jE,KAA5C;;AACA,cAAG,KAAK03B,QAAR,EAAiB;AACb;AACH;;AAED,cAAG,CAACitC,OAAO,CAACh9B,MAAZ,EAAmB;AACfxZ,gBAAI,CAACxpB,IAAL,CAAUggE,OAAO,CAAC/8B,SAAlB;AACH,WAFD,MAEK;AACD,gBAAMg9B,aAAa,GAAGz2C,IAAI,CAACjuB,OAAL,CAAaykE,OAAO,CAAC/8B,SAArB,CAAtB;AACAzZ,gBAAI,CAAC5kB,MAAL,CAAYq7D,aAAZ,EAA0B,CAA1B;AACH;;AACD,eAAKd,yBAAL,CAA+BpmE,QAA/B,oBAA4CywB,IAA5C;AACA,eAAKg2C,mBAAL;AACA,eAAKH,qBAAL;AACH;AAED;;;;yCACwBhkE,K,EAAuB;AAC3C,cAAGA,KAAK,KAAK,cAAAq5B,gBAAA,CAAiBU,MAA3B,IAAqC,KAAK6pC,2BAAL,CAAiC5jE,KAAjC,KAA2C,cAAAq5B,gBAAA,CAAiBU,MAApG,EAA2G;AACvG,gBAAM6lB,eAAe,GAAG,CAAC,QAAAjoB,UAAA,CAAWC,QAAZ,CAAxB;AACAgoB,2BAAe,CAACj7C,IAAhB,CAAqB,cAAAs1B,eAArB;AACA,iBAAK6pC,yBAAL,CAA+B5rC,aAA/B,CAA6C0nB,eAA7C;AACA,iBAAKkkB,yBAAL,CAA+BtrC,sBAA/B;AACH,WALD,MAKM,IAAGx4B,KAAK,KAAK,cAAAq5B,gBAAA,CAAiBU,MAA3B,IAAqC,KAAK6pC,2BAAL,CAAiC5jE,KAAjC,KAA2C,cAAAq5B,gBAAA,CAAiBU,MAApG,EAA2G;AAC7G,iBAAK+pC,yBAAL,CAA+BnkB,eAA/B;AACA,iBAAKmkB,yBAAL,CAA+BtrC,sBAA/B;AACH;AACJ;;;4BApP6C;AAC1C,iBAAO,KAAKvf,IAAL,CAAUzG,GAAV,CAAc,QAAd,CAAP;AACH;;;4BAEkC;AAC/B,iBAAO,KAAKyG,IAAL,CAAUzG,GAAV,CAAc,kBAAd,CAAP;AACH;;;4BAEqC;AAClC,iBAAO,KAAKyG,IAAL,CAAUzG,GAAV,CAAc,mBAAd,CAAP;AACH;;;4BAEuC;AACpC,iBAAO,KAAKyG,IAAL,CAAUzG,GAAV,CAAc,qBAAd,CAAP;AACH;;;4BAEsC;AACnC,iBAAO,KAAKyG,IAAL,CAAUzG,GAAV,CAAc,oBAAd,CAAP;AACH;;;4BAEmC;AAChC,iBAAO,KAAKyG,IAAL,CAAUzG,GAAV,CAAc,iBAAd,CAAP;AACH;;;4BA0FyB;AACtB,iBAAO,KAAK8vD,4BAAL,CAAkCtiE,KAAlC,KAA4C,cAAAq5B,gBAAA,CAAiBU,MAApE;AACH;;;4BAmF8B;AAC3B,cAAM9K,MAAM,GAAG,KAAK20C,2BAAL,CAAiC5jE,KAAhD;AACA,iBAAO,cAAAmnC,8BAAA,CAA+BlY,MAA/B,CAAP;AACH;;;;MAjOsC,OAAA11B,a;;AAN3C;;;qDAMagpE,qB;AAAqB,K;;;YAArBA,qB;AAAqB,8C;AAAA;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,e;AAAA,c;AAAA,8xB;AAAA;AAAA;ACZlC;AACI;AACI;AAAA;AAAsD;AAAe;AAAA;AACrE;AAQA;AACJ;AACA;AACI;AAAA;AAAkD;AAAe;AAAA;AACjE;AAQA;AACJ;AACA;AACI;AACI;AAAA;AAA0D;AAAe;AAAA;AACzE;AACI;AACI;AAAwF;AAAA,mBAAe,IAAAsC,cAAA,QAAf;AAAqC,WAArC;AACpF;AAGJ;AACJ;AACA;AACI;AAAuF;AAAA,mBAAe,IAAAC,eAAA,QAAf;AAAsC,WAAtC;AACnF;AAGJ;AACJ;AACJ;AACJ;AACA;AAYJ;AACJ;;;;AA1D0C;AAAnB;AAMX;AAAA,uDAA0B,aAA1B,EAA0B,WAA1B,EAA0B,UAA1B,EAA0B,YAA1B,EAA0B,SAA1B,EAA0B,4CAA1B;AAKe;AAAA;AAOf;AAAA,qDAAwB,aAAxB,EAAwB,WAAxB,EAAwB,UAAxB,EAAwB,YAAxB,EAAwB,SAAxB,EAAwB,oCAAxB;AAKe;AAAA;AAOa;AAAA,0EAA6C,UAA7C,EAA6C,YAA7C;AACJ;AAAA;AAMI;AAAA,yEAA4C,UAA5C,EAA4C,YAA5C;AACJ;AAAA;AAOO;AAAA;;;;;;sEDjC9BvC,qB;;;;2BAAAA,qB,EAAqB;cANjC,OAAA5jB,SAMiC;eANvB;AACPjlD,kBAAQ,EAAE,yBADH;AAEPklD,qBAAW,EAAE,0CAFN;AAGPC,mBAAS,EAAE,CAAC,0CAAD;AAHJ,S;AAMuB,Q;;gBAE7B,OAAAziD;;;gBACA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AEfL;AAAA;AAAA;;AAKA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;AAOY;AAII;AAKA;AACA;AACJ;;;;;AARI;AADA;AAGI;AAAA,wCAAiB,MAAjB,EAAiB,UAAjB;AAKJ;AAAA;;;;;;AAVJ;;;;;AACI;;;;;;QAeH2oE,qB;;;;;AAcT,qCAAY1L,KAAZ,EAAqC;AAAA;;AAAA;;AACjC,uCAAMA,KAAN;AAPJ;;;;AAIA,iBAAA2L,cAAA,GAAiB,KAAjB;AAEqC;AAEpC;;;MAhBsC,0BAAA5L,qB;;AApB3C;;;uBAoBa2L,qB,EAAqB,yC;AAAA,K;;;YAArBA,qB;AAAqB,wC;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,6B;AAAA,c;AAAA,a;AAAA,sI;AAAA;AAAA;;AAjB1B;;;;;;;;;2BAiBKA,qB,EAAqB;cApBjC,OAAApmB,SAoBiC;eApBvB;AACPjlD,kBAAQ,EAAE,mBADH;AAEPuxD,kBAAQ,mnBAFD;AAkBPpM,mBAAS,EAAE,CAAC,+BAAD;AAlBJ,S;AAoBuB,Q;;;;;;gBAE7B,OAAAziD;;;gBAGA,OAAAA;;;gBAMA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;ACvCL;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJY;AACI;;AAIJ;;;;;;;AAHQ;AAAA,+DAAA6oE,mBAAA;AACA,qDAAsD,aAAtD,EAAsD,wBAAtD;;;;;;AAGR;AAGI;;AAIJ;;;;;;AALI;AAEI;AAAA,2CAAiB,UAAjB,EAAiB,kDAAjB;;;;;;AAKZ;;;;AAGI;;;;QDKCC,e;AAgET,iCAAc;AAAA;;;;AAvDP,aAAAxlD,OAAA,GAA+B,EAA/B;AAKP;;;;AAIO,aAAAylD,aAAA,GAAgB,KAAhB;AAGA,aAAAC,YAAA,GAAe,KAAf;AASA,aAAAC,WAAA,GAAuB,KAAvB;AAOA,aAAAjQ,iBAAA,GAAiC,IAAI,QAAA39B,WAAJ,EAAjC;AAEA,aAAAz3B,KAAA,GAAQ,IAAI,OAAAzH,eAAJ,CAAwC,KAAKogE,aAAL,KAAkB,MAAI,KAAKj5C,OAAL,CAAa,CAAb,CAAJ,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAE1f,KAAvC,CAAxC,CAAR;AAEP;;AACO,aAAAy4D,QAAA,GAAW,IAAI,OAAAlgE,eAAJ,CAAyC,KAAKmnB,OAA9C,CAAX;AAKA,aAAA6+C,cAAA,GAAiB,OAAA9xC,aAAA,CAAc,CAAC,KAAKgsC,QAAN,EAAgB,KAAKz4D,KAArB,CAAd,EAA2C4N,IAA3C,CACpB,YAAAjL,GAAA,CAAI;AAAA;AAAA,cAAE+c,OAAF;AAAA,cAAW1f,KAAX;;AAAA,iBAAsB0f,OAAO,CAACpf,IAAR,CAAa,UAAAonB,CAAC;AAAA,mBAAIA,CAAC,CAAC1nB,KAAF,KAAYA,KAAhB;AAAA,WAAd,CAAtB;AAAA,SAAJ,CADoB,CAAjB;AAIA,aAAAs+D,iBAAA,GAAoB,KAAK7F,QAAL,CAAc7qD,IAAd,CACvB,YAAAjL,GAAA,CAAI,UAAAu8D,EAAE;AAAA,iBAAIA,EAAE,CAAClgE,MAAH,GAAY,CAAZ,IAAiBkgE,EAAE,CAAC,CAAD,CAAvB;AAAA,SAAN,CADuB,CAApB;AAcN;;;;mCAViB73C,M,EAA2B;AACzC,iBAAO,KAAKrnB,KAAL,CAAW4N,IAAX,CAAgB,YAAAjL,GAAA,CAAI,UAAAkJ,CAAC;AAAA,mBAAIA,CAAC,KAAKwb,MAAM,CAACrnB,KAAjB;AAAA,WAAL,CAAhB,CAAP;AACH;;;mCAUc,CACd;;;oCAEkBxF,O,EAAsB;;;AACrC,cAAIA,OAAO,CAACklB,OAAZ,EAAqB;AACjB,iBAAK+4C,QAAL,CAAcxtD,IAAd,CAAmB,KAAKyU,OAAxB;;AACA,iBAAK1f,KAAL,CAAWiL,IAAX,CAAgB,KAAK0tD,aAAL,KAAkB,YAAI,KAAKj5C,OAAT,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAG,CAAH,CAAhB,MAAoB,IAApB,IAAoB,aAApB,GAAoB,MAApB,GAAoB,GAAG1f,KAAzC,CAAhB;AACH;;AACD,cAAIxF,OAAO,CAACm+D,aAAZ,EAA2B;AACvB,iBAAK34D,KAAL,CAAWiL,IAAX,CAAgB,CAAD,KAAC,KAAK0tD,aAAL,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAE34D,KAApC;AACH;AACJ;AAED;;;;;;;iCAIgBknD,S,EAAiB;AAC7B,eAAKlnD,KAAL,CAAWiL,IAAX,CAAgBi8C,SAAhB;;AACA,cAAI,KAAKI,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAe,KAAK5nC,OAAL,CAAapf,IAAb,CAAkB,UAAAmE,CAAC;AAAA,qBAAIA,CAAC,CAACzE,KAAF,KAAYknD,SAAhB;AAAA,aAAnB,CAAf;AACH;AACJ;AAED;;;;;;;mCAIkBlnD,K,EAAiC;AAC/C,cAAIA,KAAK,IAAI,IAAb,EAAmB;AACf,iBAAKA,KAAL,CAAWiL,IAAX,CAAgBjL,KAAK,CAACA,KAAtB;AACH;AACJ;;;yCAEuB03B,Q,EAAmB;AACvC,eAAKA,QAAL,GAAgBA,QAAhB;AACH;AAED;;;;;;;yCAIwB5+B,E,EAAkC;AACtD,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;AAED;;;;;;;0CAIyBA,E,EAAkC;AACvD,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;;;4BA5DmB;;;AAChB,iBAAO,CAAP,WAAO,KAAKywD,YAAZ,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,GAAEqM,SAAnB,MAA4B,IAA5B,IAA4B,aAA5B,GAA4B,EAA5B,GAAgC,KAAvC;AACH;;;;;;AA1EL;;;uBAaasP,e;AAAe,K;;;YAAfA,e;AAAe,iC;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;uCATb,CACP;AACI70B,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAMwd,eAAN;AAAA,SAAX,CAFjB;AAGIvd,aAAK,EAAE;AAHX,OADO,C,GAMV,uB;AAAA,e;AAAA,c;AAAA,iqB;AAAA;AAAA;ACjCL;AACI;AAAiC;AAAS;AAC1C;AAGI;AAMI;AAAA,mBAAe,IAAAjqD,QAAA,QAAf;AAA+B,WAA/B;;;AAEA;AAMA;;;;AAQJ;AACA;AAKA;AACI;AACJ;AACJ;AACJ;;;;;;AArCuC;AACxB;AAAA;AAAsB;AAAA;AAMzB;AAAA,kDAAoD,OAApD,EAAoD,gCAApD,EAAoD,UAApD,EAAoD,YAApD;AAMY;AAAA;AAOR;AAAA;AASJ;AAAA;AAKkB;AAAA;;;;;;;;;;;2BDEjBwnE,e,EAAe;cAb3B,OAAAvmB,SAa2B;eAbjB;AACPjlD,kBAAQ,EAAE,YADH;AAEPklD,qBAAW,EAAE,yBAFN;AAGPC,mBAAS,EAAE,CAAC,yBAAD,CAHJ;AAIPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAMwd,eAAN;AAAA,aAAX,CAFjB;AAGIvd,iBAAK,EAAE;AAHX,WADO,CAJJ;AAWPmQ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AAX1B,S;AAaiB,Q;;;;gBAEvB,OAAA7lB;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAMA,OAAAA;;;gBAGA,OAAAA;;;gBAIA,OAAAA;;;gBAEA,OAAAA;;;gBAGA,OAAAA;;;gBAgBA,OAAA+lD,S;iBAAU,Q;;;;;;;;;;;;;;;;;;;;;;;;AEjFf;AAAA;AAAA;;;;;;;;;;QAmBamjB,0B,GAZb;AAAA;;AAkBI,WAAApkC,KAAA,GAAQ,IAAI,OAAAkb,YAAJ,EAAR;AAEH,K;;AApBD;;;uBAYakpB,0B;AAA0B,K;;;YAA1BA,0B;AAA0B,8C;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,c;AAAA,a;AAAA,qH;AAAA;AAAA;AAT/B;AACI;AAAA,mBAAS,IAAApkC,KAAA,OAAT;AAAqB,WAArB;AAEA;AAAM;AAAS;AACf;AACJ;;;;AAFU;AAAA;;;;;;;;;2BAMLokC,0B,EAA0B;cAZtC,OAAA3mB,SAYsC;eAZ5B;AACPjlD,kBAAQ,EAAE,yBADH;AAEPuxD,kBAAQ,kQAFD;AAUPpM,mBAAS,EAAE,CAAC,sCAAD;AAVJ,S;AAY4B,Q;;gBAElC,OAAAziD;;;gBAGA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;ACxBL;AAAA;AAAA;;AAMA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;AAiBY;;;;;AAAK;AAEA;;;;;;;;;;;;;AAEL;;;;;AAAK;AAEA;;;;;;AANL;AAIA;;;;;AAHK;AAIA;AAAA;;;;AApBjB,QAAYymB,UAAZ;;AAAA,eAAYA,UAAZ,EAAsB;AAClB;;;AAGA;AACA;;;;AAGA;AACH,KATD,EAAYA,UAAU,GAAV,QAAAA,UAAA,aAAAA,UAAA,GAAU,EAAV,CAAZ;;QA2BaC,e;;;;;AAeT,+BAAYnM,KAAZ,EAAqC;AAAA;;AAAA;;AACjC,uCAAMA,KAAN;AAfJ,iBAAAkM,UAAA,GAAaA,UAAb;AAMA,iBAAAxR,IAAA,GAAmBwR,UAAU,CAACE,UAA9B;AAQqC;AAEpC;;;MAjBgC,0BAAArM,qB;;AAhBrC;;;uBAgBaoM,e,EAAe,yC;AAAA,K;;;YAAfA,e;AAAe,iC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,kE;AAAA;AAAA;AAbpB;;;;;;;;;2BAaKA,e,EAAe;cAhB3B,OAAA7mB,SAgB2B;eAhBjB;AACPjlD,kBAAQ,EAAE,YADH;AAEPuxD,kBAAQ,2fAFD;AAcPpM,mBAAS,EAAE,CAAC,wBAAD;AAdJ,S;AAgBiB,Q;;;;;;gBAGvB,OAAAziD;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AC/CL;AAAA;AAAA;;;;;;;;;;;;;;;;;;AAgBY;AAKI;AAAA;AAAA;AAAA;AAAA;AAAA;AAC+B;AAAkB;;;;;;AAHjD;AAGA;AAA+B;AAAA;;;;QAKlCspE,oB;AAcT,sCAAc;AAAA;;AALd,aAAAt+C,eAAA,GAAuC,EAAvC;AAGA,aAAAu+C,aAAA,GAAgB,IAAI,OAAAvpB,YAAJ,EAAhB;AAGC;;;;mCAEO,CACP;;;wCAEsB/0B,M,EAA2B;AAC9C,eAAKs+C,aAAL,CAAmBnoB,IAAnB,CAAwBn2B,MAAxB;AACH;;;mCAEiBA,M,EAA2B;AACzC,iBAAO,CAAC,CAAC,KAAKD,eAAL,CAAqB9mB,IAArB,CAA0B,UAAA+R,CAAC;AAAA,mBAAIA,CAAC,CAACrS,KAAF,KAAYqnB,MAAM,CAACrnB,KAAvB;AAAA,WAA3B,CAAT;AACH;;;;;;AA5CL;;;uBAkBa0lE,oB;AAAoB,K;;;YAApBA,oB;AAAoB,uC;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,c;AAAA,a;AAAA,mU;AAAA;AAAA;AAfzB;AACI;AAEyB;AAAS;AAClC;AAOJ;;;;AATQ;AAAA;AACqB;AAAA;AAKrB;AAAA;;;;;;;;;2BAOHA,oB,EAAoB;cAlBhC,OAAA/mB,SAkBgC;eAlBtB;AACPjlD,kBAAQ,EAAE,kBADH;AAEPuxD,kBAAQ,ylBAFD;AAgBPpM,mBAAS,EAAE,CAAC,+BAAD;AAhBJ,S;AAkBsB,Q;;;;gBAE5B,OAAAziD;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;ACtCL;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwBoB;AAGI;;AAIJ;;;;;;AALI;AAEI;AAAA,2CAAiB,UAAjB,EAAiB,kDAAjB;;;;QAqBfoK,kB;;;;;AA/Cb;AAAA;;AAAA;;;AAoDI;;AACgB,iBAAA5pD,IAAA,GAAO,EAAP;AAGhB;;AACgB,iBAAAs/D,WAAA,GAAc,IAAd;AAGhB;;AACgB,iBAAAl9D,QAAA,GAAoB,IAAI,UAAAsM,MAAJ,CAAW;AAAElR,cAAI,EAAEJ,IAAI,CAAConB,GAAL;AAAR,SAAX,EAAiCy1B,QAArD;AAWhB;;AACO,iBAAAz8C,IAAA,GAAO,IAAI,OAAAvE,eAAJ,CAAoB,UAAAgO,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAAxC,CAAP;AAEA,iBAAA2uD,iBAAA,GAAiC,IAAI,QAAA39B,WAAJ,EAAjC;AAEA,iBAAA4mC,WAAA,GAAc,OAAA5xC,aAAA,CAAc,CAC/B,SAAK2oC,iBAAL,CAAuB18B,YADQ,EAE/B,SAAK57B,IAF0B,CAAd,EAEL8Q,IAFK,CAGjB,YAAAjL,GAAA,CAAI;AAAA;AAAA,cAAE3C,KAAF;AAAA,cAASlD,IAAT;;AAAA,iBAAmB,OAAAuC,kBAAA,CAAmB,SAAKC,IAAxB,EAA8BU,KAA9B,EAAqC,QAAAP,QAAA,CAASqkB,GAAT,GAAenkB,OAAf,EAArC,CAAnB;AAAA,SAAJ,CAHiB,CAAd;AAMP;;AACO,iBAAAK,KAAA,GAAQ,IAAI,OAAAzH,eAAJ,CAA4B,OAAAsE,iBAAA,CAAkB,QAAA4C,QAAA,CAASqkB,GAAT,EAAlB,EAAkC,SAAKxkB,IAAvC,EAA6CO,QAA7C,CAAsD,OAAtD,CAA5B,CAAR;AAEP;;AACO,iBAAA6f,OAAA,GAAU,IAAI,OAAAnnB,eAAJ,CAAyC,aAAA+wD,sBAAA,CAAuB,UAAA/iD,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAA3C,EAA+C,CAAC,SAAKm4D,WAArD,EAAkE,SAAKt/D,IAAvE,EAA6E,SAAKoC,QAAlF,CAAzC,CAAV;AAEA,iBAAA68D,cAAA,GAAiB,OAAA9xC,aAAA,CAAc,CAAC,SAAK/M,OAAN,EAAe,SAAK1f,KAApB,CAAd,EAA0C4N,IAA1C,CACpB,YAAAjL,GAAA,CAAI;AAAA;AAAA,cAAE+c,OAAF;AAAA,cAAW1f,KAAX;;AAAA,iBAAsB0f,OAAO,CAACpf,IAAR,CAAa,UAAAonB,CAAC;AAAA,mBAAIA,CAAC,CAAC1nB,KAAF,KAAYA,KAAhB;AAAA,WAAd,CAAtB;AAAA,SAAJ,CADoB,CAAjB;AAIA,iBAAAs+D,iBAAA,GAAoB,SAAK5+C,OAAL,CAAa9R,IAAb,CACvB,YAAAjL,GAAA,CAAI,UAAAu8D,EAAE;AAAA,iBAAIA,EAAE,CAAClgE,MAAH,GAAY,CAAZ,IAAiBkgE,EAAE,CAAC,CAAD,CAAvB;AAAA,SAAN,CADuB,CAApB;AA7FX;AA4MC;;;;mCA3GqB73C,M,EAA2B;AACzC,iBAAO,KAAKrnB,KAAL,CAAW4N,IAAX,CAAgB,YAAAjL,GAAA,CAAI,UAAAkJ,CAAC;AAAA,mBAAIA,CAAC,KAAKwb,MAAM,CAACrnB,KAAjB;AAAA,WAAL,CAAhB,CAAP;AACH;;;mCAMc;AAAA;;AACX;AACA,eAAK0f,OAAL,CAAazU,IAAb,CAAkB,aAAAq+C,sBAAA,CAAuB,KAAKxsD,IAAL,CAAUkD,KAAjC,EAAwC,CAAC,KAAK4+D,WAA9C,EAA2D,KAAKt/D,IAAhE,EAAsE,KAAKoC,QAA3E,CAAlB,EAFW,CAIX;;AACA,eAAK7G,YAAL,CAAkB,iBAAlB,EACI,OAAA4xB,aAAA,CAAc,CACV,KAAK3vB,IADK,CAAd,EAEG8Q,IAFH,CAGI,YAAAjL,GAAA,CAAI,kBAAY;AAAA;AAAA,gBAAV7F,IAAU;;AACZ;AACA,gBAAM8oE,eAAe,GAAG,OAAA/oE,iBAAA,CAAkB,QAAA4C,QAAA,CAASC,UAAT,CAAoB5C,IAAI,CAAC6C,OAAL,EAApB,CAAlB,EAAuD,QAAI,CAACL,IAA5D,CAAxB,CAFY,CAGZ;;AACA,mBAAO,IAAI,UAAA0O,MAAJ,CAAW;AAAClR,kBAAI,EAAE8oE,eAAe,CAACjmE,OAAhB,EAAP;AAAkCwkB,yBAAW,EAAC,KAA9C;AAAqDC,yBAAW,EAAE,QAAI,CAAC1iB;AAAvE,aAAX,CAAP;AACH,WALD,CAHJ,EASI,YAAAqjD,cAAA,CAAe,KAAKrlC,OAApB,CATJ,EAUI,YAAAhc,MAAA,CAAO,kBAAwD;AAAA;AAAA,gBAAtD5G,IAAsD;AAAA,gBAAhDqiE,WAAgD;;AAC3D;AACA,mBAAO,CAACA,WAAW,CAAC7+D,IAAZ,CAAiB,UAAAuL,CAAC;AAAA,qBAAIA,CAAC,CAAC7L,KAAF,KAAYlD,IAAI,CAACsB,UAAL,CAAgB,OAAhB,CAAhB;AAAA,aAAlB,CAAR;AACH,WAHD,CAVJ,EAcI,YAAAuE,GAAA,CAAI,kBAAyB;AAAA;AAAA,gBAAvB7F,IAAuB;AAAA,gBAAjBqiE,WAAiB;;AACzB;AACA;AACAA,uBAAW,CAACx6D,IAAZ,CAAiB;AACboE,qBAAO,EAAE,OAAAvB,6BAAA,CAA8B1K,IAA9B,CADI;AAEbkD,mBAAK,EAAElD,IAAI,CAACsB,UAAL,CAAgB,OAAhB;AAFM,aAAjB,EAHyB,CAOzB;;AACA+gE,uBAAW,CAACn6D,IAAZ,CAAiB,UAACC,CAAD,EAAIC,CAAJ;AAAA,qBAAU,UAAGD,CAAC,CAACjF,KAAL,EAAamF,aAAb,WAA8BD,CAAC,CAAClF,KAAhC,EAAV;AAAA,aAAjB;AACA,mBAAOm/D,WAAP;AACH,WAVD,CAdJ,EAyBEpkE,SAzBF,CAyBY,UAAAkQ,IAAI;AAAA,mBAAI,QAAI,CAACyU,OAAL,CAAazU,IAAb,CAAkBA,IAAlB,CAAJ;AAAA,WAzBhB,CADJ;AA2BH;;;oCAEkBzQ,O,EAAsB;AACrC,cAAIA,OAAO,CAAC2uD,aAAR,IAAyB3uD,OAAO,CAAC8E,IAAjC,IAAyC9E,OAAO,CAACkH,QAArD,EAA+D;AAC3D;AACA,iBAAKge,OAAL,CAAazU,IAAb,CAAkB,aAAAq+C,sBAAA,CAAuB,KAAKxsD,IAAL,CAAUkD,KAAjC,EAAwC,CAAC,KAAK4+D,WAA9C,EAA2D,KAAKt/D,IAAhE,EAAsE,KAAKoC,QAA3E,CAAlB;AACA,gBAAMmkE,YAAY,GAAG,IAAI,UAAA73D,MAAJ,CAAW;AAAClR,kBAAI,EAAE,KAAK2P,IAAZ;AAAkB0X,yBAAW,EAAE,KAA/B;AAAsCC,yBAAW,EAAE,KAAK1iB;AAAxD,aAAX,EAA8E8E,YAA9E,CAA2F,QAA3F,CAArB;AACA,iBAAKxG,KAAL,CAAWiL,IAAX,CAAgB46D,YAAY,CAACznE,UAAb,CAAwB,OAAxB,CAAhB;AACH;;AACD,cAAI5D,OAAO,CAACiS,IAAZ,EAAkB;AACd;AACA,iBAAK3P,IAAL,CAAUmO,IAAV,CAAe,KAAKwB,IAApB;AACH;AACJ;AAED;;;;;;;iCAIgBy6C,S,EAAiB;AAC7B;AACA,cAAM4e,OAAO,GAAG,CAAC5e,SAAS,CAAChnD,OAAV,CAAkB,GAAlB,IAAyB,CAAzB,GAA6BgnD,SAA7B,GAAyC,OAA1C,EAAmDpoD,KAAnD,CAAyD,GAAzD,CAAhB,CAF6B,CAG7B;;AACA,cAAMb,CAAC,GAAG,IAAI,UAAA+P,MAAJ,CAAW;AAAElR,gBAAI,EAAE,KAAKA,IAAL,CAAUkD,KAAlB;AAAyBmkB,uBAAW,EAAE,KAAtC;AAA6CC,uBAAW,EAAE,KAAK1iB;AAA/D,WAAX,CAAV;AACA,cAAM5E,IAAI,GAAGmB,CAAC,CAACP,QAAF,CAAW;AAAE0B,gBAAI,EAAEa,QAAQ,CAAC6lE,OAAO,CAAC,CAAD,CAAR,CAAhB;AAA8B3oE,kBAAM,EAAE8C,QAAQ,CAAC6lE,OAAO,CAAC,CAAD,CAAR;AAA9C,WAAX,CAAb;;AACA,cAAIhpE,IAAJ,EAAU;AACN,gBAAI,KAAKwqD,SAAT,EAAoB;AAChB,mBAAKA,SAAL,CAAexqD,IAAI,CAAC2J,EAApB;AACH;AACJ;AACJ;AAED;;;;;;;mCAIkBzG,K,EAAsB;AACpC,cAAIA,KAAK,IAAI,IAAb,EAAmB;AACf;AACA,iBAAKlD,IAAL,CAAUmO,IAAV,CAAejL,KAAf,EAFe,CAGf;;AACA,gBAAMlD,IAAI,GAAG,OAAAD,iBAAA,CAAkB,QAAA4C,QAAA,CAASC,UAAT,CAAoBM,KAApB,EAA2B65C,OAA3B,CAAmC,QAAnC,CAAlB,EAAgE,KAAKv6C,IAArE,CAAb,CAJe,CAKf;;AACA,gBAAMumE,YAAY,GAAG,IAAI,UAAA73D,MAAJ,CAAW;AAAClR,kBAAI,EAAEA,IAAI,CAAC6C,OAAL,EAAP;AAAuBwkB,yBAAW,EAAE,KAApC;AAA2CC,yBAAW,EAAE,KAAK1iB;AAA7D,aAAX,EAAmF8E,YAAnF,CAAgG,QAAhG,CAArB;AACA,iBAAKkZ,OAAL,CAAazU,IAAb,CAAkB,aAAAq+C,sBAAA,CAAuBuc,YAAY,CAACp/D,EAApC,EAAwC,CAAC,KAAKm4D,WAA9C,EAA2D,KAAKt/D,IAAhE,EAAsE,KAAKoC,QAA3E,CAAlB;AACH;AACJ;;;yCAEuBg2B,Q,EAAmB;AACvC,eAAKA,QAAL,GAAgBA,QAAhB;AACH;AAED;;;;;;;yCAIwB5+B,E,EAAuB;AAC3C,eAAKwuD,SAAL,GAAiBxuD,EAAjB;AACH;AAED;;;;;;;0CAIyBA,E,EAAuB;AAC5C,eAAKyuD,QAAL,GAAgBzuD,EAAhB;AACH;;;4BAtGmB;;;AAChB,iBAAO,CAAP,WAAO,KAAKywD,YAAZ,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,GAAEqM,SAAnB,MAA4B,IAA5B,IAA4B,aAA5B,GAA4B,EAA5B,GAAgC,KAAvC;AACH;;;;MAxDmC,OAAAr8D,a;;AA/CxC;;;kDA+Ca2vD,kB;AAAkB,K;;;YAAlBA,kB;AAAkB,qC;AAAA;AAAA;;;;;;;;;;;;;;;;;;;uCAThB,CACP;AACI7Y,eAAO,EAAE,QAAAmX,iBADb;AAEIC,mBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,iBAAMwB,kBAAN;AAAA,SAAX,CAFjB;AAGIvB,aAAK,EAAE;AAHX,OADO,C,GAMV,6B,EAAA,uB;AAAA,e;AAAA,c;AAAA,4iB;AAAA;AAAA;AAzCG;AACI;AAAiC;AAAS;AAC1C;AAGI;AAMI;AAAA,mBAAe,IAAAjqD,QAAA,QAAf;AAA+B,WAA/B;;;AAEA;AACI;;AAIJ;AACA;;;;AAQJ;AACA;AACI;AACJ;AACJ;AACJ;;;;;;;;AA/Be;AAAA;AAAsB;AAAA;AAMzB;AAAA,kDAAoD,OAApD,EAAoD,gCAApD,EAAoD,UAApD,EAAoD,YAApD;AASQ;AAAA,uDAAsD,aAAtD,EAAsD,qBAAtD;AAIJ;AAAA;AASc;AAAA;;;;;;;;mEAezBwrD,kB;;;;2BAAAA,kB,EAAkB;cA/C9B,OAAAvK,SA+C8B;eA/CpB;AACPjlD,kBAAQ,EAAE,gBADH;AAEPuxD,kBAAQ,2tDAFD;AAqCPpM,mBAAS,EAAE,CAAC,6BAAD,CArCJ;AAsCPpD,mBAAS,EAAE,CACP;AACIpL,mBAAO,EAAE,QAAAmX,iBADb;AAEIC,uBAAW,EAAE,OAAAC,UAAA,CAAW;AAAA,qBAAMwB,kBAAN;AAAA,aAAX,CAFjB;AAGIvB,iBAAK,EAAE;AAHX,WADO,CAtCJ;AA6CPmQ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AA7C1B,S;AA+CoB,Q;;gBAC1B,OAAA7lB;;;gBAEA,OAAAA;;;gBAGA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBASA,OAAA+lD,S;iBAAU,Q;;;;;;;;;;;;;;;;;;;;;;;;AC5Gf;AAAA;AAAA;;;;;;;;;;;;;;;;;;AAYY;AAII;AAAA;AAAA;AAAA;AAAA;AAAA;AACC;AAAmB;;;;;;AAHpB;AAFmC;AACnC;AAIC;AAAA;;;;QAKJ4jB,e;AAdb;AAAA;;AAuBI,aAAAC,cAAA,GAAiB,IAAI,OAAA5pB,YAAJ,EAAjB;AASH;;;;oCAPsB/0B,M,EAA2B;AAC1C,eAAK2+C,cAAL,CAAoBxoB,IAApB,CAAyBn2B,MAAzB;AACH;;;mCAEUA,M,EAA2B;AAClC,iBAAO,KAAKE,QAAL,KAAkBF,MAAzB;AACH;;;;;;AA/BL;;;uBAca0+C,e;AAAe,K;;;YAAfA,e;AAAe,iC;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,c;AAAA,a;AAAA,kL;AAAA;AAAA;AAXpB;AACI;AAMJ;;;;AANY;AAAA;;;;;;;;;2BAUPA,e,EAAe;cAd3B,OAAApnB,SAc2B;eAdjB;AACPjlD,kBAAQ,EAAE,YADH;AAEPuxD,kBAAQ,kcAFD;AAYPpM,mBAAS,EAAE,CAAC,yBAAD;AAZJ,S;AAciB,Q;;gBAEvB,OAAAziD;;;gBAGA,OAAAA;;;gBAGA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AC9BL;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;ACCE;AACE;AACF;;;;;AADE;AAAA;;;;;;;;QDKSmnB,gB,GALb;AAAA;;AAME,WAAAC,SAAA,GAAqB,KAArB,CANF,CAM8B;;AAC5B,WAAApe,QAAA,GAA4B,gBAAAqe,eAAA,CAAgBC,OAA5C;AACA,WAAAC,KAAA,GAAsB,gBAAAC,YAAA,CAAaF,OAAnC;AACA,WAAAG,OAAA,GAAU,EAAV;AACA,WAAA1kB,IAAA,GAAO,CAAP;AACA,WAAAF,GAAA,GAAM,CAAN;AACA,WAAA6kB,OAAA,GAAU,KAAV;AACD,K;;AAbD;;;uBAKaP,gB;AAAgB,K;;;YAAhBA,gB;AAAgB,kC;AAAA,c;AAAA,c;AAAA,qE;AAAA;AAAA;ACR7B;AAEE;AAGF;;;;AAJE,kDAA0B,KAA1B,EAA0B,cAA1B;AADyE;AAAtD;AAEd;AAAA;;;;;;;;;2BDMMA,gB,EAAgB;cAL5B,OAAAtnB,SAK4B;eALlB;AACTjlD,kBAAQ,EAAE,aADD;AAETklD,qBAAW,EAAE,0BAFJ;AAGTC,mBAAS,EAAE,CAAC,0BAAD;AAHF,S;AAKkB,Q;;;;;;;;;;;;;;;;;;;;;;AER7B;AAAA;AAAA;;AAYA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;QAKa4nB,gB;AAeX,gCAAoBxM,UAApB,EAAoDyM,MAApD,EACMC,wBADN,EACkEC,QADlE,EACsF;AAAA;;AADlE,aAAA3M,UAAA,GAAAA,UAAA;AAAgC,aAAAyM,MAAA,GAAAA,MAAA;AAC9C,aAAAC,wBAAA,GAAAA,wBAAA;AAA4D,aAAAC,QAAA,GAAAA,QAAA;AAdzD,aAAAL,OAAA,GAAU,EAAV;AACA,aAAAze,QAAA,GAA4B,gBAAAqe,eAAA,CAAgBC,OAA5C;AACA,aAAAC,KAAA,GAAsB,gBAAAC,YAAA,CAAaF,OAAnC;AACA,aAAA9uE,OAAA,GAA6B,OAA7B;AACA,aAAAuvE,SAAA,GAAY,CAAZ;AACA,aAAAC,SAAA,GAAY,CAAZ;AACA,aAAA/2C,IAAA,GAAgB,IAAhB;AAED,aAAAg3C,YAAA,GAAyC,IAAzC;AAOP;;;;uCAGW;AACV,cAAI,KAAKzvE,OAAL,KAAiB,OAArB,EAA8B;AAC5B,iBAAK0vE,iBAAL;AACD;AACF;;;uCAGW;AACV,cAAI,KAAK1vE,OAAL,KAAiB,OAArB,EAA8B;AAC5B,iBAAK2vE,qBAAL;AACD;AACF;;;kCAGM;AACL,cAAI,KAAK3vE,OAAL,KAAiB,OAArB,EAA8B;AAC5B,gBAAI,KAAKyvE,YAAL,KAAsB,IAA1B,EAAgC;AAC9B,mBAAKC,iBAAL;AACD,aAFD,MAEO;AACL,mBAAKxtE,OAAL,GADK,CACW;AACjB;AACF;AACF;;;qCAGYmvD,M,EAAkB;AAC7BA,gBAAM,CAAC7mB,cAAP;AACAz/B,gBAAM,CAAC3J,YAAP,CAAoB,KAAKwuE,YAAzB;AACA,eAAKA,YAAL,GAAoB7kE,MAAM,CAACpJ,UAAP,CAAkB,KAAK+tE,iBAAL,CAAuBG,IAAvB,CAA4B,IAA5B,CAAlB,EAAqD,GAArD,CAApB;AACD;;;qCAGS;AACR9kE,gBAAM,CAAC3J,YAAP,CAAoB,KAAKwuE,YAAzB;AACA,eAAKD,qBAAL;AACD;;;4CAE2B;AAC1B,cAAI,KAAKF,YAAL,KAAsB,IAA1B,EAAgC;AAC9B1kE,kBAAM,CAAC1J,aAAP,CAAqB,KAAKmuE,SAA1B;AACA,gBAAMM,gBAAgB,GAAG,KAAKT,wBAAL,CAA8BU,uBAA9B,CAAsD,oBAAApB,gBAAtD,CAAzB;AACA,iBAAKc,YAAL,GAAoBK,gBAAgB,CAACtM,MAAjB,CAAwB,KAAK8L,QAA7B,CAApB;AAEA,iBAAKF,MAAL,CAAYY,UAAZ,CAAuB,KAAKP,YAAL,CAAkBQ,QAAzC;;AAL8B,uDAMD,KAAKR,YAAL,CAAkBQ,QAAlB,CAAoDC,SANnD;AAAA,gBAMvBC,iBANuB;;AAQ9B,iBAAKC,6BAAL;AAEAr/D,oBAAQ,CAACW,IAAT,CAAcC,WAAd,CAA0Bw+D,iBAA1B;AACA,iBAAKE,WAAL,GAAmBtlE,MAAM,CAACpJ,UAAP,CAAkB,KAAK2uE,WAAL,CAAiBT,IAAjB,CAAsB,IAAtB,CAAlB,EAA+C,KAAKN,SAApD,CAAnB;AACD;AACF;;;wDAEuC;AACtC,cAAI,KAAKE,YAAL,KAAsB,IAA1B,EAAgC;AAC9B,iBAAKA,YAAL,CAAkBc,QAAlB,CAA2BtB,OAA3B,GAAqC,KAAKA,OAA1C;AACA,iBAAKQ,YAAL,CAAkBc,QAAlB,CAA2B/f,QAA3B,GAAsC,KAAKA,QAA3C;AACA,iBAAKif,YAAL,CAAkBc,QAAlB,CAA2BxB,KAA3B,GAAmC,KAAKA,KAAxC;;AAH8B,wCAKK,KAAKpM,UAAL,CAAgBt/D,aAAhB,CAA8BmtE,qBAA9B,EALL;AAAA,gBAKvBjmB,IALuB,yBAKvBA,IALuB;AAAA,gBAKjBkmB,KALiB,yBAKjBA,KALiB;AAAA,gBAKVpmB,GALU,yBAKVA,GALU;AAAA,gBAKLqmB,MALK,yBAKLA,MALK;;AAO9B,oBAAQ,KAAKlgB,QAAb;AACE,mBAAK,gBAAAqe,eAAA,CAAgB8B,KAArB;AAA4B;AAC1B,uBAAKlB,YAAL,CAAkBc,QAAlB,CAA2BhmB,IAA3B,GAAkCzkD,IAAI,CAACk1B,KAAL,CAAW,CAACy1C,KAAK,GAAGlmB,IAAT,IAAiB,CAAjB,GAAqBA,IAAhC,CAAlC;AACA,uBAAKklB,YAAL,CAAkBc,QAAlB,CAA2BlmB,GAA3B,GAAiCvkD,IAAI,CAACk1B,KAAL,CAAW01C,MAAX,CAAjC;AACA;AACD;;AACD,mBAAK,gBAAA7B,eAAA,CAAgB+B,KAArB;AAA4B;AAC1B,uBAAKnB,YAAL,CAAkBc,QAAlB,CAA2BhmB,IAA3B,GAAkCzkD,IAAI,CAACk1B,KAAL,CAAW,CAACy1C,KAAK,GAAGlmB,IAAT,IAAiB,CAAjB,GAAqBA,IAAhC,CAAlC;AACA,uBAAKklB,YAAL,CAAkBc,QAAlB,CAA2BlmB,GAA3B,GAAiCvkD,IAAI,CAACk1B,KAAL,CAAWqvB,GAAX,CAAjC;AACA;AACD;;AACD,mBAAK,gBAAAwkB,eAAA,CAAgBgC,KAArB;AAA4B;AAC1B,uBAAKpB,YAAL,CAAkBc,QAAlB,CAA2BhmB,IAA3B,GAAkCzkD,IAAI,CAACk1B,KAAL,CAAWy1C,KAAX,CAAlC;AACA,uBAAKhB,YAAL,CAAkBc,QAAlB,CAA2BlmB,GAA3B,GAAiCvkD,IAAI,CAACk1B,KAAL,CAAWqvB,GAAG,GAAG,CAACqmB,MAAM,GAAGrmB,GAAV,IAAiB,CAAlC,CAAjC;AACA;AACD;;AACD,mBAAK,gBAAAwkB,eAAA,CAAgBiC,IAArB;AAA2B;AACzB,uBAAKrB,YAAL,CAAkBc,QAAlB,CAA2BhmB,IAA3B,GAAkCzkD,IAAI,CAACk1B,KAAL,CAAWuvB,IAAX,CAAlC;AACA,uBAAKklB,YAAL,CAAkBc,QAAlB,CAA2BlmB,GAA3B,GAAiCvkD,IAAI,CAACk1B,KAAL,CAAWqvB,GAAG,GAAG,CAACqmB,MAAM,GAAGrmB,GAAV,IAAiB,CAAlC,CAAjC;AACA;AACD;;AACD;AAAS;AACP;AACD;AAvBH;AAyBD;AACF;;;sCAEqB;AACpB,cAAI,KAAKolB,YAAL,KAAsB,IAA1B,EAAgC;AAC9B,iBAAKA,YAAL,CAAkBc,QAAlB,CAA2BrB,OAA3B,GAAqC,KAAKz2C,IAAL,GAAY,IAAZ,GAAmB,KAAxD;AACD;AACF;;;gDAE+B;AAC9B,eAAKs4C,WAAL,GAAmBhmE,MAAM,CAACpJ,UAAP,CAAkB,KAAKO,OAAL,CAAa2tE,IAAb,CAAkB,IAAlB,CAAlB,EAA2C,KAAKL,SAAhD,CAAnB;AACD;;;sCAEU;AACT,eAAKttE,OAAL;AACD;;;kCAEM;AACL,cAAI,KAAKutE,YAAL,KAAsB,IAA1B,EAAgC;AAC9B1kE,kBAAM,CAAC1J,aAAP,CAAqB,KAAKgvE,WAA1B;AACAtlE,kBAAM,CAAC1J,aAAP,CAAqB,KAAKmuE,SAA1B;AACA,iBAAKJ,MAAL,CAAY4B,UAAZ,CAAuB,KAAKvB,YAAL,CAAkBQ,QAAzC;AACA,iBAAKR,YAAL,CAAkBvtE,OAAlB;AACA,iBAAKutE,YAAL,GAAoB,IAApB;AACD;AACF;;;;;;AAtIH;;;uBAGaN,gB,EAAgB,mC,EAAA,uC,EAAA,iD,EAAA,iC;AAAA,K;;;YAAhBA,gB;AAAgB,sC;AAAA;AAAA;;mBAAhB,kB;AAAc,W,EAAA,Y,EAAA;AAAA,mBAAd,kBAAc;AAAA,W,EAAA,O,EAAA;AAAA,mBAAd,aAAc;AAAL,W,EAAA,Y,EAAA;AAAA,mBAAT,wBAAS;AAEtB,W,EAAA,U,EAAA;AAAA,mBAFa,gBAEb;AAFyB,W;;;;;;;;;;;;;;;;2BAAZA,gB,EAAgB;cAH5B,OAAAhtE,SAG4B;eAHlB;AACTC,kBAAQ,EAAE;AADD,S;AAGkB,Q;;;;;;;;;;;;gBAE1B,OAAA0C;;;gBACA,OAAAA;;;gBACA,OAAAA;;;gBACA,OAAAA;;;gBACA,OAAAA;;;gBACA,OAAAA;;;gBACA,OAAAA;;;gBAWA,OAAAmQ,Y;iBAAa,Y;;;gBAOb,OAAAA,Y;iBAAa,Y;;;gBAOb,OAAAA,Y;iBAAa,O;;;gBAWb,OAAAA,Y;iBAAa,Y,EAAc,CAAC,QAAD,C;;;gBAO3B,OAAAA,Y;iBAAa,U;;;;;;;;;;;;;;;;;;;;;;;ACrEhB,QAAY45D,eAAZ;;AAAA,eAAYA,eAAZ,EAA2B;AACvB;AACA;AACA;AACA;AACA;AACA;AACH,KAPD,EAAYA,eAAe,GAAf,QAAAA,eAAA,aAAAA,eAAA,GAAe,EAAf,CAAZ;;AASA,QAAYG,YAAZ;;AAAA,eAAYA,YAAZ,EAAwB;AACpB;AACA;AACA;AACH,KAJD,EAAYA,YAAY,GAAZ,QAAAA,YAAA,aAAAA,YAAA,GAAY,EAAZ,CAAZ;;;;;;;;;;;;;;;;;;;;;ACTA;AAAA;AAAA;;AAAS,YAAA1S,SAAA,4BAAAA,SAAA;AAAW,YAAAC,kBAAA,4BAAAA,kBAAA;;;;;;;;;;;;;;;;;;;;ACApB;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA,0E,CAAsF;;;AACtF;AAAA;AAAA,0E,CAAsF;;;AACtF;AAAA;AAAA,0F,CAA6G;;;AAC7G;AAAA;AAAA,kF,CAAiG;;;AACjG;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;AAEa,YAAA7H,gBAAA,GAA0B,CACnC,SAAAC,eADmC,EAEnC,YAAAC,iBAFmC,EAGnC,SAAAC,eAHmC,EAInC,aAAAC,kBAJmC,EAKnC,OAAAmc,aALmC,EAMnC,QAAAlc,cANmC,EAOnC,mBAAAC,wBAPmC,EAQnC,eAAAC,oBARmC,EASnC,eAAAC,qBATmC,EAUnC,SAAAC,eAVmC,EAWnC,QAAAC,cAXmC,EAYnC,OAAAC,eAZmC,EAanC,OAAAC,aAbmC,EAcnC,WAAAC,iBAdmC,EAenC,UAAAC,gBAfmC,EAgBnC,QAAAC,cAhBmC,EAiBnC,OAAAC,aAjBmC,EAkBnC,eAAAC,oBAlBmC,EAmBnC,YAAAub,kBAnBmC,EAoBnC,UAAAC,aApBmC,CAA1B;;QAkHA1lB,Q;;;;AA3Fb;;YA2FaA;;;;yBAAAA,Q;AAAQ,O;AAAA,iBA1FP,SAAAhrD,YA0FO,4BAzFV,QAAAi0D,gBAyFU,IAxFb,QAAAlJ,mBAwFa,EAvFb,QAAAD,WAuFa,EAtFb,wBAAA6lB,wBAsFa,EAtFa,sBAAAC,uBAsFb,IAvBb,QAAA7lB,mBAuBa,EAtBb,QAAAD,WAsBa;;;;+EAARE,Q,EAAQ;AAAA,uBApFb,2CAAA0R,mCAoFa,EAnFb,wCAAA4D,iCAmFa,EAlFb,4BAAA/F,sBAkFa,EAjFb,4BAAA2N,sBAiFa,EAhFb,oCAAAnD,6BAgFa,EA/Eb,gCAAAO,yBA+Ea,EA9Eb,uBAAAnU,kBA8Ea,EA7Eb,+BAAAyV,wBA6Ea,EA5Eb,2BAAA9V,sBA4Ea,EA3Eb,mCAAAoV,4BA2Ea,EA1Eb,mBAAA/F,eA0Ea,EAzEb,yBAAA4J,oBAyEa,EAxEb,cAAAf,UAwEa,EAvEb,gBAAAO,YAuEa,EAtEb,mBAAAkE,eAsEa,EArEb,0BAAAhG,qBAqEa,EApEb,yBAAAC,oBAoEa,EAnEb,0BAAAsF,qBAmEa,EAlEb,uBAAArF,kBAkEa,EAjEb,gCAAA4F,0BAiEa,EAhEb,yBAAAxR,oBAgEa,EA/Db,0BAAAyL,qBA+Da,EA9Db,mBAAAwG,eA8Da,EA7Db,kBAAAnG,cA6Da,EA5Db,kBAAAgB,cA4Da,EA3Db,4BAAArE,uBA2Da,EA1Db,yBAAAmJ,oBA0Da,EAzDb,6BAAAnF,uBAyDa,EAxDb,gCAAAZ,2BAwDa,EAvDb,mBAAAuF,eAuDa,EAtDb,4BAAArF,uBAsDa,EArDb,oCAAA0C,qBAqDa,EApDb,iCAAAE,kBAoDa,EAnDb,oCAAAV,oBAmDa,EAlDb,4BAAAnkB,uBAkDa,EAjDb,mCAAAkjB,6BAiDa,EAhDb,iCAAArE,2BAgDa,EA/Cb,uBAAA9C,kBA+Ca,EA9Cb,iCAAAI,2BA8Ca,EA7Cb,+BAAAL,yBA6Ca,EA5Cb,oBAAAuM,gBA4Ca,EA3Cb,oBAAAQ,gBA2Ca;AA3CG,kBA/CV,SAAA1uE,YA+CU,EAtEpB,SAAAk0D,eAsEoB,EArEpB,YAAAC,iBAqEoB,EApEpB,SAAAC,eAoEoB,EAnEpB,aAAAC,kBAmEoB,EAlEpB,OAAAmc,aAkEoB,EAjEpB,QAAAlc,cAiEoB,EAhEpB,mBAAAC,wBAgEoB,EA/DpB,eAAAC,oBA+DoB,EA9DpB,eAAAC,qBA8DoB,EA7DpB,SAAAC,eA6DoB,EA5DpB,QAAAC,cA4DoB,EA3DpB,OAAAC,eA2DoB,EA1DpB,OAAAC,aA0DoB,EAzDpB,WAAAC,iBAyDoB,EAxDpB,UAAAC,gBAwDoB,EAvDpB,QAAAC,cAuDoB,EAtDpB,OAAAC,aAsDoB,EArDpB,eAAAC,oBAqDoB,EApDpB,YAAAub,kBAoDoB,EAnDpB,UAAAC,aAmDoB,EA7ChB,QAAA3lB,mBA6CgB,EA5ChB,QAAAD,WA4CgB,EA3ChB,wBAAA6lB,wBA2CgB,EA3CU,sBAAAC,uBA2CV,CA2CH;AAtFoC,kBA8CjD,2CAAAlU,mCA9CiD,EA+CjD,wCAAA4D,iCA/CiD,EAgDjD,4BAAA/F,sBAhDiD,EAiDjD,4BAAA2N,sBAjDiD,EAkDjD,oCAAAnD,6BAlDiD,EAmDjD,gCAAAO,yBAnDiD,EAoDjD,uBAAAnU,kBApDiD,EAqDjD,+BAAAyV,wBArDiD,EAsDjD,2BAAA9V,sBAtDiD,EAuDjD,mCAAAoV,4BAvDiD,EAwDjD,yBAAA6D,oBAxDiD,EAyDjD,cAAAf,UAzDiD,EA0DjD,gBAAAO,YA1DiD,EA2DjD,mBAAAkE,eA3DiD,EA4DjD,0BAAAhG,qBA5DiD,EA6DjD,yBAAAC,oBA7DiD,EA8DjD,yBAAA3L,oBA9DiD,EA+DjD,QAAAhR,mBA/DiD,EAgEjD,QAAAD,WAhEiD,EAiEjD,mBAAAkjB,eAjEiD,EAkEjD,kBAAAnG,cAlEiD,EAmEjD,kBAAAgB,cAnEiD,EAoEjD,4BAAArE,uBApEiD,EAqEjD,yBAAAmJ,oBArEiD,EAsEjD,6BAAAnF,uBAtEiD,EAuEjD,gCAAAZ,2BAvEiD,EAwEjD,mBAAAuF,eAxEiD,EAyEjD,4BAAArF,uBAzEiD,EA0EjD,oCAAA0C,qBA1EiD,EA2EjD,iCAAAE,kBA3EiD,EA4EjD,oCAAAV,oBA5EiD,EA6EjD,4BAAAnkB,uBA7EiD,EA8EjD,mCAAAkjB,6BA9EiD,EA+EjD,iCAAArE,2BA/EiD,EAgFjD,uBAAA9C,kBAhFiD,EAgF7B,iCAAAI,2BAhF6B,EAiFjD,+BAAAL,yBAjFiD,EAkFjD,oBAAAuM,gBAlFiD,EAmFjD,oBAAAQ,gBAnFiD;AAsFpC,O;AAHG,K;;;;;2BAGX1jB,Q,EAAQ;cA3FpB,OAAA/qD,QA2FoB;eA3FX;AACNC,iBAAO,GAAG,SAAAF,YAAH,4BACA,QAAAi0D,gBADA,IAEH,QAAAlJ,mBAFG,EAGH,QAAAD,WAHG,EAIH,wBAAA6lB,wBAJG,EAIuB,sBAAAC,uBAJvB,EADD;AAMN9uE,sBAAY,EAAE,CACV,2CAAA46D,mCADU,EAEV,wCAAA4D,iCAFU,EAGV,4BAAA/F,sBAHU,EAIV,4BAAA2N,sBAJU,EAKV,oCAAAnD,6BALU,EAMV,gCAAAO,yBANU,EAOV,uBAAAnU,kBAPU,EAQV,+BAAAyV,wBARU,EASV,2BAAA9V,sBATU,EAUV,mCAAAoV,4BAVU,EAWV,mBAAA/F,eAXU,EAYV,yBAAA4J,oBAZU,EAaV,cAAAf,UAbU,EAcV,gBAAAO,YAdU,EAeV,mBAAAkE,eAfU,EAgBV,0BAAAhG,qBAhBU,EAiBV,yBAAAC,oBAjBU,EAkBV,0BAAAsF,qBAlBU,EAmBV,uBAAArF,kBAnBU,EAoBV,gCAAA4F,0BApBU,EAqBV,yBAAAxR,oBArBU,EAsBV,0BAAAyL,qBAtBU,EAuBV,mBAAAwG,eAvBU,EAwBV,kBAAAnG,cAxBU,EAyBV,kBAAAgB,cAzBU,EA0BV,4BAAArE,uBA1BU,EA2BV,yBAAAmJ,oBA3BU,EA4BV,6BAAAnF,uBA5BU,EA6BV,gCAAAZ,2BA7BU,EA8BV,mBAAAuF,eA9BU,EA+BV,4BAAArF,uBA/BU,EAgCV,oCAAA0C,qBAhCU,EAiCV,iCAAAE,kBAjCU,EAkCV,oCAAAV,oBAlCU,EAmCV,4BAAAnkB,uBAnCU,EAoCV,mCAAAkjB,6BApCU,EAqCV,iCAAArE,2BArCU,EAsCV,uBAAA9C,kBAtCU,EAuCV,iCAAAI,2BAvCU,EAwCV,+BAAAL,yBAxCU,EAyCV,oBAAAuM,gBAzCU,EA0CV,oBAAAQ,gBA1CU,CANR;AAkDN3sE,iBAAO,EAAE,CACL,2CAAA26D,mCADK,EAEL,wCAAA4D,iCAFK,EAGL,4BAAA/F,sBAHK,EAIL,4BAAA2N,sBAJK,EAKL,oCAAAnD,6BALK,EAML,gCAAAO,yBANK,EAOL,uBAAAnU,kBAPK,EAQL,+BAAAyV,wBARK,EASL,2BAAA9V,sBATK,EAUL,mCAAAoV,4BAVK,EAWL,yBAAA6D,oBAXK,EAYL,cAAAf,UAZK,EAaL,gBAAAO,YAbK,EAcL,mBAAAkE,eAdK,EAeL,0BAAAhG,qBAfK,EAgBL,yBAAAC,oBAhBK,EAiBL,yBAAA3L,oBAjBK,EAkBL,QAAAhR,mBAlBK,EAmBL,QAAAD,WAnBK,EAoBL,mBAAAkjB,eApBK,EAqBL,kBAAAnG,cArBK,EAsBL,kBAAAgB,cAtBK,EAuBL,4BAAArE,uBAvBK,EAwBL,yBAAAmJ,oBAxBK,EAyBL,6BAAAnF,uBAzBK,EA0BL,gCAAAZ,2BA1BK,EA2BL,mBAAAuF,eA3BK,EA4BL,4BAAArF,uBA5BK,EA6BL,oCAAA0C,qBA7BK,EA8BL,iCAAAE,kBA9BK,EA+BL,oCAAAV,oBA/BK,EAgCL,4BAAAnkB,uBAhCK,EAiCL,mCAAAkjB,6BAjCK,EAkCL,iCAAArE,2BAlCK,EAmCL,uBAAA9C,kBAnCK,EAmCe,iCAAAI,2BAnCf,EAoCL,+BAAAL,yBApCK,EAqCL,oBAAAuM,gBArCK,EAsCL,oBAAAQ,gBAtCK;AAlDH,S;AA2FW,Q;;;;;;;;;;;;;;;;;ACzLrB;;;;;;;;;;AAMA;AAAA;AAAA;;AAUA;AAAA;AAAA;;AACA;AAAA;AAAA,2D,CAEA;;;AACa,YAAAmC,qBAAA,GAAwB,KAAK,EAA7B;AAEA,YAAAzK,gBAAA,GAAmB,EAAnB,C,CAEb;;AACa,YAAA7U,sBAAA,GAAyB,UAClCI,SADkC,EAElCmf,QAFkC,EAKZ;AAAA,UAFtBvpE,IAEsB,uEAFP,EAEO;AAAA,UADtBoC,QACsB,uEADH,IAAI,UAAAsM,MAAJ,CAAW;AAAElR,YAAI,EAAEJ,IAAI,CAAConB,GAAL;AAAR,OAAX,EAAiCy1B,QAC9B;AACtB;AACA;AACA,UAAMz1B,GAAG,GAAG,IAAI,UAAA9V,MAAJ,CAAW;AAAElR,YAAI,EAAEJ,IAAI,CAAConB,GAAL,EAAR;AAAoBK,mBAAW,EAAE,KAAjC;AAAwCC,mBAAW,EAAE1iB;AAArD,OAAX,CAAZ,CAHsB,CAItB;;AACA,UAAI5E,IAAI,GAAG,IAAI,UAAAkR,MAAJ,CAAW;AAAElR,YAAI,EAAE4sD,SAAR;AAAmBvlC,mBAAW,EAAE,KAAhC;AAAuCC,mBAAW,EAAE1iB;AAApD,OAAX,CAAX,CALsB,CAMtB;;AACA,UAAMunD,MAAM,GAAwB,EAApC;;AACA,UAAI4f,QAAQ,IAAI/rE,IAAI,CAACu4B,WAAL,CAAiBvR,GAAjB,EAAsB,KAAtB,CAAhB,EAA8C;AAC1C;AACAhnB,YAAI,GAAGA,IAAI,CAAC0J,YAAL,CAAkB,KAAlB,CAAP;AACH,OAHD,MAGO;AACH;AACA1J,YAAI,GAAGgnB,GAAP;AACH,OAdqB,CAetB;;;AACA,UAAMglD,SAAS,GAAG,QAAArpE,QAAA,CAASC,UAAT,CAAoB5C,IAAI,CAAC2J,EAAzB,CAAlB;AACA,UAAM7G,WAAW,GAAG,OAAA/C,iBAAA,CAAkBisE,SAAlB,EAA6BxpE,IAA7B,CAApB,CAjBsB,CAkBtB;;AACAxC,UAAI,GAAG,IAAI,UAAAkR,MAAJ,CAAW;AAAElR,YAAI,EAAE8C,WAAW,CAACD,OAAZ,EAAR;AAA+BwkB,mBAAW,EAAE,KAA5C;AAAmDC,mBAAW,EAAE1iB;AAAhE,OAAX,CAAP;AACA,UAAMsoB,GAAG,GAAGltB,IAAI,CAACiwB,UAAL,CAAgB,KAAhB,CAAZ,CApBsB,CAqBtB;;AACA,aAAOjwB,IAAI,CAACs4B,YAAL,CAAkBpL,GAAlB,CAAP,EAA+B;AAC3Bi/B,cAAM,CAACtkD,IAAP,CAAY;AACRoE,iBAAO,EAAE,OAAAvB,6BAAA,CAA8B1K,IAA9B,CADD;AAER0hB,sBAAY,EAAE1hB,IAAI,CAACsB,UAAL,CAAgB,QAAhB,CAFN;AAGR4B,eAAK,EAAElD,IAAI,CAACsB,UAAL,CAAgB,OAAhB;AAHC,SAAZ;AAKAtB,YAAI,GAAGA,IAAI,CAACa,QAAL,CAAc;AAAEJ,iBAAO,EAAE+B;AAAX,SAAd,CAAP;AACH;;AACD,aAAO2pD,MAAP;AACH,KApCY;;AAuCA,YAAA+V,wBAAA,GAA2B,UACpC9f,UADoC,EAEpC2pB,QAFoC,EAQX;AAAA,UALzBvpE,IAKyB,uEALV,EAKU;AAAA,UAJzBoC,QAIyB,uEAJN,IAAI,UAAAsM,MAAJ,CAAW;AAAElR,YAAI,EAAEJ,IAAI,CAAConB,GAAL;AAAR,OAAX,EAAiCy1B,QAI3B;AAAA,UAHzB/mB,OAGyB,uEAHN,KAGM;AAAA,UAFzBgR,MAEyB,uEAFQ,EAER;AAAA,UADzBs7B,eACyB,uEADE,KACF;AACzB;AACA,UAAMh7C,GAAG,GAAG,IAAI,UAAA9V,MAAJ,CAAW;AAAElR,YAAI,EAAEJ,IAAI,CAAConB,GAAL,EAAR;AAAoBK,mBAAW,EAAE,KAAjC;AAAwCC,mBAAW,EAAE1iB;AAArD,OAAX,CAAZ,CAFyB,CAGzB;;AACA,UAAIjE,MAAM,GAAGyhD,UAAU,CAAChmB,KAAX,EAAb,CAJyB,CAKzB;;AACA,UAAM+vB,MAAM,GAA2B,EAAvC;;AACA,UAAI4f,QAAQ,IAAIprE,MAAM,CAAC43B,WAAP,CAAmBvR,GAAnB,EAAwB,KAAxB,CAAhB,EAAgD;AAC5C;AACArmB,cAAM,GAAGA,MAAM,CAAC+I,YAAP,CAAoB,KAApB,CAAT;AACH,OAHD,MAGO;AACH;AACA/I,cAAM,GAAGqhE,eAAe,GAAGrhE,MAAH,GAAYqmB,GAApC;AACH,OAbwB,CAczB;;;AACArmB,YAAM,GAAG,OAAAD,mBAAA,CAAoBC,MAApB,EAA4B6B,IAA5B,CAAT,CAfyB,CAgBzB;;AACA,UAAM0qB,GAAG,GAAGvsB,MAAM,CAACsvB,UAAP,CAAkB,KAAlB,CAAZ,CAjByB,CAkBzB;;AACA,UAAIyF,OAAO,IAAI/0B,MAAM,CAAC48B,UAAP,CAAkBvW,GAAlB,EAAuB,KAAvB,CAAf,EAA8C;AAC1C,YAAMqG,UAAU,GAAG1sB,MAAM,CAAC+I,YAAP,CAAoB,KAApB,CAAnB;AACAyiD,cAAM,CAACtkD,IAAP,CAAY;AACRoE,iBAAO,EAAE,OAAAvB,6BAAA,CAA8B2iB,UAA9B,CADD;AAER3L,sBAAY,EAAE2L,UAAU,CAAC/rB,UAAX,CAAsB,QAAtB,CAFN;AAGR4B,eAAK,EAAEmqB;AAHC,SAAZ;AAKH,OA1BwB,CA2BzB;;;AACA,aAAO1sB,MAAM,CAAC23B,YAAP,CAAoBpL,GAApB,CAAP,EAAiC;AAC7Bi/B,cAAM,CAACtkD,IAAP,CAAY;AACRoE,iBAAO,EAAE,OAAAvB,6BAAA,CAA8B/J,MAA9B,CADD;AAER+gB,sBAAY,EAAE/gB,MAAM,CAACW,UAAP,CAAkB,QAAlB,CAFN;AAGR4B,eAAK,EAAEvC;AAHC,SAAZ;AAMAA,cAAM,GAAGA,MAAM,CAACE,QAAP,CAAgB;AAAEJ,iBAAO,EAAE+B;AAAX,SAAhB,CAAT;AACH;;AAED,aAAO,OAAAkE,MAAA,CAAOggC,MAAM,CAAC5U,MAAP,CAAcq6B,MAAd,CAAP,EAA8B,cAA9B,CAAP;AACH,KA/CY;AAiDb;;;;;;;;;AAOa,YAAAD,uBAAA,GAA0B,UACnClsD,IADmC,EAEnCyD,GAFmC,EAGnCk6B,GAHmC,EAInCn7B,IAJmC,EAKnCm/D,QALmC,EAKQ;AAC3C,UAAMxV,MAAM,GAAwB,EAApC;AACA,UAAIjpD,KAAK,GAAGy6B,GAAZ;;AACA,aAAOz6B,KAAK,IAAIO,GAAhB,EAAqB;AACjB,YAAI1C,QAAgB,SAApB;;AACA,YAAI4gE,QAAJ,EAAc;AACV,cAAMxgE,CAAC,GAAG,OAAAL,iBAAA,CAAkBoC,KAAK,GAAGy6B,GAA1B,EAA+B,IAA/B,CAAV;AACA58B,kBAAQ,GAAGI,CAAC,cAAOA,CAAP,IAAa,SAAzB;AACH,SAHD,MAGO;AACHJ,kBAAQ,GAAG,OAAAD,iBAAA,CAAkBoC,KAAlB,EAAyB,IAAzB,CAAX;AACH;;AAEDipD,cAAM,CAACtkD,IAAP,CAAY;AACR3E,eAAK,EAALA,KADQ;AAER+I,iBAAO,YAAKjM,IAAI,CAACa,QAAL,CAAc;AAAEJ,mBAAO,EAAEyC;AAAX,WAAd,EAAkC5B,UAAlC,CAA6C,OAAAwI,gBAAA,EAA7C,EAAiEW,iBAAjE,EAAL,eAA8F1J,QAA9F;AAFC,SAAZ;AAIAmC,aAAK,IAAIV,IAAT;AACH;;AACD,aAAO2pD,MAAP;AACH,KAxBY;;AA0BA,YAAA8f,YAAA,GAAmC;AAC5C/oE,WAAK,EAAE,QAAA4oE,qBADqC;AAE5C7/D,aAAO,EAAE;AAFmC,KAAnC;AAKA,YAAAigE,aAAA,GAAoC;AAC7ChpE,WAAK,EAAE,KAAK,EAAL,GAAU,CAD4B;AAE7C+I,aAAO,EAAE;AAFoC,KAApC;AAKA,YAAAm1D,qBAAA,GAAyC,CAClD;AACIlhE,WAAK,EAAE,EADX;AAEIsC,UAAI,EAAE,EAFV;AAGIiB,SAAG,EAAE,KAAK;AAHd,KADkD,CAMlD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdkD,KAAzC;AAiBb;;;;AAGa,YAAAi+D,iCAAA,GAAoC,UAAC1hE,IAAD,EAAeiD,cAAf,EAAgD0+D,QAAhD;AAAA,gCACzC1+D,cAAc,CAAC4C,GAAf,CAAmB,UAAA9E,QAAQ;AAAA,eAAI,QAAAmrD,uBAAA,CAAwBlsD,IAAxB,EAA8Be,QAAQ,CAAC0C,GAAvC,EAA4C1C,QAAQ,CAACb,KAArD,EAA4Da,QAAQ,CAACyB,IAArE,EAA2Em/D,QAA3E,CAAJ;AAAA,OAA3B,EAAqHh+D,MAArH,CAA6H,UAACC,aAAD,EAAgBC,YAAhB,EAAiC;AAC9JD,qBAAa,CAACiE,IAAd,OAAAjE,aAAa,qBAASC,YAAT,EAAb;AACA,eAAOD,aAAP;AACH,OAHG,EAGA,EAHA,CADyC;AAAA,KAApC;;;;;;;;;;;;;;;;;;;;;;;;;AChLb;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;ACHA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AAEa,YAAAuoE,QAAA,GAAW,kBAAA/7D,mBAAA,CAAqC,aAArC,EAAoD,SAApD,CAAX;;AAEA,YAAAg8D,eAAA,GAAkB;AAAA,UAAGxzD,IAAH,UAAGA,IAAH;AAAA,aAA8BA,IAA9B;AAAA,KAAlB;;AAEA,YAAAyzD,iBAAA,GAAoB,QAAAr3D,cAAA,CAAe,QAAAA,cAAA,CAAe,QAAAo3D,eAAf,EAAgC,QAAAD,QAAA,CAASl3D,SAAT,CAAmBkT,KAAnD,CAAf,EAA0E,UAACptB,KAAD;AAAA,aAAW,CAAC,CAACA,KAAK,CAACma,eAAnB;AAAA,KAA1E,CAApB;AAEA,YAAAyD,iBAAA,GAAoB,QAAA3D,cAAA,CAAe,QAAAo3D,eAAf,EAAgC,QAAAD,QAAA,CAASl3D,SAAT,CAAmBC,eAAnD,CAApB;;;;;;;;;;;;;;;;;;;;;;;;AChBb;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;QAIao3D,W,GAET,qBAAoB37D,OAApB,EACoB47D,WADpB,EAC+C;AAAA;;AAAA;;AAD3B,WAAA57D,OAAA,GAAAA,OAAA;AACA,WAAA47D,WAAA,GAAAA,WAAA;AAIpB,WAAAJ,QAAA,GAAW,UAAA75D,mBAAA,CAAoB,KAAK3B,OAAzB,EAAkC,eAAAw7D,QAAlC,EAA4C;AAAA,eAAM,QAAI,CAACI,WAAL,CAAiBx6B,eAAjB,EAAN;AAAA,OAA5C,CAAX;AAHC,K;;;uBAJQu6B,W,EAAW,uB,EAAA,4B;AAAA,K;;;aAAXA,W;AAAW,eAAXA,WAAW;;;AAOpB,wBADC,UAAA15D,MAAA,EACD,E,yCAAA,G,qBAAA,E,UAAA,E,MAAA;;AARJ;;;;2BACa05D,W,EAAW;cADvB,OAAAz5D;AACuB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXxB;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;QASa25D,U;;;;AAPb;;YAOaA;;;;yBAAAA,U;AAAU,O;AAAA,gBANV,CACL,SAAAvxE,YADK,EAEL,QAAAgY,WAAA,CAAYD,UAAZ,CAAuB,MAAvB,EAA+B,eAAAy5D,WAA/B,CAFK,EAGL,UAAA15D,aAAA,CAAcC,UAAd,CAAyB,CAAC,eAAAs5D,WAAD,CAAzB,CAHK,CAMU;;;;+EAAVE,U,EAAU;AAAA,kBALf,SAAAvxE,YAKe,EALH,qBAKG,EALH,uBAKG;AAAA,O;AALH,K;;;;;2BAKPuxE,U,EAAU;cAPtB,OAAAtxE,QAOsB;eAPb;AACNC,iBAAO,EAAE,CACL,SAAAF,YADK,EAEL,QAAAgY,WAAA,CAAYD,UAAZ,CAAuB,MAAvB,EAA+B,eAAAy5D,WAA/B,CAFK,EAGL,UAAA15D,aAAA,CAAcC,UAAd,CAAyB,CAAC,eAAAs5D,WAAD,CAAzB,CAHK;AADH,S;AAOa,Q;;;;;;;;;;;;;;;;;;;;;;ACdvB;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAGa,YAAAI,gBAAA,GAA8B;AACvChyC,aAAO,EAAE,UAAArnB,YAAA,CAAaC,KAAb;AAD8B,KAA9B;AAIA,YAAAm5D,WAAA,GAAc,QAAA74D,aAAA,iBAAc,QAAA84D,gBAAd,4BACpB,eAAAP,QAAA,CAASr4D,GADW,GAAd;;;;;;;;;;;;;;ACVb,aAAS64D,wBAAT,CAAkCC,GAAlC,EAAuC;AACtC;AACA;AACA,aAAOvwD,OAAO,CAACC,OAAR,GAAkBI,IAAlB,CAAuB,YAAW;AACxC,YAAIrS,CAAC,GAAG,IAAIjO,KAAJ,CAAU,yBAAyBwwE,GAAzB,GAA+B,GAAzC,CAAR;AACAviE,SAAC,CAAC0f,IAAF,GAAS,kBAAT;AACA,cAAM1f,CAAN;AACA,OAJM,CAAP;AAKA;;AACDsiE,4BAAwB,CAAC/mE,IAAzB,GAAgC,YAAW;AAAE,aAAO,EAAP;AAAY,KAAzD;;AACA+mE,4BAAwB,CAACrwD,OAAzB,GAAmCqwD,wBAAnC;AACAE,UAAM,CAAC7vE,OAAP,GAAiB2vE,wBAAjB;AACAA,4BAAwB,CAAC16D,EAAzB,GAA8B,yCAA9B;;;;;;;;;;;;;;;;;;;;ACZA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;AAEA,QAAM66D,MAAM,GAAW,CACnB;AACIhhD,UAAI,EAAE,EADV;AAEIihD,eAAS,EAAE,kBAAAC,qBAFf;AAGIC,cAAQ,EAAE,CACN;AACInhD,YAAI,EAAE,MADV;AAEIohD,oBAAY,EAAE;AAAA,iBAAM;AAAA;AAAO;AAAA,iDAAP;AAAA,aAAmCxwD,IAAnC,CAAwC,UAACtb,CAAD;AAAA,mBAAOA,CAAC,CAAC+rE,aAAT;AAAA,WAAxC,CAAN;AAAA;AAFlB,OADM,EAKN;AAAErhD,YAAI,EAAE,IAAR;AAAcshD,kBAAU,EAAE;AAA1B,OALM;AAHd,KADmB,EAYnB;AAAEthD,UAAI,EAAE,IAAR;AAAcshD,gBAAU,EAAE;AAA1B,KAZmB,CAAvB;;QAmBaC,gB;;;;AAJb;;YAIaA;;;;yBAAAA,gB;AAAgB,O;AAAA,gBAHhB,CAAC,SAAAC,YAAA,CAAaC,OAAb,CAAqBT,MAArB,EAA6B;AAAEU,eAAO,EAAE;AAAX,OAA7B,CAAD,CAGgB,EAFf,SAAAF,YAEe;;;;+EAAhBD,gB,EAAgB;AAAA;AAAA,kBAFf,SAAAC,YAEe;AAAA,O;AAFH,K;;;;;2BAEbD,gB,EAAgB;cAJ5B,OAAAnyE,QAI4B;eAJnB;AACNC,iBAAO,EAAE,CAAC,SAAAmyE,YAAA,CAAaC,OAAb,CAAqBT,MAArB,EAA6B;AAAEU,mBAAO,EAAE;AAAX,WAA7B,CAAD,CADH;AAENxwE,iBAAO,EAAE,CAAC,SAAAswE,YAAD;AAFH,S;AAImB,Q;;;;;;;;;;;;;;;;;;;;;;ACvB7B;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAMA;AAAA;AAAA;;;;;;;;;;;;;;QAYaG,Y;;;;;AACT,4BACYC,IADZ,EAEY3+C,IAFZ,EAGYC,OAHZ,EAIYK,SAJZ,EAKY6vB,OALZ,EAMYyuB,MANZ,EAMkC;AAAA;;AAAA;;AAE9B;AAPQ,iBAAAD,IAAA,GAAAA,IAAA;AACA,iBAAA3+C,IAAA,GAAAA,IAAA;AACA,iBAAAC,OAAA,GAAAA,OAAA;AACA,iBAAAK,SAAA,GAAAA,SAAA;AACA,iBAAA6vB,OAAA,GAAAA,OAAA;AACA,iBAAAyuB,MAAA,GAAAA,MAAA,CAAsB,CAI9B;;AACA,YAAI,CAAC,cAAA7uB,WAAA,CAAYC,UAAjB,EAA6B;AACzB9kC,sBAAY,CAACiwB,OAAb,CAAqB,SAArB,EAAgC,MAAhC;AACH;;AAGD,YAAI,OAAAh9B,QAAA,MAAc,OAAAA,QAAA,KAAa,EAA/B,EAAmC;AAC/BmM,kBAAQ,CAACW,IAAT,aAAmBX,QAAQ,CAACO,MAA5B,SAAqCP,QAAQ,CAAC6S,QAA9C;AACA;AACH;;AAb6B;AAcjC;;;;mCAEc;AACX,eAAKgzB,OAAL,CAAanjC,MAAb,CAAoB9d,SAApB,CAA8B,UAAC2vE,GAAD,EAA0B;AACpD,gBAAMzmD,WAAW,GAAG5e,IAAI,CAACC,KAAL,CAAWyR,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAX,CAApB;;AACA,gBAAI0zD,GAAG,IAAIA,GAAG,CAACC,iBAAX,IAAgCD,GAAG,CAACl0D,GAAxC,EAA6C;AACzC;AACA,kBAAMo0D,SAAS,GAAGz0D,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEs1B,IAAV,CAAe3sC,KAAf,CAAqB,GAArB,EAA0B,CAA1B,CAAlB;AACA,kBAAM+rE,gBAAgB,GAAGD,SAAS,CAAC1qE,OAAV,CAAkB,iBAAlB,MAAyC,CAAlE;AACA,kBAAM4qE,iBAAiB,GAAGF,SAAS,CAAC1qE,OAAV,CAAkB,kBAAlB,MAA0C,CAApE;;AACA,kBAAI,CAAC2qE,gBAAD,IAAqB,CAACC,iBAAtB,IAA2CF,SAA3C,IAAwD,CAAC,QAAD,EAAW,eAAX,EAA4B,eAA5B,EAA6C,aAA7C,EAA4D1qE,OAA5D,CAAoE0qE,SAApE,MAAmF,CAAC,CAA5I,IAAiJ3mD,WAAjJ,IAAgK,EAACA,WAAW,SAAX,IAAAA,WAAW,WAAX,GAAW,MAAX,GAAAA,WAAW,CAAEhT,UAAd,CAApK,EAA8L;AAC1LkF,wBAAQ,CAACW,IAAT,aAAmBX,QAAQ,CAACO,MAA5B;AACA;AACH;AACJ;AAEJ,WAbD;AAcH;;;;MAtC6B,OAAAnd,a;;AAVlC;;;uBAUagxE,Y,EAAY,2C,EAAA,4C,EAAA,sC,EAAA,wC,EAAA,+B,EAAA,uC;AAAA,K;;;YAAZA,Y;AAAY,+B;AAAA,+C;AAAA,c;AAAA,a;AAAA,0B;AAAA;AAAA;ACzBzB;AACI;AACJ;;;;;;;;;;2BDuBaA,Y,EAAY;cAVxB,OAAA5rB,SAUwB;eAVd;AACPjlD,kBAAQ,EAAE,UADH;AAEPklD,qBAAW,EAAE,sBAFN;AAGPC,mBAAS,EAAE,CACP,6BADO,EAEP,qCAFO,EAGP,qCAHO,CAHJ;AAQPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AAR1B,S;AAUc,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QEzBzB;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;AAEA;;;;;AAGA,aAAgB8oD,uBAAhB,CAAwCC,OAAxC,EAAmE;AAC/D;AACA,UAAItoE,IAAI,GAAG,CACP,WADO,EAEP,aAFO,EAGP,OAHO,CAAX;;AAMA,UAAI,CAAC,cAAAk5C,WAAA,CAAYC,UAAjB,EAA6B;AACzBn5C,YAAI,GAAG,CACH,UADG,EAEH,WAFG,EAGH,cAHG,EAIH,aAJG,EAKH,OALG,EAMH,MANG,CAAP;AAQH;;AAED,aAAO,0BAAAuoE,gBAAA,CAAiB;AACpBvoE,YAAI,EAAJA,IADoB;AAEpBwoE,iBAAS,EAAE;AAFS,OAAjB,EAGJF,OAHI,CAAP;AAIH;;AAvBD;AAyBA,QAAMG,YAAY,GAAiC,CAACJ,uBAAD,CAAnD;;QAuCaK,S;;;;AApCb;;YAoCaA,S;AAAS,kBAFN,gBAAAb,YAEM;;;;yBAATa,S;AAAS,O;AAAA,iBAPP,CACP;AAAE/6B,eAAO,EAAE,OAAAg7B,wBAAX;AAAqCtgC,gBAAQ,EAAE;AAAE,mBAAO;AAAT;AAA/C,OADO,EAEP,cAAAqF,yBAAA,CAA0B,WAAAk7B,gBAA1B,CAFO,EAGP;AAAEj7B,eAAO,EAAE,cAAAqL,iBAAX;AAA8B3Q,gBAAQ,EAAE,cAAA6Q;AAAxC,OAHO,C;AAIV,gBA5BQ,CACL,mBAAA2vB,aADK,EAEL,aAAAC,uBAFK,EAGL,qBAAArB,gBAHK,EAIL,OAAAsB,gBAJK,EAKL,QAAA5oB,WALK,EAML,WAAA6oB,cANK,EAOL,gBAAAC,mBAPK,EAQL,kBAAAhpB,oBARK,EASL,QAAA5yC,WAAA,CAAYs6D,OAAZ,CAAoB,EAApB,EAAwB;AAAEc,oBAAY,EAAZA;AAAF,OAAxB,CATK,EAUL,iBAAAS,mBAAA,CAAoBC,UAApB,CAA+B;AAC3BC,cAAM,EAAE,GADmB;AAE3BC,eAAO,EAAE,cAAAnwB,WAAA,CAAYC;AAFM,OAA/B,CAVK,EAcL,UAAAhsC,aAAA,CAAcw6D,OAAd,EAdK,EAeL,WAAAz6D,cAfK,EAgBL,iBAAAq6D,aAhBK,EAiBL,YAAA/2D,eAjBK,EAkBL,aAAA84D,SAlBK,EAmBL,eAAA7b,kBAnBK,EAoBL,QAAAoB,WApBK,EAqBL,KAAAxO,QArBK,EAsBL,OAAAumB,UAtBK,CA4BR;;;;+EAGQ8B,S,EAAS;AAAA,uBAlCd,gBAAAb,YAkCc,EAjCd,kBAAAT,qBAiCc;AAjCO,kBAGrB,mBAAAyB,aAHqB,EAIrB,aAAAC,uBAJqB,EAKrB,qBAAArB,gBALqB,EAMrB,OAAAsB,gBANqB,EAOrB,QAAA5oB,WAPqB,EAQrB,WAAA6oB,cARqB,EASrB,gBAAAC,mBATqB,EAUrB,kBAAAhpB,oBAVqB,EAUD,kBAVC,EAUD,sBAVC,EAUD,oBAVC,EAiBrB,WAAA/yC,cAjBqB,EAkBrB,iBAAAq6D,aAlBqB,EAmBrB,YAAA/2D,eAnBqB,EAoBrB,aAAA84D,SApBqB,EAqBrB,eAAA7b,kBArBqB,EAsBrB,QAAAoB,WAtBqB,EAuBrB,KAAAxO,QAvBqB,EAwBrB,OAAAumB,UAxBqB;AAiCP,O;AATJ,K;;;;;2BASL8B,S,EAAS;cApCrB,OAAApzE,QAoCqB;eApCZ;AACN6B,sBAAY,EAAE,CACV,gBAAA0wE,YADU,EAEV,kBAAAT,qBAFU,CADR;AAKN7xE,iBAAO,EAAE,CACL,mBAAAszE,aADK,EAEL,aAAAC,uBAFK,EAGL,qBAAArB,gBAHK,EAIL,OAAAsB,gBAJK,EAKL,QAAA5oB,WALK,EAML,WAAA6oB,cANK,EAOL,gBAAAC,mBAPK,EAQL,kBAAAhpB,oBARK,EASL,QAAA5yC,WAAA,CAAYs6D,OAAZ,CAAoB,EAApB,EAAwB;AAAEc,wBAAY,EAAZA;AAAF,WAAxB,CATK,EAUL,iBAAAS,mBAAA,CAAoBC,UAApB,CAA+B;AAC3BC,kBAAM,EAAE,GADmB;AAE3BC,mBAAO,EAAE,cAAAnwB,WAAA,CAAYC;AAFM,WAA/B,CAVK,EAcL,UAAAhsC,aAAA,CAAcw6D,OAAd,EAdK,EAeL,WAAAz6D,cAfK,EAgBL,iBAAAq6D,aAhBK,EAiBL,YAAA/2D,eAjBK,EAkBL,aAAA84D,SAlBK,EAmBL,eAAA7b,kBAnBK,EAoBL,QAAAoB,WApBK,EAqBL,KAAAxO,QArBK,EAsBL,OAAAumB,UAtBK,CALH;AA6BN7tB,mBAAS,EAAE,CACP;AAAEpL,mBAAO,EAAE,OAAAg7B,wBAAX;AAAqCtgC,oBAAQ,EAAE;AAAE,uBAAO;AAAT;AAA/C,WADO,EAEP,cAAAqF,yBAAA,CAA0B,WAAAk7B,gBAA1B,CAFO,EAGP;AAAEj7B,mBAAO,EAAE,cAAAqL,iBAAX;AAA8B3Q,oBAAQ,EAAE,cAAA6Q;AAAxC,WAHO,CA7BL;AAkCNqwB,mBAAS,EAAE,CAAC,gBAAA1B,YAAD;AAlCL,S;AAoCY,Q;;;;;;;;;;;;;;;;;;;;;;ACxGtB;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACMgB;AAA0B;AAAK;;;;;;;;;;;;;;;;;;;;;;QDClC2B,2B;;;;;AAkDT,2CAAoB//C,SAApB,EAA4DN,IAA5D,EAAuF;AAAA;;AAAA;;AACnF;AADgB,iBAAAM,SAAA,GAAAA,SAAA;AAAwC,iBAAAN,IAAA,GAAAA,IAAA;AAjD5D;;AACgB,iBAAApuB,MAAA,GAAiB,UAAA8I,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAjB;AAKhB;;AACgB,iBAAAyvE,aAAA,GAAgB,KAAhB;AAChB;;AACgB,iBAAAC,WAAA,GAAuB,KAAvB;AAChB;;AACgB,iBAAAC,kBAAA,GAA8B,KAA9B;AAChB;;AACiB,iBAAAC,YAAA,GAAe,IAAI,OAAAlwB,YAAJ,EAAf;AACjB;;AACiB,iBAAA5xC,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AAIV,iBAAA8C,UAAA,GAAa,UAAA34C,OAAA,GAAUgI,aAAV,CAAwB;AAAE6nB,gBAAM,EAAE;AAAV,SAAxB,CAAb;AA8BgF;AAEtF;;;;mCAEc;AAAA;;AACX;AACD,cAAIt5B,IAAJ;;AACC,cAAG,CAAC,KAAKuvE,kBAAT,EAA6B;AACxBvvE,gBAAI,GAAG,CAACia,YAAY,CAACC,OAAb,CAAqB,gBAArB,CAAD,IAA2C,KAAK8M,GAAL,CAASrd,EAA3D;AACJ,WAFD,MAEO;AACF3J,gBAAI,GAAG,KAAKgnB,GAAL,CAASrd,EAAhB;AACJ;AAGD;;;AACA,cAAI3J,IAAI,KAAKA,IAAI,KAAK,KAAKW,MAAL,CAAYgJ,EAArB,IAA2B,KAAK8lE,cAAL,KAAwB,KAAK9uE,MAAL,CAAY2mB,WAApE,CAAR,EAA0F;AACtF;AACA,iBAAK3oB,OAAL,CACI,MADJ,EAEI,YAAM;AACF,sBAAI,CAACgC,MAAL,GAAc,IAAI,UAAAuQ,MAAJ,CAAW;AACrBlR,oBAAI,EAAJA,IADqB;AAErBqnB,2BAAW,EAAE,KAFQ;AAGrBC,2BAAW,EAAE,QAAI,CAACmoD;AAHG,eAAX,CAAd;;AAKA,sBAAI,CAACD,YAAL,CAAkB9uB,IAAlB,CAAuB,QAAI,CAAC//C,MAA5B;;AACA,sBAAI,CAACi2D,UAAL;AACH,aAVL,EAWI,EAXJ;AAaH;;AACD,eAAK74D,YAAL,CACI,QADJ,EAEI,KAAKsxB,SAAL,CAAeC,aAAf,CAA6BrxB,SAA7B,CAAuC,UAACC,IAAD,EAAU;AAC7C,oBAAI,CAACwxE,SAAL,GAAiB,EAAjB;AACA,oBAAI,CAACA,SAAL,GAAiBxxE,IAAI,CAAC,CAAD,CAArB;AACH,WAHD,CAFJ;AAOH;;;kCAEgBwP,K,EAAO,CACrB;AACC;AACA;AACH;AAED;;;;;;;mCAIkBxK,K,EAAe;AAC7B,cAAIlD,IAAI,GAAG,IAAI,UAAAkR,MAAJ,CAAW;AAClBlR,gBAAI,EAAE,UAAAw+C,WAAA,CAAY,KAAK79C,MAAjB,EAAyBgJ,EADb;AAElB0d,uBAAW,EAAE,KAFK;AAGlBC,uBAAW,EAAE,KAAKmoD;AAHA,WAAX,CAAX;AAKAzvE,cAAI,GAAGA,IAAI,CAACa,QAAL,CAAc;AAAEwwB,gBAAI,EAAEnuB;AAAR,WAAd,CAAP;AACA,eAAKvC,MAAL,GAAcX,IAAd;AACA,eAAKwvE,YAAL,CAAkB9uB,IAAlB,CAAuB,KAAK//C,MAA5B;AACAsZ,sBAAY,CAACiwB,OAAb,CAAqB,gBAArB,YAA0C,KAAKvpC,MAAL,CAAYgJ,EAAtD;AACAsQ,sBAAY,CAACiwB,OAAb,CAAqB,oBAArB,YAA8C,KAAKulC,cAAnD;AACA,eAAK7Y,UAAL;AACH;AAED;;;;;;;6CAI4B+Y,W,EAAqB;AAC7C,eAAKhvE,MAAL,GAAc,IAAI,UAAAuQ,MAAJ,CAAW;AACrBlR,gBAAI,EAAE,UAAAw+C,WAAA,CAAYmxB,WAAZ,EAAyBhmE,EADV;AAErB0d,uBAAW,EAAE,KAFQ;AAGrBC,uBAAW,EAAE,KAAKmoD;AAHG,WAAX,CAAd;AAKA,eAAKD,YAAL,CAAkB9uB,IAAlB,CAAuB,KAAK//C,MAA5B;AACAsZ,sBAAY,CAACiwB,OAAb,CAAqB,gBAArB,YAA0C,KAAKvpC,MAAL,CAAYgJ,EAAtD;AACAsQ,sBAAY,CAACiwB,OAAb,CAAqB,oBAArB,YAA8C,KAAKulC,cAAnD;AACA,eAAK7Y,UAAL;AACA,eAAK9K,eAAL;AACH;;;qCAEmB;AAAA;;AAChB,eAAKntD,OAAL,CAAa,aAAb,EAA4B;AAAA,mBAAM,QAAI,CAAC0wB,SAAL,CAAe6iB,OAAf,CAAuB,QAAI,CAACvxC,MAA5B,CAAN;AAAA,WAA5B;AACH;AAED;;;;oCACmB;AACf,eAAKA,MAAL,GAAc,IAAI,UAAAuQ,MAAJ,CAAW;AACrBlR,gBAAI,EAAE,UAAAw+C,WAAA,CAAY,KAAKx3B,GAAjB,EAAsBrd,EADP;AAErB0d,uBAAW,EAAE,KAFQ;AAGrBC,uBAAW,EAAE,KAAKmoD;AAHG,WAAX,CAAd;AAKA,eAAKD,YAAL,CAAkB9uB,IAAlB,CAAuB,KAAK//C,MAA5B;AACAsZ,sBAAY,CAACiwB,OAAb,CAAqB,gBAArB,YAA0C,KAAKvpC,MAAL,CAAYgJ,EAAtD;AACAsQ,sBAAY,CAACiwB,OAAb,CAAqB,oBAArB,YAA8C,KAAKulC,cAAnD;AACA,eAAK7Y,UAAL;AACH;;;0CAEwB;AACrB,eAAKA,UAAL;AACH;AAED;;;;kCACc;AACV,eAAKlpD,KAAL,CAAWgzC,IAAX,CAAgB,UAAhB;AACH;;;4BArIgB;AACb,iBAAO,UAAAj3C,OAAA,EAAP;AACH;AAED;;;;4BACa;AACT,iBAAO,UAAAuuB,uBAAA,CAAwB,KAAKy3C,cAA7B,CAAP;AACH;;;4BAE2B;AACxB,iBAAOx1D,YAAY,CAACC,OAAb,CAAqB,oBAArB,KAA8C,KAAKtV,QAAnD,IAA+D,KAAKoiB,GAAL,CAASM,WAA/E;AACH;;;4BAEqB;AAClB,iBAAO,IAAI,UAAApW,MAAJ,CAAW;AACdlR,gBAAI,EAAE,UAAAw+C,WAAA,CAAY,KAAK79C,MAAjB,EAAyBgJ,EADjB;AAEd0d,uBAAW,EAAE,KAFC;AAGdC,uBAAW,EAAE,KAAKmoD;AAHJ,WAAX,EAIJlyC,UAJI,CAKH,IAAI,UAAArsB,MAAJ,CAAW;AACPlR,gBAAI,EAAEJ,IAAI,CAAConB,GAAL,EADC;AAEPK,uBAAW,EAAE,KAFN;AAGPC,uBAAW,EAAE,KAAKmoD;AAHX,WAAX,CALG,EAUH,KAVG,CAAP;AAYH;;;;MAhD4C,OAAAhzE,a;;AALjD;;;uBAKa2yE,2B,EAA2B,4C,EAAA,4C;AAAA,K;;;YAA3BA,2B;AAA2B,2C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,e;AAAA,c;AAAA,wa;AAAA;AAAA;ACZxC;AAGI;AACI;AACI;AAAwC;AAAA,mBAAS,IAAAQ,UAAA,CAAW,IAAC,CAAZ,CAAT;AAAuB,WAAvB;AACpC;AAGJ;AACA;AAAkB;AAAA,mBAAY,IAAA/vE,SAAA,EAAZ;AAAuB,WAAvB;AACd;AACA;AAA6B;;AAAuC;AACxE;AACA;AAAoC;AAAA,mBAAS,IAAA+vE,UAAA,CAAW,CAAX,CAAT;AAAsB,WAAtB;AAChC;AAGJ;AACJ;AACA;AAAoB;AAAA,mBAAS,IAAAC,SAAA,QAAT;AAA0B,WAA1B;AAChB;AAII;AAAA;AAAA,aAAoB,UAApB,EAAoB;AAAA,mBAIR,IAAAC,oBAAA,QAJQ;AAIoB,WAJxC;AAMJ;AACJ;AACJ;AACJ;;;;AA3BoB;AAAA;AAIK;AAAA;AACN;AAAA;AAA0B;AAAA;AAIzB;AAAA;AAOJ;AAAA,2CAAkB,UAAlB,EAAkB,6DAAlB,EAAkB,SAAlB,EAAkB,UAAlB,EAAkB,YAAlB,EAAkB,cAAlB,EAAkB,gBAAlB,EAAkB,KAAlB,EAAkB,UAAlB,EAAkB,kBAAlB;;;;;;;;;;2BDXHV,2B,EAA2B;cALvC,OAAAvtB,SAKuC;eAL7B;AACPjlD,kBAAQ,EAAE,sBADH;AAEPklD,qBAAW,EAAE,uCAFN;AAGPC,mBAAS,EAAE,CAAC,uCAAD;AAHJ,S;AAK6B,Q;;;;;;;;gBAEnC,OAAAziD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;gBAEA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AE5BL;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;AAGA,QAAM8qB,MAAM,GAAW,CACnB;AAAEhhD,UAAI,EAAE,EAAR;AAAYihD,eAAS,EAAE,qCAAAgD;AAAvB,KADmB,EAEnB;AAAEjkD,UAAI,EAAE,QAAR;AAAkBihD,eAAS,EAAE,qCAAAgD;AAA7B,KAFmB,EAGnB;AAAEjkD,UAAI,EAAE,IAAR;AAAcshD,gBAAU,EAAE;AAA1B,KAHmB,CAAvB;;QAUa4C,4B;;;;AAJb;;YAIaA;;;;yBAAAA,4B;AAA4B,O;AAAA,gBAH5B,CAAC,SAAA1C,YAAA,CAAa2C,QAAb,CAAsBnD,MAAtB,CAAD,CAG4B,EAF3B,SAAAQ,YAE2B;;;;+EAA5B0C,4B,EAA4B;AAAA;AAAA,kBAF3B,SAAA1C,YAE2B;AAAA,O;AAFf,K;;;;;2BAEb0C,4B,EAA4B;cAJxC,OAAA90E,QAIwC;eAJ/B;AACNC,iBAAO,EAAE,CAAC,SAAAmyE,YAAA,CAAa2C,QAAb,CAAsBnD,MAAtB,CAAD,CADH;AAEN9vE,iBAAO,EAAE,CAAC,SAAAswE,YAAD;AAFH,S;AAI+B,Q;;;;;;;;;;;;;;;;;;;;;;ACfzC;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAUA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACbC;;;;QDuBYyC,+B;;;;;AAST,+CACYhhD,IADZ,EAEYC,OAFZ,EAGYK,SAHZ,EAIY6gD,cAJZ,EAKYx5D,KALZ,EAK0C;AAAA;;AAAA;;AAEtC;AANQ,iBAAAqY,IAAA,GAAAA,IAAA;AACA,iBAAAC,OAAA,GAAAA,OAAA;AACA,iBAAAK,SAAA,GAAAA,SAAA;AACA,iBAAA6gD,cAAA,GAAAA,cAAA;AACA,iBAAAx5D,KAAA,GAAAA,KAAA;AAbL,iBAAAy5D,gBAAA,GAAmB,0BAAAA,gBAAnB;AAEA,iBAAAC,SAAA,GAA0B;AAC7Bv2D,eAAK,EAAE,CAAC,OAAD,EAAU,SAAV,CADsB;AAE7B+mC,qBAAW,EAAE;AAAE30C,mBAAO,EAAE;AAAX;AAFgB,SAA1B;AAIP,iBAAAokE,YAAA,GAA2B,EAA3B;AAO0C;AAKzC;;;;mCAEc;AAAA;;AACX;AACA,eAAKH,cAAL,CAAoB7gC,eAApB,GAAsC,IAAtC;AAEA,eAAKghC,YAAL,GAAoB,KAAKthD,IAAL,CAAUja,SAA9B;AAEA,eAAK/W,YAAL,CAAkB,YAAlB,EAAgC,KAAK2Y,KAAL,CAAW5F,IAAX,CAC5B,QAAA4H,MAAA,CAAO,cAAA0O,gBAAP,CAD4B,EAE5B,YAAAu7B,oBAAA,EAF4B,EAG5B1kD,SAH4B,CAGlB,UAACkQ,IAAD,EAAuC;AACjD,gBAAIA,IAAI,KAAIA,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAExN,MAAV,CAAR,EAA0B;AACtBsZ,0BAAY,CAACiwB,OAAb,CAAqB,gBAArB,YAA0C/7B,IAAI,CAACxN,MAAL,CAAYgJ,EAAtD;AACAsQ,0BAAY,CAACiwB,OAAb,CAAqB,oBAArB,YAA8C/7B,IAAI,CAACvJ,QAAnD;;AACF,kBAAMye,QAAQ,GAAG,QAAI,CAAC0L,IAAL,CAAUja,SAAV,CAAoBtR,IAApB,CACd,UAACgU,CAAD,EAAO;AAAD;;AAAC,uBAAAA,CAAC,CAACvF,EAAF,MAAI,kBAAK9D,IAAI,CAACkL,QAAL,CAAczS,MAAd,CAAqB,UAAAC,EAAE;AAAA,yBAAIA,EAAE,CAACsf,UAAP;AAAA,iBAAvB,EAA0C,CAA1C,CAAL,MAAiD,IAAjD,IAAiD,aAAjD,GAAiD,MAAjD,GAAiD,GAAEpB,IAAnD,MAAuD,IAAvD,IAAuD,aAAvD,GAAuD,MAAvD,GAAuD,GAAE1B,QAAzD,MAAiE,IAAjE,IAAiE,aAAjE,GAAiE,MAAjE,GAAiE,GAAEpR,EAAvE;AAAyE,eADlE,CAAjB;;AAGE,kBAAGoR,QAAH,EAAa;AACT,wBAAI,CAAC0L,IAAL,CAAU1L,QAAV,GAAqBA,QAArB;AACH;AAEJ;AACF,WAf6B,CAAhC;;AAiBE,eAAK0L,IAAL,CAAUxW,WAAV,CAAsBzH,IAAtB,CAA2B,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,mBAAOA,CAAP;AAAA,WAAN,CAA3B,EAA4CvZ,SAA5C,CAAsD,YAAM;AAC1D,oBAAI,CAACoyE,YAAL,GAAoB,QAAI,CAACthD,IAAL,CAAUja,SAA9B;AACD,WAFD;AAKL;;;yCAEuB,CAAE;;;sCAER;AACb;AACA,eAAKo7D,cAAL,CAAoB7gC,eAApB,GAAsC,KAAtC;AACJ;;;;MAxDgD,OAAA5yC,a;;AANrD;;;uBAMaszE,+B,EAA+B,4C,EAAA,sC,EAAA,wC,EAAA,wC,EAAA,8B;AAAA,K;;;YAA/BA,+B;AAA+B,+C;AAAA,+C;AAAA,c;AAAA,a;AAAA,gJ;AAAA;AAAA;AC9B5C;AACC;AACC;AACC;AAAA,mBAAU,IAAAO,cAAA,EAAV;AAA0B,WAA1B;AAED;AACD;AACA;AAED;;;;AAPmB;AAAA,4DAA+B,MAA/B,EAA+B,aAA/B;AAKF;AAAA;;;;;;;;;;2BDuBJP,+B,EAA+B;cAN3C,OAAAluB,SAM2C;eANjC;AACPjlD,kBAAQ,EAAE,0BADH;AAEPklD,qBAAW,EAAE,iCAFN;AAGPC,mBAAS,EAAE,CAAC,mCAAD,CAHJ;AAIPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AAJ1B,S;AAMiC,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AE9B5C;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;AAEa,YAAAorD,yBAAA,GAA4B,CACrC,qCAAAR,+BADqC,EAErC,2BAAAS,sBAFqC,EAGrC,iCAAApB,2BAHqC,EAIrC,qBAAAqB,wBAJqC,EAKrC,kBAAAC,qBALqC,EAMrC,kBAAAC,0BANqC,EAOrC,0BAAAC,oBAPqC,CAA5B;AAUA,YAAAC,oBAAA,GAAuB,CAChC,SAAA51E,YADgC,EACnB,QAAA8qD,WADmB,EAEhC,QAAAC,mBAFgC,EAGhC,gBAAA6oB,mBAHgC,EAIhC,KAAA5oB,QAJgC,CAAvB;;QAkBA6qB,qB;;;;AARb;;YAQaA;;;;yBAAAA,qB;AAAqB,O;AAAA,6CALvB,QAAAD,oBAKuB,IAJ1B,kCAAAb,4BAI0B;;;;+EAArBc,qB,EAAqB;AAAA,uBA3B9B,qCAAAf,+BA2B8B,EA1B9B,2BAAAS,sBA0B8B,EAzB9B,iCAAApB,2BAyB8B,EAxB9B,qBAAAqB,wBAwB8B,EAvB9B,kBAAAC,qBAuB8B,EAtB9B,kBAAAC,0BAsB8B,EArB9B,0BAAAC,oBAqB8B;AArBV,kBAIpB,SAAA31E,YAJoB,EAIP,QAAA8qD,WAJO,EAKpB,QAAAC,mBALoB,EAMpB,gBAAA6oB,mBANoB,EAOpB,KAAA5oB,QAPoB,EAiBhB,kCAAA+pB,4BAjBgB;AAqBU,O;AAJE,K;;;;;2BAIvBc,qB,EAAqB;cARjC,OAAA51E,QAQiC;eARxB;AACN6B,sBAAY,qBAAM,QAAAwzE,yBAAN,CADN;AAENp1E,iBAAO,+BACA,QAAA01E,oBADA,IAEH,kCAAAb,4BAFG;AAFD,S;AAQwB,Q;;;;;;;;;;;;;;;;;;;;;;AC/ClC;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACEM;AACE;AACE;AAAU;AAAkB;AAC5B;AAAM;AAAqB;AAC7B;AACA;AAA+C;AAAA;AAAA;AAAA;AAAA;AAA0C;AAC3F;;;;;;;;AAL0B;AAAA,0DAAoC,SAApC,EAAoC,wEAApC;AACZ;AAAA;AACJ;AAAA;AAEa;AAAA;;;;;;;;AAGvB;AACE;AAAiD;AAAA;AAAA;AAAA;AAAA;AAAA;AAC/C;AAAU;AAAkB;AAC5B;AAAM;AAAqB;AAC7B;AACF;;;;;AAJwB;AAAA;AACV;AAAA;AACJ;AAAA;;;;;;AAbZ;AAEE;AAQA;AAMF;;;;;AAdgB;AAAA;AAQA;AAAA;;;;QDDPY,oB;AAOX,oCAAmBG,MAAnB,EAAmC;AAAA;;AAAhB,aAAAA,MAAA,GAAAA,MAAA;AAFF,aAAAC,aAAA,GAAgB,IAAI,OAAA1xB,YAAJ,EAAhB;AAGhB;;;;mCAEU,CACV;;;wCAEsB2xB,I,EAAM;AAC3B,eAAKD,aAAL,CAAmBtwB,IAAnB,CAAwBuwB,IAAxB;AACD;;;;;;AApBH;;;uBAKaL,oB,EAAoB,+B;AAAA,K;;;YAApBA,oB;AAAoB,oC;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;ACVjC;AACI;AAiBF;;;;AAlB6B;AACb;AAAA;;;oGDSLA,oB,EAAoB,a;AAAA;;;;;2BAApBA,oB,EAAoB;cALhC,OAAA/uB,SAKgC;eALtB;AACTjlD,kBAAQ,EAAE,eADD;AAETklD,qBAAW,EAAE,gCAFJ;AAGTC,mBAAS,EAAE,CAAC,gCAAD;AAHF,S;AAKsB,Q;;;;;;gBAC9B,OAAAziD;;;gBACA,OAAAA;;;gBACA,OAAA+lD,S;iBAAU,W,EAAa;AAAC,sBAAQ;AAAT,W;;;gBAEvB,OAAArD;;;;;;;;;;;;;;;;;;;;;;;;AEfH;AAAA;AAAA;;AAWA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACDgB;;;;;AAEI;;;;;;AAOJ;;;;;;AAVJ;AACI;AASA;AACJ;;;;;AATQ;AAAA;AAQS;AAAA;;;;;;AAUjB;AAEI;AAAmB;AAAgB;AACnC;AACI;AACJ;AACJ;;;;;AAHuB;AAAA;AACf;AAAA;;;;;;AAcJ;AACI;AACI;AACJ;AACJ;;;;;AAFQ;AAAA;;;;;;AAGR;AAEI;AAAmB;AAA+D;AACtF;;;;;AAFI;AACmB;AAAA;;;;;;AAEvB;AACI;AAAmB;AAAO;AAC9B;;;;;;AAtBJ;AACI;AACI;AAAuD;AAAmB;AAC9E;AACA;AACI;AACI;AAGJ;AACJ;AACA;AAKA;AAIA;AAGJ;;;;;AArB2B;AAAA;AAAoC;AAAA;AAInD;AAAA;AAKW;AAAA;AAKA;AAAA;AAIA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;AAO/B;AAWI;AAMQ;AACJ;AACR;;;;;AAdI,6DAAsF,MAAtF,EAAsF,iBAAtF,EAAsF,UAAtF,EAAsF,gBAAtF;AAOA;AAAA,8IAA6G,MAA7G,EAA6G,eAA7G,EAA6G,gBAA7G;AAKkB;AAAA;;;;;;AA9F1B;AAWI;AAKA;AAKI;AACI;AAAkB;AAA0C;AAC5D;AAYJ;AACA;AACI;AACI;AAAmB;AAAW;AAC9B;AACI;AACJ;AACJ;AACA;AAOA;AAyBJ;AACJ;AACA;AAoBJ;;;;;AA5FI,gDAAuB,MAAvB,EAAuB,iBAAvB,EAAuB,OAAvB,EAAuB,2CAAvB,EAAuB,QAAvB,EAAuB,8DAAvB;AADA;AAFA;AAUI;AAAA;AACA,6DAAiC,QAAjC,EAAiC,gCAAjC;AAIA;AAAA;AACA;AAIsB;AAAA;AACG;AAAA;AAgBE;AAAA;AACf;AAAA;AAIoB;AAAA;AAMvB;AAAA;AA2BJ;AAAA;;;;QD1BA2uB,0B;;;;;AAiCT,0CACYz0D,QADZ,EAEWxF,KAFX,EAGYyoC,OAHZ,EAIYD,OAJZ,EAKYgD,KALZ,EAMY7C,kBANZ,EAMkD;AAAA;;AAAA;;AAE9C;AAPQ,iBAAAnjC,QAAA,GAAAA,QAAA;AACD,iBAAAxF,KAAA,GAAAA,KAAA;AACC,iBAAAyoC,OAAA,GAAAA,OAAA;AACA,iBAAAD,OAAA,GAAAA,OAAA;AACA,iBAAAgD,KAAA,GAAAA,KAAA;AACA,iBAAA7C,kBAAA,GAAAA,kBAAA;AApCZ;;AACgB,iBAAA1+C,MAAA,GAAiB,UAAA8I,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAjB;AAShB;;AACiB,iBAAAorD,QAAA,GAAW,IAAI,OAAA1L,YAAJ,EAAX;AAyBiC;AAGjD;;;;mCAEO;AAAA;;AACJ,eAAKvhD,YAAL,CAAkB,aAAlB,EAAiC,KAAK2Y,KAAL,CAAWgC,MAAX,CAAkB,OAAAC,iBAAlB,EAC5B7H,IAD4B,CACvB,YAAA+H,IAAA,CAAK,CAAL,CADuB,EAE5B5a,SAF4B,CAElB,UAAC2a,IAAD,EAA4B;AACvC;AACA,oBAAI,CAAC0J,WAAL,GAAmB,IAAI,cAAA0R,IAAJ,CAASpb,IAAT,CAAnB;AACC,WAL4B,CAAjC;AAQA,eAAK8mC,QAAL,GAAgB,KAAK/qC,OAAL,CAAa6P,MAAb,KAAwB,cAAAuU,cAAA,CAAe2mB,QAAvD;AACA,eAAK3sB,QAAL,GAAgB,KAAKpe,OAAL,CAAa6P,MAAb,KAAwB,cAAAuU,cAAA,CAAehG,QAAvD,CAVI,CAWJ;;AAXI,+BAY2C,KAAKpe,OAZhD;AAAA,cAYG4f,OAZH,kBAYGA,OAZH;AAAA,cAYYD,SAZZ,kBAYYA,SAZZ;AAAA,cAYuBU,gBAZvB,kBAYuBA,gBAZvB;AAaJ,eAAK2qB,cAAL,GAAsB;AAClBC,oBAAQ,EAAE;AACN3zC,qBAAO,EAAEsoB,OAAO,KAAMA,OAAO,CAACnjB,KAAR,KAAkBkjB,SAAS,CAACljB,KAA5B,IAAsCmjB,OAAO,CAACnjB,KAAR,KAAkBkjB,SAAS,CAACljB,KAA5B,IAAqC4jB,gBAAgB,KAAK,IAA1D,IAAkEV,SAAS,CAACljB,KAAV,KAAmB4jB,gBAAgB,CAAC,OAAD,CAAjJ,CADV;AAEN9xB,mBAAK,EAAGqxB,OAAO,CAACnjB,KAAR,KAAkBkjB,SAAS,CAACljB,KAA5B,IAAqC4jB,gBAAgB,KAAK,IAA1D,IAAkEV,SAAS,CAACljB,KAAV,KAAmB4jB,gBAAgB,CAAC,OAAD,CAAtG,GAAoHA,gBAAgB,CAAC,MAAD,CAAhB,IAA4BA,gBAAgB,CAAC,OAAD,CAAhK,GAA8K,CAAAT,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEx4B,IAAT,KAAiBw4B,OAAO,CAACnjB;AAFxM;AADQ,WAAtB;AAMH;;;oCA2CkB1T,O,EAAwB;AACvC;AACA,cAAIA,OAAO,CAACiX,OAAR,IAAmBjX,OAAO,CAACwzE,OAA3B,IAAsCxzE,OAAO,CAACiD,MAAlD,EAA0D;AACtD,iBAAKwwE,iBAAL;AACA,iBAAKzxB,QAAL,GAAgB,KAAK/qC,OAAL,CAAa6P,MAAb,KAAwB,cAAAuU,cAAA,CAAe2mB,QAAvD;AACA,iBAAK3sB,QAAL,GAAgB,KAAKpe,OAAL,CAAa6P,MAAb,KAAwB,cAAAuU,cAAA,CAAehG,QAAvD;AACH;AACJ;AAED;;;;mCACkB6F,K,EAAsB;AACpC,cAAMmP,eAAe,GAAG,KAAKpzB,OAAL,CAAairB,SAAb,EAAxB;AACA3lB,sBAAY,CAACiwB,OAAb,CAAqB,sBAArB,EAA6C3hC,IAAI,CAACE,SAAL,CAAemwB,KAAK,CAACxc,MAAN,EAAf,CAA7C;AACAnC,sBAAY,CAACiwB,OAAb,CAAqB,wBAArB,EAA+C3hC,IAAI,CAACE,SAAL,CAAes/B,eAAf,CAA/C;AACA9tB,sBAAY,CAACiwB,OAAb,CAAqB,gBAArB,YAA0C,KAAKv1B,OAAL,CAAa/J,WAAb,CAAyBjB,EAAnE;AACAsQ,sBAAY,CAACiwB,OAAb,CAAqB,oBAArB,YAA8C,KAAKv1B,OAAL,CAAa/J,WAAb,CAAyB0c,WAAvE;AACH;AAED;;;;;;kCAGiBsR,K,EAAsB;AACnC;AACA,cAAI,KAAKjkB,OAAL,IAAgB,KAAKA,OAAL,CAAamhB,QAAjC,EAA2C;AACvC;AACA,gBAAI7b,YAAJ,EAAkB;AACd,mBAAKm3D,UAAL,CAAgBx4C,KAAhB;AACH;;AACD,iBAAKsmB,OAAL,CAAapL,QAAb,CAAsB,CAAC,WAAD,EAAc,QAAd,CAAtB,EAA+C;AAC3C8M,yBAAW,EAAE;AAAEjsC,uBAAO,EAAE,KAAKA,OAAL,CAAa1C,EAAxB;AAA4Bo/D,oBAAI,EAAEz4C,KAAK,CAAC3mB;AAAxC;AAD8B,aAA/C;AAGH;AACJ;AAED;;;;4CAC4B;AACxB;AACA,cAAI,KAAK0C,OAAT,EAAkB;AACd,gBAAMu8D,OAAO,GAAG,KAAKA,OAAL,IAAgB;AAAE5yE,mBAAK,EAAE,CAAT;AAAYslC,mBAAK,EAAE;AAAnB,aAAhC;AACA,gBAAM0tC,UAAU,GAAG,KAAK3wE,MAAL,CAAY+I,YAAZ,CAAyB,KAAzB,CAAnB;AACA,gBAAM1J,IAAI,GAAG,KAAK2U,OAAL,CAAa/J,WAAb,CAAyBlB,YAAzB,CAAsC,QAAtC,CAAb;AACA,gBAAMwjB,GAAG,GAAG,KAAKvY,OAAL,CAAa9J,SAAb,CAAuBnB,YAAvB,CAAoC,QAApC,CAAZ;AACA,gBAAM6nE,iBAAiB,GAAG,CAACvxE,IAAI,CAACu9B,UAAL,CAAgB+zC,UAAhB,EAA4B,KAA5B,CAA3B;;AACA,gBAAIpkD,GAAG,CAACoL,YAAJ,CAAiBg5C,UAAjB,EAA6B,KAA7B,CAAJ,EAAyC;AAAE;AACvC,mBAAKzsB,GAAL,GAAW,CAAC,GAAZ;AACA,mBAAKjqD,MAAL,GAAc,CAAd;AACA;AACH,aAVa,CAYd;AACA;AACA;;;AAEA,gBAAMsF,KAAK,GAAGqxE,iBAAiB,GAAG,CAAH,GAAOjxE,IAAI,CAAC23B,GAAL,CAAS,CAACj4B,IAAI,CAACk4B,QAAL,CAAco5C,UAAd,EAA0B,OAA1B,EAAmC,OAAnC,EAA4CE,OAA5C,CAAoD,CAApD,CAAV,CAAtC;AACA,gBAAMzwE,QAAQ,GAAGT,IAAI,CAACq9B,GAAL,CACb,KAAKhpB,OAAL,CAAa5T,QADA,EAEbT,IAAI,CAAC23B,GAAL,CAASq5C,UAAU,CAACp5C,QAAX,CAAoBl4B,IAAI,CAACa,QAAL,CAAc;AAAEJ,qBAAO,EAAE,KAAKkU,OAAL,CAAa5T;AAAxB,aAAd,CAApB,EAAuE,SAAvE,CAAT,CAFa,CAAjB;AAIA,iBAAK8jD,GAAL,GAAWvkD,IAAI,CAACmD,GAAL,CAAS,CAAT,EAAavD,KAAK,GAAG,EAAT,GAAe,GAA3B,CAAX;AACA,iBAAKtF,MAAL,GAAc0F,IAAI,CAACq9B,GAAL,CACV,MAAM,KAAKknB,GADD,EAEV,KAAK5e,KAAL,GAAallC,QAAQ,GAAG,EAAxB,GAA8BA,QAAQ,GAAG,EAAX,GAAgB,EAAjB,GAAuB,GAF1C,CAAd;AAIA,iBAAKiqD,QAAL,CAActK,IAAd,CAAmB;AAAEmE,iBAAG,EAAE,KAAKA,GAAZ;AAAiBjqD,oBAAM,EAAGmG,QAAQ,GAAG,EAAX,GAAgB,EAAjB,GAAuB;AAAhD,aAAnB;AACA,iBAAKigD,KAAL,GAAa1gD,IAAI,CAACq9B,GAAL,CAAS,GAAT,EAAc,MAAMuzC,OAAO,CAACttC,KAAd,GAAsB,CAApC,CAAb;AACA,iBAAKmhB,IAAL,GAAYzkD,IAAI,CAACq9B,GAAL,CAAS,MAAM,KAAKqjB,KAApB,EAA2B,KAAKA,KAAL,GAAakwB,OAAO,CAAC5yE,KAArB,GAA6B,IAAI4yE,OAAO,CAAC5yE,KAApE,CAAZ;AACA,iBAAKmzE,YAAL,GACI,CAAC,KAAK98D,OAAL,CAAa+F,KAAb,CAAmB,KAAKwI,KAAL,CAAW9R,KAA9B,IACM,KAAKuD,OAAL,CAAa+F,KAAb,CAAmB,KAAKwI,KAAL,CAAW9R,KAA9B,IAAuC,EAAxC,GAA8CrQ,QADnD,GAEK,CAAC,GAFP,IAEc,GAHlB;AAIA,iBAAK2wE,eAAL,GACI,CAAC,KAAK/8D,OAAL,CAAaiZ,SAAb,CAAuB,KAAK1K,KAAL,CAAW9R,KAAlC,IACM,KAAKuD,OAAL,CAAaiZ,SAAb,CAAuB,KAAK1K,KAAL,CAAW9R,KAAlC,IAA2C,EAA5C,GAAkDrQ,QADvD,GAEK,CAAC,GAFP,IAEc,GAHlB;;AAIA,gBAAI,KAAK4T,OAAL,CAAa+gB,OAAjB,EAA0B;AACtB,mBAAKmvB,GAAL,GAAW,CAAX;AACA,mBAAKjqD,MAAL,GAAc,GAAd;AACH;AACJ;AACJ;;;;AASD;kCACc;AACV,iBAAO,CAAC,SAAD,EAAW,aAAX,EAAyB,mBAAzB,EAA8C,MAA9C,EAAsDkf,QAAtD,CAA+D,KAAKnF,OAAL,CAAag9D,oBAA5E,CAAP;AACH;;;4BApIkB;AACf,iBAAO,KAAKh9D,OAAL,CAAaoZ,OAAb,CAAqBgV,MAArB,CAA4B,CAA5B,EAA+B,CAA/B,CAAP;AACH;AAED;;;;4BACe;AACX,cAAM6uC,SAAS,GAAG,KAAKtvD,WAAL,CAAiBlR,KAAnC;AADW,+BAEoB,KAAKuD,OAFzB;AAAA,cAEH4f,OAFG,kBAEHA,OAFG;AAAA,cAEMD,SAFN,kBAEMA,SAFN;AAGX,cAAGs9C,SAAS,KAAKr9C,OAAO,CAACnjB,KAAtB,IAA+BwgE,SAAS,KAAKt9C,SAAS,CAACljB,KAA1D,EACI,OAAO,KAAKuD,OAAL,CAAaqe,OAAb,EAAP,CADJ,KAGI,OAAO,gBAAP;AACP;AAED;;;;4BACiB;AACb;AACA,iBAAO,KAAKre,OAAL,CAAak9D,WAApB;AACH;AAED;;;;4BACmB;AACf,cAAMh2C,QAAQ,GAAG,KAAKlnB,OAAL,CAAaggB,kBAA9B;AACA,iBAAO,KAAKzR,KAAL,GAAa2Y,QAAQ,CAAC,KAAK3Y,KAAL,CAAW9R,KAAZ,CAAR,IAA8B,CAA3C,GAA+C,CAAtD;AACH;AAED;;;;4BACuB;AACnB,iBAAO,CAAC,CAAC,KAAKwnB,KAAd;AACH;;;4BAEe;AAAA;;AACZ,iBAAO,KAAKjkB,OAAL,CAAamhB,QAAb,CAAsBtyB,IAAtB,CAA2B,UAACo1B,KAAD;AAAA,mBAAWA,KAAK,CAACC,WAAN,KAAsB,QAAI,CAAC3V,KAAL,CAAW9R,KAA5C;AAAA,WAA3B,CAAP;AACH;AAED;;;;4BACiB;AACb,cAAMuD,OAAO,GAAG,KAAKuH,QAAL,CAAcxG,GAAd,CAAkB,4BAAlB,CAAhB;;AACA,iBAAO,CAACf,OAAD,IAAYA,OAAO,CAAC1C,EAAR,KAAe,KAAK0C,OAAL,CAAa1C,EAA/C;AACH;;;4BAmFqB;AAClB,cAAM2/D,SAAS,GAAG,KAAKtvD,WAAL,CAAiBlR,KAAnC;AACA,cAAM0gE,QAAQ,GAAG,KAAKxvD,WAAL,CAAiBvmB,IAAlC;AAFkB,+BAGa,KAAK4Y,OAHlB;AAAA,cAGV4f,OAHU,kBAGVA,OAHU;AAAA,cAGDD,SAHC,kBAGDA,SAHC;AAIxB,kCAAiBtoB,kBAAkB,CAACsoB,SAAS,CAACljB,KAAX,CAAnC,iBAA2DpF,kBAAkB,CAAC4lE,SAAD,CAA7E,wEAAsJ5lE,kBAAkB,CAAC,KAAKkX,KAAL,CAAW2sB,WAAZ,CAAxK;AACA;;;;MAhM8C,OAAApzC,a;;AANhD;;;uBAMak0E,0B,EAA0B,2C,EAAA,8B,EAAA,kC,EAAA,+B,EAAA,0C,EAAA,2C;AAAA,K;;;YAA1BA,0B;AAA0B,2C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,wE;AAAA,c;AAAA,a;AAAA,u9B;AAAA;AAAA;ACnDvC;;;;AAGI;;;;;;;;;;2BDgDSA,0B,EAA0B;cANtC,OAAA9uB,SAMsC;eAN5B;AACPjlD,kBAAQ,EAAE,sBADH;AAEPklD,qBAAW,EAAE,wBAFN;AAGPC,mBAAS,EAAE,CAAC,wBAAD,CAHJ;AAIP2B,yBAAe,EAAE,OAAAC,uBAAA,CAAwBC;AAJlC,S;AAM4B,Q;;;;;;;;;;;;;;;;gBAElC,OAAAtkD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AEjEL;AAAA;AAAA;;AAaA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjBQ;AACI;AACJ;;;;;;AAsBA;AACI;AACI;AAKJ;AACJ;;;;;;AALY;AAAA,qCAAc,OAAd,EAAc,YAAd,EAAc,SAAd,EAAc,OAAd;;;;;;AAMZ;;;;;;AACI,mIAAsF,QAAtF,EAAsF,wFAAtF;;;;;;;;AA5BR;AAII;AAAA;AAAA;AAAA;AAAA,WAA6B,cAA7B,EAA6B;AAAA;AAAA;AAAA;AAAA,SAA7B,EAA6B,iBAA7B,EAA6B;AAAA;AAAA;AAAA;AAAA,SAA7B;AAMA;AAMI;AAAA;AAAA;AAAA;AAAA,sFAA8D,EAA9D;AAAgE,SAAhE;AACV;AACM;AASA;AAGJ;;;;;;AA7BI;AAMA,iEAAe,iBAAf,EAAe,wEAAf;AAII;AAAA,6CAAe,QAAf,EAAe,aAAf,EAAe,SAAf,EAAe,OAAf,EAAe,SAAf,EAAe,sEAAf,EAAe,SAAf,EAAe,kEAAf;;;;;;;;;;;;;ODCZ;;;QAOa0uB,qB;;;;;AA8DT,qCACYx0D,QADZ,EAEY8S,OAFZ,EAGYiwB,sBAHZ,EAIY5vB,SAJZ,EAKY8vB,OALZ,EAMY4yB,GANZ,EAOYhjD,IAPZ,EAOqC;AAAA;;AAAA;;AAEjC;AARQ,iBAAA7S,QAAA,GAAAA,QAAA;AACA,iBAAA8S,OAAA,GAAAA,OAAA;AACA,iBAAAiwB,sBAAA,GAAAA,sBAAA;AACA,iBAAA5vB,SAAA,GAAAA,SAAA;AACA,iBAAA8vB,OAAA,GAAAA,OAAA;AACA,iBAAA4yB,GAAA,GAAAA,GAAA;AACA,iBAAAhjD,IAAA,GAAAA,IAAA;AA1DZ;;AACgB,iBAAAijD,MAAA,GAA2B,EAA3B;AAMA,iBAAAC,iBAAA,GAAwC,EAAxC;AAChB;;AACiB,iBAAAC,MAAA,GAAS,IAAI,OAAA5yB,YAAJ,EAAT;AACjB;;AACiB,iBAAA6yB,QAAA,GAAW,IAAI,OAAA7yB,YAAJ,EAAX;AACjB;;AACiB,iBAAA8yB,MAAA,GAAS,IAAI,OAAA9yB,YAAJ,EAAT;AACjB;;AACO,iBAAA+yB,UAAA,GAAwB,EAAxB;AACP;;AACO,iBAAAC,eAAA,GAA0C,EAA1C;AACP;;AACO,iBAAAC,aAAA,GAA0D,EAA1D;AASP;;AACO,iBAAAt5D,OAAA,GAA4B,EAA5B;AACP;;AACO,iBAAAE,QAAA,GAA4B,EAA5B;AAKP;;AACO,iBAAAq5D,WAAA,GAA0B,SAAKC,kBAAL,EAA1B;AA0BP;;AACQ,iBAAA12D,MAAA,GAAqB,EAArB;AAN6B;AAGpC;AAtBD;;;;;6CAC0B;AACtB,cAAMowC,MAAM,GAAe,EAA3B;AACA,cAAMnsD,IAAI,GAAG,UAAAyJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB8J,YAApB,CAAiC,MAAjC,CAAb;;AACA,eAAK,IAAIrL,IAAC,GAAG,CAAb,EAAgBA,IAAC,GAAG,EAApB,EAAwBA,IAAC,EAAzB,EAA6B;AACzB8tD,kBAAM,CAACtkD,IAAP,CAAY;AACRoK,gBAAE,EAAEjS,IAAI,CAACY,QAAL,CAAc;AAAE0B,oBAAI,EAAEjE;AAAR,eAAd,EAA2BiD,UAA3B,CAAsC,OAAtC,CADI;AAERvF,kBAAI,EAAEiE,IAAI,CAACY,QAAL,CAAc;AAAE0B,oBAAI,EAAEjE;AAAR,eAAd,EAA2BiD,UAA3B,CAAsC,OAAtC,EAA+CmJ,iBAA/C;AAFE,aAAZ;AAIH;;AACD,iBAAO0hD,MAAP;AACH;;;mCAgBc;AAAA;;AACX,eAAKpwC,MAAL,GAAc,KAAK22D,YAAL,EAAd;;AACA,eAAKx2D,QAAL,CAAc3D,WAAd,CAA0BzH,IAA1B,CAA+B,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,mBAAOA,CAAP;AAAA,WAAN,CAA/B,EAAgDvZ,SAAhD,CAA0D,YAAM;AAC5D,oBAAI,CAACkb,QAAL,GAAgB,QAAI,CAAC+C,QAAL,CAAcd,OAAd,CAAsB,cAAtB,KAAyC,EAAzD,CAD4D,CAE5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,oBAAI,CAACrd,YAAL,CACI,UADJ,EAEI,QAAI,CAACkhD,sBAAL,CAA4BrvB,QAA5B,CAAqC3xB,SAArC,CAA+C,UAACC,IAAD,EAAU;AACrD,sBAAI,CAACm0E,UAAL,sBAAsBn0E,IAAtB;AACA,sBAAI,CAAC6d,MAAL,sBAAkB,QAAI,CAAC22D,YAAL,EAAlB;;AACA,sBAAI,CAACX,GAAL,CAASxuB,aAAT;AACH,aAJD,CAFJ;;AAQA,oBAAI,CAACovB,WAAL;AACH,WA1BD;AA2BH;;;oCAEkBj1E,O,EAAsB;AAAA;;AACrC;AACA,cAAIA,OAAO,CAACkB,MAAZ,EAAoB;AAChB,iBAAK+zE,WAAL;AACH;;AACD,cAAIj1E,OAAO,CAACwlB,KAAZ,EAAmB;AACf,iBAAKmvD,UAAL,sBAAsB,KAAKA,UAA3B;AACA,iBAAK1zE,OAAL,CAAa,SAAb,EAAwB;AAAA,qBAAM,QAAI,CAACg0E,WAAL,EAAN;AAAA,aAAxB,EAAkD,GAAlD;AACH;AACD;;;AACA,cAAIj1E,OAAO,CAACk1E,WAAZ,EAAyB;AACrB,iBAAKj0E,OAAL,CAAa,iBAAb,EAAgC;AAAA,qBAAM,QAAI,CAACk0E,iBAAL,EAAN;AAAA,aAAhC,EAAgE,IAAhE;AACH;AACJ;;;uCAEmB;AAAA;;AAChB,cAAI,KAAK3vD,KAAT,EAAgB;AACZ,gBAAMnT,QAAQ,GAAG,KAAKsiE,UAAtB;AACA,gBAAMn0E,IAAI,GAAG6R,QAAQ,CAACnJ,MAAT,CAAgB,UAAC8G,KAAD,EAAW;AACxC,kBAAI,QAAI,CAAColE,cAAL,IAAuB,QAAI,CAACA,cAAL,KAAwBplE,KAAK,CAACqgB,OAAzD,EAAkE;AAC9D,wBAAI,CAAC9U,OAAL,CAAavL,KAAK,CAACuE,EAAnB,IAAyB,IAAzB;AACH;;AAED,kBAAM8U,MAAM,GAAGrZ,KAAK,CAAC6Y,YAAN,IAAsB7Y,KAAK,CAACogB,eAAN,KAA0B,QAA/D;AAEA,qBACQ,CAAC/G,MAAD,IAAW,CAACrZ,KAAK,CAACqlB,QAAlB,IAA8B;AAC9BrlB,mBAAK,CAACilB,IAAN,CAAWvhB,KAAX,KAAqB,QAAI,CAAC8R,KAAL,CAAW9R,KADhC,KAEC,CAAC,QAAI,CAAC2hE,aAAN,IACGrlE,KAAK,CAACgN,KAAN,CAAYhN,KAAK,CAACilB,IAAN,CAAWvhB,KAAvB,CADH,IAEG1D,KAAK,CAACkgB,SAAN,CAAgBlgB,KAAK,CAACilB,IAAN,CAAWvhB,KAA3B,CAJJ,CADR;AAOC,aAdY,EAcVvL,GAdU,CAcN,UAAAwE,CAAC;AAAA,qBAAI,IAAI,cAAAqa,OAAJ,CAAY,MAAD,OAAC,CAAD,EAAC,EAAIra,CAAC,CAAC+R,MAAF,EAAJ,CAAZ,CAAJ;AAAA,aAdK,CAAb;AAgBA,mBAAOle,IAAP;AACH;;AACD,iBAAO,EAAP;AACH;AAED;;AACA;;;;;;;;kCAKiBI,K,EAAeoK,I,EAAe;AAC3C,iBAAOA,IAAI,CAACuJ,EAAL,IAAW3T,KAAlB;AACH;AAED;;;;;;4CAG4B;AAAA;;AACxB,cAAMyd,MAAM,GAAG,KAAKA,MAAL,CAAY7T,IAAZ,CACX,UAACC,CAAD,EAAIC,CAAJ;AAAA,mBACID,CAAC,CAACyC,WAAF,CAAcjB,EAAd,GAAmBvB,CAAC,CAACwC,WAAF,CAAcjB,EAAjC,IACAxB,CAAC,CAACpH,QAAF,GAAaqH,CAAC,CAACrH,QADf,IAEA,CAACoH,CAAC,CAACwkB,KAAF,IAAW,EAAZ,EAAgBtkB,aAAhB,CAA8BD,CAAC,CAACukB,KAAF,IAAW,EAAzC,CAHJ;AAAA,WADW,CAAf;AAMA5Q,gBAAM,CAAC3d,OAAP,CAAe,UAACC,CAAD;AAAA,mBAAQ,QAAI,CAACi0E,eAAL,CAAqBj0E,CAAC,CAAC4T,EAAvB,IAA6B;AAAE3T,mBAAK,EAAE,CAAT;AAAYslC,mBAAK,EAAE;AAAnB,aAArC;AAAA,WAAf;;AAPwB,uDAQN7nB,MARM;AAAA;;AAAA;AAAA;AAAA,kBAQboS,GARa;AASpB,kBAAM4L,SAAS,GAAG5L,GAAG,CAACvjB,WAAJ,CAAgBlB,YAAhB,CAA6B,QAA7B,CAAlB;AACA,kBAAMswB,OAAO,GAAG7L,GAAG,CAACtjB,SAAJ,CAAcnB,YAAd,CAA2B,QAA3B,CAAhB;AACA,kBAAI3B,KAAK,GAAG,CAAZ;AACA,kBAAIzJ,KAAK,GAAG,CAAZ;AACA,kBAAM00E,UAAU,GAAc,EAA9B;;AAboB,2DAcFj3D,MAdE;AAAA;;AAAA;AAAA;AAAA,sBAcTk3D,GAdS;;AAehB;AACA,sBAAI9kD,GAAG,CAAClc,EAAJ,KAAWghE,GAAG,CAAChhE,EAAnB,EAAuB;AACnB,wBAAMihE,SAAS,GAAGD,GAAG,CAACroE,WAAJ,CAAgBlB,YAAhB,CAA6B,QAA7B,CAAlB;AACA,wBAAMypE,OAAO,GAAGF,GAAG,CAACpoE,SAAJ,CAAcnB,YAAd,CAA2B,QAA3B,CAAhB;AACA;;AACA,wBACIqwB,SAAS,CAACwD,UAAV,CAAqB21C,SAArB,EAAgC,QAAhC,KACCn5C,SAAS,CAACxB,WAAV,CAAsB26C,SAAtB,KAAqCn5C,SAAS,CAACzB,YAAV,CAAuB66C,OAAvB,CADtC,IAEAn5C,OAAO,CAACuD,UAAR,CAAmB41C,OAAnB,EAA4B,QAA5B,CAFA,IAGCn5C,OAAO,CAACzB,WAAR,CAAoB26C,SAApB,KAAkCl5C,OAAO,CAAC1B,YAAR,CAAqB66C,OAArB,CAJvC,EAKE;AACEprE,2BAAK;AACLirE,gCAAU,CAACnrE,IAAX,CAAgBsmB,GAAhB;AACA;;AACA,0BACIpS,MAAM,CAAC+xB,SAAP,CAAiB,UAACzvC,CAAD;AAAA,+BAAOA,CAAC,CAAC4T,EAAF,KAASkc,GAAG,CAAClc,EAApB;AAAA,uBAAjB,IACA8J,MAAM,CAAC+xB,SAAP,CAAiB,UAACzvC,CAAD;AAAA,+BAAOA,CAAC,CAAC4T,EAAF,KAASghE,GAAG,CAAChhE,EAApB;AAAA,uBAAjB,CAFJ,EAGE;AACE3T,6BAAK;AACR;AACJ;AACJ;AApCe;;AAcpB,0EAA0B;AAAA;AAuBzB;AArCmB;AAAA;AAAA;AAAA;AAAA;;AAsCpB,sBAAI,CAACg0E,eAAL,CAAqBnkD,GAAG,CAAClc,EAAzB,IAA+B;AAAE3T,qBAAK,EAAEgC,IAAI,CAACmD,GAAL,CAAS,CAAT,EAAYnF,KAAZ,CAAT;AAA6BslC,qBAAK,EAAE77B;AAApC,eAA/B;AAtCoB;;AAQxB,sEAA0B;AAAA;AA+BzB;AAvCuB;AAAA;AAAA;AAAA;AAAA;AAwC3B;AAED;;;;;;sCAGsB;AAClB;AACA,cAAI,KAAKspE,IAAL,IAAa,KAAKA,IAAL,CAAUxzE,aAA3B,EAA0C;AACtC,gBAAMgJ,EAAE,GAAG,KAAKwqE,IAAL,CAAUxzE,aAArB;AACA,iBAAKu1E,OAAL,GACIvsE,EAAE,CAACwsE,UAAH,GAAgB,KAAKz0E,MAArB,IAA+B,CAAC,GAAhC,IACAiI,EAAE,CAACwsE,UAAH,GAAgB,KAAKz0E,MAArB,IAA+B2G,MAAM,CAAC2J,UAF1C;AAGA,iBAAKgjE,MAAL,CAAYxxB,IAAZ,CAAiB,KAAK0yB,OAAtB;AACH;AACJ;AAED;;;;;;mCAGkB;AACd,eAAKE,GAAL,GAAW,KAAKjC,IAAL,CAAUxzE,aAAV,CAAwBmtE,qBAAxB,EAAX;AACA,eAAKmH,QAAL,CAAczxB,IAAd,CAAmB,IAAnB;AACH;AAED;;;;;;kCAGiB;AAAA;;AACb,eAAK/hD,OAAL,CAAa,UAAb,EAAyB;AAAA,mBAAO,QAAI,CAACkmD,GAAL,GAAW,CAAlB;AAAA,WAAzB,EAA+C,EAA/C;AACA,eAAKstB,QAAL,CAAczxB,IAAd,CAAmB,KAAnB;AACH;AAED;;;;;;;;sCAKqBhzC,K,EAA6B;AAC9C;AACA,cAAIA,KAAK,CAAC6lE,KAAN,CAAY91E,CAAhB,EAAmB;AACf,gBAAMA,CAAC,GAAGiQ,KAAK,CAAC8lE,eAAN,CAAsB/1E,CAAhC;AACA,gBAAMonD,GAAG,GAAG,CAACpnD,CAAC,GAAG,KAAK61E,GAAL,CAASzuB,GAAb,GAAmB,KAAK4uB,UAAzB,IAAuC,KAAKH,GAAL,CAAS14E,MAA5D;AACA,gBAAM84E,WAAW,GAAIpzE,IAAI,CAACk1B,KAAL,CAAYqvB,GAAG,GAAG,EAAN,GAAW,EAAZ,GAAkB,EAA7B,IAAmC,EAApC,GAA0C,EAA9D;AACA,iBAAKA,GAAL,GAAY6uB,WAAW,GAAG,EAAf,GAAqB,GAAhC;AAEH;AACJ;;;qDAMmCC,kB,EAAoBC,gB,EAAkB;;;AACtE,cAAM5jC,eAAe,GACjB,YAAKj0B,MAAL,MAAW,IAAX,IAAW,aAAX,GAAW,MAAX,GAAW,GAAEnV,MAAF,CAAS,UAACqpC,GAAD,EAAS;AACzB,gBAAMC,UAAU,GAAG,IAAI,UAAAh/B,MAAJ,CAAW;AAC1BlR,kBAAI,EAAEiwC,GAAG,CAACn+B,WAAJ,GAAkB,IADE;AAE1BuV,yBAAW,EAAE,KAFa;AAG1BC,yBAAW,EAAE2oB,GAAG,CAACrrC;AAHS,aAAX,EAIhB+E,EAJH;AAKA,gBAAMwmC,QAAQ,GAAG,IAAI,UAAAj/B,MAAJ,CAAW;AACxBlR,kBAAI,EAAEiwC,GAAG,CAACz+B,SAAJ,GAAgB,IADE;AAExB6V,yBAAW,EAAE,KAFW;AAGxBC,yBAAW,EAAE2oB,GAAG,CAACrrC;AAHO,aAAX,EAId+E,EAJH;AAKA,gBAAMkqE,iBAAiB,GACnB5jC,GAAG,CAACriB,SAAJ,IACA5gB,MAAM,CAACkpB,MAAP,CAAc+Z,GAAG,CAACriB,SAAlB,EAA6BpL,IAA7B,CAAkC,UAACtf,KAAD;AAAA,qBAAWA,KAAK,KAAK,IAArB;AAAA,aAAlC,CAFJ;;AAGA,gBAAIywE,kBAAkB,CAAChqE,EAAnB,KAA0BwmC,QAA1B,IAAsC0jC,iBAA1C,EAA6D;AACzD,qBAAO,IAAP;AACH,aAFD,MAGI,OACKF,kBAAkB,CAAChqE,EAAnB,IAAyBumC,UAAzB,IAAuCyjC,kBAAkB,CAAChqE,EAAnB,GAAwBwmC,QAAhE,IACCyjC,gBAAgB,CAACjqE,EAAjB,GAAsBumC,UAAtB,IAAoC0jC,gBAAgB,CAACjqE,EAAjB,GAAsBwmC,QAF/D;AAIP,WArBU,CAAX,KAqBM,EAtBV;AAuBA,iBAAO,CAAC,CAACH,eAAe,CAAC9tC,MAAzB;AACH;AAEH;;;;gCACiByS,O,EAAO;AACvB,iBAAOA,OAAO,CAACg9D,oBAAR,KAAiC,MAAxC;AACA;;;;MA1RwC,OAAAl1E,a;;AAL3C;;;uBAKai0E,qB,EAAqB,2C,EAAA,sC,EAAA,4C,EAAA,wC,EAAA,kC,EAAA,0C,EAAA,4C;AAAA,K;;;YAArBA,qB;AAAqB,qC;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpClC;AAUI;AACI;AAGJ;AAGA;AA+BJ;;;;AA3CC,gGAA2C,iBAA3C,EAA2C,+CAA3C,EAA2C,IAA3C,EAA2C,wDAA3C;AAK2B;AAAA;AACA;AAAA;AAQpB;AAAA,+CAA+C,cAA/C,EAA+C,aAA/C;;;;;;;;;2BDiBKA,qB,EAAqB;cALjC,OAAA7uB,SAKiC;eALvB;AACPjlD,kBAAQ,EAAE,gBADH;AAEPklD,qBAAW,EAAE,wBAFN;AAGPC,mBAAS,EAAE,CAAC,wBAAD;AAHJ,S;AAKuB,Q;;;;;;;;;;;;;;;;;;gBAE7B,OAAAziD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA,K;iBAAM,W;;;gBAEN,OAAAA,K;iBAAM,Y;;;gBAEN,OAAAA;;;gBAEA,OAAA0iD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAqBA,OAAAqD,S;iBAAU,M,EAAQ;AAAE,sBAAQ;AAAV,W;;;;;;;;;;;;;;;;;;;;;;;;AEjFvB;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAYA;AAAA;AAAA;;AAeA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1BoB;AACA;AACI;AAAgD;AAA0C;AAC1F;AACI;AACJ;AACF;AACF;AAAiF;AAAA;AAAA;AAAA;AAAA;AAA+C;AACpI;;;;;;;;;;AAPS;AAAA,0DAAoC,SAApC,EAAoC,wCAApC;AAC+C;AAAA;AAE1B;AAAA;AAGL;AAAA,iDAAuB,cAAvB,EAAuB,yBAAvB;;;;;;AATzB;AAEI;AAeN;;;;;AAfY;AAAA;;;;;;AAkBd;;;;;AAAY;;;;;;AAMJ;AAA8D;AAAoB;;;;;AAApB;AAAA;;;;;;;;;;;;;;;AAC9D;AAAoD;AAAA;AAAA;;AAAA;;AAAA,8BAAqB,EAArB;AAAyB,aAAF,MAAE,GAAY,EAAZ;AAAgB,iBAAF,gBAAE,GAAkB,KAAlB;AAAyB,iBAAF,yBAAmB,CAAjB;AAAkB,SAApF;AAChD;AACJ;;;;AADc;AAAA;;;;;;;;;;;;;;AAEd;AACI;AACA;AACJ;;;;AAFc;AAAA;;;;;;;;;;;QDUrBmrB,sB;;;;;AAiCT,sCACYt0D,QADZ,EAEY6S,IAFZ,EAGYowB,OAHZ,EAIYD,OAJZ,EAKYyuB,MALZ,EAMY1uB,sBANZ,EAOYjwB,OAPZ,EAQYtY,KARZ,EAQ+C;AAAA;;AAAA;;AAE3C;AATQ,iBAAAwF,QAAA,GAAAA,QAAA;AACA,iBAAA6S,IAAA,GAAAA,IAAA;AACA,iBAAAowB,OAAA,GAAAA,OAAA;AACA,iBAAAD,OAAA,GAAAA,OAAA;AACA,iBAAAyuB,MAAA,GAAAA,MAAA;AACA,iBAAA1uB,sBAAA,GAAAA,sBAAA;AACA,iBAAAjwB,OAAA,GAAAA,OAAA;AACA,iBAAAtY,KAAA,GAAAA,KAAA;AAxCZ;;AACO,iBAAA/V,MAAA,GAAiB,UAAA8I,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAjB;AAEP;;AACO,iBAAAk0E,YAAA,GAAuB,EAAvB;AACP;;AACO,iBAAAzsB,WAAA,GAAsB,EAAtB;AACP;;AACO,iBAAAxxC,MAAA,GAA0B,EAA1B;AACP;;AACO,iBAAA4zB,WAAA,GAA0B,EAA1B;AAOT,iBAAA4oC,UAAA,GAAwB,EAAxB;AAEA,iBAAA0B,iBAAA,GAA4B,CAA5B;AACA,iBAAAC,eAAA,GAAuB,CAAvB;AAEA,iBAAAC,cAAA,GAAyB,CAAzB;AACM,iBAAA5xD,MAAA,GAAkB,EAAlB;AAIH,iBAAA6xD,QAAA,GAAgB,EAAhB;;AA+HD,iBAAAC,UAAA,GAAa,UAACzrE,IAAD,EAAYK,KAAZ,EAA2BqrE,UAA3B;AAAA,iBAAmD1rE,IAAI,IAAIA,IAAI,CAACK,KAAD,CAAZ,IAAuBL,IAAI,CAACK,KAAD,CAAJ,CAAYrB,WAAZ,GAA0BoS,QAA1B,CAAmCs6D,UAAnC,CAA1E;AAAA,SAAb;;AAlH+C;AAG9C;;;;mCAEc;AAAA;;AACX,eAAKl4D,QAAL,CAAcyQ,KAAd,GAAsB,UAAtB;;AAEJ,eAAKoC,IAAL,CAAUxW,WAAV,CAAsBzH,IAAtB,CAA2B,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,mBAAOA,CAAP;AAAA,WAAN,CAA3B,EAA4CvZ,SAA5C,CAAsD,YAAM;AACpD;AACA,oBAAI,CAAC0C,MAAL,GAAc,IAAI,UAAAuQ,MAAJ,CAAW;AAAElR,kBAAI,EAAE,QAAI,CAACW,MAAL,CAAYgJ,EAApB;AAAwB0d,yBAAW,EAAE,KAArC;AAA4CC,yBAAW,EAAE,QAAI,CAAC1iB;AAA9D,aAAX,CAAd;;AACA,oBAAI,CAAC7G,YAAL,CACI,cADJ,EAEI,QAAI,CAAC4vE,MAAL,CAAY0G,QAAZ,CAAqBp2E,SAArB,CAA+B,UAACwsC,MAAD,EAAY;AACvC;AACA,kBAAIA,MAAM,CAAC6pC,GAAP,CAAW,OAAX,KAAuB,QAAI,CAACR,YAAL,KAAsBrpC,MAAM,CAAC/0B,GAAP,CAAW,OAAX,CAAjD,EAAsE;AAClE,oBAAMwV,KAAK,GAAG,QAAI,CAAC6D,IAAL,CAAUiX,WAAV,CAAsByE,MAAM,CAAC/0B,GAAP,CAAW,OAAX,CAAtB,CAAd;AACA;;;AACA,oBAAIwV,KAAJ,EAAW;AACP,sBAAM7H,QAAQ,GAAG,QAAI,CAAC0L,IAAL,CAAUja,SAAV,CAAoBtR,IAApB,CACb,UAAC4iC,GAAD;AAAA,2BAASA,GAAG,CAACn0B,EAAJ,KAAWiZ,KAAK,CAACmb,WAA1B;AAAA,mBADa,CAAjB;AAGA;;;AACA,sBAAIhjB,QAAJ,EAAc;AACV,4BAAI,CAACywD,YAAL,GAAoB5oD,KAAK,CAACjZ,EAA1B;AACA,4BAAI,CAAC8c,IAAL,CAAU1L,QAAV,GAAqBA,QAArB;;AACA,4BAAI,CAAC47B,sBAAL,CAA4BhN,OAA5B,CAAoC,QAAI,CAAC6hC,YAAL,IAAqB,QAAI,CAAC/kD,IAAL,CAAU1L,QAAV,CAAmBpR,EAA5E;AACH;AACJ;AACJ;AACJ,aAjBD,CAFJ;;AAqBA,oBAAI,CAAClU,YAAL,CACI,UADJ,EAEI,QAAI,CAACgxB,IAAL,CAAUxwB,MAAV,CAAiB,iBAAjB,EAAoCN,SAApC,CAA8C,YAAM;;;AAChD,sBAAI,CAACghD,sBAAL,CAA4BrtB,cAA5B,GADgD,CAEhD;;;AACV,sBAAI,CAACjxB,MAAL,GAAc,IAAI,UAAAuQ,MAAJ,CAAW;AACxBlR,oBAAI,EAAE,QAAI,CAACW,MAAL,CAAYgJ,EADM;AAExB0d,2BAAW,EAAE,KAFW;AAGxBC,2BAAW,EAAE,QAAI,CAAC1iB;AAHM,eAAX,CAAd;AAKU,kBAAMye,QAAQ,GAAG,QAAI,CAAC0L,IAAL,CAAU1L,QAA3B;AAEA;;AACA,kBAAI,CAACA,QAAQ,CAACxN,MAAT,CAAgBrS,IAAhB,CAAqB,UAACokC,GAAD;AAAA,uBAASA,GAAG,CAAC31B,EAAJ,KAAW,QAAI,CAAC6hE,YAAzB;AAAA,eAArB,CAAL,EAAkE;AAC9D,wBAAI,CAACA,YAAL,GAAoB,CAAH,KAAGzwD,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAExN,MAAV,CAAiB,CAAjB,OAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAG5D,EAAzC;;AACA,wBAAI,CAACsiE,WAAL;AACH;;AACX,sBAAI,CAACC,SAAL;;AAEU,sBAAI,CAAC3+D,MAAL,GAAc,CAAC;AAAE5D,kBAAE,EAAE,EAAN;AAAUlW,oBAAI,EAAE;AAAhB,eAAD,EAAwC+1B,MAAxC,CAA+CzO,QAAQ,CAACxN,MAAxD,CAAd;;AACV,sBAAI,CAACA,MAAL,CAAY3N,IAAZ,CAAiB,UAACC,CAAD,EAAIC,CAAJ;AAAA,uBAAUA,CAAC,CAACrM,IAAF,CAAOsM,aAAP,CAAqBF,CAAC,CAACpM,IAAvB,EAA6BkG,SAA7B,EAAwC;AACjEwyE,yBAAO,EAAE,IADwD;AAEjEC,mCAAiB,EAAE;AAF8C,iBAAxC,CAAV;AAAA,eAAjB;;AAMA,sBAAI,CAACR,QAAL,GAAgB,EAAhB;;AACA,sBAAI,CAACr+D,MAAL,CAAYzX,OAAZ,CAAoB,UAAAyI,EAAE,EAAI;AACzB,wBAAI,CAACqtE,QAAL,CAAcrsE,IAAd,CAAmB;AACjBoE,yBAAO,EAAEpF,EAAE,CAAC9K,IADK;AACCmH,uBAAK,EAAE2D,EAAE,CAACoL,EADX;AACe8S,sBAAI,EAAE;AADrB,iBAAnB;AAGA,eAJD;;AAMA,sBAAI,CAAC4vD,WAAL,GAAmB;AAClBC,0BAAU,EAAE,YADM;AAElBhyD,uBAAO,EAAE,QAAI,CAACsxD,QAFI;AAGlBnX,+BAAe,EAAE,QAAI,CAACmX,QAAL,CAActtE,MAAd,CAAqB,UAAAC,EAAE;AAAA,yBAAIA,EAAE,CAAC3D,KAAH,KAAc,QAAI,CAAC4wE,YAAvB;AAAA,iBAAvB,EAA6D,CAA7D,CAHC;AAIlB9W,gCAAgB,EAAE,QAAI,CAAC6X,mBAAL,CAAyBxK,IAAzB,CAA8B,QAA9B;AAJA,eAAnB;AAQA,sBAAI,CAACvlD,mBAAL,GAA2B,QAAI,CAACiK,IAAL,CAAUja,SAAV,CAAoBlO,MAApB,CAC1B,UAAC4Q,CAAD;AAAA,uBAAOA,CAAC,CAAC/B,IAAF,KAAW4N,QAAQ,CAAC5N,IAA3B;AAAA,eAD0B,CAA3B;;AAIA,sBAAI,CAACq/D,oBAAL;AAGO,aA9CD,CAFJ;AAmDH,WA3EL;;AA6EI,eAAK/2E,YAAL,CACI,UADJ,EAEI,KAAKkhD,sBAAL,CAA4BrvB,QAA5B,CAAqC3xB,SAArC,CAA+C,UAACC,IAAD,EAAU;AACrD,oBAAI,CAACm0E,UAAL,sBAAsB,QAAI,CAACK,YAAL,CAAkBx0E,IAAlB,CAAtB;AAEH,WAHD,CAFJ;AAOH;;;qCAEoBA,I,EAAI;AAC1B,cAAM6R,QAAQ,GAAG7R,IAAjB;AACA,cAAM62E,eAAe,GAAGhlE,QAAQ,CAACnJ,MAAT,CAAgB,UAAC8G,KAAD,EAAW;AACjD,gBAAMqZ,MAAM,GAAGrZ,KAAK,CAAC6Y,YAAN,IAAsB7Y,KAAK,CAACogB,eAAN,KAA0B,QAA/D;AACA,mBAAS,CAAC/G,MAAV;AACD,WAHuB,CAAxB;AAKA,iBAAOguD,eAAe,IAAI,EAA1B;AACE;;;oCAEkB;AAAA;;AACf,eAAKh3E,YAAL,CACI,QADJ,EAEI,KAAKixB,OAAL,CAAazwB,MAAb,CAAoB,MAApB,EAA4BN,SAA5B,CAAsC,UAACokB,MAAD,EAAY;AAC9C,gBAAMpG,OAAO,GAAG,CAAC,QAAI,CAAC63D,YAAN,GAAqB,QAAI,CAAC/kD,IAAL,CAAU1L,QAAV,CAAmBpR,EAAxC,GAA6C,QAAI,CAAC6hE,YAAlE;AACA,oBAAI,CAACzxD,MAAL,GAAc,QAAI,CAAC2M,OAAL,CAAapoB,MAAb,CAAoB,UAAC4Q,CAAD;AAAA,qBAAOA,CAAC,CAAC8L,KAAF,CAAQlgB,OAAR,CAAgB6Y,OAAhB,KAA4B,CAA5B,IAAiCzE,CAAC,CAAC0M,QAA1C;AAAA,aAApB,CAAd;AACH,WAHD,CAFJ;AAOH;;;sCAIahhB,K,EAAO;AAAA;;AAEjB;AACD,eAAK8xE,eAAL,GAAuB,KAAvB,CAHkB,CAKlB;;AACA,cAAMC,WAAW,GAAG/xE,KAAK,CAACwE,WAAN,GAAoB40C,IAApB,EAApB,CANkB,CAQlB;;AACD,cAAM44B,QAAQ,gCAAO,KAAK7C,UAAZ,sBAA2B,KAAKhwD,MAAhC,EAAd,CATmB,CAUlB;AACD;;AACA,cAAM8yD,aAAa,GAAGD,QAAQ,CAACtuE,MAAT,CAAiB,UAAC8B,IAAD;AAAA,mBACtC,QAAI,CAACyrE,UAAL,CAAgBzrE,IAAI,CAAC6rB,OAArB,EAA8B,MAA9B,EAAsC0gD,WAAtC,KACA,QAAI,CAACd,UAAL,CAAgBzrE,IAAI,CAAC4rB,SAArB,EAAgC,MAAhC,EAAwC2gD,WAAxC,CADA,IAEA,QAAI,CAACd,UAAL,CAAgBzrE,IAAhB,EAAsB,aAAtB,EAAqCusE,WAArC,CAHsC;AAAA,WAAjB,CAAtB,CAZmB,CAkBlB;;AACA,eAAKhB,cAAL,GAAsBkB,aAAa,CAACjzE,MAApC,CAnBkB,CAqBlB;;AACA,eAAK8yE,eAAL,GAAuB,CAAC,KAAKf,cAA7B,CAtBkB,CAwBlB;;AACA,eAAKF,iBAAL,GAAyB,KAAKE,cAAL,GAAsB,CAA/C;;AAGA,cAAG,KAAKmB,SAAL,KAAmBlyE,KAAtB,EAA6B;AACzB;AACA,iBAAKgZ,QAAL,CAAcvc,GAAd,CAAkB,4BAAlB,EAAgDw1E,aAAa,CAAC,CAAD,CAA7D,EAFyB,CAGzB;;;AACA,iBAAKnB,eAAL,GAAuB,CAAvB;AACH,WALD,MAMK;AACD;AACA;AACA,iBAAKA,eAAL,GAAyB,KAAKA,eAAL,GAAuB,KAAKD,iBAA9B,GAAqD,KAAKC,eAAL,GAAuB,CAA5E,GAAgF,CAAvG,CAHC,CAID;;AACA,iBAAK93D,QAAL,CAAcvc,GAAd,CAAkB,4BAAlB,EAAgDw1E,aAAa,CAAC,KAAKnB,eAAN,CAA7D;AACH,WAxCiB,CA0ClB;;;AACA,eAAKoB,SAAL,GAAiBlyE,KAAjB;AACF;;;sCAGiB;AACd,eAAKgZ,QAAL,CAAcvc,GAAd,CAAkB,4BAAlB,EAAgD,EAAhD;AACF,S,CAKF;;;;qCAKoBgB,M,EAAgB;AAChC,eAAKA,MAAL,GAAcA,MAAd;AACH;;;sCAEoB;AACjB,eAAKs+C,sBAAL,CAA4BhN,OAA5B,CAAoC,KAAK6hC,YAAL,IAAqB,KAAK/kD,IAAL,CAAU1L,QAAV,CAAmBpR,EAA5E;;AACJ,eAAKuiE,SAAL,GAFqB,CAGjB;AACH;;;+CAE2B;AAG7B,cAAG,KAAK1vD,mBAAL,CAAyB5iB,MAA5B,EAAoC;AAEnC,gBAAMmzE,QAAQ,GAAc,CAAC;AAC5BC,yBAAW,EAAE,KAAKvmD,IAAL,CAAU1L,QAAV,CAAmBtnB,IADJ;AAE5Bw5E,sBAAQ,EAAE,OAFkB;AAG5BtI,sBAAQ,EAAC;AAHmB,aAAD,CAA5B;AAOA,iBAAKnoD,mBAAL,CAAyB1mB,OAAzB,CAAiC,UAAAyI,EAAE,EAAI;AACtC,kBAAM2uE,cAAc,GAAc,EAAlC;AAEA3uE,gBAAE,CAACgP,MAAH,CAAUzX,OAAV,CAAkB,UAAAwpC,GAAG;AAAA,uBAAI4tC,cAAc,CAAC3tE,IAAf,CAAoB;AAC5CytE,6BAAW,EAAE1tC,GAAG,CAAC7rC,IAD2B;AAE5CkxE,0BAAQ,EAAE,EAFkC;AAG5CloD,sBAAI,EAAE;AACL+iB,4BAAQ,EAAGF,GAAG,CAAC31B,EADV;AAELo0B,+BAAW,EAAEuB,GAAG,CAACvB;AAFZ;AAHsC,iBAApB,CAAJ;AAAA,eAArB;AAUAmvC,4BAAc,CAAC3tE,IAAf,CAAoB;AAAEytE,2BAAW,EAAE,YAAf;AAA6BrI,wBAAQ,EAAE,EAAvC;AAA2CloD,oBAAI,EAAE;AACnE+iB,0BAAQ,EAAG,EADwD;AAEnEzB,6BAAW,EAAEx/B,EAAE,CAACoL;AAFmD;AAAjD,eAApB;AAMAojE,sBAAQ,CAAC,CAAD,CAAR,CAAYpI,QAAZ,CAAqBplE,IAArB,CAA0B;AACzBytE,2BAAW,EAAEzuE,EAAE,CAAC9K,IADS;AAEzBkxE,wBAAQ,EAAEuI,cAFe;AAGzBzwD,oBAAI,EAAE;AACLshB,6BAAW,EAAEx/B,EAAE,CAACoL;AADX;AAHmB,eAA1B;AAOA,aA1BD;AA4BA,iBAAKwjE,iBAAL,GAAyBJ,QAAzB;AAEA;AAGD;;;6CAE4BpE,I,EAAM;AAAA;;AAClC;AACA,cAAM5tD,QAAQ,GAAG,KAAKyB,mBAAL,CAAyBle,MAAzB,CAAgC,UAAAw/B,GAAG;AAAA,mBAAIA,GAAG,CAACn0B,EAAJ,KAAWg/D,IAAI,CAAClsD,IAAL,CAAUshB,WAAzB;AAAA,WAAnC,EAAyE,CAAzE,CAAjB;AACA,eAAKtX,IAAL,CAAU1L,QAAV,GAAqBA,QAArB;AACA,eAAKqyD,kBAAL,GAA0BryD,QAAQ,CAACtnB,IAAnC;AAGC,eAAK8Z,MAAL,GAAc,CAAC;AAAE5D,cAAE,EAAE,EAAN;AAAUlW,gBAAI,EAAE;AAAhB,WAAD,EAAwC+1B,MAAxC,CAA+CzO,QAAQ,CAACxN,MAAxD,CAAd;AACA,eAAKA,MAAL,CAAY3N,IAAZ,CAAiB,UAACC,CAAD,EAAIC,CAAJ;AAAA,mBAAUA,CAAC,CAACrM,IAAF,CAAOsM,aAAP,CAAqBF,CAAC,CAACpM,IAAvB,EAA6BkG,SAA7B,EAAwC;AACjEwyE,qBAAO,EAAE,IADwD;AAEjEC,+BAAiB,EAAE;AAF8C,aAAxC,CAAV;AAAA,WAAjB;AAOA,eAAKZ,YAAL,GAAoB7C,IAAI,CAAClsD,IAAL,CAAU+iB,QAA9B;AACA,eAAK6sC,WAAL,CAAiB5X,eAAjB,GAAmC,KAAKmX,QAAL,CAActtE,MAAd,CAAqB,UAAAC,EAAE;AAAA,mBAAIA,EAAE,CAAC3D,KAAH,KAAc,QAAI,CAAC4wE,YAAvB;AAAA,WAAvB,EAA6D,CAA7D,CAAnC;AACA,eAAKS,WAAL;AACD;;;4CAEmBrpD,K,EAAW;AAC9B,eAAK4oD,YAAL,GAAoB5oD,KAAK,CAAChoB,KAA1B;AAEA,eAAKqxE,WAAL;AAEA;;;4BAtFuB;;;AAClB,iBAAO,YAAKxlD,IAAL,CAAU1L,QAAV,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEze,QAApB,KAAgCqV,YAAY,CAACC,OAAb,CAAqB,oBAArB,CAAvC;AACH;;;;MAtNuC,OAAAzd,a;;AAL5C;;;uBAKa+zE,sB,EAAsB,2C,EAAA,4C,EAAA,kC,EAAA,+B,EAAA,uC,EAAA,4C,EAAA,sC,EAAA,8B;AAAA,K;;;YAAtBA,sB;AAAsB,qC;AAAA,+C;AAAA,e;AAAA,c;AAAA,wuC;AAAA;AAAA;;;AC/CnC;AACI;AAEI;AAEI;AACI;AAkBL;AAEC;AAEA;AACI;AACI;AACA;AAA6C;AAAA;AAAA,aAAuB,aAAvB,EAAuB;AAAA;;AAAA;;AAAA,iCAA8B,EAA9B,IAAoC,IAAAmF,aAAA,WAApC;AAA4D,WAAnF,EAAuB,eAAvB,EAAuB;AAAA,kCAA2K,KAA3K;AAAkL,mBAAF,qBAAmB,CAAjB;AAAkB,WAA3N;AAA7C;AACA;AACA;AAGA;AAIJ;AACJ;AAGA;AACI;AAAA;AAAA,aAAmB,cAAnB,EAAmB;AAAA,mBAMH,IAAAC,YAAA,QANG;AAMiB,WANpC;AAOJ;AAEJ;AAEA;AACI;AAMJ;AACJ;AACJ;;;;AA3DsB;AAAA;AAoBuB;AAAA;AAGb;AAAA;AACF;AAAA;AACmC;AAAA;AACnB;AAAA;AACQ;AAAA;AAGN;AAAA;AAShC;AAAA,8CAAmB,UAAnB,EAAmB,YAAnB,EAAmB,MAAnB,EAAmB,gBAAnB,EAAmB,aAAnB,EAAmB,IAAnB,EAAmB,eAAnB,EAAmB,IAAnB,EAAmB,oBAAnB,EAAmB,KAAnB;AAaA;AAAA,8CAAiB,OAAjB,EAAiB,gBAAjB,EAAiB,eAAjB,EAAiB,iBAAjB,EAAiB,YAAjB,EAAiB,eAAjB;;;;;;;;;2BDXHpF,sB,EAAsB;cALlC,OAAA3uB,SAKkC;eALxB;AACPjlD,kBAAQ,EAAE,gBADH;AAEPklD,qBAAW,EAAE,iCAFN;AAGPC,mBAAS,EAAE,CAAC,iCAAD;AAHJ,S;AAKwB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AE/CnC;AAAA;AAAA;;AAYA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA,2C,CAEA;;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1BC;AACC;AACD;;;;;;AAeK;AACC;AAAgF;AAAoB;AACrG;;;;;;AADuB;AAAA;AAA0D;AAAA;;;;;;AAKlF;AACC;AACC;AAAkB;AAAqB;AACvC;AACD;AACA;AACC;AAED;AACD;;;;;AAT+D;AAE3C;AAAA;AAIlB;AAAA;;;;;;;;AAYA;AAGC;AAUC;AAAA;AAAA;AAAA;AAAA,WAA+B,QAA/B,EAA+B;AAAA;AAAA;AAAA;AAAA;AAAA,SAA/B,EAA+B,QAA/B,EAA+B;AAAA;AAAA;AAAA;AAAA,SAA/B;AAGD;AACD;;;;;;AAjBmB;AAIjB;AAAA,wDAA0B,QAA1B,EAA0B,aAA1B,EAA0B,OAA1B,EAA0B,OAA1B,EAA0B,QAA1B,EAA0B,aAA1B,EAA0B,eAA1B,EAA0B,oBAA1B,EAA0B,QAA1B,EAA0B,sBAA1B,EAA0B,WAA1B,EAA0B,wCAA1B,EAA0B,YAA1B,EAA0B,kBAA1B,EAA0B,mBAA1B,EAA0B,oBAA1B;;;;;;AAoBP;;AACC;AACD;;;;;AAFwC;;;;;;AAK1C;AACC;AACC;AAAkB;AAAc;AAChC;AACC;AACD;AACD;AACD;;;;AD/CA,QAAM8zB,eAAe,GAAG,EAAxB;;QAQapF,wB;;;;;AA2FT,wCACYv0D,QADZ,EAEY8S,OAFZ,EAGYiwB,sBAHZ,EAIYlwB,IAJZ,EAKY4+C,MALZ,EAMYvwE,SANZ,EAOY+hD,OAPZ,EAQYtoC,KARZ,EASYk7D,GATZ,EASkC;AAAA;;AAAA;;AAE9B;AAVQ,iBAAA71D,QAAA,GAAAA,QAAA;AACA,iBAAA8S,OAAA,GAAAA,OAAA;AACA,iBAAAiwB,sBAAA,GAAAA,sBAAA;AACA,iBAAAlwB,IAAA,GAAAA,IAAA;AACA,iBAAA4+C,MAAA,GAAAA,MAAA;AACA,iBAAAvwE,SAAA,GAAAA,SAAA;AACA,iBAAA+hD,OAAA,GAAAA,OAAA;AACA,iBAAAtoC,KAAA,GAAAA,KAAA;AACA,iBAAAk7D,GAAA,GAAAA,GAAA;AAhGZ;;AACgB,iBAAApxE,MAAA,GAAiB,UAAA8I,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAjB;AAKhB;;AACgB,iBAAAoyE,MAAA,GAA2B,EAA3B;AAQhB;;AACO,iBAAAQ,WAAA,GAA0B,SAAKC,kBAAL,EAA1B;AACP;;AACO,iBAAAgB,UAAA,GAAqB,CAArB;AACP;;AACO,iBAAAqC,WAAA,GAAsB,CAAtB;AACP;;AACO,iBAAAC,aAAA,GAAwB,CAAxB;AACP;;AACO,iBAAA1zD,MAAA,GAAkB,EAAlB;AACP;;AACO,iBAAA2zD,eAAA,GAA2B,EAA3B;AACP;;AACO,iBAAA5C,OAAA,GAAqC,EAArC;AAKP;;AACO,iBAAA6C,aAAA,GAA2C,EAA3C;AAGP;;AACO,iBAAArD,WAAA,GAAsB,CAAtB;AAKP;AACA;;AAEO,iBAAAsD,WAAA,GAAwB,EAAxB;AAEA,iBAAAC,QAAA,GAAoB,SAAKtxE,OAAL,EAApB;AACA,iBAAAuxE,gBAAA,GAAmB,KAAnB;AAMP,iBAAAC,aAAA,GAAyB,KAAzB;AAyCkC;AAGjC;AAvCD;;;;;mCAEkB;AACd,cAAI,KAAKC,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAAnC,EAAkD;AAC9C,iBAAKy1E,GAAL,GAAW,KAAKgD,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAA/B,CAA6CmtE,qBAA7C,EAAX;AACH;AACJ;;;kCAMgB;;;AACb,iBAAO,IAAI,UAAA95D,MAAJ,CAAW;AACdlR,gBAAI,EAAE,UAAAw+C,WAAA,CAAY,KAAK79C,MAAjB,EAAyBgJ,EADjB;AAEd0d,uBAAW,EAAE,KAFC;AAGdC,uBAAW,EAAE,YAAKyH,IAAL,CAAU1L,QAAV,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEze,QAApB,KAAgCqV,YAAY,CAACC,OAAb,CAAqB,oBAArB;AAH/B,WAAX,EAIJqjB,UAJI,CAKH,IAAI,UAAArsB,MAAJ,CAAW;AACPlR,gBAAI,EAAEJ,IAAI,CAAConB,GAAL,EADC;AAEPK,uBAAW,EAAE,KAFN;AAGPC,uBAAW,EAAE,YAAKyH,IAAL,CAAU1L,QAAV,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEze,QAApB,KAAgCqV,YAAY,CAACC,OAAb,CAAqB,oBAArB;AAHtC,WAAX,CALG,EAUH,KAVG,CAAP;AAYH;;;mCAyBc;AAAA;;AACX,eAAK8U,OAAL,CAAazW,WAAb,CAAyBzH,IAAzB,CAA8B,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,mBAAOA,CAAP;AAAA,WAAN,CAA9B,EAA+CvZ,SAA/C,CAAyD,YAAM;AAC3D,oBAAI,CAAC8wB,IAAL,CAAUxW,WAAV,CAAsBzH,IAAtB,CAA2B,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,qBAAOA,CAAP;AAAA,aAAN,CAA3B,EAA4CvZ,SAA5C,CAAsD,YAAM;AACxD,sBAAI,CAACghD,sBAAL,CAA4BzM,wBAA5B;;AACA,kBAAMv2B,OAAO,GAAG,CAAC,QAAI,CAACiP,KAAN,GAAc,QAAI,CAAC6D,IAAL,CAAU1L,QAAV,CAAmBpR,EAAjC,GAAsC,QAAI,CAACiZ,KAA3D;AACA,sBAAI,CAAC7I,MAAL,GAAc,QAAI,CAAC2M,OAAL,CAAapoB,MAAb,CAAoB,UAAC4Q,CAAD;AAAA,uBAAOA,CAAC,CAAC8L,KAAF,CAAQlgB,OAAR,CAAgB6Y,OAAhB,KAA4B,CAAnC;AAAA,eAApB,CAAd;;AACA,sBAAI,CAACzD,IAAL;;AACA,sBAAI,CAAC+9D,UAAL,GALwD,CAMxD;;;AACA,sBAAI,CAACC,UAAL;;AACA,sBAAI,CAAC3/D,KAAL,CAAW6a,iBAAX,CAA6B,YAAM;AAC/B,wBAAI,CAACC,QAAL,CAAc,MAAd,EAAsB;AAAA,yBAAM,QAAI,CAAC6kD,UAAL,EAAN;AAAA,iBAAtB,EAA+C,KAAK,IAApD;AACH,eAFD,EARwD,CAWxD;;;AACA,sBAAI,CAACz4E,YAAL,CACI,QADJ,EAEI,QAAI,CAACkhD,sBAAL,CAA4Bt+C,MAA5B,CAAmC1C,SAAnC,CAA6C,UAAC0C,MAAD,EAAY;AACrD;AACA,wBAAI,CAACA,MAAL,GAAcA,MAAd;AACH,eAHD,CAFJ;AAOH,aAnBD;AAoBH,WArBD;;AAsBA,eAAKw1E,QAAL,GAAgB,KAAKtxE,OAAL,EAAhB;AAEA,eAAK9G,YAAL,CACI,QADJ,EAEI,KAAKixB,OAAL,CAAazwB,MAAb,CAAoB,MAApB,EAA4BN,SAA5B,CAAsC,UAACokB,MAAD,EAAY;AAC9C,gBAAMpG,OAAO,GAAG,CAAC,QAAI,CAACiP,KAAN,GAAc,QAAI,CAAC6D,IAAL,CAAU1L,QAAV,CAAmBpR,EAAjC,GAAsC,QAAI,CAACiZ,KAA3D;AACA,oBAAI,CAAC7I,MAAL,GAAc,QAAI,CAAC2M,OAAL,CAAapoB,MAAb,CAAoB,UAAC4Q,CAAD;AAAA,qBAAOA,CAAC,CAAC8L,KAAF,CAAQlgB,OAAR,CAAgB6Y,OAAhB,KAA4B,CAAnC;AAAA,aAApB,CAAd;;AACA,oBAAI,CAACzD,IAAL;;AACA,oBAAI,CAAC+9D,UAAL,GAJ8C,CAK9C;;;AACA,oBAAI,CAACC,UAAL;AACH,WAPD,CAFJ;AAYH;;;0CAEiB;AACd,cAAM15C,EAAE,GAAG,KAAK1/B,SAAL,CAAe0O,aAAf,CAA6B,KAA7B,CAAX;;AACA,eAAK1O,SAAL,CAAeq5E,QAAf,CAAwB35C,EAAxB,EAA4B,yBAA5B;;AACA,eAAK45C,aAAL,CAAmBvZ,UAAnB,IAAiC,KAAK//D,SAAL,CAAe+O,WAAf,CAA2B,KAAKuqE,aAAL,CAAmBvZ,UAAnB,CAA8Bt/D,aAAzD,EAAwEi/B,EAAxE,CAAjC;AACD;;;oCAGgBp/B,O,EAAsB;AACrC;AACA,cAAIA,OAAO,CAACwtB,KAAR,IAAiB,KAAK6D,IAAL,CAAU1L,QAA/B,EAAyC;AACrC,gBAAMpH,OAAO,GAAG,CAAC,KAAKiP,KAAN,GAAc,KAAK6D,IAAL,CAAU1L,QAAV,CAAmBpR,EAAjC,GAAsC,KAAKiZ,KAA3D;AACA,iBAAK7I,MAAL,GAAc,KAAK2M,OAAL,CAAapoB,MAAb,CAAoB,UAAC4Q,CAAD;AAAA,qBAAOA,CAAC,CAAC8L,KAAF,CAAQlgB,OAAR,CAAgB6Y,OAAhB,KAA4B,CAAnC;AAAA,aAApB,CAAd;AACA,iBAAKu6D,UAAL;AACA,iBAAKD,UAAL;AACH;;AACD,cAAI74E,OAAO,CAACi5E,UAAZ,EAAwB;AACpB,iBAAKJ,UAAL;AACH;AACJ;;;sCAEoB;;;AACjB,cAAI,CAAJ,KAAI,KAAKt3B,sBAAL,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAE23B,WAAjC,EAA8C,WAAK33B,sBAAL,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAE23B,WAAF,EAA3B;AACjD;;;+BAEa;AAAA;;AACV,eAAK16D,QAAL,CAAcyQ,KAAd,GAAsB,UAAtB;AACA,eAAK5uB,YAAL,CACI,SADJ,EAEI,KAAKme,QAAL,CACK3d,MADL,CACY,4BADZ,EAEKN,SAFL,CAEe,UAACyP,KAAD;AAAA,mBAAW,QAAI,CAACmpE,cAAL,CAAoBnpE,KAApB,CAAX;AAAA,WAFf,CAFJ,EAFU,CAQV;;AACA,eAAK3P,YAAL,CACI,aADJ,EAEI,KAAK4vE,MAAL,CAAYmJ,aAAZ,CAA0B74E,SAA1B,CAAoC,UAACwsC,MAAD,EAAY;AAC5C;AACA,gBAAIA,MAAM,CAAC6pC,GAAP,CAAW,MAAX,KAAsBr6D,YAAY,CAACC,OAAb,CAAqB,wBAArB,CAA1B,EAA0E;AACtE,sBAAI,CAAC68D,OAAL,GAAetsC,MAAM,CAAC/0B,GAAP,CAAW,MAAX,CAAf;AACA,kBAAM+b,OAAO,GAAGxX,YAAY,CAACC,OAAb,CAAqB,wBAArB,CAAhB;AACA,kBAAM88D,SAAS,GAAG/8D,YAAY,CAACC,OAAb,CAAqB,8BAArB,CAAlB;AACA;;AACA,kBAAIuX,OAAJ,EAAa;AACT,oBAAMvO,KAAK,GAAsB8zD,SAAS,GACpC,IAAI,cAAA7zD,KAAJ,CAAU5a,IAAI,CAACC,KAAL,CAAWwuE,SAAX,CAAV,CADoC,GAEpC/0E,SAFN;AAGA,oBAAM0S,OAAO,GAAG,IAAI,cAAA+P,OAAJ,CAAY,MAAD,OAAC,CAAD,kBAAMnc,IAAI,CAACC,KAAL,CAAWipB,OAAX,CAAN,CAAC,EAAwB;AAAEkB,sBAAI,EAAEzP;AAAR,iBAAxB,CAAZ,CAAhB;;AACA,oBAAG,CAAC,QAAI,CAACkzD,gBAAT,EAA2B;AACvB,0BAAI,CAACA,gBAAL,GAAwB,IAAxB,CADuB,CAEvB;;AACAn8D,8BAAY,CAACmF,UAAb,CAAwB,wBAAxB;AACAnF,8BAAY,CAACmF,UAAb,CAAwB,8BAAxB;AACH;AACJ;AACJ;AACJ,WApBD,CAFJ;AAyBA;;AACA,cAAI,KAAKk3D,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAAnC,EAAkD;AAC9C,iBAAKy1E,GAAL,GAAW,KAAKgD,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAA/B,CAA6CmtE,qBAA7C,EAAX;AACH;AACJ;AAED;;;;;;;qCAIoBt9D,K,EAAO;AACvB,eAAK+lE,UAAL,GAAkB/lE,KAAK,CAACyE,MAAN,CAAarT,SAA/B;AACA,eAAKg3E,WAAL,GAAmBpoE,KAAK,CAACyE,MAAN,CAAatT,UAAhC;AACH;AAID;;;;6CAC0B;AACtB,cAAMstD,MAAM,GAAe,EAA3B;AACA,cAAMnsD,IAAI,GAAG,UAAAyJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB8J,YAApB,CAAiC,MAAjC,CAAb;;AACA,eAAK,IAAIrL,IAAC,GAAG,CAAb,EAAgBA,IAAC,GAAG,EAApB,EAAwBA,IAAC,EAAzB,EAA6B;AACzB8tD,kBAAM,CAACtkD,IAAP,CAAY;AACRoK,gBAAE,EAAEjS,IAAI,CAACY,QAAL,CAAc;AAAE0B,oBAAI,EAAEjE;AAAR,eAAd,EAA2BiD,UAA3B,CAAsC,OAAtC,CADI;AAERvF,kBAAI,EAAEiE,IAAI,CAACY,QAAL,CAAc;AAAE0B,oBAAI,EAAEjE;AAAR,eAAd,EAA2BiD,UAA3B,CAAsC,OAAtC,EAA+CmJ,iBAA/C;AAFE,aAAZ;AAIH;;AACD,iBAAO0hD,MAAP;AACH;AAED;;;;qCACqB;;;AACjB,cAAMnlC,GAAG,GAAG,IAAI,UAAA9V,MAAJ,CAAW;AACnBlR,gBAAI,EAAEJ,IAAI,CAAConB,GAAL,EADa;AAEnBK,uBAAW,EAAE,KAFM;AAGnBC,uBAAW,EAAE,YAAKyH,IAAL,CAAU1L,QAAV,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEze,QAApB,KAAgCqV,YAAY,CAACC,OAAb,CAAqB,oBAArB;AAH1B,WAAX,CAAZ;AAKA,eAAK8M,GAAL,GAAW,CAACA,GAAG,CAAC6kB,QAAJ,GAAe7kB,GAAG,CAACvmB,OAAJ,GAAc,EAA9B,IAAoC,EAA/C;AACA,eAAKw2E,WAAL,GAAmBjwD,GAAG,CAACtd,YAAJ,CAAiB,MAAjB,EAAyBpI,UAAzB,CAAoC,OAApC,CAAnB;AACA,eAAK60E,QAAL,GAAgB,KAAKtxE,OAAL,EAAhB;AACA,eAAKktE,GAAL,CAASxuB,aAAT;AACH;AAGD;;;;;;;uCAIuB2zB,U,EAA4B;AAAA;;;;AAC/C,cAAIA,UAAU,IAAI,KAAKZ,WAAnB,IAAkC,KAAKA,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAArE,EAAoF;AAChF,iBAAKs5E,MAAL,IAAe,KAAK/5E,SAAL,CAAeg6E,WAAf,CAA2B,KAAKD,MAAhC,EAAwC,MAAxC,CAAf;AAEA;;;;;AAIA,gBAAME,OAAO,GAAGH,UAAU,CAAC,OAAD,CAAV,GAAsBA,UAAU,CAAC,OAAD,CAAV,CAAoBjlE,EAA1C,GAA+CilE,UAAU,CAACjlE,EAA1E;AACA,gBAAMrU,OAAO,GAAmB,KAAK04E,WAAL,CAAiB,YAAjB,EAC3Bz4E,aAD2B,CACb2N,aADa,sBACe6rE,OADf,EAAhC;AAIA,iBAAKF,MAAL,GAAcv5E,OAAd;AAEA,iBAAK05E,SAAL,IAAkB,KAAKl6E,SAAL,CAAeg6E,WAAf,CAA2B,KAAKE,SAAhC,EAA2C,MAA3C,CAAlB;AACA,gBAAGJ,UAAU,CAAC,OAAD,CAAV,IAAuBA,UAAU,CAAC,OAAD,CAAV,CAAoBjlE,EAA9C,EACI,KAAKqlE,SAAL,GAAiB,CAAH,KAAG15E,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE4N,aAAT,YAA2B0rE,UAAU,CAACjlE,EAAtC,QAA0C,IAA1C,IAA0C,aAA1C,GAA0C,MAA1C,GAA0C,GAAGzG,aAAH,CAAiB,kBAAjB,CAA3D;AAGJ;;AACA,gBAAI5N,OAAJ,EAAa;AACT,mBAAK25E,SAAL,IAAkB37E,YAAY,CAAC,KAAK27E,SAAN,CAA9B;;AACA,mBAAKn6E,SAAL,CAAeq5E,QAAf,CAAwB74E,OAAxB,EAAiC,MAAjC;;AACA,mBAAK05E,SAAL,IAAkB,KAAKl6E,SAAL,CAAeq5E,QAAf,CAAwB,KAAKa,SAA7B,EAAwC,MAAxC,CAAlB;AACA,kBAAME,UAAU,GAAG,KAAKlB,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAA/B,CAA6CmtE,qBAA7C,EAAnB;AAEA,kBAAIyM,YAAJ;;AACA,kBAAGP,UAAU,CAAC,OAAD,CAAV,IAAuBA,UAAU,CAAC,OAAD,CAAV,CAAoBjlE,EAA9C,EAAkD;AAC7CwlE,4BAAY,GAAGn3E,IAAI,CAAC23B,GAAL,CACZi/C,UAAU,CAAC,aAAD,CAAV,CAA0Bh/C,QAA1B,CACIg/C,UAAU,CAAC,aAAD,CAAV,CAA0BxtE,YAA1B,CAAuC,KAAvC,CADJ,EAEI,SAFJ,CADY,KAKX,KAAK,EALM,CAAf;AAMJ;;AAGD,kBAAM4pE,GAAG,GAAG11E,OAAO,CAACotE,qBAAR,EAAZ;AACA,kBAAMjmB,IAAI,GAAGuuB,GAAG,CAACvuB,IAAJ,GAAWyyB,UAAU,CAACzyB,IAAtB,GAA6B,KAAKuxB,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAA/B,CAA6CgB,UAA1E,GAAuF,GAApG;AACA,kBAAMgmD,GAAG,GAAIqyB,UAAU,CAAC,OAAD,CAAV,IAAuBA,UAAU,CAAC,OAAD,CAAV,CAAoBjlE,EAA5C,GACR,KAAKqkE,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAA/B,CAA6CinD,YAA7C,GAA4D2yB,YAA5D,GAA2E,EADnE,GAER,CAFJ;AAKA,mBAAKnB,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAA/B,CAA6C+mD,QAA7C,CAAsD;AAClDG,oBAAI,EAAEA,IAD4C;AAElDF,mBAAG,EAAEA,GAF6C;AAGlDG,wBAAQ,EAAE;AAHwC,eAAtD;AAMA,mBAAKuyB,SAAL,GAAkBp7E,UAAU,CAAC,YAAK;AAC9ByB,uBAAO,IAAI,QAAI,CAACR,SAAL,CAAeg6E,WAAf,CAA2Bx5E,OAA3B,EAAoC,MAApC,CAAX;AACA,wBAAI,CAAC05E,SAAL,IAAmB,QAAI,CAACl6E,SAAL,CAAeg6E,WAAf,CAA2B,QAAI,CAACE,SAAhC,EAA2C,MAA3C,CAAnB;AACH,eAH2B,EAGzB,IAHyB,CAA5B;AAIH;AACJ;AACJ;AAED;;;;;;;;mCAKkB95E,C,EAAWC,C,EAAW;AACpC;AACA,cAAID,CAAC,IAAIC,CAAT,EAAY;AACR,iBAAK64E,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAA/B,CAA6CiB,SAA7C,IAA0DrB,CAAC,IAAI,CAA/D;AACA,iBAAK64E,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAA/B,CAA6CgB,UAA7C,IAA2DrB,CAAC,IAAI,CAAhE;AACA;;AACA,gBACKC,CAAC,IACE,KAAK64E,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAA/B,CAA6CiB,SAA7C,IACI,KAAKw3E,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAA/B,CAA6CinD,YAFrD,IAGCtnD,CAAC,IACE,KAAK84E,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAA/B,CAA6CgB,UAA7C,IACI,KAAKy3E,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAA/B,CAA6C65E,WALrD,IAMCj6E,CAAC,IAAI,KAAK64E,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAA/B,CAA6CiB,SAA7C,IAA0D,CANhE,IAOCtB,CAAC,IAAI,KAAK84E,WAAL,CAAiB,YAAjB,EAA+Bz4E,aAA/B,CAA6CgB,UAA7C,IAA2D,CARrE,EASE;AACE,mBAAKhD,aAAL,CAAmB,aAAnB;AACH,aAfO,CAgBZ;;AACC;AACJ;;;wCAEsB;AACnB,eAAKqgB,QAAL,CAAcvc,GAAd,CAAkB,4BAAlB,EAAgD,IAAhD;AACH;;;uCAEqB;AAClB,eAAK9D,aAAL,CAAmB,aAAnB;AACH;AAED;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;qCAEqB;AAAA;;AACjB,cAAMwsC,WAAW,GAAG,KAAKA,WAAzB;AACA,eAAK2tC,eAAL,GAAuB,KAAK3zD,MAAL,CAAYzb,MAAZ,CACnB,UAACvI,CAAD;AAAA,mBACI,CAAC,CAAC,QAAI,CAACs4E,UAAN,IAAoBt4E,CAAC,CAACilB,KAAF,CAAQlgB,OAAR,CAAgB,QAAI,CAACuzE,UAArB,KAAoC,CAAzD,MACC,CAACtuC,WAAD,IAAgBhqC,CAAC,CAAC4T,EAAF,KAASo2B,WAAW,CAACp2B,EADtC,KAEA5T,CAAC,CAAC6lB,QAHN;AAAA,WADmB,CAAvB;AAMA,eAAK8xD,eAAL,CAAqB9tE,IAArB,CAA0B,UAACC,CAAD,EAAIC,CAAJ;AAAA,mBAAUD,CAAC,CAACwmB,UAAF,CAAatmB,aAAb,CAA2BD,CAAC,CAACumB,UAA7B,CAAV;AAAA,WAA1B;AACA,eAAKunD,WAAL,GAAmB,KAAK7zD,MAAL,CAAYxc,GAAZ,CAAgB,UAACxH,CAAD;AAAA,uCAAoBA,CAAC,CAAC4T,EAAtB;AAAA,WAAhB,CAAnB;AACH;;;4BAtUuB;AACpB,iBAAO,KAAKgtC,sBAAL,CAA4BhmC,OAAnC;AACH;;;4BA+BqB;AAClB,cAAMmtB,GAAG,GAAG,KAAKrX,IAAL,CAAU1L,QAAtB;AACA;;AACA,cAAI+iB,GAAG,IAAIA,GAAG,CAACiC,WAAf,EAA4B;AACxB,mBAAO,KAAKrZ,OAAL,CAAaxrB,IAAb,CAAkB4iC,GAAG,CAACiC,WAAtB,CAAP;AACH;;AACD,iBAAO,IAAP;AACH;;;;MA/GO,OAAA5rC,a;;AAPZ;;;uBAMag0E,wB,EAAwB,2C,EAAA,sC,EAAA,4C,EAAA,4C,EAAA,uC,EAAA,kC,EAAA,kC,EAAA,+B,EAAA,0C;AAAA,K;;;YAAxBA,wB;AAAwB,wC;AAAA;AAAA;;yBA0DtB,YAAAkH,wB,EAAwB,I;;;;;;;;;;;;;mBA1D1B,c;AAAU,W,EAAA,K,EAAA,kB;;;;;;;;;;;;;;;;;;ACvCvB;AACC;;AAIA;AAAkB;AAAA,mBAAS,IAAAC,aAAA,EAAT;AAAwB,WAAxB;AACjB;AACC;AAMC;AAAA,mBAAU,IAAAC,YAAA,QAAV;AAA8B,WAA9B;AAEA;AACC;AACC;AAAkB;AAAI;AACtB;AAGD;AACD;AACA;AACC;AAUD;AAEA;AAGA;AACC;AACC;AACC;AAkBD;AACD;AACD;AACD;AACD;AAEA;AAGE;AACJ;AACA;;;;AAtEqB;AAAA;AAKO;AAAA;AAYH;AAAA;AAMM;AAAA;AAmBvB;AAAA;AAuBgB;AAAA;AAKI;AAAA;;;;;;;;;;;2BDhCfpH,wB,EAAwB;cANpC,OAAA5uB,SAMoC;eAN1B;AACPjlD,kBAAQ,EAAE,mBADH;AAEPklD,qBAAW,EAAE,2BAFN;AAGPC,mBAAS,EAAE,CAAC,2BAAD,CAHJ;AAIP2B,yBAAe,EAAE,OAAAC,uBAAA,CAAwBC;AAJlC,S;AAM0B,Q;;;;;;;;;;;;;;;;;;;;;;gBAKhC,OAAAtkD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAuCA,OAAA+lD,S;iBAAU,a,EAAe;AAAE,sBAAQ;AAAV,W;;;gBAEzB,OAAAA,S;iBAAU,YAAAsyB,wB;;;gBAOV,OAAAloE,Y;iBAAa,e;;;;;;;;;;;;;;;;;;;;;;;;;;;;AExGlB;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAGA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyBY;AACI;AAII;AAAA;AAAA;AAAA;AAAA;AACJ;AACJ;;;;;AALQ;AAAA,2CAAa,WAAb,EAAa,IAAb,EAAa,UAAb,EAAa,IAAb;;;;;;AAWQ;AACE;AAAI;AAAoJ;AAC1J;;;;;AADM;AAAA;;;;;;AAEN;AACE;AACF;;;;;;AAIU;AAA6B;AAAmB;;;;;AAAnB;AAAA;;;;;;AAC7B;AAA4B;AAAyD;;;;;;AAFvF;AACE;AACA;AACF;;;;;AAFM;AAAA;AACA;AAAA;;;;;;AAIF;AAAyC;AAA8B;;;;;AAA9B;AAAA;;;;;;AAD3C;AACE;AACA;AAAK;AAA0B;AAC/B;AAAK;AAA0B;AAC/B;AAAK;AAAuD;AAC9D;;;;;AAJkB;AAAA;AACX;AAAA;AACA;AAAA;AACA;AAAA;;;;;;;;AAIxB;AAA4D;AAAA;AAAA;AAAA,+CAAS,QAAA8G,IAAA,oFAAT;AAA0D,SAA1D;AAA6D;AAAmE;;;;;;AAAnE;AAAA;;;;;;AAFxG;AAClB;AAAgC;;AAC/B;AACD;AACC;AAAK;AAAgC;AACrC;AAAK;AAAiC;AACtC;AAAK;AAA0B;AAC/B;AAAK;AAAiD;AACxD;;;;;;;AAPiC;AAAA;AACzB;AAAA;AAED;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;;AAdU;AACE;AAMA;AAUF;;;;;AAhB4B;AAAA;AAMC;AAAA;;;;;;AAW7B;AACI;AACE;AAAK;AAAuE;AAC5E;AAAK;AAA8E;AACnF;AACA;AACE;AACA;AACA;AACJ;AACA;AACJ;;;;;;AAEI;AACI;AACI;AAEJ;AACA;AAAK;AAAkC;AACvC;AAAK;AAAyC;AAClD;;;;;AALQ;AAAA;AAGC;AAAA;AACA;AAAA;;;;;;AAET;AACI;AACA;AACA;AACA;AACA;AACJ;;;;;;AAIJ;AACI;AACI;AACA;AAAG;AAAuB;AAC9B;AACJ;;;;;AAHa;AAAA;AACF;AAAA;;;;;;AAGX;AACI;AACI;AACA;AACE;AACF;AACJ;AACJ;;;;;;AAUE;AAAmB;AAAO;AAAQ;AAAS;AAAW;;;;;AAAX;AAAA;;;;;;AAI3C;AAAgC;AAAO;AAAuD;AAAQ;;;;;;AAPxG;AACE;AAAG;AAAO;AAAK;AAAS;AAA0B;AAClD;AAAG;AAAO;AAAU;AAAS;AAAa;AAC1C;AACA;AAAG;AAAO;AAAY;AAAS;AAAe;AAC9C;AAAG;AAAO;AAAmB;AAAS;AAAa;AACnD;AAAG;AAAO;AAAwB;AAAS;AAAS;AACpD;AACF;;;;;AAP0B;AAAA;AACK;AAAA;AAC1B;AAAA;AAC4B;AAAA;AACO;AAAA;AACK;AAAA;AACxC;AAAA;;;;;;AAEL;AACE;AAAG;AAA8E;AACjF;AAAG;AAA8E;AACjF;AAAG;AAA8E;AACjF;AAAG;AAA8E;AACjF;AAAG;AAA8E;AACjF;AACE;AACA;AACA;AACF;AACF;;;;;;;;AAEJ;AACI;AACE;AAAI;AAAqC;AAA2C;AACpF;AAKI;AAAA;AAAA;AAAA;AAAA;AACH;AAAM;AAAY;AAAO;AAE1B;AACJ;AACF;;;;;AAb2D;AAOjD;AAAA;AAIkB;AAAA;;;;;;AAG5B;AACE;AACE;AACA;AAAI;AAA8E;AAClF;AAAI;AAA8E;AAClF;AAAG;AAAM;AACT;AACF;AAEF;;;;;;AA/CJ;AACI;AACI;AASA;AAYJ;AACA;AAcA;AAUJ;;;;;AA9CsB;AAAA;AASA;AAAA;AAaI;AAAA;AAcS;AAAA;;;;;;AAWnC;AACI;AAAI;AAAoB;AACxB;AAAG;AAAgE;AACnE;AAAG;AAAsC;AAC7C;;;;;;;;AAKR;AACI;AACI;AAA8D;AAAA;AAAA;AAAA;AAAA;AAAuB;AAAoD;AAC7I;AACJ;;;;;AAF6F;AAAA;;;;;;AAG7F;AACE;AACI;AACJ;AACF;;;;;;AAhKZ;AACI;AAQA;AACA;AACI;AACI;AACI;AACI;AAGA;AAGA;AACI;AACI;AAIA;AAkBA;AAYA;AACI;AAQA;AAOJ;AACJ;AACA;AACI;AAMA;AAQJ;AACJ;AACJ;AACA;AACI;AAiDA;AAKJ;AACJ;AACJ;AACA;AACI;AAKA;AAKJ;AACJ;AACJ;AAnKA;;;;;AAC2B;AAAA;AAYU;AAAA;AACH;AAAA;AAGA;AAAA;AAKa;AAAA;AAIL;AAAA;AAkBA;AAAA;AAaI;AAAA;AAQA;AAAA;AASjB;AAAA;AAAqE;AACxD;AAAA;AAMA;AAAA;AAWL;AAAA;AACZ;AAAA;AAiDA;AAAA;AASC;AAAA;AAKA;AAAA;;;;AA1KlC,QAAY45D,gBAAZ;;AAAA,eAAYA,gBAAZ,EAA4B;AACxB;AACA;AACH,KAHD,EAAYA,gBAAgB,GAAhB,QAAAA,gBAAA,aAAAA,gBAAA,GAAgB,EAAhB,CAAZ;;QAqLa2H,4B;;;;;AAsET,4CACYphE,KADZ,EAEYwoC,OAFZ,EAE2B;AAAA;;AAAA;;AAEvB;AAHQ,iBAAAxoC,KAAA,GAAAA,KAAA;AACA,iBAAAwoC,OAAA,GAAAA,OAAA;AAvEZ;;AACgB,iBAAA+X,IAAA,GAAyBkZ,gBAAgB,CAAC4H,KAA1C;AAQhB;;AACiB,iBAAAlY,QAAA,GAAW,IAAI,OAAAvgB,YAAJ,EAAX;AA6DU;AAG1B;;;;kCAbgB1mB,K,EAAO;AACpB,iBAAOA,KAAK,CAAC56B,KAAN,CAAY6H,GAAZ,CAAgB,UAAAxH,CAAC;AAAA,8BAAQA,CAAC,CAACokC,MAAV,eAAqBpkC,CAAC,CAACtC,IAAvB;AAAA,WAAjB,EAAgDsN,IAAhD,CAAqD,IAArD,CAAP;AACH;;;2CAEyBuvB,K,EAAO;;;AAC7B,iBAAO,CAAP,KAAO,KAAKriB,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE5B,OAAF,CAAU/J,WAAV,CAAsB/J,QAAtB,CAA+B;AAAEJ,mBAAO,EAAEm4B,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAEb;AAAlB,WAA/B,EAAkEz2B,UAAlE,CAA6E,OAA7E,CAAhB;AACH;;;uCASsB02E,U,EAAkB;AACrC,kBAAQA,UAAR;AACI,iBAAK,WAAL;AACI,qBAAO,UAAP;;AACJ,iBAAK,aAAL;AACI,qBAAO,WAAP;;AACJ;AACI,qBAAOA,UAAP;AANR;AAQH;;;kCAEgB;AACb,iBAAQ,KAAKC,SAAL,IAAkB,CAAC,KAAKh/D,OAAzB,IAAqC,KAAKi/D,aAAL,EAA5C;AACH;;;mCAEiB;AACd3yE,gBAAM,CAACyS,IAAP,CAAY,OAAAmgE,IAAA,CAAKC,IAAjB;AACH;;;qCAEyB;;;;;;yBAElB,KAAKC,K;;;;;AACL,yBAAKJ,SAAL,GAAiB,KAAjB;AACA,yBAAKh/D,OAAL,GAAe,KAAf;AACA,yBAAK4mD,QAAL,CAAcnf,IAAd;;;;;wBAEI,KAAKw3B,aAAL,E;;;;;AACA,yBAAKxhE,KAAL,CAAW4hE,QAAX,CAAoB,cAAAhkE,iBAAA,EAApB,E,CACA;;AACA,yBAAKoC,KAAL,CAAW4hE,QAAX,CAAoB,cAAAjkE,oBAAA,EAApB;;AACA,yBAAK6qC,OAAL,CAAapL,QAAb,CAAsB,CAAC,GAAD,EAAM,MAAN,CAAtB;;;;;;;AAEA,2BAAM,KAAKoL,OAAL,CAAapL,QAAb,CAAsB,CAAC,OAAD,EAAU,SAAV,CAAtB,EAA4C;AAAE8M,iCAAW,EAAE;AAAE30C,+BAAO,EAAE;AAAX;AAAf,qBAA5C,CAAN;;;;;;;;;AAGX;;;wCAE4B;;;;;;;;AACzB,yBAAKyK,KAAL,CAAW4hE,QAAX,CAAoB,cAAAjkE,oBAAA,EAApB;AACA,yBAAK4jE,SAAL,GAAiB,KAAjB;AACA,yBAAKh/D,OAAL,GAAe,KAAf;AACA,yBAAK4mD,QAAL,CAAcnf,IAAd;;AACA,2BAAM,KAAKxB,OAAL,CAAapL,QAAb,CAAsB,CAAC,GAAD,EAAM,MAAN,EAAc,UAAd,EAA0B,CAAF,KAAE,KAAKv9B,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE5B,OAAF,CAAU1C,EAA7C,CAAtB,CAAN;;;;;;;;;AACH;;;wCAEsB;;;AACnB,iBAAO,YAAKsE,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEiO,MAAF,CAASkI,IAAT,CAAchlB,WAAd,EAAT,MAAyC,aAAhD;AACH;;;4BA7Ge;;;AACjB,iBAAO,CAAP,KAAO,KAAK6O,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE5B,OAAlB;AACA;;;4BAGoB;;;AACf,iBAAO,CAAP,KAAO,KAAK4B,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE5B,OAAF,CAAUge,IAAV,CAAetP,QAA/B;AACH;;;4BAE+B;;;AAC9B,iBAAO,CAAC,cAAAyJ,eAAA,CAAgB,CAAD,KAAC,KAAKvW,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE5B,OAA3B,EAAoC,KAAK0O,QAAzC,CAAR;AACD;;;4BAEwB;;;AACrB,iBAAO,CAAC,YAAK9M,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE5B,OAAF,CAAU+f,eAAnB,KAAsC,EAAvC,EAA2C,CAAD,KAC7C,KAAKne,IADyC,MACrC,IADqC,IACrC,aADqC,GACrC,MADqC,GACrC,GAAE5B,OAAF,CAAUge,IAAV,CAAevhB,KADrB,KAEF,gBAFL;AAGH;;;4BAEsB;;;AACnB,iBAAO,CAAC,YAAKmF,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE5B,OAAF,CAAUggB,kBAAnB,KAAyC,EAA1C,EAA8C,CAAD,KAChD,KAAKpe,IAD4C,MACxC,IADwC,IACxC,aADwC,GACxC,MADwC,GACxC,GAAE5B,OAAF,CAAUge,IAAV,CAAevhB,KADrB,KAEF,CAFL;AAGH;;;4BAEsB;;;AACnB,cAAMjJ,CAAC,GAAG4E,KAAK,CAACsB,OAAN,CAAc,CAAD,KAAC,KAAKkI,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE5B,OAAF,CAAU0f,SAAjC,IAA8C,CAAD,KAAC,KAAK9d,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE5B,OAAF,CAAU0f,SAAV,CAAoBxuB,GAApB,CAAwB,UAAA0yE,CAAC;AAAA,mBAAI,CAAAA,CAAC,SAAD,IAAAA,CAAC,WAAD,GAAC,MAAD,GAAAA,CAAC,CAAEx8E,IAAH,IAAUw8E,CAAC,CAACx8E,IAAZ,GAAmB,EAAvB;AAAA,WAAzB,CAAvD,GAA6G,EAAvH;AACA,iBAAOoM,CAAC,CAACkB,IAAF,CAAO,IAAP,CAAP;AACH;;;4BAEoB;;;AACjB,iBAAO,CAAP,KAAO,KAAKkN,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE5B,OAAF,CAAUmgB,OAAV,CAAkBzrB,IAAlB,CAAuB,IAAvB,CAAhB;AACH;;;4BAEkB;;;AACf,cAAMqtB,IAAI,GAAG,CAAH,KAAG,KAAKngB,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE5B,OAAF,CAAU8f,KAAV,CAAgBjxB,IAAhB,CAAqB,UAAAuoB,CAAC;AAAA,mBAAIA,CAAC,CAAC9mB,IAAF,KAAW,WAAf;AAAA,WAAtB,CAAtB;AACA,iBAAOyxB,IAAI,GAAGA,IAAI,CAAC/e,OAAR,GAAkB,EAA7B;AACH;;;4BAEqB;AAClB,iBAAO,OAAA6gE,mBAAA,CAAoB,KAAKC,WAAzB,CAAP;AACH;;;4BAE4B;;;AACzB,iBAAO,cAAA7rD,oBAAA,CAAqB,KAAKvJ,QAA1B,EAAoC,CAAF,WAAE,KAAK9M,IAAP,MAAW,IAAX,IAAW,aAAX,GAAW,MAAX,GAAW,GAAE5B,OAAX,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEuO,KAAxD,KAAkE,cAAA4J,eAAA,CAAgB,CAAD,KAAC,KAAKvW,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE5B,OAA3B,EAAoC,KAAK0O,QAAzC,CAAzE;AACH;;;;MA5D6C,OAAA5mB,a;;AA1KlD;;;uBA0Kaq7E,4B,EAA4B,8B,EAAA,+B;AAAA,K;;;YAA5BA,4B;AAA4B,2C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,0iD;AAAA;AAAA;AAvKjC;;;;AAA0C;;;;;;;;;;2BAuKrCA,4B,EAA4B;cA1KxC,OAAAj2B,SA0KwC;eA1K9B;AACPjlD,kBAAQ,EAAE,sBADH;AAEPuxD,kBAAQ,snYAFD;AAwKPpM,mBAAS,EAAE,CAAC,uCAAD;AAxKJ,S;AA0K8B,Q;;;;;;;;gBAEpC,OAAAziD;;;gBAEA,OAAAA;;;gBACA,OAAAA;;;gBAEA,OAAAA;;;gBACF,OAAAA,K;iBAAM,qB;;;gBAGJ,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AC7NL;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAWA;AAAA;AAAA;;AAGA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpBI;AACI;AACA;AAAuB;AAAoB;AAC3C;AAAqC;AAAA;AAAA;AAAA;AAAA;AAArC;AACJ;;;;;AAF2B;AAAA;;;;;;;;AAIzB;AAKI;AAAA;AAAA;AAAA;AAAA;AACJ;;;;;AAJI,6DAA+B,OAA/B,EAA+B,IAA/B,EAA+B,UAA/B,EAA+B,IAA/B;;;;;;AAKJ;;;;;AAEI,6DAA+B,MAA/B,EAA+B,gBAA/B;;;;;;AAuBoB;AACI;AAAK;AAAoB;AACzB;AAAK;AAAoB;AACzB;AAAK;AAAqC;AAC9C;;;;;AAHS;AAAA;AACA;AAAA;AACA;AAAA;;;;;;;;AAItB;AAAsD;AAAA;AAAA;AAAA;AAAA;AAAuD;AAA6D;;;;;;AAA7D;AAAA;;;;;;AAF/G;AACC;AAAgC;;AAC/B;AACD;AACC;AAAK;AAA0B;AAC/B;AAAK;AAA2B;AAChC;AAAK;AAAoB;AACzB;AAAK;AAAqC;AAC5C;;;;;;;AAPiC;AAAA;AACzB;AAAA;AAED;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;;;;AAkBZ;AACI;AAAuF;AAAA;AAAA;AAAA;AAAA;AAA0B;AAAI;AACrH;AAAkG;AAAA;AAAA;AAAA;AAAA;AAAyD;AAA+E;AAC9O;;;;;AAFsE;AAAA;AAC0D;AAAA;AAA9D;AAA6F;AAAA;;;;;;;;AAE/J;AACE;AAAuF;AAAA;AAAA;AAAA;AAAA;AAA2B;AAAI;AACtH;AAAkG;AAAA;AAAA;AAAA;AAAA;AAAyD;AAAc;AAC3K;;;;;AAFoE;AAAA;AAC0D;AAAA;AAA9D;;;;QD5C7D02B,sB;;;;;;;;;;;;;mCAGM;AAAA;;AACX;;AACA,eAAK36E,YAAL,CAAkB,YAAlB,EAAgC,KAAK2Y,KAAL,CAAW5F,IAAX,CAC5B,QAAA4H,MAAA,CAAO,cAAA0O,gBAAP,CAD4B,EAE5B,YAAAu7B,oBAAA,EAF4B,EAG9B1kD,SAH8B,CAGpB,UAACkQ,IAAD,EAAuC;AAC/C,gBAAIA,IAAI,KAAIA,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAExN,MAAV,CAAR,EAA0B;AACtB,sBAAI,CAAC4V,IAAL,CAAUpI,IAAV,CAAeA,IAAf;;AACA,sBAAI,CAACwG,OAAL,GAAe,QAAI,CAACgkE,oBAAL,CAA0BxqE,IAA1B,CAAf;AACH;AACJ,WAR+B,CAAhC,EAFW,CAYf;;AACA,eAAKyqE,qBAAL;AACC;AAGD;;;;;;sCAGqB;AAAA;;AACjB,eAAK3/D,OAAL,GAAe,IAAf;AACA,eAAKtE,OAAL,GAAe,KAAKgkE,oBAAL,CAA0B,KAAKpiE,IAAL,CAAUrT,KAApC,CAAf,CAFiB,CAGjB;;AACA,eAAKyR,OAAL,CAAa6P,MAAb,GAAsB,cAAAuU,cAAA,CAAe2mB,QAArC;AACA,wBAAAlyB,eAAA,CACI,KAAKwB,OADT,EAEI,KAAKra,OAFT,EAGE+H,IAHF,CAGO,UAACwH,QAAD,EAAuB;AAC1B,gBAAI,CAACA,QAAL,EAAe;AACX;AACA;AACA;AACA;AACA;AACA,sBAAI,CAACvP,OAAL,CAAa6P,MAAb,GAAsB,cAAAuU,cAAA,CAAe8/C,WAArC;AACA;AACH,aATyB,CAW1B;;;AACA,oBAAI,CAACC,iBAAL,CAAuB7jC,IAAvB,CAA4B,QAAI,CAACtgC,OAAjC,EAA0C+H,IAA1C,CACI,UAACyR,GAAD,EAAS;AAChB;AACA,sBAAI,CAAC4qD,4BAAL,CAAkC5qD,GAAlC;AACQ,aAJL,EAKI,UAACrQ,GAAD,EAAS;AACL,kBAAIA,GAAG,CAAC0G,MAAJ,KAAe,GAAnB,EAAwB;AACtB,wBAAI,CAACw0D,yBAAL;AACD,eAFD,MAEO;AAChB,wBAAI,CAAC//D,OAAL,GAAe,KAAf;AACU,wBAAI,CAACg/D,SAAL,GAAiB,KAAjB;;AACC,wBAAI,CAACgB,oBAAL,CAA0B,cAAA1qD,qBAAA,CAAsBzQ,GAAG,CAAC0G,MAA1B,CAA1B;AACD;AACJ,aAbL;AAeH,WA9BD,EA8BE,UAAC1G,GAAD,EAAS;AACH,oBAAI,CAACnf,OAAL,CAAa,OAAb,EAAsB,YAAM;AACnC,sBAAI,CAACq6E,yBAAL;AACQ,aAFD,EAEG,GAFH;AAGH,WAlCL;AAoCH;;;;MAhEuC,8BAAAE,wB;;AAL5C;;;sDAKaR,sB;AAAsB,K;;;YAAtBA,sB;AAAsB,yC;AAAA,+C;AAAA,e;AAAA,c;AAAA,mqC;AAAA;AAAA;AC/BnC;AACI;AAKA;AACE;AAOA;AAKF;AACF;AACI;AACI;AACI;AACI;AACI;AAAI;AAAmC;AACvC;AACI;AACI;AAGI;AAAA,mBAAc,IAAAS,UAAA,QAAd;AAAgC,WAAhC,EAAiC,cAAjC,EAAiC;AAAA,mBACjB,IAAAC,YAAA,QADiB;AACG,WADpC;AAEH;AACL;AACJ;AACA;AACI;AACI;AAAI;AAAsE;AAC1E;AAKf;AAUe;AACI;AAAK;AACiB;AACtB;AAAK;AAAoC;AACzC;AAAK;AAAsC;AAC/C;AACJ;AACJ;AACJ;AACJ;AACJ;AACJ;AACJ;AACA;AACI;AACI;AAIA;AAIJ;AACJ;AACA;AAMI;AAAA,mBAAY,IAAAvZ,QAAA,EAAZ;AAAsB,WAAtB;AACH;AACH;;;;AAvFkG;AAC5D;AAAA;AAO5B;AAAA;AAOA;AAAA;AAUgB;AAAA;AAIQ;AAAA,gDAAmB,eAAnB,EAAmB,mBAAnB;AASA;AAAA;AACC;AAAA;AAKd;AAAA;AAWkB;AAAA;AAEA;AAAA;AACA;AAAA;AAWxB;AAAA;AAIA;AAAA;AAOT;AAAA,oDAAuB,SAAvB,EAAuB,WAAvB,EAAuB,OAAvB,EAAuB,SAAvB,EAAuB,qBAAvB,EAAuB,uBAAvB;;;;;;;uEDjDO6Y,sB;;;;2BAAAA,sB,EAAsB;cALlC,OAAA72B,SAKkC;eALxB;AACPjlD,kBAAQ,EAAE,oBADH;AAEPklD,qBAAW,EAAE,oCAFN;AAGPC,mBAAS,EAAE,CAAC,iCAAD;AAHJ,S;AAKwB,Q;;;;;;;;;;;;;;;;;;;;;;AE/BnC;AAAA;AAAA;;AAEE;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAGA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;AAkBQ;AAGE;AAAA;AAAA;AAAA;AAAA;AACD;;;;;AAFC;;;;;;AAGF;;;;QAIKs3B,2B;;;;;AAKX,2CACW3iE,KADX,EACyC;AAAA;;AAAA;;AAErC;AAFO,iBAAAA,KAAA,GAAAA,KAAA;AAHN,iBAAAuC,OAAA,GAAmB,IAAnB;AAGoC;AAGtC;;;;mCAEY;AAAA;;AAEb,eAAKlb,YAAL,CAAkB,YAAlB,EACE,KAAK2Y,KAAL,CAAW5F,IAAX,CAAgB,YAAA+H,IAAA,CAAK,CAAL,CAAhB,EACH,QAAAH,MAAA,CAAO,cAAA0O,gBAAP,CADG,EAEC,YAAAu7B,oBAAA,EAFD,EAGD1kD,SAHC,CAGS,UAACkQ,IAAD,EAAuC;AAClD,oBAAI,CAAC8K,OAAL,GAAe,KAAf;;AACI,gBAAI9K,IAAI,KAAIA,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAExN,MAAV,CAAR,EAA0B;AACxB,sBAAI,CAACgU,OAAL,GAAe,IAAI,cAAA+P,OAAJ,CAAYvW,IAAZ,CAAf;AACD;AACJ,WARC,CADF;AAWD;;;;MAxB8C,OAAA1R,a;;AAZjD;;;uBAYa48E,2B,EAA2B,8B;AAAA,K;;;YAA3BA,2B;AAA2B,+C;AAAA,+C;AAAA,c;AAAA,a;AAAA,oL;AAAA;AAAA;AAVzB;AACP;AAKA;AACF;;;;AALI;AAAA;AAImB;AAAA;;;;;;;;;2BAIhBA,2B,EAA2B;cAZvC,OAAAx3B,SAYuC;eAZ7B;AACTjlD,kBAAQ,EAAE,0BADD;AAETuxD,kBAAQ,+YAFC;AAUTpM,mBAAS,EAAE,CAAC,iCAAD;AAVF,S;AAY6B,Q;;;;;;;;;;;;;;;;;;;;;;;;;;AC1C1C;AAAA;AAAA;;AAOA;AAAA;AAAA;;AAaA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AF1BI;AACI;AACA;AAAuB;AAAoB;AAC3C;AAAqC;AAAA;AAAA;AAAA;AAAA;AAArC;AACJ;;;;;AAF2B;AAAA;;;;;;;;AAIzB;AAKI;AAAA;AAAA;AAAA;AAAA;AACJ;;;;;AAJI,6DAA+B,OAA/B,EAA+B,IAA/B,EAA+B,UAA/B,EAA+B,IAA/B;;;;;;AAKJ;;;;;AAEI,6DAA+B,MAA/B,EAA+B,gBAA/B;;;;;;AAuBoB;AACI;AAAK;AAAoB;AACzB;AAAK;AAAoB;AACzB;AAAK;AAAqC;AAC9C;;;;;AAHS;AAAA;AACA;AAAA;AACA;AAAA;;;;;;;;AAItB;AAAsD;AAAA;AAAA;AAAA;AAAA;AAAuD;AAA6D;;;;;;AAA7D;AAAA;;;;;;AAF/G;AACC;AAAgC;;AAC/B;AACD;AACC;AAAK;AAA0B;AAC/B;AAAK;AAA2B;AAChC;AAAK;AAAoB;AACzB;AAAK;AAAqC;AAC5C;;;;;;;AAPiC;AAAA;AACzB;AAAA;AAED;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;;;;AAkBZ;AACI;AAAuF;AAAA;AAAA;AAAA;AAAA;AAA0B;AAAI;AACrH;AAAkG;AAAA;AAAA;AAAA;AAAA;AAAyD;AAA+E;AAC9O;;;;;AAFsE;AAAA;AAC0D;AAAA;AAA9D;AAA6F;AAAA;;;;;;;;AAE/J;AACE;AAAuF;AAAA;AAAA;AAAA;AAAA;AAA2B;AAAI;AACtH;AAAkG;AAAA;AAAA;AAAA;AAAA;AAAyD;AAAc;AAC3K;;;;;AAFoE;AAAA;AAC0D;AAAA;AAA9D;;;;QEzC7Du3B,oB;;;;;AALb;AAAA;;AAAA;;;AAOmB,iBAAAC,cAAA,GAAiB,IAAI,OAAAj6B,YAAJ,EAAjB;AAPnB;AAuMC;;;;mCA7LgB;AAAA;;;;AACb;;AAEA,eAAKvhD,YAAL,CAAkB,YAAlB,EAAgC,KAAK2Y,KAAL,CAAW5F,IAAX,CAC9B,QAAA4H,MAAA,CAAO,cAAA0O,gBAAP,CAD8B,EAE9B,YAAAu7B,oBAAA,EAF8B,EAG9B1kD,SAH8B,CAGpB,UAACkQ,IAAD,EAAuC;AACjD,gBAAIA,IAAI,KAAIA,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAExN,MAAV,CAAR,EAA0B;AACxB,sBAAI,CAAC4V,IAAL,CAAUpI,IAAV,CAAeA,IAAf;;AACA,sBAAI,CAACqrE,YAAL,GAAoBrrE,IAAI,CAAC8C,MAAL,KAAgB,cAAAwW,YAAA,CAAaC,IAAjD;AACD;AACF,WAR+B,CAAhC;AAUA,eAAK2wD,KAAL,GAAa,CAAC,KAAKmB,YAAnB;AACA,eAAKC,SAAL,GAAiB,KAAK9kE,OAAL,CAAauO,KAAb,CAAmB9R,KAApC;AACA,cAAMijB,SAAS,GAAI,wBAAK9d,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAErT,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEmxB,SAAlB,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAEnyB,MAA7B,MAAmC,kBAAI,KAAKqU,IAAT,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAErT,KAAf,MAAoB,IAApB,IAAoB,aAApB,GAAoB,MAApB,GAAoB,GAAEmxB,SAAF,CAAY,CAAZ,CAApB,MAAiC,IAAjC,IAAiC,aAAjC,GAAiC,MAAjC,GAAiC,GAAGtP,IAAvE,CAAD,GACb,KAAKxO,IAAL,CAAUrT,KAAV,CAAgBmxB,SADH,GAEd,KAAK1f,OAAL,CAAa0f,SAAb,CAAuBztB,MAAvB,CAA8B,UAAA8yE,EAAE;AAAA,mBAAIA,EAAE,CAAC39E,IAAH,KAAY,EAAZ,IAAkB29E,EAAE,CAACtoE,KAAH,KAAY,EAAlC;AAAA,WAAhC,EAAsEvL,GAAtE,CAA0E,UAAA0yE,CAAC,EAAI;AAC7E,mBAAO;AACLr1E,mBAAK,EAAEq1E,CAAC,CAACnnE,KADJ;AAELnF,qBAAO,EAAEssE,CAAC,CAACx8E,IAFN;AAGLkuB,qBAAO,EAAE,KAHJ;AAILpC,yBAAW,EAAE,IAJR;AAKLnG,0BAAY,EAAE62D,CAAC,CAACx8E,IALX;AAMLgpB,kBAAI,EAAE;AAAEqT,wBAAQ,EAAEmgD,CAAC,CAACngD,QAAd;AAAwBxf,oBAAI,EAAE2/D,CAA9B;AAAiCnf,qBAAK,EAAEmf,CAAC,CAACnnE,KAAF,CAAQ1J,WAAR,GAAsBoS,QAAtB,CAA+B,WAA/B,IAA8C,UAA9C,GAA2D;AAAnG;AAND,aAAP;AAQD,WATD,CAFJ;AAaA,cAAMgb,OAAO,GAAI,wBAAKve,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAErT,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAE4xB,OAAlB,MAAyB,IAAzB,IAAyB,aAAzB,GAAyB,MAAzB,GAAyB,GAAE5yB,MAA3B,MAAiC,kBAAI,KAAKqU,IAAT,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAErT,KAAf,MAAoB,IAApB,IAAoB,aAApB,GAAoB,MAApB,GAAoB,GAAE4xB,OAAF,CAAU,CAAV,CAApB,MAA+B,IAA/B,IAA+B,aAA/B,GAA+B,MAA/B,GAA+B,GAAG7K,OAAnE,CAAD,GACZ,CAAD,WAAC,KAAK1T,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAErT,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAE4xB,OADN,GAEZ,KAAKngB,OAAL,CAAamgB,OAAb,CAAqBjvB,GAArB,CAAyB,UAAA0yE,CAAC,EAAI;AAC9B,mBAAO;AACLr1E,mBAAK,EAAEq1E,CADF;AAELtsE,qBAAO,EAAEssE,CAFJ;AAGLtuD,qBAAO,EAAE,KAHJ;AAILpC,yBAAW,EAAE,IAJR;AAKLnG,0BAAY,EAAE62D;AALT,aAAP;AAOD,WARC,CAFJ;AAYA,cAAM/xB,UAAU,GAAG,YAAK7xC,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAEggB,kBAAF,CAAqB,KAAK8kD,SAA1B,CAAZ,IAAmD,CAAD,KAAC,KAAK9kE,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAEggB,kBAAF,CAAqB,KAAK8kD,SAA1B,CAA/D,GAAsG,CAAzH;AACA,cAAM1vD,IAAI,GAAG,YAAKpV,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAE+f,eAAF,CAAkB,KAAK+kD,SAAvB,CAAZ,IAAgD,CAAD,KAAC,KAAK9kE,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAE+f,eAAF,CAAkB,KAAK+kD,SAAvB,CAA5D,GAAgG,EAA7G;AACA,cAAMnlD,SAAS,GAAI,kBAAK/d,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAErT,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEoxB,SAAlB,MAA2B,kBAAI,KAAK/d,IAAT,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAErT,KAAf,MAAoB,IAApB,IAAoB,aAApB,GAAoB,MAApB,GAAoB,GAAEoxB,SAAtB,MAA+B,IAA/B,IAA+B,aAA/B,GAA+B,MAA/B,GAA+B,GAAEvP,IAA5D,CAAD,GACd,CAAD,WAAC,KAAKxO,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAErT,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEoxB,SADJ,GAEd;AACAroB,mBAAO,EAAE,KAAK0I,OAAL,CAAa2f,SAAb,CAAuBv4B,IADhC;AAEAmH,iBAAK,EAAE,KAAKyR,OAAL,CAAa2f,SAAb,CAAuBljB,KAF9B;AAGA2T,gBAAI,EAAE;AAAEnM,kBAAI,EAAE,KAAKjE,OAAL,CAAa2f;AAArB;AAHN,WAFJ;AAOA,cAAMG,KAAK,GAAG1nB,KAAK,CAACsB,OAAN,CAAc,KAAKsG,OAAL,CAAa8f,KAA3B,IAAoC,CAAD,KAAE,KAAK9f,OAAL,CAAa8f,KAAb,CAAmBjxB,IAAnB,CAAwB,UAAAuoB,CAAC;AAAA,mBAAIA,CAAC,CAAC9mB,IAAF,KAAW,WAAf;AAAA,WAAzB,CAAD,MAAqD,IAArD,IAAqD,aAArD,GAAqD,MAArD,GAAqD,GAAE0S,OAA3F,GAAqG,KAAKhD,OAAL,CAAa8f,KAAhI;AACA,cAAMklD,YAAY,GAAG,kBAAKpjE,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAErT,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEy2E,YAAlB,IAClB,YACD,KAAKpjE,IADJ,MACQ,IADR,IACQ,aADR,GACQ,MADR,GACQ,GAAErT,KADV,MACe,IADf,IACe,aADf,GACe,MADf,GACe,GAAEy2E,YAFC,GAInB;AACEz2D,iBAAK,EAAE,KAAKvO,OAAL,CAAage;AADtB,WAJF;AAQE,cAAMve,OAAO,GAAG,MAAH,OAAG,CAAH,kBACR,KAAKO,OAAL,CAAayH,MAAb,EADQ,CAAG,EACU;AACxBiY,qBAAS,EAATA,SADwB;AAExBtK,gBAAI,EAAJA,IAFwB;AAGxBy8B,sBAAU,EAAVA,UAHwB;AAIxB/xB,iBAAK,EAALA,KAJwB;AAKxBH,qBAAS,EAATA,SALwB;AAMxBqlD,wBAAY,EAAZA,YANwB;AAOxB7kD,mBAAO,EAAPA;AAPwB,WADV,CAAhB;AAUF,eAAKpe,KAAL,CAAW4hE,QAAX,CAAoB,cAAApkE,oBAAA,CAAqB;AACvCE,mBAAO,EAAEA;AAD8B,WAArB,CAApB;;AAIA,cAAG,KAAKolE,YAAR,EAAsB;AACpB,iBAAK7kE,OAAL,GAAe,KAAKgkE,oBAAL,CAA0B,KAAKpiE,IAAL,CAAUrT,KAApC,EAA2C,KAAKs2E,YAAhD,CAAf;AACD,WA1EY,CA2Eb;;;AACA,eAAKZ,qBAAL;AAGD;;;oCAEkBjkE,O,EAAS+hB,I,EAAM/D,I,EAAM;AAAA;;AACtC,cAAM8B,KAAK,GAAG,EAAd;;AACA,cAAM4O,aAAa,GAAG,KAAK0gB,qBAAL,CAA2B61B,QAA3B,EAAtB;;AACA,cAAMC,eAAe,GAAGllE,OAAO,CAAC8f,KAAR,CAAcjxB,IAAd,CAAmB,UAAAkzB,IAAI;AAAA,mBAAIA,IAAI,CAACzxB,IAAL,KAAc,WAAlB;AAAA,WAAvB,CAAxB;AACA,cAAM60E,cAAc,GAAGnlE,OAAO,CAAC8f,KAAR,CAAcjxB,IAAd,CAAmB,UAAAkzB,IAAI;AAAA,mBAAIA,IAAI,CAACzxB,IAAL,KAAc,UAAlB;AAAA,WAAvB,CAAvB;;AAEA,cAAIo+B,aAAa,CAACnhC,MAAd,IAAwB,CAAC43E,cAA7B,EAA6C;AAC3CrlD,iBAAK,CAAC5sB,IAAN,CAAWw7B,aAAa,CAAC,CAAD,CAAxB;AACD;;AAED,cAAIw2C,eAAJ,EAAqB;AACnBllE,mBAAO,CAAC8f,KAAR,CAAc5uB,GAAd,CAAkB,UAAA6C,IAAI,EAAI;AACxB,kBAAMiP,OAAO,GAAG0rB,aAAa,CAACnhC,MAAd,IAAwBwG,IAAI,CAACzD,IAAL,KAAc,UAAtC,GAAmDo+B,aAAa,CAAC,CAAD,CAAb,CAAiB1rB,OAApE,GAA8EjP,IAAI,CAACiP,OAAnG;AAEA8c,mBAAK,CAAC5sB,IAAN,CAAW,MAAD,OAAC,CAAD,kBACLa,IADK,CAAC,EACF;AACP6tB,sBAAM,EAAG,QAAI,CAACjU,WAAL,CAAiBvmB,IADnB;AAEP4b,uBAAO,EAAGjP,IAAI,CAACzD,IAAL,KAAc,WAAd,GAA4ByxB,IAA5B,GAAmC/e,OAFtC;AAGPuL,qBAAK,EAAExa,IAAI,CAACzD,IAAL,KAAc,WAAd,GAA4B0tB,IAA5B,GAAmCjqB,IAAI,CAACwa,KAHxC;AAIPljB,oBAAI,EAAE0I,IAAI,CAACzD,IAAL,KAAc,WAAd,GAA4B,IAAIrF,IAAJ,GAAW83B,OAAX,EAA5B,GAAmDhvB,IAAI,CAAC1I;AAJvD,eADE,CAAX;AAOD,aAVD;AAWD,WAZD,MAYO;AACL,gBAAI02B,IAAJ,EAAU;AACRjC,mBAAK,CAAC5sB,IAAN,CAAW;AACT0uB,sBAAM,EAAE,KAAKjU,WAAL,CAAiBvmB,IADhB;AAETkJ,oBAAI,EAAE,WAFG;AAGT0S,uBAAO,EAAE+e,IAHA;AAITxT,qBAAK,EAAEyP,IAJE;AAKT3yB,oBAAI,EAAE,IAAIJ,IAAJ,GAAW83B,OAAX;AALG,eAAX;AAOD;AACF;;AACD,iBAAOjD,KAAP;AACD;AAED;;;;;;sCAGqB;AAAA;;;;AACnB,cAAMslD,iBAAiB,GAAG,KAAKxjE,IAAL,CAAUrT,KAApC;;AAEA,cAAG,CAAC,KAAKs2E,YAAT,EAAuB;AACvB;AACG,gBAAM7kE,OAAO,GAAGqlE,SAAS,CAAC,KAAKrlE,OAAN,CAAzB;AAEJA,mBAAO,CAACgY,KAAR,GAAgBotD,iBAAiB,CAACptD,KAAlC;AACAhY,mBAAO,CAAC0f,SAAR,GAAoB,KAAK4lD,eAAL,CAAqBF,iBAAiB,CAAC1lD,SAAvC,CAApB;AACA1f,mBAAO,CAACmgB,OAAR,GAAkB,KAAKolD,aAAL,CAAmBH,iBAAiB,CAACjlD,OAArC,CAAlB;AACAngB,mBAAO,CAAC8f,KAAR,GAAgB,KAAK0lD,WAAL,CAAiB,KAAKxlE,OAAtB,EAA+BolE,iBAAiB,CAACtlD,KAAjD,EAAwD,KAAKglD,SAA7D,CAAhB;AAAwF;AACxF9kE,mBAAO,CAAC+f,eAAR,uBAA6B,KAAK+kD,SAAlC,EAA8CM,iBAAiB,CAAChwD,IAAhE;AACApV,mBAAO,CAACggB,kBAAR,uBAAgC,KAAK8kD,SAArC,EAAiDM,iBAAiB,CAACvzB,UAAnE;AACA7xC,mBAAO,CAAC2f,SAAR,GAAoB,CAAH,KAAGylD,iBAAiB,CAACzlD,SAAlB,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAEvP,IAAF,CAAOnM,IAAtD;AACA,gBAAMwnC,eAAe,GAAG25B,iBAAiB,CAACtlD,KAAlB,KAAuB,MAAIslD,iBAAiB,CAACtlD,KAAtB,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAEvyB,MAApD,wBAA+D,aAAA63E,iBAAiB,CAACJ,YAAlB,MAA8B,IAA9B,IAA8B,aAA9B,GAA8B,MAA9B,GAA8B,GAAEz2D,KAAhC,MAAqC,IAArC,IAAqC,aAArC,GAAqC,MAArC,GAAqC,GAAE9R,KAAvC,MAA4C,MAAIuD,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEuO,KAAb,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAE9R,KAAhE,CAA/D,EAAuI,GAAvI,IAA8I,IAAtK,CAXwB,CAWoJ;AAC5K;;AACA,gBAAIgvC,eAAJ,EAAqB;AACnBzrC,qBAAO,CAAC+F,KAAR,GAAgB0lC,eAAhB;AACAzrC,qBAAO,CAACiZ,SAAR,GAAoBwyB,eAApB;AACD;;AACEzrC,mBAAO,CAACugB,OAAR,GAAkB6kD,iBAAiB,CAAC7kD,OAApC;AACH,iBAAKvgB,OAAL,GAAeA,OAAf;AACC,WAnBA,MAoBI;AACL,iBAAKA,OAAL,GAAe,KAAKgkE,oBAAL,CAA0BoB,iBAA1B,EAA6C,KAAKP,YAAlD,CAAf;AACC;;AAGA,eAAKvgE,OAAL,GAAe,IAAf;AACA,wBAAAuU,eAAA,CACE,KAAKwB,OADP,EAEE,KAAKra,OAFP,EAGE+H,IAHF,CAGO,UAACwH,QAAD,EAAuB;AAC1B;AACA,gBAAIA,QAAJ,EAAc;AAEZ,sBAAI,CAAC40D,iBAAL,CAAuB7jC,IAAvB,CAA4B,QAAI,CAACtgC,OAAjC,EAA2C,QAAI,CAAC6kE,YAAhD,EAA8D98D,IAA9D,CACE,UAACyR,GAAD,EAAS;AACP;AACA,wBAAI,CAAC4qD,4BAAL,CAAkC5qD,GAAlC,EAFO,CAGP;;;AACA,wBAAI,CAACorD,cAAL,IAAuB,QAAI,CAACA,cAAL,CAAoB74B,IAApB,CAAyB,QAAI,CAAC/rC,OAA9B,CAAvB;AAED,eAPH,EAQE,UAACmJ,GAAD,EAAS;AACP,oBAAIA,GAAG,CAAC0G,MAAJ,KAAe,GAAnB,EAAwB;AACtB,0BAAI,CAACw0D,yBAAL;AACD,iBAFD,MAEO;AACL,0BAAI,CAAC//D,OAAL,GAAe,KAAf;AACA,0BAAI,CAACg/D,SAAL,GAAiB,KAAjB;;AACA,0BAAI,CAACgB,oBAAL,CAA0B,cAAA1qD,qBAAA,CAAsBzQ,GAAG,CAAC0G,MAA1B,CAA1B;AACD;AACF,eAhBH;AAkBD,aApBD,MAoBO;AACL,sBAAI,CAACw0D,yBAAL;;AACA;AACD;AACJ,WA7BD,EA8BE,UAACl7D,GAAD,EAAS;AACP,oBAAI,CAACk7D,yBAAL;AACD,WAhCH;AAkCD;;;mCAEiB;AAChB,eAAKoB,aAAL,CAAmB15B,IAAnB,CAAwB,IAAxB;AACD;;;;MAhMuC,8BAAAw4B,wB;;AAL1C;;;oDAKaI,oB;AAAoB,K;;;YAApBA,oB;AAAoB,uC;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,e;AAAA,c;AAAA,mqC;AAAA;AAAA;AFlCjC;AACI;AAKA;AACE;AAOA;AAKF;AACF;AACI;AACI;AACI;AACI;AACI;AAAI;AAAmC;AACvC;AACI;AACI;AAGI;AAAA,mBAAc,IAAAH,UAAA,QAAd;AAAgC,WAAhC,EAAiC,cAAjC,EAAiC;AAAA,mBACjB,IAAAC,YAAA,QADiB;AACG,WADpC;AAEH;AACL;AACJ;AACA;AACI;AACI;AAAI;AAAsE;AAC1E;AAKf;AAUe;AACI;AAAK;AACiB;AACtB;AAAK;AAAoC;AACzC;AAAK;AAAsC;AAC/C;AACJ;AACJ;AACJ;AACJ;AACJ;AACJ;AACJ;AACA;AACI;AACI;AAIA;AAIJ;AACJ;AACA;AAMI;AAAA,mBAAY,IAAAvZ,QAAA,EAAZ;AAAsB,WAAtB;AACH;AACH;;;;AAvFkG;AAC5D;AAAA;AAO5B;AAAA;AAOA;AAAA;AAUgB;AAAA;AAIQ;AAAA,gDAAmB,eAAnB,EAAmB,mBAAnB;AASA;AAAA;AACC;AAAA;AAKd;AAAA;AAWkB;AAAA;AAEA;AAAA;AACA;AAAA;AAWxB;AAAA;AAIA;AAAA;AAOT;AAAA,oDAAuB,SAAvB,EAAuB,WAAvB,EAAuB,OAAvB,EAAuB,SAAvB,EAAuB,qBAAvB,EAAuB,uBAAvB;;;;;;;qEE9COyZ,oB;;;;2BAAAA,oB,EAAoB;cALhC,OAAAz3B,SAKgC;eALtB;AACTjlD,kBAAQ,EAAE,kBADD;AAETklD,qBAAW,EAAE,oCAFJ;AAGTC,mBAAS,EAAE,CAAC,iCAAD;AAHF,S;AAKsB,Q;;gBAC9B,OAAAziD;;;gBACA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpCH;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAoBA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AASA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AH1DI;AACI;AACA;AAAuB;AAAoB;AAC3C;AAAqC;AAAA;AAAA;AAAA;AAAA;AAArC;AACJ;;;;;AAF2B;AAAA;;;;;;;;AAIzB;AAKI;AAAA;AAAA;AAAA;AAAA;AACJ;;;;;AAJI,6DAA+B,OAA/B,EAA+B,IAA/B,EAA+B,UAA/B,EAA+B,IAA/B;;;;;;AAKJ;;;;;AAEI,6DAA+B,MAA/B,EAA+B,gBAA/B;;;;;;AAuBoB;AACI;AAAK;AAAoB;AACzB;AAAK;AAAoB;AACzB;AAAK;AAAqC;AAC9C;;;;;AAHS;AAAA;AACA;AAAA;AACA;AAAA;;;;;;;;AAItB;AAAsD;AAAA;AAAA;AAAA;AAAA;AAAuD;AAA6D;;;;;;AAA7D;AAAA;;;;;;AAF/G;AACC;AAAgC;;AAC/B;AACD;AACC;AAAK;AAA0B;AAC/B;AAAK;AAA2B;AAChC;AAAK;AAAoB;AACzB;AAAK;AAAqC;AAC5C;;;;;;;AAPiC;AAAA;AACzB;AAAA;AAED;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;;;;AAkBZ;AACI;AAAuF;AAAA;AAAA;AAAA;AAAA;AAA0B;AAAI;AACrH;AAAkG;AAAA;AAAA;AAAA;AAAA;AAAyD;AAA+E;AAC9O;;;;;AAFsE;AAAA;AAC0D;AAAA;AAA9D;AAA6F;AAAA;;;;;;;;AAE/J;AACE;AAAuF;AAAA;AAAA;AAAA;AAAA;AAA2B;AAAI;AACtH;AAAkG;AAAA;AAAA;AAAA;AAAA;AAAyD;AAAc;AAC3K;;;;;AAFoE;AAAA;AAC0D;AAAA;AAA9D;;;;QGH7Dk3B,wB;;;;;AA+BX,wCACSh9D,QADT,EAESxF,KAFT,EAGSq6D,MAHT,EAIS+H,iBAJT,EAKS75B,sBALT,EAMSjwB,OANT,EAOS+0B,qBAPT,EAQSs2B,MART,EASUrxC,MATV,EAS8B;AAAA;;AAAA;;AAE5B;AAVO,iBAAA9sB,QAAA,GAAAA,QAAA;AACA,iBAAAxF,KAAA,GAAAA,KAAA;AACA,iBAAAq6D,MAAA,GAAAA,MAAA;AACA,iBAAA+H,iBAAA,GAAAA,iBAAA;AACA,iBAAA75B,sBAAA,GAAAA,sBAAA;AACA,iBAAAjwB,OAAA,GAAAA,OAAA;AACA,iBAAA+0B,qBAAA,GAAAA,qBAAA;AACA,iBAAAs2B,MAAA,GAAAA,MAAA;AACC,iBAAArxC,MAAA,GAAAA,MAAA;AAvCH,iBAAAmnC,gBAAA,GAAmB,0BAAAA,gBAAnB;AAEA,iBAAAC,SAAA,GAA0B;AAC/Bv2D,eAAK,EAAE,CAAC,OAAD,EAAU,SAAV,EAAqB,MAArB,CADwB;AAE/B+mC,qBAAW,EAAE;AAFkB,SAA1B;AAKU,iBAAAw5B,aAAA,GAAgB,IAAI,OAAA96B,YAAJ,EAAhB,CAgCa,CA9B9B;;AACO,iBAAA+4B,KAAA,GAAQ,KAAR;AACA,iBAAA9hE,IAAA,GAAO,IAAI,OAAA9a,eAAJ,CAAiDwG,SAAjD,CAAP;AAEA,iBAAAg2E,SAAA,GAAqB,KAArB;AAMA,iBAAAtjE,OAAA,GAAmB,IAAI,cAAA+P,OAAJ,CAAY,EAAZ,CAAnB;AAGA,iBAAA41D,WAAA,GAAuB,IAAvB;AACA,iBAAAC,iBAAA,GAA6B,KAA7B;AAIP,iBAAAf,YAAA,GAAwB,KAAxB;AAY8B;AAG7B;;;;mCAEc;AAAA;;AACb,eAAKz7E,YAAL,CAAkB,aAAlB,EAAiC,KAAK2Y,KAAL,CAAWgC,MAAX,CAAkB,OAAAC,iBAAlB,EAC9B7H,IAD8B,CACzB,YAAA+H,IAAA,CAAK,CAAL,CADyB,EAE9B5a,SAF8B,CAEpB,UAAC2a,IAAD,EAA4B;AACrC;AACA,oBAAI,CAAC0J,WAAL,GAAmB,IAAI,cAAA0R,IAAJ,CAASpb,IAAT,CAAnB;AACD,WAL8B,CAAjC;AASD;;;wCAoC4B;;;;;;;AAC3B,2BAAM,KAAKm4D,MAAL,CAAYj9B,QAAZ,CAAqB,KAAKs8B,SAAL,CAAev2D,KAApC,EAA2C;AAAE+mC,iCAAW,EAAE,KAAKwvB,SAAL,CAAexvB;AAA9B,qBAA3C,CAAN;;;;;;;;;AACD;AAED;;;;;;wCAGuB;AACrB;AACA,eAAK45B,eAAL,GAAuB,IAAI56E,IAAJ,GAAW83B,OAAX,EAAvB;AACD,S,CAED;;;;mCACkBovB,S,EAAgB;AAChC,cAAIvyB,OAAJ;;AACA,cAAIuyB,SAAS,CAAC2zB,YAAd,EAA4B;AAC1B,gBAAI3zB,SAAS,CAACxyB,SAAV,CAAoBpxB,KAApB,KAA8B,KAAKof,WAAL,CAAiBlR,KAAnD,EAA0D;AACxDmjB,qBAAO,GAAG,KAAKjS,WAAf;AACD;AACF,WAN+B,CAQhC;AACA;AACA;AACA;;;AACA,eAAK5L,KAAL,CAAW4hE,QAAX,CAAoB,cAAApkE,oBAAA,CAAqB;AACvCE,mBAAO,EAAE,MAAF,OAAE,CAAF,kBACF,KAAKO,OAAL,CAAayH,MAAb,EADE,CAAE,EACiB;AACxBiY,uBAAS,EAAEyyB,SAAS,CAACzyB,SADG;AAExBtK,kBAAI,EAAE+8B,SAAS,CAAC/8B,IAFQ;AAGxBy8B,wBAAU,EAAEM,SAAS,CAACN,UAHE;AAIxB/xB,mBAAK,EAAEqyB,SAAS,CAACryB,KAJO;AAKxBH,uBAAS,EAAEwyB,SAAS,CAACxyB,SALG;AAMxBC,qBAAO,EAAPA,OANwB;AAOxB5H,mBAAK,EAAEm6B,SAAS,CAACn6B,KAPO;AAQxBmI,qBAAO,EAAEgyB,SAAS,CAAChyB,OARK;AASxBI,qBAAO,EAAE4xB,SAAS,CAAC5xB;AATK,aADjB;AAD8B,WAArB,CAApB;AAcA,eAAKwlD,WAAL;AACD,S,CAED;;;;qCACoB/2D,K,EAAgB;AAClC,eAAK22D,WAAL,GAAmB,CAAC32D,KAApB;AACD;;;mCAEiB+S,I,EAAc+iD,S,EAAmB;AACjD,cAAI/iD,IAAI,IAAIA,IAAI,CAACx0B,MAAjB,EAA2B;AACzB;AACA,mBAAO,CAAC;AACNq0B,oBAAM,EAAE,KAAKjU,WAAL,CAAiBvmB,IADnB;AAENkJ,kBAAI,EAAE,WAFA;AAGN0S,qBAAO,EAAE,CAAC5K,KAAK,CAACsB,OAAN,CAAcqoB,IAAd,CAAD,GAAwBA,IAAxB,GAA+BA,IAAI,CAAC,CAAD,CAAJ,CAAQ/e,OAH1C;AAINuL,mBAAK,EAAEu2D,SAJD;AAKNz5E,kBAAI,EAAE,IAAIJ,IAAJ,GAAW83B,OAAX;AALA,aAAD,CAAP;AAOD;;AAED,iBAAO,EAAP;AACD;;;wCAEsBrD,S,EAAkB;AACvC,iBAAO,CAACA,SAAD,GAAa,EAAb,GAAkBA,SAAS,CAACxuB,GAAV,CAAc,UAAAsC,CAAC,EAAI;;;AAC1C,gBAAIwyE,QAAQ,GAAG;AACbniC,wBAAU,EAAE,EADC;AAEbC,uBAAS,EAAE,EAFE;AAGbrnC,mBAAK,EAAE,EAHM;AAIbrV,kBAAI,EAAE,EAJO;AAKbkJ,kBAAI,EAAE,UALO;AAMbmzB,sBAAQ,EAAE,KANG;AAOb+e,qBAAO,EAAE;AAPI,aAAf;;AASA,gBAAI,CAAJ,KAAIhvC,CAAC,CAAC4c,IAAF,MAAM,IAAN,IAAM,aAAN,GAAM,MAAN,GAAM,GAAEqT,QAAZ,EAAsB;AACpB;AACA,kBAAMwiD,SAAS,GAAGzyE,CAAC,CAAC8D,OAAF,CAAUjK,KAAV,CAAgB,GAAhB,CAAlB;AACA,kBAAME,MAAM,GAAG04E,SAAS,CAAC14E,MAAzB;;AACA,kBAAIA,MAAJ,EAAY;AACVy4E,wBAAQ,CAACniC,UAAT,GAAsBoiC,SAAS,CAAC,CAAD,CAA/B;AACAD,wBAAQ,CAAC5+E,IAAT,GAAgB6+E,SAAS,CAACvxE,IAAV,CAAe,GAAf,CAAhB;AACD;;AACD,kBAAInH,MAAM,GAAG,CAAb,EAAgB;AACd04E,yBAAS,CAACjjD,KAAV;AACAgjD,wBAAQ,CAACliC,SAAT,GAAqBmiC,SAAS,CAACvxE,IAAV,CAAe,GAAf,CAArB;AACD;;AACDsxE,sBAAQ,CAACvpE,KAAT,GAAiB,CAAH,KAAGjJ,CAAC,CAACjF,KAAF,MAAO,IAAP,IAAO,aAAP,GAAO,EAAP,aAAc5C,IAAI,CAACY,KAAL,CAAWZ,IAAI,CAACuJ,MAAL,KAAgB,KAA3B,CAAd,wBAAjB;AACA8wE,sBAAQ,CAAC11E,IAAT,GAAgB,UAAhB,CAboB,CAaQ;;AAC5B01E,sBAAQ,CAACviD,QAAT,GAAoB,IAApB;AACAuiD,sBAAQ,CAACxjC,OAAT,GAAmB,IAAnB;AACD;;AAAE,gBAAI,CAAJ,KAAIhvC,CAAC,CAAC4c,IAAF,MAAM,IAAN,IAAM,aAAN,GAAM,MAAN,GAAM,GAAEnM,IAAZ,EAAkB;AACnB+hE,sBAAQ,GAAGxyE,CAAC,CAAC4c,IAAF,CAAOnM,IAAlB;AACD,aAFE,MAGE;AACH+hE,sBAAQ,GAAGxyE,CAAX;AACD;;AACD,mBAAO,IAAI,cAAA6rB,IAAJ,CAAS2mD,QAAT,CAAP;AACD,WAjCwB,CAAzB;AAkCD;;;sCAEoBE,S,EAAkB;AACrC,iBAAO,CAACA,SAAD,GAAa,EAAb,GAAkBA,SAAS,CAACh1E,GAAV,CAAc,UAAAsC,CAAC,EAAI;AAC1C,mBAAOA,CAAC,CAACjF,KAAT;AACD,WAFwB,CAAzB;AAGD;AAED;;;;;;sCAGqB;AACnB,eAAK+V,OAAL,GAAe,IAAf;AACA,cAAM8gE,iBAAiB,GAAG,KAAKxjE,IAAL,CAAUrT,KAApC,CAFmB,CAGnB;AACD;;;mCAEiB,CAChB;AACD;;;6CAkB2B43E,M,EAAgB;AAAA;;AAC1C,eAAKC,cAAL,GAAsBD,MAAtB;AACA,eAAKP,iBAAL,GAAyB,IAAzB;AACA,eAAK57E,OAAL,CAAa,cAAb,EAA6B,YAAM;AACjC,oBAAI,CAAC47E,iBAAL,GAAyB,KAAzB;AACD,WAFD,EAEG,KAFH;AAGD;;;4CAE0B;AACvB,eAAKA,iBAAL,GAAwB,KAAxB;AACH;;;yCAEuB;AACtB,eAAK7jE,KAAL,CAAW4hE,QAAX,CAAoB,cAAAjkE,oBAAA,EAApB;AACA,eAAK+lE,aAAL,CAAmB15B,IAAnB,CAAwB,IAAxB;AACD;;;uCAIcq5B,iB,EAAoC;;;AACjD,0BAAGA,iBAAiB,CAACzlD,SAArB,MAA8B,IAA9B,IAA8B,aAA9B,GAA8B,MAA9B,GAA8B,GAAEvP,IAAhC,MAAoC,IAApC,IAAoC,aAApC,GAAoC,MAApC,GAAoC,GAAEnM,IAAtC,EAA2C;AACvC,mBAAO,CAAP,WAAOmhE,iBAAiB,CAACzlD,SAAzB,MAAkC,IAAlC,IAAkC,aAAlC,GAAkC,MAAlC,GAAkC,GAAEvP,IAA7B,MAAiC,IAAjC,IAAiC,aAAjC,GAAiC,MAAjC,GAAiC,GAAEnM,IAA1C;AACH,WAFD,MAGI;AACAmhE,6BAAiB,CAACzlD,SAAlB,GAA8B,MAAH,OAAG,CAAH,kBAAOylD,iBAAiB,CAACzlD,SAAzB,CAAG,EAA+B;AAAEvP,kBAAI,EAAE;AAACnM,oBAAI,EAAE,KAAK0J;AAAZ;AAAR,aAA/B,CAA9B;AACA,mBAAO,CAAP,KAAOy3D,iBAAiB,CAACzlD,SAAlB,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAEvP,IAAF,CAAOnM,IAAzC;AACH;AACF;;;6CAE2BoiE,W,EAA0C;AAAA,cAA7BxB,YAA6B,uEAAL,KAAK;;;;AACpE,cAAIO,iBAAiB,GAAGiB,WAAxB;AACA,cAAM56B,eAAe,GAAG25B,iBAAiB,CAACtlD,KAAlB,KAAuB,MAAIslD,iBAAiB,CAACtlD,KAAtB,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAEvyB,MAApD,wBAA+D63E,iBAAiB,CAACJ,YAAlB,CAA+Bz2D,KAA/B,CAAqC9R,KAApG,EAA4G,GAA5G,IAAmH,EAA3I,CAFoE,CAE2E;;AAC/I,cAAMijB,SAAS,GAAG,KAAK4lD,eAAL,CAAqBF,iBAAiB,CAAC1lD,SAAvC,CAAlB;AACA,cAAMS,OAAO,GAAG,KAAKolD,aAAL,CAAmBH,iBAAiB,CAACjlD,OAArC,CAAhB;AACA,cAAMhjB,WAAW,GAAG,CAAH,KAAGioE,iBAAiB,SAAjB,IAAAA,iBAAiB,WAAjB,GAAiB,MAAjB,GAAAA,iBAAiB,CAAEp5E,MAAnB,MAAyB,IAAzB,IAAyB,aAAzB,GAAyB,MAAzB,GAAyB,GAAE+Q,OAA/C;AACA,cAAMF,SAAS,GAAGuoE,iBAAiB,CAACp5E,MAAlB,CAAyBE,QAAzB,CAAkC;AAAEJ,mBAAO,EAAEs5E,iBAAiB,CAACh5E;AAA7B,WAAlC,EAA2E2Q,OAA7F;AAEA,cAAMkK,QAAQ,GAAG;AACb3J,cAAE,EAAEunE,YAAY,GAAGO,iBAAiB,CAAC9nE,EAArB,GAA0B,EAD7B;AAEbyjB,mBAAO,EAAEqkD,iBAAiB,CAACrkD,OAAlB,IAA6B,KAFzB;AAGbrB,qBAAS,EAATA,SAHa;AAIbD,wBAAY,EAAE2lD,iBAAiB,CAAC31D,WAAlB,CAA8BlhB,KAJ/B;AAKb4yB,oBAAQ,EAAEikD,iBAAiB,CAACjkD,QAAlB,IAA8B,EAL3B;AAMbhkB,uBAAW,EAAXA,WANa;AAObN,qBAAS,EAATA,SAPa;AAQb5M,oBAAQ,EAAEm1E,iBAAiB,CAACn1E,QARf;AASb8vB,2BAAe,sBAAIqlD,iBAAiB,CAACJ,YAAlB,CAA+Bz2D,KAA/B,CAAqC9R,KAAzC,EAAiD2oE,iBAAiB,CAAChwD,IAAnE,CATF;AAUb4K,8BAAkB,sBAAIolD,iBAAiB,CAACJ,YAAlB,CAA+Bz2D,KAA/B,CAAqC9R,KAAzC,EAAiD2oE,iBAAiB,CAACvzB,UAAnE,CAVL;AAWbjiC,wBAAY,EAAEw1D,iBAAiB,CAACx1D,YAAlB,IAAkC,KAXnC;AAYb2W,uBAAW,EAAE6+C,iBAAiB,CAAC7+C,WAAlB,IAAiC,KAZjC;AAab5G,qBAAS,EAAE,KAAK2mD,cAAL,CAAoBlB,iBAApB,CAbE;AAcbtlD,iBAAK,EAAE,KAAKymD,UAAL,CAAgBnB,iBAAiB,CAACtlD,KAAlC,EAAyCslD,iBAAiB,CAACJ,YAAlB,CAA+Bz2D,KAA/B,CAAqC9R,KAA9E,CAdM;AAebmjB,mBAAO,EAAEwlD,iBAAiB,CAACxlD,OAfd;AAgBb5B,gBAAI,EAAEonD,iBAAiB,CAACJ,YAAlB,CAA+Bz2D,KAhBxB;AAiBbyJ,iBAAK,EAAEotD,iBAAiB,CAACptD,KAjBZ;AAkBbjS,iBAAK,EAAE0lC,eAlBM;AAmBbxyB,qBAAS,EAAEwyB,eAnBE;AAoBbtrB,mBAAO,EAAPA,OApBa;;AAqBb;AACAvO,wBAAY,EAAEwzD,iBAAiB,CAACxzD,YAtBnB;AAuBbI,4BAAgB,EAAEozD,iBAAiB,CAACpzD,gBAvBvB;AAwBbG,2BAAe,EAAEizD,iBAAiB,CAACjzD,eAxBtB;AAyBbJ,4BAAgB,EAAEqzD,iBAAiB,CAACrzD,gBAzBvB;AA0BbG,iCAAqB,EAAEkzD,iBAAiB,CAAClzD,qBA1B5B;AA2BbJ,+BAAmB,EAAEszD,iBAAiB,CAACtzD,mBA3B1B;AA4BbD,6BAAiB,EAAEuzD,iBAAiB,CAACvzD,iBA5BxB;AA6BbI,6BAAiB,EAAEmzD,iBAAiB,CAACnzD,iBA7BxB;AA+Bb0P,8BAAkB,EAAEyjD,iBAAiB,CAACzjD,kBA/BzB;AAgCb;AACA;AACAxI,2BAAe,EAAEisD,iBAAiB,CAACjsD,eAAlB,IAAqC,IAlCzC;AAmCbQ,gCAAoB,EAAEyrD,iBAAiB,CAACzrD,oBAnC3B;AAoCb2H,iBAAK,EAAE8jD,iBAAiB,SAAjB,IAAAA,iBAAiB,WAAjB,GAAiB,MAAjB,GAAAA,iBAAiB,CAAE9jD,KApCb;AAqCblP,kBAAM,EAAEgzD,iBAAiB,SAAjB,IAAAA,iBAAiB,WAAjB,GAAiB,MAAjB,GAAAA,iBAAiB,CAAEhzD,MArCd;AAuCbmO,mBAAO,EAAE8lD,WAAW,CAAC9lD;AAvCR,WAAjB;AA4CA,iBAAO,IAAI,cAAAxQ,OAAJ,CAAY9I,QAAZ,CAAP;AACD;;;qDAGyCuS,G,EAAK;;;;;;;AAE7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA,yBAAKxZ,OAAL,GAAe,IAAI,cAAA+P,OAAJ,CAAY,MAAD,OAAC,CAAD,kBAAM,KAAK/P,OAAX,CAAC,EAAsBwZ,GAAG,CAACyR,SAAJ,EAAtB,CAAZ,CAAf;AACA,yBAAKg5C,qBAAL;;AACA,yBAAK35B,sBAAL,CAA4Bh2C,OAA5B,CAAoC,KAAK0L,OAAzC;AAEA;;;;;0BAGG,KAAKA,OAAL,CAAa2Z,oBAAb,KAAsC,IAAtC,IAA8C,KAAKkrD,Y;;;;;;AAE3B,2BAAM,KAAKV,iBAAL,CAAuB7lD,IAAvB,CAA4B,KAAKte,OAAL,CAAa2Z,oBAAzC,CAAN;;;AAAjBgyB,kC;;AACN,yBAAKrB,sBAAL,CAA4Bh2C,OAA5B,CAAoCq3C,cAApC;;;AAGJ;AACA,yBAAK5pC,KAAL,CAAW4hE,QAAX,CAAoB,cAAAjkE,oBAAA,EAApB;AAEA,yBAAK4E,OAAL,GAAe,KAAf;AACA,yBAAK7D,OAAL,GAAe,IAAf;AACA,yBAAK6iE,SAAL,GAAiB,IAAjB,C,CAEA;;AACA,yBAAK/7D,QAAL,CAAcvF,SAAd,CAAwBwkE,KAAxB,CAA8B,QAA9B,EAAwC;AACtCp7C,gCAAU,EAAE,KAAKprB,OAAL,CAAa1C,EADa;AAEtC2c,4BAAM,EAAE,KAAKja,OAAL,CAAage,IAAb,CAAkBtP,QAAlB,CAA2BtnB,IAFG;AAGtC42B,0BAAI,EAAE,KAAKhe,OAAL,CAAage,IAAb,CAAkBkd,WAHc;AAItC7hB,gCAAU,EAAE,KAAKrZ,OAAL,CAAa/J,WAAb,CAAyBjB,EAJC;AAKtCskB,8BAAQ,EAAE,KAAKtZ,OAAL,CAAa9J,SAAb,CAAuBlB,EALK;AAMtCmsB,8BAAQ,EAAE,CAAC,CAAC,KAAKnhB,OAAL,CAAamhB,QAAb,CAAsB5zB,MANI;AAOtCk5E,+BAAS,EAAE,KAAK7kE,IAAL,CAAUrT,KAAV,CAAgBsjD;AAPW,qBAAxC;;;;;;;;;AAUD;;;oDAGkC;AACjC,eAAKvtC,OAAL,GAAe,KAAf;AACA,eAAKtE,OAAL,CAAa6P,MAAb,GAAsB,cAAAuU,cAAA,CAAe8/C,WAArC;;AACA,eAAK55B,sBAAL,CAA4Bh2C,OAA5B,CAAoC,KAAK0L,OAAzC;;AACA,eAAKsjE,SAAL,GAAiB,IAAjB;AACA,eAAK7iE,OAAL,GAAe,KAAf;AACA,eAAKwjE,qBAAL;AACD;AAED;;;;;;;;gDAK+B;AAE7B;AACA,eAAKyC,mBAAL,GAA2B;AACzB1mE,mBAAO,EAAE,KAAKA,OADW;AAEzB6P,kBAAM,EAAE,KAAKA,MAFY;AAGzB82D,sBAAU,EAAE,KAAKA,UAHQ;AAIzBC,yBAAa,EAAE,KAAKA,aAJK;AAKzBC,sBAAU,EAAE,KAAKA,UALQ;AAMzBC,0BAAc,EAAE,KAAKA,cANI;AAOzBx2E,gBAAI,EAAE,KAAKA,IAPc;AAQzBu0E,wBAAY,EAAE,KAAKA,YARM;AAS1B;AACCkC,oCAAwB,EAAE,KAAKA,wBAAL,CAA8BrR,IAA9B,CAAmC,IAAnC,CAVD;AAWzB;AACAsR,wCAA4B,EAAE,KAAKA,4BAAL,CAAkCtR,IAAlC,CAAuC,IAAvC;AAZL,WAA3B;AAcD;AAED;;;;;;;;;;;;mDASkC;;;AAChC,cAAMppB,SAAS,GAAG,sBAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMtsC,OAAN,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEge,IAAf,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAEipD,gBAArB,KAAqC,YAAG,SAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMjnE,OAAT,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEge,IAAlB,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAEkpD,oBAA7D,CAAlB;AACA,iBAAO;AAAEC,uBAAW,EAAE,CAAC,CAAC76B,SAAjB;AAA4B86B,2BAAe,EAAE96B;AAA7C,WAAP;AACD;AAGH;;;;;;;;;;;AA8BC;;;;;;;;;;;qDAWqCtuB,I,EAAa;AAAA;;AAAA,cACxC9L,qBADwC,GACd,KAAKtQ,IAAL,CAAUrT,KADI,CACxC2jB,qBADwC;AAG/C,cAAMm1D,UAAU,GAAG,KAAK3B,MAAL,CAAYriE,IAAZ,CACU,KAAA8oC,uBADV,EACmC;AACpDC,oBAAQ,EAAE,MAD0C;AAEpDC,iBAAK,EAAE,MAF6C;AAGpDzqC,gBAAI,EAAE;AACJi5B,uBAAS,EAAE7c,IAAI,CAACkd,WADZ;AAEJoR,uBAAS,EAAEp6B,qBAFP;AAGJjiB,sBAAQ,EAAE+tB,IAAI,CAACtP,QAAL,CAAcze;AAHpB;AAH8C,WADnC,CAAnB;AAUA,eAAK7G,YAAL,CACE,wBADF,EAEEi+E,UAAU,CAAC76B,iBAAX,CAA6BzzC,KAA7B,CAAmCzP,SAAnC,CAA6C,UAACyP,KAAD,EAAwB;AACjEsuE,sBAAU,CAAC53C,KAAX;AACH,WAFD,CAFF;AAMA43C,oBAAU,CAACz6B,WAAX,GAAyBtjD,SAAzB,CAAmC;AAAA,mBAAM,QAAI,CAACnC,KAAL,CAAW,wBAAX,CAAN;AAAA,WAAnC;AACD;;;4BA5ZkB;AACjB,iBAAO,KAAK6Y,OAAL,CAAage,IAAb,CAAkBtP,QAAzB;AACD;;;4BAEiB;AAChB,iBAAO,KAAK1O,OAAL,CAAasnE,gBAApB;AACD;;;4BAEmC;AAClC,iBAAO,KAAKtnE,OAAL,CAAage,IAAb,CAAkBlrB,OAAlB,CAA0B2wB,QAA1B,KAAuC,IAAvC,GAA6C,UAA7C,GAA0D,UAAjE;AACD;;;4BAEc;AACb;AACA,iBAAO,KAAKzjB,OAAL,CAAa/J,WAApB;AACD;;;4BAEuB;AACtB,iBAAO,KAAK+J,OAAL,CAAa/J,WAAb,CAAyBtJ,UAAzB,CAAoC,gBAApC,CAAP,CADsB,CACwC;AAE/D;;;4BAEuB;;;AACtB,iBAAO,OAAAwJ,gCAAA,CAAiC,KAAK6J,OAAL,CAAa/J,WAA9C,EAA2D,CAAF,KAAE,KAAK+J,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAEwjB,gBAAzE,CAAP;AACD;;;4BAE2B;;;AAC1B,iBAAO,OAAAnxB,gBAAA,CAAiB,CAAD,KAAC,KAAK2N,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAE5T,QAA/B,CAAP;AACD;;;4BAEmB;AAClB,iBAAO,cAAAyrB,oBAAA,CAAqB,KAAK7X,OAA1B,CAAP;AACD;;;4BAwHoB;;;AACnB,cAAM4B,IAAI,GAAG,KAAKA,IAAL,CAAUrT,KAAvB;AAEA;;AACA,cAAI,QAACqT,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEojE,YAAP,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAEz2D,KAArB,CAAJ,EAAgC;AAC5B,mBAAO,KAAP;AACH;;AAED,cAAMA,KAAK,GAAG,IAAI,cAAAC,KAAJ,CAAU5M,IAAI,CAACojE,YAAL,CAAkBz2D,KAA5B,CAAd;AACA,iBAAOA,KAAK,CAAC2U,SAAN,CAAgB;AACnBl3B,kBAAM,EAAE4V,IAAI,CAAC5V,MADM;AAEnBI,oBAAQ,EAAEwV,IAAI,CAACxV,QAFI;AAGnBuY,gBAAI,EAAE,KAAKgJ;AAHQ,WAAhB,CAAP;AAKD;;;4BAgMuB;AACtB;AACA,cAAI45D,eAAe,GAAiB,EAApC;AAFsB,+BAGmD,KAAKvnE,OAHxD;AAAA,cAGd4R,YAHc,kBAGdA,YAHc;AAAA,cAGAK,iBAHA,kBAGAA,iBAHA;AAAA,cAGmB0P,kBAHnB,kBAGmBA,kBAHnB;AAAA,cAGuC1xB,QAHvC,kBAGuCA,QAHvC;;AAItB,cAAG2hB,YAAY,IAAIK,iBAAiB,CAAC1kB,MAArC,EAA6C;AAC3Cg6E,2BAAe,GAAG,KAAKvnE,OAAL,CAAaiS,iBAA/B;AACD,WAFD,MAGK,IAAGL,YAAY,IAAI,CAACK,iBAAiB,CAAC1kB,MAAnC,KAA6Co0B,kBAAkB,SAAlB,IAAAA,kBAAkB,WAAlB,GAAkB,MAAlB,GAAAA,kBAAkB,CAAEp0B,MAAjE,CAAH,EAA4E;AAC/E,iBAAKyS,OAAL,CAAa2hB,kBAAb,CAAgCl4B,OAAhC,CAAwC,UAAAR,OAAO,EAAI;AACjDs+E,6BAAe,CAACr0E,IAAhB,CAAqB,IAAI,UAAAqJ,MAAJ,CAAW;AAAElR,oBAAI,EAAEpC,OAAO,CAACkU,WAAR,GAAsB,IAA9B;AAAoCuV,2BAAW,EAAE,KAAjD;AAAwDC,2BAAW,EAAE1iB;AAArE,eAAX,CAArB;AACD,aAFD;AAGAs3E,2BAAe,GAAGA,eAAe,CAACh0E,IAAhB,CAAqB,UAAC20B,EAAD,EAAaC,EAAb;AAAA,qBAA4BD,EAAE,CAAClzB,EAAH,GAAQmzB,EAAE,CAACnzB,EAAvC;AAAA,aAArB,CAAlB;AACD,WALI,MAMA;AACHuyE,2BAAe,GAAG,CAAC,KAAKvnE,OAAL,CAAa/J,WAAd,CAAlB;AACD,WAfqB,CAkBtB;AACA;;;AACA,iBAAO,cAAAqgC,mBAAA,CAAoBixC,eAApB,EAAqC56E,UAArC,CAAgD,gBAAhD,CAAP,CApBsB,CAoBoD;AAC3E;;;;MApb2C,OAAA7E,a;;AAL9C;;;uBAKay8E,wB,EAAwB,2C,EAAA,8B,EAAA,+B,EAAA,wC,EAAA,4C,EAAA,sC,EAAA,6C,EAAA,kC,EAAA,qC;AAAA,K;;;YAAxBA,wB;AAAwB,uC;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,e;AAAA,c;AAAA,mqC;AAAA;AAAA;AHxErC;AACI;AAKA;AACE;AAOA;AAKF;AACF;AACI;AACI;AACI;AACI;AACI;AAAI;AAAmC;AACvC;AACI;AACI;AAGI;AAAA,mBAAc,IAAAC,UAAA,QAAd;AAAgC,WAAhC,EAAiC,cAAjC,EAAiC;AAAA,mBACjB,IAAAC,YAAA,QADiB;AACG,WADpC;AAEH;AACL;AACJ;AACA;AACI;AACI;AAAI;AAAsE;AAC1E;AAKf;AAUe;AACI;AAAK;AACiB;AACtB;AAAK;AAAoC;AACzC;AAAK;AAAsC;AAC/C;AACJ;AACJ;AACJ;AACJ;AACJ;AACJ;AACJ;AACA;AACI;AACI;AAIA;AAIJ;AACJ;AACA;AAMI;AAAA,mBAAY,IAAAvZ,QAAA,EAAZ;AAAsB,WAAtB;AACH;AACH;;;;AAvFkG;AAC5D;AAAA;AAO5B;AAAA;AAOA;AAAA;AAUgB;AAAA;AAIQ;AAAA,gDAAmB,eAAnB,EAAmB,mBAAnB;AASA;AAAA;AACC;AAAA;AAKd;AAAA;AAWkB;AAAA;AAEA;AAAA;AACA;AAAA;AAWxB;AAAA;AAIA;AAAA;AAOT;AAAA,oDAAuB,SAAvB,EAAuB,WAAvB,EAAuB,OAAvB,EAAuB,SAAvB,EAAuB,qBAAvB,EAAuB,uBAAvB;;;;;;;;;;2BGROqZ,wB,EAAwB;cALpC,OAAAr3B,SAKoC;eAL1B;AACTjlD,kBAAQ,EAAE,kBADD;AAETklD,qBAAW,EAAE,oCAFJ;AAGTC,mBAAS,EAAE,CAAC,iCAAD;AAHF,S;AAK0B,Q;;;;;;;;;;;;;;;;;;;;;;gBAQlC,OAAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChFH;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AA+BA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQY;AAAmD;AAAM;;;;;;;;AACzD;AACI;AACA;AAAuB;AAAsD;AAC7E;AAAsC;AAAA;AAAA;AAAA;AAAA;AAAtC;AACJ;;;;;;;;AACA;AACI;AACA;AAAuB;AAAoB;AAC3C;AAAqC;AAAA;AAAA;AAAA;AAAA;AAArC;AACJ;;;;;AAF2B;AAAA;;;;;;AAeC;;;;;AAAA;;;;;;AAGA;;;;;AAAA;;;;;;AAGA;;;;;AAAA;;;;;;AAOQ;AAAmD;AAAiD;;;;;AAAjD;AAAA;;;;;;AAH3D;AACI;AACA;AACI;AACJ;AACJ;;;;;AAFa;AAAA;;;;;;;;AAJb;AAA6D;AAAkC;AAAA;AAAA;AAAA;AAAA;AAAgC;AAAc;AAAQ;AACrJ;;;;;AADqJ;AAAA;AACnI;AAAA;;;;;;;;AAW5C;AAGE;AAAA;AAAA;AAAA;AAAA;AAEgB;AACjB;;;;;AAFC;;;;;;;;AAGY;AAEZ;AAAA;AAAA;AAAA;AAAA,oBAAiC;AAAjC;AAAqC,SAArC;AACA;AACF;;;;;;AACA;;;;;;AA3CM;AACI;AACG;AACK;AACA;AAAgC;AAA2C;AAChF;AACA;AACK;AACA;AACI;AAGA;AAGA;AAGA;AASJ;AACL;AACH;AACA;AACV;AAOc;AAKd;AACU;AACJ;;;;;AA1CiB;AAAA;AAC2B;AAAA;AAIH;AAAA;AACZ;AAAA;AAGA;AAAA;AAGA;AAAA;AAiBjC;AAAA;AAMoB;AAAA;AAKD;AAAA;;;;;;AAIf;AACI;AACI;AAAG;AAA4B;AAAsC;AACnF;AAAQ;AAAe;AACb;AACJ;;;;;AALoB;AAEJ;AAAA;AAAuB;AAAA;AACrC;AAAA;;;;;;AAUF;AACI;AACI;AACJ;AACJ;;;;;;AAKQ;AAAqB;AAA8B;;;;;AAA9B;AAAA;;;;;;AACrB;AACI;AAGJ;;;;;;AAII;AAMA;AAAsB;;;;;AAFlB;;;;;;AAGJ;;;;;;;;AAMA;AAGI;AAAA;AAAA;AAAA;AAAA;AAEA;AAAc;;;;;;AAClB;;;;;;;;AAmCI;AACI;AAGI;AAAA;AAAA;AAAA;AAAA;AAHJ;AAKJ;;;;;;;;AAhCR;AACI;AACI;AACA;AACJ;AACA;AACI;AAAoB;AACpB;AAAoB;AACpB;AACJ;AAEA;AAGI;AAAA;AAAA;AAAA;AAAA;AAEA;AACJ;AAEA;AACI;AAAyB;AACzB;AAAkB;AAClB;AACJ;AAEA;AACI;AAQA;AASI;AAAA;AAAA;AAAA,qCAA4B,KAA5B;AAAiC,SAAjC;AACH;AACL;AAEA;AAGI;AAAA;AAAA;AAAA;AAAA;AAEA;AACJ;AACJ;;;;;AAnDQ;AAAA;AAGA;AAAA;AACA;AAAA;AACA;AAAA;AAKA;AAAA;AAOA;AAAA;AACA;AAAA;AACA;AAAA;AAIK;AAAA;AAUD;AAAA,gDAAiB,OAAjB,EAAiB,mBAAjB,EAAiB,UAAjB,EAAiB,wBAAjB,EAAiB,UAAjB,EAAiB,mCAAjB,EAAiB,OAAjB,EAAiB,gCAAjB,EAAiB,OAAjB,EAAiB,0BAAjB,EAAiB,MAAjB,EAAiB,8BAAjB;AAaJ;AAAA;AAGA;AAAA;;;;;;AAGR;AACI;AACI;AACJ;AACA;AACI;AACA;AACA;AACJ;AACA;AACA;AACA;AACI;AACA;AACA;AACJ;AACA;AACA;AACJ;;;;;;AAUI;AAAyB;AAAQ;AAAQ;AAAU;AAAiB;;;;;AAAjB;AAAA;;;;;;AAI3E;AAAmB;AAAsD;;;;;;;;AAUrD;AACI;AACI;AACA;AACJ;AACA;AAAI;AAAgC;AACpC;AAGI;AAAA;AAAA;AAAA;AAAA;AAEA;AACJ;AAEA;AACJ;;;;;AAPQ;AAAA;AAMkB;AAAA;;;;;;;;AApC9B;AACI;AACI;AACI;AACA;AACJ;AACA;AAAG;AAAQ;AAAK;AAAU;AAAQ;AAClC;AAAG;AAAQ;AAAU;AAAU;AAAmB;AAClD;AACA;AAAG;AAAQ;AAAY;AAAU;AAAc;AAC/C;AAAG;AAAQ;AAAmB;AAAU;AAAa;AACrD;AAAG;AAAQ;AAAwB;AAAU;AAAgB;AACrF;AAEwB;AAGI;AAAA;AAAA;AAAA;AAAA;AAEA;AACJ;AACJ;AACA;AAgBJ;;;;;AAhCkC;AAAA;AACK;AAAA;AAC5B;AAAA;AAC8B;AAAA;AACO;AAAA;AACK;AAAA;AAClE;AAAA;AAIyB;AAAA;AAMH;AAAA;;;;;;AA6BL;AACI;AACI;AACJ;AACA;AACI;AACJ;AACA;AACJ;;;;;;AApBJ;AACI;AACI;AACI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACJ;AACA;AASJ;;;;;AATS;AAAA;;;;;;;;AAa3B;AAGC;AAAA;AAAA;AAAA;AAAA;AACD;;;;;;AACA;;;;;;AAPI;AACL;AACC;AAKA;AACD;AACD;;;;;AANG;AAAA;AAIoB;AAAA;;;;;;;;AAUnB;AAaI;AAAA;AAAA;AAAA,qCAA4B,IAA5B;AAAgC,SAAhC,EAAkC,wBAAlC,EAAkC;AAAA;AAAA;AAAA;AAAA,SAAlC,EAAkC,gBAAlC,EAAkC;AAAA;AAAA;AAAA;AAAA,SAAlC;AAGH;;;;;AAdG,yIAAsC,4BAAtC,EAAsC,kCAAtC,EAAsC,UAAtC,EAAsC,oGAAtC,EAAsC,gBAAtC,EAAsC,qBAAtC,EAAsC,UAAtC,EAAsC,yBAAtC,EAAsC,WAAtC,EAAsC,8FAAtC,EAAsC,UAAtC,EAAsC,mCAAtC,EAAsC,OAAtC,EAAsC,oJAAtC,EAAsC,OAAtC,EAAsC,iGAAtC,EAAsC,UAAtC,EAAsC,4BAAtC,EAAsC,aAAtC,EAAsC,mBAAtC;;;;;;;;AAiBA;AAGI;AAAA;AAAA;AAAA;AAAA,WAA0C,gBAA1C,EAA0C;AAAA;AAAA;AAAA;AAAA,SAA1C;AAEH;;;;;AAHG;;;;;;AAIJ;;;;;;AAPJ;AACI;AAMA;AACJ;;;;;AANQ;AAAA;AAKiB;AAAA;;;;;;;;AAEzB;AACI;AAII;AAAA;AAAA;AAAA;AAAA,WAAyC,cAAzC,EAAyC;AAAA;AAAA;AAAA;AAAA,SAAzC;AAEH;AACL;;;;;AANQ;AAAA,4CAAa,aAAb,EAAa,IAAb,EAAa,SAAb,EAAa,oDAAb;;;;AApThB,QAAM/S,WAAW,GAAG,EAApB;;QA8TaktC,4B;;;;;AA2EZ,4CACUpL,MADV,EAEel3D,KAFf,EAGiC2uB,KAHjC,EAISrE,SAJT,EAKSztB,KALT,EAMQ2Y,SANR,EAOSnT,QAPT,EAQS8S,OART,EASSqrD,MATT,EAS0B;AAAA;;AAAA;;AAEzB;AAVS,iBAAAtJ,MAAA,GAAAA,MAAA;AACK,iBAAAl3D,KAAA,GAAAA,KAAA;AACkB,iBAAA2uB,KAAA,GAAAA,KAAA;AACxB,iBAAArE,SAAA,GAAAA,SAAA;AACA,iBAAAztB,KAAA,GAAAA,KAAA;AACD,iBAAA2Y,SAAA,GAAAA,SAAA;AACC,iBAAAnT,QAAA,GAAAA,QAAA;AACA,iBAAA8S,OAAA,GAAAA,OAAA;AACA,iBAAAqrD,MAAA,GAAAA,MAAA;AAnFF,iBAAAlK,gBAAA,GAAmB,0BAAAA,gBAAnB;AAQA,iBAAA6H,UAAA,GAAqB,EAArB;AAcA,iBAAAoE,gBAAA,GAAmB,KAAnB;AACA,iBAAAC,kBAAA,GAAqB,KAArB;AAOA,iBAAA9lE,IAAA,GAAO,IAAI,OAAA9a,eAAJ,CAAiDwG,SAAjD,CAAP;AACA,iBAAAq6E,WAAA,GAAc,IAAI,OAAA7gF,eAAJ,CAAqCwG,SAArC,CAAd;AAMA,iBAAAs6E,oBAAA,GAAgC,KAAhC,CA8CmB,CA7C1B;;AACO,iBAAA1iC,MAAA,GAAkB,KAAlB;AACA,iBAAA5gC,OAAA,GAAmB,KAAnB;AACA,iBAAAujE,cAAA,GAA0B,KAA1B;AACA,iBAAAjC,iBAAA,GAA6B,KAA7B;AACA,iBAAAkC,YAAA,GAAwB,KAAxB;AAaP,iBAAAC,uBAAA,GAAmC,KAAnC;AAWO,iBAAAC,mBAAA,GAA+B,KAA/B;AACA,iBAAAC,qBAAA,GAAiC,KAAjC;AACA,iBAAAC,0BAAA,GAAsC,KAAtC;AAEC,iBAAAC,eAAA,GAAkB,KAAlB;AAeP,iBAAKC,YAAL,GAAoB,SAAKv0C,KAAL,CAAW7zB,OAAX,CAAmBge,IAAnB,CAAwBqqD,eAA5C;;AACA,iBAAKC,iBAAL,CAAuB,SAAKz0C,KAAL,CAAW7zB,OAAlC;;AACA,iBAAKhW,OAAL,CAAa,UAAb,EAAyB,YAAM;AAC9B,mBAAKs+E,iBAAL,CAAuB,SAAKz0C,KAAL,CAAW7zB,OAAlC;;AACA,cAAI,SAAK6zB,KAAL,CAAW6d,MAAX,IAAqB,SAAK62B,kBAAL,EAAzB,EAAoD;AACnD,qBAAKC,aAAL;AACA;;AACD,cAAI,SAAK30C,KAAL,CAAW40C,WAAX,IAA0B,SAAKC,eAAnC,EAAoD;AACnD,qBAAKD,WAAL;AACA,WAP6B,CAQ9B;;;AACA,mBAAKz+E,OAAL,CAAa,iBAAb,EAAgC,YAAM;AACrC,qBAAK6pC,KAAL,CAAW80C,YAAX,GAA0B,KAA1B;AACA,WAFD,EAEG,GAFH;AAGA,SAZD,EAYG,IAZH;;AALyB;AAkBzB;AA3CD;;;;;mCA8CkB;AAAA;;;AAEjB;;;;;;;;;;;AASA,cAAG,YAAK90C,KAAL,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAE8X,cAAZ,MAA+B,IAAlC,EAAwC;AACvC,iBAAK95B,iBAAL,GAAyB,CAAH,WAAG,KAAKgiB,KAAR,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAE8X,cAAZ,MAA0B,IAA1B,IAA0B,aAA1B,GAA0B,MAA1B,GAA0B,GAAE95B,iBAArD;AACA,iBAAKC,mBAAL,GAA2B,CAAH,WAAG,KAAK+hB,KAAR,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAE8X,cAAZ,MAA0B,IAA1B,IAA0B,aAA1B,GAA0B,MAA1B,GAA0B,GAAE75B,mBAAvD;AAEA,iBAAK6P,kBAAL,GAA0B,kBAAKkS,KAAL,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAE8X,cAAZ,MAA0B,IAA1B,IAA0B,aAA1B,GAA0B,MAA1B,GAA0B,GAAEhqB,kBAA5B,MAA8C,YAAI,KAAKkS,KAAT,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAE8X,cAAhB,MAA8B,IAA9B,IAA8B,aAA9B,GAA8B,MAA9B,GAA8B,GAAEhqB,kBAAF,CACpG1vB,MADoG,CAC7F,UAAA22E,SAAS;AAAA,qBAAIA,SAAS,CAACtrE,EAAV,KAAiB,QAAI,CAACu2B,KAAL,CAAW8X,cAAX,CAA0BruC,EAA/C;AAAA,aADoF,EAEpGpM,GAFoG,CAEhG,UAAA03E,SAAS;AAAA,qBAAK,MAAD,OAAC,CAAD,kBACdA,SADc,CAAC,EACN;AACZzrE,2BAAW,EAAEyrE,SAAS,CAACzrE,WAAV,GAAwB,IADzB;AAEZnR,sBAAM,EAAE,IAAI,UAAAuQ,MAAJ,CAAW;AAClBlR,sBAAI,EAAEu9E,SAAS,CAACzrE,WAAV,GAAwB,IADZ;AAElBuV,6BAAW,EAAE,KAFK;AAGlBC,6BAAW,EAAE,QAAI,CAACkhB,KAAL,CAAW8X,cAAX,CAA0B17C;AAHrB,iBAAX;AAFI,eADM,CAAL;AAAA,aAFuF,CAA5E,CAA1B;AAYA;;AAGD,eAAK7G,YAAL,CAAkB,aAAlB,EAAiC,KAAK2Y,KAAL,CAAWgC,MAAX,CAAkB,OAAAC,iBAAlB,EAC/B7H,IAD+B,CAC1B,YAAA+H,IAAA,CAAK,CAAL,CAD0B,EAE/B5a,SAF+B,CAErB,UAAC2a,IAAD,EAA4B;AACtC;AACA,oBAAI,CAAC0J,WAAL,GAAmB,IAAI,cAAA0R,IAAJ,CAASpb,IAAT,CAAnB;AACA,WAL+B,CAAjC;AAQA,eAAK7a,YAAL,CAAkB,MAAlB,EAA0B,KAAK2Y,KAAL,CAAW5F,IAAX,CACzB,QAAA4H,MAAA,CAAO,cAAA+Q,yBAAP,CADyB,EAExBxrB,SAFwB,CAEd,UAAAkQ,IAAI,EAAI;uBAAA,CACnB;;;AACA,oBAAI,CAACmuE,WAAL,CAAiBnuE,IAAjB,CAAsB,aAAAA,IAAI,CAACiH,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAEiN,MAAd,MAAoB,IAApB,IAAoB,aAApB,GAAoB,MAApB,GAAoB,GAAEngB,MAAtB,IAA+BiM,IAAI,CAACiH,OAAL,CAAaiN,MAAb,CAAoB,CAApB,EAAuBlJ,QAAvB,CAAgCpJ,QAA/D,GAA0Ek/B,WAAhG;AACA,WALyB,CAA1B;;AAOA,eAAKjgB,OAAL,CAAazW,WAAb,CAAyBzH,IAAzB,CAA8B,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,mBAAOA,CAAP;AAAA,WAAN,CAA9B,EAA+CvZ,SAA/C,CAAyD,YAAM;AAC9D,oBAAI,CAACkb,QAAL,GAAgB,QAAI,CAAC+C,QAAL,CAAcd,OAAd,CAAsB,aAAtB,CAAhB;AACA,oBAAI,CAACe,IAAL,GAAY,cAAAie,mBAAA,CAAoB,QAAI,CAACoO,KAAL,CAAW7zB,OAA/B,EAAwC,QAAI,CAAC6oE,gBAA7C,CAAZ;AACA,WAHD;;AAKA,cAAMvuE,UAAU,GAAG,GAAnB;;AACA,cAAI1J,MAAJ,EAAY;AACX,iBAAKs0C,MAAL,GAAct0C,MAAM,CAAC2J,UAAP,GAAoBD,UAAlC;AACA;;AAED,iBAAAwuE,SAAA,CAAUl4E,MAAV,EAAkB,QAAlB,EAA4BuL,IAA5B,CAAiC,YAAA4sE,YAAA,CAAa,GAAb,CAAjC,EAAoD5sE,IAApD,CAAyD,YAAA6sE,GAAA,CAAI;AAC5DxvE,gBAAI,EAAE,cAAAy/D,GAAG,EAAI;AACZ,kBAAMz7D,MAAM,GAAGy7D,GAAG,CAACz7D,MAAnB;AACA,sBAAI,CAAC0nC,MAAL,GAAc1nC,MAAM,CAACjD,UAAP,GAAoBD,UAAlC;AACA;AAJ2D,WAAJ,CAAzD,EAKIhR,SALJ;AAQA,eAAKF,YAAL,CAAkB,WAAlB,EAA+B,KAAK2Y,KAAL,CAAW5F,IAAX,CAC9B,QAAA4H,MAAA,CAAO,YAAA7D,qBAAP,CAD8B,EAE9B,QAAA6D,MAAA,CAAO,YAAAvD,kCAAP,CAF8B,EAG9B,YAAAtP,GAAA,CAAI,UAACukB,OAAD,EAA4C;AAC/C,mBAAO,cAAAD,qBAAA,CAAsBC,OAAtB,CAAP;AACA,WAFD,CAH8B,EAM9B,YAAAu4B,oBAAA,EAN8B,EAO7B1kD,SAP6B,CAOnB,UAAAkQ,IAAI,EAAI;AACnB,oBAAI,CAAC2G,SAAL,GAAiB3G,IAAjB;AACA,aAAC,QAAI,CAACyvE,WAAN,IAAqB,QAAI,CAACC,+BAAL,CAAqC,QAAI,CAACr1C,KAAL,CAAW7zB,OAAhD,CAArB;AACA,WAV8B,CAA/B;AAaA;;;2CAsByBikB,K,EAAO;AAChC,iBAAO,KAAK4P,KAAL,CAAW7zB,OAAX,CAAmB/J,WAAnB,CAA+B/J,QAA/B,CAAwC;AAAEJ,mBAAO,EAAEm4B,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAEb;AAAlB,WAAxC,EAA2Ez2B,UAA3E,CAAsF,OAAtF,CAAP;AACA;;;0CAEwBqT,O,EAAkB;AAAA;;;;AAC1C,cAAM8kE,SAAS,GAAG9kE,OAAO,CAACge,IAAR,CAAavhB,KAAb,IAAsB,EAAxC;AACA,eAAKkqE,UAAL,GAAkB,OAAApwE,wBAAA,CAAyByJ,OAAO,CAAC/J,WAAjC,EAA8C,IAA9C,CAAlB;AACA,eAAK4wE,UAAL,GAAkB,OAAA1wE,gCAAA,CAAiC6J,OAAO,CAAC/J,WAAzC,EAAsD+J,OAAO,CAACwjB,gBAA9D,CAAlB;AACA,eAAK7e,IAAL,GAAY3E,OAAO,CAAC2f,SAAR,CAAkBv4B,IAA9B;AACA,eAAKm5B,OAAL,GAAevgB,OAAO,CAACugB,OAAvB;AACA,eAAK4oD,SAAL,GAAiBnpE,OAAO,CAAC2f,SAAR,CAAkBljB,KAAnC;AACA,eAAKub,KAAL,GAAahY,OAAO,CAACgY,KAArB;AACA,eAAK1nB,IAAL,GAAY,OAAAkK,WAAA,CAAYwF,OAAO,CAACyf,YAApB,CAAZ;AACA,eAAK2pD,QAAL,GAAgBppE,OAAO,CAACge,IAAR,CAAahE,UAAb,IAA2B,EAA3C;AACA,eAAK8sD,cAAL,GAAsB,OAAAz0E,gBAAA,CAAiB2N,OAAO,CAAC5T,QAAzB,CAAtB;AACA,eAAKslB,QAAL,GAAgB1R,OAAO,CAACge,IAAR,CAAatM,QAA7B;AACA,eAAK23D,eAAL,GAAuBrpE,OAAO,CAAC0f,SAAR,CAAkBxuB,GAAlB,CAAsB,UAAAsC,CAAC;AAAA,mBAAIA,CAAC,CAACpM,IAAN;AAAA,WAAvB,EAAmCsN,IAAnC,CAAwC,IAAxC,CAAvB;AACA,eAAK40E,UAAL,GAAkBtpE,OAAO,CAAC+f,eAAR,CAAwB+kD,SAAxB,CAAlB;AACA,eAAK2B,SAAL,GAAiBzmE,OAAO,CAACggB,kBAAR,CAA2B8kD,SAA3B,CAAjB;AACA,eAAKyE,MAAL,GAAcvpE,OAAO,CAACge,IAAR,CAAazH,KAAb,CAAmB0d,OAAjC;AACA,eAAKu1C,iBAAL,GAAyB,CAAzB;AACA,eAAKC,WAAL,kBAA2BzpE,OAAO,CAACge,IAAR,CAAa+S,MAAxC;AACA,eAAK24C,kBAAL,GAA0B,KAA1B;AACA,eAAKC,eAAL,GAAuB,wBAAK91C,KAAL,CAAW7zB,OAAX,CAAmBge,IAAnB,CAAwBtP,QAAxB,MAAgC,IAAhC,IAAgC,aAAhC,GAAgC,MAAhC,GAAgC,GAAEtM,SAAlC,MAA2C,IAA3C,IAA2C,aAA3C,GAA2C,MAA3C,GAA2C,GAAE0vB,cAA7C,MAA2D,IAA3D,IAA2D,aAA3D,GAA2D,MAA3D,GAA2D,GAAE83C,eAA7D,KAAgF,EAAvG;AACA,eAAKC,aAAL,GAAqB7pE,OAAO,CAACmgB,OAAR,CAAgBzrB,IAAhB,CAAqB,IAArB,CAArB,CApB0C,CAqB1C;;AACA,eAAKszE,mBAAL,GAA2B,IAA3B,CAtB0C,CAsBT;;AACjC,eAAKC,qBAAL,GAA6B,IAA7B;AACA,eAAKC,0BAAL,GAAkC,IAAlC;AACA,eAAKR,kBAAL,GAA0B,CAAC1nE,OAAO,CAACmZ,eAAR,KAA4B,IAA5B,IAAoCnZ,OAAO,CAACmZ,eAAR,KAA4B,EAAjE,KAAwEnZ,OAAO,CAAC6R,iBAAR,KAA8B,IAAtG,GAA6G,IAA7G,GAAoH,KAA9I,CAzB0C,CA2B1C;;AACA,eAAKi4D,2BAAL,CAAiC9pE,OAAO,CAAC/J,WAAzC,EA5B0C,CA8B1C;;AACA,cAAM8zE,YAAY,GAAG/pE,OAAO,CAAC8f,KAAR,CAAcjxB,IAAd,CAAmB,UAAAuoB,CAAC,EAAI;AAC5C,gBAAIA,CAAC,CAAC9mB,IAAF,KAAW,WAAf,EAA4B;AAC3B,qBAAO,IAAP;AACA;AACD,WAJoB,CAArB;AAKA,eAAKy5E,YAAL,GAAoBA,YAAY,GAAGA,YAAY,CAAC/mE,OAAhB,GAA0B,EAA1D,CApC0C,CAsC1C;;AACA,cAAIhD,OAAO,CAAC6P,MAAZ,EAAoB;AACnB;AACA,gBAAMm6D,SAAS,GAAGhqE,OAAO,CAAC6P,MAA1B;AACA,iBAAKA,MAAL,GAAc7P,OAAO,CAAC6P,MAAtB;AACA,gBAAMo6D,eAAe,GAAG,UAAAn1E,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB6R,aAApB,CAAkC;AAAEhR,qBAAO,EAAE;AAAX,aAAlC,EAAkD63B,YAAlD,CAA+D3jB,OAAO,CAAC/J,WAAR,CAAoB/J,QAApB,CAA6B;AAAEJ,qBAAO,EAAEkU,OAAO,CAAC5T;AAAnB,aAA7B,CAA/D,CAAxB;;AACA,gBAAI,CAAC,CAAC,UAAD,EAAa,WAAb,EAA0B+Y,QAA1B,CAAmCnF,OAAO,CAAC6P,MAA3C,CAAL,EAAyD;AACxD,mBAAKA,MAAL,GAAc,UAAA/a,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB24B,WAApB,CAAgC5jB,OAAO,CAAC/J,WAAR,CAAoB/J,QAApB,CAA6B;AAAEJ,uBAAO,EAAEkU,OAAO,CAAC5T;AAAnB,eAA7B,CAAhC,IAA+F,SAA/F,GAA2G4T,OAAO,CAAC6P,MAAjI;AACA;;AAED,gBAAG,KAAKgkB,KAAL,CAAW8X,cAAX,IAA6B,KAAK9X,KAAL,CAAW8X,cAAX,CAA0B97B,MAA1B,KAAqC,WAArE,EAAmF;AAClF,mBAAKk4D,uBAAL,GAA+B,IAA/B;AACA;;AAED,oBAAQ,KAAKl4D,MAAb;AACC,mBAAK,WAAL;AACC,qBAAKq6D,WAAL,GAAmB,iCAAnB;AACA,qBAAK7G,UAAL,GAAkB,SAAlB;AACA,qBAAK2E,mBAAL,GAA2B,KAA3B;AACA,qBAAKE,0BAAL,GAAkC,KAAlC;AACA,qBAAKD,qBAAL,GAA6B,KAA7B,CALD,CAMC;;AACA,oBAAI,UAAAnzE,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB24B,WAApB,CAAgC5jB,OAAO,CAAC/J,WAAxC,CAAJ,EAA0D;AACzD;AACA,uBAAKgyE,qBAAL,GAA6B,IAA7B;AACA;;AAED;;AACD,mBAAK,UAAL;AACC,qBAAKiC,WAAL,GAAmB,mCAAnB;AACA,qBAAK7G,UAAL,GAAkB,WAAlB;AACA,qBAAK2E,mBAAL,GAA2B,KAA3B;AACA,qBAAKE,0BAAL,GAAkC,KAAlC;AACA,qBAAKD,qBAAL,GAA6B,KAA7B;AACA,qBAAKyB,kBAAL,GAA0B,IAA1B,CAND,CAOC;;AACA,qBAAKS,gBAAL,GAAwBpiE,IAAxB,CAA6B,UAAAhQ,CAAC,EAAI;AACjC,0BAAI,CAACyxE,iBAAL,GAAyBzxE,CAAzB;AACA,0BAAI,CAAC2xE,kBAAL,GAA0B,KAA1B;AACA,iBAHD,EARD,CAYC;;AACA,oBAAI,UAAA50E,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB24B,WAApB,CAAgC5jB,OAAO,CAAC/J,WAAxC,CAAJ,EAA0D;AACzD;AACA,uBAAKgyE,qBAAL,GAA6B,IAA7B;AACA;;AACD;;AACD,mBAAK,UAAL;AACC,qBAAKiC,WAAL,GAAmB,mCAAnB;AACA,qBAAK7G,UAAL,GAAkB,WAAlB;AACA,qBAAK2E,mBAAL,GAA2B,KAA3B;AACA,qBAAKE,0BAAL,GAAkC,KAAlC;AACA,qBAAKD,qBAAL,GAA6B,KAA7B,CALD,CAKqC;;AACpC,qBAAKyB,kBAAL,GAA0B,IAA1B,CAND,CAOC;;AACA,qBAAKS,gBAAL,GAAwBpiE,IAAxB,CAA6B,UAAAhQ,CAAC,EAAI;AACjC,0BAAI,CAACyxE,iBAAL,GAAyBzxE,CAAzB;AACA,0BAAI,CAAC2xE,kBAAL,GAA0B,KAA1B;AACA,iBAHD,EARD,CAYC;;AACA,oBAAI,UAAA50E,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB24B,WAApB,CAAgC5jB,OAAO,CAAC/J,WAAxC,CAAJ,EAA0D;AACzD;AACA,uBAAKgyE,qBAAL,GAA6B,IAA7B;AACA;;AACD;;AACD,mBAAK,UAAL;AACC,qBAAKiC,WAAL,GAAmB,mCAAnB;AACA,qBAAK7G,UAAL,GAAkB,WAAlB,CAFD,CAGC;;AACA,qBAAKmG,iBAAL,GAAyB,CAAzB;AACA;;AACD,mBAAK,WAAL;AACC,qBAAKU,WAAL,GAAmB,mCAAnB;AACA,qBAAK7G,UAAL,GAAkB,WAAlB;AACA,qBAAKmG,iBAAL,GAAyB,CAAzB;AACA;;AACD,mBAAK,SAAL;AACC,qBAAKU,WAAL,GAAmB,iCAAnB;AACA,qBAAK7G,UAAL,GAAkB,SAAlB;AACA,qBAAKmG,iBAAL,GAAyB,CAAzB;;AAEA,oBAAIS,eAAe,IAAI,CAAC,UAAD,EAAa,UAAb,EAAyB9kE,QAAzB,CAAkC6kE,SAAlC,CAAvB,EAAqE;AACpE,uBAAKN,kBAAL,GAA0B,IAA1B;AACA,uBAAKS,gBAAL,GAAwBpiE,IAAxB,CAA6B,UAAAhQ,CAAC,EAAI;AACjC,4BAAI,CAACyxE,iBAAL,GAAyBzxE,CAAzB;AACA,4BAAI,CAAC2xE,kBAAL,GAA0B,KAA1B;AACA,mBAHD;AAIA;;AACD;;AACD;AAAS;AACR,qBAAKQ,WAAL,GAAmB,iCAAnB;AACA,qBAAK7G,UAAL,GAAkB,SAAlB;AACA,qBAAKmG,iBAAL,GAAyB,CAAzB;AACA;AA9EF;AAgFA;AACD;;;kCAEgBvlD,K,EAAO;AACvB,iBAAOA,KAAK,CAAC56B,KAAN,CAAY6H,GAAZ,CAAgB,UAAAxH,CAAC;AAAA,8BAAQA,CAAC,CAACokC,MAAV,eAAqBpkC,CAAC,CAACtC,IAAvB;AAAA,WAAjB,EAAgDsN,IAAhD,CAAqD,IAArD,CAAP;AACA;;;yCAEuB;AACvB,eAAK+yE,gBAAL,GAAwB,IAAxB;AACA;;;sCAE+C;AAAA,cAA7B2C,UAA6B,uEAAP,KAAO;AAC/C,eAAK3C,gBAAL,GAAwB,KAAxB;AACA,eAAKG,oBAAL,GAA4B,KAA5B;;AACA,cAAIwC,UAAJ,EAAgB;AACf,iBAAKA,UAAL,CAAgB,KAAhB;AACA,iBAAKC,sBAAL,IAA+B,KAAKC,oBAAL,CAA0B,KAA1B,EAAiC,IAAjC,CAA/B;AACA,iBAAKD,sBAAL,GAA8B,KAA9B;AACA;AACD;;;gCAE+B;AAAA,cAAnBE,IAAmB,uEAAJ,EAAI;AAC/B,eAAK/6C,SAAL,CAAeC,KAAf,CAAqB86C,IAArB;AACA;AAED;;;;;;;;;2CAM8B;;;;;;;AACvBC,kC,GAAiB,KAAK32C,KAAL,CAAW7zB,OAAX,CAAmB+F,KAAnB,CAAyB,KAAK8tB,KAAL,CAAW7zB,OAAX,CAAmBge,IAAnB,CAAwBvhB,KAAjD,KAA2D,C;AAC5EguE,sC,GAAqB,KAAK52C,KAAL,CAAW7zB,OAAX,CAAmBiZ,SAAnB,CAA6B,KAAK4a,KAAL,CAAW7zB,OAAX,CAAmBge,IAAnB,CAAwBvhB,KAArD,IAA8D,KAAKo3B,KAAL,CAAW7zB,OAAX,CAAmBiZ,SAAnB,CAA6B,KAAK4a,KAAL,CAAW7zB,OAAX,CAAmBge,IAAnB,CAAwBvhB,KAArD,IAA8D,EAA5H,GAAiI,C,EAE5J;;AACM4e,yB,GAAQ,KAAKwY,KAAL,CAAW7zB,OAAX,CAAmB9J,SAAnB,CAA6BhK,QAA7B,CAAsC;AAAE6Q,6BAAO,EAAEytE,cAAc,GAAG;AAA5B,qBAAtC,C,EAAuE;;AAC/E10C,0B,GAAS;AACd9c,8BAAQ,EAAE,KAAK6a,KAAL,CAAW7zB,OAAX,CAAmBge,IAAnB,CAAwB1gB,EADpB;AAEdtR,4BAAM,EAAEqvB,KAFM;AAGdjvB,8BAAQ,EAAE,KAAKq+E,kBAHD;AAIdvxD,mCAAa,EAAE;AAJD,qB;;AAOR,2BAAM,KAAKmB,OAAL,CACXnK,SADW,CACD4lB,MADC,EACO,IADP,EACa,KADb,EAEX/tB,IAFW,CAGX,UAACxe,IAAD,EAAU;AACT;AACA,0BAAMmhF,YAAY,GAAI,CAACnhF,IAAI,CAAC,CAAD,CAAJ,CAAQwgC,eAAR,IAA2B1O,KAAK,CAACte,OAAN,GAAgB,EAA3C,CAAD,IAAmD,EAAzE;AACA,0BAAMxO,KAAK,GAAG5C,IAAI,CAACq9B,GAAL,CAAS,EAAT,EAAa0hD,YAAb,CAAd;AACA,6BAAOn8E,KAAK,IAAI,EAAT,GAAcA,KAAd,GAAsB,CAA7B;AACA,qBARU,EASX,YAAM;AACL,6BAAO,CAAP;AACA,qBAXU,CAAN;;;;;;;;;;;;AAaP;;;2CAEyB;AACzB,eAAK06E,WAAL,GAAmB,CAAC,KAAKA,WAAzB;AACA,WAAC,KAAKA,WAAN,IAAqB,KAAKC,+BAAL,CAAqC,KAAKr1C,KAAL,CAAW7zB,OAAhD,CAArB;AACA;;;oCAKkBA,O,EAAgB;AAElC,cAAI,KAAKG,SAAL,IAAkBH,OAAO,CAACwf,aAA9B,EAA6C;AAC5C,mBAAO,KAAKrf,SAAL,CAAetR,IAAf,CAAoB,UAAA4E,CAAC;AAAA,qBAAIuM,OAAO,CAACwf,aAAR,KAA0B/rB,CAAC,CAAClF,KAAhC;AAAA,aAArB,CAAP;AACA;;AACD,iBAAO,EAAP;AACA;AAGD;;;;;;;;;;;;wDAUuCyR,O,EAAyC;AAAA,cAAhC2qE,aAAgC,uEAAP,KAAO;;;;AAC/E,cAAM16E,QAAQ,GAAG+P,OAAO,CAAC/P,QAAzB;AAD+E,8BAEpC+P,OAAO,CAACge,IAF4B;AAAA,cAEvEtM,QAFuE,iBAEvEA,QAFuE;AAAA,cAE7DhC,oBAF6D,iBAE7DA,oBAF6D;AAG/E,cAAMk7D,UAAU,GAAGl5D,QAAQ,GAAG,CAAX,GAAe,CAAf,GAAoBA,QAAQ,GAAG,CAAX,IAAgBA,QAAQ,GAAG,EAA5B,GAAkC,CAAlC,GAAsC,CAA5E;AACA,cAAMN,QAAQ,GAAG,cAAAH,eAAA,CAAgB25D,UAAhB,CAAjB,CAJ+E,CAM/E;;AACA,cAAIC,oBAAoB,GAAG,EAA3B;AACA,cAAItD,eAAe,GAAG,EAAtB;;AACA,cAAGvnE,OAAO,CAAC4R,YAAR,IAAwB+4D,aAA3B,EAA0C;AAEzC,iBAAK92C,KAAL,CAAW8X,cAAX,CAA0BhqB,kBAA1B,CAA6Cl4B,OAA7C,CAAqD,UAAAR,OAAO,EAAI;AAC/Ds+E,6BAAe,CAACr0E,IAAhB,CAAqB,IAAI,UAAAqJ,MAAJ,CAAW;AAAElR,oBAAI,EAAEpC,OAAO,CAACkU,WAAR,GAAsB,IAA9B;AAAoCuV,2BAAW,EAAE,KAAjD;AAAwDC,2BAAW,EAAE1iB;AAArE,eAAX,CAArB;AACA,aAFD;;AAGAs3E,2BAAe,GAAGA,eAAe,CAACh0E,IAAhB,CAAqB,UAAC20B,EAAD,EAAaC,EAAb;AAAA,qBAA4BD,EAAE,CAAClzB,EAAH,GAAQmzB,EAAE,CAACnzB,EAAvC;AAAA,aAArB,CAAlB;AALyC,wCAsB9B,KAAK6+B,KAAL,CAAW8X,cAtBmB;AAAA,gBAQxCruC,EARwC,yBAQxCA,EARwC;AAAA,gBASxCuU,iBATwC,yBASxCA,iBATwC;AAAA,gBAUxCC,mBAVwC,yBAUxCA,mBAVwC;AAAA,gBAWxCE,gBAXwC,yBAWxCA,gBAXwC;AAAA,gBAYxCJ,YAZwC,yBAYxCA,YAZwC;AAAA,gBAaxCM,qBAbwC,yBAaxCA,qBAbwC;AAAA,gBAcxCqW,kBAdwC,yBAcxCA,kBAdwC;AAAA,gBAexCpW,eAfwC,yBAexCA,eAfwC;AAAA,gBAgBxC0R,yBAhBwC,yBAgBxCA,yBAhBwC;AAAA,gBAiBxClC,kBAjBwC,yBAiBxCA,kBAjBwC;AAAA,gBAkBxCH,gBAlBwC,yBAkBxCA,gBAlBwC;AAAA,gBAmBxCE,cAnBwC,yBAmBxCA,cAnBwC;AAAA,gBAoBxCvI,eApBwC,yBAoBxCA,eApBwC;AAAA,gBAqBxCQ,oBArBwC,yBAqBxCA,oBArBwC;AAAA,gBAsBxC2H,KAtBwC,yBAsBxCA,KAtBwC;AAwBzC,gBAAMwpD,SAAS,GAAGjnD,yBAAyB,CAAC6xC,IAA1B,CAA+B,KAAK7hC,KAAL,CAAW8X,cAA1C,CAAlB;AACA,gBAAM55B,gBAAgB,GAAG+4D,SAAS,CAACnpD,kBAAD,CAAlC;AAKAkpD,gCAAoB,GAAG;AACtBvtE,gBAAE,EAACA,EADmB;AAEtBuU,+BAAiB,EAAEA,iBAFG;AAGtBC,iCAAmB,EAAEA,mBAAmB,IAAI,CAHtB;AAItBC,8BAAgB,EAAEA,gBAJI;AAKtBC,8BAAgB,EAAEA,gBAAgB,IAAI,CALhB;AAMtBJ,0BAAY,EAAEA,YANQ;AAOtBK,+BAAiB,EAAEs1D,eAPG;AAQtBr1D,mCAAqB,EAAEA,qBAAqB,IAAI,EAR1B;AAStBqW,gCAAkB,EAAEA,kBAAkB,IAAI,QATpB;AAUtBpW,6BAAe,EAAEA,eAAe,IAAI,EAVd;AAYtBwP,gCAAkB,EAAEA,kBAZE;AAalBH,8BAAgB,EAAEA,gBAAgB,IAAI,IAbpB;AAclBE,4BAAc,EAAEA,cAAc,IAAI,IAdhB;AAelBvI,6BAAe,EAAEA,eAAe,IAAI,IAflB;AAgBlBQ,kCAAoB,EAAEA,oBAhBJ;AAiBtB2H,mBAAK,EAAEA;AAjBe,aAAvB;AAmBA;;AAAA;AAGD,cAAM6wB,SAAS;AACdztC,oBAAQ,EAAE,CAAC,KAAKqmE,WAAL,CAAiB/qE,OAAjB,CAAD,CADI;AAEd;AACA;AACAhU,kBAAM,EAAEu7E,eAAe,CAACh6E,MAAhB,IAAyB,CAAzB,GAA6Bg6E,eAAe,CAAC,CAAD,CAA5C,GAAkD,OAAAx7E,mBAAA,CAAoB,IAAI,UAAAwQ,MAAJ,CAAW;AAAElR,kBAAI,EAAEJ,IAAI,CAAConB,GAAL,EAAR;AAAoBK,yBAAW,EAAE;AAAjC,aAAX,CAApB,EAA0E,EAA1E,EAA+Ejd,MAA/E,CAAsFxF,QAAtF,CAJ5C;AAKd7D,oBAAQ,EAAE4T,OAAO,CAAC5T,QALJ;AAMdqjB,uBAAW,EAAEC,oBAAoB,KAAK,UAAzB,GAAsC,cAAAqB,kBAAA,CAAmB,CAAnB,CAAtC,GAA8D,cAAAA,kBAAA,CAAmB,CAAnB,CAN7D;AAOdK,oBAAQ,EAAEA,QAPI;AAQd4zD,wBAAY,EAAE,IARA;AASd/0E,oBAAQ,EAAEA;AATI,aASI,YAEf,KAAK4jC,KAFU,MAEL,IAFK,IAEL,aAFK,GAEL,MAFK,GAEL,GAAE8X,cAFG,MAEW,IAFX,IAEW,aAFX,GAEW,MAFX,GAEW,GAAElkC,MAAF,EAXf,GAYXojE,oBAZW,GAYS;AACvBtqD,mBAAO,EAACvgB,OAAO,CAACugB,OADO;AAEvBjkB,kBAAM,EAAE;AAFe,WAZT,CAAf,CA7D+E,CA+E/E;;AACA,eAAK0uE,sBAAL;AACA,eAAKjpE,KAAL,CAAW4hE,QAAX,CAAoB,cAAApkE,oBAAA,CAAqB;AAAEE,mBAAO,EAAE0yC;AAAX,WAArB,CAApB,EAjF+E,CAmF/E;;AACA,eAAKpwC,KAAL,CAAW4hE,QAAX,CAAoB,QAAAjwD,sBAAA,CAAuBjW,OAAvB,CAA+B,cAAA6T,mBAAA,CAAoB6gC,SAApB,CAA/B,CAApB;AACA;AAED;;;;;;8CAG6B;AAAA;;AAC5B;AACA,eAAK+2B,+BAAL,CAAqC,KAAKr1C,KAAL,CAAW7zB,OAAhD,EAAyD,IAAzD;AAEA,cAAMirE,UAAU,GAAG,KAAKvF,MAAL,CAAYriE,IAAZ,CAAiB,+BAAA6nE,yBAAjB,EAA4C;AAC7D5nE,sBAAU,EAAE,WADiD;AAE7D0vC,qBAAS,EAAE,KAFkD;AAG7DC,yBAAa,EAAE,oBAH8C;AAI7DrxC,gBAAI,EAAE;AACLupE,wBAAU,EAAE,KAAKC,gBAAL,CAAsB1V,IAAtB,CAA2B,IAA3B,CADP;AAELp5D,oBAAM,EAAE,cAAAwW,YAAA,CAAaC;AAFhB;AAJuD,WAA5C,CAAnB,CAJ4B,CAc5B;;AACAk4D,oBAAU,CAACr+B,WAAX,GAAyBtjD,SAAzB,CAAmC,UAACihF,IAAD,EAAU;AAC5C;AACAA,gBAAI,IAAI,QAAI,CAAC96C,KAAL,CAAW86C,IAAX,CAAR,CAF4C,CAElB;AAC1B,WAHD;AAKA;;;2CAEkB;AAClB,eAAKnO,MAAL,CAAYj9B,QAAZ,CAAqB,CAAC,iBAAD,CAArB,EAA0C;AAAEksC,sBAAU,EAAE,KAAKnmE;AAAnB,WAA1C;AACA;;;iDAG+B;AAC/B,eAAKnD,KAAL,CAAW4hE,QAAX,CAAoB,cAAAjkE,oBAAA,EAApB;AACA,eAAKqC,KAAL,CAAW4hE,QAAX,CAAoB,QAAApwD,mBAAA,CAAoB2oC,KAApB,EAApB;AACA;;;yCAGuB;AACvB,eAAKkuB,UAAL,CAAgB,IAAhB;AACA,eAAKxC,oBAAL,GAA4B,IAA5B;AACA;;;2CAEyB5nE,O,EAAkB;AAC3C,eAAK6zB,KAAL,CAAW7zB,OAAX,GAAqBA,OAArB;AACA,eAAKsoE,iBAAL,CAAuBtoE,OAAvB;AACA,eAAK+B,KAAL,CAAW4hE,QAAX,CAAoB,WAAAtoE,qBAAA,CAAsB;AAAE,kBAAM2E,OAAO,CAAC1C,EAAhB;AAAoB,qBAAS,KAAKqQ,WAAL,CAAiBlR,KAA9C;AAAqD,sBAAU,aAA/D;AAA8E,sBAAU;AAAxF,WAAtB,CAApB,EAH2C,CAI3C;;AACA,eAAKo3B,KAAL,CAAWy3C,OAAX,GAL2C,CAKrB;;AACtB;;;wCAEqD;AAAA;;AAAA,cAAjCxpD,IAAiC,uEAAJ,EAAI;AACrD;AACA,eAAK4jD,MAAL,CAAYriE,IAAZ,CAAiB,iCAAAkoE,2BAAjB,EAA8C;AAC7CjoE,sBAAU,EAAE,cADiC;AAE7C1B,gBAAI,EAAE,MAAF,OAAE,CAAF,gCACA,KAAKiyB,KADL,GAEA/R,IAFA,CAAE,EAEE;AACPopC,sBAAQ,EAAE,oBAAM;AACf,oBAAMlrD,OAAO,GAAG,QAAI,CAAC6zB,KAAL,CAAW7zB,OAAX,CAAmBynB,KAAnB,EAAhB;;AACA,wBAAI,CAACoM,KAAL,CAAW7zB,OAAX,WAA0B8hB,IAA1B,EAAgC/Z,IAAhC,CACC,YAAM;AACL,0BAAI,CAAC0nB,KAAL,GADK,CAEL;;;AACA,0BAAI,CAACoE,KAAL,CAAWy3C,OAAX,GAHK,CAIL;AACA;;;AACA,0BAAI,CAAC/jE,QAAL,CAAcvF,SAAd,CAAwBwkE,KAAxB,CAA8B,QAA9B,EAAwC;AACvCp7C,8BAAU,EAAEprB,OAAO,CAAC1C,EADmB;AAEvC2c,0BAAM,EAAEja,OAAO,CAACge,IAAR,CAAatP,QAAb,CAAsBtnB,IAFS;AAGvC42B,wBAAI,EAAEhe,OAAO,CAACge,IAAR,CAAa52B,IAHoB;AAIvCiyB,8BAAU,EAAErZ,OAAO,CAAC/J,WAAR,CAAoBjB,EAJO;AAKvCskB,4BAAQ,EAAEtZ,OAAO,CAAC9J,SAAR,CAAkBlB,EALW;AAMvCmsB,4BAAQ,EAAE,CAAC,CAACnhB,OAAO,CAACmhB,QAAR,CAAiBqqD,KANU;AAOvC/E,6BAAS,EAAEzmE,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEggB,kBAAT,CAA4BhgB,OAAO,CAACge,IAAR,CAAavhB,KAAzC;AAP4B,mBAAxC;AASA,iBAhBF,EAiBC,UAAC0M,GAAD,EAAS;AACR,0BAAI,CAACm7D,oBAAL,CAA0B,cAAA1qD,qBAAA,CAAsBzQ,GAAG,SAAH,IAAAA,GAAG,WAAH,GAAG,MAAH,GAAAA,GAAG,CAAE0G,MAA3B,CAA1B;AACA,iBAnBF;AAsBA;AAzBM,aAFF,CAFuC;AA+B7CmjC,qBAAS,EAAE,KA/BkC;AAgC7CC,yBAAa,EAAE;AAhC8B,WAA9C;AAkCA;;;wCAEsB;AAAA;;AACtB;AACA,cAAMw4B,UAAU,GAAG,KAAK/F,MAAL,CAAYriE,IAAZ,CAAiB,mCAAAqoE,6BAAjB,EAAgD;AAClEpoE,sBAAU,EAAE,cADsD;AAElE1B,gBAAI,EAAE;AACL5B,qBAAO,EAAE,KAAK6zB,KAAL,CAAW7zB,OADf;AAEL2rE,qBAAO,EAAE,KAAKnC;AAFT,aAF4D;AAMlEx2B,qBAAS,EAAE,KANuD;AAOlEC,yBAAa,EAAE;AAPmD,WAAhD,CAAnB;AAUAw4B,oBAAU,CAAC7+B,WAAX,GAAyBtjD,SAAzB,CAAmC,UAAC0W,OAAD,EAAuB;AACzD,gBAAIA,OAAJ,EAAa;AACZ,sBAAI,CAAC4rE,kBAAL,CAAwB5rE,OAAxB;AACA;AACD,WAJD;AAKA;;;6CAE2B;AAC3B;AACA,iBAAO,CAAC,CAAC,WAAD,EAAc,SAAd,EAAyB,UAAzB,EAAqCmF,QAArC,CAA8C,KAAK0K,MAAnD,CAAR;AACA;;;uCAGqBjO,I,EAAwB;AAAA;;iBAAA,CAC7C;;;AACA,eAAKsjC,MAAL,GAActjC,IAAI,CAACsjC,MAAnB;AACA,eAAK4kC,2BAAL,CAAiCloE,IAAI,CAAC5V,MAAtC,EAH6C,CAK7C;;AACA,cAAI,KAAK4V,IAAL,CAAUrT,KAAd,EAAqB;AACpB,iBAAK67E,UAAL,CAAgB,IAAhB,EAAsB,KAAKyB,0BAA3B,EADoB,CAEpB;;AACA,iBAAK9pE,KAAL,CAAW4hE,QAAX,CAAoB,cAAApkE,oBAAA,CAAqB;AACxCE,qBAAO,EAAE,MAAF,OAAE,CAAF,kBACH,KAAKmC,IAAL,CAAUrT,KADP,CAAE,EACU;AAClBvC,sBAAM,EAAE4V,IAAI,CAAC5V,MADK;AAElBI,wBAAQ,EAAEwV,IAAI,CAACxV;AAFG,eADV;AAD+B,aAArB,CAApB;AAOA,WAVD,MAUO,IAAIwV,IAAI,CAAC0+B,IAAT,EAAe;AACrB;AACA,gBAAMtgC,OAAO,GAAG,KAAK6zB,KAAL,CAAW7zB,OAAX,CAAmBynB,KAAnB,EAAhB;;AACA,gBAAMqkD,cAAc,GAAG9rE,OAAO,CAAC5T,QAAR,KAAqBwV,IAAI,CAACxV,QAA1B,IAAsC4T,OAAO,CAAC/J,WAAR,CAAoBjB,EAApB,KAA2B4M,IAAI,CAAC5V,MAAL,CAAYgJ,EAApG,CAHqB,CAIrB;;AACAgL,mBAAO,CAAC/J,WAAR,GAAsB2L,IAAI,CAAC5V,MAA3B,CALqB,CAKc;;AACnCgU,mBAAO,CAAC9J,SAAR,GAAoB0L,IAAI,CAAC5V,MAAL,CAAYE,QAAZ,CAAqB;AAAEJ,qBAAO,EAAE8V,IAAI,CAACxV;AAAhB,aAArB,CAApB;AACA,iBAAKkY,OAAL,GAAe,IAAf;AAEA,gBAAMynE,SAAS,GAAG,cAAAl9D,aAAA,CAAc;AAC/Bha,kBAAI,EAAEmL,OAAO,CAAC3U,IADiB;AAE/Be,sBAAQ,EAAE4T,OAAO,CAAC5T,QAFa;AAG/B6X,kBAAI,EAAE,KAAK0J,WAHoB;AAI/BiB,mBAAK,EAAE,CAAF,KAAE,KAAKilB,KAAL,CAAW7zB,OAAX,CAAmBge,IAAnB,CAAwBtP,QAAxB,MAAgC,IAAhC,IAAgC,aAAhC,GAAgC,MAAhC,GAAgC,GAAEI,aAJV;AAK/BP,mBAAK,EAAEvO,OAAO,CAACge;AALgB,aAAd,CAAlB,CATqB,CAiBrB;;AACA,gBAAI8tD,cAAc,IAAI,EAACC,SAAS,SAAT,IAAAA,SAAS,WAAT,GAAS,MAAT,GAAAA,SAAS,CAAE/7D,YAAZ,CAAtB,EAAgD;AAC/C;;AACA;;;;AAIA;AACAhQ,qBAAO,CAAC6P,MAAR,GAAiB,WAAjB;AACA7P,qBAAO,CAACye,YAAR,GAAuB,IAAvB;AACA,aATD,MAUK,IAAIstD,SAAS,CAACh9D,MAAV,KAAqB,cAAAxB,iBAAA,CAAkBmD,WAA3C,EAAwD;AAC5D;AACA,mBAAK25D,sBAAL,GAA8B,IAA9B;AACA,mBAAK/lE,OAAL,GAAe,KAAf;AACA;AACA,aAjCoB,CAmCrB;;;AACA,iBAAKoW,SAAL,CAAe4lB,IAAf,CAAoBtgC,OAApB,EAA6B+H,IAA7B,CACC,UAACyR,GAAD,EAAS;AACR;AACA,sBAAI,CAACoyD,kBAAL,CAAwB5rE,OAAxB;;AACA,sBAAI,CAACwH,IAAL,GAAY,cAAAie,mBAAA,CAAoBzlB,OAApB,EAA6B,QAAI,CAAC6oE,gBAAlC,CAAZ;AACA,sBAAI,CAACvkE,OAAL,GAAe,KAAf;;AACA,sBAAI,CAAC0nE,iBAAL;;AACAhsE,qBAAO,CAACge,IAAR,CAAatP,QAAb,CAAsBtnB,IAAtB;;AACA,sBAAI,CAACmgB,QAAL,CAAcvF,SAAd,CAAwBwkE,KAAxB,CAA8B,QAA9B,EAAwC;AACvCp7C,0BAAU,EAAEprB,OAAO,CAAC1C,EADmB;AAEvC2c,sBAAM,EAAEja,OAAO,CAACge,IAAR,CAAatP,QAAb,CAAsBtnB,IAFS;AAGvC42B,oBAAI,EAAEhe,OAAO,CAACge,IAAR,CAAaiuD,WAHoB;AAIvC5yD,0BAAU,EAAErZ,OAAO,CAAC/J,WAAR,CAAoBjB,EAJO;AAKvCskB,wBAAQ,EAAEtZ,OAAO,CAAC9J,SAAR,CAAkBlB,EALW;AAMvCmsB,wBAAQ,EAAE,CAAC,CAACnhB,OAAO,CAACmhB,QAAR,CAAiBqqD,KANU;AAOvC/E,yBAAS,EAAEzmE,OAAO,CAAC6xC;AAPoB,eAAxC;AASA,aAjBF,EAkBC,UAAC1oC,GAAD,EAAS;AACR,sBAAI,CAAC7E,OAAL,GAAe,KAAf;AACA,sBAAI,CAACsjE,oBAAL,GAA4B,KAA5B;;AACA,sBAAI,CAACtD,oBAAL,CAA0B,cAAA1qD,qBAAA,CAAsBzQ,GAAG,SAAH,IAAAA,GAAG,WAAH,GAAG,MAAH,GAAAA,GAAG,CAAE0G,MAA3B,CAA1B;AACA,aAtBF;AAwBA;AACD;AAED;;;;;;;;6CAMqBq8D,U,EAAYC,W,EAAa;AAC7C;AACA,cAAMvqE,IAAI,GAAG;AACZwqE,sBAAU,EAAE,CAACF,UAAD,GAAc;AAAD;AAAb,cAAkE,CAACC,WAAD,GAAe;AAAD;AAAd,cAAoE,EADtI;AAEZnpE,mBAAO,EAAE;AAAF;AAFK;AAGZqpE,uBAAW,EAAE,OAHD;AAIZnhB,oBAAQ,EAAE;AAAA,qBAAM,IAAN;AAAA,aAJE;AAKZkE,uBAAW,EAAE;AALD,WAAb;AAOA,cAAMsW,MAAM,GAAG,KAAKA,MAAL,CAAYriE,IAAZ,CAAiB,KAAA2nD,2BAAjB,EACd;AACCppD,gBAAI,EAAEA,IADP;AAEC0B,sBAAU,EAAE,WAFb;AAGC0vC,qBAAS,EAAE,KAHZ;AAICC,yBAAa,EAAE,oBAJhB;AAKC/H,wBAAY,EAAE,CAACghC;AALhB,WADc,CAAf;AAQA;;;4CAI0B;AAAA;;AAC1B,eAAKrE,cAAL,GAAsB,IAAtB;AACA,eAAK79E,OAAL,CAAa,cAAb,EAA6B,YAAM;AAClC,oBAAI,CAAC69E,cAAL,GAAsB,KAAtB;AACA,WAFD,EAEG,IAFH;AAGA;;;6CAE2B1B,M,EAAgB;AAAA;;AAC3C,eAAKC,cAAL,GAAsBD,MAAtB;AACA,eAAKP,iBAAL,GAAyB,IAAzB;AACA,eAAK57E,OAAL,CAAa,cAAb,EAA6B,YAAM;AAClC,oBAAI,CAAC47E,iBAAL,GAAyB,KAAzB;AACA,WAFD,EAEG,KAFH;AAGA;;;yCAEuB;AACvB,eAAKiC,cAAL,GAAsB,KAAtB;AACA;;;4CAE0B;AAC1B,eAAKjC,iBAAL,GAAyB,KAAzB;AACA;;;oDAEkC0G,W,EAAqB;AACvD,cAAI,CAACA,WAAL,EAAkB;AACjB;AACA;;AAED,cAAI,KAAKpnC,MAAT,EAAiB;AAChB,iBAAK2mC,0BAAL,GAAkCS,WAAW,CAAC7kD,KAAZ,EAAlC;AACA,WAFD,MAEO;AACN,iBAAKokD,0BAAL,GAAkCS,WAAW,CAAC7kD,KAAZ,GAAoB1yB,YAApB,CAAiC,MAAjC,EAAyCA,YAAzC,CAAsD,KAAtD,CAAlC;AACA;AACD;;;+CAE6B82E,0B,EAAoC;AACjE,eAAKA,0BAAL,GAAkCA,0BAA0B,CAACpkD,KAA3B,EAAlC;AACA,eAAK2iD,UAAL,CAAgB,IAAhB,EAAsB,KAAKyB,0BAA3B;AACA;;;qCAEqF;AAAA,cAApEU,OAAoE,uEAAjD,IAAiD;AAAA,cAA3CV,0BAA2C,uEAAN,IAAM;;;;AACrF,cAAI,oBAAC,KAAKh4C,KAAN,MAAW,IAAX,IAAW,aAAX,GAAW,MAAX,GAAW,GAAE7zB,OAAb,MAAoB,IAApB,IAAoB,aAApB,GAAoB,MAApB,GAAoB,GAAEuO,KAAtB,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAEjR,EAA7B,CAAJ,EAAqC;AACpC;AACA;;AAED,cAAM9N,GAAG,GAAG,KAAK,EAAjB;AACA,cAAMo1B,IAAI,GAAGp1B,GAAG,GAAG,CAAnB;AACA,cAAMnE,IAAI,GAAG,CAACwgF,0BAA0B,iBAAI,KAAKh4C,KAAT,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAE7zB,OAAhB,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAE/J,WAAzB,CAA3B,EAAiEwxB,KAAjE,EAAb,CAPqF,CAOE;;AACvF,cAAM/O,UAAU,GAAGrtB,IAAI,CAAC0J,YAAL,CAAkB,KAAlB,EAAyB9I,QAAzB,CAAkC;AAAER,kBAAM,EAAE,CAAV;AAAaD,uBAAW,EAAE;AAA1B,WAAlC,CAAnB;AACA,cAAMghF,WAAW,GAAGnhF,IAAI,CAAC0J,YAAL,CAAkB,MAAlB,CAApB,CATqF,CAWrF;;AACA,cAAM0J,KAAK,GAAG;AACbzS,kBAAM,EAAEugF,OAAO,GAAGC,WAAH,GAAiB9zD,UADnB;AAEbtsB,oBAAQ,EAAEmgF,OAAO,GAAG3nD,IAAH,GAAUp1B,GAFd;AAGbiiB,qBAAS,EAAE,CAAF,iBAAE,KAAKoiB,KAAP,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAE7zB,OAAd,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAEuO,KAArB,MAA0B,IAA1B,IAA0B,aAA1B,GAA0B,MAA1B,GAA0B,GAAEjR,EAH1B;AAIboU,oBAAQ,EAAE,CAAF,iBAAE,KAAKmiB,KAAP,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAE7zB,OAAd,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAEuO,KAArB,MAA0B,IAA1B,IAA0B,aAA1B,GAA0B,MAA1B,GAA0B,GAAEmD;AAJzB,WAAd;AAMA,eAAK3P,KAAL,CAAW4hE,QAAX,CAAoB,QAAA3vD,eAAA,CAAgBvW,OAAhB,CAAwBgB,KAAxB,CAApB;AACA;;;sCAEoB;AACpB;AACA,eAAKqpE,YAAL,GAAoB,IAApB;AACA;;;gDAE8BtgE,I,EAAiB;AAC/C;AACA;AACA,cAAI,CAACA,IAAL,EAAW;AACV,iBAAKsgE,YAAL,GAAoB,KAApB;AACA,iBAAKmB,WAAL,GAAmB,KAAnB;AACA;AACA,WAP8C,CAQ/C;;;AACA,cAAMjpE,OAAO,GAAG,KAAK6zB,KAAL,CAAW7zB,OAAX,CAAmBynB,KAAnB,EAAhB;;AACAznB,iBAAO,CAACmhB,QAAR,GAAmB3Z,IAAI,CAACovB,QAAL,CAAczV,QAAd,CAAuB5yB,KAA1C;;AAEA,cAAIyR,OAAO,CAACmhB,QAAR,CAAiB5zB,MAArB,EAA6B;AAC5B,gBAAMwY,KAAK,GAAG,EAAd;AACAA,iBAAK,CAAC/F,OAAO,CAACge,IAAR,CAAavhB,KAAd,CAAL,GAA4BuD,OAAO,CAAC+F,KAAR,CAAc/F,OAAO,CAACge,IAAR,CAAavhB,KAA3B,KAAqC,GAAjE;AACA,gBAAMwc,SAAS,GAAG,EAAlB;AACAA,qBAAS,CAACjZ,OAAO,CAACge,IAAR,CAAavhB,KAAd,CAAT,GAAgCuD,OAAO,CAACiZ,SAAR,CAAkBjZ,OAAO,CAACge,IAAR,CAAavhB,KAA/B,KAAyC,GAAzE;AAEAuD,mBAAO,CAAC+F,KAAR,GAAgBA,KAAhB;AACA/F,mBAAO,CAACiZ,SAAR,GAAoBA,SAApB;AACA;;AAED,eAAK2yD,kBAAL,CAAwB5rE,OAAxB;AACA;;;8CAW4B;AAC5B,eAAKysE,cAAL,GAAsB,CAAC,KAAKA,cAA5B;AACA;;;4BApwB0B;;;AAC1B,iBAAO,YAAKjoE,QAAL,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEkoE,WAAf,KAA8B,EAArC;AACA;;;4BAEqB;AACrB,kCAAiBr1E,kBAAkB,CAAC,KAAKsyE,eAAN,CAAnC,iBAAgEtyE,kBAAkB,CAAC,KAAK8xE,SAAN,CAAlF,mCAA2H9xE,kBAAkB,CAAC,KAAK+xE,QAAN,CAA7I,0CAA4L/xE,kBAAkB,CAAC,KAAKsvE,UAAN,CAA9M,0BAA+OtvE,kBAAkB,CAAC,KAAKwvE,UAAN,CAAjQ,gBAAwRxvE,kBAAkB,CAAC,KAAK/G,IAAN,CAA1S,2BAAsU+G,kBAAkB,CAAC,KAAKyvE,cAAN,CAAxV,8BAAiYzvE,kBAAkB,CAAC,KAAK+wE,YAAN,CAAnZ,0BAAsb/wE,kBAAkB,CAAC,KAAK+xE,QAAN,CAAxc,8BAA2e/xE,kBAAkB,CAAC,KAAKqa,QAAN,CAA7f;AACA;;;4BAsHkC;;;AAClC,kBAAQ,KAAK7B,MAAb;AACC,iBAAK,WAAL;AACA,iBAAK,UAAL;AACA,iBAAK,SAAL;AACC,qBAAO,IAAP;;AACD;AACC,qBAAO,CAAC,cAAAsI,eAAA,CAAgB,CAAD,KAAC,KAAK0b,KAAL,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAE7zB,OAA5B,EAAqC,KAAK6zB,KAAL,CAAW7zB,OAAX,CAAmBge,IAAnB,CAAwBtP,QAA7D,CAAR;AANF;AAQA;;;4BAE4B;;;AAC5B,iBAAO,cAAAuJ,oBAAA,CAAqB,KAAK4b,KAAL,CAAW7zB,OAAX,CAAmBge,IAAnB,CAAwBtP,QAA7C,EAAuD,CAAF,KAAE,KAAKmlB,KAAL,CAAW7zB,OAAX,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEge,IAA3E,CAAP;AACA;;;4BAEqB;;;AACrB,iBAAO,YAAK6V,KAAL,CAAW7zB,OAAX,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEmhB,QAApB,KAAgC,EAAvC;AACA;;;0BA4mByB83C,G,EAAc;AACvC,eAAKkP,eAAL,GAAuBlP,GAAvB;AACA,S;4BAEwB;AACxB,iBAAO,KAAKkP,eAAZ;AACA;;;;MA3zBgD,OAAArgF,a;;AA5TlD;;;uBA4Ta0/E,4B,EAA4B,+B,EAAA,uC,EAAA,qBA8E/B,SAAAv6B,eA9E+B,C,EA8EhB,qC,EAAA,8B,EAAA,wC,EAAA,2C,EAAA,sC,EAAA,kC;AAAA,K;;;YA9EZu6B,4B;AAA4B,gD;AAAA,+C;AAAA,e;AAAA,c;AAAA,q1H;AAAA;AAAA;AAzTjC;AACI;AACA;AAKA;AAKA;AACI;AACI;AA+CA;AAaA;AAKJ;AACA;AACI;AACI;AACI;AACA;AAKJ;AACA;AACI;AACI;AAOA;AAIJ;AACA;AACI;AAMA;AAIJ;AACJ;AACJ;AACA;AACI;AACI;AAuDA;AAmBJ;AACA;AAuCA;AAsBJ;AACV;AAUM;AAEJ;AAGJ;AAEA;AAkBA;AASA;;;;AA5SS;AAAA;AAC0B;AAAA;AAKG;AAAA;AAMV;AAAA;AACc;AAAA;AA+CS;AAAA;AAalC;AAAA;AAMgB;AAAA;AAGT;AAAA;AACA;AAAA;AASI;AAAA;AAOA;AAAA;AAMA;AAAA;AAMA;AAAA;AAQH;AAAA;AAuDA;AAAA;AAoBY;AAAA;AAuCA;AAAA;AAuBQ;AAAA;AAkBzC;AAAA;AAiBC;AAAA;AASA;AAAA;;;;;;;;;2BAYAA,4B,EAA4B;cA5TxC,OAAAt6B,SA4TwC;eA5T9B;AACVjlD,kBAAQ,EAAE,2BADA;AAEVuxD,kBAAQ,22lBAFE;AA0TVpM,mBAAS,EAAE,CAAC,wCAAD;AA1TD,S;AA4T8B,Q;;;;;;;;kBA8EtC,OAAAlT,M;mBAAO,SAAA+S,e;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxcV;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAKA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAWY;AACI;AACA;AAAuB;AAA+C;AACtE;AAAqC;AAAA;AAAA;AAAA;AAAA;AAArC;AACJ;;;;;;;;;;QAqCCy+B,6B;;;;;AAuBT,6CACwC9pE,IADxC,EAEgB4tB,SAFhB,EAGe9U,SAHf,EAGyC;AAAA;;AAAA;;AAErC;AAJoC,iBAAA9Y,IAAA,GAAAA,IAAA;AACxB,iBAAA4tB,SAAA,GAAAA,SAAA;AACD,iBAAA9U,SAAA,GAAAA,SAAA;AAvBR,iBAAAkrD,iBAAA,GAA6B,KAA7B;AAcA,iBAAAzzB,SAAA,GAAY,IAAI,QAAA1pB,SAAJ,CAAc;AAC7Bp9B,cAAI,EAAE,IAAI,QAAA26B,WAAJ,CAAgB,SAAKpkB,IAAL,CAAU5B,OAAV,CAAkB3U,IAAlC,EAAwC,CAAC,QAAA66B,UAAA,CAAWC,QAAZ,CAAxC,CADuB;AAE7Bn6B,gBAAM,EAAE,IAAI,QAAAg6B,WAAJ,CAAgB,SAAKpkB,IAAL,CAAU5B,OAAV,CAAkB/J,WAAlC,EAA+C,CAAC,QAAAiwB,UAAA,CAAWC,QAAZ,CAA/C,CAFqB;AAG7B/5B,kBAAQ,EAAE,IAAI,QAAA45B,WAAJ,CAAgB,cAAApV,wBAAhB,EAA0C,CAAC,QAAAsV,UAAA,CAAWC,QAAZ,CAA1C;AAHmB,SAAd,CAAZ;AASkC;AAGxC;;;;mCAEU;AACP,eAAKgsB,SAAL,CAAelmD,QAAf,CAAwB;AACpBZ,gBAAI,EAAE,KAAKuW,IAAL,CAAU5B,OAAV,CAAkB3U,IADJ;AAEpBW,kBAAM,EAAE,KAAK4V,IAAL,CAAU5B,OAAV,CAAkB/J,WAFN;AAGpB7J,oBAAQ,EAAE,KAAKwV,IAAL,CAAU5B,OAAV,CAAkB5T;AAHR,WAAxB;AAKH;;;mCAEiB4T,O,EAAmB;AACjC,eAAKwvB,SAAL,CAAeC,KAAf,CAAqBzvB,OAArB;AACH;;;gDAE8B;AAAA;;;;AAC3B,cAAMuzC,QAAQ,GAAG,KAAKpB,SAAL,CAAew6B,WAAf,EAAjB;AACA,eAAKroE,OAAL,GAAe,WAAf,CAF2B,CAI3B;AACA;;AACA,cAAMtE,OAAO,GAAGqlE,SAAS,CAAC,CAAD,KAAC,KAAKzjE,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE5B,OAAZ,CAAzB;AACAA,iBAAO,CAAC9J,SAAR,GAAoB8J,OAAO,CAAC/J,WAAR,CAAoB/J,QAApB,CAA6B;AAAEJ,mBAAO,EAAEynD,QAAQ,CAACnnD;AAApB,WAA7B,CAApB;;AACA,eAAKsuB,SAAL,CAAe4lB,IAAf,CAAoBtgC,OAApB,EAA6B+H,IAA7B,CACI,YAAM;AACF,oBAAI,CAACzD,OAAL,GAAe,IAAf;;AACA,oBAAI,CAACsoE,UAAL,CAAgB5sE,OAAhB;AACH,WAJL,EAKI,UAACmJ,GAAD,EAAS;AACL,oBAAI,CAAC7E,OAAL,GAAe,IAAf;;AACA,oBAAI,CAACggE,oBAAL;AACH,WARL;AAUH;;;+CAG6B;AAAA;;AAC1B,eAAKsB,iBAAL,GAAyB,IAAzB;AACA,eAAK57E,OAAL,CAAa,cAAb,EAA6B,YAAM;AAC/B,oBAAI,CAAC47E,iBAAL,GAAyB,KAAzB;AACH,WAFD,EAEG,KAFH;AAGH;;;4CAE0B;AACvB,eAAKA,iBAAL,GAAwB,KAAxB;AACH;;;4BApE2B;AACxB,cAAM/3E,IAAI,GAAG,EAAb;AACA,cAAMg/E,KAAK,GAAGlhF,IAAI,CAACY,KAAL,CAAW,KAAKqV,IAAL,CAAU+pE,OAAV,GAAoB99E,IAA/B,CAAd;AACA,cAAMiB,GAAG,GAAI+9E,KAAK,GAAGh/E,IAAT,GAAiB,KAAK+T,IAAL,CAAU5B,OAAV,CAAkB5T,QAA/C;AAEA,iBAAO,CAAC;AACJb,iBAAK,EAAE,KAAKqW,IAAL,CAAU5B,OAAV,CAAkB5T,QADrB;AAEJyB,gBAAI,EAAJA,IAFI;AAGJiB,eAAG,EAAHA;AAHI,WAAD,CAAP;AAKH;;;;MAf8C,OAAAhH,a;;AA7CnD;;;uBA6Ca4jF,6B,EAA6B,qBAwBtB,SAAAz+B,eAxBsB,C,EAwBP,qC,EAAA,wC;AAAA,K;;;YAxBtBy+B,6B;AAA6B,iD;AAAA,+C;AAAA,e;AAAA,c;AAAA,+uB;AAAA;AAAA;AA1ClC;AACI;AAKA;AACI;AAAgE;AAAA,mBAAS,IAAAkB,UAAA,EAAT;AAAqB,WAArB;AAC5D;AACJ;AACA;AAAkB;AAAuB;AAC7C;AACA;AACI;AAQI;AAAA,mBAAiB,IAAAz6B,SAAA,mCAAjB;AAA6D,WAA7D;AAKJ;AACJ;AACA;AACI;AAGI;AAAA,mBAAiB,IAAA26B,qBAAA,EAAjB;AAAwC,WAAxC,EAAyC,iBAAzC,EAAyC;AAAA,mBAEtB,IAAAF,UAAA,EAFsB;AAEV,WAF/B;AAGH;AACL;AACJ;;;;AApCsC;AAAA;AAgB1B;AAAA,6EAAgD,UAAhD,EAAgD,IAAhD,EAAgD,SAAhD,EAAgD,qCAAhD,EAAgD,gBAAhD,EAAgD,0BAAhD,EAAgD,UAAhD,EAAgD,IAAhD,EAAgD,gBAAhD,EAAgD,kBAAhD,EAAgD,UAAhD,EAAgD,2DAAhD;AAaA;AAAA;;;;;;;;;;2BAYPlB,6B,EAA6B;cA7CzC,OAAAx+B,SA6CyC;eA7C/B;AACPjlD,kBAAQ,EAAE,4BADH;AAEPuxD,kBAAQ,27DAFD;AA0CPpM,mBAAS,EAAE,CAAC,yCAAD,CA1CJ;AA2CPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AA3C1B,S;AA6C+B,Q;;;;kBAwB7B,OAAA0pB,M;mBAAO,SAAA+S,e;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnGpB;AAAA;AAAA;;AAOA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAIA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;AC3BA;AACI;AAAiB;AAAM;AAAiB;AAC5C;;;;;AADI;AAAA;AAAuB;AAAA;;;;;;AAWX;AACI;AAEJ;;;;;AAFI;AAAA;;;;;;AARZ;AACI;AACI;AACI;AAGJ;AACA;AAIJ;AACJ;;;;;AATY;AAAA;AAIC;AAAA;;;;;;AAMb;AACI;AACA;AACA;AACJ;;;;;;AAGA;AACI;AAAqB;AAA4B;AAAgB;AACjE;AACI;AACJ;AACJ;;;;;AAJ8B;AAAA;AAAuB;AAAA;AAE7C;AAAA;;;;;;AAGR;;;;;;;;AAGA;AAA+C;AAAA;AAAA;AAAA,iBAAS,QAAA8/B,aAAA,wBAAT;AAAsC,SAAtC;AAC3C;AACJ;;;;;;;;AAEI;AACI;AAAwB;AAA6B;AACrD;AAAoE;AAElE;AACF;AAAmB;AAAA;AAAA;AAAA,iBAAS,QAAAA,aAAA,wBAAT;AAAsC,SAAtC;AAAwC;AAAY;AAC3E;;;;;AAL4B;AAAA;AACA;AAAA;AAA4C;AAAA;;;;;;AAKxE;AACI;AACJ;;;;;;AAQI;AAA2B;AAA2C;AAAO;;;;;;AALjF;AACI;AAAM;AAAuC;AAAc;AAC3D;AAAM;AAA2C;AAAkB;AACnE;AAAM;AAAuC;AAAgB;AAC7D;AAAM;AAA4C;AAAsB;AACxE;AACJ;;;;;AALiD;AAAA;AACI;AAAA;AACJ;AAAA;AACK;AAAA;AAC5C;AAAA;;;;;;AAEV;AACI;AACA;AACA;AACA;AACA;AACJ;;;;QDxBCC,0B;;;;;AAuET,0CAAoBjrE,KAApB,EAAyD;AAAA;;AAAA;;AACrD;AADgB,iBAAAA,KAAA,GAAAA,KAAA;AAxDJ,iBAAAkrE,KAAA,GAAiB,KAAjB;AAGT,iBAAAF,aAAA,GAAgB,IAAI,OAAApiC,YAAJ,EAAhB;AAEA,iBAAAxqC,SAAA,GAAY,IAAI,OAAArZ,eAAJ,CAAyC,EAAzC,CAAZ;AAMA,iBAAAomF,eAAA,GAA4B,CAAC,GAAD,EAAM,GAAN,CAA5B;AACA,iBAAAC,oBAAA,GAAiC,CAAC,GAAD,EAAM,GAAN,CAAjC;AACA,iBAAAC,iBAAA,GAA6B,KAA7B;AA2CkD;AAExD;;;;mCAEc;AAAA;;AACX,eAAKC,kBAAL;AACA,eAAKjkF,YAAL,CAAkB,WAAlB,EAA+B,KAAK2Y,KAAL,CAAW5F,IAAX,CAC3B,QAAA4H,MAAA,CAAO,YAAA7D,qBAAP,CAD2B,EAE3B,QAAA6D,MAAA,CAAO,YAAAvD,kCAAP,CAF2B,EAG3B,YAAAtP,GAAA,CAAI,UAACukB,OAAD,EAA4C;AAC5C,mBAAO,cAAAD,qBAAA,CAAsBC,OAAtB,CAAP;AACH,WAFD,CAH2B,EAM3B,YAAAu4B,oBAAA,EAN2B,EAO7B1kD,SAP6B,CAOnB,UAAAkQ,IAAI,EAAI;AAChB,oBAAI,CAAC2G,SAAL,CAAe3G,IAAf,CAAoBA,IAApB;AACH,WAT8B,CAA/B;AAUH;;;kCAEgB;AACb,iBAAO,KAAK8zE,SAAL,KAAmBhgF,SAA1B;AACH;;;6CAE2B;;;AACxB,cAAI,QAAC,KAAKggF,SAAN,MAAe,IAAf,IAAe,aAAf,GAAe,MAAf,GAAe,GAAEttE,OAAjB,CAAJ,EAA8B;AAC1B;AACH;;AACD,eAAKktE,eAAL,GAAuB,OAAAr3E,wBAAA,CAAyB,KAAKy3E,SAAL,CAAettE,OAAf,CAAuB/J,WAAhD,EAA6D5I,KAA7D,CAAmE,GAAnE,CAAvB;AACA,eAAKkgF,eAAL,GAAuB,OAAAv3E,wBAAA,CAAyB,KAAKs3E,SAAL,CAAettE,OAAf,CAAuB/J,WAAhD,EAA6D,KAAKq3E,SAAL,CAAettE,OAAf,CAAuBwjB,gBAApF,CAAvB;AACA,eAAK4pD,iBAAL,GAAyB,CAAC,KAAKE,SAAL,CAAettE,OAAf,CAAuB/J,WAAvB,CAAmCyc,WAA7D;AACA,eAAKy6D,oBAAL,GAA4B,OAAAt3E,wBAAA,CAAyB,KAAKy3E,SAAL,CAAettE,OAAf,CAAuB/J,WAAvB,CAAmCR,MAAnC,CAA0C,UAAAk0C,aAAA,EAA1C,CAAzB,EAAqFt8C,KAArF,CAA2F,GAA3F,CAA5B;AACA,eAAKsX,IAAL,GAAY,KAAK2oE,SAAL,CAAettE,OAAf,CAAuB2f,SAAvB,CAAiCv4B,IAA7C;AACA,eAAKgiF,QAAL,GAAgB,KAAKkE,SAAL,CAAettE,OAAf,CAAuBge,IAAvB,CAA4BhE,UAA5C;AACA,eAAKouD,YAAL,GAAoB,KAAKkF,SAAL,CAAettE,OAAf,CAAuBge,IAAvB,CAA4BqqD,eAAhD;AACA,eAAKvB,cAAL,GAAsB,OAAAz0E,gBAAA,CAAiB,KAAKi7E,SAAL,CAAettE,OAAf,CAAuB5T,QAAxC,EAAkD,QAAlD,CAAtB;;AAEA,cAAI,KAAKkhF,SAAL,CAAettE,OAAf,CAAuB6P,MAA3B,EAAmC;AAC/B;AACA,iBAAKA,MAAL,GAAe,UAAA/a,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB24B,WAApB,CAAgC,KAAK0pD,SAAL,CAAettE,OAAf,CAAuB9J,SAAvD,KAAqE,KAAK3M,IAAL,KAAc,WAApF,GAAmG,SAAnG,GAA+G,KAAK+jF,SAAL,CAAettE,OAAf,CAAuB6P,MAApJ;;AACA,oBAAO,KAAKA,MAAZ;AACI,mBAAK,WAAL;AACI,qBAAKq6D,WAAL,GAAmB,iCAAnB;AACA,qBAAK7G,UAAL,GAAkB,SAAlB;AACA;;AACJ,mBAAK,UAAL;AACI,qBAAK6G,WAAL,GAAmB,mCAAnB;AACA,qBAAK7G,UAAL,GAAkB,WAAlB;AACA;;AACJ,mBAAK,UAAL;AACI,qBAAK6G,WAAL,GAAmB,mCAAnB;AACA,qBAAK7G,UAAL,GAAkB,WAAlB;AACA;;AACJ,mBAAK,UAAL;AACI,qBAAK6G,WAAL,GAAmB,mCAAnB;AACA,qBAAK7G,UAAL,GAAkB,WAAlB;AACA;;AACJ,mBAAK,WAAL;AACI,qBAAK6G,WAAL,GAAmB,mCAAnB;AACA,qBAAK7G,UAAL,GAAkB,WAAlB;AACA;;AACJ,mBAAK,SAAL;AACI,qBAAK6G,WAAL,GAAmB,iCAAnB;AACA,qBAAK7G,UAAL,GAAkB,SAAlB;AACA;;AACJ;AAAS;AACL,qBAAK6G,WAAL,GAAmB,iCAAnB;AACA,qBAAK7G,UAAL,GAAkB,SAAlB;AACJ;AA5BJ;AA8BH;;AACD;AACH;;;4BA3GuB;AACpB,cAAI,CAAC,KAAKjoE,QAAN,IAAkB,CAAC,KAAKA,QAAL,CAAc7N,MAArC,EAA6C,OAAO,EAAP;AAC7C,cAAMigF,IAAI,GAAG,KAAKpyE,QAAL,CAAc,KAAKzR,KAAnB,EAA0BqW,OAAvC;AACA,cAAMkoB,EAAE,GAAG,IAAI,UAAA3rB,MAAJ,CAAW;AAAElR,gBAAI,EAAEmiF,IAAI,CAACv3E,WAAL,CAAiBjB,EAAzB;AAA6B0d,uBAAW,EAAE,KAA1C;AAAiDC,uBAAW,EAAE66D,IAAI,CAACv3E,WAAL,CAAiB0c;AAA/E,WAAX,CAAX;;AACA,cAAI,KAAKhpB,KAAL,KAAe,CAAnB,EAAsB;AAClB,mBAAO,OAAA6M,4BAAA,CAA6B0xB,EAA7B,CAAP;AACH;;AACD,cAAMulD,IAAI,GAAG,KAAKryE,QAAL,CAAc,KAAKzR,KAAL,GAAa,CAA3B,EAA8BqW,OAA3C;AACA,cAAMmoB,EAAE,GAAG,IAAI,UAAA5rB,MAAJ,CAAW;AAAElR,gBAAI,EAAEoiF,IAAI,CAACx3E,WAAL,CAAiBjB,EAAzB;AAA6B0d,uBAAW,EAAE,KAA1C;AAAiDC,uBAAW,EAAE86D,IAAI,CAACx3E,WAAL,CAAiB0c;AAA/E,WAAX,CAAX;;AACA,cAAI,CAACuV,EAAE,CAACU,UAAH,CAAcT,EAAd,EAAkB,KAAlB,CAAL,EAA+B;AAC3B,mBAAO,OAAA3xB,4BAAA,CAA6B0xB,EAA7B,CAAP;AACH;;AACD,iBAAO,EAAP;AACH;;;4BACwB;AACrB,cAAI,CAAC,KAAK9sB,QAAN,IAAkB,CAAC,KAAKA,QAAL,CAAc7N,MAArC,EAA6C;AACzC,mBAAO,EAAP;AACH,WAHoB,CAKrB;;;AACA,cAAM26B,EAAE,GAAG,IAAI,UAAA3rB,MAAJ,CAAW;AAAElR,gBAAI,EAAE,KAAK+P,QAAL,CAAc,KAAKzR,KAAnB,EAA0BqW,OAA1B,CAAkC/J,WAAlC,CAA8CjB;AAAtD,WAAX,CAAX;AACA,iBAAO,UAAAF,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB29B,UAApB,CAA+BV,EAA/B,EAAmC,KAAnC,IAA4C,SAA5C,GAAwD,EAA/D;AACH;;;4BAEwB;iBAAA,CACrB;;;AACA,iBAAO,CAAP,KAAO,KAAKolD,SAAL,CAAettE,OAAf,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAE0iB,YAAF,CAAen1B,MAA5C;AACH;;;4BAEsB;;;AACnB,iBAAO,YAAK+/E,SAAL,CAAettE,OAAf,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAE4P,YAAxB,MAAoC,YAAI,KAAK09D,SAAL,CAAettE,OAAnB,MAA0B,IAA1B,IAA0B,aAA1B,GAA0B,MAA1B,GAA0B,GAAEmhB,QAA5B,MAAoC,IAApC,IAAoC,aAApC,GAAoC,MAApC,GAAoC,GAAE5zB,MAA1E,CAAP;AACH;;;4BAEqB;AAClB,iBAAO,CAAC,WAAD,EAAc,UAAd,EAA0B,UAA1B,EAAsC4X,QAAtC,CAA+C,KAAK0K,MAApD,CAAP;AACH;;;;MArE2C,OAAA/nB,a;;AALhD;;;uBAKaklF,0B,EAA0B,8B;AAAA,K;;;YAA1BA,0B;AAA0B,8C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,e;AAAA,c;AAAA,ijC;AAAA;AAAA;ACvCvC;AAGA;AACI;AACI;AAaA;AAKJ;AACA;AACI;AAMA;AACJ;AACA;AACI;AAGA;AACI;AAOA;AAGJ;AACA;AACI;AAOA;AAOJ;AACJ;AACJ;;;;AAlEI;AAIiC;AAAA;AACxB;AAAA;AAaS;AAAA;AAMa;AAAA;AACtB;AAAA;AAM4C;AAAA;AAGpB;AAAA;AAIX;AAAA;AAOA;AAAA;AAKA;AAAA;AAOA;AAAA;;;;;;;;;2BDlBbA,0B,EAA0B;cALtC,OAAA9/B,SAKsC;eAL5B;AACPjlD,kBAAQ,EAAE,yBADH;AAEPklD,qBAAW,EAAE,sCAFN;AAGPC,mBAAS,EAAE,CAAC,sCAAD;AAHJ,S;AAK4B,Q;;;;;;gBAIlC,OAAAziD;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AExDL;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;AAEA,QAAM8qB,MAAM,GAAW,CACnB;AACIhhD,UAAI,EAAE,SADV;AAEIihD,eAAS,EAAE,yBAAAsV;AAFf,KADmB,EAKnB;AACIv2D,UAAI,EAAE,gBADV;AAEIihD,eAAS,EAAE,+BAAAuV;AAFf,KALmB,EASnB;AACIx2D,UAAI,EAAE,cADV;AAEIihD,eAAS,EAAE,yBAAAwV;AAFf,KATmB,EAanB;AACIz2D,UAAI,EAAE,QADV;AAEIihD,eAAS,EAAE,2BAAA2L;AAFf,KAbmB,EAiBnB;AACI5sD,UAAI,EAAE,MADV;AAEIihD,eAAS,EAAE,iCAAAsM;AAFf,KAjBmB,EAqBnB;AACIvtD,UAAI,EAAE,QADV;AAEIihD,eAAS,EAAE,4BAAAyV;AAFf,KArBmB,EAyBnB;AACI12D,UAAI,EAAE,cADV;AAEIvV,UAAI,EAAE;AAAE+N,mBAAW,EAAE;AAAf,OAFV;AAGIyoD,eAAS,EAAE,4BAAAyV;AAHf,KAzBmB,EA8BnB;AACI12D,UAAI,EAAE,mBADV;AAEIihD,eAAS,EAAE,4BAAAyV;AAFf,KA9BmB,EAkCnB;AACI12D,UAAI,EAAE,aADV;AAEIihD,eAAS,EAAE,4BAAAyV;AAFf,KAlCmB,EAsCnB;AACI12D,UAAI,EAAE,WADV;AAEIihD,eAAS,EAAE,yBAAA0V;AAFf,KAtCmB,EA0CnB;AACI32D,UAAI,EAAE,0BADV;AAEIohD,kBAAY,EAAE;AAAA,eAAM;AAAA;AAAO;AAAA,yEAAP;AAAA,WAAqDxwD,IAArD,CAA0D,UAACtb,CAAD;AAAA,iBAAOA,CAAC,CAAC0vE,qBAAT;AAAA,SAA1D,CAAN;AAAA;AAFlB,KA1CmB,EA8CnB;AACIhlD,UAAI,EAAE,IADV;AAEIihD,eAAS,EAAE,yBAAA2V;AAFf,KA9CmB,CAAvB;;QAwDaC,oB;;;;AAJb;;YAIaA;;;;yBAAAA,oB;AAAoB,O;AAAA,gBAHpB,CAAC,SAAArV,YAAA,CAAa2C,QAAb,CAAsBnD,MAAtB,CAAD,CAGoB,EAFnB,SAAAQ,YAEmB;;;;+EAApBqV,oB,EAAoB;AAAA;AAAA,kBAFnB,SAAArV,YAEmB;AAAA,O;AAFP,K;;;;;2BAEbqV,oB,EAAoB;cAJhC,OAAAznF,QAIgC;eAJvB;AACNC,iBAAO,EAAE,CAAC,SAAAmyE,YAAA,CAAa2C,QAAb,CAAsBnD,MAAtB,CAAD,CADH;AAEN9vE,iBAAO,EAAE,CAAC,SAAAswE,YAAD;AAFH,S;AAIuB,Q;;;;;;;;;;;;;;;;;;;;;;ACnEjC;AAAA;AAAA;;AAIA;AAAA;AAAA;;AASa,YAAAv5D,uBAAA,GAA4C;AACrDC,uBAAiB,EAAE;AADkC,KAA5C;AAIA,YAAAC,kBAAA,GAAqB,QAAAL,aAAA,CAAc,QAAAG,uBAAd,EAC9B,QAAAF,EAAA,CAAG,cAAAK,oBAAH,EAAyB,UAACnZ,KAAD,EAA0BkW,MAA1B,EAAqC;AAC1D,aAAO,gCACAlW,KADA,GACK;AACRoZ,kBAAU,EAAE,MAAF,OAAE,CAAF,kBACHpZ,KAAK,CAACoZ,UADH,CAAE,EAELlD,MAAM,CAACmD,OAFF;AADJ,OADL,CAAP;AAOH,KARD,CAD8B,EAU9B,QAAAP,EAAA,CAAG,cAAAQ,oBAAH,EAAyB,UAAAtZ,KAAK,EAAI;;;AAAA,6CAC3BA,KAD2B,GACtB;AACRoZ,kBAAU,EAAE;AACRkF,kBAAQ,EAAE,CAAF,KAAEte,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAEoZ,UAAP,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEkF;AADrB;AADJ,OADsB;AAKZ,KALtB,CAV8B,EAgB9B,QAAAxF,EAAA,CAAG,cAAAS,iBAAH,EAAsB,UAAAvZ,KAAK;AAAA,aAAK,MAAD,OAAC,CAAD,kBACxBA,KADwB,CAAC,EACpB;AACRwZ,wBAAgB,EAAE,IAAI3U,IAAJ;AADV,OADoB,CAAL;AAAA,KAA3B,CAhB8B,EAoB9B,QAAAiU,EAAA,CAAG,cAAAW,gBAAH,EAAqB,UAACzZ,KAAD,EAA0BkW,MAA1B,EAAqC;AACtD,aAAO,gCACAlW,KADA,GACK;AACRiZ,yBAAiB,EAAE/C,MAAM,CAACmD;AADlB,OADL,CAAP;AAIH,KALD,CApB8B,EA0B9B,QAAAP,EAAA,CAAG,cAAAY,gBAAH,EAAqB,UAAC1Z,KAAD;AAAA,aAA8B,MAAD,OAAC,CAAD,kBAC3CA,KAD2C,CAAC,EACvC;AACRiZ,yBAAiB,EAAE,QAAAD,uBAAA,CAAwBC;AADnC,OADuC,CAA9B;AAAA,KAArB,CA1B8B,CAArB;;;;;;;;;;;;;;;;;;;;ACjBb;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEa,YAAAu8D,yBAAA,GAA4B,CACrC,8BAAA2I,wBADqC,EAErC,2BAAAR,sBAFqC,EAGrC,yBAAAY,oBAHqC,EAIrC,iCAAAxB,4BAJqC,EAKrC,kCAAAqE,4BALqC,EAMrC,mCAAAkE,6BANqC,EAOrC,6BAAAuC,wBAPqC,EAQrC,gCAAAjB,0BARqC,EASrC,iCAAAzB,2BATqC,EAUrC,4BAAAsC,uBAVqC,EAWrC,qBAAAK,wBAXqC,EAYrC,0BAAAC,oCAZqC,EAarC,uBAAAC,iCAbqC,EAcrC,qBAAAC,6BAdqC,EAerC,iBAAAC,8BAfqC,EAgBrC,yBAAAP,oBAhBqC,EAiBrC,yBAAAH,oBAjBqC,EAkBrC,yBAAAF,oBAlBqC,EAmBrC,8BAAAa,yBAnBqC,EAoBrC,2BAAAC,sBApBqC,EAqBrC,sCAAAC,gCArBqC,EAsBrC,kCAAAC,4BAtBqC,EAuBrC,6BAAAC,uBAvBqC,EAwBrC,+BAAAzD,yBAxBqC,EAyBrC,8BAAA0D,wBAzBqC,EA0BrC,sCAAAC,+BA1BqC,EA2BrC,mCAAAC,6BA3BqC,EA4BrC,+BAAAnB,yBA5BqC,EA6BrC,8BAAAoB,wBA7BqC,EA8BrC,iCAAAC,2BA9BqC,EA+BrC,4CAAAC,qCA/BqC,EAgCrC,qBAAAZ,6BAhCqC,EAiCrC,wBAAAa,mBAjCqC,EAkCrC,yBAAAC,oBAlCqC,EAmCrC,iCAAAzK,2BAnCqC,CAA5B;AAsCA,YAAAxI,oBAAA,GAAuB,CAChC,SAAA51E,YADgC,EAEhC,KAAAgrD,QAFgC,EAGhC,SAAA0J,eAHgC,EAIhC,SAAAR,eAJgC,EAKhC,wBAAAyc,wBALgC,EAMhC,QAAA5lB,mBANgC,EAOhC,gBAAA6oB,mBAPgC,EAQhC,QAAA9oB,WARgC,EAShC,sBAAA8lB,uBATgC,EAUhC,aAAAqD,SAVgC,EAWhC,mBAAA6U,cAAA,CAAexW,OAAf,CAAuB;AACnBh6B,aAAO,EAAE,mBAAAywC,WADU;AAEnBC,gBAAU,EAAE,WAAAC;AAFO,KAAvB,CAXgC,EAehC,0BAAAC,oBAfgC,CAAvB;;QA2BAhX,a;;;;AARb;;YAQaA;;;;yBAAAA,a;AAAa,O;AAAA,6CALf,QAAA0D,oBAKe,IAJlB,yBAAA8R,oBAIkB,EAHlB,QAAA1vE,WAAA,CAAYD,UAAZ,CAAuB,aAAvB,EAAsC,uBAAAiB,kBAAtC,CAGkB;;;;+EAAbk5D,a,EAAa;AAAA,uBAhEtB,8BAAA+L,wBAgEsB,EA/DtB,2BAAAR,sBA+DsB,EA9DtB,yBAAAY,oBA8DsB,EA7DtB,iCAAAxB,4BA6DsB,EA5DtB,kCAAAqE,4BA4DsB,EA3DtB,mCAAAkE,6BA2DsB,EA1DtB,6BAAAuC,wBA0DsB,EAzDtB,gCAAAjB,0BAyDsB,EAxDtB,iCAAAzB,2BAwDsB,EAvDtB,4BAAAsC,uBAuDsB,EAtDtB,qBAAAK,wBAsDsB,EArDtB,0BAAAC,oCAqDsB,EApDtB,uBAAAC,iCAoDsB,EAnDtB,qBAAAC,6BAmDsB,EAlDtB,iBAAAC,8BAkDsB,EAjDtB,yBAAAP,oBAiDsB,EAhDtB,yBAAAH,oBAgDsB,EA/CtB,yBAAAF,oBA+CsB,EA9CtB,8BAAAa,yBA8CsB,EA7CtB,2BAAAC,sBA6CsB,EA5CtB,sCAAAC,gCA4CsB,EA3CtB,kCAAAC,4BA2CsB,EA1CtB,6BAAAC,uBA0CsB,EAzCtB,+BAAAzD,yBAyCsB,EAxCtB,8BAAA0D,wBAwCsB,EAvCtB,sCAAAC,+BAuCsB,EAtCtB,mCAAAC,6BAsCsB,EArCtB,+BAAAnB,yBAqCsB,EApCtB,8BAAAoB,wBAoCsB,EAnCtB,iCAAAC,2BAmCsB,EAlCtB,4CAAAC,qCAkCsB,EAjCtB,qBAAAZ,6BAiCsB,EAhCtB,wBAAAa,mBAgCsB,EA/BtB,yBAAAC,oBA+BsB,EA9BtB,iCAAAzK,2BA8BsB;AA9BK,kBAI3B,SAAAp+E,YAJ2B,EAK3B,KAAAgrD,QAL2B,EAM3B,SAAA0J,eAN2B,EAO3B,SAAAR,eAP2B,EAQ3B,wBAAAyc,wBAR2B,EAS3B,QAAA5lB,mBAT2B,EAU3B,gBAAA6oB,mBAV2B,EAW3B,QAAA9oB,WAX2B,EAY3B,sBAAA8lB,uBAZ2B,EAa3B,aAAAqD,SAb2B,EAalB,iBAbkB,EAkB3B,0BAAAiV,oBAlB2B,EA0BvB,yBAAAxB,oBA1BuB,EA0BH,qBA1BG;AA8BL,O;AAJE,K;;;;;2BAIfxV,a,EAAa;cARzB,OAAAjyE,QAQyB;eARhB;AACN6B,sBAAY,qBAAM,QAAAwzE,yBAAN,CADN;AAENp1E,iBAAO,+BACA,QAAA01E,oBADA,IAEH,yBAAA8R,oBAFG,EAGH,QAAA1vE,WAAA,CAAYD,UAAZ,CAAuB,aAAvB,EAAsC,uBAAAiB,kBAAtC,CAHG;AAFD,S;AAQgB,Q;;;2BAtDtB,qBAAA4uE,wB,EAAwB,+7JAVxB,8BAAA3J,wBAUwB,EATxB,2BAAAR,sBASwB,EARxB,yBAAAY,oBAQwB,EAPxB,iCAAAxB,4BAOwB,EANxB,kCAAAqE,4BAMwB,EALxB,mCAAAkE,6BAKwB,EAJxB,6BAAAuC,wBAIwB,EAHxB,gCAAAjB,0BAGwB,EAFxB,iCAAAzB,2BAEwB,EADxB,4BAAAsC,uBACwB,EAAxB,qBAAAK,wBAAwB,EACxB,0BAAAC,oCADwB,EAExB,uBAAAC,iCAFwB,EAqBxB,qBAAAC,6BArBwB,EAIxB,iBAAAC,8BAJwB,EAKxB,yBAAAP,oBALwB,EAMxB,yBAAAH,oBANwB,EAOxB,yBAAAF,oBAPwB,EAQxB,8BAAAa,yBARwB,EASxB,2BAAAC,sBATwB,EAUxB,sCAAAC,gCAVwB,EAWxB,kCAAAC,4BAXwB,EAYxB,6BAAAC,uBAZwB,EAaxB,+BAAAzD,yBAbwB,EAcxB,8BAAA0D,wBAdwB,EAexB,sCAAAC,+BAfwB,EAgBxB,mCAAAC,6BAhBwB,EAiBxB,+BAAAnB,yBAjBwB,EAkBxB,8BAAAoB,wBAlBwB,EAmBxB,iCAAAC,2BAnBwB,EAoBxB,4CAAAC,qCApBwB,EAsBxB,wBAAAC,mBAtBwB,EAuBxB,yBAAAC,oBAvBwB,EAwBxB,iCAAAzK,2BAxBwB,C,EAwBG,+S;;;;;;;;;;;;;;;;;;;;;;;;AC1F/B;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACbU;AAOI;AAAA;AAAA;AAAA;AAAA;AAAA;AACJ;;;;;;;AANI,+CAAgB,MAAhB,EAAgB,mBAAhB,EAAgB,WAAhB,EAAgB,aAAhB,EAAgB,UAAhB,EAAgB,gBAAhB,EAAgB,OAAhB,EAAgB,KAAhB;;;;;;AAHR;AACI;AASJ;;;;;AARQ;AAAA;;;;;;AAUN;AACE;AACA;AAAG;AAA6B;AAClC;;;;;;AACA;AACE;AACA;AAAG;AAAyD;AAC9D;;;;;;AACA;AACA;AACE;AAAG;AAA8D;AACnE;;;;;;AAZF;AACE;AAIA;AAIA;AAIF;;;;;AAbgB;AACT;AAAA;AAIA;AAAA;AAIA;AAAA;;;;;;AArBT;AACE;AAWA;AAcF;;;;;AAzBO;AAAA;AAWmC;AAAA;;;;;;AAgBtC;;;;;;;;;;AAAA;;;;AAAyB;;;;;;;;AAQ/B;AAAI;AAAA;AAAA;AAAA,kCAAkB,CAAlB;AAAmB,SAAnB;AAA2C;AAAC;;;;;;;;AAChD;AAAI;AAAA;AAAA;AAAA;AAAA;AAAwC;AAAG;;;;;;;;AAC/C;AAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AACF;AACF;;;;;;AAF0B;AACxB;AAAA;;;;;;;;AAEF;AAAI;AAAA;AAAA;AAAA;AAAA;AAAwC;AAAG;;;;;;;;AAC/C;AAAI;AAAA;AAAA;AAAA;AAAA;AACF;AACF;;;;;AADE;AAAA;;;;QDhBSuJ,wB;;;;;AAmET,wCACYlsE,KADZ,EAEYi3D,MAFZ,EAGYzuB,OAHZ,EAIYm7B,MAJZ,EAKQhrD,SALR,EAKkC;AAAA;;AAAA;;AAE9B;AANQ,iBAAA3Y,KAAA,GAAAA,KAAA;AACA,iBAAAi3D,MAAA,GAAAA,MAAA;AACA,iBAAAzuB,OAAA,GAAAA,OAAA;AACA,iBAAAm7B,MAAA,GAAAA,MAAA;AACJ,iBAAAhrD,SAAA,GAAAA,SAAA;AApED,iBAAA+0D,cAAA,GAAiB,IAAI,OAAA3oF,eAAJ,CACpB,UAAA4X,YAAA,CAAaC,KAAb,EADoB,CAAjB;AAIA,iBAAA+wE,YAAA,GAAe,KAAf;AACA,iBAAAC,SAAA,GAAY,KAAZ;AACA,iBAAAnU,gBAAA,GAAmB,0BAAAA,gBAAnB;AACA,iBAAAt2B,MAAA,GAAkB,KAAlB;AAOA,iBAAAxoC,UAAA,GAAgC;AACnConE,qBAAW,EAAE,CADsB;AAEnC8L,sBAAY,EAAE,CAFqB;AAGnCC,mBAAS,EAAE;AAHwB,SAAhC;;AAqMS,iBAAAC,QAAA,GAAW;AAAA,iBAAM,SAAKC,OAAL,CAAa,SAAKrzE,UAAL,CAAgBonE,WAAhB,GAA8B,CAA3C,CAAN;AAAA,SAAX;;AACA,iBAAAkM,QAAA,GAAW;AAAA,iBAAM,SAAKD,OAAL,CAAa,SAAKrzE,UAAL,CAAgBonE,WAAhB,GAA8B,CAA3C,CAAN;AAAA,SAAX;;AACA,iBAAAmM,SAAA,GAAY;AAAA,iBAAM,SAAKF,OAAL,CAAa,SAAKrzE,UAAL,CAAgBonE,WAAhB,GAA8B,CAA3C,CAAN;AAAA,SAAZ;;AACA,iBAAAoM,SAAA,GAAY;AAAA,iBAAM,SAAKH,OAAL,CAAa,SAAKrzE,UAAL,CAAgBonE,WAAhB,GAA8B,CAA3C,CAAN;AAAA,SAAZ;;AACA,iBAAAqM,QAAA,GAAW,UAACC,IAAD;AAAA,iBAAkB,SAAKL,OAAL,CAAaK,IAAb,CAAlB;AAAA,SAAX;;AAnJkB;AAGjC;;;;mCAEc;AAAA;;AACX,cAAM91E,UAAU,GAAG,GAAnB;AACA,cAAMrS,QAAQ,GAAG,KAAKud,MAAL,CAAYvd,QAA7B;AACA,cAAMuV,MAAM,GAAG,KAAKgI,MAAL,CAAYlV,IAA3B;AAEA,eAAKlH,YAAL,CACI,aADJ,EAEI,KAAK2Y,KAAL,CACKgC,MADL,CACY,OAAAC,iBADZ,EAEK7H,IAFL,CAEU,YAAA+H,IAAA,CAAK,CAAL,CAFV,EAGK5a,SAHL,CAGe,UAAC2a,IAAD,EAA4B;AACnC;AACA,oBAAI,CAAC0J,WAAL,GAAmB,IAAI,cAAA0R,IAAJ,CAASpb,IAAT,CAAnB;;AACA,oBAAI,CAAClC,KAAL,CAAW4hE,QAAX,CACI,WAAAtoE,qBAAA,CAAsB;AAClBoB,mBAAK,EAAE,QAAI,CAACkR,WAAL,CAAiBlR,KADN;AAElBzB,kBAAI,EAAE,UAAAlG,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAFR;AAGlBwI,oBAAM,EAANA,MAHkB;AAIlBzO,oBAAM,EAAE;AAJU,aAAtB,CADJ,EAHmC,CAWnC;;;AACA,gBAAMA,MAAM,GAAG,UAAA+F,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB8J,YAApB,CAAiC,QAAjC,EAA2C7I,QAA3C,CAAoD;AAAEJ,qBAAO,EAAE;AAAX,aAApD,EAAoEkJ,EAApE,GAAyE,UAAAF,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAA5G,CAZmC,CAanC;;AACAxN,sBAAU,CAAC,YAAM;AACb,sBAAI,CAAC8jF,OAAL,CAAa9tE,MAAb;;AACA,sBAAI,CAACwf,QAAL,CAAc,iBAAd,EAAiC;AAAA,uBAAM,QAAI,CAACsuD,OAAL,CAAa9tE,MAAb,CAAN;AAAA,eAAjC,EAA6D,KAAK,IAAlE;AACH,aAHS,EAGPzO,MAAM,GAAG,IAHF,CAAV;AAIH,WArBL,CAFJ;;AAyBA,cAAMshF,QAAQ,GAAG,SAAXA,QAAW,CAAC78E,CAAD,EAAIC,CAAJ;AAAA,mBAAUD,CAAC,CAACnI,IAAF,GAASoI,CAAC,CAACpI,IAArB;AAAA,WAAjB;;AACA,cAAMilF,SAAS,GAAG,SAAZA,SAAY,CAAC98E,CAAD,EAAIC,CAAJ;AAAA,mBAAUA,CAAC,CAACpI,IAAF,GAASmI,CAAC,CAACnI,IAArB;AAAA,WAAlB;;AAEA,eAAKjC,YAAL,CACI,gBADJ,EAEI,KAAK2Y,KAAL,CAAW5F,IAAX,CAAgB,QAAA4H,MAAA,CAAO9b,QAAP,CAAhB,EAAkCqB,SAAlC,CAA4C,UAACkQ,IAAD,EAAU;;;AAClD,oBAAI,CAACi2E,cAAL,CAAoBj2E,IAApB,CAAyBA,IAAzB;;AACA,gBAAI,CAACA,IAAI,CAAC6jD,OAAL,EAAD,IAAmBjlD,KAAK,CAACsB,OAAN,CAAc,CAAD,KAACF,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEiH,OAAN,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAE5N,OAA7B,CAAvB,EAA8D;AAC1D,kBAAIA,OAAO,GAAG,mBAAI,CAAH,KAAG2G,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEiH,OAAN,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAE5N,OAAnB,EAA4BU,IAA5B,CACV,QAAI,CAACiS,MAAL,CAAY+qE,YAAZ,GAA2BD,SAA3B,GAAuCD,QAD7B,CAAd;;AAGA,sBAAI,CAACX,YAAL,GAAoB,CAAC,CAAC78E,OAAO,CAACtF,MAA9B;AACA,sBAAI,CAACoiF,SAAL,GAAiB,KAAjB;AACA,sBAAI,CAACv0E,QAAL,GAAgB,4BAAA8e,sBAAA,CAAuBrnB,OAAvB,EAAgCZ,MAAhC,CAAuC,UAAAwB,CAAC;AAAA,uBAAI,EAAEA,CAAC,CAACuM,OAAF,CAAU4R,YAAV,IAA0Bne,CAAC,CAACuM,OAAF,CAAUmZ,eAAV,KAA8B,QAA1D,CAAJ;AAAA,eAAxC,CAAhB;AACA,sBAAI,CAACq3D,WAAL,GAAmB39E,OAAnB;AACV,sBAAI,CAAC6J,UAAL,CAAgBkzE,YAAhB,GAA+Bp2E,IAAI,CAACiH,OAAL,CAAawuB,KAA5C;AACO,aATD,MASO;AACH,sBAAI,CAACygD,YAAL,GAAoB,KAApB;AACA,sBAAI,CAACt0E,QAAL,GAAgB,EAAhB;AACA,sBAAI,CAACsB,UAAL,CAAgBkzE,YAAhB,GAA+B,CAA/B;AACH;AACJ,WAhBD,CAFJ;;AAqBA,cAAIh/E,MAAJ,EAAY;AACR,iBAAKs0C,MAAL,GAAct0C,MAAM,CAAC2J,UAAP,GAAoBD,UAAlC;AACH;;AAED,iBAAAwuE,SAAA,CAAUl4E,MAAV,EAAkB,QAAlB,EACKuL,IADL,CACU,YAAA4sE,YAAA,CAAa,GAAb,CADV,EAEK5sE,IAFL,CAGQ,YAAA6sE,GAAA,CAAI;AACAxvE,gBAAI,EAAE,cAACy/D,GAAD,EAAS;AACX,kBAAMz7D,MAAM,GAAGy7D,GAAG,CAACz7D,MAAnB;AACA,sBAAI,CAAC0nC,MAAL,GAAc1nC,MAAM,CAACjD,UAAP,GAAoBD,UAAlC;AACH;AAJD,WAAJ,CAHR,EAUKhR,SAVL;AAWA,eAAKU,OAAL,CAAa,OAAb,EAAsB;AAAA,mBAClB,QAAI,CAACZ,YAAL,CACI,aADJ,EAEI,QAAI,CAAC4vE,MAAL,CAAYmJ,aAAZ,CAA0B74E,SAA1B,CAAoC,UAACwsC,MAAD,EAAY;AAC5C,kBAAIA,MAAM,CAAC6pC,GAAP,CAAW,MAAX,CAAJ,EAAwB,QAAI,CAACoQ,OAAL,CAAa,CAACj6C,MAAM,CAAC/0B,GAAP,CAAW,MAAX,CAAd,EAAkC,KAAlC;AAC3B,aAFD,CAFJ,CADkB;AAAA,WAAtB;AAQH;;;oCAEkB0vE,O,EAAc;AAC7B,cAAI,CAAAA,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEtwE,SAAT,CAAmBjR,YAAnB,MAAoCuhF,OAAO,CAACtwE,SAAR,CAAkBlR,aAA1D,EAAyE;AACrE,iBAAKq8E,OAAL,CAAa,KAAK9lE,MAAL,CAAYlV,IAAzB;AACH;AACJ;;;sCAEoB;qBAAA,CACjB;;;AACA,iBAAO,KAAKq/E,SAAL,KAAc,YAAI,KAAKF,cAAT,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAElhF,KAAzB,MAA8B,IAA9B,IAA8B,aAA9B,GAA8B,MAA9B,GAA8B,GAAEivD,SAAF,EAA5C,CAAP;AACH;;;oCAEkBx9C,O,EAAkB;;;AACjC,cAAI,KAAKG,SAAL,IAAkBH,OAAO,CAACwf,aAA9B,EAA6C;AACzC,mBAAO,CAAP,KAAO,KAAKrf,SAAL,CAAe5R,KAAf,CAAqBM,IAArB,CAA0B,UAAC4E,CAAD;AAAA,qBAAOuM,OAAO,CAACwf,aAAR,KAA0B/rB,CAAC,CAAClF,KAAnC;AAAA,aAA1B,OAAmE,IAAnE,IAAmE,aAAnE,GAAmE,MAAnE,GAAmE,GAAE6hB,IAAF,CACrE1B,QADL;AAEH;;AACD,iBAAO,IAAP;AACH,S,CAED;;;;oCACyB4+D,S,EAAoC;;;;;;;;;;;yBAEtDA,SAAS,CAACttE,OAAV,CAAkB4R,Y;;;;;AACb5R,2B,GAAU,KAAKwwE,WAAL,CAAiB3hF,IAAjB,CAAsB,UAAA2qB,GAAG;AAAA,6BAAIA,GAAG,CAAClc,EAAJ,KAAWgwE,SAAS,CAACttE,OAAV,CAAkB2Z,oBAA7B,IAAqDH,GAAG,CAACL,eAAJ,KAAwB,SAAjF;AAAA,qBAAzB,C;;wBACTnZ,O;;;;;;AACS,2BAAM,KAAK0a,SAAL,CAAe4D,IAAf,CAAoBgvD,SAAS,CAACttE,OAAV,CAAkB2Z,oBAAtC,CAAN;;;AAAV3Z,2B;;;AAEJ,yBAAK2rC,cAAL,GAAsB,4BAAAzxB,sBAAA,CAAuB,CAACla,OAAD,CAAvB,EAAkC,CAAlC,CAAtB;;;AAIJ;AACMyrE,8B,GAAa,KAAK/F,MAAL,CAAYriE,IAAZ,CAAiB,kCAAAmkE,4BAAjB,EAA+C;AAC9DlkE,gCAAU,EAAE,+BADkD;AAE9D1B,0BAAI,EAAE;AACF5B,+BAAO,EAAEstE,SAAS,CAACttE,OADjB;AAEFsrE,+BAAO,EAAE,mBAAM;AACX,kCAAI,CAACA,OAAL,CAAa,KAAb;AACH,yBAJC;AAMF58D,gCAAQ,EAAE,KAAKgiE,WAAL,CAAiBpD,SAAS,CAACttE,OAA3B,CANR;AAOF2rC,sCAAc,EAAE,YAAKA,cAAL,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAE3rC,OAArB,KAAgC;AAP9C,uBAFwD;AAW9DgzC,+BAAS,EAAE,KAXmD;AAY9DC,mCAAa,EAAE;AAZ+C,qBAA/C,C;AAenBw4B,8BAAU,CAAC7+B,WAAX,GAAyBtjD,SAAzB,CAAmC,UAACihF,IAAD,EAAU;AACzCA,0BAAI,KAAK,sBAAT,IAAmC,QAAI,CAACS,sBAAL,EAAnC,CADyC,CAEzC;AACA;AACH,qBAJD;;;;;;;;;AAKH;;;iDAE+B;AAC5B,eAAKjpE,KAAL,CAAW4hE,QAAX,CAAoB,cAAAjkE,oBAAA,EAApB;AACA,eAAKqC,KAAL,CAAW4hE,QAAX,CAAoB,QAAApwD,mBAAA,CAAoB2oC,KAApB,EAApB;AACH;;;gCAQcy0B,Q,EAAyC;AAAA,cAAvBzrE,KAAuB,uEAAN,IAAM;AACpD,cAAI,CAAC,KAAK0rE,KAAL,CAAW3hD,KAAhB,EAAuB;AACvB,cAAMmhD,IAAI,GAAGzkF,IAAI,CAACmD,GAAL,CAAS,CAAT,EAAYnD,IAAI,CAACq9B,GAAL,CAAS2nD,QAAT,EAAmB,KAAKC,KAAL,CAAW3hD,KAA9B,CAAZ,CAAb;AACA,cAAI/pB,KAAJ,EAAW,KAAKqlC,OAAL,CAAapL,QAAb,CAAsB,EAAtB,EAA0B;AAAEksC,sBAAU,EAAE,KAAKrS,MAAnB;AAA2B/sB,uBAAW,EAAE;AAAEmkC,kBAAI,EAAJA;AAAF;AAAxC,WAA1B;AACX,eAAK1zE,UAAL,CAAgBonE,WAAhB,GAA8BsM,IAA9B;AACA,eAAK9E,OAAL;AACH;;;kCAEiD;AAAA,cAAnC9tE,MAAmC,uEAAlB,KAAKgI,MAAL,CAAYlV,IAAM;;;;AAC9C,cAAI,QAAC,KAAKqd,WAAN,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAElR,KAAnB,CAAJ,EAA8B;AAC1B;AACH;;AAED,cAAM1N,MAAM,GAAG,CAAC,KAAK2N,UAAL,CAAgBonE,WAAhB,GAA8B,CAA/B,IAAoC,KAAKpnE,UAAL,CAAgBmzE,SAAnE,CAL8C,CAM9C;;AACA,eAAK9tE,KAAL,CAAW4hE,QAAX,CACI,WAAAtoE,qBAAA,CAAsB;AAClBoB,iBAAK,EAAE,KAAKkR,WAAL,CAAiBlR,KADN;AAElBzB,gBAAI,EAAE,UAAAlG,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAFR;AAGlBwI,kBAAM,EAANA,MAHkB;AAIlBzO,kBAAM,EAANA;AAJkB,WAAtB,CADJ;AAQA,eAAK4gF,SAAL,GAAiB,IAAjB;AACH;;;4BA7NqB;AAClB,iBAAO,KAAKiB,KAAL,CAAW3hD,KAAX,KAAqB,KAAKvyB,UAAL,CAAgBonE,WAA5C;AACH;;;4BAEkB;AACf,cAAM+M,CAAC,GAAG,KAAKn0E,UAAf;AACA,cAAMuyB,KAAK,GAAGtjC,IAAI,CAACC,IAAL,CAAUilF,CAAC,CAACjB,YAAF,GAAiBiB,CAAC,CAAChB,SAA7B,CAAd;AACA,cAAM5/D,KAAK,GAAGtkB,IAAI,CAACC,IAAL,CAAUilF,CAAC,CAAC/M,WAAF,GAAgB,CAA1B,CAAd;AACA,cAAMgN,aAAa,GAAGnlF,IAAI,CAACmD,GAAL,CAClB,CADkB,EAElBnD,IAAI,CAACq9B,GAAL,CAAS/Y,KAAK,GAAG,CAAR,GAAY,CAACA,KAAK,GAAG,CAAT,KAAe4gE,CAAC,CAAChB,SAAF,GAAc,CAA7B,IAAkC,CAA9C,GAAkD,CAA3D,EAA8D5gD,KAAK,GAAG,CAAtE,CAFkB,CAAtB;AAIA,cAAI2hD,KAAK,GAAG,EAAZ;;AACA,eAAK,IAAI/nF,CAAC,GAAGioF,aAAb,EAA4BjoF,CAAC,IAAI8C,IAAI,CAACq9B,GAAL,CAAS8nD,aAAa,GAAG,CAAzB,EAA4B7hD,KAA5B,CAAjC,EAAqEpmC,CAAC,EAAtE,EAA0E;AACtE+nF,iBAAK,CAAC19E,IAAN,CAAWrK,CAAX;AACH;;AACD,cAAI,CAAC+nF,KAAK,CAACrjF,MAAX,EAAmB;AACfqjF,iBAAK,CAAC19E,IAAN,CAAW,CAAX;AACH;;AACD,cAAM69E,KAAK,GAAG,SAARA,KAAQ,GAAM;AAChB,gBAAI9hD,KAAK,IAAI,CAAT,IAAc4hD,CAAC,CAAC/M,WAAF,IAAiB70C,KAAK,GAAG,CAA3C,EAA8C;AAC1C,qBAAO,KAAP;AACH;;AACD,mBAAO,IAAP;AACH,WALD;;AAMA,cAAM+hD,KAAK,GAAG,SAARA,KAAQ,GAAM;AAChB,gBAAI/hD,KAAK,IAAI,CAAT,IAAc4hD,CAAC,CAAC/M,WAAF,GAAgB,CAAlC,EAAqC;AACjC,qBAAO,KAAP;AACH;;AACD,mBAAO,IAAP;AACH,WALD;;AAMA,cAAMv4E,KAAK,GAAGslF,CAAC,CAAC/M,WAAF,GAAgB,CAA9B;AACA,cAAMvrD,GAAG,GAAG,EAAEs4D,CAAC,CAAC/M,WAAF,GAAgB70C,KAAK,GAAG,CAA1B,CAAZ;AACA,iBAAO;AACHA,iBAAK,EAALA,KADG;AAEH2hD,iBAAK,EAALA,KAFG;AAGH5nD,eAAG,EAAEgoD,KAAK,EAHP;AAIHliF,eAAG,EAAEiiF,KAAK,EAJP;AAKHxlF,iBAAK,EAALA,KALG;AAMHgtB,eAAG,EAAHA;AANG,WAAP;AAQH;;;;MAjEyC,OAAAzwB,a;;AAL9C;;;uBAKammF,wB,EAAwB,8B,EAAA,uC,EAAA,+B,EAAA,kC,EAAA,wC;AAAA,K;;;YAAxBA,wB;AAAwB,2C;AAAA;AAAA;AAAA;AAAA,O;AAAA,wE;AAAA,e;AAAA,a;AAAA,oxB;AAAA;AAAA;ACpCrC;AAKE;AAIE;AA2BA;AAIF;AACF;AACA;AACA;AACE;AAAI;AAAA,mBAAS,IAAA6B,QAAA,EAAT;AAAmB,WAAnB;AAAqB;AAAwC;AACjE;AACA;AACA;AAGA;AACA;AAGA;AAAI;AAAA,mBAAS,IAAAE,QAAA,EAAT;AAAmB,WAAnB;AAAqB;AAAyC;AACpE;AACA;;;;;;AA/CS;AAAA,mDAA0C,UAA1C,EAA0C,GAA1C;AAoCmB;AAAA;AACA;AAAA;AAC+C;AAAA;AAG/C;AAAA;AACW;AAAA;;;;;;;;;2BDf1B/B,wB,EAAwB;cALpC,OAAA/gC,SAKoC;eAL1B;AACPjlD,kBAAQ,EAAE,sBADH;AAEPklD,qBAAW,EAAE,mCAFN;AAGPC,mBAAS,EAAE,CAAC,mCAAD;AAHJ,S;AAK0B,Q;;;;;;;;;;;;;;gBAChC,OAAAziD;;;gBACA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AEtCL;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;AAgBY;AACI;AAA2C;AAAA;AAAA;AAAA;AAAA;AACvC;AACJ;AACJ;;;;;;AAcmD;;;;;;AAEnC;AACI;;AACJ;AACA;AAAG;AAAI;;;;;AAFH;AAAA;;;;;;AAIiC;;;;;;AAR7C;AACI;AACA;AAMA;AAEA;AAEJ;;;;;AAXiB;AAAA;AACA;AAAA;AAMA;AAAA;AAEb;AAAA;;;;;;AAUY;AACI;AACJ;;;;;AADI;AAAA;;;;;;AANhB;AAAM;AAAgB;AACtB;AACI;AACI;AAAsB;AAAI;AAC1B;AACI;AAGJ;AACJ;AACJ;;;;;AALiB;AAAA;;;;;;AAzBzB;AAKI;AAaA;AAcJ;;;;;AA9BI;AAGG;AAAA;;;;;;AA6BP;AAAyB;AAAgB;;;;;AAAhB;AAAA;;;;;;AArC7B;AACI;AAAG;AAAwB;AAE3B;AAkCA;AACA;AAAG;AAAgB;AACnB;AAAG;AAAqB;AACxB;AAAG;AAAkC;AACzC;;;;;AAxCO;AAAA;AAKC;AAAA;AA+BD;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;;;;AAEP;AACI;AAGI;AAAA;AAAA;AAAA;AAAA,WAAiC,iBAAjC,EAAiC;AAAA;AAAA;AAAA;AAAA,SAAjC;AAGH;AACL;;;;AANQ;AAAA;;;;QAYP4gF,2B;;;;;AAoBT,2CACoC3pE,IADpC,EAEY4tB,SAFZ,EAEgE;AAAA;;AAAA;;;;AAE5D;AAHgC,iBAAA5tB,IAAA,GAAAA,IAAA;AACxB,iBAAA4tB,SAAA,GAAAA,SAAA;AAhBL,iBAAAyhD,QAAA,GAAW,KAAX;AACC,iBAAA9I,eAAA,GAAkB,KAAlB;AAkBJ,iBAAKxB,UAAL,GAAkB,OAAApwE,wBAAA,CAAyB,SAAKqL,IAAL,CAAU5B,OAAV,CAAkB/J,WAA3C,EAAwD,IAAxD,CAAlB;AACA,iBAAK4wE,UAAL,GAAkB,OAAA1wE,gCAAA,CAAiC,SAAKyL,IAAL,CAAU5B,OAAV,CAAkB/J,WAAnD,EAAgE,SAAK2L,IAAL,CAAU5B,OAAV,CAAkBwjB,gBAAlF,CAAlB;AACA,iBAAKxL,KAAL,GAAa,SAAKpW,IAAL,CAAU5B,OAAV,CAAkBgY,KAA/B;AACA,iBAAKk5D,eAAL,GAAuB,SAAKtvE,IAAL,CAAU5B,OAAV,CAAkBge,IAAlB,CAAuBqqD,eAA9C;;AAGJ,YAAG,gBAAKzmE,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE+pC,cAAX,MAA8B,IAAjC,EAAuC;AAEtC,mBAAK95B,iBAAL,GAAyB,CAAH,WAAG,SAAKjQ,IAAR,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAE+pC,cAAX,MAAyB,IAAzB,IAAyB,aAAzB,GAAyB,MAAzB,GAAyB,GAAE95B,iBAApD;AACA,mBAAKC,mBAAL,GAA2B,CAAH,WAAG,SAAKlQ,IAAR,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAE+pC,cAAX,MAAyB,IAAzB,IAAyB,aAAzB,GAAyB,MAAzB,GAAyB,GAAE75B,mBAAtD;AAEA,mBAAK6P,kBAAL,GAA0B,sBAAK/f,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE+pC,cAAX,MAAyB,IAAzB,IAAyB,aAAzB,GAAyB,MAAzB,GAAyB,GAAEhqB,kBAA3B,MAA6C,YACtE,SAAK/f,IADiE,MAC7D,IAD6D,IAC7D,aAD6D,GAC7D,MAD6D,GAC7D,GAAE+pC,cAD2D,MAC7C,IAD6C,IAC7C,aAD6C,GAC7C,MAD6C,GAC7C,GAAEhqB,kBAAF,CACvB1vB,MADuB,CAChB,UAAC22E,SAAD,EAAe;AAAD;;AAAC,mBAAAA,SAAS,CAACtrE,EAAV,MAAY,YAAK,SAAKsE,IAAV,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAE+pC,cAAhB,MAA8B,IAA9B,IAA8B,aAA9B,GAA8B,MAA9B,GAA8B,GAAEruC,EAA5C;AAA8C,WAD7C,EAEvBpM,GAFuB,CAEnB,UAAC03E,SAAD;AAAA,mBAAgB,MAAD,OAAC,CAAD,kBAChBA,SADgB,CAAC,EACR;AACZzrE,yBAAW,EAAEyrE,SAAS,CAACzrE,WAAV,GAAwB,IADzB;AAEZnR,oBAAM,EAAE,IAAI,UAAAuQ,MAAJ,CAAW;AAClBlR,oBAAI,EAAEu9E,SAAS,CAACzrE,WAAV,GAAwB,IADZ;AAElBuV,2BAAW,EAAE,KAFK;AAGlBC,2BAAW,EAAE,SAAK/Q,IAAL,CAAU+pC,cAAV,CAAyB17C;AAHpB,eAAX;AAFI,aADQ,CAAhB;AAAA,WAFmB,CADA,CAA1B;AAYA;;AA1B+D;AA4B/D;;;;qCAEmB;AAChB,eAAKu/B,SAAL,CAAeC,KAAf;AACH;;;wCAEsB;AAAA;;AACnB,eAAKwhD,QAAL,GAAgB,IAAhB;AACA,eAAKrvE,IAAL,CAAUspD,QAAV;AACA,eAAKlhE,OAAL,CAAa,YAAb,EAA2B;AAAA,mBAAM,QAAI,CAAC4iF,UAAL,EAAN;AAAA,WAA3B,EAAoD,IAApD;AACH;;;8CAU4B;AACzB,eAAKH,cAAL,GAAsB,CAAC,KAAKA,cAA5B;AACH;;;4BA5DqB;;;AAClB,iBAAO,KAAKwE,QAAL,aACE,KAAKj5D,KADP,0BAED,YAAKpW,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEopB,MAAX,IACA,wDADA,GAEA,+CAJN;AAKH;;;0BA4CyBiuC,G,EAAc;AACpC,eAAKkP,eAAL,GAAuBlP,GAAvB;AACH,S;4BAEwB;AACrB,iBAAO,KAAKkP,eAAZ;AACH;;;;MApE4C,OAAA1hF,S;;AArEjD;;;uBAqEa8kF,2B,EAA2B,qBAqBxB,SAAAt+B,eArBwB,C,EAqBT,qC;AAAA,K;;;YArBlBs+B,2B;AAA2B,+C;AAAA,+C;AAAA,c;AAAA,a;AAAA,o1B;AAAA;AAAA;AAlEhC;AACI;AAKA;AACI;AACA;AAAkB;AAAc;AACpC;AACA;AA0CA;AASJ;;;;AA5D4B;AAAA;AAKc;AAAA;AAEhB;AAAA;AAEa;AAAA;AA0CO;AAAA;;;;;;;;;;;2BAczCA,2B,EAA2B;cArEvC,OAAAr+B,SAqEuC;eArE7B;AACPjlD,kBAAQ,EAAE,0BADH;AAEPuxD,kBAAQ,wqGAFD;AAkEPpM,mBAAS,EAAE,CAAC,uCAAD,CAlEJ;AAmEPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AAnE1B,S;AAqE6B,Q;;;;kBAqB/B,OAAA0pB,M;mBAAO,SAAA+S,e;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9GhB;AAAA;AAAA;;AAOA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAYA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAOA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;AC1BgB;AACI;AAMI;AAAA;AAAA;AAAA;AAAA,WAAuD,OAAvD,EAAuD;AAAA;AAAA;AAAA;AAAA,SAAvD;AAEH;AACL;;;;;AARQ;AAAA,uDAAyB,UAAzB,EAAyB,qBAAzB,EAAyB,MAAzB,EAAyB,WAAzB,EAAyB,SAAzB,EAAyB,cAAzB,EAAyB,eAAzB,EAAyB,oBAAzB;;;;;;;;AAWR;AAMI;AAAA;AAAA;AAAA;AAAA;AACH;;;;;AANG,uDAAyB,OAAzB,EAAyB,mBAAzB,EAAyB,QAAzB,EAAyB,aAAzB,EAAyB,UAAzB,EAAyB,eAAzB,EAAyB,SAAzB,EAAyB,cAAzB;;;;;;AAhBZ;AACI;AACI;AAWJ;AACA;AAUJ;;;;;;;AAtBsB;AAAA,oDAAyC,UAAzC,EAAyC,GAAzC;;;;;;;;AAuBtB;AACI;AAKI;AAAA;AAAA;AAAA;AAAA;AACH;AACL;;;;;AANQ;AAAA,qDAAuB,SAAvB,EAAuB,cAAvB,EAAuB,OAAvB,EAAuB,IAAvB,EAAuB,qBAAvB,EAAuB,0BAAvB;;;;QDiBHihC,wB;;;;;AAYT,wCACY1jC,OADZ,EAEWjjC,QAFX,EAGWmT,SAHX,EAGqC;AAAA;;AAAA;;AAEjC;AAJQ,iBAAA8vB,OAAA,GAAAA,OAAA;AACD,iBAAAjjC,QAAA,GAAAA,QAAA;AACA,iBAAAmT,SAAA,GAAAA,SAAA;AAZX;;AACiB,iBAAA3hB,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AAGjB;;AACiB,iBAAAm9B,YAAA,GAAe,IAAI,OAAAn9B,YAAJ,EAAf;AAEjB,iBAAAk6B,YAAA,GAAwB,KAAxB;AAgBO,iBAAArJ,gBAAA,GAAmB,0BAAAA,gBAAnB;AACA,iBAAA8H,SAAA,GAAqB,KAArB;AACA,iBAAA6N,aAAA,GAAyB,IAAzB;AAEA,iBAAA7sE,OAAA,GAAmB,KAAnB,CAf8B,CA8ErC;;AACO,iBAAA8sE,YAAA,GAAe,UAACC,QAAD,EAA+BC,QAA/B,EAAgE;AAClF;AACA,cAAMC,QAAQ,GAAG,EAAjB;AACAD,kBAAQ,CAAC7nF,OAAT,CAAiB,UAACC,CAAD,EAAO;AACpB,gBAAI6nF,QAAQ,CAAC7nF,CAAC,CAAC4T,EAAH,CAAZ,EAAoB;AAChBi0E,sBAAQ,CAAC7nF,CAAC,CAAC4T,EAAH,CAAR,CAAew2C,SAAf,CAAyBy9B,QAAQ,CAAC7nF,CAAC,CAAC4T,EAAH,CAAR,CAAewwB,MAAf,GAAwBpkC,CAAC,CAACokC,MAAnD;AACH,aAFD,MAEO;AACHyjD,sBAAQ,CAAC7nF,CAAC,CAAC4T,EAAH,CAAR,GAAiB5T,CAAjB;AACH;AACJ,WAND;AAOA2nF,kBAAQ,CAAC5nF,OAAT,CAAiB,UAACC,CAAD,EAAO;AACpB,gBAAI6nF,QAAQ,CAAC7nF,CAAC,CAAC4T,EAAH,CAAZ,EAAoB;AAChBi0E,sBAAQ,CAAC7nF,CAAC,CAAC4T,EAAH,CAAR,CAAew2C,SAAf,CAAyBy9B,QAAQ,CAAC7nF,CAAC,CAAC4T,EAAH,CAAR,CAAewwB,MAAf,GAAwBpkC,CAAC,CAACokC,MAAnD;AACH,aAFD,MAEO;AACHyjD,sBAAQ,CAAC7nF,CAAC,CAAC4T,EAAH,CAAR,GAAiB5T,CAAjB;AACH;AACJ,WAND,EAVkF,CAiBlF;;AACA,cAAML,KAAK,GAAG,EAAd;;AACA,eAAK,IAAM0K,IAAX,IAAmBw9E,QAAnB,EAA6B;AACzBloF,iBAAK,CAAC6J,IAAN,CAAWq+E,QAAQ,CAACx9E,IAAD,CAAnB;AACH,WArBiF,CAsBlF;;;AACA,iBAAO1K,KAAP;AACH,SAxBM;;AA/E8B;AAGpC;;;;mCAEc;AACd,eAAK46E,qBAAL;AACA;;;;AAiED;mCACe;;;AACX,cAAMhgD,KAAK,GAAG,IAAI,cAAA7C,aAAJ,CAAkB;AAAE+C,4BAAgB,EAAE,CAAF,KAAE,KAAKnkB,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAE/P;AAAlC,WAAlB,CAAd;AACA,eAAKuhF,YAAL,GAAoBvtD,KAApB;AACH;AA6BD;;;;yCACwBA,K,EAAsB;AAAA;;AAC1C;AACA,cAAIA,KAAJ,EAAW;AACP,iBAAKktD,aAAL,GAAqB,KAArB;AACA,gBAAMntD,MAAM,GAAG,KAAKxc,IAAL,CAAUovB,QAAV,CAAmBzV,QAAnB,CAA4B5yB,KAA3C,CAFO,CAGP;;AACA,gBAAM5E,KAAK,GAAGq6B,MAAM,CAACmV,SAAP,CAAiB,UAACs4C,QAAD,EAAc;AACzC,qBAAOxtD,KAAK,CAAC3mB,EAAN,KAAam0E,QAAQ,CAACn0E,EAA7B;AACH,aAFa,CAAd,CAJO,CAQP;;AACA,gBAAI3T,KAAK,GAAG,CAAZ,EAAe;AACX;AACAq6B,oBAAM,CAAC9wB,IAAP,CAAY+wB,KAAZ;AACH,aAHD,MAGO;AACH;AACAD,oBAAM,CAAClsB,MAAP,CAAcnO,KAAd,EAAqB,CAArB,EAAwBs6B,KAAxB;AACH,aAfM,CAiBP;;;AACA,gBAAMytD,WAAW,GAAG,EAApB;AACA,gBAAMC,YAAY,GAAG,EAArB;AACA3tD,kBAAM,CAACv6B,OAAP,CAAe,UAACwsB,CAAD,EAAO;AAClB,kBAAIy7D,WAAW,CAACz7D,CAAC,CAACmN,aAAH,CAAf,EAAkC;AAC9B;AACAsuD,2BAAW,CAACz7D,CAAC,CAACmN,aAAH,CAAX,GAA+B,QAAI,CAACguD,YAAL,CAAkBn7D,CAAC,CAAC5sB,KAApB,EAA2BqoF,WAAW,CAACz7D,CAAC,CAACmN,aAAH,CAAtC,CAA/B;AACH,eAHD,MAGO;AACH;AACAsuD,2BAAW,CAACz7D,CAAC,CAACmN,aAAH,CAAX,GAA+BnN,CAAC,CAAC5sB,KAAjC,CAFG,CAGH;;AACAsoF,4BAAY,CAAC17D,CAAC,CAACmN,aAAH,CAAZ,GAAgCnN,CAAhC;AACA07D,4BAAY,CAAC17D,CAAC,CAACmN,aAAH,CAAZ,CAA8B/5B,KAA9B,GAAsC,EAAtC;AACH;AACJ,aAXD,EApBO,CAiCP;;AACA,gBAAIuoF,kBAAkB,GAAG,EAAzB;;AACA,iBAAK,IAAMC,YAAX,IAA2BF,YAA3B,EAAyC;AACrC,kBAAM1tD,MAAK,GAAG0tD,YAAY,CAACE,YAAD,CAA1B;AACA5tD,oBAAK,CAAC56B,KAAN,GAAcqoF,WAAW,CAACG,YAAD,CAAzB;AACAD,gCAAkB,CAAC1+E,IAAnB,CAAwB+wB,MAAxB;AACH;;AAED,iBAAKzc,IAAL,CAAUovB,QAAV,CAAmBzV,QAAnB,CAA4Bl1B,QAA5B,CAAqC2lF,kBAArC;AACH;;AACD,eAAKJ,YAAL,GAAoB,IAApB;AACH;;;wCAEsB;AACnB;AACA,eAAKL,aAAL,GAAqB,IAArB;AACA,eAAKK,YAAL,GAAoB,IAApB,CAHmB,CAKnB;;AACA,eAAKhqE,IAAL,CAAUovB,QAAV,CAAmBzV,QAAnB,CAA4Bl1B,QAA5B,CAAqC,KAAK+T,OAAL,CAAamhB,QAAb,CAAsBjwB,GAAtB,CAA0B,UAAA+yB,KAAK;AAAA,mBAAIA,KAAK,CAACwD,KAAN,EAAJ;AAAA,WAA/B,CAArC;AACA,eAAK1uB,KAAL,CAAWgzC,IAAX;AACH;;;4CAE0B;AACvB,eAAKhzC,KAAL,CAAWgzC,IAAX;AACH;AAED;;;;mDACmC;AAAA;;AAC/B,cAAMG,GAAG,GAAG,KAAK1B,OAAL,CAAannC,IAAb,CACR,kBAAA8rC,6BADQ,EAER;AACI/C,oBAAQ,EAAE,MADd;AAEIC,iBAAK,EAAE,MAFX;AAGIzqC,gBAAI,EAAE;AACF8L,oBAAM,EAAE,KAAKlG,IAAL,CAAUovB,QAAV,CAAmBra,UAAnB,CAA8BhuB,KADpC;AAEFkhD,yBAAW,EAAE,KAAKjoC,IAAL,CAAUovB,QAAV,CAAmB9W,KAF9B;AAGFqB,sBAAQ,EAAE,KAAK3Z,IAAL,CAAUovB,QAAV,CAAmBzV,QAH3B;AAIFnhB,qBAAO,EAAE,KAAKA;AAJZ;AAHV,WAFQ,CAAZ;;AAaA,eAAK5W,YAAL,CACI,cADJ,EAEI8iD,GAAG,CAACM,iBAAJ,CAAsBzzC,KAAtB,CAA4BzP,SAA5B,CAAsC,UAACyP,KAAD,EAAwB;AAC1D;;AACA;AACA,gBAAIA,KAAK,CAACgW,MAAN,KAAiB,MAArB,EAA6B;AACzB;AACAm9B,iBAAG,CAACzc,KAAJ,GAFyB,CAIzB;;AACA,sBAAI,CAACnrB,OAAL,GAAe,IAAf;AACA,sBAAI,CAACg/D,SAAL,GAAiB,IAAjB;;AAEA,sBAAI,CAACwO,WAAL;AACH;AACJ,WAbD,CAFJ;AAiBA5lC,aAAG,CAACU,WAAJ,GAAkBtjD,SAAlB,CAA4B;AAAA,mBAAM,QAAI,CAACnC,KAAL,CAAW,cAAX,CAAN;AAAA,WAA5B;AACH;;;sCAEoB;AAAA;;AACjB;AACA,cAAI6Y,OAAO,GAAG,KAAKA,OAAL,CAAaynB,KAAb,EAAd;AACAznB,iBAAO,CAACmhB,QAAR,GAAmB,KAAK3Z,IAAL,CAAUovB,QAAV,CAAmBzV,QAAnB,CAA4B5yB,KAA/C;AACAyR,iBAAO,CAAC8f,KAAR,GAAgB,KAAKtY,IAAL,CAAUovB,QAAV,CAAmB9W,KAAnB,CAAyBvxB,KAAzC;;AACA,cAAGyR,OAAO,CAAC8f,KAAR,CAAcvyB,MAAd,IAAwByS,OAAO,CAACmhB,QAAR,CAAiB5zB,MAA5C,EAAoD;AAEhD,gBAAMwY,KAAK,GAAG,MAAH,OAAG,CAAH,EAAG,EAAK/F,OAAO,CAAC+F,KAAb,CAAd;AACAA,iBAAK,CAAC/F,OAAO,CAACuO,KAAR,CAAc9R,KAAf,CAAL,GAA8BuD,OAAO,CAAC+F,KAAR,CAAc/F,OAAO,CAACuO,KAAR,CAAc9R,KAA5B,KAAsC,GAApE;AACAuD,mBAAO,CAAC+F,KAAR,GAAgBA,KAAhB;AAEA,gBAAMkT,SAAS,GAAG,MAAH,OAAG,CAAH,EAAG,EAAKjZ,OAAO,CAACiZ,SAAb,CAAlB;AACAA,qBAAS,CAACjZ,OAAO,CAACuO,KAAR,CAAc9R,KAAf,CAAT,GAAiCuD,OAAO,CAACiZ,SAAR,CAAkBjZ,OAAO,CAACuO,KAAR,CAAc9R,KAAhC,KAA0C,GAA3E;AACAuD,mBAAO,CAACiZ,SAAR,GAAoBA,SAApB;AACH,WAdgB,CAiBjB;;;AACA,eAAKyB,SAAL,CAAe4lB,IAAf,CAAoBtgC,OAApB,EAA6BA,OAAO,CAAC4R,YAArC,EAAoD7J,IAApD,CACI,UAACyR,GAAD,EAAS;AACL,oBAAI,CAACxZ,OAAL,GAAe,IAAI,cAAA+P,OAAJ,CAAY,MAAD,OAAC,CAAD,kBAAM,QAAI,CAAC/P,OAAX,CAAC,EAAsBwZ,GAAG,CAACyR,SAAJ,EAAtB,CAAZ,CAAf,CADK,CAEL;;AACA,oBAAI,CAACg5C,qBAAL;;AAEA,oBAAI,CAAC3/D,OAAL,GAAe,KAAf;AACA,oBAAI,CAACg/D,SAAL,GAAiB,IAAjB;;AACA,oBAAI,CAACvqE,KAAL,CAAWgzC,IAAX,CAAgB,QAAI,CAACvkC,IAArB;AACH,WATL,EAUI,UAAC2B,GAAD,EAAS;AACL;AACA,oBAAI,CAAC7E,OAAL,GAAe,KAAf;AACA,oBAAI,CAACg/D,SAAL,GAAiB,KAAjB;;AACA,oBAAI,CAAC/7D,QAAL,CAAc23B,WAAd;AAGH,WAjBL;AAmBH;;;6CAE2BgY,M,EAAa;AACrC,cAAMlzB,MAAM,GAAG,KAAKxc,IAAL,CAAUovB,QAAV,CAAmBzV,QAAnB,CAA4B5yB,KAA3C,CADqC,CAErC;;AACA,cAAI2oD,MAAM,CAAC5mD,IAAP,KAAgB,UAApB,EAAgC;AAC5B;AACA,iBAAK6gF,aAAL,GAAqB,IAArB;AACA,iBAAKK,YAAL,GAAoB,IAApB,CAH4B,CAI5B;;AACA,iBAAKhqE,IAAL,CAAUovB,QAAV,CAAmBzV,QAAnB,CAA4Bl1B,QAA5B,CAAqC,KAAK+T,OAAL,CAAamhB,QAAb,CAAsBjwB,GAAtB,CAA0B,UAAA+yB,KAAK;AAAA,qBAAIA,KAAK,CAACwD,KAAN,EAAJ;AAAA,aAA/B,CAArC;AACA,iBAAK1uB,KAAL,CAAWgzC,IAAX;AACH;;AACD,cAAImL,MAAM,CAAC5mD,IAAP,KAAgB,MAApB,EAA4B;AACxB;AACA,iBAAK6gF,aAAL,GAAqB,KAArB;;AACA,gBAAIntD,MAAM,CAACz2B,MAAX,EAAmB;AACf,mBAAKwkF,wBAAL;AACH,aAFD,MAEO;AACH;AACA,mBAAKztE,OAAL,GAAe,IAAf;AACA,mBAAKg/D,SAAL,GAAiB,IAAjB;AACA,mBAAKwO,WAAL;AACH;AACJ;AACJ;;;uCAEqB;AAClB;AACA,eAAKxO,SAAL,GAAiB,KAAjB;AACA,eAAK6N,aAAL,GAAqB,IAArB;AACA,eAAKrJ,YAAL,CAAkB/7B,IAAlB;AACH;AAED;;;;;;;;gDAK+B;AAE3B;AACA,eAAK26B,mBAAL,GAA2B;AAC3B1mE,mBAAO,EAAE,KAAKA,OADa;AAE3B6P,kBAAM,EAAE,KAAKA,MAFc;AAG3B82D,sBAAU,EAAE,KAAKA,UAHU;AAI3BC,yBAAa,EAAE,KAAKA,aAJO;AAK3BC,sBAAU,EAAE,KAAKA,UALU;AAM3BC,0BAAc,EAAE,KAAKA,cANM;AAO3Bx2E,gBAAI,EAAE,KAAKA,IAPgB;AAQ3Bu0E,wBAAY,EAAE,KAAKA,YARQ;AAS3B;AACAkC,oCAAwB,EAAE,KAAKA,wBAAL,CAA8BrR,IAA9B,CAAmC,IAAnC;AAVC,WAA3B;AAcH;AAEA;;;;;;;;;;;;mDASiC;;;AAC9B,cAAMppB,SAAS,GAAG,sBAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMtsC,OAAN,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEge,IAAf,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAEipD,gBAArB,KAAqC,YAAG,SAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMjnE,OAAT,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEge,IAAlB,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAEkpD,oBAA7D,CAAlB;AACA,iBAAO;AAAEC,uBAAW,EAAE,CAAC,CAAC76B,SAAjB;AAA4B86B,2BAAe,EAAE96B;AAA7C,WAAP;AACH;AAED;;;;;;;;;;4BAtSmB;AACf,iBAAO,KAAKtsC,OAAL,CAAage,IAAb,CAAkBtP,QAAzB;AACH;;;;AAED;4BAC4B;AACxB,iBAAO,KAAKlH,IAAL,IAAa,KAAKA,IAAL,CAAUovB,QAAV,CAAmBzV,QAAhC,GAA2C,KAAK3Z,IAAL,CAAUovB,QAAV,CAAmBzV,QAA9D,GAAyE,IAAhF;AACH;AAED;;;;4BACqB;;;AACjB,iBAAO,KAAK3Z,IAAL,KAAS,kBAAI,KAAKA,IAAT,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEovB,QAAf,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAEra,UAAzB,MAAmC,IAAnC,IAAmC,aAAnC,GAAmC,MAAnC,GAAmC,GAAEhuB,KAAF,CAAQhB,MAApD,IACD,KAAKia,IAAL,CAAUovB,QAAV,CAAmBra,UAAnB,CAA8BhuB,KAD7B,GAED,EAFN;AAGH;AAED;;;;4BACiB;AACb,iBAAO,KAAKiZ,IAAL,IAAa,KAAKA,IAAL,CAAUovB,QAAV,CAAmB5qC,MAAhC,GACD,KAAKwb,IAAL,CAAUovB,QAAV,CAAmB5qC,MAAnB,CAA0BuC,KADzB,GAED,UAAAuG,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB8J,YAApB,CAAiC,QAAjC,CAFN;AAGH;AAED;;;;4BACmB;AACf,iBAAO,KAAKyS,IAAL,IAAa,KAAKA,IAAL,CAAUovB,QAAV,CAAmBxqC,QAAhC,GAA2C,KAAKob,IAAL,CAAUovB,QAAV,CAAmBxqC,QAAnB,CAA4BmC,KAAvE,GAA+E,EAAtF;AACH;AAED;;;;4BACkB;AACd,iBAAO,KAAKiZ,IAAL,IAAa,KAAKA,IAAL,CAAUovB,QAAV,CAAmB7V,OAAhC,IAA2C,KAAKvZ,IAAL,CAAUovB,QAAV,CAAmB7V,OAAnB,CAA2BxyB,KAA7E;AACH;;;4BAGiB;;;AACd,iBAAO,OAAAiM,WAAA,CAAY,CAAD,KAAC,KAAKwF,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,WAAxB,CAAP;AACH;;;4BAEuB;AACpB,iBAAO,OAAAzJ,wBAAA,CAAyB,KAAKyJ,OAAL,CAAa/J,WAAtC,CAAP;AACH;;;4BAEuB;;;AACpB,iBAAO,OAAAE,gCAAA,CAAiC,KAAK6J,OAAL,CAAa/J,WAA9C,EAA2D,CAAF,KAAE,KAAK+J,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAEwjB,gBAAzE,CAAP;AACH;;;4BAE2B;;;AACxB,iBAAO,OAAAnxB,gBAAA,CAAiB,CAAD,KAAC,KAAK2N,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAE5T,QAA/B,CAAP;AACH;;;4BAEmB;AAChB,iBAAO,cAAAyrB,oBAAA,CAAqB,KAAK7X,OAA1B,CAAP;AACH;;;4BAyPqB;AACtB;AACA,cAAIunE,eAAe,GAAiB,EAApC;AAFsB,+BAGmD,KAAKvnE,OAHxD;AAAA,cAGd4R,YAHc,kBAGdA,YAHc;AAAA,cAGAK,iBAHA,kBAGAA,iBAHA;AAAA,cAGmB0P,kBAHnB,kBAGmBA,kBAHnB;AAAA,cAGuC1xB,QAHvC,kBAGuCA,QAHvC;;AAItB,cAAG2hB,YAAY,IAAIK,iBAAiB,CAAC1kB,MAArC,EAA6C;AAC3Cg6E,2BAAe,GAAG,KAAKvnE,OAAL,CAAaiS,iBAA/B;AACD,WAFD,MAGK,IAAGL,YAAY,IAAI,CAACK,iBAAiB,CAAC1kB,MAAnC,IAA6Co0B,kBAAkB,CAACp0B,MAAnE,EAA2E;AAC9E,iBAAKyS,OAAL,CAAa2hB,kBAAb,CAAgCl4B,OAAhC,CAAwC,UAAAR,OAAO,EAAI;AACjDs+E,6BAAe,CAACr0E,IAAhB,CAAqB,IAAI,UAAAqJ,MAAJ,CAAW;AAAElR,oBAAI,EAAEpC,OAAO,CAACkU,WAAR,GAAsB,IAA9B;AAAoCuV,2BAAW,EAAE,KAAjD;AAAwDC,2BAAW,EAAE1iB;AAArE,eAAX,CAArB;AACD,aAFD;AAGAs3E,2BAAe,GAAGA,eAAe,CAACh0E,IAAhB,CAAqB,UAAC20B,EAAD,EAAaC,EAAb;AAAA,qBAA4BD,EAAE,CAAClzB,EAAH,GAAQmzB,EAAE,CAACnzB,EAAvC;AAAA,aAArB,CAAlB;AACD,WALI,MAMA;AACHuyE,2BAAe,GAAG,CAAC,KAAKvnE,OAAL,CAAa/J,WAAd,CAAlB;AACD,WAfqB,CAkBtB;AACA;;;AACA,iBAAO,OAAAO,4BAAA,CAA6B,cAAA8/B,mBAAA,CAAoBixC,eAApB,CAA7B,CAAP;AACD;;;;MAnW2C,OAAAz/E,a;;AAL9C;;;uBAKaomF,wB,EAAwB,kC,EAAA,2C,EAAA,wC;AAAA,K;;;YAAxBA,wB;AAAwB,uC;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,inB;AAAA;AAAA;ACtDrC;AACI;AACI;AAII;AAAA,mBAAiB,IAAAzI,aAAA,EAAjB;AAAgC,WAAhC;AACJ;AACF;AACF;AACI;AAyBA;AASJ;AACJ;;;;AA1CY;AAAA,4DAA+B,OAA/B,EAA+B,IAA/B,EAA+B,UAA/B,EAA+B,IAA/B;AAO6C;AAAA;AAyBA;AAAA;;;;;;;;2BDmB5CyI,wB,EAAwB;cALpC,OAAAhhC,SAKoC;eAL1B;AACPjlD,kBAAQ,EAAE,kBADH;AAEPklD,qBAAW,EAAE,2BAFN;AAGPC,mBAAS,EAAE,CAAC,2BAAD;AAHJ,S;AAK0B,Q;;;;;;;;;;gBAEhC,OAAAziD;;;gBAEA,OAAA0iD;;;gBACA,OAAA1iD;;;gBACA,OAAAA;;;gBAEA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AE9DL;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;ACMI;AACI;AAOJ;;;;;;AANQ;AAAA,iDAAmB,UAAnB,EAAmB,eAAnB,EAAmB,QAAnB,EAAmB,aAAnB,EAAmB,MAAnB,EAAmB,OAAnB,EAAmB,OAAnB,EAAmB,YAAnB;;;;;;AAHZ;AACI;AASJ;;;;;AATsB;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;AAWlB;AACI;AACI;AACJ;AACA;AAAA;AAEA;AACJ;;;;AALkB;AAAA;;;;;;;;;;;QDZTghC,6B,GALb;AAAA;;AAgBI;AACiB,WAAA5+C,KAAA,GAAQ,IAAI,OAAAkb,YAAJ,EAAR;AACpB,K;;AAlBD;;;uBAKa0jC,6B;AAA6B,K;;;YAA7BA,6B;AAA6B,yC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,c;AAAA,a;AAAA,+T;AAAA;AAAA;ACV1C;AACI;AACI;AAAwB;AAAA,mBAAS,IAAA5+C,KAAA,OAAT;AAAqB,WAArB;AACpB;AACJ;AACA;AAAkB;AAAoB;AAC1C;AACJ;AACA;AAWA;;;;;;AAhBsB;AAAA;AAEI;AAAA;AAGZ;AAAA,mGAAmF,UAAnF,EAAmF,GAAnF;;;;;;;;;2BDED4+C,6B,EAA6B;cALzC,OAAAnhC,SAKyC;eAL/B;AACPjlD,kBAAQ,EAAE,oBADH;AAEPklD,qBAAW,EAAE,2BAFN;AAGPC,mBAAS,EAAE,CAAC,2BAAD;AAHJ,S;AAK+B,Q;;gBAErC,OAAAziD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AEtBL;AAAA;AAAA;;AAUA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAaA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7BwB;AACI;AACJ;;;;;AAF6C;AACzC;AAAA;;;;;;AALhB;AACI;AAAA;AAA2E;AAC3E;AACI;AACI;AAGJ;AACJ;AACJ;;;;;AALwB;AAAA;;;;;;;;;;;;;;;;;;AAUZ;AACI;AACJ;;;;;AAFiD;AAC7C;AAAA;;;;;;AALhB;AACI;AAAA;AAAsF;AACtF;AACI;AACI;AAGJ;AACJ;AACJ;;;;;AALwB;AAAA;;;;;;;;;;;;;;;;;;;;;AAhBhC;AACI;AACI;AAUA;AAUA;AACI;AAGI;AAAA;AAAA;AAAA;AAAA,iCAGlB,qBAAa,EAAb,CAHkB,GAGC,EAHD;AAGG;AAAA,SAHH;AAMA;AAMJ;AACA;AACI;AACI;AACI;AAII;AAAA;AAAA;AAAA,iBAAiB,QAAAgL,OAAA,aAAjB;AAAqC,SAArC;;AAJJ;AAQJ;AACJ;AACJ;AACJ;AACJ;AACJ;;;;;AAtDU;AAAA;AACiB;AAAA;AAUA;AAAA;AAUC;AAAA;AAGZ;AAAA;AAQI;AAAA;AAMkB;AAAA;AAMV;AAAA,yEAA2B,gBAA3B,EAA2B,4BAA3B;;;;;;AAapB;AACI;AAOJ;;;;;;AANQ;AAAA,kDAAmB,UAAnB,EAAmB,6DAAnB,EAAmB,QAAnB,EAAmB,cAAnB,EAAmB,MAAnB,EAAmB,QAAnB,EAAmB,OAAnB,EAAmB,2BAAnB;;;;;;AAHZ;AACI;AASJ;;;;;AATsB;AAAA;;;;;;;;AAaV;AAMI;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEA;AACA;AAAkB;AAAe;AACrC;;;;;;AANI;AACA;AAIkB;AAAA;;;;;;AAV1B;AACI;AAWJ;;;;;AARQ;AAAA;;;;;;AALZ;AACI;AAaJ;;;;;;;;AAb0B;AAAA,iFAA2D,UAA3D,EAA2D,GAA3D;;;;;;AAD1B;;;;;;;;AAAc,wDAA+C,UAA/C,EAA+C,GAA/C;;;;;;AAbtB;;AACI;;AAWA;AAiBJ;;;;;;;AA7BkB;AACA;AAAA,oEAAkC,UAAlC,EAAkC,IAAlC;;;;;;;;;;;;;;;;;;;;;;;AAwDlB;AACI;AACI;AACJ;AACA;AAAA;AACgB;AAAyD;AAEzE;AAAA;AACJ;;;;;AADI;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;AAIJ;AACI;AACI;AACI;AACJ;AACA;AAAA;AAEA;AACJ;AACJ;;;;;AAFQ;AAAA;AAAA;;;;;;;;AAKR;AAMI;AAAA;AAAA;AAAA,2CAA2B,IAA3B;AAA+B,SAA/B;AACH;;;;;AANG,iDAAmB,UAAnB,EAAmB,sBAAnB,EAAmB,QAAnB,EAAmB,aAAnB,EAAmB,OAAnB,EAAmB,0BAAnB,EAAmB,UAAnB,EAAmB,6BAAnB;;;;QDzFK81B,oC;;;;;AAyFT,oDACY6D,KADZ,EAEY53D,IAFZ,EAGYowB,OAHZ,EAG8B;AAAA;;AAAA;;AAE1B;AAJQ,iBAAAwnC,KAAA,GAAAA,KAAA;AACA,iBAAA53D,IAAA,GAAAA,IAAA;AACA,iBAAAowB,OAAA,GAAAA,OAAA;AA7EZ;;AACiB,iBAAAzxC,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AAGjB;;AACO,iBAAAsnC,aAAA,GAAoC,EAApC;AAGP;;AACO,iBAAAC,eAAA,GAA8B,EAA9B;AAKP;;AACgB,iBAAA75B,OAAA,GAAU,IAAI,OAAAvxD,eAAJ,CAAoB,EAApB,CAAV;AAChB;;AACO,iBAAAqrF,aAAA,GAAgC,EAAhC;AA4DuB;AAG7B;AA3DD;;;;;mCA6De;AAAA;;AACX,eAAKt6B,sBAAL;AACA,eAAKzuD,YAAL,CAAkB,QAAlB,EAA4B,KAAKivD,OAAL,CAAal8C,IAAb,CAAkB,YAAAjL,GAAA,CAAI,UAACW,GAAD,EAAS;AACvD,gBAAMgqB,MAAM,GAAGhqB,GAAG,CAACkB,WAAJ,EAAf;AACA,gBAAM1J,KAAK,GAAG,EAAd;;AAFuD,yDAGhC,QAAI,CAAC4oF,aAH2B;AAAA;;AAAA;AAGvD,wEAA2C;AAAA,oBAAhC3tC,QAAgC;;AACvC,oBAAIA,QAAQ,CAACj7C,KAAb,EAAoB;AAAA,+DACIi7C,QAAQ,CAACj7C,KADb;AAAA;;AAAA;AAChB,8EAAoC;AAAA,0BAAzB4mB,KAAyB;;AAChC,0BAAKA,KAAa,CAAC5mB,KAAnB,EAA0B;AACtB,4BACK4mB,KAAa,WAAb,KACAA,KAAK,CAAC7oB,IAAN,CAAW2L,WAAX,GAAyBoS,QAAzB,CAAkC0W,MAAlC,KACI5L,KAAa,CAAC5mB,KAAd,CAAoBwF,IAApB,CAAyB,UAACkF,IAAD;AAAA,iCACtBA,IAAI,CAAC3M,IAAL,CAAU2L,WAAV,GAAwBoS,QAAxB,CAAiC0W,MAAjC,CADsB;AAAA,yBAAzB,CAFJ,CADL,EAME;AACExyB,+BAAK,CAAC6J,IAAN,CAAW+c,KAAX;AACH,yBARD,MAQO;AAAA,uEACiBA,KAAa,CAAC5mB,KAD/B;AAAA;;AAAA;AACH,sFAAyC;AAAA,kCAA9B0K,IAA8B;;AACrC,kCAAIA,IAAI,CAAC3M,IAAL,CAAU2L,WAAV,GAAwBoS,QAAxB,CAAiC0W,MAAjC,CAAJ,EAA8C;AAC1CxyB,qCAAK,CAAC6J,IAAN,CAAWa,IAAX;AACH;AACJ;AALE;AAAA;AAAA;AAAA;AAAA;AAMN;AACJ,uBAhBD,MAgBO;AACH,4BAAIkc,KAAK,CAAC7oB,IAAN,CAAW2L,WAAX,GAAyBoS,QAAzB,CAAkC0W,MAAlC,CAAJ,EAA+C;AAC3CxyB,+BAAK,CAAC6J,IAAN,CAAW+c,KAAX;AACH;AACJ;AACJ;AAvBe;AAAA;AAAA;AAAA;AAAA;AAwBnB;AACJ;AA7BsD;AAAA;AAAA;AAAA;AAAA;;AA8BvD,mBAAO5mB,KAAP;AACH,WA/B6C,CAAlB,EA+BxBC,SA/BwB,CA+Bd,UAACD,KAAD;AAAA,mBAAW,QAAI,CAAC8oF,aAAL,GAAqB9oF,KAAhC;AAAA,WA/Bc,CAA5B;AAgCH;;;oCAEkBN,O,EAAwB;AAAA;;AACvC;AACA,cAAIA,OAAO,CAACsC,IAAR,IAAgBtC,OAAO,CAACqD,QAA5B,EAAsC;AAClC,iBAAKyrD,sBAAL;AACA;;AACA,gBACI,KAAKrwC,IAAL,IACA,CAAC,KAAK0qE,eAAL,CAAqBrjF,IAArB,CACG,UAACgG,IAAD;AAAA,qBAAUA,IAAI,CAACyI,EAAL,KAAY,QAAI,CAACkK,IAAL,CAAUovB,QAAV,CAAmBxT,aAAnB,CAAiC70B,KAAvD;AAAA,aADH,CAFL,EAKE;AACE,mBAAKiZ,IAAL,CAAUovB,QAAV,CAAmBxT,aAAnB,CAAiCn3B,QAAjC,CAA0C,KAAKimF,eAAL,CAAqB,CAArB,EAAwB50E,EAAlE;AACH;AACJ;AACD;;;AACA,cAAIvU,OAAO,CAACwzB,UAAZ,EAAwB;AACpB;AACA,gBAAI,KAAK/U,IAAL,IAAa,KAAK+U,UAAlB,IAAgC,CAAC,KAAK/U,IAAL,CAAUovB,QAAV,CAAmB1S,WAAnB,CAA+B31B,KAApE,EAA2E;AACvE,mBAAKiZ,IAAL,CAAUovB,QAAV,CAAmB1S,WAAnB,CAA+Bj4B,QAA/B,CAAwC,KAAKswB,UAAL,CAAgB,CAAhB,EAAmB9f,KAA3D;AACH;AACJ;AACD;;;AACA,cAAI1T,OAAO,CAACk7B,KAAR,IAAiB,KAAKA,KAA1B,EAAiC;AAC7B,iBAAKmuD,QAAL;AACH;AACJ;;;sCAEoB;AACjB,cAAI,KAAKC,SAAL,IAAkB,KAAKC,WAA3B,EAAwC;AACpC,iBAAKD,SAAL,CAAenpF,aAAf,CAA6B6uD,KAA7B;AACH;AACJ;;;mCAEiB;AAAA;;AACd,eAAKvwC,IAAL,GAAY,IAAI,QAAAihB,SAAJ,CAAc;AACtBnrB,cAAE,EAAE,IAAI,QAAA0oB,WAAJ,CAAgB,KAAK/B,KAAL,CAAW3mB,EAA3B,CADkB;AAEtB6d,wBAAY,EAAE,IAAI,QAAA6K,WAAJ,CACV,KAAKjF,OAAL,GAAe,KAAK/0B,MAAL,CAAY+I,YAAZ,CAAyB,KAAzB,EAAgCC,EAA/C,GAAoD,KAAKhJ,MAAL,CAAYgJ,EADtD,CAFQ;AAKtBkvB,uBAAW,EAAE,IAAI,QAAA8B,WAAJ,CAAgB,KAAK/B,KAAL,CAAWC,WAAX,IAA0B,KAAK3H,UAAL,CAAgB,CAAhB,EAAmB9f,KAA7D,CALS;AAMtB2mB,yBAAa,EAAE,IAAI,QAAA4C,WAAJ,CAAgB,KAAK/B,KAAL,CAAWb,aAAX,IAA4B,KAAK8uD,eAAL,CAAqB,CAArB,EAAwB50E,EAApE,CANO;AAOtBjU,iBAAK,EAAE,IAAI,QAAA28B,WAAJ,CAAgB,KAAK/B,KAAL,CAAW56B,KAAX,CAAiB6H,GAAjB,CAAqB,UAAC6C,IAAD;AAAA,qBAAU,IAAI,cAAA44B,YAAJ,CAAiB54B,IAAjB,CAAV;AAAA,aAArB,CAAhB;AAPe,WAAd,CAAZ;AASA,eAAK3K,YAAL,CACI,cADJ,EAEI,KAAKoe,IAAL,CAAUovB,QAAV,CAAmB1S,WAAnB,CAA+B+C,YAA/B,CAA4C39B,SAA5C,CAAsD,UAACilB,KAAD,EAAW;AAC7D,oBAAI,CAACspC,sBAAL;;AACA,gBACI,CAAC,QAAI,CAACq6B,eAAL,CAAqBrjF,IAArB,CACG,UAACgG,IAAD;AAAA,qBAAUA,IAAI,CAACyI,EAAL,KAAY,QAAI,CAACkK,IAAL,CAAUovB,QAAV,CAAmBxT,aAAnB,CAAiC70B,KAAvD;AAAA,aADH,CADL,EAIE;AACE,sBAAI,CAACiZ,IAAL,CAAUovB,QAAV,CAAmBxT,aAAnB,CAAiCn3B,QAAjC,CAA0C,QAAI,CAACimF,eAAL,CAAqB,CAArB,EAAwB50E,EAAlE;AACH;;AACD,oBAAI,CAACkK,IAAL,CAAUovB,QAAV,CAAmBvtC,KAAnB,CAAyB4C,QAAzB,CAAkC,EAAlC;;AACA,oBAAI,CAACsmF,QAAL;AACH,WAXD,CAFJ;AAeA,eAAKA,QAAL;AACA,eAAK16B,sBAAL;;AACA,cACI,KAAKrwC,IAAL,IACA,CAAC,KAAK0qE,eAAL,CAAqBrjF,IAArB,CAA0B,UAACgG,IAAD;AAAA,mBAAUA,IAAI,CAACyI,EAAL,KAAY,QAAI,CAACkK,IAAL,CAAUovB,QAAV,CAAmBxT,aAAnB,CAAiC70B,KAAvD;AAAA,WAA1B,CAFL,EAGE;AACE,iBAAKiZ,IAAL,CAAUovB,QAAV,CAAmBxT,aAAnB,CAAiCn3B,QAAjC,CAA0C,KAAKimF,eAAL,CAAqB,CAArB,EAAwB50E,EAAlE;AACH;AACJ;;;uCAEqB;AAAA;;AAClB,cAAM4uC,GAAG,GAAG,KAAK1B,OAAL,CAAannC,IAAb,CACkB,kBAAA6rC,oCADlB,EACwD;AAC5D9C,oBAAQ,EAAE,MADkD;AAE5DxqC,gBAAI,EAAE;AACFmf,qBAAO,EAAE,KAAKA,OADZ;AAEF/0B,oBAAM,EAAE,KAAKA,MAFX;AAGFwb,kBAAI,EAAE,KAAKA;AAHT;AAFsD,WADxD,CAAZ;;AASA,eAAKpe,YAAL,CACI,eADJ,EAEI8iD,GAAG,CAACM,iBAAJ,CAAsBzzC,KAAtB,CAA4BzP,SAA5B,CAAsC,UAACyP,KAAD,EAAwB;AAC1D;AACA,gBAAIA,KAAK,CAACgW,MAAN,KAAiB,MAArB,EAA6B;AACzB,kBAAMkV,KAAK,GAAG,IAAI,cAAA7C,aAAJ,CAAkB,MAAD,OAAC,CAAD,kBAAM,QAAI,CAAC6C,KAAX,CAAC,EAAoB,QAAI,CAACzc,IAAL,CAAUjZ,KAA9B,CAAlB,CAAd,CADyB,CAEzB;;AACA,sBAAI,CAACwK,KAAL,CAAWgzC,IAAX,CAAgB9nB,KAAhB;;AACAioB,iBAAG,CAACzc,KAAJ;AACH;AACJ,WARD,CAFJ;AAYAyc,aAAG,CAACU,WAAJ,GAAkBtjD,SAAlB,CAA4B,YAAM;AAC9B,oBAAI,CAACnC,KAAL,CAAW,eAAX;AACH,WAFD;AAGH;;;mCAEkB;AAAA;;AACf,cAAMonB,KAAK,GAAG,KAAKgO,UAAL,CAAgB1tB,IAAhB,CACV,UAAC0f,KAAD;AAAA,mBAAWA,KAAK,CAAC9R,KAAN,KAAgB,QAAI,CAAC+K,IAAL,CAAUovB,QAAV,CAAmB1S,WAAnB,CAA+B31B,KAA1D;AAAA,WADU,CAAd;AAIA,eAAK+V,OAAL,GAAe,IAAf;;AACA,eAAK0tE,KAAL,CACKvzE,KADL,CACW;AAAE6I,mBAAO,EAAE,KAAK8S,IAAL,CAAUja,SAAV,CAAoBtR,IAApB,CAAyB,UAAC4iC,GAAD;AAAA,qBAASljB,KAAK,CAACI,KAAN,CAAYxJ,QAAZ,CAAqBssB,GAAG,CAACn0B,EAAzB,CAAT;AAAA,aAAzB,EAAgEA;AAA3E,WADX,EAEKyK,IAFL,CAGQ,UAACxe,IAAD,EAAU;AACN,oBAAI,CAAC+a,OAAL,GAAe,KAAf;AACA,oBAAI,CAAC2tE,aAAL,GAAqB1oF,IAAI,CAAC2H,GAAL,CAAS,UAACxH,CAAD;AAAA,qBAAO,IAAI,cAAA6iC,gBAAJ,CAAqB7iC,CAArB,CAAP;AAAA,aAAT,EAChBuI,MADgB,CACT,UAAAkI,CAAC;AAAA,qBAAI,CAACA,CAAC,CAAC+zB,YAAP;AAAA,aADQ,CAArB;AAEH,WAPT,EAQQ;AAAA,mBAAO,QAAI,CAAC5pB,OAAL,GAAe,KAAtB;AAAA,WARR;AAUH;AAED;;;;iDACiC;AAAA,sCACE,KAAKkuE,wBAAL,EADF;AAAA,cACvBviF,QADuB,yBACvBA,QADuB;AAAA,cACb1E,KADa,yBACbA,KADa;AAAA,cACNgtB,GADM,yBACNA,GADM;;AAE7BhtB,eAAK,GAAGA,KAAK,CAACU,QAAN,CAAe;AAAEP,kBAAM,EAAEC,IAAI,CAACC,IAAL,CAAUL,KAAK,CAACO,OAAN,GAAgB,CAA1B,IAA+B;AAAzC,WAAf,CAAR,CAF6B,CAG7B;;AACA,cAAMslE,UAAU,GAAG,KAAKplE,MAAxB;AACA,eAAKkmF,eAAL,GAAuB,EAAvB;;AACA,iBAAO3mF,KAAK,CAACo4B,YAAN,CAAmBpL,GAAnB,CAAP,EAAgC;AAC5B,iBAAK25D,eAAL,CAAqBh/E,IAArB,CAA0B;AACtBoK,gBAAE,EAAE3R,IAAI,CAAC23B,GAAL,CAAS8tC,UAAU,CAAC7tC,QAAX,CAAoBh4B,KAApB,EAA2B,SAA3B,CAAT,CADkB;AAEtBnE,kBAAI,EAAEmE,KAAK,CAACoB,UAAN,CAAiB,OAAjB,EAA0BmJ,iBAA1B;AAFgB,aAA1B;AAIAvK,iBAAK,GAAGA,KAAK,CAACW,QAAN,CAAe;AAAEJ,qBAAO,EAAE;AAAX,aAAf,CAAR;AACH;AACD;;;AACA,cAAI,KAAKomF,eAAL,CAAqB3kF,MAArB,KAAgC,CAApC,EAAuC;AACnC,iBAAK2kF,eAAL,CAAqBh/E,IAArB,CAA0B;AAAEoK,gBAAE,EAAE,CAAC,CAAP;AAAUlW,kBAAI,EAAE;AAAhB,aAA1B;AACH;AACJ;;;mDAE+B;AAC5B,cAAMirB,GAAG,GAAG,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAZ;AACA,cAAIgF,QAAQ,GAAGoiB,GAAG,CAACy1B,QAAnB;AACA,cAAM2qC,WAAW,GAAG,KAAKjrE,IAAL,GAAY,KAAKA,IAAL,CAAUovB,QAAV,CAAmB1S,WAAnB,CAA+B31B,KAA3C,GAAmD,IAAvE;AACA,cAAI2pB,cAAc,GAAG;AAAE3sB,iBAAK,EAAE,CAAT;AAAYgtB,eAAG,EAAE;AAAjB,WAArB;AACA,cAAIm6D,aAAa,GAAG,KAAK1mF,MAAL,CAAY+I,YAAZ,CAAyB,KAAzB,CAApB;AACA,cAAI49E,cAAc,GAAGD,aAAa,CAACxmF,QAAd,CAAuB;AAAEwG,iBAAK,EAAEwlB,cAAc,CAAC3sB;AAAxB,WAAvB,CAArB;AACA,cAAIqnF,YAAY,GAAGF,aAAa,CAACxmF,QAAd,CAAuB;AAAEwG,iBAAK,EAAEwlB,cAAc,CAACK;AAAxB,WAAvB,CAAnB;;AAEA,cAAIk6D,WAAJ,EAAiB;AACb;AACA,gBAAMlkE,KAAK,GAAG,KAAKgO,UAAL,CAAgB1tB,IAAhB,CAAqB,UAAC0f,KAAD;AAAA,qBAAWA,KAAK,CAAC9R,KAAN,KAAgBg2E,WAA3B;AAAA,aAArB,CAAd;;AACA,gBAAM/jE,QAAQ,GAAG,KAAK0L,IAAL,CAAUja,SAAV,CAAoBtR,IAApB,CAAyB,UAAC4iC,GAAD;AAAA,qBAASljB,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAEI,KAAP,CAAaxJ,QAAb,CAAsBssB,GAAG,CAACn0B,EAA1B,CAAT;AAAA,aAAzB,CAAjB;;AACA,gBAAIoR,QAAQ,CAACze,QAAb,EAAuB;AACnB;AACAA,sBAAQ,GAAGye,QAAQ,CAACze,QAApB;AACAyiF,2BAAa,GAAG,KAAK1mF,MAAL,CAAYyJ,MAAZ,CAAmBxF,QAAnB,EAA6B8E,YAA7B,CAA0C,KAA1C,CAAhB;AACH;;AACD,gBAAI2Z,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEwJ,cAAd,EAA8B;AAC1B;AACAA,4BAAc,GAAGxJ,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEwJ,cAA3B;AACH,aAZY,CAab;;;AACAy6D,0BAAc,GAAGD,aAAa,CAACxmF,QAAd,CAAuB;AAAEwG,mBAAK,EAAEwlB,cAAc,CAAC3sB;AAAxB,aAAvB,CAAjB;AACAqnF,wBAAY,GAAGF,aAAa,CAACxmF,QAAd,CAAuB;AAAEwG,mBAAK,EAAEwlB,cAAc,CAACK;AAAxB,aAAvB,CAAf;AACH,WAzB2B,CA2B5B;;;AACA,cAAIhtB,KAAK,GAAG,KAAKS,MAAL,CAAYyJ,MAAZ,CAAmBxF,QAAnB,CAAZ;AACA,cAAIsoB,GAAG,GAAG,KAAKvsB,MAAL,CAAYyJ,MAAZ,CAAmBxF,QAAnB,EAA6B/D,QAA7B,CAAsC;AAAEJ,mBAAO,EAAE,KAAKM;AAAhB,WAAtC,CAAV,CA7B4B,CA+B5B;;AACA,cAAIb,KAAK,CAACo4B,YAAN,CAAmBgvD,cAAnB,CAAJ,EAAwC;AACpC;AACA,gBAAIC,YAAY,CAAChvD,WAAb,CAAyBr4B,KAAzB,CAAJ,EAAqC;AACjC;AACAA,mBAAK,GAAGonF,cAAc,CAACzmF,QAAf,CAAwB,EAAxB,CAAR;AACH,aAHD,MAGO;AACH;AACAX,mBAAK,GAAGqnF,YAAY,CAAC1mF,QAAb,CAAsB,EAAtB,CAAR;AACAqsB,iBAAG,GAAGq6D,YAAY,CAAC1mF,QAAb,CAAsB,EAAtB,CAAN;AACA,qBAAO;AAAE+D,wBAAQ,EAARA,QAAF;AAAY1E,qBAAK,EAALA,KAAZ;AAAmBgtB,mBAAG,EAAHA;AAAnB,eAAP;AACH;AACJ,WAXD,MAWO;AACH;AACA,gBAAIq6D,YAAY,CAACjvD,YAAb,CAA0Bp4B,KAA1B,CAAJ,EAAsC;AAClC;AACAA,mBAAK,GAAGqnF,YAAY,CAAC1mF,QAAb,CAAsB,EAAtB,CAAR;AACAqsB,iBAAG,GAAGq6D,YAAY,CAAC1mF,QAAb,CAAsB,EAAtB,CAAN;AACA,qBAAO;AAAE+D,wBAAQ,EAARA,QAAF;AAAY1E,qBAAK,EAALA,KAAZ;AAAmBgtB,mBAAG,EAAHA;AAAnB,eAAP;AACH;AACJ;;AAED,cAAIA,GAAG,CAACoL,YAAJ,CAAiBivD,YAAjB,CAAJ,EAAoC;AAChC;AACA,gBAAID,cAAc,CAAC/uD,WAAf,CAA2BrL,GAA3B,CAAJ,EAAqC;AACjC;AACAhtB,mBAAK,GAAGonF,cAAc,CAACzmF,QAAf,CAAwB,EAAxB,CAAR;AACAqsB,iBAAG,GAAGo6D,cAAc,CAACzmF,QAAf,CAAwB,EAAxB,CAAN;AACA,qBAAO;AAAE+D,wBAAQ,EAARA,QAAF;AAAY1E,qBAAK,EAALA,KAAZ;AAAmBgtB,mBAAG,EAAHA;AAAnB,eAAP;AACH;AACJ,WARD,MAQO;AACH;AACA;AACAA,eAAG,GAAGq6D,YAAY,CAAC1mF,QAAb,CAAsB,EAAtB,CAAN;AACH;;AAED,iBAAO;AAAE+D,oBAAQ,EAARA,QAAF;AAAY1E,iBAAK,EAALA,KAAZ;AAAmBgtB,eAAG,EAAHA;AAAnB,WAAP;AACH;;;4BAzSmB;AAChB,iBACI,CAAC,KAAKi6B,eAAL,CAAqB5iC,YAArB,IAAqC,KAAKqiE,aAAL,CAAmB1kF,MAAzD,MACC,CAAC,KAAKslF,sBAAN,IAAgC,KAAKC,mBADtC,KAEA,CAAC,KAAKC,YAHV;AAKH;AAED;;;;4BAC0B;AACtB,cAAMC,aAAa,GAAG,CAAC,KAAKxrE,IAAL,IAAa;AAAEovB,oBAAQ,EAAE;AAAE1S,yBAAW,EAAE;AAAE31B,qBAAK,EAAE;AAAT;AAAf;AAAZ,WAAd,EAA4DqoC,QAAlF;AACA,cAAMroB,KAAK,GACP,KAAKgO,UAAL,CAAgB1tB,IAAhB,CAAqB,UAAC0f,KAAD;AAAA,mBAAWA,KAAK,CAAC9R,KAAN,IAAeu2E,aAAa,CAAC9uD,WAAd,CAA0B31B,KAApD;AAAA,WAArB,KACC;AAAEgoB,iBAAK,EAAE;AAAT,WAFL;AAGA,iBACI,KAAK6D,IAAL,CAAUja,SAAV,CAAoBtR,IAApB,CAAyB,UAAC4iC,GAAD;AAAA,mBAASljB,KAAK,CAACgI,KAAN,CAAYmb,WAAZ,KAA4BD,GAAG,CAACn0B,EAAzC;AAAA,WAAzB,KACC;AAAE+1B,oCAAwB,EAAE;AAA5B,WAFL;AAIH;AAED;;;;4BACiB;AACb,iBAAO,KAAKmf,eAAL,CAAqBlf,QAArB,IAAiC,KAAxC;AACH;AAED;;;;4BACqB;AACjB,iBAAO,KAAK9rB,IAAL,GACD,KAAKA,IAAL,CAAUovB,QAAV,CAAmBvtC,KAAnB,CAAyBkF,KAAzB,CAA+BS,MAA/B,CAAsC,UAACigC,KAAD,EAAQl7B,IAAR;AAAA,mBAAiBk7B,KAAK,GAAGl7B,IAAI,CAAC+5B,MAA9B;AAAA,WAAtC,EAA4E,CAA5E,CADC,GAED,CAFN;AAGH;AAED;;AACA;;;;4BACuB;AACnB,iBAAO,KAAKtmB,IAAL,CAAUovB,QAAV,CAAmBxT,aAAnB,CAAiC70B,KAAjC,GAAyC,CAAhD;AACH;AAED;;;;4BACiC;AAC7B,cAAM0kF,OAAO,GAAG,UAAAn+E,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoBiB,QAApB,CAA6B;AAAEwG,iBAAK,EAAE,KAAK8/C,eAAL,CAAqBnf;AAA9B,WAA7B,EAAuFt+B,YAAvF,CAAoG,QAApG,CAAhB;AACA,iBAAO,KAAK/I,MAAL,CAAY23B,YAAZ,CAAyBsvD,OAAzB,CAAP;AACH;AAED;;;;4BAC8B;AAC1B,iBAAO,KAAKhB,aAAL,CAAmBjjF,MAAnB,CACH,UAACkhB,SAAD,EAAYo0B,QAAZ;AAAA,mBAAyBp0B,SAAS,IAAIo0B,QAAQ,CAAChW,iBAA/C;AAAA,WADG,EAEH,KAFG,CAAP;AAIH;;;;MAvFqD,OAAAxmC,a;;AAL1D;;;uBAKaqmF,oC,EAAoC,4C,EAAA,4C,EAAA,kC;AAAA,K;;;YAApCA,oC;AAAoC,+C;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjDjD;AACI;AAwDA;AA8BA;AACI;AACI;AAKI;AAAA,mBAAS,IAAAp1E,KAAA,OAAT;AAAqB,WAArB;AALJ;AASA;AACA;AAMI;AAAA,mBAAS,IAAAm6E,YAAA,EAAT;AAAuB,WAAvB;AANJ;AAUA;AACJ;AACJ;AACJ;AACA;AAWA;AAYA;;;;;;AAxIoC;AACZ;AAAA;AAwDkC;AAAA,8CAAiC,UAAjC,EAAiC,GAAjC;AA+C1C;AAAA;AAKJ;AAAA;AAAA;;;;;;;;;;2BD5DC/E,oC,EAAoC;cALhD,OAAAjhC,SAKgD;eALtC;AACPjlD,kBAAQ,EAAE,0BADH;AAEPklD,qBAAW,EAAE,gCAFN;AAGPC,mBAAS,EAAE,CAAC,gCAAD;AAHJ,S;AAKsC,Q;;;;;;;;;;gBAE5C,OAAAziD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;gBAkBA,OAAAqD,S;iBAAU,O;;;;;;;;;;;;;;;;;;;;;;;;AEnFf;AAAA;AAAA;;AAQA;AAAA;AAAA;;AAKA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAQa49B,8B;AA4DT,8CAAoBj0D,OAApB,EAA4C;AAAA;;AAAxB,aAAAA,OAAA,GAAAA,OAAA;AAvDpB;;AACS,aAAAhvB,IAAA,GAAe,UAAAyJ,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAAnC;AACT;;AACiB,aAAAm+E,IAAA,GAAO,IAAI,OAAAxoC,YAAJ,EAAP;AACjB;;AACiB,yBAAS,IAAI,OAAAA,YAAJ,EAAT;AAmDhB;;;;mCA/Cc;AAAA;;AACX,eAAK3sB,IAAL,GAAY,CAAC,KAAKzB,UAAL,IAAmB,EAApB,EAAwB1tB,IAAxB,CAA6B,UAAA0f,KAAK;AAAA,mBAAIA,KAAK,CAAC9R,KAAN,KAAgB,QAAI,CAACwnB,KAAL,CAAWC,WAA/B;AAAA,WAAlC,CAAZ;AACH;;;4BAE0B;AACvB,iBAAO,CAAC,CAAC,KAAKlG,IAAd;AACH;AAED;;;;4BAC2B;;;AACvB,iBAAO,YAAKA,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEhE,UAAX,KAAyB,eAAhC;AACH;AAED;;;;4BACwB;AACpB;AACA,cAAI,CAAC,KAAKiK,KAAV,EAAiB;AACb,mBAAO,iBAAP;AACH,WAJmB,CAMpB;;;AACA,iBAAO,KAAKA,KAAL,CAAW2K,aAAX,CAAyB1iC,QAAzB,CAAkC;AAAEJ,mBAAO,EAAE,KAAKm4B,KAAL,CAAWb,aAAX,IAA4B;AAAvC,WAAlC,EAA8Ez2B,UAA9E,CAAyF,OAAzF,EAAkGmJ,iBAAlG,EAAP;AACH;AAED;;;;4BACqB;AACjB,cAAMzM,KAAK,GAAG,CAAC,KAAK46B,KAAL,IAAc;AAAE56B,iBAAK,EAAE;AAAT,WAAf,EAA8BA,KAA5C;AACA,iBAAOA,KAAK,CAAC2F,MAAN,CAAa,UAAC8+B,MAAD,EAAS/5B,IAAT;AAAA,mBAAkB+5B,MAAM,GAAG/5B,IAAI,CAAC+5B,MAAL,GAAc/5B,IAAI,CAACo5B,UAA9C;AAAA,WAAb,EAAuE,CAAvE,CAAP;AACH;AAED;;;;4BACqB;AACjB,cAAM9jC,KAAK,GAAG,CAAC,KAAK46B,KAAL,IAAc;AAAE56B,iBAAK,EAAE;AAAT,WAAf,EAA8BA,KAA5C;AACA,iBAAOA,KAAK,CAAC2F,MAAN,CAAa,UAAC8+B,MAAD,EAAS/5B,IAAT;AAAA,mBAAkB+5B,MAAM,GAAG/5B,IAAI,CAAC+5B,MAAhC;AAAA,WAAb,EAAqD,CAArD,CAAP;AACH;AAED;;;;4BACiB;;AACb;;;AACA,cAAI,CAAC,KAAK9P,IAAN,IAAc,CAAC,KAAKA,IAAL,CAAUzH,KAA7B,EAAoC;AAChC,mBAAO,KAAP;AACH;;AAED,iBAAO,kBAAKyH,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEtP,QAAX,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAE4kB,QAArB,KAAiC,KAAxC;AACH;;;;;;AA/DL;;;uBAKag7C,8B,EAA8B,sC;AAAA,K;;;YAA9BA,8B;AAA8B,+C;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA;AAAA,O;AAAA,e;AAAA,c;AAAA,8N;AAAA;AAAA;ACrB3C;AAAA;AACe;AAAuC;AACtD;AAAA;AACA;AACI;AACI;AACA;;AAAsE;AAC1E;AACA;AAAkB;;AAAyC;AAC/D;AACA;AACI;AAII;AAAA,mBAAS,IAAA6E,IAAA,OAAT;AAAoB,WAApB;AAOA;AAGJ;AACA;AAAsD;AAAA,mBAAS,oBAAT;AAAsB,WAAtB;AAClD;AACJ;AACJ;;;;AA3BA;AAAA,6CAAM,iBAAN;AAAA;AAGQ;AAAA;;;;AAGc;AAAA;AAMd;AAAA;AAEA;AAOI;AAAA;AAIM;AAAA;;;;;;;;;;2BDNL7E,8B,EAA8B;cAL1C,OAAAphC,SAK0C;eALhC;AACPjlD,kBAAQ,EAAE,0BADH;AAEPklD,qBAAW,EAAE,uBAFN;AAGPC,mBAAS,EAAE,CAAC,uBAAD;AAHJ,S;AAKgC,Q;;;;;;gBAEtC,OAAAziD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;gBAEA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AE/BL;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAOA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACNgB;AAKI;AAAA;AAAA;AAAA;AAAA;AAAA,WAAyB,QAAzB,EAAyB;AAAA;AAAA;AAAA;AAAA;AAAA,SAAzB;AAEH;;;;;;AALG,uDAAyB,OAAzB,EAAyB,QAAzB,EAAyB,MAAzB,EAAyB,WAAzB;;;;;;;;AAJZ;AACI;AACI;AAQJ;AACA;AAA8B;AAAA;AAAA;AAAA;AAAA;AAA9B;AAEA;AACJ;;;;;AAXY;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqChB;AACI;AACI;AACJ;AACA;AAAA;AAA2E;AAC3E;AAA8B;AAAA;AAAA;AAAA;AAAA;AAA9B;AAEA;AACJ;;;;AANkB;AAAA;;;;QD1BT+gC,iC;AALb;AAAA;;AAgBI;AACiB,aAAAr1E,KAAA,GAAQ,IAAI,OAAA4xC,YAAJ,EAAR;AACjB;;AACiB,aAAA1mB,KAAA,GAAQ,IAAI,OAAA0mB,YAAJ,EAAR;AAEV,yBAAkB,KAAlB;AAyDV;AAvDG;;;;;;AAqBA;mCACkB;AACd,eAAK1mB,KAAL,CAAW8nB,IAAX;AACH;AAED;;;;kCACiB9nB,K,EAAsB;AACnC,eAAKA,KAAL,CAAW8nB,IAAX,CAAgB9nB,KAAhB;AACH;AAED;;;;oCACmBA,K,EAAsB;AACrC,cAAMD,MAAM,GAAG,KAAKA,MAApB;AACA,cAAMr6B,KAAK,GAAGq6B,MAAM,CAACmV,SAAP,CAAiB,UAAAs4C,QAAQ;AAAA,mBAAIxtD,KAAK,CAAC3mB,EAAN,KAAam0E,QAAQ,CAACn0E,EAA1B;AAAA,WAAzB,CAAd;AACA;;AACA,cAAI3T,KAAK,IAAI,CAAb,EAAgB;AACZq6B,kBAAM,CAAClsB,MAAP,CAAcnO,KAAd,EAAqB,CAArB;AACA,iBAAKw3B,QAAL,CAAcl1B,QAAd,CAAuB+3B,MAAvB;AACA,6BAAc,IAAd;AACH;AACJ;AAED;;;;;;+BAGW;AACP;AACA,eAAKjrB,KAAL,CAAWgzC,IAAX,CAAgB;AAAEz7C,gBAAI,EAAE,MAAR;AAAgBzC,gBAAI,EAAE;AAAtB,WAAhB;AACH;AAED;;;;mCACe;AACX,eAAKkL,KAAL,CAAWgzC,IAAX,CAAgB;AAAEz7C,gBAAI,EAAE,UAAR;AAAoBzC,gBAAI,EAAE;AAA1B,WAAhB;AACH;;;4BArDgB;AAAA;;AACb;AACA,cAAI,CAAC,KAAKszB,QAAV,EAAoB;AAChB,mBAAO,EAAP;AACH;;AACD,cAAI6C,MAAM,GAAG,EAAb;AACA,cAAMuB,KAAK,GAAG,IAAI,UAAAhpB,MAAJ,CAAW;AAAClR,gBAAI,EAAE,KAAKA;AAAZ,WAAX,CAAd;AACA,eAAK81B,QAAL,CAAc5yB,KAAd,CAAoB9E,OAApB,CACI,UAAAw6B,KAAK,EAAI;AACL,gBAAMmvD,QAAQ,GAAGnvD,KAAjB;AACAmvD,oBAAQ,CAACj4D,YAAT,GAAwB,QAAI,CAAC4F,OAAL,GACFwE,KAAK,CAACxwB,YAAN,CAAmB,KAAnB,EAA0BC,EADxB,GAEF,QAAI,CAAC3J,IAF3B;AAGA24B,kBAAM,CAAC9wB,IAAP,CAAYkgF,QAAZ;AACH,WAPL;AAUA,iBAAOpvD,MAAP;AACH;;;;;;AA1CL;;;uBAKaoqD,iC;AAAiC,K;;;YAAjCA,iC;AAAiC,4C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA;AAAA,O;AAAA,e;AAAA,a;AAAA,qnB;AAAA;AAAA;ACrB9C;AACI;AACI;AAAA;AAAqD;AACzD;AACA;AACI;AAeJ;AACA;AACI;AACI;AAKI;AAAA,mBAAS,IAAAiF,QAAA,EAAT;AAAmB,WAAnB;AALJ;AASA;AACA;AAKgB;AAAA,mBAAS,IAAA75E,IAAA,EAAT;AAAe,WAAf;AALhB;AAOA;AACJ;AACJ;AACJ;AACA;;;;;;AAvCsB;AAAA,iEAAiD,UAAjD,EAAiD,GAAjD;AAgCN;AAAA;;;;;;;;;2BDhBH40E,iC,EAAiC;cAL7C,OAAAlhC,SAK6C;eALnC;AACPjlD,kBAAQ,EAAE,uBADH;AAEPklD,qBAAW,EAAE,6BAFN;AAGPC,mBAAS,EAAE,CAAC,6BAAD;AAHJ,S;AAKmC,Q;;gBAEzC,OAAAziD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;gBAEA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AEnCL;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAGA;AAAA;AAAA;;;;;;;;;;;;AAgBY;AACI;AACI;AACJ;AACA;AACI;AACJ;AACA;AACI;AACJ;AACJ;;;;;;;AAVgE;AAExD;AAAA;AAGA;AAAA;AAGA;AAAA;;;;;;AAjBhB;AACI;AACI;AACI;AACI;AACJ;AACA;AAAmB;AAAW;AAC9B;AAAmB;AAAK;AAC5B;AACA;AAWJ;AACJ;;;;;AAZY;AAAA;;;;QAgBH6hC,mB;;;;;;;;;;;;;kCAIQjrD,K,EAAO;AACpB,iBAAOA,KAAK,CAAC56B,KAAN,CAAY6H,GAAZ,CAAgB,UAAAxH,CAAC;AAAA,6BAAOA,CAAC,CAACtC,IAAT,SAAgBsC,CAAC,CAACokC,MAAF,GAAW,CAAX,eAAoBpkC,CAAC,CAACokC,MAAtB,SAAkC,EAAlD;AAAA,WAAjB,EAAyEp5B,IAAzE,CAA8E,IAA9E,CAAP;AACH;;;2CAEyBuvB,K,EAAO;AAC7B,iBAAO,KAAKjkB,OAAL,CAAa/J,WAAb,CAAyB/J,QAAzB,CAAkC;AAAEJ,mBAAO,EAAEm4B,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAEb;AAAlB,WAAlC,EAAqEz2B,UAArE,CAAgF,OAAhF,EAAyFmJ,iBAAzF,EAAP;AACH;;;qCAEmBjN,C,EAAG;AACnB,iBAAOA,CAAC,GAAG,CAAJ,KAAU,CAAV,GAAc,KAAd,GAAsB,MAA7B;AACH;;;;MAdoC,OAAAf,a;;AA5BzC;;;mDA4BaonF,mB;AAAmB,K;;;YAAnBA,mB;AAAmB,2C;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,gM;AAAA;AAAA;AAzB5B;;;;AAAmC;;;;;;oEAyB1BA,mB;;;;2BAAAA,mB,EAAmB;cA5B/B,OAAAhiC,SA4B+B;eA5BrB;AACPjlD,kBAAQ,EAAE,sBADH;AAEPuxD,kBAAQ,wyBAFD;AA0BPpM,mBAAS,EAAE,CAAC,8BAAD;AA1BJ,S;AA4BqB,Q;;gBAE3B,OAAAziD;;;;;;;;;;;;;;;;;;;;;;;;ACzCL;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAWA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQY;AAA6C;AAAM;;;;;;AAUvC;AACE;AACE;AAEA;AACJ;;;;;;AAJW;AAAA;AACe;AAAA,yCAAe,WAAf,EAAe,gBAAf;;;;QAWrCkjF,uB;;;;;AA4BT,uCACYnI,MADZ,EAEY3jE,KAFZ,EAGYmD,KAHZ,EAIYqlC,OAJZ,EAI2B;AAAA;;AAAA;;AAEvB;AALQ,iBAAAm7B,MAAA,GAAAA,MAAA;AACA,iBAAA3jE,KAAA,GAAAA,KAAA;AACA,iBAAAmD,KAAA,GAAAA,KAAA;AACA,iBAAAqlC,OAAA,GAAAA,OAAA;AA/BL,iBAAAixB,gBAAA,GAAmB,0BAAAA,gBAAnB;AACA,iBAAAr7D,SAAA,GAAY,IAAI,OAAArZ,eAAJ,CAAyC,EAAzC,CAAZ;AACA,iBAAAwsF,YAAA,GAAe,CAClB;AACIhjF,cAAI,EAAE,UADV;AAEIgH,iBAAO,EAAE,UAFb;AAGIrP,kBAAQ,EAAE,cAAAmsB;AAHd,SADkB,EAMlB;AACI9jB,cAAI,EAAE,MADV;AAEIgH,iBAAO,EAAE,MAFb;AAGIrP,kBAAQ,EAAE,cAAAosB;AAHd,SANkB,EAWlB;AACI/jB,cAAI,EAAE,WADV;AAEIgH,iBAAO,EAAE,WAFb;AAGIi5E,sBAAY,EAAE,IAHlB;AAIItoF,kBAAQ,EAAE,cAAAqsB;AAJd,SAXkB,CAAf;AAsBA,iBAAAmtD,gBAAA,GAAmB,KAAnB;AACA,iBAAAkH,YAAA,GAAe,IAAf;AAMoB;AAG1B;;;;mCAEc;AAAA;;AAEX;AACA,cAAM4K,SAAS,GAAG,KAAKruE,KAAL,CAAWsuE,QAAX,CAAoB9T,QAApB,CAA6B3+D,GAA7B,CAAiC,IAAjC,CAAlB;AACA,cAAM0yE,IAAI,GAAG,KAAKvuE,KAAL,CAAWsuE,QAAX,CAAoB9T,QAApB,CAA6B3+D,GAA7B,CAAiC,MAAjC,CAAb,CAJW,CAKX;;AACA,eAAKgB,KAAL,CAAW4hE,QAAX,CAAoB,eAAAniE,iBAAA,CAAkB/D,OAAlB,EAApB;AACA,eAAKyH,KAAL,CAAWtD,IAAX,CAAgBtY,SAAhB,CAA0B,UAAAoqF,QAAQ,EAAI;AAClC;AACA,gBAAMhiC,MAAM,GAAG+hC,IAAI,KAAK,QAAxB;AACA,gBAAMhL,WAAW,GAAGiL,QAAQ,CAAC/jE,WAA7B;AACA;;;;;;AAKA,oBAAI,CAACg5D,YAAL,GAAoBF,WAAW,IAAI/2B,MAAnC;;AAEA,oBAAI,CAACtoD,YAAL,CAAkB,WAAlB,EAA+B,QAAI,CAAC2Y,KAAL,CAAW5F,IAAX,CAC3B,QAAA4H,MAAA,CAAO,YAAA7D,qBAAP,CAD2B,EAE3B,QAAA6D,MAAA,CAAO,YAAAvD,kCAAP,CAF2B,EAG3B,YAAAtP,GAAA,CAAI,UAACukB,OAAD,EAA4C;AAC5C,qBAAO,cAAAD,qBAAA,CAAsBC,OAAtB,CAAP;AACH,aAFD,CAH2B,EAM3B,YAAAu4B,oBAAA,EAN2B,EAO7B1kD,SAP6B,CAOnB,UAAAkQ,IAAI,EAAI;AAChB,sBAAI,CAAC2G,SAAL,CAAe3G,IAAf,CAAoBA,IAApB;;AACI,kBAAI+5E,SAAS,IAAI,CAAC,QAAI,CAAC9R,gBAAvB,EAAyC;AACrC,wBAAI,CAAC1/D,KAAL,CAAW4hE,QAAX,CAAoB,WAAA7nE,uBAAA,EAApB;;AACA,wBAAI,CAAC2lE,gBAAL,GAAwB,IAAxB,CAFqC,CAGrC;;AACA,wBAAI,CAACr4E,YAAL,CAAkB,gBAAlB,EAAoC,QAAI,CAAC2Y,KAAL,CAAW5F,IAAX,CAChC,QAAA4H,MAAA,CAAO,cAAAwQ,iCAAP,CADgC,EAElCjrB,SAFkC,CAExB,UAAAkQ,IAAI,EAAI;;;AAChB,sBAAMwG,OAAO,GAAGxG,IAAI,CAACiH,OAAL,GAAe,CAAD,KAACjH,IAAI,CAACiH,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAG,CAAH,CAA3B,GAAmC,IAAnD;;AACA,sBAAIT,OAAO,IAAIA,OAAO,CAACge,IAAvB,EAA6B;AACzB;AACA,wBAAI,QAAI,CAACwR,SAAT,EAAoB;AAChB,8BAAI,CAACA,SAAL,CAAeC,KAAf;AACH;;AACD,wBAAI,QAAI,CAACi2C,MAAT,EAAiB;AACd,8BAAI,CAACA,MAAL,CAAYiO,QAAZ;AACF,qBAPwB,CAQzB;AACA;;;AACA,4BAAI,CAACC,wBAAL,CAA8B5zE,OAA9B,EAAuC0xC,MAAvC,EAA+C+2B,WAA/C,EAVyB,CAYzB;;;AACA,4BAAI,CAACz+E,OAAL,CAAa,aAAb,EAA2B,YAAM;AAC7B,8BAAI,CAACugD,OAAL,CAAapL,QAAb,CAAsB,CAAC,OAAD,EAAS,QAAT,CAAtB,EAA0C;AAAE00C,kCAAU,EAAE;AAAd,uBAA1C;AACH,qBAFD;AAGH;AACJ,iBArBmC,CAApC;AAsBH;AACR,aApC8B,CAA/B;AAsCH,WAjDD;AAmDA,eAAKzqF,YAAL,CAAkB,aAAlB,EAAiC,KAAK2Y,KAAL,CAAWgC,MAAX,CAAkB,OAAAC,iBAAlB,EAC5B7H,IAD4B,CACvB,YAAA+H,IAAA,CAAK,CAAL,CADuB,EAE5B5a,SAF4B,CAElB,UAAC2a,IAAD,EAA4B;AACnC;AACA,oBAAI,CAAC0J,WAAL,GAAmB,IAAI,cAAA0R,IAAJ,CAASpb,IAAT,CAAnB;;AACA,gBAAIsvE,SAAJ,EAAe;AACX;AACA,sBAAI,CAACxxE,KAAL,CAAW4hE,QAAX,CAAoB,WAAAtoE,qBAAA,CAAsB;AAAE,sBAAMk4E,SAAR;AAAmB,yBAAS,QAAI,CAAC5lE,WAAL,CAAiBlR,KAA7C;AAAoD,0BAAU,aAA9D;AAA6E,0BAAU;AAAvF,eAAtB,CAApB;AACH;AACJ,WAT4B,CAAjC;AAUH;;;oCAEkBuD,O,EAAkB;;;AACjC,cAAI,KAAKG,SAAL,IAAkBH,OAAO,CAACwf,aAA9B,EAA6C;AACzC,mBAAO,CAAP,KAAO,KAAKrf,SAAL,CAAe5R,KAAf,CAAqBM,IAArB,CAA0B,UAAA4E,CAAC;AAAA,qBAAIuM,OAAO,CAACwf,aAAR,KAA0B/rB,CAAC,CAAClF,KAAhC;AAAA,aAA3B,OAAiE,IAAjE,IAAiE,aAAjE,GAAiE,MAAjE,GAAiE,GAAE6hB,IAAF,CAAO1B,QAA/E;AACH;;AACD,iBAAO,IAAP;AACH,S,CAED;;;;iDACgC1O,O,EAAyE;AAAA;;AAAA,cAAvD0xC,MAAuD,uEAArC,KAAqC;AAAA,cAA9B+2B,WAA8B,uEAAP,KAAO;;AACrG,cAAI,KAAKhH,gBAAL,IAAyB,KAAKjyC,SAAlC,EAA6C;AACzC,iBAAKA,SAAL,CAAeC,KAAf;AACA,iBAAKD,SAAL,GAAiB,IAAjB;AACH,WAJoG,CAKrG;AACA;;;AACA,cAAI,CAAC,KAAKA,SAAN,IAAmBxvB,OAAO,CAACge,IAA/B,EAAqC;AACjC,iBAAKwR,SAAL,GAAiB,KAAKk2C,MAAL,CAAYriE,IAAZ,CAAiB,kCAAAmkE,4BAAjB,EAA+C;AAC5DlkE,wBAAU,EAAE,+BADgD;AAE5D1B,kBAAI,EAAE;AACF5B,uBAAO,EAAPA,OADE;AAEF0O,wBAAQ,EAAE,KAAKgiE,WAAL,CAAiB1wE,OAAjB,CAFR;AAGF0xC,sBAAM,EAANA,MAHE;AAIF+2B,2BAAW,EAAXA,WAJE;AAKFE,4BAAY,EAAE,KAAKA,YALjB;AAMF2C,uBAAO,EAAE;AAAA,yBAAM,IAAN;AAAA;AANP,eAFsD;AAU5Dt4B,uBAAS,EAAE,KAViD;AAW5DC,2BAAa,EAAE;AAX6C,aAA/C,CAAjB,CADiC,CAcjC;;AACAzrD,sBAAU,CAAC,YAAM;AACb,sBAAI,CAACmhF,YAAL,GAAoB,KAApB;AACH,aAFS,EAEP,IAFO,CAAV;AAGH;AACJ;;;kCAEgB5vE,K,EAA2B;AACxC,eAAKwxC,OAAL,CAAapL,QAAb,CAAsB,EAAtB,EAA0B;AAAEksC,sBAAU,EAAE,KAAKnmE,KAAnB;AAA0B+mC,uBAAW,EAAE;AAAEmkC,kBAAI,EAAE;AAAR;AAAvC,WAA1B;AACH;;;;MAjJwC,OAAAtoF,a;;AA3B7C;;;uBA2Ba+lF,uB,EAAuB,kC,EAAA,8B,EAAA,uC,EAAA,+B;AAAA,K;;;YAAvBA,uB;AAAuB,0C;AAAA,+C;AAAA,e;AAAA,a;AAAA,gV;AAAA;AAAA;AAxB5B;AACI;AACA;AACI;AAGJ;AACA;AACI;AACI;AAAI;AAAe;AACnB;AAA+B;AAAA,mBAAqB,IAAAiG,SAAA,QAArB;AAAsC,WAAtC;AAC3B;AAMJ;AACJ;AACJ;AACJ;;;;AAnBS;AAAA;AAGG;AAAA;AAOS;AAAA;;;;;;;;;2BAahBjG,uB,EAAuB;cA3BnC,OAAA3gC,SA2BmC;eA3BzB;AACPjlD,kBAAQ,EAAE,qBADH;AAEPuxD,kBAAQ,2hCAFD;AAyBPpM,mBAAS,EAAE,CAAC,kCAAD;AAzBJ,S;AA2ByB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QCxEvB2mC,uB,GACT,iCAAmB/zE,OAAnB,EAAqC;AAAA;;AAAlB,WAAAA,OAAA,GAAAA,OAAA;AAClB,K;;AAFL;AAKA;;;;AAGa,YAAAka,sBAAA,GAAyB,UAACrnB,OAAD,EAAmD;;;AACrF,UAAI,CAACA,OAAD,IAAY,QAACA,OAAO,CAAC,CAAD,CAAR,MAAW,IAAX,IAAW,aAAX,GAAW,MAAX,GAAW,GAAE0b,KAAb,CAAhB,EAAoC;AAChC,eAAO,EAAP;AACH;;AACD,aAAO1b,OAAO,CAAC3B,GAAR,CAAY,UAAC8O,OAAD,EAAsB;AACrC,eAAO,IAAI+zE,uBAAJ,CACH/zE,OADG,CAAP;AAGH,OAJM,CAAP;AAKH,KATY;;;;;;;;;;;;;;;;;;;;;ACbb;AAAA;AAAA;;AACA;AAAA;AAAA;;AAqBA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAOA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;AA4BO;;;;;;AACA;;;;;;;;AAiBC;AAAqH;AAAA;AAAA;AAAA,gCAAgB,EAAhB;AAAkB,SAAlB,EAAoB,UAApB,EAAoB;AAAA;AAAA;AAAA,gCAAoB,EAApB;AAAsB,SAA1C;AAEnH;AACF;;;;;AADE;AAAA;;;;;;;;AAID;AAAqH;AAAA;AAAA;AAAA,gCAAgB,EAAhB;AAAkB,SAAlB,EAAoB,UAApB,EAAoB;AAAA;AAAA;AAAA,gCAAoB,EAApB;AAAsB,SAA1C;AACrH;AACD;;;;;AADC;AAAA;;;;;;AAGF;AAEC;AAAO;AAAkB;AAC1B;;;;;;;;AACA;AAEC;AACC;AAAA;AAAA;AAAA,oDAA4B,KAAK,IAAjC,IAAyC,CAAzC;AAA0C,SAA1C,EAA4C,UAA5C,EAA4C;AAAA;AAAA;AAAA,oDAAgC,KAAK,IAArC,IAA6C,CAA7C;AAA8C,SAA1F;AACC;AACF;AACD;;;;;AAFG;AAAA;;;;;;AAIH;AACE;AAAO;AAAmF;AAC5F;;;;;AADS;AAAA;;;;;;AAET;AACE;AACF;;;;;;AAtCD;AACC;AACC;AAAM;AAAsB;AAC7B;AACA;AACC;AAAM;AAAuE;AAC9E;AACA;AACC;AAAM;AAAa;AACpB;AACA;AACC;AAID;AACA;AACE;AAGF;AACA;AAIA;AAQA;AAGA;AAGI;;;;;AAlCG;AAAA;AAM4F;AAAA;AAMC;AAAA;AAIhD;AAAA;AAIjB;AAAA;AAQW;AAAA;AAGD;AAAA;;;;;;;;AAI9C;AAEC;AACE;AAAM;AAAmB;AAC3B;AACA;AACE;AAAO;AAAyF;AAClG;AACA;AACC;AAAkG;AAAA;AAAA;AAAA;AAAA,WAAsB,UAAtB,EAAsB;AAAA;AAAA;AAAA;AAAA,SAAtB;AAChG;AACF;AACD;AACD;;MAvFN;;;AAEa,YAAAg0E,YAAA,GAAe,EAAf;AAeb;;;;QA8EaC,wB;;;;;AA0CT,wCACqCryE,IADrC,EAEY4mD,UAFZ,EAGWzmD,KAHX,EAIWsY,OAJX,EAKW8pD,iBALX,EAMW75B,sBANX,EAOW/iC,QAPX,EAOuC;AAAA;;AAAA;;;;AAGnC;AATiC,iBAAA3F,IAAA,GAAAA,IAAA;AACzB,iBAAA4mD,UAAA,GAAAA,UAAA;AACD,iBAAAzmD,KAAA,GAAAA,KAAA;AACA,iBAAAsY,OAAA,GAAAA,OAAA;AACA,iBAAA8pD,iBAAA,GAAAA,iBAAA;AACA,iBAAA75B,sBAAA,GAAAA,sBAAA;AACA,iBAAA/iC,QAAA,GAAAA,QAAA;AAhDJ,iBAAA2sE,cAAA,GAAiB,SAAKtyE,IAAL,CAAUtE,EAA3B;AAEA,iBAAA62E,IAAA,GAAO,IAAI,OAAArtF,eAAJ,CAAoB,YAAAstF,cAApB,CAAP;AACA,iBAAAC,MAAA,GAAS,IAAI,OAAAvtF,eAAJ,CAA2B,YAAAwtF,YAA3B,CAAT;AAEA,iBAAAjpF,IAAA,GAAO,QAAA2C,QAAA,CAASqkB,GAAT,GAAenkB,OAAf,EAAP;AAIA,iBAAAqmF,cAAA,GAAiB/lF,QAAQ,CAAC,CAAD,WAAC,SAAKoT,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAE4C,QAAX,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAEulB,eAAF,CAAkBj4B,QAAlB,EAApB,CAAR,GAA4D,IAA7E;AAOA,iBAAAkO,OAAA,GAAmB,IAAI,cAAA+P,OAAJ,CAAY,EAAZ,CAAnB;AAEA,iBAAAs2D,WAAA,GAAc,IAAI,OAAAv/E,eAAJ,CAAiDwG,SAAjD,CAAd;AACA,iBAAAg2E,SAAA,GAAqB,KAArB;AAKA,iBAAAkR,oBAAA,GAAgC,KAAhC,CAwBgC,CAjBvC;;AACO,iBAAAC,aAAA,GAAyB,IAAzB;AAGP,iBAAAtI,WAAA,GAAuB,IAAvB;AAGF,iBAAAuI,UAAA,GAAa,CAAb;AAUyC;AAItC;;;;uCAEqBnmE,K,EAAO;AAAA;;AAE3B;AACM,eAAKomE,qBAAL,CAA2B,KAA3B,EAHqB,CAK3B;;AACM,eAAKvrF,YAAL,CACI,qBADJ,EAEI,KAAK2Y,KAAL,CAAW5F,IAAX,CAAgB,QAAA4H,MAAA,CAAO,cAAA+Q,yBAAP,CAAhB,EAAmDxrB,SAAnD,CAA6D,UAACkQ,IAAD,EAAU;;;AACnE,gBAAIA,IAAI,CAACiH,OAAL,CAAaiN,MAAjB,EAAyB;AAErBa,mBAAK,CAACA,KAAN,GAAc/U,IAAI,CAACiH,OAAL,CAAaiN,MAAb,CAAoB,CAApB,CAAd;AACA,sBAAI,CAACknE,gBAAL,GAAwBrmE,KAAxB;AAEA,sBAAI,CAACkmE,aAAL,GAAqB,IAArB;AAEA,sBAAI,CAACF,cAAL,GAAsB/lF,QAAQ,CAAC,QAAI,CAAComF,gBAAL,CAAsBrmE,KAAtB,CAA4B/J,QAA5B,CAAqCulB,eAArC,CAAqDj4B,QAArD,EAAD,CAAR,GAA4E,IAAlG,CAPqB,CASjC;;AATiC,0CAU2D,QAAI,CAAC+iF,4BAAL,EAV3D;AAAA,kBAU1BC,aAV0B,yBAU1BA,aAV0B;AAAA,kBAUXC,cAVW,yBAUXA,cAVW;AAAA,kBAUKC,4BAVL,yBAUKA,4BAVL;AAAA,kBAUmCC,oBAVnC,yBAUmCA,oBAVnC;;AAWjC,sBAAI,CAACtmF,IAAL,GAAYsmF,oBAAZ,CAXiC,CAYrB;;AACA,kBAAIH,aAAa,KAAK,WAAtB,EAAmC;AAC/B,oBAAGC,cAAc,CAACxnF,MAAf,IAAyBynF,4BAA4B,GAAG,EAAxD,IAA+DC,oBAAoB,IAAI,EAA1F,EAA+F;AAC3F,0BAAI,CAACC,UAAL,GAD2F,CAE3F;AACA;;;AACA,0BAAI,CAACC,sBAAL;AACH,iBALD,MAKO;AACH,0BAAI,CAAChJ,WAAL,GAAmB,KAAnB;AACA,gCAAI,CAACiJ,cAAL,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAExtF,WAAF,EAAnB;AACAV,+BAAa,CAAC,QAAI,CAACmuF,eAAN,CAAb;AACH;AAEJ,eAZD,MAYM;AACF,wBAAI,CAACH,UAAL,GADE,CAEF;AACA;;;AACA,wBAAI,CAACC,sBAAL;AACH,eA9BoB,CAgCjC;;;AACY,sBAAI,CAACG,6BAAL;AACH;AACJ,WApCD,CAFJ;AAyCP;AAEH;;;;;;;uDAImC;;;AAElC,cAAMjjE,GAAG,GAAQ,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAjB,CAFkC,CAEI;AAEtC;;AACA,cAAMmQ,QAAQ,GAAG,KAAKw5E,gBAAL,CAAsBrmE,KAAtB,CAA4B/J,QAA5B,CAAqCpJ,QAArC,CAA8ClK,GAA9C,CAAkD,UAAAuC,CAAC;AAAA,mBAAI,IAAI,cAAAsc,OAAJ,CAAYtc,CAAZ,CAAJ;AAAA,WAAnD,CAAjB,CALkC,CAOlC;;AACA,cAAMshF,cAAc,GAAG35E,QAAQ,CAACnJ,MAAT,CAAgB,UAAA+N,OAAO;AAAA,mBAC3CqS,GAAG,CAACuR,WAAJ,CAAgB5jB,OAAO,CAAC/J,WAAR,CAAoBlB,YAApB,CAAiC,QAAjC,CAAhB,KACAsd,GAAG,CAACsR,YAAJ,CAAiB3jB,OAAO,CAAC9J,SAAR,CAAkBnB,YAAlB,CAA+B,QAA/B,CAAjB,CAF2C;AAAA,WAAvB,CAAvB,CARkC,CAalC;;AACA,cAAM+/E,aAAa,GAAG,KAAKlzE,IAAL,CAAU2zE,eAAV,CAA0BC,UAA1B,CAAqCnnE,SAArC,CAA+C,KAAK6lE,cAApD,CAAtB,CAdkC,CAcyD;AAE3F;;AACA,cAAIc,4BAA4B,GAAG,CAAnC,CAjBkC,CAiBI;;AACtC,cAAIC,oBAAoB,GAAG,EAA3B,CAlBkC,CAkBH;AAE/B;;AACA,cAAGF,cAAc,CAACxnF,MAAlB,EAA0B;AACzB,gBAAMkoF,OAAO,GAAQ,QAAAznF,QAAA,CAASqkB,GAAT,EAArB,CADyB,CAEzB;;AACA2iE,wCAA4B,GAAGrpF,IAAI,CAAC23B,GAAL,CAAS33B,IAAI,CAACk1B,KAAL,CAAW,CAACk0D,cAAc,CAAC,CAAD,CAAd,CAAkBl4E,SAAlB,GAA8B,IAA9B,GAAqC44E,OAAO,CAACC,EAA9C,IAAoD,KAA/D,CAAT,CAA/B,CAHyB,CAKzB;;AACA,gBAAMC,MAAM,GAAG,QAAA3nF,QAAA,CAASqkB,GAAT,GAAetR,GAAf,CAAmB,QAAnB,IAA+B,QAAAizE,YAA/B,KAAgD,CAAhD,GAAoD,CAApD,GAAwD,CAAvE,CANyB,CAQzB;;AACA,gBAAM4B,oBAAoB,GAAQ,OAAAxqF,iBAAA,CAAkB,QAAA4C,QAAA,CAASqkB,GAAT,GAAexmB,IAAf,CAAoB;AAAEC,qBAAO,EAAE6pF,MAAX;AAAmB54E,qBAAO,EAAC;AAA3B,aAApB,EAAoDugC,OAApD,CAA4D,CAAD,WAAC,KAAKs3C,gBAAN,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAElmE,QAAvB,MAA+B,IAA/B,IAA+B,aAA/B,GAA+B,MAA/B,GAA+B,GAAEze,QAA7F,CAAlB,EAA0H,QAAA+jF,YAA1H,CAAlC,CATyB,CAWzB;;AACA,gBAAM6B,uBAAuB,GAAG,CAAH,WAAG,KAAKjB,gBAAL,CAAsBrmE,KAAzB,MAA8B,IAA9B,IAA8B,aAA9B,GAA8B,MAA9B,GAA8B,GAAE/J,QAA7B,MAAqC,IAArC,IAAqC,aAArC,GAAqC,MAArC,GAAqC,GAAEpJ,QAAF,CAAWnJ,MAAX,CAAkB,UAAC8B,IAAD;AAAA,qBACtFA,IAAI,CAACoJ,WAAL,GAAmB,IAAnB,IAA2By4E,oBAAoB,CAACF,EADsC;AAAA,aAAlB,CAArE,CAZyB,CAgBzB;;AACA,gBAAGG,uBAAuB,CAACtoF,MAA3B,EAAmC;AAClC;AACA,kBAAMuoF,sBAAsB,GAAGD,uBAAuB,CAAC,CAAD,CAAvB,CAA2B14E,WAA3B,GAAyC,IAAxE;AACA83E,kCAAoB,GAAGtpF,IAAI,CAACY,KAAL,CAAW,CAACupF,sBAAsB,GAAGL,OAAO,CAACC,EAAlC,KAAyC,OAAO,EAAhD,CAAX,CAAvB;AACA;AACD;;AAED,iBAAO;AACHZ,yBAAa,EAAEA,aADZ;AAEHC,0BAAc,EAAEA,cAFb;AAGHE,gCAAoB,EAAEA,oBAHnB;AAIHD,wCAA4B,EAAGA;AAJ5B,WAAP;AAOA;;;0CAE0B;AAAA;;AACrB;AACA,WAAC,KAAKN,UAAN,IAAoBltF,UAAU,CAAC;AAAA,mBAAI,QAAI,CAACuuF,SAAL,EAAJ;AAAA,WAAD,EAAuB,IAAvB,CAA9B;AACA,eAAKrB,UAAL;AACA,eAAKW,eAAL,GAAuBzkF,MAAM,CAAClJ,WAAP,CACnB,YAAM;AAAE,gBAAH,EAAG;;AAAA,0BAAI,CAAC0tF,cAAL,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAExtF,WAAF,EAAnB;AAAoCJ,sBAAU,CAAC;AAAA,qBAAI,QAAI,CAACuuF,SAAL,EAAJ;AAAA,aAAD,EAAuB,IAAvB,CAAV;AAAyC,WADlE,EAEf,OAAO,EAAP,GAAY,QAAA/B,YAFG,CAAvB;AAKH;;;oCAEkB;qBAAA,CACf;AACA;AACA;;;AACA,cAAM2B,MAAM,GAAG,QAAA3nF,QAAA,CAASqkB,GAAT,GAAetR,GAAf,CAAmB,QAAnB,IAA+B,QAAAizE,YAA/B,KAAgD,CAAhD,GAAoD,CAApD,GAAwD,CAAvE;AACA,cAAMgC,UAAU,GAAG,KAAK,QAAAhoF,QAAA,CAASqkB,GAAT,GAAetR,GAAf,CAAmB,QAAnB,CAAxB;AACA,cAAIxV,KAAK,GAAO,OAAAH,iBAAA,CAAkB,QAAA4C,QAAA,CAASqkB,GAAT,GAAexmB,IAAf,CAAoB;AAAEC,mBAAO,EAAE6pF,MAAX;AAAmB54E,mBAAO,EAAC;AAA3B,WAApB,EAAoDugC,OAApD,CAA4D,CAAD,WAAC,KAAKs3C,gBAAN,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAElmE,QAAvB,MAA+B,IAA/B,IAA+B,aAA/B,GAA+B,MAA/B,GAA+B,GAAEze,QAA7F,CAAlB,EAA0H,QAAA+jF,YAA1H,CAAhB;AACIzoF,eAAK,GAAGA,KAAK,CAACmE,cAAN,CAAqB,QAAA1B,QAAA,CAASioF,WAA9B,CAAR;;AACA,cAAG1qF,KAAK,KAAK,KAAK4R,WAAlB,EAAgC;AAE5B,iBAAKA,WAAL,GAAmB5R,KAAnB,CAF4B,CAI5B;AACA;AACA;AACA;;AAEA,gBAAMoqF,OAAM,GAAG,QAAA3nF,QAAA,CAASqkB,GAAT,GAAetR,GAAf,CAAmB,QAAnB,IAA+B,QAAAizE,YAA/B,KAAgD,CAAhD,GAAoD,CAApD,GAAwD,CAAvE;;AACA,gBAAMgC,WAAU,GAAG,KAAK,QAAAhoF,QAAA,CAASqkB,GAAT,GAAetR,GAAf,CAAmB,QAAnB,CAAxB;;AACA,iBAAKm1E,UAAL,CAAgBP,OAAhB;AAEH,WArBU,CAuBjB;;;AACA,eAAKR,sBAAL,GAxBiB,CA0BX;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACP;;;mCAEc;AAAA;;;;AACX,eAAKR,qBAAL,CAA2B,KAA3B;AAEA,eAAK/yE,IAAL,CAAU2zE,eAAV,CAA0BY,aAA1B,GAA0C,KAAKC,cAAL,CAAoB1gB,IAApB,CAAyB,IAAzB,CAA1C;AACA,eAAKkf,gBAAL,GAAwB,CAAH,KAAG,KAAKhzE,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEoc,IAAnC;AACJ,eAAKm3D,sBAAL;AACI,eAAKiB,cAAL,CAAoB,KAAKxB,gBAAzB,EANW,CAOf;AACI;;AAEA,eAAKxrF,YAAL,CACI,aADJ,EAEI,KAAK2Y,KAAL,CACKgC,MADL,CACY,OAAAC,iBADZ,EAEK7H,IAFL,CAEU,YAAA+H,IAAA,CAAK,CAAL,CAFV,EAGK5a,SAHL,CAGe,UAAC2a,IAAD,EAA4B;AACnC;AACA,oBAAI,CAAC0J,WAAL,GAAmB,IAAI,cAAA0R,IAAJ,CAASpb,IAAT,CAAnB;AACH,WANL,CAFJ,EAVW,CAqBX;AACA;;AACA,eAAKrC,IAAL,CAAU2zE,eAAV,CAA0Bc,eAA1B,GAA4C,IAA5C;AACH;AAED;;;;;;;;iDAKgC;;;AAEjC,cAAMhkE,GAAG,GAAQ,QAAArkB,QAAA,CAASqkB,GAAT,EAAjB,CAFiC,CAIjC;;AAJiC,sCAK2D,KAAKwiE,4BAAL,EAL3D;AAAA,cAK1BC,aAL0B,yBAK1BA,aAL0B;AAAA,cAKXC,cALW,yBAKXA,cALW;AAAA,cAKKC,4BALL,yBAKKA,4BALL;AAAA,cAKmCC,oBALnC,yBAKmCA,oBALnC,EAMjC;;;AACA,eAAKtmF,IAAL,GAAYsmF,oBAAZ,CAPiC,CASjC;;AACA,eAAK9I,WAAL,GAAmB6I,4BAA4B,GAAG,EAA/B,IAAsCC,oBAAoB,IAAI,EAAjF,CAViC,CAUmD;AAEpF;;AACA,cAAMU,MAAM,GAAGtjE,GAAG,CAACtR,GAAJ,CAAQ,QAAR,IAAoB,QAAAizE,YAApB,KAAqC,CAArC,GAAyC,CAAzC,GAA6C,CAA5D;AACA,cAAMsC,YAAY,GAAGjkE,GAAG,CAACxmB,IAAJ,CAAS;AAAEC,mBAAO,EAAE6pF,MAAX;AAAmB54E,mBAAO,EAAE;AAA5B,WAAT,EAA0CugC,OAA1C,CAAkD,CAAD,WAAC,KAAKs3C,gBAAN,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAElmE,QAAvB,MAA+B,IAA/B,IAA+B,aAA/B,GAA+B,MAA/B,GAA+B,GAAEze,QAAnF,CAArB,CAdiC,CAgBjC;;AACA,cAAMsmF,QAAQ,GAAG,OAAAnrF,iBAAA,CAAkBkrF,YAAlB,EAAgC,QAAAtC,YAAhC,CAAjB;AACA,eAAK72E,WAAL,GAAmBo5E,QAAQ,CAAC7mF,cAAT,CAAwB,QAAA1B,QAAA,CAASioF,WAAjC,CAAnB;AACA,eAAKO,YAAL,GAAoBD,QAAQ,CAAC1qF,IAAT,CAAc;AAAEC,mBAAO,EAAE;AAAX,WAAd,EAA+B4D,cAA/B,CAA8C,QAAA1B,QAAA,CAASioF,WAAvD,CAApB;AACA,eAAKQ,YAAL,GAAoBF,QAAQ,CAAC1qF,IAAT,CAAc;AAAEC,mBAAO,EAAE;AAAX,WAAd,EAA+B4D,cAA/B,CAA8C,QAAA1B,QAAA,CAASioF,WAAvD,CAApB;AACE;;;0CAEiB;AACd,eAAKf,UAAL;AACH;;;qCAEmB;;;AAChBnkF,iBAAO,CAACV,GAAR,CAAY,QAAArC,QAAA,CAASqkB,GAAT,GAAetR,GAAf,CAAmB,QAAnB,CAAZ;AACA,cAAM40E,MAAM,GAAG,QAAA3nF,QAAA,CAASqkB,GAAT,GAAeirB,OAAf,CAAuB,CAAD,WAAC,KAAKs3C,gBAAN,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAElmE,QAAvB,MAA+B,IAA/B,IAA+B,aAA/B,GAA+B,MAA/B,GAA+B,GAAEze,QAAxD,EAAkE8Q,GAAlE,CAAsE,QAAtE,IAAkF,QAAAizE,YAAlF,KAAmG,CAAnG,GAAuG,CAAvG,GAA2G,CAA1H;AACA,cAAMgC,UAAU,GAAG,KAAK,QAAAhoF,QAAA,CAASqkB,GAAT,GAAetR,GAAf,CAAmB,QAAnB,CAAxB;AACA,eAAKm1E,UAAL,CAAgBP,MAAhB;AACH,S,CAGD;;;;qCAC+C;AAAA;;AAAA,cAA7Br+E,OAA6B,uEAAnB,CAAmB;AAAA,cAAhB0+E,UAAgB,uEAAH,CAAG;AAE3C;AACA;AACA;AACA;AACA;AACA;AACA,cAAIU,KAAK,GAAG,CAAZ;;AACA,cAAGA,KAAK,IAAI,CAAZ,EAAc;AACV,iBAAKtB,cAAL,GAAuB,OAAAp4D,QAAA,CAAS,IAAT,EAAe1zB,SAAf,CAAyB,UAAAT,CAAC,EAAI;;;AAEjD,kBAAM8tF,WAAW,GAAG,IAAI1rF,IAAJ,CAAS,QAAA+C,QAAA,CAASqkB,GAAT,GAAenkB,OAAf,EAAT,CAApB;AACA,kBAAM0oF,OAAO,GAAG,IAAI3rF,IAAJ,CAAS,OAAAG,iBAAA,CAAkB,QAAA4C,QAAA,CAASqkB,GAAT,GAAexmB,IAAf,CAAoB;AAACC,uBAAO,EAAEwL,OAAV;AAAmByF,uBAAO,EAAEi5E;AAA5B,eAApB,EAA6D14C,OAA7D,CAAqE,CAAD,WAAC,QAAI,CAACs3C,gBAAN,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAElmE,QAAvB,MAA+B,IAA/B,IAA+B,aAA/B,GAA+B,MAA/B,GAA+B,GAAEze,QAAtG,CAAlB,EAAmI,QAAA+jF,YAAnI,EAAiJ9lF,OAAjJ,EAAT,CAAhB;AACA,kBAAM2oF,mBAAmB,GAAGlrF,IAAI,CAAC23B,GAAL,CAAS,CAACszD,OAAO,CAAC7zD,OAAR,KAAoB4zD,WAAW,CAAC5zD,OAAZ,EAArB,IAA8C,KAAvD,IAA+D,EAA3F;AACA,kBAAI2zD,KAAK,GAAGG,mBAAZ,CALiD,CAKhB;;AAEjC,sBAAI,CAACpC,aAAL,GAAqB,IAArB;AACA,sBAAI,CAACqC,gBAAL,GAAwBnrF,IAAI,CAACY,KAAL,CAAWmqF,KAAK,GAAG,EAAnB,CAAxB;AACA,sBAAI,CAACK,gBAAL,GAAwBprF,IAAI,CAACY,KAAL,CAAWmqF,KAAK,GAAG,EAAnB,CAAxB;AAEA,sBAAI,CAACI,gBAAL,GAAwB,QAAI,CAACA,gBAAL,GAAwB,EAAxB,GAA6B,MAAM,QAAI,CAACA,gBAAxC,GAA2D,QAAI,CAACA,gBAAxF;AACA,sBAAI,CAACC,gBAAL,GAAwB,QAAI,CAACA,gBAAL,GAAwB,EAAxB,GAA6B,MAAM,QAAI,CAACA,gBAAxC,GAA2D,QAAI,CAACA,gBAAxF;AAEA,gBAAEL,KAAF;;AAEA,kBAAIA,KAAK,IAAI,CAAb,EAAgB;AACZA,qBAAK,GAAG,CAAR;AACA,8BAAI,CAACtB,cAAL,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAExtF,WAAF,EAAnB,CAFY,CAGZ;;AACA,wBAAI,CAAC6sF,aAAL,GAAqB,KAArB;AACA,iBAAC,QAAI,CAACC,UAAN,IAAoB,QAAI,CAACsC,eAAL,EAApB;;AAEV,wBAAI,CAACj1E,KAAL,CAAWgC,MAAX,CAAkB,cAAA0O,gBAAlB,EAAoCtW,IAApC,CAAyC,YAAA+H,IAAA,CAAK,CAAL,CAAzC,EACE5a,SADF,CACY,UAACke,IAAD,EAAU;;;AACnB,sBAAMmuE,MAAM,GAAG,QAAA3nF,QAAA,CAASqkB,GAAT,GAAeirB,OAAf,CAAuB,CAAD,WAAC,QAAI,CAACs3C,gBAAN,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAElmE,QAAvB,MAA+B,IAA/B,IAA+B,aAA/B,GAA+B,MAA/B,GAA+B,GAAEze,QAAxD,EAAkE8Q,GAAlE,CAAsE,QAAtE,IAAkF,QAAAizE,YAAlF,KAAmG,CAAnG,GAAuG,CAAvG,GAA2G,CAA1H;AACA,sBAAMgC,UAAU,GAAG,KAAK,QAAAhoF,QAAA,CAASqkB,GAAT,GAAeirB,OAAf,CAAuB,CAAD,WAAC,QAAI,CAACs3C,gBAAN,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAElmE,QAAvB,MAA+B,IAA/B,IAA+B,aAA/B,GAA+B,MAA/B,GAA+B,GAAEze,QAAxD,EAAkE8Q,GAAlE,CAAsE,QAAtE,CAAxB;AACAyG,sBAAI,CAAC,MAAD,CAAJ,GAAgB,OAAApc,iBAAA,CAAkB,QAAA4C,QAAA,CAASqkB,GAAT,GAAeirB,OAAf,CAAuB,CAAD,WAAC,QAAI,CAACs3C,gBAAN,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAElmE,QAAvB,MAA+B,IAA/B,IAA+B,aAA/B,GAA+B,MAA/B,GAA+B,GAAEze,QAAxD,EAAkEpE,IAAlE,CAAuE;AAAEC,2BAAO,EAAE6pF,MAAX;AAAmB54E,2BAAO,EAAC;AAA3B,mBAAvE,CAAlB,EAA0H,QAAAi3E,YAA1H,EAAwI9lF,OAAxI,EAAhB,EACAsZ,IAAI,CAACxb,MAAL,GAAc,OAAAD,mBAAA,CACZ,IAAI,UAAAwQ,MAAJ,CAAW;AAAElR,wBAAI,EAAE,QAAA2C,QAAA,CAASqkB,GAAT,GAAexmB,IAAf,CAAoB;AAAEC,6BAAO,EAAE6pF,MAAX;AAAmB54E,6BAAO,EAAC;AAA3B,qBAApB,CAAR;AAA6D2V,+BAAW,EAAE,KAA1E;AAAiFC,+BAAW,EAAEnL,IAAI,CAACvX;AAAnG,mBAAX,CADY,EAEZ,QAAA+jF,YAFY,CADd;;AAKA,0BAAI,CAACjyE,KAAL,CAAW4hE,QAAX,CAAoB,cAAApkE,oBAAA,CAAqB;AAAEE,2BAAO,EAAE+H;AAAX,mBAArB,CAApB;;AAEA,0BAAI,CAACzF,KAAL,CAAW4hE,QAAX,CAAoB,QAAApwD,mBAAA,CAAoB9V,OAApB,CAA4B,cAAA6T,mBAAA,CAAoB9J,IAApB,CAA5B,CAApB;AAED,iBAbF;AAeO;AACJ,aAvCsB,CAAvB,CADU,CAwCP;AACN;AACJ;AAEH;;;;;;wDAGyC;qCAAA,CAEvC;;;AACI,cAAM6K,GAAG,GAAG,QAAArkB,QAAA,CAASqkB,GAAT,EAAZ,CAHmC,CAKvC;;AACI,cAAMsjE,MAAM,GAAGtjE,GAAG,CAACtR,GAAJ,CAAQ,QAAR,IAAoB,QAAAizE,YAApB,KAAqC,CAArC,GAAyC,CAAzC,GAA6C,CAA5D,CANmC,CAQvC;;AACI,cAAMiD,aAAa,GAAQ,OAAA7rF,iBAAA,CACnBinB,GAAG,CAACxmB,IAAJ,CAAS;AAAEC,mBAAO,EAAE6pF,MAAX;AAAmB54E,mBAAO,EAAC;AAA3B,WAAT,EACCugC,OADD,CACS,CAAD,WAAC,KAAKs3C,gBAAN,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAElmE,QAAvB,MAA+B,IAA/B,IAA+B,aAA/B,GAA+B,MAA/B,GAA+B,GAAEze,QAD1C,CADmB,EAEkC,QAAA+jF,YAFlC,CAA3B,CATmC,CAcrC;;AACE,cAAI,CAAJ,KAAI,KAAKY,gBAAL,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAErmE,KAA3B,EAAkC;AACrC;AACO,gBAAM2oE,cAAc,GAAG,wBAAKtC,gBAAL,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAErmE,KAAvB,MAA4B,IAA5B,IAA4B,aAA5B,GAA4B,MAA5B,GAA4B,GAAE/J,QAA9B,MAAsC,IAAtC,IAAsC,aAAtC,GAAsC,MAAtC,GAAsC,GAAEpJ,QAAxC,KAAoD,EAA3E,CAF8B,CAIpC;;AACM,gBAAM+7E,UAAU,GAAGF,aAAa,CAACprF,IAAd,CAAmB;AAAEC,qBAAO,EAAE;AAAX,aAAnB,EAAoC4pF,EAAvD,CAL8B,CAOpC;;AACA,gBAAMG,uBAAuB,GAAGqB,cAAc,CAACjlF,MAAf,CAAsB,UAAA8B,IAAI;AAAA,qBAAIA,IAAI,CAACoJ,WAAL,GAAmB,IAAnB,IAA2Bg6E,UAA/B;AAAA,aAA1B,CAAhC,CARoC,CAUpC;;AACA,gBAAGtB,uBAAuB,CAACtoF,MAAxB,GAAiC,CAApC,EAAuC;AACtC;AACA,kBAAM6pF,sBAAsB,GAAG,IAAInsF,IAAJ,CAAS4qF,uBAAuB,CAAC,CAAD,CAAvB,CAA2B14E,WAA3B,GAAyC,IAAlD,CAA/B,CAFsC,CAItC;;AACA,kBAAMk6E,UAAU,GAAGD,sBAAsB,CAACr0D,OAAvB,KAAmC1Q,GAAG,CAACnkB,OAAJ,EAAtD;AACA,mBAAKopF,QAAL,GAAiBD,UAAjB,CANsC,CAOtC;;AACA,mBAAKE,WAAL,GAAmB5rF,IAAI,CAACY,KAAL,CAAW8qF,UAAU,IAAI,OAAO,EAAP,GAAY,EAAhB,CAArB,CAAnB;AACM,mBAAKG,aAAL,GAAqB7rF,IAAI,CAACY,KAAL,CAAY8qF,UAAU,IAAI,OAAO,EAAP,GAAY,EAAhB,CAAX,IAAmC,OAAO,EAA1C,CAAX,CAArB,CATgC,CAWtC;;AACM,mBAAK7C,oBAAL,GAA4B,CAAC5+B,KAAK,CAACyhC,UAAD,CAAlC;AACN,aAbD,MAcK;AACJ,mBAAK7C,oBAAL,GAA4B,KAA5B;AACA;AACE;AAEJ,S,CAED;;;;gDACsD;AAAA,cAAzBjI,OAAyB,uEAAN,IAAM;;;;AAClD,cAAM/8E,GAAG,GAAG,KAAK,EAAjB;AACA,cAAMo1B,IAAI,GAAGp1B,GAAG,GAAG,CAAnB;AACA,cAAMnE,IAAI,GAAG,CAAC,CAAD,KAAC,KAAK2U,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAE/J,WAAf,EAA4BwxB,KAA5B,EAAb;AACA,cAAM/O,UAAU,GAAGrtB,IAAI,CAAC0J,YAAL,CAAkB,KAAlB,EAAyB9I,QAAzB,CAAkC;AAAER,kBAAM,EAAE,CAAV;AAAaD,uBAAW,EAAE;AAA1B,WAAlC,CAAnB;AACA,cAAMghF,WAAW,GAAGnhF,IAAI,CAAC0J,YAAL,CAAkB,MAAlB,CAApB,CALkD,CAOlD;;AACA,cAAM0J,KAAK,GAAG;AACVzS,kBAAM,EAAEugF,OAAO,GAAGC,WAAH,GAAiB9zD,UADtB;AAEVtsB,oBAAQ,EAAEmgF,OAAO,GAAG3nD,IAAH,GAAUp1B,GAFjB;AAGViiB,qBAAS,EAAE,CAAF,KAAE,KAAK7P,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEtE,EAHZ;AAIVoU,oBAAQ,EAAE,CAAF,WAAE,KAAK1R,OAAP,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAEuO,KAAd,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAEmD;AAJrB,WAAd;AAMA,eAAK3P,KAAL,CAAW4hE,QAAX,CAAoB,QAAA3vD,eAAA,CAAgBvW,OAAhB,CAAwBgB,KAAxB,CAApB;AACH;;;qCAEmB;;;AAChB,cAAMilE,KAAK,GAAG,KAAKlb,UAAL,CAAgBt/D,aAAhB,CAA8B2N,aAA9B,CAA4C,wBAA5C,CAAd;AACA6sE,eAAK,CAACtf,SAAN,CAAgB11D,GAAhB,CAAoB,MAApB;AACA,eAAKkT,IAAL,CAAU2zE,eAAV,CAA0Bc,eAA1B,GAA4C,KAA5C;AACA,eAAK3B,UAAL,GAAkB,CAAlB;AACA,eAAKvI,WAAL,GAAmB,KAAnB;AACJ,eAAKqI,oBAAL,GAA4B,KAA5B;AACI,qBAAKY,cAAL,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAExtF,WAAF,EAAnB,CAPgB,CAQhB;AACA;;AACAV,uBAAa,CAAC,KAAKmuF,eAAN,CAAb;AACH;;;2CAEyB;AACtB,cAAI,KAAKzzE,IAAL,CAAU2zE,eAAV,CAA0BkC,YAA1B,IAA0C,KAAK7C,gBAAnD,EAAqE;AACjE,iBAAKhzE,IAAL,CAAU2zE,eAAV,CAA0BkC,YAA1B,CAAuC,KAAK7C,gBAA5C;AACH;AACJ;;;+BAEa9oF,O,EAAiB;AAC3BA,iBAAO,GAAGH,IAAI,CAACk1B,KAAL,CAAW/0B,OAAX,CAAV;AAD2B,sCAEC,KAAK8oF,gBAAL,CAAsBrmE,KAFvB;AAAA,cAEpBzb,OAFoB,yBAEpBA,OAFoB;AAAA,cAEX0R,QAFW,yBAEXA,QAFW;;AAG3B,cAAM1R,OAAO,KAAIA,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE0gC,cAAb,CAAR,IAA0ChvB,QAAQ,KAAIA,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEgvB,cAAd,CAAvD,EAAuF;AACnF,iBAAKkkD,gBAAL;AACH,WAFD,MAEO;AACH,iBAAK3R,WAAL,CAAiBj6E,OAAjB;AACH;AACJ;;;6CAE2BA,O,EAAO;;;AAC/B,cAAMs5E,iBAAiB,GAAG,KAAKiB,WAAL,CAAiB93E,KAA3C;AACA,cAAMk9C,eAAe,GACjB,CAAA25B,iBAAiB,SAAjB,IAAAA,iBAAiB,WAAjB,GAAiB,MAAjB,GAAAA,iBAAiB,CAAEtlD,KAAnB,MAAwB,MAAIslD,iBAAiB,CAACtlD,KAAtB,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAEvyB,MAArD,wBACS63E,iBAAiB,CAACJ,YAAlB,CAA+Bz2D,KAA/B,CAAqC9R,KAD9C,EACsD,GADtD,IAEM,EAHV,CAF+B,CAKjB;;AACd,cAAMijB,SAAS,GAAG,KAAK1f,OAAL,CAAa0f,SAA/B;AACA,cAAMS,OAAO,GAAG,KAAKngB,OAAL,CAAamgB,OAA7B;AACA,cAAMhjB,WAAW,GAAG,OAAA/R,iBAAA,CAAkB,QAAA4C,QAAA,CAASqkB,GAAT,EAAlB,EAAkC,EAAlC,EAAsCnkB,OAAtC,KAAkD,IAAtE;AACA,cAAM2O,SAAS,GACX,OAAAzR,iBAAA,CAAkB,QAAA4C,QAAA,CAASqkB,GAAT,EAAlB,EAAkC,EAAlC,EAAsCxmB,IAAtC,CAA2C;AAAEC,mBAAO,EAAEA;AAAX,WAA3C,EAAiEoC,OAAjE,KAA6E,IADjF;AAGA,cAAM+Y,QAAQ,GAAG;AACbsH,iBAAK,EAAE;AAAEjR,gBAAE,EAAE,KAAK42E;AAAX,aADM;AAEbnzD,mBAAO,EAAE,KAFI;AAGbrB,qBAAS,EAATA,SAHa;AAIb;AACAD,wBAAY,EAAE,KAAKm1D,gBAAL,CAAsBrmE,KAAtB,CAA4Bzb,OAA5B,CAAoC2wB,QAApC,KAAiD,IAAjD,GAAuD,UAAvD,GAAoE,UALrE;AAMbtC,oBAAQ,EAAE,EANG;AAObhkB,uBAAW,EAAXA,WAPa;AAQbN,qBAAS,EAATA,SARa;AASb5M,oBAAQ,EAAEm1E,iBAAiB,SAAjB,IAAAA,iBAAiB,WAAjB,GAAiB,MAAjB,GAAAA,iBAAiB,CAAEn1E,QAThB;AAUb8vB,2BAAe,sBACVqlD,iBAAiB,SAAjB,IAAAA,iBAAiB,WAAjB,GAAiB,MAAjB,GAAAA,iBAAiB,CAAEJ,YAAnB,CAAgCz2D,KAAhC,CAAsC9R,KAD5B,EACoC2oE,iBAAiB,SAAjB,IAAAA,iBAAiB,WAAjB,GAAiB,MAAjB,GAAAA,iBAAiB,CAAEhwD,IADvD,CAVF;AAab4K,8BAAkB,sBACb,KAAKpe,IAAL,CAAUnF,KADG,EACK,CADL,CAbL;AAgBbmT,wBAAY,EAAE,KAhBD;AAiBb2W,uBAAW,EAAE,KAjBA;AAkBbzG,iBAAK,EAAE,KAAK9f,OAAL,CAAa8f,KAlBP;AAmBbH,qBAAS,EAAE,KAAKhS,WAnBH;AAoBbiS,mBAAO,EAAE,KAAKjS,WApBD;AAqBbqQ,gBAAI,EAAE,KAAK42D,gBAAL,CAAsBrmE,KArBf;AAsBbyJ,iBAAK,EAAE,gBAtBM;AAuBbjS,iBAAK,EAAE0lC,eAvBM;AAwBbxyB,qBAAS,EAAEwyB,eAxBE;AAyBbtrB,mBAAO,EAAPA;AAzBa,WAAjB;AA2BApvB,iBAAO,CAACV,GAAR,CAAY,IAAI,cAAA0f,OAAJ,CAAY9I,QAAZ,CAAZ;AACA,iBAAO,IAAI,cAAA8I,OAAJ,CAAY9I,QAAZ,CAAP;AACH,S,CAED;;;;oCACmBnb,O,EAAS;AAAA;;AACxB,eAAKwY,OAAL,GAAe,IAAf;AACA,eAAKtE,OAAL,GAAe,KAAKgkE,oBAAL,CAA0Bl4E,OAA1B,CAAf,CAFwB,CAGxB;;AACA,eAAKkU,OAAL,CAAa6P,MAAb,GAAsB,cAAAuU,cAAA,CAAe2mB,QAArC;AACA,wBAAAlyB,eAAA,CAAgB,KAAKwB,OAArB,EAA8B,KAAKra,OAAnC,EAA4C+H,IAA5C,CACI,UAACwH,QAAD,EAAuB;AACnB,gBAAI,CAACA,QAAL,EAAe;AACX;AACA;AACA;AACA,sBAAI,CAACvP,OAAL,CAAa6P,MAAb,GAAsB,cAAAuU,cAAA,CAAe8/C,WAArC;AACA;AACH;;AAED,oBAAI,CAACC,iBAAL,CAAuB7jC,IAAvB,CAA4B,QAAI,CAACtgC,OAAjC,EAA0C+H,IAA1C,CACI,UAACyR,GAAD,EAAS;AACL,sBAAI,CAAClV,OAAL,GAAe,KAAf;AACA,sBAAI,CAAC7D,OAAL,GAAe,IAAf;AACA,sBAAI,CAAC6iE,SAAL,GAAiB,IAAjB;;AACA,sBAAI,CAACh5B,sBAAL,CAA4Bh2C,OAA5B,CAAoCklB,GAApC,EAJK,CAML;AACA;;;AACA,sBAAI,CAACxZ,OAAL,GAAe,IAAI,cAAA+P,OAAJ,CAAY,MAAD,OAAC,CAAD,kBAAMyJ,GAAG,CAAC/R,MAAJ,EAAN,CAAC,EAAiB;AAAEuW,oBAAI,EAAE,QAAI,CAAChe,OAAL,CAAage;AAArB,eAAjB,CAAZ,CAAf,CARK,CASL;;AACA,sBAAI,CAACjc,KAAL,CAAW4hE,QAAX,CAAoB,cAAAjkE,oBAAA,EAApB,EAVK,CAYL;;;AACA,sBAAI,CAAC6H,QAAL,CAAcvF,SAAd,CAAwBwkE,KAAxB,CAA8B,QAA9B,EAAwC;AACpCp7C,0BAAU,EAAE5R,GAAG,CAAClc,EADoB;AAEpC2c,sBAAM,EAAE,QAAI,CAACja,OAAL,CAAage,IAAb,CAAkBtP,QAAlB,CAA2BtnB,IAFC;AAGpC42B,oBAAI,EAAE,QAAI,CAAChe,OAAL,CAAage,IAAb,CAAkBhE,UAHY;AAIpCX,0BAAU,EAAEG,GAAG,CAACvjB,WAAJ,CAAgBjB,EAJQ;AAKpCskB,wBAAQ,EAAEE,GAAG,CAACtjB,SAAJ,CAAclB,EALY;AAMpCmsB,wBAAQ,EAAE,CAAC,CAAC3H,GAAG,CAAC2H,QAAJ,CAAa5zB,MANW;AAOpCk5E,yBAAS,EAAE;AAPyB,eAAxC;;AASA,sBAAI,CAAC7kE,IAAL,CAAU2zE,eAAV,CAA0BoC,cAA1B,CAAyC,QAAI,CAAC33E,OAA9C;AACH,aAxBL,EAyBI,UAACmJ,GAAD,EAAS;AACL,sBAAI,CAAC7E,OAAL,GAAe,KAAf;AACA,sBAAI,CAACg/D,SAAL,GAAiB,KAAjB;;AACA,kBAAIn6D,GAAG,CAAC0G,MAAJ,KAAe,GAAnB,EAAwB;AACpB;AACA,wBAAI,CAAC7P,OAAL,CAAa6P,MAAb,GAAsB,cAAAuU,cAAA,CAAe8/C,WAArC;;AACA,wBAAI,CAAC55B,sBAAL,CAA4Bh2C,OAA5B,CAAoC,QAAI,CAAC0L,OAAzC;;AACA,wBAAI,CAACsjE,SAAL,GAAiB,IAAjB;AACA,wBAAI,CAAC7iE,OAAL,GAAe,KAAf;AACH,eAND,MAMO;AACH1P,uBAAO,CAACV,GAAR,CAAY8Y,GAAZ;AACH;AACJ,aArCL;AAuCH,WAjDL,EAkDI,UAACA,GAAD,EAAS;AACL;AACA,oBAAI,CAAC7E,OAAL,GAAe,KAAf;;AACA,oBAAI,CAACta,OAAL,CACI,OADJ,EAEI,YAAM;AACF,sBAAI,CAACgW,OAAL,CAAa6P,MAAb,GAAsB,cAAAuU,cAAA,CAAe8/C,WAArC;;AACA,sBAAI,CAAC55B,sBAAL,CAA4Bh2C,OAA5B,CAAoC,QAAI,CAAC0L,OAAzC;;AACA,sBAAI,CAACsjE,SAAL,GAAiB,IAAjB;AACA,sBAAI,CAAC7iE,OAAL,GAAe,KAAf;AACH,aAPL,EAQI,GARJ;AAUH,WA/DL;AAiEH;;;;MA/hByC,OAAA3Y,a;;AA3E9C;;;uBA2EamsF,wB,EAAwB,qBA2CrB,sBAAA2D,gBA3CqB,C,EA2CL,mC,EAAA,8B,EAAA,sC,EAAA,wC,EAAA,4C,EAAA,2C;AAAA,K;;;YA3CnB3D,wB;AAAwB,uC;AAAA,+C;AAAA,e;AAAA,a;AAAA,+zC;AAAA;AAAA;AAxE7B;AACE;AAEE;AACL;AACA;AACO;AACE;AAAwC;AAAA,mBAAS,IAAArH,UAAA,EAAT;AAAqB,WAArB,EAAsB,UAAtB,EAAsB;AAAA,mBAAa,IAAAA,UAAA,EAAb;AAAyB,WAA/C;AAAxC;AACF;AACF;AAEN;AAwCA;AAcI;AACA;AACF;;;;AA/DI;AAAA;AACC;AAAA;AAMF;AAAA;AAwCA;AAAA;;;;;;;;;2BAqBEqH,wB,EAAwB;cA3EpC,OAAA/mC,SA2EoC;eA3E1B;AACPjlD,kBAAQ,EAAE,kBADH;AAEPuxD,kBAAQ,qyHAFD;AAwEPpM,mBAAS,EAAE,CAAC,oCAAD,CAxEJ;AAyEPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkBuxB;AAzE1B,S;AA2E0B,Q;;;;kBA2C5B,OAAA39C,M;mBAAO,sBAAA09C,gB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpKhB;AAAA;AAAA;;AAEa,YAAAxD,cAAA,GAAiB,CAAjB;AACA,YAAA0D,cAAA,GAAiB,EAAjB;AACA,YAAAxD,YAAA,GAAsB;AAAEzrF,OAAC,EAAE,GAAL;AAAUC,OAAC,EAAE;AAAb,KAAtB;AAEA,YAAAkrF,YAAA,GAAe,EAAf;;AAEb,QAAM+D,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACloE,MAAD,EAAiC;AAC7D,cAAQA,MAAR;AACI,aAAK;AAAL;AAAA;AACI,iBAAO,cAAP;;AACJ,aAAK;AAAL;AAAA;AACI,iBAAO,sBAAP;;AACJ,aAAK;AAAL;AAAA;AACI,iBAAO,QAAP;;AACJ,aAAK;AAAL;AAAA;AACA;AACI,iBAAO,WAAP;AATR;AAWH,KAZD;;AAcA,QAAMmoE,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACnoE,MAAD;AAAA,aAA0B;AACrDthB,aAAK,EAAEshB,MAD8C;AAErDvY,eAAO,EAAEygF,uBAAuB,CAACloE,MAAD;AAFqB,OAA1B;AAAA,KAA/B;;AAKa,YAAAooE,aAAA,GAAgB;AAAA,aAA2B,C;;AAAA,Q;;AAAA,Q;;AAAA,Q;;AAAA,QAKtD/mF,GALsD,CAKlD8mF,sBALkD,CAA3B;AAAA,KAAhB;;AAQA,YAAAE,sBAAA,GAAyB,CAClC,2DADkC,EAElC,wDAFkC,EAGlC,8BAHkC,EAIlC,uEAJkC,CAAzB;AAOA,YAAAC,yBAAA,GAA4B,gFAA5B;;AAEA,YAAAC,wBAAA,GAA2B,UACpC7pE,KADoC,EAEpCsB,MAFoC,EAGpCwoE,cAHoC,EAGR;AAC5B,UAAM/6E,EAAE,GACJ,UAAGiR,KAAK,CAACwiB,MAAT,EAAkBtiC,OAAlB,CAA0B,MAA1B,IAAoC,CAApC,kBACc8f,KAAK,CAACwiB,MADpB,eAEMxiB,KAAK,CAACwiB,MAHhB;AAIA,aACI;AACIzzB,UAAE,EAAFA,EADJ;AAEIg7E,cAAM,EAAE;AACJn4C,cAAI,EAAEk4C,cAAc,iBAAUxoE,MAAV,EAAd,IAAqC,MADvC;AAEJ7pB,iBAAO,EAAE;AAFL;AAFZ,OADJ;AAQH,KAhBY;AAkBb;;;;;;;;;AAOa,YAAAuyF,4BAAA,GAA+B,UACxChqE,KADwC,EAExCiqE,UAFwC,EAGxCC,UAHwC,EAIxCC,UAJwC,EAKxB;AAChB,UAAMp7E,EAAE,GACJ,UAAGiR,KAAK,CAACwiB,MAAT,EAAkBtiC,OAAlB,CAA0B,MAA1B,IAAoC,CAApC,kBACc8f,KAAK,CAACwiB,MADpB,eAEMxiB,KAAK,CAACwiB,MAHhB;AAIA,UAAM4nD,SAAS,GAAkB,EAAjC;AACAA,eAAS,CAACzlF,IAAV,CAAe;AACXoK,UAAE,EAAFA,EADW;AAEXvE,aAAK,EAAE,YAFI;AAGXmyD,gBAAQ,EAAEstB;AAHC,OAAf;AAKAG,eAAS,CAACzlF,IAAV,CAAe;AACXoK,UAAE,EAAFA,EADW;AAEXvE,aAAK,EAAE,YAFI;AAGXmyD,gBAAQ,EAAEutB;AAHC,OAAf;;AAKA,UAAIlqE,KAAK,CAACgB,QAAV,EAAoB;AAChBopE,iBAAS,CAACzlF,IAAV,CAAe;AACXoK,YAAE,EAAFA,EADW;AAEXvE,eAAK,EAAE,OAFI;AAGXmyD,kBAAQ,EAAEwtB;AAHC,SAAf;AAKAC,iBAAS,CAACzlF,IAAV,CAAe;AACXoK,YAAE,EAAFA,EADW;AAEXvE,eAAK,EAAE,UAFI;AAGXmyD,kBAAQ,EAAEwtB;AAHC,SAAf;AAKH;;AACD,aAAOC,SAAP;AACH,KAlCY;;AAqCA,YAAAC,iBAAA,GAAoB,UAACrqE,KAAD;AAAA,aAA+B;AAC5DjR,UAAE,iBAAUiR,KAAK,CAACwiB,MAAhB,YAD0D;AAE5D8nD,mBAAW,EAAE,IAF+C;AAG5D11E,eAAO,EAAE,8BAAA8wE,wBAHmD;AAI5DryE,YAAI,EAAE,MAAF,OAAE,CAAF,EAAE,EACC2M,KADD;AAJsD,OAA/B;AAAA,KAApB;;AASA,YAAAuqE,gBAAA,GAAmB,UAAC96D,IAAD,EAA6Bu3D,eAA7B;AAAA,aAAoE;AAChGj4E,UAAE,iBAAU0gB,IAAI,CAACzP,KAAL,CAAWwiB,MAArB,YAD8F;AAEhG8nD,mBAAW,EAAE,IAFmF;AAGhG11E,eAAO,EAAE,8BAAA8wE,wBAHuF;AAIhGryE,YAAI,EAAE,MAAF,OAAE,CAAF,kBACGoc,IAAI,CAACzP,KADR,CAAE,EACW;AACbgnE,yBAAe,EAAfA,eADa;AAEbv3D,cAAI,EAAJA;AAFa,SADX;AAJ0F,OAApE;AAAA,KAAnB,C,CAWb;;;AACa,YAAA+6D,eAAA,GAAkB,6CAAlB;;;;;;;;;;;;;;;;;;;;AC3Ib;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;AAEa,YAAAC,gBAAA,GAAmB,CAC5B,SAAA1yF,YAD4B,EAE5B,SAAAk0D,eAF4B,EAG5B,sBAAAy+B,aAH4B,EAI5B,SAAAj+B,eAJ4B,EAK5B,KAAA1J,QAL4B,EAM5B,SAAAoJ,eAN4B,EAO5B,aAAA6f,SAP4B,CAAnB;AAUA,YAAA2e,qBAAA,GAAwB,CACjC,yBAAApL,oBADiC,EAEjC,8BAAAmG,wBAFiC,CAAxB;;QAoBAzE,oB;;;;AAXb;;YAWaA;;;;yBAAAA,oB;AAAoB,O;AAAA,mCAHtB,QAAAwJ,gBAGsB;;;;+EAApBxJ,oB,EAAoB;AAAA,uBAnB7B,yBAAA1B,oBAmB6B,EAlB7B,8BAAAmG,wBAkB6B;AAlBL,kBAXxB,SAAA3tF,YAWwB,EAVxB,SAAAk0D,eAUwB,EATxB,sBAAAy+B,aASwB,EARxB,SAAAj+B,eAQwB,EAPxB,KAAA1J,QAOwB,EANxB,SAAAoJ,eAMwB,EALxB,aAAA6f,SAKwB,CAkBK;AAvBpB,kBAIT,yBAAAuT,oBAJS,EAKT,8BAAAmG,wBALS;AAuBoB,O;AAlBL,K;;;;;2BAkBfzE,oB,EAAoB;cAXhC,OAAAjpF,QAWgC;eAXvB;AACN6B,sBAAY,qBACL,QAAA8wF,qBADK,CADN;AAIN7wF,iBAAO,qBACA,QAAA6wF,qBADA,CAJD;AAON1yF,iBAAO,qBACA,QAAAwyF,gBADA;AAPD,S;AAWuB,Q;;;;;;;;;;;;;;;;;;;;;;ACzCjC;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAyBA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClCQ;AAOI;AAAA;AAAA;AAAA,uCAAwB,eAAxB;AAAuC,SAAvC;AAEA;AACJ;;;;;;;;AAnCJ;AACI;AACI;AAEI;AAAA;AAAA;AAAA;AAAA;AAFJ;AAKA;AACI;AAAA;AAAA;AAAA;AAAA,WAAwB,cAAxB,EAAwB;AAAA;AAAA;AAAA;AAAA,SAAxB,EAAwB,cAAxB,EAAwB;AAAA;AAAA;AAAA;AAAA,SAAxB;AAGH;AACD;AAEI;AAAA;AAAA;AAAA,iBAAc,QAAA7E,IAAA,aAAd;AAA+B,SAA/B,EAAgC,cAAhC,EAAgC;AAAA;AAAA;AAAA,iBAEhB,QAAAE,MAAA,aAFgB;AAEG,SAFnC;;;;;;;;AASJ;AACJ;AACA;AAWJ;;;;;;;AAnC6B;AAAA;AAYjB;AAAA,kEAAqB,QAArB,EAAqB,oCAArB,EAAqB,KAArB,EAAqB,oCAArB,EAAqB,KAArB,EAAqB,uCAArB,EAAqB,WAArB,EAAqB,uCAArB,EAAqB,UAArB,EAAqB,uCAArB,EAAqB,OAArB,EAAqB,SAArB;AAYA;AAAA;;;;;;;;AAYZ;AACI;AACI;AACI;AACI;AAAK;AAAiB;AACtB;AACI;AACI;AACA;AAAK;AAAS;AAClB;AACA;AACI;AAAK;AAAiB;AACtB;AAAK;AAA6F;AAClG;AAAK;AAA0E;AAC/E;AAAK;AAAmF;AACxF;AAAK;AAAoF;AACzF;AAAK;AAAsC;AAC3C;AAAK;AAAyC;AAClD;AACJ;AACJ;AACJ;AACA;AACI;AACA;AAAK;AAAgC;AACrC;AAAK;AAAqC;AAC1C;AAAK;AAAoG;AACzG;AAAK;AAA0D;AAC/D;AAAK;AAAuD;AAChE;AACJ;AACA;AACA;AACI;AACI;AAAA;AAAA;AAAA,wCAAwB,OAAxB;AAA+B,SAA/B;AAOA;AACJ;AACJ;AACJ;;;;;AAhC6B;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAOZ;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;QDMRvG,oB;;;;;AA+CT,oCACY/rE,KADZ,EAEW2jE,MAFX,EAGYnK,cAHZ,EAIYa,MAJZ,EAKYl3D,KALZ,EAMWqC,QANX,EAOY7C,QAPZ,EAO8B;AAAA;;AAAA;;AAE1B;AARQ,iBAAA3C,KAAA,GAAAA,KAAA;AACD,iBAAA2jE,MAAA,GAAAA,MAAA;AACC,iBAAAnK,cAAA,GAAAA,cAAA;AACA,iBAAAa,MAAA,GAAAA,MAAA;AACA,iBAAAl3D,KAAA,GAAAA,KAAA;AACD,iBAAAqC,QAAA,GAAAA,QAAA;AACC,iBAAA7C,QAAA,GAAAA,QAAA;AApDL,iBAAAy0E,UAAA,GAAsB,IAAtB;AAEA,iBAAAhF,IAAA,GAAO,IAAI,OAAArtF,eAAJ,CAAoB,kBAAAstF,cAApB,CAAP;AAEA,iBAAAC,MAAA,GAAS,IAAI,OAAAvtF,eAAJ,CAA2B,kBAAAwtF,YAA3B,CAAT;AACA,iBAAAqE,SAAA,GAAY,IAAI,OAAA7xF,eAAJ,CAAmC,EAAnC,CAAZ;AAEA,iBAAAsyF,eAAA,GAAkB,IAAI,OAAAtyF,eAAJ,CAA4CwG,SAA5C,CAAlB;AACA,iBAAAytC,QAAA,GAAW,OAAA/f,aAAA,CAAc,CAAC,SAAKo+D,eAAN,CAAd,EAAsCj9E,IAAtC,CACd,YAAAjL,GAAA,CAAI,UAAC7H,KAAD;AAAA,iBAAWA,KAAK,CAAC4I,MAAN,CAAa,UAACvI,CAAD;AAAA,mBAAO,CAAC,CAACA,CAAT;AAAA,WAAb,CAAX;AAAA,SAAJ,CADc,CAAX;AAIA,iBAAA+/E,WAAA,GAAc,IAAI,OAAA3iF,eAAJ,CAAsDwG,SAAtD,CAAd;AAEA,iBAAA+rF,eAAA,GAAkB,IAAI,OAAAvyF,eAAJ,CAAgC,EAAhC,CAAlB;AACA,iBAAAwyF,YAAA,GAAe,IAAI,OAAAxyF,eAAJ,CAA6B,EAA7B,CAAf;AACA,iBAAAyyF,cAAA,GAAiB,IAAI,OAAAzyF,eAAJ,CAA0CwG,SAA1C,CAAjB;AACA,iBAAAksF,WAAA,GAAc,IAAI,OAAA1yF,eAAJ,CAA+CwG,SAA/C,CAAd;AACA,iBAAAmsF,WAAA,GAAc,IAAI,OAAA3yF,eAAJ,CAAuCwG,SAAvC,CAAd;AAEP;;AACO,iBAAAosF,SAAA,GAAY,IAAI,OAAA5yF,eAAJ,CAAuD,EAAvD,CAAZ;AAEA,iBAAAyiF,MAAA,GAAS,SAAKiQ,WAAL,CAAiBr9E,IAAjB,CAAsB,YAAAjL,GAAA,CAAI,UAACqlB,KAAD,EAAW;AAAD;;AAAA,uBAACA,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAE0d,OAAR,MAAe,IAAf,IAAe,aAAf,GAAe,EAAf,GAAmB,EAAnB;AAAqB,SAAnC,CAAtB,CAAT;AAEA,iBAAA0lD,gBAAA,GAAmB,IAAI,OAAA7yF,eAAJ,CAAyC,EAAzC,CAAnB;AACA,iBAAA8yF,oBAAA,GAAuB,IAAI,OAAA9yF,eAAJ,CAAyC,EAAzC,CAAvB;AACA,iBAAA+yF,gBAAA,GAAmB,IAAI,OAAA/yF,eAAJ,CAAyC,EAAzC,CAAnB;AAEA,iBAAAgzF,oBAAA,GAAuB,OAAA9+D,aAAA,CAAc,CAAC,SAAKu+D,cAAN,EAAsB,SAAKI,gBAA3B,CAAd,EAA4Dx9E,IAA5D,CAC1B,YAAAjL,GAAA,CAAI;AAAA;AAAA,cAAEwd,QAAF;AAAA,cAAY+C,SAAZ;;AAAA,iBAA2BA,SAAS,CAAC5iB,IAAV,CAAe,UAACsS,CAAD;AAAA,mBAAOA,CAAC,CAAC5S,KAAF,MAAYmgB,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEpR,EAAtB,CAAP;AAAA,WAAf,CAA3B;AAAA,SAAJ,CAD0B,CAAvB;AAIA,iBAAAy8E,iBAAA,GAAoB,SAAKP,WAAL,CAAiBr9E,IAAjB,CAAsB,YAAAjL,GAAA,CAAI,cAAAolB,wBAAJ,CAAtB,CAApB;AACA,iBAAA0jE,iBAAA,GAAoB,SAAKP,WAAL,CAAiBt9E,IAAjB,CAAsB,YAAAjL,GAAA,CAAI,QAAAkvD,qBAAJ,CAAtB,CAApB;AACA,iBAAA65B,eAAA,GAAkB,IAAI,OAAAnzF,eAAJ,CAAiDwG,SAAjD,CAAlB;AAMA,iBAAA4sF,gBAAA,GAAmB,KAAnB;AAmTA,iBAAA7D,eAAA,GAAmB,KAAnB;;AAkIA,iBAAAsB,cAAA,GAAiB,UAACtR,WAAD,EAAqB;AACzC,mBAAK6T,gBAAL,GAAwB,IAAxB;AACA,mBAAK7T,WAAL,GAAmBA,WAAnB;AACH,SAHM;;AAvaH,iBAAK5mE,OAAL,GAAeiF,QAAQ,CAACy1E,QAAT,EAAf;AACA,iBAAK16E,OAAL,CAAa26E,QAAb,GAAwB,KAAxB;AAJ0B;AAK7B;;;;oCAEkBrxF,O,EAAsB;AACrC,gBAAM,IAAItB,KAAJ,CAAU,yBAAV,CAAN;AACH;;;mCAEc;AAAA;;iBAAA,CACX;;;AACA,eAAKsa,KAAL,CAAW4hE,QAAX,CAAoB,cAAA7jE,gBAAA,EAApB;AAEA,cAAMu6E,SAAS,GAAG;AAAE9rF,iBAAK,EAAE,CAAF,KAAE,KAAKkR,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAEA,OAAvB;AAAgCnI,mBAAO,EAAE;AAAzC,WAAlB;AACA,eAAKmI,OAAL,CAAaiP,QAAb,CAAsBngB,KAAtB,GAA8B,KAAKkR,OAAL,CAAaiP,QAAb,CAAsB,CAAtB,EAAyBpR,EAAvD;AAEA,eAAKlU,YAAL,CACI,aADJ,EAEI,KAAK2Y,KAAL,CACKgC,MADL,CACY,OAAAC,iBADZ,EAEK7H,IAFL,CAEU,YAAA+H,IAAA,CAAK,CAAL,CAFV,EAGK5a,SAHL,CAGe,UAAC2a,IAAD,EAA4B;AACnC;AACA,oBAAI,CAAC0J,WAAL,GAAmB,IAAI,cAAA0R,IAAJ,CAASpb,IAAT,CAAnB;AACA,oBAAI,CAACq2E,cAAL,GAAsB,QAAI,CAAC3sE,WAAL,CAAiBlR,KAAjB,KAA2B,kBAAAs8E,eAAjD;AACH,WAPL,CAFJ,EAPW,CAmBX;;AACA,eAAK3vF,YAAL,CACI,YADJ,EAEI,KAAK2Y,KAAL,CACK5F,IADL,CACU,QAAA4H,MAAA,CAAO,cAAA0O,gBAAP,CADV,EACoC,YAAAu7B,oBAAA,EADpC,EAEK1kD,SAFL,CAEe,UAACkQ,IAAD,EAAuC;AAC9C,gBAAIA,IAAJ,EAAU;AACNA,kBAAI,CAACpN,QAAL,GAAgB,EAAhB;;AACA,sBAAI,CAAC6tF,eAAL,CAAqBzgF,IAArB,CAA0BA,IAA1B,EAFM,CAE2B;;AACpC;AACJ,WAPL,CAFJ;AAYA,eAAKpQ,YAAL,CACI,kBADJ,EAEI,KAAK2Y,KAAL,CAAW5F,IAAX,CAAgB,QAAA4H,MAAA,CAAO,cAAAkP,sBAAP,CAAhB,EAAgD3pB,SAAhD,CAA0D,UAACkQ,IAAD,EAAU;AAChE,oBAAI,CAACmgF,gBAAL,CAAsBngF,IAAtB,CAA2BA,IAA3B,EADgE,CAEhE;;;AACA,gBAAM+gF,IAAI,GAAG,QAAb;AACA/yF,sBAAU,CAAC,YAAM;AACb+yF,kBAAI,CAACC,oBAAL,CAA0BD,IAAI,CAACZ,gBAAL,CAAsBprF,KAAtB,CAA4B,CAA5B,CAA1B;AACH,aAFS,EAEP,CAFO,CAAV;AAGH,WAPD,CAFJ;AAYA,eAAKnF,YAAL,CACI,qBADJ,EAEI,OAAA4xB,aAAA,CAAc,CACV,KAAKjZ,KAAL,CAAW5F,IAAX,CACI,QAAA4H,MAAA,CAAO,cAAA4Q,wBAAP,CADJ,EAEI,YAAAzjB,GAAA,CAAI,UAACG,CAAD;AAAA,mBAAqCA,CAAC,CAACoP,OAAvC;AAAA,WAAJ,CAFJ,CADU,EAKV,KAAK84E,cAAL,CAAoBp9E,IAApB,CAAyB,WAAAwkD,eAAA,EAAzB,CALU,EAMV,KAAK64B,WAAL,CAAiBr9E,IAAjB,CAAsB,WAAAwkD,eAAA,EAAtB,CANU,CAAd,EAOGr3D,SAPH,CAOa,kBAAuC;AAAA;AAAA,gBAArCglB,cAAqC;AAAA,gBAArBI,QAAqB;AAAA,gBAAX6H,KAAW;;AAChD,oBAAI,CAACi/D,UAAL,GAAkBlnE,cAAlB;AAEA,gBAAMmsE,mBAAmB,GAAG,CAACnsE,cAAc,CAACZ,MAAf,IAAyB,EAA1B,EAA8Bzb,MAA9B,CACxB,UAAC2O,CAAD,EAAM;;;AACF,sBAAC,CAACA,CAAC,CAACmwB,MAAJ,IACAnwB,CAAC,CAAC+N,KAAF,CAAQxJ,QAAR,CAAiBuJ,QAAQ,CAACpR,EAA1B,CADA,IAEAsD,CAAC,CAAC+N,KAAF,CAAQxJ,QAAR,CAAiB,CAAD,KAAC,QAAI,CAAC1F,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAEA,OAA/B,CAFA;AAEuC,aAJnB,CAA5B;;AAOA,oBAAI,CAAC65E,YAAL,CAAkB9/E,IAAlB,CAAuB6rE,SAAS,CAACoV,mBAAD,CAAhC;;AAEA,gBAAM9B,SAAS,GAAkB,EAAjC;AACA,gBAAML,MAAM,GAAsC,EAAlD;AACA,gBAAMoC,UAAU,GAAG,QAAI,CAACnf,cAAL,CAAoBx6D,GAApB,CAAwB,oBAAxB,KAAiD,EAApE;AACA05E,+BAAmB,CAAChxF,OAApB,CAA4B,UAAC8kB,KAAD,EAAW;AACnC,kBAAMsB,MAAM,GAAGvB,cAAc,CAACD,SAAf,CAAyBE,KAAK,CAACjR,EAA/B,CAAf;AACA,kBAAMq9E,QAAQ,GAAG,kBAAAvC,wBAAA,CAAyB7pE,KAAzB,EAAgCsB,MAAhC,EAAwC6qE,UAAxC,CAAjB;AACApC,oBAAM,YAAKqC,QAAQ,CAACr9E,EAAd,EAAN,GAA4Bq9E,QAAQ,CAACrC,MAArC;AACAK,uBAAS,CAACzlF,IAAV,OAAAylF,SAAS,qBACF,kBAAAJ,4BAAA,CACChqE,KADD,EAEC,YAAM,CAAE,CAFT,EAGC,YAAM,CAAE,CAHT,EAIC,YAAM;AACF,oBAAG,CAAC,QAAI,CAAC+rE,cAAT,EAAyB;AACrB,0BAAI,CAACb,WAAL,CAAiBjgF,IAAjB,CAAsB+U,KAAtB;;AACA,0BAAI,CAACqsE,WAAL;AACH;AAEJ,eAVF,CADE,EAAT;AAcH,aAlBD;;AAmBA,oBAAI,CAAClB,SAAL,CAAelgF,IAAf,CAAoB8+E,MAApB;;AACA,oBAAI,CAACK,SAAL,CAAen/E,IAAf,CAAoBm/E,SAApB;;AACA,oBAAI,CAACtC,eAAL,IAAwB,QAAI,CAACuE,WAAL,EAAxB;AACH,WA5CD,CAFJ;AAiDA,eAAKxxF,YAAL,CACI,gBADJ,EAEI,KAAKkwF,YAAL,CACKn9E,IADL,CACU,YAAAm3C,cAAA,CAAe,KAAKmmC,WAApB,CADV,EAEKnwF,SAFL,CAEe,kBAAiC;AAAA;AAAA,gBAA/BgwF,YAA+B;AAAA,gBAAjBG,WAAiB;;AACxC,oBAAI,CAACI,gBAAL,CAAsBrgF,IAAtB,CAA2B8/E,YAAY,CAACpoF,GAAb,CAAiB,QAAAkvD,qBAAjB,CAA3B;AACH,WAJL,CAFJ;AASA,eAAKh3D,YAAL,CACI,gBADJ,EAEI,KAAKkwF,YAAL,CACChwF,SADD,CACW,UAACkQ,IAAD,EAAU;AACjB;AACA,gBAAM+U,KAAK,GAAI/U,IAAI,CAAC3K,IAAL,CAAU,UAAC+R,CAAD,EAAO;AAAD;;AAAC,qBAAAA,CAAC,CAACtD,EAAF,MAAI,kBAAK,QAAI,CAACmsE,WAAV,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAEl7E,KAAvB,MAA4B,IAA5B,IAA4B,aAA5B,GAA4B,MAA5B,GAA4B,GAAEggB,KAA9B,MAAmC,IAAnC,IAAmC,aAAnC,GAAmC,MAAnC,GAAmC,GAAEjR,EAAzC;AAA2C,aAA5D,CAAf;AACAiR,iBAAK,IAAI,QAAI,CAACkrE,WAAL,CAAiBjgF,IAAjB,CAAsB+U,KAAtB,CAAT;AACH,WALD,CAFJ;AAaA,eAAKnlB,YAAL,CACI,wBADJ,EAEI,KAAK2Y,KAAL,CAAW5F,IAAX,CAAgB,QAAA4H,MAAA,CAAO,cAAAiR,6BAAP,CAAhB,EAAuD1rB,SAAvD,CAAiE,UAAC6W,SAAD,EAAe;AAC5E,oBAAI,CAACk5E,eAAL,CAAqB7/E,IAArB,CAA0B,QAAI,CAACiG,OAAL,CAAaiP,QAAvC,EAD4E,CAE5E;;;AACA,gBAAIvO,SAAS,CAAC5S,MAAV,GAAmB,CAAnB,IAAwB,CAAC,QAAI,CAACgsF,cAAL,CAAoBhrF,KAAjD,EAAwD;AACpD,kBAAMssF,aAAa,GAAG16E,SAAS,CAAC,CAAD,CAA/B;;AACA,sBAAI,CAACo5E,cAAL,CAAoB//E,IAApB,CAAyBqhF,aAAzB;AACH;AACJ,WAPD,CAFJ;AAYA,eAAKzxF,YAAL,CACI,sBADJ,EAEI,KAAKmwF,cAAL,CACKp9E,IADL,CAEQ,WAAAwkD,eAAA,EAFR,EAGQ,YAAAzvD,GAAA,CAAI,UAACuC,CAAD;AAAA,mBAAiBA,CAAC,CAACyN,MAAnB;AAAA,WAAJ,CAHR,EAKK5X,SALL,CAKe,UAAC4X,MAAD,EAAY;AACnB,oBAAI,CAAC04E,oBAAL,CAA0BpgF,IAA1B,CAA+B0H,MAAM,CAAChQ,GAAP,CAAW,cAAAolB,wBAAX,CAA/B;AACH,WAPL,CAFJ,EA/HW,CA2IX;;AACA,eAAKltB,YAAL,CACI,yCADJ,EAEI,KAAKmwF,cAAL,CACKp9E,IADL,CAEQ,WAAAwkD,eAAA,EAFR,EAGQ,YAAA3S,oBAAA,EAHR,EAIQ,YAAAsF,cAAA,CAAe,KAAKkmC,WAApB,CAJR,EAKQ,YAAAtoF,GAAA,CACI;AAAA;AAAA,gBAAEwd,QAAF;AAAA,gBAAY8qE,WAAZ;;AAAA,mBACKA,WAAW,IAAI9qE,QAAQ,CAACxN,MAAT,CAAgBrS,IAAhB,CAAqB,UAACsS,CAAD;AAAA,qBAAOA,CAAC,CAAC7D,EAAF,KAASk8E,WAAW,CAACl8E,EAA5B;AAAA,aAArB,CAAhB,IACAoR,QAAQ,CAACxN,MAAT,CAAgB,CAAhB,CAFJ;AAAA,WADJ,CALR,EAWK5X,SAXL,CAWe,UAACitB,KAAD,EAAW;AAClB,oBAAI,CAACijE,WAAL,CAAiBhgF,IAAjB,CAAsB+c,KAAtB;AACH,WAbL,CAFJ,EA5IW,CA8JX;;AACA,eAAKntB,YAAL,CACI,2BADJ,EAEI,OAAA4zB,QAAA,CAAS,KAAK,IAAd,EACK7gB,IADL,CACU,YAAAm3C,cAAA,CAAe,KAAKvxC,KAAL,CAAWgC,MAAX,CAAkB,cAAA0O,gBAAlB,CAAf,CADV,EAEKnpB,SAFL,CAEe,kBAAc;AAAA;AAAA,gBAAVke,IAAU;;AAErBA,gBAAI,CAAC,MAAD,CAAJ,GAAgB,OAAApc,iBAAA,CAAkB,QAAA4C,QAAA,CAASqkB,GAAT,GAAexmB,IAAf,CAAoB;AAAEC,qBAAO,EAAE;AAAX,aAApB,CAAlB,EAAuD,kBAAAkoF,YAAvD,EAAqE9lF,OAArE,EAAhB,EACAsZ,IAAI,CAACxb,MAAL,GAAc,OAAAD,mBAAA,CACV,IAAI,UAAAwQ,MAAJ,CAAW;AAAElR,kBAAI,EAAE,QAAA2C,QAAA,CAASqkB,GAAT,GAAexmB,IAAf,CAAoB;AAAEC,uBAAO,EAAE;AAAX,eAApB,CAAR;AAA6C4mB,yBAAW,EAAE,KAA1D;AAAiEC,yBAAW,EAAEnL,IAAI,CAACvX;AAAnF,aAAX,CADU,EAEV,kBAAA+jF,YAFU,CADd;;AAKA,oBAAI,CAACjyE,KAAL,CAAW4hE,QAAX,CAAoB,cAAApkE,oBAAA,CAAqB;AAAEE,qBAAO,EAAE+H;AAAX,aAArB,CAApB;;AACA,oBAAI,CAACzF,KAAL,CAAW4hE,QAAX,CAAoB,QAAApwD,mBAAA,CAAoB9V,OAApB,CAA4B,cAAA6T,mBAAA,CAAoB9J,IAApB,CAA5B,CAApB;AACH,WAXL,CAFJ;AAgBA,eAAKgzE,oBAAL,CAA0B,KAAK/6E,OAAL,CAAaiP,QAAvC;AACA,eAAKosE,mBAAL,CAAyBT,SAAzB;AAEH;;;iCAEe;AACZ,cAAI,KAAKlG,IAAL,CAAU5lF,KAAV,GAAkB,kBAAAupF,cAAtB,EAAsC;AAClC,iBAAK3D,IAAL,CAAU36E,IAAV,CAAe,KAAK26E,IAAL,CAAU5lF,KAAV,GAAkB,CAAjC;AACH;AACJ;;;kCAEgB;AACb,cAAI,KAAK4lF,IAAL,CAAU5lF,KAAV,GAAkB,kBAAA6lF,cAAtB,EAAsC;AAClC,iBAAKD,IAAL,CAAU36E,IAAV,CAAe,KAAK26E,IAAL,CAAU5lF,KAAV,GAAkB,CAAjC;AACH;AACJ;;;mDAEiC;AAC9B,eAAKm3E,MAAL,CAAYriE,IAAZ,CAAiB,qCAAA03E,+BAAjB,EAAkD;AAC9Cn5E,gBAAI,EAAE,KAAK23E,cAAL,CAAoBhrF,KADoB;AAE9C+U,sBAAU,EAAE,WAFkC;AAG9C0vC,qBAAS,EAAE,KAHmC;AAI9CC,yBAAa,EAAE;AAJ+B,WAAlD;AAMH;;;0CAEwB;AACrB,eAAKkhC,IAAL,CAAU36E,IAAV,CAAe,kBAAA46E,cAAf;AACA,eAAKC,MAAL,CAAY76E,IAAZ,CAAiB,kBAAA86E,YAAjB;AACA,eAAK7K,WAAL,CAAiBjwE,IAAjB,CAAsBlM,SAAtB;AACH;;;6CAE2B+sF,S,EAA8B;AAAA;;AACtD,eAAKhB,eAAL,CACKl9E,IADL,CAEQ,YAAAjL,GAAA,CAAI,UAACy1C,GAAD;AAAA,mBAASA,GAAG,CAAC93C,IAAJ,CAAS,UAAC4E,CAAD;AAAA,qBAAOA,CAAC,CAAC6J,EAAF,KAAS+8E,SAAS,CAAC9rF,KAA1B;AAAA,aAAT,CAAT;AAAA,WAAJ,CAFR,EAGQ,YAAA2V,IAAA,CAAK,CAAL,CAHR,EAIQ,WAAAy8C,eAAA,EAJR,EAMKr3D,SANL,CAMe,UAACkQ,IAAD,EAAU;AACjB,oBAAI,CAAC+/E,cAAL,CAAoB//E,IAApB,CAAyBA,IAAzB;AACH,WARL;AASH;;;4CAE0B6gF,S,EAA8B;AAAA;;AACrD,eAAKd,cAAL,CACKp9E,IADL,CAEQ,YAAAjL,GAAA,CAAI,UAACuC,CAAD,EAAO;AAAD;;AAAA,yBAACA,CAAC,CAACyN,MAAH,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAErS,IAAF,CAAO,UAACsS,CAAD;AAAA,qBAAOA,CAAC,CAAC7D,EAAF,MAAS+8E,SAAS,SAAT,IAAAA,SAAS,WAAT,GAAS,MAAT,GAAAA,SAAS,CAAE9rF,KAApB,CAAP;AAAA,aAAP,CAAT;AAAiD,WAA3D,CAFR,EAGQ,YAAA2V,IAAA,CAAK,CAAL,CAHR,EAIQ,WAAAy8C,eAAA,EAJR,EAMKr3D,SANL,CAMe,UAACkQ,IAAD,EAAU;AACjB,oBAAI,CAACggF,WAAL,CAAiBhgF,IAAjB,CAAsBA,IAAtB;AACH,WARL;AASH;;;0CAEwB6gF,S,EAA+B;AAAA;;AACpD,eAAKf,YAAL,CACKn9E,IADL,CAEQ,YAAAjL,GAAA,CAAI,UAACy1C,GAAD;AAAA,mBAASA,GAAG,CAAC93C,IAAJ,CAAS,UAAC+R,CAAD,EAAO;AAAD;;AAAC,qBAAAA,CAAC,CAACtD,EAAF,MAAI,MAAK,QAAI,CAACmsE,WAAV,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAEl7E,KAAF,CAAQggB,KAAR,CAAcjR,EAAvC;AAAyC,aAAzD,CAAT;AAAA,WAAJ,CAFR,EAGQ;AACA,qBAAAqjD,eAAA,EAJR,EAMKr3D,SANL,CAMe,UAACkQ,IAAD,EAAU;AACjB,oBAAI,CAACigF,WAAL,CAAiBjgF,IAAjB,CAAsBA,IAAtB;AACH,WARL;AASH;;;sCAEoB;AAAA;;AACjB;AACA,eAAKigF,WAAL,CAAiBt9E,IAAjB,CAAsB,YAAA+H,IAAA,CAAK,CAAL,CAAtB,EAA+B,WAAAy8C,eAAA,EAA/B,EAAyDr3D,SAAzD,CAAmE,UAACkQ,IAAD,EAAU;AACzE,gBAAIlS,KAAK,GAAG,CAAZ;;AACA,gBAAIkS,IAAI,CAAC+c,KAAL,CAAWjZ,EAAX,KAAkB,QAAI,CAACk8E,WAAL,CAAiBjrF,KAAjB,CAAuB+O,EAA7C,EAAiD;AAC7C,sBAAI,CAACk8E,WAAL,CAAiBhgF,IAAjB,CAAsBA,IAAI,CAAC+c,KAA3B;;AACAjvB,mBAAK,GAAG,GAAR;AACH;;AACD,oBAAI,CAAC0C,OAAL,CACI,oBADJ,EAEI,YAAM;;;AACF,kBAAMy/E,WAAW,GAAG,cAAAvvD,sBAAA,CAChB,CAAC,QAAI,CAACu/D,WAAL,CAAiBlrF,KAAlB,CADgB,EAEhB,CAAC,QAAI,CAACirF,WAAL,CAAiBjrF,KAAlB,CAFgB,EAGhB,CAAC,QAAI,CAACgrF,cAAL,CAAoBhrF,KAArB,CAHgB,CAApB,CADE,CAMF;;AAEA,sBAAI,CAACk7E,WAAL,CAAiBjwE,IAAjB,CAAsB6rE,SAAS,CAACoE,WAAW,CAAC,CAAD,CAAZ,CAA/B;;AACA,sBAAI,CAAC4M,eAAL,IAAwB,QAAI,CAACF,aAAL,CAAoB9Q,SAAS,CAACoE,WAAW,CAAC,CAAD,CAAZ,CAA7B,CAAxB;;AATE,2BAWa,CAAH,WAAG,QAAI,CAACA,WAAR,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAEl7E,KAAlB,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAEggB,KAXtC;AAAA,kBAWTzb,OAXS,UAWTA,OAXS;AAAA,kBAWA0R,QAXA,UAWAA,QAXA,EAW6C;;;AAC/C,kBAAK,QAAI,CAACgxE,UAAL,CAAgBnnE,SAAhB,CAA0B,QAAI,CAACo7D,WAAL,CAAiBl7E,KAAjB,CAAuBggB,KAAvB,CAA6BjR,EAAvD,MAA+D,aAA/D,IAAiF,CAAAxK,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE0gC,cAAT,MAA4BhvB,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEgvB,cAAtC,CAAtF,EAA8I;AAC1I;AACA,wBAAI,CAACzxB,KAAL,CAAW4hE,QAAX,CACI,cAAApkE,oBAAA,CAAqB;AACjBE,yBAAO,EAAE,MAAF,OAAE,CAAF,kBACA,QAAI,CAACw6E,eAAL,CAAqB1rF,KADrB,CAAE,EACwB;AAC7By2E,gCAAY,EAAE,QAAI,CAACyE,WAAL,CAAiBl7E;AADF,mBADxB;AADQ,iBAArB,CADJ;;AAQA,wBAAI,CAACkpF,YAAL,CAAkB,QAAI,CAAChO,WAAL,CAAiBl7E,KAAnC;AACH;;AACD,eAAC,QAAI,CAAC8nF,eAAN,IAAyB,QAAI,CAAC+C,eAAL,CAAqB5/E,IAArB,CAA0B,kBAAAs/E,gBAAA,CAAiB,QAAI,CAACrP,WAAL,CAAiBl7E,KAAlC,EAAyC,QAAzC,CAA1B,CAAzB;;AACA,sBAAI,CAAC4lF,IAAL,CAAU36E,IAAV,CAAe,CAAf;AACH,aA5BL,EA6BIlS,KA7BJ;AA+BH,WArCD;AAsCH;;;uCAKqB4d,K,EAAa;AAAA;;AAC/B,eAAKnD,KAAL,CAAW4hE,QAAX,CAAoB,cAAA7jE,gBAAA,EAApB;AAEA,eAAKiC,KAAL,CAAWgC,MAAX,CAAkB,cAAA0O,gBAAlB,EAAoCtW,IAApC,CAAyC,YAAA+H,IAAA,CAAK,CAAL,CAAzC,EACF5a,SADE,CACQ,UAACke,IAAD,EAAU;AACpBA,gBAAI,CAACiI,WAAL,GAAmB,cAAAsB,kBAAA,CAAmB,CAAnB,CAAnB,EACkBvJ,IAAI,CAAC4J,QAAL,GAAgB,cAAAJ,qBADlC,EAEC,QAAI,CAACjP,KAAL,CAAW4hE,QAAX,CAAoB,cAAApkE,oBAAA,CAAqB;AAAEE,qBAAO,EAAE+H;AAAX,aAArB,CAApB,CAFD;AAGA,WALE;AAOA,cAAMwzE,gBAAgB,GAAG;AACrB50F,iBAAK,EAAE;AAAEqZ,qBAAO,EAAE,KAAK+5E,WAAL,CAAiBjrF;AAA5B,aADc;AAErB88E,sBAAU,EAAE,KAAKnmE,KAFI;AAGrB+mC,uBAAW,EAAE;AACT30C,qBAAO,EAAE;AADA;AAHQ,WAAzB;AAOA,eAAKiQ,QAAL,CAAc0zE,eAAd,GAAgC,IAAhC;AACA,eAAK7e,MAAL,CAAYj9B,QAAZ,CAAqB,CAACj6B,KAAD,CAArB,EAA8B81E,gBAA9B;AACH,S,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;qCAEoBh9D,I,EAA4B;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,cAAI2B,SAAS,GAAG;AAAEroB,mBAAO,EAAE,KAAKqW,WAAL,CAAiBvmB,IAA5B;AAAkCmH,iBAAK,EAAE,KAAKof,WAAL,CAAiBlR;AAA1D,WAAhB;AACA,eAAKsF,KAAL,CAAW4hE,QAAX,CACI,cAAApkE,oBAAA,CAAqB;AACjBE,mBAAO,EAAE;AACLkgB,uBAAS,EAAEA,SADN;AAEL3H,mBAAK,EAAE,gBAFF;AAGL;AACA5C,kBAAI,EAAE,EAJD;AAKL0K,mBAAK,EAAE,EALF;AAML+xB,wBAAU,EAAE,CANP;AAOLmzB,0BAAY,EAAEhnD;AAPT;AADQ,WAArB,CADJ;AAcA,eAAKo+C,MAAL,CAAYj9B,QAAZ,CAAqB,CAAC,WAAD,CAArB,EAAoC;AAAEksC,sBAAU,EAAE,KAAKnmE;AAAnB,WAApC;AACH;;;qCAEmB7Z,I,EAA8B;AAC9C,cAAM6vF,SAAS,GAAG,IAAIjwF,IAAJ,CAASI,IAAT,EAAe89C,MAAf,EAAlB;AACA,iBAAOyM,KAAK,CAACslC,SAAD,CAAL,GACD,IADC,GAED,CAAC,QAAD,EAAW,QAAX,EAAqB,SAArB,EAAgC,WAAhC,EAA6C,UAA7C,EAAyD,QAAzD,EAAmE,UAAnE,EACIA,SADJ,CAFN;AAKH;;;;MA9dqC,OAAApzF,a;;AAL1C;;;uBAKagmF,oB,EAAoB,8B,EAAA,kC,EAAA,wC,EAAA,+B,EAAA,uC,EAAA,2C,EAAA,iC;AAAA,K;;;YAApBA,oB;AAAoB,uC;AAAA;AAAA;AAAA,O;AAAA,wE;AAAA,c;AAAA,a;AAAA,goC;AAAA;AAAA;ACxEjC;AACI;AAqCA;AA6CJ;;;;AAlFiD;AAAA;AAqCxC;AAAA;;;;;;;;;;2BDkCIA,oB,EAAoB;cALhC,OAAA5gC,SAKgC;eALtB;AACPjlD,kBAAQ,EAAE,kBADH;AAEPklD,qBAAW,EAAE,+BAFN;AAGPC,mBAAS,EAAE,CAAC,+BAAD;AAHJ,S;AAKsB,Q;;;;;;;;;;;;;;;;;;gBAC5B,OAAAziD;;;;;;;;;;;;;;;;;;;;;;;;AEzEL;AAAA;AAAA;;AAQA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;AAQgB;AACgC;AAAgD;;;;;AAAhD;AAAA;;;;QAUnC6jF,sB;;;;;AAmCT,sCAAoBpS,MAApB,EACoBl3D,KADpB,EAC2C;AAAA;;AAAA;;AACvC;AAFgB,iBAAAk3D,MAAA,GAAAA,MAAA;AACA,iBAAAl3D,KAAA,GAAAA,KAAA;AAlCb,iBAAAi2E,aAAA,GAAqC,CACxC;AACI5sF,eAAK,EAAE,CADX;AAEI+I,iBAAO,EAAE,MAFb;AAGI8Y,cAAI,EAAE;AACF80B,kBAAM,EAAE;AADN;AAHV,SADwC,EAQxC;AACI32C,eAAK,EAAE,CADX;AAEI+I,iBAAO,EAAE,KAFb;AAGI8Y,cAAI,EAAE;AACF80B,kBAAM,EAAE;AADN;AAHV,SARwC,EAexC;AACI32C,eAAK,EAAE,CADX;AAEI+I,iBAAO,EAAE,UAFb;AAGI8Y,cAAI,EAAE;AACFlL,iBAAK,EAAE,kBADL;AAEFggC,kBAAM,EAAE;AAFN;AAHV,SAfwC,CAArC;AAyBA,iBAAAk2C,cAAA,GAAiB,IAAI,OAAAt0F,eAAJ,CAAuC,SAAKq0F,aAAL,CAAmB,CAAnB,CAAvC,CAAjB;AAMA,iBAAAE,oBAAA,GAAuB,IAAI,OAAA1wC,YAAJ,EAAvB;AAGoC;AAE1C;;;;mCAEc;AAAA;;AACX,eAAK0wC,oBAAL,CAA0B7hF,IAA1B,CAA+B,KAAK4hF,cAAL,CAAoB7sF,KAAnD;AAEA,eAAKnF,YAAL,CAAkB,YAAlB,EAAgC,KAAK8b,KAAL,CAAWi9D,aAAX,CAC3BhmE,IAD2B,CACtB,WAAAskD,wBAAA,EADsB,EAE3Bn3D,SAF2B,CAEjB,UAACkQ,IAAD,EAAoB;AAC3B,gBAAM8hF,eAAe,GAAG,QAAI,CAACH,aAAL,CAAmBtsF,IAAnB,CAAwB,UAAAonB,CAAC;AAAA,qBAAIA,CAAC,CAAC3e,OAAF,CAAUvE,WAAV,OAA4ByG,IAAI,CAACuH,GAAL,CAAS,SAAT,CAAhC;AAAA,aAAzB,CAAxB;;AACA,oBAAI,CAACw6E,gBAAL,CAAsBD,eAAe,SAAf,IAAAA,eAAe,WAAf,GAAAA,eAAA,GAAmB,QAAI,CAACH,aAAL,CAAmB,CAAnB,CAAzC;AACH,WAL2B,CAAhC;AAMH;;;yCAEuBvlE,M,EAA2B;;;AAC/C,eAAKwlE,cAAL,CAAoB5hF,IAApB,CAAyBoc,MAAzB;AACA,eAAKylE,oBAAL,CAA0B7hF,IAA1B,CAA+Boc,MAA/B;;AAEA,oBAAGA,MAAM,CAACxF,IAAV,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAElL,KAAhB,EAAuB;AACnB,iBAAKk3D,MAAL,CAAYj9B,QAAZ,CAAqB,CAAC,kBAAD,CAArB,EAA2C;AAAEksC,wBAAU,EAAE,KAAKnmE;AAAnB,aAA3C;AACH,WAFD,MAGK;AACA;AACD,iBAAKk3D,MAAL,CAAYj9B,QAAZ,CAAqB,EAArB,EAAyB;AACrBksC,wBAAU,EAAE,KAAKnmE,KADI;AAErB+mC,yBAAW,EAAE;AACT30C,uBAAO,EAAEse,MAAM,CAACte,OAAP,CAAevE,WAAf;AADA,eAFQ;AAKrByoF,iCAAmB,EAAE;AALA,aAAzB;AAOH;AAGJ;;;;MAtEuC,OAAA1zF,a;;AAjB5C;;;uBAiBa0mF,sB,EAAsB,+B,EAAA,uC;AAAA,K;;;YAAtBA,sB;AAAsB,yC;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,mR;AAAA;AAAA;AAd3B;AACI;AACI;AAAgC;AAAO;AACvC;AAEJ;AAEA;AAEY;AAAA,mBAAkB,IAAA+M,gBAAA,QAAlB;AAA0C,WAA1C;;AAA4C;AAC5D;;;;AANc;AAAA;AAGE;AAAA,sDAAyB,UAAzB,EAAyB,wCAAzB;;;;;;;;;;2BAOX/M,sB,EAAsB;cAjBlC,OAAAthC,SAiBkC;eAjBxB;AACPjlD,kBAAQ,EAAE,oBADH;AAEPuxD,kBAAQ,umBAFD;AAePpM,mBAAS,EAAE,CAAC,iCAAD;AAfJ,S;AAiBwB,Q;;;;;;;;gBA6B9B,OAAAziD;;;gBAGA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AClEL;AAAA;AAAA;;AAQA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAOA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DgB;AAAgD;AAAyC;;;;;;AACzF;AAA+B;AAA2C;;;;;;AAC1E;AAAuD;AAA+C;;;;;;AACtG;AACI;AACJ;;;;;AADI;AAAA;;;;;;;;;;QAiCP4hC,qC;AAqBT,qDACoCrtE,IADpC,EAEY4tB,SAFZ,EAGYnV,OAHZ,EAGkC;AAAA;;AAFE,aAAAzY,IAAA,GAAAA,IAAA;AACxB,aAAA4tB,SAAA,GAAAA,SAAA;AACA,aAAAnV,OAAA,GAAAA,OAAA;AAvBK,aAAAmqD,UAAA,GAAa,IAAI,OAAA75B,YAAJ,EAAb;AASV,aAAA8C,UAAA,GAAqB,OAAA1hD,mBAAA,CAAoB,IAAI,UAAAwQ,MAAJ,EAApB,EAAkC,EAAlC,CAArB;AACA,aAAA2T,SAAA,GAAqB,IAArB;AACA,aAAAiiC,SAAA,GAAY,IAAI,QAAA1pB,SAAJ,CAAc;AAC7Bz8B,gBAAM,EAAE,IAAI,QAAAg6B,WAAJ,CAAgB,KAAKynB,UAArB,EAAiC,CAAC,QAAAvnB,UAAA,CAAWC,QAAZ,CAAjC,CADqB;AAE7B/5B,kBAAQ,EAAE,IAAI,QAAA45B,WAAJ,CAAgB,cAAApV,wBAAhB,EAA0C,CAAC,QAAAsV,UAAA,CAAWC,QAAZ,CAA1C;AAFmB,SAAd,CAAZ;AAIA,aAAAwjB,aAAA,GAAgB,EAAhB;AACA,aAAAN,gBAAA,GAAmB,EAAnB;AACA,aAAAsE,UAAA,GAAa,EAAb;AACA,aAAAC,QAAA,GAAW,EAAX;AAMH;;;;mCAMW;AACX78C,iBAAO,CAACV,GAAR,CAAY,QAAZ;AACA,eAAK8hD,SAAL,CAAelmD,QAAf,CAAwB;AACpBD,kBAAM,EAAE,KAAK4V,IAAL,CAAU65E,aADE;AAEpBrvF,oBAAQ,EAAE,KAAKwV,IAAL,CAAUmjC;AAFA,WAAxB;AAIAh0C,iBAAO,CAACV,GAAR,CAAY,QAAZ;AACA,eAAKqrF,aAAL;AACH,S,CAED;;;;qCACoB3yF,O,EAAY;AAC5B,eAAK6Y,IAAL,CAAU65E,aAAV,GAA0B1yF,OAAO,CAAC0yF,aAAlC,CAD4B,CACqB;;AACjD,eAAK75E,IAAL,CAAUmjC,eAAV,GAA4Bh8C,OAAO,CAACg8C,eAApC;AACA,eAAK22C,aAAL;AACH;;;wCAEsB;AAAA;;qDAAA,CACnB;AACA;;;AACA,cAAM1vF,MAAM,GAAG,KAAK4V,IAAL,CAAU5V,MAAzB;AACA,eAAK26E,UAAL,GAAkB,OAAApwE,wBAAA,CAAyBvK,MAAzB,CAAlB;AACA,eAAK66E,UAAL,GAAkB,OAAA1wE,gCAAA,CAAiCnK,MAAjC,EAAyCA,MAAM,CAACE,QAAP,CAAgB;AAAEJ,mBAAO,EAAE,KAAK8V,IAAL,CAAUxV;AAArB,WAAhB,CAAzC,CAAlB;AACA,eAAK06E,cAAL,GAAsB,OAAAz0E,gBAAA,CAAiB,KAAKuP,IAAL,CAAUxV,QAA3B,CAAtB;AAEA,cAAMqvF,aAAa,GAAG,KAAK75E,IAAL,CAAU65E,aAAhC;AACA,eAAKE,iBAAL,GAAyB,OAAAplF,wBAAA,CAAyBklF,aAAzB,CAAzB;AACA,eAAKG,iBAAL,GAAyB,OAAAzlF,gCAAA,CAAiCslF,aAAjC,EAAgDA,aAAa,CAACvvF,QAAd,CAAuB;AAAEJ,mBAAO,EAAE,KAAK8V,IAAL,CAAUmjC;AAArB,WAAvB,CAAhD,CAAzB;AACA,eAAK82C,qBAAL,GAA6B,OAAAxpF,gBAAA,CAAiB,KAAKuP,IAAL,CAAUmjC,eAA3B,CAA7B;AACA,eAAK0I,UAAL,GAAkB,OAAA1hD,mBAAA,CAAoB0vF,aAApB,EAAmC,EAAnC,CAAlB,CAZmB,CAYuC;;AAE1D,cAAM11E,KAAK,GAAG,EAAd;AACAA,eAAK,CAAC,KAAKnE,IAAL,CAAU2M,KAAV,CAAgB9R,KAAjB,CAAL,GAA+B,kBAAKmF,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEk6E,cAAX,MAAyB,IAAzB,IAAyB,aAAzB,GAAyB,MAAzB,GAAyB,GAAE/1E,KAAF,CAAQ,CAAD,WAAC,KAAKnE,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAE2M,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAE9R,KAA1B,CAAzB,KAA6D,CAA5F;AACA,cAAMwc,SAAS,GAAG,EAAlB;AACAA,mBAAS,CAAC,KAAKrX,IAAL,CAAU2M,KAAV,CAAgB9R,KAAjB,CAAT,GAAmC,kBAAKmF,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEk6E,cAAX,MAAyB,IAAzB,IAAyB,aAAzB,GAAyB,MAAzB,GAAyB,GAAE/1E,KAAF,CAAQ,CAAD,WAAC,KAAKnE,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAE2M,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAE9R,KAA1B,CAAzB,KAA6D,CAAhG;AAEA,eAAKqxC,oBAAL,CAA0B,CAAD,WAAC,KAAKlsC,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAE2M,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEte,QAA5C;AAEA,cAAM8rF,WAAW,GAAG,IAAI,cAAAhsE,OAAJ,CAAY;AAC5BzS,cAAE,EAAE,KAAKsE,IAAL,CAAU2xE,SADc;AAE5Bp2E,uBAAW,EAAE,KAAKyE,IAAL,CAAU65E,aAAV,CAAwB1+E,OAFT;AAG5BF,qBAAS,EAAE,KAAK+E,IAAL,CAAU65E,aAAV,CAAwBvvF,QAAxB,CAAiC;AAAEJ,qBAAO,EAAE,KAAK8V,IAAL,CAAUmjC;AAArB,aAAjC,EAAyEhoC,OAHxD;AAI5BihB,gBAAI,EAAE,KAAKpc,IAAL,CAAU2M,KAJY;AAK5BxI,iBAAK,EAALA,KAL4B;AAM5BkT,qBAAS,EAATA;AAN4B,WAAZ,CAApB;AASA,wBAAAJ,eAAA,CACI,KAAKwB,OADT,EAEI0hE,WAFJ,EAGEh0E,IAHF,CAGO,UAACwH,QAAD,EAAuB;AAC1B,oBAAI,CAACW,SAAL,GAAiBX,QAAjB;AACH,WALD,WAKS,YAAM;AACX,oBAAI,CAACW,SAAL,GAAiB,KAAjB;AACH,WAPD;AAQH;;;qCAEmB;AAChB,eAAKsf,SAAL,CAAeC,KAAf,CAAqB,IAArB;AACH;;;8CAE4BzjC,M,EAAgB;AACzC,cAAMgwF,YAAY,GAAW,KAAK7pC,SAAL,CAAe5jD,KAAf,CAAqBvC,MAAlD;AACA,cAAMwD,GAAG,GAAGwsF,YAAY,CAAC/vF,QAAb,CAAsB;AAC9BuD,eAAG,EAAExD,MAAM,CAAC88C,OADkB;AAE9Br7C,iBAAK,EAAEzB,MAAM,CAAC68C,SAFgB;AAG9Bn7C,gBAAI,EAAE1B,MAAM,CAAC48C;AAHiB,WAAtB,CAAZ;AAKA,eAAK38C,QAAL,CAAcuD,GAAd,EAAmB,KAAK2iD,SAAL,CAAevb,QAAf,CAAwB5qC,MAA3C;AACH;;;iCAEeiwF,M,EAAQC,W,EAA8B;AAClD;AACAA,qBAAW,CAACjwF,QAAZ,CAAqBgwF,MAArB,EAFkD,CAEpB;;AAC9B,eAAKzX,UAAL,CAAgBz4B,IAAhB,CAAqB,KAAKoG,SAAL,CAAe5jD,KAApC;AACH;;;kCAEgB;AAAA;;;;AACb,cAAMwX,KAAK,GAAG,EAAd;AACAA,eAAK,CAAC,KAAKnE,IAAL,CAAU2M,KAAV,CAAgB9R,KAAjB,CAAL,GAA+B,kBAAKmF,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEk6E,cAAX,MAAyB,IAAzB,IAAyB,aAAzB,GAAyB,MAAzB,GAAyB,GAAE/1E,KAAF,CAAQ,CAAD,WAAC,KAAKnE,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAE2M,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAE9R,KAA1B,CAAzB,KAA6D,CAA5F;AACA,cAAMwc,SAAS,GAAG,EAAlB;AACAA,mBAAS,CAAC,KAAKrX,IAAL,CAAU2M,KAAV,CAAgB9R,KAAjB,CAAT,GAAmC,kBAAKmF,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEk6E,cAAX,MAAyB,IAAzB,IAAyB,aAAzB,GAAyB,MAAzB,GAAyB,GAAE/1E,KAAF,CAAQ,CAAD,WAAC,KAAKnE,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAE2M,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAE9R,KAA1B,CAAzB,KAA6D,CAAhG;AAEA,cAAM23D,YAAY,GAAG,UAAAhrB,sCAAA,CAAuC,KAAKxnC,IAAL,CAAU65E,aAAV,CAAwBzmF,EAA/D,EAAmE,CAAF,WAAE,KAAK4M,IAAP,MAAW,IAAX,IAAW,aAAX,GAAW,MAAX,GAAW,GAAEk6E,cAAX,MAAyB,IAAzB,IAAyB,aAAzB,GAAyB,MAAzB,GAAyB,GAAE7rF,QAA9F,CAArB;AACA,cAAM8rF,WAAW,GAAG,IAAI,cAAAhsE,OAAJ,CAAY;AAC5BzS,cAAE,EAAE,KAAKsE,IAAL,CAAU2xE,SADc;AAE5Bp2E,uBAAW,EAAEi3D,YAAY,CAACr3D,OAFE;AAG5BF,qBAAS,EAAEu3D,YAAY,CAACloE,QAAb,CAAsB;AAAEJ,qBAAO,EAAE,KAAK8V,IAAL,CAAUmjC;AAArB,aAAtB,CAHiB;AAI5B/mB,gBAAI,EAAE,KAAKpc,IAAL,CAAU2M,KAJY;AAK5BxI,iBAAK,EAALA,KAL4B;AAM5BkT,qBAAS,EAATA;AAN4B,WAAZ,CAApB;AASA,wBAAAJ,eAAA,CACI,KAAKwB,OADT,EAEI0hE,WAFJ,EAGEh0E,IAHF,CAGO,UAACwH,QAAD,EAAuB;AAC1B,oBAAI,CAACW,SAAL,GAAiBX,QAAjB;;AACA,oBAAI,CAACigB,SAAL,CAAeC,KAAf,CAAqB,MAAD,OAAC,CAAD,EAAC,EACd,QAAI,CAAC0iB,SAAL,CAAe5jD,KADD,CAArB;AAGH,WARD,WAQS,YAAM;AACX,oBAAI,CAAC2hB,SAAL,GAAiB,KAAjB;AACH,WAVD;AAWH;;;6CAE4BjgB,Q,EAAkB;AAC3C,cAAIA,QAAJ,EAAc;AACV,iBAAKo5C,gBAAL,GAAwBp5C,QAAxB;AACA,gBAAMksF,kBAAkB,GAAG,KAAKhqC,SAAL,CAAe5jD,KAAf,CAAqBvC,MAAhD;AACA,gBAAMowF,gBAAgB,GAAGD,kBAAkB,CAACjwF,QAAnB,CAA4B;AAAEJ,qBAAO,EAAE,KAAKqmD,SAAL,CAAe5jD,KAAf,CAAqBnC;AAAhC,aAA5B,CAAzB;AACA,iBAAKuhD,UAAL,GAAkBwuC,kBAAkB,CAAC7lF,eAAnB,CAAmC,OAAnC,CAAlB;AACA,iBAAKs3C,QAAL,GAAgBwuC,gBAAgB,CAAC9lF,eAAjB,CAAiC,OAAjC,CAAhB;AACH,WAND,MAMO;AACH,iBAAK+yC,gBAAL,GAAwB,KAAKM,aAAL,CAAmBx4C,KAAnB,CAAyB,CAAzB,CAAxB;AACA,iBAAKw8C,UAAL,GAAkB,EAAlB;AACA,iBAAKC,QAAL,GAAgB,EAAhB;AACH;AACJ;;;4BA1HsB;AACnB,iBAAO,KAAKhsC,IAAL,CAAU65E,aAAjB,CADmB,CACa;AACnC;;;;;;AA/GL;;;uBAkFaxM,qC,EAAqC,qBAsBlC,SAAAhiC,eAtBkC,C,EAsBnB,qC,EAAA,sC;AAAA,K;;;YAtBlBgiC,qC;AAAqC,0D;AAAA;AAAA;AAAA,O;AAAA,e;AAAA,c;AAAA,woC;AAAA;AAAA;AA/E1C;AACA;AACI;AACI;AAAgE;AAAA,mBAAS,IAAArC,UAAA,EAAT;AAAqB,WAArB;AAC5D;AACJ;AACA;AAAoB;AAAqB;AACzC;AACI;AACI;AAKI;AAAA,mBAAY,IAAAyP,qBAAA,QAAZ;AAAyC,WAAzC;AACJ;AACA;AAEA;AAQI;AAAA,mBAAiB,IAAApwF,QAAA,uCAAjB;AAA4D,WAA5D;AACJ;AACA;AACA;AASI;AAAA,mBAAiB,IAAAA,QAAA,yCAAjB;AAA8D,WAA9D;AACJ;AACJ;AACJ;AACA;AACA;AACA;AACA;AAGJ;AACA;AACI;AACI;AACI;AAAI;AAAG;AACP;AAAG;AAAoB;AACvB;AAAG;AAAoB;AACvB;AAAG;AAAoB;AACvB;AACJ;AACA;AACI;AAAI;AAAG;AACP;AAAG;AAA2B;AAC9B;AAAG;AAA2B;AAC9B;AAAG;AAA2B;AAClC;AACJ;AACJ;AACJ;AACA;AACQ;AAE2B;AAAA,mBAAiB,IAAAwlD,OAAA,EAAjB;AAA0B,WAA1B,EAA2B,iBAA3B,EAA2B;AAAA,mBACP,IAAAm7B,UAAA,EADO;AACK,WADhC;AAE1B;AACT;AACA;;;;AAnEc;AAAA;AAIM;AAAA;AAKoB;AAAA,4CAAmB,UAAnB,EAAmB,IAAnB;AAKpB;AAAA,0CAAiB,YAAjB,EAAiB,cAAjB,EAAiB,SAAjB,EAAiB,mCAAjB,EAAiB,gBAAjB,EAAiB,2BAAjB;AAOoB;AAAA,4CAAmB,UAAnB,EAAmB,IAAnB;AAKpB;AAAA,4EAA+C,YAA/C,EAA+C,yDAA/C,EAA+C,UAA/C,EAA+C,IAA/C,EAA+C,SAA/C,EAA+C,qCAA/C,EAA+C,gBAA/C,EAA+C,2BAA/C;AAST;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAQQ;AAAA;AACA;AAAA;AACA;AAAA;AAKA;AAAA;AACA;AAAA;AACA;AAAA;AAOP;AAAA;;;;;;;;;;2BAUPqC,qC,EAAqC;cAlFjD,OAAA/hC,SAkFiD;eAlFvC;AACPjlD,kBAAQ,EAAE,qCADH;AAEPuxD,kBAAQ,6oIAFD;AA+EPpM,mBAAS,EAAE,CAAC,kDAAD,CA/EJ;AAgFPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AAhF1B,S;AAkFuC,Q;;;;kBAsBzC,OAAA0pB,M;mBAAO,SAAA+S,e;;;;;;;;;gBArBX,OAAAI;;;;;;;;;;;;;;;;;;;;;;;;AChIL;AAAA;AAAA;;AAaA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AASA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAOA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtCQ;AAKI;AAAA;AAAA;AAAA;AAAA;AACJ;;;;;AAJI,2CAAa,WAAb,EAAa,IAAb,EAAa,UAAb,EAAa,IAAb;;;;;;;;AAOJ;AAMI;AAAA;AAAA;AAAA;AAAA;AAGJ;;;;;AAPI;AACA,wDAA0B,QAA1B,EAA0B,aAA1B,EAA0B,SAA1B,EAA0B,iBAA1B,EAA0B,cAA1B,EAA0B,mBAA1B,EAA0B,YAA1B,EAA0B,iBAA1B;;;;;;;;AAgEY;AASI;AAAA;AAAA;AAAA;AAAA,iBAAY;AAAA79C,eAAA;AAAA,YAAZ;AAA6C,SAA7C,EAA8C,MAA9C,EAA8C;AAAA;AAAA;AAAA;AAAA,iBAGtC;AAAAuJ,iBAAA,kBAAAA,KAAA;AAAA;AAAA,YAHsC;AAG+B,SAH7E;AAIA;;;AACA;AAAG;AAAmD;AAC1D;;;;;;;AAZI,mDAA6B,gBAA7B,EAA6B,4BAA7B,EAA6B,YAA7B,EAA6B,gBAA7B,EAA6B,aAA7B,EAA6B,iBAA7B,EAA6B,cAA7B,EAA6B,mBAA7B;AAKA;AAKA;AAAA;AACG;AAAA;;;;;;AAfP;AACA;AAgBA;;;;;;AAdI;AAAA,2CAA0D,cAA1D,EAA0D,+BAA1D;;;;;;;;;;;;;;;;;;;;;;AA6BJ;AAoBA;AAAA;AAAA;AAAA,iBAAY;AAAA;AAAA,YAAZ;AAAsD,SAAtD,EAAuD,iBAAvD,EAAuD;AAAA;AAAA;AAAA,iBACpC;AAAA;AAAA,YADoC;AACM,SAD7D;;;AASA;AACA;AACA;AACA;AACA;AAKA;AACA;AAMA;;;;;;;;;;;;AA3CA;AACA,4NAGE,oBAHF,EAGE,iLAHF,EAGE,kBAHF,EAGE,oBAHF,EAGE,cAHF,EAGE,8CAHF,EAGE,iBAHF,EAGE,mBAHF,EAGE,qBAHF,EAGE,uBAHF,EAGE,cAHF,EAGE,gBAHF;AAqBA;AAKoB;AAAA;AACA;AAAA;AAIhB;AAAA,+EAAgD,gBAAhD,EAAgD,4BAAhD;AAMA;AAAA,+EAAgD,gBAAhD,EAAgD,0BAAhD,EAAgD,MAAhD,EAAgD,qCAAhD;;;;;;;;AAhIpB;AACI;AACI;AACI;AAAI;AAAiB;AACrB;AAAG;AAAoB;AACvB;AAAG;AAA0D;AACjE;AACA;AACI;AACI;AACI;AAAuD;AAAA;AAAA;AAAA;AAAA;AAAvD;AACA;AAAQ;AAAA;AAAA;AAAA;AAAA;AACJ;AACJ;AACA;AAAwD;AAAA;AAAA;AAAA;AAAA;AAAxD;AACJ;AACA;AACI;AAAM;AAAqB;AAC3B;AAOI;AAAA;AAAA;AAAA;AAAA;AAAA;AAEJ;AACJ;AACA;AAE4B;AAAA;AAAA;AAAA;AAAA;AACxB;AACJ;AACJ;AACJ;AACA;AACI;AAII;AAAA;AAAA;AAAA;AAAA,WAA+C,oBAA/C,EAA+C;AAAA;AAAA;AAAA;AAAA,SAA/C;AAQH;AAED;AAyBA;AA2DJ;AACJ;AACJ;;;;;;;;;AAzIyC;AAI1B;AAAA;AACA;AAAA;AAWmB;AAAA;AACR;AAAA;AAEF;AAAA,yDAA2B,WAA3B,EAA2B,IAA3B,EAA2B,YAA3B,EAA2B,iBAA3B,EAA2B,UAA3B,EAA2B,eAA3B,EAA2B,wBAA3B,EAA2B,iBAA3B;AAUsD;AAAA;AAE1D;AAKyC;AAAA;AAE7C;AAAA,4DAA8B,QAA9B,EAA8B,aAA9B,EAA8B,SAA9B,EAA8B,kBAA9B,EAA8B,YAA9B,EAA8B,8CAA9B,EAA8B,eAA9B,EAA8B,oBAA9B,EAA8B,gBAA9B,EAA8B,GAA9B,EAA8B,eAA9B,EAA8B,IAA9B;;;;;;;;AAqGhB;AACI;AACI;AAAkE;AAAA;AAAA;AAAA;AAAA;AAAqB;AAAsC;AAC7H;AAA8D;AAAA;AAAA;AAAA;AAAA;AAC9B;AAAO;AAC3C;AACJ;;;;;AAJ+F;AAAA;AAEnF;AAAA;;;;AD1HpB,QAAMujF,YAAY,GAAG,CAAC,CAAD,EAAI,CAAJ,CAArB;AACA,QAAMxrF,MAAM,GAAG;AACXyrF,UAAI,EAAE;AACFC,iBAAS,EAAE,SADT;AAEFC,eAAO,EAAE;AAFP,OADK;AAKXC,UAAI,EAAE;AACFF,iBAAS,EAAE,SADT;AAEFC,eAAO,EAAE;AAFP,OALK;AASXE,SAAG,EAAE;AACDH,iBAAS,EAAE,SADV;AAEDC,eAAO,EAAE;AAFR;AATM,KAAf;;QAuCahO,gC;;;;;AA2BT,gDAAmB/I,MAAnB,EAAsC;AAAA;;AAAA;;AAClC;AADe,iBAAAA,MAAA,GAAAA,MAAA;AAVnB;;AACgB,iBAAApjB,IAAA,GAAyB,kCAAAkZ,gBAAA,CAAiB4H,KAA1C,CASsB,CAPtC;;AAEiB,iBAAAwZ,cAAA,GAAoC,IAAI,OAAAjyC,YAAJ,EAApC;AACA,iBAAAkyC,YAAA,GAAkC,IAAI,OAAAlyC,YAAJ,EAAlC;AACA,iBAAAmyC,sBAAA,GAA+C,IAAI,OAAAnyC,YAAJ,EAA/C;AACA,iBAAAoyC,mBAAA,GAAyC,IAAI,OAAApyC,YAAJ,EAAzC;AAMV,iBAAArwC,UAAA,GAAa,GAAb;AACA,iBAAA4qC,MAAA,GAAS,KAAT;AACA,iBAAA83C,cAAA,GAAiB,KAAjB;AACA,iBAAA51E,MAAA,GAA8B,EAA9B;AAMA,iBAAA61E,WAAA,GAAuB,KAAvB;AAEA,iBAAAC,kBAAA,GAAqB,IAAI,OAAAp2F,eAAJ,CAA4B,UAAAgO,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAA5B,CAArB;AACA,iBAAAkyF,aAAA,GAAyB,KAAzB;AAGA,iBAAAC,aAAA,GAAwB,EAAxB;AACA,iBAAAC,UAAA,GAA2B,IAAI,OAAAl2E,OAAJ,EAA3B;AACA,iBAAAm2E,WAAA,GAA4B,IAAI,OAAAn2E,OAAJ,EAA5B;AACA,iBAAAo2E,mBAAA,GAA+B,KAA/B,CAtB+B,CAsBO;;AACtC,iBAAAxkF,KAAA,GAA2B;AAC9BxN,eAAK,EAAE,IAAIN,IAAJ,EADuB;AAE9BstB,aAAG,EAAE,IAAIttB,IAAJ,EAFyB;AAG9B+sB,eAAK,EAAE,EAHuB;AAI9BysC,eAAK,EAAE3zD,MAAM,CAAC4rF,IAJgB;AAK9Bc,kBAAQ,EAAE,UALoB;AAM9BxhF,iBAAO,EAAE,IANqB;AAO9ByhF,mBAAS,EAAE;AACPC,uBAAW,EAAE,KADN;AAEPC,oBAAQ,EAAE;AAFH,WAPmB;AAW9BC,mBAAS,EAAE;AAXmB,SAA3B;AA0BA,iBAAAC,UAAA,GAAkB,EAAlB;AACA,iBAAAC,WAAA,GAAuB,KAAvB,CAlD+B,CAoDtC;;AACO,iBAAAC,SAAA,GAAY;AACfxyF,eAAK,EAAE,CADQ;AAEfgtB,aAAG,EAAE;AAFU,SAAZ,CArD+B,CA0DtC;;AACO,iBAAAk1B,UAAA,GAAa,UAAA34C,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB6R,aAApB,CAAkC;AAAEg6C,eAAK,EAAE;AAAT,SAAlC,CAAb;AAEA,iBAAAknC,WAAA,GAAc,IAAI,QAAAh4D,WAAJ,CAAgB,IAAI/6B,IAAJ,GAAWiD,OAAX,EAAhB,CAAd;AA7D+B;AAErC;;;;oCA6DkB1B,C,EAAuB;AACtC,cAAMnB,IAAI,GAAG,IAAI,UAAAkR,MAAJ,CAAW;AAAElR,gBAAI,EAAEmB,CAAC,CAACnB,IAAF,CAAO6C,OAAP;AAAR,WAAX,CAAb,CADsC,CACe;;AACrD,iBAAO,KAAKutF,aAAL,CAAmB7yD,UAAnB,CAA8Bv9B,IAA9B,EAAoC,KAApC,CAAP;AACH;;;mCAUc;AAAA;;iBAAA,CACX;;;AACA,eAAK65C,MAAL,GAAc,OAAA7qC,oBAAA,CAAqB,KAAKC,UAA1B,CAAd;AACA,eAAKmhF,aAAL,GAAqB,KAAKzvF,MAAL,CAAYy7B,KAAZ,EAArB;AACA,cAAMp8B,IAAI,GAAG,KAAKW,MAAL,CAAYy7B,KAAZ,EAAb;AACA,cAAMw2D,uBAAuB,GAAG,KAAKnC,cAAL,GAC1B,KAAKA,cAAL,CAAoB7lF,WAApB,CAAgC/J,QAAhC,CAAyC;AAAE6Q,mBAAO,EAAE;AAAX,WAAzC,CAD0B,GAE1B1R,IAFN;AAGA,eAAKwgF,0BAAL,GAAkCxgF,IAAI,CAAC0J,YAAL,CAAkB,MAAlB,EAA0BA,YAA1B,CAAuC,KAAvC,CAAlC,CARW,CAUX;;AACA,eAAKmpF,cAAL,GAAsB,KAAKrS,0BAAL,CAAgCpkD,KAAhC,EAAtB;AAEA,eAAK02D,cAAL;AACA,eAAKp5C,eAAL,GAAuB,KAAK34C,QAA5B;AACA,eAAKgyF,UAAL,GAAkB,IAAI,UAAA7hF,MAAJ,CAAW;AACzBlR,gBAAI,EAAE,QAAA2C,QAAA,CAASqwF,OAAT,CAAiB,KAAK5C,aAAL,CAAmB9uF,UAAnB,CAA8B,YAA9B,CAAjB;AADmB,WAAX,EAEfV,QAFe,CAEN;AAAE0B,gBAAI,EAAE,EAAR;AAAYjC,kBAAM,EAAE;AAApB,WAFM,CAAlB;AAGA,eAAK4yF,gBAAL,CAAsB,KAAK7C,aAA3B;AACA,eAAKwB,WAAL,GACIX,YAAY,CAACn3E,QAAb,CAAsB84E,uBAAuB,CAACz/D,WAA9C,KACA89D,YAAY,CAACn3E,QAAb,CAAsB9Z,IAAI,CAACmzB,WAA3B,CAFJ;AAGA,eAAK+/D,cAAL;AACA,eAAKC,iBAAL;AACA,iBAAA1V,SAAA,CAAUl4E,MAAV,EAAkB,QAAlB,EACKuL,IADL,CACU,YAAA4sE,YAAA,CAAa,GAAb,CADV,EAEK5sE,IAFL,CAGQ,YAAA6sE,GAAA,CAAI;AACAxvE,gBAAI,EAAE,cAACy/D,GAAD,EAAS;AACX,kBAAMz7D,MAAM,GAAGy7D,GAAG,CAACz7D,MAAnB;AACA,sBAAI,CAAC0nC,MAAL,GAAc1nC,MAAM,CAACjD,UAAP,GAAoB,QAAI,CAACD,UAAvC;AACA,sBAAI,CAACmkF,QAAL,GAAgB,QAAI,CAACnB,WAAL,CAAiB9jF,IAAjB,EAAhB,GAA0C,QAAI,CAAC6jF,UAAL,CAAgB7jF,IAAhB,EAA1C;AACH;AALD,WAAJ,CAHR,EAWKlQ,SAXL;AAaA,eAAKslB,KAAL,GAAa,cAAAC,aAAA,CAAc;AACvBha,gBAAI,EAAE,KAAK7I,MAAL,CAAYgJ,EADK;AAEvB5I,oBAAQ,EAAE,KAAKA,QAFQ;AAGvB6X,gBAAI,EAAE,KAAK0J,WAHY;AAIvBiB,iBAAK,EAAE,CAAF,KAAE,KAAKF,QAAL,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEI,aAJC;AAKvBP,iBAAK,EAAE,KAAKA;AALW,WAAd,CAAb,CArCW,CA6CX;;AACA,iBAAAu6D,SAAA,CAAUl4E,MAAV,EAAkB,QAAlB,EACKuL,IADL,CACU,YAAA4sE,YAAA,CAAa,GAAb,CADV,EAEK5sE,IAFL,CAGQ,YAAA6sE,GAAA,CAAI;AACAxvE,gBAAI,EAAE,cAACy/D,GAAD,EAAS;AACX,sBAAI,CAAC/zB,MAAL,GAAc,OAAA7qC,oBAAA,CAAqB,QAAI,CAACC,UAA1B,CAAd;;AACA,sBAAI,CAAC6jF,cAAL;;AACA,sBAAI,CAACO,eAAL;AACH;AALD,WAAJ,CAHR,EAWKp1F,SAXL;AAYA,eAAK00F,WAAL,CAAiB/xF,QAAjB,CAA0B,KAAKD,MAA/B;AACA,eAAKwyF,iBAAL;AACH;;;oCAEkBz1F,O,EAAsB;AACrC,cAAIA,OAAO,CAAC01F,QAAZ,EAAsB;AAClB;AACA,iBAAK1lF,KAAL,CAAW6kF,SAAX,GAAuB,KAAKa,QAA5B;AACA,iBAAK1lF,KAAL,CAAW0kF,SAAX,GAAuB;AACnBC,yBAAW,EAAE,KAAKe,QADC;AAEnBd,sBAAQ,EAAE,KAAKc;AAFI,aAAvB;AAIA,gBAAMpzF,IAAI,GAAG,KAAKW,MAAlB;AACA,iBAAKsyF,gBAAL,CAAsBjzF,IAAtB;AACH;;AAED,cAAI,KAAKszF,YAAT,EAAuB,KAAK1uC,QAAL;AAEvB,cAAI,CAAC,KAAKwrC,aAAV,EAAyB;;AAEzB,cAAI1yF,OAAO,CAACqS,QAAR,IAAoBrS,OAAO,CAAC01F,QAAhC,EAA0C;AACtC,iBAAKD,iBAAL;AACH;;AACD,cAAIz1F,OAAO,CAAC8iF,0BAAZ,EAAwC;AACpC,iBAAK6S,eAAL;AACH;;AACD,cAAI31F,OAAO,CAAC01F,QAAZ,EAAsB;AAClB,iBAAKA,QAAL,GAAgB,KAAKnB,WAAL,CAAiB9jF,IAAjB,EAAhB,GAA0C,KAAK6jF,UAAL,CAAgB7jF,IAAhB,EAA1C;AACH;AACJ;;;0CAEwB;AACrB,cAAMolF,SAAS,GAAG,UAAA90C,cAAA,CAAe,KAAK+hC,0BAAL,CAAgCl5D,WAA/C,EAA4DjgB,KAA9E;AACA,cAAMmsF,eAAe,GAAG,KAAKhT,0BAAL,CAAgC/uE,aAAhC,CAA8C;AAACpK,iBAAK,EAAEksF;AAAR,WAA9C,EAAkEn3D,KAAlE,EAAxB,CAFqB,CAE8E;;AACnG,eAAKy2D,cAAL,GAAsB,KAAKA,cAAL,IAAuB,KAAKrS,0BAAL,CAAgCpkD,KAAhC,EAA7C;AACA,cAAIq3D,cAAc,GAAG,KAAKZ,cAAL,CAAoBnpF,YAApB,CAAiC,MAAjC,CAArB,CAJqB,CAI0C;;AAC/D,cAAI,CAAC,KAAKkoF,WAAV,EAAuB;AACnB;AACA6B,0BAAc,GAAGA,cAAc,CAAC5yF,QAAf,CAAwB;AAAEwwB,kBAAI,EAAE;AAAR,aAAxB,CAAjB;AACH;;AAED,cAAI,KAAKwoB,MAAT,EAAiB;AACb,iBAAKg5C,cAAL,GAAsBW,eAAtB;AACA,iBAAKE,iBAAL,aAA4B,KAAKb,cAAL,CAAoBvxF,UAApB,CAA+B,QAA/B,CAA5B;AACA,iBAAKuwF,kBAAL,CAAwB1jF,IAAxB,CAA6B,KAAK0kF,cAAlC;AACH,WAJD,MAIO;AACH,iBAAKA,cAAL,GAAsBW,eAAe,CAAC3yF,QAAhB,CAAyB;AAAEwwB,kBAAI,EAAE,KAAKugE,WAAL,GAAmB,CAAnB,GAAuB;AAA/B,aAAzB,CAAtB,CADG,CACiF;;AACpF,iBAAK8B,iBAAL,aAA4BD,cAAc,CAACnyF,UAAf,CAA0B,QAA1B,CAA5B,gBAAqEmyF,cAAc,CAC9E5yF,QADgE,CACvD;AAAEwwB,kBAAI,EAAE,KAAKugE,WAAL,GAAmB,CAAnB,GAAuB;AAA/B,aADuD,EAEhEtwF,UAFgE,CAErD,aAFqD,CAArE;AAGA,iBAAKuwF,kBAAL,CAAwB1jF,IAAxB,CAA6BslF,cAA7B;AACH;AACJ;;;mCAEiB9+E,O,EAA6C;AAAA,cAA3B8V,QAA2B,uEAAP,KAAO;AAC3D,cAAMrZ,KAAK,GAAGuD,OAAO,CAACuO,KAAR,CAAc9R,KAAd,IAAuB,KAAK8R,KAAL,CAAW9R,KAAhD;AACA,cAAMsJ,KAAK,GAAG/F,OAAO,CAAC+F,KAAR,CAActJ,KAAd,IAAuBuD,OAAO,CAAC+F,KAAR,CAActJ,KAAd,IAAuB,EAA9C,GAAmD,CAAjE;AACA,cAAMwc,SAAS,GAAGjZ,OAAO,CAACiZ,SAAR,CAAkBxc,KAAlB,IAA2BuD,OAAO,CAACiZ,SAAR,CAAkBxc,KAAlB,IAA2B,EAAtD,GAA2D,CAA7E;AAEA,iBAAO;AACHyzC,eAAG,EAAE;AACDA,iBAAG,aAAMnqC,KAAK,GAAG,CAAd,OADF;AAED9f,oBAAM,YAAK8f,KAAL,OAFL;AAGDi5E,6BAAe,EAAElpE,QAAQ,GAAGhlB,MAAM,CAAC4rF,IAAP,CAAYF,SAAf,GAA2B1rF,MAAM,CAACyrF,IAAP,CAAYC;AAH/D,aADF;AAMHjmB,kBAAM,EAAE;AACJA,oBAAM,aAAMt9C,SAAS,GAAG,CAAlB,OADF;AAEJhzB,oBAAM,YAAKgzB,SAAL,OAFF;AAGJ+lE,6BAAe,EAAElpE,QAAQ,GAAGhlB,MAAM,CAAC4rF,IAAP,CAAYF,SAAf,GAA2B1rF,MAAM,CAACyrF,IAAP,CAAYC;AAH5D;AANL,WAAP;AAYH;;;yCAEuB;AACpB,eAAKkC,eAAL;AACA,cAAM1C,YAAY,GAAG,KAAKP,aAAL,CAAmBh0D,KAAnB,EAArB;AACA,cAAM2pC,UAAU,GAAG4qB,YAAY,CAAC/vF,QAAb,CAAsB;AAAER,kBAAM,EAAE,CAAV;AAAaD,uBAAW,EAAE;AAA1B,WAAtB,CAAnB;AACA,eAAKuN,KAAL,CAAWxN,KAAX,GAAmB6lE,UAAU,CAACvoC,MAA9B;AACA,eAAK9vB,KAAL,CAAWwf,GAAX,GAAiB64C,UAAU,CAACllE,QAAX,CAAoB;AAAEJ,mBAAO,EAAE,KAAKi5C;AAAhB,WAApB,EAAuDlc,MAAxE;AACA,cAAMo2D,SAAS,GAAGzwF,QAAQ,CAACwtF,YAAY,CAACrvF,UAAb,CAAwB,GAAxB,CAAD,EAA+B,EAA/B,CAA1B;;AAEA,cAAIsyF,SAAS,KAAK,CAAlB,EAAqB;AACjB,iBAAKN,YAAL,GAAoBM,SAApB;AACH,WAFD,MAEO,IAAIA,SAAS,GAAG,CAAhB,EAAmB;AACtB,gBAAMlwF,MAAM,GAAGkwF,SAAS,GAAG,CAAZ,GAAgBA,SAAS,GAAG,CAA5B,GAAgCA,SAA/C;AACA,iBAAKN,YAAL,GAAoBM,SAAS,GAAGlwF,MAAhC;AACH,WAHM,MAGA;AACH;AACA;AACA,gBAAMA,OAAM,GAAGpD,IAAI,CAACq9B,GAAL,CAAS,EAAT,EAAai2D,SAAS,GAAG,CAAzB,CAAf;;AACA,iBAAKN,YAAL,GAAoB5vF,OAApB;AACH;;AAED,cAAI,CAAC,KAAK+uF,WAAN,IAAqB,KAAKa,YAA9B,EAA4C;AACxC,iBAAK1uC,QAAL;AACH;;AAED,eAAKivC,UAAL,GAAkBvzF,IAAI,CAACmD,GAAL,CAAS,EAAT,EAAa,KAAK6vF,YAAL,GAAoB,CAAjC,CAAlB;AACA,eAAK5lF,KAAL,CAAWif,KAAX,aAAsBgkE,YAAY,CAC7BrvF,UADiB,CACN,OADM,EAEjBmJ,iBAFiB,EAAtB,eAE6B,OAAA3J,iBAAA,CAAkB,KAAK44C,eAAvB,EAAwC,IAAxC,CAF7B;AAGA,eAAKhsC,KAAL,CAAWykF,QAAX,sBAAkC,KAAKP,WAAL,GAAmB,cAAnB,GAAoC,EAAtE,cACI,KAAK/3C,MAAL,IAAe,KAAKu5C,QAApB,GAA+B,QAA/B,GAA0C,EAD9C;;AAIA,cAAI,KAAK3C,cAAT,EAAyB;AACrB,iBAAK/iF,KAAL,CAAWomF,MAAX,GAAoB,KAAKC,UAAL,CAAgB,KAAKtD,cAArB,CAApB;AACA,iBAAK/iF,KAAL,CAAWiH,OAAX,GAAqB,KAAK87E,cAA1B;AACH;;AACD,eAAK2C,QAAL,GAAgB,KAAKnB,WAAL,CAAiB9jF,IAAjB,EAAhB,GAA0C,KAAK6jF,UAAL,CAAgB7jF,IAAhB,EAA1C;AACH;;;4CAE0B;AAAA;;AACvB,eAAK6lF,YAAL;AACA,cAAMj4E,MAAM,GAAG,EAAf;;AACA,cAAIhP,KAAK,CAACsB,OAAN,CAAc,KAAK0B,QAAnB,CAAJ,EAAkC;AAC9B,iBAAKA,QAAL,CAAc3R,OAAd,CAAsB,UAAC61F,WAAD,EAAiB;AACnC,kBAAMt/E,OAAO,GAAG,IAAI,cAAA+P,OAAJ,CAAYuvE,WAAZ,CAAhB;;AADmC,0CAER,QAAI,CAACC,YAAL,CACvBv/E,OAAO,CAAC/J,WAAR,CAAoBjB,EADG,EAEvBgL,OAAO,CAAC9J,SAAR,CAAkBlB,EAFK,CAFQ;AAAA,kBAE3BstD,IAF2B,yBAE3BA,IAF2B;AAAA,kBAErBl2D,QAFqB,yBAErBA,QAFqB,EAOnC;;;AACA,kBAAImsB,GAAG,GAAGvY,OAAO,CAAC9J,SAAlB;AACA,kBAAM0gF,OAAO,GAAG52E,OAAO,CAAC9J,SAAxB;;AACA,kBAAI0gF,OAAO,CAAC9qF,OAAR,KAAoB,CAApB,IAAyB8qF,OAAO,CAAC75E,OAAR,KAAoB,CAAjD,EAAoD;AAChD;AACAwb,mBAAG,GAAGvY,OAAO,CAAC9J,SAAR,CAAkB4G,aAAlB,CAAgC;AAAEC,yBAAO,EAAE;AAAX,iBAAhC,CAAN;AACH,eAbkC,CAenC;;;AACA,kBAAIiD,OAAO,CAAC1C,EAAR,KAAe,QAAI,CAACi2E,SAAxB,EAAmC;AAEnC,kBAAMiM,QAAQ,GAAGx/E,OAAO,CAAC/J,WAAzB,CAlBmC,CAkBG;;AACtC,kBAAMwpF,MAAM,GAAGlnE,GAAf,CAnBmC,CAmBf;AACpB;;AACA,kBAAMmnE,iBAAiB,GAAG,cAAAC,cAAA,CAAeH,QAAQ,CAACxqF,EAAxB,EAA4BgL,OAAO,CAAC/P,QAApC,CAA1B,CArBmC,CAqBsC;;AACzE,kBAAM2vF,eAAe,GAAG,cAAAD,cAAA,CAAeF,MAAM,CAACzqF,EAAtB,EAA0BgL,OAAO,CAAC/P,QAAlC,CAAxB,CAtBmC,CAsBkC;;AAErEmX,oBAAM,CAAClU,IAAP,CAAY;AACR3H,qBAAK,EAAEm0F,iBADC;AAERnnE,mBAAG,EAAEqnE,eAFG;AAGR5nE,qBAAK,sBAAehY,OAAO,CAACogB,MAAR,CAAe,MAAf,CAAf,CAHG;AAIRqkC,qBAAK,EAAE3zD,MAAM,CAACyrF,IAJN;AAKRvgF,uBAAO,EAAE,IALD;AAMRwhF,wBAAQ,mBAAY,QAAI,CAACt4C,MAAL,IAAe,QAA3B,cACJ,QAAI,CAAC+3C,WAAL,GAAmB,cAAnB,GAAoC,EADhC,cAEJ36B,IAFI,CANA;AASR68B,sBAAM,EAAE,QAAI,CAACC,UAAL,CAAgBp/E,OAAhB,CATA;AAURy9E,yBAAS,EAAE;AACPC,6BAAW,EAAE,KADN;AAEPC,0BAAQ,EAAE;AAFH,iBAVH;AAcRC,yBAAS,EAAE,KAdH;AAeR59E,uBAAO,EAAPA;AAfQ,eAAZ;AAiBH,aAzCD;AA0CH;;AA9CsB,mCAgDI,KAAKu/E,YAAL,CACvB,KAAKxmF,KAAL,CAAWxN,KAAX,CAAiBw3B,OAAjB,EADuB,EAEvB,KAAKhqB,KAAL,CAAWwf,GAAX,CAAewK,OAAf,EAFuB,CAhDJ;AAAA,cAgDfu/B,IAhDe,sBAgDfA,IAhDe;AAAA,cAgDTl2D,QAhDS,sBAgDTA,QAhDS;;AAoDvB,cAAM2M,KAAK,GAAGV,MAAM,CAACwnF,MAAP,CAAc,EAAd,EAAkB,KAAK9mF,KAAvB,CAAd;AACA,cAAM69E,OAAO,GAAG,IAAI,UAAAr6E,MAAJ,CAAW;AAAElR,gBAAI,EAAE,KAAK0N,KAAL,CAAWxN,KAAX,CAAiB2C,OAAjB;AAAR,WAAX,EAAiDhC,QAAjD,CAA0D;AACtEJ,mBAAO,EAAE,KAAKi5C;AADwD,WAA1D,CAAhB,CArDuB,CAuDnB;;AACJ,cAAI6xC,OAAO,CAAC9qF,OAAR,KAAoB,CAApB,IAAyB8qF,OAAO,CAACnrF,MAAR,KAAmB,CAAhD,EAAmD;AAC/C;AACAsN,iBAAK,CAACwf,GAAN,GAAYq+D,OAAO,CAAC95E,aAAR,CAAsB;AAAEgjF,0BAAY,EAAE;AAAhB,aAAtB,EAA2Cj3D,MAAvD,CAF+C,CAEgB;AAClE,WA3DsB,CA6DvB;AACA;;;AACA9vB,eAAK,CAACxN,KAAN,GAAc,cAAAo0F,cAAA,CAAe5mF,KAAK,CAACxN,KAArB,EAA4B,KAAK0E,QAAjC,CAAd,CA/DuB,CA+DmC;;AAC1D8I,eAAK,CAACwf,GAAN,GAAY,cAAAonE,cAAA,CAAe5mF,KAAK,CAACwf,GAArB,EAA0B,KAAKtoB,QAA/B,CAAZ,CAhEuB,CAgE+B;;AAEtD8I,eAAK,CAACykF,QAAN,sBAA6B,KAAKt4C,MAAL,IAAe,KAAKu5C,QAApB,GAA+B,QAA/B,GAA0C,EAAvE,eAA8En8B,IAA9E;;AACA,cAAI,KAAKw5B,cAAT,EAAyB;AACrB/iF,iBAAK,CAAComF,MAAN,GAAe,KAAKC,UAAL,CAAgB,KAAKtD,cAArB,EAAqC,IAArC,CAAf;AACA/iF,iBAAK,CAACiH,OAAN,GAAgB,KAAK87E,cAArB;AACH;;AAED10E,gBAAM,CAAClU,IAAP,CAAY6F,KAAZ;AACA,eAAKqO,MAAL,GAAcA,MAAM,CAACjW,KAAP,EAAd;AACA,eAAK4uF,eAAL;AACH;;;0CAEwB;AACrB,cAAM/D,YAAY,GAAG,KAAKP,aAAL,CAAmBh0D,KAAnB,EAArB;AACA,cAAMl8B,KAAK,GAAGywF,YAAY,CAAC/vF,QAAb,CAAsB;AAAER,kBAAM,EAAE,CAAV;AAAaD,uBAAW,EAAE;AAA1B,WAAtB,CAAd;AACA,cAAM+sB,GAAG,GAAGhtB,KAAK,CAACW,QAAN,CAAe;AAAEJ,mBAAO,EAAE,KAAKi5C;AAAhB,WAAf,CAAZ;AACA,cAAMi7C,MAAM,GAAG,KAAK54E,MAAL,CAAYnV,MAAZ,CAAmB,UAACyD,CAAD;AAAA,mBAAO,CAACA,CAAC,CAACkoF,SAAV;AAAA,WAAnB,CAAf,CAJqB,CAImC;;AACxD,cAAMqC,QAAQ,GAAG,KAAKC,WAAL,CAAiB30F,KAAjB,EAAwBgtB,GAAxB,EAA6BynE,MAA7B,CAAjB;AACA,cAAMG,QAAQ,GAAG,KAAK/4E,MAAL,CAAYnV,MAAZ,CAAmB,UAACyD,CAAD;AAAA,mBAAOA,CAAC,CAACkoF,SAAT;AAAA,WAAnB,CAAjB;;AACA,cAAGuC,QAAQ,CAAC5yF,MAAZ,EAAqB;AACjB4yF,oBAAQ,CAAC,CAAD,CAAR,CAAY17B,KAAZ,GAAoBw7B,QAAQ,GAAGnvF,MAAM,CAAC6rF,GAAV,GAAgB7rF,MAAM,CAAC4rF,IAAnD;AACA,iBAAKa,mBAAL,GAA2B0C,QAAQ,GAAG,IAAH,GAAU,KAA7C;AAEH;;AACD,WAAC,KAAKxB,QAAN,IAAkB,KAAK1B,mBAAL,CAAyBhxC,IAAzB,CAA8B;AAAC/tB,gBAAI,EAAE,KAAKzP,KAAZ;AAAmB2xE,uBAAW,EAAED;AAAhC,WAA9B,CAAlB;AACH;;;qCACmB10F,K,EAAegtB,G,EAAa;AAC5C,cAAMnsB,QAAQ,GAAGmsB,GAAG,GAAGhtB,KAAvB;AACA,iBAAO;AACHa,oBAAQ,EAARA,QADG;AAEHk2D,gBAAI,EAAEl2D,QAAQ,GAAG,KAAKg0F,wBAAhB,GAA2C,UAA3C,GAAwD;AAF3D,WAAP;AAIH;;;yCAEuBp0F,M,EAAgB;AACpC,cAAIq0F,MAAM,GAAG,UAAAvrF,OAAA,GAAUC,YAAV,CAAuB,QAAvB,CAAb;;AACA,cAAI/I,MAAJ,EAAY;AACRq0F,kBAAM,GAAGr0F,MAAM,CAAC+I,YAAP,CAAoB,QAApB,CAAT;AACH;;AACD,cAAI,CAAC,KAAKmwC,MAAN,IAAgBm7C,MAAM,CAAC7hE,WAAP,KAAuB,CAA3C,EAA8C;AAC1C6hE,kBAAM,GAAGA,MAAM,CAACtrF,YAAP,CAAoB,MAApB,CAAT;AACH;;AACD,eAAK+nF,sBAAL,CAA4B/wC,IAA5B,CAAiCs0C,MAAjC;AACA,eAAK/C,WAAL,CAAiB9jF,IAAjB;AACA,eAAKqyE,0BAAL,GAAkCwU,MAAlC;AACA,eAAK3B,eAAL;AACH;AAED;;;;;;;;;yDAMwC4B,U,EAAoB;AACxD,iBAAO,UAAAh3C,sCAAA,CAAuCg3C,UAAU,CAACtrF,EAAlD,EAAsD,KAAK/E,QAA3D,EAAqE+E,EAA5E;AACH;;;oCAEkBomB,O,EAASC,K,EAAO2kE,M,EAAQ;AAAA;;yBAAA,CACvC;;;AACA,cAAMO,kBAAkB,GAAGnlE,OAAO,CAACpmB,EAAnC;AACA,cAAMwrF,gBAAgB,GAAGnlE,KAAK,CAACrmB,EAA/B;AACA,cAAIyH,KAAK,GAAG,YAAK8R,KAAL,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAE9R,KAAZ,MAAiB,YAAI,KAAKq/E,cAAT,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAE99D,IAAzB,MAA6B,IAA7B,IAA6B,aAA7B,GAA6B,MAA7B,GAA6B,GAAEvhB,KAAhD,CAAZ;AACA,iBAAOujF,MAAM,CAACnyE,IAAP,CAAY,UAACpa,CAAD,EAAO;;;AACtBgJ,iBAAK,GAAGA,KAAK,iBAAIhJ,CAAC,CAACuM,OAAN,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEge,IAAf,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAEvhB,KAArB,CAAb,CADsB,CAEtB;;AACA,gBAAMsJ,KAAK,GAAG,OAAAtS,CAAC,CAACuM,OAAF,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE+F,KAAF,CAAQtJ,KAAR,CAAT,KAA2B,CAAzC,CAHsB,CAItB;;AACA,gBAAMgkF,gBAAgB,GAAG,IAAI,UAAAlkF,MAAJ,CAAW;AAAElR,kBAAI,EAAEoI,CAAC,CAAClI,KAAF,CAAQ2C,OAAR;AAAR,aAAX,CAAzB,CALsB,CAK4C;;AAClE,gBAAMwyF,cAAc,GAAG,IAAI,UAAAnkF,MAAJ,CAAW;AAAElR,kBAAI,EAAEoI,CAAC,CAAC8kB,GAAF,CAAMrqB,OAAN;AAAR,aAAX,CAAvB,CANsB,CAMwC;;AAC9D,gBAAMyyF,MAAM,GAAGF,gBAAgB,CAAC3jF,aAAjB,CAA+B;AAAEC,qBAAO,EAAEgJ;AAAX,aAA/B,EAAmD/Q,EAAlE;AACA,gBAAMikB,SAAS,GAAG,OAAAxlB,CAAC,CAACuM,OAAF,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEiZ,SAAF,CAAYxc,KAAZ,CAAT,KAA+B,CAAjD;AACA,gBAAMmkF,IAAI,GAAGF,cAAc,CAACx0F,QAAf,CAAwB;AAAE6Q,qBAAO,EAAEkc;AAAX,aAAxB,EAAgDjkB,EAA7D;;AAEA,gBACKurF,kBAAkB,IAAII,MAAtB,IAAgCJ,kBAAkB,GAAGK,IAAtD,IAA+D;AAC9DL,8BAAkB,IAAII,MAAtB,IAAgCH,gBAAgB,GAAGG,MADpD,IAC+D;AAC9DJ,8BAAkB,IAAII,MAAtB,IAAgCH,gBAAgB,IAAII,IAFrD,IAE8D;AAC7DL,8BAAkB,IAAII,MAAtB,IAAgCH,gBAAgB,IAAII,IAJzD,CAI+D;AAJ/D,cAKE;AACE,uBAAO,OAAAntF,CAAC,CAACuM,OAAF,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE1C,EAAX,OAAa,MAAK,QAAI,CAACw+E,cAAV,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,GAAEx+E,EAAvC,CAAP;AACH;;AACD,mBAAO,KAAP;AACH,WApBM,CAAP;AAqBH;;;kDAEmF;AAAA,cAAzDvE,KAAyD,UAAzDA,KAAyD;AAAA,cAAlD8nF,QAAkD,UAAlDA,QAAkD;AAAA,cAAxCC,MAAwC,UAAxCA,MAAwC;;;;AAChF,cAAMlgF,CAAC,GAAG,UAAAwoC,sCAAA,CACNy3C,QAAQ,CAAC3yF,OAAT,EADM,EAEN,KAAK+B,QAFC,CAAV;AAIA,cAAI2Q,CAAC,CAAC5L,EAAF,GAAO/J,IAAI,CAAConB,GAAL,EAAX,EAAuB,OALyD,CAMhF;AACA;;AACA,eAAKjL,MAAL,GAAc,KAAKA,MAAL,CAAYlW,GAAZ,CAAgB,UAAC6vF,MAAD,EAAY;AACtC,gBAAIhoF,KAAK,CAACuE,EAAN,IAAYyjF,MAAM,CAACzjF,EAAP,KAAcvE,KAAK,CAACuE,EAApC,EAAwC;AACpC,qBAAO,MAAP,OAAO,CAAP,kBACOvE,KADP,CAAO,EACK;AACRxN,qBAAK,EAAEs1F,QADC;AAERtoE,mBAAG,EAAEuoE;AAFG,eADL,CAAP;AAKH;;AACD,mBAAOC,MAAP;AACH,WATa,CAAd,CARgF,CAiB5E;;AAEJ,cAAIC,mBAAmB,GAAG,IAAI,UAAAzkF,MAAJ,CACtB;AAAElR,gBAAI,EAAEw1F,QAAQ,CAAC3yF,OAAT;AAAR,WADsB,CAA1B;AAGA,cAAI+yF,iBAAiB,GAAG,IAAI,UAAA1kF,MAAJ,CACpB;AAAElR,gBAAI,EAAEM,IAAI,CAACC,IAAL,CAAUk1F,MAAM,CAAC5yF,OAAP,KAAiB,MAA3B,IAAmC;AAA3C,WADoB,CACgC;AADhC,WAAxB,CAtBgF,CA0BhF;;AACA8yF,6BAAmB,CAAC/0F,QAApB,CAA6B;AAAET,uBAAW,EAAE,CAAf;AAAkBC,kBAAM,EAAE;AAA1B,WAA7B;;AAEA,cAAIu1F,mBAAmB,GAAG,UAAAlsF,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAA1B,EAA+C;AAC3C;AACA;AACA,iBAAKuzF,iBAAL;AACA;AACH;;AAED,cAAIz5C,eAAe,GAAGp5C,IAAI,CAACY,KAAL,CAClB,CAAC00F,iBAAiB,CAACjsF,EAAlB,GAAuBgsF,mBAAmB,CAAChsF,EAA5C,IAAkD,EAAlD,GAAuD,IADrC,CAAtB,CApCgF,CAuChF;AACA;;AACA,cAAMksF,SAAS,GAAGF,mBAAmB,CAACv5D,KAApB,EAAlB,CAzCgF,CAyCjC;;AAC/C,cAAIsd,eAAe,IAAI,EAAvB,EAA2B;AACvB;AACA,gBAAMv4C,CAAC,GAAGu4C,eAAe,GAAG,EAA5B,CAFuB,CAGvB;AACI;AACA;AACJ;AACA;;AACA,gBAAMt4C,CAAC,GAAG+B,QAAQ,CAAC0yF,SAAS,CAACv0F,UAAV,CAAqB,GAArB,CAAD,EAA4B,EAA5B,CAAlB;AACA,gBAAMw0F,EAAE,GAAG10F,CAAC,GAAG,EAAf,CATuB,CAUvB;AACI;AACA;AACJ;AACA;AACA;AACH,WAhBD,MAgBO;AACH;AACA,gBAAMD,GAAC,GAAGu4C,eAAe,GAAG,EAA5B;;AACA,gBAAIv4C,GAAJ,EAAO,CACH;AACA;AACH;;AACD,iBAAK4wF,aAAL,GAAqB,EAArB;AACH,WAlE+E,CAoEhF;;;AACA,cAAMgE,YAAY,GAAGH,iBAAiB,CAACjsF,EAAlB,GAAuBgsF,mBAAmB,CAAChsF,EAAhE;;AACA,cAAIosF,YAAY,IAAI,KAAKC,iBAAL,GAAyB,CAA7C,EAAgD;AAC5C;AACAJ,6BAAiB,GAAGA,iBAAiB,CAAC/0F,QAAlB,CAA2B;AAAE4zF,0BAAY,EAAE;AAAhB,aAA3B,CAApB;AACH;;AAED,cAAI,CAAJ,KAAI,KAAKlxE,KAAL,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAEmd,UAAhB,EAA4B;AACxB,gBAAIq1D,YAAY,GAAG,KAAf,IAAoB,MAAG,KAAKxyE,KAAR,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEmd,UAAnC,CAAJ,EAAmD;AAC/C;AACA,mBAAKyyD,iBAAL;AACA;AACH;AACJ,WAjF+E,CAmFhF;;;AACA,cAAI8C,sBAAsB,GAAGN,mBAAmB,CAACv5D,KAApB,EAA7B;AACA,cAAI85D,oBAAoB,GAAGN,iBAAiB,CAACx5D,KAAlB,EAA3B,CArFgF,CAsFhF;;AACA,cAAI,KAAKq0D,cAAT,EAAyB;AACrB,gBAAM/1E,KAAK,GAAG,KAAK+1E,cAAL,CAAoB/1E,KAApB,CAA0B,KAAK+1E,cAAL,CAAoBvtE,KAApB,CAA0B9R,KAApD,KAA8D,CAA5E;;AACA,gBAAIsJ,KAAJ,EAAW;AACP,kBAAMxa,MAAK,GAAGy1F,mBAAmB,CAACv5D,KAApB,EAAd;;AACA65D,oCAAsB,GAAG/1F,MAAK,CAACuR,aAAN,CAAoB;AAAEC,uBAAO,EAAEgJ;AAAX,eAApB,CAAzB;AACH;;AACD,gBAAMkT,SAAS,GAAG,KAAK6iE,cAAL,CAAoB7iE,SAApB,CAA8B,KAAK6iE,cAAL,CAAoBvtE,KAApB,CAA0B9R,KAAxD,KAAkE,CAApF;;AACA,gBAAIwc,SAAJ,EAAe;AACX,kBAAMV,IAAG,GAAG0oE,iBAAiB,CAACnkF,aAAlB,CAAgC;AAAEC,uBAAO,EAAE;AAAX,eAAhC,CAAZ;;AACAwkF,kCAAoB,GAAGhpE,IAAG,CAACrsB,QAAJ,CAAa;AAAEJ,uBAAO,EAAEmtB;AAAX,eAAb,CAAvB;AACH;AACJ,WAlG+E,CAoGhF;;;AACA,cAAM1tB,KAAK,GAAG+1F,sBAAd;AACA,cAAM/oE,GAAG,GAAGgpE,oBAAZ;AACA,cAAMvB,MAAM,GAAG,KAAK54E,MAAL,CAAYnV,MAAZ,CAAmB,UAACyD,CAAD;AAAA,mBAAOA,CAAC,CAACkoF,SAAF,KAAgB,KAAvB;AAAA,WAAnB,CAAf,CAvGgF,CAuGf;;AACjE,cAAMqC,QAAQ,GAAG,KAAKC,WAAL,CAAiB30F,KAAjB,EAAwBgtB,GAAxB,EAA6BynE,MAA7B,CAAjB;AACA,eAAKhC,WAAL,CAAiB/xF,QAAjB,CAA0BV,KAA1B;;AACA,cAAI00F,QAAJ,EAAc;AACV;AACA,iBAAKzB,iBAAL;AACA;AACH,WA9G+E,CAgHhF;;;AACA,cAAI,KAAK/C,aAAL,KAAuBuF,mBAA3B,EAAgD;AAC5C,iBAAK7D,aAAL,GAAqB,IAArB;AACH,WAFD,MAEO,IAAI,KAAKp4C,eAAL,KAAyBA,eAA7B,EAA8C;AACjD,iBAAKo4C,aAAL,GAAqB,IAArB;AACH,WArH+E,CAuHhF;;;AACA,eAAK1B,aAAL,GAAqB,UAAAryC,sCAAA,CAAuC43C,mBAAmB,CAAChsF,EAA3D,EAA+D,KAAK/E,QAApE,CAArB,CAxHgF,CAwHoB;;AACpG,eAAK80C,eAAL,GAAuBA,eAAvB;AAEA,eAAKw5C,cAAL;AACA,eAAKC,iBAAL;AACH;;;oCAEkBzlF,K,EAA2B;AAC1C;AACA,cAAMyoF,iBAAiB,GAAG,UAAAp4C,sCAAA,CACtBrwC,KAAK,CAAC1N,IAAN,CAAW6C,OAAX,EADsB,EAEtB,KAAK+B,QAFiB,CAA1B,CAF0C,CAKvC;;AACH,cAAImrB,OAAO,GAAGomE,iBAAiB,CAAC/5D,KAAlB,EAAd;AACA,cAAIpM,KAAK,GAAGD,OAAO,CAAClvB,QAAR,CAAiB;AAAEJ,mBAAO,EAAE,KAAKi5C;AAAhB,WAAjB,CAAZ;;AAEA,cAAIy8C,iBAAiB,CAACxsF,EAAlB,GAAuB/J,IAAI,CAAConB,GAAL,EAA3B,EAAuC;AACnC;AACA;AACA;AACH,WAbyC,CAe1C;;;AACA,cAAI,KAAKopE,aAAL,CAAmBzmF,EAAnB,KAA0BomB,OAAO,CAACpmB,EAAtC,EAA0C;AACtC;AACA;AACA,gBAAI,KAAK8mF,cAAT,EAAyB;AACrB,kBAAM/1E,KAAK,GAAG,KAAK+1E,cAAL,CAAoB/1E,KAApB,CAA0B,KAAK+1E,cAAL,CAAoBvtE,KAApB,CAA0B9R,KAApD,KAA8D,CAA5E;;AACA,kBAAIsJ,KAAJ,EAAW;AACPqV,uBAAO,GAAGA,OAAO,CAACte,aAAR,CAAsB;AAAEC,yBAAO,EAAEgJ;AAAX,iBAAtB,CAAV;AACH;;AACD,kBAAMkT,SAAS,GACX,KAAK6iE,cAAL,CAAoB7iE,SAApB,CAA8B,KAAK6iE,cAAL,CAAoBvtE,KAApB,CAA0B9R,KAAxD,KAAkE,CADtE;;AAEA,kBAAIwc,SAAJ,EAAe;AACXoC,qBAAK,GAAGA,KAAK,CAACnvB,QAAN,CAAe;AAAEJ,yBAAO,EAAEmtB;AAAX,iBAAf,CAAR;AACH;AACJ,aAbqC,CAetC;;;AACA,gBAAM+mE,MAAM,GAAG,KAAK54E,MAAL,CAAYnV,MAAZ,CAAmB,UAACyD,CAAD;AAAA,qBAAOA,CAAC,CAACkoF,SAAF,KAAgB,KAAvB;AAAA,aAAnB,CAAf,CAhBsC,CAiBtC;;AACA,gBAAMqC,QAAQ,GAAG,KAAKC,WAAL,CAAiB9kE,OAAjB,EAA0BC,KAA1B,EAAiC2kE,MAAjC,CAAjB;;AACA,gBAAIC,QAAJ,EAAc;AACV;AACA,mBAAKzB,iBAAL;AACA;AACH;;AAED,iBAAKrB,aAAL,GAAqB,IAArB;AACA,iBAAK1B,aAAL,GAAqB+F,iBAArB,CA1BsC,CA0BE;;AAExC,iBAAKjD,cAAL;AACA,iBAAKC,iBAAL;AACH;AACJ;;;mDAEiC;AAAA;;AAC9B,eAAKX,UAAL,GAAkB;AACdpC,yBAAa,EAAE,KAAKA,aADN;AAEd12C,2BAAe,EAAE,KAAKA,eAFR;AAGd/4C,kBAAM,EAAE,KAAKA,MAHC;AAIdI,oBAAQ,EAAE,KAAKA,QAJD;AAKdmiB,iBAAK,EAAE,IAAI,cAAAC,KAAJ,CAAU,KAAKD,KAAf,CALO;AAMdK,iBAAK,EAAE,KAAKA,KANE;AAOd2kE,qBAAS,EAAE,KAAKA,SAPF;AAQduI,0BAAc,EAAE,KAAKA;AARP,WAAlB;AAWA,cAAMtsD,SAAS,GAAG,KAAKk2C,MAAL,CAAYriE,IAAZ,CAAiB,4CAAA4rE,qCAAjB,EAAwD;AACtErtE,gBAAI,EAAE,KAAKi8E,UAD2D;AAEtEv6E,sBAAU,EAAE,WAF0D;AAGtE0vC,qBAAS,EAAE,KAH2D;AAItEC,yBAAa,EAAE;AAJuD,WAAxD,CAAlB;AAOAzjB,mBAAS,CAACgd,iBAAV,CAA4Bg4B,UAA5B,CAAuCl7E,SAAvC,CAAiD,UAACkD,CAAD,EAAY;AACzD;AACA,oBAAI,CAAC2wF,aAAL,GAAqB,IAArB;AACA,oBAAI,CAAC1B,aAAL,GAAqBjvF,CAAC,CAACR,MAAvB;AACA,oBAAI,CAAC+4C,eAAL,GAAuBv4C,CAAC,CAACJ,QAAzB;AAEAojC,qBAAS,CAACgd,iBAAV,CAA4Bi1C,YAA5B,CAAyC;AACrCz1F,oBAAM,EAAEQ,CAAC,CAACR,MAD2B;AAErCI,sBAAQ,EAAE,QAAI,CAAC24C,eAFsB;AAGrC02C,2BAAa,EAAE,QAAI,CAACA,aAHiB;AAIrC12C,6BAAe,EAAE,QAAI,CAACA;AAJe,aAAzC;;AAMA,oBAAI,CAACw5C,cAAL;;AACA,oBAAI,CAACC,iBAAL,GAbyD,CAczD;;;AACA,oBAAI,CAACF,gBAAL,CAAsB9xF,CAAC,CAACR,MAAxB;AACH,WAhBD;AAkBAwjC,mBAAS,CAACod,WAAV,GAAwBtjD,SAAxB,CAAkC,UAACkD,CAAD,EAAO;AACrC;AACA,gBAAIA,CAAJ,EAAO;AACH;AACA,kBAAM4nE,YAAY,GAAG,UAAAhrB,sCAAA,CACjB58C,CAAC,CAACR,MAAF,CAASgJ,EADQ,EAEjB,QAAI,CAAC/E,QAFY,CAArB;AAIA,sBAAI,CAACjE,MAAL,GAAcooE,YAAd;AACA,sBAAI,CAAChoE,QAAL,GAAgBI,CAAC,CAACJ,QAAlB;AACA,sBAAI,CAACgyF,UAAL,GAAkB,IAAI,UAAA7hF,MAAJ,CAAW;AACzBlR,oBAAI,EAAE,QAAA2C,QAAA,CAASqwF,OAAT,CAAiBjqB,YAAY,CAACznE,UAAb,CAAwB,YAAxB,CAAjB;AADmB,eAAX,EAEfV,QAFe,CAEN;AAAE0B,oBAAI,EAAE,EAAR;AAAYjC,sBAAM,EAAE;AAApB,eAFM,CAAlB;AAGA,sBAAI,CAACyxF,aAAL,GAAqB,KAArB;;AACA,sBAAI,CAACP,cAAL,CAAoB7wC,IAApB,CAAyB,MAAD,OAAC,CAAD,kBAAMv/C,CAAN,CAAC,EAAM;AAAE04C,sBAAM,EAAE,QAAI,CAACA,MAAf;AAAuB5E,oBAAI,EAAE;AAA7B,eAAN,CAAzB;AACH,aAbD,MAaO;AACH;AACA,kBAAM6gD,EAAE,GAAG,QAAI,CAACtD,UAAhB;AACA,sBAAI,CAAC7xF,MAAL,GAAcm1F,EAAE,CAACn1F,MAAjB;AACA,sBAAI,CAACI,QAAL,GAAgB+0F,EAAE,CAAC/0F,QAAnB;AACA,sBAAI,CAACqvF,aAAL,GAAqB0F,EAAE,CAACn1F,MAAxB;AACA,sBAAI,CAAC+4C,eAAL,GAAuBo8C,EAAE,CAAC/0F,QAA1B;AACA,sBAAI,CAACgyF,UAAL,GAAkB,IAAI,UAAA7hF,MAAJ,CAAW;AACzBlR,oBAAI,EAAE,QAAA2C,QAAA,CAASqwF,OAAT,CAAiB8C,EAAE,CAACn1F,MAAH,CAAUW,UAAV,CAAqB,YAArB,CAAjB;AADmB,eAAX,EAEfV,QAFe,CAEN;AAAE0B,oBAAI,EAAE,EAAR;AAAYjC,sBAAM,EAAE;AAApB,eAFM,CAAlB;AAGA,sBAAI,CAACyxF,aAAL,GAAqB,KAArB,CAVG,CAWH;;AACA,sBAAI,CAACP,cAAL,CAAoB7wC,IAApB,CAAyB;AACrB//C,sBAAM,EAAEm1F,EAAE,CAACn1F,MADU;AAErBI,wBAAQ,EAAE,QAAI,CAACA,QAFM;AAGrB84C,sBAAM,EAAE,QAAI,CAACA,MAHQ;AAIrB5E,oBAAI,EAAE,CAAC,CAAC9zC;AAJa,eAAzB;;AAMA,sBAAI,CAAC+xF,cAAL;;AACA,sBAAI,CAACC,iBAAL;;AACA,sBAAI,CAAClB,WAAL,CAAiB9jF,IAAjB;;AACA,sBAAI,CAACqyE,0BAAL,GAAkC,QAAI,CAACuS,UAAvC;;AACA,sBAAI,CAACM,eAAL;AACH;AACJ,WAvCD;AAwCH;;;mCAEiB;AACd9tF,gBAAM,CAACyS,IAAP,CAAY,OAAAmgE,IAAA,CAAKC,IAAjB;AACH;;;mCAEiB;AAAA;;AACd,cAAI,KAAKqa,WAAT,EAAsB;AACtB,eAAK9zF,OAAL,CACI,WADJ,EAEI,YAAM;AACF,gBAAM03F,GAAG,GAAG9qF,QAAQ,CAAC+qF,cAAT,CAAwB,yBAAxB,CAAZ;;AACA,gBAAID,GAAJ,EAAS;AACLA,iBAAG,CAACzxC,QAAJ,CAAa;AACTC,mBAAG,EAAE,QAAI,CAACyuC,YAAL,GAAoB,EADhB;AAETvuC,oBAAI,EAAE,CAFG;AAGTC,wBAAQ,EAAE;AAHD,eAAb;AAKA,sBAAI,CAACytC,WAAL,GAAmB,IAAnB;AACH;AACJ,WAZL,EAaI,GAbJ;AAeH;;;2CAEyB;AACtB,eAAKd,cAAL,GAAsB,CAAC,KAAKA,cAA5B;AACH;;;mCAEiB;AACd,eAAKH,YAAL,CAAkB9wC,IAAlB,CAAuB,KAAvB,EADc,CAEd;;AACA,eAAK0vC,aAAL,GAAqB,KAAKzvF,MAA1B,CAHc,CAGoB;;AAClC,eAAK+4C,eAAL,GAAuB,KAAK34C,QAA5B;AACA,eAAKgyF,UAAL,GAAkB,IAAI,UAAA7hF,MAAJ,CAAW;AACzBlR,gBAAI,EAAE,QAAA2C,QAAA,CAASqwF,OAAT,CAAiB,KAAKryF,MAAL,CAAYW,UAAZ,CAAuB,YAAvB,CAAjB;AADmB,WAAX,EAEfV,QAFe,CAEN;AAAE0B,gBAAI,EAAE,EAAR;AAAYjC,kBAAM,EAAE;AAApB,WAFM,CAAlB;AAGA,eAAKyxF,aAAL,GAAqB,KAArB;AACA,eAAKoB,cAAL;AACA,eAAKC,iBAAL;AACA,eAAKnB,UAAL,CAAgB7jF,IAAhB;AACH;;;uCAEqB;AAClB,cAAIooD,KAAK,GAAG,KAAKiqB,0BAAjB,CADkB,CAC2B;;AAC7C,cAAI,KAAK3mC,MAAT,EAAiB;AACb0c,iBAAK,GAAGA,KAAK,CAAC9kD,aAAN,CAAoB;AAAE4f,kBAAI,EAAE;AAAR,aAApB,CAAR;AACH,WAFD,MAEO;AACHklC,iBAAK,GAAGA,KAAK,CAAC9kD,aAAN,CAAoB;AAAE+nB,mBAAK,EAAE;AAAT,aAApB,EAAkC9vB,YAAlC,CAA+C,KAA/C,CAAR;AACH;;AACD,eAAK+nF,sBAAL,CAA4B/wC,IAA5B,CAAiC6V,KAAjC;AACA,eAAK07B,WAAL,CAAiB9jF,IAAjB;AACA,eAAKqyE,0BAAL,GAAkCjqB,KAAlC;AACA,eAAK88B,eAAL;AACH;;;uCAEqB;AAClB,cAAI98B,KAAK,GAAG,KAAK65B,aAAjB,CADkB,CACc;;AAChC,cAAI,KAAKv2C,MAAL,IAAe,CAAC,KAAKu5C,QAAzB,EAAmC;AAC/B,iBAAKV,SAAL,CAAexyF,KAAf,GAAuBq2D,KAAK,CAAC7sD,YAAN,CAAmB,KAAnB,EAA0BC,EAAjD;AACA,iBAAK+oF,SAAL,CAAexlE,GAAf,GAAqBqpC,KAAK,CAACtmC,UAAN,CAAiB,KAAjB,EAAwBtmB,EAA7C;AACH,WAHD,MAGO;AACH,iBAAK+oF,SAAL,CAAexyF,KAAf,GAAuBq2D,KAAK,CAAC7sD,YAAN,CAAmB,MAAnB,EAA2BC,EAAlD;AACA,iBAAK+oF,SAAL,CAAexlE,GAAf,GAAqBqpC,KAAK,CAACtmC,UAAN,CAAiB,MAAjB,EAAyBtmB,EAA9C;AACH;AACJ;;;yCAEuB;AACpB,cAAI4sD,KAAK,GAAG,KAAK65B,aAAL,CAAmB1mF,YAAnB,CAAgC,KAAhC,CAAZ;;AACA,cAAI,CAAC,KAAKmwC,MAAV,EAAkB;AACd0c,iBAAK,GAAGA,KAAK,CAAC7sD,YAAN,CAAmB,MAAnB,CAAR;AACH;;AAED,eAAK+nF,sBAAL,CAA4B/wC,IAA5B,CAAiC6V,KAAjC;AACA,eAAK07B,WAAL,CAAiB9jF,IAAjB;AACA,eAAKqyE,0BAAL,GAAkCjqB,KAAlC;AACA,eAAK88B,eAAL;AACH;;;0CAEwB;AACrB,cAAI98B,KAAK,GAAG,KAAKiqB,0BAAjB,CADqB,CACuB;;AAC5C,cAAI,KAAK3mC,MAAT,EAAiB;AACb0c,iBAAK,GAAGA,KAAK,CAAC11D,QAAN,CAAe;AAAEwwB,kBAAI,EAAE;AAAR,aAAf,CAAR;AACH,WAFD,MAEO;AACHklC,iBAAK,GAAGA,KAAK,CAAC11D,QAAN,CAAe;AAAE24B,mBAAK,EAAE;AAAT,aAAf,EAA6B9vB,YAA7B,CAA0C,KAA1C,CAAR;AACH;;AACD,eAAK+nF,sBAAL,CAA4B/wC,IAA5B,CAAiC6V,KAAjC;AACA,eAAK07B,WAAL,CAAiB9jF,IAAjB;AACA,eAAKqyE,0BAAL,GAAkCjqB,KAAlC;AACA,eAAK88B,eAAL;AACH;;;wCAEsB;AACnB,eAAKzB,WAAL,GAAmB,CAAC,KAAKA,WAAzB;AACA,eAAKsB,cAAL;AACH;;;4BApsBkB;AACf,iBAAO,KAAKvyF,MAAL,CAAY2mB,WAAnB;AACH;;;4BAE8B;AAC3B,iBAAO,QAAP;AACH;;;4BAEqC;AAClC,iBAAO,OAAP;AACH;;;4BAqBmB;AAChB,iBAAO,KAAKuqE,kBAAL,CAAwB/gF,IAAxB,CAA6B,YAAAjL,GAAA,CAAI,UAAC1E,CAAD;AAAA,mBAAOA,CAAP;AAAA,WAAJ,CAA7B,CAAP;AACH;;;4BAEqB;AAClB,iBAAO,OAAAq3E,mBAAA,CAAoB,KAAKC,WAAzB,CAAP;AACH;;;;MArGiD,OAAAr9E,S;;AANtD;;;uBAMagoF,gC,EAAgC,kC;AAAA,K;;;YAAhCA,gC;AAAgC,gD;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClF7C;AACI;AACI;AAOJ;AACA;AACI;AAUA;AA2IA;AAOJ;AACJ;;;;AArKY;AAAA;AAOwC;AAAA;AAExC;AAAA;AASC;AAAA;AA2IqC;AAAA;;;;;;;;;;;2BD9ErCA,gC,EAAgC;cAN5C,OAAAvhC,SAM4C;eANlC;AACPjlD,kBAAQ,EAAE,2BADH;AAEPklD,qBAAW,EAAE,4CAFN;AAGPC,mBAAS,EAAE,CAAC,4CAAD,CAHJ;AAIP2B,yBAAe,EAAE,OAAAC,uBAAA,CAAwBC;AAJlC,S;AAMkC,Q;;;;;;gBACxC,OAAAyB,S;iBAAU,iB;;;gBAEV,OAAA/lD;;;gBAEA,OAAAA;;;gBACA,OAAAA;;;gBAEA,OAAAA;;;gBAGA,OAAAA;;;gBACA,OAAAA;;;gBACA,OAAAA;;;gBACA,OAAAA;;;gBACA,OAAAA;;;gBACA,OAAAA;;;gBAEA,OAAAA;;;gBACA,OAAAA;;;gBAGA,OAAA0iD;;;gBACA,OAAAA;;;gBACA,OAAAA;;;gBACA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AE3GL;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAOA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AASA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC2BgB;AACI;AAGJ;;;;;;;AA0FI;AACI;AACA;AAEJ;;;;;;AACA;AACI;AACA;AACJ;;;;;;;;;;;;AAtLhB;AACQ;AAAA;AAAA;AAAA;AAAA;AAMJ;AACI;AACI;AAAA;AAIiB;AACjB;AAAA;AACA;AACI;AAOI;AAAA;AAAA;AAAA,6BAAa,OAAb;AAAoB,SAApB;AAPJ;AASA;AAAA;AACI;AACI;AAGR;AAAA;AACJ;AACJ;AACA;AACI;AASJ;AACJ;AACA;AACI;AAMkB;AAA0B;AAChD;AAEA;AACI;AAWI;AAAA;AAAA;AAAA,2DAAqD6J,MAAM,CAACvP,IAAP,EAArD;AAAkE,SAAlE,EAAoE,gBAApE,EAAoE;AAAA;AAAA;AAAA;AAAA,SAApE,EAAoE,cAApE,EAAoE;AAAA;AAAA;AAAA;AAAA,SAApE;AAOJ;AACA;AAEI;AAAA;AAAA;AAAA;AAAA;AAFJ;AAII;AACA;AAKJ;AAAA;AACJ;AAEA;AACI;AACI;AASA;AAAA;AAAA;AAAA,2DAAoDuP,MAAM,CAACvP,IAAP,EAApD;AAAiE,SAAjE,EAAmE,gBAAnE,EAAmE;AAAA;AAAA;AAAA;AAAA,SAAnE;AAKA;AACJ;AACA;AACI;AAAA;AAIe;AACf;AAAA;AACA;AACI;AAOA;AAAA;AACI;AACA;AAGJ;AAAA;AACJ;AACJ;AACA;AACI;AAAA;AAIkB;AAClB;AAAA;AACA;AACI;AASA;AAAA;AACI;AACI;AAGR;AAAA;AACJ;AACJ;AACJ;AAEA;AACI;AACI;AAAA;AAI0D;AAC1D;AAAA;AACA;AACI;AAKI;AAAA;AAAA;AAAA,8BAAa,OAAb;AAAoB,SAApB;AACH;AACL;AACA;AACI;AAKA;AAIJ;AACJ;AACJ;AACJ;;;;;AArLQ;AAIe;AAAA;AAaH;AAAA;AAQJ;AAAA;AAAA;AAQA;AAAA,qDAAuB,UAAvB,EAAuB,IAAvB,EAAuB,UAAvB,EAAuB,eAAvB;AAWR;AAAA;AADA,qvBAA2M,SAA3M,EAA2M,4BAA3M;AAYI;AAAA,wCAAiB,oBAAjB,EAAiB,IAAjB,EAAiB,SAAjB,EAAiB,cAAjB,EAAiB,eAAjB,EAAiB,IAAjB,EAAiB,aAAjB,EAAiB,KAAjB,EAAiB,iBAAjB,EAAiB,sBAAjB,EAAiB,SAAjB,EAAiB,cAAjB,EAAiB,oBAAjB,EAAiB,IAAjB;AAoBK;AAAA;AAYL;AAAA,yCAAkB,oBAAlB,EAAkB,IAAlB,EAAkB,SAAlB,EAAkB,qBAAlB,EAAkB,eAAlB,EAAkB,IAAlB,EAAkB,aAAlB,EAAkB,KAAlB,EAAkB,iBAAlB,EAAkB,wBAAlB,EAAkB,oBAAlB,EAAkB,IAAlB;AAoBA;AAAA;AAAA;AAcI;AAAA;AAAA;AAsCiC;AAAA;AAU9B;AAAA;AAKA;AAAA;;;;QDvHVknC,+B;;;;;AA4ET,+CACYx0D,OADZ,EAEYunE,SAFZ,EAGY7/E,KAHZ,EAII6lD,KAJJ,EAKYvzB,MALZ,EAKkC;AAAA;;AAAA;;AAC9B,uCAAMuzB,KAAN;AALQ,iBAAAvtC,OAAA,GAAAA,OAAA;AACA,iBAAAunE,SAAA,GAAAA,SAAA;AACA,iBAAA7/E,KAAA,GAAAA,KAAA;AAEA,iBAAAsyB,MAAA,GAAAA,MAAA;AA9EZ;;AACgB,iBAAA13B,KAAA,GAAQ,CAAR;AAChB;;AACgB,iBAAAklF,aAAA,GAAgB,EAAhB;AAChB;;AACgB,iBAAA7hF,OAAA,GAAmB,IAAnB;AAChB;;AACiB,iBAAAwkE,UAAA,GAAa,IAAI,OAAA75B,YAAJ,EAAb;AACjB;;AACiB,iBAAA85B,YAAA,GAAe,IAAI,OAAA95B,YAAJ,EAAf;AASjB;;AACO,iBAAAm3C,QAAA,GAAW,KAAX;AAKP;;AACO,iBAAAC,aAAA,GAAgB,IAAI,OAAA56E,OAAJ,EAAhB;AACP;;AACO,iBAAA66E,WAAA,GAAc,EAAd;AACP;;AACO,iBAAA/zE,OAAA,GAAU,IAAI,OAAAnnB,eAAJ,CAAyC,EAAzC,CAAV;AACP;;AACO,iBAAA6uB,eAAA,GAAkB,IAAI,OAAA7uB,eAAJ,CAAyC,EAAzC,CAAlB;AACA,iBAAAm7F,aAAA,GAAgB,IAAI,OAAAn7F,eAAJ,CAAyC,EAAzC,CAAhB;AACA,iBAAAwoD,iBAAA,GAAoB,KAApB;AACA,iBAAAw2B,YAAA,GAAe,KAAf;AACA,iBAAA51D,SAAA,GAAqB,IAArB;AACA,iBAAAgyE,WAAA,GAAc,IAAd;AACA,iBAAAC,mBAAA,GAAsB,EAAtB;AACA,iBAAAC,iBAAA,GAAoB,IAAI,OAAAt7F,eAAJ,CAAyC,EAAzC,CAApB;AACA,iBAAAu7F,cAAA,GAAiB,IAAI,OAAAv7F,eAAJ,CAAyC,EAAzC,CAAjB;AAEP;;AACO,iBAAAw7F,gBAAA,GAAmB,IAAI,QAAA75D,SAAJ,CAAc;AACpC9I,mBAAS,EAAE,IAAI,QAAAqG,WAAJ,EADyB;AAEpChO,eAAK,EAAE,IAAI,QAAAgO,WAAJ,CAAgB,EAAhB,EAAoB,CAAE,QAAAE,UAAA,CAAWG,SAAX,CAAqB,CAArB,CAAF,CAApB,CAF6B;AAGpC3G,mBAAS,EAAE,IAAI,QAAAsG,WAAJ,EAHyB;AAIpC5Q,cAAI,EAAE,IAAI,QAAA4Q,WAAJ,CAAgB,EAAhB,EAAoB,CAAC,QAAAE,UAAA,CAAWG,SAAX,CAAqB,CAArB,CAAD,EAA0B,QAAAH,UAAA,CAAWuf,OAAX,CAAmB,gBAAnB,CAA1B,CAApB,CAJ8B;AAKpC3lB,eAAK,EAAE,IAAI,QAAAkG,WAAJ,EAL6B;AAMpC6rB,oBAAU,EAAE,IAAI,QAAA7rB,WAAJ,CAAgB,CAAhB,EAAmB,CAAC,QAAAE,UAAA,CAAWC,QAAZ,EAAsB,QAAAD,UAAA,CAAW8C,GAAX,CAAe,CAAf,CAAtB,CAAnB,CANwB;AAOpCwkB,mBAAS,EAAE,IAAI,QAAAxnB,WAAJ,EAPyB;AAQpCu8D,mBAAS,EAAE,IAAI,QAAAv8D,WAAJ,EARyB;AASpC7F,iBAAO,EAAE,IAAI,QAAA6F,WAAJ,EAT2B;AAUpCzF,iBAAO,EAAE,IAAI,QAAAyF,WAAJ;AAV2B,SAAd,CAAnB;AAoC2B;AAEjC;;;;mCAEc;AAAA;;AACX;;AACA,eAAK58B,YAAL,CAAkB,aAAlB,EAAiC,KAAK2Y,KAAL,CAAWgC,MAAX,CAAkB,OAAAC,iBAAlB,EAC5B7H,IAD4B,CACvB,YAAA+H,IAAA,CAAK,CAAL,CADuB,EAE5B5a,SAF4B,CAElB,UAAC2a,IAAD,EAAgB;AACvB;AACA,oBAAI,CAAC0J,WAAL,GAAmB,IAAI,cAAA0R,IAAJ,CAASpb,IAAT,CAAnB;AACH,WAL4B,CAAjC;;AAQA,eAAKowB,MAAL,CAAYzwB,WAAZ,CAAwBzH,IAAxB,CAA6B,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,mBAAOA,CAAP;AAAA,WAAN,CAA7B,EAA8CvZ,SAA9C,CAAwD,YAAM;AAC1D,gBAAM2a,IAAI,GAAS,QAAI,CAACowB,MAAL,CAAYtO,OAA/B;AACA,gBAAM4d,SAAS,GAAG1/B,IAAI,CAAC0/B,SAAL,CAAezyC,GAAf,CAAmB,UAACw1C,GAAD,EAAS;AAC1C;AACA,kBAAM87C,MAAM,GAAG,QAAI,CAACnuD,MAAL,CAAYxlC,IAAZ,CAAiB63C,GAAG,CAACjqC,KAArB,CAAf;;AACA,qBAAO+lF,MAAM,GACT,IAAI,cAAAnjE,IAAJ,CAAS;AAAE5iB,qBAAK,EAAE+lF,MAAM,CAAC/lF,KAAhB;AAAuBrV,oBAAI,EAAEo7F,MAAM,CAACp7F,IAApC;AAA0Cm5B,uBAAO,EAAEmmB,GAAG,CAACnmB;AAAvD,eAAT,CADS,GAET,IAAI,cAAAlB,IAAJ,CAAS;AAAE5iB,qBAAK,EAAEiqC,GAAG,CAACjqC,KAAb;AAAoBrV,oBAAI,EAAEs/C,GAAG,CAACjqC,KAAJ,CAAUpP,KAAV,CAAgB,GAAhB,EAAqB,CAArB,EAAwBA,KAAxB,CAA8B,GAA9B,EAAmC6D,GAAnC,CAAuC,UAAC0P,CAAD;AAAA,yBAAOA,CAAC,CAAC02B,MAAF,CAAS,CAAT,EAAY78B,WAAZ,KAA4BmG,CAAC,CAAClI,SAAF,CAAY,CAAZ,CAAnC;AAAA,iBAAvC,EAClChE,IADkC,CAC7B,GAD6B,CAA1B;AAEP6rB,uBAAO,EAAEmmB,GAAG,CAACnmB;AAFN,eAAT,CAFJ,CAH0C,CAS1C;AACC,aAVa,CAAlB;;AAWA,gBAAIojB,SAAS,CAACp2C,MAAd,EAAsB;AAClB,sBAAI,CAACu4E,YAAL,GAAoB,IAApB;AACH;;AACD,oBAAI,CAACyc,SAAL,GAAiB,CAACt+E,IAAD,EAAOkZ,MAAP,CAAcwmB,SAAd,CAAjB;AACA,oBAAI,CAACq+C,WAAL,GAAmB,QAAI,CAACO,SAAL,CAAerxF,GAAf,CAAmB,UAAA5E,CAAC;AAAA,qBAAK;AAAEgL,uBAAO,EAAEhL,CAAC,CAAClF,IAAb;AAAmBmH,qBAAK,EAAEjC,CAAC,CAACmQ,KAA5B;AAAmC2T,oBAAI,EAAE;AAAEnM,sBAAI,EAAE3X;AAAR;AAAzC,eAAL;AAAA,aAApB,CAAnB;AACH,WAlBD,EAVW,CA8BX;;;AACA,eAAKlD,YAAL,CAAkB,WAAlB,EAA+B,KAAK2Y,KAAL,CAAWgC,MAAX,CAAkB,cAAA0O,gBAAlB,EAC1BtW,IAD0B,CACrB,YAAA+H,IAAA,CAAK,CAAL,CADqB,EAE1B5a,SAF0B,CAEhB,UAACkQ,IAAD,EAAuC;;;AAC9C,gBAAIA,IAAJ,EAAU;AACN;AADM,2BAEwB,CAAH,KAAGA,IAAI,CAACwrE,YAAL,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEz2D,KAF3C;AAAA,kBAEEzb,OAFF,UAEEA,OAFF;AAAA,kBAEW0R,QAFX,UAEWA,QAFX;;AAGN,kBAAMstC,eAAe,GAAG,CAAAh/C,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE0gC,cAAT,MAA2BhvB,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEgvB,cAArC,CAAxB;AACA,kBAAMue,iBAAiB,GAAG,CAAH,iBAAGv4C,IAAI,CAACwrE,YAAR,MAAoB,IAApB,IAAoB,aAApB,GAAoB,MAApB,GAAoB,GAAEt2D,QAAtB,MAA8B,IAA9B,IAA8B,aAA9B,GAA8B,MAA9B,GAA8B,GAAEyX,QAA7B,MAAqC,IAArC,IAAqC,aAArC,GAAqC,MAArC,GAAqC,GAAEqN,cAAjE;AACA,sBAAI,CAAC8b,iBAAL,GAAyBwC,eAAe,KAAKxkD,SAApB,GAAgCwkD,eAAhC,GAAkDC,iBAAiB,KAAKzkD,SAAtB,GAAkCykD,iBAAlC,GAAqD,KAAhI;;AAGA,kBAAI,QAAI,CAACzC,iBAAT,EAA4B;AACxB,wBAAI,CAACgzC,gBAAL,CAAsB1rD,QAAtB,CAA+BxhB,IAA/B,CAAoCqR,aAApC,CAAkD,CAAC,QAAAP,UAAA,CAAWC,QAAZ,EAAsB,QAAAD,UAAA,CAAWG,SAAX,CAAqB,CAArB,CAAtB,EAA+C,QAAAH,UAAA,CAAWuf,OAAX,CAAmB,gBAAnB,CAA/C,CAAlD;AACH,eAVK,CAWN;;;AACA,kBAAMx3B,OAAO,GAAG,EAAhB;AACA,kBAAMyR,SAAS,GAAG,CAAAlmB,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEkmB,SAAN,KAAmB,EAArC;AACA,kBAAMC,SAAS,GAAG,CAAAnmB,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEmmB,SAAN,KAAmB;AAAEroB,uBAAO,EAAE,QAAI,CAACqW,WAAL,CAAiBvmB,IAA5B;AAAmCmH,qBAAK,EAAE,QAAI,CAACof,WAAL,CAAiBlR,KAA3D;AAAkE2T,oBAAI,EAAE;AAAEqT,0BAAQ,EAAE,KAAZ;AAAmBxf,sBAAI,EAAE,QAAI,CAAC0J;AAA9B;AAAxE,eAArC;AACA,kBAAMwS,OAAO,GAAG,CAAA3mB,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAE2mB,OAAN,KAAiB,EAAjC;AAEA,kBAAMI,OAAO,GAAG,CAAA/mB,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAE+mB,OAAN,KAAiB,KAAjC;AACA,sBAAI,CAACjkB,MAAL,GAAc9C,IAAI,CAAC8C,MAAL,IAAe,KAA7B,CAlBM,CAmBN;;AACA,sBAAI,CAACgmF,gBAAL,CAAsBr2F,QAAtB,CAA+B;AAC3B0zB,yBAAS,EAATA,SAD2B;AAE3B3H,qBAAK,EAAExe,IAAI,CAACwe,KAAL,IAAc,EAFM;AAG3B0H,yBAAS,EAATA,SAH2B;AAI3BtK,oBAAI,EAAE5b,IAAI,CAAC4b,IAAL,IAAa,EAJQ;AAK3B0K,qBAAK,EAAEtmB,IAAI,CAACsmB,KAAL,IAAc,EALM;AAM3B+xB,0BAAU,EAAEr4C,IAAI,CAACq4C,UAAL,IAAmB,EANJ;AAO3BrE,yBAAS,EAAE,EAPgB;AAQ3B+0C,yBAAS,EAAE,EARgB;AAS3BpiE,uBAAO,EAAPA,OAT2B;AAU3BI,uBAAO,EAAEA;AAVkB,eAA/B;;AAYA,sBAAI,CAAC5K,eAAL,CAAqBnc,IAArB,CAA0BkmB,SAA1B;;AACA,sBAAI,CAACzR,OAAL,CAAazU,IAAb,CAAkBkmB,SAAlB;;AACA,sBAAI,CAAC0iE,iBAAL,CAAuB5oF,IAAvB,CAA4B2mB,OAA5B;;AACA,sBAAI,CAACkiE,cAAL,CAAoB7oF,IAApB,CAAyB2mB,OAAzB;AACH;AACJ,WAxC0B,CAA/B,EA/BW,CA0EX;;AACA,eAAKsiE,aAAL,GAAqB,KAAKV,aAAL,CAAmB5lF,IAAnB,CACjB,YAAA2f,YAAA,CAAa,GAAb,CADiB,EAEjB,YAAAkyB,oBAAA,EAFiB,EAGjB,YAAAjyB,SAAA,CAAU,UAACtd,KAAD,EAAW;AACjB,oBAAI,CAAC6F,OAAL,GAAe,IAAf;AACA,mBAAO7F,KAAK,CAAClR,MAAN,IAAgB,QAAI,CAACoP,KAArB,GACD,QAAI,CAAC03B,MAAL,CAAY51B,KAAZ,CAAkB;AAChByM,eAAC,EAAEzM,KADa;AAEhB+K,mBAAK,EAAE,KAAK;AAFI,aAAlB,CADC,GAKD9B,OAAO,CAACC,OAAR,CAAgB,EAAhB,CALN;AAMH,WARD,CAHiB,EAYjB,YAAAkC,UAAA,CAAW,UAAChH,CAAD;AAAA,mBAAO,OAAAkH,EAAA,CAAG,EAAH,CAAP;AAAA,WAAX,CAZiB,EAajB,YAAA7Y,GAAA,CAAI,UAAC3H,IAAD,EAAkB;AAClB,oBAAI,CAAC+a,OAAL,GAAe,KAAf;AACA,mBAAO/a,IAAP;AACH,WAHD,CAbiB,CAArB,CA3EW,CA8FX;;AACA,eAAKH,YAAL,CACI,gBADJ,EAEI,KAAKq5F,aAAL,CAAmBn5F,SAAnB,CAA6B,UAACC,IAAD,EAAU;AACnC,oBAAI,CAACikD,SAAL,GAAiBjkD,IAAjB;;AACA,oBAAI,CAACikD,SAAL,CAAe/jD,OAAf,CAAuB,UAACC,CAAD,EAAY;AAC/BA,eAAC,CAAC6uD,UAAF,GAAe,OAAA5jD,gBAAA,CAAiBjL,CAAC,CAAC6uD,UAAnB,CAAf;AACA7uD,eAAC,CAAC8uD,WAAF,GAAgB,OAAA7jD,gBAAA,CAAiBjL,CAAC,CAAC8uD,WAAnB,CAAhB;AACA,qBAAO9uD,CAAP;AACH,aAJD,EAFmC,CAQnC;;;AACA,gBAAMukB,OAAO,GAAG,QAAI,CAACu/B,SAAL,CAAet8C,GAAf,CAAmB,UAAA0yE,CAAC,EAAI;AACpC,qBAAO;AACHr1E,qBAAK,EAAEq1E,CAAC,CAACnnE,KADN;AAEHnF,uBAAO,YAAKssE,CAAC,CAACx8E,IAAP,cAAew8E,CAAC,CAACnnE,KAAjB,CAFJ;AAGH6Y,uBAAO,EAAE,KAHN;AAIHpC,2BAAW,EAAE,IAJV;AAKHnG,4BAAY,YAAK62D,CAAC,CAACx8E,IAAP,CALT;AAMHgpB,oBAAI,EAAE;AAAEqT,0BAAQ,EAAE,KAAZ;AAAmBxf,sBAAI,EAAE2/D;AAAzB;AANH,eAAP;AAQH,aATe,CAAhB,CATmC,CAmBnC;;;AACA31D,mBAAO,CAACy0E,OAAR,CAAgB;AACZn0F,mBAAK,EAAE,QAAI,CAACw2D,YADA;AAEZztD,qBAAO,EAAE,QAAI,CAACytD,YAFF;AAGZzvC,qBAAO,EAAE,KAHG;AAIZpC,yBAAW,EAAE,IAJD;AAKZnG,0BAAY,EAAE,QAAI,CAACg4C,YALP;AAMZ30C,kBAAI,EAAE;AAAEqT,wBAAQ,EAAE,IAAZ;AAAkBxf,oBAAI,EAAE;AAAxB;AANM,aAAhB,EApBmC,CA4BnC;;AACA,oBAAI,CAACgK,OAAL,CAAazU,IAAb,CAAkByU,OAAlB;AACH,WA9BD,CAFJ;AAmCA,eAAKq0E,gBAAL,CAAsBr7D,YAAtB,CAAmC39B,SAAnC,CAA6C,UAAA2vE,GAAG,EAAI;;;AAEhDhyE,wBAAY,CAAC,QAAI,CAACi7F,WAAN,CAAZ;;AACA,gBAAI,CAAJ,KAAIjpB,GAAG,SAAH,IAAAA,GAAG,WAAH,GAAG,MAAH,GAAAA,GAAG,CAAEn5C,KAAL,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAEvyB,MAAhB,EAAwB;AACpB;AACA,sBAAI,CAAC20F,WAAL,GAAmB16F,UAAU,CAAC,YAAM;AAChC,oBAAMwY,OAAO,GAAG,QAAI,CAACA,OAAL,CAAaynB,KAAb,EAAhB;;AACA,oBAAM1hB,KAAK,GAAG,EAAd;AACAA,qBAAK,CAAC/F,OAAO,CAACuO,KAAR,CAAc9R,KAAf,CAAL,GAA6BuD,OAAO,CAAC+F,KAAR,CAAc/F,OAAO,CAACuO,KAAR,CAAc9R,KAA5B,KAAsC,GAAnE;AACA,oBAAMwc,SAAS,GAAG,EAAlB;AACAA,yBAAS,CAACjZ,OAAO,CAACuO,KAAR,CAAc9R,KAAf,CAAT,GAAiCuD,OAAO,CAACiZ,SAAR,CAAkBjZ,OAAO,CAACuO,KAAR,CAAc9R,KAAhC,KAA0C,GAA3E;AAEA,oBAAMs/E,WAAW,GAAG,IAAI,cAAAhsE,OAAJ,CAAY;AAC5BzS,oBAAE,EAAE0C,OAAO,CAAC1C,EADgB;AAE5B0gB,sBAAI,EAAEhe,OAAO,CAACuO,KAFc;AAG5BpR,6BAAW,EAAE6C,OAAO,CAAC/J,WAAR,CAAoB8G,OAHL;AAI5BF,2BAAS,EAAEmD,OAAO,CAAC9J,SAAR,CAAkB6G,OAJD;AAK5BgJ,uBAAK,EAALA,KAL4B;AAM5BkT,2BAAS,EAATA;AAN4B,iBAAZ,CAApB;AASA,8BAAAJ,eAAA,CACI,QAAI,CAACwB,OADT,EAEI0hE,WAFJ,EAGEh0E,IAHF,CAGO,UAACwH,QAAD,EAAuB;AAC1B,0BAAI,CAACW,SAAL,GAAiBX,QAAjB;AACA,0BAAI,CAAC4yE,mBAAL,GAA2B5yE,QAAQ,KAAK,KAAb,GAAqB,QAArB,GAAgC,WAA3D;AACH,iBAND,WAMS,YAAM;AACX,0BAAI,CAACW,SAAL,GAAiB,KAAjB;;AACA,0BAAI,CAACu0D,YAAL,CAAkB14B,IAAlB,CAAuB,KAAvB;;AACA,0BAAI,CAACo2C,mBAAL,GAA2B,QAA3B;AACA;AACH,iBAXD;AAYH,eA5B4B,EA4B1B,GA5B0B,CAA7B;AA6BH,aA/BD,MA+BO;AACH,sBAAI,CAACjyE,SAAL,GAAiB,IAAjB;AACA,sBAAI,CAACiyE,mBAAL,GAA2B,EAA3B;AACH,aArC+C,CAyChD;AAEA;;;AACA,oBAAI,CAAC1d,YAAL,CAAkB14B,IAAlB,CAAuB,QAAI,CAACu2C,gBAAL,CAAsBtzE,KAA7C;AACD,WA7CH;AA8CH;;;2CAEyBuR,O,EAAS;AAC/B,eAAK+hE,gBAAL,CAAsB1rD,QAAtB,CAA+BrW,OAA/B,CAAuCt0B,QAAvC,CAAgDs0B,OAAhD;AACH;;;wCAEsBtc,I,EAAM;AACzBlT,iBAAO,CAACV,GAAR,CAAY4T,IAAZ;AACH;AAED;;;;oCACmBlb,O,EAAc;AAC7B,cAAIA,OAAO,CAAC84F,aAAR,IAAyB,KAAKc,OAAlC,EAA2C;AACvC;AACA,iBAAKA,OAAL,CAAaC,QAAb,CAAsBt1F,SAAtB;AACH;AACJ;AAEA;;;;;;;;6BAKWvG,G,EAAW;AACnB,eAAKu7F,gBAAL,CAAsBvhF,GAAtB,CAA0Bha,GAA1B,EAA+BkF,QAA/B,CAAwC,KAAKq2F,gBAAL,CAAsBvhF,GAAtB,CAA0Bha,GAA1B,EAA+BwH,KAA/B,CAAqCo5C,IAArC,EAAxC;AACH;AAED;;;;+BACc/xB,M,EAA2B;AAAA;;AACrC,cAAMitE,UAAU,GAAGjtE,MAAM,CAACrnB,KAA1B,CADqC,CAErC;;AACA,eACI;AACAs0F,oBAAU,CAACt1F,MAAX,GAAoB,EAFxB,EAE4B;AACxB,iBAAKq0F,SAAL,CAAev+E,IAAf,CAAoB,2CAApB,EAAiE,OAAjE,EAA0E;AAAEjX,sBAAQ,EAAE;AAAZ,aAA1E;;AACA;AACH;;AAGD,eAAKupB,eAAL,CAAqBxZ,IAArB,CACI,YAAA+H,IAAA,CAAK,CAAL,CADJ,EAEI,YAAAovC,cAAA,CAAe,KAAKrlC,OAApB,CAFJ,EAGI,YAAA/c,GAAA,CAAI,kBAAgC;AAAA;AAAA,gBAA9BykB,eAA8B;AAAA,gBAAb1H,OAAa;;AAChC,gBAAI6T,IAAI,GAAGnM,eAAe,CAACxkB,KAAhB,EAAX;AACA,gBAAM0P,KAAK,GAAGihB,IAAI,CAACjU,IAAL,CAAU,UAAA9V,CAAC;AAAA,qBAAI6d,MAAM,CAACrnB,KAAP,KAAiBwJ,CAAC,CAACxJ,KAAvB;AAAA,aAAX,CAAd;;AACA,gBAAIsS,KAAJ,EAAW;AACPihB,kBAAI,GAAGA,IAAI,CAAC7vB,MAAL,CAAY,UAAA8F,CAAC;AAAA,uBAAI6d,MAAM,CAACrnB,KAAP,KAAiBwJ,CAAC,CAACxJ,KAAvB;AAAA,eAAb,CAAP;AACH,aAFD,MAEO;AACH,kBAAMk2D,KAAK,GAAG7uC,MAAM,CAACrnB,KAAP,CAAawE,WAAb,GAA2BoS,QAA3B,CAAoC,WAApC,IAAmD,UAAnD,GAAgE,UAA9E;AACA2c,kBAAI,CAAC5uB,IAAL,CAAU,MAAD,OAAC,CAAD,kBACF0iB,MADE,CAAC,EACG;AACTxF,oBAAI,EAAE,MAAF,OAAE,CAAF,kBACGwF,MAAM,CAACxF,IADV,CAAE,EACY;AACdq0C,uBAAK,EAALA;AADc,iBADZ;AADG,eADH,CAAV;AAOH;;AAED,mBAAO3iC,IAAP;AACH,WAjBD,CAHJ,EAqBEx4B,SArBF,CAqBY,UAAAkQ,IAAI,EAAI;AAChB,gBAAI,CAAC,QAAI,CAAC8oF,gBAAL,CAAsB1rD,QAAtB,CAA+Bib,UAA/B,CAA0CoU,OAA/C,EAAwD;AACpD,sBAAI,CAACq8B,gBAAL,CAAsB1rD,QAAtB,CAA+Bib,UAA/B,CAA0C5lD,QAA1C,CAAmDuN,IAAI,CAACjM,MAAL,GAAc,CAAjE;AACH;;AACD,oBAAI,CAACooB,eAAL,CAAqBnc,IAArB,CAA0BA,IAA1B;AACH,WA1BD;AA2BH;;;yCAEuB;AACpB,eAAKspF,gBAAL,CAAsB72F,QAAtB,CAA+B,CAA/B;AACH;AAED;;;;uCACsB;AAClB,eAAKq2F,gBAAL,CAAsB3yC,gBAAtB,GADkB,CAElB;;AACA,cAAI,KAAK2yC,gBAAL,CAAsBtzE,KAA1B,EAAiC;AAC7B,gBAAM/F,SAAS,GAAG,KAAKq5E,gBAAL,CAAsB/zF,KAAxC;AACA0a,qBAAS,CAACukC,SAAV,GAAsB,KAAKA,SAA3B;AACAvkC,qBAAS,CAACs5E,SAAV,GAAsB,KAAKA,SAA3B;AACAt5E,qBAAS,CAAC68D,YAAV,GAAyB,KAAKA,YAA9B;AACA,iBAAKtB,UAAL,CAAgBz4B,IAAhB,CAAqB9iC,SAArB;AACH;AACJ;AAED;;;;2DAC0ClR,C,EAAW;AACjD,cAAMoJ,CAAC,GAAGpJ,CAAC,CAACxK,MAAZ;AACA,cAAM0gB,OAAO,GAAG,KAAK0H,eAAL,CAAqBpnB,KAArB,CAA2B4C,KAA3B,EAAhB;;AACA,cAAI,CAACgQ,CAAL,EAAQ;AACJ,iBAAK8M,OAAL,CAAazU,IAAb,CAAkB,EAAlB;AACA;AACH;;AACD,cAAI2H,CAAC,GAAG,CAAR,EAAW;AACP;AACA,iBAAK4gF,aAAL,CAAmBvoF,IAAnB,CAAwBzB,CAAxB;AACH;;AAEDkW,iBAAO,CAACy0E,OAAR,CAAgB;AACZn0F,iBAAK,EAAEwJ,CADK;AAEZT,mBAAO,EAAES,CAFG;AAGZud,mBAAO,EAAE,KAHG;AAIZpC,uBAAW,EAAE,IAJD;AAKZnG,wBAAY,EAAEhV,CALF;AAMZqY,gBAAI,EAAE;AAAEqT,sBAAQ,EAAE;AAAZ;AANM,WAAhB;AAQA,eAAKshC,YAAL,GAAoBhtD,CAApB;AACA,eAAKkW,OAAL,CAAazU,IAAb,CAAkByU,OAAlB;AACH;;;8CAE4B;AACtB,eAAK6zE,QAAL,GAAgB,CAAC,KAAKA,QAAtB;AACN;;;0DAEwC/pF,C,EAAW;AAChD,cAAI,CAACA,CAAC,CAACxK,MAAP,EAAe;AACX,iBAAK80F,cAAL,CAAoB7oF,IAApB,CAAyB,EAAzB;AACA;AACH;;AACD,eAAK6oF,cAAL,CAAoB7oF,IAApB,CAAyB,CAAC;AACtBjL,iBAAK,EAAEwJ,CADe;AAEtBT,mBAAO,EAAES,CAFa;AAGtBud,mBAAO,EAAE,KAHa;AAItBpC,uBAAW,EAAE,IAJS;AAKtBnG,wBAAY,EAAEhV;AALQ,WAAD,CAAzB;AAOH;;;sCAEoB6d,M,EAA2B;AAAA;;AAC5C,eAAKwsE,iBAAL,CAAuBjmF,IAAvB,CACI,YAAA+H,IAAA,CAAK,CAAL,CADJ,EAEI,YAAAovC,cAAA,CAAe,KAAK+uC,cAApB,CAFJ,EAGI,YAAAnxF,GAAA,CAAI,kBAAkC;AAAA;AAAA,gBAAhCkxF,iBAAgC;AAAA,gBAAbn0E,OAAa;;AAClC,gBAAI6T,IAAI,GAAGsgE,iBAAiB,CAACjxF,KAAlB,EAAX;AACA,gBAAM0P,KAAK,GAAGihB,IAAI,CAACjU,IAAL,CAAU,UAAA9V,CAAC;AAAA,qBAAI6d,MAAM,CAACrnB,KAAP,KAAiBwJ,CAAC,CAACxJ,KAAvB;AAAA,aAAX,CAAd;;AACA,gBAAIsS,KAAJ,EAAW;AACPihB,kBAAI,GAAGA,IAAI,CAAC7vB,MAAL,CAAY,UAAA8F,CAAC;AAAA,uBAAI6d,MAAM,CAACrnB,KAAP,KAAiBwJ,CAAC,CAACxJ,KAAvB;AAAA,eAAb,CAAP;AACH,aAFD,MAEO;AACHuzB,kBAAI,CAAC5uB,IAAL,CAAU0iB,MAAV;AACH;;AAED,mBAAOkM,IAAP;AACH,WAVD,CAHJ,EAcEx4B,SAdF,CAcY,UAAAkQ,IAAI,EAAI;AAChB,oBAAI,CAAC4oF,iBAAL,CAAuB5oF,IAAvB,CAA4BA,IAA5B;AACH,WAhBD;AAiBH;;;4BA5V8B;;;AAC3B,cAAI,CAAJ,KAAI,KAAK8oF,gBAAL,CAAsB1rD,QAAtB,CAA+BxhB,IAA/B,CAAoCm7B,MAApC,MAA0C,IAA1C,IAA0C,aAA1C,GAA0C,MAA1C,GAA0C,GAAEpqB,QAAhD,EAA0D;AACtD,mBAAO,yBAAP;AACH;;AACD,cAAI,CAAJ,KAAI,KAAKm8D,gBAAL,CAAsB1rD,QAAtB,CAA+BxhB,IAA/B,CAAoCm7B,MAApC,MAA0C,IAA1C,IAA0C,aAA1C,GAA0C,MAA1C,GAA0C,GAAEC,SAAhD,EAA2D;AACvD,mBAAO,8CAAP;AACH;;AACD,cAAI,CAAJ,KAAI,KAAK8xC,gBAAL,CAAsB1rD,QAAtB,CAA+BxhB,IAA/B,CAAoCm7B,MAApC,MAA0C,IAA1C,IAA0C,aAA1C,GAA0C,MAA1C,GAA0C,GAAE9K,OAAhD,EAAyD;AACrD,mBAAO,yDAAP;AACH;;AACD,iBAAO,EAAP;AACH;;;4BAE0B;AACvB,iBAAO,KAAK68C,gBAAL,CAAsBvhF,GAAtB,CAA0B,YAA1B,CAAP;AACH;;;;MA1EgD,KAAA4mD,qB;;AALrD;;;uBAKaknB,+B,EAA+B,sC,EAAA,oC,EAAA,8B,EAAA,yC,EAAA,qC;AAAA,K;;;YAA/BA,+B;AAA+B,oD;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;AC7D5C;;;;;;;;;2BD6DaA,+B,EAA+B;cAL3C,OAAA3hC,SAK2C;eALjC;AACPjlD,kBAAQ,EAAE,+BADH;AAEPklD,qBAAW,EAAE,4CAFN;AAGPC,mBAAS,EAAE,CAAC,4CAAD;AAHJ,S;AAKiC,Q;;;;;;;;;;;;;;gBACvC,OAAAsD,S;iBAAU,S;;;gBAGV,OAAA/lD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;gBAEA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AEzEL;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAOA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAoBA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAGA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3CM;;;;;AAGE;;;;;;AAIF;;;;AACc,0CAAmB,UAAnB,EAAmB,IAAnB;;;;;;AAuBd;AACE;AACF;;;;;AADE;AAAA;;;;;;AAaJ;;;;;AAAsE;;;;;;;;;;;;;;AAjExE;AACE;AAAA;AAAA;AAAA;AAAA;AAIA;AASE;AAAA;AAAA;AAAA;AAAA;AAED;AAGD;AACE;AAOA;AAGA;AAOE;AAAA;AAAA;AAAA,iBAAiB,OAAA8E,SAAA,iCAAjB;AAA2D,SAA3D;AAED;AACD;AACA;AAQE;AAAA;AAAA;AAAA,iBAAiB,QAAAA,SAAA,mCAAjB;AAA6D,SAA7D;AACD;AACD;AAGF;AAEA;AACE;AACE;AAI+B;AAAiB;AACpD;AAEA;AAEA;AAEA;AAOA;AAMA;AAEA;AACF;;;;;;;;;;;AAnFE;AAME;AAAA,wCAAiB,oBAAjB,EAAiB,IAAjB,EAAiB,SAAjB,EAAiB,cAAjB,EAAiB,iBAAjB,EAAiB,sBAAjB,EAAiB,YAAjB,EAAiB,IAAjB;AAiBE;AAAA;AAIkD;AAAA;AAIlD;AAAA,wCAAiB,YAAjB,EAAiB,iBAAjB,EAAiB,SAAjB,EAAiB,sCAAjB,EAAiB,gBAAjB,EAAiB,2BAAjB;AAOsB;AAAA,0CAAmB,UAAnB,EAAmB,IAAnB;AAKtB;AAAA,6EAA+C,UAA/C,EAA+C,IAA/C,EAA+C,SAA/C,EAA+C,wCAA/C,EAA+C,gBAA/C,EAA+C,2BAA/C;AAMG;AAAA;AAckB;AAAA;AAMvB;AAAA,wCAAiB,SAAjB,EAAiB,yBAAjB;AAOA;AAAA,wCAAiB,SAAjB,EAAiB,sBAAjB;;;;;;QDTOy8B,wB;;;;;AA4DT,wCAAoB7sE,KAApB,EACI;AACA6lD,WAFJ,EAEqCg6B,SAFrC,EAE6D;AAAA;;AAAA;;AACzD,uCAAMh6B,KAAN;AAHgB,iBAAA7lD,KAAA,GAAAA,KAAA;AAEiB,iBAAA6/E,SAAA,GAAAA,SAAA;AAzD9B,iBAAApd,UAAA,GAAa,IAAI,OAAA75B,YAAJ,EAAb;AAGA,iBAAAo4C,UAAA,GAAa,KAAb;AAKP;;;;AAIO,iBAAAC,YAAA,GAAe,IAAI,OAAAr4C,YAAJ,EAAf,CA6CsD,CA3C7D;;AACO,iBAAAs4C,QAAA,GAAmB,OAAA73F,iBAAA,CAAkB,QAAA4C,QAAA,CAASqkB,GAAT,EAAlB,EAAkC,EAAlC,EAAsCnkB,OAAtC,EAAnB,CA0CsD,CA1Cc;;AAC3E;;AACO,iBAAAu/C,UAAA,GAAqB,OAAA1hD,mBAAA,CAAoB,IAAI,UAAAwQ,MAAJ,CAAW;AAAElR,cAAI,EAAEJ,IAAI,CAAConB,GAAL,EAAR;AAAoBK,qBAAW,EAAE;AAAjC,SAAX,CAApB,EAA0E,EAA1E,CAArB;AACA,iBAAA3B,kBAAA,GAAqB,cAAAA,kBAArB;AACA,iBAAAE,eAAA,GAAkB,cAAAA,eAAlB;AACA,iBAAA04B,aAAA,GAAgB,UAAA70C,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB0nB,WAApC;AACA,iBAAAg7B,UAAA,GAAa,EAAb;AACA,iBAAAC,QAAA,GAAW,EAAX;AAEA,iBAAAuE,SAAA,GAAuB,IAAI,QAAA1pB,SAAJ,CAAc;AACxCnrB,YAAE,EAAE,IAAI,QAAA0oB,WAAJ,CAAgB,EAAhB,EAAoB,EAApB,CADoC;AAExCthB,kBAAQ,EAAE,IAAI,QAAAshB,WAAJ,CAAgB,EAAhB,EAAoB,CAAC,QAAAE,UAAA,CAAWC,QAAZ,CAApB,CAF8B;AAGxC96B,cAAI,EAAE,IAAI,QAAA26B,WAAJ,CAAgB,SAAKi9D,QAArB,EAA+B,CAAC,QAAA/8D,UAAA,CAAWC,QAAZ,CAA/B,CAHkC;AAIxCn6B,gBAAM,EAAE,IAAI,QAAAg6B,WAAJ,CAAgB,SAAKynB,UAArB,EAAiC,CAAC,QAAAvnB,UAAA,CAAWC,QAAZ,CAAjC,CAJgC;AAKxC/5B,kBAAQ,EAAE,IAAI,QAAA45B,WAAJ,CAAgB,cAAApV,wBAAhB,EAA0C,CAAC,QAAAsV,UAAA,CAAWC,QAAZ,CAA1C,CAL8B;AAMxC1W,qBAAW,EAAE,IAAI,QAAAuW,WAAJ,CAAgB,cAAAnV,yBAAhB,CAN2B;AAOxCO,kBAAQ,EAAE,IAAI,QAAA4U,WAAJ,CAAgB,cAAAhV,qBAAhB,CAP8B;AAQxCg0D,sBAAY,EAAE,IAAI,QAAAh/C,WAAJ,CAAgB,EAAhB,CAR0B;AASxC/1B,kBAAQ,EAAE,IAAI,QAAA+1B,WAAJ,CAAgB,EAAhB,CAT8B;AAUxCj3B,gBAAM,EAAE,IAAI,QAAAi3B,WAAJ,CAAgB,EAAhB,CAVgC;AAY9CnU,2BAAiB,EAAE,IAAI,QAAAmU,WAAJ,CAAgB,cAAA4B,gBAAA,CAAiBU,MAAjC,CAZ2B;AAaxCxW,6BAAmB,EAAE,IAAI,QAAAkU,WAAJ,CAAiB,CAAjB,CAbmB;AAcxCjU,0BAAgB,EAAE,IAAI,QAAAiU,WAAJ,CAAiB,IAAI,UAAAzpB,MAAJ,CAAW;AAAElR,gBAAI,EAAE;AAAR,WAAX,EAAwBa,QAAxB,CAAiC;AAACwwB,gBAAI,EAAE;AAAP,WAAjC,CAAjB,CAdsB;AAexC1K,0BAAgB,EAAE,IAAI,QAAAgU,WAAJ,CAAiB,CAAjB,CAfsB;AAgBxCpU,sBAAY,EAAE,IAAI,QAAAoU,WAAJ,CAAgB,IAAhB,CAhB0B;AAiBxC/T,2BAAiB,EAAE,IAAI,QAAA+T,WAAJ,CAAiB,EAAjB,CAjBqB;AAkBxC9T,+BAAqB,EAAE,IAAI,QAAA8T,WAAJ,CAAgB,EAAhB,CAlBiB;AAmBxCuC,4BAAkB,EAAE,IAAI,QAAAvC,WAAJ,CAAgB,cAAA4B,gBAAA,CAAiBU,MAAjC,CAnBoB;AAoBxCnW,yBAAe,EAAE,IAAI,QAAA6T,WAAJ,CAAiB,EAAjB,CApBuB;AAsBxC5T,gBAAM,EAAE,IAAI,QAAA4T,WAAJ,CAAgB,EAAhB,EAAoB,EAApB;AAtBgC,SAAd,CAAvB;AA2BA,iBAAA/X,OAAA,GAAU,IAAI,OAAAnnB,eAAJ,CAAyC,EAAzC,CAAV;AAEA,iBAAA6uB,eAAA,GAAkB,IAAI,OAAA7uB,eAAJ,CAAyC,EAAzC,CAAlB,CAIsD,CAEzD;AACA;AACA;AACA;AACA;;AANyD;AAO5D;;;;mCAEc;AAAA;;AAGX,iGAHW,CAIX;AACA;AAEA;AACA;;;AACA,eAAKsC,YAAL,CAAkB,WAAlB,EAA+B,KAAK2Y,KAAL,CAAWgC,MAAX,CAAkB,cAAA0O,gBAAlB,EAC1BtW,IAD0B,CACrB,YAAA+H,IAAA,CAAK,CAAL,CADqB,EAE1B5a,SAF0B,CAEhB,UAACkQ,IAAD,EAAuC;AAC9C,gBAAIA,IAAJ,EAAU;AACN;AACA,sBAAI,CAACi0C,UAAL,GAAkBj0C,IAAI,CAACoY,YAAL,GAAoBpY,IAAI,CAACxN,MAAzB,GAAkC,OAAAD,mBAAA,CAAoB,UAAA+I,OAAA,EAApB,EAA+B,EAA/B,CAApD,CAFM,CAEkF;;AAExF,kBAAM0S,IAAI,GAAG69D,SAAS,CAAC7rE,IAAD,CAAtB;;AACA,sBAAI,CAAC24C,SAAL,CAAe5D,UAAf,CAA0B,MAAD,OAAC,CAAD,EAAC,EACnB/mC,IADmB,CAA1B,EAEG;AAAE07E,yBAAS,EAAE;AAAb,eAFH,EALM,CASN;AACA;;AAEH;AACJ,WAhB0B,CAA/B,EATW,CA4BX;;AACA,eAAK95F,YAAL,CAAkB,aAAlB,EAAiC,KAAK+oD,SAAL,CAAelrB,YAAf,CAC5B9qB,IAD4B,CAEzB,YAAA4xC,IAAA,CAAK,CAAL,CAFyB,EAEhB;AACT,sBAAAC,oBAAA,EAHyB,EAI5B1kD,SAJ4B,CAIlB,UAACkQ,IAAD,EAAU;AACjB,gBAAMvJ,QAAQ,GAAGuJ,IAAI,CAACvJ,QAAL,IAAiB,QAAI,CAAC05C,aAAvC;AACA;;;;;AAIA,oBAAI,CAAC8D,UAAL,GAAkBj0C,IAAI,CAACoY,YAAL,GAAoBpY,IAAI,CAACxN,MAAzB,GAAkC,OAAAD,mBAAA,CAAoB,UAAA+I,OAAA,EAApB,EAA+B,EAA/B,CAApD;AAEA;;;;AAGA,oBAAI,CAACg5C,oBAAL,CAA0B79C,QAA1B;AAEH,WAjB4B,CAAjC;AAoBA,eAAK7G,YAAL,CAAkB,WAAlB,EAA+B,KAAK2Y,KAAL,CAAW5F,IAAX,CAC3B,QAAA4H,MAAA,CAAO,YAAA7D,qBAAP,CAD2B,EAE3B,QAAA6D,MAAA,CAAO,YAAAvD,kCAAP,CAF2B,EAG3B,YAAAtP,GAAA,CAAI,UAACukB,OAAD,EAA4C;AAC5C,mBAAO,cAAAD,qBAAA,CAAsBC,OAAtB,CAAP;AACH,WAFD,CAH2B,EAM3B,YAAAu4B,oBAAA,EAN2B,EAQ1B1kD,SAR0B,CAQhB,UAAAkQ,IAAI,EAAI;AACf,oBAAI,CAACyU,OAAL,CAAazU,IAAb,CAAkBA,IAAlB;AACH,WAV0B,CAA/B;AAWH;;;oCAEkBzQ,O,EAAc;AAC7B,cAAIA,OAAO,CAAC84F,aAAR,IAAyB,KAAKc,OAAlC,EAA2C;AACvC;AACA,iBAAKA,OAAL,CAAaC,QAAb,CAAsBt1F,SAAtB;AACH;AACJ;;;uCAEqB;;;AAClB,0BAAG,KAAK6kD,SAAL,CAAevb,QAAlB,MAA0B,IAA1B,IAA0B,aAA1B,GAA0B,MAA1B,GAA0B,GAAEhlB,YAA5B,MAAwC,IAAxC,IAAwC,aAAxC,GAAwC,MAAxC,GAAwC,GAAErjB,KAA1C,EAAgD;AAC5C,0BAAA0oC,uBAAA,CAAwB,KAAKkb,SAA7B;AACH,WAHiB,CAIlB;;;AACA,cAAMgxC,aAAa,GAAG,KAAKhxC,SAAL,CAAe5jD,KAArC;;AACA,cAAM60F,OAAO,GAAG,KAAKC,gBAAL,EAAhB;;AACA,cAAID,OAAJ,EAAa;AACT,iBAAKE,YAAL,CAAkB,sEAAlB,EAA0F,OAA1F;AACA;AACH,WAHD,MAGO;AACH,iBAAKnxC,SAAL,CAAelmD,QAAf,CAAwB,MAAD,OAAC,CAAD,kBAChBk3F,aADgB,CAAC,EACJ;AAChB93F,kBAAI,EAAE,OAAA8D,uBAAA,CAAwBg0F,aAAa,CAACn3F,MAAd,CAAqBgJ,EAA7C,CADU;AAEhBhJ,oBAAM,EAAEm3F,aAAa,CAACn3F,MAAd,CAAqBC,QAArB,CAA8B;AAAET,2BAAW,EAAE,CAAf;AAAkBC,sBAAM,EAAE;AAA1B,eAA9B;AAFQ,aADI,CAAxB;AAKH;;AACD,eAAK0mD,SAAL,CAAexC,gBAAf;;AACA,cAAI,KAAKwC,SAAL,CAAenjC,KAAnB,EAA0B;AACtB,iBAAKw1D,UAAL,CAAgBz4B,IAAhB,CAAqB,KAAKoG,SAAL,CAAe5jD,KAApC;AACH;AACJ;;;qCAEmByU,O,EAAiB1G,M,EAAgB;AACjD,eAAKslF,SAAL,CAAev+E,IAAf,CAAoBL,OAApB,EAA6B1G,MAA7B,EAAqC;AACjClQ,oBAAQ,EAAE,IADuB;AAEjCkX,sBAAU,EAAE,CAAC,iBAAD;AAFqB,WAArC;AAIH,S,CAED;;;;+BACcsS,M,EAA2B;AAAA;;AACrC;AACA,eAAKD,eAAL,CAAqBxZ,IAArB,CACI,YAAA+H,IAAA,CAAK,CAAL,CADJ,EAEI,YAAAovC,cAAA,CAAe,KAAKrlC,OAApB,CAFJ,EAGI,YAAA/c,GAAA,CAAI,kBAAgC;AAAA;AAAA,gBAA9BykB,eAA8B;AAAA,gBAAb1H,OAAa;;AAChC,mBAAO,cAAAyH,qBAAA,CAAsBzH,OAAtB,EAA+B0H,eAA/B,EAAgDC,MAAhD,CAAP;AACH,WAFD,CAHJ,EAMEtsB,SANF,CAMY,UAAAkQ,IAAI,EAAI;uCAAA,CAChB;;;AACA,gBAAM+pF,aAAa,GAAG,QAAI,CAACpxC,SAAL,CAAe5jD,KAArC;;AACA,gBAAI,CAACiL,IAAI,CAACjM,MAAV,EAAkB;AACd,sBAAI,CAAC4kD,SAAL,CAAelmD,QAAf,CAAwB,MAAD,OAAC,CAAD,kBAChB,QAAI,CAACkmD,SAAL,CAAe5jD,KADC,CAAC,EACG;AACvB0B,wBAAQ,EAAE,QAAI,CAAC05C,aADQ;AAEvBt+C,oBAAI,EAAEk4F,aAAa,CAACv3F,MAAd,CAAqBgJ,EAFJ;AAGvBhJ,sBAAM,EAAEu3F,aAAa,CAACv3F,MAAd,CAAqByJ,MAArB,CAA4B,QAAI,CAACk0C,aAAjC;AAHe,eADH,CAAxB;AAMH,aAPD,MAOO;AACH,kBAAMN,gBAAgB,GAAG,mBAAA7vC,IAAI,CAAC,CAAD,CAAJ,MAAO,IAAP,IAAO,aAAP,GAAO,MAAP,GAAO,GAAE4W,IAAT,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAE1B,QAAf,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAEze,QAAzB,MAAiC,kBAAIuJ,IAAI,CAAC,CAAD,CAAR,MAAW,IAAX,IAAW,aAAX,GAAW,MAAX,GAAW,GAAE4W,IAAb,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEtP,IAAnB,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAE7Q,QAA1D,CAAzB;;AACA,sBAAI,CAACkiD,SAAL,CAAelmD,QAAf,CAAwB,MAAD,OAAC,CAAD,kBAChB,QAAI,CAACkmD,SAAL,CAAe5jD,KADC,CAAC,EACG;AACvB0B,wBAAQ,EAAEo5C,gBADa;AAEvBh+C,oBAAI,EAAEk4F,aAAa,CAACv3F,MAAd,CAAqBgJ,EAFJ;AAGvBhJ,sBAAM,EAAEu3F,aAAa,CAACv3F,MAAd,CAAqByJ,MAArB,CAA4B4zC,gBAA5B;AAHe,eADH,CAAxB;AAMH;;AACD,oBAAI,CAACg6C,gBAAL,GAnBgB,CAoBhB;;;AACA,oBAAI,CAAC1tE,eAAL,CAAqBnc,IAArB,CAA0BA,IAA1B;AACH,WA5BD;AA6BH;;;2CAE0B;AACvB;AACA,cAAM2pF,aAAa,GAAG,KAAKhxC,SAAL,CAAe5jD,KAArC;AACA,cAAMlD,IAAI,GAAG,IAAI,UAAAkR,MAAJ,CAAW;AAAElR,gBAAI,EAAE,KAAK8mD,SAAL,CAAe5jD,KAAf,CAAqBvC,MAArB,CAA4BgJ,EAApC;AAAwC2d,uBAAW,EAAEwwE,aAAa,CAAClzF,QAAnE;AAA6EyiB,uBAAW,EAAC;AAAzF,WAAX,EAA6GxmB,QAA7G,CAAsH;AAAE6Q,mBAAO,EAAE;AAAX,WAAtH,CAAb;AACA,cAAMsV,GAAG,GAAG,UAAAvd,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAZ;;AACA,cAAIonB,GAAG,CAACuR,WAAJ,CAAgBv4B,IAAhB,CAAJ,EAA2B;AACvB;AACA,gBAAMm4F,SAAS,GAAG,OAAAz3F,mBAAA,CAAoB,IAAI,UAAAwQ,MAAJ,CAAW;AAAElR,kBAAI,EAAEJ,IAAI,CAAConB,GAAL,EAAR;AAAoBK,yBAAW,EAAE,KAAjC;AAAwCC,yBAAW,EAAEwwE,aAAa,CAAClzF;AAAnE,aAAX,EAA0F/D,QAA1F,CAAmG;AAAEJ,qBAAO,EAAE;AAAX,aAAnG,CAApB,EAAwI,EAAxI,CAAlB;AACA,gBAAM23F,aAAa,GAAGD,SAAS,CAAC1mF,aAAV,CAAwB;AAAChR,qBAAO,EAAE;AAAV,aAAxB,CAAtB;AACA,gBAAM43F,UAAU,GAAGD,aAAa,CAACv3F,QAAd,CAAuB;AAAE6Q,qBAAO,EAAE;AAAX,aAAvB,CAAnB,CAJuB,CAKvB;;AACA,gBAAGsV,GAAG,CAACuR,WAAJ,CAAgB8/D,UAAhB,CAAH,EAA+B;AAC3B,mBAAKj2C,UAAL,GAAkB+1C,SAAlB;AACH,aAFD,MAEK;AACD,mBAAK/1C,UAAL,GAAkBg2C,aAAlB;AACH;;AAED,iBAAKtxC,SAAL,CAAelmD,QAAf,CAAwB,MAAD,OAAC,CAAD,kBAChBk3F,aADgB,CAAC,EACJ;AAChB93F,kBAAI,EAAE,OAAA8D,uBAAA,CAAwB,KAAKs+C,UAAL,CAAgBz4C,EAAxC,CADU;AAEhBhJ,oBAAM,EAAE,KAAKyhD,UAAL,CAAgBxhD,QAAhB,CAAyB;AAAET,2BAAW,EAAE,CAAf;AAAkBC,sBAAM,EAAE;AAA1B,eAAzB;AAFQ,aADI,CAAxB;AAKA,mBAAO,IAAP;AACH;;AACD,iBAAO,KAAP;AACH;;;6CAE4BwE,Q,EAAkB;AAC3C;AACA,cAAM4+C,aAAa,GAAG,QAAA7gD,QAAA,CAASqkB,GAAT,GAAeirB,OAAf,CAAuB,KAAKqM,aAA5B,EAA2C56C,MAAjE;AACA,cAAM+/C,gBAAgB,GAAG,QAAA9gD,QAAA,CAASqkB,GAAT,GAAeirB,OAAf,CAAuBrtC,QAAvB,EAAiClB,MAA1D;AAEA,eAAK0+C,UAAL,GAAkB,IAAI,UAAAlxC,MAAJ,CAAW;AAAElR,gBAAI,EAAE,KAAKoiD,UAAL,CAAgBz4C,EAAxB;AAA4B0d,uBAAW,EAAE,KAAzC;AAAgDC,uBAAW,EAAE1iB;AAA7D,WAAX,CAAlB;;AAEA,cAAI4+C,aAAa,KAAKC,gBAAtB,EAAwC;AACpC,gBAAM/hD,SAAS,GAAG,KAAKolD,SAAL,CAAe5jD,KAAf,CAAqBvC,MAArB,CAA4By7B,KAA5B,EAAlB;AACA,iBAAKkmB,UAAL,GAAkB5gD,SAAS,CAACuJ,eAAV,CAA0B,OAA1B,CAAlB;AACA,iBAAKs3C,QAAL,GAAgB7gD,SAAS,CAACb,QAAV,CAAmB;AAAEJ,qBAAO,EAAE,KAAKqmD,SAAL,CAAe5jD,KAAf,CAAqBnC;AAAhC,aAAnB,EAA+DkK,eAA/D,CAA+E,OAA/E,CAAhB;AACH,WAJD,MAIO;AACH;AACA,iBAAKq3C,UAAL,GAAkB,EAAlB;AACA,iBAAKC,QAAL,GAAgB,EAAhB;AACH;AACJ;;;;MAvPyC,KAAA+Z,qB;;AAL9C;;;uBAKainB,wB,EAAwB,8B,EAAA,yC,EAAA,oC;AAAA,K;;;YAAxBA,wB;AAAwB,4C;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;ACtErC;;;;;;;;;2BDsEaA,wB,EAAwB;cALpC,OAAA1hC,SAKoC;eAL1B;AACPjlD,kBAAQ,EAAE,uBADH;AAEPklD,qBAAW,EAAE,oCAFN;AAGPC,mBAAS,EAAE,CAAC,oCAAD;AAHJ,S;AAK0B,Q;;;;;;;;;;gBAChC,OAAAsD,S;iBAAU,S;;;gBAGV,OAAArD;;;gBAGA,OAAA1iD;;;gBAGA,OAAAA;;;gBAMA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AEtFL;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;6EACA;;;QA4Ba69B,yB;;;;;AAGT,yCACYnpE,KADZ,EAEYytB,SAFZ,EAGqCqE,KAHrC,EAG+C;AAAA;;AAAA;;AAC3C;AAHQ,iBAAA9xB,KAAA,GAAAA,KAAA;AACA,iBAAAytB,SAAA,GAAAA,SAAA;AACyB,iBAAAqE,KAAA,GAAAA,KAAA;AAL9B,iBAAAhuC,OAAA,GAAUoF,IAAI,EAAd;AAKwC;AAE9C;;;;wCAEsB;AACnB,eAAKpF,OAAL,GAAeoF,IAAI,EAAnB;AACH;;;mCAEiBuO,I,EAAuB;AACrC;;;AAEA,cAAM4Y,MAAM,GAAG,YAAKyhB,KAAL,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAEv3B,MAAZ,MAAuB,cAAAwW,YAAA,CAAaC,IAApC,GAA2CvZ,IAAI,CAAC8D,EAAhD,GAAqD,IAApE;AACA,cAAMiS,QAAQ,GAAG,YAAKskB,KAAL,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAEv3B,MAAZ,MAAuB,cAAAwW,YAAA,CAAaC,IAApC,IAA4C,IAA7D;AAEA,eAAKhR,KAAL,CAAW4hE,QAAX,CAAoB,cAAApkE,oBAAA,CAAqB;AACrCE,mBAAO,EAAE,MAAF,OAAE,CAAF,kBACAjG,IADA,CAAE,EACE;AACP4Y,oBAAM,EAANA,MADO;AAEP7C,sBAAQ,EAARA,QAFO;AAGPjT,oBAAM,EAAE,YAAKu3B,KAAL,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAEv3B,MAAZ,KAAsB,EAHvB,CAG0B;;AAH1B,aADF;AAD4B,WAArB,CAApB;AAQA,eAAKmzB,KAAL,CAAW,sBAAX,EAdqC,CAcD;;AACpC,eAAKoE,KAAL,IAAc,KAAKA,KAAL,CAAWs3C,UAAzB,IAAuC,KAAKt3C,KAAL,CAAWs3C,UAAX,EAAvC,CAfqC,CAe2B;AAEnE;;;gCAE+B;AAAA,cAAnBZ,IAAmB,uEAAJ,EAAI;AAC5B,eAAK/6C,SAAL,CAAeC,KAAf,CAAqB86C,IAArB;AACH;;;;MAnC0C,OAAAziF,a;;AA1B/C;;;uBA0BaojF,yB,EAAyB,8B,EAAA,qC,EAAA,qBAMtB,SAAAj+B,eANsB,C;AAMP,K;;;YANlBi+B,yB;AAAyB,6C;AAAA,+C;AAAA,c;AAAA,a;AAAA,0S;AAAA;AAAA;;;AAvB9B;AACA;AACI;AAII;AAAA,mBAAc,IAAA1G,UAAA,QAAd;AAAgC,WAAhC,EAAiC,cAAjC,EAAiC;AAAA,mBACjB,IAAA/0C,KAAA,EADiB;AACV,WADvB;AAEJ;AACJ;AACA;AACI;AAEI;AAAA,mBAAiB,IAAAoyD,aAAA,EAAjB;AAAgC,WAAhC,EAAiC,iBAAjC,EAAiC;AAAA;;AAAA;;AAAA,mBAEd,uBAFc;AAEqB,WAFtD;AAGJ;AACJ;AACA;;;;;;AAdQ;AAAA,4CAAmB,eAAnB,EAAmB,WAAnB;AAUA;AAAA;;;;;;;;;;2BASH3W,yB,EAAyB;cA1BrC,OAAAh+B,SA0BqC;eA1B3B;AACPjlD,kBAAQ,EAAE,wBADH;AAEPuxD,kBAAQ,k2BAFD;AAuBPpM,mBAAS,EAAE,CAAC,qCAAD,CAvBJ;AAwBPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AAxB1B,S;AA0B2B,Q;;;;;;;;kBAM7B,OAAA0pB,M;mBAAO,SAAA+S,e;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvChB;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAgBA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAIA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCgC;AACI;AACA;AAAK;AAA6B;AACtC;;;;;;;;AAEI;AAMI;AAAA;AAAA;AAAA;AAAA;AAAA;AACJ;;;;;;;AALI,qCAAc,WAAd,EAAc,YAAd,EAAc,UAAd,EAAc,uBAAd,EAAc,OAAd,EAAc,IAAd;;;;;;AAHR;AACI;AAQJ;;;;;AAPQ;AAAA;;;;;;AAPZ;AACI;AAIA;AAUJ;;;;;AAdoB;AAAA;AAIX;AAAA;;;;;;AAYL;;;;AAAyB;;;;;;;;;;AAAzB;;;;AAAwC;;;;QAmB3D8gC,oB;;;;;AAwBT,oCAAoBhsE,KAApB,EACoBq6D,MADpB,EAEoBl3D,KAFpB,EAGoBwV,SAHpB,EAIoBgrD,MAJpB,EAIuC;AAAA;;AAAA;;AACnC;AALgB,iBAAA3jE,KAAA,GAAAA,KAAA;AACA,iBAAAq6D,MAAA,GAAAA,MAAA;AACA,iBAAAl3D,KAAA,GAAAA,KAAA;AACA,iBAAAwV,SAAA,GAAAA,SAAA;AACA,iBAAAgrD,MAAA,GAAAA,MAAA;AA3Bb,iBAAAlK,gBAAA,GAAmB,0BAAAA,gBAAnB;AACA,iBAAArZ,SAAA,GAAY,KAAAA,SAAZ;AAEA,iBAAA9V,KAAA,GAAQ,EAAR,CAwBgC,CAtBvC;;AACO,iBAAAqjC,YAAA,GAAe,KAAf;AACA,iBAAAiU,iBAAA,GAAoB,KAApB;AACA,iBAAAC,iBAAA,GAAoB,KAApB;AACA,iBAAAC,iBAAA,GAAoB,KAApB;AAGA,iBAAAC,sBAAA,GAAyB,IAAI,OAAAh9F,eAAJ,CAAmD,UAAA4X,YAAA,CAAaC,KAAb,EAAnD,CAAzB;AACA,iBAAAolF,kBAAA,GAAqB,IAAI,OAAAj9F,eAAJ,CAAmD,UAAA4X,YAAA,CAAaC,KAAb,EAAnD,CAArB;AAEA,iBAAAwB,SAAA,GAAY,IAAI,OAAArZ,eAAJ,CAAyC,EAAzC,CAAZ;AACA,iBAAA6oF,SAAA,GAAY,KAAZ;AAaH,iBAAKhJ,UAAL,GAAkB,OAAApwE,wBAAA,CAAyB,UAAAzB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,CAAzB,CAAlB;AAFmC;AAGtC;;;;sCAEoB;AACjB,cAAI,OAAO2F,MAAP,KAAkB,QAAtB,EAAgC;AAC5BA,kBAAM,CAACozF,cAAP,GAAwB12F,SAAxB;AACH,WAHgB,CAIrB;;;AACA,eAAKpG,aAAL,CAAmB,iBAAnB;AACC;;;mCAEc;AAAA;;AACX;AACA,cAAI,OAAO0J,MAAP,KAAkB,QAAtB,EAAgC;AAC5BA,kBAAM,CAACozF,cAAP,GAAwB,UAACjrF,KAAD,EAAW;AAC/B,kBAAMrD,CAAC,GAAGqD,KAAK,IAAInI,MAAM,CAACmI,KAA1B;;AACA,sBAAI,CAACgJ,KAAL,CAAW4hE,QAAX,CAAoB,cAAAjkE,oBAAA,EAApB;;AACA,qBAAOhK,CAAP;AACD,aAJH;AAKH;;AAED,eAAKqM,KAAL,CAAW4hE,QAAX,CAAoB,eAAAniE,iBAAA,CAAkB/D,OAAlB,EAApB;AAEA,eAAKrU,YAAL,CAAkB,WAAlB,EAA+B,KAAK2Y,KAAL,CAAW5F,IAAX,CAC3B,QAAA4H,MAAA,CAAO,YAAA7D,qBAAP,CAD2B,EAE3B,QAAA6D,MAAA,CAAO,YAAAvD,kCAAP,CAF2B,EAG3B,YAAAtP,GAAA,CAAI,UAACukB,OAAD,EAA4C;AAC5C,mBAAO,cAAAD,qBAAA,CAAsBC,OAAtB,CAAP;AACH,WAFD,CAH2B,EAM3B,YAAAu4B,oBAAA,EAN2B,EAO7B1kD,SAP6B,CAOnB,UAAAkQ,IAAI,EAAI;AAChB,oBAAI,CAAC2G,SAAL,CAAe3G,IAAf,CAAoBA,IAApB,EADgB,CAEhB;AACA;;AACH,WAX8B,CAA/B;AAaA,eAAKpQ,YAAL,CAAkB,aAAlB,EAAiC,KAAK2Y,KAAL,CAAWgC,MAAX,CAAkB,OAAAC,iBAAlB,EAChC7H,IADgC,CAC3B,YAAA+H,IAAA,CAAK,CAAL,CAD2B,EAEhC5a,SAFgC,CAEtB,UAAC2a,IAAD,EAAgB;AACnB;AACA,oBAAI,CAAC0J,WAAL,GAAmB,IAAI,cAAA0R,IAAJ,CAASpb,IAAT,CAAnB;;AACA,oBAAI,CAAClC,KAAL,CAAW4hE,QAAX,CAAoB,WAAAtoE,qBAAA,CAAsB;AAAE,uBAAS,QAAI,CAACsS,WAAL,CAAiBlR,KAA5B;AAAmC,sBAAQ,UAAA3H,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAA/D;AAAmE,wBAAU;AAA7E,aAAtB,CAApB,EAHmB,CAInB;AACA;AACA;AACA;AACA;AACA;;;AACI,oBAAI,CAACgoB,QAAL,CAAc,iBAAd,EAAiC,YAAM;AAChD,sBAAI,CAACsuD,OAAL,CAAa,UAAb;AACA,aAFS,EAEP,KAAK,IAFE,EAVe,CAanB;;AAEH,WAjB4B,CAAjC;AAoBA,eAAKliF,YAAL,CAAkB,iBAAlB,EAAqC,KAAK2Y,KAAL,CAAW5F,IAAX,CACjC,QAAA4H,MAAA,CAAO,cAAAoQ,sCAAP,CADiC,EAEnC7qB,SAFmC,CAEzB,UAAAkQ,IAAI,EAAI;AAChB,oBAAI,CAACsqF,sBAAL,CAA4BtqF,IAA5B,CAAiCA,IAAjC;;AACA,gBAAI,CAACA,IAAI,CAAC6jD,OAAL,EAAD,IAAmB7jD,IAAI,CAACiH,OAAxB,IAAmCrI,KAAK,CAACsB,OAAN,CAAcF,IAAI,CAACiH,OAAL,CAAa5N,OAA3B,CAAnC,IAA0E2G,IAAI,CAACiH,OAAL,CAAawuB,KAA3F,EAAkG;AAC9F,sBAAI,CAAC0gD,SAAL,GAAiB,KAAjB;AACA,sBAAI,CAACgU,iBAAL,GAAyB,IAAzB;AACA,sBAAI,CAACM,gBAAL,GAAwB,4BAAA/pE,sBAAA,CAAuB1gB,IAAI,CAACiH,OAAL,CAAa5N,OAApC,EAA6CZ,MAA7C,CAAoD,UAAAwB,CAAC;AAAA,uBAAI,EAAEA,CAAC,CAACuM,OAAF,CAAU4R,YAAV,IAA0Bne,CAAC,CAACuM,OAAF,CAAUmZ,eAAV,KAA8B,QAA1D,CAAJ;AAAA,eAArD,CAAxB;AACA,sBAAI,CAACq3D,WAAL,GAAmBh3E,IAAI,CAACiH,OAAL,CAAa5N,OAAhC;;AAEA,kBAAI,QAAI,CAACoxF,gBAAL,CAAsB12F,MAA1B,EAAkC;AAC9B,wBAAI,CAACmiF,YAAL,GAAoB,IAApB;AACH;AACJ,aATD,MASO;AACH,sBAAI,CAACC,SAAL,GAAiB,KAAjB;AACA,sBAAI,CAACgU,iBAAL,GAAyB,KAAzB;AACA,sBAAI,CAACM,gBAAL,GAAwB,EAAxB;AACA,sBAAI,CAACvU,YAAL,GAAoB,KAApB;AACH;AACJ,WAnBoC,CAArC;AAqBA,eAAKtmF,YAAL,CAAkB,aAAlB,EAAiC,KAAK2Y,KAAL,CAAW5F,IAAX,CAC7B,QAAA4H,MAAA,CAAO,cAAAsQ,kCAAP,CAD6B,EAE/B/qB,SAF+B,CAErB,UAAAkQ,IAAI,EAAI;;;AAChB,gBAAI,CAACA,IAAI,CAAC6jD,OAAL,EAAD,KAAe,MAAI7jD,IAAI,CAAC+G,eAAT,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,GAAE0uB,KAAzC,CAAJ,EAAoD;AAChD,sBAAI,CAAC20D,iBAAL,GAAyB,IAAzB;AACH;AACJ,WANgC,CAAjC;AAQA,eAAKx6F,YAAL,CAAkB,kBAAlB,EAAsC,KAAK2Y,KAAL,CAAW5F,IAAX,CAClC,QAAA4H,MAAA,CAAO,cAAAuQ,uCAAP,CADkC,EAEpChrB,SAFoC,CAE1B,UAAAkQ,IAAI,EAAI;;;AAChB,gBAAI,CAACA,IAAI,CAAC6jD,OAAL,EAAD,KAAe,MAAI7jD,IAAI,CAAC+G,eAAT,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,GAAE0uB,KAAzC,CAAJ,EAAoD;AAChD,sBAAI,CAAC40D,iBAAL,GAAyB,IAAzB;AACH;AACJ,WANqC,CAAtC;AAOH;;;sCAEoB;AACjB;AACA,iBAAO,KAAKlU,SAAL,IAAkB,KAAKmU,sBAAL,CAA4Bv1F,KAA5B,CAAkCivD,SAAlC,EAAzB;AACH;;;oCAEkBx9C,O,EAAkB;;;AACjC,cAAI,KAAKG,SAAL,IAAkBH,OAAO,CAACwf,aAA9B,EAA6C;AACzC,mBAAO,CAAP,KAAO,KAAKrf,SAAL,CAAe5R,KAAf,CAAqBM,IAArB,CAA0B,UAAA4E,CAAC;AAAA,qBAAIuM,OAAO,CAACwf,aAAR,KAA0B/rB,CAAC,CAAClF,KAAhC;AAAA,aAA3B,OAAiE,IAAjE,IAAiE,aAAjE,GAAiE,MAAjE,GAAiE,GAAE6hB,IAAF,CAAO1B,QAA/E;AACH;;AACD,iBAAO,EAAP;AACH,S,CAED;AACA;AACA;;;;oCAEmB;AACf9d,gBAAM,CAACyS,IAAP,CAAY,OAAAmgE,IAAA,CAAK0gB,SAAjB;AACH;;;uCAEqB1qF,I,EAAuB;AACzC,eAAKuI,KAAL,CAAW4hE,QAAX,CAAoB,cAAApkE,oBAAA,CAAqB;AACrCE,mBAAO,EAAE,MAAF,OAAE,CAAF,EAAE,EACFjG,IADE;AAD4B,WAArB,CAApB;AAKA,eAAKuI,KAAL,CAAW4hE,QAAX,CAAoB,QAAApwD,mBAAA,CAAoB2oC,KAApB,EAApB;AACA,eAAKkgB,MAAL,CAAYj9B,QAAZ,CAAqB,CAAC,SAAD,CAArB,EAAkC;AAAEksC,sBAAU,EAAE,KAAKnmE;AAAnB,WAAlC;AACH;;;gDAE8B;AAC3B,eAAKk3D,MAAL,CAAYj9B,QAAZ,CAAqB,CAAC,QAAD,CAArB,EAAiC;AAAEksC,sBAAU,EAAE,KAAKnmE;AAAnB,WAAjC;AACH;;;gCAEc1H,M,EAAgB;;;AAC3B,cAAI,QAAC,KAAKmQ,WAAN,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAElR,KAAnB,CAAJ,EAA8B;AAC1B;AACH,WAH0B,CAK3B;;;AACA,eAAKsF,KAAL,CAAW4hE,QAAX,CAAoB,WAAAtoE,qBAAA,CAAsB;AAAE,qBAAS,KAAKsS,WAAL,CAAiBlR,KAA5B;AAAmC,oBAAQ,UAAA3H,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB+J,EAA/D;AAAmEwI,kBAAM,EAANA;AAAnE,WAAtB,CAApB;AACH;AAGH;;;;;;;;;;;;oCAS2B8vE,S,EAAoC;;;;;;;;;;;yBAI3DA,SAAS,CAACttE,OAAV,CAAkB4R,Y;;;;;AACf5R,2B,GAAU,KAAKwwE,WAAL,CAAiB3hF,IAAjB,CAAsB,UAAA2qB,GAAG;AAAA,6BAAIA,GAAG,CAAClc,EAAJ,KAAWgwE,SAAS,CAACttE,OAAV,CAAkB2Z,oBAA7B,IAAqDH,GAAG,CAACL,eAAJ,KAAwB,SAAjF;AAAA,qBAAzB,C;;wBACTnZ,O;;;;;;AACO,2BAAM,KAAK0a,SAAL,CAAe4D,IAAf,CAAoBgvD,SAAS,CAACttE,OAAV,CAAkB2Z,oBAAtC,CAAN;;;AAAV3Z,2B;;;AAEF,yBAAK2rC,cAAL,GAAsB,4BAAAzxB,sBAAA,CAAuB,CAACla,OAAD,CAAvB,EAAkC,CAAlC,CAAtB;;;AAGF;AACMyrE,8B,GAAa,KAAK/F,MAAL,CAAYriE,IAAZ,CAAiB,kCAAAmkE,4BAAjB,EAA+C;AAChElkE,gCAAU,EAAE,+BADoD;AAEhE1B,0BAAI,EAAE;AACJ5B,+BAAO,EAAEstE,SAAS,CAACttE,OADf;AAEJ0O,gCAAQ,EAAE,KAAKgiE,WAAL,CAAiBpD,SAAS,CAACttE,OAA3B,CAFN;AAGJ2rC,sCAAc,EAAE,YAAKA,cAAL,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAE3rC,OAArB,KAAgC,IAH5C;AAIJsrE,+BAAO,EAAE,mBAAM;AACb,kCAAI,CAACA,OAAL,CAAa,UAAb,EADa,CACa;;AAC3B;AANG,uBAF0D;AAUhEt4B,+BAAS,EAAE,KAVqD;AAWhEC,mCAAa,EAAE;AAXiD,qBAA/C,C;AAcnBw4B,8BAAU,CAAC7+B,WAAX,GAAyBtjD,SAAzB,CAAmC,UAACihF,IAAD,EAAU;AAC5C;AACCA,0BAAI,KAAK,sBAAT,IAAmC,QAAI,CAACS,sBAAL,EAAnC;AACD,qBAHD;;;;;;;;;AAIE;AAEH;;;;;;;;;;iDAOkC;AAC5B,eAAKjpE,KAAL,CAAW4hE,QAAX,CAAoB,cAAAjkE,oBAAA,EAApB;AACA,eAAKqC,KAAL,CAAW4hE,QAAX,CAAoB,QAAApwD,mBAAA,CAAoB2oC,KAApB,EAApB;AACH;;;;MA5NqC,OAAAp0D,a;;AAvE1C;;;uBAuEaimF,oB,EAAoB,8B,EAAA,+B,EAAA,uC,EAAA,wC,EAAA,kC;AAAA,K;;;YAApBA,oB;AAAoB,uC;AAAA,+C;AAAA,e;AAAA,a;AAAA,spC;AAAA;AAAA;;;AApEzB;AACI;AACI;AAGJ;AACA;AACI;AACI;AACI;AAAoB;AAAoB;AACxC;AACI;AACJ;AACJ;AACJ;AACA;AACI;AACI;AAEI;AAAA,mBAAc,IAAAoW,cAAA,QAAd;AAAoC,WAApC;AACA;AAII;AAAA;;AAAA;;AAAA,mBAAmB,uBAAnB;AAAsD,WAAtD;AAEJ;AACJ;AACJ;AACA;AACI;AACI;AAAI;AAAa;AACjB;AAgBA;AAIJ;AACA;AACG;AAGC;AAAA,mBAAS,IAAAC,qBAAA,EAAT;AAAgC,WAAhC;AAEA;AAAM;AACV;AACJ;AACJ;AACJ;AACJ;;;;;;;;AA7DY;AAAA;AAoBY;AAAA,0EAA6D,cAA7D,EAA6D,IAA7D;AASC;AAAA,mDAA0C,UAA1C,EAA0C,GAA1C;AAwBL;AAAA;;;;;;;;;2BAYfrW,oB,EAAoB;cAvEhC,OAAA7gC,SAuEgC;eAvEtB;AACPjlD,kBAAQ,EAAE,kBADH;AAEPuxD,kBAAQ,4sHAFD;AAqEPpM,mBAAS,EAAE,CAAC,+BAAD;AArEJ,S;AAuEsB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3IjC;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAqBA;AAAA;AAAA;;AAOA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnCI;AACI;AACA;AAAuB;AAAmE;AAC1F;AAAsC;AAAA;AAAA;AAAA;AAAA;AAAtC;AACJ;;;;;;AACA;AACI;AACA;AAAwB;AAAwE;AACpG;;;;;;AAGQ;;;;;AACI,6DAA+B,UAA/B,EAA+B,yBAA/B;;;;;;AAuBoB;AACI;AACJ;;;;;AADI;AAAA;;;;;;AALZ;AACI;AACA;AACA;AACI;AAGJ;AACJ;;;;;AAJY;AAAA;;;;;;AAMhB;AACI;AACA;AACA;AACI;AAAI;AAAY;AAChB;AAAI;AAAoC;AAC5C;AACJ;;;;;AAHY;AAAA;;;;;;;;AAUZ;AAYI;AAAA;AAAA;AAAA;AAAA,WAAyC,cAAzC,EAAyC;AAAA;AAAA;AAAA;AAAA,SAAzC,EAAyC,wBAAzC,EAAyC;AAAA;AAAA;AAAA;AAAA,SAAzC,EAAyC,qBAAzC,EAAyC;AAAA;AAAA;AAAA;AAAA,SAAzC;AAIH;;;;;AAdG,wFAAyD,UAAzD,EAAyD,yBAAzD,EAAyD,UAAzD,EAAyD,mDAAzD,EAAyD,gBAAzD,EAAyD,eAAzD,EAAyD,aAAzD,EAAyD,mBAAzD,EAAyD,QAAzD,EAAyD,6DAAzD,EAAyD,UAAzD,EAAyD,+DAAzD,EAAyD,UAAzD,EAAyD,4BAAzD,EAAyD,OAAzD,EAAyD,gDAAzD,EAAyD,OAAzD,EAAyD,YAAzD;;;;;;;;AALR;AACI;AAAI;AAAkB;AACtB;AAAG;AAAc;AACjB;AAiBA;AACI;AAEQ;AAAA;AAAA;AAAA,4CAA4B,IAA5B;AAAgC,SAAhC;AACJ;AACJ;AACJ;AACJ;;;;;AAzBO;AAAA;AAEC;AAAA;;;;;;AA6DZ;AACI;AAAK;AAAoB;AACzB;AAAK;AAAoB;AAC7B;;;;;AAHsB;AACb;AAAA;AACA;AAAA;;;;;;;;AAKD;AAAsD;AAAA;AAAA;AAAA;AAAA;AAA8C;AACrC;;;;;;AADqC;AAAA;;;;;;AAH5G;AACI;AAAgC;;AAE5B;AAEJ;AACA;AAAK;AAA0B;AAC/B;AAAK;AAA2B;AAChC;AAAK;AAAoB;AAC7B;;;;;;;AATsB;AACc;AAAA;AAEtB;AAAA;AAGL;AAAA;AACA;AAAA;AACA;AAAA;;;;ADnFzB,QAAM9S,WAAW,GAAG,EAApB;;QAOaszC,oB;;;;;AA6CT,oCACY7rE,KADZ,EAEYq6D,MAFZ,EAGYhiD,IAHZ,EAIWsrD,MAJX,EAI4B;AAAA;;AAAA;;;;AAExB;AALQ,iBAAA3jE,KAAA,GAAAA,KAAA;AACA,iBAAAq6D,MAAA,GAAAA,MAAA;AACA,iBAAAhiD,IAAA,GAAAA,IAAA;AACD,iBAAAsrD,MAAA,GAAAA,MAAA;AAhDJ,iBAAAlK,gBAAA,GAAmB,0BAAAA,gBAAnB,CAgDqB,CA9C5B;;AACO,iBAAAC,SAAA,GAA0B;AAC7Bv2D,eAAK,EAAE,CAAC,OAAD,EAAU,SAAV,CADsB;AAE7B+mC,qBAAW,EAAE;AAAE30C,mBAAO,EAAE;AAAX;AAFgB,SAA1B;AAKA,iBAAAsK,IAAA,GAAO,IAAI,OAAA9a,eAAJ,CAAiDwG,SAAjD,CAAP;AACA,iBAAAq6E,WAAA,GAAc,IAAI,OAAA7gF,eAAJ,CAAqCwG,SAArC,CAAd;AACA,iBAAA+V,IAAA,GAAgB,IAAhB,CAsCqB,CArC5B;;AACO,iBAAA0T,aAAA,GAAgB,mBAAhB,CAoCqB,CAnC5B;;AACO,iBAAAmuB,MAAA,GAAkB,KAAlB;AACA,iBAAAuiC,gBAAA,GAA4B,KAA5B;AACA,iBAAAG,oBAAA,GAAgC,KAAhC,CAgCqB,CA/B5B;;AACO,iBAAAiE,0BAAA,GAAqC,IAAI,UAAAtvE,MAAJ,EAArC;AAGP;;AACO,iBAAAsrE,cAAA,GAA0B,IAA1B;AAQP;;AACQ,iBAAAwc,gBAAA,GAA4B,KAA5B;AAMD,iBAAA3oB,YAAA,GAA2B,EAA3B;AACP;;AACO,iBAAA4oB,WAAA,GAAsB,EAAtB;AAEP;;AACO,iBAAAC,qBAAA,GAAgC,EAAhC;AASH;;;;;AAIA,YAAK,SAAKnoB,MAAL,CAAYooB,oBAAZ,OAAuC,IAAvC,KAA2C,YAAI,SAAKpoB,MAAL,CAAYooB,oBAAZ,GAAmCzyD,MAAvC,MAA6C,IAA7C,IAA6C,aAA7C,GAA6C,MAA7C,GAA6C,GAAE3rC,KAA/C,MAAoD,IAApD,IAAoD,aAApD,GAAoD,MAApD,GAAoD,GAAEqZ,OAAjG,CAAL,EAAgH;AACnH,mBAAKsC,KAAL,CAAW4hE,QAAX,CAAoB,cAAApkE,oBAAA,CAAqB;AACvCE,mBAAO,EAAE,SAAK28D,MAAL,CAAYooB,oBAAZ,GAAmCzyD,MAAnC,CAA0C3rC,KAA1C,CAAgDqZ;AADlB,WAArB,CAApB;AAII;;AAZuB;AAa3B;;;;mCAEc;AAAA;;AACX,eAAKglF,kBAAL,GAA0B,aAA1B;AACA,eAAK/oB,YAAL,GAAoB,KAAKthD,IAAL,CAAUja,SAA9B;AAEA,eAAK/W,YAAL,CACI,aADJ,EAEI,KAAK2Y,KAAL,CACKgC,MADL,CACY,OAAAC,iBADZ,EAEK7H,IAFL,CAEU,YAAA+H,IAAA,CAAK,CAAL,CAFV,EAGK5a,SAHL,CAGe,UAAC2a,IAAD,EAA4B;AACnC;AACA,oBAAI,CAAC0J,WAAL,GAAmB,IAAI,cAAA0R,IAAJ,CAASpb,IAAT,CAAnB;AACH,WANL,CAFJ;AAWA,eAAK7a,YAAL,CACI,YADJ,EAEI,KAAK2Y,KAAL,CACK5F,IADL,CACU,QAAA4H,MAAA,CAAO,cAAA0O,gBAAP,CADV,EACoC,YAAAu7B,oBAAA,EADpC,EAEK1kD,SAFL,CAEe,UAACkQ,IAAD,EAAuC;;;AAC9C,gBAAIA,IAAJ,EAAU;AACN,sBAAI,CAACoI,IAAL,CAAUpI,IAAV,CAAeA,IAAf,EADM,CAEN;;;AACA,kBAAI,QAAC,QAAI,CAACoI,IAAL,CAAUrT,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEy2E,YAAlB,KAAkC,QAAC,QAAI,CAACpjE,IAAL,CAAUrT,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEvC,MAAF,CAASgJ,EAAzB,CAAtC,EAAmE;AAC/D;AACH,eALK,CAMN;;;AACA,sBAAI,CAACgpB,IAAL,GAAY,IAAI,cAAAxP,KAAJ,CAAU,CAAD,WAAC,QAAI,CAAC5M,IAAL,CAAUrT,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEy2E,YAAjB,MAA6B,IAA7B,IAA6B,aAA7B,GAA6B,MAA7B,GAA6B,GAAEz2D,KAAzC,CAAZ,CAPM,CASN;;AACA,sBAAI,CAACm2E,yBAAL;;AACA,sBAAI,CAAC5a,2BAAL,CAAiC,CAAD,KAAC,QAAI,CAACloE,IAAL,CAAUrT,KAAV,MAAe,IAAf,IAAe,aAAf,GAAe,MAAf,GAAe,GAAEvC,MAAlD,EAXM,CAaN;;;AACA,sBAAI,CAACo+E,UAAL,CAAgB,KAAhB;;AACA,sBAAI,CAACua,cAAL;;AAEA,sBAAI,CAACC,eAAL,GAAuB,CAAH,KAAG,QAAI,CAAChjF,IAAL,CAAUrT,KAAV,MAAe,IAAf,IAAe,aAAf,GAAe,MAAf,GAAe,GAAEvC,MAAxC;;AACA,kBAAIwN,IAAI,CAACoY,YAAT,EAAuB;AAAA,6BACE,CAAH,WAAG,QAAI,SAAJ,YAAI,WAAJ,GAAI,MAAJ,WAAI,CAAEhQ,IAAT,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAErT,KAAZ,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEvC,MADrB;AAAA,oBAC1B0mB,WAD0B,UAC1BA,WAD0B;AAAA,oBACbC,WADa,UACbA,WADa;;AAElC,oBAAMkyE,OAAO,GAAG,cAAAvuD,mBAAA,CAAoB,CAAD,WAAE,QAAI,SAAJ,YAAI,WAAJ,GAAI,MAAJ,WAAI,CAAE10B,IAAR,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAErT,KAAb,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAE0jB,iBAAxC,CAAhB;AACe,wBAAI,CAAC6yE,kBAAL,GAA2B,IAAI,UAAAvoF,MAAJ,CAAW;AAAElR,sBAAI,EAAEw5F,OAAO,CAACx5F,IAAR,CAAa6C,OAAb,EAAR;AAAgCwkB,6BAAW,EAAXA,WAAhC;AAA6CC,6BAAW,EAAXA;AAA7C,iBAAX,CAA3B;AACA,wBAAI,CAAC4xE,qBAAL,aAAgC,cAAI,SAAJ,YAAI,WAAJ,GAAI,MAAJ,WAAI,CAAEvmE,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAEkpD,oBAA5C,qBAA2E,cAAI,SAAJ,YAAI,WAAJ,GAAI,MAAJ,WAAI,CAAElpD,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAEipD,gBAAvF;AACH;AACJ;AACJ,WA5BL,CAFJ;AAiCA,eAAK79E,YAAL,CACI,MADJ,EAEI,KAAK2Y,KAAL,CAAW5F,IAAX,CAAgB,QAAA4H,MAAA,CAAO,cAAA+Q,yBAAP,CAAhB,EAAmDxrB,SAAnD,CAA6D,UAACkQ,IAAD,EAAU;;;AACnE,oBAAI,CAACmuE,WAAL,CAAiBnuE,IAAjB,CACI,aAAAA,IAAI,CAACiH,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAEiN,MAAd,MAAoB,IAApB,IAAoB,aAApB,GAAoB,MAApB,GAAoB,GAAEngB,MAAtB,IACMiM,IAAI,CAACiH,OAAL,CAAaiN,MAAb,CAAoB,CAApB,EAAuBlJ,QAAvB,CAAgCpJ,QADtC,GAEMk/B,WAHV;AAKH,WAND,CAFJ;AAWA,cAAMhgC,UAAU,GAAG,GAAnB;;AACA,cAAI1J,MAAJ,EAAY;AACR,iBAAKs0C,MAAL,GAAct0C,MAAM,CAAC2J,UAAP,GAAoBD,UAAlC;AACH;;AAED,iBAAAwuE,SAAA,CAAUl4E,MAAV,EAAkB,QAAlB,EACKuL,IADL,CACU,YAAA4sE,YAAA,CAAa,GAAb,CADV,EAEK5sE,IAFL,CAGQ,YAAA6sE,GAAA,CAAI;AACAxvE,gBAAI,EAAE,cAACy/D,GAAD,EAAS;AACX,kBAAMz7D,MAAM,GAAGy7D,GAAG,CAACz7D,MAAnB;AACA,sBAAI,CAAC0nC,MAAL,GAAc1nC,MAAM,CAACjD,UAAP,GAAoBD,UAAlC;AACH;AAJD,WAAJ,CAHR,EAUKhR,SAVL;AAWH;;;yCAEuB;6BAAA,CACpB;;;AACA,cAAM2xC,SAAS,aAAM,SAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMjd,IAAN,CAAWtO,oBAAjB,gBAAf;AACA,cAAMq1E,IAAI,GAAW3sF,KAAK,CAACsB,OAAN,CAAc,CAAD,KAAC,SAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMskB,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAEid,SAA1B,IACf,CAAD,KAAC,SAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMjd,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAEid,SAAF,CAAY,CAAZ,CADK,GAEf,CAAD,KAAC,SAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMjd,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAEid,SAFlB;AAGA,cAAM3qC,IAAI,GAAG,CAAH,KAAG,SAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAM8pB,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAEkb,gCAAF,CAAmC2F,SAAnC,EAA8C8pD,IAA9C,CAAvB;AACA,eAAKT,WAAL,GAAmBh0F,IAAI,KAAKhD,SAAT,eAA0BgD,IAA1B,eAA0C,EAA7D;AACH;;;mDAEiC;;;AAC9B,cAAMg8C,SAAS,GAAG,gBAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMtuB,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAEipD,gBAAZ,KAA4B,MAAG,SAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAMjpD,IAAT,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEkpD,oBAA3C,CAAlB;AACA,iBAAO;AAAEC,uBAAW,EAAE,CAAC,CAAC76B,SAAjB;AAA4B86B,2BAAe,EAAE96B;AAA7C,WAAP;AACH;AAED;;;;;;;;;;;;;qDAUoCtuB,I,EAAa;AAAA;;AAAA,cACvC9L,qBADuC,GACb,KAAKtQ,IAAL,CAAUrT,KADG,CACvC2jB,qBADuC;AAG7C,cAAMm1D,UAAU,GAAG,KAAK3B,MAAL,CAAYriE,IAAZ,CACf,KAAA8oC,uBADe,EAEf;AACIC,oBAAQ,EAAE,MADd;AAEIC,iBAAK,EAAE,MAFX;AAGIzqC,gBAAI,EAAE;AACFi5B,uBAAS,EAAE7c,IAAI,CAACkd,WADd;AAEFoR,uBAAS,EAAEp6B,qBAFT;AAGFjiB,sBAAQ,EAAE+tB,IAAI,CAACtP,QAAL,CAAcze;AAHtB;AAHV,WAFe,CAAnB;AAYA,eAAK7G,YAAL,CACI,wBADJ,EAEIi+E,UAAU,CAAC76B,iBAAX,CAA6BzzC,KAA7B,CAAmCzP,SAAnC,CAA6C,UAACyP,KAAD,EAAwB;AACjEsuE,sBAAU,CAAC53C,KAAX;AACH,WAFD,CAFJ;AAMA43C,oBAAU,CAACz6B,WAAX,GAAyBtjD,SAAzB,CAAmC;AAAA,mBAAM,QAAI,CAACnC,KAAL,CAAW,wBAAX,CAAN;AAAA,WAAnC;AACH;AAEH;;;;;;;;;;AAcE;;;oDAGmC;;;AAC/B,eAAKu0E,YAAL,GACI,CAAC,KAAKA,YAAL,CAAkBnuE,MAAnB,KAAyB,MAAI,KAAKqU,IAAL,CAAUrT,KAAd,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAE4R,SAA9C,IACM,CAAD,KAAC,KAAKyB,IAAL,CAAUrT,KAAV,MAAe,IAAf,IAAe,aAAf,GAAe,MAAf,GAAe,GAAE4R,SADvB,GAEM,KAAKu7D,YAHf;AAIA,eAAKspB,qBAAL,GAA6B,cAAAx3E,4BAAA,CACzB,EADyB,EAEzB,CAAC,KAAKwQ,IAAN,CAFyB,EAGzB,KAAKpc,IAAL,CAAUrT,KAHe,EAIzB,KAAKmtE,YAJoB,EAKzB,KAAK/tD,WALoB,CAA7B;AAOH;AAED;;;;;;;6CAIqBu+D,U,EAAYC,W,EAAa;AAC1C,eAAKkY,gBAAL,GAAwB,IAAxB;AACA,cAAMziF,IAAI,GAAG;AACTwqE,sBAAU,EAAE,CAACF,UAAD,GACN;AAAD;AADO,cAEN,CAACC,WAAD,GACA;AAAD;AADC,cAEA,EALG;AAMTnpE,mBAAO,EACH,KAAKgiF,qBAAL,CAA2Bz0E,cAA3B,KAA8C,cAAAhD,iBAAA,CAAkBmD,WAAhE,GACM;AAAD;AADL,cAEM,CAACw7D,UAAD,GACA;AAAD;AADC,cAEA,CAACC,WAAD,GACA;AAAD;AADC,cAEA,EAbD;AAcTE,uBAAW,EAAE,CAACH,UAAD,GACP;AAAD;AADQ,cAEP,CAACC,WAAD,GACA;AAAD;AADC,cAEA,EAlBG;AAmBTjhB,oBAAQ,EAAE,CAACghB,UAAD,GACJ,KAAK+Y,aAAL,CAAmBvvB,IAAnB,CAAwB,IAAxB,CADI,GAEJ,CAACyW,WAAD,GACA,KAAK+Y,kBAAL,CAAwBxvB,IAAxB,CAA6B,IAA7B,EAAmC,IAAnC,CADA,GAEA,IAvBG;AAwBTtG,uBAAW,EAAE8c;AAxBJ,WAAb;AA0BA,cAAMxG,MAAM,GAAG,KAAKA,MAAL,CAAYriE,IAAZ,CAAiB,KAAA2nD,2BAAjB,EAA8C;AACzDppD,gBAAI,EAAEA,IADmD;AAEzD0B,sBAAU,EAAE,WAF6C;AAGzD0vC,qBAAS,EAAE,KAH8C;AAIzDC,yBAAa,EAAE,oBAJ0C;AAKzD/H,wBAAY,EAAE,CAACghC;AAL0C,WAA9C,CAAf;AAOH;;;oDAEoE;AAAA,cAAlCluD,IAAkC,UAAxCA,IAAwC;AAAA,cAAfkiE,WAAe,UAA5BA,WAA4B;;AACjE,cACI,CAAC,CAACliE,IAAI,CAACzO,QAAN,IAAkB,CAAC,KAAKy1E,qBAAL,CAA2Bt3E,MAA3B,CAAkCngB,MAAtD,KACA,CAAC,KAAK82F,gBAFV,EAGE;AACE;AACA,iBAAK/Z,oBAAL,CAA0B,KAA1B,EAAiC,IAAjC;AACA,iBAAK6a,wBAAL,CAA8B;AAAD;AAA7B;AACH,WAPD,MAOO,IAAI,CAACnnE,IAAI,CAAC9N,SAAN,IAAmBgwE,WAAnB,IAAkC,CAAC,KAAKmE,gBAA5C,EAA8D;AACjE;AACA,iBAAK/Z,oBAAL,CAA0BtsD,IAAI,CAACzO,QAA/B,EAAyC,CAAC2wE,WAA1C,EAFiE,CAET;;AACxD,iBAAKiF,wBAAL,CAA8B;AAAD;AAA7B;AACH,WAJM,MAIA;AACH;;;;;;AAMA,gBAAMt1E,MAAM,GACR,CAACmO,IAAI,CAACzO,QAAN,IAAkB,CAAC,KAAKy1E,qBAAL,CAA2Bt3E,MAA3B,CAAkCngB,MAArD,GACM;AAAD;AADL,cAEM,CAACywB,IAAI,CAAC9N,SAAN,IAAmBgwE,WAAnB,GACA;AAAD;AADC,cAEA,KAAKp1C,UAAL,GACA;AAAD;AADC,cAEA;AAAD;AAPT;AAQA,iBAAKq6C,wBAAL,CAA8Bt1E,MAA9B;AACH;AACJ;;;iDAE+Bu1E,Y,EAAsBC,c,EAAyB;AAC3E,eAAKZ,kBAAL,GACIW,YAAY,KAAK,EAAjB,GACMA,YADN,GAEM,KAAKxjF,IAAL,CAAUrT,KAAV,CAAgBqjB,YAAhB,IACA,CAAC,aAAD,EAAgB,QAAhB,EAA0BnjB,OAA1B,CAAkC,KAAKg2F,kBAAvC,MAA+D,CAAC,CADhE,GAEAY,cAFA,GAGA,KAAKZ,kBANf;AAOH;;;oDAgGkCnY,W,EAAqB;AACpD,cAAI,CAACA,WAAL,EAAkB;AACd;AACH;;AAED,cAAMnxD,YAAY,GAAGmxD,WAAW,CAAC7kD,KAAZ,EAArB;;AACA,cAAI,KAAKyd,MAAT,EAAiB;AACb,iBAAK2mC,0BAAL,GAAkC1wD,YAAlC;AACH,WAFD,MAEO;AACH,iBAAK0wD,0BAAL,GAAkC1wD,YAAY,CAACpmB,YAAb,CAA0B,MAA1B,CAAlC;AACH;AACJ;;;+CAE6B82E,0B,EAAoC;AAC9D,eAAKA,0BAAL,GAAkCA,0BAAlC;AACA,eAAKzB,UAAL,CAAgB,CAAC,KAAKllC,MAAtB,EAA8B,KAAK2mC,0BAAnC;AACH;;;uCAEqBjqE,I,EAAwB;AAC1C;AACA,eAAKsjC,MAAL,GAActjC,IAAI,CAACsjC,MAAnB;AACA,eAAK4kC,2BAAL,CAAiCloE,IAAI,CAAC5V,MAAtC;AAEA,eAAKo+E,UAAL,CAAgB,CAAC,KAAKllC,MAAtB,EAA8B,KAAK2mC,0BAAnC,EAL0C,CAM1C;;AACA,eAAK9pE,KAAL,CAAW4hE,QAAX,CACI,cAAApkE,oBAAA,CAAqB;AACjBE,mBAAO,EAAE,MAAF,OAAE,CAAF,kBACA,KAAKmC,IAAL,CAAUrT,KADV,CAAE,EACa;AAClBvC,oBAAM,EAAE4V,IAAI,CAAC5V,MADK;AAElBI,sBAAQ,EAAEwV,IAAI,CAACxV;AAFG,aADb;AADQ,WAArB,CADJ;AASH;;;qCAEqF;AAAA,cAApEmgF,OAAoE,uEAAjD,IAAiD;AAAA,cAA3CV,0BAA2C,uEAAN,IAAM;;;;AAClF,cAAI,QAAC,KAAK7tD,IAAN,MAAU,IAAV,IAAU,aAAV,GAAU,MAAV,GAAU,GAAE1gB,EAAZ,CAAJ,EAAoB;AAChB;AACH;;AAED,cAAM9N,GAAG,GAAG,KAAK,EAAjB;AACA,cAAMo1B,IAAI,GAAGp1B,GAAG,GAAG,CAAnB;AAEA,cAAI4hE,UAAU,GAAG,CAACya,0BAA0B,IAAI,KAAKjqE,IAAL,CAAUrT,KAAV,CAAgBvC,MAA/C,EAAuDy7B,KAAvD,EAAjB;;AACA,cAAI8kD,OAAO,IAAInb,UAAU,CAAC5yC,WAAX,KAA2B,CAA1C,EAA6C;AACzC4yC,sBAAU,GAAGA,UAAU,CAACr8D,YAAX,CAAwB,MAAxB,CAAb;AACH;;AAED,cAAM2jB,UAAU,GAAG04C,UAAU,CAACr8D,YAAX,CAAwB,KAAxB,EAA+B9I,QAA/B,CAAwC;AAAER,kBAAM,EAAE,CAAV;AAAaD,uBAAW,EAAE;AAA1B,WAAxC,CAAnB;AACA,cAAMghF,WAAW,GAAGpb,UAAU,CAACnlE,QAAX,CAAoB;AAAER,kBAAM,EAAE,CAAV;AAAaD,uBAAW,EAAE;AAA1B,WAApB,EAAmDuJ,YAAnD,CAAgE,KAAhE,CAApB,CAdkF,CAgBlF;;AACA,cAAM0J,KAAK,GAAG;AACVzS,kBAAM,EAAEugF,OAAO,GAAGC,WAAH,GAAiB9zD,UADtB;AAEVtsB,oBAAQ,EAAEmgF,OAAO,GAAG3nD,IAAH,GAAUp1B,GAFjB;AAGViiB,qBAAS,EAAE,CAAF,KAAE,KAAKuM,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE1gB,EAHZ;AAIVoU,oBAAQ,EAAE,CAAF,KAAE,KAAK9P,IAAL,CAAUrT,KAAV,MAAe,IAAf,IAAe,aAAf,GAAe,MAAf,GAAe,GAAE6iB,QAAF,CAAW7iB;AAJ1B,WAAd;AAMA,eAAKwT,KAAL,CAAW4hE,QAAX,CAAoB,QAAA3vD,eAAA,CAAgBvW,OAAhB,CAAwBgB,KAAxB,CAApB;AACH;;;2CAEyB;AACtB,cAAMmD,IAAI,GAAG,KAAKA,IAAL,CAAUrT,KAAvB;AADsB,cAEhBvC,MAFgB,GAEG4V,IAFH,CAEhB5V,MAFgB;AAAA,cAER+C,MAFQ,GAEG6S,IAFH,CAER7S,MAFQ;AAGtB/C,gBAAM,GAAGA,MAAM,CAAC8Q,aAAP,CAAqB;AAAEhR,mBAAO,EAAI,OAAOiD,MAAP,KAAkB,QAAlB,IAA8BA,MAAM,IAAI,EAAzC,IAAiD,OAAOA,MAAP,KAAkB,WAApE,GAAoF,CAApF,GAAwF4mD,MAAM,CAAC5mD,MAAD;AAAzG,WAArB,CAAT;AACA,eAAKgT,KAAL,CAAW4hE,QAAX,CACI,cAAApkE,oBAAA,CAAqB;AACjBE,mBAAO,EAAE,MAAF,OAAE,CAAF,kBACAmC,IADA,CAAE,EACE;AACP5V,oBAAM,EAAEA,MADD;AAEP+C,oBAAM,EAAE;AAFD,aADF;AADQ,WAArB,CADJ;AASH;;;wCAEsB;AACnB,eAAKu2F,gBAAL;AACA,eAAKlpB,MAAL,CAAYj9B,QAAZ,CAAqB,KAAKs8B,SAAL,CAAev2D,KAApC,EAA2C;AAAE+mC,uBAAW,EAAE,KAAKwvB,SAAL,CAAexvB;AAA9B,WAA3C;AACH;;;kCAEgB5oC,I,EAAe;AAC5B,eAAKokE,gBAAL,GAAwBpkE,IAAxB;AACH;;;2CAEyBA,I,EAAe;AACrC,eAAK+mE,UAAL,CAAgB,CAAC,KAAKllC,MAAtB;AACA,eAAK0iC,oBAAL,GAA4BvkE,IAA5B;AACH;;;sCAEoB;;;AACjB,eAAKokE,gBAAL,GAAwB,KAAxB;AACA,eAAKG,oBAAL,GAA4B,KAA5B;AACA,eAAKkC,2BAAL,CAAiC,CAAD,KAAC,KAAKloE,IAAL,CAAUrT,KAAV,MAAe,IAAf,IAAe,aAAf,GAAe,MAAf,GAAe,GAAEvC,MAAlD;AACA,eAAKo+E,UAAL,CAAgB,KAAhB;AACH;AAED;;;;;;mCAGkB;AACd;AACA,eAAKroE,KAAL,CAAW4hE,QAAX,CACI,cAAApkE,oBAAA,CAAqB;AACjBE,mBAAO,EAAE,MAAF,OAAE,CAAF,EAAE,EACF,KAAKmC,IAAL,CAAUrT,KADR;AADQ,WAArB,CADJ;AAQA,cAAMg3F,YAAY,GAAG,KAAK3jF,IAAL,CAAUrT,KAAV,CAAgB+O,EAAhB,GAAqB,MAArB,GAA8B,QAAnD;AACA,eAAK8+D,MAAL,CAAYj9B,QAAZ,CAAqB,CAAC,OAAD,EAAUomD,YAAV,CAArB;AACH;;;yCAEuB;AACpB,eAAK1d,cAAL,GAAsB,KAAtB;AACH;;;4BA9TsB;AACxB;AACA,cAAG,CAAC,KAAKid,kBAAT,EAA6B;AAC5B,mBAAO,EAAP;AACA;;AACD,iBAAO,KAAKA,kBAAL,CAAwBn4F,UAAxB,CAAmC,gBAAnC,CAAP,CALwB,CAKqC;AAC7D;;;4BAqGoB;;;AACf,iBACI,UAAAmI,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EACKgB,QADL,CACc;AAAEP,kBAAM,EAAE,CAAV;AAAaiC,gBAAI,EAAE,CAAF,WAAE,KAAKqwB,IAAP,MAAW,IAAX,IAAW,aAAX,GAAW,MAAX,GAAW,GAAEtP,QAAX,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAEwJ,cAAF,CAAiB3sB;AAAvD,WADd,EAEKoB,UAFL,CAEgB,IAFhB,EAGKmJ,iBAHL,KAIA,KAJA,GAKA,UAAAhB,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EACKgB,QADL,CACc;AAAEP,kBAAM,EAAE,CAAV;AAAaiC,gBAAI,EAAE,CAAF,WAAE,KAAKqwB,IAAP,MAAW,IAAX,IAAW,aAAX,GAAW,MAAX,GAAW,GAAEtP,QAAX,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAEwJ,cAAF,CAAiBK;AAAvD,WADd,EAEK5rB,UAFL,CAEgB,IAFhB,EAGKmJ,iBAHL,EANJ;AAWH;;;4BAEoB;AACrB,cAAG,CAAC,KAAK8uF,eAAT,EAA0B,OAAO,EAAP;AACtB,iBAAO,KAAKA,eAAL,CAAqBj4F,UAArB,CAAgC,gBAAhC,CAAP;AAAyD,WAFxC,CAE0C;AAE9D;;;4BAE2B;;;AACxB,gCAAe,WAAKqxB,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE+S,MAA1B;AACH;AAED;;;;4BACqB;;;AACjB,cAAMnvB,IAAI,GAAG,KAAKA,IAAL,CAAUrT,KAAvB;AAEA;;AACA,cAAI,QAACqT,IAAI,SAAJ,IAAAA,IAAI,WAAJ,GAAI,MAAJ,GAAAA,IAAI,CAAEojE,YAAP,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAEz2D,KAArB,CAAJ,EAAgC;AAC5B,mBAAO,KAAP;AACH;;AAED,cAAMA,KAAK,GAAG,IAAI,cAAAC,KAAJ,CAAU5M,IAAI,CAACojE,YAAL,CAAkBz2D,KAA5B,CAAd;AACA,cAAMi3E,SAAS,GAAGj3E,KAAK,CAAC2U,SAAN,CAAgB;AAC9Bl3B,kBAAM,EAAE4V,IAAI,CAAC5V,MADiB;AAE9BI,oBAAQ,EAAEwV,IAAI,CAACxV,QAFe;AAG9BuY,gBAAI,EAAE,KAAKgJ;AAHmB,WAAhB,CAAlB;AAKA,eAAKw3E,wBAAL,CACI,EADJ,EAEIK,SAAS,GAAG;AAAD;AAAF,YAA6B;AAAD;AAFzC;AAIA,iBAAOA,SAAP;AACH;;;4BAEsB;iBAAA,CACnB;;;AACA,cAAMC,gBAAgB,GAAG,MAAH,OAAG,CAAH,EAAG,EAElB,KAAKrrE,IAAL,CAAUkb,gCAAV,CAA2C,iBAA3C,CAFkB,CAAzB;AAIA,cAAMyF,QAAQ,GAAG,KAAK/c,IAAL,KAAc1wB,SAAd,GAA0B,CAAD,KAAC,KAAK0wB,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAE3O,aAAF,CAAgBne,GAAhB,CAChD,UAACwa,OAAD;AAAA,mBAAqB+5E,gBAAgB,CAAC/5E,OAAD,CAArC;AAAA,WADgD,CAAnC,GAEb,EAFJ;AAIA,iBAAO,mBAAI,IAAIkwB,GAAJ,CAAQb,QAAR,CAAJ,EAAuB9oC,MAAvB,CAA8B,UAACe,CAAD;AAAA,mBAAO,CAAC,CAACA,CAAT;AAAA,WAA9B,CAAP;AACH;;;4BAE4B;yBAAA,CACzB;;;AACA,cAAM0b,QAAQ,GAAG,CAAH,WAAG,KAAK9M,IAAL,CAAUrT,KAAb,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEy2E,YAAjB,MAA6B,IAA7B,IAA6B,aAA7B,GAA6B,MAA7B,GAA6B,GAAEt2D,QAAhD;AACA,cAAIiB,WAAW,GAAGjB,QAAQ,GAAGA,QAAQ,CAACkB,YAAZ,GAA2B,KAArD,CAHyB,CAIzB;;AACA,cAAI,YAAKoO,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEpO,YAAX,MAA4B,KAAhC,EAAuC;AACnCD,uBAAW,GAAG,KAAd;AACH;;AACD,iBAAOA,WAAP;AACH;;;4BAE4B;;;AACzB,iBAAO,CAAP,KAAO,KAAKqO,IAAL,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAEvhB,KAAF,CAAQpP,KAAR,CAAc,GAAd,EAAmB,CAAnB,CAAhB;AACH;;;4BAEgB;;;AACb,iBAAO,CAAP,WAAO,KAAK2wB,IAAZ,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEzH,KAAX,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAE0d,OAAzB;AACH;;;4BAEoB;;;AACtB,cAAG,CAAC,KAAK2wD,eAAT,EAA0B,OAAO,EAAP;AAC1B,iBAAO,OAAAzuF,gCAAA,CACL,KAAKyuF,eADA,EAEL,KAAKA,eAAL,CAAqB14F,QAArB,CAA8B;AAAEJ,mBAAO,EAAE,CAAF,KAAE,KAAK8V,IAAL,CAAUrT,KAAV,MAAe,IAAf,IAAe,aAAf,GAAe,MAAf,GAAe,GAAEnC;AAA5B,WAA9B,CAFK,CAAP;AAIE;AAED;;;;;;4BAGmB;iBAAA,CACf;;;AACA,iBAAO,CAAP,KAAO,KAAKwV,IAAL,CAAUrT,KAAV,CAAgBy2E,YAAhB,MAA4B,IAA5B,IAA4B,aAA5B,GAA4B,MAA5B,GAA4B,GAAEt2D,QAAF,CAAWze,QAA9C;AACH;;;;MA3YqC,OAAAnI,a;;AAL1C;;;uBAKa8lF,oB,EAAoB,8B,EAAA,+B,EAAA,4C,EAAA,kC;AAAA,K;;;YAApBA,oB;AAAoB,uC;AAAA,+C;AAAA,e;AAAA,c;AAAA,8zE;AAAA;AAAA;AC7DjC;AACI;AACI;AAEI;AAAA,mBAAU,IAAA0X,gBAAA,EAAV;AAA4B,WAA5B;AAEJ;AACJ;AACA;AAKA;AAIA;AACI;AACI;AAKA;AACI;AACI;AACI;;AACJ;AACA;AACI;AAAuC;AAAI;AAAoB;AAAM;AAAwF;AAAmC;AAAO;AACvM;AACI;AACA;AAAM;AAAC;AACP;AACA;AAAM;AAAC;AACP;AAAiD;AAA8B;AAAgB;AACnG;AACA;AACI;AASJ;AACA;AAQJ;AACJ;AACA;AACI;AA4BA;AACI;AAAI;AAAc;AAClB;AAAG;AAA+C;AAClD;AAQI;AAAA,mBAAgB,IAAAI,WAAA,EAAhB;AAA6B,WAA7B;AACH;AACD;AACI;AAEQ;AAAA,mBAAS,IAAAC,SAAA,CAAU,IAAV,CAAT;AAAwB,WAAxB;AACJ;AACJ;AACJ;AACJ;AACJ;AACJ;AACJ;AACJ;AACA;AACI;AACI;AAEI;AAAiB;AAAA;AAAA;AACb;AACI;AACA;AACJ;AACA;AAAI;AAAqE;AAC7E;AAEA;AAIA;AAUJ;AACJ;AACA;AACI;AACI;AAAkE;AAAA,mBAAS,IAAAV,aAAA,EAAT;AAAwB,WAAxB;AAA0B;AAAI;AAChG;AAA+I;AAAA,mBAAS,IAAAW,QAAA,EAAT;AAAmB,WAAnB;AAAqB;AAAwC;AAChN;AACJ;AACJ;AACJ;;;;AAjJY;AAAA,4DAA+B,MAA/B,EAA+B,aAA/B;AAKiB;AAAA;AAKG;AAAA;AAIkC;AAAA;AACrD;AAAA;AAIG;AAAA;AAGyB;AAAA;AACwB;AAAA;AACzC;AAAA;AAG2C;AAAA;AAAwE;AAAA;AAA0C;AAAA;AAEzJ;AAAA;AAEA;AAAA;AAEA;AAAA;AAA+E;AAAA;AAG1E;AAAA;AAUY;AAAA;AAWP;AAAA;AA8BX;AAAA;AAEC;AAAA,8CAAiB,OAAjB,EAAiB,qBAAjB,EAAiB,UAAjB,EAAiB,oBAAjB,EAAiB,UAAjB,EAAiB,2CAAjB,EAAiB,OAAjB,EAAiB,wCAAjB,EAAiB,OAAjB,EAAiB,QAAjB,EAAiB,MAAjB,EAAiB,0BAAjB;AA2BoC;AAAA;AACxC;AAAA;AAEA;AAAA;AAGkC;AAAA;AAIY;AAAA;AAenB;AAAA;AAAiI;AAAA;;;;;;;;;;2BDnFvKhY,oB,EAAoB;cALhC,OAAA1gC,SAKgC;eALtB;AACPjlD,kBAAQ,EAAE,kBADH;AAEPklD,qBAAW,EAAE,+BAFN;AAGPC,mBAAS,EAAE,CAAC,+BAAD;AAHJ,S;AAKsB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AE7DjC;AAAA;AAAA;;AAMA;AAAA;AAAA;;AASA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqBY;AAEI;AAAA;AAAA;AAAA;AAAA;;AAIJ;;;;;AAHI,uFAA2C,SAA3C,EAA2C,sCAA3C;;;;;;;;AAIJ;AAEI;AAAA;AAAA;AAAA;AAAA;;AAIJ;;;;;AAHI,uFAA2C,SAA3C,EAA2C,sCAA3C;;;;;;QAuBH2hC,wB;;;;;AAkBT,wCAAoBhtE,KAApB,EAA0CqY,IAA1C,EAAqE;AAAA;;AAAA;;AACjE;AADgB,iBAAArY,KAAA,GAAAA,KAAA;AAAsB,iBAAAqY,IAAA,GAAAA,IAAA;AAhBnC,iBAAApN,kBAAA,GAAqB,cAAAA,kBAArB;AACA,iBAAAE,4BAAA,GAA+B,cAAAA,4BAA/B;AACA,iBAAAG,mBAAA,GAAsB,cAAAA,mBAAtB;AACA,iBAAAC,qBAAA,GAAwB,cAAAA,qBAAxB;AACA,iBAAAH,+BAAA,GAAkC,EAAlC;AACA,iBAAAC,+BAAA,GAAkC,EAAlC;AACA,iBAAAy4E,UAAA,GAAa,KAAb;AAEA,iBAAAlwE,eAAA,GAAkB,IAAI,OAAA7uB,eAAJ,CAAyC,EAAzC,CAAlB;AAGA,iBAAAk8F,YAAA,GAAe,IAAI,OAAAr4C,YAAJ,EAAf;AAGA,iBAAAm7C,aAAA,GAAgB,IAAI,OAAAn7C,YAAJ,EAAhB;AAE8D;AAEpE;;;;mCAEc;AAAA;;AACX,eAAKvhD,YAAL,CAAkB,aAAlB,EACI,KAAK2Y,KAAL,CAAW5F,IAAX,CACI,QAAA4H,MAAA,CAAO,cAAAoP,gBAAP,CADJ,EAEE7pB,SAFF,CAEY,UAAAkQ,IAAI,EAAI;AAChB,oBAAI,CAACqsF,UAAL,GAAkBrsF,IAAlB;AACH,WAJD,CADJ;AAMA,eAAKpQ,YAAL,CAAkB,SAAlB,EACI,KAAK2Y,KAAL,CAAW5F,IAAX,CACI,QAAA4H,MAAA,CAAO,cAAAqP,iBAAP,CADJ,EAEE9pB,SAFF,CAEY,UAAAkQ,IAAI,EAAI;AAChB,oBAAI,CAACmc,eAAL,CAAqBnc,IAArB,CAA0BA,IAA1B;AACH,WAJD,CADJ;AAOA,eAAK4T,+BAAL,GAAuC,KAAK24E,UAAL,CAAgB,qBAAhB,CAAvC;AACA,eAAK54E,+BAAL,GAAuC,KAAK44E,UAAL,CAAgB,qBAAhB,CAAvC;AACH;;;4CAE0B3/B,Y,EAAiC;AAAA;;AACxD,eAAKzwC,eAAL,CAAqBxZ,IAArB,CACI,YAAA+H,IAAA,CAAK,CAAL,CADJ,EAEI,YAAAhT,GAAA,CAAI,UAAA+c,OAAO,EAAI;AACX,gBAAMpN,KAAK,GAAGoN,OAAO,CAACpf,IAAR,CAAa,UAAAonB,CAAC;AAAA,qBAAIA,CAAC,CAAC1nB,KAAF,KAAY63D,YAAY,CAAC73D,KAA7B;AAAA,aAAd,CAAd;;AACA,gBAAIsS,KAAJ,EAAW;AACP;AACA,qBAAOoN,OAAO,CAAChc,MAAR,CAAe,UAAAgkB,CAAC;AAAA,uBAAIA,CAAC,CAAC1nB,KAAF,KAAY63D,YAAY,CAAC73D,KAA7B;AAAA,eAAhB,CAAP;AACH,aALU,CAMX;;;AACA,gDAAW0f,OAAX,IAAoBm4C,YAApB;AACH,WARD,CAFJ,EAWE98D,SAXF,CAWY,UAAAkQ,IAAI,EAAI;AAChB,oBAAI,CAACmc,eAAL,CAAqBnc,IAArB,CAA0BA,IAA1B;AACH,WAbD;AAcH;;;wCAEsB;AAAA;;AACnB,eAAKmc,eAAL,CAAqBxZ,IAArB,CACI,YAAA+H,IAAA,CAAK,CAAL,CADJ,EAEE5a,SAFF,CAEY,UAAA2kB,OAAO,EAAI;AACnB,oBAAI,CAAC63E,aAAL,CAAmB/5C,IAAnB,CAAwB99B,OAAxB;AACH,WAJD;AAKH;;;mCAEiB3d,I,EAAa;AAC3B,cAAMwC,OAAO,GAAG,KAAKsnB,IAAL,CAAUkb,gCAAV,CAA2ChlC,IAA3C,KAAoD,EAApE;AACA,iBAAO+H,MAAM,CAACpH,IAAP,CAAY6B,OAAZ,EAAqB5B,GAArB,CAAyB,UAACnK,GAAD,EAAS;AACrC,gBAAMuQ,OAAO,GAAGxE,OAAO,CAAC/L,GAAD,CAAvB;AACA,mBAAO;AACHwH,mBAAK,EAAExH,GADJ;AAEHuQ,qBAAO,EAAPA,OAFG;AAGHyV,0BAAY,EAAEzV;AAHX,aAAP;AAKH,WAPM,CAAP;AAQH;;;;MA3EyC,OAAAxP,a;;AAjD9C;;;uBAiDainF,wB,EAAwB,8B,EAAA,4C;AAAA,K;;;YAAxBA,wB;AAAwB,4C;AAAA;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,6B;AAAA,e;AAAA,c;AAAA,kyB;AAAA;AAAA;;AA9C7B;AACI;AAEI;AAAA,mBAAiB,IAAAiX,mBAAA,QAAjB;AAA4C,WAA5C;;AAGJ;AACA;AAEI;AAAA,mBAAiB,IAAAA,mBAAA,QAAjB;AAA4C,WAA5C;;AAGJ;AACA;AAOA;AAOA;AAEI;AAAA,mBAAiB,IAAAA,mBAAA,QAAjB;AAA4C,WAA5C;;AAGJ;AACA;AAEI;AAAA,mBAAiB,IAAAA,mBAAA,QAAjB;AAA4C,WAA5C;;AAGJ;AACA;AAEA;AACJ;;;;AAtCQ;AAAA,uFAA2C,SAA3C,EAA2C,sBAA3C;AAMA;AAAA,uFAA2C,SAA3C,EAA2C,gCAA3C;AAIA;AAAA;AAOA;AAAA;AASA;AAAA,uFAA2C,SAA3C,EAA2C,uBAA3C;AAMA;AAAA,wFAA2C,SAA3C,EAA2C,yBAA3C;;;;;;;;;;2BAUHjX,wB,EAAwB;cAjDpC,OAAA7hC,SAiDoC;eAjD1B;AACPjlD,kBAAQ,EAAE,uBADH;AAEPuxD,kBAAQ,mmEAFD;AA+CPpM,mBAAS,EAAE,CAAC,oCAAD;AA/CJ,S;AAiD0B,Q;;;;;;;;gBAYhC,OAAAC;;;gBAGA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AC3FL;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;QAyBasgC,yB;AAKT,yCACY5rE,KADZ,EAEYytB,SAFZ,EAEgE;AAAA;;AADpD,aAAAztB,KAAA,GAAAA,KAAA;AACA,aAAAytB,SAAA,GAAAA,SAAA;AACX;;;;gCAEc;AACX,eAAKA,SAAL,CAAeC,KAAf;AACH;;;sCAEoB38B,O,EAA8B;AAC/C,eAAKiP,KAAL,CAAW4hE,QAAX,CAAoB,cAAA9jE,gBAAA,CAAiB;AACjCJ,mBAAO,EAAE3M;AADwB,WAAjB,CAApB;AAGA,eAAK28B,KAAL;AACH;;;;;;AA1CL;;;uBAuBak+C,yB,EAAyB,8B,EAAA,qC;AAAA,K;;;YAAzBA,yB;AAAyB,uC;AAAA;AAAA;yBAEvB,8BAAAoB,wB,EAAwB,I;;;;;;;;;;;;;;;;AAtB/B;AACA;AACI;AAEI;AAAA,mBAAgB,IAAAt/C,KAAA,EAAhB;AAAuB,WAAvB,EAAwB,eAAxB,EAAwB;AAAA,mBACP,IAAAw2D,aAAA,QADO;AACc,WADtC;AAEJ;AACA;AACI;AACI;AAAA;;AAAA;;AAAA,mBAAiB,mBAAjB;AAAgD,WAAhD,EAAiD,iBAAjD,EAAiD;AAAA;;AAAA;;AAAA,mBAC9B,6BAD8B;AACW,WAD5D;AAIJ;AACJ;AACJ;AACA;;;;;;;;;2BAIKtY,yB,EAAyB;cAvBrC,OAAAzgC,SAuBqC;eAvB3B;AACPjlD,kBAAQ,EAAE,kBADH;AAEPuxD,kBAAQ,wxBAFD;AAqBPpM,mBAAS,EAAE,CAAC,qCAAD;AArBJ,S;AAuB2B,Q;;;;;;;;gBAEjC,OAAAsD,S;iBAAU,8BAAAq+B,wB;;;;;;;;;;;;;;;;;;;;;;;;ACnCf;AAAA;AAAA;;AASA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AASA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAGA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAegB;AACI;AAII;AAAA;AAAA;AAAA;AAAA;AACJ;AACJ;;;;;AALQ;AAAA,2CAAa,WAAb,EAAa,IAAb,EAAa,UAAb,EAAa,IAAb;;;;;;;;AAMR;AACI;AACI;AACI;AACI;AACA;AACJ;AACA;AAA+B;AAAsG;AACzI;AACA;AACI;AACI;AAGI;AAAA;AAAA;AAAA;AAAA;AAGA;AACJ;AACA;AAKJ;AACA;AACI;AAAA;AAAA;AAAA;AAAA,WAAwB,cAAxB,EAAwB;AAAA;AAAA;AAAA;AAAA,SAAxB,EAAwB,cAAxB,EAAwB;AAAA;AAAA;AAAA;AAAA,SAAxB;AAGH;AACL;AACJ;AACJ;;;;;AA3BgB;AAAA;AAiBI;AAAA;;;;;;;;AAqBpB;AACI;AACI;AAA8D;AAAA;AAAA;AAAA;AAAA;AAAqB;AAAK;AAC5F;AACJ;;;;AAjEhB,QAAYvT,gBAAZ;;AAAA,eAAYA,gBAAZ,EAA4B;AACxB;AACA;AACH,KAHD,EAAYA,gBAAgB,GAAhB,QAAAA,gBAAA,aAAAA,gBAAA,GAAgB,EAAhB,CAAZ;;QAwEakT,4B;;;;;AAwCT,4CACY3sE,KADZ,EAEW2jE,MAFX,EAGYnK,cAHZ,EAG6C;AAAA;;AAAA;;AACzC;AAHQ,iBAAAx5D,KAAA,GAAAA,KAAA;AACD,iBAAA2jE,MAAA,GAAAA,MAAA;AACC,iBAAAnK,cAAA,GAAAA,cAAA;AA1CL,iBAAA0c,aAAA,GAAgB,YAAAA,aAAA,EAAhB;AAoBP;;AACgB,iBAAA31B,IAAA,GAAyBkZ,gBAAgB,CAAC0qB,IAA1C,CAqB6B,CAnB7C;;AACgB,iBAAAC,QAAA,GAAmB,IAAnB;AAGT,iBAAAtJ,YAAA,GAAkC,IAAI,OAAAlyC,YAAJ,EAAlC;AAmBA,iBAAA8+B,WAAA,GAAc,IAAI,OAAA3iF,eAAJ,CAA4CwG,SAA5C,CAAd;AACA,iBAAA84F,YAAA,GAAe,IAAI,OAAAt/F,eAAJ,CAA4CwG,SAA5C,CAAf;AACA,iBAAA6mF,IAAA,GAAO,IAAI,OAAArtF,eAAJ,CAAoB,YAAAstF,cAApB,CAAP;AACA,iBAAAiS,OAAA,GAAU,IAAI,OAAAv/F,eAAJ,CAAoB,YAAAgxF,cAAA,GAAiB,CAArC,CAAV;AACA,iBAAA/8C,QAAA,GAAW,OAAA/f,aAAA,CAAc,CAAC,SAAKorE,YAAN,CAAd,EAAmCjqF,IAAnC,CAAwC,YAAAjL,GAAA,CAAI,UAAA7H,KAAK;AAAA,iBAAIA,KAAK,CAAC4I,MAAN,CAAa,UAAAvI,CAAC;AAAA,mBAAI,CAAC,CAACA,CAAN;AAAA,WAAd,CAAJ;AAAA,SAAT,CAAxC,CAAX;AACA,iBAAA48F,iBAAA,GAAyB,IAAzB;AACA,iBAAAlzF,KAAA,GAAQ,CAAR;AACA,iBAAAihF,MAAA,GAAS,IAAI,OAAAvtF,eAAJ,CAA2B,YAAAwtF,YAA3B,CAAT;AACP;;AACO,iBAAAoF,SAAA,GAAY,IAAI,OAAA5yF,eAAJ,CAAuD,EAAvD,CAAZ;AAEA,iBAAAyyF,cAAA,GAAiB,IAAI,OAAAzyF,eAAJ,CAA0CwG,SAA1C,CAAjB;AACA,iBAAAksF,WAAA,GAAc,IAAI,OAAA1yF,eAAJ,CAA+CwG,SAA/C,CAAd;AACA,iBAAAmsF,WAAA,GAAc,IAAI,OAAA3yF,eAAJ,CAAuCwG,SAAvC,CAAd;AAjBsC;AAE5C;;;;oCAiBkBvE,O,EAAY;AAAA;;AAC3B,cAAIA,OAAO,CAAC01F,QAAR,IAAoB11F,OAAO,CAAC01F,QAAR,CAAiBvvF,YAAzC,EAAuD;AACnD,iBAAKuqF,WAAL,CAAiBt9E,IAAjB,CACI,YAAA+H,IAAA,CAAK,CAAL,CADJ,EAEI,WAAAy8C,eAAA,EAFJ,EAGI,YAAAzvD,GAAA,CAAI,YAAA0nF,iBAAJ,CAHJ,EAIEtvF,SAJF,CAIY,UAAAkQ,IAAI,EAAI;AAChB,sBAAI,CAAC4sF,YAAL,CAAkB5sF,IAAlB,CAAuBA,IAAvB;AACH,aAND;AAOH,WARD,MAQO,IAAIzQ,OAAO,CAAC01F,QAAR,IAAoB11F,OAAO,CAAC01F,QAAR,CAAiBxvF,aAArC,IAAsD,CAAClG,OAAO,CAAC01F,QAAR,CAAiBvvF,YAA5E,EAA0F;AAC7F,iBAAKk3F,YAAL,CAAkB5sF,IAAlB,CAAuBlM,SAAvB;AACH;AACJ;;;mCAEc;AAAA;;AACX,eAAKtD,OAAL,CAAa,eAAb,EAA8B;AAAA,mBAAM,QAAI,CAACgwD,WAAL,CAAiBpjD,QAAQ,CAACohB,KAA1B,CAAN;AAAA,WAA9B,EADW,CAGX;;AACA,eAAKhuB,OAAL,CAAa,cAAb,EAA6B;AAAA,mBAAM,QAAI,CAACu8F,WAAL,EAAN;AAAA,WAA7B,EAAuD,IAAvD;AACA,eAAK9M,WAAL,CAAiBjgF,IAAjB,CAAsB,KAAK+U,KAA3B;AACA,eAAKgrE,cAAL,CAAoB//E,IAApB,CAAyB,KAAKkV,QAA9B;AACA,eAAK8qE,WAAL,CAAiBhgF,IAAjB,CAAsB,KAAK+c,KAA3B;AAEA,eAAKntB,YAAL,CAAkB,qBAAlB,EACI,OAAA4xB,aAAA,CAAc,CACV,KAAKjZ,KAAL,CAAW5F,IAAX,CACI,QAAA4H,MAAA,CAAO,cAAA4Q,wBAAP,CADJ,EAEI,YAAAzjB,GAAA,CAAI,UAACG,CAAD;AAAA,mBAAqCA,CAAC,CAACoP,OAAvC;AAAA,WAAJ,CAFJ,CADU,EAKV,KAAK84E,cAAL,CAAoBp9E,IAApB,CAAyB,WAAAwkD,eAAA,EAAzB,CALU,EAMV,KAAK64B,WAAL,CAAiBr9E,IAAjB,CAAsB,WAAAwkD,eAAA,EAAtB,CANU,CAAd,EAOGr3D,SAPH,CAOa,kBAAuC;AAAA;AAAA,gBAArCglB,cAAqC;AAAA,gBAArBI,QAAqB;AAAA,gBAAX6H,KAAW;;AAChD,gBAAMkkE,mBAAmB,GAAG,CAACnsE,cAAc,CAACZ,MAAf,IAAyB,EAA1B,EACvBzb,MADuB,CAChB,UAAA2O,CAAC;AAAA,qBAAI,CAAC,CAACA,CAAC,CAACmwB,MAAJ,IAAcnwB,CAAC,CAAC+N,KAAF,CAAQxJ,QAAR,CAAiBuJ,QAAQ,CAACpR,EAA1B,CAAd,IAA+CsD,CAAC,CAAC+N,KAAF,CAAQxJ,QAAR,CAAiBoR,KAAK,CAACjZ,EAAvB,CAAnD;AAAA,aADe,CAA5B;AAGA,gBAAMg7E,MAAM,GAAsC,EAAlD,CAJgD,CAKhD;AACA;AACA;AACA;AACA;AACA;;AACA,oBAAI,CAACoB,SAAL,CAAelgF,IAAf,CAAoB8+E,MAApB;AAEH,WApBD,CADJ;AAwBH;;;sCAEoB;AAAA;;AACjB,cAAMiC,IAAI,GAAG,IAAb,CADiB,CAEjB;AACA;;AACA,eAAK+L,iBAAL,GAAyB5+F,WAAW,CAAC,YAAM;AACvC,gBAAI,CAAC,QAAI,CAACqwD,KAAV,EAAiB;AACb;AACH;;AAEDwiC,gBAAI,CAACiM,UAAL;AACAjM,gBAAI,CAACnnF,KAAL;;AACA,gBAAImnF,IAAI,CAACnnF,KAAL,GAAa,CAAjB,EAAoB;AAChBlM,2BAAa,CAACqzF,IAAI,CAAC+L,iBAAN,CAAb;AACA/L,kBAAI,CAAC+L,iBAAL,GAAyB,IAAzB;AACH;AACJ,WAXmC,EAWjC,IAXiC,CAApC;AAYH;;;oCAEkB5hF,Q,EAAU;AACzBA,kBAAQ,GAAGA,QAAQ,CAAC0pB,MAAT,CAAgB,CAAhB,EAAmB1pB,QAAQ,CAACjW,OAAT,CAAiB,IAAjB,CAAnB,CAAX;AACA,eAAKq1E,WAAL,GAAmBp/D,QAAnB;AACH;;;mCAEiB;AACd9T,gBAAM,CAACyS,IAAP,CAAY,OAAAmgE,IAAA,CAAKC,IAAjB;AACH;;;qCAEgB;AACb,eAAKgG,WAAL,CAAiBjwE,IAAjB,CAAsB,KAAKu+C,KAA3B;AACA,eAAKo8B,IAAL,CAAU36E,IAAV,CAAe,YAAAs+E,cAAf;AACH;;;iCAEe;AACZ,cAAI,KAAKuO,OAAL,CAAa93F,KAAb,GAAqB,YAAAupF,cAAzB,EAAyC;AACrC,iBAAKuO,OAAL,CAAa7sF,IAAb,CAAkB,KAAK6sF,OAAL,CAAa93F,KAAb,GAAqB,CAAvC;AACH;AACJ;;;kCAEgB;AACb,cAAI,KAAK83F,OAAL,CAAa93F,KAAb,GAAqB,YAAA6lF,cAAzB,EAAyC;AACrC,iBAAKiS,OAAL,CAAa7sF,IAAb,CAAkB,KAAK6sF,OAAL,CAAa93F,KAAb,GAAqB,CAAvC;AACH;AACJ;;;0CAEwB;AACrB,eAAK83F,OAAL,CAAa7sF,IAAb,CAAkB,YAAA46E,cAAlB;AACA,eAAKD,IAAL,CAAU36E,IAAV,CAAe,YAAA46E,cAAf;AACA,eAAKC,MAAL,CAAY76E,IAAZ,CAAiB,YAAA86E,YAAjB;AACA,eAAK7K,WAAL,CAAiBjwE,IAAjB,CAAsBlM,SAAtB;AACH;;;mCAEiB;AACd,eAAKuvF,YAAL,CAAkB9wC,IAAlB,CAAuB,KAAvB;AACA,cAAMwuC,IAAI,GAAG,IAAb;AACAA,cAAI,CAACnnF,KAAL,GAAa,CAAb;AAEA,eAAK+gF,IAAL,CAAU36E,IAAV,CAAe,YAAAs+E,cAAf;AACA,eAAKzD,MAAL,CAAY76E,IAAZ,CAAiB,YAAA86E,YAAjB;AACA,eAAK7K,WAAL,CAAiBjwE,IAAjB,CAAsBlM,SAAtB,EAPc,CASd;;AACA,eAAKg5F,iBAAL,GAAyB5+F,WAAW,CAAC,YAAM;AACvC6yF,gBAAI,CAACiM,UAAL;AACAjM,gBAAI,CAACnnF,KAAL;;AACA,gBAAImnF,IAAI,CAACnnF,KAAL,GAAa,CAAjB,EAAoB;AAChBlM,2BAAa,CAACqzF,IAAI,CAAC+L,iBAAN,CAAb;AACA/L,kBAAI,CAAC+L,iBAAL,GAAyB,IAAzB;AACH;AACJ,WAPmC,EAOjC,GAPiC,CAApC;AAQH;;;mDAEiC;AAC9B,eAAK5gB,MAAL,CAAYriE,IAAZ,CAAiB,qCAAA03E,+BAAjB,EACI;AACIn5E,gBAAI,EAAE,KAAK8M,QADf;AAEIpL,sBAAU,EAAE,WAFhB;AAGI0vC,qBAAS,EAAE,KAHf;AAIIC,yBAAa,EAAE;AAJnB,WADJ;AAOH;;;4BA9JqB;AAClB,iBAAO,OAAA4wB,mBAAA,CAAoB,KAAKC,WAAzB,CAAP;AACH;;;4BAEsB;AACnB,iBAAO,KAAK2a,QAAL,GAAgB,KAAK4H,OAAL,CAAa93F,KAA7B,GAAqC,KAAK4lF,IAAL,CAAU5lF,KAAtD;AACH;;;;MAtC6C,OAAAzG,a;;AAnElD;;;uBAmEa4mF,4B,EAA4B,8B,EAAA,kC,EAAA,wC;AAAA,K;;;YAA5BA,4B;AAA4B,4C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,wE;AAAA,e;AAAA,c;AAAA,o2B;AAAA;AAAA;AAhEjC;AACI;AACI;AAQA;AAiCA;;;;;AAUA;AAKJ;AACJ;;;;AA3DmC;AACN;AAAA;AACE;AAAA;AAQN;AAAA;AAkCb;AAAA;AACA,+CAAkB,KAAlB,EAAkB,UAAlB,EAAkB,OAAlB,EAAkB,sCAAlB,EAAkB,QAAlB,EAAkB,iCAAlB,EAAkB,KAAlB,EAAkB,oCAAlB,EAAkB,UAAlB,EAAkB,mCAAlB;AAQsC;AAAA;;;;;;;;;;;2BAW7CA,4B,EAA4B;cAnExC,OAAAxhC,SAmEwC;eAnE9B;AACPjlD,kBAAQ,EAAE,uBADH;AAEPuxD,kBAAQ,ylGAFD;AAgEPpM,mBAAS,EAAE,CAAC,wCAAD,CAhEJ;AAiEPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AAjE1B,S;AAmE8B,Q;;;;;;;;;;gBAGpC,OAAA7lB;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAIA,OAAAA;;;gBAGA,OAAAA;;;gBAEA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;ACzJL;AAAA;AAAA;;AASA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;AAWwB;AAAgC;AAA6F;;;;;AAA7F;AAAA;;;;;;;;;;;;;AAFpC;AACI;AACA;AACJ;;;;;AAHkD;AAC9C;AAAA;AACM;AAAA;;;;;;AAOF;AAA6C;AAAkB;;;;;;;;;;;;AAJnE;AAII;AACJ;;;;;AAJA;AAGU;AAAA;;;;;;AAEV;;;;;;AASI;AAA6C;AAAkB;;;;;;AAJnE;AAII;AACJ;;;;;AAJI;AAGM;AAAA;;;;;;AAEV;;;;;;AAUJ;AAA+B;AAAoB;;;;;AAApB;AAAA;;;;;;AAC/B;AAAiC;AAAsB;;;;;AAAtB;AAAA;;;;;;AAJrC;AACI;AAAM;AAA4B;AAAG;AAAmB;AAAI;AAC5D;AAA8C;AAAQ;AACtD;AACA;AACJ;;;;;AAJU;AAAA;AAA+B;AAAA;AACb;AAAA;AAAsB;AAAA;AACxC;AAAA;AACA;AAAA;;;;;;AAEV;AACI;AACA;AACA;AACJ;;;;;;AAEJ;AACI;AAEJ;;;;;;;;;;;QAKCshC,uB;;;;;AAxDb;AAAA;;AAAA;;;AA0DW,iBAAA53D,aAAA,GAAwB,mBAAxB;AACA,iBAAAC,QAAA,GAAmB,EAAnB;AACA,iBAAA1mB,IAAA,GAAe,EAAf;AAeA,iBAAAm2F,UAAA,GAAa,IAAI,OAAA97C,YAAJ,EAAb;AAIA,iBAAAzzB,WAAA,GAAkC,CAAC,CAAD,EAAG,CAAH,EAAMhmB,GAAN,CAAU,UAAAkmB,CAAC,EAAI;AACpD,iBAAO;AAACD,gBAAI,yCAAkCC,CAAlC;AAAL,WAAP;AACH,SAFwC,CAAlC;AA/EX;AA2HC;;;;mCAxCkB;;;AACX,cAAI,KAAKk2D,SAAL,IAAkB,KAAKA,SAAL,CAAe/+D,KAArC,EAA4C;AACxC,iBAAKyI,QAAL,GAAgB,KAAKs2D,SAAL,CAAe/+D,KAAf,CAAqB9R,KAArB,CAA2BpP,KAA3B,CAAiC,GAAjC,EAAsC,CAAtC,CAAhB;AACA,0BAAAupB,eAAA,CAAgB,IAAhB,EAAsB,CAAC,CAAD,EAAG,CAAH,CAAtB,EAA6B,KAAKG,aAAlC,EAAiD,KAAKC,QAAtD;AACA,gBAAM5c,CAAC,GAAG,KAAKkzE,SAAL,CAAe/+D,KAAf,CAAqBmB,oBAA/B,CAHwC,CAGY;;AACpD,iBAAKpf,IAAL,aAAe,MAAA8J,CAAC,CAAC,CAAD,CAAD,MAAI,IAAJ,IAAI,aAAJ,GAAI,MAAJ,GAAI,GAAEK,WAAF,EAAnB,SAAqCL,CAAC,CAACtE,iBAAF,GAAsB4C,SAAtB,CAAgC,CAAhC,CAArC;AACH;AACJ;;;oCAEkB3P,O,EAAsB;AACrC,cAAI,KAAK29F,YAAL,KAAsB,IAAtB,IACA39F,OAAO,CAAC6Y,IAAR,IACA7Y,OAAO,CAAC6Y,IAAR,CAAa+kF,WAAb,KAA6B,IAD7B,IAEA59F,OAAO,CAAC6Y,IAAR,CAAa1S,YAFb,IAGAnG,OAAO,CAAC6Y,IAAR,CAAa1S,YAAb,CAA0BlD,MAH1B,IAIAjD,OAAO,CAAC6Y,IAAR,CAAa1S,YAAb,CAA0B9C,QAL9B,EAMG;AACC,iBAAKs6F,YAAL,GAAoB,KAAKpZ,SAAL,CAAe/+D,KAAf,CAAqB2U,SAArB,CAA+B;AAC/Cl3B,oBAAM,EAAE,KAAK4V,IAAL,CAAU5V,MAD6B;AAE/CI,sBAAQ,EAAE,KAAKwV,IAAL,CAAUxV,QAF2B;AAG/CuY,kBAAI,EAAE,KAAKV;AAHoC,aAA/B,MAIb,KAJa,GAIL,UAJK,GAIQ,aAJ5B;AAMH;AACJ;;;kCAEgB;AACb,iBAAO,KAAKqpE,SAAL,KAAmBhgF,SAA1B;AACH;;;kCAMgB6pB,I,EAAM;AACnB,iBAAOA,IAAI,CAAChS,QAAL,CAAc,aAAd,CAAP;AACH;;;4BANsB;AACnB,iBAAO,KAAK7U,IAAL,CAAUwF,iBAAV,EAAP;AACH;;;4BAKmB;AAChB,iBAAQ,IAAI7K,IAAJ,EAAD,CAAa83B,OAAb,EAAP;AACH;;;;MAlEwC,OAAAroB,c;;AAxD7C;;;uDAwDai0E,uB;AAAuB,K;;;YAAvBA,uB;AAAuB,2C;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,wE;AAAA,e;AAAA,c;AAAA,u1B;AAAA;AAAA;AArD5B;AAAiD;AAAA,mBAAS,IAAA8X,UAAA,oBAAT;AAAmC,WAAnC;AAE7C;AACI;AACI;AAIA;AACI;AAMA;AAGJ;AACA;AACI;AAMA;AAGJ;AACJ;AACJ;AACA;AACI;AAMA;AAKJ;AACA;AAIJ;;;;AAhDI;AAGwC;AAAA;AAKF;AAAA;AAQtB;AAAA;AAGsB;AAAA;AAQtB;AAAA;AAKE;AAAA;AAMA;AAAA;AAMiB;AAAA;;;;;;wEAQlC9X,uB;;;;2BAAAA,uB,EAAuB;cAxDnC,OAAAzhC,SAwDmC;eAxDzB;AACPjlD,kBAAQ,EAAE,sBADH;AAEPuxD,kBAAQ,+gHAFD;AAsDPpM,mBAAS,EAAE,CAAC,mCAAD;AAtDJ,S;AAwDyB,Q;;gBAS/B,OAAAziD;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;ACtFL;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAeA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgBwB;AACI;AAMI;AAAA;AAAA;AAAA;AAAA,iBAAU,OAAAu5C,eAAA,kBAAV;AAAwC,SAAxC;AAEJ;AACA;AAEJ;;;;;;AAVQ;AAAA,+DAAiC,WAAjC,EAAiC,KAAjC,EAAiC,MAAjC,EAAiC,8BAAjC,EAAiC,SAAjC,EAAiC,UAAjC,EAAiC,YAAjC,EAAiC,qBAAjC;;;;;;AAHZ;AACI;;AAaJ;;;;;;AAbkB;AAAA;;;;;;;;AAed;AAKI;AAAA;AAAA;AAAA;AAAA;;AAAoC;;;;;;AAHpC,+CAAoB,MAApB,EAAoB,kCAApB,EAAoB,MAApB,EAAoB,mBAApB;;;;;;;;AAMA;AAEQ;AAAA;AAAA;AAAA;AAAA;AAEJ;;AACJ;;;;;AADI;AAAA;;;;;;AAbZ;AACI;;AAOA;AACI;;AAMJ;AACJ;;;;;AAdQ;AAAA,iFAA+E,cAA/E,EAA+E,yBAA/E;AAUQ;AAAA;;;;;;AAMZ;;;;;;;;;;AADJ;AACI;AAEA;AACI;AACJ;AACJ;;;;AAL0B;AAAA;;;;;;;;;;AAnClC;AACI;AACI;;AAeA;;;AAiBA;;;AAOJ;AACJ;;;;;;;;;AAxCsB;AAAA;AAeA;AAAA;AAiBA;AAAA;;;;QAcrB9X,6B;;;;;AAqCT,6CAAYlnB,KAAZ,EACY7lD,KADZ,EAEYq6D,MAFZ,EAGYl3D,KAHZ,EAIYkV,IAJZ,EAKYmzB,KALZ,EAMY/C,OANZ,EAMgC;AAAA;;AAAA;;AAC5B,uCAAMod,KAAN;AANQ,iBAAA7lD,KAAA,GAAAA,KAAA;AACA,iBAAAq6D,MAAA,GAAAA,MAAA;AACA,iBAAAl3D,KAAA,GAAAA,KAAA;AACA,iBAAAkV,IAAA,GAAAA,IAAA;AACA,iBAAAmzB,KAAA,GAAAA,KAAA;AACA,iBAAA/C,OAAA,GAAAA,OAAA;AA1CL,iBAAAq8C,iBAAA,GAAoB,EAApB;AACA,iBAAAC,kBAAA,GAAqB,CAArB;AACA,iBAAA3kC,SAAA,GAAY,KAAAA,SAAZ;AACA,iBAAAC,kBAAA,GAAqB,KAAAA,kBAArB;AACP;;AACgB,iBAAArzD,MAAA,GAAS,CAAT;AAeT,iBAAA63F,eAAA,GAAkB,IAAI,OAAAj8C,YAAJ,EAAlB;AAEA,iBAAAo8C,YAAA,GAAe,IAAI,OAAAjgG,eAAJ,CAAoB,SAAKggG,kBAAzB,CAAf;AAWA,iBAAAllF,IAAA,GAAO,IAAI,OAAA9a,eAAJ,CAAiDwG,SAAjD,CAAP;AASyB;AAE/B;;;;mCAEc;AAAA;;AACX,sGADW,CAEX;;;AACA,eAAK05F,iBAAL,GAAyB,OAAAhsE,aAAA,CAAc,CAAC,KAAKisE,UAAN,EAAkB,KAAKF,YAAvB,CAAd,EACpB5qF,IADoB,CAEjB,YAAAjL,GAAA,CAAI,kBAAwB;AAAA;AAAA,gBAAtBg2F,EAAsB;AAAA,gBAAlBH,YAAkB;;AAAE,oBAAI,CAACx5C,KAAL,CAAW45C,YAAX;;AAA2B,mBAAOD,EAAE,SAAF,IAAAA,EAAE,WAAF,GAAE,MAAF,GAAAA,EAAE,CAAE/1F,KAAJ,CAAU,CAAV,EAAa41F,YAAb,CAAP;AAAmC,WAA5F,CAFiB,CAAzB;AAIA,eAAKK,YAAL,GAAoB,OAAApsE,aAAA,CAAc,CAAC,KAAKisE,UAAN,EAAkB,KAAKF,YAAvB,CAAd,EACf5qF,IADe,CAEZ,YAAAjL,GAAA,CAAI,kBAAwB;AAAA;AAAA,gBAAtBg2F,EAAsB;AAAA,gBAAlBH,YAAkB;;;;AACxB,mBAAQ,CAAC,CAAD,KAACG,EAAE,SAAF,IAAAA,EAAE,WAAF,GAAE,MAAF,GAAAA,EAAE,CAAE35F,MAAJ,MAAU,IAAV,IAAU,aAAV,GAAU,EAAV,GAAc,CAAf,IAAoBw5F,YAA5B;AACH,WAFD,CAFY,CAApB;AAMA,eAAKM,gBAAL,GAAwB,OAAArsE,aAAA,CAAc,CAAC,KAAKisE,UAAN,EAAkB,KAAKF,YAAvB,CAAd,EACnB5qF,IADmB,CAEhB,YAAAjL,GAAA,CAAI;AAAA;AAAA,gBAAEg2F,EAAF;AAAA,gBAAMH,YAAN;;AAAA,mBAAwBG,EAAE,IAAKA,EAAE,CAAC35F,MAAH,GAAYw5F,YAAnB,IAAoC,CAA5D;AAAA,WAAJ,CAFgB,CAAxB;AAIA,eAAK39F,YAAL,CAAkB,aAAlB,EAAiC,KAAK2Y,KAAL,CAAWgC,MAAX,CAAkB,OAAAC,iBAAlB,EAC5B7H,IAD4B,CACvB,YAAA+H,IAAA,CAAK,CAAL,CADuB,EAE5B5a,SAF4B,CAElB,UAAC2a,IAAD,EAA4B;AACnC;AACA,oBAAI,CAAC0J,WAAL,GAAmB,IAAI,cAAA0R,IAAJ,CAASpb,IAAT,CAAnB;AACH,WAL4B,CAAjC;AAQA,eAAK7a,YAAL,CAAkB,YAAlB,EAAgC,KAAK2Y,KAAL,CAAW5F,IAAX,CAC5B,QAAA4H,MAAA,CAAO,cAAA0O,gBAAP,CAD4B,EAE5B,YAAAu7B,oBAAA,EAF4B,EAG9B1kD,SAH8B,CAGpB,UAACkQ,IAAD,EAAuC;AAC/C,gBAAIA,IAAJ,EAAU;AACN,sBAAI,CAACoI,IAAL,CAAUpI,IAAV,CAAeA,IAAf;;AACA,sBAAI,CAAC+zC,KAAL,CAAWqB,aAAX;AAEH;AACJ,WAT+B,CAAhC;AAUA,eAAKrB,KAAL,CAAWqB,aAAX;AACH;;;mCAEiB;AAAA;;AACd;AACA,eAAKm4C,YAAL,CAAkB5qF,IAAlB,CACI,YAAA+H,IAAA,CAAK,CAAL,CADJ,EAEI,YAAAhT,GAAA,CAAI,UAAA6G,CAAC;AAAA,mBAAIA,CAAC,GAAG,QAAI,CAAC8uF,iBAAb;AAAA,WAAL,CAFJ,EAGEv9F,SAHF,CAGY,UAAAkQ,IAAI,EAAI;AAChB,oBAAI,CAACutF,YAAL,CAAkBvtF,IAAlB,CAAuBA,IAAvB;;AACA,oBAAI,CAAC+zC,KAAL,CAAWqB,aAAX;AACH,WAND;AAOH;;;2CAEyBjlD,K,EAAeoK,I,EAA4B;AACjE,iBAAOA,IAAI,CAACwa,KAAL,CAAWjR,EAAlB;AACH;AAGH;;;;;;;;;;;;;qCAUsB0gB,I,EAA4BkpD,oB,EAA8BD,gB,EAA0B;AAAA,cAE5Fr1D,YAF4F,GAE3E,KAAKhQ,IAAL,CAAUrT,KAFiE,CAE5FqjB,YAF4F;AAGpG,eAAKhQ,IAAL,CAAUrT,KAAV,CAAgB2jB,qBAAhB,GAAwC,EAAxC;;AACA,cAAGN,YAAH,EAAgB;AACnB;AACA,gBAAM01E,cAAc,GAAGtpE,IAAI,CAACzP,KAAL,CAAWstB,uBAAX,CAAmC5pC,MAAnC,CAA0C,UAAAukC,MAAM;AAAA,qBAAI,CAACA,MAAM,CAACtmB,SAAZ;AAAA,aAAhD,CAAvB;AACA,iBAAKtO,IAAL,CAAUrT,KAAV,CAAgB2jB,qBAAhB,GAAwCo1E,cAAc,CAACp2F,GAAf,CAAmB,UAACslC,MAAD;AAAA,qBAAWA,MAAM,CAACnrC,IAAlB;AAAA,aAAnB,CAAxC;AACI,WARmG,CAUxG;;;AACA,cAAG,KAAKuW,IAAL,CAAUrT,KAAV,CAAgB2jB,qBAAhB,CAAsC3kB,MAAzC,EAAiD;AACzC,iBAAKy5E,4BAAL,CAAkChpD,IAAlC,EADyC,CACA;AAC5C,WAFL,MAGK,IAAI,KAAKpc,IAAL,CAAUrT,KAAV,CAAgBizB,gBAAhB,IAAoC,KAAK5f,IAAL,CAAUrT,KAAV,CAAgBizB,gBAAhB,CAAiCj0B,MAAzE,EAAiF;AACrF,iBAAKg6F,eAAL,CAAqBvpE,IAArB,EADqF,CACzD;AAC5B,WAFI,MAGI;AACD,iBAAKwpE,cAAL,CAAoBxpE,IAApB,EADC,CAC0B;AAC9B;AAEJ;AAEH;;;;;;;;;;;;;;;uCAYyBA,I,EAAM;AAC9B;AAD8B,cAEnBhyB,MAFmB,GAER,KAAK4V,IAAL,CAAUrT,KAFF,CAEnBvC,MAFmB;;AAGzB,cAAI,KAAK+C,MAAT,EAAiB;AACb/C,kBAAM,GAAGA,MAAM,CAACE,QAAP,CAAgB;AAAEJ,qBAAO,EAAE,KAAKiD;AAAhB,aAAhB,CAAT;AACH;AAEA;;;;;AAKD;;;AACA,eAAKqtE,MAAL,CAAYj9B,QAAZ,CAAqB,CAAC,MAAD,CAArB,EAAgC;AAAEksC,sBAAU,EAAE,KAAKnmE,KAAnB;AAA0B9e,iBAAK,EAAC;AAACqZ,qBAAO,kCACjE,KAAKmC,IAAL,CAAUrT,KADuD,GAClD;AAClB4R,yBAAS,EAAE,KAAKia,IAAL,CAAUja,SADH;AACc;AAChCnU,sBAAM,EAANA,MAFkB;AAGlB+C,sBAAM,EAAE,KAAKA,MAHK;AAIlBi2E,4BAAY,EAAEhnD;AAJI,eADkD;AAAR;AAAhC,WAAhC;AAQH;AAGH;;;;;;;;;;;;qDASqCA,I,EAA4B;AAAA;;AAAA,cACxD9L,qBADwD,GAC9B,KAAKtQ,IAAL,CAAUrT,KADoB,CACxD2jB,qBADwD,EAGjE;;AACE,cAAMm1D,UAAU,GAAG,KAAK78B,OAAL,CAAannC,IAAb,CAAwE,KAAA8oC,uBAAxE,EAAiG;AAClHC,oBAAQ,EAAE,MADwG;AAElHC,iBAAK,EAAE,MAF2G;AAGlHzqC,gBAAI,EAAE;AACJi5B,uBAAS,EAAE7c,IAAI,CAACzP,KAAL,CAAW2sB,WADlB;AAEJoR,uBAAS,EAAEp6B,qBAFP;AAGJjiB,sBAAQ,EAAE+tB,IAAI,CAACtP,QAAL,CAAcze;AAHpB;AAH4G,WAAjG,CAAnB;;AASA,eAAK7G,YAAL,CACE,wBADF,EAEEi+E,UAAU,CAAC76B,iBAAX,CAA6BzzC,KAA7B,CAAmCzP,SAAnC,CAA6C,UAACyP,KAAD,EAAwB;AAEvE,gBAAIA,KAAK,CAACgW,MAAN,KAAiB,MAAjB,IAA2B,EAAE,QAAI,CAACnN,IAAL,CAAUrT,KAAV,CAAgBizB,gBAAhB,IAAoC,CAAC,QAAI,CAAC5f,IAAL,CAAUrT,KAAV,CAAgBizB,gBAAhB,CAAiCj0B,MAAxE,CAA/B,EAAiH;AAC/G,sBAAI,CAACi6F,cAAL,CAAoBxpE,IAApB,EAD+G,CACnF;;AAC7B;;AACGqpD,sBAAU,CAAC53C,KAAX;AACD,WAND,CAFF;AAUA43C,oBAAU,CAACz6B,WAAX,GAAyBtjD,SAAzB,CAAmC;AAAA,mBAAM,QAAI,CAACnC,KAAL,CAAW,wBAAX,CAAN;AAAA,WAAnC;AACD;AAEF;;;;;;;;;;;;wCASyB62B,I,EAA4B;AAAA;;AACpD;AACE,cAAMkuB,GAAG,GAAG,KAAK1B,OAAL,CAAannC,IAAb,CAAiD,KAAAgsD,6BAAjD,EAAgF;AACxFhjB,iBAAK,EAAE,OADiF;AAExFzqC,gBAAI,EAAE;AACJ0f,mBAAK,EAAE,KAAK1f,IAAL,CAAUrT,KAAV,CAAgBizB,gBADnB;AAEJvxB,sBAAQ,EAAE,KAAK2R,IAAL,CAAUrT,KAAV,CAAgB0B;AAFtB;AAFkF,WAAhF,CAAZ;;AAOAi8C,aAAG,CAACM,iBAAJ,CAAsBzzC,KAAtB,CAA4BzP,SAA5B,CAAsC,UAAAyP,KAAK,EAAI;AAC7C,gBAAIA,KAAK,CAACgW,MAAN,KAAiB,MAArB,EAA6B;AAC3B,sBAAI,CAACy4E,cAAL,CAAoBxpE,IAApB,EAD2B,CACA;;;AAC3BkuB,iBAAG,CAACzc,KAAJ;AACD,aAHD,MAGO,IAAI12B,KAAK,CAACgW,MAAN,KAAiB,OAArB,EAA8B;AACnCm9B,iBAAG,CAACzc,KAAJ;AACD;AACF,WAPD;AAQD;;;;MAvOgD,KAAAk4B,qB;;AApDnD;;;uBAoDamnB,6B,EAA6B,yC,EAAA,8B,EAAA,+B,EAAA,uC,EAAA,4C,EAAA,0C,EAAA,kC;AAAA,K;;;YAA7BA,6B;AAA6B,iD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,0rB;AAAA;AAAA;AAjDlC;;;;;;;;;;;2BAiDKA,6B,EAA6B;cApDzC,OAAA5hC,SAoDyC;eApD/B;AACPjlD,kBAAQ,EAAE,4BADH;AAEPuxD,kBAAQ,qrFAFD;AAiDPpM,mBAAS,EAAE,CAAC,yCAAD,CAjDJ;AAkDP2B,yBAAe,EAAE,OAAAC,uBAAA,CAAwBC;AAlDlC,S;AAoD+B,Q;;;;;;;;;;;;;;;;;;gBAMrC,OAAAtkD;;;gBAEA,OAAAA;;;gBAGA,OAAAA;;;gBAMA,OAAAA;;;gBAGA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;ACvIL;AAAA;AAAA;;AASA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAYA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkBY;;;;;;AADJ;AACI;AACJ;;;;;;;;AADkB;AAAA;;;;;;AAGlB;;AAMI;AACJ;;;;;;;;AAJI;AACA;AAFA;AAIc;AAAA;;;;;;;;AAId;AAKI;AAAA;AAAA;AAAA;AAAA;AAEJ;;;;;AANI,0DAA4B,YAA5B,EAA4B,2BAA5B,EAA4B,WAA5B,EAA4B,uBAA5B,EAA4B,QAA5B,EAA4B,aAA5B;;;;QAYH2hC,2B;;;;;AAoET,2CAAoBjtE,KAApB,EAA4DqY,IAA5D,EAAuF;AAAA;;AAAA;;AACnF;AADgB,iBAAArY,KAAA,GAAAA,KAAA;AAAwC,iBAAAqY,IAAA,GAAAA,IAAA;AAlE5D;;AACgB,iBAAArrB,MAAA,GAAS,CAAT;AAwBT,iBAAA63F,eAAA,GAAkB,IAAI,OAAAj8C,YAAJ,EAAlB;AAEA,iBAAA88C,oBAAA,GAAuB,IAAI,OAAA3gG,eAAJ,CAC1BwG,SAD0B,CAAvB;AAIA,iBAAAo6F,YAAA,GAAe,IAAI,OAAA5gG,eAAJ,CAAoB,KAApB,CAAf;AAKA,iBAAA6gG,kBAAA,GAAqB,EAArB;;AAGC,iBAAAC,4BAAA,GAA+B,UACnCC,OADmC,EAEnCtnC,iBAFmC,EAGnCunC,qBAHmC,EAInCC,gBAJmC,EAKlC;AACD,mBAAK3+F,YAAL,CACIy+F,OADJ,EAEI,OAAA7sE,aAAA,CAAc,CACVulC,iBAAiB,CAACpkD,IAAlB,CAAuB,YAAAjL,GAAA,CAAI,UAACG,CAAD,EAAO;AAAD;;AAAC,0BAAAA,CAAC,CAACkP,eAAF,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEmN,MAAnB,KAA6B,EAA7B;AAA+B,WAA1C,CAAvB,CADU,EAEVo6E,qBAFU,CAAd,EAIK3rF,IAJL,CAKQ,YAAAjL,GAAA,CAAI,kBAA8C;AAAA;AAAA,gBAA5C2B,OAA4C;AAAA;AAAA,gBAAjC4jB,eAAiC,WAAjCA,eAAiC;AAAA,gBAAhBtW,SAAgB,WAAhBA,SAAgB;;;;AAC9C,iCAAA+Z,sBAAA,CACI,CAAArnB,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEtF,MAAT,MAAe,MAAIsF,OAAO,CAAC,CAAD,CAAX,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAE6b,QAA/B,IAA0C7b,OAA1C,GAAoD,EADxD,EAEI4jB,eAFJ,EAGItW,SAHJ;AAIC,WALL,CALR,EAaK7W,SAbL,CAae,UAACkQ,IAAD,EAAU;AACjBuuF,4BAAgB,CAACvuF,IAAjB,CAAsBA,IAAtB;AACH,WAfL,CAFJ;AAmBH,SAzBO;;AA2B+E;AAEtF;;;;mCAEc;AAAA;;AACX,eAAKwuF,cAAL,GAAsB,KAAKn1F,OAAL,CAAasJ,IAAb,CAAkB,YAAAjL,GAAA,CAAI,UAACzE,CAAD;AAAA,mBAAOA,CAAC,CAACwwD,SAAT;AAAA,WAAJ,CAAlB,CAAtB;AAEA,eAAK7zD,YAAL,CACI,YADJ,EAEI,OAAA4xB,aAAA,CAAc,CAAC,KAAK0sE,YAAN,EAAoB,KAAK3lF,KAAzB,CAAd,EACK5F,IADL,CAEQ,YAAAlK,MAAA,CAAO;AAAA;AAAA,gBAAEkhF,IAAF;;AAAA,mBAAY,CAACA,IAAb;AAAA,WAAP,CAFR,EAGQ,YAAAjiF,GAAA,CAAI;AAAA;AAAA,gBAAE2R,CAAF;AAAA,gBAAKd,KAAL;;AAAA,mBAAgBA,KAAhB;AAAA,WAAJ,CAHR,EAIQ,QAAAgC,MAAA,CAAO,cAAA0O,gBAAP,CAJR,EAKQ,YAAAu7B,oBAAA,EALR,EAOK1kD,SAPL,CAOe,UAACkQ,IAAD,EAAuC;AAC9C,gBAAIA,IAAJ,EAAU;AACN,sBAAI,CAACkL,QAAL,GAAgBlL,IAAI,CAACkL,QAArB;;AACA,sBAAI,CAACujF,eAAL;AACH,aAHD,MAGO,CACN;AACJ,WAbL,CAFJ;AAkBA,eAAK7+F,YAAL,CACI,WADJ,EAEI,KAAKgxB,IAAL,CAAUxwB,MAAV,CAAiB,WAAjB,EAA8BN,SAA9B,CAAwC,YAAM;AAC1C,oBAAI,CAAC2+F,eAAL;AACH,WAFD,CAFJ;AAOA,eAAKC,gBAAL,GAAwB,KAAKr1F,OAAL,CAAasJ,IAAb,CACpB,YAAAjL,GAAA,CAAI,UAACG,CAAD,EAAO;AAAD;;AAAC,0BAAAA,CAAC,CAACkP,eAAF,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEwO,MAAnB,KAA6B,cAAAxB,iBAAA,CAAkBiD,IAA/C;AAAmD,WAA9D,CADoB,EAEpB,YAAAtf,GAAA,CACI,UAACG,CAAD;AAAA,mBACI,IAAI,mCAAA82F,6BAAJ,CAAkC92F,CAAlC,EAAqC,QAAI,CAAC+2F,UAA1C,EAAsD,QAAI,CAACT,kBAA3D,CADJ;AAAA,WADJ,CAFoB,CAAxB;AAQA,eAAKC,4BAAL,CACI,eADJ,EAEI,KAAK/0F,OAFT,EAGI,KAAKw1F,cAAL,IAAuB,OAAAt+E,EAAA,CAAG;AAAE0M,2BAAe,EAAE,EAAnB;AAAuBtW,qBAAS,EAAE;AAAlC,WAAH,CAH3B,EAII,KAAKsnF,oBAJT;AAMH;;;0CAEiB;AAAA;;;;AACd,cAAMt3E,mBAAmB,GAAG,CAAH,KAAG,KAAKiK,IAAL,CAAUja,SAAV,MAAmB,IAAnB,IAAmB,aAAnB,GAAmB,MAAnB,GAAmB,GAAElO,MAAF,CAAS,UAAA4Q,CAAC,EAAI;+CAAA,CACzD;;;AACA,gBAAI,CAAC,QAAI,CAAC6B,QAAN,IAAkB,QAAI,CAACA,QAAL,CAAcnX,MAAd,KAAyB,CAA/C,EAAkD,OAAO,KAAP,CAFO,CAGzD;;AACA,gBAAM+6F,gBAAgB,GAAG,oBAAO,QAAI,CAAC5jF,QAAL,CAAc,CAAd,CAAP,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAE0L,IAAzB,MAA6B,IAA7B,IAA6B,aAA7B,GAA6B,MAA7B,GAA6B,GAAEtP,IAA/B,MAAwC,QAAxC,IAAoD,qBAAI,CAAC4D,QAAL,CAAc,CAAd,OAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAE0L,IAAlB,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAEtP,IAAxB,MAAiC,IAArF,GACnB,CAAD,WAAC,QAAI,CAAC4D,QAAL,CAAc,CAAd,CAAD,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAE0L,IAAlB,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAEtP,IAAF,CAAO1Z,IADV,GAEnB,CAAD,WAAC,QAAI,CAACsd,QAAL,CAAc,CAAd,CAAD,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAE0L,IAAlB,MAAsB,IAAtB,IAAsB,aAAtB,GAAsB,MAAtB,GAAsB,GAAEtP,IAF9B;AAGA,mBAAO+B,CAAC,CAAC/B,IAAF,KAAWwnF,gBAAlB;AACH,WAR8C,CAA/C;AASA,cAAMX,kBAAkB,GAAGx3E,mBAAmB,SAAnB,IAAAA,mBAAmB,WAAnB,GAAmB,MAAnB,GAAAA,mBAAmB,CAAEle,MAArB,CACvB,UAACyc,QAAD;AAAA,mBACI,CAAC,QAAI,CAAChK,QAAL,CAAcmJ,IAAd,CACG,UAACyC,YAAD,EAAkB;AAAD;;AAAC,kCAAAA,YAAY,CAACF,IAAb,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAE1B,QAAnB,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAEpR,EAA7B,MAAoCoR,QAAQ,CAACpR,EAA7C;AAA+C,aADpE,CADL;AAAA,WADuB,CAA3B;AAMA,eAAKqqF,kBAAL,GAA0BA,kBAA1B;AACA,eAAKO,gBAAL,GAAwB,KAAKr1F,OAAL,CAAasJ,IAAb,CACpB,YAAAjL,GAAA,CAAI,UAACG,CAAD,EAAO;AAAD;;AAAC,0BAAAA,CAAC,CAACkP,eAAF,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEwO,MAAnB,KAA6B,cAAAxB,iBAAA,CAAkBiD,IAA/C;AAAmD,WAA9D,CADoB,EAEpB,YAAAtf,GAAA,CACI,UAACG,CAAD;AAAA,mBACI,IAAI,mCAAA82F,6BAAJ,CAAkC92F,CAAlC,EAAqC,QAAI,CAAC+2F,UAA1C,EAAsD,QAAI,CAACT,kBAA3D,CADJ;AAAA,WADJ,CAFoB,CAAxB;AAOH;;;oCAEkB5+F,O,EAAwB;AACvC,cAAIA,OAAO,CAAC8J,OAAR,IAAmB9J,OAAO,CAACs/F,cAA3B,IAA6Ct/F,OAAO,CAAC0+F,oBAAzD,EAA+E;AAC3E,iBAAKG,4BAAL,CACI,eADJ,EAEI,KAAK/0F,OAFT,EAGI,KAAKw1F,cAAL,IAAuB,OAAAt+E,EAAA,CAAG;AAAE0M,6BAAe,EAAE,EAAnB;AAAuBtW,uBAAS,EAAE;AAAlC,aAAH,CAH3B,EAII,KAAKsnF,oBAJT;AAMH;AACJ;;;0CAEwB14E,M,EAA2B;AAChD,eAAK63E,eAAL,CAAqB76C,IAArB,CAA0Bh9B,MAA1B;AACH;;;;MA3J4C,OAAAjnB,a;;AA9BjD;;;uBA8BaknF,2B,EAA2B,8B,EAAA,4C;AAAA,K;;;YAA3BA,2B;AAA2B,+C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,wE;AAAA,c;AAAA,a;AAAA,iY;AAAA;AAAA;AA3BhC;AAIA;AASA;;;;AAbK;AAKD;AAAA;;;;;;;;;;2BAsBCA,2B,EAA2B;cA9BvC,OAAA9hC,SA8BuC;eA9B7B;AACPjlD,kBAAQ,EAAE,0BADH;AAEPuxD,kBAAQ,s7BAFD;AA2BPpM,mBAAS,EAAE,CAAC,uCAAD,CA3BJ;AA4BPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkBuxB;AA5B1B,S;AA8B6B,Q;;;;;;;;gBACnC,OAAAltF;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAMA,OAAAA;;;gBAMA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AChGL;AAAA;AAAA;;QAMa86C,6B,GAKT,uCAAmBp5E,MAAnB,EAAqDq5E,UAArD,EAAoF/3E,kBAApF,EAA+G;AAAA;;;;AAA5F,WAAAtB,MAAA,GAAAA,MAAA;AAAkC,WAAAq5E,UAAA,GAAAA,UAAA;AACjD,WAAKrzB,OAAL,GAAe,IAAf;;AACA,cAAQhmD,MAAR;AACI,aAAK,cAAAxB,iBAAA,CAAkBvf,QAAvB;AACI,eAAKgqB,KAAL,GACA,mEACA,mDAFA;AAGA,eAAKuwE,gBAAL,GAAwB,kBAAxB;AACA;;AACJ,aAAK,cAAAh7E,iBAAA,CAAkBmD,WAAvB;AACI,eAAKsH,KAAL;;AAGA,cAAI3H,kBAAkB,IAAIA,kBAAkB,CAAC9iB,MAAnB,GAA4B,CAAtD,EAAyD;AACrD,iBAAKyqB,KAAL,0CAA6C3H,kBAAkB,CAAC9iB,MAAnB,GAA4B,CAA5B,GACvC8iB,kBAAkB,CAAClf,KAAnB,CAAyB,CAAzB,EAA4B,CAAC,CAA7B,EAAgCD,GAAhC,CAAoC,UAAAwd,QAAQ;AAAA,qBAAIA,QAAQ,CAACtnB,IAAb;AAAA,aAA5C,EAA+DsN,IAA/D,CAAoE,IAApE,IAA4E,OAA5E,GAAsF2b,kBAAkB,CAACA,kBAAkB,CAAC9iB,MAAnB,GAA4B,CAA7B,CAAlB,CAAkDnG,IADjG,GAEvC,CAAD,KAACipB,kBAAkB,CAAC,CAAD,CAAlB,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAEjpB,IAF7B;AAIH;;AACD,cAAIghG,UAAJ,EAAgB;AACZ,iBAAKpwE,KAAL,IACI,0EACYowE,UAAU,CAACrjF,GADvB,6DACwEqjF,UAAU,CAAChhG,IADnF,SADJ;AAGH;;AACD,eAAKmhG,gBAAL,GAAwB,kBAAxB;AACA;;AACJ,aAAK,cAAAh7E,iBAAA,CAAkBkD,OAAvB;AACI,eAAKuH,KAAL,GACI,kDACA,iCAFJ;AAGA,eAAKuwE,gBAAL,GAAwB,cAAxB;AACA;;AACJ,aAAK,cAAAh7E,iBAAA,CAAkBoD,uBAAvB;AACI,eAAKqH,KAAL,sFACI3H,kBAAkB,CAAC9iB,MAAnB,GAA4B,CAA5B,GACE8iB,kBAAkB,CAAClf,KAAnB,CAAyB,CAAzB,EAA4B,CAAC,CAA7B,EAAgCD,GAAhC,CAAoC,UAAAwd,QAAQ;AAAA,mBAAIA,QAAQ,CAACtnB,IAAb;AAAA,WAA5C,EAA+DsN,IAA/D,CAAoE,IAApE,IAA4E,OAA5E,GAAsF2b,kBAAkB,CAACA,kBAAkB,CAAC9iB,MAAnB,GAA4B,CAA7B,CAAlB,CAAkDnG,IAD1I,GAEE,CAAD,KAACipB,kBAAkB,CAAC,CAAD,CAAlB,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAEjpB,IAH7B;AAKA,eAAKmhG,gBAAL,GAAwB,kBAAxB;AACA;;AACJ,aAAK,cAAAh7E,iBAAA,CAAkBiD,IAAvB;AACI,eAAKukD,OAAL,GAAe,KAAf;AACA,eAAK/8C,KAAL,GAAa,EAAb;AACA,eAAKuwE,gBAAL,GAAwB,EAAxB;AACA;AA1CR;AA4CH,K;;AAnDL;;;;;;;;;;;;;;;;;;;;ACNA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAOA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAkBA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgEgC;AAEI;AAAA;AAAA;AAAA;AAAA;AAGA;AACJ;;;;;;;;AAxBhB;AAII;AACI;AACI;AACI;AAOI;AAAA;AAAA;AAAA;AAAA,WAA2C,uBAA3C,EAA2C;AAAA;AAAA;AAAA;AAAA,SAA3C,EAA2C,eAA3C,EAA2C;AAAA;AAAA;AAAA;AAAA,SAA3C;AAGH;AACD;AAOA;AAGI;AACJ;AACJ;AACJ;AACJ;AACA;AAII;AAKI;AAAA;AAAA;AAAA;AAAA;AAEJ;AACA;AAQI;AAAA;AAAA;AAAA;AAAA;;AAEJ;AACA;AAUI;AAAA;AAAA;AAAA;AAAA;;;AAEJ;AACA;AASI;AAAA;AAAA;AAAA;AAAA;;AAEJ;AACJ;AACJ;;;;;AA1EoB;AAAA,6DAA+B,YAA/B,EAA+B,iBAA/B,EAA+B,SAA/B,EAA+B,wBAA/B,EAA+B,aAA/B,EAA+B,mBAA/B;AAWA;AAAA;AAmBR;AAAA,6DAA+B,aAA/B,EAA+B,KAA/B,EAA+B,YAA/B,EAA+B,iBAA/B,EAA+B,gBAA/B,EAA+B,4BAA/B;AAYA;AAAA;AAJA,yDAA2B,aAA3B,EAA2B,IAA3B,EAA2B,YAA3B,EAA2B,iBAA3B,EAA2B,gBAA3B,EAA2B,4BAA3B;AAeA;AAAA;AAGA;AAPA,6DAA+B,aAA/B,EAA+B,IAA/B,EAA+B,YAA/B,EAA+B,iBAA/B,EAA+B,gBAA/B,EAA+B,4BAA/B,EAA+B,QAA/B,EAA+B,MAA/B;AAiBA;AAAA;AAJA,gEAAkC,aAAlC,EAAkC,IAAlC,EAAkC,YAAlC,EAAkC,iBAAlC,EAAkC,gBAAlC,EAAkC,4BAAlC,EAAkC,QAAlC,EAAkC,2BAAlC;;;;;;;;AAaZ;AAII;AAII;AAII;AAEI;AAAA;AAAA;AAAA;AAAA;AACH;AACL;AACJ;AACJ;;;;;AAZQ;AAAA;AAOQ;AAAA;;;;;;;;AApIxB;AAII;AACI;AACJ;AACA;AACI;AACI;AACI;AACI;AAGI;AAAA;AAAA;AAAA;AAAA,WAAqC,aAArC,EAAqC;AAAA;AAAA;AAAA;AAAA,SAArC;;;;AAGH;AACL;AACA;AAAiB;AAAA;AAAA;AAAA;AAAA;AACb;AACI;AACA;AACJ;AACJ;AACJ;AACA;AACI;AACI;AACI;AAAA;AAAA;AAAA;AAAA;;AAGJ;AACJ;AACJ;AACJ;AACA;;AAmFA;;AAmBJ;AACJ;;;;;AAtIyB;AAAA;AAGZ;AAAA;AAE0C;AAAA;AAE/B;AAAA,wEAA2B,MAA3B,EAA2B,kCAA3B,EAA2B,WAA3B,EAA2B,mDAA3B;AASA;AAAA;AACwC;AAAA;AAQxC;AAAA;AAQZ;AAAA;AAmFA;AAAA;;;;QAyDP7a,oB;;;;;AA6ET,oCACY3rE,KADZ,EAEYq6D,MAFZ,EAGYl3D,KAHZ,EAIYwgE,MAJZ,EAKYtrD,IALZ,EAMY1V,QANZ,EAM8B;AAAA;;AAAA;;AAE1B;AAPQ,iBAAA3C,KAAA,GAAAA,KAAA;AACA,iBAAAq6D,MAAA,GAAAA,MAAA;AACA,iBAAAl3D,KAAA,GAAAA,KAAA;AACA,iBAAAwgE,MAAA,GAAAA,MAAA;AACA,iBAAAtrD,IAAA,GAAAA,IAAA;AACA,iBAAA1V,QAAA,GAAAA,QAAA;AAlFL,iBAAA82D,gBAAA,GAAmB,0BAAAA,gBAAnB;AAEA,iBAAAgtB,UAAA,GAAa,CAAb;AAEA,iBAAA5mF,IAAA,GAAO,IAAI,OAAA9a,eAAJ,CAAiDwG,SAAjD,CAAP;AACA,iBAAAwF,OAAA,GAAU,IAAI,OAAAhM,eAAJ,CAAyC,EAAzC,CAAV;AAEA,iBAAA2hG,WAAA,GAAc,IAAI,OAAA3hG,eAAJ,CAAkD,UAAA4X,YAAA,CAAaC,KAAb,EAAlD,CAAd;AACA,iBAAA+pF,mBAAA,GAAsB,IAAI,OAAA5hG,eAAJ,CACzB,UAAA4X,YAAA,CAAaC,KAAb,EADyB,CAAtB;AAGA,iBAAAgqF,mBAAA,GAAsB,IAAI,OAAA7hG,eAAJ,CACzB,UAAA4X,YAAA,CAAaC,KAAb,EADyB,CAAtB;AAGA,iBAAAiqF,sBAAA,GAAyB,IAAI,OAAA9hG,eAAJ,CAC5B,UAAA4X,YAAA,CAAaC,KAAb,EAD4B,CAAzB;AAGA,iBAAAkqF,eAAA,GAAkB,IAAI,OAAA/hG,eAAJ,CACrB,UAAA4X,YAAA,CAAaC,KAAb,EADqB,CAAlB;AAKA,iBAAAmqF,mBAAA,GAAsB,IAAI,OAAAhiG,eAAJ,CAAwCwG,SAAxC,CAAtB;AAEA,iBAAAy7F,oBAAA,GAAuB,SAAKN,WAAL,CAAiBtsF,IAAjB,CAC1B,YAAAjL,GAAA,CAAI,UAACG,CAAD,EAAO;AAAD;;AAAC,wBAAAA,CAAC,CAACkP,eAAF,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEwO,MAAnB,KAA6B,cAAAxB,iBAAA,CAAkBiD,IAA/C;AAAmD,SAA9D,CAD0B,EAE1B,YAAAtf,GAAA,CAAI,UAACG,CAAD;AAAA,iBAAO,IAAI,mCAAA82F,6BAAJ,CAAkC92F,CAAlC,EAAqC,SAAK+2F,UAA1C,CAAP;AAAA,SAAJ,CAF0B,CAAvB;AAOA,iBAAAY,gBAAA,GAAmB,WAAA3oC,qBAAA,CACtB,SAAKqoC,mBADiB,EAEtB,SAAKA,mBAAL,CAAyBvsF,IAAzB,CAA8B,YAAAjL,GAAA,CAAI,UAACG,CAAD,EAAO;AAAD;;AAAA,uBAACA,CAAC,CAACkP,eAAH,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEmN,MAApB;AAA0B,SAApC,CAA9B,CAFsB,CAAnB;AAIA,iBAAAu7E,iBAAA,GAAoB,WAAA5oC,qBAAA,CACvB,SAAKsoC,mBADkB,EAEvB,SAAKA,mBAAL,CAAyBxsF,IAAzB,CAA8B,YAAAjL,GAAA,CAAI,UAACG,CAAD,EAAO;AAAD;;AAAA,uBAACA,CAAC,CAACkP,eAAH,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEmN,MAApB;AAA0B,SAApC,CAA9B,CAFuB,CAApB;AAIA,iBAAAw7E,oBAAA,GAAuB,WAAA7oC,qBAAA,CAC1B,SAAKuoC,sBADqB,EAE1B,SAAKA,sBAAL,CAA4BzsF,IAA5B,CAAiC,YAAAjL,GAAA,CAAI,UAACG,CAAD,EAAO;AAAD;;AAAA,uBAACA,CAAC,CAACkP,eAAH,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEmN,MAApB;AAA0B,SAApC,CAAjC,CAF0B,CAAvB;AAIA,iBAAAy7E,aAAA,GAAgB,WAAA9oC,qBAAA,CACnB,SAAKwoC,eADc,EAEnB,SAAKA,eAAL,CAAqB1sF,IAArB,CAA0B,YAAAjL,GAAA,CAAI,UAACG,CAAD,EAAO;AAAD;;AAAA,uBAACA,CAAC,CAACkP,eAAH,MAAkB,IAAlB,IAAkB,aAAlB,GAAkB,MAAlB,GAAkB,GAAEmN,MAApB;AAA0B,SAApC,CAA1B,CAFmB,CAAhB;AAKA,iBAAA0tE,cAAA,GAAiB,IAAI,OAAAt0F,eAAJ,CAA4B,CAA5B,CAAjB;AAOA,iBAAAuc,IAAA,GAAgB,IAAhB;AACA,iBAAAqkF,YAAA,GAAe,IAAI,OAAA5gG,eAAJ,CAAoB,KAApB,CAAf;AAEA,iBAAAsiG,YAAA,GAAe,IAAI,QAAApjE,WAAJ,EAAf;AAKA,iBAAAqjE,mBAAA,GAAsB,KAAtB;AACA,iBAAA5pF,OAAA,GAAe;AAClBA,iBAAO,EAAE;AAAErY,gBAAI,EAAE,MAAR;AAAgBkW,cAAE,EAAE;AAApB,WADS;AAElBoR,kBAAQ,EAAE,EAFQ;AAGlB0rE,kBAAQ,EAAE;AAHQ,SAAf;AAMA,iBAAA/rB,MAAA,GAAS,IAAT;AAeH,iBAAK5uD,OAAL,GAAeiF,QAAQ,CAACy1E,QAAT,EAAf;AAH0B;AAI7B;;;;iCAde;AACZ,eAAK9rB,MAAL,GAAc,CAAC,KAAKA,MAApB;AACH;;;mCAcc;AAAA;;;;AACX,eAAKjlE,YAAL,CACI,SADJ,EAEI,KAAK2Y,KAAL,CAAW5F,IAAX,CAAgB,QAAA4H,MAAA,CAAO,cAAAqP,iBAAP,CAAhB,EAA2C,YAAA46B,oBAAA,EAA3C,EAAmE1kD,SAAnE,CAA6E,UAACkQ,IAAD,EAAU;AACnF,mBAAO,QAAI,CAAC1G,OAAL,CAAa0G,IAAb,CAAkBA,IAAlB,CAAP;AACH,WAFD,CAFJ;AAOA,eAAKpQ,YAAL,CACI,YADJ,EAEI,OAAA4xB,aAAA,CAAc,CAAC,KAAK0sE,YAAN,EAAoB,KAAK3lF,KAAzB,CAAd,EACK5F,IADL,CAEQ,YAAAlK,MAAA,CAAO;AAAA;AAAA,gBAAEkhF,IAAF;;AAAA,mBAAY,CAACA,IAAb;AAAA,WAAP,CAFR,EAGQ,YAAAjiF,GAAA,CAAI;AAAA;AAAA,gBAAE2R,CAAF;AAAA,gBAAKd,KAAL;;AAAA,mBAAgBA,KAAhB;AAAA,WAAJ,CAHR,EAIQ,QAAAgC,MAAA,CAAO,cAAA0O,gBAAP,CAJR,EAKQ,YAAAu7B,oBAAA,EALR,EAOK1kD,SAPL,CAOe,UAACkQ,IAAD,EAAuC;;;AAC9C,gBAAIA,IAAJ,EAAU;AACN,kBAAMhK,GAAG,GAAGgK,IAAI,CAACxN,MAAL,CAAYwyB,WAAZ,GAA0B,CAAtC;AACA,sBAAI,CAACgqE,UAAL,GAAkBh5F,GAAG,IAAI,CAAP,GAAW,IAAIA,GAAf,GAAqB,CAAvC;;AACA,kBAAMkf,QAAQ,GAAG,QAAI,CAAC0L,IAAL,CAAUja,SAAV,CAAoBtR,IAApB,CACb,UAACgU,CAAD,EAAO;AAAD;;AAAC,uBAAAA,CAAC,CAACvF,EAAF,MAAI,kBAAK9D,IAAI,CAACkL,QAAL,CAAc,CAAd,CAAL,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAE0L,IAAvB,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAE1B,QAA7B,MAAqC,IAArC,IAAqC,aAArC,GAAqC,MAArC,GAAqC,GAAEpR,EAA3C;AAA6C,eADvC,CAAjB;;AAGA,sBAAI,CAAC8qF,UAAL,GACA,CAAA15E,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEjI,OAAV,CAAkB,oBAAlB,OAAsC,oCACtCjN,IAAI,CAACkL,QAAL,CAAc7V,IAAd,CACI,UAAAorB,MAAM,EAAI;AAAD;;AAAA,qDAACA,MAAM,SAAN,IAAAA,MAAM,WAAN,GAAM,MAAN,GAAAA,MAAM,CAAE7J,IAAT,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAE1B,QAAf,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAEtM,SAAzB,MAAkC,IAAlC,IAAkC,aAAlC,GAAkC,MAAlC,GAAkC,GAAE0vB,cAApC,MAAkD,IAAlD,IAAkD,aAAlD,GAAkD,MAAlD,GAAkD,GAAE9xB,OAApD,MAA2D,IAA3D,IAA2D,aAA3D,GAA2D,MAA3D,GAA2D,GAAEooF,UAA7D;AAAuE,eADpF,CADsC,MAGrC,IAHqC,IAGrC,aAHqC,GAGrC,MAHqC,GAGrC,GAAEh4E,IAHmC,MAG/B,IAH+B,IAG/B,aAH+B,GAG/B,MAH+B,GAG/B,GAAE1B,QAH6B,MAGrB,IAHqB,IAGrB,aAHqB,GAGrB,MAHqB,GAGrB,GAAEtM,SAHmB,MAGV,IAHU,IAGV,aAHU,GAGV,MAHU,GAGV,GAAE0vB,cAHQ,MAGM,IAHN,IAGM,aAHN,GAGM,MAHN,GAGM,GAAE9xB,OAHR,MAGe,IAHf,IAGe,aAHf,GAGe,MAHf,GAGe,GAAEooF,UAHvD,CADA,CANM,CAWN;AACA;;AACA,kBAAMkB,IAAI,GAAG,QAAAnqC,sBAAA,CAAuB3lD,IAAI,CAACxN,MAA5B,CAAb;;AACA,sBAAI,CAAC88F,mBAAL,CAAyBtvF,IAAzB,cAAoC,OAAA3D,wBAAA,CAAyByzF,IAAzB,CAApC;;AACA,sBAAI,CAACvnF,KAAL,CAAW4hE,QAAX,CAAoB,QAAA7kB,kBAAA,CAAmB,cAAAxtC,mBAAA,CAAoB9X,IAApB,CAAnB,CAApB;;AACA,sBAAI,CAACoI,IAAL,CAAUpI,IAAV,CAAeA,IAAf;AACH,aAjBD,MAiBO;AACH;AACA,sBAAI,CAAC4iE,MAAL,CAAYj9B,QAAZ,CAAqB,CAAC,KAAD,CAArB,EAA8B;AAC1B00C,0BAAU,EAAE,IADc;AAE1BxI,0BAAU,EAAE,QAAI,CAACnmE;AAFS,eAA9B;AAIH;AACJ,WAhCL,CAFJ;AAqCA,eAAK9b,YAAL,CACI,SADJ,EAEI,KAAK2Y,KAAL,CAAW5F,IAAX,CAAgB,QAAA4H,MAAA,CAAO,cAAA2Q,qBAAP,CAAhB,EAA+CprB,SAA/C,CAAyD,UAACkQ,IAAD,EAAU;;;AAC/D,oBAAI,CAACivF,WAAL,CAAiBjvF,IAAjB,CAAsBA,IAAtB;;AACA,oBAAI,CAACkvF,mBAAL,CAAyBlvF,IAAzB,CAA8BA,IAA9B,EAF+D,CAG/D;;;AACA,oBAAI,CAAC+vF,iBAAL,GAAyB,OAAA/vF,IAAI,CAACiH,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAEiN,MAAd,IACnB,CAAD,WAAClU,IAAI,CAACiH,OAAN,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAEiN,MAAd,MAAoB,IAApB,IAAoB,aAApB,GAAoB,MAApB,GAAoB,GAAExc,GAAF,CAAM,QAAAkvD,qBAAN,CADD,GAEnB,EAFN;AAGH,WAPD,CAFJ;AAYA,eAAKh3D,YAAL,CACI,cADJ,EAEI,KAAK2Y,KAAL,CAAW5F,IAAX,CAAgB,QAAA4H,MAAA,CAAO,cAAA6Q,6BAAP,CAAhB,EAAuDtrB,SAAvD,CAAiE,UAACkQ,IAAD,EAAU;AACvE,oBAAI,CAACmvF,mBAAL,CAAyBnvF,IAAzB,CAA8BA,IAA9B;AACH,WAFD,CAFJ;AAOA,eAAKpQ,YAAL,CACI,gBADJ,EAEI,KAAK2Y,KAAL,CAAW5F,IAAX,CAAgB,QAAA4H,MAAA,CAAO,cAAA8Q,4BAAP,CAAhB,EAAsDvrB,SAAtD,CAAgE,UAACkQ,IAAD,EAAU;AACtE,oBAAI,CAACovF,sBAAL,CAA4BpvF,IAA5B,CAAiCA,IAAjC;AACH,WAFD,CAFJ;AAOA,eAAKpQ,YAAL,CACI,UADJ,EAEI,KAAK2Y,KAAL,CAAW5F,IAAX,CAAgB,QAAA4H,MAAA,CAAO,cAAAgR,6BAAP,CAAhB,EAAuDzrB,SAAvD,CAAiE,UAACkQ,IAAD,EAAU;AACvE,oBAAI,CAACqvF,eAAL,CAAqBrvF,IAArB,CAA0BA,IAA1B;AACH,WAFD,CAFJ;AAOA,eAAKsuF,qBAAL,GAA6B,KAAK/lF,KAAL,CAAW5F,IAAX,CACzB,QAAA4H,MAAA,CAAO,YAAA7D,qBAAP,CADyB,EAEzB,QAAA6D,MAAA,CAAO,YAAA9D,aAAA,CAAcK,SAAd,CAAwBC,eAA/B,CAFyB,EAGzB,WAAAogD,eAAA,EAHyB,EAIzB,YAAAzvD,GAAA,CAAI,cAAAslB,0BAAJ,CAJyB,EAKzB,YAAAgF,WAAA,CAAY,CAAZ,CALyB,CAA7B;AAQA,eAAKpyB,YAAL,CACI,cADJ,EAEI,KAAKggG,YAAL,CAAkBniE,YAAlB,CAA+B39B,SAA/B,CAAyC,UAACiF,KAAD,EAAW;;;AAChD,gBAAMm6F,mBAAmB,GAAGrjB,SAAS,CAAC,QAAI,CAACojB,WAAL,CAAiBl6F,KAAlB,CAArC;AACA,gBAAMi7F,aAAa,GAAG,CAAH,WAAG,QAAI,CAACf,WAAL,CAAiBl6F,KAAjB,CAAuBkS,OAA1B,MAAiC,IAAjC,IAAiC,aAAjC,GAAiC,MAAjC,GAAiC,GAAEiN,MAAhC,MAAsC,IAAtC,IAAsC,aAAtC,GAAsC,MAAtC,GAAsC,GAAEzb,MAAF,CAAS,UAAC2O,CAAD,EAAO;AACxE,kBAAIA,CAAC,CAACtD,EAAF,KAAS/O,KAAK,CAACA,KAAnB,EAA0B;AACtB,uBAAO,IAAP;AACH;;AACD,qBAAO,KAAP;AACH,aAL2D,CAA5D;AAMAm6F,+BAAmB,CAACjoF,OAApB,CAA4BiN,MAA5B,GAAqC87E,aAArC;;AACA,oBAAI,CAACd,mBAAL,CAAyBlvF,IAAzB,CAA8BkvF,mBAA9B;AACH,WAVD,CAFJ,EAtFW,CAqGX;;AACA,cAAI,CAAJ,KAAI,KAAKjpF,OAAL,MAAY,IAAZ,IAAY,aAAZ,GAAY,MAAZ,GAAY,GAAE26E,QAAlB,EAA4B;AACxB,iBAAKhe,MAAL,CAAYj9B,QAAZ,CAAqB,qBAArB,EAA4C;AACxC/4C,mBAAK,EAAE,MAAF,OAAE,CAAF,EAAE,EAAK,KAAKqZ,OAAV,CADiC;AAExCwsC,yBAAW,EAAE;AACT30C,uBAAO,EAAE;AADA;AAF2B,aAA5C;AAMH;;AAED,eAAKlO,YAAL,CACI,cADJ,EAEI,KAAKgyF,cAAL,CAAoB9xF,SAApB,CAA8B,UAACiF,KAAD,EAAW;;;AACrCA,iBAAK,KAAK,CAAV,IACI,QAAC,QAAI,CAACkR,OAAN,MAAa,IAAb,IAAa,aAAb,GAAa,MAAb,GAAa,GAAE26E,QAAf,CADJ,IAEI,QAAI,CAACr4E,KAAL,CAAW4hE,QAAX,CAAoB,QAAA7kB,kBAAA,CAAmB,cAAAxtC,mBAAA,CAAoB,QAAI,CAAC1P,IAAL,CAAUrT,KAA9B,CAAnB,CAApB,CAFJ;AAGA,aAACA,KAAK,KAAK,CAAV,KAAW,MAAI,QAAI,CAACkR,OAAT,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAE26E,QAA7B,CAAD,KACI,QAAI,CAACr4E,KAAL,CAAW4hE,QAAX,CACI,QAAAjwD,sBAAA,CAAuBjW,OAAvB,CAA+B,cAAA6T,mBAAA,CAAoB,QAAI,CAAC1P,IAAL,CAAUrT,KAA9B,CAA/B,CADJ,CADJ;AAIH,WARD,CAFJ;AAYH;;;0CAEwB;AACrB,eAAK44D,UAAL,GAAkBl8D,IAAI,CAAConB,GAAL,EAAlB;AACA,eAAKo3E,aAAL,GAAqB,IAArB;AACA,cAAMhB,WAAW,GAAGpjB,SAAS,CAAC,KAAKojB,WAAL,CAAiBl6F,KAAlB,CAA7B;AACA,eAAKm6F,mBAAL,CAAyBlvF,IAAzB,CAA8BivF,WAA9B;AACA,eAAKY,mBAAL,GAA2B,KAA3B;AACH;;;wCAEsBtwF,K,EAAY;AAC/B,eAAKswF,mBAAL,GAA2B,CAAC,CAACtwF,KAAK,CAACxL,MAAnC;AACH;;;oCAEkBwL,K,EAAO;AACtB,cAAIA,KAAJ,EAAW;AACP,iBAAK2wF,eAAL;AACH;AACJ;;;4CAE0B3wF,K,EAA4B;;;AACnD,cAAM4wF,OAAO,GAAG5wF,KAAK,CAAC7H,GAAN,CAAU,UAAC+kB,CAAD;AAAA,mBAAOA,CAAC,CAAC1nB,KAAT;AAAA,WAAV,CAAhB;AACA,cAAMm6F,mBAAmB,GAAGrjB,SAAS,CAAC,KAAKojB,WAAL,CAAiBl6F,KAAlB,CAArC;AACA,cAAMi7F,aAAa,GAAG,wBAAKf,WAAL,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAEl6F,KAAlB,MAAuB,IAAvB,IAAuB,aAAvB,GAAuB,MAAvB,GAAuB,GAAEkS,OAAzB,MAAgC,IAAhC,IAAgC,aAAhC,GAAgC,MAAhC,GAAgC,GAAEiN,MAAlC,IAChB,CAAD,uBAAC,KAAK+6E,WAAN,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAEl6F,KAAnB,MAAwB,IAAxB,IAAwB,aAAxB,GAAwB,MAAxB,GAAwB,GAAEkS,OAA1B,MAAiC,IAAjC,IAAiC,aAAjC,GAAiC,MAAjC,GAAiC,GAAEiN,MAAlC,MAAwC,IAAxC,IAAwC,aAAxC,GAAwC,MAAxC,GAAwC,GAAEzb,MAAF,CAAS,UAAC2O,CAAD,EAAO;AACpD,gBAAI+oF,OAAO,CAACxkF,QAAR,CAAiBvE,CAAC,CAACtD,EAAnB,CAAJ,EAA4B;AACxB,qBAAO,IAAP;AACH;;AACD,mBAAO,KAAP;AACH,WALuC,CADxB,GAOhB,EAPN;AAQAorF,6BAAmB,CAACjoF,OAApB,CAA4BiN,MAA5B,GAAqC87E,aAArC;AACA,eAAKd,mBAAL,CAAyBlvF,IAAzB,CAA8BkvF,mBAA9B;AACH;;;8CAE4B;AAAA;;AACzB,eAAKhB,YAAL,CAAkBluF,IAAlB,CAAuB,IAAvB;AACA,cAAMyxE,UAAU,GAAG,KAAKvF,MAAL,CAAYriE,IAAZ,CAAiB,+BAAA6nE,yBAAjB,EAA4C;AAC3D5nE,sBAAU,EAAE,WAD+C;AAE3D0vC,qBAAS,EAAE,KAFgD;AAG3DC,yBAAa,EAAE;AAH4C,WAA5C,CAAnB;AAKAg4B,oBAAU,CAACr+B,WAAX,GAAyBtjD,SAAzB,CAAmC;AAAA,mBAAM,QAAI,CAACo+F,YAAL,CAAkBluF,IAAlB,CAAuB,KAAvB,CAAN;AAAA,WAAnC;AACH;;;wCAEsB;AACnB,eAAKksE,MAAL,CAAYriE,IAAZ,CAAiB,+BAAAsqE,yBAAjB,EAA4C;AACxCrqE,sBAAU,EAAE,WAD4B;AAExC0vC,qBAAS,EAAE,KAF6B;AAGxCC,yBAAa,EAAE;AAHyB,WAA5C;AAKH;;;0CAEwBlkC,M,EAA2B;AAChD,kBAAQA,MAAR;AACI,iBAAK,cAAAxB,iBAAA,CAAkBkD,OAAvB;AACI,mBAAK1O,KAAL,CAAW4hE,QAAX,CAAoB,cAAA7jE,gBAAA,EAApB;AACA;;AACJ,iBAAK,cAAAyN,iBAAA,CAAkBmD,WAAvB;AACA,iBAAK,cAAAnD,iBAAA,CAAkBvf,QAAvB;AACI,mBAAK47F,mBAAL;AACA;AAPR;AASH;;;6CAE2B7wF,K,EAA0B;AAClD,eAAKqiF,cAAL,CAAoB5hF,IAApB,CAAyBT,KAAK,CAACxK,KAA/B;AACH;;;;MAvRqC,OAAAzG,a;;AArL1C;;;uBAqLa4lF,oB,EAAoB,8B,EAAA,+B,EAAA,uC,EAAA,kC,EAAA,4C,EAAA,iC;AAAA,K;;;YAApBA,oB;AAAoB,uC;AAAA,+C;AAAA,c;AAAA,a;AAAA,ooE;AAAA;AAAA;AAlLzB;;;;AAEI;;;;;;;mBA4II,CACR,aAAA7nF,OAAA,CAAQ,gBAAR,EAA0B,CACtB,aAAAO,KAAA,CACI,MADJ,EAEI,aAAAL,KAAA,CAAM;AACFE,gBAAM,EAAE,GADN;AAEFD,iBAAO,EAAE;AAFP,SAAN,CAFJ,CADsB,EAQtB,aAAAI,KAAA,CACI,QADJ,EAEI,aAAAL,KAAA,CAAM;AACF8jG,kBAAQ,EAAE,QADR;AAEF7jG,iBAAO,EAAE,CAFP;AAGFC,gBAAM,EAAE;AAHN,SAAN,CAFJ,CARsB,EAgBtB,aAAAH,UAAA,CAAW,iBAAX,EAA8B,aAAAI,OAAA,CAAQ,gBAAR,CAA9B,CAhBsB,CAA1B,CADQ,EAmBR,aAAAL,OAAA,CAAQ,aAAR,EAAuB,CACnB,aAAAO,KAAA,CACI,MADJ,EAEI,aAAAL,KAAA,CAAM;AACFqmD,kBAAQ,EAAE;AADR,SAAN,CAFJ,CADmB,EAOnB,aAAAhmD,KAAA,CACI,QADJ,EAEI,aAAAL,KAAA,CAAM;AACFqmD,kBAAQ,EAAE;AADR,SAAN,CAFJ,CAPmB,EAanB,aAAAtmD,UAAA,CAAW,iBAAX,EAA8B,aAAAI,OAAA,CAAQ,gBAAR,CAA9B,CAbmB,CAAvB,CAnBQ;;;;;;2BAoCHwnF,oB,EAAoB;cArLhC,OAAAxgC,SAqLgC;eArLtB;AACPjlD,kBAAQ,EAAE,kBADH;AAEPuxD,kBAAQ,4mPAFD;AAgJPpM,mBAAS,EAAE,CAAC,+BAAD,CAhJJ;AAiJPuH,oBAAU,EAAE,CACR,aAAA9uD,OAAA,CAAQ,gBAAR,EAA0B,CACtB,aAAAO,KAAA,CACI,MADJ,EAEI,aAAAL,KAAA,CAAM;AACFE,kBAAM,EAAE,GADN;AAEFD,mBAAO,EAAE;AAFP,WAAN,CAFJ,CADsB,EAQtB,aAAAI,KAAA,CACI,QADJ,EAEI,aAAAL,KAAA,CAAM;AACF8jG,oBAAQ,EAAE,QADR;AAEF7jG,mBAAO,EAAE,CAFP;AAGFC,kBAAM,EAAE;AAHN,WAAN,CAFJ,CARsB,EAgBtB,aAAAH,UAAA,CAAW,iBAAX,EAA8B,aAAAI,OAAA,CAAQ,gBAAR,CAA9B,CAhBsB,CAA1B,CADQ,EAmBR,aAAAL,OAAA,CAAQ,aAAR,EAAuB,CACnB,aAAAO,KAAA,CACI,MADJ,EAEI,aAAAL,KAAA,CAAM;AACFqmD,oBAAQ,EAAE;AADR,WAAN,CAFJ,CADmB,EAOnB,aAAAhmD,KAAA,CACI,QADJ,EAEI,aAAAL,KAAA,CAAM;AACFqmD,oBAAQ,EAAE;AADR,WAAN,CAFJ,CAPmB,EAanB,aAAAtmD,UAAA,CAAW,iBAAX,EAA8B,aAAAI,OAAA,CAAQ,gBAAR,CAA9B,CAbmB,CAAvB,CAnBQ;AAjJL,S;AAqLsB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/OjC;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAMA;AAAA;AAAA;;;;;;;;;;;;;;;;AAWgB;AAAgE;AAAkB;;;;;;AAClF;AAAqD;AAAmC;;;;;;AACxF;AAA4C;AAAiB;;;;;AAAjB;AAAA;;;;QAkB/CqoF,yB;AAwBT,2CAAc;AAAA;;AAlBP,aAAAz7E,OAAA,GAA+B,EAA/B;AAGA,aAAAg3F,WAAA,GAAc,IAAI,OAAAn/C,YAAJ,EAAd;AAGA,aAAAo/C,WAAA,GAAc,IAAI,OAAAp/C,YAAJ,EAAd;AAGA,aAAAq/C,SAAA,GAAY,IAAZ;AAEA,aAAA5iG,IAAA,GAAO,EAAP;AACA,aAAAiE,IAAA,GAAO,EAAP;AACA,aAAA4+F,MAAA,GAAS,EAAT;AACA,aAAA50D,KAAA,GAAQ,EAAR;AACA,aAAA60D,aAAA,GAAgB,EAAhB;AACA,aAAAC,WAAA,GAAc,EAAd;AAGN;;;;oCAEkBphG,O,EAAsB;AACrC,cAAIA,OAAO,CAAC6Y,IAAR,IAAgB7Y,OAAO,CAAC+J,OAA5B,EAAqC;AACjC,iBAAKs3F,cAAL;AACH;AACJ;;;mCAEc;AACX,eAAKA,cAAL;AACH;;;yCAGuB;;;AACpB,cAAI,CAAC,KAAKxoF,IAAV,EAAgB;AACZ;AACH;;AAHmB,2BAI0E,KAAKA,IAJ/E;AAAA,cAIZxV,QAJY,cAIZA,QAJY;AAAA,cAIFJ,MAJE,cAIFA,MAJE;AAAA,cAIM0Y,QAJN,cAIMA,QAJN;AAAA,cAIgB0M,QAJhB,cAIgBA,QAJhB;AAAA,cAI0B3B,WAJ1B,cAI0BA,WAJ1B;AAAA,cAIuCmC,YAJvC,cAIuCA,YAJvC;AAAA,cAIqDG,gBAJrD,cAIqDA,gBAJrD,EAOpB;;AAEA,cAAM9B,KAAK,GAAGvL,QAAQ,CAAC7V,IAAT,CAAc,UAAAsS,CAAC;AAAA,mBAAIA,CAAC,CAAC+R,WAAN;AAAA,WAAf,CAAd;;AACA,cAAIjD,KAAJ,EAAW;AACP,iBAAK7oB,IAAL,GAAY6oB,KAAK,CAAClD,YAAlB;AACH,WAFD,MAEO;AACH,iBAAK3lB,IAAL,GAAY,cAAA+uB,oBAAA,CAAqBzR,QAArB,CAAZ;AACH,WAdmB,CAgBpB;;;AACA,cAAMiO,WAAW,GAAG,mBAAAjO,QAAQ,CAAC,CAAD,CAAR,MAAW,IAAX,IAAW,aAAX,GAAW,MAAX,GAAW,GAAE0L,IAAb,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,MAAjB,GAAiB,GAAE1B,QAAnB,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAEze,QAA7B,MAAqC,kBAAIyU,QAAQ,CAAC,CAAD,CAAZ,MAAe,IAAf,IAAe,aAAf,GAAe,MAAf,GAAe,GAAE0L,IAAjB,MAAqB,IAArB,IAAqB,aAArB,GAAqB,MAArB,GAAqB,GAAEtP,IAAvB,MAA2B,IAA3B,IAA2B,aAA3B,GAA2B,MAA3B,GAA2B,GAAE7Q,QAAlE,CAApB;AACA,cAAMlD,SAAS,GAAG,IAAI,UAAAwP,MAAJ,CAAW;AAAClR,gBAAI,EAAEW,MAAM,CAACgJ,EAAd;AAAkB0d,uBAAW,EAAE,KAA/B;AAAsCC,uBAAW,EAAXA;AAAtC,WAAX,CAAlB;;AAEA,cAAGf,YAAH,EAAiB;AACb,gBAAMy4E,UAAU,GAAG,cAAA/zD,mBAAA,CAAoB,CAAD,KAAE,SAAI,IAAJ,aAAI,MAAJ,GAAI,MAAJ,QAAM10B,IAAP,MAAW,IAAX,IAAW,aAAX,GAAW,MAAX,GAAW,GAAEqQ,iBAAjC,CAAnB;AACH,gBAAMq4E,UAAU,GAAG,IAAI,UAAA/tF,MAAJ,CAAW;AAAClR,kBAAI,EAAEg/F,UAAU,CAACr1F,EAAlB;AAAsB0d,yBAAW,EAAE,KAAnC;AAA0CC,yBAAW,EAAXA;AAA1C,aAAX,CAAnB;AACC,iBAAKtnB,IAAL,kBAAoB,OAAAqB,sBAAA,CAAuBK,SAAvB,CAApB,oBAA+D,OAAAL,sBAAA,CAAuB49F,UAAvB,CAA/D;AACD,WAJD,MAKK;AACD,iBAAKj/F,IAAL,GAAY,OAAAqB,sBAAA,CAAuBK,SAAvB,CAAZ;AACH;;AAED,cAAMw9F,YAAY,GAAGx9F,SAAS,CAACJ,UAAV,WAAwB,OAAAwI,gBAAA,EAAxB,GAA8CW,iBAA9C,EAArB;AACA,cAAM+uF,OAAO,GAAG93F,SAAS,CAACb,QAAV,CAAmB;AAAEJ,mBAAO,EAAEM;AAAX,WAAnB,CAAhB;AACA,cAAMo+F,UAAU,GAAG,OAAAz0F,6BAAA,CAA8B8uF,OAA9B,CAAnB;AACA,eAAKoF,MAAL,aAAiBM,YAAjB,cAAiCC,UAAjC,EAhCoB,CAgC2B;;AAE/C,cAAMC,eAAe,GAAG,OAAAp4F,gBAAA,CAAiBjG,QAAjB,EAA2B,OAA3B,CAAxB;AACA,eAAKipC,KAAL,aAAgBo1D,eAAhB,eAAoCh7E,WAAW,CAACnY,OAAhD,eAA4D8Z,QAAQ,CAAC9Z,OAArE;AAEA,eAAK4yF,aAAL,GAAqB,KAAKp3F,OAAL,CAAa5B,GAAb,CAAiB,UAAA8B,CAAC;AAAA,mBAAIA,CAAC,CAAC+Z,YAAN;AAAA,WAAlB,EAAsCrY,IAAtC,CAA2C,IAA3C,CAArB;AACA,eAAKy1F,WAAL,GAAmB,KAAKr3F,OAAL,CAAavF,MAAb,GAAsB,CAAtB,cAA8B,KAAKuF,OAAL,CAAavF,MAA3C,SAAuD,EAA1E;AACH;;;;;;AA1GL;;;uBA6BaghF,yB;AAAyB,K;;;YAAzBA,yB;AAAyB,4C;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA;AAAA,O;AAAA,yC;AAAA,e;AAAA,a;AAAA,0lB;AAAA;AAAA;AA1B9B;AACI;AACI;AAAM;AAAQ;AACd;AAAM;AAAQ;AACd;AAAM;AAAU;AAChB;AAA6B;AAAS;AACtC;AACA;AACA;AACJ;AACA;AACI;AAEQ;AAAA,mBAAS,IAAAub,WAAA,OAAT;AAA2B,WAA3B;AACJ;AACJ;AACA;AAGI;AAAA,mBAAS,IAAAC,WAAA,OAAT;AAA2B,WAA3B;AAA6B;AACjC;AACJ;AACJ;;;;AApBc;AAAA;AACA;AAAA;AACA;AAAA;AACuB;AAAA;AACD;AAAA;AACM;AAAA;AACZ;AAAA;AASlB;AAAA;AAE6B;AAAA;;;;;;;;;2BAOpCxb,yB,EAAyB;cA7BrC,OAAArhC,SA6BqC;eA7B3B;AACPjlD,kBAAQ,EAAE,uBADH;AAEPuxD,kBAAQ,wwCAFD;AA2BPpM,mBAAS,EAAE,CAAC,oCAAD;AA3BJ,S;AA6B2B,Q;;;;gBAEjC,OAAAziD;;;gBAGA,OAAAA;;;gBAGA,OAAA0iD;;;gBAGA,OAAAA;;;gBAGA,OAAA1iD;;;;;;;;;;;;;;;;;;;;;;;;ACnEL;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACLQ;AACI;AACI;AACI;AACJ;AACA;AAAkB;AAAe;AACrC;AACJ;;;;;AAPsB;AAGA;AAAA;AAEI;AAAA;;;;;;AAG1B;;AACI;AACI;AACI;AACJ;AACA;AAAkB;AAAe;AACrC;AACJ;;;;;AAPuB;AAGD;AAAA;AAEI;AAAA;;;;;;AAd9B;AACI;AAQA;AAQJ;;;;;AAhBO;AAAA;AAQA;AAAA;;;;;;AAVX;AACI;AAkBJ;;;;;AAlBkB;AAAA;;;;QDgBL+/F,mB;;;;;AAKT,mCAAoBnjF,QAApB,EAAkD;AAAA;;AAAA;;AAC9C;AADgB,iBAAAA,QAAA,GAAAA,QAAA;AAHpB;;AACO,iBAAAojF,KAAA,GAA2B,EAA3B;AAE2C;AAEjD;AAED;;;;;mCACe;AAAA;;AACX,eAAKpjF,QAAL,CAAc3D,WAAd,CAA0BzH,IAA1B,CAA+B,YAAAyG,KAAA,CAAM,UAAAC,CAAC;AAAA,mBAAIA,CAAJ;AAAA,WAAP,CAA/B,EAA8CvZ,SAA9C,CAAwD,YAAM;AAC1D,oBAAI,CAACqhG,KAAL,GAAa,QAAI,CAACpjF,QAAL,CAAcd,OAAd,CAAsB,gBAAtB,KAA2C,EAAxD;AACH,WAFD;AAGH;;;;MAdoC,OAAA3e,a;;AALzC;;;uBAKa4iG,mB,EAAmB,2C;AAAA,K;;;YAAnBA,mB;AAAmB,oC;AAAA,+C;AAAA,c;AAAA,a;AAAA,sS;AAAA;AAAA;ACjBhC;;;;AAAyB;;;;;;;;;;2BDiBZA,mB,EAAmB;cAL/B,OAAAx9C,SAK+B;eALrB;AACPjlD,kBAAQ,EAAE,eADH;AAEPklD,qBAAW,EAAE,8BAFN;AAGPC,mBAAS,EAAE,CAAC,8BAAD;AAHJ,S;AAKqB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;AEjBhC;AAAA;AAAA;;AAOA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACNY;AACI;AACI;AAAkB;AAAc;AAChC;AAAkB;AAAc;AAChC;AAAqB;AAAiB;AAC1C;AACJ;;;;;AAN8C;AAEpB;AAAA;AACA;AAAA;AACG;AAAA;;;;;;;;AAXrC;AAKI;AAA+C;AAAA;AAAA;AAAA;AAAA;AAC3C;AAAqB;AAA4D;AACjF;AAOJ;AACJ;;;;;AAVgC;AAAA;AACH;AAAA;AACT;AAAA;;;;;;AAWZ;AACI;AACJ;;;;;AAF6C;AACzC;AAAA;;;;QDMHw9C,oB;;;;;AAkBT,oCACY5xB,MADZ,EAEYzuB,OAFZ,EAGYhjC,QAHZ,EAIY6S,IAJZ,EAIqC;AAAA;;AAAA;;AAEjC;AALQ,iBAAA4+C,MAAA,GAAAA,MAAA;AACA,iBAAAzuB,OAAA,GAAAA,OAAA;AACA,iBAAAhjC,QAAA,GAAAA,QAAA;AACA,iBAAA6S,IAAA,GAAAA,IAAA;AAjBZ;;AACiB,iBAAAywE,WAAA,GAAc,IAAI,OAAAlgD,YAAJ,EAAd;AACjB;;AACO,iBAAAmgD,gBAAA,GAA6B,SAAK1wE,IAAL,CAAU1L,QAAvC;AACP;;AACO,iBAAAq8E,aAAA,GAA4B,EAA5B;AACP;;AACO,iBAAAC,UAAA,GAAuC,EAAvC;AAU8B;AAGpC;;;;mCAEiB;AAAA;;AACd,eAAK5wE,IAAL,CAAUxwB,MAAV,CAAiB,WAAjB,EAA8BuS,IAA9B,CAAmC,YAAAyG,KAAA,CAAM,UAAAC,CAAC;AAAA,mBAAI,CAAC,CAACA,CAAF,IAAO,CAAC,CAACA,CAAC,CAACtV,MAAf;AAAA,WAAP,CAAnC,EAAkEjE,SAAlE,CAA4E,YAAM;AAC9E,oBAAI,CAACF,YAAL,CACI,aADJ,EAEI,QAAI,CAAC4vE,MAAL,CAAYmJ,aAAZ,CAA0B74E,SAA1B,CAAoC,UAAAwsC,MAAM,EAAI;AAC1C;AACA,kBAAIA,MAAM,CAAC6pC,GAAP,CAAW,OAAX,CAAJ,EAAyB;AACrB,oBAAMxsC,QAAQ,GAAG2C,MAAM,CAAC/0B,GAAP,CAAW,OAAX,CAAjB;;AACA,oBAAMwV,KAAK,GAAG,QAAI,CAAC6D,IAAL,CAAUiX,WAAV,CAAsB8B,QAAtB,CAAd;;AACA,wBAAI,CAAC5c,KAAL,GAAaA,KAAK,CAACjZ,EAAnB;;AACA,wBAAI,CAAC2tF,WAAL,CAAiB10E,KAAK,CAACmb,WAAvB;;AACA,wBAAI,CAACm5D,WAAL,CAAiB9+C,IAAjB,CAAsB,QAAI,CAACx1B,KAA3B;;AACA,wBAAI,CAACtvB,YAAL,CAAkB,gBAAlB;AACH;AACJ,aAVD,CAFJ;;AAcA,oBAAI,CAAC8jG,aAAL,GAAqB,QAAI,CAAC3wE,IAAL,CAAUja,SAA/B;;AACA,oBAAI,CAACnW,OAAL,CAAa,gBAAb,EAA+B,YAAM;AACjC;AACA,kBAAI,CAAC,QAAI,CAAC0kB,QAAV,EAAoB;AAChB,wBAAI,CAACu8E,WAAL,CAAiB,QAAI,CAAC7wE,IAAL,CAAU1L,QAAV,CAAmBpR,EAApC;AACH;;AACD,sBAAI,CAACutF,WAAL,CAAiB9+C,IAAjB,CAAsB,QAAI,CAACx1B,KAA3B;AACH,aAND;AAOH,WAvBD;AAwBH;;;oCAEkBud,M,EAAgB;AAAA;;AAC/B,cAAMplB,QAAQ,GAAG,KAAK0L,IAAL,CAAUja,SAAV,CAAoBtR,IAApB,CAAyB,UAAA4iC,GAAG;AAAA,mBAAIA,GAAG,CAACn0B,EAAJ,KAAWw2B,MAAf;AAAA,WAA5B,CAAjB;AACA;;;AACA,cAAIplB,QAAJ,EAAc;AACV,iBAAKo8E,gBAAL,GAAwBp8E,QAAxB;AACA,iBAAKA,QAAL,GAAgBolB,MAAhB;AACA,iBAAK1Z,IAAL,CAAU1L,QAAV,GAAqBA,QAArB;AACA,iBAAKs8E,UAAL,GAAkBt8E,QAAQ,CAACxN,MAA3B;AACA;;AACA,gBAAI,KAAK8pF,UAAL,CAAgBz9F,MAAhB,IAA0B,CAAC,KAAKy9F,UAAL,CAAgBn8F,IAAhB,CAAqB,UAAAokC,GAAG;AAAA,qBAAIA,GAAG,CAAC31B,EAAJ,KAAW,QAAI,CAACiZ,KAApB;AAAA,aAAxB,CAA/B,EAAmF;AAC/E,mBAAKqpD,WAAL,CAAiB,KAAKorB,UAAL,CAAgB,CAAhB,EAAmB1tF,EAApC;AACH;AACJ;AACJ;;;oCAEkB4tF,M,EAAgB;AAC/B,eAAK30E,KAAL,GAAa20E,MAAb;AACA,eAAKL,WAAL,CAAiB9+C,IAAjB,CAAsB,KAAKx1B,KAA3B;;AACA,eAAKg0B,OAAL,CAAapL,QAAb,CAAsB,EAAtB,EAA0B;AACtBksC,sBAAU,EAAE,KAAKrS,MADK;AAEtB/sB,uBAAW,EAAE;AAAE11B,mBAAK,EAAE20E;AAAT;AAFS,WAA1B;AAIH;;;4BA9D6B;AAC1B,iBAAO,CAAC,CAAC,KAAK3jF,QAAL,CAAcd,OAAd,CAAsB,iCAAtB,CAAT;AACH;;;;MAhBqC,OAAA3e,a;;AAL1C;;;uBAKa8iG,oB,EAAoB,uC,EAAA,+B,EAAA,2C,EAAA,4C;AAAA,K;;;YAApBA,oB;AAAoB,qC;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,gV;AAAA;AAAA;AC1BjC;AACI;AAgBA;AACI;AAAyB;AAAA;AAAA,aAAiB,aAAjB,EAAiB;AAAA,mBAAgB,IAAAhrB,WAAA,QAAhB;AAAmC,WAApD;AACrB;AAGJ;AACJ;AACJ;;;;AApBQ;AAAA;AAcyB;AAAA;AACT;AAAA;;;;;;;;;2BDOXgrB,oB,EAAoB;cALhC,OAAA19C,SAKgC;eALtB;AACPjlD,kBAAQ,EAAE,gBADH;AAEPklD,qBAAW,EAAE,+BAFN;AAGPC,mBAAS,EAAE,CAAC,+BAAD;AAHJ,S;AAKsB,Q;;;;;;;;;;;;gBAE5B,OAAAziD;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AEhCL;AAAA;AAAA;;AAOA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACwB4B;AAOI;AACI;AAAkB;AAAmB;AACrC;AAOJ;AACJ;;;;;AAdI,mFAA+B,aAA/B,EAA+B,wBAA/B;AAKsB;AAAA;AAEd;AAAA;;;;;;AAXhB;AACI;AAkBJ;;;;;AAjBQ;AAAA;;;;;;AAnBZ;AACI;AAKI;AACI;AAAkB;AAAe;AACjC;AAOJ;AACJ;AACA;AAoBJ;;;;;AAnCQ;AAAA,+EAA2B,aAA3B,EAA2B,oBAA3B;AAKsB;AAAA;AAEd;AAAA;AAQE;AAAA;;;;;;;;;;;;;;AAsBd;;AACI;AACI;AAAkB;AAAe;AACjC;AAOJ;AACJ;;;;;AAXG;AAEuB;AAAA;AAEd;AAAA;;;;;;AA5CpB;AACI;AAsCA;AAcJ;;;;;;;;AApDkB;AAAA,6CAAsC,UAAtC,EAAsC,GAAtC;;;;;;;;;;;;;;;;;;;;;AAuD1B;AAAA;AAEA;;;;;AAAA;AAAA,kCAAM,gBAAN;AAAA;;;;;;;;;;;;QDvDK89C,oB;;;;;AAsBT,oCAAoB5jF,QAApB,EAAkD;AAAA;;AAAA;;AAC9C;AADgB,iBAAAA,QAAA,GAAAA,QAAA;AAnBpB;;AACiB,iBAAA6jF,UAAA,GAAa,IAAI,OAAAzgD,YAAJ,EAAb;AAkBiC;AAEjD;AAlBD;;;;;;AAyBA;gCACe;AACX,eAAKrsB,IAAL,GAAY,KAAZ;AACA,eAAK8sE,UAAL,CAAgBr/C,IAAhB,CAAqB,KAAKztB,IAA1B;AACH;;;uCAEqB;AAAA;;AAClB,eAAKt0B,OAAL,CAAa,OAAb,EAAsB;AAAA,mBAAM,QAAI,CAACylC,KAAL,EAAN;AAAA,WAAtB,EAA0C,EAA1C;AACH;;;sCAEoB;AAAA;;AACjB,eAAKzlC,OAAL,CAAa,cAAb,EAA6B;AAAA,mBAAM,QAAI,CAAC/C,YAAL,CAAkB,OAAlB,CAAN;AAAA,WAA7B,EAA+D,EAA/D;AACH;;;4BApCoB;AACjB,cAAMud,QAAQ,GAAG,KAAK+C,QAAL,CAAcd,OAAd,CAAsB,kBAAtB,KAA6C;AAAEpd,iBAAK,EAAE;AAAT,WAA9D;AACA,iBAAOmb,QAAQ,CAACnb,KAAT,IAAkB,EAAzB;AACH;AAED;;;;4BACoB;AAChB,iBAAO,CAAC,KAAKke,QAAL,CAAcd,OAAd,CAAsB,kBAAtB,KAA6C,EAA9C,EAAkD4kF,SAAlD,IAA+D,EAAtE;AACH;;;4BAEqB;AAClB,cAAM7mF,QAAQ,GAAG,KAAK+C,QAAL,CAAcd,OAAd,CAAsB,kBAAtB,KAA6C;AAAE4vC,oBAAQ,EAAE;AAAZ,WAA9D;AACA,iBAAO7xC,QAAP;AACH;AAMD;;;;4BACe;AACX,iBAAO,UAAA1P,OAAA,CAAQ,IAAI7J,IAAJ,EAAR,EAAoB29C,QAA3B;AACH;;;;MA7BqC,OAAA9gD,a;;AAL1C;;;uBAKaqjG,oB,EAAoB,2C;AAAA,K;;;YAApBA,oB;AAAoB,qC;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,e;AAAA,c;AAAA,ikB;AAAA;AAAA;ACrBjC;AAKI;AAAA,mBAAS,IAAAG,YAAA,EAAT;AAAuB,WAAvB;AAEA;AAAkB;AAAA,mBAAS,IAAAC,WAAA,EAAT;AAAsB,WAAtB;AACd;AACI;AACA;AAAwB;AAAA,mBAAS,IAAA97D,KAAA,EAAT;AAAgB,WAAhB;AACpB;AAGJ;AACJ;AACA;AACI;AACI;AAsDJ;AACJ;AACA;AAGJ;AACJ;;;;AA5EI,mGAA4C,QAA5C,EAA4C,kEAA5C,EAA4C,MAA5C,EAA4C,QAA5C;AAUgB;AAAA;AAMU;AAAA;AAwDF;AAAA;;;;;;;;;;2BDrDf07D,oB,EAAoB;cALhC,OAAAj+C,SAKgC;eALtB;AACPjlD,kBAAQ,EAAE,gBADH;AAEPklD,qBAAW,EAAE,+BAFN;AAGPC,mBAAS,EAAE,CAAC,+BAAD;AAHJ,S;AAKsB,Q;;;;;;gBAE5B,OAAAziD;;;gBAEA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AEzBL;AAAA;AAAA;;AAOA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;AAoBoB;AAAkC;AAAkB;;;;;;;;;;;;AAHxD;AAGI;AACJ;;;;;;AAFI;AACM;AAAA;;;;;;AAbd;AACI;AASA;AAKJ;AACA;;;;;AAbQ;AAAA,2CAAoB,QAApB,EAAoB,GAApB,EAAoB,eAApB,EAAoB,KAApB,EAAoB,UAApB,EAAoB,IAApB,EAAoB,MAApB,EAAoB,IAApB,EAAoB,MAApB,EAAoB,KAApB;AAQA;AAAA;;;;;;AAYA;AAAkC;AAAkB;;;;;;AALxD;AAKI;AACJ;;;;;;AAJI;AAGM;AAAA;;;;;;AANd;AACI;AAOJ;;;;;AANQ;AAAA;;;;QAYPm+C,+B;;;;;AAgBT,+CAAoBj+C,KAApB,EAA4C;AAAA;;AAAA;;AACxC;AADgB,iBAAAA,KAAA,GAAAA,KAAA;AARb,iBAAA51B,UAAA,GAAa,IAAI,OAAA7wB,eAAJ,CAAwC,EAAxC,CAAb;AAEA,iBAAAowB,WAAA,GAAkC,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAQhmB,GAAR,CAAY,UAAAkmB,CAAC,EAAI;AACtD,iBAAO;AAACD,gBAAI,yCAAkCC,CAAlC;AAAL,WAAP;AACH,SAFwC,CAAlC;AAIA,iBAAA8tB,MAAA,GAAS,KAAT;AAEqC;AAE3C;;;;mCAEc;AAAA;;AACX,cAAM5qC,UAAU,GAAG,GAAnB;;AAEA,cAAI1J,MAAJ,EAAY;AACR,iBAAKs0C,MAAL,GAAct0C,MAAM,CAAC2J,UAAP,GAAoBD,UAAlC;AACH;;AAED,iBAAAwuE,SAAA,CAAUl4E,MAAV,EAAkB,QAAlB,EAA4BuL,IAA5B,CAAiC,YAAA4sE,YAAA,CAAa,GAAb,CAAjC,EAAoD5sE,IAApD,CAAyD,YAAA6sE,GAAA,CAAI;AACzDxvE,gBAAI,EAAE,cAAAy/D,GAAG,EAAI;AACT,kBAAMz7D,MAAM,GAAGy7D,GAAG,CAACz7D,MAAnB;AACA,sBAAI,CAAC0nC,MAAL,GAAc1nC,MAAM,CAACjD,UAAP,GAAoBD,UAAlC;AACH;AAJwD,WAAJ,CAAzD,EAKIhR,SALJ;AAMA,wBAAAstB,eAAA,CAAgB,IAAhB,EAAsB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,CAAtB,EAA+B,KAAKG,aAApC,EAAmD,KAAKC,QAAxD,EAAkE,KAAKC,YAAvE;AACA,eAAK7tB,YAAL,CACF,cADE,EAEF,KAAKuuB,UAAL,CAAgBruB,SAAhB,CAA0B,UAACmiG,MAAD,EAAgC;AACzD,gBAAGA,MAAM,CAACl+F,MAAV,EAAkB,QAAI,CAAC2pB,WAAL,GAAoBu0E,MAApB;;AAClB,oBAAI,CAACl+C,KAAL,CAAWqB,aAAX;AACA,WAHD,CAFE;AAMH;;;kCAEgBz3B,I,EAAM;AACnB,iBAAOA,IAAI,CAAChS,QAAL,CAAc,aAAd,CAAP;AACH;;;4BAEmB;AAChB,iBAAQ,IAAIla,IAAJ,EAAD,CAAa83B,OAAb,EAAP;AACH;;;;MAhDgD,OAAAroB,c;;AAnCrD;;;uBAmCa8wF,+B,EAA+B,0C;AAAA,K;;;YAA/BA,+B;AAA+B,mD;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,c;AAAA,a;AAAA,6Y;AAAA;AAAA;AAhCpC;AACI;AAiBA;AASJ;;;;AA1BS;AAAA;AAiBA;AAAA;;;;;;;;;;2BAcJA,+B,EAA+B;cAnC3C,OAAAt+C,SAmC2C;eAnCjC;AACPjlD,kBAAQ,EAAE,8BADH;AAEPuxD,kBAAQ,6zCAFD;AAgCPpM,mBAAS,EAAE,CAAC,2CAAD,CAhCJ;AAiCP2B,yBAAe,EAAE,OAAAC,uBAAA,CAAwBC;AAjClC,S;AAmCiC,Q;;;;;;gBAGvC,OAAAtkD;;;gBACA,OAAAA;;;gBAGA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;ACvDL;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAGA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZQ;AACI;AACI;AAAgE;AAAA;AAAA;AAAA;AAAA;AAC5D;AACJ;AACA;AACI;AACJ;AACJ;AACA;AACI;AAAoB;AAAA;AAAA;AAAA;AAAA;AAApB;AACA;AAAoB;AAAA;AAAA;AAAA;AAAA;AAApB;AACJ;AACJ;;;;;;;;AAeQ;AACI;AAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AACH;AAAmB;AACxB;;;;;AAJQ;AAAA,wCAAiB,OAAjB,EAAiB,WAAjB;AAGH;AAAA;;;;;;;;AAjBb;AACI;AACI;AAAgE;AAAA;AAAA;AAAA;AAAA;AAC5D;AACJ;AACA;AACI;AACA;AACA;AAAG;AAA6B;AACpC;AACJ;AACA;AACI;AAOA;AACI;AACI;AAAO;AAAmB;AAC1B;AACI;AAAA;AAAA;AAAA;AAAA;AAEH;AACH;AACN;AACJ;AACA;AACI;AAG0B;AAAA;AAAA;AAAA;AAAA,WAA2B,iBAA3B,EAA2B;AAAA;AAAA;AAAA;AAAA,SAA3B;AAEzB;AACL;AACJ;;;;;AAzBa;AAAA;AAmBD;AAAA,4CAAqB,cAArB,EAAqB,IAArB;;;;;;;;AAQZ;AACI;AACI;AAAgE;AAAA;AAAA;AAAA;AAAA;AAC5D;AACJ;AACJ;AAEA;AACI;AACI;AACJ;AACA;AAGyB;AAAA;AAAA;AAAA;AAAA;AACxB;AACL;AACJ;;;;AALY;AAAA,4CAAqB,cAArB,EAAqB,IAArB;;;;QD/CPwkF,oB;;;;;AACT,oCACoCt7C,KADpC,EAEYvxB,SAFZ,EAGYmoC,WAHZ,EAG2D;AAAA;;AAAA;;AAEvD;AAJgC,iBAAA5W,KAAA,GAAAA,KAAA;AACxB,iBAAAvxB,SAAA,GAAAA,SAAA;AACA,iBAAAmoC,WAAA,GAAAA,WAAA;AAKZ;;AACO,iBAAA7/B,KAAA,GAAQ,EAAR;AACA,iBAAA8gF,KAAA,GAAQ,OAAR;AACA,iBAAAC,OAAA,GAAU,EAAV;AAEA,iBAAAC,SAAA,GAAY;AACfC,oBAAU,EAAE,CADG;AAEfC,oBAAU,EAAE,CAFG;AAGfC,yBAAe,EAAE,kBAHF;AAIfC,wBAAc,EAAE,+BAJD;AAKf/9E,iBAAO,EAAE,EALM;AAMf3Q,YAAE,EAAE;AANW,SAAZ;AASA,iBAAA2uF,OAAA,GAAU;AACbC,sBAAY,EAAE,EADD;AAEbC,kBAAQ,EAAE,IAFG;AAGbC,0BAAgB,EAAE,EAHL;AAIbC,kBAAQ,EAAE;AAJG,SAAV;AAnBoD;AAG1D,O,CAuBD;;;;;wCACoB;AAChB,eAAKJ,OAAL,CAAaE,QAAb,GAAwB,KAAxB;AACA,eAAKT,KAAL,GAAa,WAAb;AACH;;;mCAEc;AAAA;;AACX;AACA,eAAKppF,SAAL,CAAesB,WAAf,CAA2BzH,IAA3B,CAAgC,YAAAyG,KAAA,CAAM,UAAAC,CAAC;AAAA,mBAAIA,CAAJ;AAAA,WAAP,CAAhC,EAA+CvZ,SAA/C,CAAyD,YAAM;AAC3D,gBAAMshB,KAAK,GAAG,QAAI,CAACtI,SAAL,CAAesE,IAAf,CAAoBgE,KAAlC;AACA,oBAAI,CAACA,KAAL,GAAaA,KAAb;AACA,oBAAI,CAAC+gF,OAAL,GAAe,QAAI,CAACrpF,SAAL,CAAesE,IAAf,CAAoBC,YAApB,CAAiCvS,OAAjC,CAAyC,QAAI,CAACgO,SAAL,CAAesE,IAAf,CAAoB1B,KAA7D,EAAoE,qBAApE,CAAf;;AACA,oBAAI,CAAConF,2BAAL,CAAiC1hF,KAAjC,EAAwC,QAAI,CAACipB,KAA7C;AACH,WALD;AAMH;;;oDAEkCjpB,K,EAAe2hF,U,EAAoB;AAAA;;AAClE,cAAI7kF,OAAJ,CAAiB,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAClC,gBAAM7C,GAAG,aAAM,QAAI,CAAC4mF,OAAX,wBAAgCY,UAAhC,CAAT;AACA,gBAAI9iF,MAAM,GAAQ,IAAlB;;AACA,oBAAI,CAACnH,SAAL,CAAeoH,IAAf,CAAoB3I,GAApB,CAAwBgE,GAAxB,EAA6Bzb,SAA7B,CACI,UAACkD,CAAD;AAAA,qBAAQid,MAAM,GAAGjd,CAAjB;AAAA,aADJ,EAEI,UAACkJ,CAAD,EAAO;AACHkS,oBAAM,CAAClS,CAAD,CAAN;AACH,aAJL,EAKI,YAAM;AACFiS,qBAAO,CAAC8B,MAAD,CAAP;AACH,aAPL;AASH,WAZD,EAYG1B,IAZH,CAYQ,UAAAvb,CAAC,EAAI;AACT,oBAAI,CAACo/F,SAAL,GAAiBp/F,CAAjB;AACA,oBAAI,CAACy/F,OAAL,GAAe;AACXC,0BAAY,EAAE,QAAI,CAACN,SAAL,CAAetuF,EADlB;AAEX6uF,sBAAQ,EAAE,IAFC;AAGXC,8BAAgB,EAAE,QAAI,CAACR,SAAL,CAAe39E,OAAf,CAAuB/c,GAAvB,CAA2B,UAAAga,CAAC;AAAA,uBAAK;AAC/C5N,oBAAE,EAAE4N,CAAC,CAAC5N,EADyC;AAE/CkvF,yBAAO,EAAE;AAFsC,iBAAL;AAAA,eAA5B,CAHP;AAOXH,sBAAQ,EAAE;AAPC,aAAf;AASH,WAvBD,WAuBS,UAAA32F,CAAC,EAAI;AACV3E,mBAAO,CAACV,GAAR,CAAY,OAAZ,EAAqBqF,CAArB;AACH,WAzBD;AA0BH,S,CAED;;;;qCACoBnH,K,EAAY;AAAA;;AAC5B,eAAK09F,OAAL,CAAaG,gBAAb,CAA8Bv+E,IAA9B,CAAmC,UAACoI,CAAD,EAAIvsB,CAAJ,EAAU;AACzC,gBAAIusB,CAAC,CAAC3Y,EAAF,KAAS/O,KAAK,CAAC+O,EAAnB,EAAuB;AACnB,sBAAI,CAAC2uF,OAAL,CAAaG,gBAAb,CAA8B1iG,CAA9B,EAAiC8iG,OAAjC,GAA2C,CAAC,QAAI,CAACP,OAAL,CAAaG,gBAAb,CAA8B1iG,CAA9B,EAAiC8iG,OAA7E;AACA,qBAAO,IAAP;AACH;AACJ,WALD;AAMH,S,CAED;;;;sCACqBC,M,EAAa;AAC9B,eAAKR,OAAL,CAAaI,QAAb,GAAwBI,MAAM,CAACjvF,MAAP,CAAcjP,KAAtC;AACH,S,CAED;;;;kCACiB;AAAA;;AACb,cAAImZ,OAAJ,CAAiB,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAClC,gBAAI6B,MAAM,GAAQ,IAAlB;;AACA,oBAAI,CAACnH,SAAL,CAAeoH,IAAf,CAAoBO,IAApB,CAAyB,QAAI,CAAC0hF,OAA9B,EAAuC,QAAI,CAACM,OAA5C,EAAqD3iG,SAArD,CACI,UAACkD,CAAD;AAAA,qBAAQid,MAAM,GAAGjd,CAAjB;AAAA,aADJ,EAEI,UAACkJ,CAAD,EAAO;AACHkS,oBAAM,CAAClS,CAAD,CAAN;AACH,aAJL,EAKI,YAAM;AACFiS,qBAAO,CAAC8B,MAAD,CAAP;AACH,aAPL;AASH,WAXD,EAWG1B,IAXH,CAWQ,UAAAvb,CAAC,EAAI;AACT,oBAAI,CAACk/F,KAAL,GAAa,MAAb;;AACA,oBAAI,CAAC9e,UAAL,CAAgB,IAAhB;AACH,WAdD,WAcS,UAAAl3E,CAAC,EAAI;AACV3E,mBAAO,CAACV,GAAR,CAAY,OAAZ,EAAqBqF,CAArB;AACA,oBAAI,CAACg2F,KAAL,GAAa,MAAb;;AACA,oBAAI,CAAC9e,UAAL,CAAgB,IAAhB;AACH,WAlBD;AAoBH,S,CAED;;;;qCAC4C;AAAA;;AAAA,cAA1B8f,OAA0B,uEAAP,KAAO;;AACxC,cAAIA,OAAJ,EAAa;AACT,iBAAK1iG,OAAL,CAAa,YAAb,EAA2B,YAAM;AAC7B,sBAAI,CAACygD,WAAL,CAAiBhb,KAAjB;AACH,aAFD,EAEG,IAFH;AAGH,WAJD,MAIO;AACH,iBAAKgb,WAAL,CAAiBhb,KAAjB;AACH;AACJ;;;;MA3HqC,OAAAhpC,S;;AAN1C;;;uBAMa0oF,oB,EAAoB,qBAEjB,SAAAliC,eAFiB,C,EAEF,wC,EAAA,qC;AAAA,K;;;YAFlBkiC,oB;AAAoB,qC;AAAA,+C;AAAA,c;AAAA,a;AAAA,yzB;AAAA;AAAA;ACtBjC;AACI;AACI;AAgBA;AAuCA;AAkBJ;AACJ;;;;AA1Ea;AAAA;AAgBA;AAAA;AAuCA;AAAA;;;;;;;;;;2BDnCAA,oB,EAAoB;cANhC,OAAAjiC,SAMgC;eANtB;AACPjlD,kBAAQ,EAAE,gBADH;AAEPklD,qBAAW,EAAE,+BAFN;AAGPC,mBAAS,EAAE,CAAC,+BAAD,CAHJ;AAIPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AAJ1B,S;AAMsB,Q;;;;kBAExB,OAAA0pB,M;mBAAO,SAAA+S,e;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AExBhB;AAAA;AAAA;;AAQA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAUA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsBY;AACI;AAEQ;AAAA;AAAA;AAAA;AAAA;AACJ;AACJ;AACJ;;;;;AAJY;AAAA;AAEc;AAAA;;;;;;AAKlB;AACmC;AAAkB;;;;;AADH;AACf;AAAA;;;;;;AACnC;;;;;;AAAmD;;;;;;AAHvD;AACI;AAEA;AAGJ;;;;;AALyB;AAAA;AAEE;AAAA;;;;;;AAJ/B;AACI;AAOJ;;;;;AAPsB;AAAA;;;;;;;;AAQtB;AACI;AAEI;AAAA;AAAA;AAAA;AAAA;AACA;AACJ;AACJ;;;;;AAJQ;AAAA;AAEkB;AAAA;;;;;;;;AAG1B;AACI;AAEI;AAAA;AAAA;AAAA,iBAAS,QAAAw4B,aAAA,MAAmB,IAAnB,CAAT;AAAiC,SAAjC;AACA;AACJ;AACJ;;;;;AAJQ;AAAA;AAEkB;AAAA;;;;;;;;AAG1B;AACI;AAEI;AAAA;AAAA;AAAA,iBAAS,QAAAA,aAAA,MAAmB,IAAnB,CAAT;AAAiC,SAAjC;AACA;AACJ;AACJ;;;;;AAJQ;AAAA;AAEkB;AAAA;;;;AApDtC,QAAYjK,gBAAZ;;AAAA,eAAYA,gBAAZ,EAA4B;AACxB;AACA;AACH,KAHD,EAAYA,gBAAgB,GAAhB,QAAAA,gBAAA,aAAAA,gBAAA,GAAgB,EAAhB,CAAZ;;QA8EamxB,qB;;;;;AAwCT,qCAAoB5qF,KAApB,EACYK,SADZ,EAEYooC,OAFZ,EAGYtlC,KAHZ,EAIYqlC,OAJZ,EAI6B;AAAA;;AAAA;;AACzB;AALgB,iBAAAxoC,KAAA,GAAAA,KAAA;AACR,iBAAAK,SAAA,GAAAA,SAAA;AACA,iBAAAooC,OAAA,GAAAA,OAAA;AACA,iBAAAtlC,KAAA,GAAAA,KAAA;AACA,iBAAAqlC,OAAA,GAAAA,OAAA;AAvCZ;;AACgB,iBAAAm5B,KAAA,GAAiB,KAAjB;AAChB;;AACgB,iBAAAkpB,SAAA,GAAqB,KAArB;AAChB;;AACgB,iBAAAC,QAAA,GAAoB,KAApB;AAGhB;;AACgB,iBAAAvqC,IAAA,GAAyBkZ,gBAAgB,CAAC0qB,IAA1C;AAKhB;;AACiB,iBAAA4G,UAAA,GAAa,IAAI,OAAAniD,YAAJ,EAAb;AACjB;;AACiB,iBAAA86B,aAAA,GAAgB,IAAI,OAAA96B,YAAJ,EAAhB;AACjB;;AACiB,iBAAAoiD,MAAA,GAAS,IAAI,OAAApiD,YAAJ,EAAT;AAGjB;;AACO,iBAAAqiD,SAAA,GAAqB,KAArB;AACP,iBAAAnoB,YAAA,GAAwB,KAAxB;AAMO,iBAAAooB,eAAA,GAA2D,IAA3D;AAEA,iBAAArtF,gBAAA,GAAyB,IAAI3U,IAAJ,EAAzB;AACA,iBAAAiiG,UAAA,GAAqB,IAArB;AAMsB;AAE5B;;;;mCAEc;AAAA;;AACX,eAAKnrF,KAAL,CAAW4hE,QAAX,CAAoB,eAAAniE,iBAAA,CAAkB/D,OAAlB,EAApB;;AACA,eAAK2E,SAAL,CAAewB,WAAf,CAA2BzH,IAA3B,CAAgC,YAAAyG,KAAA,CAAM,UAAAC,CAAC;AAAA,mBAAIA,CAAJ;AAAA,WAAP,CAAhC,EAA+CvZ,SAA/C,CAAyD,YAAM;AAC3D,oBAAI,CAAC6jG,IAAL,GAAY,QAAI,CAAC/qF,SAAL,CAAerB,GAAf,oBAA+B,QAAI,CAACuhD,IAApC,MAA+C;AAAEhyD,kBAAI,EAAE;AAAR,aAA3D;AACH,WAFD;;AAGA,eAAKtG,OAAL,CAAa,eAAb,EAA8B;AAAA,mBAAM,QAAI,CAACgwD,WAAL,CAAiBpjD,QAAQ,CAACohB,KAA1B,CAAN;AAAA,WAA9B;;AACA,eAAKuyB,OAAL,CAAanjC,MAAb,CAAoB9d,SAApB,CAA8B,UAACyP,KAAD,EAA0B;AACpD;AACA,gBAAIA,KAAK,YAAY,SAAAkhD,aAArB,EAAoC;AAChC,sBAAI,CAACjwD,OAAL,CAAa,eAAb,EAA8B;AAAA,uBAAM,QAAI,CAACgwD,WAAL,CAAiBpjD,QAAQ,CAACohB,KAA1B,CAAN;AAAA,eAA9B;AACH;AACJ,WALD,EANW,CAaX;;;AACA,cAAI,CAAC,KAAK60E,QAAV,EAAoB;AAChB;AACA,iBAAKzjG,YAAL,CAAkB,iBAAlB,EAAqC,KAAK2Y,KAAL,CAAW5F,IAAX,CACjC,YAAA6xC,oBAAA,EADiC,EAEnC1kD,SAFmC,CAEzB,UAACkQ,IAAD,EAA2B;;;AACnC,kBAAM0zF,UAAU,GAAG,CAAH,6BAAG1zF,IAAI,CAACm7B,YAAR,MAAoB,IAApB,IAAoB,aAApB,GAAoB,MAApB,GAAoB,GAAE/yB,IAAtB,MAA0B,IAA1B,IAA0B,aAA1B,GAA0B,MAA1B,GAA0B,GAAEnB,OAA5B,MAAmC,IAAnC,IAAmC,aAAnC,GAAmC,MAAnC,GAAmC,GAAE2B,SAArC,MAA8C,IAA9C,IAA8C,aAA9C,GAA8C,MAA9C,GAA8C,GAAE0vB,cAA7C,MAA2D,IAA3D,IAA2D,aAA3D,GAA2D,MAA3D,GAA2D,GAAEs7D,WAAhF;;AACA,kBAAIF,UAAU,IAAI,QAAI,CAACA,UAAL,KAAoBA,UAAtC,EAAkD;AAC9C,wBAAI,CAACA,UAAL,GAAkBA,UAAlB;AACH;;AACD,kBAAI,OAAA1zF,IAAI,CAACgZ,WAAL,MAAgB,IAAhB,IAAgB,aAAhB,GAAgB,MAAhB,GAAgB,GAAE5S,gBAAlB,KAAsC,QAAI,CAACA,gBAAL,CAAsBmjB,OAAtB,KAAkCvpB,IAAI,CAACgZ,WAAL,CAAiB5S,gBAAjB,CAAkCmjB,OAAlC,EAA5E,EAAyH;AACrH,wBAAI,CAACnjB,gBAAL,GAAwB,IAAI3U,IAAJ,CAASuO,IAAI,CAACgZ,WAAL,CAAiB5S,gBAAjB,CAAkCmjB,OAAlC,EAAT,CAAxB;;AACA,wBAAI,CAACsqE,iBAAL;AACH;AACJ,aAXoC,CAArC;AAYH;;AAGD,eAAKjkG,YAAL,CAAkB,YAAlB,EAAgC,KAAK2Y,KAAL,CAAW5F,IAAX,CAC5B,QAAA4H,MAAA,CAAO,cAAA0O,gBAAP,CAD4B,EAE5B,YAAAu7B,oBAAA,EAF4B,EAG9B1kD,SAH8B,CAGpB,UAACkQ,IAAD,EAAuC;AAC/C,gBAAIA,IAAJ,EAAU;AACN,sBAAI,CAACqrE,YAAL,GAAoBrrE,IAAI,CAAC8C,MAAL,KAAgB,cAAAwW,YAAA,CAAaC,IAAjD;AACH;AACJ,WAP+B,CAAhC;AAQH;;;oCAEkBrO,Q,EAAU;AACzBA,kBAAQ,GAAGA,QAAQ,CAAC0pB,MAAT,CAAgB,CAAhB,EAAmB1pB,QAAQ,CAACjW,OAAT,CAAiB,IAAjB,CAAnB,CAAX;AACA,eAAKq1E,WAAL,GAAmBp/D,QAAnB;AACH;AAED;;;;mCACkB;AACd,eAAKg+B,IAAL,GAAY,IAAZ;AACA,eAAKoqD,UAAL,CAAgB/gD,IAAhB,CAAqB,KAAKrJ,IAA1B;AACH;;;mCAEuB;;;;;;;;AACpB,yBAAKmiC,YAAL,IAAqB,KAAKmG,sBAAL,EAArB;;AACA,2BAAM,KAAKzgC,OAAL,CAAapL,QAAb,CAAsB,CAAC,CAAD,KAAC,KAAKmuD,YAAL,MAAiB,IAAjB,IAAiB,aAAjB,GAAiB,EAAjB,GAAqB,GAAtB,CAAtB,CAAN;;;AACA;AACA,yBAAK9iD,OAAL,CAAampC,QAAb;;;;;;;;;AACH;;;iDAG4B;AAC/B,eAAK5xE,KAAL,CAAW4hE,QAAX,CAAoB,cAAAjkE,oBAAA,EAApB;AACA,eAAKqC,KAAL,CAAW4hE,QAAX,CAAoB,QAAApwD,mBAAA,CAAoB2oC,KAApB,EAApB;AACA;;;mCAEoB;AACdtrD,gBAAM,CAACyS,IAAP,CAAY,OAAAmgE,IAAA,CAAKC,IAAjB;AACH;;;uCAEqB;AAClB;AACA,eAAK1hE,KAAL,CAAW4hE,QAAX,CAAoB,cAAAhkE,iBAAA,EAApB;AACH;;;4CAE0B;AAAA;;AACvB,cAAI,CAAC,KAAKqtF,SAAN,IAAmB,CAAC,KAAKC,eAA7B,EAA8C;AAC1C,iBAAKD,SAAL,GAAiB,IAAjB;AACA,iBAAKC,eAAL,GAAuB,KAAKziD,OAAL,CAAannC,IAAb,CAAkB,yBAAA8rE,oBAAlB,EAAwC;AAC3DjkC,0BAAY,EAAE,IAD6C;AAE3D5nC,wBAAU,EAAE,kBAF+C;AAG3D1B,kBAAI,EAAE,KAAKsrF,UAHgD;AAI3Dl6C,uBAAS,EAAE,KAJgD;AAK3DC,2BAAa,EAAE;AAL4C,aAAxC,CAAvB;AAOA,iBAAKg6C,eAAL,CAAqBrgD,WAArB,GAAmCtjD,SAAnC,CAA6C,YAAM;AAC/C,sBAAI,CAAC0jG,SAAL,GAAiB,KAAjB;AACA,sBAAI,CAACC,eAAL,GAAuB,IAAvB;AACH,aAHD;AAIH;AAEJ;;;wCAE4B;;;;;;AACzB,yBAAKF,MAAL,CAAYhhD,IAAZ;;AACA,2BAAM,KAAKxB,OAAL,CAAapL,QAAb,CAAsB,KAAKouD,IAAL,CAAUroF,KAAhC,EAAuC;AAAE+mC,iCAAW,EAAE,KAAKshD,IAAL,CAAUthD;AAAzB,qBAAvC,CAAN;;;;;;;;;AACH;;;4BAhHqB;AAClB,iBAAO,OAAA43B,mBAAA,CAAoB,KAAKC,WAAzB,CAAP;AACH;;;;MAjCsC,OAAAh8E,a;;AAhE3C;;;uBAgEa6kG,qB,EAAqB,8B,EAAA,wC,EAAA,kC,EAAA,uC,EAAA,+B;AAAA,K;;;YAArBA,qB;AAAqB,sC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,e;AAAA,c;AAAA,+jC;AAAA;AAAA;AA7D1B;AACI;AAOA;AASA;AAOA;AAOA;AAOA;AACI;AAGI;AAAA,mBAAS,IAAAa,YAAA,EAAT;AAAuB,WAAvB;AAEA;AACA;AAAM;AAAQ;AAClB;AACA;AAGQ;AAAA,mBAAS,IAAAC,QAAA,EAAT;AAAmB,WAAnB;AAEA;AACA;AAAM;AAAI;AAClB;AACJ;AACJ;;;;AAxDK;AACuB;AAAA;AAOkB;AAAA;AASR;AAAA;AAOA;AAAA;AAOA;AAAA;AAU1B;AAAA;AAGkB;AAAA;AAKd;AAAA;AAGkB;AAAA;;;;;;;;;;2BAS7Bd,qB,EAAqB;cAhEjC,OAAAz/C,SAgEiC;eAhEvB;AACPjlD,kBAAQ,EAAE,iBADH;AAEPuxD,kBAAQ,wxGAFD;AA6DPpM,mBAAS,EAAE,CAAC,gCAAD;AA7DJ,S;AAgEuB,Q;;;;;;;;;;;;;;gBAI7B,OAAAziD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;gBAEA,OAAA0iD;;;gBAEA,OAAAA;;;gBAEA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;AChJL;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAKA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXoB;AAAsD;AAAkB;;;;;AAAvC;AAAqB;AAAA;;;;;;AACtD;;;;;;AAAkC;;;;;;;;AANtD;AACI;AACI;AACI;AACI;AACI;AACA;AACJ;AACJ;AACA;AACI;AACI;AACI;AAAA;AAQA;AACA;AACI;AAAA;AAAA;AAOA;AAAA;AACyB;AAE7B;AACJ;AACA;AACI;AAAA;AAQA;AACA;AACI;AAAA;AAMI;AAAA;AAAA;AAAA;AAAA;AANJ;AAQA;AAAA;AACiC;AAErC;AACJ;AACJ;AACJ;AACA;AACI;AAAmB;AAAA;AAAA;AAAA;AAAA;AAAnB;AAA8D;AAClE;AACJ;AACJ;AACJ;;;;;AA/Dc;AAAA;AACkB;AAAA;AAET;AAAA;AACE;AAAA;AAQG;AAAA;AAuBA;AAAA;;;;;;;;;;;;;;;;;;AA8BxB;AACI;AACI;AACJ;AACA;AAAA;AAAkE;AACtE;;;;QDjDSqgD,c;;;;;AAQT,8BAAoBnmF,QAApB,EAA0D8sB,MAA1D,EAAgF;AAAA;;AAAA;;AAC5E;AADgB,iBAAA9sB,QAAA,GAAAA,QAAA;AAAsC,iBAAA8sB,MAAA,GAAAA,MAAA;AAAsB;AAE/E;;;;mCAEc;AAAA;;AACX,eAAK/vB,OAAL,GAAe,IAAf;AACA,eAAKkD,IAAL,GAAY,IAAI,QAAAihB,SAAJ,CAAc;AACtBklE,oBAAQ,EAAE,IAAI,QAAA3nE,WAAJ,CAAgB,EAAhB,EAAoB,CAAC,QAAAE,UAAA,CAAWC,QAAZ,CAApB,CADY;AAEtBynE,oBAAQ,EAAE,IAAI,QAAA5nE,WAAJ,CAAgB,EAAhB,EAAoB,CAAC,QAAAE,UAAA,CAAWC,QAAZ,CAApB;AAFY,WAAd,CAAZ;;AAIA,eAAK5e,QAAL,CAAc3D,WAAd,CAA0BzH,IAA1B,CAA+B,YAAAyG,KAAA,CAAM,UAAAC,CAAC;AAAA,mBAAIA,CAAJ;AAAA,WAAP,CAA/B,EAA8CvZ,SAA9C,CAAwD,YAAM;AAC1D,oBAAI,CAACgb,OAAL,GAAe,KAAf;AACA,oBAAI,CAAC6oF,IAAL,GAAY,QAAI,CAAC5lF,QAAL,CAAcd,OAAd,CAAsB,gBAAtB,KAA2C;AAAEnW,kBAAI,EAAE;AAAR,aAAvD;AACH,WAHD;AAIH;AAED;;;;gCACe;AAAA;;AACX,eAAKgU,OAAL,GAAe,IAAf;AACA,cAAMkD,IAAI,GAAG,KAAKA,IAAL,CAAUjZ,KAAvB;;AACA,eAAK8lC,MAAL,CAAYw5D,KAAZ,CAAkB;AACdF,oBAAQ,EAAEnmF,IAAI,CAACmmF,QADD;AAEdC,oBAAQ,EAAEpmF,IAAI,CAAComF;AAFD,WAAlB,EAGG;AAAEpmF,gBAAI,EAAE;AAAR,WAHH,EAGmBO,IAHnB,CAGwB,YAAM;AAC1B,oBAAI,CAACzD,OAAL,GAAe,KAAf;AACH,WALD,EAKG,YAAM;AACL,oBAAI,CAACA,OAAL,GAAe,KAAf;;AACA,oBAAI,CAACkD,IAAL,CAAUovB,QAAV,CAAmBg3D,QAAnB,CAA4BE,SAA5B,CAAsC;AAAEzhE,mBAAK,EAAE;AAAT,aAAtC;AACH,WARD;AASH;;;;MArC+B,OAAAvkC,a;;AALpC;;;uBAKa4lG,c,EAAc,2C,EAAA,qC;AAAA,K;;;YAAdA,c;AAAc,gC;AAAA,+C;AAAA,c;AAAA,a;AAAA,soB;AAAA;AAAA;ACvB3B;AAkEA;;;;;;AAlEmB,8CAAoC,UAApC,EAAoC,GAApC;;;;;;;;;;2BDuBNA,c,EAAc;cAL1B,OAAAxgD,SAK0B;eALhB;AACPjlD,kBAAQ,EAAE,WADH;AAEPklD,qBAAW,EAAE,wBAFN;AAGPC,mBAAS,EAAE,CAAC,wBAAD;AAHJ,S;AAKgB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;AEvB3B;AAAA;AAAA;;;;;;;;;;QAuDaw9C,oB;AAsBT,sCAAc;AAAA;;AApBP,aAAAmD,YAAA,GAAe,IAAI,OAAApjD,YAAJ,EAAf;AAGA,aAAAqjD,WAAA,GAAc,IAAI,OAAArjD,YAAJ,EAAd;AAGA,aAAAsjD,YAAA,GAAe,IAAI,OAAAtjD,YAAJ,EAAf;AAGA,aAAAujD,SAAA,GAAY,IAAI,OAAAvjD,YAAJ,EAAZ;AAEG,aAAAwjD,WAAA,GAAc,IAAI,OAAAxjD,YAAJ,EAAd;AAEH,aAAAwd,QAAA,GAAW,IAAX;AAOS;;;;iCALP;AACL,eAAKgmC,WAAL,CAAiBpiD,IAAjB;AACA,eAAKoc,QAAL,GAAgB,CAAC,KAAKA,QAAtB;AACH;;;mCAIO,CAAW;;;;;;AAxEvB;;;uBAgDayiC,oB;AAAoB,K;;;YAApBA,oB;AAAoB,uC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA,e;AAAA,a;AAAA,wvB;AAAA;AAAA;AA7CzB;AACI;AACI;AAGI;AAAA,mBAAS,IAAAoD,WAAA,OAAT;AAA2B,WAA3B;AAGA;AACJ;AACA;AAGI;AAAA,mBAAS,IAAAD,YAAA,OAAT;AAA4B,WAA5B;AAGA;AACJ;AACA;AAGI;AAAA,mBAAS,IAAAE,YAAA,OAAT;AAA4B,WAA5B;AAGA;AACJ;AACA;AACI;AAAA,mBAAS,IAAAG,MAAA,EAAT;AAAiB,WAAjB;AAGA;AAQJ;AACJ;AACJ;;;;AARgB;AAAA;;;;;;;;;2BAaXxD,oB,EAAoB;cAhDhC,OAAA19C,SAgDgC;eAhDtB;AACPjlD,kBAAQ,EAAE,kBADH;AAEPuxD,kBAAQ,0yDAFD;AA6CPpM,mBAAS,EAAE,CAAC,+BAAD,CA7CJ;AA8CPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkBuxB;AA9C1B,S;AAgDsB,Q;;;;gBAC5B,OAAAxqC;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;gBAGA,OAAAA;;;;;;;;;;;;;;;;;;;;;;;;ACpEL;AAAA;AAAA;;AASA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgBgB;AAEI;AAAA;AAAA;AAAA;AAAA;AAEI;AACR;;;;QAkCHghD,mB;;;;;AA4CT,qCAAc;AAAA;;AAAA;;AACV;AA3CG,iBAAApW,aAAA,GAAgB,YAAAA,aAAA,EAAhB;AASA,iBAAAqW,sBAAA,GAAyB,IAAI,OAAA3jD,YAAJ,EAAzB;AASA,iBAAA4jD,mBAAA,GAAsB,IAAI,OAAA5jD,YAAJ,EAAtB;AAMA,iBAAA6jD,mBAAA,GAAsB,IAAI,OAAA7jD,YAAJ,EAAtB;AAMA,iBAAA8jD,WAAA,GAAc,IAAI,OAAA9jD,YAAJ,EAAd;AAEA,iBAAA+jD,eAAA,GAAkB,IAAI,QAAA1oE,WAAJ,EAAlB;AAEA,iBAAA2oE,YAAA,GAAe,IAAI,QAAA3oE,WAAJ,EAAf;AAEA,iBAAAojE,YAAA,GAAe,IAAI,QAAApjE,WAAJ,EAAf;AAIA,iBAAAqjE,mBAAA,GAAsB,KAAtB;AAEO;AAEb;;;;mCAEc;AAAA;;AACX,eAAKjgG,YAAL,CAAkB,iBAAlB,EACI,KAAKslG,eAAL,CAAqBznE,YAArB,CAAkC39B,SAAlC,CAA4C,UAAAiF,KAAK;AAAA,mBAAI,QAAI,CAAC+/F,sBAAL,CAA4BviD,IAA5B,CAAiCx9C,KAAjC,CAAJ;AAAA,WAAjD,CADJ;AAEA,eAAKnF,YAAL,CAAkB,cAAlB,EACI,KAAKulG,YAAL,CAAkB1nE,YAAlB,CAA+B39B,SAA/B,CAAyC,UAAAiF,KAAK;AAAA,mBAAI,QAAI,CAACggG,mBAAL,CAAyBxiD,IAAzB,CAA8Bx9C,KAA9B,CAAJ;AAAA,WAA9C,CADJ;AAEA,eAAKnF,YAAL,CAAkB,cAAlB,EACI,KAAKggG,YAAL,CAAkBniE,YAAlB,CAA+B39B,SAA/B,CAAyC,UAAAiF,KAAK,EAAI;AAC9C,oBAAI,CAACigG,mBAAL,CAAyBziD,IAAzB,CAA8Bx9C,KAA9B;;AACA,oBAAI,CAACkgG,WAAL,CAAiB1iD,IAAjB;AACH,WAHD,CADJ;AAKH;;;0CAEwB;AACrB,eAAKob,UAAL,GAAkBl8D,IAAI,CAAConB,GAAL,EAAlB;AACA,eAAKo3E,aAAL,GAAqB,IAArB;AACA,eAAKJ,mBAAL,GAA2B,KAA3B,CAHqB,CAIrB;AACH;;;wCAEsBtwF,K,EAAY;AAC/B,eAAKswF,mBAAL,GAA2B,CAAC,CAACtwF,KAAK,CAACxL,MAAnC;AACH;;;;MArEoC,OAAAzF,a;;AArDzC;;;uBAqDaumG,mB;AAAmB,K;;;YAAnBA,mB;AAAmB,sC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,e;AAAA,c;AAAA,o+B;AAAA;AAAA;AAlDxB;AACI;AACI;AAOA;AAAA,mBAAmB,IAAAvnC,eAAA,QAAnB;AAA0C,WAA1C;AACC;AACD;AAMA;AACI;AAAA,mBAAS,IAAA2nC,WAAA,OAAT;AAA2B,WAA3B;AAEI;AACR;AACJ;AACA;AACI;AAOA;AAOA;AAMJ;AACJ;;;;AA1CQ;AAAA,4DAA+B,YAA/B,EAA+B,cAA/B,EAA+B,SAA/B,EAA+B,UAA/B,EAA+B,aAA/B,EAA+B,gBAA/B;AASI;AAAA;AAaA;AAAA,6CAAoB,eAApB,EAAoB,oBAApB,EAAoB,aAApB,EAAoB,mBAApB,EAAoB,SAApB,EAAoB,aAApB,EAAoB,UAApB,EAAoB,0DAApB;AAOA;AAAA,6CAAoB,eAApB,EAAoB,iBAApB,EAAoB,aAApB,EAAoB,gBAApB,EAAoB,SAApB,EAAoB,UAApB,EAAoB,UAApB,EAAoB,oDAApB;AASA;AAAA;;;;;;;;;2BASPJ,mB,EAAmB;cArD/B,OAAAnhD,SAqD+B;eArDrB;AACPjlD,kBAAQ,EAAE,iBADH;AAEPuxD,kBAAQ,0vEAFD;AAkDPpM,mBAAS,EAAE,CAAC,8BAAD,CAlDJ;AAmDPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkBuxB;AAnD1B,S;AAqDqB,Q;;;;gBAI3B,OAAAltF;;;gBAGA,OAAAA;;;gBAGA,OAAA0iD;;;gBAGA,OAAA1iD;;;gBAGA,OAAAA;;;gBAGA,OAAA0iD;;;gBAGA,OAAA1iD;;;gBAGA,OAAA0iD;;;gBAGA,OAAA1iD;;;gBAGA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;ACjGL;AAAA;AAAA;;AASA;AAAA;AAAA;;;;;;;;;;;;;;;;;;AAgBgB;AAEI;AAAA;AAAA;AAAA;AAAA,WAA4B,UAA5B,EAA4B;AAAA;AAAA;AAAA;AAAA,SAA5B;AAGA;AACJ;;;AAfhB;;;;;QAuBauhD,mB;AACT,mCACqChtF,IADrC,EAC8D;AAAA;;AAAzB,aAAAA,IAAA,GAAAA,IAAA;AAEpC;;;;2CAEyB;AACtB,cAAI,KAAKA,IAAL,CAAU2zE,eAAV,CAA0BkC,YAA1B,IAA0C,KAAK71E,IAAL,CAAUoc,IAAxD,EAA8D;AAC1D,iBAAKpc,IAAL,CAAU2zE,eAAV,CAA0BkC,YAA1B,CAAuC,KAAK71E,IAAL,CAAUoc,IAAjD;AACH;AACJ;;;;;;AA9BL;;;uBAoBa4wE,mB,EAAmB,qBAEhB,sBAAAhX,gBAFgB,C;AAEA,K;;;YAFnBgX,mB;AAAmB,sC;AAAA,c;AAAA,a;AAAA,ka;AAAA;AAAA;AAjBxB;AACI;AACI;AACA;AAOJ;AACA;AACJ;;;;AAVQ;AAAA;AAC2C;AAAA;;;;;;;;;2BAc9CA,mB,EAAmB;cApB/B,OAAA1hD,SAoB+B;eApBrB;AACPjlD,kBAAQ,EAAE,iBADH;AAEPuxD,kBAAQ,onBAFD;AAiBPpM,mBAAS,EAAE,CAAC,8BAAD,CAjBJ;AAkBPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkBuxB;AAlB1B,S;AAoBqB,Q;;;;kBAEvB,OAAA39C,M;mBAAO,sBAAA09C,gB;;;;;;;;;;;;;;;;;;;;;;;;;ACzChB;AAAA;AAAA;;AASA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAoBA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AAQA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAyEaiX,kB;;;;;AAmDT,kCACY9sF,KADZ,EAEW2jE,MAFX,EAGYnK,cAHZ,EAIYa,MAJZ,EAKY13D,QALZ,EAMYQ,KANZ,EAMiC;AAAA;;AAAA;;AAE7B;AAPQ,iBAAAnD,KAAA,GAAAA,KAAA;AACD,iBAAA2jE,MAAA,GAAAA,MAAA;AACC,iBAAAnK,cAAA,GAAAA,cAAA;AACA,iBAAAa,MAAA,GAAAA,MAAA;AACA,iBAAA13D,QAAA,GAAAA,QAAA;AACA,iBAAAQ,KAAA,GAAAA,KAAA;AAvDL,iBAAAi0E,UAAA,GAAsB,IAAtB;AAEA,iBAAAhF,IAAA,GAAO,IAAI,OAAArtF,eAAJ,CAAoB,YAAAstF,cAApB,CAAP;AAEA,iBAAAC,MAAA,GAAS,IAAI,OAAAvtF,eAAJ,CAA2B,YAAAwtF,YAA3B,CAAT;AACA,iBAAAqE,SAAA,GAAY,IAAI,OAAA7xF,eAAJ,CAAmC,EAAnC,CAAZ;AAEA,iBAAAsyF,eAAA,GAAkB,IAAI,OAAAtyF,eAAJ,CAA4CwG,SAA5C,CAAlB;AACA,iBAAAytC,QAAA,GAAW,OAAA/f,aAAA,CAAc,CAAC,SAAKo+D,eAAN,CAAd,EAAsCj9E,IAAtC,CACd,YAAAjL,GAAA,CAAI,UAAC7H,KAAD;AAAA,iBAAWA,KAAK,CAAC4I,MAAN,CAAa,UAACvI,CAAD;AAAA,mBAAO,CAAC,CAACA,CAAT;AAAA,WAAb,CAAX;AAAA,SAAJ,CADc,CAAX;AAIA,iBAAA+/E,WAAA,GAAc,IAAI,OAAA3iF,eAAJ,CAAsDwG,SAAtD,CAAd;AAEA,iBAAA+rF,eAAA,GAAkB,IAAI,OAAAvyF,eAAJ,CAAgC,EAAhC,CAAlB;AACA,iBAAAwyF,YAAA,GAAe,IAAI,OAAAxyF,eAAJ,CAA6B,EAA7B,CAAf;AACA,iBAAAyyF,cAAA,GAAiB,IAAI,OAAAzyF,eAAJ,CAA0CwG,SAA1C,CAAjB;AACA,iBAAAksF,WAAA,GAAc,IAAI,OAAA1yF,eAAJ,CAA+CwG,SAA/C,CAAd;AACA,iBAAAmsF,WAAA,GAAc,IAAI,OAAA3yF,eAAJ,CAAuCwG,SAAvC,CAAd;AAEP;;AACO,iBAAAosF,SAAA,GAAY,IAAI,OAAA5yF,eAAJ,CAAuD,EAAvD,CAAZ;AAEA,iBAAAyiF,MAAA,GAAS,SAAKiQ,WAAL,CAAiBr9E,IAAjB,CAAsB,YAAAjL,GAAA,CAAI,UAACqlB,KAAD,EAAW;AAAD;;AAAA,uBAACA,KAAK,SAAL,IAAAA,KAAK,WAAL,GAAK,MAAL,GAAAA,KAAK,CAAE0d,OAAR,MAAe,IAAf,IAAe,aAAf,GAAe,EAAf,GAAmB,EAAnB;AAAqB,SAAnC,CAAtB,CAAT;AAEA,iBAAA0lD,gBAAA,GAAmB,IAAI,OAAA7yF,eAAJ,CAAyC,EAAzC,CAAnB;AACA,iBAAA8yF,oBAAA,GAAuB,IAAI,OAAA9yF,eAAJ,CAAyC,EAAzC,CAAvB;AACA,iBAAA+yF,gBAAA,GAAmB,IAAI,OAAA/yF,eAAJ,CAAyC,EAAzC,CAAnB;AAEA,iBAAAgzF,oBAAA,GAAuB,OAAA9+D,aAAA,CAAc,CAAC,SAAKu+D,cAAN,EAAsB,SAAKI,gBAA3B,CAAd,EAA4Dx9E,IAA5D,CAC1B,YAAAjL,GAAA,CAAI;AAAA;AAAA,cAAEwd,QAAF;AAAA,cAAY+C,SAAZ;;AAAA,iBAA2BA,SAAS,CAAC5iB,IAAV,CAAe,UAACsS,CAAD;AAAA,mBAAOA,CAAC,CAAC5S,KAAF,MAAYmgB,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAEpR,EAAtB,CAAP;AAAA,WAAf,CAA3B;AAAA,SAAJ,CAD0B,CAAvB;AAIA,iBAAAy8E,iBAAA,GAAoB,SAAKP,WAAL,CAAiBr9E,IAAjB,CAAsB,YAAAjL,GAAA,CAAI,cAAAolB,wBAAJ,CAAtB,CAApB;AACA,iBAAA0jE,iBAAA,GAAoB,SAAKP,WAAL,CAAiBt9E,IAAjB,CAAsB,YAAAjL,GAAA,CAAI,QAAAkvD,qBAAJ,CAAtB,CAApB;AACA,iBAAA65B,eAAA,GAAkB,IAAI,OAAAnzF,eAAJ,CAAiDwG,SAAjD,CAAlB;AAGG,iBAAA6gG,WAAA,GAAc,IAAI,OAAAxjD,YAAJ,EAAd,CAiBuB,CAfjC;;AACO,iBAAA0jB,MAAA,GAAS,IAAT;AAiBH,iBAAKygC,SAAL,GAAiBpqF,QAAQ,CAACy1E,QAAT,EAAjB;AAH6B;AAIhC;;;;0CAhBiB;AAChB,eAAKgU,WAAL,CAAiBpiD,IAAjB;AACA,eAAKsiB,MAAL,GAAc,CAAC,KAAKA,MAApB;AACD;;;mCAec;AAAA;;;;AACX,eAAKjlE,YAAL,CACI,kBADJ,EAEI,KAAK2Y,KAAL,CAAW5F,IAAX,CAAgB,QAAA4H,MAAA,CAAO,cAAAkP,sBAAP,CAAhB,EAAgD3pB,SAAhD,CAA0D,UAACkQ,IAAD,EAAU;AAChE,oBAAI,CAACmgF,gBAAL,CAAsBngF,IAAtB,CAA2BA,IAA3B,EADgE,CAEhE;;;AACA,gBAAM+gF,IAAI,GAAG,QAAb;AACA/yF,sBAAU,CAAC,YAAM;AACb+yF,kBAAI,CAACC,oBAAL,CAA0BD,IAAI,CAACZ,gBAAL,CAAsBprF,KAAtB,CAA4B,CAA5B,CAA1B;AACH,aAFS,EAEP,CAFO,CAAV;AAGH,WAPD,CAFJ;AAWA,eAAKnF,YAAL,CACI,qBADJ,EAEI,OAAA4xB,aAAA,CAAc,CACV,KAAKjZ,KAAL,CAAW5F,IAAX,CACI,QAAA4H,MAAA,CAAO,cAAA4Q,wBAAP,CADJ,EAEI,YAAAzjB,GAAA,CAAI,UAACG,CAAD;AAAA,mBAAqCA,CAAC,CAACoP,OAAvC;AAAA,WAAJ,CAFJ,CADU,EAKV,KAAK84E,cAAL,CAAoBp9E,IAApB,CAAyB,WAAAwkD,eAAA,EAAzB,CALU,EAMV,KAAK64B,WAAL,CAAiBr9E,IAAjB,CAAsB,WAAAwkD,eAAA,EAAtB,CANU,CAAd,EAOGr3D,SAPH,CAOa,kBAAuC;AAAA;AAAA,gBAArCglB,cAAqC;AAAA,gBAArBI,QAAqB;AAAA,gBAAX6H,KAAW;;AAChD,gBAAMkkE,mBAAmB,GAAG,CAACnsE,cAAc,CAACZ,MAAf,IAAyB,EAA1B,EAA8Bzb,MAA9B,CACxB,UAAC2O,CAAD;AAAA,qBAAO,CAAC,CAACA,CAAC,CAACmwB,MAAJ,IAAcnwB,CAAC,CAAC+N,KAAF,CAAQxJ,QAAR,CAAiBuJ,QAAQ,CAACpR,EAA1B,CAArB;AAAA,aADwB,CAA5B;;AAGA,oBAAI,CAACg8E,YAAL,CAAkB9/E,IAAlB,CAAuBihF,mBAAvB;;AAEA,gBAAM9B,SAAS,GAAkB,EAAjC;AACA,gBAAML,MAAM,GAAsC,EAAlD;AACA,gBAAMoC,UAAU,GAAG,QAAI,CAACnf,cAAL,CAAoBx6D,GAApB,CAAwB,oBAAxB,KAAiD,EAApE;AACA05E,+BAAmB,CAAChxF,OAApB,CAA4B,UAAC8kB,KAAD,EAAW;AACnC,kBAAMsB,MAAM,GAAGvB,cAAc,CAACD,SAAf,CAAyBE,KAAK,CAACjR,EAA/B,CAAf;AACA,kBAAMq9E,QAAQ,GAAG,YAAAvC,wBAAA,CAAyB7pE,KAAzB,EAAgCsB,MAAhC,EAAwC6qE,UAAxC,CAAjB;AACApC,oBAAM,YAAKqC,QAAQ,CAACr9E,EAAd,EAAN,GAA4Bq9E,QAAQ,CAACrC,MAArC;AACAK,uBAAS,CAACzlF,IAAV,OAAAylF,SAAS,qBACF,YAAAJ,4BAAA,CACChqE,KADD,EAEC,YAAM,CAAE,CAFT,EAGC,YAAM,CAAE,CAHT,EAICsB,MAAM,KAAK,QAAX,GACI,YAAM;AACF,wBAAI,CAAC4pE,WAAL,CAAiBjgF,IAAjB,CAAsB+U,KAAtB;;AACA,wBAAI,CAACqsE,WAAL;AACH,eAJL,GAKM,YAAK,CAAE,CATd,CADE,EAAT;AAaH,aAjBD;;AAkBA,oBAAI,CAAClB,SAAL,CAAelgF,IAAf,CAAoB8+E,MAApB;;AACA,oBAAI,CAACK,SAAL,CAAen/E,IAAf,CAAoBm/E,SAApB;AACH,WApCD,CAFJ;AAwCA,eAAKvvF,YAAL,CACI,gBADJ,EAEI,KAAKkwF,YAAL,CACKn9E,IADL,CACU,YAAAm3C,cAAA,CAAe,KAAKmmC,WAApB,CADV,EAEKnwF,SAFL,CAEe,kBAAiC;AAAA;AAAA,gBAA/BgwF,YAA+B;AAAA,gBAAjBG,WAAiB;;AACxC,oBAAI,CAACI,gBAAL,CAAsBrgF,IAAtB,CAA2B8/E,YAAY,CAACpoF,GAAb,CAAiB,QAAAkvD,qBAAjB,CAA3B;AACH,WAJL,CAFJ;AASA,eAAKh3D,YAAL,CACI,wBADJ,EAEI,KAAK2Y,KAAL,CAAW5F,IAAX,CAAgB,QAAA4H,MAAA,CAAO,cAAAiR,6BAAP,CAAhB,EAAuD1rB,SAAvD,CAAiE,UAAC6W,SAAD,EAAe;AAC5E,oBAAI,CAACk5E,eAAL,CAAqB7/E,IAArB,CAA0B2G,SAA1B,EAD4E,CAE5E;;;AACA,gBAAIA,SAAS,CAAC5S,MAAV,GAAmB,CAAnB,IAAwB,CAAC,QAAI,CAACgsF,cAAL,CAAoBhrF,KAAjD,EAAwD;AACpD,kBAAMssF,aAAa,GAAG16E,SAAS,CAAC,CAAD,CAA/B;;AACA,sBAAI,CAACo5E,cAAL,CAAoB//E,IAApB,CAAyBqhF,aAAzB;AACH;AACJ,WAPD,CAFJ;AAYA,eAAKzxF,YAAL,CACI,sBADJ,EAEI,KAAKmwF,cAAL,CACKp9E,IADL,CAEQ,WAAAwkD,eAAA,EAFR,EAGQ,YAAAzvD,GAAA,CAAI,UAACuC,CAAD;AAAA,mBAAiBA,CAAC,CAACyN,MAAnB;AAAA,WAAJ,CAHR,EAKK5X,SALL,CAKe,UAAC4X,MAAD,EAAY;AACnB,oBAAI,CAAC04E,oBAAL,CAA0BpgF,IAA1B,CAA+B0H,MAAM,CAAChQ,GAAP,CAAW,cAAAolB,wBAAX,CAA/B;AACH,WAPL,CAFJ,EAzEW,CAqFX;;AACA,eAAKltB,YAAL,CACI,yCADJ,EAEI,KAAKmwF,cAAL,CACKp9E,IADL,CAEQ,WAAAwkD,eAAA,EAFR,EAGQ,YAAA3S,oBAAA,EAHR,EAIQ,YAAAsF,cAAA,CAAe,KAAKkmC,WAApB,CAJR,EAKQ,YAAAtoF,GAAA,CACI;AAAA;AAAA,gBAAEwd,QAAF;AAAA,gBAAY8qE,WAAZ;;AAAA,mBACKA,WAAW,IAAI9qE,QAAQ,CAACxN,MAAT,CAAgBrS,IAAhB,CAAqB,UAACsS,CAAD;AAAA,qBAAOA,CAAC,CAAC7D,EAAF,KAASk8E,WAAW,CAACl8E,EAA5B;AAAA,aAArB,CAAhB,IACAoR,QAAQ,CAACxN,MAAT,CAAgB,CAAhB,CAFJ;AAAA,WADJ,CALR,EAWK5X,SAXL,CAWe,UAACitB,KAAD,EAAW;AAClB,oBAAI,CAACijE,WAAL,CAAiBhgF,IAAjB,CAAsB+c,KAAtB;AACH,WAbL,CAFJ,EAtFW,CAwGX;;AACA,eAAKntB,YAAL,CACI,2BADJ,EAEI,OAAA4zB,QAAA,CAAS,KAAK,IAAd,EACK7gB,IADL,CACU,YAAAm3C,cAAA,CAAe,KAAKvxC,KAAL,CAAWgC,MAAX,CAAkB,cAAA0O,gBAAlB,CAAf,CADV,EAEKnpB,SAFL,CAEe,kBAAc;AAAA;AAAA,gBAAVke,IAAU;;AACrB,oBAAI,CAACzF,KAAL,CAAW4hE,QAAX,CAAoB,QAAAjwD,sBAAA,CAAuBjW,OAAvB,CAA+B,cAAA6T,mBAAA,CAAoB9J,IAApB,CAA/B,CAApB;AACH,WAJL,CAFJ,EAzGW,CAkHX;;AACA,eAAKpe,YAAL,CACI,YADJ,EAEI,KAAK2Y,KAAL,CACK5F,IADL,CACU,QAAA4H,MAAA,CAAO,cAAA0O,gBAAP,CADV,EACoC,YAAAu7B,oBAAA,EADpC,EAEK1kD,SAFL,CAEe,UAACkQ,IAAD,EAAuC;AAC9C,gBAAIA,IAAJ,EAAU;AACN,sBAAI,CAACygF,eAAL,CAAqBzgF,IAArB,CAA0BA,IAA1B;AACH;AACJ,WANL,CAFJ;;AAWA,cAAI,CAAJ,KAAI,KAAKs1F,SAAL,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAErvF,OAApB,EAA6B;AACzB,iBAAKsvF,cAAL,GAAsB;AAClBz3F,qBAAO,EAAE,CAAF,KAAE,KAAKw3F,SAAL,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAErvF,OAAF,CAAUrY,IADf;AAElBmH,mBAAK,EAAE,CAAF,KAAE,KAAKugG,SAAL,MAAc,IAAd,IAAc,aAAd,GAAc,MAAd,GAAc,GAAErvF,OAAF,CAAUnC;AAFb,aAAtB;AAIA,iBAAKw9E,mBAAL,CAAyB,KAAKiU,cAA9B;AACAvnG,sBAAU,CAAC,YAAM;AACb,sBAAI,CAACwnG,kBAAL;AACH,aAFS,CAAV;AAGH;AACJ;;;6CAEwB;AACrB,eAAKjV,iBAAL,GAAyB,KAAKP,WAAL,CAAiBr9E,IAAjB,CAAsB,YAAAjL,GAAA,CAAI,cAAAolB,wBAAJ,CAAtB,CAAzB;AACH;;;iCAEe;AACZ,cAAI,KAAK69D,IAAL,CAAU5lF,KAAV,GAAkB,YAAAupF,cAAtB,EAAsC;AAClC,iBAAK3D,IAAL,CAAU36E,IAAV,CAAe,KAAK26E,IAAL,CAAU5lF,KAAV,GAAkB,CAAjC;AACH;AACJ;;;kCAEgB;AACb,cAAI,KAAK4lF,IAAL,CAAU5lF,KAAV,GAAkB,YAAA6lF,cAAtB,EAAsC;AAClC,iBAAKD,IAAL,CAAU36E,IAAV,CAAe,KAAK26E,IAAL,CAAU5lF,KAAV,GAAkB,CAAjC;AACH;AACJ;;;mDAEiC;AAC9B,eAAKm3E,MAAL,CAAYriE,IAAZ,CAAiB,qCAAA03E,+BAAjB,EAAkD;AAC9Cn5E,gBAAI,EAAE,KAAK23E,cAAL,CAAoBhrF,KADoB;AAE9C+U,sBAAU,EAAE,WAFkC;AAG9C0vC,qBAAS,EAAE,KAHmC;AAI9CC,yBAAa,EAAE;AAJ+B,WAAlD;AAMH;;;0CAEwB;AACrB,eAAKkhC,IAAL,CAAU36E,IAAV,CAAe,YAAA46E,cAAf;AACA,eAAKC,MAAL,CAAY76E,IAAZ,CAAiB,YAAA86E,YAAjB;AACA,eAAK7K,WAAL,CAAiBjwE,IAAjB,CAAsBlM,SAAtB;AACH;;;6CAE2B+sF,S,EAA8B;AAAA;;AACtD,eAAKhB,eAAL,CACKl9E,IADL,CAEQ,YAAAjL,GAAA,CAAI,UAACy1C,GAAD;AAAA,mBAASA,GAAG,CAAC93C,IAAJ,CAAS,UAAC4E,CAAD;AAAA,qBAAOA,CAAC,CAAC6J,EAAF,KAAS+8E,SAAS,CAAC9rF,KAA1B;AAAA,aAAT,CAAT;AAAA,WAAJ,CAFR,EAGQ,YAAA2V,IAAA,CAAK,CAAL,CAHR,EAIQ,WAAAy8C,eAAA,EAJR,EAMKr3D,SANL,CAMe,UAACkQ,IAAD,EAAU;AACjB,oBAAI,CAAC+/E,cAAL,CAAoB//E,IAApB,CAAyBA,IAAzB;AACH,WARL;AASH;;;4CAE0B6gF,S,EAA8B;AAAA;;AACrD,eAAKd,cAAL,CACKp9E,IADL,CAEQ,YAAAjL,GAAA,CAAI,UAACuC,CAAD,EAAO;AAAD;;AAAA,yBAACA,CAAC,CAACyN,MAAH,MAAS,IAAT,IAAS,aAAT,GAAS,MAAT,GAAS,GAAErS,IAAF,CAAO,UAACsS,CAAD;AAAA,qBAAOA,CAAC,CAAC7D,EAAF,MAAS+8E,SAAS,SAAT,IAAAA,SAAS,WAAT,GAAS,MAAT,GAAAA,SAAS,CAAE9rF,KAApB,CAAP;AAAA,aAAP,CAAT;AAAiD,WAA3D,CAFR,EAGQ,YAAA2V,IAAA,CAAK,CAAL,CAHR,EAIQ,WAAAy8C,eAAA,EAJR,EAMKr3D,SANL,CAMe,UAACkQ,IAAD,EAAU;AAC1B,oBAAI,CAACuI,KAAL,CAAW4hE,QAAX,CAAoB,QAAAjwD,sBAAA,CAAuBjW,OAAvB,CAA+B,cAAA6T,mBAAA,CAAoB,QAAI,CAAC2oE,eAAL,CAAqB1rF,KAAzC,CAA/B,CAApB;;AACS,oBAAI,CAACirF,WAAL,CAAiBhgF,IAAjB,CAAsBA,IAAtB;AACH,WATL;AAUH;;;0CAEwB6gF,S,EAA8B;AAAA;;AACnD,eAAKf,YAAL,CACKn9E,IADL,CAEQ,YAAAjL,GAAA,CAAI,UAACy1C,GAAD;AAAA,mBAASA,GAAG,CAAC93C,IAAJ,CAAS,UAAC+R,CAAD;AAAA,qBAAOA,CAAC,CAACtD,EAAF,MAAS+8E,SAAS,SAAT,IAAAA,SAAS,WAAT,GAAS,MAAT,GAAAA,SAAS,CAAE9rF,KAApB,CAAP;AAAA,aAAT,CAAT;AAAA,WAAJ,CAFR,EAGQ,YAAA2V,IAAA,CAAK,CAAL,CAHR,EAIQ,WAAAy8C,eAAA,EAJR,EAMKr3D,SANL,CAMe,UAACkQ,IAAD,EAAU;AACjB,oBAAI,CAACigF,WAAL,CAAiBjgF,IAAjB,CAAsBA,IAAtB;AACH,WARL;AASH;;;sCAEoB;AAAA;;AACjB,eAAKigF,WAAL,CAAiBt9E,IAAjB,CAAsB,YAAA+H,IAAA,CAAK,CAAL,CAAtB,EAA+B,WAAAy8C,eAAA,EAA/B,EAAyDr3D,SAAzD,CAAmE,UAACkQ,IAAD,EAAU;AACzE,gBAAIlS,KAAK,GAAG,CAAZ;;AACA,gBAAIkS,IAAI,CAAC+c,KAAL,CAAWjZ,EAAX,KAAkB,QAAI,CAACk8E,WAAL,CAAiBjrF,KAAjB,CAAuB+O,EAA7C,EAAiD;AAC7C,sBAAI,CAACk8E,WAAL,CAAiBhgF,IAAjB,CAAsBA,IAAI,CAAC+c,KAA3B;;AACAjvB,mBAAK,GAAG,GAAR;AACH;;AACD,oBAAI,CAAC0C,OAAL,CACI,oBADJ,EAEI,YAAM;AACF,kBAAMy/E,WAAW,GAAG,cAAAvvD,sBAAA,CAChB,CAAC,QAAI,CAACu/D,WAAL,CAAiBlrF,KAAlB,CADgB,EAEhB,CAAC,QAAI,CAACirF,WAAL,CAAiBjrF,KAAlB,CAFgB,EAGhB,CAAC,QAAI,CAACgrF,cAAL,CAAoBhrF,KAArB,CAHgB,CAApB;;AAKA,sBAAI,CAACk7E,WAAL,CAAiBjwE,IAAjB,CAAsBiwE,WAAW,CAAC,CAAD,CAAjC;;AACA,sBAAI,CAAC2P,eAAL,CAAqB5/E,IAArB,CAA0B,YAAAs/E,gBAAA,CAAiB,QAAI,CAACrP,WAAL,CAAiBl7E,KAAlC,EAAyC,QAAzC,CAA1B;;AACA,sBAAI,CAAC4lF,IAAL,CAAU36E,IAAV,CAAe,YAAAs+E,cAAf;AACH,aAXL,EAYIxwF,KAZJ;AAcH,WApBD;AAqBH;;;qCAEmB02B,I,EAA4B;AAC5C;AACA,eAAKjc,KAAL,CAAW4hE,QAAX,CACI,cAAApkE,oBAAA,CAAqB;AACjBE,mBAAO,EAAE,MAAF,OAAE,CAAF,kBACA,KAAKw6E,eAAL,CAAqB1rF,KADrB,CAAE,EACwB;AAC7By2E,0BAAY,EAAEhnD;AADe,aADxB;AADQ,WAArB,CADJ;AASA,eAAKo+C,MAAL,CAAYj9B,QAAZ,CAAqB,CAAC,MAAD,CAArB,EAA+B;AAAEksC,sBAAU,EAAE,KAAKnmE;AAAnB,WAA/B;AACH;;;;MAjTmC,OAAApd,a;;AAlExC;;;uBAkEa+mG,kB,EAAkB,8B,EAAA,kC,EAAA,wC,EAAA,+B,EAAA,iC,EAAA,uC;AAAA,K;;;YAAlBA,kB;AAAkB,qC;AAAA;AAAA;AAAA,O;AAAA;AAAA;AAAA,O;AAAA,+C;AAAA,e;AAAA,c;AAAA,8hB;AAAA;AAAA;AA/DvB;AACI;AACI;AACI;AAAA,mBAA0B,IAAArU,oBAAA,QAA1B;AAAsD,WAAtD,EAAuD,qBAAvD,EAAuD;AAAA,mBAChC,IAAAM,mBAAA,QADgC;AACL,WADlD,EAAuD,qBAAvD,EAAuD;AAAA,mBAEhC,IAAAmU,iBAAA,QAFgC;AAEP,WAFhD,EAAuD,aAAvD,EAAuD;AAAA,mBASxC,IAAArU,WAAA,EATwC;AAS3B,WAT5B;;;;;;;AAWJ;AACJ;AACA;AACI;AAEI;AAAA,mBAAS,IAAAsU,wBAAA,EAAT;AAAmC,WAAnC;AAFJ;AAKA;AACA;AAAA,mBAAe,IAAAC,eAAA,EAAf;AAAgC,WAAhC,EAAiC,aAAjC,EAAiC;AAAA,mBACd,IAAAC,MAAA,EADc;AACN,WAD3B,EAAiC,cAAjC,EAAiC;AAAA,mBAEb,IAAAC,OAAA,EAFa;AAEJ,WAF7B,EAAiC,cAAjC,EAAiC;AAAA,mBAGb,IAAAC,eAAA,EAHa;AAGI,WAHrC;AAIC;AACD;AAEI;AAAA,mBAAc,IAAAnb,IAAA,aAAd;AAA+B,WAA/B,EAAgC,cAAhC,EAAgC;AAAA,mBAEhB,IAAAE,MAAA,aAFgB;AAEG,WAFnC;;;;;;;;AASJ;AACJ;AACJ;;;;;;AAnCY;AAAA,6FAAiD,eAAjD,EAAiD,4CAAjD,EAAiD,eAAjD,EAAiD,4CAAjD,EAAiD,WAAjD,EAAiD,2CAAjD,EAAiD,QAAjD,EAAiD,+CAAjD,EAAiD,QAAjD,EAAiD,2CAAjD;AAUiB;AAAA;AAAoC;AAarD;AAAA,kEAAqB,QAArB,EAAqB,kCAArB,EAAqB,KAArB,EAAqB,kCAArB,EAAqB,KAArB,EAAqB,qCAArB,EAAqB,WAArB,EAAqB,qCAArB,EAAqB,UAArB,EAAqB,oCAArB,EAAqB,OAArB,EAAqB,UAArB;;;;;;;mBAgBJ,CACR,aAAAxuF,OAAA,CAAQ,cAAR,EAAwB,CACpB,aAAAO,KAAA,CACI,MADJ,EAEI,aAAAL,KAAA,CAAM;AACFE,gBAAM,EAAE;AADN,SAAN,CAFJ,CADoB,EAOpB,aAAAG,KAAA,CACI,QADJ,EAEI,aAAAL,KAAA,CAAM;AACFE,gBAAM,EAAE;AADN,SAAN,CAFJ,CAPoB,EAapB,aAAAH,UAAA,CAAW,iBAAX,EAA8B,aAAAI,OAAA,CAAQ,gBAAR,CAA9B,CAboB,CAAxB,CADQ;;;;;;2BAkBH2oG,kB,EAAkB;cAlE9B,OAAA3hD,SAkE8B;eAlEpB;AACPjlD,kBAAQ,EAAE,gBADH;AAEPuxD,kBAAQ,wjEAFD;AA8CPpM,mBAAS,EAAE,CAAC,6BAAD,CA9CJ;AA+CPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkBuxB,QA/C1B;AAgDPljC,oBAAU,EAAE,CACR,aAAA9uD,OAAA,CAAQ,cAAR,EAAwB,CACpB,aAAAO,KAAA,CACI,MADJ,EAEI,aAAAL,KAAA,CAAM;AACFE,kBAAM,EAAE;AADN,WAAN,CAFJ,CADoB,EAOpB,aAAAG,KAAA,CACI,QADJ,EAEI,aAAAL,KAAA,CAAM;AACFE,kBAAM,EAAE;AADN,WAAN,CAFJ,CAPoB,EAapB,aAAAH,UAAA,CAAW,iBAAX,EAA8B,aAAAI,OAAA,CAAQ,gBAAR,CAA9B,CAboB,CAAxB,CADQ;AAhDL,S;AAkEoB,Q;;;;;;;;;;;;;;;;gBAC1B,OAAAyE;;;gBAuCA,OAAA0iD;;;;;;;;;;;;;;;;;;;;;;;;AC1KL;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;AAEa,YAAA2rC,gBAAA,GAAmB,CAC5B,SAAA1yF,YAD4B,EAE5B,SAAAk0D,eAF4B,EAG5B,sBAAAy+B,aAH4B,EAI5B,SAAAj+B,eAJ4B,EAK5B,KAAA1J,QAL4B,EAM5B,SAAAoJ,eAN4B,CAAnB;AASA,YAAAw+B,qBAAA,GAAwB,CACjC,uBAAA2V,kBADiC,EAEjC,yBAAAjE,oBAFiC,EAGjC,wBAAAyD,mBAHiC,EAIjC,qCAAAtT,+BAJiC,EAKjC,wBAAA6T,mBALiC,CAAxB;;QAmBAr0B,S;;;;AAXb;;YAWaA;;;;yBAAAA,S;AAAS,O;AAAA,mCAHX,QAAAye,gBAGW;;;;+EAATze,S,EAAS;AAAA,uBAlBlB,uBAAAs0B,kBAkBkB,EAjBlB,yBAAAjE,oBAiBkB,EAhBlB,wBAAAyD,mBAgBkB,EAflB,qCAAAtT,+BAekB,EAdlB,wBAAA6T,mBAckB;AAdC,kBAbnB,SAAAtoG,YAamB,EAZnB,SAAAk0D,eAYmB,EAXnB,sBAAAy+B,aAWmB,EAVnB,SAAAj+B,eAUmB,EATnB,KAAA1J,QASmB,EARnB,SAAAoJ,eAQmB,CAcD;AAtBH,kBAIf,uBAAAm0C,kBAJe,EAKf,yBAAAjE,oBALe,EAMf,wBAAAyD,mBANe,EAOf,qCAAAtT,+BAPe,EAQf,wBAAA6T,mBARe;AAsBG,O;AAdC,K;;;;;2BAcVr0B,S,EAAS;cAXrB,OAAAh0E,QAWqB;eAXZ;AACN6B,sBAAY,qBACL,QAAA8wF,qBADK,CADN;AAIN7wF,iBAAO,qBACA,QAAA6wF,qBADA,CAJD;AAON1yF,iBAAO,qBACA,QAAAwyF,gBADA;AAPD,S;AAWY,Q;;;;;;;;;;;;;;;;;;;;;;AC7BtB;AAAA;AAAA;;AAEa,YAAA5E,cAAA,GAAiB,CAAjB;AACA,YAAA0D,cAAA,GAAiB,EAAjB;AACA,YAAAxD,YAAA,GAAsB;AAAEzrF,OAAC,EAAE,GAAL;AAAUC,OAAC,EAAE;AAAb,KAAtB;;AAEb,QAAMivF,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACloE,MAAD,EAAiC;AAC7D,cAAQA,MAAR;AACI,aAAK;AAAL;AAAA;AACI,iBAAO,cAAP;;AACJ,aAAK;AAAL;AAAA;AACI,iBAAO,sBAAP;;AACJ,aAAK;AAAL;AAAA;AACI,iBAAO,QAAP;;AACJ,aAAK;AAAL;AAAA;AACA;AACI,iBAAO,WAAP;AATR;AAWH,KAZD;;AAcA,QAAMmoE,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACnoE,MAAD;AAAA,aAA0B;AACrDthB,aAAK,EAAEshB,MAD8C;AAErDvY,eAAO,EAAEygF,uBAAuB,CAACloE,MAAD;AAFqB,OAA1B;AAAA,KAA/B;;AAKa,YAAAooE,aAAA,GAAgB;AAAA,aAA2B,C;;AAAA,Q;;AAAA,Q;;AAAA,Q;;AAAA,QAKtD/mF,GALsD,CAKlD8mF,sBALkD,CAA3B;AAAA,KAAhB;;AAQA,YAAAE,sBAAA,GAAyB,CAClC,2DADkC,EAElC,wDAFkC,EAGlC,8BAHkC,EAIlC,uEAJkC,CAAzB;AAOA,YAAAC,yBAAA,GAA4B,gFAA5B;;AAEA,YAAAC,wBAAA,GAA2B,UACpC7pE,KADoC,EAEpCsB,MAFoC,EAGpCwoE,cAHoC,EAGR;AAC5B,UAAM/6E,EAAE,GACJ,UAAGiR,KAAK,CAACwiB,MAAT,EAAkBtiC,OAAlB,CAA0B,MAA1B,IAAoC,CAApC,kBACc8f,KAAK,CAACwiB,MADpB,eAEMxiB,KAAK,CAACwiB,MAHhB;AAIA,aACI;AACIzzB,UAAE,EAAFA,EADJ;AAEIg7E,cAAM,EAAE;AACJn4C,cAAI,EAAEk4C,cAAc,iBAAUxoE,MAAV,EAAd,IAAqC,MADvC;AAEJ7pB,iBAAO,EAAE;AAFL;AAFZ,OADJ;AAQH,KAhBY;AAkBb;;;;;;;;;AAOa,YAAAuyF,4BAAA,GAA+B,UACxChqE,KADwC,EAExCiqE,UAFwC,EAGxCC,UAHwC,EAIxCC,UAJwC,EAKxB;AAChB,UAAMp7E,EAAE,GACJ,UAAGiR,KAAK,CAACwiB,MAAT,EAAkBtiC,OAAlB,CAA0B,MAA1B,IAAoC,CAApC,kBACc8f,KAAK,CAACwiB,MADpB,eAEMxiB,KAAK,CAACwiB,MAHhB;AAIA,UAAM4nD,SAAS,GAAkB,EAAjC;AACAA,eAAS,CAACzlF,IAAV,CAAe;AACXoK,UAAE,EAAFA,EADW;AAEXvE,aAAK,EAAE,YAFI;AAGXmyD,gBAAQ,EAAEstB;AAHC,OAAf;AAKAG,eAAS,CAACzlF,IAAV,CAAe;AACXoK,UAAE,EAAFA,EADW;AAEXvE,aAAK,EAAE,YAFI;AAGXmyD,gBAAQ,EAAEutB;AAHC,OAAf;;AAKA,UAAIlqE,KAAK,CAACgB,QAAV,EAAoB;AAChBopE,iBAAS,CAACzlF,IAAV,CAAe;AACXoK,YAAE,EAAFA,EADW;AAEXvE,eAAK,EAAE,OAFI;AAGXmyD,kBAAQ,EAAEwtB;AAHC,SAAf;AAKAC,iBAAS,CAACzlF,IAAV,CAAe;AACXoK,YAAE,EAAFA,EADW;AAEXvE,eAAK,EAAE,UAFI;AAGXmyD,kBAAQ,EAAEwtB;AAHC,SAAf;AAKH;;AACD,aAAOC,SAAP;AACH,KAlCY;;AAqCA,YAAAC,iBAAA,GAAoB,UAACrqE,KAAD;AAAA,aAA+B;AAC5DjR,UAAE,iBAAUiR,KAAK,CAACwiB,MAAhB,YAD0D;AAE5D8nD,mBAAW,EAAE,IAF+C;AAG5D11E,eAAO,EAAE,wBAAAyrF,mBAHmD;AAI5DhtF,YAAI,EAAE,MAAF,OAAE,CAAF,EAAE,EACC2M,KADD;AAJsD,OAA/B;AAAA,KAApB;;AASA,YAAAuqE,gBAAA,GAAmB,UAAC96D,IAAD,EAA6Bu3D,eAA7B;AAAA,aAAoE;AAChGj4E,UAAE,iBAAU0gB,IAAI,CAACzP,KAAL,CAAWwiB,MAArB,YAD8F;AAEhG8nD,mBAAW,EAAE,IAFmF;AAGhG11E,eAAO,EAAE,wBAAAyrF,mBAHuF;AAIhGhtF,YAAI,EAAE,MAAF,OAAE,CAAF,kBACGoc,IAAI,CAACzP,KADR,CAAE,EACW;AACbgnE,yBAAe,EAAfA,eADa;AAEbv3D,cAAI,EAAJA;AAFa,SADX;AAJ0F,OAApE;AAAA,KAAnB;;;;;;;;;;;;;;;;;;;;;AC7Hb;AAAA;AAAA;;AAMA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AAIA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;AAeoB;;;;;;AAE+B;;;;;;AAMvB;;;;;;AAEqC;;;;;;AAL7C;AACI;AAAgC;AAAe;AAC/C;AACI;AAGJ;AACJ;;;;;AANoC;AAAA;AAIxB;AAAA;;;;;;AAMZ;;;;;AAEmC;;;;;;AAGnC;AACI;AAAqB;AAA8C;AAAW;AAClF;;;;;AAD0C;AAAA;AAA6B;AAAA;;;;;;AAEvE;;;;;AAAsB;;;;QAW7B+8D,+B;AACT,+CAA4CrsE,QAA5C,EACoB8gB,SADpB,EAC8E;AAAA;;AADlC,aAAA9gB,QAAA,GAAAA,QAAA;AACxB,aAAA8gB,SAAA,GAAAA,SAAA;AACnB;AAGD;;;;;qCAmDoB;AAChB,eAAKA,SAAL,CAAeC,KAAf;AACH;;;oCAEkB8/D,I,EAAc;AAC7B,cAAMl8F,KAAK,GAAG,OAAd;AACA,iBAAOk8F,IAAI,CAACj7F,OAAL,CAAajB,KAAb,EAAoB,qBAApB,CAAP;AACH;;;4BAzDe;AACZ,cAAMqb,QAAQ,GAAa,KAAKA,QAAhC;AACA,cAAMoO,OAAO,GAAuBpO,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAE0kB,eAA9C;AACA,iBAAO,CAAAtW,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAElO,KAAT,KAAkB,EAAzB;AACH;AAED;;;;4BACe;AACX,cAAMF,QAAQ,GAAa,KAAKA,QAAhC;AACA,cAAMoO,OAAO,GAAuBpO,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAE0kB,eAA9C;AACA,iBAAO,CAAAtW,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAEyyE,IAAT,KAAiB,YAAApX,yBAAxB;AACH;;;4BAEoB;AACjB,cAAMzpE,QAAQ,GAAa,KAAKA,QAAhC;AACA,cAAMoO,OAAO,GAAuBpO,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAE0kB,eAA9C;AACA,iBAAOtW,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE0yE,WAAhB;AACH;AAED;;;;4BACoB;AAChB,cAAM9gF,QAAQ,GAAa,KAAKA,QAAhC;AACA,cAAMoO,OAAO,GAAuBpO,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAE0kB,eAA9C;AACA,iBAAO,CAAAtW,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE2yE,SAAT,KAAuB,YAAAvX,sBAA9B;AACH;AAED;;;;4BACsB;;;AAClB,cAAMxpE,QAAQ,GAAa,KAAKA,QAAhC;AACA,cAAMoO,OAAO,GAAuBpO,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAE0kB,eAA9C;AACA,cAAMxkB,KAAK,GAAY,CAAC,CAAD,KAACkO,OAAA,MAAe,IAAf,IAAe,aAAf,GAAe,MAAf,GAAe,GAAE4yE,WAAlB,KAAiC,EAAxD;AACA,iBAAOr3F,MAAM,CAACpH,IAAP,CAAY2d,KAAZ,EAAmB5f,MAAnB,CAA0B,UAACwE,CAAD,EAAIuE,CAAJ,EAAU;AAEvCvE,aAAC,CAACN,IAAF,CAAO;AAAE8kB,mBAAK,EAAEjgB,CAAT;AAAY6W,mBAAK,EAAEA,KAAK,CAAC7W,CAAD,CAAL,IAAY;AAA/B,aAAP;AACA,mBAAOvE,CAAP;AACH,WAJM,EAIJ,EAJI,CAAP;AAKH;;;4BAEiB;AACd,cAAMkb,QAAQ,GAAa,KAAKA,QAAhC;AACA,cAAMoO,OAAO,GAAuBpO,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAE0kB,eAA9C;AACA,iBAAO,CAAAtW,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE6yE,OAAT,KAAoB,EAA3B;AACH;;;4BAEc;AACX,cAAMjhF,QAAQ,GAAa,KAAKA,QAAhC;AACA,cAAMoO,OAAO,GAAuBpO,QAAQ,SAAR,IAAAA,QAAQ,WAAR,GAAQ,MAAR,GAAAA,QAAQ,CAAE0kB,eAA9C;AACA,iBAAO,CAAAtW,OAAO,SAAP,IAAAA,OAAO,WAAP,GAAO,MAAP,GAAAA,OAAO,CAAE8yE,IAAT,KAAiB,EAAxB;AACH;;;;;;AApGL;;;uBA6Ca7U,+B,EAA+B,qBACpB,SAAA9tC,eADoB,C,EACL,qC;AAAA,K;;;YAD1B8tC,+B;AAA+B,mD;AAAA,e;AAAA,a;AAAA,4d;AAAA;AAAA;AA1CpC;AACI;AACI;AAAoB;AAA6B;AACjD;AAAkB;AAAqB;AAC3C;AACA;AACI;AACI;AAGJ;AACA;AACI;AAQJ;AACA;AAAgC;AAAuB;AACvD;AACI;AAGJ;AACA;AACI;AAGA;AACJ;AACJ;AACA;AACI;AAAwC;AAAA,mBAAiB,IAAAnO,UAAA,EAAjB;AAA6B,WAA7B;AAA+B;AAC3E;AACJ;;;;AAnC4B;AAAA;AACF;AAAA;AAMV;AAAA;AAGC;AAAA;AAaD;AAAA;AAGD;AAAA;AAGA;AAAA;;;;;;;;;;2BAWVmO,+B,EAA+B;cA7C3C,OAAA7tC,SA6C2C;eA7CjC;AACPjlD,kBAAQ,EAAE,8BADH;AAEPuxD,kBAAQ,i7DAFD;AA0CPpM,mBAAS,EAAE,CAAC,2CAAD,CA1CJ;AA2CPiZ,uBAAa,EAAE,OAAAC,iBAAA,CAAkB91C;AA3C1B,S;AA6CiC,Q;;;;kBAC3B,OAAA0pB,M;mBAAO,SAAA+S,e;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjExB;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAIA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;AAEA,QAAM4iD,UAAU,GAAgB,CAC5B,OAAA/nG,aAD4B,EAE5B,kBAAA4lG,cAF4B,EAG5B,0BAAAf,qBAH4B,EAI5B,qCAAAnB,+BAJ4B,EAK5B,yBAAAL,oBAL4B,EAM5B,wBAAAT,mBAN4B,EAO5B,yBAAAE,oBAP4B,CAAhC;AAUA,QAAMrwC,gBAAgB,GAAU,CAC5B,SAAAC,eAD4B,EAE5B,YAAAC,iBAF4B,EAG5B,SAAAC,eAH4B,EAI5B,aAAAC,kBAJ4B,EAK5B,QAAAC,cAL4B,EAM5B,mBAAAC,wBAN4B,EAO5B,eAAAC,oBAP4B,EAQ5B,eAAAC,qBAR4B,EAS5B,SAAAC,eAT4B,EAU5B,QAAAC,cAV4B,EAW5B,OAAAC,eAX4B,EAY5B,OAAAC,aAZ4B,EAa5B,WAAAC,iBAb4B,EAc5B,UAAAC,gBAd4B,EAe5B,QAAAC,cAf4B,EAgB5B,OAAAC,aAhB4B,EAiB5B,eAAAC,oBAjB4B,CAAhC;AAoBA,QAAMs0C,WAAW,GAAU,CACvB,YAAAC,eADuB,EAEvB,YAAAC,cAFuB,EAGvB,QAAAC,cAHuB,CAA3B;;QAsCa/1B,mB;;;;AA/Bb;;YA+BaA;;;;yBAAAA,mB;AAAmB,O;AAAA,iBA1BxB,SAAA5zE,YA0BwB,EAzBxB,QAAA8qD,WAyBwB,EAxBxB,QAAAC,mBAwBwB,EAvBxB,YAAA6+C,YAuBwB,EAtBxB,sBAAAC,qBAsBwB,EArBxB,oBAAAC,mBAqBwB,EApBxB,SAAAz3B,YAoBwB,EAnBxB,kBAAApnB,YAmBwB,EAlBxB,WAAA0oB,cAkBwB,EAjBxB,YAAA9oB,cAiBwB,EAhBxB,kBAAAD,oBAgBwB,EAfxB,8BAAAm/C,iBAewB,SAdrB91C,gBAcqB,EAbrBu1C,WAaqB,GAVxB,YAAAI,YAUwB,EATxB,sBAAAC,qBASwB,EARxB,oBAAAC,mBAQwB,EAPxB,YAAAj/C,cAOwB,EANxB,kBAAAD,oBAMwB,EAzD5B,SAAAsJ,eAyD4B,EAxD5B,YAAAC,iBAwD4B,EAvD5B,SAAAC,eAuD4B,EAtD5B,aAAAC,kBAsD4B,EArD5B,QAAAC,cAqD4B,EApD5B,mBAAAC,wBAoD4B,EAnD5B,eAAAC,oBAmD4B,EAlD5B,eAAAC,qBAkD4B,EAjD5B,SAAAC,eAiD4B,EAhD5B,QAAAC,cAgD4B,EA/C5B,OAAAC,eA+C4B,EA9C5B,OAAAC,aA8C4B,EA7C5B,WAAAC,iBA6C4B,EA5C5B,UAAAC,gBA4C4B,EA3C5B,QAAAC,cA2C4B,EA1C5B,OAAAC,aA0C4B,EAzC5B,eAAAC,oBAyC4B,EArC5B,YAAAu0C,eAqC4B,EApC5B,YAAAC,cAoC4B,EAnC5B,QAAAC,cAmC4B;;;;+EAAnB/1B,mB,EAAmB;AAAA,uBAnE5B,OAAApyE,aAmE4B,EAlE5B,kBAAA4lG,cAkE4B,EAjE5B,0BAAAf,qBAiE4B,EAhE5B,qCAAAnB,+BAgE4B,EA/D5B,yBAAAL,oBA+D4B,EA9D5B,wBAAAT,mBA8D4B,EA7D5B,yBAAAE,oBA6D4B;AA7DR,kBAmChB,SAAAtkG,YAnCgB,EAoChB,QAAA8qD,WApCgB,EAqChB,QAAAC,mBArCgB,EAsChB,YAAA6+C,YAtCgB,EAuChB,sBAAAC,qBAvCgB,EAwChB,oBAAAC,mBAxCgB,EAyChB,SAAAz3B,YAzCgB,EA0ChB,kBAAApnB,YA1CgB,EA2ChB,WAAA0oB,cA3CgB,EA4ChB,YAAA9oB,cA5CgB,EA6ChB,kBAAAD,oBA7CgB,EA8ChB,8BAAAm/C,iBA9CgB,EAIpB,SAAA71C,eAJoB,EAKpB,YAAAC,iBALoB,EAMpB,SAAAC,eANoB,EAOpB,aAAAC,kBAPoB,EAQpB,QAAAC,cARoB,EASpB,mBAAAC,wBAToB,EAUpB,eAAAC,oBAVoB,EAWpB,eAAAC,qBAXoB,EAYpB,SAAAC,eAZoB,EAapB,QAAAC,cAboB,EAcpB,OAAAC,eAdoB,EAepB,OAAAC,aAfoB,EAgBpB,WAAAC,iBAhBoB,EAiBpB,UAAAC,gBAjBoB,EAkBpB,QAAAC,cAlBoB,EAmBpB,OAAAC,aAnBoB,EAoBpB,eAAAC,oBApBoB,EAwBpB,YAAAu0C,eAxBoB,EAyBpB,YAAAC,cAzBoB,EA0BpB,QAAAC,cA1BoB,CA6DQ;AAnCd,kBAyBV,YAAAC,YAzBU,EA0BV,sBAAAC,qBA1BU,EA2BV,oBAAAC,mBA3BU,EA4BV,YAAAj/C,cA5BU,EA6BV,kBAAAD,oBA7BU,EAhCd,OAAAppD,aAgCc,EA/Bd,kBAAA4lG,cA+Bc,EA9Bd,0BAAAf,qBA8Bc,EA7Bd,qCAAAnB,+BA6Bc,EA5Bd,yBAAAL,oBA4Bc,EA3Bd,wBAAAT,mBA2Bc,EA1Bd,yBAAAE,oBA0Bc,EAtBd,SAAApwC,eAsBc,EArBd,YAAAC,iBAqBc,EApBd,SAAAC,eAoBc,EAnBd,aAAAC,kBAmBc,EAlBd,QAAAC,cAkBc,EAjBd,mBAAAC,wBAiBc,EAhBd,eAAAC,oBAgBc,EAfd,eAAAC,qBAec,EAdd,SAAAC,eAcc,EAbd,QAAAC,cAac,EAZd,OAAAC,eAYc,EAXd,OAAAC,aAWc,EAVd,WAAAC,iBAUc,EATd,UAAAC,gBASc,EARd,QAAAC,cAQc,EAPd,OAAAC,aAOc,EANd,eAAAC,oBAMc,EAFd,YAAAu0C,eAEc,EADd,YAAAC,cACc,EAAd,QAAAC,cAAc;AAmCc,O;AAnCd,K;;;;;2BAmCL/1B,mB,EAAmB;cA/B/B,OAAA3zE,QA+B+B;eA/BtB;AACN6B,sBAAY,YACLynG,UADK,CADN;AAINrpG,iBAAO,GACH,SAAAF,YADG,EAEH,QAAA8qD,WAFG,EAGH,QAAAC,mBAHG,EAIH,YAAA6+C,YAJG,EAKH,sBAAAC,qBALG,EAMH,oBAAAC,mBANG,EAOH,SAAAz3B,YAPG,EAQH,kBAAApnB,YARG,EASH,WAAA0oB,cATG,EAUH,YAAA9oB,cAVG,EAWH,kBAAAD,oBAXG,EAYH,8BAAAm/C,iBAZG,SAaA91C,gBAbA,EAcAu1C,WAdA,CAJD;AAoBNznG,iBAAO,GACH,YAAA6nG,YADG,EAEH,sBAAAC,qBAFG,EAGH,oBAAAC,mBAHG,EAIH,YAAAj/C,cAJG,EAKH,kBAAAD,oBALG,SAMA2+C,UANA,EAOAt1C,gBAPA,EAQAu1C,WARA;AApBD,S;AA+BsB,Q;;;;;;;;;;;;;;;;;;;;;;ACxHhC;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAOA;AAAA;AAAA;;AAwBA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEA;AAAA;AAAA;;AAKA;AAAA;AAAA;;AAQA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnDI;AACI;AACJ;;;;;;AACA;AACI;AACJ;;;;;;AACA;AACI;AACI;AACI;AACJ;AACA;AAAkB;AAAmB;AACzC;AACJ;;;;QD+CSz3B,qB;;;;;AAYT,qCACY9wD,QADZ,EAEY+oF,OAFZ,EAGYl2E,IAHZ,EAIYm2E,cAJZ,EAKYl2E,OALZ,EAMY+hD,MANZ,EAOYr6D,KAPZ,EAOwC;AAAA;;AAAA;;AAEpC;AARQ,iBAAAwF,QAAA,GAAAA,QAAA;AACA,iBAAA+oF,OAAA,GAAAA,OAAA;AACA,iBAAAl2E,IAAA,GAAAA,IAAA;AACA,iBAAAm2E,cAAA,GAAAA,cAAA;AACA,iBAAAl2E,OAAA,GAAAA,OAAA;AACA,iBAAA+hD,MAAA,GAAAA,MAAA;AACA,iBAAAr6D,KAAA,GAAAA,KAAA;AAbJ,iBAAAyuF,WAAA,GAAc,IAAI,OAAA1pG,eAAJ,CAA6B,IAA7B,CAAd;AACD,iBAAA2pG,QAAA,GAAW,IAAI,OAAA3pG,eAAJ,CAA6B,IAA7B,CAAX;AACA,iBAAA4pG,eAAA,GAAkB,IAAI,OAAA5pG,eAAJ,CAAyC,EAAzC,CAAlB,CAWiC,CAIpC;;AACA,YAAI6pG,MAAM,GAAG,IAAb;;AACA,YAAI,SAAKJ,cAAL,CAAoB/c,QAApB,CAA6BrR,aAA7B,CAA2CphE,GAA3C,CAA+C,IAA/C,CAAJ,EAA0D;AACtD4vF,gBAAM,GAAG,SAAKJ,cAAL,CAAoB/c,QAApB,CAA6BrR,aAA7B,CAA2CphE,GAA3C,CAA+C,IAA/C,CAAT;AACH,SAFD,MAEO,IAAIuE,YAAY,CAACsrF,cAAb,IAA+BtrF,YAAY,CAACsrF,cAAb,CAA4BzrF,QAA5B,CAAqC,MAArC,CAAnC,EAAiF;AACpFwrF,gBAAM,GAAGrrF,YAAY,CAACsrF,cAAb,CAA4BvjG,KAA5B,CAAkC,GAAlC,EAAuC,CAAvC,CAAT;AACH,SAVmC,CAWpC;AAEA;;;AACA,YAAIia,OAAO,GAAG,IAAd;;AACA,YAAI,SAAKipF,cAAL,CAAoB/c,QAApB,CAA6BrR,aAA7B,CAA2CphE,GAA3C,CAA+C,SAA/C,CAAJ,EAA+D;AAC3DuG,iBAAO,GAAG,SAAKipF,cAAL,CAAoB/c,QAApB,CAA6BrR,aAA7B,CAA2CphE,GAA3C,CAA+C,SAA/C,CAAV;AACH,SAFD,MAEO,IACHuE,YAAY,CAACsrF,cAAb,IACAtrF,YAAY,CAACsrF,cAAb,CAA4BzrF,QAA5B,CAAqC,WAArC,CAFG,EAGL;AACEmC,iBAAO,GAAGhC,YAAY,CAACsrF,cAAb,CAA4BvjG,KAA5B,CAAkC,GAAlC,EAAuC,CAAvC,CAAV;;AACA,cAAIia,OAAO,CAACnC,QAAR,CAAiB,GAAjB,CAAJ,EAA2B;AACvBmC,mBAAO,GAAGA,OAAO,CAACja,KAAR,CAAc,GAAd,EAAmB,CAAnB,CAAV;AACH;AACJ;;AAED,iBAAKia,OAAL,GAAeA,OAAf,CA3BoC,CA6BpC;;AACA,YAAI/a,KAAK,GAAG,IAAZ;;AACA,YAAI,SAAKgkG,cAAL,CAAoB/c,QAApB,CAA6BrR,aAA7B,CAA2CphE,GAA3C,CAA+C,OAA/C,CAAJ,EAA6D;AACzDxU,eAAK,GAAG,SAAKgkG,cAAL,CAAoB/c,QAApB,CAA6BrR,aAA7B,CAA2CphE,GAA3C,CAA+C,OAA/C,CAAR;AACH,SAFD,MAEO,IAAIuE,YAAY,CAACsrF,cAAb,IAA+BtrF,YAAY,CAACsrF,cAAb,CAA4BzrF,QAA5B,CAAqC,SAArC,CAAnC,EAAoF;AACvF5Y,eAAK,GAAG+Y,YAAY,CAACsrF,cAAb,CAA4BvjG,KAA5B,CAAkC,SAAlC,EAA6C,CAA7C,CAAR;AACH;;AACD,iBAAKd,KAAL,GAAaA,KAAb;AACCA,aAAK,IAAI+a,OAAV,IAAsBqpF,MAAtB,GAA+B,SAAKF,QAAL,CAAcj3F,IAAd,CAAmB,KAAnB,CAA/B,GAA2D,SAAKi3F,QAAL,CAAcj3F,IAAd,CAAmB,IAAnB,CAA3D;AArCoC;AAsCvC;AAED;;;;;;AAqBA;;;;;oCAKmB2G,S,EAAuBwwF,M,EAAgB;AAAA;;AACtD,cAAIx+C,SAAS,GAAG;AACZztC,oBAAQ,EAAE,EADE;AAEZrZ,gBAAI,EAAE,OAAAD,iBAAA,CAAkB,QAAA4C,QAAA,CAASqkB,GAAT,EAAlB,EAAkC,EAAlC,EAAsCnkB,OAAtC,EAFM;AAGZlC,kBAAM,EAAE,OAAAD,mBAAA,CAAoB,IAAI,UAAAwQ,MAAJ,CAAW;AAAElR,kBAAI,EAAEJ,IAAI,CAAConB,GAAL,EAAR;AAAoBK,yBAAW,EAAE;AAAjC,aAAX,CAApB,EAAyE,EAAzE,CAHI;AAIZtmB,oBAAQ,EAAE,cAAAwkB,wBAJE;AAKZnB,uBAAW,EAAE,cAAAsB,kBAAA,CAAmB,CAAnB,CALD;AAMZK,oBAAQ,EAAE,cAAAJ,qBANE;AAOZg0D,wBAAY,EAAE,IAPF;AAQZ/0E,oBAAQ,EAAE,IARE;AASZkQ,qBAAS,EAAEA;AATC,WAAhB;AAYA,cAAM21B,MAAM,GAAG;AACX9c,oBAAQ,EAAE23E;AADC,WAAf;AAIA,cAAME,gBAAgB,GAAG;AACrB73E,oBAAQ,EAAE23E,MADW;AAErB3kG,kBAAM,EAAE,OAAAD,mBAAA,CAAoB,IAAI,UAAAwQ,MAAJ,CAAW;AAAElR,kBAAI,EAAEJ,IAAI,CAAConB,GAAL,EAAR;AAAoBK,yBAAW,EAAE;AAAjC,aAAX,CAApB,EAA0E,EAA1E,CAFa;AAGrBtmB,oBAAQ,EAAE,cAAAwkB,wBAHW;AAIrBmrB,yBAAa,EAAE;AAJM,WAAzB;AAMA,cAAMt9B,KAAK,GAAG,cAAAq9B,0BAAA,CAA2B+0D,gBAA3B,CAAd;;AACA,eAAKx2E,OAAL,CAAaiiB,UAAb,CAAwB79B,KAAxB,EAA+BnV,SAA/B,CACI,UAACiQ,GAAD,EAAS;AACL;AACA,gBAAMhQ,IAAI,GAAGgQ,GAAG,CAACrI,GAAJ,CAAQ,UAACxH,CAAD;AAAA,qBAAO,QAAI,CAAC2wB,OAAL,CAAa1Q,OAAb,CAAqBjgB,CAArB,CAAP;AAAA,aAAR,CAAb;;AACA,oBAAI,CAAC2wB,OAAL,CAAay2E,YAAb,CAA0BvnG,IAA1B;AACA;;;;;AAGA,gBAAMwnG,WAAW,GAAG,cAAA72E,sBAAA,CAChB3wB,IADgB,EAEhBA,IAAI,CAAC,CAAD,CAAJ,CAAQmlB,QAAR,CAAiBxN,MAFD,EAGhBf,SAHgB,CAApB;AAKA,gBAAMW,IAAI,GAAGvX,IAAI,CAAC,CAAD,CAAJ,CAAQmlB,QAAR,CAAiB5N,IAA9B;AACA,gBAAM7Q,QAAQ,GAAG1G,IAAI,CAAC,CAAD,CAAJ,CAAQ0G,QAAzB;AACA,gBAAM4iD,eAAe,GAAG;AACpB9rD,iBAAG,EAAE;AAAEK,oBAAI,EAAE0Z,IAAR;AAAc7Q,wBAAQ,EAARA;AAAd,eADe;AAEpB1B,mBAAK,EAAE,CAAA4R,SAAS,SAAT,IAAAA,SAAS,WAAT,GAAS,MAAT,GAAAA,SAAS,CAAElO,MAAX,CAAkB,UAACw/B,GAAD;AAAA,uBAASA,GAAG,CAAC3wB,IAAJ,KAAaA,IAAtB;AAAA,eAAlB,MAAiD;AAFpC,aAAxB;AAIA,gBAAMgyC,cAAc,GAAGD,eAAe,CAACtkD,KAAhB,CAAsB2C,GAAtB,CAA0B,UAACugC,GAAD;AAAA,qBAC7C,cAAAvc,yBAAA,CAA0B29B,eAAe,CAAC9rD,GAAhB,CAAoBK,IAA9C,EAAoDqqC,GAApD,CAD6C;AAAA,aAA1B,CAAvB;AAGA,gBAAMxjB,OAAO,IAAI,cAAAsH,wBAAA,CAAyBs9B,eAAe,CAAC9rD,GAAzC,CAAJ,4BAAsD+rD,cAAtD,EAAb;AAEA,gBAAMk+C,YAAY,GAAsB/iF,OAAO,CAAChc,MAAR,CACpC,UAACyD,CAAD;AAAA,qBAAOA,CAAC,CAACnH,KAAF,KAAYhF,IAAI,CAAC,CAAD,CAAJ,CAAQmlB,QAAR,CAAiBpR,EAApC;AAAA,aADoC,EAEtC,CAFsC,CAAxC;AAGA,gBAAM+rC,gBAAgB,GAAG9/C,IAAI,CAAC,CAAD,CAAJ,CAAQ0G,QAAjC,CA1BK,CA2BL;;AACAkiD,qBAAS,GAAG;AACRztC,sBAAQ,EAAE,CAACssF,YAAD,CADF;AAER3lG,kBAAI,EAAE,OAAAD,iBAAA,CAAkB,QAAA4C,QAAA,CAASqkB,GAAT,EAAlB,EAAkC,EAAlC,EAAsCnkB,OAAtC,EAFE;AAGRlC,oBAAM,EAAE,OAAAD,mBAAA,CACJ,IAAI,UAAAwQ,MAAJ,CAAW;AAAElR,oBAAI,EAAEJ,IAAI,CAAConB,GAAL,EAAR;AAAoBK,2BAAW,EAAE;AAAjC,eAAX,CADI,EAEJ,EAFI,EAGNjd,MAHM,CAGC4zC,gBAHD,CAHA;AAORj9C,sBAAQ,EAAE,cAAAwkB,wBAPF;AAQRnB,yBAAW,EACPlmB,IAAI,CAAC,CAAD,CAAJ,CAAQmmB,oBAAR,KAAiC,UAAjC,GACM,cAAAqB,kBAAA,CAAmB,CAAnB,CADN,GAEM,cAAAA,kBAAA,CAAmB,CAAnB,CAXF;AAYRK,sBAAQ,EAAE,cAAAJ,qBAZF;AAaRg0D,0BAAY,EAAE+rB,WAAW,CAAC,CAAD,CAbjB;AAcR9gG,sBAAQ,EAAEo5C,gBAdF;AAeRlpC,uBAAS,EAAEA;AAfH,aAAZ;;AAkBA,oBAAI,CAAC4B,KAAL,CAAW4hE,QAAX,CACI,cAAApkE,oBAAA,CAAqB;AACjBE,qBAAO,EAAE0yC;AADQ,aAArB,CADJ;;AAKA,oBAAI,CAACiqB,MAAL,CAAYj9B,QAAZ,CAAqB,wBAArB,EAA+C;AAC3C/4C,mBAAK,EAAE;AAAEqZ,uBAAO,EAAE,MAAF,OAAE,CAAF,kBAAO0yC,SAAP,CAAE,EAAc;AAAEpjD,wBAAM,EAAE;AAAV,iBAAd;AAAX;AADoC,aAA/C;;AAGAuW,wBAAY,CAACsrF,cAAb,GAA8BtrF,YAAY,CAACsrF,cAAb,CAA4BvjG,KAA5B,CAAkC,GAAlC,EAAuC,CAAvC,CAA9B;;AACA,oBAAI,CAACojG,QAAL,CAAcj3F,IAAd,CAAmB,IAAnB;AACH,WAzDL,EA0DI,UAACsQ,KAAD,EAAW;AACP;AACA,oBAAI,CAAC2mF,QAAL,CAAcj3F,IAAd,CAAmB,IAAnB,EAFO,CAGP;;AACA;;;;;AAGA,oBAAI,CAACuI,KAAL,CAAW4hE,QAAX,CAAoB,cAAApkE,oBAAA,CAAqB;AAAEE,qBAAO,EAAE0yC;AAAX,aAArB,CAApB;;AACA,oBAAI,CAACiqB,MAAL,CAAYj9B,QAAZ,CAAqB,mBAArB,EAA0C;AACtC/4C,mBAAK,EAAE;AAAEqZ,uBAAO,EAAE,MAAF,OAAE,CAAF,kBAAO0yC,SAAP,CAAE,EAAc;AAAEpjD,wBAAM,EAAE;AAAV,iBAAd;AAAX,eAD+B;AAEtCk9C,yBAAW,EAAE;AAAE30C,uBAAO,EAAE;AAAX;AAFyB,aAA1C;AAIH,WAtEL;AAwEH;;;mCAEc;AAAA;;AACX;AACA,eAAKlO,YAAL,CACI,sBADJ,EAEI,KAAKgzE,MAAL,CAAYh1D,MAAZ,CACKjL,IADL,CACU,YAAAlK,MAAA,CAAO,UAAC8G,KAAD;AAAA,mBAAWA,KAAK,YAAY,SAAAk4F,eAA5B;AAAA,WAAP,CADV,EAEK3nG,SAFL,CAEe,UAACyP,KAAD,EAA4B;AACnC,gBAAIA,KAAK,YAAY,SAAAk4F,eAArB,EAAsC;AAClC,kBACIl4F,KAAK,CAACmgE,iBAAN,KAA4B,UAA5B,KACCngE,KAAK,CAACgM,GAAN,CAAUI,QAAV,CAAmB,eAAnB,KAAuCpM,KAAK,CAACgM,GAAN,CAAUI,QAAV,CAAmB,UAAnB,CADxC,CADJ,EAGE;AACE,wBAAI,CAACqrF,WAAL,CAAiBh3F,IAAjB,CAAsB,IAAtB;;AACA5I,sBAAM,CAAC8T,QAAP,CAAgBohC,MAAhB;AACH;AACJ;AACJ,WAZL,CAFJ;AAiBA,cAAI6qD,MAAM,GAAG,IAAb;;AACA,cAAI,KAAKJ,cAAL,CAAoB/c,QAApB,CAA6BrR,aAA7B,CAA2CphE,GAA3C,CAA+C,IAA/C,CAAJ,EAA0D;AACtD4vF,kBAAM,GAAG,KAAKJ,cAAL,CAAoB/c,QAApB,CAA6BrR,aAA7B,CAA2CphE,GAA3C,CAA+C,IAA/C,CAAT;AACH,WAFD,MAEO,IAAIuE,YAAY,CAACsrF,cAAb,IAA+BtrF,YAAY,CAACsrF,cAAb,CAA4BzrF,QAA5B,CAAqC,MAArC,CAAnC,EAAiF;AACpFwrF,kBAAM,GAAGrrF,YAAY,CAACsrF,cAAb,CAA4BvjG,KAA5B,CAAkC,GAAlC,EAAuC,CAAvC,CAAT;AACH;;AAED,cAAIsjG,MAAJ,EAAY;AACR,iBAAKvnG,YAAL,CACI,WADJ,EAEI,KAAKgxB,IAAL,CACKxwB,MADL,CACY,WADZ,EAEKuS,IAFL,CAEU,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,qBAAO,CAAC,CAACA,CAAF,IAAO,CAAC,CAACA,CAAC,CAACtV,MAAlB;AAAA,aAAN,CAFV,EAGKjE,SAHL,CAGe,UAACmrC,QAAD,EAA0B;AACjC,sBAAI,CAACy8D,WAAL,CAAiBz8D,QAAjB,EAA2Bk8D,MAA3B;AACH,aALL,CAFJ;AASH;;AAED,cAAI,KAAKrpF,OAAL,IAAgB,KAAK/a,KAAzB,EAAgC;AAC5B,iBAAKnD,YAAL,CACI,WADJ,EAEI,KAAKgxB,IAAL,CACKxwB,MADL,CACY,WADZ,EAEKuS,IAFL,CAEU,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,qBAAO,CAAC,CAACA,CAAF,IAAO,CAAC,CAACA,CAAC,CAACtV,MAAlB;AAAA,aAAN,CAFV,EAGKjE,SAHL,CAGe,UAACmrC,QAAD,EAA0B;AACjC,kBAAM/lB,QAAQ,GAAG+lB,QAAQ,CAACxiC,MAAT,CAAgB,UAACC,EAAD;AAAA,uBAAQA,EAAE,CAACoL,EAAH,KAAU,QAAI,CAACgK,OAAvB;AAAA,eAAhB,CAAjB;AAEA,kBAAMxG,IAAI,GAAG4N,QAAQ,CAAC,CAAD,CAAR,CAAY5N,IAAzB;AACA,kBAAM7Q,QAAQ,GAAGye,QAAQ,CAAC,CAAD,CAAR,CAAYze,QAA7B;AAEA,kBAAM4iD,eAAe,GAAG;AACpB9rD,mBAAG,EAAE;AAAEK,sBAAI,EAAE0Z,IAAR;AAAc7Q,0BAAQ,EAARA;AAAd,iBADe;AAEpB1B,qBAAK,EAAEmgB,QAAQ,IAAI;AAFC,eAAxB;AAIA,kBAAMokC,cAAc,GAAGD,eAAe,CAACtkD,KAAhB,CAAsB2C,GAAtB,CAA0B,UAACugC,GAAD;AAAA,uBAC7C,cAAAvc,yBAAA,CAA0B29B,eAAe,CAAC9rD,GAAhB,CAAoBK,IAA9C,EAAoDqqC,GAApD,CAD6C;AAAA,eAA1B,CAAvB;AAGA,kBAAMxjB,OAAO,IACT,cAAAsH,wBAAA,CAAyBs9B,eAAe,CAAC9rD,GAAzC,CADS,4BAEN+rD,cAFM,EAAb;AAKA,kBAAMk+C,YAAY,GAAsB/iF,OAAO,CAAChc,MAAR,CACpC,UAACyD,CAAD;AAAA,uBAAOA,CAAC,CAACnH,KAAF,KAAYmgB,QAAQ,CAAC,CAAD,CAAR,CAAYpR,EAA/B;AAAA,eADoC,EAEtC,CAFsC,CAAxC;AAGA,kBAAM+rC,gBAAgB,GAAG36B,QAAQ,CAAC,CAAD,CAAR,CAAYze,QAArC,CArBiC,CAsBjC;;AACA,kBAAM0lF,MAAM,GAAG,QAAA3nF,QAAA,CAASqkB,GAAT,GAAetR,GAAf,CAAmB,QAAnB,IAA+B,CAA/B,KAAqC,CAArC,GAAyC,CAAzC,GAA6C,CAA5D;AACA,kBAAMoxC,SAAS,GAAG;AACdztC,wBAAQ,EAAE,CAACssF,YAAD,CADI;AAEd3lG,oBAAI,EAAE,OAAAD,iBAAA,CACF,QAAA4C,QAAA,CAASqkB,GAAT,GAAexmB,IAAf,CAAoB;AAAEC,yBAAO,EAAE6pF;AAAX,iBAApB,CADE,EAEF,EAFE,EAGJznF,OAHI,EAFQ;AAMdlC,sBAAM,EAAE,OAAAD,mBAAA,CACJ,IAAI,UAAAwQ,MAAJ,CAAW;AACPlR,sBAAI,EAAE,QAAA2C,QAAA,CAASqkB,GAAT,GAAexmB,IAAf,CAAoB;AAAEC,2BAAO,EAAE6pF;AAAX,mBAApB,CADC;AAEPjjE,6BAAW,EAAE,KAFN;AAGPC,6BAAW,EAAE02B;AAHN,iBAAX,CADI,EAMJ,EANI,CANM;AAcdj9C,wBAAQ,EAAE,EAdI;AAedqjB,2BAAW,EAAE,cAAAqB,oBAfC;AAgBdM,wBAAQ,EAAE,cAAAF,oBAAA,CAAqB,CAArB,CAhBI;AAiBd8zD,4BAAY,EAAE,IAjBA;AAkBd/0E,wBAAQ,EAAEo5C,gBAlBI;AAmBdlpC,yBAAS,EAAEs0B;AAnBG,eAAlB;AAsBA,kBAAM08D,MAAM,GAAG;AACX;AACA1/E,yBAAS,EAAE,QAAI,CAACnK,OAFL;AAGX;AACA;AACAy0B,6BAAa,EAAE,IALJ;AAMX/vC,sBAAM,EAAE,OAAAD,mBAAA,CACJ,IAAI,UAAAwQ,MAAJ,CAAW;AACPlR,sBAAI,EAAE,QAAA2C,QAAA,CAASqkB,GAAT,GAAexmB,IAAf,CAAoB;AAAEC,2BAAO,EAAE6pF;AAAX,mBAApB,CADC;AAEPjjE,6BAAW,EAAE,KAFN;AAGPC,6BAAW,EAAE02B;AAHN,iBAAX,CADI,EAMJ,EANI,CANG;AAcXj9C,wBAAQ,EAAE;AAdC,eAAf,CA9CiC,CA+DjC;;AACA,sBAAI,CAAC2V,KAAL,CAAW4hE,QAAX,CAAoB,cAAA7jE,gBAAA,EAApB;;AAEA,sBAAI,CAACiC,KAAL,CAAW4hE,QAAX,CAAoB,QAAApwD,mBAAA,CAAoB2oC,KAApB,EAApB;;AACA,sBAAI,CAACn6C,KAAL,CAAW4hE,QAAX,CAAoB,cAAApkE,oBAAA,CAAqB;AAAEE,uBAAO,EAAE0yC;AAAX,eAArB,CAApB;;AAEA,sBAAI,CAACpwC,KAAL,CAAW4hE,QAAX,CAAoB,QAAApwD,mBAAA,CAAoB9V,OAApB,CAA4B0zF,MAA5B,CAApB;;AACA7rF,0BAAY,CAACsrF,cAAb,GAA8B,EAA9B,CAtEiC,CAuEjC;;AACA,sBAAI,CAACx0B,MAAL,CAAYj9B,QAAZ,CAAqB,mBAArB,EAA0C;AACtC/4C,qBAAK,EAAE;AACHqZ,yBAAO,EAAE,QAAI,CAAClT,KADX;AAEHmiB,0BAAQ,EAAEA,QAFP;AAGH0rE,0BAAQ,EAAE,IAHP;AAIHr1E,qBAAG,EAAEnU,MAAM,CAAC8T,QAAP,CAAgBW;AAJlB,iBAD+B;AAOtC4mC,2BAAW,EAAE;AAAE30C,yBAAO,EAAE;AAAX;AAPyB,eAA1C;;AASA,sBAAI,CAACm5F,QAAL,CAAcj3F,IAAd,CAAmB,IAAnB;AACH,aArFL,CAFJ;AAyFH;;AAED,eAAKpQ,YAAL,CACI,SADJ,EAEI,KAAKme,QAAL,CAAc3d,MAAd,CAA8C,SAA9C,EAAyDN,SAAzD,CAAmE,UAACgb,OAAD,EAAa;AAC5E,oBAAI,CAAC8sF,aAAL,GAAqB9sF,OAArB;AACH,WAFD,CAFJ;;AAOA,eAAKiD,QAAL,CAAc3D,WAAd,CAA0BzH,IAA1B,CAA+B,YAAAyG,KAAA,CAAM,UAACC,CAAD;AAAA,mBAAOA,CAAP;AAAA,WAAN,CAA/B,EAAgDvZ,SAAhD,CAA0D,YAAM;AAC5D,oBAAI,CAAC6jG,IAAL,GAAY,QAAI,CAAC5lF,QAAL,CAAcd,OAAd,CAAsB,gBAAtB,KAA2C;AAAEnW,kBAAI,EAAE;AAAR,aAAvD;AACH,WAFD;AAIA;;;;;AAGA,eAAKlH,YAAL,CACI,aADJ,EAEI,OAAA4xB,aAAA,CAAc,CACV,KAAKjZ,KAAL,CAAW5F,IAAX,CAAgB,QAAA4H,MAAA,CAAO,OAAA2zD,iBAAP,CAAhB,CADU,EAEV,KAAK44B,OAAL,CAAa1sF,WAFH,EAGV,KAAK6sF,QAHK,CAAd,EAKKt0F,IALL,CAMQ,YAAAlK,MAAA,CAAO,kBAA8C;AAAA;AAAA,gBAA5C4Q,CAA4C;AAAA,gBAAzCwuF,WAAyC;AAAA,gBAA5BC,sBAA4B;;AACjDvgG,mBAAO,CAACV,GAAR,CAAYwS,CAAZ;AACA,mBAAOwuF,WAAW,IAAIC,sBAAtB;AACH,WAHD,CANR,EAWKhoG,SAXL,CAWe,kBAAY;AAAA;AAAA,gBAAVkQ,IAAU;;AACnB,oBAAI,CAACg3F,WAAL,CAAiBh3F,IAAjB,CAAsB,CAACA,IAAvB;;AACA,gBAAI,CAACA,IAAL,EAAW;AACP,sBAAI,CAACuI,KAAL,CAAW4hE,QAAX,CAAoB,OAAAnM,QAAA,CAAS/5D,OAAT,EAApB;AACH;AACJ,WAhBL,CAFJ;AAoBH;;;4BA/RoB;AACjB,iBAAO,KAAK+yF,WAAZ;AACH;AAED;;;;4BACqB;AACjB,iBAAO,KAAKA,WAAZ;AACH;AAED;;;;4BAC6B;AACzB,cAAMjnG,IAAI,GAAmB,EAA7B;;AACA,eAAK,IAAMgoG,GAAX,IAAkB,KAAKH,aAAvB,EAAsC;AAClC,gBAAI,KAAKA,aAAL,CAAmBG,GAAnB,CAAJ,EAA6B;AACzBhoG,kBAAI,CAAC2J,IAAL,CAAU,KAAKk+F,aAAL,CAAmBG,GAAnB,CAAV;AACH;AACJ;;AACD,iBAAOhoG,IAAP;AACH;;;;MA9EsC,OAAAzB,a;;AAL3C;;;uBAKauwE,qB,EAAqB,2C,EAAA,wC,EAAA,4C,EAAA,uC,EAAA,sC,EAAA,+B,EAAA,8B;AAAA,K;;;YAArBA,qB;AAAqB,wC;AAAA,+C;AAAA,c;AAAA,a;AAAA,iR;AAAA;AAAA;AC7DlC;AACI;;AAGA;;AAGA;;AAQJ;;;;AAdsB;AAAA;AAGQ;AAAA;AAGC;AAAA;;;;;;;;;;2BDsDlBA,qB,EAAqB;cALjC,OAAAnrB,SAKiC;eALvB;AACPjlD,kBAAQ,EAAE,mBADH;AAEPklD,qBAAW,EAAE,wBAFN;AAGPC,mBAAS,EAAE,CAAC,wBAAD;AAHJ,S;AAKuB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AE7DlC,QAAYo2B,IAAZ;;AAAA,eAAYA,IAAZ,EAAgB;AACZ;AACA;AACA;AACA;AACH,KALD,EAAYA,IAAI,GAAJ,QAAAA,IAAA,aAAAA,IAAA,GAAI,EAAJ,CAAZ;;AAOa,YAAAK,mBAAA,GAAsB,UAACuM,IAAD,EAAkB;AACjD,uBAAU5M,IAAI,CAACguB,QAAf,SAA0BphB,IAA1B;AACH,KAFY;;;;;;;;;;;;;;;;;;;;ACLA,YAAAjmC,WAAA,GAA+B;AACxCC,gBAAU,EAAE,IAD4B;AAExCqnD,SAAG,EAAE,KAFmC;AAGxCzrF,gBAAU,EAAE;AAH4B,KAA/B;;;;;;;;;;;;;;;;;;;ACAb;AACA;;;;AAGA,QAAM0rF,OAAO,GAAG;AACZhvD,UAAI,EAAE;AACFr5C,aAAK,EAAE,EADL;AAEFgiG,iBAAS,EAAE,oBAFT;AAGFh1C,gBAAQ,EAAE;AAHR;AADM,KAAhB;AAQA;;;;AAGA,QAAMs7C,IAAI,GAAG;AACT3zD,gBAAU,EAAE,wBADH;AAET2sD,WAAK,EAAE,CACH;AACIvjG,YAAI,EAAE,MADV;AAEI8d,aAAK,EAAE,cAFX;AAGIhC,YAAI,EAAE;AACF5S,cAAI,EAAE,MADJ;AAEF,mBAAO;AAFL;AAHV,OADG,EASH;AACIlJ,YAAI,EAAE,MADV;AAEI8d,aAAK,EAAE,gBAFX;AAGIhC,YAAI,EAAE;AACF5S,cAAI,EAAE,MADJ;AAEF,mBAAO;AAFL;AAHV,OATG,EAiBH;AACIlJ,YAAI,EAAE,QADV;AAEI8d,aAAK,EAAE,WAFX;AAGIhC,YAAI,EAAE;AACF5S,cAAI,EAAE,MADJ;AAEF,mBAAO;AAFL;AAHV,OAjBG;AAFE,KAAb;AA6BA;;;;AAGA,QAAMshG,IAAI,GAAG;AACTjH,WAAK,EAAE,EADE;AAETkH,aAAO,EAAE;AAFA,KAAb;AAIA;;;;AAGA,QAAM7xF,OAAO,GAAG;AACZ8xF,mBAAa,EAAE,CACX;AAAE1qG,YAAI,EAAE,UAAR;AAAoBkW,UAAE,EAAE;AAAxB,OADW,EAEX;AAAElW,YAAI,EAAE,UAAR;AAAoBkW,UAAE,EAAE;AAAxB,OAFW,CADH;AAKZovE,iBAAW,EAAE,CACT,WADS,EAET,MAFS,EAGT,UAHS,EAIT,QAJS,EAKT,UALS,EAMT,WANS,EAOT,OAPS,EAQT,MARS,EAST,SATS,EAUT,aAVS,EAWT,cAXS,CALD;AAkBZqlB,eAAS,EAAE,KAlBC;AAmBZC,qBAAe,EAAE,IAnBL;AAoBZC,gBAAU,EAAE;AApBA,KAAhB;AAsBA;;;;AAGA,QAAMC,aAAa,GAAG;AAClBC,iBAAW,EAAE;AADK,KAAtB;AAGA;;;;AAGA,QAAMC,SAAS,GAAG;AACdC,kBAAY,EAAE,IADA;AAEdC,uBAAiB,EAAE;AAFL,KAAlB;AAIA;;;;AAGA,QAAMC,OAAO,GAAG;AACZzhG,YAAM,EAAE;AACJ,2BAAmB,SADf;AAEJ,6BAAqB,SAFjB;AAGJ,6BAAqB,SAHjB;AAIJ,wBAAgB,SAJZ;AAKJ,8BAAsB,MALlB;AAMJ,0BAAkB,SANd;AAOJ,iCAAyB,SAPrB;AAQJ,4BAAoB,SARhB;AASJ,mCAA2B,SATvB;AAUJ,yBAAiB,SAVb;AAWJ,gCAAwB,SAXpB;AAYJ,6BAAqB,MAZjB;AAaJ,oCAA4B,MAbxB;AAcJ,oBAAY,SAdR;AAeJ,uBAAe,SAfX;AAgBJ,qBAAa;AAhBT,OADI;AAmBZ0hG,yBAAmB,EAAE,IAnBT;AAoBZC,6BAAuB,EAAE,KApBb;AAqBZC,mBAAa,EAAE,IArBH;AAsBZr1B,YAAM,EAAE;AACJs1B,eAAO,EAAE,CACL;AAAE5rG,aAAG,EAAE,iBAAP;AAA0BK,cAAI,EAAE;AAAhC,SADK,EAEL;AAAEL,aAAG,EAAE,mBAAP;AAA4BK,cAAI,EAAE;AAAlC,SAFK,EAGL;AAAEL,aAAG,EAAE,mBAAP;AAA4BK,cAAI,EAAE;AAAlC,SAHK,EAIL;AAAEL,aAAG,EAAE,oBAAP;AAA6BK,cAAI,EAAE;AAAnC,SAJK;AADL;AAtBI,KAAhB;AAgCA;;;;AAGA,QAAMwrG,QAAQ,GAAG;AACbC,cAAQ,EAAE;AADG,KAAjB;AAKA;;;;AAGA,QAAMr0D,GAAG,GAAG;AACRxmB,WAAK,EAAE,oBADC;AAERgV,iBAAW,EAAE,4DAFL;AAGRjT,gBAAU,EAAE,OAHJ;AAIRgkB,gBAAU,EAAE;AACRztC,YAAI,EAAE,KADE;AAERsnB,WAAG,EAAE,qBAFG;AAGRomB,kBAAU,EAAE;AAHJ,OAJJ;AASRC,eAAS,EAAE;AACP3tC,YAAI,EAAE,KADC;AAEPsnB,WAAG,EAAE,6BAFE;AAGPomB,kBAAU,EAAE;AAHL,OATH;AAcRE,aAAO,EAAE;AACLh4B,cAAM,EAAE,UADH;AAELi4B,iBAAS,EAAE,IAFN;AAGLC,qBAAa,EAAE,IAHV;AAILC,4BAAoB,EAAE,IAJjB;AAKLC,mBAAW,EAAE;AALR,OAdD;AAqBRozD,aAAO,EAAPA,OArBQ;AAsBRC,UAAI,EAAJA,IAtBQ;AAuBRC,UAAI,EAAJA,IAvBQ;AAwBR5xF,aAAO,EAAPA,OAxBQ;AAyBRkyF,mBAAa,EAAbA,aAzBQ;AA0BRE,eAAS,EAATA,SA1BQ;AA2BRG,aAAO,EAAPA,OA3BQ;AA4BRK,cAAQ,EAARA;AA5BQ,KAAZ;AAgCA;;;;AAGa,YAAA/4B,gBAAA,GAA6C;AACtDhpE,WAAK,EAAE,IAD+C;AAEtD0T,cAAQ,EAAE;AACNK,cAAM,EAAE,EADF;AAENM,aAAK,EAAE,QAFD;AAGNT,gBAAQ,EAAE,EAHJ;AAINK,YAAI,EAAE,EAJA;AAKNE,kBAAU,EAAE,KALN;AAMNc,mBAAW,EAAE;AANP,OAF4C;AAUtD04B,SAAG,EAAHA,GAVsD;AAWtDp5B,UAAI,EAAE,KAXgD;AAYtDiB,cAAQ,EAAE;AAZ4C,KAA7C;;;;;;;;;;;;;;;;;;;;AC5Kb;AAAA;AAAA;;AACA;AAAA;AAAA;;AAEa,YAAAysF,YAAA,GAAe,UACxB56B,MADwB,EAExBsC,SAFwB,EAGvB;AACD,UAAIu4B,QAAJ;AACA76B,YAAM,CAAC86B,GAAP,CAAWryD,MAAX;AACA65B,eAAS,GAAGzyD,IAAZ,CAAiB,UAAAwpF,GAAG;AAAA,eAAKwB,QAAQ,GAAGxB,GAAhB;AAAA,OAApB;AACAr5B,YAAM,CAAC86B,GAAP,CAAWnoC,OAAX,CAAmB,YAAM;AACrB,YAAMoK,MAAM,GAAmB89B,QAAQ,CAAC59B,QAAT,CAAkBp0D,GAAlB,CAAsB,OAAAkyF,cAAtB,CAA/B;AACA,YAAMC,QAAQ,GAAGj+B,MAAM,CAACk+B,UAAP,CAAkBjiG,GAAlB,CAAsB,UAAAiJ,CAAC;AAAA,iBAAIA,CAAC,CAACuK,QAAF,CAAWxb,aAAf;AAAA,SAAvB,CAAjB;AACA,YAAMkqG,WAAW,GAAG,MAAAC,cAAA,CAAeH,QAAf,CAApB;AACAH,gBAAQ,CAAChrG,OAAT;AACAqrG,mBAAW;AACd,OAND;AAOH,KAdY;;;;;;;;;;;;;;;;;;;;;ACHb;AAAA;AAAA;;AAEA;AAAA;AAAA;;AACA;AAAA;AAAA;;;;;;;;;;AAGA,QAAI,cAAAjpD,WAAA,CAAYC,UAAhB,EAA4B;AACxB,aAAAkpD,cAAA;AACH;;AAED,QAAM94B,SAAS,GAAG,SAAZA,SAAY;AAAA,aAAM,oBAAA+4B,eAAA,GAAyBC,eAAzB,CAAyC,mBAAD,UAAxC,CAAN;AAAA,KAAlB,C,CAEA;;;AACA,QAAI,cAAArpD,WAAA,CAAYsnD,GAAhB,EAAqB;AACjB,UAAK,KAAL,EAAyB,CAExB,CAFD,MAEO;AACH1gG,eAAO,CAAC+Y,KAAR,CAAc,4CAAd;AACA/Y,eAAO,CAACV,GAAR,CAAY,4CAAZ;AACH;AACJ,KAPD,MAOO;AACHmqE,eAAS,WAAT,CAAkB,UAAArxD,GAAG;AAAA,eAAIpY,OAAO,CAACV,GAAR,CAAY8Y,GAAZ,CAAJ;AAAA,OAArB;AACH","file":"main-es5.js","sourcesContent":["export * from './lib/animations.module';\nexport * from './lib/angular-animations'\n","import { trigger, transition, style, animate, state } from '@angular/animations';\n\nexport const ANIMATION_SHOW_ENTER_LEAVE = trigger('show', [\n    transition(':enter', [\n        style({ opacity: 0, height: 0 }),\n        animate(300, style({ opacity: 1, height: '*' }))\n    ]),\n    transition(':leave', [\n        style({ opacity: 1, height: '*' }),\n        animate(300, style({ opacity: 0, height: 0 }))\n    ])\n]);\n\nexport const ANIMATION_SHOW_CONTRACT_EXPAND = trigger('show', [\n    state('show', style({ opacity: 1, height: '*' })),\n    state('hide', style({ opacity: 0, height: 0 })),\n    transition('show <=> hide', animate('200ms ease-in'))\n]);\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n  imports: [CommonModule],\n})\nexport class AnimationsModule {}\n","export * from './lib/base.module';\nexport * from './lib/types.utilities';\nexport * from './lib/general.utilities';\nexport * from './lib/base.class';\nexport * from './lib/base.directive';\nexport * from './lib/date.utils'\nexport * from './lib/date.spec-helpers'\nexport * from './lib/replace.pipe'\nexport * from './lib/cdk-drop-list-scroll-container.directive'\nexport * from './lib/image.directive';\n","import { Subscription, BehaviorSubject } from \"rxjs\";\n\nexport class BaseClass {\n    /** Store for named timers */\n    protected _timers: { [name: string]: number } = {};\n    /** Store for named intervals */\n    protected _intervals: { [name: string]: number } = {};\n    /** Store for named subscription unsub callbacks */\n    protected _subscriptions: { [name: string]: (Subscription | (() => void)) } = {};\n    /** Subject which stores the initialised state of the object */\n    protected readonly _initialised = new BehaviorSubject<boolean>(false);\n\n    /** Observable of the initialised state of the object */\n    public get initialised(): BehaviorSubject<boolean> {\n        return this._initialised;\n    }\n    /** Whether the object has been initialised */\n    public get is_initialised(): boolean {\n        return this._initialised.getValue();\n    }\n\n    protected destroy() {\n        for (const key in this._timers) {\n            if (this._timers.hasOwnProperty(key)) {\n                this.clearTimeout(key);\n            }\n        }\n        for (const key in this._intervals) {\n            if (this._intervals.hasOwnProperty(key)) {\n                this.clearInterval(key);\n            }\n        }\n        for (const key in this._subscriptions) {\n            if (this._subscriptions.hasOwnProperty(key)) {\n                this.unsub(key);\n            }\n        }\n    }\n\n    /**\n     * Creates a named timer\n     * @param name Name of the timer\n     * @param fn Callback function for the timer\n     * @param delay Callback delay\n     */\n    protected timeout(name: string, fn: () => void, delay: number = 300) {\n        if (name && fn && fn instanceof Function) {\n            this.clearTimeout(name);\n            this._timers[name] = <any>setTimeout(() => {\n                fn();\n                this._timers[name] = null;\n            }, delay);\n        } else {\n            throw new Error(\n                name ? 'Cannot create named timeout without a name' : 'Cannot create a timeout without a callback'\n            );\n        }\n    }\n\n    /**\n     * Clears the named timer\n     * @param name Timer name\n     */\n    protected clearTimeout(name: string) {\n        if (this._timers[name]) {\n            clearTimeout(this._timers[name]);\n            this._timers[name] = null;\n        }\n    }\n\n    /**\n     * Creates a named interval\n     * @param name Name of the interval\n     * @param fn Callback function for the interval\n     * @param delay Callback delay\n     */\n    protected interval(name: string, fn: () => void, delay: number = 300) {\n        if (name && fn && fn instanceof Function) {\n            this.clearInterval(name);\n            this._intervals[name] = <any>setInterval(() => fn(), delay);\n        } else {\n            throw new Error(\n                name ? 'Cannot create named interval without a name' : 'Cannot create a interval without a callback'\n            );\n        }\n    }\n\n    /**\n     * Clears the named interval\n     * @param name Timer name\n     */\n    protected clearInterval(name: string) {\n        if (this._intervals[name]) {\n            clearInterval(this._intervals[name]);\n            this._intervals[name] = null;\n        }\n    }\n\n    /**\n     * Store named subscription\n     * @param name Name of the subscription\n     * @param unsub Unsubscribe callback or Subscription object\n     */\n    protected subscription(name: string, unsub: Subscription | (() => void)) {\n        this.unsub(name);\n        this._subscriptions[name] = unsub\n    }\n\n    /**\n     * Call unsubscribe callback with the given name\n     * @param name\n     */\n    protected unsub(name: string) {\n        if (this._subscriptions && this._subscriptions[name]) {\n            this._subscriptions[name] instanceof Subscription\n                ? (this._subscriptions[name] as Subscription).unsubscribe()\n                : (this._subscriptions[name] as any)();\n            this._subscriptions[name] = null;\n        }\n    }\n}\n","\nimport { Directive, OnDestroy } from '@angular/core';\nimport { BaseClass } from './base.class';\n\n@Directive({\n    selector: 'a-very-basic-component-base-that-should-not-be-used'\n})\nexport class BaseDirective extends BaseClass implements OnDestroy {\n    public ngOnDestroy(): void {\n        this.destroy();\n    }\n}","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { NumbersOnlyDirective } from './numbers-only.directive';\n\n@NgModule({\n    imports: [CommonModule,],\n    declarations: [\n        NumbersOnlyDirective\n    ],\n    exports: [\n        NumbersOnlyDirective\n    ]\n})\nexport class BaseModule {\n}\n","import {\n    Directive,\n    Input,\n    Renderer2,\n    SimpleChanges,\n    OnChanges,\n    ContentChildren,\n    QueryList,\n    AfterContentInit\n} from '@angular/core';\nimport { CdkDropList, CdkDrag } from '@angular/cdk/drag-drop';\nimport { BaseDirective } from './base.directive';\n\nexport enum ScrollDirection {\n    NONE,\n    X,\n    Y,\n    BOTH\n}\n\n@Directive({\n    selector: '[cdkDropList][scrollContainer]'\n})\nexport class CdkDropListScrollContainer extends BaseDirective\n    implements OnChanges, AfterContentInit {\n    /** Direction of scroll to determine updating the position of the drop list */\n    @Input() direction: ScrollDirection = ScrollDirection.X;\n    /** Name of the scroll container for the list */\n    @Input() scrollContainer: string;\n    /** Scroll container element */\n    public element: HTMLElement;\n    /** Last scroll position */\n    public last_scroll: { x: number; y: number } = { x: 0, y: 0 };\n\n    /** Draggable children elements */\n    @ContentChildren(CdkDrag) private items: QueryList<CdkDrag>;\n\n    constructor(private _cdkDropList: CdkDropList, private _renderer: Renderer2) {\n        super();\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.scrollContainer && this.scrollContainer) {\n            this.element = this._cdkDropList.element.nativeElement.closest(\n                this.scrollContainer\n            ) as HTMLElement;\n        }\n    }\n\n    public ngAfterContentInit(): void {\n        this.subscription(\n            'drag_items',\n            this.items.changes.subscribe((items: QueryList<CdkDrag>) => {\n                const list = items.toArray();\n                list.forEach((i, index) => {\n                    this.subscription(\n                        `list-item-${index}`,\n                        this._renderer.listen(i.element.nativeElement, 'mousedown', () => {\n                            this.subscription(\n                                'item-dragged',\n                                this._renderer.listen('window', 'mouseup', () => this.onDrop())\n                            );\n                            this.onDrag();\n                        })\n                    );\n                    this.subscription(\n                        `list-item-touch-${index}`,\n                        this._renderer.listen(i.element.nativeElement, 'touchstart', () => {\n                            this.subscription(\n                                'item-dragged',\n                                this._renderer.listen('window', 'touchend', () => this.onDrop())\n                            );\n                            this.onDrag();\n                        })\n                    );\n                });\n            })\n        );\n    }\n\n    /** Start listing for scroll events on the container */\n    public onDrag() {\n        if (this.element) {\n            this.subscription(\n                'scroll',\n                this._renderer.listen(this.element, 'scroll', () => this.updateListPosition())\n            );\n        }\n    }\n\n    /** Stop listening for scroll events on the container */\n    public onDrop() {\n        this.unsub('scroll');\n    }\n\n    /**\n     * Forcefully update the position data of the drop list\n     */\n    private updateListPosition() {\n        this.timeout(\n            'update_positions',\n            () => {\n                const scroll = { x: this.element.scrollLeft, y: this.element.scrollTop };\n                if (\n                    ((this.direction === ScrollDirection.BOTH ||\n                        this.direction === ScrollDirection.Y) &&\n                        scroll.y !== this.last_scroll.y) ||\n                    ((this.direction === ScrollDirection.BOTH ||\n                        this.direction === ScrollDirection.X) &&\n                        scroll.x !== this.last_scroll.x)\n                ) {\n                    (this._cdkDropList._dropListRef as any)._cacheOwnPosition();\n                    (this._cdkDropList._dropListRef as any)._siblings.forEach(i =>\n                        i.isReceiving() ? i._cacheOwnPosition() : null\n                    );\n                }\n                this.last_scroll = scroll;\n            },\n            50\n        );\n    }\n}\n","import MockDate from 'mockdate';\n\n/**\n * August 13, 2020 at 7:22:12 UTC\n */\nconst initialTime = 1597346532 * 1000;\n\nexport const mockDate = (timeOverride = initialTime) => MockDate.set(new Date(timeOverride));\n\nexport const resetDate = () => MockDate.reset();\n","import { DateNow, DateTZ } from '@mckinsey-converge/date-tz'\nimport { DateTime } from 'luxon';\nimport * as dayjs from 'dayjs';\nimport {\n    dayJsHoursMinutes,\n    dayJsTimeFormatString,\n} from './general.utilities';\n\n/**\n * Allows you to split up durations into a group.\n */\nexport interface DurationGroup {\n    /**\n     * Step amount to generate between start and max.\n     */\n    step: number;\n    /**\n     * Where to start in minutes.\n     */\n    start: number;\n    /**\n     * Where to end in minutes.\n     */\n    max: number;\n}\n\n/**\n * Find the multiple of `stepMinute` which is closest to the 'minutes' property of the given date.\n * @param date - Any Lexon date.\n * @param stepMinute - The number of minutes between one timeslot and the next. Integer value\n * 1 to 59, inclusive.\n */\n// R--- depreciate this one\nexport const closestToTimeSlot = (date: DateTime, stepMinute: number, start: number = 0) : DateTime => {\n    return date.set({ millisecond: 0, second: 0, minute: Math.ceil(date.minute / stepMinute) * stepMinute })\n        .plus({ minutes: start % 60 }) // apply offset as well if it starts at 15.\n};\n\nexport const closestToTimeSlotTz = (dateTz: DateTZ, stepMinute: number, start: number = 0) : DateTZ => {\n    return dateTz.setValue({ millisecond: 0, second: 0, minute: Math.ceil(dateTz.minutes / stepMinute) * stepMinute })\n        .addValue({ minutes: start % 60 }) // apply offset as well if it starts at 15.\n};\n\n/**\n * Convert duration to human readable string\n * @param duration Duration in minutes\n * @param short Whether to use short form of duration words e.g. hours as hrs, or minutes as mins\n */\nexport function durationHumanized(duration: number, short: boolean = false): string {\n    if (!duration || duration < 0) {\n        return '';\n    }\n    const h = Math.floor(duration / 60);\n    let d = `${h >= 1 ? h + (short ? ' hr' : ' hour' + (h === 1 ? '' : 's')) : ''}`;\n    if (duration % 60 !== 0) {\n        if (d) {\n            d += short ? ' ' : ', ';\n        }\n        const m = duration % 60;\n        d += `${m >= 1 ? m + (short ? ' min' : ' minute' + (m === 1 ? '' : 's')) : ''}`;\n    }\n    return d;\n}\n\nexport const weekDayMonthYearFormat = (date: DateTZ): string => date.formatDate('ccc dd MMM yyyy');\n\n/**\n * Tries to extract best-fit input\n * @return undefined if not valid. otherwise if good\n */\nexport const extractDateFromInput = (input: string,\n    checkHour,\n    startDate: dayjs.Dayjs): dayjs.Dayjs | undefined => {\n    // check if input has am/pm or normal 24 hour time.\n    // let date = dayjs(input, 'HH:mm');\n    // let date = dayjs(input, 'h:mma');\n    let date = dayjs(input, dayJsTimeFormatString());\n    if (!date.isValid()) {\n        // patch if time is in format xx:x to assume you meant xx:x0\n        let cleanedInput = input;\n        const times = input.split(':');\n        if(!input){\n            return undefined\n        }\n        if (times.length === 2) {\n            if (times[1].length === 1) {\n                cleanedInput = `${times[0]}:${times[1]}0`;\n            }\n        }\n        // may be other input, lets try next value (without am/pm)\n        date = dayjs(cleanedInput, dayJsHoursMinutes());\n        // might be just purely an hour\n        if (!date.isValid() && checkHour) {\n            date = dayjs(input, 'H');\n        }\n    }\n    // We expect input times to be in the future. If now is in the afternoon, this\n    // simple block will ensure the returned date is also in the afternoon.\n    //\n    // NB: dayjs parses times as morning by default.\n    if (date.isValid()) {\n        // Move to the selected start date\n        date = date.month(startDate.month()).date(startDate.date()).year(startDate.year());\n        if (startDate.hour() > date.hour() && date.date() === startDate.date()) {\n            date = date.set('hour', date.hour() + 12);\n        }\n    }\n\n    return date.isValid() ? date : undefined;\n};\n\n\n/**\n * 1. Calculates the date from input via {@link extractDateFromInput}.\n * 2. Finds the nearest time slot that it can be via {@link closestToTimeSlot}.\n * 3. Then returns the time-format string the input expects so autocomplete can suggest\n *    closest match.\n * @param step The step between time slots.\n * @param input The input text.\n */\nexport const nearestStepToInput = (\n    step: number,\n    input: string,\n    currentStartDate: number,\n    start: number = 0\n): string => {\n    let date = extractDateFromInput(input, false, dayjs(currentStartDate));\n    if (date) {\n        const luxonDate = DateTime.fromMillis(date.valueOf());\n        const closestDate = closestToTimeSlot(luxonDate, step, start);\n        return closestDate.toFormat(dayJsHoursMinutes());\n    } else {\n        return input;\n    }\n};\n/**\n * Similiar to {@link nearestStepToInput} instead:\n * 1. Calculates the date from input via {@link extractDateFromInput}.\n * 2. Finds which duration group is closest to the currentStartDate. If not found\n *    return vanilla text.\n * 3. Finds the nearest time slot that it can be via {@link closestToTimeSlot}.\n * 4. Then returns the time-format string the input expects so autocomplete can suggest\n *    closest match.\n */\nexport const nearestDurationToInput = (durationGroups: DurationGroup[],\n    currentStartDate: number,\n    value: string): string => {\n\n    let date = extractDateFromInput(value, false, dayjs(currentStartDate));\n\n    if (!date) {\n        // Check if the input is a duration \n        const duration = parseInt(value);\n        if (typeof (duration) === 'number' && value.indexOf(':') === -1 && duration > 12) {\n            date = dayjs(currentStartDate).add(duration, 'm');\n        }\n    }\n\n    if (date) {\n        const minutes = date.diff(currentStartDate, 'minute');\n        const closestDurationGroup = durationGroups.find(d => {\n            return (minutes <= d.max);\n        });\n        if (closestDurationGroup) {\n            const offset = [closestDurationGroup].reduce((previousValue, currentValue) => {\n                return previousValue + currentValue.start;\n            }, 0);\n            const luxonDate = DateTime.fromMillis(date.valueOf());\n            const closestDate = closestToTimeSlot(luxonDate, closestDurationGroup.step, 0);\n            return closestDate.toFormat(dayJsHoursMinutes());\n        }\n    }\n\n    return value;\n};\n\nexport const resetSecondsOnTimestamp = (timestamp: number) => {\n    return DateTime.fromMillis(timestamp).set({ second: 0, millisecond: 0 }).toMillis();\n}\n\nexport const formatDateWithSuffix = (date: string): string => {\n    const dateObj = new Date(date);\n    const day = dateObj.getDate();\n    const month = dateObj.toLocaleString(\"default\", { month: \"short\" });\n    const year = dateObj.getFullYear();\n    return `${day}${nthNumber(day)} ${month} ${year}`; //this.event.date_string;\n}\n\nconst nthNumber = (number) => {\n    return number > 0\n        ? [\"th\", \"st\", \"nd\", \"rd\"][\n                (number > 3 && number < 21) || number % 10 > 3 ? 0 : number % 10\n            ]\n        : \"\";\n};\n\nexport const getListOfDateFormat = () => {\n    return [\t\n        'MMMM dd y', \t//March 07 2023\n        'MMM dd, y',\t//Mar 07 2023\n        'MMMM dd',\t\t//March 07\n        'MMM dd', \t\t//Mar 07\n        'MM dd', \t\t//03 07\n\n        'MM-dd-yy',\t\t//03-07-23\n        'MM-dd-yyyy',\t//03-07-2023\n        'MMMM-dd-yyyy', //March-07-2023\n        'MMMM-dd-yy',\t//March-07-23\n\n        'MMMM-dd',\t\t//March-07\n        'MMM-dd',\t\t//Mar-07\n        \n        'MMM-dd-y',\t\t//Mar-07-2023\n\n        'MM/dd',\t\t//03/07\n        'MM/dd/yy',\t\t//03/07/23\n        'MM/dd/yyyy',\t//03/07/2023\n        \n        'dd/MM',\t\t//07/03\n        'dd/MM/yy',\t\t//07/03/23\n        'dd/MM/yyyy',\t//07/03/2023\n        \n        'dd-MMMM',\t\t//07-March\n        'dd MMMM',\t\t//07 March\n        'dd-MMM',\t\t//07-Mar\n        'dd MMM',\t\t//07 Mar\n\n        'dd-MM-y',\t\t//07-03-23\n        'dd MMMM yy',\t//07 March 23\n        \n        'dd/MMM/y',\t    //07/Mar/2023\n        'dd/MMMM/y',    //07/March/2023\n        'dd/MMM/yy',    //07/Mar/23\n        'dd/MMMM/yy',   //07/March/23\n        \n\n        'dd-MMMM-yy',\t//07-March-23\n        'dd-MMM-yy',\t//07-Mar-23\n        'dd-MM-yy',\t\t//07-03-23\n        'MMMM-dd-yy',\t//March-07-23\n        'MMM-dd-yy',\t//Mar-07-23\n\n        'MMMM dd yy',\t//March 07 23\n        'MMM dd, yy',\t//Mar 07 23\n        'MM dd, yy',\t//03 07 23\n\n        'dd MMMM y',\t//07 March 2023\n        'dd MMM, y',\t//07 Mar 2023\n        'dd MM, yy',\t//07 03, 23\n        'dd-MMM-y',\t//07-Mar-2023\n\n        'h:mm a', // 3:30 pm\n        'h:mma' // 3:30 pm\n\n    ];\n}","import { HashMap, Point } from './types.utilities';\n\nimport * as dayjs from 'dayjs';\nimport * as utc from 'dayjs/plugin/utc';\nimport * as timezone from 'dayjs/plugin/timezone';\nimport * as isToday from 'dayjs/plugin/isToday';\nimport * as weekday from 'dayjs/plugin/weekday';\nimport * as customParseFormat from 'dayjs/plugin/customParseFormat';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n// TODO: this is not the best place to import this timezone addition\ndayjs.extend(utc);\ndayjs.extend(timezone);\ndayjs.extend(isToday);\ndayjs.extend(weekday);\ndayjs.extend(customParseFormat);\n\n/** Available console output streams. */\nexport type ConsoleStream = 'debug' | 'warn' | 'log' | 'error' | 'info';\n\n/**\n * Log data to the browser console\n * @param type Type of message\n * @param msg Message body\n * @param args array of argments to log to the console\n * @param stream Stream to emit the console on. 'debug', 'log', 'warn' or 'error'\n * @param force Whether to force message to be emitted when debug is disabled\n */\nexport function log(\n    type: string,\n    msg: string,\n    args?: any,\n    stream: ConsoleStream = 'debug',\n    force: boolean = false,\n    app_name: string = 'STAFF'\n) {\n    if ((window as any).debug || force) {\n        const colors: string[] = [\n            'color: #E91E63',\n            'color: #3F51B5',\n            'color: default',\n        ];\n        if (args) {\n            console[stream](\n                `%c[${app_name}]%c[${type}] %c${msg}`,\n                ...colors,\n                args\n            );\n        } else {\n            console[stream](`%c[${app_name}]%c[${type}] %c${msg}`, ...colors);\n        }\n    }\n}\n\n/**\n * Get item from the nested object\n * @param keys List of sub-keys to search for\n * @param map Object to search\n */\n export function getItemWithKeys(keys: string[], map: HashMap) {\n    const key = keys[0];\n    if (map && key in map) {\n        return keys.length > 1\n            ? getItemWithKeys(keys.slice(1), map[key] || {})\n            : map[key];\n    }\n    return null;\n}\n\n/* istanbul ignore next */\n/**\n * Checks whether the platform is a mobile device.\n */\nexport function isMobileDevice(): boolean {\n    const r = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;\n    return !!navigator.userAgent.match(r);\n}\n\n/* istanbul ignore next */\n/**\n * Checks whether the browser is Mobile Safari.\n */\nexport function isMobileSafari(): boolean {\n    const agent = navigator.userAgent;\n    return !!(\n        agent.match(/iPhone|iPad|iPod/) &&\n        agent.match(/AppleWebKit/) &&\n        !agent.match('CriOS')\n    );\n}\n\n/* istanbul ignore next */\n/**\n * Checks whether the browser is Android Chrome.\n */\nexport function isAndroidChrome(): boolean {\n    const agent = navigator.userAgent;\n    return !!(agent.match(/Android/) && agent.match(/Chrome/));\n}\n\n/**\n * Generate string representation of a number with zeros padding the length\n * @param value Number to pad with zeros\n * @param length Length of the resulting string\n */\nexport function padZero(value: number, length: number): string {\n    let str = value.toString();\n    while (str.length < length) {\n        str = '0' + str;\n    }\n    return str;\n}\n\n/**\n * Remove duplicates from the given array\n * @param array List of items to remove duplicates from\n * @param key Key on array objects to compare for uniqueness\n */\nexport function unique<T>(array: T[], key: keyof T | undefined = undefined) {\n    return array.filter(\n        (el, pos, arr) =>\n            el &&\n            arr.indexOf(\n                key\n                    ? arr.find((i) => i && i[key] === el[key])\n                    : arr.find((i) => i === el)\n            ) === pos\n    );\n}\n\n/**\n * Convert duration to human readable string\n * @param duration Duration in minutes\n * @param short Whether to use short form of duration words e.g. hours as h\n */\nexport function humaniseDuration(durationInput: number, size: string = 'long') {\n    const duration = Math.floor(durationInput);\n    if (!duration || duration < 0) {\n        return '';\n    }\n    let singular = false;\n    let format = { hours: ' hour', minutes: ' minute' };\n    switch (size) {\n        case 'medium':\n            format = { hours: 'hr', minutes: 'min' };\n            break;\n        case 'short':\n            format = { hours: 'h', minutes: 'm' };\n            singular = true;\n            break;\n    }\n    const h = Math.floor(duration / 60);\n    let d = `${\n        h >= 1\n            ? h +\n              (singular ? format.hours : format.hours + (h === 1 ? '' : 's'))\n            : ''\n    }`;\n    if (duration % 60 !== 0) {\n        if (d) {\n            d += singular ? ' ' : ', ';\n        }\n        const m = duration % 60;\n        d += `${\n            m >= 1\n                ? m +\n                  (singular\n                      ? format.minutes\n                      : format.minutes + (m === 1 ? '' : 's'))\n                : ''\n        }`;\n    }\n    return d;\n}\n\n/**\n * Get a filtered list of items\n * @param filter Value to filter on\n * @param items List of results to filter\n * @param fields Fields to check for matches on each item\n */\nexport function filterList<T = HashMap>(\n    filter: string,\n    items?: T[],\n    fields: string[] = ['id']\n): T[] {\n    let results: any[];\n    // Tokenise filter string\n    const filters = (filter || '').toLowerCase().split(' ');\n    const list = {};\n    for (const f of filters) {\n        /* istanbul ignore else */\n        if (f) {\n            /* istanbul ignore else */\n            if (!list[f]) {\n                list[f] = 0;\n            }\n            list[f]++;\n        }\n    }\n    // Group similar tokens\n    const parts = [];\n    for (const f in list) {\n        /* istanbul ignore else */\n        if (list.hasOwnProperty(f)) {\n            parts.push({ word: f, count: list[f], regex: new RegExp(f, 'gi') });\n        }\n    }\n    parts.sort(\n        (a, b) => b.word.length - a.word.length || a.word.localeCompare(b.word)\n    );\n    const item_list = JSON.parse(JSON.stringify(items || []));\n    /* istanbul ignore else */\n    if (filter) {\n        results = item_list.filter((item) => {\n            let match_count = 0;\n            item.match_index = 65535;\n            item.match = '';\n            const field_list = {};\n            // Initialise field match variables\n            for (const f of fields) {\n                field_list[f] = {\n                    value: (item[f] || '').toLowerCase(),\n                    index: 65536,\n                    matched: 0,\n                };\n            }\n            // Search for matches with the tokenised filter string\n            for (const i of parts) {\n                /* istanbul ignore else */\n                if (i.word) {\n                    // Check fields for matches\n                    for (const f of fields) {\n                        const field = field_list[f];\n                        const index = field.value.indexOf(i.word);\n                        field.index = index < field.index ? index : field.index;\n                        field.matches = (\n                            field.value.match(i.regex) || []\n                        ).length;\n                        field.value = field.value.replace(i.regex, ' ');\n                    }\n                    // Update token match count\n                    for (const f of fields) {\n                        const field = field_list[f];\n                        /* istanbul ignore else */\n                        if (field.matches >= i.count) {\n                            match_count++;\n                            // Update field matches\n                            let changed = 0;\n                            const tokens = (\n                                item[`match_${f}`] ||\n                                item[f] ||\n                                ''\n                            ).split(' ');\n                            for (const k of tokens) {\n                                /* istanbul ignore else */\n                                if (changed >= i.count) {\n                                    break;\n                                }\n                                /* istanbul ignore else */\n                                if (\n                                    k.toLowerCase().indexOf(i.word) >= 0 &&\n                                    k.indexOf('`') < 0\n                                ) {\n                                    tokens[tokens.indexOf(k)] = k.replace(\n                                        i.regex,\n                                        '`$&`'\n                                    );\n                                    changed++;\n                                }\n                            }\n                            item[`match_${f}`] = tokens.join(' ');\n                            break;\n                        }\n                    }\n                }\n            }\n            // Get field with the most relevent match\n            for (const f of fields) {\n                const field = field_list[f];\n                /* istanbul ignore else */\n                if (field.index < item.match_index && field.index >= 0) {\n                    item.match_index = field.index;\n                    item.match = f;\n                }\n            }\n            return (\n                item.match_index >= 0 &&\n                item.match &&\n                match_count >= parts.length\n            );\n        });\n    } else {\n        results = item_list;\n    }\n    // Sort by order of relevence then name\n    results.sort((a, b) => {\n        const diff = a.match_index - b.match_index;\n        return diff === 0 ? a.name.localeCompare(b.name) : diff;\n    });\n    return results;\n}\n\n/**\n * Convert a match string from `filterList` to renderable HTML\n * @param str Match string to change\n */\nexport function matchToHighlight(str: string): string {\n    /* istanbul ignore else */\n    if (str) {\n        str = str.replace(\n            /\\`[a-zA-Z0-9\\@\\.\\_]*\\`/g,\n            '<span class=\"highlight\">$&</span>'\n        );\n        str = str.replace(/\\`/g, '');\n    }\n    return str;\n}\n\n/**\n * Convert time string to ms from UTC epoch for today\n * @param time Time string in the format `HH:mm`\n */\nexport function timeToDate(time: string): number {\n    const parts = time.split(':');\n    const date = DateNow(new Date())\n        .setValue({\n            hour: +parts[0],\n            minute: +parts[1],\n        })\n        .startOfValue('minute');\n    return date.ms;\n}\n\n/**\n * Generate a random number\n * @param ceil Biggest value to generate not inclusive\n * @param floor Smallest value to generate. Defaults to 0\n */\nexport function randomInt(ceil: number, floor: number = 0) {\n    return Math.floor(Math.random() * (ceil - floor)) + floor;\n}\n\n/**\n * Get time format string for locale\n * @param isLowerCaseAmPm - if true, we use lowercase for am/pm.\n */\nexport function timeFormatString(): string {\n    return is24HourTime() ? 'HH:mm' : 'h:mma';\n}\n\nexport const hoursMinutes = (): string => (is24HourTime() ? 'HH:mm' : 'h:mma');\n\nexport function dayJsTimeFormatString(): string {\n    return is24HourTime() ? 'HH:mm' : 'h:mma';\n}\n\nexport const dayJsHoursMinutes = (): string =>\n    is24HourTime() ? 'HH:mm' : 'h:mm';\n\n/**\n * Converts a timeZone name into a date object.\n * @param timeZoneName - name of timezone\n */\nexport const timezoneNameToDate = (\n    timeZoneName: string | undefined\n): DateTZ | undefined => {\n    let zone: DateTZ | undefined;\n    if (timeZoneName) {\n        try {\n            zone = DateNow(new Date()).toZone(timeZoneName);\n        } catch (e) {\n            // invalid timezone. Suppress logs here.\n            // console.error(e);\n        }\n    }\n    return zone;\n};\n\nexport const timezoneDisplay = (date: DateTZ) =>\n    !!date ? `${date.formatDate('ZZZZ')}` : '';\nexport const gmtOffsetDisplay = (date: DateTZ) =>\n    !!date ? `(GMT${date.formatDate('ZZ')})` : '';\n\n/**\n * Returns a full time with timezone.\n * @param date\n */\nexport function timeWithZoneFormatString(date: DateTZ): string {\n    return `${date\n        .formatDate(timeFormatString())\n        .toLocaleLowerCase()} ${timezoneDisplay(date)}`;\n}\n\nexport function timeWithGmtOffsetFormatString(date: DateTZ): string {\n    return `${date\n        .formatDate(timeFormatString())\n        .toLocaleLowerCase()} ${gmtOffsetDisplay(date)}`;\n}\n\n/**\n * Returns a full start end range.\n *\n * Start and end both use lowercase am/pm markers (c.f. timeFormatString).\n * @param startDateTz start time DateTZ object\n * @param endDateTz end time DateTZ object\n */\nexport function startEndTimeFormatString(\n    startDateTz: DateTZ,\n    endDateTz: DateTZ\n): string {\n    return `${startDateTz\n        .formatDate(timeFormatString())\n        .toLocaleLowerCase()}-${endDateTz\n        .formatDate(timeFormatString())\n        .toLocaleLowerCase()}`;\n}\n\n/**\n * Returns a full start end range with timezone.\n *\n * Start and end both use lowercase am/pm markers (c.f. timeFormatString).\n * @param startDateTz start time DateTZ object\n * @param endDateTz end time DateTZ object\n */\nexport function startEndTimeWithZoneFormatString(\n    startDateTz: DateTZ,\n    endDateTz: DateTZ\n): string {\n    return `${startDateTz\n        .formatDate(timeFormatString())\n        .toLocaleLowerCase()}-${endDateTz\n        .formatDate(timeFormatString())\n        .toLocaleLowerCase()} ${gmtOffsetDisplay(startDateTz)}`;\n}\n\n/**\n * Returns a full date with weekday day month year.\n * @param date\n * @param comma optional boolean to display a comma after the month\n */\nexport function dateLocalFormatString(date: DateTZ, comma?: boolean): string {\n    if (comma) {\n        return date.formatLocalDate('cccc d MMMM, yyyy');\n    }\n    return date.formatLocalDate('cccc d MMMM yyyy');\n}\n\nexport function dateBuildingFormatString(\n    date: DateTZ,\n    comma?: boolean\n): string {\n    if (comma) {\n        return date.formatDate('cccc d MMMM, yyyy');\n    }\n    return date.formatDate('cccc d MMMM yyyy');\n}\n\nexport function shorterLocalDateFormatString(\n    date: DateTZ,\n    comma?: boolean\n): string {\n    if (comma) {\n        return date.formatLocalDate('ccc d MMM, yyyy');\n    }\n    return date.formatLocalDate('ccc d MMM yyyy');\n}\n\nexport function shorterBuildingDateFormatString(\n    date: DateTZ,\n    comma?: boolean\n): string {\n    if (comma) {\n        return date.formatDate('ccc d MMM, yyyy');\n    }\n    return date.formatDate('ccc d MMM yyyy');\n}\n\n/** Whether locale string is displayed in 24 hour time */\nexport function is24HourTime(): boolean {\n    const date = new Date();\n    const localeString = date\n        .toLocaleTimeString(\n            document.querySelector('html').getAttribute('lang') ||\n                navigator.language\n        )\n        .toLowerCase();\n    return localeString.indexOf('am') < 0 && localeString.indexOf('pm') < 0;\n}\n\n/* istanbul ignore next */\n/**\n * Downloads a file to the users computer with the given filename and contents\n * @param filename Name of the file to download\n * @param contents Contents of the file to download\n */\nexport function downloadFile(filename: string, contents: string) {\n    const element = document.createElement('a');\n    element.setAttribute(\n        'href',\n        'data:text/plain;charset=utf-8,' +\n            encodeURIComponent('\\uFEFF' + contents)\n    );\n    element.setAttribute('download', filename);\n\n    element.style.display = 'none';\n    document.body.appendChild(element);\n\n    element.click();\n\n    document.body.removeChild(element);\n}\n\n/**\n * Parse raw CSV data into a JSON object\n * @param csv CSV data to parse\n */\nexport function csvToJson(csv: string) {\n    const lines = csv.split('\\n');\n    let fields = lines.splice(0, 1)[0].split(',');\n    fields = fields.map((v) => v.replace('\\r', ''));\n    const list: any[] = [];\n    for (const line of lines) {\n        let parts = line.split(',');\n        parts = parts.map((v) => v.replace('\\r', ''));\n        /* istanbul ignore else */\n        if (parts.length >= fields.length) {\n            const item: any = {};\n            for (let i = 0; i <= parts.length; i++) {\n                let part = null;\n                part = parts[i];\n                /* istanbul ignore else */\n                if (part !== undefined) {\n                    item[(fields[i] || '').split(' ').join('_').toLowerCase()] =\n                        part;\n                }\n            }\n            list.push(item);\n        }\n    }\n\n    return list;\n}\n\n/**\n * Convert javascript array to CSV string\n * @param json Javascript array to convert\n */\nexport function jsonToCsv(json: HashMap[]) {\n    /* istanbul ignore else */\n    if (json instanceof Array && json.length > 0) {\n        const keys = Object.keys(json[0]);\n        const valid_keys = keys.filter((key) => json[0].hasOwnProperty(key));\n        return `${valid_keys.join(',')}\\n${json\n            .map((item) =>\n                valid_keys\n                    .map((key) => {\n                        return typeof item[key] !== 'boolean'\n                            ? `\"${item[key] || ''}\"`\n                            : item[key];\n                    })\n                    .join(',')\n            )\n            .join('\\n')}`;\n    }\n    return '';\n}\n\n/* istanbul ignore next */\n/**\n * detect IE\n * returns version of IE or false, if browser is not Internet Explorer\n */\nexport function detectIE() {\n    var ua = window.navigator.userAgent;\n\n    var msie = ua.indexOf('MSIE ');\n    if (msie > 0) {\n        // IE 10 or older => return version number\n        return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\n    }\n\n    var trident = ua.indexOf('Trident/');\n    if (trident > 0) {\n        // IE 11 => return version number\n        var rv = ua.indexOf('rv:');\n        return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\n    }\n\n    var edge = ua.indexOf('Edge/');\n    if (edge > 0) {\n        // Edge (IE 12+) => return version number\n        return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\n    }\n\n    // other browser\n    return false;\n}\n\n/**\n * Grab point details from mouse or touch event\n * @param event Event to grab details from\n */\nexport function eventToPoint(event: MouseEvent | TouchEvent): Point {\n    if (!event) {\n        return { x: -1, y: -1 };\n    }\n    if (event instanceof MouseEvent) {\n        return { x: event.clientX, y: event.clientY };\n    } else {\n        return event.touches && event.touches.length > 0\n            ? { x: event.touches[0].clientX, y: event.touches[0].clientY }\n            : { x: -1, y: -1 };\n    }\n}\n\n/* istanbul ignore next */\n/**\n * Flatten nested array\n * @param an_array Array to flatten\n */\nexport function flatten<T = any>(an_array: T[]) {\n    const stack = [...an_array];\n    const res = [];\n    while (stack.length) {\n        // pop value from stack\n        const next = stack.pop();\n        if (Array.isArray(next)) {\n            // push back array items, won't modify the original input\n            stack.push(...next);\n        } else {\n            res.push(next);\n        }\n    }\n    // reverse to restore input order\n    return res.reverse();\n}\n\nconst seed = xmur3('PlaceOS');\nconst rand = sfc32(0x9e3779b9, 0x243f6a88, 0xb7e15162, seed());\n\nexport function predictableRandomInt(ceil: number = 100, floor: number = 0) {\n    return Math.floor(rand() * (ceil - floor)) + floor;\n}\n\n// https://stackoverflow.com/questions/521295/seeding-the-random-number-generator-in-javascript\nfunction xmur3(str) {\n    for (var i = 0, h = 1779033703 ^ str.length; i < str.length; i++)\n        (h = Math.imul(h ^ str.charCodeAt(i), 3432918353)),\n            (h = (h << 13) | (h >>> 19));\n    return function () {\n        h = Math.imul(h ^ (h >>> 16), 2246822507);\n        h = Math.imul(h ^ (h >>> 13), 3266489909);\n        return (h ^= h >>> 16) >>> 0;\n    };\n}\n\nfunction sfc32(a, b, c, d) {\n    return function () {\n        a >>>= 0;\n        b >>>= 0;\n        c >>>= 0;\n        d >>>= 0;\n        var t = (a + b) | 0;\n        a = b ^ (b >>> 9);\n        b = (c + (c << 3)) | 0;\n        c = (c << 21) | (c >>> 11);\n        d = (d + 1) | 0;\n        t = (t + d) | 0;\n        c = (c + t) | 0;\n        return (t >>> 0) / 4294967296;\n    };\n}\n\nexport function isLessThanBreakpoint(breakpoint: number): boolean {\n    if (window) {\n        return window.innerWidth < breakpoint;\n    }\n    return false;\n}\n\nexport function toTitleCase(str: string): string {\n    return typeof str === 'string'\n        ? str\n              .toLowerCase()\n              .split(' ')\n              .map(function (word) {\n                  return word.replace(word[0], word[0].toUpperCase());\n              })\n              .join(' ')\n        : '';\n}\n","\nimport { Directive, OnDestroy } from '@angular/core';\nimport { BaseClass } from './base.class';\nimport { SpaceImageObject } from '@mckinsey-converge/base';\nimport { BehaviorSubject } from 'rxjs';\n\n@Directive({\n    selector: 'a-very-basic-component-image-that-should-not-be-used'\n})\nexport class ImageDirective extends BaseClass implements OnDestroy {\n    public foundImages?: SpaceImageObject[];\n    public loadImages?: BehaviorSubject<SpaceImageObject[]>\n    public ngOnDestroy(): void {\n        this.destroy();\n    }\n}","import {\n    Directive,\n    ElementRef,\n    HostListener\n} from '@angular/core';\n\n@Directive({\n    selector: 'input[type=number], input[numbersOnly]'\n})\nexport class NumbersOnlyDirective {\n\n    constructor(private _el: ElementRef) {\n    }\n\n    @HostListener('input', ['$event']) onInputChange(event) {\n        const initalValue = this._el.nativeElement.value;\n        this._el.nativeElement.value = initalValue.replace(/[^0-9]*/g, '');\n        if (initalValue !== this._el.nativeElement.value) {\n            event.stopPropagation();\n        }\n    }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'replace'\n})\nexport class ReplacePipe implements PipeTransform {\n\n    transform(value: string, from: string = '_', to: string = ' '): string {\n        return (value|| '').split(from).join(to);\n    }\n}\n","export * from './lib/bookings.module';\nexport * from './lib/bookings.actions'\nexport * from './lib/bookings.reducer'\nexport * from './lib/bookings.types'\nexport * from './lib/bookings.utils'\n","\nimport { IBookingQueryOptions, PaginatedBooking } from '@mckinsey-converge/data-common';\nimport { \n    createLoadingAction\n} from '../../../loading/src/lib/loading.actions';\n\nimport {\n    MyBookingsState,\n    MyBookingsStoreState,\n} from './bookings.types';\nimport {\n    createAction,\n    props\n} from '@ngrx/store';\n\nexport const bookingStateSelector = (state: MyBookingsStoreState) => state.bookings;\n\nexport const loadBookingsWithQuery = createAction('[Bookings] Load Bookings with query', props<IBookingQueryOptions>());\n\nexport const loadHomepageBookingsResults = createLoadingAction<MyBookingsState, PaginatedBooking, IBookingQueryOptions>('HomepageBookings', 'homepage');\n\nexport const loadUpcomingBookingsResults = createLoadingAction<MyBookingsState, PaginatedBooking, IBookingQueryOptions>('UpcomingBookings', 'upcoming');\n\nexport const loadPastBookingsResults = createLoadingAction<MyBookingsState, PaginatedBooking, IBookingQueryOptions>('PastBookings', 'past');\n\nexport const loadCancelledBookingsResults = createLoadingAction<MyBookingsState, PaginatedBooking, IBookingQueryOptions>('CancelledBookings', 'cancelled');\n\nexport const loadBookingByIdResults = createLoadingAction<MyBookingsState, PaginatedBooking, IBookingQueryOptions>('BookingById', 'bookingById');\n\nexport const clearBookingByIdResults = createAction('[BookingById] Clear Booking Data');\n","import { Injectable } from '@angular/core';\nimport {\n    Actions,\n    Effect,\n    ofType\n} from '@ngrx/effects';\nimport {\n    IBookingQueryOptions,\n    BookingsPaginatedService\n} from '../../../data-common/src/lib/bookings';\nimport {\n    createLoadingEffect,\n    LoadingAction\n} from '@mckinsey-converge/loading';\nimport {\n    loadHomepageBookingsResults,\n    loadPastBookingsResults,\n    loadUpcomingBookingsResults,\n    loadCancelledBookingsResults,\n    loadBookingsWithQuery,\n    loadBookingByIdResults\n} from './bookings.actions';\nimport { mergeMap } from 'rxjs/operators';\nimport {\n\n} from './bookings.utils';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\n\n@Injectable()\nexport class BookingsEffects {\n    constructor(private actions: Actions,\n                private bookingService: BookingsPaginatedService) {\n    }\n\n    @Effect()\n    public afterBookingsRequestResultsLoadOthersEffect = this.actions.pipe(\n        ofType(loadBookingsWithQuery),\n        mergeMap((action: LoadingAction<IBookingQueryOptions>) => {\n            const date = new DateTZ({date: action.from})\n            const yourBookingsRequest = {\n                email: action.email,\n                pagination: true,\n                limit: 4,\n                offset: action.offset,\n                show_cancelled: false,\n                sort: 'start_epoch asc',\n                filters: {\n                    end_epoch: `>=${date.subtractValue({ minutes: 5 }).seconds}`,\n                },\n                include_rooms: true\n            };\n            const upcomingRequest = {\n                email: action.email,\n                pagination: true,\n                limit: 4,\n                offset: action.offset,\n                show_cancelled: false,\n                sort: 'start_epoch asc',\n                filters: {\n                    end_epoch: `>=${date.seconds}`,\n                },\n                include_rooms: true\n            };\n            const pastRequest = {\n                email: action.email,\n                pagination: true,\n                limit: 4,\n                offset: action.offset,\n                show_cancelled: false,\n                sort: 'start_epoch desc',\n                filters: {\n                    start_epoch: `>${date.subtractValue({ hours: 48 }).seconds}`,\n                    end_epoch: `<${date.seconds}`,\n                },\n                include_rooms: true\n            };\n            const cancelledRequest = {\n                email: action.email,\n                pagination: true,\n                limit: 4,\n                offset: action.offset,\n                show_cancelled: true,\n                sort: 'start_epoch desc',\n                filters: {\n                    start_epoch: `>${date.subtractValue({ hours: 48 }).seconds}`,\n                },\n                include_rooms: true\n            };\n            const byIdRequest = {\n                email: action.email,\n                id: action.id,\n                pagination: true,\n                limit: 1,\n                include_rooms: true\n            };\n\n            const effects = [];\n            switch(action.target) {\n                case 'upcoming':\n                    effects.push(loadUpcomingBookingsResults.request(upcomingRequest));\n                    break;\n                case 'past':\n                    effects.push(loadPastBookingsResults.request(pastRequest));\n                    break;\n                case 'cancelled':\n                    effects.push(loadCancelledBookingsResults.request(cancelledRequest));\n                    break;\n                case 'bookingById':\n                    effects.push(loadBookingByIdResults.request(byIdRequest));\n                    break\n                case 'homepage':\n                    effects.push(loadHomepageBookingsResults.request(yourBookingsRequest));\n                    effects.push(loadPastBookingsResults.request(pastRequest));\n                    break\n                default:\n            }\n            return effects;\n        })\n    );\n\n    @Effect()\n    public loadHomepageBookingsResultsEffect = createLoadingEffect(this.actions, loadHomepageBookingsResults,\n        (action) => this.bookingService.userBookings(action, `homepage-${action.filters?.start_epoch || ''}${action.filters?.end_epoch || ''}`));\n\n    @Effect()\n    public loadUpcomingBookingsResultsEffect = createLoadingEffect(this.actions, loadUpcomingBookingsResults,\n        (action) => this.bookingService.userBookings(action, `upcoming-${action.filters?.start_epoch || ''}${action.filters?.end_epoch || ''}`));\n            \n    @Effect()\n    public loadPastBookingsResultsEffect = createLoadingEffect(this.actions, loadPastBookingsResults,\n        (action) =>\n            this.bookingService.userBookings(action, `past-${action.filters?.start_epoch || ''}${action.filters?.end_epoch || ''}`));\n\n    @Effect()\n    public loadCancelledBookingsResultsEffect = createLoadingEffect(this.actions, loadCancelledBookingsResults,\n        (action) =>\n            this.bookingService.userBookings(action, `cancelled-${action.filters?.start_epoch || ''}${action.filters?.end_epoch || ''}`));\n\n    @Effect()\n    public loadBookingByIdResultsEffect = createLoadingEffect(this.actions, loadBookingByIdResults,\n        (action) => \n            this.bookingService.userBookings(action, `bookingById-${action.id}`));\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { bookingsReducer } from './bookings.reducer';\nimport { BookingsEffects } from './bookings.effects';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        EffectsModule.forFeature([BookingsEffects]),\n        StoreModule.forFeature('bookings', bookingsReducer)\n    ]\n})\nexport class BookingsModule {\n}\n","import { LoadingModel } from '@mckinsey-converge/loading';\nimport {\n    createReducer,\n    on\n} from '@ngrx/store';\nimport {\n    loadHomepageBookingsResults,\n    loadUpcomingBookingsResults,\n    loadPastBookingsResults,\n    loadCancelledBookingsResults,\n    loadBookingByIdResults,\n    clearBookingByIdResults,\n} from './bookings.actions';\nimport { MyBookingsState } from './bookings.types';\n   \nimport { \n    BookingFormState,\n    clearBookingFormData,\n    clearRoomFilters,\n    openBookingSurvey,\n    storeBookingFormData,\n    storeRoomFilters\n} from '@mckinsey-converge/data-common';\n\n\nexport const initialBookingsState: MyBookingsState = {\n    query: LoadingModel.empty(),\n    homepage: LoadingModel.empty(),\n    upcoming: LoadingModel.empty(),\n    past: LoadingModel.empty(),\n    cancelled: LoadingModel.empty(),\n    bookingById: LoadingModel.empty(),\n};\n\nexport const bookingsReducer = createReducer(initialBookingsState,\n    on(clearBookingByIdResults, (state: MyBookingsState) => ({\n        ...state,\n        bookingById: LoadingModel.empty(),\n    }) as MyBookingsState),\n    ...loadHomepageBookingsResults.ons,\n    ...loadUpcomingBookingsResults.ons,\n    ...loadPastBookingsResults.ons,\n    ...loadCancelledBookingsResults.ons,\n    ...loadBookingByIdResults.ons,\n    );\n\n\n\n    export const initialBookingFormState: BookingFormState = {\n        activeFormFilters: []\n    };\n    \n    export const bookingFormReducer = createReducer(initialBookingFormState,\n        on(storeBookingFormData, (state: BookingFormState, action) => {\n            return {\n                ...state,\n                activeForm: {\n                    ...state.activeForm,\n                    ...action.payload\n                }\n            } as BookingFormState;\n        }),\n        on(clearBookingFormData, state => ({\n            ...state,\n            activeForm: undefined\n        }) as BookingFormState),\n        on(openBookingSurvey, state => ({\n            ...state,\n            bookingCompleted: new Date()\n        }) as BookingFormState),\n        on(storeRoomFilters, (state: BookingFormState, action) => {\n            return {\n                ...state,\n                activeFormFilters: action.payload\n            } as BookingFormState;\n        }),\n        on(clearRoomFilters, (state: BookingFormState) => ({\n            ...state,\n            activeFormFilters: initialBookingFormState.activeFormFilters\n        }) as BookingFormState)\n    );\n    \n","import { Booking } from '@mckinsey-converge/data-common';\nimport { SelectOption } from '@mckinsey-converge/ui';\n\nexport const mapBookingToSelectOption = (booking?: Booking): SelectOption<any> => booking ? ({\n    value: booking.id,\n    display: booking.name\n}) : undefined;\n","export * from './lib/buildings.module';\nexport * from './lib/buildings.actions'\nexport * from './lib/buildings.types'\nexport * from './lib/buildings.reducer'\n","import { \n    createLoadingAction,\n} from '../../../loading/src/lib/loading.actions';\nimport {\n    Building,\n    BuildingCity,\n} from '../../../data-common/src/lib/organisation/building.class';\nimport {\n    BuildingLevel,\n} from '../../../data-common/src/lib/organisation/level.class'\nimport {\n    Organisation,\n} from '../../../data-common/src/lib/organisation/organisation.class'\nimport { createSelector } from '@ngrx/store';\nimport {\n    BuildingState,\n    BuildingStoreState\n} from './buildings.types';\n\nexport const loadBuildings = createLoadingAction<BuildingState, Building[], Organisation>('Buildings', 'data');\n\nexport const buildingStateSelector = (state: BuildingStoreState) => state.buildings;\n\nexport const selectLoadBuildingsSuccess = createSelector(buildingStateSelector, loadBuildings.selectors.optionalSuccess);\n\n/**\n * Groups buildings by city\n */\nexport const selectBuildingOptionsGroupedByCity = createSelector(loadBuildings.selectors.optionalSuccess, (success) => {\n    if (success) {\n        const mapped = new Map<BuildingCity, Building[]>();\n        success.forEach(s => {\n            const found = Array.from(mapped.keys()).find(c => c.name === s.city);\n            let list = found ? mapped.get(found) : undefined;\n            if (!list) {\n                list = [];\n                mapped.set({\n                    name: s.city,\n                    timezone: s.timezone\n                }, list);\n            }\n            list.push(s);\n        });\n        return mapped;\n    }\n    return new Map<BuildingCity, Building[]>();\n});\n\nexport const selectLevelByZoneId = createSelector(selectLoadBuildingsSuccess,\n    (buildings, param: string) => {\n        if (buildings) {\n            return buildings.map(b => b.levels.find((l: BuildingLevel) => l.id === param))\n                ?.[0] ?? undefined;\n        }\n        return undefined;\n    });\n","import { Injectable } from '@angular/core';\nimport {\n  Actions,\n  Effect,\n  ofType\n} from '@ngrx/effects';\nimport {\n  Organisation,\n  OrganisationService\n} from '../../../data-common/src/lib/organisation';\nimport { loadBuildings } from './buildings.actions';\nimport {\n  createLoadingEffect,\n  LoadingAction,\n  Payload\n} from '@mckinsey-converge/loading';\nimport { loadOrganisations } from '../../../organisation/src/lib/organisation.actions';\nimport { map } from 'rxjs/operators';\n\n\n@Injectable()\nexport class BuildingsEffects {\n\n  constructor(private actions: Actions,\n              private organizationService: OrganisationService) {\n\n  }\n\n  @Effect()\n  public loadBuildings = createLoadingEffect(this.actions, loadBuildings,\n    (action) => this.organizationService.loadBuildingsWithOrg(action));\n\n  @Effect()\n  public loadBuildingsAfterOrg = this.actions.pipe(\n    ofType(loadOrganisations.success),\n    map((action: LoadingAction<Payload<Organisation>>) => loadBuildings.request(action.payload)));\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { EffectsModule } from '@ngrx/effects';\nimport { BuildingsEffects } from './buildings.effects';\nimport { StoreModule } from '@ngrx/store';\nimport { buildingsReducer } from './buildings.reducer';\n\n\n@NgModule({\n    declarations: [],\n    imports: [\n        CommonModule,\n        EffectsModule.forFeature([\n            BuildingsEffects\n        ]),\n        StoreModule.forFeature('buildings', buildingsReducer)\n    ]\n})\nexport class BuildingsModule {\n}\n","import { createReducer } from '@ngrx/store';\nimport { LoadingModel } from '@mckinsey-converge/loading';\nimport { loadBuildings } from './buildings.actions';\nimport { BuildingState } from './buildings.types';\n\nexport const initialBuildingState: BuildingState = {\n    data: LoadingModel.empty()\n};\n\nexport const buildingsReducer = createReducer(initialBuildingState,\n    ...loadBuildings.ons\n);\n","export * from './lib/data-common.module';\nexport * from './lib/booking';\nexport * from './lib/bookings';\nexport * from './lib/catering';\nexport * from './lib/location';\nexport * from './lib/organisation';\nexport * from './lib/spaces';\nexport * from './lib/users';\nexport * from './lib/app.service';\nexport * from './lib/hotkeys.service';\nexport * from './lib/base.service';\nexport * from './lib/base-api.class';\nexport * from './lib/reports'\nexport * from './lib/service-manager.class';\nexport * from './lib/settings.service';\nexport * from './lib/spec-helpers';\nexport * from './lib/settings.interfaces';\nexport * from './lib/validation.utilities';\nexport * from './lib/status.interfaces';\nexport * from './lib/recurrence/recurrence.utils';\nexport * from './lib/close-modal-dialog-service';\nexport * from './lib/validation.utilities'","import { HashMap } from '@mckinsey-converge/base';\n\n/**\n * Convert map into a query string\n * @param map Key value pairs to convert\n */\nexport function toQueryString(map: HashMap) {\n  let str = '';\n  if (map) {\n    for (const key in map) {\n      if (map.hasOwnProperty(key) && map[key] !== undefined && map[key] !== null) {\n        str += `${(str ? '&' : '')}${key}=${map[key]}`;\n      }\n    }\n  }\n  return str;\n}\n","import {\n    ApplicationRef,\n    Injectable,\n    NgZone,\n} from '@angular/core';\nimport { Title } from '@angular/platform-browser';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { take, first } from 'rxjs/operators';\n\nimport { ComposerService } from '@placeos/composer';\nimport { PlaceOSOptions } from '@placeos/ts-client';\nimport { HeapIoService } from '@acaprojects/ngx-heap-io';\n\nimport {\n    BehaviorSubject,\n    Observable,\n    Subject\n} from 'rxjs';\n\nimport {\n    ApplicationLoadingState,\n    BaseClass,\n    ConsoleStream,\n    log\n} from '@mckinsey-converge/base';\nimport { SettingsService } from './settings.service';\n\nimport { HotkeysService } from './hotkeys.service';\nimport {\n    ApplicationIcon,\n    ComposerSettings\n} from './settings.interfaces';\nimport { EnvironmentService } from '../../../environment/src/lib/environment.service'; // '@mckinsey-converge/environment';\nimport {\n    Store\n} from '@ngrx/store';\nimport { selectCurrentUser } from '../../../user/src/lib/user.actions';\nimport { UserStoreState } from '../../../user/src/lib/user.types';\nimport { Booking } from './bookings';\nimport { filter } from 'rxjs/operators';\n\n\ndeclare global {\n    interface Window {\n        application: ApplicationService;\n        mock: {\n            enabled: boolean;\n            backend: any;\n        };\n    }\n}\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class ApplicationService extends BaseClass {\n    /** Map of state variables for Service */\n    protected _subjects: {\n        [key: string]: BehaviorSubject<any> | Subject<any>;\n    } = {};\n    /** Map of observables for state variables */\n    protected _observers: { [key: string]: Observable<any> } = {};\n    _kioskFormFilter: boolean;\n\n    constructor(\n        public store: Store<UserStoreState>,\n        public analytics: HeapIoService,\n        private _app_ref: ApplicationRef,\n        private _zone: NgZone,\n        private _title: Title,\n        private _settings: SettingsService,\n        private _hotkeys: HotkeysService,\n        private _composer: ComposerService,\n        private _snackbar: MatSnackBar,\n        private _environment: EnvironmentService\n    ) {\n        super();\n        this.set('system', null);\n        this.set('title', 'Home');\n        this.set('loading', {});\n        this.set('CONCIERGE.day_view.viewing', null);\n        this.set('undo', new BehaviorSubject<{\n            action: 'series' | 'booking',\n            booking: Booking\n        } | null>(null));\n\n        this.set('APP.breakdown', false);\n\n        this._app_ref.isStable.pipe(first(_ => _)).subscribe(() => {\n            this._zone.run(() => {\n                this.log('APP', `Application has stablised.`);\n                this.waitForSettings();\n            });\n        });\n    }\n\n    public set kioskFormFilter(isIt: boolean) {\n        this._kioskFormFilter = isIt;\n    }\n\n    public get kioskFormFilter():boolean {\n        return this._kioskFormFilter \n    }\n\n    /** Analytics service */\n    public get Analytics() {\n        return {};\n    }\n\n    /** Hotkeys service */\n    public get Hotkeys() {\n        return this._hotkeys;\n    }\n\n    /**\n     * Get a setting from the settings service\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n     */\n    public setting(key: string): any {\n        return this._settings.get(key);\n    }\n\n    /**\n     * Title of the page\n     */\n    public set title(value: string) {\n        const title_suffix = this.setting('app.title');\n        this.set('title', value);\n        this._title.setTitle(`${value ? value + ' | ' : ''}${title_suffix}`);\n    }\n\n    /**\n     * Title of the page\n     */\n    public get title(): string {\n        return this._title.getTitle();\n    }\n\n    /** Root API Endpoint */\n    public get endpoint() {\n        return `/api/staff/`;\n    }\n\n    /** Root API Endpoint for engine */\n    public get engine_endpoint() {\n        return this._composer.auth.api_endpoint + '/';\n    }\n\n    /** Whether settings has been loaded */\n    public get has_settings(): boolean {\n        return this._settings.is_initialised;\n    }\n\n    /**\n     * Create notification popup\n     * @param type CSS Class to add to the notification\n     * @param message Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     * @param icon Icon to render to the left of the notification message\n     */\n    public notify(\n        type: string,\n        message: string,\n        action: string = 'OK',\n        on_action?: () => void,\n        icon: ApplicationIcon = {\n            type: 'icon',\n            class: 'material-icons',\n            content: 'info'\n        }\n    ): void {\n        const snackbar_ref = this._snackbar.open(message, action, {\n            panelClass: [type],\n            duration: 5000\n        });\n        this.subscription(\n            'snackbar_close',\n            snackbar_ref.afterDismissed().subscribe(() => {\n                this.unsub('snackbar_close');\n                this.unsub('notify');\n            })\n        );\n        if (action) {\n            on_action = on_action || (() => snackbar_ref.dismiss());\n            this.subscription(\n                'notify',\n                snackbar_ref.onAction().subscribe(() => on_action())\n            );\n        }\n    }\n\n    /**\n     * Create success notification popup\n     * @param msg Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     */\n    public notifySuccess(msg: string, action?: string, on_action?: () => void): void {\n        const icon: ApplicationIcon = {\n            type: 'icon',\n            class: 'material-icons',\n            content: 'done'\n        };\n        this.notify('success', msg, action, on_action, icon);\n    }\n\n    /**\n     * Create error notification popup\n     * @param msg Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     */\n    public notifyError(msg: string, action?: string, on_action?: () => void): void {\n        const icon: ApplicationIcon = {\n            type: 'icon',\n            class: 'material-icons',\n            content: 'error'\n        };\n        this.notify('error', msg, action, on_action, icon);\n    }\n\n    /**\n     * Create warning notification popup\n     * @param msg Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     */\n    public notifyWarn(msg: string, action?: string, on_action?: () => void): void {\n        const icon: ApplicationIcon = {\n            type: 'icon',\n            class: 'material-icons',\n            content: 'warning'\n        };\n        this.notify('warn', msg, action, on_action, icon);\n    }\n\n    /**\n     * Create info notification popup\n     * @param msg Message to display on the notificaiton\n     * @param action Display text for the callback action\n     * @param on_action Callback of action on the notification\n     */\n    public notifyInfo(msg: string, action?: string, on_action?: () => void): void {\n        this.notify('info', msg, action, on_action);\n    }\n\n    /**\n     * Log data to the browser console\n     * @param type Type of message\n     * @param msg Message body\n     * @param args array of argments to log to the console\n     * @param stream Stream to emit the console on. 'debug', 'log', 'warn' or 'error'\n     * @param force Whether to force message to be emitted when debug is disabled\n     */\n    public log(\n        type: string,\n        msg: string,\n        args?: any,\n        stream: ConsoleStream = 'debug',\n        force: boolean = false\n    ): void {\n        log(type, msg, args, stream, force);\n    }\n\n    /**\n     * Get the current value of the named property\n     * @param name Property name\n     */\n    public get<U = any>(name: string): U {\n        return this._subjects[name] && this._subjects[name] instanceof BehaviorSubject\n            ? (this._subjects[name] as BehaviorSubject<U>).getValue()\n            : null;\n    }\n\n    /**\n     * Listen to value change of the named property\n     * @param name Property name\n     * @param next Callback for value changes\n     */\n    public listen<U = any>(name: string): Observable<U> {\n        if (!this._observers[name]) {\n            this.set<U>(name, null);\n        }\n        return this._observers[name];\n    }\n\n    /**\n     * Update the value of the named property\n     * @param name Property name\n     * @param value New value\n     */\n    public set<U = any>(name: string, value: U): void {\n        if (!this._subjects[name]) {\n            this._subjects[name] = new BehaviorSubject<U>(value);\n            this._observers[name] = this._subjects[name].asObservable();\n        } else {\n            this._subjects[name].next(value);\n        }\n    }\n\n    /** Wait for settings to be initialised before setting up the application */\n    private waitForSettings() {\n        // Wait until the settings have loaded before initialising\n        this._settings.initialised.pipe(first(_ => _)).subscribe(() => this.init());\n    }\n\n    /**\n     * Initialise application services\n     */\n    private init(): void {\n        this.setupComposer();\n        this.subscription('currentUser', this.store.select(selectCurrentUser)\n            .pipe( filter(user => user !== undefined) )\n            .pipe(take(1))\n            .subscribe((user: any) => {\n                // Once we know we have the user loaded.\n                this.setupAnalytics(user?.fmno);\n            })\n        );\n        this._composer.initialised.pipe(first(_ => _)).subscribe(() => {\n            this._initialised.next(true);\n        });\n        // Add service to window if in debug mode\n        if (window.debug) {\n            window.application = this;\n        }\n    }\n\n    /**\n     * Initialise the composer library comms\n     */\n    private setupComposer(): void {\n        this.log('SYSTEM', 'Setup up composer...');\n        const loading: ApplicationLoadingState = this.get('loading');\n        loading.composer = {\n            message: 'Initialising service connection',\n            state: 'loading'\n        };\n        this.set('loading', loading);\n        // Get application settings\n        const settings: ComposerSettings = this._settings.get('composer') || {};\n        const protocol = settings.protocol || location.protocol;\n        const host = settings.domain || location.hostname;\n        const port = settings.port || location.port;\n        const url = settings.use_domain ? `${protocol}//${host}:${port}` : location.origin;\n        const route = host.includes('localhost') && port === '4200' ? '' : settings.route || '';\n        const mock =\n            this._settings.get('mock') ||\n            location.href.includes('mock=true') ||\n            localStorage.getItem('mock') === 'true';\n        // Generate configuration object\n        const config: PlaceOSOptions = {\n            scope: 'public',\n            host: `${host}:${port}`,\n            auth_uri: `${url}/auth/oauth/authorize`,\n            token_uri: `${url}/auth/token`,\n            redirect_uri: `${location.origin}${route}/oauth-resp.html`,\n            handle_login: !settings.local_login,\n            mock\n        };\n        this._composer.setup(config);\n        loading.composer = {\n            message: 'Initialising service connection',\n            state: 'complete'\n        };\n        this.set('loading', loading);\n    }\n\n    private setupAnalytics(fmno: string) {\n        this.log('HEAP', `Loading heap ${this._environment?.heap_io_id}`);\n        // Default Heap app ID via the default setting\n        const heapIo = this._settings.get('app.heap_io');\n        if (this._environment?.heap_io_id) {\n            // Apply Heap app ID via the environmental setting\n            heapIo.app_id = this._environment.heap_io_id;\n        }\n        if (heapIo) {\n            this.analytics.load(heapIo);\n            if (fmno) {\n                this.analytics.identify(fmno);\n            }\n        } else {\n            this.log('HEAP', `Heap could not be found for the current frontend ${this._settings.frontend}`);\n        }\n    }\n\n}\n","import { Subject } from 'rxjs';\n\nimport {\n  BaseClass,\n  HashMap\n} from '@mckinsey-converge/base';\nimport {\n  ServiceLike,\n  ServiceManager\n} from './service-manager.class';\n\nexport type ApiEventType = 'value_change' | 'item_saved' | 'reset' | 'other';\n\nexport interface ApiEvent<T = HashMap> {\n  type: ApiEventType;\n  metadata: T;\n}\n\n\nexport class BaseDataClass extends BaseClass {\n  /** Subject for emitting events on the object */\n  protected readonly event_subject = new Subject<ApiEvent>();\n  /** Observable for events on this object */\n  public readonly events = this.event_subject.asObservable();\n  /** Unique Identifier of the object */\n  public readonly id: string;\n  /** Human readable name of the object */\n  public readonly name: string;\n  /** Email address associated with the object */\n  public readonly email: string;\n  /** Map of local property names to server ones */\n  protected _server_names: HashMap<string> = {};\n\n  /** Service for managing model on the server */\n  protected get _service(): ServiceLike {\n    return ServiceManager.serviceFor(BaseDataClass);\n  }\n\n  constructor(raw_data: HashMap) {\n    super();\n    this.id = raw_data.id || raw_data.zone_id || raw_data.email || '';\n    this.name = raw_data.name || '';\n    this.email = `${raw_data.email || ''}`.toLowerCase();\n  }\n\n  /**\n   * Save pending changes to server\n   */\n  public save(): Promise<BaseDataClass> {\n    if (this._service) {\n      const form = this.toJSON();\n      return new Promise((resolve, reject) => {\n        const promise = this.id\n          ? this._service.update(this.id, form)\n          : this._service.add(form);\n        promise.then(\n          (d) => {\n            this.event_subject.next({ type: 'item_saved', metadata: d });\n            resolve(d);\n          },\n          (_) => reject(_)\n        );\n      });\n    } else {\n      Promise.reject('No service to process request');\n    }\n  }\n\n  /**\n   * Delete this item from the server\n   */\n  public delete(): Promise<void> {\n    if (this.id) {\n      return this._service.delete(this.id);\n    }\n  }\n\n  /**\n   * Run task for this item on the service\n   * @param task_name Name of the task\n   * @param parameters Parameters to pass to the task request\n   */\n  public runTask(task_name: string, parameters: HashMap): Promise<void> {\n    if (this.id) {\n      return this._service.task(this.id, task_name, parameters);\n    }\n  }\n\n  /**\n   * Convert object into plain object\n   */\n  public toJSON(this: BaseDataClass): HashMap {\n    const obj: any = { ...this };\n    // Remove local private members\n    delete obj._service;\n    delete obj._changes;\n    delete obj.event_subject;\n    delete obj.events;\n    // Remove parent private members\n    delete obj._timers;\n    delete obj._intervals;\n    delete obj._subscriptions;\n    delete obj._server_names;\n    delete obj._initialised;\n    // Convert remaining members to be public\n    const keys = Object.keys(obj);\n    for (const key of keys) {\n      if (key[0] === '_') {\n        const new_key = this._server_names[key.substring(1)] || key.substring(1);\n        obj[new_key] = obj[key];\n        delete obj[key];\n      } else if (obj[key] === undefined) {\n        delete obj[key];\n      }\n    }\n    return obj;\n  }\n\n  /**\n   * Make a copy of this object\n   */\n  public clone(): BaseDataClass {\n    return new BaseDataClass(this);\n  }\n\n  /**\n   * Make a copy of this object without identification data\n   */\n  public duplicate(): BaseDataClass {\n    return new BaseDataClass({ ...this, id: null, email: null });\n  }\n}\n","import { ComposerService } from '@placeos/composer';\nimport { BehaviorSubject, Observable, of, Subject, Subscriber } from 'rxjs';\n\nimport { BaseDataClass } from './base-api.class';\nimport { BaseClass, HashMap } from '@mckinsey-converge/base';\nimport { ApplicationService } from './app.service';\nimport { toQueryString } from './api.utilities';\nimport { SettingsService } from './settings.service';\nimport { catchError, map } from 'rxjs/operators';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\n\nexport interface IEngineResponse {\n  results: HashMap[];\n  total: number;\n}\n\nexport class BaseAPIService<T extends {} = BaseDataClass> extends BaseClass {\n  /** Application service */\n  public parent: ApplicationService;\n  /** Display name of the service */\n  protected _name: string;\n  /** API Route of the service */\n  protected _api_route: string;\n  /** Map of state variables for Service */\n  protected _subjects: { [key: string]: BehaviorSubject<any> | Subject<any> } = {};\n  /** Map of observables for state variables */\n  protected _observers: { [key: string]: Observable<any> } = {};\n  /** Map of poll subscribers for API endpoints */\n  protected _subscribers: { [key: string]: Subscriber<any> } = {};\n  /** Map of promises for Service */\n  protected _promises: { [key: string]: Promise<any> } = {};\n  /** Comparison function for service items */\n  protected _compare: (a: T, b: T) => boolean = (a, b) =>\n    a === b || (a as any).id === (b as any).id;\n  /** Default filter function for list method */\n  protected _list_filter: (a: T) => boolean = (a) => !!a;\n\n  /** Http Client */\n  protected get http() {\n    return this._composer.http;\n  }\n  constructor(protected _composer: ComposerService,\n              protected settingsService: SettingsService) {\n    super();\n    this._name = 'Base';\n    this._api_route = 'base';\n    this.set('list', []);\n  }\n\n  /**\n   * Injects concierge into form_data.\n   */\n  private injectConcierge(form_data: HashMap) {\n      // we only send it over when concierge, since the BE may check for presence rather than\n      // if its true or not.\n      if (this.settingsService.concierge) {\n          return { ...form_data, concierge: true }\n      }\n      return form_data;\n  }\n\n  /**\n   * Initailise service\n   */\n  public init() {\n    this.load().then(\n      (_) => this._initialised.next(true),\n      (err) => this.timeout('init', () => this.init(), 1000)\n    );\n  }\n\n  /**\n   * Get API route for the service\n   * @param engine Whether endpoint is using the application API or engine API\n   */\n  public route(engine: boolean = false) {\n    const endpoint = engine\n      ? this._composer.auth.api_endpoint\n      : '/api/staff';\n    return `${endpoint}/${this._api_route}`;\n  }\n\n  /** API Route of the service */\n  public get api_route() {\n    return this._api_route;\n  }\n\n  /**\n   * Get the current value of the named property\n   * @param name Property name\n   */\n  public get<U = any>(name: string): U {\n    if (!this._observers[name]) {\n      this.set<U>(name, null);\n    }\n    return (this._subjects[name] as BehaviorSubject<U>).getValue();\n  }\n\n  /**\n   * Listen to value change of the named property\n   * @param name Property name\n   * @param next Callback for value changes\n   */\n  public listen<U = any>(name: string): Observable<U> {\n    if (!this._observers[name]) {\n      this.set<U>(name, null);\n    }\n    return this._observers[name];\n  }\n\n  /**\n   * Update the value of the named property\n   * @param name Property name\n   * @param value New value\n   */\n  protected set<U = any>(name: string, value: U): void {\n    if (!this._subjects[name]) {\n      this._subjects[name] = new BehaviorSubject<U>(value);\n      this._observers[name] = this._subjects[name].asObservable();\n    } else {\n      this._subjects[name].next(value);\n    }\n  }\n\n  /**\n   * Get list of loaded items\n   * @param predicate Function for filtering the list\n   */\n  public filter(predicate: (a: T) => boolean = this._list_filter): T[] {\n        const list: T[] = this.get('list');\n        return list.filter(predicate);\n  }\n\n  /**\n   * Get item with the given id from the loaded items\n   * @param id ID of the item\n   */\n  public find(id: string): T {\n    const list = this.get('list');\n    return list.find((i) => i.id === id || (i.email?.toLowerCase() === id?.toLowerCase()));\n  }\n\n  /**\n   * Query the index of the API route associated with this service\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public query(query_params: HashMap = {}): Promise<T[]> {\n    let engine = false;\n    let cache = 1000;\n    /* istanbul ignore else */\n    if (query_params) {\n      engine = !!query_params.engine;\n      delete query_params.engine;\n      cache = typeof query_params.cache !== 'boolean' ? query_params.cache || 1000 : 1000;\n      typeof query_params.cache !== 'boolean' && delete query_params.cache;\n    }\n    let query = toQueryString(query_params);\n    const key = `query|${query}`;\n    if (!this._promises[key]) {\n      // Bring back once implemented in the API\n      // if (this.settingsService.concierge) {\n      //   query = query + '&check_access=true';\n      // }\n      this._promises[key] = new Promise((resolve, reject) => {\n        const url = `${this.route(engine)}${query ? '?' + query : ''}`;\n        let result: T[] | HashMap[] = [];\n        this.http.get(url).subscribe(\n          (d: IEngineResponse | HashMap[]) => {\n            result =\n              d && d instanceof Array\n                ? d.map((i) => this.process(i))\n                : d && !(d instanceof Array) && d.results\n                ? (d.results as HashMap[])\n                : d && !(d instanceof Array) && !d.results \n                ? [d]\n                : [];\n          },\n          (e) => {\n            reject(e);\n            this._promises[key] = null;\n          },\n          () => {\n            resolve(result);\n            this.timeout(key, () => (this._promises[key] = null), cache);\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n  /**\n   * query function version -2 - returns observable instead of promise...\n   * Query the index of the API route associated with this service\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n   public queryObsr(query_params: HashMap = {}):Observable<any>{\n    let engine = false;\n    let cache = 1000;\n    /* istanbul ignore else */\n    if (query_params) {\n      engine = !!query_params.engine;\n      delete query_params.engine;\n    }\n    let query = toQueryString(query_params);\n    const key = `query|${query}`;\n    const url = `${this.route(engine)}${query ? '?' + query : ''}`;\n    return this.http.get(url).pipe(\n      map((d: IEngineResponse | HashMap[]) =>  this.processApiResult(d) ),\n      catchError(<T>(error: any, result?: T) => {\n        console.log(error);\n        return of(result as T);\n        })\n    );;\n  }\n\n\n  /**\n   * \n   * @param d \n   * @returns \n   */\n   processApiResult(d: IEngineResponse | HashMap[]): IEngineResponse | HashMap[]{\n    let result: IEngineResponse | HashMap[] =\n        d && d instanceof Array\n          ? d.map((i) => this.process(i))\n          : d && !(d instanceof Array) && d.results\n          ? (d.results as HashMap[])\n          : d && !(d instanceof Array) && !d.results \n          ? [d]\n          : [];\n    return result;\n  }\n\n  /**\n   * query function version -2 - returns observable instead of promise...\n   * Query the index of the API route associated with this service\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public queryRoomsForQR(query_params: HashMap = {}):Observable<any>{\n    let engine = false;\n    let cache = 1000;\n    /* istanbul ignore else */\n    if (query_params) {\n      engine = !!query_params.engine;\n      delete query_params.engine;\n    }\n    let query = toQueryString(query_params);\n    const key = `query|${query}`;\n    const url = `${this.route(engine)}${query ? '?' + query : ''}`;\n    return this.http.get(url);\n  }\n  \n  /**\n   * Query the API route for a sepecific item\n   * @param id ID of the item\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public show(id: string, query_params: HashMap = {}): Promise<T> {\n    let engine = false;\n    /* istanbul ignore else */\n    if (query_params) {\n      engine = !!query_params.engine;\n      delete query_params.engine;\n    }\n    const query = toQueryString(query_params);\n    const key = `show|${id}|${query}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<T>((resolve, reject) => {\n        const url = `${this.route(engine)}/${id}${query ? '?' + query : ''}`;\n        let result: T = null;\n        this.http.get(url).subscribe(\n          (d) => (result = this.process(d)),\n          (e) => {\n            reject(e);\n            this._promises.new_item = null;\n          },\n          () => {\n            resolve(result);\n            this.timeout(key, () => (this._promises[key] = null), 1000);\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n  /**\n   * Make post request for a new item to the service\n   * @param form_data Data to post to the server\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public add(form_data: HashMap, query_params: HashMap = {}): Promise<T> {\n    /* istanbul ignore else */\n    if (!this._promises.new_item) {\n      this._promises.new_item = new Promise<T>((resolve, reject) => {\n        const query = toQueryString(query_params);\n        const url = `${this.route(query_params.engine)}${query ? '?' + query : ''}`;\n        let result: T = null;\n        this.http.post(url, this.injectConcierge(form_data)).subscribe(\n          (d) => (result = this.process(d)),\n          (e) => {\n            reject(e);\n            this.analyticsEvent(`create-${this._name.toLowerCase()}-failed`);\n            this._promises.new_item = null;\n          },\n          () => {\n            resolve(result);\n            this.set('list', this.updateList(this.get('list'), [result]));\n            this.analyticsEvent(`create-${this._name.toLowerCase()}-success`);\n            this._promises.new_item = null;\n          }\n        );\n      });\n    }\n    return this._promises.new_item;\n  }\n\n  /**\n   * Perform API task for the given item ID\n   * @param id ID of the item\n   * @param task_name Name of the task\n   * @param form_data Map of data to pass to the API\n   * @param method Verb to use for request\n   */\n  public \n  task<U = any>(\n    id: string,\n    task_name: string,\n    form_data: HashMap = {},\n    method: 'post' | 'get' = 'post'\n  ): Promise<U> {\n    const query =  toQueryString(this.injectConcierge(form_data));\n    const key = `task|${id}|${task_name}|${query}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<U>((resolve, reject) => {\n        const post_data = { ...form_data, id, _task: task_name };\n        const url = `${this.route(false)}/${id}/${task_name}`;\n        let result: any;\n        const request =\n          method === 'post'\n            ? this.http.post(url, post_data)\n            : this.http.get(`${url}${query ? '?' + query : ''}`);\n        request.subscribe(\n          (d) => (result = d),\n          (e) => {\n            reject(e);\n            this.analyticsEvent(\n              `${this._name.toLowerCase()}-task-${task_name}-failed`,\n              id\n            );\n            delete this._promises[key];\n          },\n          () => {\n            resolve(result as U);\n            this.analyticsEvent(\n              `${this._name.toLowerCase()}-task-${task_name}-success`,\n              id\n            );\n            this.timeout(key, () => delete this._promises[key], 1000);\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n\n  /**\n   * V-2\n   * Perform API task for the given item ID\n   * @param id ID of the item\n   * @param task_name Name of the task\n   * @param form_data Map of data to pass to the API\n   * @param method Verb to use for request\n   */\n   public taskObsr<U = any>( \n    id: string, \n    task_name: string, \n    form_data: HashMap = {}, \n    method: 'post' | 'get' = 'post' ):Observable<any>{\n    const query =   toQueryString(this.injectConcierge(form_data));\n    let engine = false;\n    let cache = 1000;\n    const post_data = { ...form_data, id, _task: task_name };\n    const url = `${this.route(false)}/${id}/${task_name}`;\n    let result: any;\n\n    const request = method === 'post'\n      ? this.http.post(url, post_data)\n      : this.http.get(`${url}${query ? '?' + query : ''}`);\n    \n      return request;\n  }\n\n\n  /**\n   * Make put request for changes to the item with the given id\n   * @param id ID of the item being updated\n   * @param form_data New values for the item\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public update(id: string, form_data: HashMap, query_params: HashMap = {}): Promise<T> {\n    const key = `update|${id}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<T>((resolve, reject) => {\n        const query = toQueryString(this.injectConcierge(query_params));\n        const url = `${this.route(query_params.engine)}/${id}${query ? '?' + query : ''}`;\n        let result: T = null;\n        this.http.put(url, this.injectConcierge(form_data)).subscribe(\n          (d) => (result = this.process(d)),\n          (e) => {\n            reject(e);\n            this.analyticsEvent(`update-${this._name.toLowerCase()}-failed`, id);\n            this._promises[key] = null;\n          },\n          () => {\n            resolve(result);\n            this.set(\n              'list',\n              this.updateList(this.removeItem(this.get('list'), { id } as any), [\n                result\n              ])\n            );\n            this.analyticsEvent(`update-${this._name.toLowerCase()}-success`, id);\n            this._promises[key] = null;\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n\n  /**\n   * update function version -2 - returns observable instead of promise...\n   * @param id url id with respect to update api\n   * @param form_data data to be update \n   * @param should_inject_concierge common value to be set to add concierge: true to the query url and body\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n   public updateObsr(id: string, form_data: HashMap, should_inject_concierge: Boolean = false, query_params: HashMap = {}):Observable<any>{\n    const query = should_inject_concierge ? toQueryString(this.injectConcierge(query_params)) : false;\n    const url = `${this.route(query_params.engine)}/${id}${query ? '?' + query : ''}`;\n    const body = should_inject_concierge ? this.injectConcierge(form_data) : form_data;\n    \n    return this.http.put(url, body)\n      .pipe(\n          map((d: IEngineResponse | HashMap[]) =>  this.processApiResult(d) \n        ),\n        catchError(<T>(error: any, result?: T) => {\n          console.log(error);\n          this.analyticsEvent(`update-${this._name.toLowerCase()}-failed`, id);\n          return of(error as T);\n        })\n      );\n\n  }\n\n  /**\n   * update function version -2 - returns observable instead of promise...\n   * @param form_data data to be update \n   * @param should_inject_concierge common value to be set to add concierge: true to the query url and body\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n   public uploadSpacePhotos(apiSubRoute: string, form_data: HashMap, should_inject_concierge: Boolean = false, query_params: HashMap = {}):Observable<any>{\n    const query = should_inject_concierge ? toQueryString(this.injectConcierge(query_params)) : false;\n    const url = `${this.route(query_params.engine)}/${apiSubRoute}${query ? '?' + query : ''}`;\n    const body = should_inject_concierge ? this.injectConcierge(form_data) : form_data;\n\n    const token = sessionStorage.length ? JSON.parse(sessionStorage.getItem('OAUTH.params')).access_token : '';\n\n    const headers = new HttpHeaders({\n      'Authorization': `Bearer ${token}`,\n    });\n    \n  const requestOptions = { headers: headers };\n\n    // return this.httpClient.post(url, body, {\n    //       ...requestOptions \n    //   });\n\n    return this.http.post(url, body);\n\n  }\n\n  /**\n   * Make delete request for the given item\n   * @param id ID of item\n   */\n  public delete(id: string, q: HashMap = {}): Promise<void> {\n    const key = `delete|${id}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<void>((resolve, reject) => {\n        const query = toQueryString(q);\n        const url = `${this.route()}/${id}${query ? '?' + query : ''}`;\n        this.http.delete(url).subscribe(\n          (_) => null,\n          (e) => {\n            reject(e);\n            this._promises[key] = null;\n          },\n          () => {\n            this.set('list', this.removeItem(this.get('list'), { id } as any));\n            this._promises[key] = null;\n            resolve();\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n  /**\n   * Load initial data for the service\n   */\n  protected async load(): Promise<void> {\n  }\n\n  /**\n   * Post analytics event for this service\n   * @param action Name of the action to post\n   */\n  protected analyticsEvent(action: string, label?: string) {\n    // if (this.parent && this.parent.Analytics) {\n    //     this.parent.Analytics.track(this._name, { desc: `${this.parent.name.toLowerCase()}-${action}`, label });\n    // }\n  }\n\n  /**\n   * Convert raw API data into a valid API Object\n   * @param raw_item Raw API data\n   */\n  protected process(raw_item: HashMap): T {\n    return raw_item as T;\n  }\n\n  /**\n   * Update recorded list of items\n   * @param old_list Old list of items\n   * @param list List of updated items\n   * @param compareFn Function to compare items to remove duplicates\n   */\n  public updateList(\n    old_list: T[],\n    list: T[],\n    compareFn: (a: T, b: T) => boolean = this._compare\n  ): T[] {\n    /* istanbul ignore else */\n    if (!list || list.length === 0) {\n      return old_list;\n    }\n    const new_list: T[] = [];\n    const mixed_list = [...list, ...old_list];\n    /* istanbul ignore else */\n    if (!compareFn) {\n      compareFn = this._compare;\n    }\n    for (const item of mixed_list) {\n      const found = new_list.find((i) => compareFn(i, item));\n      /* istanbul ignore else */\n      if (!found) {\n        new_list.push(item);\n      }\n    }\n    return new_list;\n  }\n\n  /**\n   * Remove the given item from the given list\n   * @param list List of items\n   * @param item Item to remove\n   * @param compareFn Function to compare items\n   */\n  protected removeItem(list: T[], item: T, compareFn?: (a: T, b: T) => boolean) {\n    const new_list = [];\n    /* istanbul ignore else */\n    if (!compareFn) {\n      compareFn = this._compare;\n    }\n    list.forEach((i) => (compareFn(item, i) ? null : new_list.push(i)));\n    return new_list;\n  }\n}\n","import { SelectOption } from '../../../../ui/src/lib/options/select-option';\nimport { Building } from '../organisation/building.class';\nimport { Booking } from '../bookings/booking.class';\nimport { User } from '../users';\nimport { Space } from '../spaces';\nimport { SpaceBookingRuleOptions } from '../spaces/space.class';\nimport {\n    BookingFormData,\n} from './booking.form.data';\nimport { statusFromBookings } from '../bookings/booking.utilities';\nimport { rulesForSpace } from '../bookings/space.utilities';\nimport { SpaceStatus } from '../bookings/space.types';\nimport { SpaceFeatures } from '../spaces/space.class';\nimport { HashMap } from 'libs/base/src/lib/types.utilities';\n\nexport const spaceExtraFeatureToDisplayName = (feature: SpaceFeatures) => {\n    switch (feature) {\n        case SpaceFeatures.VideoConference:\n            return 'Video conference (VC)';\n        case SpaceFeatures.ConferencePhone:\n            return 'Conference phone';\n        case SpaceFeatures.WirelessContentSharing:\n            return 'Wireless content sharing';\n        case SpaceFeatures.FlipChart:\n            return 'Flip chart';\n        case SpaceFeatures.Glassboard:\n            return 'Glassboard';\n        case SpaceFeatures.ElectronicWhiteboard:\n            return 'Whiteboard';\n        case SpaceFeatures.ConferenceRoom:\n            return 'Conference';\n        case SpaceFeatures.TeamRoom:\n            return 'Team';\n        case SpaceFeatures.PartnerOffice:\n            return 'Partner';\n        case SpaceFeatures.PhoneBooth:\n            return 'Phone booth';\n        case SpaceFeatures.NaturalLight:\n            return 'Room with window only (natural light)';\n        case SpaceFeatures.BoardRoom:\n            return 'Boardroom room style';\n        case SpaceFeatures.CocktailRoom:\n            return 'Cocktail room style';\n        case SpaceFeatures.TheatreRoom:\n            return 'Theatre room style';\n        case SpaceFeatures.WorkshopRoom:\n            return 'Workshop room style';\n        case SpaceFeatures.UShapeRoom:\n            return 'U Shape room style';\n        case SpaceFeatures.Miscellaneous:\n            return 'Miscellaneous room style'\n        case SpaceFeatures.Catering:\n            return 'Rooms with catering';\n        // TODO: add any special display handling here.\n        default:\n            return feature;\n    }\n};\n\n\nexport const instantBookOption: SelectOption<any> = {\n    value: 'instant-book',\n    display: 'Listing you can book without waiting for a host approval',\n    shortDisplay: 'Instant book'\n};\nexport const instantBookOptions: SelectOption<any>[] = [\n    instantBookOption\n];\n\nexport const mapSpaceFeaturesToSelectOption = (f: SpaceFeatures): SelectOption<any> => {\n    const display = spaceExtraFeatureToDisplayName(f);\n    return ({\n        value: f,\n        display,\n        // Useful for long text, like that of the instant-book\n        // option.\n        //\n        // We do not expect this option object to be modified\n        // at any further point before it appears on screen -\n        // although that may change in future releases.\n        shortDisplay: display\n    });\n};\n\nexport const roomEquipmentRequiredOptions: SelectOption<any>[] = [\n    SpaceFeatures.VideoConference,\n    SpaceFeatures.ConferencePhone,\n    SpaceFeatures.WirelessContentSharing,\n    SpaceFeatures.FlipChart,\n    SpaceFeatures.Glassboard,\n    SpaceFeatures.ElectronicWhiteboard\n].map(mapSpaceFeaturesToSelectOption);\n\nexport const internalRoomTypeRequiredOptions: SelectOption<any>[] = [\n    SpaceFeatures.PartnerOffice,\n    SpaceFeatures.ConferenceRoom,\n    SpaceFeatures.TeamRoom,\n    SpaceFeatures.PhoneBooth\n].map(mapSpaceFeaturesToSelectOption);\n\nexport const externalRoomTypeRequiredOptions: SelectOption<any>[] = [\n    SpaceFeatures.ConferenceRoom,\n    SpaceFeatures.TeamRoom\n].map(mapSpaceFeaturesToSelectOption);\n\nexport const roomDetailsRequired: SelectOption<any>[] = [\n    SpaceFeatures.NaturalLight,\n    SpaceFeatures.BoardRoom,\n    SpaceFeatures.CocktailRoom,\n    SpaceFeatures.TheatreRoom,\n    SpaceFeatures.WorkshopRoom,\n    SpaceFeatures.UShapeRoom,\n    SpaceFeatures.Miscellaneous\n].map(mapSpaceFeaturesToSelectOption);\n\nexport const roomCateringAvailable: SelectOption<any>[] = [\n    SpaceFeatures.Catering,\n].map(mapSpaceFeaturesToSelectOption);\n\n/**\n * Defines the reason by which spaces are filtered out / missing.\n */\nexport enum SpaceFilterReason {\n    /**\n     * Spaces were shown and not all filtered out.\n     */\n    None = 'None',\n\n    /**\n     * If room filters are applied to the set of rooms,\n     * and rooms are available if not applied by filtering.\n     */\n    Filters = 'Filters',\n\n    /**\n     * We check office rules first to determine if its been filtered.\n     */\n    OfficeRules = 'OfficeRules',\n\n    /**\n     * Fallback as the end case if no results are found.\n     */\n    DateTime = 'DateTime',\n\n    /**\n     * In case there are no results for a buiding but there are other office buidings in the same city.\n     */\n    AlternateBuildingsFound = 'AlternateBuildingsFound',\n\n    /**\n     * If room is non-bookable in the system\n     */\n    NonBookable = 'NonBookable'\n}\n\nexport interface FilteredSpaces {\n    spaces: Space[] | undefined;\n    reason: SpaceFilterReason;\n    statusMap: HashMap<SpaceStatus>;\n    specificReason?: SpaceFilterReason;\n}\n\n/**\n * Filter spaces by filters locally. TBD in the future for real API pagination.\n *\n * @param formFilters - the set of filters to apply on the list of spaces.\n * @param spaces - the list of spaces to filter\n * @param activeForm - the landing page set of filters.\n * @param buildings - the list of buildings loaded, used to retrieve building-specific booking rules.\n * @param currentUser - the current user\n */\nexport const filterSpacesByAppliedFilters = (\n    formFilters: SelectOption<any>[],\n    spaces: Space[] | undefined, // the resultshere are raw JSON Spaces, not an array of the Space class\n    activeForm: BookingFormData,\n    buildings: Building[] = [],\n    currentUser: User | undefined): FilteredSpaces => {\n    const instantBook: boolean = formFilters.some(f => f.value === instantBookOption.value);\n    const onlyCatering: boolean  = formFilters.some(f => f.value === SpaceFeatures.Catering);\n    // Drop incompatible spaces. If no filters were given, just return the array unchanged.\n    const featureFilters = formFilters.filter(filter => ![instantBookOption.value, SpaceFeatures.Catering].includes(filter.value));\n    const formFiltersEmpty = featureFilters.length === 0;\n\n    // R--- refactor activeForm? Only after forms can handle dateTz\n    // Blocked by date time input refactor\n    const options: SpaceBookingRuleOptions = {\n        duration: activeForm.duration,\n        host: currentUser,\n        dateTz: activeForm.dateTz,\n    };\n    let rulesCount = 0;\n    let ruleReason = '';\n    let excludedByFiltersCount = 0;\n    const statusMap: HashMap<SpaceStatus> = {};\n    // console.group();\n    const filteredSpaces = spaces?.map(space => space instanceof Space ? space : new Space(space)).filter(raw_space => {\n        const space = new Space(raw_space); // Construct the full fledged space\n        const building = buildings.find(b => space.zones.includes(b.id));\n        const rules = rulesForSpace({\n            time: options?.dateTz?.ms,\n            duration: options.duration,\n            user: options.host,\n            rules: building?.booking_rules,\n            space\n        });\n        ruleReason = rules.reason;\n        let valid = !rules.hide;\n        if (!valid) {\n            rulesCount++;\n            return false;\n        }\n\n\n        // Check for all the form filters ( except 'catering' )\n        let hasAllFeatures: boolean;\n        const internalRoomTypeFilters = [\n            'conference',\n            'meeting_room',\n            'partner',\n            'phone_booth',\n            'team_room',\n        ];\n\n        if (featureFilters.length === 0) {\n            hasAllFeatures = true;\n        } else if(featureFilters.every(f => internalRoomTypeFilters.includes(f.value))) {    // If all featureFilters(selected filters) are present in internalRoomTypeFilters, make the filtering inclusive(return on first true) \n            hasAllFeatures = featureFilters.some(f => space.featuresArray.includes(f.value));\n          } else {    // If any featureFilters(selected filters) are not present in internalRoomTypeFilters, make the filtering exclusive(return on first false)\n            hasAllFeatures = featureFilters.every(f => space.featuresArray.includes(f.value));\n          }\n\n        const canBook = instantBook ? space.bookable : true;\n        const matchesType = activeForm?.bookingType?.value === 'allRooms'\n                            ? true\n                            : space?.internal_or_external?.length\n                            ? space.internal_or_external === activeForm?.bookingType?.value\n                            : true;\n        valid = valid && matchesType && (formFiltersEmpty || hasAllFeatures) && canBook;\n        let hasCatering = building?.has_catering;\n        if (space?.has_catering === false) {\n            hasCatering = false;\n        }\n        // need the room catering to override.\n        if (onlyCatering && !hasCatering) {\n            valid = false;\n            // console.log('Excluded by Catering');\n        }\n\n        // count this space if the only reason it can't be shown is because one of the filters excluded it\n        if (!hasAllFeatures) {\n            valid = false;\n            // console.log('Excluded by Status');\n        }\n\n        const status = statusFromBookings(\n            space.bookings.length ? space.bookings.map(b => new Booking(b)) : space.settings.bookings.map(b => new Booking(b)),\n            space.bookable && !rules.hide,\n            !rules.auto_approve,\n            activeForm.dateTz,\n            space\n        );\n\n        // only compute room availability here right now if instant book option is chosen and room still valid.\n        if (instantBook && valid) {\n            valid = status.status === SpaceStatus.Available;\n            if (!valid) console.group('Excluded by Status');\n            \n        }\n\n\n        /** \n         * In case of recurring rooms availability - Room having no availability filter in the results page\n         * Available indicates that is is available/Not available to be booked durring the queried times.\n         * \n         */\n        if(!space.available) {\n            valid = space.available\n        }\n        /** */\n\n        // cache space status\n        if (valid) {\n            statusMap[space.id] = status.status;\n        } else {\n            excludedByFiltersCount++;\n        }\n        // console.log('Valid:', valid);\n        return valid;\n    });\n\n    const buildingsInSameCity = buildings.filter(\n        (_) =>activeForm?.location!==undefined && activeForm?.location?.length &&  _.city === activeForm?.location[0]?.meta?.building?.city\n    ) || [];\n    const alternateBuildings = buildingsInSameCity.filter(building =>\n        !activeForm.location.some(locationItem =>\n            locationItem.meta?.building?.id === building.id\n        )\n    );\n\n    // console.groupEnd();\n    let reason, specificReason = SpaceFilterReason.None;\n    // console.log('Spaces:', filteredSpaces?.length, excludedByFiltersCount, rulesCount, ruleReason)\n    if (filteredSpaces?.length === 0) {\n        if (excludedByFiltersCount > 0 && (!formFiltersEmpty || onlyCatering)) {\n            reason = SpaceFilterReason.Filters;\n        } else if (rulesCount > 0) {\n            reason = SpaceFilterReason.OfficeRules;\n        } else if(alternateBuildings){\n            reason = SpaceFilterReason.AlternateBuildingsFound;\n        }\n        else {\n            reason = SpaceFilterReason.DateTime;\n        }\n\n        if (ruleReason === SpaceFilterReason.OfficeRules) {\n            specificReason = SpaceFilterReason.OfficeRules;\n        }\n    }\n\n    return { spaces: filteredSpaces, reason, statusMap, specificReason };\n};\n","import { BookingFormData } from './booking.form.data';\nimport {\n    createAction,\n    props\n} from '@ngrx/store';\nimport { Payload } from '../../../../loading/src/lib/loading.actions';;\nimport { SelectOption } from '../../../../ui/src/lib/options/select-option';\n\n\nexport const storeBookingFormData = createAction('[BookingForm] Store Form Data',\n    props<Payload<Partial<BookingFormData>>>());\n\nexport const clearBookingFormData = createAction('[BookingForm] Clear Form Data');\n\nexport const storeRoomFilters = createAction('[BookingForm] Store Room Filters',\n    props<Payload<SelectOption<any>[]>>());\n\nexport const clearRoomFilters = createAction('[BookingForm] Clear Room Filters');\n\nexport const openBookingSurvey = createAction('[BookingSurvey] Open Survey Modal');\n","import { SelectOption } from '../../../../ui/src/lib/options/select-option';\nimport { RoomQueryOptions } from '../../../../rooms/src/lib/rooms.types';\nimport { User } from '../users/user.class';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\nimport { DaysOfWeek, RecurrencePeriod } from '../recurrence/recurrence.utils';\nimport { Building } from '../organisation';\n\nexport const DEFAULT_BOOKING_DURATION = 30;\n\nexport const internalBookingTypeOption = {\n    value: 'internal',\n    display: 'Internal',\n};\n\nexport const allBookingTypeOption = {\n    value: 'allRooms',\n    display: 'All Rooms',\n};\n\nexport const bookingTypeOptions: SelectOption<string>[] = [\n    internalBookingTypeOption,\n    {\n        value: 'external',\n        display: 'External',\n    }\n];\n\nexport const defaultRoomSizeOption = {\n    value: '2',\n    display: '3-9 People',\n};\n\nexport const roomSizeOptions: SelectOption<string>[] = [\n    {\n        value: '1',\n        display: '1-2 People',\n    },\n    defaultRoomSizeOption,\n    {\n        value: '3',\n        display: '10+ People',\n    }\n];\n\nexport const roomSizeOptionsKiosk: SelectOption<string>[] = [\n   ...roomSizeOptions,\n    {\n        value: '4',\n        display: 'All Rooms',\n    },\n];\n\nexport const roomCapacityToValue = (roomSize: string): number => {\n    switch (roomSize) {\n        case '1':\n            return 1;\n        case '2':\n            return 3;\n        case '3':\n            return 10;\n        case '4':\n            return null;\n    }\n};\n\nexport const roomMaxCapacityToValue = (roomSize: string): number => {\n    switch (roomSize) {\n        case '1':\n            return 2;\n        case '2':\n            return 9;\n        default:\n            return null;\n    }\n};\n\nexport interface BookingFormData {\n    // R--- off the rails, define these \"any's\"\n    id?: string;\n    location: SelectOption<string>[];\n    dateTz: DateTZ;\n    /**\n     * Duration, in minutes.\n     */\n    duration: number;\n    bookingType: SelectOption<any>;\n    roomSize: SelectOption<any>;\n    selectedRoom?: any;\n    organiser?: SelectOption<string>;\n    title?: string;\n    attendees?: any[];\n    code?: string;\n    notes?: string;\n    head_count?: number;\n    creator?: User;\n    company?: any[];\n    //Recurrence fields\n    recurrence_period?: RecurrencePeriod;\n    recurrence_interval?: number;\n    recurrence_endTz?: DateTZ;\n    recurrence_count?: number;\n    recurrence_starts?: Array<DateTZ>;\n    recurrence_exceptions?: Array<number>; //SHOULD BE DATETZ\n    recurrence_days?: Array<DaysOfWeek>;\n    timezone?: string;\n    offset?: number;\n    buildings?: Building[];\n    is_recurrent?: boolean;\n    action?: string; // helping to set staff app recurring action flag for edit/clone in the active form\n    ignore?: string; // helping while editing - recurring series rooms search api call\n    bookable?: boolean; // set while editing - recurring series rooms search api call\n    occurrence_edits?: string[];\n    opt_out?:boolean\n}\n\n/**\n * Converts form data into API query parameters.\n */\nexport const roomFormDataToQuery = (\n    data: BookingFormData\n): RoomQueryOptions => {\n    // remove all buildings chip from query\n    const filteredLocationIds = data?.location\n        .filter((l) => l.groupChild)\n        .map((l) => l.value)\n        .join(',');\n    return {\n        dateTz: data?.dateTz,\n        duration: data?.duration,\n        locations: filteredLocationIds,\n        capacity: roomCapacityToValue(data?.roomSize?.value),\n        capacity_max: roomMaxCapacityToValue(data?.roomSize?.value),\n\n        is_recurrent: data?.is_recurrent,\n        recurrence_period: data?.recurrence_period,\n        recurrence_interval: data?.recurrence_interval,\n        recurrence_endTz: data?.recurrence_endTz,\n        recurrence_count: data?.recurrence_count,\n        recurrence_starts: data?.recurrence_starts,\n        recurrence_exceptions: data?.recurrence_exceptions, //SHOULD BE DATETZ\n        recurrence_days: data?.recurrence_days,\n        timezone: data?.timezone,\n        offset: data?.offset,\n        buildings: data?.buildings,\n        bookable: data?.bookable,\n        ignore: data?.ignore\n    };\n};\n","import { BookingFormState } from './booking.form.types';\nimport {\n    DEFAULT_BOOKING_DURATION,\n    defaultRoomSizeOption,\n    internalBookingTypeOption\n} from './booking.form.data';\nimport { DateNow } from '@mckinsey-converge/date-tz';\n\nconst now = DateNow(new Date())\n\nexport const defaultTestBookingForm = (): BookingFormState => ({\n    activeForm: {\n        dateTz: now,\n        duration: 2 * DEFAULT_BOOKING_DURATION,\n        location: [],\n        bookingType: internalBookingTypeOption,\n        roomSize: defaultRoomSizeOption\n    },\n    activeFormFilters: []\n});\n","import { createSelector } from '@ngrx/store';\nimport {\n    RoomStoreState\n}  from '../../../../rooms/src/lib/rooms.types';\nimport {\n    loadLaterThatDayResults,\n    loadNextDayResults,\n    loadRoomsForResults,\n    roomStateSelector,\n    loadByIdResults,\n    loadDiffSizeResults,\n    loadRoomsForResultsMap\n} from '../../../../rooms/src/lib/rooms.actions';\nimport {\n    loadHomepageBookingsResults,\n    loadUpcomingBookingsResults,\n    loadPastBookingsResults,\n    loadCancelledBookingsResults,\n    loadBookingByIdResults,\n    bookingStateSelector\n} from '../../../../bookings/src/lib/bookings.actions';\nimport { Building } from '../organisation/building.class';\nimport { BuildingStoreState } from '../../../../buildings/src/lib/buildings.types';\nimport { selectLoadBuildingsSuccess } from '../../../../buildings/src/lib/buildings.actions';\nimport { Space } from '../spaces/space.class';\nimport { User } from '../users/user.class';\nimport { selectCurrentUser } from '../../../../user/src/lib/user.actions';\nimport { UserStoreState } from '../../../../user/src/lib/user.types';\nimport { LoadingModel } from '../../../../loading/src/lib/loading.model';\nimport { SelectOption } from '../../../../ui/src/lib/options/select-option';\n\nimport {\n    SpaceFilterReason,\n    filterSpacesByAppliedFilters,\n    FilteredSpaces\n} from './booking-filter.utils';\nimport {\n    BookingFormData,\n    internalBookingTypeOption,\n} from './booking.form.data';\nimport {\n    BookingFormState,\n    BookingStoreState,\n} from './booking.form.types';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\nimport { BookingAction, RecurrencePeriod, SeriesAction } from '../recurrence/recurrence.utils';\n\n\nexport const selectBookingFormsData =\n    (state: BookingStoreState | RoomStoreState | BuildingStoreState | UserStoreState) =>\n        (state as any).bookingForm as BookingFormState;\n\nexport const selectActiveForm = createSelector(selectBookingFormsData, state => {\n    // Recreate because serialized form dateTz doesn't have DateTZ class methods\n    if (!state.activeForm?.dateTz) {\n        return state.activeForm\n    }\n    const { date, is_local_tz, building_tz} = state.activeForm?.dateTz;\n    const endTzDate =   state.activeForm?.recurrence_endTz?.date;\n    const recurrence_endTz = endTzDate ? {\n        recurrence_endTz : new DateTZ({ date: endTzDate.valueOf(), is_local_tz, building_tz })\n    } : {};\n\n    const recurrence_starts =  state.activeForm?.recurrence_starts\n\t\t\t? {\n\t\t\t\t\trecurrence_starts: state.activeForm?.recurrence_starts.map( el =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// at final step of booking creation process recurrence_start becomes Array<number> which need to be Array<DateTz>\n\t\t\t\t\t\t\t// To Do: Refactor - apps/staff/src/app/booking/booking-create/booking-form-base.component.ts lno: 186\n\t\t\t\t\t\t\treturn new DateTZ({ date: typeof el === 'number' ? el * 1000 : el.date.valueOf(), is_local_tz, building_tz })\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t: {};\n\n\n    const recEditingSearchPayload =  (state.activeForm.action === SeriesAction.EDIT && state.activeForm.is_recurrent)\n\t\t\t?\n\t\t  {\n\t\t\t\tid: state.activeForm.id,\n\t\t\t\tignore: state.activeForm.ignore,\n\t\t\t\tbookable: state.activeForm.bookable\n\t\t\t}\n\t\t\t: {};\n\n\n\n\n    return {\n        ...state.activeForm,\n        dateTz: new DateTZ({ date: date.valueOf(), is_local_tz, building_tz }),\n        ...recurrence_endTz,\n        ...recurrence_starts,\n\t\t\t\t...recEditingSearchPayload\n    }\n});\n\nexport const selectBookingType = createSelector(selectActiveForm,\n    (form) => form?.bookingType);\n\nexport const selectBookingLocations = createSelector(selectActiveForm,\n    (form) => (form?.location || []).filter(f => !f.groupHeader));\n\nexport const selectIsInternal = createSelector(selectBookingType,\n    (type) => type?.value === internalBookingTypeOption.value);\n\nexport const selectFormFilters = createSelector(selectBookingFormsData,\n    (state) => state.activeFormFilters || []);\n\nconst selectRoomResultsFromState = createSelector(roomStateSelector,\n    loadRoomsForResults.selectors.model);\n\nconst selectRoomResultsFromState_map = createSelector(roomStateSelector,\n    loadRoomsForResultsMap.selectors.model);\n\nconst selectLaterThatDayResultsFromState = createSelector(roomStateSelector,\n    loadLaterThatDayResults.selectors.model);\nconst selectNextDayResultsFromState = createSelector(roomStateSelector,\n    loadNextDayResults.selectors.model);\nconst selectByIdResultsFromState = createSelector(roomStateSelector,\n    loadByIdResults.selectors.model);\nconst selectDiffSizeResultsFromState = createSelector(roomStateSelector,\n    loadDiffSizeResults.selectors.model);\n\nexport const selectHomepageBookingsResultsFromState = createSelector(bookingStateSelector,\n        loadHomepageBookingsResults.selectors.model);\nexport const selectUpcomingBookingsResultsFromState = createSelector(bookingStateSelector,\n    loadUpcomingBookingsResults.selectors.model);\nexport const selectPastBookingsResultsFromState = createSelector(bookingStateSelector,\n        loadPastBookingsResults.selectors.model);\nexport const selectCancelledBookingsResultsFromState = createSelector(bookingStateSelector,\n        loadCancelledBookingsResults.selectors.model);\nexport const selectBookingByIdResultsFromState = createSelector(bookingStateSelector,\n        loadBookingByIdResults.selectors.model);\n\n/**\n * Wraps {@link filterSpacesByAppliedFilters} with {@link LoadingModel} interop.\n * This will only filter data if there is data to filter, and returns a success {@link LoadingModel}.\n */\nconst filterSpacesByAppliedFiltersIfSuccess = (\n    results: LoadingModel<Space[]>,\n    formFilters: SelectOption<any>[],\n    activeForm: BookingFormData,\n    buildings: Building[] | undefined,\n    currentUser: User | undefined): LoadingModel<FilteredSpaces> => {\n    const data = results.optionalSuccess;\n\n    // don't filter model if no success found\n    return !activeForm ? results.mutate({\n        spaces: data, // the result here is a raw JSON Space, not the Space class\n        reason: SpaceFilterReason.None,\n        statusMap: {}\n    }) : results.mutate(\n        filterSpacesByAppliedFilters(formFilters, data, activeForm, buildings || activeForm.buildings, currentUser));\n};\n\nexport const selectFilteredResults = createSelector(selectRoomResultsFromState,\n    selectFormFilters,\n    selectActiveForm,\n    selectLoadBuildingsSuccess,\n    selectCurrentUser,\n    filterSpacesByAppliedFiltersIfSuccess);\n\nexport const selectMapFilteredResults = createSelector(selectRoomResultsFromState_map,\n    selectActiveForm,\n    selectLoadBuildingsSuccess,\n    selectCurrentUser,\n    (results, activeForm, buildings, currentUser) => filterSpacesByAppliedFiltersIfSuccess(results, [], activeForm, buildings, currentUser));\n\nexport const selectFilteredLaterDayResults = createSelector(selectLaterThatDayResultsFromState,\n    selectFormFilters,\n    selectActiveForm,\n    selectLoadBuildingsSuccess,\n    selectCurrentUser,\n    filterSpacesByAppliedFiltersIfSuccess);\n\nexport const selectFilteredNextDayResults = createSelector(selectNextDayResultsFromState,\n    selectFormFilters,\n    selectActiveForm,\n    selectLoadBuildingsSuccess,\n    selectCurrentUser,\n    filterSpacesByAppliedFiltersIfSuccess);\n\n\nexport const selectFilteredByIdResults = createSelector(selectByIdResultsFromState,\n    selectActiveForm,\n    selectLoadBuildingsSuccess,\n    selectCurrentUser,\n    (results, activeForm, buildings, currentUser) => filterSpacesByAppliedFiltersIfSuccess(results, [], activeForm, buildings, currentUser));\n\nexport const selectFilteredDiffSizeResults = createSelector(selectDiffSizeResultsFromState,\n    selectFormFilters,\n    selectActiveForm,\n    selectLoadBuildingsSuccess,\n    selectCurrentUser,\n    filterSpacesByAppliedFiltersIfSuccess);\n\n/**\n * Maps selected options by loaded buildings.\n */\nexport const selectSelectedBuildingOptions = createSelector(\n    selectBookingLocations,\n    selectLoadBuildingsSuccess,\n    (locations, buildings) => (locations\n        .map(l => buildings?.find(b => b.id === l.value))\n        .filter(f => !!f) as Building[])\n);\n\n","import { Building, BuildingCity } from '../organisation/building.class';\nimport { Booking } from '../bookings/booking.class';\nimport { BuildingLevel } from '../organisation/level.class';\nimport { Space } from '../spaces/space.class';\nimport { SpacesService } from '../spaces/spaces.service';\nimport {\n    timezoneDisplay,\n    timezoneNameToDate,\n    unique,\n    ImageDirective,\n} from '@mckinsey-converge/base';\nimport { SelectOption } from '../../../../ui/src/lib/options/select-option';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n/**\n * If more than 3 are selected, we truncate location display.\n */\nconst MAX_ABBREV_LOCATIONS = 3;\n\nexport const mapBuildingToSelectOption = (\n    city: string,\n    building: Building\n): SelectOption<any> => ({\n    display: `${building.name} ${timezoneDisplay(\n        timezoneNameToDate(building.timezone)\n    )}`,\n    dropdownOverride: `${building.code}-${building.name}, ${building.address}`,\n    value: building.id,\n    groupId: city,\n    groupChild: true,\n    shortDisplay: `${building.name} ${timezoneDisplay(\n        timezoneNameToDate(building.timezone)\n    )}`,\n    meta: { building, city },\n});\n\nexport const mapCityToAllSelectOption = (\n    city: BuildingCity\n): SelectOption<any> => ({\n    display: `${city.name} (All Offices) ${timezoneDisplay(\n        timezoneNameToDate(city.timezone)\n    )}`,\n    value: city.name,\n    groupHeader: true,\n    groupId: city.name,\n    shortDisplay: `${city.name} (All Offices) ${timezoneDisplay(\n        timezoneNameToDate(city.timezone)\n    )}`,\n    meta: { city },\n});\n\n/**\n * Flattens a map of {@link BuildingCity} to {@link Building} array into a list of {@link SelectOption}.\n * @param grouped The grouping\n */\nexport const flattenDisplayOffices = (\n    grouped: Map<BuildingCity, Building[]>\n) => {\n    const options: SelectOption<any>[] = [];\n    grouped.forEach((value, key) => {\n        options.push(mapCityToAllSelectOption(key));\n        value.forEach((b) =>\n            options.push(mapBuildingToSelectOption(key.name, b))\n        );\n    });\n    return options;\n};\n\n/**\n * This method will either add or remove a selected option from the selectedOptions list based on\n * these conditions:\n * 1. If the option EXISTS in the list AND is a groupHeader, de-select all of its children.\n * 2. If the option EXISTS in the list AND is a groupChild, remove it and its associated header from the list.\n * 3. If the option does NOT EXIST in the list AND is a groupHeader, select all other children.\n * 4. If the option does NOT EXIST in the list AND is a groupChild, add it to the list.\n *\n * Special note regarding item 4:\n * 4a. If that selection completes the children selection, select its associated header as well.\n */\nexport const toggleSelectedByGroup = (\n    options: SelectOption<any>[],\n    selectedOptions: SelectOption<any>[],\n    option: SelectOption<any>\n) => {\n    if (selectedOptions.find((s) => s.value === option.value)) {\n        return selectedOptions.filter((s) => {\n            let filter = s.value !== option.value;\n            // if group header, also remove any option that is the child of it.\n            if (option.groupHeader) {\n                filter =\n                    filter &&\n                    (!s.groupChild ||\n                        (s.groupChild && s.groupId !== option.groupId));\n            } else if (option.groupChild) {\n                // if child removing, remove the associated header.\n                filter =\n                    filter &&\n                    (!s.groupHeader ||\n                        (s.groupHeader && s.groupId !== option.groupId));\n            }\n            return filter;\n        });\n    }\n    // option does NOT EXIST\n    // if adding header, add the other children to the selected list, ensuring no dupes.\n    if (option.groupHeader) {\n        const toSelect = options.filter(\n            (v) =>\n                v.groupChild &&\n                v.groupId === option.value &&\n                !selectedOptions.find((selected) => selected.value === v.value)\n        );\n        return [...selectedOptions, option, ...toSelect];\n    }\n    // add group child, add the group header if all satisfied\n    const newGroup = [...selectedOptions, option];\n\n    // check if we have selected all children from options by filtering down by city and checking if\n    // they're in the selected options list.\n    const remainingChildrenInGroup = options.filter(\n        (o) =>\n            o.groupChild &&\n            o.groupId === option.groupId &&\n            !newGroup.find((ng) => ng.value === o.value)\n    );\n    // if we dont have remaining children, add the group\n    if (remainingChildrenInGroup.length === 0) {\n        return [\n            ...newGroup,\n            options.find((o) => o.groupHeader && o.groupId === option.groupId),\n        ];\n    }\n    return newGroup;\n};\n\n/**\n * If the list of locations are larger than {@link MAX_ABBREV_LOCATIONS}, then truncate\n * and display the remaining count.\n */\nexport const truncateLocationList = (\n    locations: readonly SelectOption<any>[]\n): string => {\n    // comma separate the locations\n    let truncatedLocations = [...locations];\n    const shouldTruncate = locations.length > MAX_ABBREV_LOCATIONS;\n    if (shouldTruncate) {\n        truncatedLocations = truncatedLocations.splice(0, MAX_ABBREV_LOCATIONS);\n    }\n    let display = truncatedLocations\n        .map((l) => l.shortDisplay || l.display)\n        .join(', ');\n    if (shouldTruncate) {\n        display += `...(${locations.length})`;\n    }\n    return display;\n};\n\nexport const mapBuildingLevelToOption = (\n    level?: BuildingLevel\n): SelectOption<any> =>\n    level\n        ? {\n              value: level.id,\n              display: level.name,\n          }\n        : undefined;\n\n/**\n * Returns all levels included with the building, deduped.\n * @param buildings\n */\nexport const flattenBuildingsWithLevels = (buildings: Building[]) => {\n    const flattenedLevels = unique(\n        buildings.reduce((next: BuildingLevel[], building: Building) => {\n            next.push(...building.levels);\n            return next;\n        }, []),\n        'id'\n    );\n    return {\n        flattenedLevels,\n        buildings,\n    };\n};\n\n/** Gets route to image placeholder if room image isn't found */\n\nexport const placeholderRoute = (num: number): string => {\n    let index: number;\n    if (num <= 3) {\n        index = num;\n    } else if (num % 3 === 0) {\n        index = 3;\n    } else {\n        index = 1;\n    }\n    return `assets/img/rooms/placeholder-${index}.png`;\n};\n\n/**\n * Method takes the rootFolderURL and fileSlug to create an array of three images\n * that should exist.  If a room image exists, it replaces the placehoder image.\n */\nexport const setupRoomImages = (\n    componentReference: ImageDirective,\n    image_positions: number[],\n    rootFolderURL: string,\n    fileSlug: string,\n    imagesLoaded: boolean = false\n): void => {\n    let foundImages: any[] = image_positions.map((i) =>\n        i ? { path: placeholderRoute(i) } : false\n    );\n    image_positions.forEach((n) => {\n        const desiredImageName = `${rootFolderURL}${fileSlug}-part-${n}.png`;\n        const desiredImage = location.pathname.includes('concierge') ?  `${location.origin}/staff/${desiredImageName}` : desiredImageName;\n        if (!imagesLoaded) {\n            const tester = new Image();\n            tester.onload = () => {\n                // Will never run on unit test\n                foundImages[n - 1] = { path: desiredImage };\n                componentReference.foundImages = [...foundImages.slice()];\n                componentReference?.loadImages && componentReference?.loadImages.next([...foundImages.slice()]);\n            };\n            tester.src = desiredImage;\n        }\n\n        // Force valid image output on unit test\n        if (imagesLoaded) {\n            foundImages[n - 1] = { path: desiredImage };\n            componentReference.foundImages = foundImages.slice();\n        }\n    });\n};\n\nexport const bookingStatusDetails = (booking: Booking) => {\n    const now = DateNow(new Date());\n    let image = '';\n    let text = '';\n    let title = '';\n\n    if (booking?.status) {\n        const status = now > booking.endDateTz ? 'expired' : booking.status;\n        switch (status) {\n            case 'unavailable':\n                image = 'assets/icon/booking_cancelled.svg';\n                title = 'Unavailable';\n                text = 'Unavailable';\n                break;\n            case 'declined':\n                image = 'assets/icon/booking_cancelled.svg';\n                title = 'Cancelled';\n                text = 'Cancelled';\n                break;\n            case 'cancelled':\n                image = 'assets/icon/booking_cancelled.svg';\n                title = 'Cancelled';\n                text = 'Cancelled';\n                break;\n            case 'expired':\n                image = 'assets/icon/booking_expired.svg';\n                title = 'Expired';\n                text = 'Expired';\n                break;\n            case 'tentative':\n                image = 'assets/icon/booking_pending.svg';\n                title = 'Requested';\n                text = 'Pending';\n                break;\n            case 'accepted':\n                image = 'assets/icon/booking_confirmed.svg';\n                title = 'Confirmed';\n                text = 'Confirmed';\n                break;\n            case 'approved':\n                image = 'assets/icon/booking_confirmed.svg';\n                title = 'Confirmed';\n                text = 'Confirmed';\n                break;\n            default:\n                // TODO\n                image = 'assets/icon/booking_expired.svg';\n                title = 'Expired';\n                text = 'Expired';\n                break;\n        }\n    }\n    return { text, title, image };\n};\n\nexport const roomHasCateringHours = (building: Building, space: Space) => {\n    let hasCatering = building\n        ? building.has_catering && building.catering_hours\n        : false;\n    // Room catering status as false overrides building status\n    if (space?.has_catering === false) {\n        hasCatering = false;\n    }\n    return hasCatering;\n};\n\nexport const cateringAllowed = (booking: Booking, building: Building) => {\n    const status = bookingStatusDetails(booking);\n    const disallowedStatus = ['declined', 'cancelled', 'expired'].includes(\n        status.text\n    );\n    const opens = building?.catering_hours?.start;\n    const closed = building?.catering_hours?.end;\n\n    if (disallowedStatus) {\n        return false;\n    }\n\n    if (typeof opens === 'undefined' || typeof closed === 'undefined') {\n        return false;\n    }\n\n    // Catering time could be a decimal so convert to a date\n    const openMinutes = opens * 60;\n    const closeMinutes = closed * 60;\n\n    const startOfDay = booking.startDateTz.startOfValue('day');\n    const cateringOpenTime = startOfDay.addValue({ minutes: openMinutes });\n    const cateringCloseTime = startOfDay.addValue({ minutes: closeMinutes });\n\n    if (\n        cateringOpenTime.ms <= booking.startDateTz.ms ||\n        cateringCloseTime.ms > booking.startDateTz.ms\n    ) {\n        // Booking ends before catering opens\n        if (booking.endDateTz.ms <= cateringOpenTime.ms) {\n            return false;\n        }\n        // Booking starts after catering closes\n        if (booking.startDateTz.ms > cateringCloseTime.ms) {\n            return false;\n        }\n\n        // Start time is OK\n        if (booking.startDateTz.ms > DateNow(new Date()).ms) {\n            // Due to COVID, no orders are available once a meeting begins.\n            return true;\n        }\n    }\n\n    return false;\n};\n\nexport const checkCollisions = (\n    service: SpacesService,\n    booking: Booking\n): Promise<boolean> => {\n    return new Promise((resolve, reject) => {\n\n        let availabilityParams: {\n            room_ids: string;\n            dateTz: DateTZ;\n            duration: number;\n            setup: number;\n            breakdown: number;\n            hide_bookings: boolean;\n            [key: string]: any;\n        } = {\n            room_ids: booking.space.id,\n            dateTz: booking.startDateTz,\n            duration: booking.duration,\n            setup: booking.setup[booking.space.email],\n            breakdown: booking.breakdown[booking.space.email],\n            hide_bookings: false,\n        };\n\n        if (booking.recurrence_type === \"master\" || booking.recurrence_type === null) {\n            availabilityParams = {\n                ...availabilityParams,\n                ignore: booking?.icaluid,\n                recurrence_count: booking?.recurrence_count,\n                recurrence_period: booking?.recurrence_period,\n                recurrence_endTz: booking?.recurrence_endTz,\n                recurrence_interval: booking?.recurrence_interval,\n                recurrence_starts: booking?.recurrence_starts,\n                is_recurrent: booking?.is_recurrent,\n                recurrence_days: booking?.recurrence_days\n            } as typeof availabilityParams;\n        }\n\n        service\n            .available(\n                availabilityParams,\n                null,\n                false\n            )\n            .then(\n                (list) => {\n                    const space = list.length ? list[0] : null;\n                    if (space) {\n                        if (!space.bookable) return reject('Has conflict');\n                        const setup = booking?.setup[space?.email] || 0;\n                        const breakdown = booking?.breakdown[space?.email] || 0;\n                        const start_time = booking?.startDateTz.seconds - setup;\n                        const end_time = booking.endDateTz.seconds + breakdown;\n\n                        const bookings = space.settings.bookings;\n                        // console.log('Bookings:', bookings);\n                        // Compare the existing bookings to see if any truely conflict.\n                        if (bookings.length) {\n                            const has_conflict = bookings.find(bkn => {\n                                const b_setup = bkn.setup[space.email] || 0;\n                                const b_breakdown = bkn.setup[space.email] || 0;\n                                const start = (bkn.start_epoch || bkn.start) - b_setup;\n                                const end = (bkn.end_epoch || bkn.end) + b_breakdown;\n                                return (\n                                    (end_time > start && end_time <= end) || // Booking ends during the meeting\n                                    (start_time >= start && start_time < end) || // Booking starts during a meeting\n                                    (start_time <= start && end_time >= end) // Booking overlaps entire meeting\n                                ) && bkn.id !== booking.id \n                                && ( (booking.recurrence_type === \"master\" || booking.recurrence_type === null) \n                                        ?\n                                        bkn.recurrence_master_id !== booking.id\n                                        :\n                                        false\n                                    )\n\n\n\n                            });\n                            // Conflicts found, reject\n                            if (has_conflict) return reject('has booking conflict');\n                        }\n                        return resolve(space.bookable);\n                    }\n                    reject('space not found');\n                },\n                () => reject('available error')\n            );\n    });\n};\n\nexport const getStatusErrorMessage = (status?: number) => {\n    let msg = '';\n    switch (status) {\n\t\t\tcase 400:\n\t\t\t\tmsg = 'Apologies, the booking cannot be finalized because the current time has exceeded the scheduled start time for this booking. Please try again.';\n\t\t\t\tbreak;\n\t\t\tcase 403:\n\t\t\t\tmsg = 'Your do not have permission to update this booking.';\n\t\t\t\tbreak;\n\t\t\tcase 409:\n\t\t\t\tmsg = 'Sorry, your booking time conflicts with another booking.';\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tmsg = 'Your booking failed to update, please try again';\n    }\n    return msg;\n};\n","export * from './room-results/room-results.viewmodel'\nexport * from './booking-filter.utils'\nexport * from './booking.form.actions'\nexport * from './booking.form.data'\nexport * from './booking.form.spec-helpers'\nexport * from './booking.form.types'\nexport * from './booking.selectors'\nexport * from './booking.utils'","import { Space } from '../../spaces/space.class';\nimport { BuildingLevel } from '../../organisation/level.class';\nimport { Building } from '../../organisation/building.class';\n\nexport class RoomResultsViewModel {\n\n    public levelDisplay: string;\n    public title: string;\n    public office: string;\n    public capacity: string;\n\n    constructor(public space: Space,\n                public level?: BuildingLevel,\n                public building?: Building) {\n\n        this.levelDisplay = `Level ${this.space?.level?.short_name}`;\n        this.title = this.space.local_name;\n        this.office = this.building ? `(${this.building?.code}) ${this.building?.name}` : '';\n        this.capacity = `Capacity: ${this.space.capacity} people`;\n    }\n}\n\n/**\n * For each result from results, we find its level and building from the lists.\n */\nexport const mapResultsToViewModels = (results: Space[],\n                                       flattenedLevels: BuildingLevel[],\n                                       buildings: Building[]): RoomResultsViewModel[] =>\n    results.map((r: Space) => {\n        const level = flattenedLevels.find(l => r.zones.includes(l.id));\n        const building = buildings.find(b => r.zones.includes(b.id));\n        return new RoomResultsViewModel(\n            r,\n            level,\n            building\n        );\n    });\n","import { Injectable, NgZone } from '@angular/core';\nimport { BehaviorSubject, combineLatest, of, Observable } from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    filter,\n    first,\n    map,\n    shareReplay,\n    switchMap,\n} from 'rxjs/operators';\nimport { BaseClass } from '@mckinsey-converge/base';\nimport { replaceBookings, timePeriodsIntersect } from './booking.utilities';\nimport { SpacesService } from '../spaces/spaces.service';\nimport { Booking } from '../bookings/booking.class';\nimport { Space } from '../spaces/space.class';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { OrganisationService } from '../organisation/organisation.service';\n\nexport type BookingType =\n    | 'internal'\n    | 'client'\n    | 'external'\n    | 'setup'\n    | 'training'\n    | 'interview'\n    | 'declined';\n\nexport interface BookingFilters {\n    /** List of zone ids to get bookings for */\n    zone_ids?: string[];\n    space_emails?: string[];\n    hide_type?: BookingType[];\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class BookingStateService extends BaseClass {\n    /** List of bookings */\n    private _poll = new BehaviorSubject<boolean>(false);\n    /** List of bookings */\n    private _long_poll = new BehaviorSubject<'month' | ''>('');\n    private _long_poll_week = new BehaviorSubject<'week' | ''>('');\n    /** List of bookings */\n    private _bookings = new BehaviorSubject<Booking[]>([]);\n    /** List of meeting count per date */\n    public _noOfMeetings = new BehaviorSubject<{}>({});\n    /** Filter details for bookings */\n    private _filters = new BehaviorSubject<BookingFilters>({});\n    /** Currently active date */\n    private _dateTz = new BehaviorSubject<DateTZ>(DateNow(new Date()));\n    /** Currently displayed zone */\n    private _zone = new BehaviorSubject<string>(' ');\n    /** Whether booking data is being loaded */\n    private _loading = new BehaviorSubject<boolean>(false);\n    /** Observable for filter and booking list changes */\n    private _state = combineLatest(\n        this._bookings,\n        this._filters,\n        this._dateTz,\n        this._zone\n    );\n\n    /** Observable for list of bookings */\n    public readonly bookings = this._bookings.asObservable();\n    /** Observable for active date */\n    public readonly dateTz = this._dateTz.asObservable();\n    /** Observable for active zone */ // R-- zone was this._date.asObservable(); this looks like a mistake but it exists from the beginning of time\n    public readonly zone = this._dateTz.asObservable();\n    /** Observable for loading state of bookings */\n    public readonly loading = this._loading.asObservable();\n\n    public get booking_date() {\n        // When this class is initialized this._dateTz is local timezone\n        return this._dateTz.value;\n    }\n\n    public get timezone() {\n        return localStorage.getItem('CONCIERGE.timezone');\n    }\n\n    /** Obsevable for filtered list of bookings */\n    public readonly filtered = this._state.pipe(\n        map((state) => {\n            const bdTz = this.timezone\n                ? new DateTZ({\n                      date: this.booking_date.ms,\n                      is_local_tz: false,\n                      building_tz: this.timezone,\n                  })\n                : this.booking_date;\n            const startTz = bdTz.startOfValue('day');\n            const endTz = startTz.addValue({}).endOfValue('day');\n            return this.filterBookings(startTz, endTz);\n        }),\n        shareReplay(1)\n    );\n\n    /** Obsevable for filtered list of bookings of the active week */\n    public readonly filtered_week = this._state.pipe(\n        map(() => {\n            // Tested to be valid in building time now.\n            const bd = this.timezone\n            ? new DateTZ({\n                  date: this.booking_date.ms,\n                  is_local_tz: false,\n                  building_tz: this.timezone,\n              })\n            : this.booking_date;\n            const start = bd.startOfValue('week').startOfValue('day');\n            const end = this.getEndOfWeek(bd);\n            return this.filterBookings(start, end);\n        })\n    );\n\n    /** Obsevable for filtered list of bookings for active month */\n    public readonly filtered_month = this._state.pipe(\n        map(() => {\n            const start = this.booking_date.startOfValue('month');\n            const end = this.booking_date.endOfValue('month');\n            return this.filterBookings(start, end);\n        })\n    );\n\n    /** Active filters */\n    public get filters() {\n        return this._filters.getValue();\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _spaces: SpacesService,\n        private ngZone: NgZone,\n    ) {\n        super();\n\n        this._org.initialised.pipe(first((_) => _)).subscribe(() => {\n            // Just to get the timezone correct\n            this._dateTz.next(\n                new DateTZ({\n                    date: this._dateTz.value.ms,\n                    is_local_tz: false,\n                    building_tz: this._org.building?.timezone,\n                })\n            );\n        });\n\n        /** Generate observable for updating bookings */\n        const search = combineLatest(this._poll, this._zone, this._dateTz).pipe(\n            filter((i) => !!i[0]),\n            debounceTime(500),\n            switchMap(() => {\n                const fzone = this._zone.getValue();\n                if (!fzone) {\n                    return of([]);\n                }\n                this._loading.next(true);\n                const start = this.booking_date.startOfValue('day');\n                const end = start.endOfValue('day');\n                return this._spaces.queryBooking({\n                    zone_ids: fzone,\n                    available_from: start.seconds,\n                    available_to: end.seconds,\n                });\n            }),\n            catchError(() => of([]))\n        );\n\n        const search_long_week = combineLatest(\n            this._long_poll_week,\n            this._zone,\n            this._dateTz\n        ).pipe(\n            filter((i) => !!i[0]),\n            debounceTime(500),\n            switchMap((props) => {\n                const type = props[0];\n                const fzone = props[1];\n                const dateTz = props[2];\n                if (!fzone) {\n                    return of([]);\n                }\n                this._loading.next(true);\n                return this.querySpace(type, fzone, dateTz, false);\n            }),\n            catchError((e) => { \n                return of([]);\n             })\n        );\n\n        /** Subscribe to update observable */\n        search.subscribe((space_list) => {\n            this.processBookings(space_list);\n            this._loading.next(false);\n        });\n        search_long_week.subscribe((space_list) => {\n            this.processBookings(space_list, this._long_poll_week.getValue() as any);\n            this._loading.next(false);\n        });\n    }\n\n    /**\n     * Function to build\n     */\n    private buildSpaceLongQuery(dailyCount: boolean = false): Observable<any> {\n        return combineLatest(\n            this._long_poll,\n            this._zone,\n            this._dateTz\n        ).pipe(\n            filter((i) => !!i[0]),\n            debounceTime(500),\n            switchMap((props) => {\n                const type = props[0];\n                const fzone = dailyCount ? this._org.building.id : props[1];\n                const dateTz = props[2];\n                if (!fzone) {\n                    return of([]);\n                }\n                this._loading.next(true);\n                return this.querySpace(type, fzone, dateTz, dailyCount);\n            }),\n            catchError((e) => { \n                return of([]);\n             })\n        );\n    }\n\n    private querySpace(type: string, fzone: string, dateTz: DateTZ, dailyCount: boolean = false) : Observable<Space[]> | Observable<any>{\n        const start = () => {\n            const s = dateTz;\n            if (type === 'week') {\n                return s.startOfValue('week');\n            } else {\n                return s.startOfValue('month');\n            }\n        };\n\n        const end = () => {\n            const e = start();\n            if (type === 'week') {\n                /**\n                 *  To Do: date-tz.class.ts endOfValue subtracts 1 day from end of week for 7 days a week type which returns Friday instead of Saturday\n                 *  below is the adjustment -\n                 */\n                return e.addValue({ days: 1 }).endOfValue('week');\n            } else {\n                return e.endOfValue('month');\n            }\n            /**\n             * R--- when testing March 2022 London offices, the month is an hour short.\n             * Is this a Luxon bug or London DST?\n             */\n        };\n\n        // dates here are ok\n        return this._spaces.queryBooking({\n            zone_ids: fzone,\n            available_from: start().seconds,\n            available_to: end().seconds,\n            ...(dailyCount) ? { daily_count: true } : ''\n        });\n    }\n\n\n    public getDailyMeetingCount() : void {\n        this._long_poll.next('month');\n        this.buildSpaceLongQuery(true).subscribe((counts) => {\n            this._noOfMeetings.next(counts);\n            this._loading.next(false);\n        });\n    }\n\n    /**\n     * Update the booking filters\n     * @param details\n     */\n    public setFilters(details: BookingFilters) {\n        this._filters.next(details);\n    }\n\n    /**\n     * Update the booking date\n     * @param details\n     */\n    public setDate(dateTz: DateTZ) {\n        this._dateTz.next(dateTz);\n    }\n\n    /**\n     * Update the booking's zone\n     * @param details\n     */\n    public setZone(zone: string) {\n        this._zone.next(zone);\n    }\n\n    /**\n     * update day view once\n     */\n    public pollOnce(){\n        this._poll.next(true);\n    }\n    \n    /**\n     * Start polling to update bookings\n     * @param delay Duration between polling events in milliseconds\n     */\n    public startPolling(delay: number = 30 * 1000) {\n        this._poll.next(true);\n        this.ngZone.runOutsideAngular(() => {\n            this.interval('polling', () => this._poll.next(true), delay);\n        });\n    }\n\n    /**\n     * Start polling to update bookings\n     * @param delay Duration between polling events in milliseconds\n     */\n    public startPollingWeek(delay: number = 4 * 30 * 1000 ) {\n        this._long_poll_week.next('week');\n        this.ngZone.runOutsideAngular(() => {\n            this.interval(\n                'polling_long',\n                () => this._long_poll_week.next('week'),\n                delay\n            );\n        });\n    }\n    /**\n     * Start polling to update bookings\n     * @param delay Duration between polling events in milliseconds\n     */\n    public startPollingEveryFiveMin(delay: number =  60 * 1000) {\n        this._poll.next(true);\n        this.ngZone.runOutsideAngular(() => {\n            this.interval('polling', () => this._poll.next(true), delay);\n        });\n    }\n    \n    /**\n     * Start polling to update bookings\n     * @param delay Duration between polling events in milliseconds\n     */\n    public startPollingMonth(delay: number = 5 * 60 * 1000) {\n        this._long_poll.next('month');\n        this.ngZone.runOutsideAngular(() => {\n            this.interval(\n                'polling_long',\n                () => this._long_poll.next('month'),\n                delay\n            );\n        });\n    }\n\n\n    /**\n     * Stop polling to update bookings;\n     */\n    public stopPolling() {\n        this._poll.next(false);\n        this.clearInterval('polling');\n        this._long_poll.next('');\n        this.clearInterval('polling_long');\n    }\n\n    public updateRoomList() {\n        this._spaces.updateRoomList();\n    }\n\n    /**\n     * Add booking to bookings listing\n     * @param booking\n     */\n    public add(booking: Booking) {\n        const bookings = this._bookings.getValue();\n        const new_bookings = bookings.concat([booking]);\n        this._bookings.next(new_bookings);\n    }\n\n    /**\n     * Update booking in the bookings list\n     * @param booking\n     */\n    public replace(booking: Booking) {\n        const bookings = this._bookings.getValue();\n        const new_bookings = bookings\n            .filter(\n                (bkn) =>\n                    bkn.icaluid !== booking.icaluid && bkn.id !== booking.id\n            )\n            .concat([booking]);\n        this._bookings.next(new_bookings);\n    }\n\n    /**\n     * Remove booking in the bookings list\n     * @param booking\n     */\n    public remove(booking: Booking) {\n        const bookings = this._bookings.getValue();\n        const new_bookings = bookings.filter(\n            (bkn) => bkn.icaluid !== booking.icaluid\n        );\n        this._bookings.next(new_bookings);\n    }\n\n    public attentToDelete(\n        booking: Booking,\n        action: 'series' | 'booking' = 'booking',\n        undo: boolean = false\n    ) {\n        const bookings = this._bookings.getValue();\n        const attempted_to_delete = ((action) => {\n            return (bkg: Booking) => {\n                switch (action) {\n                    case 'booking': {\n                        const booking_master = bookings.find(\n                            (bkn) => bkn.icaluid === booking.icaluid\n                        );\n                        if (!booking_master) return false;\n                        return bkg.id === booking.id;\n                    }\n                    case 'series': {\n                        const booking_master = bookings.find(\n                            (bkg) =>\n                                bkg.id ===\n                                (booking.recurrence_type === 'occurrence'\n                                    ? booking.recurrence_master_id\n                                    : booking.id)\n                        );\n                        if (!booking_master) return false;\n                        return (\n                            booking_master.id === bkg.id ||\n                            bkg.recurrence_master_id === booking_master.id\n                        );\n                    }\n                    default:\n                        false;\n                }\n            };\n        })(action);\n\n        const new_bookings = [...bookings].map((bkg) => {\n            if (!undo && attempted_to_delete(bkg)) {\n                bkg.attempted_to_delete = action;\n            }\n\n            if (undo && attempted_to_delete(bkg)) {\n                bkg.attempted_to_delete = null;\n            }\n\n            return bkg;\n        });\n\n        this._bookings.next(new_bookings);\n    }\n\n    private processBookings(\n        space_list: Space[],\n        period: 'day' | 'week' | 'month' = 'day'\n    ) {\n        const start = () => {\n            switch (period) {\n                case 'month':\n                    return this.booking_date.startOfValue('month');\n                case 'week':\n                    return this.booking_date.startOfValue('week');\n                default:\n                    return this.booking_date.startOfValue('day');\n            }\n        };\n        const end = () => {\n            const s = start();\n            switch (period) {\n                case 'month':\n                    return s.endOfValue('month');\n                case 'week':\n                    return s.endOfValue('week');\n                default:\n                    return s.endOfValue('day');\n            }\n        };\n\n        let bookings = this._bookings.getValue();\n        space_list.forEach((space) => {\n            return (bookings = replaceBookings(\n                bookings,\n                space.bookings.map((bkn) => new Booking(bkn)),\n                {\n                    room_email: space.email,\n                    fromTz: start(),\n                    toTz: end(),\n                }\n            ));\n        });\n        this._bookings.next(bookings);\n    }\n\n    private filterBookings(startTz: DateTZ, endTz: DateTZ) {\n        const filters = this._filters.getValue();\n        const bookings = this._bookings.getValue();\n        const fzone = this._zone.getValue();\n        return bookings.filter((bkn) => {\n            const intersects = timePeriodsIntersect(\n                startTz.ms,\n                endTz.ms,\n                bkn.startDateTz.ms,\n                bkn.endDateTz.ms\n            );\n            const in_zone = bkn.room.zones.includes(fzone);\n            const has_space =\n                !filters.space_emails?.length ||\n                filters.space_emails.includes(bkn.room.email);\n            const in_zones =\n                !filters.zone_ids?.length ||\n                !!bkn.room.zones.find((zone) =>\n                    filters.zone_ids.includes(zone)\n                );\n            const type = bkn.declined ? 'declined' : bkn.getType();\n\n            const show =\n                !filters.hide_type?.length ||\n                !filters.hide_type.includes(type as any);\n            return intersects && has_space && in_zone && in_zones && show;\n        });\n    }\n\n    /**If Sunday add one day to get Saturday as end of week */\n    private getEndOfWeek(date: DateTZ): DateTZ {\n        return date.dateWeekday === 7\n            ? date.addValue({ days: 1 }).endOfValue('week').endOfValue('day')\n            : date.endOfValue('week').endOfValue('day');\n    }\n}\n","import { BaseDataClass } from '../base-api.class';\nimport { CateringOrder } from '../catering';\nimport { User } from '../users';\nimport {\n    flatten,\n    HashMap,\n    humaniseDuration,\n    shorterBuildingDateFormatString,\n    shorterLocalDateFormatString,\n    toTitleCase,\n    unique\n} from '@mckinsey-converge/base';\nimport { Space } from '../spaces/space.class';\nimport { ServiceManager } from '../service-manager.class';\nimport { SettingsService } from '../settings.service';\nimport {\n    BookingNote,\n} from './booking.types';\nimport { convertLocalTimestampToTimezonedDateTz, DateNow, DateTZ, getTimezoneOffsetString } from '@mckinsey-converge/date-tz';\nimport { DaysOfWeek, getLastDateFromList, handleRecurrenceFields, RecurrencePeriod } from '../recurrence/recurrence.utils';\nimport { findSpace } from '../spaces';\nimport { DateTime } from 'luxon';\n\n\nexport interface IBookingQueryOptions {\n    /** booking ID */\n    id?: string;\n    email?: string;\n    target?: string;\n    from?: number; // R--- depreciate\n    until?: number; // R--- depreciate\n    fromTz?: DateTZ;\n    untilTz?: DateTZ;\n    show_cancelled?: boolean;\n    pagination?: boolean;\n    limit?: number;\n    offset?: number;\n    sort?: string,\n    filters?: any;\n    include_rooms?: boolean;\n    building_zone?: string;\n}\n\nexport class Booking extends BaseDataClass {\n    /** Unique calendar event ID */\n    // public readonly icaluid: string;\n    /** Subject or title of the booking */\n    public title: string;\n    /** Luxon based date class of the booking start time */\n    public startDateTz: DateTZ;\n    /** Luxon based date class of the booking start time */\n    public endDateTz: DateTZ;\n    /** Description or details of the booking */\n    public readonly body: string;\n    /** Type of booking */\n    public readonly booking_type: string;\n    /** List of catering orders for the booking */\n    public catering: readonly CateringOrder[];\n    /** Whether booking's duration covers all day */\n    public readonly all_day: boolean;\n    /** Mapping of emails to approval statuses */\n    public approval_status: HashMap<string>;\n    /**\n     * New booking approval status set in constructor\n     *\n     * timeBasedStatusLabel is a getter calculated via current time, some parts of the application\n     * may use status when it should use timeBasedStatusLabel\n     */\n    public status: 'tentative' | 'accepted' | 'approved' | 'declined' | 'cancelled' | 'expired' | 'unavailable';\n    /** Host/Organiser of the booking */\n    public organiser: User;\n    /** List of people invited to attend the booking */\n    public attendees: User[];\n    /** Author of the booking */\n    public readonly creator: User;\n\n    /** List of notes associated with the booking */\n    public notes: readonly BookingNote[];\n    /** Mapping of spaces to equipment charge codes */\n    public equipment_codes: HashMap<string>;\n    /** Mapping of spaces to expected number of attendees */\n    public expected_attendees: HashMap<number>;\n    /** Map of space emails to the setup time before the meeting in minutes */\n    public setup: HashMap<number>;\n    /** List of checked in attendees */\n    public check_ins: object;\n    /** Map of space emails to the breakdown time before the meeting in minutes */\n    public breakdown: HashMap<number>;\n    /** List of fields edited since creation */\n    public readonly edits: string[];\n    /** List of users to be notified on visitor arrivals */\n    public readonly notify_users: readonly string[];\n    /** Whether the time or duration has changed */\n    public time_changed = false;\n    /**\n     * Booking Space\n     * Bookings only have one room on MCK\n     */\n    public room: Space;\n    /** building_zone */\n    public building_zone: string;\n    /** Initialized Timezone */\n    public timezone: string;\n    /** Array of company names */\n    public company?: string[];\n    /** Type of recurrence,  Shows whether this is a master or an occurence in the series. */\n    public readonly recurrence_type: string;\n    /** The frequency of the recurring booking. */\n    public readonly recurrence_period: RecurrencePeriod;\n    /** The interval time between each period. Defaults to 1. For example, with a period of \"weekly\" and an interval of 2, the recurrencd happen every 2 weeks. */\n    public readonly recurrence_interval: number;\n    /** Unix epoch in seconds of the recurrence end date */\n    private _recurrence_endTz: DateTZ;\n    /** The number of times to repeat the recurring booking. */\n    public readonly recurrence_count: number;\n    /** ID of the booking considered the master */\n    public readonly recurrence_master_id: string;\n    /** An array of booking IDs which belong to this recurring series. This INCLUDES the master booking ID. */\n    public readonly occurrence_ids: string[];\n    /** A list of INDIVIDUAL edits to any of the bookings in the series. This is so we can prompt the user if they are going to override previously updated bookings with a whole-series update. */\n    public readonly occurrence_edits: string[];\n    /** A list of Ocurrences */\n    public readonly occurrence_details: { id: string, start_epoch: number }[];\n    /** When the booking was created */\n    public created_epoch: number;\n    /** Is the Application concierge */\n    public is_concierge: boolean;\n    /**helper to know if recurring toggle is on */\n    public is_recurrent: boolean;\n    /**array of start dates of each ocurrence in the series */\n    public recurrence_starts: Array<DateTZ>\n    /**array of conflicting dates not to be included in the recurrence series */\n    public recurrence_exceptions: Array<number>\n\n    public recurrence_days?: Array<DaysOfWeek>\n\n    /** Master recurrence start */\n    public recurrence_start: number;\n\n    /** Start Epoch */\n    public start_epoch: number;\n    public end_epoch: number;\n    level_zone: string;\n    opt_out: boolean;\n\n    /** Currently back-end is not properly setting the recurrence_end property, this is a workaround */\n    public get recurrence_endTz(): DateTZ {\n        return this._recurrence_endTz;\n    }\n\n    public set recurrence_endTz(date: DateTZ) {\n        this._recurrence_endTz = date;\n    }\n\n    /** Mark a booking for deleting */\n    public attempted_to_delete?: 'series' | 'booking' | null;\n\n    // No specific reason to set readonly but canm be change if needed to update in future\n    public readonly booked_by : string | { name: string };\n    public readonly booker: Object;\n    public readonly booker_concierge: Object\n\n    constructor(raw_data: HashMap = {}) {\n        super(raw_data);\n        // Needed to check if the current app is Concierge or Staff\n        const settingsService = ServiceManager.serviceFor(SettingsService) as unknown as SettingsService;\n        this.is_concierge = settingsService.concierge;\n\n        /**\n         * Setup Defaults when raw_data values are not provided\n         */\n        const nowTz = new DateTZ();\n\n        const defaultTitle = ''; // Blank since the create booking form will init with test values.\n        const defaultLocalTimezone = Intl?.DateTimeFormat()?.resolvedOptions()?.timeZone;\n        const defaultBuildingZone = null // R --- no idea, should be a building.id but which and how\n        const defaultOrgainiser = User.active_user || new User(); // meh, non American use.\n        const defaultBookingType = 'internal';\n\n        /**\n        * Process the simple raw_data with defaults mixed in\n        */\n        this.title = raw_data.title || defaultTitle;\n        this.timezone = raw_data.timezone || defaultLocalTimezone;\n        // Used by components to get the building details\n        this.building_zone = raw_data.building_zone || defaultBuildingZone;\n        this.body = raw_data.body || '';\n        // Provided booking type\n        this.booking_type = raw_data.booking_type || defaultBookingType;\n        // Attendees provided in API booking data\n        this.attendees = (raw_data.attendees || []).map((i) => new User(i));\n        // Provided organiser, active user, or empty user?\n        this.organiser = raw_data.organiser ? new User(raw_data.organiser) : defaultOrgainiser;\n        // Creator is provided or defaults to the organizer\n        this.creator = (raw_data.booked_by ? new User(raw_data.booked_by) : defaultOrgainiser) || this.organiser;\n        // Setup and breakdown times can conflict but not the true event start and end times\n        this.setup = raw_data.setup || {};\n        this.breakdown = raw_data.breakdown || {};\n        // Notes are assigned by room but we only support a single room\n        this.notes = raw_data.notes || [];\n        this.equipment_codes = raw_data.equipment_codes || {};\n        this.expected_attendees = raw_data.expected_attendees || {};\n        this.check_ins = raw_data.check_ins || {};\n        this.notify_users = raw_data.notify_users?.length ? raw_data.notify_users : [this.organiser?.name];\n        this.company = raw_data.company || [];\n        // retain booked by if there : helps to get correct creator above\n        this.booked_by = raw_data.booked_by;\n        this.booker = raw_data.booker;\n        this.booker_concierge = raw_data.booker_concierge;\n        this.level_zone = raw_data.level_zone;\n        this.opt_out = raw_data.opt_out;\n\n        /**\n         * Setup Defaults when raw_data values are not provided\n         *\n         * all room_ids and space_list inputs can be refactored into just room like an API booking\n         *\n         * raw_data.room can be provides as the Space class or JSON object\n         */\n        this.room = raw_data.room ? new Space(raw_data.room) : new Space();\n\n        const room_id = raw_data.room_id || raw_data.room_ids // Not sure why we have room_id and room_ids\n        if (!this.room.id && room_id?.length) {\n            this.room = findSpace(room_id[0]) || this.room;\n        }\n        /**\n         * Setup the booking start and end time\n         *\n         *\n         * Booking defaults to now if start is not defined.\n         * Booking durration is now a getter\n         */\n        // now rounded to the next 5 minute increment\n        const defaultStartTz = new DateTZ({ date: nowTz.ms, is_local_tz: false, building_tz: this.timezone }).setValue({ minute: Math.ceil(nowTz.minutes / 5) * 5 });\n\n        /**\n         * When saving a booking the BaseDataClass doens't know to use the toAPIJson\n         * so startDateTz isn't being convert to the epoch timestamp\n         *\n         * I'm not testing for the end time values because we can assume those follow the same pattern.\n         */\n        const startEpochProvided = !!(raw_data.start_epoch || raw_data.start);\n        const startDateTzProvided = !!raw_data.startDateTz;\n\n        /**\n         * Not trying to be fancy here, just clear.\n         */\n        if (!startEpochProvided && startDateTzProvided) {\n            /**\n             * Once a booking is saved the BaseDataClass recreates the Booking\n             * but doesn't use the toApiJSON method adapt the class input, mainly the\n             * startDateTz isn't converted to the start_epoch timestamp.\n             */\n            this.startDateTz = raw_data.startDateTz;\n            this.endDateTz = raw_data.endDateTz;\n        } else if (startEpochProvided) {\n            /**\n             * A Booking created from the API responses arrives with the booking\n             * start_epoch and end_epoch timestamps.\n             */\n            this.startDateTz = new DateTZ({\n                date: ((raw_data.start_epoch || raw_data.start) * 1000),\n                is_local_tz: false,\n                building_tz: this.timezone\n            });\n            this.endDateTz = new DateTZ({\n                date: ((raw_data.end_epoch || raw_data.end)* 1000),\n                is_local_tz: false,\n                building_tz: this.timezone\n            });\n        } else {\n            /**\n             * And there are uses of new Booking where there are no inputs\n             * and defaults are necessary.\n             */\n            this.startDateTz = defaultStartTz;\n            this.endDateTz = defaultStartTz.addValue({ minutes: 60 });;\n        }\n\n        /**\n         * End time was by design ending at one minute before, IE 4:00PM is 3:59PM,\n         * because of calendar and conflcit checking\n         *\n         * Check and finesse it.\n         * Not sure why but some booking endtime added extra seconds\n         */\n        if ((this.endDateTz.minutes % 5) !== 0 || this.endDateTz.second > 0) {\n            // Not sure of the source but some bookings do not conform.\n            this.endDateTz = this.endDateTz.setValue({ second: 0, minute: Math.round(this.endDateTz.minutes / 5) * 5 });\n        }\n\n\n\n        /**\n         * Setup the booking created_date\n         *\n         * if it exists as a key, use the value directly.\n         * if we initialize without a value, switch to checking duration.\n         * Ref: MCK-826\n         */\n        this.created_epoch = raw_data.created_epoch || nowTz.seconds;\n\n\n        /**\n         * Setup the booking all_day boolean\n         *\n         * if it exists as a key, use the value directly.\n         * if we initialize without a value, switch to checking duration.\n         * Ref: MCK-826\n         */\n        if ('all_day' in raw_data) {\n            this.all_day = raw_data.all_day;\n        } else {\n            this.all_day = !!raw_data.all_day || this.duration > 23 * 60;\n        }\n\n\n        // R--- TODO Concierge will use startDateTz so i'm not sure if this is needed.\n        if (!this.is_concierge && this.all_day && this.timezone) {\n            /**\n             * Concierge has a all_day form field, I can see it may need this for that, does it really?\n             */\n            this.startDateTz = this.startDateTz.startOfValue('day')\n        }\n\n        /**\n         * Setup the booking approval status\n         */\n         let status = raw_data.status;\n         // If not provided default to approved.\n         if (!raw_data.status) {\n            status = 'accepted';\n         }\n         // \"show_as\" is a special rule to override how the applications display the status\n         if (raw_data.show_as && raw_data.show_as === 'cancelled') {\n            status = 'declined';\n         }\n         const approvalStatus = {};\n         approvalStatus[this.room.email] = status;\n         // Tracking new \"status\" and legacy \"approval_status\" from raw_data.status.\n         this.status = status;\n         this.approval_status = raw_data.approval_status || {};\n\n        /**\n         * Catering setup\n         *\n         * Bring in and sort the catering order by delivery time\n         */\n\n        this.catering = (raw_data.catering instanceof Array ? raw_data.catering : []).map(\n            (i) => new CateringOrder(i)\n        );\n\n\n\n        /**\n         * Edited fields setup\n         *\n         * Bring in and sort the catering order by delivery time\n         *\n         * cateringOrders can return the order sorted\n         */\n        const edited_fields = Array.isArray(raw_data.edits)\n            ? raw_data.edits\n            : unique(\n                flatten(\n                    Object.keys(raw_data.edits || {}).map((room) => {\n                        return flatten(Object.values(raw_data.edits[room]));\n                    })\n                )\n            );\n        this.edits = edited_fields;\n\n        /**\n         * New Recurring booking feilds\n         *\n         * New fields do not match the BookingRecurrenceDetails type\n         * and are simpler to manage this way\n         */\n        this.recurrence_count = raw_data.recurrence_count || null;\n        this.recurrence_days = raw_data.recurrence_days || null;\n        this.occurrence_edits = raw_data.occurrence_edits || null;\n        this.recurrence_endTz = raw_data.recurrence_end ? new DateTZ({date: raw_data.recurrence_end * 1000, is_local_tz: false, building_tz: this.timezone}) : null;\n        this.recurrence_exceptions = raw_data.recurrence_exceptions || null;\n        this.occurrence_ids = raw_data.occurrence_ids || null;\n        this.recurrence_interval = raw_data.recurrence_interval || null;\n        this.recurrence_period = raw_data.recurrence_period || null;\n        this.recurrence_type = raw_data.recurrence_type || null;\n        this.recurrence_master_id = raw_data.recurrence_master_id\n        this.occurrence_details = raw_data.occurrence_details\n        this.is_recurrent = raw_data.is_recurrent || (!!this.recurrence_type && !!this.recurrence_period) || null;\n        this.recurrence_starts = raw_data.recurrence_starts || []\n        this.start_epoch = raw_data.start_epoch\n        this.end_epoch = raw_data.end_epoch\n\n        /**\n         * I'm not clear why, but the booking body, aka description is copied into the notes.\n         * R--- In concerge data description is only a key when saving, also in the note array?\n         */\n        if (raw_data.body && !this.notes.find((i) => i.type === 'description')) {\n            this.notes = [\n                ...this.notes,\n                {\n                    type: 'description',\n                    date: 0,\n                    message: raw_data.body,\n                    author: this.organiser.email\n                }\n            ];\n        }\n\n        /**\n         * In case there is a cancellation in progress the property attempted_to_delete is set to false\n         * And it is persisted until the booking is gone\n         */\n        this.attempted_to_delete = raw_data.attempted_to_delete || null;\n    }\n\n\n    /** Service for managing Bookings */\n    protected get _service() {\n        return ServiceManager.serviceFor(Booking);\n    }\n\n    /** Alias to approval_status */\n    public get auto_approve(): boolean {\n        // if concierge we auto_approve always.\n        if (this.is_concierge) {\n            return true;\n        }\n        return !this.room.byRequest({\n            dateTz: this.startDateTz,\n            duration: this.duration,\n            host: this.organiser\n        });\n    }\n\n    /** Whether booking has been approved */\n    public get approved(): boolean {\n        return !this.declined && !this.tentative;\n    }\n\n    /** All of the booking attendees including the organizer */\n    public get allAttendees(): User[] {\n        return unique([this.organiser].concat(this.attendees), 'email');\n    }\n\n    /** Computer format for booking type */\n    public get bookingTypeId(): string {\n        return this.booking_type.toLowerCase();\n    }\n\n    /** Human format for booking type */\n    public get bookingTypeLabel(): string {\n        return toTitleCase(this.booking_type);\n    }\n\n    /** Get accessor for the check in object, app expect array */\n    public get checkInsArray(): string[] {\n        return Object.keys(this.check_ins || {})\n    }\n\n    /** Legacy getter for \"class\" */ // R-- TODO remove\n    public get class(): string {\n        return this.booking_type;\n    }\n\n    /**  */\n    public get displayEndDateTz(): DateTZ {\n        if ((this.endDateTz.minutes % 5) !== 0) {\n            // All the bookings should end in 59 seconds\n            return this.endDateTz.addValue({ seconds: 1 });\n        }\n        // but if not they return 00\n        return this.endDateTz;\n    }\n\n    /** Whether booking has been declined */\n    public get declined(): boolean {\n        /**\n         * I'm not sure, nor is Cam if this is ever used to decline\n         * all booking for a specific room\n         */\n        if (this.room.name.toLowerCase().includes('decline')) {\n            return true;\n        }\n\n        if (this.status.includes('decline')) {\n            return true;\n        }\n\n        return false;\n    }\n\n    /** Description of the booking purpose */\n    public get description(): string {\n        const note = (this.notes || []).find((i) => i.type === 'description');\n        return note ? note.message : '';\n    }\n\n    /** Catering getter */\n    public get cateringOrders() {\n        // Return the catering orders sorted by delivery time\n        return this.catering ? this.catering.slice().sort((a, b) => {\n            if (a?.delivery_time > b?.delivery_time) return 1;\n            if (b?.delivery_time > a?.delivery_time) return -1;\n\n            return 0;\n        }) : [];\n    }\n\n    /** Get the created date as DateTz */\n    public get creationDateTz() {\n        return new DateTZ({ date: this.created_epoch * 1000, is_local_tz: false, building_tz: this.timezone })\n    }\n\n    public get tz_offset() {\n        return getTimezoneOffsetString(this.timezone);\n    }\n\n    /** Display value for the date */\n    public get date_string(): string {\n        return this.startDateTz.formatDate('dd MMM yyyy');\n    }\n\n    /**\n     * Get the booking durration based on start and end times\n     */\n     public get duration(): number {\n        return Math.abs(this.startDateTz.startOfValue('minute').dateDiff(this.displayEndDateTz, 'minutes'));\n    }\n\n    /** Unix timestamp of the booking start */\n    public get date() {  // R--- remove if not necessary\n        return this.startDateTz.ms;\n    }\n\n    /** Whether booking contains external visitors in the attendee list */\n    public get has_visitors(): boolean {\n        return this.attendees.reduce((a, v) => a || v.external, false);\n    }\n\n    /** Does the booking have catering orders */\n    public get has_catering(): boolean {\n        return !!this.catering.length;\n    }\n\n    /**\n     * Unique calendar event ID\n     * same as this.id, used to support existing component usage\n     */\n    public get icaluid(): string {\n        return this.id;\n    }\n\n    /**\n     * Get the booking room id\n     */\n    public get room_id(): string {\n        return this.room.id;\n    }\n\n    /** Legacy getter of room, aka space */\n    public get space(): Space {\n        return this.room;\n    }\n\n    /** Status of the booking */\n    public get timeBasedStatusLabel(): 'future' | 'upcoming' | 'done' | 'started' | 'in_progress' | 'expired_yesterday' {\n        const  buildingTzDt = DateNow(new Date()).toZone(this.timezone) ;  // building time\n\n        if (DateNow(new Date()).isBeforeDate(this.startDateTz.subtractValue({ minutes: 15 }))) {\n            return 'future';\n        } else if (DateNow(new Date()).isBeforeDate(this.startDateTz)) {\n            return 'upcoming';\n        } else if (DateNow(new Date()).isBeforeDate(this.startDateTz.addValue({ minutes: 15 }))) {\n            return 'started';\n        } else if (DateNow(new Date()).isBeforeDate(this.startDateTz.addValue({ minutes: this.duration }))) {\n            return 'in_progress';\n        }\n        // if current time is 12 AM (as per timezone) and booking expired yesterday\n        else if(buildingTzDt.startOfValue('day').addValue({ minutes: 1 }).isAfterDate(this.startDateTz, 'day') ) {\n            return 'expired_yesterday'\n        }\n\n        return 'done';\n    }\n\n    /** Whether booking is tentative */\n    public get tentative(): boolean {\n        if (\n            this.status &&\n            this.status.indexOf('tentative') >= 0\n        ) {\n            return true;\n        }\n\n        return false;\n    }\n\n    /** Display valuie for the start and end times of the booking */\n    public get time_period(): string {\n        return `${this.startDateTz.formatDate('h:mma')} - ${this.displayEndDateTz.formatDate('h:mma')}`;\n    }\n\n    /** Display value for the start time of the booking */\n    public get start_time(): string {\n        return this.startDateTz.formatDate('h:mma');\n    }\n\n    /** Display value for the end time of the booking */\n    public get end_time(): string {\n        return this.endDateTz.formatDate('h:mma');\n    }\n\n    /** Display value for the duration of the booking */\n    public get length_string(): string {\n        return humaniseDuration(this.duration);\n    }\n\n    /** Display value for the location of the booking */\n    public get local_room_name(): string {\n        return this.room?.local_name || 'No location';\n    }\n\n    /** Display value for the level of the first space in the booking */\n    public get level(): string {\n        return this.space.level.name;\n    }\n\n    /**\n     * Make a copy of this object\n     */\n    public clone(): Booking {\n        return new Booking(this.toJSON());\n    }\n\n    /**\n     * Make a copy of this object without identification data\n     */\n    public duplicate(isEdit = false): Booking {\n        return new Booking({\n            ...this.toJSON(),\n            id: isEdit ? this.id : null,\n        });\n    }\n\n    /**\n     *\n     * @param status\n     * @returns void\n     */\n    public undo(status?: 'accept' | 'decline', opts: { series?: boolean } = {}): Promise<void> {\n        return this._service.undo(\n            this.id, status || 'accept',\n            opts\n        );\n    }\n\n    /**\n     * Delete booking from the server\n     */\n    public delete(opts: { series?: boolean } = {}): Promise<void> {\n        if (this.id) {\n            return this._service.delete(this.id, { ...opts });\n\n            // R-- ask Cam again is he's positive these extra params are not needed for anything\n            // return this._service.delete(this.id, {\n            //     concierge: this.is_concierge,\n            //     host: this.organiser.email,\n            //     room_id: this.space?.id,\n            //     icaluid: this.icaluid,\n            //     start: json.start,\n            //     end: json.end\n            // });\n        }\n    }\n\n    /**\n     * Convert object into plain object\n     */\n    public toJSON(this: Booking): HashMap {\n        let data = super.toJSON();\n        // Remove the description from the notes\n        data.notes = Array.isArray(data.notes) ? data.notes.filter((note) => note.type !== 'description') : data.notes;\n        // Encode the nested objects\n        data.room = data.room.toJSON();\n\n\n        data.organiser = data.organiser.toJSON();\n        data.creator = data.creator?.toJSON ? data.creator.toJSON(): data.creator;\n        // Map the attendees User objects\n        data.attendees = data.attendees.map((i: User) => i.toJSON());\n\n        // New recurring booking\n        data = handleRecurrenceFields(data)\n\n        if(data.recurrence_list){\n            data.recurrence_starts = [...data.recurrence_list]\n            delete data.recurrence_list\n        }\n\n        return data;\n    }\n\n    /**\n     * Convert object into plain object\n     */\n    public toApiJSON(this: Booking): HashMap {\n        let data = super.toJSON();\n\n        // Update booking payload contains additional fields\n        data.icaluid = \"\";\n        if (data.id) {\n            data.icaluid = data.id;\n            data.location_name = this.room.local_name;\n            data.from_room = this.room.email;\n            data.building_zone = this.room.building?.id;\n        }\n\n        /**\n         * These fields are rather in flux\n         * According to Cam \"approve\" will be the prefered field\n         * and auto_approve and approval_status can be removed.\n         */\n        data.approve = this.auto_approve; // this value appear incorrect on update\n        data.auto_approve = [this.auto_approve]; // Needed to update approval status until BE accepts \"approve\"\n        // delete data.approval_status;\n\n        // Booking start and end data\n        delete data.startDateTz;\n        delete data.endDateTz;\n        data.start = this.startDateTz.seconds;\n        data.end = this.endDateTz.seconds;\n        data.old_start = this.startDateTz.seconds; // remove is not necessary\n        data.old_end = this.endDateTz.seconds; // remove is not necessary\n\n        // Creation date value\n        delete data.created_epoch;\n        data.creation_date = this.creationDateTz.seconds;\n\n        // Catering fields\n        // data.catering = data.catering.toJSON();\n        data.catering = this.cateringOrders;\n        data.has_catering = this.has_catering;\n        delete data.cateringOrders\n\n        // Attendees appear quite incomplete\n        // Map the attendees User objects\n        data.attendees = this.allAttendees.map((i: User) => i.toJSON ? i.toJSON() : i);\n\n        // Orgainizer and Creator data\n        data.organiser = data.organiser.toJSON ? data.organiser.toJSON() : data.organiser;\n        data.creator = data.creator.toJSON ? data.creator.toJSON() : data.creator;\n\n        //  Convert check_ins to checked_in array\n        delete data.check_ins;\n        data.checked_in = this.checkInsArray;\n\n        // edits - edit booking is showing all fields even w/o an edit :(\n\n        // Room data\n        data.room_ids = [this.room.email];\n        delete data.room;\n\n        // New recurring booking\n        data = handleRecurrenceFields(data)\n\n\n        if(data.recurrence_list){\n            data.recurrence_starts = [...data.recurrence_list]\n            delete data.recurrence_list\n        }\n\n        // Not found in dev data\n        delete data.name;\n        delete data.email;\n        delete data.is_concierge;\n        // delete data.building_zone;\n        // delete data.status;\n\n        return data;\n    }\n\n    public getType(): string {\n        if (!this || this.status?.includes('decline')) {\n            return 'cancelled';\n        }\n        const booking_type = this.booking_type;\n        if (booking_type === 'internal' && this.has_visitors) {\n            return 'external';\n        }\n        return booking_type;\n    }\n\n    /** fallback for a booking when the recurrence_end is null but it's a series booking */\n    public recurrenEndFromOcurrences(occurrence_details: { id: string, start_epoch: number }[]): DateTZ {\n        const date = occurrence_details?.map(occurence => occurence)\n        .sort((a, b) => new Date(a.start_epoch * 1000).getTime() - new Date(b.start_epoch * 1000).getTime())\n        .reverse()\n        .shift()\n        .start_epoch * 1000\n        return new DateTZ({date, is_local_tz: false, building_tz: this.timezone});\n    }\n\n    public get dateString() {\n        return shorterLocalDateFormatString(this.startDateTz);\n    }\n    public get dateBuildingString() {\n        return shorterBuildingDateFormatString(this.startDateTz);\n    }\n\n    public get endDateString(): string {\n        return shorterLocalDateFormatString(this.recurrenEndFromOcurrences(this.occurrence_details));\n    }\n}\n\n/**\n * Merge catering orders with same time and location\n * @param order_list List of catering orders\n */\nexport function mergeCateringOrders(order_list: CateringOrder[]) {\n    // R--- investigate when this is used. Staff doesn't use it when adding catering orders.\n    for (let i = 0; i < order_list.length; i++) {\n        const orders = order_list.filter(\n            (order) =>\n                order.location_id === order_list[i].location_id &&\n                order.delivery_time === order_list[i].delivery_time\n        );\n        if (orders.length > 1) {\n            const new_list = order_list.filter(\n                (order) =>\n                    !(order.location_id === order_list[i].location_id &&\n                        order.delivery_time === order_list[i].delivery_time)\n            );\n            new_list.push(new CateringOrder({\n                ...order_list[i],\n                items: flatten(orders.map(order => order.items)),\n                booking_date: this.startDateTz.ms,\n                booking_timezone: this.booking_timezone,\n            }));\n            order_list = new_list;\n            i = 0;\n        }\n    }\n    return order_list;\n}\n","import { DateTZ } from \"@mckinsey-converge/date-tz\";\n\nexport interface SpaceRules {\n    auto_approve: boolean;\n    hide: boolean;\n    max_length?: number;\n    min_length?: number;\n    reason?: string // specially for non-bookable rooms\n}\n\nexport interface BookingNote {\n    /** Type of note */\n    type: 'equipment' | 'catering' | 'description' | 'private' | 'other' | 'catering-private';\n    /** Name of the note's author */\n    author: string;\n    /** Contents of the note */\n    message: string;\n    /** Time the note was added to the booking */\n    date: number;\n    /** Display value for the time */\n    time?: string;\n    /** ID of the space associated with the note */\n    space?: string;\n    /** ID of the catering order associated with the note */\n    order_id?: string;\n}\n\nexport interface DateDurationData {\n    dateTz: DateTZ,\n    duration: number,\n    mobile: boolean,\n    save?: boolean,\n}\n\nexport enum BOOKING_STATUS {\n    approved = 'approved',\n    declined = 'declined',\n    tentative = 'tentative',\n    unavailable = 'unavailable'\n}","import {\n    AbstractControl,\n    FormControl,\n    FormGroup,\n    Validators\n} from '@angular/forms';\n\nimport { AvailableBookingFields } from '../settings.interfaces';\nimport {\n    HashMap,\n    humaniseDuration,\n    mockDate as mockDateBase,\n    resetDate as resetDateBase,\n    timeFormatString,\n    unique\n} from '@mckinsey-converge/base';\nimport { CateringOrder } from '../catering/catering-order.class';\nimport { ServiceManager } from '../service-manager.class';\nimport { User } from '../users/user.class';\nimport { Booking, IBookingQueryOptions } from './booking.class';\nimport {\n    BookingRule,\n    SpaceStatus\n} from './space.types';\nimport { validateEndTime } from '../validation.utilities';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { BookingAction, RecurrencePeriod, SeriesAction } from '../recurrence/recurrence.utils';\nimport { Space } from '../spaces';\n\nconst MINUTE = 1;\nconst HOUR = 60;\nconst DAY = 24 * HOUR;\nconst WEEK = 7 * DAY;\nconst MONTH = 30 * DAY;\n\nconst DURATION_MAP: { [duration: string]: number } = {\n    month: MONTH,\n    months: MONTH,\n    week: WEEK,\n    weeks: WEEK,\n    day: DAY,\n    days: DAY,\n    hour: HOUR,\n    hours: HOUR,\n    minute: MINUTE,\n    minutes: MINUTE\n};\n\n/**\n * Deprecated. Use @mckinsey-converge/base's import.\n */\nexport const mockDate = mockDateBase;\n\n/**\n * Deprecated. Use @mckinsey-converge/base's import.\n */\nexport const resetDate = resetDateBase;\n\nexport interface IBookingSlot {\n    start: number;\n    end: number;\n}\n\n\nexport function bookingOptionsToQuery(options: IBookingQueryOptions): HashMap {\n    let query: HashMap = {};\n    if (options) {\n        query = { ...options };\n        delete query.type;\n        if (options.filters) {\n            delete query.filters;\n            for (const property in options.filters) {\n                if (!query[property]) {\n                    query[property] = options.filters[property]\n                }\n            }\n        }\n\n        // id?: string;\n        // cancelled?: boolean;\n        if (options.until) {\n            query.to = options.until;\n            delete query.until;\n        }\n        \n    }\n    return query;\n}\n\n\n/**\n * Generate a list of free time slots between the given bookings\n * @param list List of bookings to find slots between\n * @param min_size Minimum length of a free slot in minutes\n */\nexport function getFreeBookingSlots(list: Booking[], min_size: number = 30): IBookingSlot[] {\n    /* istanbul ignore else */\n    if (!list) {\n        return [\n            {\n                start: 0,\n                end: DateNow(new Date()).startOfValue('minute').ms * 10\n            }\n        ];\n    }\n    const slots: IBookingSlot[] = [];\n    let start = new DateTZ({ date: 0 });\n    list.sort((a, b) => a.date - b.date);\n    for (const booking of list) {\n        const bkn_start = booking.startDateTz;\n        const bkn_end = booking.endDateTz;\n        if (bkn_start.isAfterDate(start)) {\n            const diff = Math.abs(bkn_start.dateDiff(start, 'minutes'));\n            /* istanbul ignore else */\n            if (diff >= min_size) {\n                slots.push({ start: start.ms, end: bkn_start.ms });\n            }\n            start = bkn_end;\n        } else if (start.startOfValue('minute').ms === bkn_start.startOfValue('minute').ms) {\n            start = bkn_end;\n        }\n    }\n    slots.push({\n        start: start.ms,\n         // R--- these X 10's make no sense. why not + 2 years?\n        end: DateNow(new Date()).startOfValue('minute').ms * 10\n    });\n\n    return slots;\n}\n\n/**\n * Get the next free time slot from the given bookings\n * @param list List of bookings to find the next slot\n * @param date Date to find next slot after in ms since UTC epoch\n * @param min_size Minimum length of the free slot in minutes\n * \n * R--- Possibly depreciate, I don't see it used anywhere except for its own test\n */\nexport function getNextFreeBookingSlot(\n    list: Booking[],\n    date: number = DateNow(new Date()).ms,\n    min_size: number = 15\n): IBookingSlot {\n    const slots = getFreeBookingSlots(list, min_size);\n    const date_ = new DateTZ({date})\n    const time = date_.startOfValue('minute').setValue({ second: 1 });\n    for (const block of slots) {\n        const start = new DateTZ({date: block.start});\n        const end = new DateTZ({date: block.end});\n        if (start.startOfValue('minute').isAfterDate(time)) {\n            return block;\n        } else if (time.isBeforeDate(end.startOfValue('minute'))) {\n            const duration = end.startOfValue('minute').dateDiff(time, 'minutes');\n            /* istanbul ignore else */\n            if (duration >= min_size) {\n                return block;\n            }\n        }\n    }\n    return slots[slots.length - 1];\n}\n\n/**\n * Generate form fields for the given booking\n * @param booking Booking to generate form for\n * @param current_user Current user of the system to default as the host\n */\nexport function generateBookingForm(\n    booking: Booking,\n    use_fields: AvailableBookingFields[],\n    isConcierge: boolean = false,\n    manualTimezone?: string,\n    action?: SeriesAction | BookingAction | null\n    ): FormGroup {\n    if (!booking) {\n        throw Error('No booking passed');\n    }\n\n    const user_service = ServiceManager.serviceFor(User);\n    const current_user =\n        user_service.current ||\n        new User({ id: 'local-user', name: 'Local User', email: 'local@place.tech' });\n\n    const fields: HashMap<FormControl> = {\n        id: new FormControl(booking.id || ''),\n        space_list: new FormControl([booking.room], []),\n        room: new FormControl(booking.room, {}),\n        dateTz: new FormControl({ value: booking.startDateTz || DateNow(), disabled: false }, [Validators.required]),\n        duration: new FormControl({ value: booking.duration, disabled: false }),\n        organiser: new FormControl(booking.organiser || current_user, [Validators.required]),\n        attendees: new FormControl(booking.attendees, []),\n        title: new FormControl(booking.title || '', { validators: [ Validators.required, Validators.minLength(1) ], updateOn: 'blur' }), //Validators.pattern(\"[^=`~!@#$%*{};:'\\\",_.<>]*\")\n        booking_type: new FormControl(booking.booking_type),\n        body: new FormControl(booking.body),\n        notes: new FormControl(booking.notes),\n        equipment_codes: new FormControl(booking.equipment_codes),\n        expected_attendees: new FormControl(booking.expected_attendees),\n        company: new FormControl(booking.company),\n        catering: new FormControl(\n            booking.cateringOrders.map(\n                (order) => new CateringOrder({\n                    ...order,\n                    booking_date: booking.startDateTz.ms,\n                    booking_timezone: booking.timezone,\n                })\n            )\n        ),\n        all_day: new FormControl(!!booking.all_day),\n        has_catering: new FormControl(!!booking.has_catering),\n        needs_space: new FormControl(true),\n        action: new FormControl(''),\n        timezone: new FormControl(manualTimezone || \"\"),\n        is_before_date: new FormControl(false)\n    };\n    if (!isConcierge) {\n        fields.duration.setValidators([Validators.required, validateEndTime(fields.dateTz)]);\n    }\n    /* istanbul ignore else */\n    if (booking.id && booking.id !== 'ad-hoc') {\n        fields.organiser.disable();\n        /* istanbul ignore else */\n        if (booking.endDateTz.ms < DateNow(new Date()).ms) {\n            fields.dateTz.disable();\n        }\n    } else {\n        const dateValidators = [Validators.required];\n        if (!isConcierge) {\n            dateValidators.push(isFuture);\n        }\n        dateValidators.push(validDateTZ)\n        fields.dateTz.setValidators(dateValidators);\n        fields.dateTz.updateValueAndValidity();\n    }\n    let list_length = -1;\n    fields.space_list.valueChanges.subscribe((list) => {\n        const expected = fields.expected_attendees.value || {};\n        const matches = Object.keys(expected).filter((key) =>\n            list.find((space) => space.email === key)\n        ).length;\n        if (list && list.length && matches === 0) {\n            const codes = fields.equipment_codes.value || {};\n            if (Object.keys(expected).length >= 0 || Object.keys(codes).length >= 0) {\n                const key = Object.keys(expected)[0] || Object.keys(codes)[0];\n                const new_expected = {};\n                const new_codes = {};\n                const notes = fields.notes.value;\n                notes.forEach((note) => (note.space === key ? (note.space = list[0].email) : ''));\n                new_expected[list[0].email] = expected[key];\n                new_codes[list[0].email] = codes[key];\n                fields.expected_attendees.setValue(new_expected);\n                fields.equipment_codes.setValue(new_codes);\n            }\n        }\n        list_length = list.length;\n    });\n    fields.dateTz.valueChanges.subscribe((_) => {\n        fields.duration.updateValueAndValidity();\n    });\n    fields.needs_space.valueChanges.subscribe((space_needed) => {\n        if (!space_needed) {\n            fields.space_list.setValue([]);\n        }\n    });\n    fields.has_catering.valueChanges.subscribe((has_catering) => {\n        if (!has_catering) {\n            fields.catering.setValue([]);\n        }\n    });\n    const simplified_fields: HashMap<FormControl> = [\n        'id',\n        'space_list',\n        'space_ids',\n        'notes',\n        'dateTz',\n        'booking_type',\n        'equipment_codes',\n        'expected_attendees',\n        'timezone',\n        'is_before_date',\n        ...use_fields\n    ].reduce((map, key) => {\n        /* istanbul ignore else */\n        if (fields[key]) {\n            map[key] = fields[key];\n        }\n        return map;\n    }, {});\n    \n    if (simplified_fields.all_day) {\n        const handleAllDay = (value) => {\n            if (value) {\n                let startOfDay = simplified_fields.dateTz.value.clone();\n                // When the booking space isn't set we still need a way to determine midnight\n                // and here we use the current concierge building selection's timezone.\n                if (manualTimezone) {\n                    startOfDay = startOfDay.toZone(manualTimezone);\n                }\n\n                simplified_fields.dateTz.setValidators([Validators.required]);\n                simplified_fields.dateTz.setValue(simplified_fields.all_day.value\n                            ? startOfDay.startOfValue('day')\n                            : simplified_fields.dateTz.value);\n                simplified_fields.duration.setValue(simplified_fields.all_day.value\n                    ? 24 * 60\n                    : simplified_fields.duration.value);\n                simplified_fields.dateTz.updateValueAndValidity();\n                simplified_fields.duration.disable();\n                // simplified_fields.dateTz.disable();\n            } else {\n                const dateValidators = [Validators.required];\n                if (!isConcierge) {\n                    dateValidators.push(isFuture);\n                }\n                dateValidators.push(validDateTZ)\n                simplified_fields.dateTz.setValidators(dateValidators);\n                simplified_fields.duration.setValue(booking.duration || 30);\n                simplified_fields.dateTz.updateValueAndValidity();\n                simplified_fields.duration.enable();\n                simplified_fields.dateTz.enable();\n            }\n        };\n        simplified_fields.all_day.valueChanges.subscribe(handleAllDay);\n        handleAllDay(simplified_fields.all_day.value);\n    }\n\n    const occurrences = booking.occurrence_details || [];\n\n    //Add recurrence fields\n    if(action && booking.recurrence_period  === RecurrencePeriod.LIST){\n        booking.recurrence_starts = occurrences\n            .filter(occurrence => occurrence.id !== booking.recurrence_master_id)\n            .map((occurrence) => new DateTZ({date: occurrence.start_epoch * 1000, is_local_tz: false, building_tz: booking.timezone})\n        ) \n    }\n    /**If series exists then set the start and end dates from the first and last bookings in the occurrences array\n     * this prevents prefilled form errors due to individual edits\n     */\n    if(action && action !== SeriesAction.CLONE && action !== BookingAction.CLONE && occurrences && occurrences.length && !booking.id){\n        const start_dateTz = new DateTZ({\n            date: occurrences.sort((d1, d2) => d1.start_epoch - d2.start_epoch)[0].start_epoch * 1000, \n            is_local_tz: false, building_tz: booking.timezone\n        })\n        simplified_fields.dateTz.setValue(start_dateTz)\n        const end = occurrences.sort((d1, d2) => d2.start_epoch - d1.start_epoch)[0].start_epoch * 1000\n        booking.recurrence_endTz =  new DateTZ({date: end, is_local_tz: false, building_tz: booking.timezone})  \n    }\n\n    // R-- needs TZ aware fields\n    const _recurr_end = simplified_fields.dateTz?.value || new DateTZ({ date: 1 }); // new DateTZ({date: simplified_fields.date?.value}) \n    const fields_with_recurrence = {\n        ...simplified_fields,\n        recurrence_period: new FormControl(booking.recurrence_period || RecurrencePeriod.WEEKLY),\n        recurrence_interval: new FormControl(booking.recurrence_interval || 1),\n        recurrence_endTz: new FormControl(booking.recurrence_endTz || _recurr_end.addValue({days: 1})),\n        recurrence_count: new FormControl(booking.recurrence_count || 0),\n        is_recurrent: new FormControl(booking.is_recurrent),\n        recurrence_starts: new FormControl(booking.recurrence_starts || []),\n        recurrence_exceptions: new FormControl([]),\n        recurrence_pattern: new FormControl(RecurrencePeriod.WEEKLY), //Helper value to store the last selected pattern (daily, weekly, monthly),\n        recurrence_days: new FormControl(booking.recurrence_days || [])\n    }\n\n    if(booking.is_recurrent && action !== BookingAction.CLONE){\n        fields_with_recurrence.recurrence_starts.setValidators([arrayWithValues])\n        fields_with_recurrence.recurrence_starts.updateValueAndValidity()\n        fields_with_recurrence.recurrence_endTz.setValidators([Validators.required, validDateTZ]);\n    }\n    // Generate form group for booking item\n    const form = new FormGroup(fields_with_recurrence);\n    return form;\n}\n\n/**\n * Validate whether date is in the future\n * @param control Control to check value\n */\nexport function isFuture(control: AbstractControl) {\n    const dateTz = control.value; // new DateTZ({date: control.value});\n    return dateTz.isBeforeDate(DateNow(new Date()).subtractValue({ minutes: 5 }))\n        ? { dateTz: 'Date needs to be in the future' }\n        : null;\n}\n\n/**\n * Validate whether an array has values\n * @param control Control to check value\n */\nexport function arrayWithValues (control: AbstractControl) {\n    return control.value.length !== 0 ? null : { field: 'Needs at least one value'}\n}\n\n/**\n * Validate whether a date has a valid value (future or current date)\n * @param control Control to check value\n */\n export function validDate (control: AbstractControl) {\n     if(!control.value){\n         return { date: 'Needs a valid date'}\n     }\n    const date = new DateTZ({date: control.value})\n    const now = DateNow(new Date())\n    const isValid = now.isBeforeDate(date, 'day') || now.isSameDate(date, 'day')\n    return isValid ? null : { date: 'Needs a valid date'}\n}\n\n/**\n * Validate whether a date has a valid DateTZ value (future or current date)\n * @param control Control to check value\n */\n export function validDateTZ (control: AbstractControl) {\n    if(!control.value){\n        return { date: 'Needs a valid date'}\n    }\n   const date = DateNow(control.value.JSDate);\n   const now = DateNow(new Date());\n   const isValid = now.isBeforeDate(date, 'day') || now.isSameDate(date, 'day')\n   return isValid ? null : { date: 'Needs a valid date'}\n}\n\n/**\n * Get minimum duration from ruleset in minutes\n * Default to 5min\n */\nexport function getMinLength(rule_list: HashMap<BookingRule[]>): number {\n    return Object.values(rule_list).reduce((min, block) => {\n        const min_block = block.reduce((min_length, el) => {\n            if (el.conditions.min_length && stringToMinutes(el.conditions.min_length) > min) {\n                return stringToMinutes(el.conditions.min_length);\n            } else {\n                return min_length;\n            }\n        }, 5);\n        if (min_block > min) {\n            return min_block;\n        } else {\n            return min;\n        }\n    }, 5) as number;\n}\n\n/**\n * Whether the first input is greater than the last. Converts duration strings into minutes\n * @param duration_1 First input can be a number in minutes or a duration string e.g. `1 hour`\n * @param duration_2 Second input can be a number in minutes or a duration string e.g. `30 minutes`\n */\nexport function durationGreaterThanOrEqual(\n    duration_1: string | number,\n    duration_2: string | number\n) {\n    const first: number = typeof duration_1 === 'string' ? stringToMinutes(duration_1) : duration_1;\n    const second: number =\n        typeof duration_2 === 'string' ? stringToMinutes(duration_2) : duration_2;\n    return first >= second;\n}\n\n/**\n * Conver time string into minutes\n * @param str timestring e.g. `'1 day'`, `'15 minutes'`, `'2 weeks'`\n */\nexport function stringToMinutes(str: string): number {\n    const parts = str.split(' ');\n    return +parts[0] * DURATION_MAP[parts[1]];\n}\n\n/**\n * Get current status within bookings\n * @param bookings List of bookings\n * @param host Host of the new event\n * @param date Datetime of the new event\n */\nexport function statusFromBookings(\n    bookings: Booking[] = [],\n    bookable: boolean = true,\n    requestable: boolean = false,\n    dateTz: DateTZ = DateNow(),\n    space?: Space\n) {\n    const free_slots = getFreeBookingSlots(bookings.filter((bkn) => !bkn.declined));\n    const now = DateNow() // new DateTZ({date}); // now should be now\n    // commeted bellow piece as correct way to get next free booking slot is at line- 488\n    // const next_free_slot = free_slots.find((slot) => {\n    //     return slot && (slot.start > now.ms || now.ms > slot.start - slot.start % 1000 || now.ms < slot.end - slot.end % 60 * 1000);\n    //     // const start = new DateTZ({date: slot?.start || 0 });\n    //     // const end = new DateTZ({date: slot?.end || 0}); // slot end isn't late enough? or after now/\n    //     // return start.isAfterDate(now) || (now.isAfterDate(start.startOfValue('second')) && now.isBeforeDate(end.startOfValue('minute')))\n    // });\n\n    const next_free_slot = getNextFreeBookingSlot(bookings.filter((bkn) => !bkn.declined));\n    \n    const start = new DateTZ({date: next_free_slot?.start || 0});\n    const end = new DateTZ({date: next_free_slot?.end || 0});\n    const currently_free = now.isAfterDate(start.startOfValue('second')) && now.isBeforeDate(end.startOfValue('minute'));\n    const time_until_next_block = humaniseDuration(\n        currently_free ? end.dateDiff(now, 'minutes') : start.dateDiff(now, 'minutes'),\n        'short'\n    );\n\n    const free_tomorrow = !currently_free && !start.isSameDate(now, 'day');\n    const free_today = currently_free && !end.isSameDate(now, 'day');\n    \n    return {\n        status: (!bookable\n            ? SpaceStatus.NotBookable\n            : currently_free\n                ? requestable\n                    ? SpaceStatus.Requestable\n                    : SpaceStatus.Available\n                : SpaceStatus.InProgress) as SpaceStatus,\n        available_until: free_today\n            ? 'No meetings today'\n            : currently_free\n                ? `Free until ${end.formatDate(timeFormatString())}(${time_until_next_block})`\n                : free_tomorrow\n                    ? 'Unavailable today'\n                    : `Free at ${start.formatDate(timeFormatString())}(${time_until_next_block})`\n    };\n}\n\n/**\n * V1 version display.\n */\nexport const spaceStatusToDisplay = (status: SpaceStatus): string => {\n    switch (status) {\n        case SpaceStatus.NotBookable:\n            return 'Not Bookable';\n        case SpaceStatus.Requestable:\n            return 'Available by Request';\n        case SpaceStatus.Unavailable:\n            return 'Unavailable';\n        case SpaceStatus.InProgress:\n            return 'Meeting in Progress';\n        case SpaceStatus.Available:\n        default:\n            return 'Available';\n    }\n};\n\nexport function replaceBookings(\n    list: Booking[],\n    new_bookings: Booking[],\n    filter_options: { room_email: string; fromTz: DateTZ; toTz: DateTZ }\n) {\n    const filtered_list = list.filter((booking) => {\n        return (\n            !(booking.room?.email === filter_options.room_email) ||\n            !timePeriodsIntersect(filter_options.fromTz.ms, filter_options.toTz.ms, booking.startDateTz.ms, booking.endDateTz.ms)\n        );\n    });\n    const updated_list = filtered_list.concat(new_bookings);\n    updated_list.sort((a, b) => a.date - b.date);\n    return unique(updated_list, 'icaluid');\n}\n\nexport function timePeriodsIntersect(\n    start1: number,\n    end1: number,\n    start2: number,\n    end2: number,\n    type = ''\n) {\n    return (\n        (start1 >= start2 && start1 < end2) ||\n        (end1 > start2 && end1 <= end2) ||\n        (start2 >= start1 && start2 < end1) ||\n        (end2 > start1 && end2 <= end1)\n    );\n}\n\nexport function formatWhen({\n    all_day,\n    startTZ,\n    endTZ,\n    displayEndTZ\n}): string {\n    if (all_day) {\n        return `${startTZ.formatDate('dd MMM yyyy')} - All Day`;\n    } else {\n        if (startTZ.isSameDate(endTZ, 'day')) {\n            return `${startTZ.formatDate('dd MMM yyyy, h:mma')} - ${displayEndTZ.formatDate('h:mma')}`;\n        } else {\n            return `${startTZ.formatDate('dd MMM yyyy, h:mma')} - ${displayEndTZ.formatDate('dd MMM yyyy, h:mma')}`;\n        }\n    }\n}\n","\nimport { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\nimport { BaseAPIService } from '../base.service';\nimport { Booking, IBookingQueryOptions } from './booking.class';\nimport { bookingOptionsToQuery } from './booking.utilities';\nimport {\n    HashMap\n} from '@mckinsey-converge/base';\nimport { ServiceManager } from '../service-manager.class';\nimport { SettingsService } from '../settings.service';\nimport { BookingCheckinParams } from './space.types';\nimport { DateNow } from \"@mckinsey-converge/date-tz\";\nimport { Observable } from 'rxjs/internal/Observable';\nimport { forkJoin } from 'rxjs';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class BookingsService extends BaseAPIService<Booking> {\n    constructor(protected _composer: ComposerService,\n        settingsService: SettingsService,\n    ) {\n        super(_composer, settingsService);\n        ServiceManager.setService(Booking, this);\n        this._name = 'Bookings';\n        this._api_route = 'bookings';\n        this._compare = (a, b) => !(a.id || '').localeCompare(b.id) || !(a.icaluid || '').localeCompare(b.icaluid);\n    }\n\n    /**\n * Get user bookings\n * @param options\n */\n    public userBookings(options: IBookingQueryOptions,\n        uniqueId?: string): Promise<Booking[]> {\n        if (!options) {\n            throw new Error('Booking avilability requires request options');\n        }\n        const now = DateNow(new Date())\n        if (!options.from) {\n            options.from = now\n                .startOfValue('day')\n                .subtractValue({ days: 2 })\n                .ms;\n        }\n        if (!options.until) {\n            options.until = null;\n        }\n\n        const key = `bookings|${options.id ? options.id : ''}|${uniqueId ?? ''}`;\n        if (!this._promises[key]) {\n            this._promises[key] = new Promise((resolve, reject) => {\n                const respond = (list: Booking[]) => {\n                    delete this._promises[key];\n                    resolve(list);\n                };\n                const error = e => {\n                    reject(e);\n                    delete this._promises[key];\n                };\n                const query = bookingOptionsToQuery(options);\n                if (options.id) {\n                    this.show(options.id, query).then(i => respond([i]), error);\n                } else {\n                    this.query(query).then(respond, error);\n                }\n            });\n        }\n        return this._promises[key];\n    }\n\n\n    /**\n     * Save changes to the booking\n     * @param booking Booking update or add to the database\n     */\n    public save(booking: Booking, series?: boolean): Promise<Booking> {\n        const body = booking.toApiJSON()\n        if(series){\n            body.series = true\n        }\n        return booking.id ? this.update(booking.id, body) : this.add(body);\n    }\n\n    /**\n     * Checkin atteendee of a booking\n     * @param id ID of the booking\n     * @param fields Fields associated with the booking and attendee\n     */\n    public checkin(id: string, fields: BookingCheckinParams) {\n        return  this.task(id, 'checkin', fields);\n    }\n    public checkinIndividualVisitor(id: string, fields: BookingCheckinParams) {\n        return  this.taskObsr(id, 'checkin', fields); \n    }\n\n    public accept(id: string, fields?: HashMap) {\n        return this.task(id, 'accept', fields);\n    }\n\n    public undo(id: string, status: 'accept' | 'decline', fields?: HashMap) {\n        return this.task(id, status, fields);\n    }\n\n    public decline(id: string, fields?: HashMap) {\n        return this.task(id, this.settingsService.concierge ? 'concierge_decline' : 'decline', fields);\n    }\n\n    protected process(raw_data: HashMap): Booking {\n        return new Booking(raw_data);\n    }\n\n    public declineMultiple(bookings: Booking[]): Observable<any[]> {\n        const requests = [];\n        bookings.forEach(bkg => {\n            const booking = bkg.toJSON();\n            const id = booking.id;\n            const fields = {\n                booking_id: booking.id,\n                organiser: booking.organiser.email,\n                room_email: booking.space?.email,\n                icaluid: booking.icaluid,\n                start: booking.startDateTz.formatDate('h:mm a').toLocaleLowerCase(),\n                end: booking.endDateTz.formatDate('h:mm a').toLocaleLowerCase(),\n            };\n            requests.push(this.taskObsr(id, 'concierge_decline', fields) ); \n        });\n        return forkJoin(requests);\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\nimport { PaginatedAPIService } from '../paginated.service';\nimport { Booking, IBookingQueryOptions,  } from './booking.class';\nimport { bookingOptionsToQuery } from './booking.utilities';\nimport {\n    HashMap\n} from '@mckinsey-converge/base';\nimport { ServiceManager } from '../service-manager.class';\nimport { SettingsService } from '../settings.service';\nimport { BookingCheckinParams } from './space.types';\nimport { Observable } from 'rxjs';\n\nexport interface PaginatedBooking {\n    results: Booking[];\n    total: number;\n}\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class BookingsPaginatedService extends PaginatedAPIService<Booking> {\n    constructor(protected _composer: ComposerService,\n        settingsService: SettingsService,\n    ) {\n        super(_composer, settingsService);\n        ServiceManager.setService(Booking, this);\n        this._name = 'Bookings';\n        this._api_route = 'bookings';\n        this._compare = (a, b) => !(a.id || '').localeCompare(b.id) || !(a.icaluid || '').localeCompare(b.icaluid);\n    }\n\n    /**\n * Get user bookings\n * @param options\n */\n    public userBookings(options: IBookingQueryOptions,\n        uniqueId?: string): Promise<PaginatedBooking> {\n        if (!options) {\n            throw new Error('Booking avilability requires request options');\n        }\n\n        const key = `bookingsPaginated|${options.id ? options.id : ''}|${uniqueId ?? ''}`;\n        if (!this._promises[key]) {\n            this._promises[key] = new Promise((resolve, reject) => {\n                const respond = (response: any) => {\n                    delete this._promises[key];\n                    resolve(response);\n                };\n                const error = e => {\n                    reject(e);\n                    delete this._promises[key];\n                };\n                const query = bookingOptionsToQuery(options);\n                if (options.id) {\n                    this.show(options.id, query).then(i => respond([i]), error);\n                } else {\n                    this.query(query).then(respond, error);\n                }\n            });\n        }\n\n        return this._promises[key];\n    }\n\n\n    /**\n     * Save changes to the booking\n     * @param booking Booking update or add to the database\n     */\n    public save(booking: Booking): Promise<Booking> {\n        return booking.id ? this.update(booking.id, booking.toJSON()) : this.add(booking.toJSON());\n    }\n\n    /**\n     * Checkin atteendee of a booking\n     * @param id ID of the booking\n     * @param fields Fields associated with the booking and attendee\n     */\n    public checkin(id: string, fields: BookingCheckinParams) {\n        return this.task(id, 'checkin', fields);\n    }\n\n    public accept(id: string, fields?: HashMap) {\n        return this.task(id, 'accept', fields);\n    }\n\n    public decline(id: string, fields?: HashMap) {\n        return this.task(id, this.settingsService.concierge ? 'concierge_decline' : 'decline', fields);\n    }\n\n    public undo(id: string, status: 'accept' | 'decline', fields?: HashMap) {\n        return this.task(id, status, fields);\n    }\n\n    protected process(raw_data: HashMap): Booking {\n        return new Booking(raw_data);\n    }\n\n    // public getHoldingBay(query: IBookingQueryOptions): Promise<PaginatedBooking> {\n    //     const key = `bookingsPaginated|holding-bay`;\n    //     if (!this._promises[key]) {\n    //         this._promises[key] = new Promise((resolve, reject) => {\n    //             const respond = (response: any) => {\n    //                 delete this._promises[key];\n    //                 resolve(response);\n    //             };\n    //             const error = e => {\n    //                 reject(e);\n    //                 delete this._promises[key];\n    //             };         \n    //                 this.query(query, { url: '/api/staff/bookings/holding_bay' }).then(respond, error);\n    //         });\n    //     }\n\n    //     return this._promises[key];\n    // }\n\n    public getHoldingBay = (query: IBookingQueryOptions): Observable<HashMap> => this.queryHoldingBay(query, { url: '/api/staff/bookings/holding_bay' });\n}\n","export * from './booking.class'\nexport * from './space.types'\nexport * from './bookings.service'\nexport * from './bookingsPaginated.service'\nexport * from './booking.utilities'\nexport * from './booking-state.service'\nexport * from './space.utilities'\nexport * from './booking.types'\n","import { SpaceRules } from './booking.types';\n\nimport {\n    durationGreaterThanOrEqual,\n    stringToMinutes\n} from './booking.utilities';\nimport {\n    SpaceCheckOptions,\n    SpaceRuleOptions\n} from './space.types';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n/**\n * Get booking rules for the given user and space\n * @param options\n */\nexport function rulesForSpace(options: SpaceRuleOptions): SpaceRules {\n    if (!options) {\n        throw Error('Options are needed to check for rule matches');\n    }\n    const space_rules_for_user: SpaceRules = {\n        auto_approve: true,\n        hide: true,\n        reason: ''\n    };\n    let match = false;\n    /* istanbul ignore else */\n    if (options.space) {\n        for (const type in options.rules) {\n            if (\n                options.rules.hasOwnProperty(type) &&\n                options.rules[type] instanceof Array &&\n                options.space.zones.find((zone) => zone === type)\n            ) {\n                for (const rule_block of options.rules[type]) {\n                    /* istanbul ignore else */\n                    if (\n                        checkRules({\n                            user: options.user,\n                            space: options.space,\n                            time: options.time,\n                            duration: options.duration,\n                            rules: rule_block.conditions\n                        })\n                    ) {\n                        const ruleset = rule_block.rules;\n                        const conditions = rule_block.conditions;\n                        space_rules_for_user.hide = false;\n                        /* istanbul ignore else */\n                        if (conditions.max_length) {\n                            space_rules_for_user.max_length = stringToMinutes(\n                                conditions.max_length as string\n                            );\n                        }\n                        /* istanbul ignore else */\n                        if (conditions.min_length) {\n                            space_rules_for_user.min_length = stringToMinutes(\n                                conditions.min_length as string\n                            );\n                        }\n                        // NOTE: use max_length in conditions instead of book_length in rules\n                        // if (ruleset.book_length) {\n                        //     space_rules_for_user.max_length = stringToMinutes(ruleset.book_length as string);\n                        // }\n                        /* istanbul ignore else */\n                        if (ruleset.auto_approve !== undefined) {\n                            space_rules_for_user.auto_approve = ruleset.auto_approve;\n                        }\n                        match = true;\n                        space_rules_for_user.reason = '';\n                        break;\n                    }\n                    else {\n                        space_rules_for_user.reason = 'OfficeRules';\n                    }\n                }\n            }\n            \n            /* istanbul ignore else */\n            if (!space_rules_for_user.hide) {\n                break;\n            }\n        }\n    }\n    if (!match) {\n        space_rules_for_user.hide = true;\n    }\n    return space_rules_for_user;\n}\n\n\n/**\n * Check if user matches the given ruleset\n * @param options\n */\nfunction checkRules(options: SpaceCheckOptions): boolean {\n    /* istanbul ignore else */\n    if (options.rules) {\n        const time = new DateTZ({date: options.time});\n        const count = Object.keys(options.rules).length;\n        let matches = 0;\n        Object.keys(options.rules).forEach((key) => {\n            let counter = 0;\n            const condition: string[] =\n                options.rules[key] instanceof Array\n                    ? (options.rules[key] as [])\n                    : [options.rules[key] as string];\n            switch (key) {\n                case 'groups':\n                    /* istanbul ignore else */\n                    if (options.user && options.user.groups) {\n                        counter = 0;\n                        condition.forEach((i) =>\n                            options.user.groups.find((j) => j === i) ? counter++ : null\n                        );\n                        /* istanbul ignore else */\n                        if (counter > 0) {\n                            matches++;\n                        }\n                    }\n                    break;\n                case 'locations':\n                    /* istanbul ignore else */\n                    if (options.user && options.user.location) {\n                        counter = 0;\n                        condition.forEach((i) =>\n                            (options.user.last_location.name || '').indexOf(i) >= 0\n                                ? counter++\n                                : null\n                        );\n                        /* istanbul ignore else */\n                        if (counter >= options.rules[key].length) {\n                            matches++;\n                        }\n                    }\n                    break;\n                case 'is_before':\n                    /* istanbul ignore else */\n                    if (options.time) {\n                        const duration = stringToMinutes(condition[0]);\n                        const check = DateNow(new Date()).addValue({ minutes: duration });\n                        let match = time.isBeforeDate(check);\n                        /* istanbul ignore else */\n                        matches += match ? 1 : 0;\n                    }\n                    break;\n                case 'is_after':\n                    /* istanbul ignore else */\n                    if (options.time) {\n\n                        const duration = stringToMinutes(condition[0]);\n                        const check = DateNow(new Date());\n                        time.isAfterDate(check.addValue({ minutes: duration })) ? matches++ : '';\n                    }\n                    break;\n                case 'min_length':\n                    /* istanbul ignore else */\n                    if (\n                        options.duration &&\n                        durationGreaterThanOrEqual(options.duration, condition[0])\n                    ) {\n                        matches++;\n                    }\n                    break;\n                case 'max_length':\n                    /* istanbul ignore else */\n                    if (\n                        options.duration &&\n                        durationGreaterThanOrEqual(condition[0], options.duration)\n                    ) {\n                        matches++;\n                    }\n                    break;\n            }\n        });\n        return matches >= count;\n    }\n    return false;\n}\n","\nimport { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\nimport { CateringCategory } from './catering-category.class';\nimport { BaseAPIService } from '../base.service';\nimport { SettingsService } from '../settings.service';\nimport { ServiceManager } from '../service-manager.class';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class CateringCategoriesService extends BaseAPIService<CateringCategory> {\n\n    constructor(protected _composer: ComposerService,\n                settingsService: SettingsService) {\n        super(_composer, settingsService);\n        ServiceManager.setService(CateringCategory, this);\n        this._name = 'catering category/group';\n        this._api_route = 'catering/category';\n    }\n\n    public query(): never {\n        throw Error('No index endpoint for catering categories. Use catering menu service.');\n    }\n\n    public show(): never {\n        throw Error('No show endpoint for catering categories. Use catering menu service.');\n    }\n\n    public processItem(raw_item: any) {\n        return new CateringCategory(raw_item);\n    }\n\n    public format(item: CateringCategory) {\n        return { ...item };\n    }\n}\n","import { CateringItem } from \"./catering-item.class\";\nimport { HashMap } from '@mckinsey-converge/base';\n\nexport class CateringCategory extends CateringItem {\n    /** Whether item is a category */\n    public is_category = true;\n    public admin_only: boolean;\n\n    constructor(data: HashMap) {\n        super(data);\n        this.is_category = true;\n        (this as any).must_select = this.must_select || 0;\n        (this as any).order_anytime = !!data.order_anytime && this.package;\n    }\n\n    /**\n     * Convert class object into plain object\n     */\n    public toJSON(this: CateringItem): HashMap {\n        const obj = super.toJSON();\n        obj.order_anytime = !!obj.order_anytime && obj.package;\n        return obj;\n    }\n}\n","import { HashMap } from '@mckinsey-converge/base';\n\nexport interface CateringAvailability {\n    /** Month of the year that the item starts being available */\n    readonly from_month: number;\n    /** Month of the year that the item ends being available */\n    readonly to_month: number;\n}\n\nexport class CateringItem {\n    /** Unique ID of the catering item */\n    public readonly id: string;\n    /** Display name of the catering item */\n    public readonly name: string;\n    /** Description of the item */\n    public readonly description: string;\n    /** URL to the image associated with the item */\n    public readonly image_path: string;\n    /** Type of catering item */\n    public readonly catering_type: string;\n    /** Availability of the item */\n    public readonly available: CateringAvailability;\n    /** Time in hours that is needed to prepare the item beforehand */\n    public readonly prior_notice: number;\n    /** Cost of the item without decimals */\n    private unit_price: number;\n    /** Cost of the item without decimals */\n    public readonly supplier_cost: number;\n    /** Minimum number this item allowed in an order */\n    public readonly minimum_quantity: number;\n    /** Maximum number this item allowed in an order */\n    public readonly maximum_quantity: number;\n    /** List of categories that the item is contained in */\n    public readonly parent_categories: readonly string[];\n    /** Allegen information associated with the item */\n    public readonly allergy: string;\n    /** Whether the supply of this item has run out */\n    public out_of_stock: boolean;\n    /** Whether item can be ordered within the time limit set by the building */\n    public readonly order_anytime: boolean;\n    /** Number of child items that must be selected as part of the package */\n    public readonly must_select: number;\n    /** List of associated items */\n    public readonly items: CateringItem[];\n    public readonly availableItems: CateringItem[];\n    /** Whether child items are part of a package */\n    public readonly package: boolean;\n    /** List of zone ids associated with the category */\n    public readonly zones: readonly string[];\n    /** Number of this item in the assoicated order */\n    private _amount = 0;\n    /** Unique ID of the catering item */\n    private instance_id: string;\n    /** Whether item is a category */\n    public is_category: boolean = false;\n    /** Whether item is disabled in Staff App */\n    public admin_only: boolean;\n\n    public get can_order_anytime(): boolean {\n        return (\n            this.order_anytime ||\n            !this.package && this.items.reduce(\n                (anytime, item) => anytime || item.can_order_anytime,\n                false,\n            )\n        );\n    }\n\n    /** Number of this item in the assoicated order */\n    public get amount(): number {\n        return this._amount || 0;\n    }\n\n     /** Unit price in the assoicated order */\n     public get price(): number {\n        return this.unit_price || 0;\n    }\n\n    /** Total cost of the amount of items set */\n    public get total(): number {\n        return (this._amount * this.unit_price) || 0;\n    }\n\n    constructor(data: HashMap) {\n        this.instance_id = `item-${Math.floor(Math.random() * 999_999_999)}`;\n        this.id = data.id || '';\n        this.name = data.name || '';\n        this.is_category = this.id.includes('category-');\n        this.available = {\n            from_month: (data.available ? data.available.from_month : data.available_from) || -1,\n            to_month: (data.available ? data.available.to_month : data.available_to) || -1,\n        };\n        this.description = data.description || '';\n        this.prior_notice = data.prior_notice || data.notice;\n        this.unit_price = data.unit_price || data.price || 0;\n        this.supplier_cost = data.supplier_cost;\n        this.minimum_quantity = Math.max(0, data.minimum_quantity || 0);\n        this.maximum_quantity = Math.max(1, data.maximum_quantity || 999);\n        this.parent_categories = data.category_ids || data.parent_categories || data.categories;\n        this.order_anytime = !!data.order_anytime;\n        this.image_path = data.image_path || '';\n        this.admin_only = data.admin_only;\n        this.catering_type = data.catering_type;\n        this.must_select = data.must_select ?? 0;\n        this._amount = data._amount || data.amount || 0;\n        this.allergy = data.allergy || '';\n        const cateringItems: CateringItem[] = (data.items || []).map(item => new CateringItem(item));\n        this.items = cateringItems;\n        const filteredCateringItems = cateringItems.filter(c => !c.out_of_stock);\n        this.availableItems = filteredCateringItems;\n        this.out_of_stock = !!data.out_of_stock ||\n            // if original items are empty, we hit the bottom, so if we filter out items then its out of stock.\n            (cateringItems.length > 0 && filteredCateringItems.length === 0);\n        this.package = data.package === 'true' || data.package === true;\n        this.zones = data.zones && data.zones.length ? [...data.zones] : [];\n    }\n\n    public setAmount(amount: number = 0): void {\n        if (amount <= this._amount) {\n            if (amount < this.minimum_quantity) {\n                amount = 0;\n            }\n        } else {\n            if (amount < this.minimum_quantity) {\n                amount = this.minimum_quantity;\n            }\n        }\n        this._amount = Math.max(0, Math.min(this.maximum_quantity, amount));\n    }\n\n    /**\n     * Updates the unit_price in the assoicated order if necessary\n     * @param price value to compare to unit_price\n     */\n    public setPrice(price: number = 0): void {\n        if(this.unit_price !== price) this.unit_price = price;\n    }\n\n    /**\n     * Increase amount of the item the order\n     * @param amount Amount to increase by\n     */\n    public addToOrder(amount: number = 1) {\n        amount = Math.max(1, amount);\n        this._amount += amount;\n        if (this._amount < 0) {\n            this._amount = 0;\n        } else if (this._amount < this.minimum_quantity) {\n            this._amount = this.minimum_quantity;\n        } else if (this._amount > this.maximum_quantity) {\n            this._amount = this.maximum_quantity;\n        }\n    }\n\n    /**\n     * Decrease amount of the item the order\n     * @param amount Amount to decrease by\n     */\n    public removeFromOrder(amount: number = 1) {\n        amount = Math.max(1, amount);\n        this._amount -= amount;\n        if (this._amount < 0) {\n            this._amount = 0;\n        } else if (this._amount < this.minimum_quantity) {\n            this._amount = 0;\n        }\n    }\n\n    /**\n     * Convert class object into plain object\n     */\n    public toJSON(this: CateringItem): HashMap {\n        const obj: any = { ...this };\n        // Remove local private members\n        delete obj._changes;\n        delete obj._server_names;\n        // Convert remaining members to be public\n        obj.price = obj.unit_price;\n        obj.categories = obj.parent_categories;\n        const keys = Object.keys(obj);\n        for (const key of keys) {\n            if (key[0] === '_') {\n                const new_key = key.substr(1);\n                obj[new_key] = obj[key];\n                delete obj[key];\n            } else if (obj[key] === undefined) {\n                delete obj[key];\n            }\n        }\n        obj.items = obj.items.map((item: CateringItem) => item.toJSON());\n        return obj;\n    }\n}\n","\nimport { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\nimport { BaseAPIService } from '../base.service';\nimport { CateringItem } from './catering-item.class';\nimport { SettingsService } from '../settings.service';\nimport { ServiceManager } from '../service-manager.class';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class CateringItemsService extends BaseAPIService<CateringItem> {\n    constructor(protected _composer: ComposerService,\n                settingsService: SettingsService) {\n        super(_composer, settingsService);\n        ServiceManager.setService(CateringItem, this);\n        this._name = 'Catering Menu';\n        this._api_route = 'catering/item';\n    }\n\n    public query(): never {\n        throw Error('No index endpoint for catering items. Use menu service.');\n    }\n\n    public show(): never {\n        throw Error('No show endpoint for catering items. Use menu service.');\n    }\n\n    public processItem(raw_item: any) {\n        return new CateringItem(raw_item);\n    }\n\n    public format(item: CateringItem) {\n        return item instanceof CateringItem ? item.toJSON() : item;\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\n\nimport { CateringItem } from './catering-item.class';\nimport { CateringCategory } from './catering-category.class';\nimport { BaseAPIService } from '../base.service';\nimport { HashMap } from '@mckinsey-converge/base';\nimport { SettingsService } from '../settings.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class CateringMenuService extends BaseAPIService<CateringItem | CateringCategory> {\n    constructor(protected _composer: ComposerService,\n                settingsService: SettingsService) {\n        super(_composer, settingsService);\n        this._name = 'Catering Menu';\n        this._api_route = 'menu';\n    }\n\n    /**\n     * Convert user data to local format\n     * @param user User data\n     */\n    protected processItem(item: HashMap) {\n        return item.items ? new CateringCategory(item) : new CateringItem(item);\n    }\n}\n","\nimport { Injectable } from '@angular/core';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class CateringNotesService {\n\n    public cateringNotes = [];\n\n    \n    public setNotes(notes) {\n        this.cateringNotes = notes;\n    }\n\n    public getNotes() {\n        return this.cateringNotes;\n    }\n}","import { CateringItem } from './catering-item.class';\nimport { HashMap } from '@mckinsey-converge/base';\n\nimport { CateringCategory } from './catering-category.class';\nimport { Booking } from '../bookings';\n\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\nexport type CateringOrderMutableProperties =\n  | 'items'\n  | 'location_id'\n  | 'location'\n  | 'delivery_time'\n  | 'charge_code'\n  | 'notes'\n  | 'status';\n\nexport type CateringOrderStatus = 'accepted' | 'preparing' | 'ready' | 'delivered' | 'cancelled';\n\nconst now = DateNow(new Date());\n\n// R--- refactor booking date to be dateTz\nexport class CateringOrder {\n  /**\n   * Booking fields\n   * \n   * The app handles booking data inconsisently.  Ususally these booking fields are provided\n   * for related booking data, but on occasion the full Booking class is used.\n   */\n\n  /** Unique Booking ID for the catering order */\n  readonly booking_id: string;\n  /** \n   * Timestamp based booking time of the booking associated with the order\n   * \n   * Must be provide as the true Booking startDateTz or as a new DateTZ with \n   * the correct date: timestamp, local_tz = false and bulding_tz values\n   */\n  readonly booking_date: number;\n  /**\n   * Timezone of the booking associated with the order\n   */\n  readonly booking_timezone: string;\n  /** ID of the location to deliver the items to */\n  location_id: string = '';\n  /** Display text for the location to deliver the items to */\n  location: string = '';\n  /**\n   * Smart timezone aware catering datetime with timezone\n   */\n  readonly bookingDateTz: DateTZ;\n\n  /** \n   * Booking associated with the order \n   * \n   * The booking attached to the CateringOrder is a special case used \n   * mainly on the Concierge catering reports because someone created \n   * a bad pattern to save catering changes to the booking.  \n   * \n   * Avoid when possible.\n   */\n  public booking: Booking = null;\n\n  /**\n   * Catering specific fields\n   * \n   * The app handles booking data inconsisently.  Ususally these booking fields are provided\n   * for related booking data, but on occasion the full Booking class is used.\n   */\n\n  /** Whether the order status change is loading */\n  public loading: boolean;\n  /** Unique ID for the catering order */\n  readonly id: string;\n  /** Number of minutes after the start of the associated meeting to delivery the order */\n  readonly delivery_time: number = 0;\n  /** Status of the catering order */\n  readonly status: CateringOrderStatus;\n  /** Whether items in the order need to be prepared in the kitchen */\n  readonly kitchen: boolean;\n  /** Whether items in the order are in the pantry */\n  readonly pantry: boolean;\n  /** List of items */\n  readonly items: readonly (CateringItem | CateringCategory)[] = [];\n  /** Creation time of the order */\n  readonly created_at: number;\n  /** Charge code associated with the order */\n  readonly charge_code: string;\n  /** Notes associated with the order */\n  readonly notes: string;\n  // /** Mapping of properties to their changes */\n  // private _changes: HashMap = {};\n  /** Map of local property names to server ones */\n  protected _server_names: HashMap<string> = {};\n  /** Currency code for the location of the order */\n  public symbol: string;\n  /** Whether the is an error with the order */\n  public error: boolean;\n\n\n  constructor(data: HashMap) {\n    /** \n     * Setup Defaults when raw_data values are not provided\n     */\n    const nowTz = DateNow(new Date());\n    // now rounded to the next 5 minute increment\n    const defaultStartTz = nowTz.setValue({ minute: Math.ceil(nowTz.minutes / 5) * 5 });\n    const defaultLocalTimezone = Intl?.DateTimeFormat()?.resolvedOptions()?.timeZone;\n\n    this.id = data.id || `order-${Math.floor(Math.random() * 999_999_999)}`;\n\n    // If the booking is provided default the booking values to the true booking values\n    this.booking = data.booking || null;\n\n    \n    // Has a booking so init with those values\n    if (this.hasBookingAttached) {\n      this.booking_date = this.booking.startDateTz.ms;\n      this.booking_timezone = this.booking.timezone;\n      this.bookingDateTz = this.booking.startDateTz;\n      this.location_id = data.location_id || '';\n      this.location = data.location || '';\n    } else {\n      this.booking_date = data.booking_date || defaultStartTz.ms;\n      this.booking_timezone = data.booking_timezone || defaultLocalTimezone;\n      this.bookingDateTz = new DateTZ({ date: this.booking_date, is_local_tz: false, building_tz: this.booking_timezone });\n      this.location_id = data.location_id || '';\n      this.location = data.location || '';\n    }\n    \n    this.delivery_time = typeof data.delivery_time === 'number' ? data.delivery_time : 0;\n    this.status = data.status || 'accepted';\n    this.charge_code = data.charge_code || data.code;\n    this.notes = data.notes;\n    this.kitchen = data.kitchen instanceof Array ? !!data.kitchen.length : data.kitchen;\n    this.pantry = data.pantry instanceof Array ? !!data.pantry.length : data.pantry;\n    this.symbol = data.symbol || 'USD';\n    this.items = (data.items || [])\n      .map(item => (item.items ? new CateringCategory(item) : new CateringItem(item)))\n      .filter(item => !!item.amount);\n  }\n\n  /** Special Case, check if a full booking is attached */\n  public get hasBookingAttached(): boolean {\n    return !!this.booking;\n  }\n\n  /** Display string for the types of items in the order */\n  public get type(): string {\n    let type = '';\n    /* istanbul ignore else */\n    if (this.kitchen) type += 'Kitchen';\n    /* istanbul ignore else */\n    if (this.pantry) {\n      /* istanbul ignore else */\n      if (type) type += ' + ';\n      type += 'Pantry';\n    }\n    return type;\n  }\n\n  /** Total cost of the order */\n  public get total(): number {\n    return this.items.reduce((total, item) => total + (item.total || 0), 0);\n  }\n\n  /** Total number of items in the order */\n  public get item_count(): number {\n    return this.items.reduce((total, item) => total + (item.amount || 0), 0);\n  }\n\n  public get deliver_date(): DateTZ {\n    return (this.bookingDateTz || this.booking?.startDateTz).addValue({ minutes: this.delivery_time })\n  }\n\n  /** Display string for the delivery time of the order (short version) */\n  public get deliver_at(): string {\n    return this.deliver_date.formatDate('h:mm a');\n  }\n\n  /** Display string for the delivery time of the order */\n  public get deliver_at_time(): string {\n    return this.deliver_date.formatDate('h:mma').toLocaleLowerCase();\n  }\n\n  /** Display string for the delivery date of the order */\n  public get deliver_on_date(): string {\n    return this.deliver_date.formatDate('dd MMM yyyy');\n  }\n\n  /**\n   * Make a copy of this object\n   */\n  public clone(): CateringOrder {\n      return new CateringOrder(this.toJSON());\n  }\n\n  /**\n   * Convert class object into plain object\n   */\n  public toJSON(this: CateringOrder): HashMap {\n    const obj: any = { ...this };\n    // Remove local private members\n    delete obj._server_names;\n    // Remove local public members\n    delete obj.booking;\n    delete obj.loading;\n    delete obj.bookingDateTz;\n\n    // Convert remaining members to be public\n    const keys = Object.keys(obj);\n    for (const key of keys) {\n      if (key[0] === '_') {\n        const new_key = this._server_names[key.substr(1)] || key.substr(1);\n        obj[new_key] = obj[key];\n        delete obj[key];\n      } else if (obj[key] === undefined) {\n        delete obj[key];\n      }\n    }\n    obj.items = obj.items.map((item: CateringItem) => item.toJSON());\n\n    return obj;\n  }\n}\n","import { CateringItem } from './catering-item.class';\n\nexport const mergeCateringItemWithFormData = (existing: CateringItem, override: any) =>\n    new CateringItem({\n        ...(existing instanceof CateringItem ? existing.toJSON() : existing),\n        ...override\n    });\n","export * from './catering-item.class';\nexport * from './catering-category.class';\nexport * from './catering-menu.service';\nexport * from './catering-order.class';\nexport * from './catering-categories.service';\nexport * from './catering-items.service';\nexport * from './catering.utilities';\nexport * from './catering-notes.service';\n","import { Injectable } from '@angular/core';\nimport { MatDialogRef } from '@angular/material/dialog';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CloseDialogService {\n  private dialogRefMap = new Map<string, MatDialogRef<any>>();\n\n  constructor() { }\n\n  // Register a dialog with its ID\n  registerDialog(id: string, dialogRef: MatDialogRef<any>): void {\n    this.dialogRefMap.set(id, dialogRef);\n  }\n\n  // Close a specific dialog by ID\n  closeDialog(id: string): void {\n    const dialogRef = this.dialogRefMap.get(id);\n    if (dialogRef) {\n      dialogRef.close();\n      this.dialogRefMap.delete(id);\n    }\n  }\n\n  // Optional: Close all dialogs\n  closeAllDialogs(): void {\n    this.dialogRefMap.forEach((dialogRef, id) => {\n      dialogRef.close();\n      this.dialogRefMap.delete(id);\n    });\n  }\n}\n\nexport enum DialogIds {\n  MeetingDetails = 'meetingDetailsDialogId',\n  BookingConfirmation = 'bookingConfirmationDialogId',\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n  imports: [CommonModule],\n})\nexport class DataCommonModule {}\n","import { Injectable } from '@angular/core';\nimport {\n  BehaviorSubject,\n  Observable,\n  Subscription\n} from 'rxjs';\n\nimport {\n  HashMap,\n  unique\n} from '@mckinsey-converge/base';\n\n/** List of keys that cannot be in a combination by themselves or with each other */\nconst INVALID_STANDALONE_KEYS: string[] = ['control', 'shift', 'alt', 'meta', 'os'];\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class HotkeysService {\n  /** Map of subjects which store press states of keys */\n  private keydown_states: HashMap<BehaviorSubject<number>> = {};\n  /** Map of obserers for key state subjects */\n  private keydown_observers: HashMap<Observable<number>> = {};\n  /** List of keys at the end of a combination */\n  private combo_end: string[] = [];\n  /** List of registered hotkey combinations */\n  private registered_combos: string[][] = [];\n  /** Counter for the number of keydown events. Used for checking order of key presses */\n  private counter: number = 0;\n  /** Last key code to be pressed */\n  private last_down: string;\n\n  constructor() {\n    window.addEventListener('keydown', (event: KeyboardEvent) => {\n      const code = this.mapKey((event.code || '').toLowerCase());\n      /* istanbul ignore else */\n      if (this.last_down !== code) {\n        /* istanbul ignore else */\n        if (!this.keydown_states[code]) {\n          this.keydown_states[code] = new BehaviorSubject(null);\n          this.keydown_observers[code] = this.keydown_states[code].asObservable();\n        }\n        this.keydown_states[code].next(++this.counter);\n        /* istanbul ignore else */\n        if (this.combo_end.indexOf(code) >= 0) {\n          event.preventDefault();\n        }\n        this.last_down = code;\n      }\n    });\n\n    window.addEventListener('keyup', (event: KeyboardEvent) => {\n      const code = this.mapKey((event.code || '').toLowerCase());\n      /* istanbul ignore else */\n      if (this.keydown_states[code]) {\n        this.keydown_states[code].next(null);\n      }\n      /* istanbul ignore else */\n      if (this.last_down === code) {\n        this.last_down = null;\n      }\n    });\n  }\n\n  /**\n   * Listen to the given key combination\n   * @param combo Array of key codes to listen to or a hotkey string e.g. `Alt+Shift+KeyK`\n   * @param next Callback for combination presses\n   */\n  public listen(combo: string | string[], next: () => void): Subscription {\n    combo = (combo instanceof Array ? combo : combo.split('+'));\n    const combination: string[] = combo.map(i => this.mapKey(i.toLowerCase()));\n    /* istanbul ignore else */\n    if (combination.length > 0 && this.validCombination(combination)) {\n      this.registered_combos.push(combination);\n      const last_key = combination[combination.length - 1];\n      /* istanbul ignore else */\n      if (!this.keydown_states[last_key]) {\n        this.keydown_states[last_key] = new BehaviorSubject(null);\n        this.keydown_observers[last_key] = this.keydown_states[last_key].asObservable();\n      }\n      this.updateCombinationEndList();\n      return this.keydown_observers[last_key].subscribe((count) => {\n        /* istanbul ignore else */\n        if (count) {\n          const presses: number[] = [];\n          /* istanbul ignore else */\n          if (combination.length > 0) {\n            // Check that keys are pressed\n            for (const key of combination) {\n              const state = this.keydown_states[key];\n              presses.push(state ? state.getValue() || -1 : -1);\n            }\n            // Check that keys are pressed in the correct order\n            for (let i = 0; i < combination.length - 1; i++) {\n              if (presses[i] > presses[i + 1]) {\n                return;\n              }\n            }\n          }\n          const total = presses.reduce((a, v) => a + (v > 0 ? 1 : -1), 0);\n          /* istanbul ignore else */\n          if (total >= combination.length) {\n            next();\n          }\n        }\n      });\n    }\n    return null;\n  }\n\n  /**\n   * Map key codes with multiple versions to simple form\n   * @param code Code to transform\n   */\n  private mapKey(code: string): string {\n    /* istanbul ignore else */\n    if (code.indexOf('alt') >= 0 || code.indexOf('shift') >= 0 || code.indexOf('control') >= 0) {\n      return code.replace('left', '').replace('right', '');\n    }\n    return code;\n  }\n\n  /**\n   * Update the list of the last keys in combinations to allow for prevent default actions on pre-existing hotkeys\n   */\n  private updateCombinationEndList(): void {\n    const key_list = [];\n    for (const combo of this.registered_combos) {\n      this.combo_end.push(combo[combo.length - 1]);\n    }\n    this.combo_end = unique(key_list);\n  }\n\n  /**\n   * Checks if the given hotkey combination is allowed and valid\n   * @param combo Array of key codes\n   */\n  private validCombination(combo: string[]): boolean {\n    let non_meta = 0;\n    for (const key of combo) {\n      /* istanbul ignore else */\n      if (INVALID_STANDALONE_KEYS.indexOf(key) < 0) {\n        non_meta++;\n      }\n    }\n    return non_meta > 0;\n  }\n}\n","export * from './location.class';\nexport * from './location.service';\n","import { HashMap } from '@mckinsey-converge/base';\n\nimport { Organisation } from '../organisation/organisation.class';\nimport {\n    ServiceLike,\n    ServiceManager\n} from '../service-manager.class';\nimport { BuildingLevel } from '../organisation/level.class';\n\nexport class MapLocation {\n  /** ID of the element on the associated map */\n  public readonly id?: string;\n  /** Name of the location */\n  public readonly name?: string;\n  /** X coordinate of the location */\n  public readonly x?: number;\n  /** Y coordinate of the location */\n  public readonly y?: number;\n  /** Level details for the location */\n  public readonly level: BuildingLevel;\n  /** Whether the position is fixed */\n  public readonly fixed: boolean;\n  /** Accuracy of the location when not fixed */\n  public readonly confidence?: number;\n  /** Whether location is at a desk */\n  public readonly at_desk?: boolean;\n  /** Whether location is set */\n  public readonly empty: boolean;\n\n  /** Service for managing model on the server */\n  protected get _service(): ServiceLike {\n    return ServiceManager.serviceFor(MapLocation);\n  }\n\n  /** Display string for the building and level of the location */\n  public get display(): string {\n    const service = ServiceManager.serviceFor(Organisation);\n    if (!service) {\n      return this.level.name;\n    }\n    const bld = service.buildings.find((bld) => bld.id === this.level.building_id);\n    return bld ? `${bld.name}, ${this.level.name}` : this.level.name;\n  }\n\n  /** Whether location is in a different building from the active one */\n  public get in_another_building(): boolean {\n    const service = ServiceManager.serviceFor(Organisation);\n    return service && service.building.id !== this.level.building_id;\n  }\n\n  constructor(raw_data: HashMap) {\n    this.id = raw_data.id || raw_data.map_id || raw_data.desk_id;\n    this.name = raw_data.name || '';\n    this.x = raw_data.x\n      ? Math.floor(this.normalise(raw_data.x, raw_data.x_max || 10000) * 10000)\n      : null;\n    this.y = raw_data.y\n      ? Math.floor(this.normalise(raw_data.y, raw_data.x_max || 10000) * 10000)\n      : null;\n    const service = ServiceManager.serviceFor(Organisation);\n    this.level =\n      raw_data.level instanceof BuildingLevel\n        ? raw_data.level\n        : service\n        ? service.levelWithID(raw_data.level)\n        : new BuildingLevel(raw_data.level);\n    this.fixed = this.x === null && this.y === null;\n    this.confidence = Math.max(5, Math.min(15, raw_data.confidence || 0));\n    this.at_desk = this.id && this.id.indexOf('area-') === 0;\n    this.empty = !(this.name && this.level && (this.id || this.x || this.y));\n  }\n\n  /** Normalise the given value within the max */\n  private normalise(value: number, max: number): number {\n    return value / (max * 1.0);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\n\nimport { BaseAPIService } from '../base.service';\nimport { MapLocation } from './location.class';\nimport { HashMap } from '@mckinsey-converge/base';\nimport { ServiceManager } from '../service-manager.class';\nimport { SettingsService } from '../settings.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class LocationService extends BaseAPIService {\n    constructor(protected _composer: ComposerService,\n                settingsService: SettingsService) {\n        super(_composer, settingsService);\n        ServiceManager.setService(MapLocation, this);\n        this._name = 'Location';\n        this._api_route = 'people';\n    }\n\n    public add(...args): never {\n        throw new Error('Create not allowed for location service')\n    }\n\n    public update(...args): never {\n        throw new Error('Update not allowed for location service')\n    }\n\n    public delete(...args): never {\n        throw new Error('Delete not allowed for location service')\n    }\n\n    public process(item: HashMap) {\n        return new MapLocation(item) as any;\n    }\n}\n","import { BaseDataClass } from '../base-api.class';\nimport {\n    getItemWithKeys,\n    HashMap,\n    Identity\n} from '@mckinsey-converge/base';\nimport { BuildingLevel } from './level.class';\nimport { BookingRule } from '../bookings';\nimport { ServiceManager } from '../service-manager.class';\n\nexport interface BuildingCity {\n    timezone: string\n    name: string\n}\n\nexport interface IBuildingRoleUser {\n    name: string;\n    email: string;\n    phone: string;\n}\n\nexport interface LockerMap {\n    [zone: string]: {\n        [area: string]: {\n            [type: string]: (string | boolean)[][];\n        };\n    };\n}\n\nexport interface ICoordinates {\n    longitude: number;\n    latitude: number;\n}\n\nexport interface LevelFeature {\n    id: string;\n    level_id: string;\n    name: string;\n}\n\nexport interface BookingRuleDetails {\n    /** List of booking rules details for the building */\n    readonly rules: readonly string[];\n    /** Custom booking rules for the map */\n    readonly map_rules?: readonly string[];\n    /** Custom booking rules for the map */\n    readonly other_rules?: readonly string[];\n    /** Contact email address for the building */\n    readonly contact?: string;\n    /** Information string to display before the rule listings */\n    readonly info?: string;\n    /** Link for more details */\n    readonly link?: { url?: string, name?: string };\n    /**\n     * Allow buildings to define their own rules formats where needed or for special messages.\n     */\n    readonly custom_html?: string;\n}\n\nexport class Building extends BaseDataClass {\n    /** Service for managing buildings */\n    protected get _service() {\n        return ServiceManager.serviceFor(Building);\n    }\n\n    /** Engine Zone ID for the building */\n    public readonly zone_id: string;\n    /** Organisation Code for the building */\n    public readonly code: string;\n    /** Geographical address of the building */\n    public readonly address: string;\n    /** Details about the booking rules for the building */\n    public readonly booking_details: BookingRuleDetails;\n    /** Details about the booking rules for the building */\n    public readonly booking_rules: HashMap<readonly BookingRule[]>;\n    /** Number of hour before a booking catering is restricted */\n    public readonly catering_restricted_from: number;\n    /** Currency code for the country assoicated with the building */\n    public readonly currency: string;\n    /** Map of fields that are required on the form */\n    public readonly required: HashMap<boolean>;\n    /** IANA timezone database string for the location the building resides  */\n    public readonly timezone: string;\n    /** Whether catering is available in this building */\n    public readonly has_catering: boolean;\n    /** ID of the system used for the holding bay */\n    public readonly holding_bay: string;\n    /** ID of the system used for standalone visitors bookings */\n    public readonly visitor_space: string;\n    /** List of zones to determine sort order spaces */\n    public readonly sort_order: readonly string[];\n    /** Searchable map features */\n    public readonly searchables: readonly LevelFeature[];\n    /** List of available extras for the building */\n    public readonly extras: readonly Identity[];\n    /** List of available extra equipment for loan at the building */\n    public readonly loan_items: readonly Identity[];\n    /** List of available levels for the building */\n    public readonly levels: readonly BuildingLevel[];\n    /** The city the building belongs in **/\n    public readonly city: string;\n\n    public readonly catering_hours: { readonly start: number, readonly end: number };\n    /** Map of custom settings for the building */\n    private _settings: HashMap;\n    /** Map of roles and list of the associated users */\n    private _roles: HashMap<IBuildingRoleUser[]>;\n    /** Map of the locker ID arrays */\n    private _lockers: LockerMap;\n    /** Map of important system ids for the building */\n    private _systems: HashMap<string>;\n    /** Map of important phone numbers for the building */\n    private _phone_numbers: HashMap<string>;\n    /** Globe coordiates for the build */\n    private _location: ICoordinates;\n    /** List of zones associated with the building */\n    public readonly zones: readonly string[];\n\n    constructor(raw_data: HashMap) {\n        super(raw_data);\n        const settings = raw_data.settings || {};\n        const disc_info = settings.discovery_info || {};\n        this.zone_id = raw_data.zone_id || raw_data.zone;\n        this.extras = (raw_data.extras || disc_info.extras || []).map(i => ({\n            id: i.extra_id || i.id,\n            name: i.extra_name || i.name\n        }));\n        this.loan_items = (raw_data.loan_items || disc_info.loan_items || []).map(i => ({\n            id: i.extra_id || i.id,\n            name: i.extra_name || i.name\n        }));\n        this.levels = (raw_data.levels || disc_info.levels || []).map(i => new BuildingLevel({\n            ...i,\n            building_id: this.id\n        }));\n        this._roles = raw_data.roles || disc_info.roles || {};\n        this._lockers = raw_data.lockers || raw_data.locker_structure || disc_info.locker_structure || {};\n        this._systems = raw_data.systems || disc_info.systems || {};\n        this._settings = settings;\n        this._phone_numbers = raw_data.phone_numbers || disc_info.phone_numbers || {};\n        this._location = raw_data.location || disc_info.location || { longitude: null, latitude: null };\n        this.catering_hours = raw_data.catering_hours || disc_info.catering_hours || settings.catering_hours || {\n            start: 7,\n            end: 20\n        };\n        const searchables = [];\n        if (raw_data.neighbourhoods) {\n            for (const lvl in raw_data.neighbourhoods) {\n                if (raw_data.neighbourhoods.hasOwnProperty(lvl)) {\n                    const lvl_features = raw_data.neighbourhoods[lvl] || {};\n                    for (const feature in lvl_features) {\n                        if (lvl_features.hasOwnProperty(feature)) {\n                            searchables.push({\n                                id: lvl_features[feature],\n                                name: feature,\n                                level_id: lvl\n                            });\n                        }\n                    }\n                }\n            }\n        }\n        this.searchables = searchables;\n        this.code = raw_data.code || disc_info.code || settings.code || '';\n        this.address = raw_data.address || disc_info.address || settings.address || '';\n        this.booking_details = raw_data.booking_details || disc_info.booking_details || settings.booking_details || {};\n        this.booking_rules = raw_data.booking_rules || disc_info.booking_rules || settings.booking_rules || {};\n        this.catering_restricted_from = raw_data.catering_restricted_from || disc_info.catering_restricted_from || settings.catering_restricted_from || 0;\n        this.currency = raw_data.currency || disc_info.currency || settings.currency || 'USD';\n        this.required = raw_data.required || disc_info.required || settings.required || {};\n        if (disc_info.requires_equipment_code) {\n            this.required.equipment_code = true;\n        }\n        if (disc_info.requires_expected_attendees) {\n            this.required.expected_attendees = true;\n        }\n        this.timezone = raw_data.timezone || disc_info.timezone || settings.timezone || '';\n        this.has_catering = raw_data.has_catering || disc_info.has_catering || settings.has_catering || false;\n        this.holding_bay = raw_data.holding_bay || disc_info.holding_bay || settings.holding_bay || '';\n        this.visitor_space = raw_data.visitor_space || disc_info.visitor_space || settings.visitor_space || '';\n        this.sort_order = raw_data.sort_order || disc_info.sort_order || settings.sort_order || [];\n        this.city = raw_data.city || disc_info.city || 'No City';\n    }\n\n    /**\n     * Get a custom building setting\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n     */\n    public setting(key: string): any {\n        const keys = key.split('.');\n        const value = getItemWithKeys(keys, this._settings) || getItemWithKeys(['discovery_info', ...keys], this._settings);\n        return value;\n    }\n\n    /**\n     * Get list of users with the associated role\n     * @param name Role to find users for\n     */\n    public role(name: string): IBuildingRoleUser[] {\n        return [...(this._roles[name] || [])];\n    }\n\n    /**\n     * Get list of the names of available user role lists\n     */\n    public get role_names(): string[] {\n        return Object.keys(this._roles).filter(i => this._roles.hasOwnProperty(i));\n    }\n\n    /** Map of the locker ID arrays */\n    public get lockers(): LockerMap {\n        return { ...(this._lockers || {}) };\n    }\n\n    /** Map of important system ids for the building */\n    public get systems(): HashMap<string> {\n        return { ...(this._systems || {}) };\n    }\n\n    /** Map of important phone numbers for the building */\n    public get phone_numbers(): HashMap<string> {\n        return { ...(this._phone_numbers || {}) };\n    }\n\n    /** Real coordinates */\n    public get location(): ICoordinates {\n        return { ...this._location };\n    }\n\n    /**\n     * Get search map feature for the given level ID\n     * @param level_id ID of level to grab features for\n     */\n    public featuresForLevel(level_id: string): LevelFeature[] {\n        return (this.searchables || []).filter(i => i.level_id === level_id);\n    }\n\n    /**\n     * Building objects are readonly and cannot be changed\n     */\n    public async save(): Promise<Building> {\n        throw new Error('Building objects are readonly and cannot be changed');\n    }\n\n    /**\n     * Building objects are readonly and cannot be deleted\n     */\n    public async delete(): Promise<void> {\n        throw new Error('Building objects are readonly and cannot be deleted');\n    }\n}\n","export * from './building.class';\nexport * from './level.class';\nexport * from './organisation.class';\nexport * from './organisation.service';\n","import { HashMap } from 'libs/base/src/lib/types.utilities';\n\n/** Building Level data */\nexport class BuildingLevel {\n    /** ID of the building level zone */\n    readonly id: string;\n    /** ID of the building zone associated with the level */\n    readonly building_id: string;\n    /** Name of the level */\n    readonly name: string;\n    /** Number or short identifier of the level */\n    readonly short_name: string;\n    /** Map URL for the level */\n    readonly map_url: string;\n    /** Usage type for the level */\n    readonly type: 'staff' | 'client' | 'any';\n    /** Setting for the level */\n    readonly settings: HashMap;\n\n    constructor(_data: HashMap = {}) {\n        this.id = _data.id || _data.level_id || '';\n        this.building_id = _data.bld_id || _data.building_id || '';\n        this.name = _data.name || _data.level_name || '';\n        const lower_name = this.name.toLowerCase();\n        const num = lower_name.indexOf('level') >= 0 ? lower_name.replace(/ ?level ?/gi, '') : lower_name.substr(0, 1).toUpperCase();\n        this.short_name = _data.short_name || num || '';\n        this.map_url = _data.map_url || '';\n        this.type = _data.type || _data.floor_type || 'any';\n        this.settings = _data.settings;\n    }\n}\n","import { BaseDataClass } from '../base-api.class';\nimport {\n  getItemWithKeys,\n  HashMap\n} from '@mckinsey-converge/base';\n\n/* istanbul ignore next */\n\nexport class Organisation extends BaseDataClass {\n  /** List of available building zone ids for the organisation */\n  public readonly available_buildings: readonly string[];\n  /** Map of custom settings for the building */\n  private _settings: HashMap;\n\n  constructor(raw_data: HashMap = {}) {\n    super(raw_data);\n    this._settings = raw_data.settings || {};\n    this.available_buildings = (raw_data.settings?.discovery_info?.buildings || []).map(\n      (bld) => bld.zone_id\n    );\n  }\n\n  /**\n   * Get a custom building setting\n   * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n   */\n  public setting(key: string): any {\n    const keys = key.split('.');\n    const value = getItemWithKeys(keys, this._settings);\n    return value;\n  }\n}\n","import { Injectable } from '@angular/core';\n\nimport { ComposerService } from '@placeos/composer';\n\nimport { BaseAPIService } from '../base.service';\nimport { Organisation } from './organisation.class';\nimport { Building } from './building.class';\nimport {\n  ApplicationLoadingState,\n  HashMap,\n  Identity\n} from '@mckinsey-converge/base';\nimport { BuildingLevel } from './level.class';\nimport { first } from 'rxjs/operators';\nimport { ApplicationService } from '../app.service';\nimport { ServiceManager } from '../service-manager.class';\nimport { UsersService } from '../users';\nimport { SettingsService } from '../settings.service';\nimport { Observable, Subject } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class OrganisationService extends BaseAPIService {\n  /** Organisation data for the application */\n  private _organisation: Organisation;\n  /** Actively displayed building */\n  private _active_building: string;\n\n  private _spaceTypesSubject: Subject<Identity[]> = new Subject<Identity[]>();\n\n  constructor(\n    protected _composer: ComposerService,\n    private _service: ApplicationService,\n    private _users: UsersService,\n    settingsService: SettingsService,\n  ) {\n    super(_composer, settingsService);\n    ServiceManager.setService(Organisation, this);\n    ServiceManager.setService(Building, this);\n    this._name = 'Organisation';\n    this._api_route = 'zones';\n    this.set('buildings', []);\n    this.set('active_building', null);\n    this._users.initialised.pipe(first((_) => _)).subscribe(() => this.init());\n  }\n\n  /**\n   * Add is not available on organisation service\n   */\n  public async add(form_data: HashMap, query_params?: HashMap): Promise<Organisation> {\n    throw new Error('Add is not available on the organisation service');\n  }\n\n  /**\n   * Update is not available on organisation service\n   */\n  public async update(\n    id: string,\n    form_data: HashMap,\n    query_params?: HashMap\n  ): Promise<Organisation> {\n    throw new Error('Update is not available on the organisation service');\n  }\n\n  /**\n   * Delete is not available on organisation service\n   */\n  public async delete(id: string): Promise<void> {\n    throw new Error('Delete is not available on the organisation service');\n  }\n\n  /**\n   * Get list of levels for the given building ID\n   * @param bld_id Building ID\n   */\n  public levels(bld_id: string): readonly BuildingLevel[] {\n    return (this.buildings.find((i) => i.id === bld_id) || ({} as Building)).levels;\n  }\n\n  /**\n   * Get a setting from the organisation or active building\n   * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n   */\n  public setting(key: string) {\n    return this.building.setting(key) || this._organisation.setting(key);\n  }\n\n  /** Active building */\n  public get building(): Building {\n    return this.buildings.find((i) => i.id === this._active_building);\n  }\n\n  /** List of types of spaces */\n  public get space_types(): Identity[] {\n    return this.get('space_types') || [];\n  }\n\n  public set building(bld: Building) {\n    if (bld instanceof Building) {\n      this._active_building = bld.id;\n    } else {\n      this._active_building = bld;\n    }\n    this.set('active_building', this.building);\n    this.loadSpaceTypes();\n    localStorage.setItem('PlaceOS.building', this._active_building);\n    localStorage.setItem('CONCIERGE.timezone', bld.timezone);\n  }\n\n  /** List of buildings for the organisation */\n  public get buildings(): Building[] {\n    return this.get<Building[]>('buildings') || [];\n  }\n\n  /**\n   * Get list of available equipment\n   * @param id ID of the building to get the list from. i.e. Defaults to the active building\n   */\n  public getExtras(id: string, bld_id?: string) {\n    const bld = this.buildings.find((i) => i.id === bld_id) || this.building;\n    if (bld && id) {\n      return bld.extras.filter((i) => `${i.id}`.indexOf(id) >= 0);\n    }\n    return [];\n  }\n\n  /**\n   * Get the first level matching the list of given IDs\n   * @param ids List of ID to search with\n   */\n  public levelWithID(ids: string | string[]): BuildingLevel {\n    const list = ids instanceof Array ? ids : [ids];\n    const bld_list = this.buildings;\n    for (const id of list) {\n      for (const bld of bld_list) {\n        for (const lvl of bld.levels) {\n          if (lvl.id === id) {\n            return lvl;\n          }\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Initialise service data\n   */\n  protected async load(): Promise<void> {\n    /* istanbul ignore else */\n    if (localStorage) {\n      this._active_building = localStorage.getItem(`${this.settingsService.frontend.toUpperCase()}.building`);\n    }\n    const loading: ApplicationLoadingState = this._service.get('loading') || {};\n    loading.organisation = { message: 'Loading organisation data', state: 'loading' };\n    await this.loadOrganisation();\n    loading.organisation = { message: 'Loading organisation data', state: 'complete' };\n    loading.buildings = { message: 'Loading building data', state: 'loading' };\n    this._service.set('loading', loading);\n    await this.loadBuildings();\n    loading.buildings = { message: 'Loading building data', state: 'complete' };\n    loading.levels = { message: 'Loading building floor data', state: 'loading' };\n    this._service.set('loading', loading);\n    await this.loadLevels();\n    loading.levels = { message: 'Loading building floor data', state: 'complete' };\n    this._service.set('loading', loading);\n    loading.space_types = { message: 'Loading space type data', state: 'loading' };\n    this._service.set('loading', loading);\n    await this.loadSpaceTypes();\n    loading.space_types = { message: 'Loading space type data', state: 'complete' };\n    this._service.set('loading', loading);\n    const user = this._users.current;\n\n    if (user) {\n      const id = localStorage.getItem('PlaceOS.building');\n      const building = this.buildings.find(bld => id && bld.id === id) || this.buildings.find((bld) => bld.code === user.location);\n      if (building) {\n        this._active_building = building.id;\n        this.set('active_building', building);\n      } else if(this.building) {\n        // This conditional solves a problem of infinite loop when user building doesn't exist.\n        this._active_building = this.building.id;\n        this.set('active_building', this.building);\n      }\n    }\n  }\n\n  /**\n   * Load organisation data for application\n   */\n  public async loadOrganisation(): Promise<Organisation> {\n    const org_data = await this.query({ tags: 'org', engine: true });\n    this._organisation = new Organisation(org_data[0]);\n    this.set('organisation', this._organisation);\n    return this._organisation;\n  }\n\n  /**\n   * Load building data for the organisation already stored in the service..\n   */\n  public async loadBuildings(): Promise<Building[]> {\n    return this.loadBuildingsWithOrg(this._organisation);\n  }\n\n  /**\n   * Load building data for the organisation passed.\n   */\n  public async loadBuildingsWithOrg(organisation: Organisation): Promise<Building[]> {\n    const bld_data = await this.query({ tags: 'building', engine: true, limit: 1000 });\n    const buildings = (bld_data as HashMap[])\n      .map((i) => new Building(i))\n      .filter((bld) => organisation.available_buildings.includes(bld.id));\n    this.set('buildings', buildings);\n    /* istanbul ignore else */\n    if (!this._active_building && buildings && buildings.length > 0) {\n      this._active_building = buildings[0].id;\n    }\n    return buildings;\n  }\n\n  /**\n   * Load level data for the buildings\n   */\n  public async loadLevels(): Promise<BuildingLevel[]> {\n    const lvl_data = await this.query({ tags: 'level', engine: true, limit: 1000 });\n    const levels = (lvl_data as HashMap[]).map((i) => new BuildingLevel(i));\n    this.set('levels', levels);\n    return levels;\n  }\n\n  /**\n   * Load space type data for the buildings\n   */\n  public async loadSpaceTypes(): Promise<void> {\n    const type_data = await this.query({ tags: 'room', engine: true, limit: 1000, building_id: this._active_building });\n    const types = (type_data as HashMap[]).map((i) => ({ id: i.id, name: i.name }));\n    this.set('space_types', types);\n    // Emit the updated space_types\n    this._spaceTypesSubject.next(types);\n  }\n\n    /**\n     * Observable to listen for changes in space_types\n     */\n    public get spaceTypesObservable(): Observable<Identity[]> {\n      return this._spaceTypesSubject.asObservable();\n    }\n\n  public getOrganizationFiltersByRoomType(key: string) {\n    if (!this._organisation) {\n      return {}\n    }\n    const discovery_info = this._organisation.setting('discovery_info')\n\n    return discovery_info && discovery_info[key] ? discovery_info[key] : {}\n  }\n\n  public getRoomTypeSubsetDDOptions(type:string) {\n    const filters = this.getOrganizationFiltersByRoomType(type) || {}\n    return [...Object.keys(filters).map((key) => {\n        const display = filters[key].toString();\n        return {\n            display,\n            value: key,\n            meta: {}\n        }\n    }) ];\n  }\n\n}\n","import { ComposerService } from '@placeos/composer';\nimport { BehaviorSubject, Observable, of, Subject, Subscriber } from 'rxjs';\n\nimport { BaseAPIService } from './base.service';\nimport { BaseClass, HashMap } from '@mckinsey-converge/base';\nimport { ApplicationService } from './app.service';\nimport { toQueryString } from './api.utilities';\nimport { SettingsService } from './settings.service';\nimport { catchError, map } from 'rxjs/operators';\n\nexport interface IEngineResponse {\n  results: HashMap[];\n  total: number;\n}\n\nexport class PaginatedAPIService<T extends {} = BaseAPIService> extends BaseClass {\n  /** Application service */\n  public parent: ApplicationService;\n  /** Display name of the service */\n  protected _name: string;\n  /** API Route of the service */\n  protected _api_route: string;\n  /** Map of state variables for Service */\n  protected _subjects: { [key: string]: BehaviorSubject<any> | Subject<any> } = {};\n  /** Map of observables for state variables */\n  protected _observers: { [key: string]: Observable<any> } = {};\n  /** Map of poll subscribers for API endpoints */\n  protected _subscribers: { [key: string]: Subscriber<any> } = {};\n  /** Map of promises for Service */\n  protected _promises: { [key: string]: Promise<any> } = {};\n  /** Comparison function for service items */\n  protected _compare: (a: T, b: T) => boolean = (a, b) =>\n    a === b || (a as any).id === (b as any).id;\n  /** Default filter function for list method */\n  protected _list_filter: (a: T) => boolean = (a) => !!a;\n\n  /** Http Client */\n  protected get http() {\n    return this._composer.http;\n  }\n\n  constructor(protected _composer: ComposerService,\n              protected settingsService: SettingsService) {\n    super();\n    this._name = 'Base';\n    this._api_route = 'base';\n    this.set('list', []);\n  }\n\n  /**\n   * Injects concierge into form_data.\n   */\n  private injectConcierge(form_data: HashMap) {\n      // we only send it over when concierge, since the BE may check for presence rather than\n      // if its true or not.\n      if (this.settingsService.concierge) {\n          return { ...form_data, concierge: true }\n      }\n      return form_data;\n  }\n\n  /**\n   * Initailise service\n   */\n  public init() {\n    this.load().then(\n      (_) => this._initialised.next(true),\n      (err) => this.timeout('init', () => this.init(), 1000)\n    );\n  }\n\n  /**\n   * Get API route for the service\n   * @param engine Whether endpoint is using the application API or engine API\n   */\n  public route(engine: boolean = false) {\n    const endpoint = engine\n      ? this._composer.auth.api_endpoint\n      : '/api/staff';\n    return `${endpoint}/${this._api_route}`;\n  }\n\n  /** API Route of the service */\n  public get api_route() {\n    return this._api_route;\n  }\n\n  /**\n   * Get the current value of the named property\n   * @param name Property name\n   */\n  public get<U = any>(name: string): U {\n    if (!this._observers[name]) {\n      this.set<U>(name, null);\n    }\n    return (this._subjects[name] as BehaviorSubject<U>).getValue();\n  }\n\n  /**\n   * Listen to value change of the named property\n   * @param name Property name\n   * @param next Callback for value changes\n   */\n  public listen<U = any>(name: string): Observable<U> {\n    if (!this._observers[name]) {\n      this.set<U>(name, null);\n    }\n    return this._observers[name];\n  }\n\n  /**\n   * Update the value of the named property\n   * @param name Property name\n   * @param value New value\n   */\n  protected set<U = any>(name: string, value: U): void {\n    if (!this._subjects[name]) {\n      this._subjects[name] = new BehaviorSubject<U>(value);\n      this._observers[name] = this._subjects[name].asObservable();\n    } else {\n      this._subjects[name].next(value);\n    }\n  }\n\n  /**\n   * Get list of loaded items\n   * @param predicate Function for filtering the list\n   */\n  public filter(predicate: (a: T) => boolean = this._list_filter): T[] {\n        const list: T[] = this.get('list');\n        return list.filter(predicate);\n  }\n\n  /**\n   * Get item with the given id from the loaded items\n   * @param id ID of the item\n   */\n  public find(id: string): T {\n    const list = this.get('list');\n    return list.find((i) => i.id === id || (i.email?.toLowerCase() === id?.toLowerCase()));\n  }\n\n  /**\n   * Query the index of the API route associated with this service\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public query(query_params: HashMap = {}, config: { url?: string } = {}): Promise<T> {\n    let engine = false;\n    let cache = 1000;\n    /* istanbul ignore else */\n    if (query_params) {\n      engine = !!query_params.engine;\n      delete query_params.engine;\n      cache = query_params.cache || 1000;\n      delete query_params.cache;\n    }\n    const query = toQueryString(query_params);\n    const key = `query|${query}`;\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise((resolve, reject) => {\n        const url = config && config.url ? `${config.url}${query ? '?' + query : ''}` : `${this.route(engine)}${query ? '?' + query : ''}`;\n        let result: IEngineResponse;\n        this.http.get(url).subscribe(\n          (d: IEngineResponse | HashMap[]) => {\n            if (d && d instanceof Array) {\n              const results = d.map((i) => this.process(i));\n              result = {\n                results,\n                total: results.length,\n              }\n            } else if (d && !(d instanceof Array) && d.results && d.total) {\n              const results = d.results.map((i) => this.process(i));\n              result = {\n                results,\n                total: d.total,\n              }\n            } else if (d && !(d instanceof Array) && d.results) {\n              const results = d.results.map((i) => this.process(i));\n              result = {\n                results,\n                total: results.length,\n              }\n            } else {\n              result = {\n                results: [],\n                total: 0,\n              }\n            }\n          },\n          (e) => {\n            reject(e);\n            this._promises[key] = null;\n          },\n          () => {\n            resolve(result);\n            this.timeout(key, () => (this._promises[key] = null), cache);\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n  /**\n   * \n   * @param query_params \n   * @param config \n   * @returns \n   */\n  queryHoldingBay(query_params: HashMap = {}, config: { url?: string } = {}):Observable<any> {\n    const query = toQueryString(query_params);\n    const url =  `${config.url}${query ? '?' + query : ''}`;\n    return this.http.get(url).pipe(\n      map((d: IEngineResponse | HashMap[]) =>  this.processApiResult(d) ),\n      catchError(<T>(error: any, result?: T) => {\n        console.log(error);\n        return of(result as T);\n        })\n    );\n  }\n\n  /**\n   * \n   * @param d \n   * @returns \n   */\n  processApiResult(d: IEngineResponse | HashMap[]): IEngineResponse{\n    let result: IEngineResponse;\n    if (d && d instanceof Array) {\n      const results = d.map((i) => this.process(i));\n      result = {\n        results,\n        total: results.length,\n      }\n    } else if (d && !(d instanceof Array) && d.results && d.total) {\n      const results = d.results.map((i) => this.process(i));\n      result = {\n        results,\n        total: d.total,\n      }\n    } else if (d && !(d instanceof Array) && d.results) {\n      const results = d.results.map((i) => this.process(i));\n      result = {\n        results,\n        total: results.length,\n      }\n    } else {\n      result = {\n        results: [],\n        total: 0,\n      }\n    }\n    return result;\n  }\n  \n\n  /**\n   * Query the API route for a sepecific item\n   * @param id ID of the item\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public show(id: string, query_params: HashMap = {}): Promise<T> {\n    let engine = false;\n    /* istanbul ignore else */\n    if (query_params) {\n      engine = !!query_params.engine;\n      delete query_params.engine;\n    }\n    const query = toQueryString(query_params);\n    const key = `show|${id}|${query}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<T>((resolve, reject) => {\n        const url = `${this.route(engine)}/${id}${query ? '?' + query : ''}`;\n        let result: T = null;\n        this.http.get(url).subscribe(\n          (d) => {\n            result = this.process(d);            \n          },\n          (e) => {\n            reject(e);\n            this._promises.new_item = null;\n          },\n          () => {\n            resolve(result);\n            this.timeout(key, () => (this._promises[key] = null), 1000);\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n  /**\n   * Make post request for a new item to the service\n   * @param form_data Data to post to the server\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public add(form_data: HashMap, query_params: HashMap = {}): Promise<T> {\n    /* istanbul ignore else */\n    if (!this._promises.new_item) {\n      this._promises.new_item = new Promise<T>((resolve, reject) => {\n        const query = toQueryString(query_params);\n        const url = `${this.route(query_params.engine)}${query ? '?' + query : ''}`;\n        let result: T = null;\n        this.http.post(url, this.injectConcierge(form_data)).subscribe(\n          (d) => (result = this.process(d)),\n          (e) => {\n            reject(e);\n            this.analyticsEvent(`create-${this._name.toLowerCase()}-failed`);\n            this._promises.new_item = null;\n          },\n          () => {\n            resolve(result);\n            this.set('list', this.updateList(this.get('list'), [result]));\n            this.analyticsEvent(`create-${this._name.toLowerCase()}-success`);\n            this._promises.new_item = null;\n          }\n        );\n      });\n    }\n    return this._promises.new_item;\n  }\n\n  /**\n   * Perform API task for the given item ID\n   * @param id ID of the item\n   * @param task_name Name of the task\n   * @param form_data Map of data to pass to the API\n   * @param method Verb to use for request\n   */\n  public task<U = any>(\n    id: string,\n    task_name: string,\n    form_data: HashMap = {},\n    method: 'post' | 'get' = 'post'\n  ): Promise<U> {\n    const query = toQueryString(this.injectConcierge(form_data));\n    const key = `task|${id}|${task_name}|${query}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<U>((resolve, reject) => {\n        const post_data = { ...form_data, id, _task: task_name };\n        const url = `${this.route(false)}/${id}/${task_name}`;\n        let result: any;\n        const request =\n          method === 'post'\n            ? this.http.post(url, post_data)\n            : this.http.get(`${url}${query ? '?' + query : ''}`);\n        request.subscribe(\n          (d) => (result = d),\n          (e) => {\n            reject(e);\n            this.analyticsEvent(\n              `${this._name.toLowerCase()}-task-${task_name}-failed`,\n              id\n            );\n            delete this._promises[key];\n          },\n          () => {\n            resolve(result as U);\n            this.analyticsEvent(\n              `${this._name.toLowerCase()}-task-${task_name}-success`,\n              id\n            );\n            this.timeout(key, () => delete this._promises[key], 1000);\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n\n  /**\n   * Make put request for changes to the item with the given id\n   * @param id ID of the item being updated\n   * @param form_data New values for the item\n   * @param query_params Map of query paramaters to add to the request URL\n   */\n  public update(id: string, form_data: HashMap, query_params: HashMap = {}): Promise<T> {\n    const key = `update|${id}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<T>((resolve, reject) => {\n        const query = toQueryString(this.injectConcierge(query_params));\n        const url = `${this.route(query_params.engine)}/${id}${query ? '?' + query : ''}`;\n        let result: T = null;\n        this.http.put(url, this.injectConcierge(form_data)).subscribe(\n          (d) => (result = this.process(d)),\n          (e) => {\n            reject(e);\n            this.analyticsEvent(`update-${this._name.toLowerCase()}-failed`, id);\n            this._promises[key] = null;\n          },\n          () => {\n            resolve(result);\n            this.set(\n              'list',\n              this.updateList(this.removeItem(this.get('list'), { id } as any), [\n                result\n              ])\n            );\n            this.analyticsEvent(`update-${this._name.toLowerCase()}-success`, id);\n            this._promises[key] = null;\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n  /**\n   * Make delete request for the given item\n   * @param id ID of item\n   */\n  public delete(id: string, q: HashMap = {}): Promise<void> {\n    const key = `delete|${id}`;\n    /* istanbul ignore else */\n    if (!this._promises[key]) {\n      this._promises[key] = new Promise<void>((resolve, reject) => {\n        const query = toQueryString(q);\n        const url = `${this.route()}/${id}${query ? '?' + query : ''}`;\n        this.http.delete(url).subscribe(\n          (_) => null,\n          (e) => {\n            reject(e);\n            this._promises[key] = null;\n          },\n          () => {\n            this.set('list', this.removeItem(this.get('list'), { id } as any));\n            this._promises[key] = null;\n            resolve();\n          }\n        );\n      });\n    }\n    return this._promises[key];\n  }\n\n  /**\n   * Load initial data for the service\n   */\n  protected async load(): Promise<void> {\n  }\n\n  /**\n   * Post analytics event for this service\n   * @param action Name of the action to post\n   */\n  protected analyticsEvent(action: string, label?: string) {\n    // if (this.parent && this.parent.Analytics) {\n    //     this.parent.Analytics.track(this._name, { desc: `${this.parent.name.toLowerCase()}-${action}`, label });\n    // }\n  }\n\n  /**\n   * Convert raw API data into a valid API Object\n   * @param raw_item Raw API data\n   */\n  protected process(raw_item: HashMap): T {\n    return raw_item as T;\n  }\n\n  /**\n   * Update recorded list of items\n   * @param old_list Old list of items\n   * @param list List of updated items\n   * @param compareFn Function to compare items to remove duplicates\n   */\n  public updateList(\n    old_list: T[],\n    list: T[],\n    compareFn: (a: T, b: T) => boolean = this._compare\n  ): T[] {\n    /* istanbul ignore else */\n    if (!list || list.length === 0) {\n      return old_list;\n    }\n    const new_list: T[] = [];\n    const mixed_list = [...list, ...old_list];\n    /* istanbul ignore else */\n    if (!compareFn) {\n      compareFn = this._compare;\n    }\n    for (const item of mixed_list) {\n      const found = new_list.find((i) => compareFn(i, item));\n      /* istanbul ignore else */\n      if (!found) {\n        new_list.push(item);\n      }\n    }\n    return new_list;\n  }\n\n  /**\n   * Remove the given item from the given list\n   * @param list List of items\n   * @param item Item to remove\n   * @param compareFn Function to compare items\n   */\n  protected removeItem(list: T[], item: T, compareFn?: (a: T, b: T) => boolean) {\n    const new_list = [];\n    /* istanbul ignore else */\n    if (!compareFn) {\n      compareFn = this._compare;\n    }\n    list.forEach((i) => (compareFn(item, i) ? null : new_list.push(i)));\n    return new_list;\n  }\n}\n","import { FormGroup } from \"@angular/forms\";\nimport { HashMap } from \"@mckinsey-converge/base\"\nimport { DateNow, DateTZ } from \"@mckinsey-converge/date-tz\"\n\nexport enum RecurrencePeriod {\n    LIST = 'list',\n    DAILY = 'daily',\n    WEEKLY = 'weekly',\n    //RELATIVE_MONTHLY = 'relativeMonthly', for the moment we will only support absoluteMonthly\n    ABSOLUTE_MONTHLY = 'monthly'\n}\n\nexport enum DaysOfWeek {\n    SUNDAY = 'sunday',\n    MONDAY = 'monday',\n    TUESDAY = 'tuesday',\n    WEDNESDAY = 'wednesday',\n    THURSDAY = 'thursday',\n    FRIDAY = 'friday',\n    SATURDAY = 'saturday'\n\n}\n\nexport enum SeriesAction {\n    EDIT = 'edit',\n    CLONE = 'clone'\n}\n\nexport enum BookingAction {\n    CLONE = 'booking_clone',\n    EDIT = 'booking_edit'\n}\n\nexport interface WeekDays {\n    id: string;\n    active: boolean;\n    day_index: number;\n    full_name: string;\n}\n\nexport interface RepeatPeriod {\n    id: RecurrencePeriod;\n    label: string\n}\n\nexport enum RepeatsOn {\n    PATTERN = 'pattern',\n    DATE = 'date'\n}\n\nexport interface RecurrenceType {\n    type: RepeatsOn;\n    label: string;\n}\n\nexport interface RecurrenceDetails {\n    period: RecurrencePeriod,\n    end: DateTZ,\n    list: Array<DateTZ>\n    interval: number\n}\n\nexport interface RecurrenceRecurringDetails extends RecurrenceDetails {\n    start: number\n}\n\nexport const recurrencePeriodToDurationType = (period: RecurrencePeriod) =>{\n    switch (period) {\n        case RecurrencePeriod.DAILY:\n            return 'days'\n        case RecurrencePeriod.WEEKLY:\n            return 'weeks' \n        case RecurrencePeriod.ABSOLUTE_MONTHLY:\n            return 'months' \n        default:\n            return 'days'\n    }\n}\n\n/**\n * Generate weekdays from monday to saturday\n */\nexport const generateWeekDays = (date: number, params: { building_tz?: string } = {}): Array<WeekDays>=> {\n    const { building_tz } = params;\n    let start_week = DateNow(new Date()).startOfValue('week').addValue({days : 1}); //set monday as start of week\n    const week_days: Array<WeekDays> = []\n    for (let i = 1; i <= 7; i++) {\n        const activeDate = new DateTZ({date, building_tz, is_local_tz: false })\n        const active = activeDate.dateWeekday === i\n        const full_name = start_week.formatDate('EEEE')\n        const day_index = i === 7 ? 0 : i //Sunday must be indexed as day 0\n        week_days.push({id: full_name.substring(0, 1), active, day_index, full_name: full_name.toLocaleLowerCase()});\n        start_week = start_week.addValue({ days : 1 });\n    }\n    return week_days\n}\n\nexport const getFirstDateFromList = (list: Array<DateTZ>) => {\n    return list.reduce((a, b) => { return a.isBeforeDate(b) ? a : b; });\n}\n\nexport const getLastDateFromList = (list: Array<DateTZ>) => {\n    return list.reduce((a, b) => { return a.isAfterDate(b) ? a : b; });\n}\n\nexport const recurrenceDetails = (recurr: RecurrenceDetails): string => {\n    const end = getLastDateFromList(recurr.list).formatDate('ccc dd MMM yyyy')\n    const getPeriod = (period: string) => {\n        if(recurr.interval === 1){\n            return `Occurs Every ${period} until ${end}`\n        }else{\n            return `Occurs Every ${recurr.interval} ${period}s until ${end}`\n        }\n    } \n    \n    switch (recurr.period) {\n        case RecurrencePeriod.DAILY:\n            return getPeriod('Day')\n        case RecurrencePeriod.WEEKLY:\n            return getPeriod('Week')\n        case RecurrencePeriod.ABSOLUTE_MONTHLY:\n            return getPeriod('Month')\n        case RecurrencePeriod.LIST:\n            return `Occurs on Specific Dates until ${getLastDateFromList(recurr.list).formatDate('ccc dd MMM yyyy')}`\n        default:\n            return ''\n    }\n}\n\nexport const recurrenceRecurringDetails = (recurr: RecurrenceRecurringDetails): string => {\n    const end = recurr.end\n    const start = new DateTZ({ date: recurr.start })\n\n    const getPeriod = (period: string) => {\n        if(recurr.interval === 1){\n            return `occurs every ${period} effective ${start.formatDate('dd MMM yyyy')} until ${end.formatDate('dd MMM yyyy')}`\n        }else{\n            return `occurs every ${recurr.interval} ${period}s effective ${start.formatDate('dd MMM yyyy')} until ${end.formatDate('dd MMM yyyy')}`\n        }\n    }\n\n    switch (recurr.period) {\n        case RecurrencePeriod.DAILY:\n            return getPeriod('Day')\n        case RecurrencePeriod.WEEKLY:\n            return getPeriod('Week')\n        case RecurrencePeriod.ABSOLUTE_MONTHLY:\n            return getPeriod('Month')\n        case RecurrencePeriod.LIST:\n            return `occurs on Specific Dates`\n        default:\n            return ''\n    }\n}\n\nexport const handleRecurrenceFields = (data: HashMap) => {\n    if(data.is_recurrent){\n        if(data.recurrence_period !== RecurrencePeriod.LIST){\n            delete data.recurrence_starts\n            delete data.recurrence_endTz\n            if(data.recurrence_period !== RecurrencePeriod.WEEKLY){\n                delete data.recurrence_days\n            }\n        } else if(data.recurrence_period){\n            data.recurrence_list = [...(data.recurrence_starts || []).map((date: DateTZ) => date.startOfValue('minute').seconds)]\n            delete data.recurrence_interval;\n            delete data.recurrence_endTz;\n            delete data.recurrence_count;\n            delete data.recurrence_starts\n            delete data.recurrence_days\n        }\n        delete data.is_recurrent\n    }else{\n        delete data.recurrence_period;\n        delete data.recurrence_interval;\n        delete data.recurrence_endTz;\n        delete data.recurrence_count;\n        delete data.recurrence_starts\n        delete data.is_recurrent\n        delete data.recurrence_exceptions\n        delete data.recurrence_days\n    }\n\n    return data\n}\n\n/** Removes expired occurrences and updates start and end dates when cloning a series */\nexport const removeExpiredOcurrences = (form: FormGroup) =>{\n    if(form.controls.action?.value === SeriesAction.CLONE ){\n        const tz = form.controls.space_list.value[0].timezone\n        const date_now = new DateTZ({ is_local_tz: false, building_tz: tz });\n        const occurrences = form.controls.recurrence_starts.value.filter((date: DateTZ) =>\n            date_now.isBeforeDate(date, 'day') || date_now.isSameDate(date, 'day')\n        )\n        form.controls.recurrence_starts.setValue(occurrences)\n        const { start, end } = setStartAndEndDateFromArray(occurrences, tz)\n        form.controls.dateTz.setValue(start)\n        form.controls.recurrence_endTz.setValue(end)\n    }\n}\n\n/** \n * Returns starts and end dates from an array of dates in milliseconds \n **/\n export const setStartAndEndDateFromArray = (dates: Array<DateTZ>, tz: string): {start: DateTZ, end: DateTZ} =>{\n    if(dates.length !== 0){\n        return {\n            start: dates.sort((d1, d2) => d1.ms - d2.ms)[0] ,\n            end: dates.sort((d1, d2) => d2.ms - d1.ms)[0]\n        }\n    }\n    //if the dates array is empty set the start and end dates as the current and next day\n    const now = DateNow(new Date()).toZone(tz)\n    return {start: now, end: now.addValue({days: 1})}\n}\n\nexport const setRecurrenceStartsTime = (form: FormGroup) => {\n    const { recurrence_starts, dateTz } = form.value\n    const list = (recurrence_starts || []).map((date: DateTZ) => date.setValue({hour: dateTz.dateHour, minute: dateTz.minutes}))\n    form.controls.recurrence_starts.setValue(list)\n}","export * from './report.class'\nexport * from './reports.service'\n","import { CurrencyPipe } from '@angular/common';\n\nimport {\n    csvToJson,\n    downloadFile,\n    HashMap,\n    humaniseDuration,\n    jsonToCsv,\n} from '@mckinsey-converge/base';\n\nimport { ServiceManager } from '../service-manager.class';\nimport { Space } from '../spaces';\nimport { Organisation } from '../organisation';\n\nexport class Report<T extends {} = HashMap> {\n    /** Type of report */\n    public readonly type: string;\n    /** List of data associated with the report */\n    public readonly data: T[];\n\n    constructor(raw_data: HashMap = {}) {\n        this.type = raw_data.type || '';\n        this.data = this.cleanData(raw_data.data);\n    }\n\n    /** Create report data structure from CSV */\n    public static fromCSV(type: string, data: string): Report {\n        const csv_json = csvToJson(data);\n        return new Report({ type, data: csv_json });\n    }\n\n    /** Download report data as CSV format */\n    public downloadCSV(name: string = 'unnamed.csv'): void {\n        downloadFile(name, jsonToCsv(this.data));\n    }\n\n    /** Download report data as JSON format */\n    public downloadJSON(name: string = 'unnamed.json'): void {\n        downloadFile(name, JSON.stringify(this.data, undefined, 4));\n    }\n\n    public formatCancelledBy(email: string) {\n        if (email !== null && email !== undefined) {\n            let name = email.split('@')[0];\n            name = name.split('_').join(' '); //get name from email and convert it to title case\n            name = name.replace(/\\w\\S*/g, function (txt) {\n                return `${txt\n                    .charAt(0)\n                    .toUpperCase()}${txt.substr(1).toLowerCase()}`;\n            });\n            return name;\n        } else {\n            return email;\n        }\n    }\n\n    public timeConverter( UNIX_timestamp: number ){\n        let a = new Date(UNIX_timestamp * 1000);\n        let months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n        let year = a.getFullYear();\n        let month = months[a.getMonth()];\n        let date = a.getDate();\n        let hour = ((a.getHours() + 11) % 12 + 1);\n        let suffix = a.getHours() >= 12 ? \"PM\":\"AM\";\n        let min = a.getMinutes();\n        let time = date + ' ' + month + ' ' + year + ' - ' + hour + ':' + min + ' ' + suffix;\n        return time;\n    }\n\n    private cleanData(data: T[] = []) {\n        if (data.length > 0 && this.type === 'day') {\n            for (let i = 0; i < data.length; i++) {\n                data[i]['booker'] = data[i]['booker'].name;\n                data[i]['expected_attendees'] = Object.values(data[i]['expected_attendees'])[0];\n            }\n        } else if (data.length > 0 && this.type === 'audit') {\n            for (let i = 0; i < data.length; i++) {\n                data[i]['created_at'] = this.timeConverter(data[i]['created_at']);\n            }\n        } else if (data.length > 0 && this.type === 'catering') {\n            for (let i = 0; i < data.length; i++) {\n                data[i]['Cancelled By'] = this.formatCancelledBy(\n                    data[i]['Cancelled By']\n                );\n            }\n            const fields = Object.keys(data[0]);\n            const room_field = fields.find(\n                (key) =>\n                    key.toLowerCase().includes('room') &&\n                    key.toLowerCase().includes('email')\n            );\n            const price_field = fields.find((key) =>\n                key.toLowerCase().includes('price')\n            );\n\n            for (let row of data) {\n                /* istanbul ignore else */\n                const space_service = ServiceManager.serviceFor(Space);\n                if (room_field && price_field && space_service) {\n                    const room = space_service.find(\n                        row[room_field].toLowerCase()\n                    );\n                    const org_service = ServiceManager.serviceFor(Organisation);\n                    const bld = org_service.buildings.find(\n                        (bld: { id: any }) =>\n                            bld.id === room?.level?.building_id\n                    );\n                    row[price_field] = new CurrencyPipe('en_us').transform(\n                        row[price_field] / 100,\n                        bld?.currency\n                    );\n                }\n                /* istanbul ignore else */\n                for (let field of fields) {\n                    row[field] =\n                        typeof row[field] === 'string'\n                            ? row[field].replace(/\\,/g, '')\n                            : row[field];\n                }\n            }\n        } else if (this.type === 'bookings') {\n            data = data.map((i: HashMap) => {\n                const booking = i;\n                try {\n                    if (booking.setup instanceof Object) {\n                        booking.setup = booking.setup[booking.room_email];\n                    }\n                    if (booking.breakdown instanceof Object) {\n                        booking.breakdown =\n                            booking.breakdown[booking.room_email];\n                    }\n                    booking.setup = humaniseDuration((booking.setup || 0) / 60);\n                    booking.breakdown = humaniseDuration(\n                        (booking.breakdown || 0) / 60\n                    );\n                    booking.description = (booking.description || '')\n                        .replace(/<[^>]*>?/gm, '')\n                        .replace(/\\,/g, '')\n                        .replace(/\\r?\\n|\\r/g, ' ');\n                    booking['Meeting Host'] =\n                        booking.organizer?.name || booking.organizer;\n                    booking['Booked By'] =\n                        booking.booked_by?.name ||\n                        booking.booked_by?.email ||\n                        '';\n                    booking.charge_code =\n                        booking.equipment_codes[booking.room_email] || '';\n                    //    booking.expected_attendees = Object.keys(booking.expected_attendees).map(key => booking.expected_attendees[key]).join(', ');\n                    booking.attendees = (booking.attendees || [])\n                        .map((person) => person.name || person.email || person)\n                        .join(' ');\n                    booking.notes = (booking.notes || [])\n                        .map((note) =>\n                            note.author &&\n                            (note.type === 'description' ||\n                                note.type === 'private')\n                                ? `[${note.author}|${note.type}]${note.message\n                                      .replace(/<[^>]*>?/gm, '')\n                                      .replace(/\\,/g, '')\n                                      .replace(/\\r?\\n|\\r/g, ' ')}`\n                                : ''\n                        )\n                        .join(' | ');\n                    booking.cancelled = booking.isCancelled;\n                    booking.status = booking.status[booking.room_email] || '';\n                    booking.company = booking.company.join(', ');\n                    if (booking.cancelled_by) {\n                        booking.cancelled_by = this.formatCancelledBy(\n                            booking.cancelled_by\n                        );\n                    }\n                    if (booking.isCancelled) {\n                        booking.cancelled_at_epoch = new Date(\n                            booking.cancelled_at_epoch * 1000\n                        ).toLocaleString();\n                    }\n                    booking.cancelled_date = booking.cancelled_at_epoch;\n                } catch (e) {}\n                const remove_fields = [\n                    'id',\n                    'icaluid',\n                    'accepted_at',\n                    'accepted_by',\n                    'check_ins',\n                    'changeKey',\n                    'created',\n                    'booking_type',\n                    'edit_history',\n                    'end_epoch',\n                    'old_attendees',\n                    'start_epoch',\n                    'expected_attendees',\n                    'isAllDay',\n                    'isCancelled',\n                    'body',\n                    'is_free',\n                    'lastModifiedDateTime',\n                    'locationType',\n                    'locations',\n                    'organizer',\n                    'booked_by',\n                    'originalEndTimeZone',\n                    'originalStartTimeZone',\n                    'room_booking_status',\n                    'room_email',\n                    'room_emails',\n                    'room_id',\n                    'sensitivity',\n                    'seriesMasterId',\n                    'show_as',\n                    'notes',\n                    'subject',\n                    'type',\n                    'previous_booking',\n                    'catering',\n                    'responseStatus',\n                    'equipment_codes',\n                    'cancelled_at_epoch',\n                ];\n                for (const field of remove_fields) {\n                    if (booking[field] !== undefined) {\n                        delete booking[field];\n                    }\n                }\n                const output = {};\n                const order = [\n                    'title',\n                    'start',\n                    'end',\n                    'location',\n                    'Meeting Host',\n                    'Booked By',\n                    'booked_at',\n                    'booked_ahead_by',\n                    'all_day',\n                    'attendees',\n                    'company',\n                    'description',\n                    'cancelled',\n                    'cancelled_by',\n                    'cancelled_date',\n                ];\n                const keys = Object.keys(booking);\n                keys.sort((a, b) => {\n                    const idx_a = order.indexOf(a);\n                    const idx_b = order.indexOf(b);\n                    return (\n                        (idx_a === -1 ? keys.length : idx_a) -\n                        (idx_b === -1 ? keys.length : idx_b)\n                    );\n                });\n                for (const key of keys) {\n                    output[key] = booking[key];\n                }\n                return output;\n            }) as any;\n        }\n        return data;\n    }\n}\n","import { Injectable } from '@angular/core';\n\nimport { ComposerService } from '@placeos/composer';\n\nimport { Report } from './report.class';\nimport { BaseAPIService } from '../base.service';\nimport { SettingsService } from '../settings.service';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class ReportsService extends BaseAPIService<Report> {\n    constructor(protected _composer: ComposerService,\n                settingsService: SettingsService) {\n        super(_composer, settingsService);\n        this._name = 'Reports';\n        this._api_route = 'reports';\n    }\n\n    protected process(raw_data: any): Report {\n        return raw_data instanceof Array\n            ? new Report({ data: raw_data })\n            : Report.fromCSV('', raw_data);\n    }\n}\n","import { Type } from '@angular/core';\nimport { Observable } from 'rxjs';\n\nimport { HashMap } from '@mckinsey-converge/base';\n\n\nexport interface ServiceLike<T = any> extends HashMap {\n    parent: any;\n    add: (_: HashMap) => Promise<T>;\n    update: (id: string, _: HashMap) => Promise<T>;\n    delete: (id: string, params?: HashMap) => Promise<void>;\n    task: (id: string, name: string, data: HashMap) => Promise<void>;\n    listen: <U = any>(prop: string) => Observable<U>;\n}\n\nexport interface ServiceProvider<T extends ServiceLike> {\n    provideFor: Type<any>;\n    useValue: T;\n}\n\nexport class ServiceManager {\n    /** Map of available services for child classes */\n    private static _service_list: ServiceProvider<any>[] = [];\n\n    /** Set the services used to handle data model requests */\n    public static setService(type: Type<any>, service: any): void {\n        if (window.debug) {\n            (window as any).ServiceManager = this._service_list;\n        }\n        const index = ServiceManager._service_list.findIndex(provider => provider.provideFor === type);\n        if (index >= 0) {\n            ServiceManager._service_list.splice(index, 1, { provideFor: type, useValue: service });\n        } else {\n            ServiceManager._service_list.push({ provideFor: type, useValue: service });\n        }\n    }\n\n    /** Get the services used to handle data model requests */\n    public static serviceFor(type: Type<any>): ServiceLike<any> {\n        const provider = ServiceManager._service_list.find(provider => provider.provideFor === type) || { useValue: null };\n        return provider.useValue;\n    }\n\n    constructor() {\n        throw new Error('ServiceMananger is static class');\n    }\n}\n","import {\n    Inject,\n    Injectable\n} from '@angular/core';\nimport { Title } from '@angular/platform-browser';\nimport {\n    BehaviorSubject,\n    Observable\n} from 'rxjs';\n\nimport { VERSION } from '@mckinsey-converge/environment';\nimport {\n    BaseClass,\n    getItemWithKeys,\n    HashMap,\n    log\n} from '@mckinsey-converge/base';\nimport { ServiceManager } from './service-manager.class';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\ndeclare global {\n    interface Window {\n        debug: boolean;\n    }\n}\n\nexport const SETTINGS_TOKEN = 'settings_service_data';\n\ntype SettingsAppData<T> = T & {\n    title: string;\n    description: string;\n    short_name: string;\n    logo_light: {\n        type: string;\n        src: string;\n        background: string;\n    }\n    logo_dark: {\n        type: string;\n        src: string;\n        background: string;\n    }\n    heap_io: {\n        app_id: number;\n        force_ssl: boolean;\n        secure_cookie: boolean;\n        disable_text_capture: boolean;\n        cookie_path: string;\n    }\n}\n\nexport interface SettingsData<TApp> {\n    debug: boolean;\n    mock: boolean;\n    frontend: 'staff' | 'concierge' | 'booking';\n    composer: {\n        domain: string;\n        route: string;\n        protocol: string;\n        port: string;\n        use_domain: boolean;\n        local_login: boolean;\n    }\n    app: SettingsAppData<TApp>;\n}\n\nexport class SettingsObject {\n    constructor(public data: SettingsData<any>) {\n    }\n}\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class SettingsService extends BaseClass {\n    /** Name of the application */\n    private _app_name = 'Converge';\n    /** List of override settings in order of priority */\n    private _overrides = new BehaviorSubject<HashMap[]>([]);\n    /** Mapping of behaviour subjects */\n    private _subjects: HashMap<BehaviorSubject<any>> = {};\n    /** Mapping of observables */\n    private _observables: HashMap<Observable<any>> = {};\n    /** Which frontend we're in. staff, concierge, or bookings **/\n    public readonly frontend: string;\n    private _bypass_bookings: boolean = false;\n\n    /**\n     * @hidden\n     */\n    public set overrides(value: HashMap[]) {\n        this._overrides.next(value);\n    }\n\n    /** Get observable for key */\n    public listen<T = any>(name: string): Observable<T> {\n        if (!this._observables[name]) {\n            this._subjects[name] = new BehaviorSubject<T>(null);\n            this._observables[name] = this._subjects[name].asObservable();\n        }\n        return this._observables[name];\n    }\n\n    /** Update observable value for key */\n    public post<T>(name: string, value: T): void {\n        if (!this._observables[name]) {\n            this._subjects[name] = new BehaviorSubject<T>(null);\n            this._observables[name] = this._subjects[name].asObservable();\n        }\n        this._subjects[name].next(value);\n    }\n\n    public value<T = any>(name: string): T {\n        return !this._observables[name] ? null : this._subjects[name].getValue();\n    }\n\n    /** Page title */\n    public get title() {\n        return this._title.getTitle();\n    }\n\n    public set title(value: string) {\n        this._title.setTitle(`${value} | ${this._app_name}`);\n    }\n\n    constructor(private _title: Title,\n                @Inject(SETTINGS_TOKEN)\n                private settings: SettingsObject) {\n        super();\n        ServiceManager.setService(SettingsService, this);\n        const time = new DateTZ({date: VERSION.time});\n        const built = DateNow(new Date()).isSameDate(time, 'day')\n            ? `Today at ${time.formatDate('h:mma')}`\n            : time.formatDate('do MMM yyyy, h:mma');\n        const frontend = this.get('frontend') || 'Unknown';\n        this.frontend = frontend;\n        log('CORE', `${VERSION.semver}`, null, 'debug', true, frontend?.toUpperCase());\n        log('APP', `${VERSION.hash} | Built: ${built}`, null, 'debug', true, frontend?.toUpperCase());\n        this.init();\n    }\n\n    /**\n     * Initialise the settings\n     */\n    public async init() {\n        if (this.get('debug')) {\n            window.debug = true;\n        }\n        if (this.get('app')?.name) {\n            this._app_name = this.get('app').name;\n        }\n        log('Settings', 'Successfully loaded settings');\n        this._initialised.next(true);\n    }\n\n    /** Whether settings service has initialised */\n    public get app_name() {\n        return this._app_name;\n    }\n\n    public get concierge() {\n        return this.frontend === 'concierge';\n    }\n\n    public set bypass_bookings(value: boolean) {\n        this._bypass_bookings = value;\n    }\n\n    public get bypass_bookings() {\n       return this._bypass_bookings;\n    }\n\n    /**\n     * Get a setting\n     * @param key Name of the setting. i.e. nested items can be grabbed using `.` to seperate key names\n     */\n    public get(key: string): any {\n        const keys = key.split('.');\n        if (keys[0] !== 'app') {\n            return getItemWithKeys(keys, this.settings.data);\n        }\n        const override_settings = this._overrides.getValue();\n        for (const override of override_settings) {\n            const value = getItemWithKeys(keys.slice(1), override);\n            if (value != null) {\n                return value;\n            }\n        }\n        return getItemWithKeys(keys, this.settings.data);\n    }\n}\n","export * from './space.class';\nexport * from './spaces.service';\nexport * from './space.utilities';\n","import { BaseDataClass } from '../base-api.class';\nimport {\n    HashMap,\n} from '@mckinsey-converge/base';\nimport {\n    Building,\n    BuildingLevel,\n    Organisation\n} from '../organisation';\nimport { User } from '../users';\nimport { ServiceManager } from '../service-manager.class';\nimport { SettingsService } from '../settings.service';\nimport { SpaceRules } from '../bookings/booking.types';\nimport { rulesForSpace } from '../bookings/space.utilities';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\nimport { DaysOfWeek, RecurrencePeriod } from '../recurrence/recurrence.utils';\nimport { DateTime } from 'luxon';\n\nexport interface ISpaceAvailabilityOptions {\n    /** Start date and time of the availability block */\n    dateTz?: DateTZ;\n    /** Length of the availability block */\n    duration: number;\n    /**  */\n    id?: string;\n    /** List of spaces to look at the availability for */\n    room_ids?: string;\n    /** Whether the spaces looked at should be bookable */\n    bookable?: boolean;\n    /** List of spaces or zones to ignore */\n    ignore?: string;\n    /** List of zones to look at the availability for */\n    zone_ids?: string | string[];\n    /** Whether space bookings should not be returned */\n    hide_bookings?: boolean;\n    /** Min capacity on the room **/\n    capacity?: number\n    clear?: boolean;\n    /** Length of the setup */\n    setup?: number;\n    /** Length of the breakdown */\n    breakdown?: number;\n    /** Hide declined bookings */\n    hide_declined?: boolean;\n    /** Max capacity on the room **/\n    capacity_max?: number\n\n    diff_capacity?: boolean\n\n    /** Fields to include recurrence in the availability search */\n    recurrence_period?: RecurrencePeriod;\n    recurrence_interval?: number;\n    recurrence_endTz?: DateTZ;\n    recurrence_count?: number;\n    recurrence_starts?: Array<DateTZ>\n    is_recurrent?: boolean\n    recurrence_days?: Array<DaysOfWeek>\n}\n\nexport interface SpaceBookingRuleOptions {\n    dateTz: DateTZ;\n    duration: number;\n    host: User;\n}\n\nexport const OPTION_DEFAULTS: ISpaceAvailabilityOptions = {\n    duration: 60\n};\n\nexport interface RecurrenceAvailability {\n    /** Unix epoch in seconds */\n    readonly date: number;\n    /** Whetehr space is available at this time */\n    readonly available: boolean;\n}\n\n/**\n * Room Settings Type\n *\n * Exmaple:\n * available: true\n * available_until: 1644344999\n * bookings: []\n * catering: false\n * charge_code: false\n * extra_features: \"meeting_room boardroom\"\n * internal_or_external: \"internal\"\n * map_id: \"08.8.15\"\n * natural_light: false\n * room_booking_screen: true\n * room_name: \"8.15 Meeting\"\n * vc: false\n * recurrence_availability: {\n *    date: \"1642596300\",\n *    available: false,\n * }\n */\nexport interface RoomSettings {\n    // Local room name is required.\n    room_name?: string\n    // TBD if anything else should be required\n    available?: boolean\n    available_until?: number\n    bookings?: HashMap[]\n    catering?: boolean\n    charge_code?: boolean\n    extra_features?: string\n    internal_or_external?: string\n    map_id?: string\n    natural_light?: boolean\n    room_booking_screen?: boolean\n    vc?: boolean\n    recurrence_availability?: RecurrenceAvailability[]\n    equipment_code?: boolean\n    external?: boolean\n}\n\n/**\n * List of space features that come from settings.\n *\n * Im sure this list will grow. It is not the most comprehensive list.\n */\nexport enum SpaceFeatures {\n    BoardRoom = 'boardroom',\n    Catering = 'catering',\n    CocktailRoom = 'cocktail',\n    ConferencePhone = 'conference_phone',\n    ConferenceRoom = 'conference',\n    ElectronicWhiteboard = 'whiteboard',\n    FlipChart = 'flipchart',\n    Glassboard = 'glassboard',\n    PartnerOffice = 'partner',\n    PhoneBooth = 'phone_booth',\n    TheatreRoom = 'theatre',\n    TeamRoom = 'team_room',\n    VideoConference = 'vc',\n    NaturalLight = 'natural_light',\n    WirelessContentSharing = 'wireless_content_sharing',\n    WorkshopRoom = 'workshop',\n    UShapeRoom = 'u_shape',\n    Miscellaneous = 'miscellaneous'\n}\n\nexport enum SpaceEquipments {\n    conference_phone,\n    whiteboard,\n    vc,\n    flipchart,\n    glassboard,\n    wireless_content_sharing\n}\nexport enum SpaceStyles {\n    boardroom,\n    cocktail,\n    conference,\n    partner,\n    theatre,\n    team_room,\n    // natural_light,\n    workshop,\n    u_shape,\n    miscellaneous\n}\n\nconst EMPTY_ARRAY = [];\n\nexport class Space extends BaseDataClass {\n    /** Whether space can be booked by users */\n    public readonly bookable: boolean;\n    /** People capacity of the space */\n    public readonly capacity: number;\n    /** Index to force order when sorting multiple spaces */\n    public readonly sort_priority: number;\n    /** Settings has extensive info displayed in the app. */\n    public readonly settings: RoomSettings;\n    /** URL for the control interface of the space */\n    public readonly support_url: string;\n    /** Engine zones associated with the space */\n    public readonly zones: readonly string[];\n    /** Is the Application concierge */\n    public is_concierge: boolean = false;\n    /** To allow bookings with rooms for staff calendar view only */\n    public allowStaffRoomWithBookings: boolean = false;\n\n    /** Simple name == local name being using in seeting.room_name\n\t\t *\n\t\t*/\n    public simple_name: string;\n\n    /** Room style set of all room style one room has\n    * [\"boardroom\", \"cocktail\", \"miscellaneous\", \"natural_light\", \"theatre\", \"u-shape\", \"workshop\"]   */\n    public room_style: string[] = [];\n\n    /** Equipment set of all room equipment one room has\n    * [\"conference_phone\", \"whiteboard\", \"vc\", \"flipchart\", \"glassboard\", \"whiteboard\", \"wireless_content_sharing\"] */\n    public equipment: string[] = [];\n\n    /** Filters has charge code settings for booking and catering */\n    public filters: RoomSettings;\n\n    /** room_type subset of internal or external rooms */\n    public room_type: string[] | string;\n    /**\n     * Features used in identifying room types.\n     *\n     * Both features and extra_features are space delimited strings.\n     *\n     * There is a getter featuresArray that returns the\n     * combination of the two as an array.\n     */\n    public readonly features: string;\n    public readonly extra_features: string;\n    public map_id: string;\n\n\n    /** Service for managing spaces */\n    protected get _service() {\n        return ServiceManager.serviceFor(Building);\n    }\n\n    /** Return the rooms' building */\n    public get building() {\n        return this._service?.buildings.find((bld) => {\n            return this.zones.includes(bld.id);\n        });\n    }\n\n    /** Return building timezone */\n    public get timezone() {\n        return this.building?.timezone;\n    }\n\n    constructor(raw_data: HashMap = {}) {\n        super(raw_data);\n\n        // Needed to check if the current app is Concierge or Staff\n        const settingsService = ServiceManager.serviceFor(SettingsService) as unknown as SettingsService;\n        this.is_concierge = !!settingsService?.concierge;\n        this.allowStaffRoomWithBookings = settingsService?.bypass_bookings || false;\n\n        const defaultGlobalName = raw_data.name || raw_data.email || 'Meeting Room';\n        const defaultSettings = {\n            room_name: defaultGlobalName\n        }\n        /**\n         * Duplicate of base-api.class just for readability\n         * .name is the full, mckinsey standardised name of the room.\n         * You can think of it was what people would call the room when\n         * considering every office and room globally.\n         *\n         * this.name = raw_data.name;\n         */\n        /**\n         * Settings has extensive info displayed in the app.\n         * setting.room_name is always used when displaying the room name in the applications\n         * setting.room_name is the more office-specific room name, you can think of this as\n         * the one people in that office would refer to the room as.\n         *\n         */\n        this.settings = raw_data.settings || defaultSettings;\n        this.filters = raw_data?.filters;\n        // Room fields\n        this.bookable = raw_data.bookable || false;\n        this.capacity = raw_data.capacity || 0;\n        this.support_url = raw_data.support_url;\n        this.zones = raw_data.zones instanceof Array ? raw_data.zones : [];\n        // Feature fields\n        this.features = raw_data.features || '';\n        this.extra_features = raw_data.settings?.extra_features || '';\n\n\t\tthis.room_type = raw_data?.room_type;\n        this.simple_name = raw_data?.simple_name;\n        this.map_id = raw_data?.map_id || raw_data.settings?.map_id || '';\n        this.room_style = raw_data?.room_style || [];\n        this.equipment = raw_data?.equipment || [];\n\n    }\n\n    /**\n     * Return the global room name\n     * IE LDN-4-408-06\n     */\n    public get global_name(): string {\n        return this.name || ''\n    }\n\n    /**\n     * Return the local room name\n     * i.e. 4.08\n     * TO DO: ROOM-DATA-STRUCTURE-REFACTOR - stop using/remove seetings.room_name\n     */\n    public get local_name(): string {\n        return this.simple_name || this.name || ''; // this.settings?.room_name\n    }\n\n    public get street_and_city(): string {\n        return this.building ? `${this.building.address}, ${this.building.city}` : '';\n    }\n\n    /**\n     * Return the map_id from settings\n     * TO DO: ROOM-DATA-STRUCTURE-REFACTOR - stop using/remove seetings.map_id and use map_id from space modal( after testing over prod)\n     */\n    // public get map_id(): string {\n    //     return this?.map_id || this.settings?.map_id || '';\n    // }\n\n    /** Internal / External status */\n    public get internal_or_external(): string {\n        const  external  = this.filters?.external;\n        return external ? 'external' : 'internal'; // ( external ? 'external' : this.settings?.internal_or_external ) || 'internal';\n    }\n\n    /**\n     * Works in conjunction with available_until.\n     *\n     * If a room is bookable that only means you can make a booking but not when.\n     * Available indicates that is is available to be booked durring the queried times.\n     */\n    public get available(): boolean {\n        return this.settings?.available ?? false;\n    }\n\n    public get currently_in_use(): boolean {\n        const nowMs = new DateTZ({ date: DateTime.now(), is_local_tz: false, building_tz: this.timezone }).ms;\n        const runningBookings = this.settings?.bookings?.filter( bks => {\n            const startEpoch = new DateTZ({ date: bks.start_epoch * 1000, is_local_tz: false, building_tz: bks.timezone}).ms;\n            const endEpoch = new DateTZ({ date: bks.end_epoch * 1000, is_local_tz: false, building_tz: bks.timezone}).ms;\n             return startEpoch <= nowMs && endEpoch >= nowMs;\n        })\n        // console.log(raw_data.settings.room_name+' : '+ nowMs.ms);\n        // console.log('IS IN USER CURRENTLY : ', isinUsernow);\n        return !!runningBookings.length;\n    }\n\n    /** Last returned availability time */\n    public get available_until(): number {\n        return this.settings?.available_until;\n    }\n\n    /** Bookings associated with the space */\n    public get bookings(): HashMap[] {\n        // We should need to care if a room as bookings in Staff\n        if (!this.is_concierge && !this.allowStaffRoomWithBookings) {\n            return EMPTY_ARRAY;\n        }\n\n        if (this.settings?.bookings?.length) {\n            /**\n             * When we're dealing with Concierge the API data arriving is rooms, and those rooms contain booking,\n             * but those bookings don't contain a room since the room is the root.\n             * In order for Concierge to filter bookings by room we need to reattach this room\n             * to each of the bookings, with it's own bookings.\n             *\n             * It's loopy and kooky but correcting for this pattern is beyond the scope of this refactor.\n             */\n            const spaceWithBookings =  new Space(this.toJSON());\n            return this.settings?.bookings.map(b => {\n                b.room = spaceWithBookings;\n                return b;\n            });\n        }\n        return EMPTY_ARRAY;\n    }\n\n    /**\n\t\t * Whether space has catering\n     * TO DO: ROOM-DATA-STRUCTURE-REFACTOR - stop using/remove seetings.catering and use filters?.catering instead\n\t\t */\n    public get has_catering(): boolean {\n        return this.filters?.catering || this.settings?.catering || false;\n    }\n\n     /** Returns an array of the space delimited feature and extra_feature strings.\n     * TO DO: ROOM-DATA-STRUCTURE-REFACTOR - stop using/remove features, extra_features\n     */\n    public get featuresArray(): (SpaceFeatures | string)[] {\n        // (this.simple_name === \"Entresol M-06\" ) && console.log('raw_data : ', this)\n        const roomType = Array.isArray(this.room_type) ?  this.room_type : [this.room_type]\n        const features = [\n                ...this.features.split(' '),\n                ...this.extra_features?.split(' '),\n\n                ...roomType, // required to work with staff>result>filters\n                ...this?.room_style,\n                ...this?.equipment,\n\n                (this.filters?.natural_light) && SpaceFeatures.NaturalLight || undefined,       // || this.settings?.natural_light\n                // this.settings?.natural_light && SpaceFeatures.NaturalLight || undefined,\n                // this.settings?.vc && SpaceFeatures.VideoConference || undefined,\n            ].filter(f => !!f).map(f => f.toLowerCase());\n        //will be an array... new Set() turns it into a set, but [... ] turns it back into an array again\n        return [ ...new Set(features) ];\n    }\n\n    /** Level in which the space is associated */\n    public get level(): BuildingLevel {\n        const service = ServiceManager.serviceFor(Organisation);\n        return (service ? service.levelWithID(this.zones as any) : null) || new BuildingLevel({});\n    }\n\n    /**\n     * Return the new recurrence_availability from settings\n     */\n    public get recurrence_availability(): RecurrenceAvailability[] {\n        return this.settings?.recurrence_availability || [];\n    }\n\n    public get availableOccurrences(): number {\n        if(this?.recurrence_availability) {\n            return this?.recurrence_availability?.filter(recurr => recurr.available).length;\n        }\n    }\n\n    public get totalOccurrences(): number {\n        return this?.recurrence_availability.length;\n    }\n\n    /**\n     * Make a copy of this object\n     */\n    public clone(): Space {\n        return new Space(this);\n    }\n\n    /**\n     * Make a copy of this object without identification data\n     */\n    public duplicate(): Space {\n        const space = { ...this };\n        space.settings.bookings = []; // clear out bookings\n        return new Space({ ...space, id: null, email: null });\n    }\n\n    /**\n     * Generate the booking rules for space with given options\n     * @param options Conditions for generating the space rules\n     */\n    public rulesFor(options: SpaceBookingRuleOptions): SpaceRules {\n        if (!this._service || !this.level) {\n            return { auto_approve: true, hide: false };\n        }\n\n        const building = this.is_concierge ? this.level.building_id : this.building\n\n        if (!building) {\n            return { auto_approve: true, hide: false };\n        }\n        const { dateTz, duration, host } = options;\n        const rules: SpaceRules = rulesForSpace({\n            time: dateTz.ms,\n            duration,\n            space: this,\n            user: host,\n            rules: building.booking_rules\n        });\n        return rules;\n    }\n\n    /**\n     * Whether space can only be booked by request\n     * @param options Conditions for checking the space rules\n     */\n    public byRequest(options: SpaceBookingRuleOptions) {\n        const rules = this.rulesFor(options);\n        return !rules.auto_approve;\n    }\n\n    /**\n     * Convert object into plain object\n     */\n    public toJSON(this: Space): HashMap {\n        return { ...super.toJSON(), settings: { ...this.settings, bookings: [] }, filters: { ...this.filters }, equipment: [ ...this.equipment] };\n    }\n}\n","import { HashMap } from '@mckinsey-converge/base';\nimport {\n    ISpaceAvailabilityOptions,\n    Space\n} from './space.class';\nimport { Building } from '../organisation/building.class';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\nimport { handleRecurrenceFields, RecurrencePeriod } from '../recurrence/recurrence.utils';\n\nexport function availabilityOptionsToQuery(options: ISpaceAvailabilityOptions): HashMap {\n    let query: HashMap = {};\n    if (options) {\n        query = { ...options };\n        if (options.dateTz) {\n            const date = options.dateTz.startOfValue('minute');\n            query.available_from = date.seconds; // Add one second or API will not allow end to end booking\n            query.available_to = date.addValue({ minutes: options.duration || 60 }).subtractValue({ seconds: 1 }).seconds;\n\n            if (options.setup) query.setup = options.setup ;\n            if (options.breakdown) query.breakdown = options.breakdown;\n \n            delete query.dateTz;\n            delete query.duration;\n        }\n\n        if (!options.capacity_max) delete query.capacity_max\n\n        if (options.hide_declined) query.hide_declined = options.hide_declined;\n        query = handleRecurrenceFields(query)\n    }\n    return query;\n}\n\n/**\n * Compare two spaces to determine order\n * @param first\n * @param second\n */\nexport function sort(first: Space, second: Space, blds: Building[] = []) {\n    const bld = blds.find(bld => first.zones.includes(bld.id));\n    const bld_b = blds.find(bld => second.zones.includes(bld.id));\n    if (bld) {\n        if (bld !== bld_b) {\n            return (bld.name).localeCompare(bld_b?.name);\n        }\n        const sort_order = [...bld.sort_order].reverse();\n        for (const zone_id of sort_order) {\n            if (zone_id === '*') {\n                continue;\n            }\n            const a_has_zone = first.zones.indexOf(zone_id) >= 0;\n            const b_has_zone = second.zones.indexOf(zone_id) >= 0;\n            if (a_has_zone && !b_has_zone) {\n                return 1;\n            } else if (b_has_zone && !a_has_zone) {\n                return -1;\n            }\n        }\n    }\n    return first.name.localeCompare(second.name);\n}\n","import { Injectable } from '@angular/core';\nimport { ComposerService } from '@placeos/composer';\nimport { first } from 'rxjs/operators';\n\nimport { BaseAPIService } from '../base.service';\nimport { ISpaceAvailabilityOptions, Space } from './space.class';\nimport { ApplicationLoadingState, HashMap } from '@mckinsey-converge/base';\nimport { availabilityOptionsToQuery } from './space.utilities';\nimport { ServiceManager } from '../service-manager.class';\nimport { OrganisationService } from '../organisation';\nimport { ApplicationService } from '../app.service';\nimport { SettingsService } from '../settings.service';\nimport { DateNow } from '@mckinsey-converge/date-tz';\nimport { Observable } from 'rxjs';\nimport { HttpClient } from '@angular/common/http';\n\nlet SPACE_LIST = [];\n\nexport function findSpace(id: string) {\n    return SPACE_LIST.find((_) => _.id === id || _.email === id);\n}\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class SpacesService extends BaseAPIService<Space> {\n    constructor(\n        protected _composer: ComposerService,\n        private _org: OrganisationService,\n        private _service: ApplicationService,\n        settingsService: SettingsService\n    ) {\n        \n        super(_composer, settingsService);\n        ServiceManager.setService(Space, this);\n        this._name = 'Space';\n        this._api_route = 'rooms';\n        this._compare = (a, b) =>\n            !a.id.localeCompare(b.id) || !a.email.localeCompare(b.email);\n        this._list_filter = (a: Space) => {\n            const bld = this._org.building;\n            return a.level.building_id === bld.id;\n        };\n        this._org.initialised\n            .pipe(first((_) => _))\n            .subscribe(() => this.init());\n    }\n\n    public async query(query: HashMap = {}, setList:boolean = false) {\n        const list = await super.query(query);\n        if ( (query.hasOwnProperty('cache') && query.cache === false) || !Object.keys(query).length || setList) {\n            this.set('list', list);\n            SPACE_LIST = list;\n        }\n        return list;\n    }\n\n    public filterAvailableSpaces(list: Space[]) {\n        return list.filter((i) => {\n            if (i.recurrence_availability?.length) return i; //if recurrence, send the space regardless of availability (needed for edit and cloning series)\n            return i.available;\n        });\n    }\n\n    /**\n     * Get available spaces\n     * @param options\n     */\n    public available(\n        options: ISpaceAvailabilityOptions,\n        uniqueId?: string,\n        filter: boolean = true\n    ): Promise<Space[]> {\n        if (!options) {\n            throw new Error('Space avilability requires request options');\n        }\n\n        const now = DateNow(new Date());\n        if (!options.dateTz) {\n            options.dateTz = now.startOfValue('minute');\n        }\n\n        if (options.hide_declined === undefined) {\n            options.hide_declined = true;\n        }\n\n        const key = `available|${options.id ? options.id : ''}|${\n            uniqueId ?? ''\n        }`;\n        if (!this._promises[key]) {\n            this._promises[key] = new Promise((resolve, reject) => {\n                const respond = (list: Space[]) => {\n                    delete this._promises[key];\n                    resolve(filter ? this.filterAvailableSpaces(list) : list);\n                };\n                const error = (e) => {\n                    reject(e);\n                    delete this._promises[key];\n                };\n                const query = availabilityOptionsToQuery(options);\n                if (options.id) {\n                    this.show(options.id, query).then(\n                        (i) => respond([i]),\n                        error\n                    );\n                } else {\n                    this.query(query).then(respond, error);\n                }\n            });\n        }\n\n        return this._promises[key];\n    }\n\n    /**\n     * Load initial data for the service\n     */\n    protected async load(): Promise<void> {\n        const loading: ApplicationLoadingState =\n            this._service.get('loading') || {};\n        if (!loading.spaces) {\n            loading.spaces = {\n                message: 'Loading space data',\n                state: 'loading',\n            };\n            this._service.set('loading', loading);\n        }\n        // Adjusted the query by incorporating the \"zone_ids\" option to filter rooms based on specific zone IDs instead of considering all thousands of rooms.\n        const option = {\n            zone_ids: this._org.building.id\n        }\n        await this.query(option, true).catch(() => {\n            loading.spaces = { message: 'Loading space data', state: 'failed' };\n            this._service.set('loading', loading);\n        });\n        loading.spaces = { message: 'Loading space data', state: 'complete' };\n        this._service.set('loading', loading);\n    }\n\n    /**\n     * Convert raw data into API object\n     * @param raw_data Raw API data\n     */\n    public process(raw_data: HashMap): Space {\n        return new Space(raw_data);\n    }\n    /**\n     * \n     * Special observable function to make http call for rooms\n     * @param query \n     * @returns observable\n     */\n    public queryRooms = (query: HashMap = {}): Observable<HashMap> => super.queryRoomsForQR(query);\n\n    public setSpaceList(list) {\n        this.set('list', list);\n        SPACE_LIST = list;\n    }\n\n    public queryBooking = (query: HashMap = {}) : Observable<Space[]> | Observable<any>  => super.queryObsr(query);\n    public updateSpace = (id: string, form_data: HashMap, should_inject_concierge: Boolean = false, query_params: HashMap = {}) : Observable<Space[]> | Observable<any>  => super.updateObsr(id, form_data, should_inject_concierge, query_params);\n    public uploadSpacePhotos = (apiSubRoute: string, form_data: HashMap, should_inject_concierge: Boolean = false, query_params: HashMap = {}) : Observable<any> | Observable<any>  => super.uploadSpacePhotos(apiSubRoute, form_data, should_inject_concierge, query_params);\n    \n    public updateRoomList() {\n        this.load().then((_) => null)\n    }\n}\n","import {\n    BehaviorSubject,\n    of\n} from 'rxjs';\nimport {\n    Building,\n    Organisation\n} from './organisation';\nimport { BaseDataClass } from './base-api.class';\nimport { MapLocation } from './location';\nimport { User } from './users';\nimport { Booking } from './bookings';\nimport {\n    RoomSettings,\n    Space,\n    SpaceFeatures\n} from './spaces';\nimport { ServiceManager } from './service-manager.class';\nimport {\n    CateringCategory,\n    CateringItem\n} from './catering';\nimport {\n    HashMap,\n    padZero,\n    predictableRandomInt,\n    unique\n} from '@mckinsey-converge/base';\n\nimport * as faker from 'faker';\n\nimport {\n    SETTINGS_TOKEN,\n    SettingsData,\n    SettingsObject,\n    SettingsService\n} from './settings.service';\nimport { Report } from './reports';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\nfaker.seed(2560);\n\nlet SERVICE: any;\n\ndeclare global {\n    interface Jest {\n        fn: () => any\n    }\n}\n\n\ndeclare let jest: Jest;\n\n/* istanbul ignore file */\n\nexport function generateMockOrganisationService(): HashMap {\n    return {\n        levelWithID: jest.fn(),\n        listen: jest.fn(),\n        loadOrganisation: jest.fn(),\n        initialised: of(true),\n        building: new Building(generateMockBuilding({ id: 'bld-01' })),\n        loadBuildingsWithOrg: jest.fn(),\n        getOrganizationFiltersByRoomType: jest.fn(),\n        getRoomTypeSubsetDDOptions: jest.fn(),\n        ...generateMockDataService('OrganisationService')\n    };\n}\n\nexport const generateMockSpacesService = (): HashMap => ({\n    available: jest.fn(),\n    ...generateMockDataService('SpacesService')\n});\n\nexport const generateMockUsersService = (): HashMap => ({\n    loadCurrentUser: jest.fn(),\n    ...generateMockDataService('UsersService')\n});\n\nexport const bookingState = () => ({\n    bookings: of([]),\n    filtered: of([]),\n    filtered_week: of([]),\n    filtered_month: of([]),\n    setZone: jest.fn(),\n    setDate: jest.fn(),\n    setFilters: jest.fn(),\n    add: jest.fn(),\n    replace: jest.fn(),\n    remove: jest.fn(),\n    startPolling: jest.fn(),\n    startPollingMonth: jest.fn(),\n    startPollingWeek: jest.fn(),\n    startPollingEveryFiveMin: jest.fn(),\n    _noOfMeetings: of([])\n});\n\nconst test_app = {\n    title: 'McKinsey & Company',\n    description: 'McKinsey & Company Staff UI written with Angular Framework',\n    short_name: 'STAFF',\n    logo_light: {\n        type: 'img',\n        src: 'assets/img/logo.svg',\n        background: ''\n    },\n    logo_dark: {\n        type: 'img',\n        src: 'assets/img/logo-inverse.svg',\n        background: ''\n    },\n    heap_io: {\n        app_id: 3540602199,\n        force_ssl: true,\n        secure_cookie: true,\n        disable_text_capture: true,\n        cookie_path: '/staff/'\n    }\n};\n\nexport const TEST_SETTINGS: SettingsData<typeof test_app> = {\n    debug: true,\n    composer: {\n        domain: '',\n        route: '/test',\n        protocol: '',\n        port: '',\n        use_domain: false,\n        local_login: false\n    },\n    app: test_app,\n    mock: false,\n    frontend: 'staff'\n};\n\nexport const generateMockSettingsService = (overrides: Partial<SettingsData<any>> = {}) => new SettingsService({ getTitle: () => jest.fn() } as any,\n    new SettingsObject({\n        ...TEST_SETTINGS,\n        ...overrides\n    }));\n\n/**\n * Provides an injectable instance for settings.\n */\nexport const provideMockSettingsObject = (settings: Partial<SettingsData<any>> = {}) => ({\n    provide: SETTINGS_TOKEN,\n    useValue: new SettingsObject({\n        ...TEST_SETTINGS,\n        ...settings\n    })\n});\n\n/**\n * Generate a mocked version of the application service\n */\nexport function generateMockAppService(settingsOverrides: Partial<SettingsData<any>> = {}) {\n    SERVICE = {\n        setting: jest.fn(),\n        notify: jest.fn(),\n        notifyInfo: jest.fn(),\n        notifyWarn: jest.fn(),\n        notifySuccess: jest.fn(),\n        notifyError: jest.fn(),\n        log: jest.fn(),\n        navigate: jest.fn(),\n        navigateBack: jest.fn(),\n        get: jest.fn(),\n        listen: jest.fn(),\n        set: jest.fn(),\n        Composer: { auth: { token: 'test' } },\n        Hotkeys: { listen: jest.fn() },\n        Users: generateMockUsersService(),\n        Organisation: generateMockOrganisationService(),\n        Locations: generateMockDataService('LocationsService'),\n        Base: generateMockDataService('BaseService'),\n        Menu: generateMockDataService('CateringMenuService'),\n        Spaces: generateMockSpacesService(),\n        Bookings: generateMockDataService('BookingsService'),\n        Reports: generateMockDataService('ReportsService'),\n        CateringItems: generateMockDataService('CateringItemsService'),\n        CateringCategories: generateMockDataService('CateringCategoriesService'),\n        Settings: generateMockSettingsService(settingsOverrides),\n        initialised: of(true)\n    };\n    ServiceManager.setService(BaseDataClass, SERVICE.Base);\n    ServiceManager.setService(Organisation, SERVICE.Organisation);\n    ServiceManager.setService(Building, SERVICE.Organisation);\n    ServiceManager.setService(User, SERVICE.Users);\n    ServiceManager.setService(Booking, SERVICE.Bookings);\n    ServiceManager.setService(Space, SERVICE.Spaces);\n    ServiceManager.setService(MapLocation, SERVICE.Locations);\n    ServiceManager.setService(Report, SERVICE.Reports);\n    ServiceManager.setService(CateringItem, SERVICE.CateringItems);\n    ServiceManager.setService(CateringCategory, SERVICE.CateringCategories);\n    SERVICE.Organisation.buildings = [SERVICE.Organisation.building];\n    SERVICE.Users.current = new User(generateMockUser());\n    SERVICE.Users.initialised = of(true);\n    SERVICE.Bookings.booking_list = new BehaviorSubject(new Array(10).fill(0).map(_ => new Booking(generateMockBooking())));\n    SERVICE.listen.mockReturnValue(of(null, []));\n    return SERVICE;\n}\n\nexport function generateMockDataService(name: string) {\n    const service = {\n        find: jest.fn(),\n        filter: jest.fn(),\n        listen: jest.fn(),\n        get: jest.fn(),\n        set: jest.fn(),\n        setting: jest.fn(),\n        query: jest.fn(),\n        show: jest.fn(),\n        add: jest.fn(),\n        save: jest.fn(),\n        remove: jest.fn(),\n        delete: jest.fn(),\n        update: jest.fn(),\n        addFrom: jest.fn(),\n        removeFrom: jest.fn(),\n        task: jest.fn(),\n        available: jest.fn(),\n        process: jest.fn(),\n        updateList: jest.fn(),\n        clearList: jest.fn(),\n        removeFromList: jest.fn(),\n        accept: jest.fn(),\n        decline: jest.fn(),\n        checkin: jest.fn(),\n        is_logged_in: false,\n        initialised: of(true),\n        getHoldingBay: jest.fn(),\n        name,\n        queryRooms: of(true),\n        queryRoomsForQR: of([]),\n        queryObsr: of([]),\n        queryBooking: of(true),\n        checkinIndividualVisitor: jest.fn(),\n        taskObsr: of(true),\n        updateSpace: jest.fn(),\n        updateObsr: of([]),\n        uploadSpacePhotos: of([])\n\n    };\n\n    service.getHoldingBay.mockImplementation(_ => Promise.resolve([new Booking({})]));\n    service.save.mockImplementation(_ => Promise.resolve(new Booking({})));\n\n    service.listen.mockReturnValue(of(null));\n    service.filter.mockReturnValue([]);\n    return service;\n}\n\nlet SPACE_COUNT: number = 0;\n\nexport function generateMinimalRoomDetails(count: number) {\n    return {\n        name: `space-0${count}`,\n        email: `space-0${count}@test.com`,\n        settings: {\n            name: `localname-0${count}`,\n            catering: true\n        }\n    }\n}\n\nexport function generateMockSpace(overrides: HashMap = {}, space_id: number = null, recurring_search: boolean = false ): Space {\n    const id = `space-${space_id || SPACE_COUNT++}`;\n    const name = overrides.name || `${faker.name} ${faker.name.lastName()} Space`;\n    const startOfDay = DateNow(new Date()).startOfValue('day');\n    let settings: RoomSettings = {\n        available: true,\n        available_until: startOfDay.addValue({ days: 1 }).seconds, // (Date.now() / 1000) + (60 * 60 * 24), // now plus 24 hrs\n        bookings: Array(10).fill(0).map(i => generateMockBooking()),\n        catering: true,\n        charge_code: true,\n        extra_features: \"meeting_room boardroom\",\n        internal_or_external: \"internal\",\n        map_id: \"1\",\n        natural_light: false,\n        room_booking_screen: true,\n        room_name: `${name} - Local Name`,\n        vc: false,\n    }\n    if (overrides.settings) {\n        settings = { ...settings, ...overrides.settings };\n        delete overrides.settings;\n    }\n    if (recurring_search) {\n        settings.recurrence_availability = [\n            {\n                date: startOfDay.seconds,\n                available: false,\n            },\n            {\n                date: startOfDay.addValue({ days: 1 }).seconds,\n                available: false,\n            },\n            {\n                date: startOfDay.addValue({ days: 2 }).seconds,\n                available: false,\n            },\n            {\n                date: startOfDay.addValue({ days: 3 }).seconds,\n                available: false,\n            },\n        ]\n    }\n\n    const linked = Math.floor(predictableRandomInt(99999)) % 2 === 0 && SPACE_COUNT > 1;\n    return new Space({\n        id,\n        name: `${name} - Global Name`,\n        map_id: `${space_id || SPACE_COUNT}`,\n        type: faker.commerce.productName(),\n        searchable: Math.floor(predictableRandomInt(99999)) % 2 === 0,\n        controlable: Math.floor(predictableRandomInt(99999)) % 2 === 0,\n        hourly_rate: Math.floor(predictableRandomInt(300)) * 100,\n        bookable: Math.floor(predictableRandomInt(99999)) % 2 === 0,\n        capacity: 15,\n        sort_priority: 0,\n        setup: Math.floor(predictableRandomInt(6)) * 5,\n        breakdown: Math.floor(predictableRandomInt(6)) * 5,\n        support_url: `/control/#/${id}`,\n        image: faker.image.business(),\n        zones: ['zone_lvl-0'],\n        features: `${SpaceFeatures.BoardRoom} ${SpaceFeatures.ElectronicWhiteboard}`,\n        email: `${name.toLowerCase().split(' ').join('.')}@${USER_DOMAIN}`,\n        settings,\n        ...overrides\n    });\n}\n\nlet BOOKING_COUNT = 0;\nlet BOOKING_DATE =  DateNow(new Date()).setValue({ hour: 6 }).setValue({minute: 0}).subtractValue({ days: 10 }).startOfValue('minute');\n\n/**\n * Set the initial time used for generating mock bookings\n * @param time New initial time as ms from UTC epoch\n */\nexport function setMockBookingStartDatetime(time: number) {\n    const date = new DateTZ({date: time})\n    BOOKING_DATE = date.startOfValue('minute');\n}\n\n/**\n * Create mock raw API data for a booking\n * @param override Overrides the properties of the generated booking with it's own\n */\nexport function generateMockBooking(override: HashMap = {}) {\n    const id = `booking-${BOOKING_COUNT++}`;\n    BOOKING_DATE = BOOKING_DATE.addValue({ minutes: Math.floor(predictableRandomInt(4) + 2) * 15 });\n    const start = BOOKING_DATE.ms;\n    const duration = Math.floor(predictableRandomInt(4) + 2) * 15;\n    BOOKING_DATE = BOOKING_DATE.addValue({ minutes: Math.floor(predictableRandomInt(4)) * 15 });\n    const organiser = generateMockUser({ external: false, visitor: false });\n    const orders = Array(Math.floor(predictableRandomInt(5)))\n        .fill(0)\n        .map(_ => generateMockCateringOrder({ booking_date: start }, override.room_ids, override.menu));\n    const hasCatering = Math.floor(predictableRandomInt(34567)) % 3 === 0;\n    const date_start = new DateTZ({date: start})\n    return {\n        id,\n        title: `${faker.commerce.productName()} Meeting`,\n        attendees: Array(Math.floor(predictableRandomInt(5) + 2))\n            .fill(0)\n            .map((_, i) => generateMockUser(override.users)),\n        organiser,\n        start_epoch: date_start.seconds,\n        end_epoch: date_start.addValue({ minutes: duration }).seconds,\n        body: faker.lorem.paragraph(),\n        notes: [{ type: 'other', message: faker.lorem.paragraph() }],\n        location: faker.address.city(),\n        // Mckinsey only has internal or external meetings\n        booking_type: ['internal', 'external'][predictableRandomInt(2)],\n        setup: { 'space-01': Math.max(0, (predictableRandomInt(12) - 6) * 5) },\n        breakdown: { 'space-01': Math.max(0, (predictableRandomInt(12) - 6) * 5) },\n        status: 'accepted',\n        catering: hasCatering ? orders : [],\n        room: new Space(generateMinimalRoomDetails(1)), // returns space-01 type values\n        equipment_codes: {},\n        company:[],\n        ...override\n    };\n}\n\nlet BLD_COUNT = 0;\nlet LVL_COUNT = 0;\n\n/**\n * Generate raw mock data for creating a building\n * @param id Forced ID for the mock\n * @param overrides Supply object value overrides in place. Supports a levelGenerator function\n * to stabilize level ids for testing.\n */\nexport function generateMockBuilding(overrides: HashMap = {}): HashMap {\n    const id = `zone_bld-${BLD_COUNT++}`;\n    const levels = Array(10)\n        .fill(0)\n        .map((_, i) => generateMockLevel(undefined, overrides.levelGenerator?.(i)));\n    const features: any = {};\n    for (const lvl of levels) {\n        const count = Math.floor(predictableRandomInt(3) + 2);\n        features[lvl.level_id] = {};\n        for (let i = 0; i < count; i++) {\n            features[lvl.level_id][faker.commerce.productName()] = `feature-${i + 1}`;\n        }\n    }\n    return {\n        id,\n        zone_id: id,\n        extras: Array(10)\n            .fill(0)\n            .map(i => {\n                const name = faker.commerce.productName();\n                return {\n                    extra_id: name\n                        .split(' ')\n                        .join('-')\n                        .toLowerCase(),\n                    extra_name: name\n                };\n            }),\n        code: 'NYO',\n        name: faker.name.firstName(),\n        address: 'building address field',\n        city: 'building city',\n        loan_items: Array(10)\n            .fill(0)\n            .map(i => {\n                const name = faker.commerce.productName();\n                return {\n                    extra_id: name\n                        .split(' ')\n                        .join('-')\n                        .toLowerCase(),\n                    extra_name: name\n                };\n            }),\n        levels,\n        roles: {\n            'first-aiders': Array(10)\n                .fill(0)\n                .map(i => generateMockUser())\n        },\n        neighbourhoods: features,\n        settings: {\n            test: {\n                nested: {\n                    level2: true,\n                    org: false\n                }\n            },\n            city: faker.address.city()\n        },\n        timezone: 'America/Chicago',\n        ...overrides\n    };\n}\n\n/**\n * Generate raw mock data for a building level\n * @param id Forced ID for the mock\n * @param overrides value overrides\n */\nexport function generateMockLevel(id?: string, overrides: HashMap = {}): HashMap {\n    if (!id) {\n        id = `zone_lvl-${LVL_COUNT++}`;\n    }\n    return {\n        id,\n        level_id: id,\n        level_name: `Level ${LVL_COUNT}`,\n        short_name: `L ${LVL_COUNT}`,\n        ...overrides\n    };\n}\n\nlet USER_COUNT = 0;\n\nexport let USER_DOMAIN = 'acaprojects.com';\n\nconst USER_EMAILS: string[] = [];\n\n/**\n * Generate raw mock data for a user\n * @param id Forced ID for the mock\n * @param name Forced name for the user\n * @param external Whether user is external of the organisation\n */\nexport function generateMockUser(override: HashMap = {}): HashMap {\n    const id = `user-${USER_COUNT++}`;\n    const name = `${faker.name.firstName()} ${faker.name.lastName()}`;\n    const external = override.external || !(predictableRandomInt(99999) % 2);\n    const organisation = external ? faker.company.companyName() : USER_DOMAIN.split('.')[0];\n    let delegates: {email: string, opt_out: boolean}[] = [];\n    const delegate_count = Math.min(predictableRandomInt(4) + 1, USER_EMAILS.length);\n    for (let i = 0; i < delegate_count; i++) {\n        delegates.push({email: USER_EMAILS[Math.floor(predictableRandomInt(USER_EMAILS.length))], opt_out: false});\n    }\n    delegates = unique(delegates);\n    const email = `${name\n        .split(' ')\n        .join('.')\n        .toLowerCase()}@${external ? 'not-' : ''}${USER_DOMAIN}`;\n    USER_EMAILS.push(email);\n    return {\n        id,\n        name,\n        first_name: name.split(' ')[0],\n        last_name: name.split(' ')[1],\n        email,\n        phone: faker.phone.phoneNumber(),\n        visitor: external,\n        organisation: {\n            id: organisation\n                .split(' ')\n                .join('.')\n                .toLowerCase(),\n            name: organisation\n        },\n        department: faker.commerce.department(),\n        staff_code: padZero(Math.floor(predictableRandomInt(99999)), 5),\n        delegates,\n        image: faker.image.avatar(),\n        ...override\n    };\n}\n\nexport function generateMockCateringOrder(overrides: HashMap = {}, room_id: string = '', menu: HashMap<HashMap[]> = {}) {\n    return {\n        id: `order-${predictableRandomInt(9999_9999)}`,\n        delivery_time: predictableRandomInt(6) * 5,\n        location_id: room_id, // R--- could be undefined\n        items: new Array(predictableRandomInt(5, 1)).fill(0).map(i => pickMenuItem(menu)),\n        ...overrides\n    };\n}\n\nfunction pickMenuItem(menu_map: HashMap<HashMap[]> = {}) {\n    const zones = Object.keys(menu_map);\n    const menu = menu_map[zones[predictableRandomInt(zones.length)]] || [];\n    const category = menu[predictableRandomInt(menu.length)] || { items: [] };\n    const group = { ...(category.items[predictableRandomInt(category.items.length)] || {}) };\n    if (!group.package && group.items?.length) {\n        const item = { ...group.items[predictableRandomInt(group.items.length)] };\n        item.amount = predictableRandomInt(5, 1);\n        return item;\n    }\n    group.amount = predictableRandomInt(5, 1);\n    return group;\n}\n\nexport function generateMockLocation(overrides: HashMap, fixed_locations: string[], maps: string[]): HashMap {\n    const fixed = predictableRandomInt(999_999_999) % 2 === 0;\n    if (fixed && (!overrides || overrides.fixed)) {\n        return {\n            map_id: fixed_locations[predictableRandomInt(fixed_locations.length)],\n            level: maps[predictableRandomInt(maps.length)],\n            ...overrides\n        };\n    } else {\n        return {\n            x: predictableRandomInt(900, 100),\n            x_max: 1000,\n            y: predictableRandomInt(500, 100),\n            level: maps[predictableRandomInt(maps.length)],\n            confidence: predictableRandomInt(30),\n            ...overrides\n        };\n    }\n}\n\nlet ORG_COUNT = 0;\n\nexport function generateMockOrganisation(): HashMap {\n    const buildings = Array(3).fill(0).map(i => generateMockBuilding());\n    return {\n        id: `zone_org-${ORG_COUNT++}`,\n        name: `Organisation ${ORG_COUNT}`,\n        buildings,\n        settings: {\n            discovery_info: {\n                buildings\n            },\n            test: {\n                nested: {\n                    org: true\n                }\n            }\n        }\n    };\n}\n\n\nexport const generateMockBuildingSetByCity = () => {\n    const buildings: Building[] = Array(10).fill(0)\n        .map(() => new Building(generateMockBuilding()));\n    buildings.push(...Array(2).fill(0).map(() => new Building(generateMockBuilding({\n        settings: {\n            city: 'Auckland'\n        },\n        city: 'Auckland'\n    }))));\n    buildings.push(...Array(5).fill(0).map(() => new Building(generateMockBuilding({\n        settings: {\n            city: 'NYC'\n        },\n        city: 'NYC'\n    }))));\n    return buildings;\n};\n\nexport function generateMockModalData(data: HashMap<any> = null) : HashMap  {\n    if (data) {\n        return data;\n    }\n    return {\n        pendingDate: new Date(1603087100 + (1000 * 60 * 15)),\n        pendingDuration: 60,\n        date: 1603087100,\n        duration: 30,\n    }\n}\n\nexport const mockDateToBuildingTz = (date?: number) =>{\n    return new DateTZ({date, building_tz: 'America/Chicago', is_local_tz: false})\n}","export * from './user.class'\nexport * from './user.utilities'\nexport * from './users.service'\n","import { BaseDataClass } from '../base-api.class';\nimport {\n  HashMap,\n  Identity\n} from '@mckinsey-converge/base';\nimport { MapLocation } from '../location';\nimport { ServiceManager } from '../service-manager.class';\n\nexport class User extends BaseDataClass {\n  \n  /** Currently logged in user */\n  public static get active_user(): User {\n    const service = ServiceManager.serviceFor(User);\n    return service ? service.current : null;\n  }\n\n  /** First name of the user */\n  public readonly first_name: string;\n  /** Last name of the user */\n  public readonly last_name: string;\n  /** Windows user ID */\n  public readonly windows_id: string;\n  /** FMNO */\n  public readonly fmno: string;\n  /** Type of user */\n  public readonly type: 'partner' | 'external' | 'internal';\n  /** Contact phone number of the user */\n  public readonly phone: string;\n  /** Organisational department the user is part of */\n  public readonly business_unit: string;\n  /** Whether user is external from the application's organisation */\n  public readonly external: boolean;\n  /** Whether user is a visitor */\n  public readonly visitor: boolean;\n  /** Organisational Identifier for the user */\n  public readonly staff_code: string;\n  /** Basic location descriptor for the user */\n  public readonly location: string;\n  /** List of users that this user can act on behalf */\n  public readonly delegates: readonly {email: string, opt_out: boolean}[];\n  /** URL of the user's avatar image */\n  public readonly image: string;\n  /** List of user groups associated with this user */\n  public readonly groups: readonly string[];\n  /** Organisation the user is associated with */\n  private _organisation: Identity;\n\n  /** Map location of the user */\n  private _location: MapLocation;\n  /** List of desk bookings */\n  // private _desk_bookings: HashMap = {}; // R--- can't explain why this is here.\n  /** Host/Organisawe email notification opt out/in setting */\n  public opt_out: boolean;\n\n  constructor(raw_data: HashMap = {}) {\n    super(raw_data);\n    this.first_name = raw_data.first_name || '';\n    this.last_name = raw_data.last_name || '';\n    this.windows_id = raw_data.email || '';\n    this.fmno = raw_data.fmno;\n    this.external = raw_data.external || false;\n    this.visitor = raw_data.visitor || false;\n\n\n    this.type = this.visitor ? 'external' : 'internal';\n    this.phone = raw_data.phone || raw_data.mobile || '';\n    this.business_unit = raw_data.business_unit || raw_data.department || '';\n    this._organisation = raw_data.organisation || {\n      id: raw_data.organisation_id,\n      name: raw_data.organisation_name\n    };\n\n    this._location = null;\n    this.image = raw_data.image || '';\n    this.staff_code = raw_data.staff_code || raw_data.fmno || '';\n    this.delegates = raw_data.delegates || [];\n    this._location = new MapLocation(\n      raw_data.location && raw_data.location instanceof Object\n        ? raw_data.location\n        : { name: raw_data.location }\n    );\n    this.groups = raw_data.groups || [];\n    this.location = raw_data.location || raw_data.officeLocation || '';\n    this.opt_out = raw_data.opt_out;\n  }\n\n  /** Organisation the user is associated with */\n  public get organisation() {\n    return this._organisation;\n  }\n\n  /** Map location of the user */\n  public get last_location(): MapLocation {\n    return new MapLocation(this._location || {});\n  }\n\n  /**\n   * Ask the server for the users current location\n   */\n  public locate(): Promise<MapLocation> {\n    const service: any = ServiceManager.serviceFor(MapLocation);\n    return new Promise((resolve, reject) => {\n      if (service) {\n        service.show(this.id, { desk: this.email }).then(\n          l => {\n            this._location = l;\n            resolve(l);\n          },\n          e => reject(e)\n        );\n      } else {\n        resolve(null);\n      }\n    });\n  }\n\n  /**\n   * Whether user is available during the given period\n   * @param start Start time as a unix timestamp with milliseconds\n   * @param end End time as a unix timestamp with milliseconds\n   */\n  public available(start?: number, end?: number): Promise<boolean> {\n    return new Promise<boolean>(resolve => {\n      this._service.query({ email: this.email, start, end }).then(\n        l => resolve(l && l.length > 0),\n        _ => resolve(false)\n      );\n    });\n  }\n\n  /**\n   * Make a copy of this object\n   */\n  public clone(): User {\n    return new User(this);\n  }\n\n  /**\n   * Make a copy of this object without identification data\n   */\n  public duplicate(): User {\n    return new User({ ...this, id: null, email: null });\n  }\n\n  /**\n   * Convert object into plain object\n   */\n  public toJSON(this: User): HashMap {\n    const data = super.toJSON();\n    delete data.location;\n    return data;\n  }\n}\n\n// R--- Might need an toApiJSON due to visitor field.","import {\n  FormControl,\n  FormGroup,\n  Validators\n} from '@angular/forms';\n\nimport { HashMap } from '@mckinsey-converge/base';\nimport { User } from './user.class';\n\n/**\n * Generate form fields for the given user\n * @param user User to generate form for\n */\nexport function generateUserForm(user: User): FormGroup {\n  if (!user) {\n    throw Error('No user passed');\n  }\n  const fields: HashMap<FormControl> = {\n    id: new FormControl(user.id || ''),\n    name: new FormControl(user.name || ''),\n    first_name: new FormControl(user.first_name || '', [Validators.required, Validators.pattern(/^(?![\\d\\s]+$)[^\\d]+$/), Validators.maxLength(50)]),\n    last_name: new FormControl(user.last_name || '', [Validators.required, Validators.pattern(/^(?![\\d\\s]+$)[^\\d]+$/), Validators.maxLength(50)]),\n    email: new FormControl(user.email || '', [Validators.email])\n  };\n  // Generate form group for booking item\n    return new FormGroup(fields);\n}\n","import { Injectable } from '@angular/core';\nimport { Location } from '@angular/common';\nimport {\n    HttpClient,\n    HttpHeaders\n} from '@angular/common/http';\nimport { ComposerService } from '@placeos/composer';\nimport { first } from 'rxjs/operators';\n\nimport { Md5 } from 'ts-md5/dist/md5';\n\nimport { BaseAPIService } from '../base.service';\nimport { User } from './user.class';\nimport {\n    ApplicationLoadingState,\n    HashMap,\n    unique\n} from '@mckinsey-converge/base';\n\nimport { ApplicationService } from '../app.service';\nimport { ServiceManager } from '../service-manager.class';\nimport { SettingsService } from '../settings.service';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\nexport interface ILoginOptions {\n    /** URL to post login request to */\n    url?: string;\n    /** Whether form data is passed in the body of the request */\n    form?: boolean;\n    /** Custom headers to pass into the post request */\n    headers?: HashMap<string>;\n}\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class UsersService extends BaseAPIService<User> {\n    constructor(\n        protected _composer: ComposerService,\n        protected uhttp: HttpClient,\n        protected location: Location,\n        private _service: ApplicationService,\n        settingsService: SettingsService\n    ) {\n        super(_composer, settingsService);\n        ServiceManager.setService(User, this);\n        this._name = 'Users';\n        this._api_route = 'users';\n        this._compare = (a, b) => !a.id.localeCompare(b.id) || !a.email.localeCompare(b.email);\n        this.set('list', []);\n        this.set('current_user', new User({ id: 'local_user', name: 'Local User' }));\n        this.set('delegates', null);\n        this._composer.initialised.pipe(first((_) => _)).subscribe(() => this.init());\n    }\n\n    /** Currently logged in user */\n    public get current(): User {\n        return this.get('current_user');\n    }\n\n    /** Whether the user has properly logged in */\n    public get is_logged_in(): boolean {\n        return this.current && this.current.id !== 'local_user';\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Sets the access token and expiry for the user\n     * @param token OAuth bearer token\n     * @param expiry Expiry epoch timestamp in ms\n     * @param reload Whether to reload the page after setting tokens\n     */\n    public setToken(token: string, expiry?: number, reload: boolean = true) {\n        if (!expiry) {\n            const now = DateNow(new Date())\n            expiry = now.addValue({ days: 7 }).endOfValue('day').ms;\n        }\n        const path = `${location.origin}${\n            this._service.setting('composer.route') || ''\n        }/oauth-resp.html`;\n        const client_id = Md5.hashStr(path);\n        if (sessionStorage) {\n            sessionStorage.setItem(`${client_id}_access_token`, token);\n            sessionStorage.setItem(`${client_id}_expires_at`, `${expiry}`);\n        }\n        if (localStorage) {\n            localStorage.setItem(`${client_id}_access_token`, token);\n            localStorage.setItem(`${client_id}_expires_at`, `${expiry}`);\n        }\n        if (reload) {\n            this.location.go(this.location.path());\n        }\n        return path;\n    }\n\n    /**\n     * Post login request to the API\n     * @param query_params Key value pairs to pass into\n     * @param options Options for the login request\n     */\n    public async login(query_params: HashMap, options: ILoginOptions = {}): Promise<void> {\n        if (this.settingsService.concierge) {\n            if (!this._promises['login']) {\n                this._promises['login'] = new Promise<void>((resolve, reject) => {\n                    this.set('status', 'loading');\n                    let headers = new HttpHeaders();\n                    if (!options || options.form !== false) {\n                        headers = headers.append('Content-Type', 'application/x-www-form-urlencoded');\n                    }\n                    const url = (options ? options.url : '') || '/auth/signin';\n                    this.uhttp.post(url, query_params, { headers }).subscribe(\n                        (_) => null,\n                        (e) => reject(e),\n                        () => {\n                            this._composer.auth.authorise();\n                            resolve();\n                        }\n                    );\n                });\n            }\n            return this._promises['login'];\n        }\n    }\n\n\n    /**\n     * Logout of user and redirect to logout URL\n     */\n    public logout() {\n        this._composer.auth.logout();\n    }\n\n    /**\n     * Loads current user from API. This diverges from {@link load} in order to simply return\n     * the user object instead of setting it on the service.\n     */\n    public async loadCurrentUser(): Promise<User> {\n        return this.show('current')\n    }\n\n    /**\n     * Load initial data for the service\n     */\n    protected load(tries: number = 0): Promise<void> {\n        const loading: ApplicationLoadingState = this._service.get('loading') || {};\n        loading.user = { message: 'Loading user credentials', state: 'loading' };\n        this._service.set('loading', loading);\n        this.set('status', 'loading');\n        return new Promise<void>((resolve) => {\n            // this is due to unclear nature of the merge between concierge and staff\n            // concierge has the retries enabled, while staff continuously retries.\n            if (this.settingsService.concierge && tries > 4) {\n                this.set('status', 'invalid');\n                loading.user = { message: 'Loading user credentials', state: 'failed' };\n                this._service.set('loading', loading);\n                return resolve();\n            }\n            this.show('current').then(\n                async (current_user) => {\n                    this.set('status', 'available');\n                    this.set('current_user', current_user);\n                    this._initialised.next(true);\n                    if (this._service && this._service.setting('app.user.grab_api_details')) {\n                        this.show(current_user.email).then(\n                            async (user) => {\n                                this.set('current_user', user);\n                                if (this._service.setting('app.user.update_location')) {\n                                    this.interval('location', () => user.locate(), 5000);\n                                }\n                                await this.loadDelegates().catch(_ => null);\n                                resolve();\n                                loading.user = {\n                                    message: 'Loading user credentials',\n                                    state: 'complete'\n                                };\n                                this._service.set('loading', loading);\n                            },\n                            () => this.timeout('load', () => this.load(++tries).then(() => resolve()), Math.min(3000, 300 * tries))\n                        );\n                    } else {\n                        \n                        // is after process\n                        if (this._service.setting('app.user.update_location')) {\n                            this.interval('location', () => current_user.locate(), 5000);\n                        }\n                        await this.loadDelegates().catch(_ => null);\n                        resolve();\n                        loading.user = { message: 'Loading user credentials', state: 'complete' };\n                        this._service.set('loading', loading);\n                    }\n                },\n                () => this.timeout('load', () => this.load(++tries).then(() => resolve()), Math.min(3000, 300 * tries))\n            );\n        });\n    }\n\n    private async loadDelegates() {\n        const delegates = this.current.delegates;\n        if (!delegates || !delegates.length) {\n            return [];\n        }\n        const promises: Promise<User>[] = [];\n        for (const del of delegates) {\n            promises.push(this.show(del.email));\n        }\n        const list = await Promise.all(promises);\n        this.set('delegates', list);\n        this.set('list', unique((this.get('list') || []).concat(list)));\n        return list;\n    }\n\n    /**\n     * Convert raw API data into a valid User Object\n     * @param raw_item Raw API data\n     */\n    protected process(raw_data: any): User {\n        return new User(raw_data);\n    }\n}","import { AbstractControl } from '@angular/forms';\n\nimport { User } from './users';\n\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n\nconst HAS_ERROR = true;\n\n/**\n * Build start time validation function\n * @param date Date of the time to check\n */\nexport function buildValidateDate(date?: number) {\n  const from = new DateTZ({ date });\n  return (c) => validateDate(c, date);\n}\n\n/**\n * Check that control value is a date that is the same or after from date\n * @param control Angular form control\n * @param is_from Comparison date(ms from UTC epoch). Defaults to the current time\n */\nexport function validateDate(control: AbstractControl, is_from?: number) {\n  const from = new DateTZ({date: is_from})\n  const date = new DateTZ({date: control.value})\n  return date.isBeforeDate(from) ? { date: HAS_ERROR, message: 'Booking needs to be made in the future' } : null;\n}\n\n/**\n * Build start time validation function\n * @param date Date of the time to check\n * @param is_from Comparison date(ms from UTC epoch). Defaults to the current time\n */\nexport function buildValidateStartTime(date: number, is_from?: number) {\n  const from = new DateTZ({date: is_from})\n  return (c) => validateStartTime(c, date, from.ms);\n}\n\n/**\n * Check that control value time is after the comparison date time\n * @param control Angular form control\n * @param date Date of the time to check\n * @param is_from Comparison date(ms from UTC epoch). Defaults to the current time\n */\nexport function validateStartTime(control: AbstractControl, date: number, is_from?: number) {\n  const now = new DateTZ({date: is_from});\n  const parts = control.value.split(':');\n  const date_obj = new DateTZ({date});\n  return date_obj.setValue({ hour: +parts[0], minute: +parts[1] }).isBeforeDate(now) ? {\n    start: HAS_ERROR,\n    message: 'Booking time needs to be made in the future'\n  } : null;\n}\n\nexport function buildValidateDuration(min: number = 30, max: number = 240) {\n  return (c) => validateDuration(c, min, max);\n}\n\nexport function validateDuration(control: AbstractControl, min: number = 30, max: number = 240) {\n  if (control.value < (min || 30)) {\n    return { duration: HAS_ERROR, message: `Minimum booking duration is ${min} minute${min === 1 ? 's' : ''}` };\n  } else if (control.value > (max || 480)) {\n    return { length: HAS_ERROR, message: `Maximum booking duration is ${max} minute${max === 1 ? 's' : ''}` };\n  }\n  return null;\n}\n\nexport function buildValidateAttendees(host: User, min: number = 0) {\n  return (c) => validateAttendees(c, host, min);\n}\n\nexport function validateAttendees(control: AbstractControl, host: User, min: number = 0) {\n  if (!control || !(control.value instanceof Array)) {\n    return min > 0\n      ? { invalid: true, message: `Minimum of ${min} attendee${min === 1 ? ' is' : 's are'} required other than you` }\n      : null;\n  }\n  const list: User[] = control.value;\n  if (host) {\n    const result = list.find(a => a.email === host.email);\n    if (result) {\n      list.splice(list.indexOf(result), 1);\n    }\n  }\n  return list.length >= min ? null : {\n    count: true,\n    message: `Minimum of ${min} attendee${min === 1 ? ' is' : 's are'} required other than you`\n  };\n}\n\nexport function validateEndTime(dateControlTz: AbstractControl) {\n  return (control: AbstractControl) => {\n    // const date = new DateTZ({date: date_control ? date_control.value : undefined})\n    const now = DateNow(new Date())\n    return dateControlTz.value.addValue({ minutes: control.value || 60 }).isBeforeDate(now)? { end_time: true } : null;\n  };\n}\n\nexport function noWhitespaceValidator(control: AbstractControl) {\n  const value = control?.value;\n  if ( value === '') {\n      return null; // Return null if control value is undefined or null\n  }\n  const isWhitespace = value.trim().length === 0;\n  // const isValid = !isWhitespace;\n  return !isWhitespace ? null : { whitespace: true };\n}\n\n","export * from './lib/date-tz.class'","import { DateObjectUnits, DateTime, DateTimeUnit, DurationLike, DurationUnits } from 'luxon';\nimport { getTimezoneOffset } from 'date-fns-tz';\n\nfunction padZero(value: number, length: number): string {\n    let str = `${value}`;\n    while (str.length < length) str = `0${str}`;\n    return str;\n}\n\ninterface DateTZParams {\n    date?: number | DateTime\n    building_tz?: string\n    is_local_tz?: boolean\n    all_day?: boolean\n}\n\nconst now = new Date()\n\nexport class DateTZ {\n    date: DateTime\n    date_org: DateTime\n    building_tz: string\n    is_local_tz: boolean = true\n    all_day: boolean\n    local_tz: string\n    valid: boolean\n\n    constructor(data?: DateTZParams) { \n        this.date_org = typeof data?.date === 'number' ? DateTime.fromMillis(data?.date) : data?.date ? data?.date : DateTime.fromMillis(now.valueOf())\n        this.is_local_tz = data?.is_local_tz === false ? data?.is_local_tz : true\n        this.all_day = data?.all_day || false\n        this.local_tz = DateTime.now().zoneName\n        this.building_tz = data?.building_tz || this.local_tz\n        this.date = !this.is_local_tz ? this.date_org.setZone(this.building_tz) : this.date_org\n        this.valid = this.date.isValid\n    }\n\n    //get epoch milliseconds\n    public get ms(): number {\n        return this.date.valueOf()\n    }\n\n    //get epoch seconds\n    public get seconds(): number {\n        return Math.trunc(this.date.toSeconds())\n    }\n\n    //get the second of the minute\n    public get second(): number {\n        return this.date.second\n    }\n\n    //get the minutes of the hour\n    public get minutes(): number {\n        return this.date.minute\n    }\n\n    //get the minutes of the hour\n    public get hours(): number {\n        return this.date.hour\n    }\n\n    public get utc(): number {\n        const newDate = new DateTZ({...this, date: this.date.toUTC()})\n        return newDate.seconds\n    }\n\n    public get dateDay(): number {\n        return this.date.day\n    }\n\n    public get dateHour(): number {\n        return this.date.hour\n    }\n\n    public get dateYear(): number {\n        return this.date.year\n    }\n\n    public get dateWeekday(): number {\n        try {\n            return this.date.weekday;\n        } catch (e) {\n            return this.date.toJSDate().getDay();\n        }\n    }\n\n    public get dateMonth(): number {\n        return this.date.month\n    }\n\n    public dateDiff (compare_to: DateTZ, unit: DurationUnits, ans_unit = 'minutes'): number {\n        return this.date.diff(compare_to.date, unit)[ans_unit]\n    }\n\n    //set the date to the begining of the given unit\n    public startOfValue (unit: DateTimeUnit) {\n        // All the luxon start of values work as needed except for week\n        let newDate = new DateTZ({...this, date: this.date.startOf(unit)})\n        // Special week logic\n        if (unit === 'week') {\n            if (this.dateWeekday === 7) {\n                // Don't change, we want sunday as the start of the week even though luxon thinks it is Monday\n                newDate =  new DateTZ({ ...this, date: this.date })\n            } else if (this.dateWeekday === 1) {\n                // If this.date is monday, just subtract one more day to make it Sunday\n                const monday =  new DateTZ({ ...this, date: this.date })\n                newDate = monday.subtractValue({ days: 1 });\n            } else {\n                // If later than monday, startOfWeek back to monday and then subtact another day to get to Sunday.\n                const monday = new DateTZ({...this, date: this.date.startOf(unit)})\n                newDate = monday.subtractValue({ days: 1 })\n            }\n        }\n\n        return newDate\n    }\n\n    //set the date to the end of the given unit\n    public endOfValue (unit: DateTimeUnit) : DateTZ {\n        // All the luxon start of values work as needed except for week\n        let newDate = new DateTZ({...this, date: this.date.startOf(unit)})\n        // Special week logic\n        if (unit === 'week') {\n            if (this.dateWeekday === 6) {\n                // Don't change, we want saturday as the end of the week even though luxon thinks it is Sunday\n                newDate =  new DateTZ({ ...this, date: this.date })\n            } else if (this.dateWeekday === 7) {\n                // If this.date is Sunday, this alone is the luxon end of week so add a day\n                // to get to monday, then endOfWeek to Sunday, and subtract 1 day to Saturday\n                const sunday =  new DateTZ({ ...this, date: this.date }).addValue({ days: 1 })\n                newDate = sunday.endOfValue(unit).subtractValue({ days: 1 }); // return next saturday\n            } else {\n                // If not saturday or sunday\n                // endOfWeek to Sunday and then subtact a day to get to Saturday.\n                const later = new DateTZ({...this, date: this.date.endOf(unit)})\n                newDate = later.subtractValue({ days: 1 })\n            }\n        } else {\n            newDate =  new DateTZ({...this, date: this.date.endOf(unit)})\n        }\n\n        return newDate\n    }\n    \n    public startEpoch (): number {\n        const org = new DateTZ({date: this.date_org})\n        return this.all_day\n        ? this.startOfValue('day').ms - this.dateDiff(org, 'minutes')\n        : this.ms\n    }\n\n    //clone the given value and unit to the date\n    public clone (): DateTZ {\n        // return new DateTZ({...this})\n        return this.addValue({ seconds: 0 })\n    }\n\n    //adds the given value and unit to the date\n    public addValue (duration: DurationLike, isLastDayOfMonth?: boolean): DateTZ {\n        return new DateTZ({...this, date: isLastDayOfMonth ? this.date.plus(duration).endOf('month') : this.date.plus(duration)});\n    }\n\n    //subtracts the given value and unit to the date\n    public subtractValue (duration: DurationLike): DateTZ {\n        const newDate = new DateTZ({...this, date: this.date.minus(duration)})\n        return newDate\n    }\n\n    public setValue (obj: DateObjectUnits): DateTZ {\n        const newDate = new DateTZ({...this, date: this.date.set(obj)})\n        return newDate\n    }\n\n    public formatDate (format: string): string {\n        // Return new immuatable via \"plus\" to prevent \n        // TypeError: Cannot assign to read only property 'weekData' of object\n        // https://github.com/moment/luxon/issues/601\n        return this.date.plus({ seconds: 0 }).toFormat(format)\n    }\n\n    public formatLocalDate (format: string): string {\n        // setZone already returns new immutable so it doesn't have the formatDate issue.\n        return this.date.plus({ seconds: 0 }).setZone(this.local_tz).toFormat(format)\n    }\n\n    public isSameDate(compare_to: DateTZ, value: DateTimeUnit): boolean {\n        return this.date.hasSame(compare_to.date, value)\n    }\n\n    public isAfterDate(compare_to: DateTZ, unit?: DateTimeUnit): boolean {\n        switch (unit) {\n            case 'year':\n                return this.dateYear > compare_to.dateYear\n            case 'month':\n                if(this.isAfterDate(compare_to, 'year')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'year')){\n                    return false\n                }else{\n                    return this.dateMonth > compare_to.dateMonth\n                }\n            case 'day':\n                if(this.isAfterDate(compare_to, 'month')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'month')){\n                    return false\n                }else{\n                    return this.dateDay > compare_to.dateDay\n                }\n            case 'hour':\n                if(this.isAfterDate(compare_to, 'day')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'day')){\n                    return false\n                }else{\n                    return this.dateHour > compare_to.dateHour\n                }\n            case 'minute':\n                if(this.isAfterDate(compare_to, 'hour')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'hour')){\n                    return false\n                }else{\n                    return this.minutes > compare_to.minutes\n                }\n            default:\n                return this.ms > compare_to.ms;\n        }\n    }\n\n    public isBeforeDate(compare_to: DateTZ, unit?: DateTimeUnit): boolean {\n        switch (unit) {\n            case 'year':\n                return this.dateYear < compare_to.dateYear\n            case 'month':\n                if(this.isBeforeDate(compare_to, 'year')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'year')){\n                    return false\n                }else{\n                    return this.dateMonth < compare_to.dateMonth\n                }\n            case 'day':\n                if(this.isBeforeDate(compare_to, 'month')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'month')){\n                    return false\n                }else{\n                    return this.dateDay < compare_to.dateDay\n                }\n            case 'hour':\n                if(this.isBeforeDate(compare_to, 'day')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'day')){\n                    return false\n                }else{\n                    return this.dateHour < compare_to.dateHour\n                }\n            case 'minute':\n                if(this.isBeforeDate(compare_to, 'hour')){\n                    return true\n                }else if(!this.isSameDate(compare_to, 'hour')){\n                    return false\n                }else{\n                    return this.minutes < compare_to.minutes\n                }\n            default:\n                return this.ms < compare_to.ms;\n        }\n    }\n\n    public toZone(tz: string): DateTZ {\n        const newDate = new DateTZ({\n            ...this, \n            date: this.date.setZone(tz), \n            building_tz: tz, \n            is_local_tz: false\n        })\n        return newDate\n    }\n\n    public setTimestamp(timestamp: number): DateTZ {\n        const newDate = new DateTZ({\n            ...this, \n            date: timestamp,\n        })\n        return newDate\n    }\n\n    public get JSDate(): Date {\n        return this.date.toJSDate()\n    }\n\n    // helper to log out the dateTZ values\n    public logDateTz (label: string = ''): void {\n        console.log(`${label} local tz/date/time`, this.addValue({ seconds: 0 }).formatLocalDate(\"cccc d MMMM,yyyy h:mma\"), this.local_tz)\n        console.log(`${label} building tz/date/time`, this.addValue({ seconds: 0 }).formatDate(\"cccc d MMMM,yyyy h:mma\"), this.building_tz)\n    }\n}\n\nexport const DateNow = (date: Date = new Date()) => {\n    return new DateTZ({date: date.valueOf()})\n} \n\n// input the local time and the building timezone\nexport const convertLocalTimestampToTimezonedDateTz = (timestamp: number, buildingTimezone: string): DateTZ => {\n    const date = new Date(timestamp);\n    return new DateTZ({ date: timestamp, building_tz: buildingTimezone, is_local_tz: false }).setValue({\n        day: date.getDate(),\n        hour: date.getHours(),\n        minute: date.getMinutes()\n    });\n}\n\n// input the building time and the building timezone\nexport const convertTimezonedTimestampToLocalDateTz = (timestamp: number, buildingTimezone: string): DateTZ => {\n    const local_tz = DateTime.now().zoneName;\n    const localOffset = getTimezoneOffset(local_tz, new Date(timestamp));\n    const desiredOffset = getTimezoneOffset(buildingTimezone, new Date(timestamp));\n    if (localOffset > desiredOffset) {\n        const eleA = timestamp + (localOffset - desiredOffset);\n        return  new DateTZ({date: eleA, building_tz: buildingTimezone, is_local_tz: false});\n    } else {\n        const eleA = timestamp + (desiredOffset - localOffset);\n        return  new DateTZ({date: eleA, building_tz: buildingTimezone, is_local_tz: false});\n    }\n}\n\nexport const localTimezone = () => {\n    return Intl.DateTimeFormat().resolvedOptions().timeZone;\n}\n\nexport const getTimezoneOffsetString = (tz: string) => {\n    const offset_minutes = Math.floor(getTimezoneOffset(tz) / 1000 / 60);\n    const hours = Math.floor(offset_minutes/60);\n    const minutes = offset_minutes % 60;\n    return `${offset_minutes > 0 ? '+' : '-'}${padZero(Math.abs(hours), 2)}${padZero(minutes, 2)}`;\n}\n\nexport function toMiddayUTC(value: DateTZ = DateNow()) {\n    // exclude Auckland from rouding up timezone as it has 12+ hours UTC timezone difference\n    return value.building_tz.includes('Auckland') ? value :  new DateTZ({\n        date: value.setValue({ hour: 12, minute: 0 }).ms,\n        is_local_tz: false,\n        building_tz: 'UTC',\n    }).setValue({ hour: 12, minute: 0 });\n}\n\n/**returns the offset between two timezones in minutes and hours */\nexport function timezoneOffset(tz: string){\n    const nowTz = DateNow(new Date())\n    const offset = nowTz.date.offset - nowTz.toZone(tz).date.offset\n    return {minutes: offset, hours: offset/60}\n}\n\nexport function isToday (date, timezone) {\n\n    return new DateTZ({\n        date: toMiddayUTC(date).ms,\n        is_local_tz: false,\n        building_tz: timezone\n    }).isSameDate(\n        new DateTZ({\n            date: Date.now(),\n            is_local_tz: false,\n            building_tz: timezone,\n        }),\n        'day'\n    );\n}\n","export * from './lib/environment.module';\nexport * from './lib/version';\nexport * from './lib/environment.service'\nexport * from './lib/types'\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n    imports: [CommonModule],\n    providers: []\n})\nexport class EnvironmentModule {\n}\n","import {\n    Inject,\n    Injectable\n} from '@angular/core';\nimport { EnvironmentData } from './types';\n\nexport const ENVIRONMENT_TOKEN = 'environments_service_data';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class EnvironmentService {\n\n    public get production(): boolean {\n        return this.environment.production;\n    }\n\n    public get heap_io_id(): number {\n        return this.environment.heap_io_id;\n    }\n\n    constructor(@Inject(ENVIRONMENT_TOKEN) private environment: EnvironmentData) {\n    }\n}\n","// IMPORTANT: THIS FILE IS AUTO GENERATED! DO NOT MANUALLY EDIT OR CHECKIN!\n/* tslint:disable */\nexport const VERSION = {\n    \"dirty\": false,\n    \"raw\": \"6ab90cc55\",\n    \"hash\": \"6ab90cc55\",\n    \"distance\": null,\n    \"tag\": null,\n    \"semver\": null,\n    \"suffix\": \"6ab90cc55\",\n    \"semverString\": null,\n    \"version\": \"0.0.0\",\n    \"time\": 1713380271989\n};\n/* tslint:enable */\n","export * from './lib/legacy-overlays.module';\nexport * from './lib/space-select-modal/space-select-modal.component';\nexport * from './lib/new-user-modal/new-user-modal.component';\nexport * from './lib/confirm-modal/confirm-modal.component';\nexport * from './lib/catering-confirm-modal/catering-confirm-modal.component';\nexport * from './lib/catering-details-modal/catering-details-modal.component';\nexport * from './lib/requirement-details-modal/requirement-details-modal.component';\nexport * from './lib/booking-confirm/booking-confirm.component';\nexport * from './lib/user-form/user-form.component'\nexport * from './lib/booking-form/booking-form.component'\n","import {\n    Component,\n    EventEmitter,\n    Inject,\n    OnInit,\n    Output\n} from '@angular/core';\nimport {\n    MAT_DIALOG_DATA,\n    MatDialogRef\n} from '@angular/material/dialog';\nimport { Router } from '@angular/router';\n\nimport {\n    ApplicationService,\n    Booking,\n    BookingsService,\n    BookingStateService,\n    CateringOrder,\n    getFirstDateFromList,\n    OrganisationService,\n    rulesForSpace,\n    recurrenceDetails,\n    SeriesAction,\n    SettingsService,\n    Space,\n    SpacesService,\n    User,\n    UsersService,\n    formatWhen,\n    BOOKING_STATUS,\n    CloseDialogService,\n    DialogIds\n} from '@mckinsey-converge/data-common';\nimport {\n    BaseDirective,\n    DialogEvent,\n    HashMap,\n    humaniseDuration\n} from '@mckinsey-converge/base';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ConflictsModalComponent, ConflictsModalComponentData } from '@mckinsey-converge/ui';\n\n\nexport interface BookingConfirmModalData {\n    old_booking: Booking;\n    booking: Booking;\n    action?: SeriesAction\n}\n\nexport interface BookingDetailInfo {\n    bookedBy: {\n        display:boolean,\n        value: string\n    }\n}\n\n@Component({\n    selector: 'a-booking-confirm-modal',\n    templateUrl: './booking-confirm.component.html',\n    styleUrls: ['./booking-confirm.component.scss']\n})\nexport class BookingConfirmComponent extends BaseDirective implements OnInit{\n    /** Emitter for user actions on the modal */\n    @Output() public event = new EventEmitter();\n    /** Display string for changes are being processed */\n    public loading: string;\n    /** Whether space availability is being checked */\n    public checking_available: boolean;\n    /** Whether to show all attendees */\n    public show_attendees: boolean;\n    /** Whether to show all attendees */\n    public show_locations: boolean;\n    /** Whether to show all catering orders */\n    public show_orders: boolean;\n    /** Whether booking has succeeded */\n    public success: boolean;\n    /** Whether booking needs to be accepted */\n    public readonly is_request: boolean;\n\n    public approved: boolean;\n    public declined: boolean;\n    public bookingDetails: BookingDetailInfo;\n    lastMomentConflict: boolean = false;\n    \n    /** Booking to confirm changes to */\n    public get old_booking(): Booking {\n        return this._data.old_booking;\n    }\n\n    /** Booking to confirm changes to */\n    public get booking(): Booking {\n        return this._data.booking;\n    }\n\n    /** Active user */\n    public get user(): User {\n        return this._users.current;\n    }\n\n    /** Title of the displayed event */\n    public get title(): string {\n        return this.booking.title;\n    }\n\n    /** Comapny names */\n    public get company(): string[] {\n        return this.booking.company;\n    }\n    \n\n    /** Display string of when the event will occur */\n    public get when(): string {\n        const duration_value = this.booking.duration;\n        const all_day = this.booking.all_day && duration_value < 25 * 60;\n        if(this.booking.is_recurrent && this.booking.recurrence_starts && this.booking.recurrence_starts.length){\n            return formatWhen({all_day, ...this.recurrenceDates })\n        }\n        return formatWhen({\n            all_day,\n            startTZ: this.booking.startDateTz,\n            endTZ: this.booking.endDateTz,\n            displayEndTZ: this.booking.displayEndDateTz})\n    }\n\n    public get recurrenceDates(){\n        const startTZ = getFirstDateFromList(this.booking.recurrence_starts)\n        const endTZ = startTZ.addValue({minutes: this.booking.duration})\n        return {startTZ, endTZ, displayEndTZ: endTZ}\n    }\n\n    /** Display string for the recurrence value of the booking */\n    public get recurrence(): string {\n        return recurrenceDetails({\n            period: this.booking.recurrence_period,\n            end: this.booking.recurrence_endTz,\n            list: this.booking.recurrence_starts,\n            interval: this.booking.recurrence_interval\n        });\n    }\n\n    /** Display string for the event's duration */\n    public get duration(): string {\n        const duration_value = this.booking.duration;\n        return this.booking.all_day ? 'All Day' : humaniseDuration(duration_value);\n    }\n\n    /** List of spaces associated with the event */\n    public get spaces(): Space[] {\n        return [this.booking.room];\n    }\n\n    /** List of attendees associated with the event not including the host */\n    public get attendees(): User[] {\n        const attendees = this.booking.attendees;\n        return attendees.filter((i) => i.email !== this.organiser.email);\n    }\n\n    /** Host of the event */\n    public get organiser(): User {\n        return this.booking.organiser || this._users.current;\n    }\n\n    /** Host of the event */\n    public get equipment_codes(): HashMap<string> {\n        return this.booking.equipment_codes || {};\n    }\n\n    /** Host of the event */\n    public get catering_codes(): HashMap<string> {\n        const catering = this.catering;\n        const codes = {};\n        for (const order of this.catering) {\n            codes[order.location_id] = order.charge_code;\n        }\n        return codes;\n    }\n\n    /** Host of the event */\n    public get equipment_notes(): HashMap<string> {\n        return this.booking.notes\n            .filter((note) => note.type === 'equipment')\n            .reduce((map, notes) => {\n                map[notes.space] = notes.message;\n                return map;\n            }, {});\n    }\n\n    /** Details about the event */\n    public get notes(): string {\n        return this.booking.body;\n    }\n\n    /** List of catering orders in the booking */\n    public get catering(): CateringOrder[] {\n        return (this.booking.catering || []).map((order) => {\n            const space: any = this.spaces.find(\n                (a_space) => a_space.email === order.location_id\n            ) || {\n                level: {}\n            };\n            const building: any =\n                this._org.buildings.find((bld) => bld.id === space.level.building_id) || {};\n            return new CateringOrder({\n                ...order,\n                location: space.local_name,\n                symbol: building.currency,\n                booking_date: this.booking.startDateTz.ms,\n                booking_timezone: this.booking.timezone,\n            });\n        });\n    }\n\n    /** Map of changes to the booking */\n    public get changes(): HashMap<boolean> {\n        return {};\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _users: UsersService,\n        private _org: OrganisationService,\n        private _bookings: BookingsService,\n        private _booking_state_service: BookingStateService,\n        private _spaces: SpacesService,\n        private _router: Router,\n        private _dialog: MatDialog,\n        private _dialog_ref: MatDialogRef<BookingConfirmComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: BookingConfirmModalData,\n        public settings: SettingsService,\n        private closeDialogService: CloseDialogService, \n    ) {\n        super();\n        this.booking.time_changed =\n            this.old_booking &&\n            (this.old_booking.startDateTz.ms !== this.booking.startDateTz.ms ||\n                this.old_booking.duration !== this.booking.duration);\n        // in concierge, all bookings are acceptable without explicit approval.\n\n        const rules = rulesForSpace({ user: this.user, space: this.booking.room, duration: 60 });\n        this.is_request = this.settings.concierge ? false : rules.auto_approve;\n    }\n\n    ngOnInit(): void {\n        this.approved = this.booking.status === BOOKING_STATUS.approved;\n        this.declined = this.booking.status === BOOKING_STATUS.declined; \n        // test comment\n        const {creator, organiser, booker_concierge} = this.booking;\n        this.bookingDetails = {\n            bookedBy: {\n                display: creator && ( creator.email !== organiser.email || (creator.email === organiser.email && (booker_concierge !== null && booker_concierge !==undefined ) && organiser.email !==booker_concierge['email']) ),\n                value: (creator.email === organiser.email && booker_concierge !== null && (booker_concierge['email'] && organiser.email !==booker_concierge['email']) ) ?  booker_concierge['name'] || booker_concierge['email']  :  creator?.name || creator.email\n            }\n        }\n    }\n\n    /**\n     * Save booking changes\n     */\n    public saveChanges() {\n        this.loading = 'Checking availability of selected spaces';\n        this._dialog_ref.disableClose = true;\n        this.checkSpaceAvailability().then(\n            () => {\n                this.loading = 'Processing booking request...';\n                // Change the unchanged settings to the selected room\n                const newEmail = this.booking.space.email;\n                const replaceObjects = ['setup', 'breakdown', 'approval_status']\n                replaceObjects.forEach(key => {\n                    const obj = this.booking[key];\n                    if (obj && obj.constructor === Object) {\n                        const keys = Object.keys(obj);\n                        if (keys.length > 0) {\n                            const replacement = {};\n                            keys.forEach(nk => {\n                                replacement[newEmail] = obj[nk];\n                            })\n                            this.booking[key] = replacement;\n                        }\n                    }\n                });\n\n                // if notes or catering exist? add 15 min buffer setup and breakdown to booking\n                const has_note_buffer = (this.booking.notes && this.booking.notes?.length) || (this.booking.catering && this.booking.catering?.length) ? {[this.booking?.space?.email]: 900} :  null; // 900 seconds = 15 min\n                if (has_note_buffer) {\n                  this.booking.setup = has_note_buffer;\n                  this.booking.breakdown = has_note_buffer;      \n                }\n\n                this._bookings.save(this.booking, this._data.action === SeriesAction.EDIT).then(\n                    async (bkn) => {\n                        this.loading = null;\n                        this.success = true;\n                        this._dialog_ref.disableClose = false;\n                        const updated = new Booking({ ...this.booking, ...bkn.toApiJSON() });\n                        this._booking_state_service.replace(updated);\n                        \n                        /**\n                         * update the master booking in case of recurring to have latest updated in the system\n                         */\n                        if(updated.recurrence_master_id !== null)\n                        { \n                            const master_booking = await this._bookings.show(updated.recurrence_master_id);\n                            this._booking_state_service.replace(master_booking);\n                        }\n\n                        if (bkn.is_recurrent && bkn.recurrence_type === 'master') {\n                            this._booking_state_service.pollOnce();\n                            this.closeDialogService.closeDialog(DialogIds.MeetingDetails);\n                        }\n\n                        localStorage.removeItem('ACA_STAFF.booking_form_data');\n                        this.event.emit({ reason: 'done' });\n                        this._service.notifySuccess(\n                            `Successfully ${this.booking.id ? 'updated' : 'created'} booking`\n                        );\n                    },\n                    (err) => {\n\n                        this._dialog_ref.disableClose = false;\n                        let erroMessage: string = '';\n                        switch(err.status){\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase 400:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\terroMessage = 'Apologies, the booking cannot be finalized because the current time has exceeded the scheduled start time for this booking. Please try again.';\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase 409:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\terroMessage = 'Apologies, this room has been booked recently by another user, please try another one.';\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.lastMomentConflict = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n                        this.loading = erroMessage;\n                        this._service.notifyError(\n                            `Error ${this.booking.id ? 'updating' : 'creating'} booking: ${erroMessage}`\n                        );\n                       setTimeout(()=> {\n                        this.loading = null;\n                        this.event.emit({ reason: 'last-moment-conflict' });\n                       }, 4000) ;\n                    }\n                );\n            },\n            (err) => {\n\n                this.lastMomentConflict = true;\n                this._dialog_ref.disableClose = false;\n                const erroMessage = 'Apologies, this room has been booked recently by another user, please try another one.';\n                this.loading = erroMessage;\n                this._service.notifyError(\n                    `Error ${this.booking.id ? 'updating' : 'creating'} booking: ${erroMessage}`\n                );\n               setTimeout(()=> {\n                this.loading = null;\n                this.event.emit({ reason: 'last-moment-conflict' });\n               }, 4000) ;\n            }\n        );\n    }\n\n    /**\n     * Staff only\n     */\n    public newBooking() {\n        this._router.navigate(['/book', 'spaces']);\n        this._dialog_ref.close();\n    }\n\n    /**\n     * Staff only\n     */\n    public toSchedule() {\n        this._router.navigate(['/schedule'], {\n            queryParams: { email: this.booking.organiser.email }\n        });\n        this._dialog_ref.close();\n    }\n\n    /**\n     * Check whether the selected spaces are available for the selected time period\n     */\n    public checkSpaceAvailability(): Promise<void> {\n        const spaces: Space[] = this.spaces;\n        if (\n            (this.booking.id &&\n                (this.booking.startDateTz.ms === this.old_booking.startDateTz.ms &&\n                    this.booking.duration === this.old_booking.duration)) ||\n            (spaces && spaces.length <= 0)\n        ) {\n            return Promise.resolve();\n        }\n        return new Promise((resolve, reject) => {\n            // Use of this.booking.timezone is unreliable, use booking space instead.\n            const all_day = this.booking.all_day;\n            // R--- should be nothing to do with date as a timestamp getter\n            this._spaces\n                .available({\n                    room_ids: spaces.map((space) => space.id).join(','),\n                    dateTz: this.booking.startDateTz,\n                    duration: all_day ? 24 * 60 : this.booking.duration,\n                    ignore: this.booking.icaluid,\n                    recurrence_count: this.booking.recurrence_count,\n                    recurrence_period: this.booking.recurrence_period,\n                    recurrence_endTz: this.booking.recurrence_endTz,\n                    recurrence_interval: this.booking.recurrence_interval,\n                    recurrence_starts: this.booking.recurrence_starts,\n                    is_recurrent: this.booking.is_recurrent,\n                    recurrence_days: this.booking.recurrence_days\n                })\n                .then(\n                    (space_list) => {\n                        for (const space of space_list) {\n                            if (!space.bookable) {\n                                this.lastMomentConflict = true;\n                                return reject(\n                                    `${space.name} is not available at the select time period.`\n                                );\n                            }\n                        }\n                        if (space_list.length < spaces.length) {\n                            this.lastMomentConflict = true;\n                            return reject(\n                                `${spaces[0].name} is not available at the select time period.`\n                            );\n                        }\n                        resolve();\n                    },\n                    (err) => reject(err)\n                );\n        });\n    }\n\n    public openConflictsModal(){\n        const ref = this._dialog.open<ConflictsModalComponent,\n        ConflictsModalComponentData>(ConflictsModalComponent, {\n        maxWidth: '95vw',\n        width: '32em',\n        data: {\n            room_name: this.booking.room.local_name,\n            conflicts: this.booking.recurrence_exceptions,\n            copy_conflicts: true,\n            timezone: this.booking.timezone\n        }\n        });\n\n        this.subscription(\n        'modal_events',\n        ref.componentInstance.event.subscribe((event: DialogEvent) => {\n            if(event.reason === 'close'){\n                ref.close();\n            }else if(event.reason  === 'action'){\n                navigator.clipboard.writeText(this.conflictsText)\n            }\n            \n        })\n        );\n        ref.afterClosed().subscribe(() => this.unsub('modal_events'));\n    }\n\n    public get conflictsText(){\n        let text = ''\n        this.booking.recurrence_exceptions.map((date)=>{\n            const dateTZ = new DateTZ({date: date*1000});\n            const display = dateTZ.formatDate('ccc dd MMM yyyy');\n            text = `${text}\\n${display}${dateTZ.isSameDate(DateNow(new Date()), 'day') ? ' (Today)' : ''}`;\n        })\n        return text\n    }\n}\n","<mat-dialog-content *ngIf=\"!loading; else load_state\">\n    <main>\n        <button name=\"close\" mat-icon-button mat-dialog-close>\n            <app-icon\n                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"\n            ></app-icon>\n        </button>\n        <div class=\"details\">\n            <img\n                [src]=\"\n                    success\n                        ? is_request\n                            ? 'assets/img/requested.svg'\n                            : 'assets/img/confirmed.svg'\n                        : 'assets/img/edit.svg'\n                \"\n            />\n            <div class=\"text\">\n                Booking Details\n                <span *ngIf=\"success && !is_request\">Confirmed!</span>\n                <span class=\"request\" *ngIf=\"success && is_request\">Requested!</span>\n            </div>\n            <div class=\"info\" *ngIf=\"success && is_request\">Please await confirmation of room</div>\n        </div>\n        <div class=\"field\" name=\"title\">\n            <label>Title<span *ngIf=\"changes.title\">*</span>:</label>\n            <div class=\"value\">{{ title || 'No title' }}</div>\n        </div>\n        <div class=\"field\" name=\"when\">\n            <label>When<span *ngIf=\"changes.date\">*</span>:</label>\n            <div class=\"value\">{{ when }}</div>\n        </div>\n        <div class=\"field\" name=\"when\" *ngIf=\"booking.is_recurrent\">\n            <label>Recurrence<span *ngIf=\"changes.recurrence\">*</span>:</label>\n            <div class=\"value\">{{ recurrence }}</div>\n            <div\n                class=\"tooltip\"\n                *ngIf=\"booking.recurrence_exceptions && booking.recurrence_exceptions.length > 0\"\n                (click)=\"openConflictsModal()\"\n            >\n                Conflicts\n            </div>\n        </div>\n        <div class=\"field\" name=\"duration\">\n            <label>Duration<span *ngIf=\"changes.duration\">*</span>:</label>\n            <div class=\"value\">{{ duration }}</div>\n        </div>\n        <div class=\"field multi\" name=\"location\">\n            <label\n                >Locations({{ spaces.length || '0' }})<span *ngIf=\"changes.location\">*</span\n                >:</label\n            >\n            <div class=\"value\">\n                <div class=\"list\" [class.shown]=\"show_locations\">\n                    <div class=\"list-item\" *ngFor=\"let item of spaces\">\n                        <div class=\"text\" [title]=\"item?.name\">{{ item?.local_name }}</div>\n                        <div\n                            class=\"tooltip\"\n                            *ngIf=\"equipment_notes[item.email]\"\n                            [matTooltip]=\"equipment_notes[item.email]\"\n                        >\n                            Notes\n                        </div>\n                        <div\n                            class=\"tooltip\"\n                            *ngIf=\"equipment_codes[item.email]\"\n                            [matTooltip]=\"\n                                (equipment_codes[item.email]\n                                    ? 'Equipment ~ ' + equipment_codes[item.email]\n                                    : '') +\n                                (catering_codes[item.email] && equipment_codes[item.email]\n                                    ? '\\n'\n                                    : '') +\n                                (catering_codes[item.email]\n                                    ? 'Catering ~ ' + catering_codes[item.email]\n                                    : '')\n                            \"\n                        >\n                            Code\n                        </div>\n                    </div>\n                    <div class=\"list-item\" *ngIf=\"!spaces.length\">No Locations</div>\n                </div>\n                <button\n                    class=\"show\"\n                    *ngIf=\"spaces.length > 5\"\n                    (click)=\"show_locations = !show_locations\"\n                >\n                    {{ show_locations ? 'Hide' : 'Show' }} Locations\n                </button>\n            </div>\n        </div>\n        <div class=\"field\" name=\"host\">\n            <label>Host<span *ngIf=\"changes.organiser\">*</span>:</label>\n            <div class=\"value\">{{ organiser?.name || organiser?.email }}</div>\n        </div>\n        <div class=\"field\" name=\"host\" *ngIf=\"bookingDetails?.bookedBy?.display\" >\n            <label>Booked by<span *ngIf=\"changes.organiser\">*</span>:</label>\n            <div class=\"value\" [title]=\"'Booked By: ' + (bookingDetails.bookedBy.value)\">\n                {{ bookingDetails.bookedBy.value }}\n            </div>\n        </div>\n        <div class=\"field\" name=\"attendees\">\n            <label\n                >Attendees({{ attendees.length || '0' }})<span *ngIf=\"changes.attendees\">*</span\n                >:</label\n            >\n            <div class=\"value\">\n                <span *ngIf=\"!attendees || !attendees.length\">&lt;No Attendees&gt;</span>\n                <div class=\"list\" [class.shown]=\"show_attendees\">\n                    <div\n                        class=\"list-item\"\n                        *ngFor=\"let item of attendees\"\n                        [title]=\"item?.name + (item?.email ? '\\n' + item.email : '')\"\n                    >\n                        <div class=\"text\">\n                            <div class=\"name\">{{ item.name }}</div>\n                            <div class=\"email\" *ngIf=\"item.email\">\n                                <a [href]=\"'mailto:' + item.email + '?subject=' + booking.title\">{{\n                                    item.email\n                                }}</a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <button\n                    class=\"show\"\n                    *ngIf=\"attendees.length > 5\"\n                    (click)=\"show_attendees = !show_attendees\"\n                >\n                    {{ show_attendees ? 'Hide' : 'Show' }} Attendees\n                </button>\n            </div>\n        </div>\n        <div class=\"field\" name=\"company\">\n            <label>Company({{this.booking.company.length}}):</label>\n            <div class=\"value\">\n                <span *ngFor=\"let item of company; last as isLast\">{{item||''}}<span *ngIf=\"!isLast\">, </span>\n            </span>\n            </div>\n        </div>\n        <div class=\"field\" name=\"notes\">\n            <label>Notes<span *ngIf=\"changes.body\">*</span>:</label>\n            <div class=\"value\" [innerHTML]=\"notes || 'No notes'\"></div>\n        </div>\n        <div class=\"field\" name=\"catering\">\n            <label\n                >Catering Orders({{ catering.length || '0' }})<span *ngIf=\"changes.catering\">*</span\n                >:</label\n            >\n            <div class=\"value\">\n                <div class=\"list\" [class.shown]=\"show_orders\">\n                    <div class=\"list-item\" *ngFor=\"let order of catering\">\n                        <div class=\"text\">\n                            <div class=\"name\">{{ order.location || '&lt;Removed&gt;' }}</div>\n                            <div class=\"email\">\n                                {{ order.item_count }} item{{ order.item_count === 1 ? '' : '' }} |\n                                {{ order.total / 100 | currency: order.symbol }}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <button\n                    class=\"show\"\n                    *ngIf=\"catering.length > 5\"\n                    (click)=\"show_orders = !show_orders\"\n                >\n                    {{ show_orders ? 'Hide' : 'Show' }} Catering orders\n                </button>\n            </div>\n        </div>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions *ngIf=\"!loading\">\n    <footer>\n        <ng-container *ngIf=\"!success; else success_actions\">\n            <button mat-button class=\"inverse\" [disabled]=\"lastMomentConflict\" mat-dialog-close>Edit</button>\n            <button mat-button name=\"save\" [disabled]=\"lastMomentConflict\" (click)=\"saveChanges()\">Save</button>\n        </ng-container>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <main>\n        <div class=\"info-block center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">\n                {{ loading }}\n            </div>\n        </div>\n    </main>\n</ng-template>\n<ng-template #success_actions>\n    <button mat-button mat-dialog-close *ngIf=\"settings.concierge\">Close</button>\n    <ng-container *ngIf=\"!settings.concierge\">\n        <button mat-button class=\"inverse\" name=\"new\" (click)=\"newBooking()\">New Booking</button>\n        <a button mat-button mat-dialog-close (click)=\"toSchedule()\">My Day</a>\n    </ng-container>\n</ng-template>\n","import {\n    Component,\n    Input,\n    OnInit, ChangeDetectionStrategy, ChangeDetectorRef, Output, EventEmitter \n} from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { MatDialog } from '@angular/material/dialog';\nimport { distinctUntilChanged, first, skip } from 'rxjs/operators';\n\nimport {\n    BaseDirective,\n    closestToTimeSlotTz,\n    Identity,\n    unique\n} from '@mckinsey-converge/base';\nimport {\n    ApplicationService,\n    arrayWithValues,\n    BookingAction,\n    CateringOrder,\n    SeriesAction,\n    SettingsService,\n    User,\n    UsersService\n} from '@mckinsey-converge/data-common';\n\nimport { NewUserModalComponent } from '../new-user-modal/new-user-modal.component';\nimport {\n    SpaceSelectModalComponent,\n    SpaceSelectModalData\n} from '../space-select-modal/space-select-modal.component';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { DateTime } from 'luxon';\nimport { MatChipsModule} from '@angular/material/chips';\n\n\n@Component({\n    selector: 'a-booking-form',\n    templateUrl: './booking-form.component.html',\n    styleUrls: ['./booking-form.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class BookingFormComponent extends BaseDirective implements OnInit {\n    /** Form fields for booking */\n    @Input() public form: FormGroup;\n    /** List of available users to host bookings */\n    public user_list: User[] = [];\n    public nowTz: DateTZ = DateNow(new Date());\n    /** From date input for date field */\n    public fromDateTz: DateTZ = this.nowTz.setValue({ minute: Math.ceil(this.nowTz.minutes / 5) * 5 });\n    /** Last bookable date, concierge only */\n    public readonly untilDateTz = DateNow(new Date()).addValue({ days: 365 }).endOfValue('day');\n    public isConcierge: boolean;\n    public localTimezone = DateNow(new Date()).building_tz;\n    public localStart = \"\";\n    public localEnd = \"\";\n    // Define an array to store selected company options\n    public chipOptions: any[] = [];\n\n    constructor(\n        private _service: ApplicationService,\n        private _users: UsersService,\n        private _dialog: MatDialog,\n        private settingsService: SettingsService,\n        private cdRef: ChangeDetectorRef\n    ) {\n        super();\n        this.isConcierge = this.settingsService.concierge;\n    }\n\n    public ngOnInit(): void {\n        // Trim title \n        // this.form.get('title').setValue(this.form.get('title').value.trim());\n\n        this.chipOptions = [...this.form.controls.company.value];\n\n        this.localTimezone = DateNow(new Date()).building_tz;\n        const building_tz = (\n            this.form.controls.action &&\n            (\n                this.form.controls.action.value === 'booking_clone' ||\n                this.form.controls.action.value === 'clone' ||\n                this.form.controls.action.value === 'edit' ||\n                this.form.controls.action.value === 'booking_edit'\n            ) &&\n            this.form.controls.dateTz &&\n            this.form.controls.dateTz.value\n        ) ? this.form.controls.dateTz.value.building_tz : this.localTimezone;\n\n        this.nowTz = new DateTZ({ date: Date.now(), is_local_tz: false, building_tz });\n        this.fromDateTz = closestToTimeSlotTz(this.nowTz, 15);\n\n        this._users.initialised.pipe(first((_) => _)).subscribe(() => {\n            const user: User = this._users.current;\n            const delegates = user.delegates.map(\n                (del) => this._users.find(del.email) || new User({ email: del.email, name: del.email.split('@')[0] })\n            );\n            this.user_list = [user].concat(delegates);\n        });\n\n        this.updateCoachmarkTimes(this.form.controls.timezone.value);\n        this.subscription('formChanges',  this.form.valueChanges\n            .pipe(\n                skip(1), // initial form changes\n                distinctUntilChanged())\n            .subscribe(() => {\n                this.timeout('update_coachmark', () => {\n                    this.updateCoachmarkTimes(this.form.controls.timezone.value);\n                }, 500);\n            })\n        );\n\n        this.subscription('isRecurrentChanges',  this.form.controls.is_recurrent.valueChanges\n            .subscribe(() => {\n                const recurrenceStarts = this.form.controls.recurrence_starts\n                if(!this.form.controls.is_recurrent.value){\n                    recurrenceStarts.clearValidators()     \n                }else{\n                    const arrayValidators = [Validators.required];\n                    arrayValidators.push(arrayWithValues);\n                    recurrenceStarts.setValidators(arrayValidators);\n                }\n                recurrenceStarts.updateValueAndValidity()\n            })\n        );     \n\n        /**Disable Inputs */\n        this.disableInputs();\n\n        /**turn is_recurrent to false if editing or cloning a stand-alone/occurrence */\n        if(this.form.controls.id?.value && !this.form.controls.action?.value){\n            this.form.controls.is_recurrent.setValue(false)\n        }\n    }\n\n    /**\n     * \n     * @param key : formcontrol name \n     * Function trim value being submitted with only spaces/beginning/end \n     */\n    public trim(key: string): void {\n        this.form.get(key).setValue(this.form.get(key).value.trim());\n    }\n\n    /** Whether notes and description should use the HTML editor */\n    public get use_html(): boolean {\n        return this._service.setting('app.booking.html_body') || false;\n    }\n\n    /** List of available types for bookings */\n    public get booking_types(): Identity[] {\n        return this._service.setting('app.booking.booking_types') || [];\n    }\n\n    /** Display string for the list of active spaces */\n    public get spaces(): string {\n        const spaces = this.form.controls.space_list.value;\n        return spaces.length === 1\n            ? spaces[0].local_name\n            : spaces.length > 1\n                ? `${spaces.length} spaces selected`\n                : 'No Spaces selected';\n    }\n\n    public disableInputs() {\n        const { id, action, needs_space, is_recurrent } = this.form.value;\n        const has_id = !!id;\n        const is_edit = action === BookingAction.EDIT;\n        if (has_id) {\n            this.form.get('is_recurrent')?.disable();\n        }\n\n        if (!this.isConcierge && !needs_space) {\n            this.form.get('has_catering')?.disable();\n        }\n        if(has_id && is_edit && is_recurrent){\n            this.form.get('dateTz')?.disable()\n            this.form.patchValue({ action: null });\n        }\n    }\n\n    /**\n     * Open modal to change the space details for the booking\n     */\n    public openSpacesModal(): void {\n        const ref = this._dialog.open<SpaceSelectModalComponent, SpaceSelectModalData>(\n            SpaceSelectModalComponent,\n            {\n                width: 'auto',\n                height: 'auto',\n                maxWidth: '95vw',\n                data: {\n                    spaces: this.form.controls.space_list.value,\n                    dateTz: this.form.controls.dateTz.value,\n                    duration: this.form.controls.duration.value,\n                    host: this.form.controls.organiser.value,\n                    multiple: true,\n                    needsCatering: !!this.form.controls.catering?.value?.length,\n                }\n            }\n        );\n        this.subscription(\n            'new_spaces',\n            ref.componentInstance.event.subscribe((event) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    let space_list = this.form.controls.space_list.value;\n                    space_list = event.metadata;\n                    this.form.controls.space_list.setValue(unique(space_list, 'id'));\n                    const catering = this.form.controls?.catering?.value.map((order: CateringOrder) => {\n                        order.location = space_list[0].name;\n                        order.location_id = space_list[0].email;\n                        return order;\n                    })\n                    this.form.controls.catering?.setValue(catering || [])\n                    ref.close();\n                    this.unsub('new_spaces');\n                }\n                if (event.reason === 'close') {\n                    ref.close();\n                    this.unsub('new_spaces');\n                }\n            })\n        );\n    }\n\n    /**\n     * Open modal to change the recurrence details for the booking\n     */\n    public openNewUserModal() {\n        const ref = this._dialog.open<NewUserModalComponent>(NewUserModalComponent, {\n            width: 'auto',\n            height: 'auto'\n        });\n        this.subscription(\n            'new_user',\n            ref.componentInstance.event.subscribe((event) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    const attendees = this.form.controls.attendees.value;\n                    attendees.push(event.metadata);\n                    this.form.controls.attendees.setValue(unique(attendees, 'email'));\n                    ref.close();\n                    this.unsub('new_user');\n                    this.cdRef.detectChanges();\n                }\n            })\n        );\n    }\n\n    // Add & Remove chip and set the value of the form control accordingly\n    addCompany(event, company): void {\n        if (company) {\n            this.chipOptions.push(company);\n            this.form.controls.company.setValue(this.chipOptions);\n        }\n        event.preventDefault();\n    }\n\n    removeOption(option: any): void {\n        const index = this.chipOptions.indexOf(option);\n        if (index >= 0) {\n            this.chipOptions.splice(index, 1);\n        }\n        this.form.controls.company.setValue(this.chipOptions);\n    }\n\n    private updateCoachmarkTimes(timezone: string) {\n        if (!timezone) timezone = this.localTimezone;\n        // Resolve the problem that locally I might have the same TZ offset but the names don't match.\n        const localTzOffset = DateTime.now().setZone(this.localTimezone).offset;\n        const buildingTzOffset = DateTime.now().setZone(timezone).offset;\n        const dateTz = this.form.controls.dateTz.value;\n        if (dateTz && localTzOffset !== buildingTzOffset) {\n            const startDate = dateTz.clone();\n            this.localStart = startDate.formatLocalDate(\"h:mma\");\n            this.localEnd = startDate.addValue({ minutes: this.form.value.duration }).formatLocalDate(\"h:mma\");\n        } else {\n            // No location is selected so coachmark is hidden\n            this.localStart = \"\";\n            this.localEnd = \"\";\n        }\n        this.cdRef.detectChanges();\n    }\n\n    public get isSeriesAction(){\n        return this.form.value.action === SeriesAction.CLONE || this.form.value.action === SeriesAction.EDIT\n    }\n}\n","<div class=\"booking-form\" *ngIf=\"form\" [formGroup]=\"form\">\n    <div\n        class=\"field\"\n        *ngIf=\"form.value.id && form.controls.space_list && !isSeriesAction\"\n    >\n        <label for=\"spaces\" i18n=\"Booking form spaces label\">Spaces: </label>\n        <an-action-field\n            name=\"spaces\"\n            [placeholder]=\"spaces\"\n            (onAction)=\"openSpacesModal()\"\n        ></an-action-field>\n    </div>\n    <div class=\"field\" name=\"title\" *ngIf=\"form.controls.title\">\n        <label\n            for=\"title\"\n            [class.error]=\"form.controls.title.invalid && form.controls.title.touched\"\n            i18n=\"Booking form title label\"\n        >\n            Title<span>*</span>:\n        </label>\n        <mat-form-field appearance=\"outline\">\n            <input matInput name=\"title\" placeholder=\"Meeting Title\" i18n-placeholder formControlName=\"title\" (blur)=\"trim('title')\" />\n\n            <mat-error *ngIf=\"form.controls.title.invalid\" i18n=\"Booking form title error\"\n            >\n            {{ ( form?.get('title').errors && form?.get('title').hasError('pattern')) \n                ? 'Some special characters (^=`~!@#$%*{};:\\'_\\\",.\\<>) are not allowed' : 'Title is required'}} \n            </mat-error\n            >\n        </mat-form-field>\n    </div>\n\n    <div class=\"group date\" *ngIf=\"!form.get('is_recurrent')?.value\">\n        <!-- this is our regular booking date input -->\n        <div class=\"date-field\" name=\"date\" *ngIf=\"form.controls.dateTz\">\n            <label for=\"date\" i18n=\"Booking form date label\">Date: </label>\n            <date-tz-date-picker\n                [error]=\"form.controls.dateTz.touched && form.controls.dateTz.invalid && form.controls.dateTz.errors.date\"\n                [class.full-width]=\"form.controls.action.value === 'booking_clone'\" \n                name=\"date\" \n                class=\"time-inputs\"\n                [fromDateTz]=\"fromDateTz\"\n                [untilDateTz]=\"isConcierge ? untilDateTz : null\"\n                formControlName=\"dateTz\"\n                [invalid]=\"form.controls.dateTz.invalid\"\n                [can_pick_today]=\"false\"\n            ></date-tz-date-picker>\n            <div class=\"error info\" *ngIf=\"form.controls.dateTz.touched && form.controls.dateTz.invalid && form.controls.dateTz.errors.date\">\n                Date and time must be in the future\n            </div>\n        </div>\n    </div>\n    <div class=\"group time\">\n        <div class=\"field\" name=\"start-time\" *ngIf=\"form.controls.dateTz\">\n            <label for=\"start-time\" i18n=\"Booking form start time label\">Start Time: </label>\n            <date-tz-time-field\n                class=\"time-inputs\"\n                [required]=\"true\"\n                name=\"start-time\"\n                [fromDateTz]=\"fromDateTz\"\n                [startFromDateTz]=\"(form.controls.is_before_date && form.controls.is_before_date.value === true) &&\n                    (\n                        form.controls.action.value === 'booking_clone' ||\n                        form.controls.action.value === 'clone' ||\n                        form.controls.action.value === 'booking_edit' ||\n                        form.controls.action.value === 'edit'\n                    )\"\n                [all_day]=\"form.controls.all_day?.value\"\n                [ngModel]=\"form.controls.dateTz.value\"\n                [disabled]=\"form.value.all_day\"\n                (ngModelChange)=\"form.controls.dateTz.setValue($event)\"\n                [ngModelOptions]=\"{ standalone: true }\"\n                [show_current]=\"form.controls.id && form.controls.id.value\"\n            ></date-tz-time-field>\n            <div class=\"error info\" *ngIf=\"form.controls.dateTz.touched && form.controls.dateTz.invalid && !form.controls.is_recurrent && form.controls.dateTz.errors.start\">\n                Date and time must be in the future\n            </div>\n        </div>\n        <div class=\"field\" name=\"duration\" *ngIf=\"form.controls.duration\">\n            <div class=\"label-group\">\n                <label for=\"duration\" i18n=\"Booking form duration label\">Duration: </label>\n                <!-- <mat-checkbox\n                    name=\"all-day\"\n                    formControlName=\"all_day\"\n                    *ngIf=\"form.controls.all_day\"\n                    i18n=\"Booking form all day label\"\n                >All day booking\n                </mat-checkbox\n                > -->\n            </div>\n            <date-tz-duration-field\n                class=\"time-inputs\"\n                name=\"duration\"\n                [startDateTz]=\"form.controls.dateTz.value\"\n                [required]=\"true\"\n                [all_day]=\"form.controls.all_day?.value\"\n                formControlName=\"duration\"\n            ></date-tz-duration-field>\n            <div class=\"error info\" *ngIf=\"form.controls.duration.touched && form.controls.duration.invalid\">\n                Duration is invalid. End time must be in the future\n            </div>\n        </div>\n        <div *ngIf=\"localStart && localEnd\" class=\"coachmark\">\n            Please be aware that this booking starts at {{localStart}} and ends at {{localEnd}} in your local timezone.\n        </div>\n    </div>\n    <div class=\"recurrence-siwch\">\n        <mat-slide-toggle\n        class=\"mck-slide-toggle\"\n        labelPosition=\"after\"\n        name=\"recurrence\"\n        formControlName=\"is_recurrent\"\n        >Recurring booking</mat-slide-toggle>\n    </div>\n    <!-- this is recurring booking form that appears when the above recurrence toggle is enabled -->\n    <recurrence-booking-form *ngIf=\"form.get('is_recurrent')?.value\" [form]=\"form\"></recurrence-booking-form>\n    <div class=\"field\" name=\"organiser\" *ngIf=\"form.controls.organiser\">\n        <label for=\"organiser\" i18n=\"Booking form organiser label\">Host: </label>\n        <a-user-search-field name=\"organiser\" formControlName=\"organiser\" *ngIf=\"isConcierge\"></a-user-search-field>\n        <mat-form-field appearance=\"outline\" *ngIf=\"!isConcierge\">\n            <mat-select\n                name=\"organiser\"\n                formControlName=\"organiser\"\n                [placeholder]=\"form.controls.organiser.value.name || form.controls.organiser.value.email\"\n            >\n                <mat-option *ngFor=\"let user of user_list\" [value]=\"user\">\n                    {{ user.name || user.email }}\n                </mat-option>\n            </mat-select>\n        </mat-form-field>\n    </div>\n    <div class=\"field\" name=\"attendees\" *ngIf=\"form.controls.attendees\">\n        <label for=\"attendees\" i18n=\"Booking form attendees label\">Attendees: </label>\n        <a-user-list-field\n            name=\"attendees\"\n            formControlName=\"attendees\"\n            (newUser)=\"openNewUserModal()\"\n        ></a-user-list-field>\n        <mat-error *ngIf=\"form.controls.attendees.invalid\" i18n=\"Booking form attendee name error\">\n            {{ form?.get('attendees').errors?.customError }}\n        </mat-error>\n    </div>\n    <div class=\"field company-name\" name=\"company\" *ngIf=\"form.controls.company\">\n        <label for=\"company\" [class.error]=\"form.controls.company.invalid && form.controls.company.touched\"\n            i18n=\"Booking form company label\">\n            Company:\n        </label>\n        <div class=\"input-with-button\">\n        <mat-form-field appearance=\"outline\" class=\"mat-form-field-container\">\n            <div class=\"chip-input-wrapper\">\n                <input #company matInput name=\"company\" placeholder=\"Company name\" i18n-placeholder [matChipInputFor]=\"chipList\">\n            </div>\n            <!-- mat-chip-list to display selected options -->\n            <mat-error *ngIf=\"form.controls.company.invalid\" i18n=\"Booking form company name error\">\n                {{ ( form?.get('company').errors && form?.get('company').hasError('pattern'))\n                ? 'Some special characters (^=`~@#$%*{};:_\\\",.\\<>) are not allowed' : ''}}\n            </mat-error>\n        </mat-form-field>\n        <button mat-button class=\"input-button\" (click)=\"addCompany($event, company.value); company.value=''\">Add</button>\n    </div>\n        <mat-chip-list #chipList>\n            <mat-chip *ngFor=\"let selected of chipOptions\" removable (removed)=\"removeOption(selected)\" class=\"mat-chip\">\n                {{ selected }}\n                <div matChipRemove class=\"mck-close-icon\">&#10006;</div>\n            </mat-chip>\n        </mat-chip-list>\n    </div>\n\n    <div class=\"field\" name=\"booking-type\" *ngIf=\"form.controls.booking_type && booking_types.length > 1\">\n        <label for=\"booking-type\" i18n=\"Booking form booking type label\">Booking Type: </label>\n        <mat-form-field appearance=\"outline\">\n            <mat-select name=\"booking-type\" formControlName=\"booking_type\">\n                <mat-option *ngFor=\"let type of booking_types\" [value]=\"type.id\">\n                    {{ type.name }}\n                </mat-option>\n            </mat-select>\n        </mat-form-field>\n    </div>\n    <div class=\"field\" name=\"need-space\" *ngIf=\"!isConcierge && form.controls.needs_space\">\n        <mat-checkbox formControlName=\"needs_space\" i18n=\"Booking form need space label\"\n        >Need a meeting space?\n        </mat-checkbox\n        >\n    </div>\n    <div class=\"field\" name=\"has-catering\" *ngIf=\"form.controls.has_catering\">\n        <!-- [disabled]=\"!isConcierge && !form.controls.needs_space.value\" -->\n        <mat-checkbox\n            name=\"catering\"\n            formControlName=\"has_catering\"\n            i18n=\"Booking form need catering label\"\n        >\n            Need catering?\n        </mat-checkbox>\n    </div>\n    <div class=\"field\" name=\"body\" *ngIf=\"form.controls.body\">\n        <label for=\"body\" i18n=\"Booking form notes label\">Notes: </label>\n        <mat-form-field name=\"body\" appearance=\"outline\" *ngIf=\"!use_html; else html_editor\">\n            <textarea\n                matInput\n                name=\"description\"\n                placeholder=\"Meeting Description\"\n                i18n-placeholder\n                formControlName=\"body\"\n                (blur)=\"trim('body')\"\n            ></textarea>\n        </mat-form-field>\n        <ng-template #html_editor>\n            <editor formControlName=\"body\"></editor>\n        </ng-template>\n    </div>\n</div>\n","import {\n    Component,\n    EventEmitter,\n    Inject,\n    OnInit,\n    Output\n} from '@angular/core';\nimport {\n    MAT_DIALOG_DATA,\n    MatDialogRef\n} from '@angular/material/dialog';\nimport {\n    FormControl,\n    FormGroup\n} from '@angular/forms';\n\nimport {\n    ApplicationService,\n    CateringItem,\n    OrganisationService,\n    Space,\n    SpacesService\n} from '@mckinsey-converge/data-common';\nimport {\n    BaseDirective,\n    DialogEvent\n} from '@mckinsey-converge/base';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\n\n\nexport interface CateringConfirmModalData {\n    all_day: boolean;\n    form: FormGroup;\n    dateTz: DateTZ;\n}\n\n@Component({\n    selector: 'a-catering-confirm-modal',\n    templateUrl: './catering-confirm-modal.component.html',\n    styleUrls: ['./catering-confirm-modal.component.scss']\n})\nexport class BookingCateringConfirmModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user actions on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** List of selected items for the order */\n    public item_list: CateringItem[] = [];\n\n    /** Space selected for delivery */\n    public get space(): Space {\n        return this._spaces.find(this._data.form?.controls?.location_id?.value);\n    }\n\n    /** Delivery time for the order */\n    public get delivery_time(): string {\n        let date = this._data.dateTz;\n        if (this._data.form && this._data.form.controls.delivery_time) {\n            date = date.addValue({ minutes: this._data.form.controls.delivery_time.value });\n        }\n        return date.formatDate('h:mma').toLocaleLowerCase();\n    }\n\n    /** Form field for order items */\n    public get item_field(): FormControl {\n        return this._data.form.controls.items as any;\n    }\n\n    /** Total cost of the order */\n    public get order_cost(): number {\n        return this.item_list.reduce((amount, item) => {\n            const price = item.price\n            return amount + item.amount * price\n        }, 0);\n    }\n\n    /** Currency symbol for the selected space */\n    public get symbol(): string {\n        /* istanbul ignore else */\n        if (!this.space || !this.space.level) {\n            return 'USD';\n        }\n        const building = this._org.buildings.find(\n            (bld) => bld.id === this.space.level.building_id\n        ) || { currency: 'USD' };\n        return building.currency;\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _org: OrganisationService,\n        private _spaces: SpacesService,\n        private _dialog_ref: MatDialogRef<BookingCateringConfirmModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: CateringConfirmModalData\n    ) {\n        super();\n        if (!this._data.form) {\n            this._service.notifyError('No form data for order');\n            this._dialog_ref.close();\n        }\n    }\n\n    public ngOnInit(): void {\n        /* istanbul ignore else */\n        if (this._data.form.controls.items) {\n            this.subscription(\n                'item_list',\n                this._data.form.controls.items.valueChanges.subscribe((items) => {\n                    /* istanbul ignore else */\n                    if (!items || items.length <= 0) {\n                        this._dialog_ref.close();\n                    }\n                })\n            );\n        }\n        this.item_list = this._data.form.controls.items.value.map((item) => new CateringItem(item.toJSON()));\n    }\n}\n","<header class=\"heading\">\n    <div i18n=\"Catering confirm order header\">Confirm Catering Order</div>\n    <button mat-icon-button mat-dialog-close >\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main>\n        <div class=\"details\">\n            Delivering to <span>{{ space?.local_name || '&lt;Unset&gt;' }}</span> at <span>{{ delivery_time }}</span>\n        </div>\n        <div class=\"list\">\n            <a-catering-menu-item\n                *ngFor=\"let item of item_list\"\n                [field]=\"item_field\"\n                [subitem]=\"true\"\n                [item]=\"item\"\n                [symbol]=\"symbol\"\n            ></a-catering-menu-item>\n        </div>\n        <div class=\"total\">\n            <label>Order Total:</label>\n            <div class=\"value\">{{ order_cost / 100 | currency:symbol }}</div>\n        </div>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button (click)=\"event.emit({ reason: 'done' })\" i18n=\"Catering confirm save action\">Save Order</button>\n    </footer>\n</mat-dialog-actions>\n","import {\n    Component,\n    ElementRef,\n    EventEmitter,\n    Inject,\n    OnInit,\n    Output,\n    ViewChild\n} from '@angular/core';\nimport {\n    AbstractControl,\n    FormControl,\n    FormGroup,\n    Validators\n} from '@angular/forms';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport {\n    OrganisationService,\n    BookingNote,\n    CateringOrder,\n    Space,\n    UsersService,\n    CateringNotesService,\n    Booking\n} from '@mckinsey-converge/data-common';\nimport {\n    DialogEvent,\n    HashMap\n} from '@mckinsey-converge/base';\n\nimport { DateNow } from '@mckinsey-converge/date-tz';\n\n\nexport interface CateringDetailsModalData {\n    spaces: Space[];\n    notes_field: AbstractControl;\n    catering: AbstractControl;\n    booking: Booking\n}\n\n@Component({\n    selector: 'a-catering-details-modal',\n    templateUrl: './catering-details-modal.component.html',\n    styleUrls: ['./catering-details-modal.component.scss']\n})\nexport class CateringDetailsModalComponent implements OnInit {\n    /** Emitter for modal events */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Mapping of spaces to notes */\n    public notes: HashMap<string> = {};\n    /** Mapping of spaces to cost codes */\n    public codes: HashMap<string> = {};\n    /** Mapping of spaces to estimated head count */\n    public head_counts: HashMap<string> = {};\n    /** Mapping of spaces to form fields */\n    public form: HashMap<FormGroup> = {};\n    /** Map of spaces to whether they need a charge code */\n    public needs_charge_code: HashMap<boolean> = {};\n    /** Index of the active space */\n    public active_space: number = 0;\n\n    @ViewChild('content', { static: true }) private _content_el: ElementRef<HTMLElement>;\n\n    /** List of selected spaces */\n    public get space_list(): Space[] {\n        return (this._data.spaces || []).filter((space) =>\n            this._data.catering.value.find((order) => order.location_id === space.email)\n        );\n    }\n\n    public get active_form(): FormGroup {\n        return this.form[this.space_list[this.active_space].email];\n    }\n\n    public get invalid_charge_code(): boolean {\n        return this.active_form.controls.code.errors?.pattern || this.active_form.controls.code.errors?.minlength;\n    }\n\n    /** Whether form fields are valid */\n    public get is_valid(): boolean {\n        return this.space_list.reduce(\n            (valid, space) => valid && this.form[space.email].valid,\n            true\n        );\n    }\n\n    constructor(\n        private _org: OrganisationService,\n        private _users: UsersService,\n        private _cateringNotesService: CateringNotesService,\n        @Inject(MAT_DIALOG_DATA) private _data: CateringDetailsModalData\n    ) {\n    }\n\n    public ngOnInit(): void {\n        const note_list = this._data.notes_field.value.filter(\n            (note: BookingNote) => note.type === 'catering'\n        );\n        this.notes = note_list.reduce((map, note) => {\n            map[note.space] = note.message;\n            return map;\n        }, {});\n        this.codes = this._data.catering.value.reduce((map, order: CateringOrder) => {\n            map[order.location_id] = order.charge_code;\n            return map;\n        }, {});\n        this.generateFormFields();\n    }\n\n    public submit(): void {\n        this.space_list.forEach((space) => this.form[space.email].markAllAsTouched());\n        /* istanbul ignore else */\n        if (this.is_valid) {\n            // Update notes\n            const notes = this._data.notes_field.value.filter(\n                (note: BookingNote) => note.type !== 'catering'\n            );\n            const new_notes = this.space_list.map(\n                (space) =>\n                    ({\n                        author: this._data.booking.booked_by ? this._data.booking.booked_by['name'] : this._users.current.name,\n                        type: 'catering',\n                        message: this.form[space.email].controls.notes.value,\n                        space: space.email,\n                        date: DateNow(new Date()).ms\n                    } as BookingNote)\n            );\n            this._cateringNotesService.setNotes(new_notes);\n            this._data.notes_field.setValue(notes.concat(new_notes).filter((note) => note.message));\n            // Save the notes\n            const orders = this._data.catering.value.map(\n                (order) =>\n                    new CateringOrder({\n                        ...order,\n                        charge_code: this.form[order.location_id]\n                            ? this.form[order.location_id].controls.code.value\n                            : ''\n                    })\n            );\n\n            this._data.catering.setValue(orders);\n            // This should go to the next\n            this.event.emit({ reason: 'done' });\n        } else {\n            this._scrollToBottom();\n        }\n    }\n\n    /** Generate form fields for each space */\n    private generateFormFields(): void {\n        for (const space of this.space_list) {\n            const building = this._org.buildings.find(\n                bld => bld.id === space.level.building_id\n            );\n            \n            this.needs_charge_code[space.email] = space?.filters?.charge_code || space?.settings?.charge_code || false;\n            this.form[space.email] = new FormGroup({\n                notes: new FormControl(this.notes[space.email] || ''),\n                code: new FormControl(this.codes[space.email] || '',\n                    this.needs_charge_code[space.email] ?\n                        [Validators.pattern(/^[a-zA-Z0-9]{4,}$/), Validators.minLength(4),  Validators.required ] : [Validators.pattern(/^[a-zA-Z0-9]{4,}$/), Validators.minLength(4)])\n            });\n        }\n    }\n\n    /** Scroll the content container to the bottom */\n    private _scrollToBottom(): void {\n        this._content_el?.nativeElement.scrollTo({\n            top: this._content_el.nativeElement.scrollHeight,\n            left: 0,\n            behavior: 'smooth'\n        });\n    }\n}\n","<div class=\"header\">\n    <div class=\"tabs\">\n        <mat-tab-group [(selectedIndex)]=\"active_space\">\n            <mat-tab\n                *ngFor=\"let space of space_list\"\n                [label]=\"space.local_name + (form[space.email].invalid && form[space.email].touched ? '*' : '')\"\n            ></mat-tab>\n        </mat-tab-group>\n    </div>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</div>\n<mat-dialog-content>\n    <main>\n        <div class=\"details\">\n            <img src=\"assets/img/food-notes.svg\" />\n            <div class=\"text\">Please specify any allergies or gluten intolerances</div>\n        </div>\n        <form *ngIf=\"space_list[active_space] && active_form\" [formGroup]=\"active_form\">\n            <div class=\"field\">\n                <label for=\"equipment-notes\" i18n=\"Catering details equipment notes label\">\n                    (eg - allergies, in tolerances, no ice in drinks etc) Additional requests are\n                    handled in confidence.\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"equipment-notes\"\n                        formControlName=\"notes\"\n                        placeholder=\"Add notes here...\"\n                        i18n-placeholder\n                    ></textarea>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <label\n                    for=\"charge-code\"\n                    [class.error]=\"\n                        active_form.controls.code.touched && active_form.controls.code.invalid\n                    \"\n                    i18n=\"Catering details charge code label\"\n                >\n                    Charge Code\n                    <span *ngIf=\"needs_charge_code[space_list[active_space].email]\">*</span>\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"charge-code\"\n                        formControlName=\"code\"\n                        placeholder=\"Charge Code\"\n                        i18n-placeholder\n                    />\n                    <mat-hint i18n=\"Catering details charge code hint\">\n                        <span>Note:</span> Your booking will be confirmed before you are charged.\n                    </mat-hint>\n                    <mat-error i18n=\"Catering details charge code error\">\n                        {{ invalid_charge_code ? 'Valid Charge Code Required' : 'Charge Code is required'}}\n                    </mat-error>\n                </mat-form-field>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button name=\"next\" (click)=\"submit()\" i18n=\"Catering details save action\">\n            Add to booking\n        </button>\n    </footer>\n</mat-dialog-actions>\n","import {\n    Component,\n    EventEmitter,\n    Inject,\n    Output\n} from '@angular/core';\nimport {\n    MAT_DIALOG_DATA,\n    MatDialogRef\n} from '@angular/material/dialog';\n\nimport { ApplicationIcon } from '@mckinsey-converge/data-common';\nimport {\n    BaseDirective,\n    DialogEvent\n} from '@mckinsey-converge/base';\n\nexport interface ConfirmModalData {\n    /** Title of the modal */\n    title: string;\n    /** Contents of the modal */\n    content: string;\n    /** Text displaed on the confirmation button */\n    action?: string;\n    /** Icon to display on the modal */\n    icon: ApplicationIcon;\n}\n\nexport const CONFIRM_METADATA = {\n    height: 'auto',\n    width: '24em',\n    maxHeight: 'calc(100vh - 2em)',\n    maxWidth: 'calc(100vw - 2em)'\n};\n\n@Component({\n    selector: 'confirm-modal',\n    templateUrl: './confirm-modal.component.html',\n    styleUrls: ['./confirm-modal.component.scss']\n})\nexport class ConfirmModalComponent extends BaseDirective {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Loading state */\n    public loading: string;\n\n    /** Title of the confirm modal */\n    public get title(): string {\n        return (this._data ? this._data.title : null) || 'Confirm';\n    }\n\n    /** Body of the confirm modal */\n    public get content(): string {\n        return (this._data ? this._data.content : null) || 'Are you sure?';\n    }\n\n    /** Display text on the confirm button */\n    public get action(): string {\n        return (this._data ? this._data.action : null) || 'Ok';\n    }\n\n    /** Display icon properties */\n    public get icon(): ApplicationIcon {\n        return (this._data ? this._data.icon : null) || null;\n    }\n\n    constructor(\n        private _dialog: MatDialogRef<ConfirmModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: ConfirmModalData\n    ) {\n        super();\n    }\n\n    /**\n     * User confirmation of the content of the modal\n     */\n    public accept() {\n        this.event.emit({ reason: 'done' });\n    }\n}\n","<header>\n    <h3 mat-dialog-title>{{ title || 'Confirm' }}</h3>\n</header>\n<mat-dialog-content>\n    <div class=\"body\" *ngIf=\"!loading; else load_state\">\n        <app-icon *ngIf=\"icon\" [icon]=\"icon\"></app-icon>\n        <div class=\"content\">\n            <p [innerHTML]=\"content || 'Are you sure?'\"></p>\n        </div>\n    </div>\n</mat-dialog-content>\n<mat-dialog-actions *ngIf=\"!loading\">\n    <footer>\n        <button mat-button class=\"inverse\" mat-dialog-close i18n=\"Close confirm modal\">Cancel</button>\n        <button mat-button name=\"accept\" (click)=\"accept()\">{{ action || 'Ok' }}</button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #load_state>\n    <div class=\"body\">\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">{{ loading }}</div>\n        </div>\n    </div>\n</ng-template>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { LegacyUiModule } from '@mckinsey-converge/legacy-ui';\nimport { UiModule } from '@mckinsey-converge/ui';\nimport {\n    FormsModule,\n    ReactiveFormsModule\n} from '@angular/forms';\nimport { SpaceSelectModalComponent } from './space-select-modal/space-select-modal.component';\nimport { NewUserModalComponent } from './new-user-modal/new-user-modal.component';\nimport { ConfirmModalComponent } from './confirm-modal/confirm-modal.component';\nimport { NoCateringModalComponent } from './no-catering-modal/no-catering-modal.component';\nimport { BookingCateringConfirmModalComponent } from './catering-confirm-modal/catering-confirm-modal.component';\nimport { CateringDetailsModalComponent } from './catering-details-modal/catering-details-modal.component';\nimport { RequirementDetailsModalComponent } from './requirement-details-modal/requirement-details-modal.component';\nimport { BookingConfirmComponent } from './booking-confirm/booking-confirm.component';\nimport { BaseModule } from '@mckinsey-converge/base';\nimport { UserFormComponent } from './user-form/user-form.component';\nimport { BookingFormComponent } from './booking-form/booking-form.component';\nimport { EditorModule } from '@tinymce/tinymce-angular';\n\nconst DECLARATIONS = [\n    SpaceSelectModalComponent,\n    NewUserModalComponent,\n    ConfirmModalComponent,\n    NoCateringModalComponent,\n    BookingCateringConfirmModalComponent,\n    CateringDetailsModalComponent,\n    RequirementDetailsModalComponent,\n    BookingConfirmComponent,\n    UserFormComponent,\n    BookingFormComponent,\n];\n\n@NgModule({\n    imports: [\n        LegacyUiModule,\n        FormsModule,\n        ReactiveFormsModule,\n        CommonModule,\n        UiModule,\n        BaseModule,\n        EditorModule,\n    ],\n    declarations: [\n        ...DECLARATIONS\n    ],\n    exports: [\n        ...DECLARATIONS,\n        BaseModule\n    ]\n})\nexport class LegacyOverlaysModule {\n}\n","import { Component, EventEmitter, OnInit, Output } from '@angular/core';\nimport { FormBuilder, FormControl, FormGroup, Validators } from '@angular/forms';\n\nimport { BaseDirective, DialogEvent } from '@mckinsey-converge/base';\nimport { generateUserForm, User } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'new-user-modal',\n    templateUrl: './new-user-modal.component.html',\n    styleUrls: ['./new-user-modal.component.scss'],\n})\nexport class NewUserModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Form fields for the new user */\n    public form: FormGroup;\n    /** New user data store */\n    public user: User;\n    /** Whether user details are being saved */\n    public loading: boolean;\n\n    public ngOnInit(): void {\n        this.user = new User();\n        this.form = generateUserForm(this.user);\n    }\n\n    public saveChanges() {\n        this.form.markAllAsTouched();\n        if (this.form.valid) {\n            if (!this.form.controls.email.value) {\n                this.form.controls.email.setValue(\n                    `${Math.floor(Math.random() * 99999)}@guest.mckinsey.com`\n                );\n            }\n            const new_user = new User({\n                ...this.form.value,\n                name: `${this.form.value.first_name} ${this.form.value.last_name}`,\n                type: 'external',\n                external: true,\n                visitor: true,\n            });\n            this.event.emit({ reason: 'done', metadata: new_user });\n        }\n    }\n}\n","<header>\n    <h3 mat-dialog-title>Add External Attendee</h3>\n    <button mat-icon-button mat-dialog-close *ngIf=\"!loading\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<div class=\"body\" *ngIf=\"!loading; else load_state\">\n    <user-form [form]=\"form\"></user-form>\n</div>\n<footer *ngIf=\"!loading\">\n    <button mat-button name=\"previous\" class=\"inverse\" mat-dialog-close>Cancel</button>\n    <button mat-button name=\"next\" (click)=\"saveChanges()\">Save</button>\n</footer>\n<ng-template #load_state>\n    <div class=\"body\">\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">\n                Saving attendee...\n            </div>\n        </div>\n    </div>\n</ng-template>\n\n","import {\n    Component,\n    Output,\n    EventEmitter\n} from '@angular/core';\nimport {\n    MatDialogRef,\n} from '@angular/material/dialog';\nimport {\n    BaseDirective,\n    DialogEvent\n} from '@mckinsey-converge/base';\n\n@Component({\n    selector: 'no-catering-modal',\n    templateUrl: './no-catering-modal.component.html',\n    styleUrls: ['./no-catering-modal.component.scss']\n})\nexport class NoCateringModalComponent extends BaseDirective {\n    constructor(\n        private _dialog_ref: MatDialogRef<NoCateringModalComponent>,\n    ) {\n        super();\n    }\n\n    // /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n\n    // Submit the Survey in it's current state.\n    public confirm() {\n        this.event.emit({ reason: 'done' });\n        this._dialog_ref.close();\n    }\n\n    // Close the modal\n    public cancel() {\n        this.event.emit({ reason: 'close' });\n        this._dialog_ref.close();\n    }\n}\n","<div>\n    <mat-dialog-content>\n        <div class=\"nc-modal\">\n            <div class=\"mck-column modal-heading\">\n                <div class=\"header\">\n                    <img src=\"assets/img/no-catering-room.svg\" />\n                    <p>Catering is not available for your new room selection. \n                    <br>Are you sure you want to change rooms?</p>\n                </div>\n            </div>\n            <mat-dialog-actions>\n                <mck-modal-button-row\n                    primaryLabel=\"Yes, proceed\" (primarySubmit)=\"confirm()\"\n                    secondaryLabel=\"Cancel\" (secondarySubmit)=\"cancel()\"\n                ></mck-modal-button-row>\n            </mat-dialog-actions>            \n        </div>\n    </mat-dialog-content>\n</div>","import {\n    Component,\n    ElementRef,\n    EventEmitter,\n    Inject,\n    OnInit,\n    Output,\n    ViewChild\n} from '@angular/core';\nimport {\n    AbstractControl,\n    FormControl,\n    FormGroup,\n    Validators\n} from '@angular/forms';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport {\n    BookingNote,\n    OrganisationService,\n    SettingsService,\n    Space,\n    UsersService\n} from '@mckinsey-converge/data-common';\nimport {\n    DialogEvent,\n    HashMap\n} from '@mckinsey-converge/base';\n\nimport { DateNow } from '@mckinsey-converge/date-tz';\n\n\nexport interface RequirementDetailsModalData {\n    spaces: Space[];\n    notes_field: AbstractControl;\n    codes_field: AbstractControl;\n    head_counts_field: AbstractControl;\n    standalone?: boolean;\n}\n\n@Component({\n    selector: 'a-requirement-details-modal',\n    templateUrl: './requirement-details-modal.component.html',\n    styleUrls: ['./requirement-details-modal.component.scss']\n})\nexport class RequirementDetailsModalComponent implements OnInit {\n    /** Emitter for modal events */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Mapping of spaces to notes */\n    public notes: HashMap<string> = {};\n    /** Mapping of spaces to cost codes */\n    public codes: HashMap<string> = {};\n    /** Mapping of spaces to estimated head count */\n    public head_counts: HashMap<string> = {};\n    /** Mapping of spaces to form fields */\n    public form: HashMap<FormGroup> = {};\n    /** Map of spaces to whether they need a charge code */\n    public needs_charge_code: HashMap<boolean> = {};\n    /** Index of the active space */\n    public active_space: number = 0;\n\n    @ViewChild('content', { static: true }) private _content_el: ElementRef<HTMLElement>;\n\n    /** List of selected spaces */\n    public get space_list(): Space[] {\n        return this._data.spaces;\n    }\n\n    public get has_recurrence(): boolean {\n        return false\n    }\n\n    public get active_form(): FormGroup {\n        return this.form[this.space_list[this.active_space].email];\n    }\n\n    public get invalid_charge_code(): boolean {\n        return this.active_form.controls.code.errors?.minlength || this.active_form.controls.code.errors?.pattern;\n    }\n\n    /** Whether form fields are valid */\n    public get is_valid(): boolean {\n        return this.space_list.reduce((valid, space) => valid && this.form[space.email].valid, true);\n    }\n\n    public isConcierge: boolean;\n    public frontend: string;\n\n    constructor(\n        private _org: OrganisationService,\n        private _users: UsersService,\n        @Inject(MAT_DIALOG_DATA) private _data: RequirementDetailsModalData,\n        private _settings: SettingsService,\n    ) {\n        this.isConcierge = _settings.concierge;\n        this.frontend = _settings.frontend;\n    }\n\n    public ngOnInit(): void {\n        const note_list = this._data.notes_field.value\n            .filter((note: BookingNote) => note.type === 'equipment');\n        this.notes = note_list.reduce((map, note) => {\n            map[note.space] = note.message;\n            return map;\n        }, {});\n        this.codes = { ...this._data.codes_field.value };\n        this.head_counts = { ...this._data.head_counts_field.value };\n        this.generateFormFields();\n    }\n\n    public submit(): void {\n        this.space_list.forEach(space => this.form[space.email].markAllAsTouched());\n        /* istanbul ignore else */\n        if (this.is_valid) {\n            // Update notes \n            const notes = this._data.notes_field.value\n                .filter((note: BookingNote) => note.type !== 'equipment');\n            const new_notes = this.space_list.map(space => ({\n                author: this._users.current.name,\n                type: 'equipment',\n                message: this.form[space.email].controls.notes.value.trim(),\n                space: space.email,\n                date: DateNow(new Date()).ms\n            } as BookingNote));\n            this._data.notes_field.setValue(notes.concat(new_notes).filter(note => note.message));\n            this._data.codes_field.setValue(this.space_list.reduce((map, space) => {\n                map[space.email] = this.form[space.email].controls.code.value;\n                return map;\n            }, {}));\n            this._data.head_counts_field.setValue(this.space_list.reduce((map, space) => {\n                map[space.email] = this.form[space.email].controls.head_count.value;\n                return map;\n            }, {}));\n            this.event.emit({ reason: 'done' });\n        } else {\n            this._content_el.nativeElement.scrollTo({\n                top: this._content_el.nativeElement.scrollHeight,\n                left: 0,\n                behavior: 'smooth'\n            });\n        }\n    }\n\n    /** Generate form fields for each space */\n    private generateFormFields(): void {\n        for (const space of this.space_list) {\n            const building = this._org.buildings.find(\n                bld => bld.id === space.level.building_id\n            );\n            // this.needs_charge_code[space.email] = space?.settings?.equipment_code || building?.required?.equipment_code || false;\n            const { filters, settings } = space;\n            const roomBasedEqCode = filters?.equipment_code || settings?.equipment_code;\n            const officeBasedEqCode = building?.required?.equipment_code;\n            this.needs_charge_code[space.email] = roomBasedEqCode !== undefined ? roomBasedEqCode : officeBasedEqCode !== undefined ? officeBasedEqCode: false;\n\n            this.form[space.email] = new FormGroup({\n                notes: new FormControl(this.notes[space.email] || ''),\n                code: new FormControl(\n                    this.codes[space.email] || '',\n                    this.needs_charge_code[space.email] ?\n                        [Validators.pattern(/^[a-zA-Z0-9]*$/), Validators.minLength(4),  Validators.required] : [Validators.minLength(4), Validators.pattern(/^[a-zA-Z0-9]*$/)]\n                ),\n                head_count: new FormControl(this.head_counts[space.email] || '', [Validators.required, Validators.pattern(/^(?!0+$)/)])\n            });\n        }\n    }\n}\n","<div class=\"header\">\n    <div class=\"tabs\">\n        <mat-tab-group [(selectedIndex)]=\"active_space\">\n            <mat-tab *ngFor=\"let space of space_list\">\n                <ng-template mat-tab-label>\n                    <span [class.error]=\"form[space.email].invalid && form[space.email].touched\">\n                        {{\n                        space.local_name +\n                        (form[space.email].invalid && form[space.email].touched ? '*' : '')\n                        }}\n                    </span>\n                </ng-template>\n            </mat-tab>\n        </mat-tab-group>\n    </div>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</div>\n<mat-dialog-content #content>\n    <main class=\"{{frontend}}\">\n        <div class=\"details\">\n            <img src=\"assets/img/equipment.svg\" />\n            <div class=\"text {{frontend}}\" i18n=\"Booking equipment information\">\n                {{\n                has_recurrence && !isConcierge\n                    ? 'To update headcount information, add equipment or catering, please edit individual meeting occurences in My Day'\n                    : \"Would you like to add equipment to your booking's spaces?\"\n                }}\n            </div>\n        </div>\n        <form *ngIf=\"space_list[active_space] && active_form\" [formGroup]=\"active_form\">\n            <div class=\"field\" *ngIf=\"!has_recurrence || isConcierge\">\n                <label for=\"equipment-notes\" i18n=\"Booking equipment notes label\">\n                    (eg - particular room configurations or specific equipment etc) Additional\n                    requests are handled in confidence\n                </label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        name=\"equipment-notes\"\n                        formControlName=\"notes\"\n                        placeholder=\"Add notes here...\"\n                        i18n-placeholder\n                    ></textarea>\n                </mat-form-field>\n            </div>\n            <div class=\"fieldset\">\n                <div\n                    class=\"field\"\n                    name=\"charge-code\"\n                    *ngIf=\"!has_recurrence || needs_charge_code[space_list[active_space].email] || isConcierge\"\n                >\n                    <label\n                        for=\"charge-code\"\n                        [class.error]=\"\n                            active_form.controls.code.touched && active_form.controls.code.invalid\n                        \"\n                        i18n=\"Booking equipment charge code label\"\n                    >\n                        Charge Code<span *ngIf=\"needs_charge_code[space_list[active_space].email]\"\n                    >*</span\n                    >\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"charge-code\"\n                            formControlName=\"code\"\n                            placeholder=\"Charge Code\"\n                            i18n-placeholder\n                        />\n                        <mat-hint i18n=\"Booking equipment charge code hint\">\n                            <span>Note:</span> Your booking will be confirmed before you are\n                            charged.\n                        </mat-hint>\n                        <mat-error i18n=\"Catering details charge code error\">\n                            {{ invalid_charge_code ? 'Valid Charge Code Required' : 'Charge Code is required'}}\n                        </mat-error>\n                    </mat-form-field>\n                </div>\n                <div class=\"field\" name=\"head-count\">\n                    <label\n                        for=\"head-count\"\n                        [class.error]=\"\n                            active_form.controls.head_count.touched &&\n                            active_form.controls.head_count.invalid\n                        \"\n                        i18n=\"Booking equipment headcount label\"\n                    >\n                        Headcount Estimate<span>*</span>\n                    </label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"head-count\"\n                            formControlName=\"head_count\"\n                            type=\"number\"\n                            placeholder=\"e.g. 12\"\n                            i18n-placeholder\n                            numbersOnly\n                        />\n                        <mat-hint i18n=\"Booking equipment headcount hint\">\n                            <span>Note:</span> This estimate is used to calculate catering and/or\n                            assign rooms. Please keep updated of any changes.\n                        </mat-hint>\n                        <mat-error i18n=\"Booking equipment headcount error\">\n                            Headcount Estimate is required\n                        </mat-error>\n                    </mat-form-field>\n                </div>\n            </div>\n        </form>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button name=\"next\" (click)=\"submit()\">Add to booking</button>\n    </footer>\n</mat-dialog-actions>\n","import {\n    Component,\n    EventEmitter,\n    Inject,\n    OnInit,\n    Output,\n} from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport {\n    BehaviorSubject,\n    Observable,\n    of,\n    Subject\n} from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    distinctUntilChanged,\n    first,\n    map,\n    switchMap,\n    take,\n    withLatestFrom\n} from 'rxjs/operators';\nimport {\n    Building,\n    mapBuildingToSelectOption,\n    mapCityToAllSelectOption,\n    OrganisationService,\n    SettingsService,\n    Space,\n    SpaceBookingRuleOptions,\n    SpacesService,\n    toggleSelectedByGroup,\n    User,\n    UsersService\n} from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport {\n    DialogEvent,\n    HashMap,\n    Identity,\n    unique\n} from '@mckinsey-converge/base';\nimport { NoCateringModalComponent } from '../no-catering-modal/no-catering-modal.component'\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { SelectOption } from '@mckinsey-converge/ui';\n\nexport interface SpaceSelectModalData {\n    /** List of selected spaces */\n    spaces: Space[];\n    /** Start time for availability of spaces */\n    dateTz: DateTZ;\n    /** Duration of the availability block to look for */\n    duration: number;\n    /** Host of the booking being made */\n    host: User;\n    /** Whether multiple spaces can be selected */\n    multiple: boolean;\n    /** Force zone ids */\n    zone_ids?: string;\n    /** Booking needs catering */\n    needsCatering?: boolean,\n}\n\n@Component({\n    selector: 'a-space-select-modal',\n    templateUrl: './space-select-modal.component.html',\n    styleUrls: ['./space-select-modal.component.scss']\n})\nexport class SpaceSelectModalComponent extends BaseDirective implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n    /** Whether space list is being loaded */\n    public loading: boolean;\n    /** List of available spaces to select from */\n    public spaces: Space[] = [];\n    /** Active building to filter spaces on */\n    public active_building: Building;\n    /** Active building to filter spaces on */\n    public active_type: Identity;\n    /** List of items from an API search */\n    public search_results$: Observable<Space[]>;\n    /** Subject holding the value of the search */\n    public readonly change$ = new Subject<string | string[]>();\n    /** List of currently selected spaces */\n    public selected_spaces: Space[] = [];\n    /** Mapping as to whether a space is by request */\n    public request_map: HashMap<boolean> = {};\n    /** Whether selected list should be shown on mobile */\n    public show_list: boolean;\n\n    /** host to load (only in staff) **/\n    public host: User;\n\n    /** List of available buildings */\n    public types: Identity[] = [];\n\n    public isConcierge: boolean;\n    public frontend: string;\n\n    /** List of available buildings */\n    public get buildings(): Building[] {\n        return this._org.buildings;\n    }\n\n    /** Whether multiple spaces can be selected */\n    public get multiple(): boolean {\n        return false;\n    }\n\n    public get has_zone(): boolean {\n        return !!this._data.zone_ids;\n    }\n\n    public formGroup = new FormGroup({\n        location: new FormControl([]),\n    });\n\n    public options = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public selectedOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n\n\n    public noCateringDialogRef: MatDialogRef<NoCateringModalComponent, any>;\n\n    /** List of zones to filter the spaces on */\n    public zone_ids: string[] = [];\n\n\n    public get initialBuildingIds(): string[] {\n        return this._org.building ? [this._org.building.id] : [];\n    }\n\n    public savedSelection\n\n    constructor(\n        private _org: OrganisationService,\n        private _users: UsersService,\n        private _spaces: SpacesService,\n        private _settings: SettingsService,\n        private _dialog: MatDialog,\n        @Inject(MAT_DIALOG_DATA) private _data: SpaceSelectModalData\n    ) {\n        super();\n        this.isConcierge = _settings.concierge;\n        this.frontend = _settings.frontend;\n    }\n\n    public ngOnInit(): void {\n        this._spaces.initialised.pipe(first((_) => _)).subscribe(() => {\n            let request_id = 0;\n            // Listen for input changes\n            this.search_results$ = this.change$.pipe(\n                debounceTime(400),\n                distinctUntilChanged(),\n                switchMap((bld) => {\n                    this.loading = true;\n                    const zone_ids: string[] = [];\n                    /* istanbul ignore else */\n                    if (this.active_building) {\n                        zone_ids.push(this.active_building.id);\n                    }\n\n                    if (bld?.includes('|')) {\n                        bld = this.savedSelection\n                    }\n\n                    const id = request_id;\n                    return this._spaces.available({\n                        zone_ids: bld?.length ? bld : this._data.spaces[0].building.id || zone_ids.join(','),\n                        dateTz: this._data.dateTz,\n                        duration: this._data.duration\n                    }).then(async (list) => ({ id, list }));\n                }),\n                catchError((_) => of({ id: request_id, list: [], error: _ })),\n                map((resp: { id: number, list: Space[] }) => {\n                    this.loading = false;\n                    const filtered_list = resp.list.filter((space: Space) => {\n                        // if concierge skip rules check.\n                        if (this._settings.concierge) {\n                            return (this.active_type && this.active_type.id ? space.zones.includes(`${this.active_type.id}`) : true) &&\n                                !this.selected_spaces.find((s) => s.id === space.id);\n                        }\n\n                        const rules = space.rulesFor({\n                            dateTz: this._data.dateTz,\n                            duration: this._data.duration,\n                            host: this.host || this._data.host\n                        });\n                        return (\n                            rules.hide !== true &&\n                            (this.active_type && this.active_type.id\n                                ? space.zones.includes(`${this.active_type.id}`)\n                                : true) &&\n                            !this.selected_spaces.find((_space) => _space.id === space.id)\n                        );\n                    });\n                    return resp.id === request_id ? filtered_list : this.spaces;\n                })\n            );\n            // Process API results\n            this.subscription(\n                'search_results',\n                this.search_results$.subscribe((list) => {\n                    this.spaces = list.filter((space) => {\n                        if (!space.available) {\n                            return false;\n                        }\n                        for (const zone of this.zone_ids) {\n                            if (space.zones.includes(zone)) {\n                                return true;\n                            }\n                        }\n                        return !this.zone_ids.length;\n                    });\n                    this.spaces.sort((a, b) => this.sort(a, b));\n                    if (!this.selectedOptions.value.length) {\n                        this.setDefaultBuilding()\n                    }\n                })\n            );\n            this.active_building = this._data.spaces?.length\n                ? this._org.buildings.find((i) => i.id === this._data.spaces[0].level.building_id)\n                : this._org.building;\n            this.types = [{ id: '', name: 'Any Space Type' } as any].concat(\n                this._org.space_types || []\n            );\n            this.active_type = this.types[0];\n            this.change$.next('');\n        });\n\n        this.subscription('buildings', this._org.listen('buildings').subscribe((bld_list) => {\n            const city = this._org.building.city\n            const timezone = this._org.building.timezone\n            const grouped_by_city = {\n                key: { name: city, timezone },\n                value: bld_list?.filter((bld) => bld.city === city) || []\n            }\n            const city_buildings = grouped_by_city.value.map(\n                (bld) => mapBuildingToSelectOption(grouped_by_city.key.name, bld)\n            )\n            const buildings = [\n                mapCityToAllSelectOption(grouped_by_city.key),\n                ...city_buildings\n            ]\n            this.options.next(buildings)\n        }));\n\n    }\n\n    /** Add space to selected list */\n    public addSpace(space: Space) {\n        this.selected_spaces.push(space);\n        this.selected_spaces = unique(this.selected_spaces, 'id');\n    }\n\n    /** Remove space from selected list */\n    public removeSpace(space: Space) {\n        this.selected_spaces = this.selected_spaces.filter((a_space) => a_space.id !== space.id);\n    }\n\n    /** Emit current state of the selected list */\n    public save(list: Space[]) {\n        if (!this._data.needsCatering) {\n            // No catering order to warn about\n            this.event.emit({ reason: 'done', metadata: list });\n            return;\n        }\n        // Check if the room has catering \n        if (list[0].has_catering) {\n            this.event.emit({ reason: 'done', metadata: list });\n            return;\n        }\n        // If not warn that the room doesn't have catering\n        this.noCateringDialogRef = this._dialog.open(NoCateringModalComponent, {\n            panelClass: 'mck-modal-mini',\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n        this.subscription(\n            'no-catering-modal',\n            this.noCateringDialogRef.componentInstance.event.subscribe((event) => {\n                if (event.reason === 'done') {\n                    this.event.emit({ reason: 'done', metadata: list });\n                }\n                if (event.reason === 'close') {\n                    this.event.emit({ reason: 'close' });\n                }\n            })\n        );\n    }\n\n    private update() {\n        const map = {};\n        const options: SpaceBookingRuleOptions = {\n            dateTz: this._data.dateTz,\n            duration: this._data.duration,\n            host: this._data.host\n        };\n        this.selected_spaces.forEach((space) => (map[space.id] = space.byRequest(options)));\n        this.spaces.forEach((space) => (map[space.id] = space.byRequest(options)));\n        this.request_map = map;\n    }\n\n    public setDefaultBuilding() {\n        const defaultBld = this.options.value.filter(opt => opt.value === this._org.building.id)\n        this.selectedOptions.next(defaultBld)\n    }\n\n    /**\n     * Compare two spaces to determine order\n     * @param space_a\n     * @param space_b\n     */\n    public sort(space_a: Space, space_b: Space) {\n        const bld = this._org.buildings.find((bld) => space_a.zones.includes(bld.id)) || { name: '', sort_order: [] };\n        const bld_b = this._org.buildings.find((bld) => space_b.zones.includes(bld.id));\n        if (bld && bld !== bld_b) {\n            return bld.name.localeCompare(bld_b?.name);\n        }\n        const sort_order = [...bld.sort_order].reverse();\n        for (const zone_id of sort_order) {\n            if (zone_id === '*') {\n                continue;\n            }\n            const a_has_zone = space_a.zones.indexOf(zone_id) >= 0;\n            const b_has_zone = space_b.zones.indexOf(zone_id) >= 0;\n            if (a_has_zone && !b_has_zone) {\n                return 1;\n            } else if (b_has_zone && !a_has_zone) {\n                return -1;\n            }\n        }\n        return space_a.name.localeCompare(space_b.name);\n    }\n\n    public toggle(option: SelectOption<any>) {\n        // update the selected value\n        this.selectedOptions.pipe(\n            take(1),\n            withLatestFrom(this.options),\n            map(([selectedOptions, options]) => {\n                return toggleSelectedByGroup(options, selectedOptions, option);\n            })\n        ).subscribe(next => {\n            const formData = this.formGroup.value;\n            this.formGroup.setValue({\n                location: formData.location,\n            });\n            this.selectedOptions.next(next);\n            this.savedSelection = next.map((bld) => bld.value)\n\n        });\n    }\n\n    /**\n     * Update the selected space list\n     * @param space Space to add/toggle in the selected list\n     */\n    public selectSpace(space: Space) {\n        const list = this.spaces;\n        if (list.find((item) => item.id === space.id)) {\n            this.spaces = list.filter((item) => item.id !== space.id);\n        } else {\n            this.spaces = [space];\n        }\n    }\n\n    public clearList() {\n        this.spaces = []\n        this.savedSelection = []\n    }\n\n    public triggerSearch = () => {\n        if (this.savedSelection.length) {\n            this.change$.next(this.savedSelection)\n        } else {\n            this.spaces = []\n        }\n    }\n\n}\n","<header>\n    <div class=\"heading\">Select meeting space{{ multiple ? 's' : '' }}</div>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content>\n    <main>\n        <div class=\"block available {{frontend}}\" [formGroup]=\"formGroup\">\n            <ng-container *ngIf=\"!has_zone\">\n                <mck-autocomplete-chip-select-item\n                    errorMessage=\"Location and office must be selected\"\n                    label=\"Location and office\"\n                    [required]=\"true\"\n                    [selectOnlyOneGroup]=\"true\"\n                    placeHolder=\"Start typing to filter location or office...\"\n                    formControlName=\"location\"\n                    [options]=\"options\"\n                    [selectedOptions]=\"selectedOptions\"\n                    (optionSelected)=\"toggle($event)\"\n                    [displayCTA]=\"true\"\n                    (chipsCleared)=\"clearList()\"\n                    [useCTAs]=\"true\"\n                    (onClickConfirm)=\"triggerSearch()\"\n                ></mck-autocomplete-chip-select-item>\n                <mck-label *ngIf=\"types && types.length > 1\">Type</mck-label>\n                <mat-form-field appearance=\"outline\" *ngIf=\"types && types.length > 1\">\n                    <mat-select\n                        #select\n                        [(value)]=\"active_type\"\n                        (valueChange)=\"change$.next(active_building.id + '|' + active_type.id)\"\n                    >\n                        <mat-option *ngFor=\"let type of types\" [value]=\"type\">\n                            {{ type?.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </ng-container>\n            <div class=\"list\">\n                <ng-container *ngIf=\"!loading; else load_state\">\n                    <ng-container *ngIf=\"spaces && spaces.length; else empty_state\">\n                        <div class=\"item\" *ngFor=\"let space of spaces\">\n                            <div class=\"details\">\n                                <div class=\"name\">{{ space.local_name }}</div>  \n                                <div class=\"info\">{{ space.level.name }}</div>\n                            </div>\n                            <div class=\"has-catering\" *ngIf=\"space.has_catering\">\n                                <app-icon\n                                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'restaurant' }\"\n                                    title=\"Catering Available\"\n                                ></app-icon>\n                            </div>\n                            <div class=\"capacity\">\n                                <app-icon\n                                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'account_circle' }\"\n                                    title=\"Room Capacity\"\n                                ></app-icon>\n                                <div class=\"text\">{{ space.capacity || '0' }}</div>\n                            </div>\n                            <div class=\"actions {{frontend}}\">\n                                <button\n                                    [class.request]=\"!isConcierge && request_map[space.id]\"\n                                    name=\"add\"\n                                    mat-button\n                                    (click)=\"multiple ? addSpace(space) : save([space])\"\n                                >\n                                    {{ (!isConcierge && request_map[space.id]) ? 'Request' : 'Select' }}\n                                </button>\n                            </div>\n                        </div>\n                    </ng-container>\n                </ng-container>\n            </div>\n        </div>\n        <div class=\"block selected {{frontend}}\" *ngIf=\"multiple\" [class.show]=\"show_list\">\n            <h3>Selected spaces</h3>\n            <div class=\"list\">\n                <ng-container\n                    *ngIf=\"selected_spaces && selected_spaces.length; else empty_select_state\"\n                >\n                    <div class=\"item\" *ngFor=\"let space of selected_spaces\">\n                        <div\n                            class=\"icon\"\n                            [class.request]=\"request_map[space.id]\"\n                            [matTooltip]=\"\n                                request_map[space.id]\n                                    ? 'Bookings in this space need to be approved by a member of the concierge team'\n                                    : ''\n                            \"\n                        >\n                            <app-icon\n                                [icon]=\"{\n                                    class: 'material-icons',\n                                    content: request_map[space.id] ? 'warning' : 'done'\n                                }\"\n                            ></app-icon>\n                        </div>\n                        <div class=\"details\">\n                            <div class=\"name\">{{ space.name }}</div>\n                            <div class=\"info\">{{ space.level.name }}</div>\n                        </div>\n                        <div class=\"capacity\">\n                            <app-icon\n                                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'account_circle' }\"\n                            ></app-icon>\n                            <div class=\"text\">{{ space.capacity || '0' }}</div>\n                        </div>\n                        <div class=\"actions {{frontend}}\">\n                            <button mat-icon-button name=\"remove\" (click)=\"removeSpace(space)\">\n                                <app-icon\n                                    [icon]=\"{ class: 'material-icons', content: 'close' }\"\n                                ></app-icon>\n                            </button>\n                        </div>\n                    </div>\n                </ng-container>\n            </div>\n            <footer>\n                <button mat-button name=\"next\" (click)=\"save(this.selected_spaces)\">Add to booking</button>\n            </footer>\n            <button mat-icon-button [class.close]=\"true\" [class.mobile-only]=\"true\" (click)=\"show_list = false\">\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n            </button>\n            <div class=\"tag mobile-only\">\n                <button mat-icon-button (click)=\"show_list = true\">\n                    <app-icon [icon]=\"{ class: 'material-icons', content: 'list' }\"></app-icon>\n                </button>\n            </div>\n        </div>\n    </main>\n</mat-dialog-content>\n<ng-template #load_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <mat-spinner diameter=\"48\"></mat-spinner>\n        </div>\n        <div class=\"text\">Loading available spaces...</div>\n    </div>\n</ng-template>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No results available, please select another office. </div>\n    </div>\n</ng-template>\n<ng-template #empty_select_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\">No selected spaces</div>\n    </div>\n</ng-template>\n","import { Component, Input } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\n\n@Component({\n  selector: 'user-form',\n  templateUrl: './user-form.component.html',\n  styleUrls: ['./user-form.component.scss']\n})\nexport class UserFormComponent {\n    /** Group of form fields used for creating the system */\n    @Input() public form: FormGroup;\n}\n","<div class=\"user form\" *ngIf=\"form\">\n    <form [formGroup]=\"form\">\n        <div class=\"field\" *ngIf=\"form.controls.name\">\n            <label\n                for=\"first-name\"\n                [class.error]=\"\n                    form.controls.first_name.invalid &&\n                    form.controls.first_name.touched\n                \"\n                i18n=\"User form first name label\"\n                >First Name:</label\n            >\n            <mat-form-field appearance=\"outline\">\n                <input\n                    matInput\n                    name=\"first-name\"\n                    placeholder=\"First name\"\n                    i18n-placeholder\n                    formControlName=\"first_name\"\n                    maxlength=\"50\"\n                />\n                <mat-error i18n=\"User form first name error\"\n                    >First name is required\n                </mat-error>\n            </mat-form-field>\n        </div>\n        <div class=\"field\" *ngIf=\"form.controls.name\">\n            <label\n                for=\"system-name\"\n                [class.error]=\"\n                    form.controls.last_name.invalid &&\n                    form.controls.last_name.touched\n                \"\n                i18n=\"User form last name label\"\n                >Last Name:</label\n            >\n            <mat-form-field appearance=\"outline\">\n                <input\n                    matInput\n                    name=\"last-name\"\n                    placeholder=\"Last name\"\n                    i18n-placeholder\n                    formControlName=\"last_name\"\n                    maxlength=\"50\"\n                />\n                <mat-error i18n=\"User form last name error\"\n                    >Last name is required</mat-error\n                >\n            </mat-form-field>\n        </div>\n        <div class=\"field\" *ngIf=\"form.controls.email\">\n            <label\n                for=\"email\"\n                [class.error]=\"\n                    form.controls.email.invalid && form.controls.email.touched\n                \"\n                i18n=\"User form email label\"\n                >Email:</label\n            >\n            <mat-form-field appearance=\"outline\">\n                <input\n                    matInput\n                    name=\"email\"\n                    placeholder=\"Email Address\"\n                    i18n-placeholder\n                    formControlName=\"email\"\n                />\n                <mat-error i18n=\"User form email error\"\n                    >A valid email is required</mat-error\n                >\n            </mat-form-field>\n        </div>\n    </form>\n</div>\n","export * from './lib/legacy-ui.module';\nexport * from './lib/custom-fields';\nexport * from './lib/icon/icon.component';\nexport * from './lib/feedback/feedback.component';\nexport * from './lib/action-icon/action-icon.component'\nexport * from './lib/user-avatar/user-avatar.component'\nexport * from './lib/bookings/catering/item/item.component'\n","import { Component, OnInit, Input } from '@angular/core';\nimport { ApplicationIcon } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'action-icon',\n    templateUrl: './action-icon.component.html',\n    styleUrls: ['./action-icon.component.scss']\n})\nexport class ActionIconComponent implements OnInit {\n    /** Icon to display */\n    @Input() public icon: ApplicationIcon;\n    /** Whether action is being processed */\n    @Input() public loading: boolean;\n    /** State of the action */\n    @Input() public state: 'success' | 'error' | '' = '';\n\n    constructor() {}\n\n    ngOnInit(): void {}\n}\n","<div class=\"action-icon\" [class.fade]=\"state || loading\">\n    <app-icon [icon]=\"icon\"></app-icon>\n    <div class=\"'state center ' + state\" *ngIf=\"!loading && state\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: state === 'success' ? 'done' : 'close' }\"></app-icon>\n    </div>\n    <div class=\"loader center\" *ngIf=\"loading\">\n        <mat-spinner [diameter]=\"16\"></mat-spinner>\n    </div>\n</div>\n","import {\n    Component,\n    Input,\n    OnChanges,\n    SimpleChanges\n} from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { FormControl } from '@angular/forms';\n\nimport {\n    ApplicationService,\n    CateringCategory,\n    CateringItem,\n    SettingsService\n} from '@mckinsey-converge/data-common';\nimport { ANIMATION_SHOW_CONTRACT_EXPAND } from '@mckinsey-converge/animations';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { PackageOptionsModalComponent } from '../package-options-modal/package-options-modal.component';\n\nfunction hasSelectionRequirements(category: CateringCategory) {\n    return (\n        category.must_select < category.items.length ||\n        (category.must_select === category.items.length &&\n            category.items.find((item: any) => item.items && item.must_select < item.items.length))\n    );\n}\n\nfunction getActiveList(category: CateringCategory) {\n    const items = category.items || [];\n    let list = items.filter((item) => item.amount > 0).map((item) => item.id);\n    for (const item of items) {\n        if ((item as any).items && (item as any).items.length) {\n            list = list.concat(getActiveList(item as any));\n        }\n    }\n    return list;\n}\n\n@Component({\n    selector: 'a-catering-menu-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss'],\n    animations: [ANIMATION_SHOW_CONTRACT_EXPAND]\n})\nexport class CateringMenuItemComponent extends BaseDirective implements OnChanges {\n    /** Whether item is a child of another */\n    @Input() public subitem: boolean;\n    /** Item to display */\n    @Input() public item: CateringCategory;\n    /** Field for storing items */\n    @Input() public field: FormControl;\n    /** Current symbol for the selected space */\n    @Input() public symbol: string;\n    /** Whether item should be disabled if not available anytime */\n    @Input() public disabled: boolean;\n    /** Whether to show smaller version of component */\n    @Input() public compact: boolean;\n    /** Whether to show children items */\n    public show_children: boolean;\n    public initial_state = null;\n\n    /** List of contents of the package */\n    public get contents(): string {\n        return this.item.items\n            ? this.item.items.reduce((list, item) => {\n                /* istanbul ignore else */\n                if (list) {\n                    list += '\\n\\n';\n                }\n                return (list += `${item.name}${\n                    (item as any).items\n                        ? (item as any).items.reduce(\n                        (a_list, an_item) =>\n                            (a_list += `\\n ${an_item.amount ? '' : ''} ${an_item.name} `),\n                        ''\n                        )\n                        : ''\n                } ${item.amount ? '' : ''}`);\n            }, '')\n            : '';\n    }\n\n    constructor(private _service: ApplicationService, private _dialog: MatDialog,\n                public settings: SettingsService) {\n        super();\n        // on the item selection set the revert/close state\n        this.initial_state = this.item;\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.field && this.field) {\n            const list = this.field.value;\n            // check the category\n            let item = list.find((an_cat) => an_cat.id === this.item.id);\n            if (item) {\n                // update the category level amount\n                this.item.setAmount(item ? item.amount : 0);\n            } else {\n                // find a category item\n                for (var cat of list) {\n                    item = cat?.items.find((an_item) => an_item.id === this.item.id);\n                    if (item) {\n                        this.item.setAmount(item ? item.amount : 0);\n                        break;\n                    }\n                };                \n            } \n\n            // On the confirm catering order modal set the revert/close state\n            if (!this.initial_state && this.item.amount) {\n                this.initial_state = this.item;\n            }\n\n            this.subscription(\n                'field_change',\n                this.field.valueChanges.subscribe((list) => {\n                    const item = list.find((an_item) => an_item.id === this.item.id);\n                    this.item.setAmount(item ? item.amount : 0);\n                    this.updatePackageSelection();\n                })\n            );\n        }\n    }\n\n    /**\n     * Update the amount of the item in the order\n     * @param value New amount\n     */\n    public updateAmount(value: number) {\n        /* istanbul ignore else */\n        if (this.field) {\n            const list: CateringItem[] = this.field.value;\n            const item = list.find((an_item) => an_item.id === this.item.id);\n            if (item) {\n                this.item.setAmount(value);\n                item.setAmount(value);\n                // MCK-1550 fix\n                const price = this.item.price;\n                item.setPrice(price)\n            } else {\n                const amount = this.item.amount;\n                this.item.setAmount(value);\n                if (\n                    this.item.package &&\n                    amount < value &&\n                    this.item.items &&\n                    this.item.items.length &&\n                    hasSelectionRequirements(this.item)\n                ) {\n                    this.selectPackageOptions().then(\n                        (confirmed_item) => {\n                            list.push(new CateringCategory(confirmed_item));\n                            this.field.setValue(list.filter((an_item) => an_item.amount));\n                        },\n                        () => {\n                            this.item.setAmount(999);\n                            this.timeout('amount', () => this.item.setAmount(0), 5);\n                            this._service.notifyWarn(\n                                'Package options not selected. Item removed from order'\n                            );\n                        }\n                    );\n                } else {\n                    list.push(new CateringItem(this.item));\n                }\n            }\n            this.field.setValue(list.filter((an_item) => an_item.amount));\n        }\n    }\n\n    public updatePackageSelection() {\n        const cart_item = this.field.value.find((item) => item.id === this.item.id);\n        if (cart_item) {\n            const active_items = getActiveList(cart_item);\n            this.timeout(\n                'update_package',\n                () => {\n                    this.item.items.forEach((item) => {\n                        item.setAmount(active_items.includes(item.id) ? 1 : 0);\n                        if ((item as any).items) {\n                            (item as any).items.forEach((item) => {\n                                item.setAmount(active_items.includes(item.id) ? 1 : 0);\n                            });\n                        }\n                    });\n                },\n                5\n            );\n        }\n    }\n\n    /** Reselect package options */\n    public updatePackageOptions(): void {\n        let updatedList: CateringItem[] = [];\n        this.selectPackageOptions().then(\n            (confirmed_item) => {\n                // Update the existing category package\n                this.field.value.forEach((category: CateringCategory) => {\n                    if (category.id === confirmed_item.id) {\n                        updatedList.push(new CateringCategory(confirmed_item))\n                    } else {\n                        updatedList.push(category)\n                    }\n                })\n                this.field.setValue(updatedList.filter((an_item) => an_item.amount));\n            },\n            () => {\n                this.item.setAmount(999);\n                this.timeout('amount', () => this.item.setAmount(0), 5);\n                this._service.notifyWarn(\n                    'Package options not selected. Item removed from order'\n                );\n            }\n        );\n    }\n\n    /**\n     * Open modal for user to select package options\n     */\n    private selectPackageOptions(): Promise<CateringCategory> {\n        return new Promise((resolve, reject) => {\n            const ref = this._dialog.open(PackageOptionsModalComponent, {\n                maxWidth: '95vw',\n                data: {\n                    item: new CateringCategory(this.item)\n                },\n                autoFocus: false,\n                backdropClass: 'mck-modal-backdrop',\n            });\n            let done = false;\n            ref.componentInstance.event.subscribe((event) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    done = true;\n                    resolve(ref.componentInstance.item);\n                    this.initial_state = this.item;\n                    ref.close();\n                }\n            });\n            ref.afterClosed().subscribe(() => {\n                /* istanbul ignore else */\n                if (!done) {\n                    if (this.initial_state) {\n                        resolve(this.initial_state);\n                    } else {\n                        reject();\n                    }\n                }\n            });\n        });\n    }\n}\n","<div\n    class=\"catering-item\"\n    *ngIf=\"item && (!item.out_of_stock || settings.concierge)\"\n    [class.compact]=\"compact\"\n    [class.subitem]=\"subitem\"\n    [attr.disabled]=\"disabled && !item.can_order_anytime\"\n>\n    <div\n        class=\"image\"\n        *ngIf=\"!subitem\"\n        [style.background-image]=\"'url(' + item.image_path + ')' | safe:'style'\"\n    ></div>\n    <div class=\"details\">\n        <div class=\"name\">{{ item.name }}</div>\n        <div class=\"description\">{{ item.package ? '[Package] ' : '' }}{{ item.description }}</div>\n        <div class=\"options\">\n            <div class=\"option price mobile-only\" *ngIf=\"item.unit_price\">\n                {{ item.unit_price / 100 | currency: symbol }}\n            </div>\n            <div\n                class=\"option\"\n                *ngIf=\"item.package && item.availableItems.length && !item.must_select\"\n                [matTooltip]=\"contents\"\n                i18n=\"Catering order item available options label\"\n            >\n                { item.availableItems.length, plural, =1 { Contains {{ item.availableItems.length }} item } other {\n                Contains {{ item.availableItems.length }} items } }\n            </div>\n            <div\n                class=\"option\"\n                *ngIf=\"item.package && item.must_select && item.amount > 0\"\n                [matTooltip]=\"contents\"\n            >\n                {{ item.must_select }}\n                <span class=\"not-mobile\" i18n=\"Catering order item selected options label\">\n                    Selected\n                </span>\n            </div>\n            <button\n                mat-button\n                *ngIf=\"item.package && item.must_select && item.amount > 0\"\n                (click)=\"updatePackageOptions()\"\n                i18n=\"Catering order item options change action\"\n            >\n                Customise\n            </button>\n        </div>\n    </div>\n    <div class=\"option price not-mobile\" *ngIf=\"item.unit_price\">\n        {{ item.unit_price / 100 | currency: symbol }}\n    </div>\n    <a-counter\n        *ngIf=\"!item.availableItems.length || item.package\"\n        [useInput]=\"item.must_select === 0 || item.availableItems.length === 0\"\n        [max]=\"item.maximum_quantity\"\n        [ngModel]=\"item.amount\"\n        (ngModelChange)=\"updateAmount($event)\"\n    ></a-counter>\n    <button\n        mat-icon-button\n        *ngIf=\"item.availableItems && item.availableItems.length && !item.package\"\n        (click)=\"show_children = !show_children\"\n    >\n        <app-icon\n            [icon]=\"{\n                class: 'material-icons',\n                content: show_children ? 'keyboard_arrow_up' : 'keyboard_arrow_down'\n            }\"\n        ></app-icon>\n    </button>\n</div>\n<div class=\"children\" [@show]=\"show_children ? 'show' : 'hide'\">\n    <a-catering-menu-item\n        *ngFor=\"let sub_item of item.availableItems\"\n        [compact]=\"compact\"\n        [subitem]=\"true\"\n        [symbol]=\"symbol\"\n        [item]=\"sub_item\"\n        [disabled]=\"!settings.concierge && disabled\"\n        [field]=\"field\"\n    ></a-catering-menu-item>\n</div>\n","import {\n    Component,\n    EventEmitter,\n    Inject,\n    Output\n} from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nimport {\n    DialogEvent,\n    HashMap\n} from '@mckinsey-converge/base';\nimport {\n    CateringCategory,\n    CateringItem\n} from '@mckinsey-converge/data-common';\n\nexport interface PackageOptionsModalData {\n    item: CateringCategory;\n}\n\nexport function checkItemRequirements(category: CateringCategory): boolean {\n    const items = category.items || [];\n    return category.must_select >= items.length\n        ? items.reduce((valid, item) => valid && checkItemRequirements(item as any), true)\n        : items.reduce((amount, item) => amount + (item.amount ? 1 : 0), 0) ===\n        category.must_select;\n}\n\nexport function getActiveItems(category: CateringCategory): HashMap<string> {\n    let map = {};\n    if (category.items) {\n        const item = category.items.find(item => item.amount > 0);\n        if (item) {\n            map[category.id] = item.id;\n        }\n        category.items.forEach(item => map = { ...map, ...getActiveItems(item as any) });\n    }\n    return map;\n}\n\n@Component({\n    selector: 'a-package-options-modal',\n    templateUrl: './package-options-modal.component.html',\n    styleUrls: ['./package-options-modal.component.scss']\n})\nexport class PackageOptionsModalComponent {\n    /** Emitter for user actions on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n\n    /** Item to select options for */\n    public get item(): CateringCategory {\n        return this._data.item;\n    }\n\n    /** Whether package requirements have been met */\n    public get requirements_met(): boolean {\n        return checkItemRequirements(this.item);\n    }\n\n    public get active_items(): HashMap<string> {\n        return getActiveItems(this.item);\n    }\n\n    constructor(@Inject(MAT_DIALOG_DATA) private _data: PackageOptionsModalData) {\n    }\n\n    /**\n     * Update the list of selected items\n     */\n    public updateAmount(a_package: CateringCategory, option: CateringItem, state: boolean) {\n        if (state) {\n            const needed = a_package.must_select;\n            const active = a_package.items.filter(an_item => an_item.amount > 0).length;\n            if (active >= needed) {\n                const item = a_package.items.find(an_item => an_item.amount > 0);\n                item.setAmount(0);\n            }\n            option.setAmount(1);\n        } else {\n            option.setAmount(0);\n        }\n    }\n}\n","<header>\n    <h3 i18n=\"Catering package options header\">Package Options</h3>\n    <button mat-icon-button mat-dialog-close>\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n    </button>\n</header>\n<mat-dialog-content class=\"package-options\">\n    <main>\n        <ng-container *ngTemplateOutlet=\"item_display; context: { package: item }\"></ng-container>\n    </main>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <footer>\n        <button mat-button [disabled]=\"!requirements_met\" (click)=\"event.emit({ reason: 'done' })\" i18n=\"Catering package options save action\">\n            Confirm Options\n        </button>\n    </footer>\n</mat-dialog-actions>\n<ng-template #item_display let-package=\"package\">\n    <ng-container *ngIf=\"package.availableItems && package.availableItems.length\">\n        <mat-radio-group [ngModel]=\"active_items[package.id]\">\n            <div class=\"item\" *ngFor=\"let option of package.availableItems\" [attr.to-select]=\"option.must_select\">\n            <ng-container\n                *ngIf=\"\n                    package.must_select &&\n                    package.must_select < package.items.length &&\n                    !option.must_select\n                \"\n            >\n                <mat-checkbox\n                    *ngIf=\"package.must_select > 1\"\n                    [checked]=\"!!option.amount\"\n                    (change)=\"updateAmount(package, option, $event.checked)\"\n                >\n                    {{ option.name }}\n                </mat-checkbox>\n                <mat-radio-button\n                    *ngIf=\"package.must_select === 1\"\n                    [value]=\"option.id\"\n                    (change)=\"updateAmount(package, option, true)\"\n                >\n                    {{ option.name }}\n                </mat-radio-button>\n            </ng-container>\n            <ng-container *ngIf=\"package.must_select >= package.items.length || option.must_select\">\n                {{ option.name }}\n            </ng-container>\n            <ng-container\n                *ngTemplateOutlet=\"item_display; context: { package: option }\"\n            ></ng-container>\n        </div>\n    </mat-radio-group>\n    </ng-container>\n</ng-template>\n","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\n\n@Component({\n  selector: 'an-action-field',\n  templateUrl: './action-field.component.html',\n  styleUrls: ['./action-field.component.scss']\n})\nexport class ActionFieldComponent extends BaseDirective {\n    /** Name of the field */\n    @Input() public name: string;\n    /** Value to display on the field */\n    @Input() public placeholder: string;\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Emitter for user interaction events */\n    @Output('onAction') public on_action = new EventEmitter();\n    /** Whether to show tooltip */\n    public show_tooltip = false;\n\n    /**\n     * Emit that the user has performed an action on the field\n     */\n    public performAction() {\n        this.show_tooltip = !this.show_tooltip;\n        this.on_action.emit();\n    }\n}\n","<div\n    class=\"action-field\"\n    role=\"button\"\n    [attr.disabled]=\"disabled\"\n    form-field\n    tabindex=\"0\"\n    (keydown.enter)=\"performAction()\"\n    (click)=\"performAction()\"\n>\n    <div class=\"display\">{{ placeholder }}</div>\n    <div class=\"icon\">\n        <app-icon\n            [icon]=\"{\n                type: 'icon',\n                class: 'material-icons',\n                content: show_tooltip ? 'arrow_drop_up' : 'arrow_drop_down'\n            }\"\n        ></app-icon>\n    </div>\n</div>\n","import { Component, forwardRef, Input } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\n\n@Component({\n    selector: 'a-counter',\n    templateUrl: './counter.component.html',\n    styleUrls: ['./counter.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            /* istanbul ignore next */\n            useExisting: forwardRef(() => CounterComponent),\n            multi: true,\n        },\n    ],\n})\nexport class CounterComponent implements ControlValueAccessor {\n    /** Maximum amount for the counter */\n    @Input() public max: number = 10;\n    /** Minimum amount for the counter */\n    @Input() public min: number = 0;\n\n    @Input() public useInput = false;\n\n    /** Current value of the counter */\n    public value: number;\n    public previous_value: number = 0;\n    /** Whether shift key is being held by the user */\n    public shift_key: boolean;\n    /** Whether control key is being held by the user */\n    public ctrl_key: boolean;\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    /**\n     * Add the `step` to the current value\n     */\n    public add() {\n        if (!this.value) {\n            this.value = this.min || 0;\n        }\n        const step = this.ctrl_key ? 100 : this.shift_key ? 10 : 1;\n        this.value += step;\n        if (this.value > this.max) {\n            this.value = this.max || 10;\n        }\n        this.setValue(this.value);\n    }\n\n    /** Remove the `step` from the current value */\n    public remove() {\n        if (!this.value) {\n            this.value = this.min || 0;\n        }\n        const step = this.ctrl_key ? 100 : this.shift_key ? 10 : 1;\n        this.value -= step;\n        if (this.value < this.min) {\n            this.value = this.min || 0;\n        }\n        this.setValue(this.value);\n    }\n\n    public handleTimeout = null;\n\n    public onInputChange(new_value: string) {\n        if (this.handleTimeout) {\n            clearTimeout(this.handleTimeout);\n            this.handleTimeout = null;\n        }\n        this.handleTimeout = setTimeout(() => this.changeInput(new_value), 500);\n    }\n\n    public changeInput(new_value: string) {\n        let value = Number(new_value);\n        if (isNaN(value)) {\n            value = this.previous_value;\n        }\n        if (value < this.min) {\n            value = this.min || 0;\n        }\n        if (value > this.max) {\n            value = this.max || 10;\n        }\n        this.setValue(value);\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number): void {\n        this.previous_value = new_value;\n        this.value = new_value;\n        /* istanbul ignore else */\n        if (this._onChange) {\n            this._onChange(new_value);\n        }\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.value = value;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n}\n","<div\n    class=\"counter\"\n    (window:keydown.shift)=\"shift_key = true\"\n    (window:keydown.control)=\"ctrl_key = true\"\n    (window:keydown.meta)=\"ctrl_key = true\"\n    (window:keyup.shift)=\"shift_key = false\"\n    (window:keyup.control)=\"ctrl_key = false\"\n    (window:keyup.meta)=\"ctrl_key = false\"\n>\n    <button mat-icon-button name=\"remove\" [disabled]=\"!value || value === min\" (click)=\"remove()\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'remove' }\"></app-icon>\n    </button>\n    <input\n        #inputValue\n        aria-label=\"value input\"\n        *ngIf=\"useInput\"\n        (keyup.enter)=\"onInputChange(inputValue.value)\"\n        (blur)=\"onInputChange(inputValue.value)\"\n        (ngModelChange)=\"onInputChange($event)\"\n        [(ngModel)]=\"value\"\n        class=\"value\"/>\n    <div class=\"value\" *ngIf=\"!useInput\" aria-label=\"value\">\n        {{value || '0'}}\n    </div>\n    <button mat-icon-button name=\"add\" [disabled]=\"value === max\" (click)=\"add()\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'add' }\"></app-icon>\n    </button>\n</div>\n","import { Component, OnInit, forwardRef, Input, ViewChild, Output, EventEmitter } from '@angular/core';\nimport { NG_VALUE_ACCESSOR, ControlValueAccessor } from '@angular/forms';\nimport { MatMenuTrigger } from '@angular/material/menu';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'a-date-field',\n    templateUrl: './date-field.component.html',\n    styleUrls: ['./date-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DateFieldComponent),\n            multi: true\n        }\n    ]\n})\nexport class DateFieldComponent extends BaseDirective implements OnInit, ControlValueAccessor {\n    /** Earliest date available the user is allowed to pick */\n    @Input('from') public _from: number = DateNow(new Date()).ms;\n    /** Latest date available the user is allowed to pick */\n    @Input('to') public _to: number;\n    /** Position of the tooltip */\n    @Input() public position: 'right' | 'left' = 'right';\n    /** Offset of the tooltip */\n    @Input() public offset: 'top' | 'bottom' = 'bottom';\n    /** Whether form control is disabled */\n    @Input() public disabled: boolean;\n    /** Whether form control is invalid, touched and contains errors */\n    @Input() public error?: boolean;\n    /** Optional event emitter for changes */\n    @Output() public onChange = new EventEmitter();\n    /** Whether to show the calendar tooltip */\n    public show_tooltip: boolean;\n    /** Currently selected date */\n    public date: number;\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    @ViewChild(MatMenuTrigger, { static: true }) private _trigger: MatMenuTrigger;\n\n    /** First allowed date on the calendar */\n    public get from(): number {\n        return this._from || DateNow(new Date()).startOfValue('day').ms;\n    }\n    /** Current date value */\n    public get until(): number {\n        return this._to || DateNow(new Date()).endOfValue('day').addValue({ years: 1 }).ms;\n    }\n    /** Display value for the current date */\n    public get date_string(): string {\n        // R--- Needs TZ aware inputs\n        const date = new DateTZ({date: this.date})\n        return date.formatDate('dd MMM yyyy');\n    }\n\n    /** Whether date picker is open */\n    public get is_open(): boolean {\n        return this._trigger.menuOpen;\n    }\n\n    public ngOnInit() {\n        this.date = DateNow(new Date()).ms;\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number) {\n        // Keep hours and minutes of the old date\n        const old_date = new DateTZ({date: this.date });\n        const new_d = new DateTZ({date: new_value})\n        let new_date = new_d\n            .setValue({ hour: old_date.dateHour, minute: old_date.minutes })\n            .ms;\n        // Check that new date is before from\n        if (new_date < this.from) {\n            new_date = this.from;\n        }\n        this.date = new_date;\n        if (this._onChange) {\n            this._onChange(new_date);\n            this.onChange.emit(new_date);\n        }\n        this.show_tooltip = false;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.date = value;\n        this.show_tooltip = false;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /** Set the state of the tooltip to closed after delay */\n    public closeDatePicker() {\n        this._trigger.closeMenu();\n    }\n\n    /** Set the state of the tooltip to closed after delay */\n    public openDatePicker() {\n        this._trigger.openMenu();\n    }\n}\n","<div\n    class=\"date-field\"\n    role=\"button\"\n    form-field\n    tabindex=\"0\"\n    [class.active]=\"is_open\"\n    [class.error]=\"error\"\n    [attr.disabled]=\"disabled\"\n    (keydown.enter)=\"openDatePicker()\"\n    [matMenuTriggerFor]=\"appMenu\"\n>\n    <div class=\"display\">{{ date_string }}</div>\n    <div class=\"icon\">\n        <app-icon\n            [icon]=\"{\n                type: 'icon',\n                class: 'material-icons',\n                content: is_open ? 'arrow_drop_up' : 'arrow_drop_down'\n            }\"\n        ></app-icon>\n    </div>\n</div>\n<mat-menu #appMenu=\"matMenu\">\n    <div mat-menu-item class=\"date-picker\" (click)=\"$event.stopPropagation()\">\n        <aca-date-picker\n            [ngModel]=\"date\"\n            [options]=\"{ from: from, to: until }\"\n            (ngModelChange)=\"setValue($event); closeDatePicker()\"\n        ></aca-date-picker>\n    </div>\n</mat-menu>\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\n\nimport {\n    humaniseDuration,\n    Identity,\n    timeFormatString\n} from '@mckinsey-converge/base';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'a-duration-field',\n    templateUrl: './duration-field.component.html',\n    styleUrls: ['./duration-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DurationFieldComponent),\n            multi: true\n        }\n    ]\n})\nexport class DurationFieldComponent extends BaseDirective\n    implements OnInit, OnChanges, ControlValueAccessor {\n    /** Maximum duration option available */\n    @Input() public max: number = 240;\n    /** Minimum duration option available */\n    @Input() public min: number = 15;\n    /** Step value between options */\n    @Input() public step: number = 15;\n    /** Reference time for displaying next to durations */\n    @Input() public time: number;\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Special case prepopulation i.e. out of step options */\n    @Input() public specialPreprops: Array<number> = [];\n    /** Whether form all_day is enabled. */\n    @Input() public all_day: boolean = false;\n\n    public duration: number = 60;\n    /** List of available duration options */\n    public duration_options: Identity[];\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    public ngOnInit(): void {\n        this.duration_options = this.generateDurationOptions(this.max, this.min, this.step, this.all_day);\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.max || changes.min || changes.step || changes.time || changes.all_day) {\n            this.duration_options = this.generateDurationOptions(this.max, this.min, this.step, this.all_day);\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number): void {\n        this.duration = new_value;\n        /* istanbul ignore else */\n        if (this._onChange) {\n            this._onChange(+new_value);\n        }\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.duration = value;\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n\n    private generateDurationOptions(max: number, min: number, step: number, all_day: boolean = false): Identity[] {\n        const blocks: Identity[] = [];\n        let time = min;\n        // R--- Change input to dateTz\n        let date = this.time ? new DateTZ({date: this.time}) : null;\n\n        // Add special case for 10min duration/prepropulation\n        for (const option of this.specialPreprops) {\n            blocks.push({\n                id: option,\n                name: date\n                    ? `${date.addValue({ minutes: option }).formatDate(timeFormatString()).toLocaleLowerCase()} (${humaniseDuration(option)})`\n                    : `${humaniseDuration(option)}`\n            });\n        }\n\n\n        while (time <= max) {\n            blocks.push({\n                id: time,\n                name: date\n                    ? `${date.addValue({ minutes: time }).formatDate(timeFormatString()).toLocaleLowerCase()} (${humaniseDuration(time)})`\n                    : `${humaniseDuration(time)}`\n            });\n            time += step;\n        }\n        if (all_day) {\n           blocks.push({ id: 24 * 60, name: 'All Day' }); \n        }\n        blocks.push({ id: 7 * 24 * 60, name: '1 week' });\n        return blocks;\n    }\n}\n","<div class=\"duration-field\" [attr.disabled]=\"disabled\">\n    <mat-form-field appearance=\"outline\">\n        <mat-select #select [value]=\"duration\" [disabled]=\"disabled\" (valueChange)=\"setValue($event)\">\n            <mat-option *ngFor=\"let option of duration_options\" [value]=\"option.id\">\n                {{ option.name }}\n            </mat-option>\n        </mat-select>\n    </mat-form-field>\n</div>\n","export * from './action-field/action-field.component'\nexport * from './counter/counter.component'\nexport * from './date-field/date-field.component'\nexport * from './duration-field/duration-field.component'\nexport * from './time-field/time-field.component'\nexport * from './user-search-field/user-search-field.component'\nexport * from './user-list-field/user-list-field.component'\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n    ViewChild\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\nimport { MatSelect } from '@angular/material/select';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport {\n    Identity,\n    timeFormatString\n} from '@mckinsey-converge/base';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'a-time-field',\n    templateUrl: './time-field.component.html',\n    styleUrls: ['./time-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => TimeFieldComponent),\n            multi: true\n        }\n    ]\n})\nexport class TimeFieldComponent extends BaseDirective implements OnInit, OnChanges, ControlValueAccessor {\n    /** Time step between each allowed time option */\n    @Input() public step: number = 15;\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Whether past times are allowed */\n    @Input() public no_past_times: boolean = true;\n    /** String representing the currently set time */\n    public date: number = DateNow(new Date()).ms;\n    /** String representing the currently set time */\n    public time: string = DateNow(new Date()).formatDate('HH:mm');\n    /** Available time blocks for the selected date */\n    public _time_options: Identity[];\n    /** Whether select field should be shown */\n    public show_select: boolean;\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    /** Select field for selecting the time */\n    @ViewChild('select') private select_field: MatSelect;\n\n    // R--- This is the form input that needs to be TZ active.\n    public ngOnInit(): void {\n        this.show_select = true;\n        this._time_options = this.generateAvailableTimes(this.date, !this.no_past_times, this.step);\n        this.timeout('hide', () => this.show_select = false);\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.no_past_times || changes.step) {\n            this._time_options = this.generateAvailableTimes(this.date, !this.no_past_times, this.step);\n        }\n    }\n\n    public get date_(){\n        return new DateTZ({date: this.date})\n    }\n\n    /** Available time blocks for the selected date */\n    public get time_options() {\n        const time = (this.time || '00:00').split(':');\n        const date = this.date_.setValue({ hour: +time[0], minute: +time[1] });\n        if (date.minutes % 15 !== 0 && !this._time_options.find(time => time.id === date.formatDate('HH:mm'))) {\n            this._time_options.push({\n                name: `${date.formatDate(timeFormatString())}`,\n                id: date.formatDate('HH:mm')\n            });\n            this._time_options.sort((a, b) => `${a.id}`.localeCompare(`${b.id}`));\n        }\n        return this._time_options;\n    }\n\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: string): void {\n        this.time = new_value;\n        if (this._onChange) {\n            const time = (this.time || '00:00').split(':');\n            const date = this.date_.setValue({ hour: +time[0], minute: +time[1] }).startOfValue('minute');\n            this._onChange(date.ms);\n        }\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        if (!value) {\n            return;\n        }\n        this.date = value;\n        let date = this.date_.startOfValue('minute');\n        date = date.setValue({ minute: Math.ceil(date.minutes / 5) * 5 });\n        this.time = date.formatDate('HH:mm');\n        this._time_options = this.generateAvailableTimes(this.date, !this.no_past_times, this.step);\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n\n    /**\n     * Show select field for time options\n     */\n    public showSelect() {\n        this.show_select = true;\n        this.timeout('on_shown', () => {\n            if (this.select_field) {\n                this.select_field.focus();\n                this.select_field.open();\n                this.subscription('listen_close', this.select_field.openedChange.subscribe((state) => {\n                    if (!state) {\n                        this.show_select = false;\n                    }\n                }));\n            }\n        });\n    }\n\n    /**\n     * Generate a list of time options for the given date\n     * @param datestamp Date to generate options for\n     * @param show_past Whether past times should be options\n     */\n    private generateAvailableTimes(datestamp: number, show_past: boolean, step: number = 15): Identity[] {\n        let date = new DateTZ({date: datestamp});\n        const blocks = [];\n        if (show_past || date.isAfterDate(DateNow(new Date()))) {\n            date = date.startOfValue('day');\n        } else if (date.isAfterDate(DateNow(new Date()))) {\n            date = DateNow(new Date());\n        }\n        date = date.setValue({ minute: Math.ceil(date.minutes / step) * step });\n        const end = date.endOfValue('day');\n        // Add options for the rest of the day\n        while (date.isBeforeDate(end)) {\n            blocks.push({\n                name: `${date.formatDate(timeFormatString()).toLocaleLowerCase()}`,\n                id: date.formatDate('HH:mm')\n            });\n            date = date.addValue({ minutes: step });\n        }\n        return blocks;\n    }\n}\n","<div\n    class=\"time-field\"\n    role=\"button\"\n    [style.display]=\"show_select ? 'none' : ''\"\n    [attr.disabled]=\"disabled\"\n    form-field\n    tabindex=\"0\"\n    (keydown.enter)=\"showSelect()\"\n>\n    <div class=\"display\">\n        <input\n            matInput\n            type=\"time\"\n            [disabled]=\"disabled\"\n            [ngModel]=\"time\"\n            (ngModelChange)=\"setValue($event)\"\n        />\n    </div>\n    <div class=\"icon\" (click)=\"showSelect()\">\n        <app-icon\n            [icon]=\"{\n                type: 'icon',\n                class: 'material-icons',\n                content: show_select ? 'arrow_drop_up' : 'arrow_drop_down'\n            }\"\n        ></app-icon>\n    </div>\n</div>\n<mat-form-field appearance=\"outline\" *ngIf=\"show_select\">\n    <mat-select #select [value]=\"time\" [disabled]=\"disabled\" (valueChange)=\"setValue($event)\">\n        <mat-option *ngFor=\"let option of time_options\" [value]=\"option.id\">\n            {{ option.name }}\n        </mat-option>\n    </mat-select>\n</mat-form-field>\n","import {\n    ChangeDetectorRef,\n    Component,\n    EventEmitter,\n    forwardRef,\n    Input,\n    OnInit,\n    Output,\n    ViewChild\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\nimport {\n    Observable,\n    of,\n    Subject\n} from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    distinctUntilChanged,\n    tap,\n    map,\n    switchMap,\n    finalize\n} from 'rxjs/operators';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport {\n    ApplicationService,\n    User,\n    UsersService\n} from '@mckinsey-converge/data-common';\nimport {\n    csvToJson,\n    downloadFile,\n    filterList,\n    matchToHighlight\n} from '@mckinsey-converge/base';\nimport { MatAutocompleteTrigger } from '@angular/material/autocomplete';\n\n@Component({\n    selector: 'a-user-list-field',\n    templateUrl: './user-list-field.component.html',\n    styleUrls: ['./user-list-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => UserListFieldComponent),\n            multi: true\n        }\n    ]\n})\nexport class UserListFieldComponent extends BaseDirective implements OnInit, ControlValueAccessor {\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Number of characters needed before a search will start */\n    @Input() public limit: number = 3;\n    /** Emitter for action to make a new user */\n    @Output('newUser') public new_user = new EventEmitter<void>();\n\n    /** User list to display */\n    public user_list: User[];\n    /** List of active selected users on the list */\n    public active_list: User[];\n    /** Whether user list is loading */\n    public loading: boolean;\n    /** String  */\n    public search_str: string;\n    /** List of users from an API search */\n    public search_results$: Observable<User[]>;\n    /** Subject holding the value of the search */\n    public search$ = new Subject<string>();\n\n    /** Form control on change handler */\n    private _onChange: (_: User[]) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: User[]) => void;\n\n    @ViewChild(MatAutocompleteTrigger, {read: MatAutocompleteTrigger}) inputAutoComplete: MatAutocompleteTrigger;\n\n    constructor(private _service: ApplicationService, private _users: UsersService,  private cdRef: ChangeDetectorRef) {\n        super();\n    }\n\n    ngOnInit() {\n        // Listen for input changes\n        this.search_results$ = this.search$.pipe(\n            debounceTime(100),\n            distinctUntilChanged(),\n            switchMap((query) => {\n                this.loading = true;\n                return query.length >= this.limit\n                    ? this._users.query({\n                        q: query.slice(0, Math.max(this.limit, 3)),\n                        cache: 60 * 1000\n                    })\n                    : Promise.resolve([]);\n            }),\n            catchError((_) => of([])),\n            map((list: User[]) => {\n                this.loading = false;\n                return filterList(this.search_str, list, ['name', 'email']);\n            })\n        );\n        // Process API results\n        this.subscription(\n            'search_results',\n            this.search_results$.subscribe((list) => {\n                this.user_list = list;\n                this.user_list.forEach((i: any) => {\n                    i.match_name = matchToHighlight(i.match_name);\n                    i.match_email = matchToHighlight(i.match_email);\n                    return i;\n                });\n                this.user_list.length ? this.inputAutoComplete.openPanel() : this.inputAutoComplete.closePanel();\n            })\n        );\n    }\n\n    /**\n     * Add user to the user list\n     * @param user\n     */\n    public addUser(user: User) {\n        /* istanbul ignore else */\n        if (!this.active_list) {\n            this.active_list = [];\n        }\n        const index = this.active_list.findIndex((a_user) => a_user.id === user.id);\n        /* istanbul ignore else */\n        if (index < 0) {\n            this.active_list = [...this.active_list, user];\n        }\n        this.setValue(this.active_list);\n        this.search_str = '';\n    }\n\n    /**\n     * Remove user from the user list\n     * @param user\n     */\n    public removeUser(user: User) {\n        this.active_list = this.active_list.filter((a_user) => a_user.id !== user.id);\n        this.setValue(this.active_list);\n    }\n\n    /**\n     * Load CSV file and populate the user list with the contents\n     * @param event File input field event\n     */\n    public addUsersFromFile(event) {\n        /* istanbul ignore else */\n        if (event.target) {\n            const file = event.target.files[0];\n            /* istanbul ignore else */\n            if (file) {\n                const reader = new FileReader();\n                reader.readAsText(file, 'UTF-8');\n                reader.addEventListener('load', (evt) => {\n                    this.processCsvData((evt.srcElement as any).result);\n                    event.target.value = '';\n                    this.cdRef.detectChanges();\n                });\n                reader.addEventListener('error', (_) =>\n                    this._service.notifyError('Error reading file.')\n                );\n            }\n        }\n    }\n\n    /**\n     * Process raw CSV data and save user data to attendee list\n     * @param data CSV data\n     */\n    private processCsvData(data: string) {\n        const list = csvToJson(data) || [];\n        const id = this._users.current.staff_code;\n        list.forEach((el) => {\n            el.name = el.name || `${el.first_name} ${el.last_name}`;\n            const display = (el.name || `${Math.floor(Math.random() * 9999_9999)}`)\n                .split(' ')\n                .join('_')\n                .toLowerCase();\n            /* istanbul ignore else */\n            if (!el.email) {\n                el.email = `${display}+${id}@guest.mckinsey.com`;\n            }\n            el.type = 'external';\n            el.external = !el.email.endsWith(\"@mckinsey.com\") && !el.email.endsWith(\"@external.mckinsey.com\");\n            this.addUser(new User(el));\n        });\n    }\n\n    /* istanbul ignore next */\n    /** Download template CSV file */\n    public downloadCSVTemplate() {\n        const template = `Organisation Name,First Name,Last Name,Email,Phone\\nFake Org,John,Smith,john.smith@example.com,01234567898`;\n        downloadFile('template.csv', template);\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: User[]): void {\n        this.active_list = new_value;\n        if (this._onChange) {\n            this._onChange(new_value);\n        }\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: User[]) {\n        this.active_list = value;\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: User[]) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: User[]) => void): void {\n        this._onTouch = fn;\n    }\n}\n","<div class=\"user-list-field\" form-field [attr.disabled]=\"disabled\">\n    <mat-form-field appearance=\"outline\">\n        <input\n            matInput\n            name=\"user-search\"\n            type=\"text\"\n            [(ngModel)]=\"search_str\"\n            (ngModelChange)=\"search$.next($event.trim())\"\n            [disabled]=\"disabled\"\n            placeholder=\"Search for user...\"\n            i18n-placeholder\n            [matAutocomplete]=\"auto\"\n            #trigger=\"matAutocompleteTrigger\"  \n        />\n        <div class=\"prefix\" matPrefix>\n            <app-icon\n                [icon]=\"{ type: 'icon', class: 'material-icons', content: 'search' }\"\n            ></app-icon>\n        </div>\n        <div class=\"suffix\" matSuffix *ngIf=\"loading\">\n            <mat-spinner diameter=\"16\"></mat-spinner>\n        </div>\n    </mat-form-field>\n    <mat-autocomplete #auto=\"matAutocomplete\" (optionSelected)=\"addUser($event.option.value)\">\n        <mat-option *ngFor=\"let option of user_list\" [value]=\"option\">\n            <div class=\"name\">{{ option.name }}</div>\n            <div class=\"email\">{{ option.email }}</div>\n        </mat-option>\n    </mat-autocomplete>\n    <div class=\"actions\">\n        <button type=\"button\" name=\"new-contact\" matRipple (click)=\"new_user.emit()\" i18n=\"Add new external attendee\">\n            Add External\n        </button>\n        <button type=\"button\" name=\"upload-csv\" matRipple i18n=\"Upload attendee list from CSV file\">\n            Upload CSV\n            <input type=\"file\" (change)=\"addUsersFromFile($event)\" />\n        </button>\n        <button type=\"button\" name=\"download-template\" matRipple (click)=\"downloadCSVTemplate()\" i18n=\"Download template CSV file\">\n            CSV Template\n        </button>\n    </div>\n    <div class=\"user-list\">\n        <mat-chip-list\n            aria-label=\"User List\"\n            *ngIf=\"active_list && active_list.length; else empty_state\"\n        >\n            <mat-chip\n                *ngFor=\"let user of active_list\"\n                [id]=\"user.email\"\n                [color]=\"user.external ? 'accent' : 'primary'\"\n                [removable]=\"true\"\n                (removed)=\"removeUser(user)\"\n            >\n                {{ user.name }}\n                <app-icon\n                    matChipRemove\n                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"\n                ></app-icon>\n            </mat-chip>\n        </mat-chip-list>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div i18n=\"Attendee empty state\">No attendees</div>\n</ng-template>\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnInit,\n    ViewChild\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\nimport {\n    Observable,\n    of,\n    Subject\n} from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    distinctUntilChanged,\n    map,\n    switchMap\n} from 'rxjs/operators';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport {\n    User,\n    UsersService\n} from '@mckinsey-converge/data-common';\nimport {\n    filterList,\n    matchToHighlight\n} from '@mckinsey-converge/base';\nimport { MatAutocompleteTrigger } from '@angular/material/autocomplete';\n\n@Component({\n    selector: 'a-user-search-field',\n    templateUrl: './user-search-field.component.html',\n    styleUrls: ['./user-search-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => UserSearchFieldComponent),\n            multi: true\n        }\n    ]\n})\nexport class UserSearchFieldComponent extends BaseDirective implements OnInit, ControlValueAccessor {\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Limit available options to these */\n    @Input() public options: User[];\n    /** Currently selected user */\n    public active_user: User;\n    /** User list to display */\n    public user_list: User[];\n    /** Whether user list is loading */\n    public loading: boolean;\n    /** Current display value of the search input field  */\n    public search_str: string;\n    /** List of users from an API search */\n    public search_results$: Observable<User[]>;\n    /** Subject holding the value of the search */\n    public search$ = new Subject<string>();\n\n    /** Form control on change handler */\n    private _onChange: (_: User) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: User) => void;\n    @ViewChild(MatAutocompleteTrigger, {read: MatAutocompleteTrigger}) inputAutoComplete: MatAutocompleteTrigger;\n    \n    constructor(private _users: UsersService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n\n        // Listen for input changes\n        this.search_results$ = this.search$.pipe(\n            debounceTime(400),\n            distinctUntilChanged(),\n            switchMap(query => {\n                this.loading = true;\n                return this.options && this.options.length > 0\n                    ? Promise.resolve(this.options)\n                    : query.length >= 3\n                        ? (this._users.query({ q: query, cache: 60 * 1000 }) as Promise<User[]>)\n                        : Promise.resolve([]);\n            }),\n            catchError((err) => of([])),\n            map((list: User[]) => {\n                this.loading = false;\n                return filterList(this.search_str, list, ['name', 'email']);\n            })\n        );\n        // Process API results\n        this.subscription('search_results', this.search_results$.subscribe(list => {\n            this.user_list = list;\n            this.user_list.forEach((i: any) => {\n                i.match_name = matchToHighlight(i.match_name);\n                i.match_email = matchToHighlight(i.match_email);\n                return i;\n            });\n            this.user_list.length ? this.inputAutoComplete.openPanel() : this.inputAutoComplete.closePanel();\n        }));\n    }\n\n    /**\n     * Reset the search string back to the name of the active user\n     */\n    public resetSearchString() {\n        if (this.active_user) {\n            this.search_str = this.active_user.name;\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: User): void {\n        this.active_user = new_value;\n        if (this._onChange) {\n            this._onChange(new_value);\n        }\n        this.resetSearchString();\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: User) {\n        this.active_user = value;\n        this.resetSearchString();\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: User) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: User) => void): void {\n        this._onTouch = fn;\n    }\n}\n","<div class=\"user-search-field\" form-field>\n    <mat-form-field appearance=\"outline\">\n        <input\n            matInput\n            name=\"user-search\"\n            [(ngModel)]=\"search_str\"\n            (ngModelChange)=\"search$.next($event)\"\n            [disabled]=\"disabled\"\n            placeholder=\"Search for user...\"\n            i18n-placeholder\n            [matAutocomplete]=\"auto\"\n            (blur)=\"resetSearchString()\"\n            #trigger=\"matAutocompleteTrigger\"  \n        />\n        <div class=\"prefix\" matPrefix>\n            <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'search' }\"></app-icon>\n        </div>\n        <div class=\"suffix\" matSuffix *ngIf=\"loading\">\n            <mat-spinner diameter=\"16\"></mat-spinner>\n        </div>\n    </mat-form-field>\n    <mat-autocomplete #auto=\"matAutocomplete\" (optionSelected)=\"setValue($event.option.value)\">\n        <mat-option *ngFor=\"let option of user_list\" [value]=\"option\">\n            <div class=\"name\">{{ option.name }}</div>\n            <div class=\"email\">{{ option.email }}</div>\n        </mat-option>\n    </mat-autocomplete>\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { NavigationEnd, Router } from '@angular/router';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\n\n@Component({\n    selector: 'feedback',\n    templateUrl: './feedback.component.html',\n    styleUrls: ['./feedback.component.scss'],\n})\nexport class FeedbackComponent extends BaseDirective implements OnInit {\n    /** Name of the currently active page */\n    public current_page: string;\n\n    constructor(private _router: Router) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.timeout('Getting Title', () => this.updateRoute(document.title), 1000);\n        this._router.events.subscribe((event: NavigationEnd) => {\n            /* istanbul ignore else */\n            if (event instanceof NavigationEnd) {\n                this.timeout('Getting Title', () => this.updateRoute(document.title));\n            }\n        });\n    }\n\n    public updateRoute(location) {\n        location = location.substr(0, location.indexOf(' |'));\n        this.current_page = location;\n    }\n}\n","<a [href]=\"'mailto:converge_feedback@mckinsey.com?subject=Feedback for page: ' + current_page\">\n    <div class=\"feedback-button\">\n        <span class=\"text\" i18n>Feedback</span>\n        <span class=\"icon\">\n            <app-icon [icon]=\"{class:'material-icons', content: 'feedback'}\"></app-icon>\n        </span>\n    </div>\n</a>\n","import {\n    Component,\n    Input\n} from '@angular/core';\nimport { ApplicationIcon } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\n@Component({\n    selector: 'app-icon',\n    templateUrl: './icon.component.html',\n    styleUrls: ['./icon.component.scss']\n})\nexport class IconComponent extends BaseDirective {\n    @Input() public icon: ApplicationIcon;\n}\n","<div class=\"app-icon\" *ngIf=\"icon\">\n    <i *ngIf=\"icon.type !== 'img'\" [class]=\"icon.class\">{{ icon.content }}</i>\n    <img *ngIf=\"icon.type === 'img'\" [src]=\"icon.src | safe:'resource'\" />\n</div>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport {\n    ActionFieldComponent,\n    CounterComponent,\n    DateFieldComponent,\n    DurationFieldComponent,\n    TimeFieldComponent,\n    UserListFieldComponent,\n    UserSearchFieldComponent\n} from './custom-fields';\nimport { IconComponent } from './icon/icon.component';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatRippleModule } from '@angular/material/core';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\nimport { ACA_PIPES_MODULE } from '@acaprojects/ngx-pipes';\nimport {\n    FormsModule,\n    ReactiveFormsModule\n} from '@angular/forms';\nimport { FeedbackComponent } from './feedback/feedback.component';\nimport { ActionIconComponent } from './action-icon/action-icon.component';\nimport { PopoutMenuComponent } from './popout-menu/popout-menu.component';\nimport { SearchbarComponent } from './searchbar/searchbar.component';\nimport { UserAvatarComponent } from './user-avatar/user-avatar.component';\nimport { CateringMenuItemComponent } from './bookings/catering/item/item.component';\nimport { PackageOptionsModalComponent } from './bookings/catering/package-options-modal/package-options-modal.component';\nimport { BaseModule } from '@mckinsey-converge/base';\nimport { UiModule } from '@mckinsey-converge/ui';\n\nconst DECLARATIONS = [\n    ActionFieldComponent,\n    IconComponent,\n    CounterComponent,\n    DateFieldComponent,\n    DurationFieldComponent,\n    TimeFieldComponent,\n    UserSearchFieldComponent,\n    UserListFieldComponent,\n    FeedbackComponent,\n    ActionIconComponent,\n    PopoutMenuComponent,\n    SearchbarComponent,\n    UserAvatarComponent,\n    CateringMenuItemComponent,\n    PackageOptionsModalComponent\n];\n\nconst MATERIAL_MODULES: any[] = [\n    MatButtonModule,\n    MatSnackBarModule,\n    MatDialogModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatProgressSpinnerModule,\n    MatProgressBarModule,\n    MatAutocompleteModule,\n    MatSelectModule,\n    MatChipsModule,\n    MatRippleModule,\n    MatMenuModule,\n    MatCheckboxModule,\n    MatTooltipModule,\n    MatRadioModule,\n    MatTabsModule,\n    MatSlideToggleModule\n];\n\n@NgModule({\n    imports: [\n        CommonModule,\n        ACA_PIPES_MODULE,\n        FormsModule,\n        ReactiveFormsModule,\n        ...MATERIAL_MODULES,\n        BaseModule,\n        UiModule\n    ],\n    declarations: [\n        ...DECLARATIONS\n    ],\n    exports: [\n        ACA_PIPES_MODULE,\n        ...DECLARATIONS,\n        ...MATERIAL_MODULES,\n        BaseModule,\n    ]\n})\nexport class LegacyUiModule {\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output\n} from '@angular/core';\nimport { ApplicationIcon } from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\nexport interface PopoutAction extends ApplicationIcon {\n    /** ID of the action */\n    id: string;\n}\n\n@Component({\n    selector: 'a-popout-menu',\n    templateUrl: './popout-menu.component.html',\n    styleUrls: ['./popout-menu.component.scss']\n})\nexport class PopoutMenuComponent extends BaseDirective {\n    /** List of available actions */\n    @Input() public actions: PopoutAction[] = [];\n    /** Emitter for user actions */\n    @Output() public action = new EventEmitter<string>();\n    /** Whether actions should show */\n    public show: boolean;\n\n    public close() {\n        this.timeout('close', () => {\n            this.show = false;\n        });\n    }\n}\n","<button\n    mat-icon-button\n    [class.small]=\"true\"\n    name=\"action\"\n    *ngFor=\"let item of actions; let i = index\"\n    [style.top]=\"show ? (-110 * i - 60) + '%' : ''\"\n    (click)=\"action.emit(item.id); show = false\"\n>\n    <app-icon [icon]=\"item\"></app-icon>\n</button>\n<button mat-icon-button name=\"menu\" [class.show]=\"show\" (click)=\"show = !show\" (window:click)=\"show ? close() : ''\">\n    <app-icon [icon]=\"{ class: 'material-icons', content: show ? 'add' : 'more_vert' }\"></app-icon>\n</button>\n","import { Component, OnInit, Input, EventEmitter, Output, ViewChild, ElementRef, SimpleChanges, OnChanges } from '@angular/core';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\n@Component({\n    selector: 'a-searchbar',\n    templateUrl: './searchbar.component.html',\n    styleUrls: ['./searchbar.component.scss']\n})\nexport class SearchbarComponent extends BaseDirective implements OnChanges {\n    /** Current contents of the searchbar input */\n    @Input('value') public value: string;\n    /** Current contents of the searchbar input */\n    @Input() public placeholder: string;\n    /** Whether external changes are being processed */\n    @Input() public loading: boolean;\n    /** Whether external changes are being processed */\n    @Input() public autofocus: boolean;\n    /** Emitter for changes to the searchbar value */\n    @Output() public valueChange = new EventEmitter<string>();\n    /** Input field reference */\n    @ViewChild('input', { static: true }) private input_field: ElementRef<HTMLInputElement>;\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.autofocus && this.autofocus) {\n            this.focusField()\n        }\n    }\n\n    public focusField() {\n        /* istanbul ignore else */\n        if (this.input_field && this.input_field.nativeElement) {\n            this.input_field.nativeElement.focus();\n        }\n    }\n}\n","<div class=\"searchbar\" tabindex=\"0\" (focus)=\"focusField()\" (click)=\"focusField()\">\n    <div class=\"prefix\">\n        <app-icon [icon]=\"{ type: 'icon', class: 'material-icons', content: 'search' }\"></app-icon>\n    </div>\n    <div class=\"input\">\n        <input #input\n            type=\"text\"\n            [(ngModel)]=\"value\"\n            (ngModelChange)=\"valueChange.emit($event)\"\n            [placeholder]=\"placeholder || 'Search...'\"\n            i18n-placeholder\n        />\n    </div>\n    <div class=\"suffix\" *ngIf=\"loading\">\n        <mat-spinner diameter=\"32\"></mat-spinner>\n    </div>\n</div>\n","import { Component, Input } from '@angular/core';\nimport { User } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-user-avatar',\n    templateUrl: './user-avatar.component.html',\n    styleUrls: ['./user-avatar.component.scss']\n})\nexport class UserAvatarComponent {\n    /** User to display avatar for */\n    @Input() public user: User;\n\n    public get initials(): string {\n        if (!this.user) {\n            return 'NA';\n        }\n        const parts = this.user.name.split(' ');\n        return parts.length > 1\n            ? `${parts[0][0]}${parts[parts.length - 1][0]}`\n            : this.user.name.slice(0, 2);\n    }\n}\n","<div class=\"user-avatar\" *ngIf=\"user\" [attr.user-id]=\"user.id\">\n    <div class=\"initials\" *ngIf=\"!user.image; else image_state\">{{ initials }}</div>\n</div>\n<ng-template #image_state>\n    <img [src]=\"user.image | safe: 'resource'\" />\n</ng-template>\n","export * from './lib/loading.actions'\nexport * from './lib/loading.model'\nexport * from './lib/loading.effects'\nexport * from './lib/loading.selectors'\nexport * from '../testing'\n","import {\n    createAction,\n    createSelector,\n    on,\n    On,\n    props\n} from '@ngrx/store';\nimport {\n    LoadingModel,\n    wrapLoading\n} from './loading.model';\nimport {\n    selectIsLoading,\n    selectOptionalError,\n    selectOptionalSuccess,\n    selectSuccess\n} from './loading.selectors';\nimport { MemoizedSelector } from '@ngrx/store/src/selector';\nimport {\n    ActionCreator,\n    NotAllowedCheck,\n    TypedAction\n} from '@ngrx/store/src/models';\nimport { HashMap } from '@mckinsey-converge/base';\n\nexport interface Payload<T> {\n    payload: T\n}\n\nexport type LoadingAction<T> = T & TypedAction<string>\nexport type LoadingActionCreator<T extends null | undefined | object> = T extends null | undefined ?\n    ActionCreator<string, () => TypedAction<string>>\n    : ActionCreator<string, (props: T & NotAllowedCheck<T>) => LoadingAction<T>>\n\ntype ClearAction = ActionCreator<string, () => TypedAction<string>>\n\ninterface Selectors<TState, TRequest, TSuccess> {\n    success: MemoizedSelector<TState, TSuccess>\n    optionalSuccess: MemoizedSelector<TState, TSuccess | undefined>\n    error: MemoizedSelector<TState, Error | undefined>\n    loading: MemoizedSelector<TState, boolean>\n    model: (TState) => LoadingModel<TSuccess>\n}\n\nexport interface LoadingActionObject<TState, TRequest extends object | undefined, TSuccess> {\n    request: LoadingActionCreator<TRequest>\n    success: LoadingActionCreator<Payload<TSuccess>>\n    error: LoadingActionCreator<Payload<Error>>\n    clear: ClearAction,\n    ons: On<TState>[],\n    selectors: Selectors<TState, TRequest, TSuccess>\n}\n\n/**\n * Creates a {@link LoadingActionObject} that contains a set of ActionCreators\n * for request, success, error, loading, and clear data. Also, it contains\n * the necessary On reducers and selectors in order to properly connect them in\n * a standardized way to data in the application.\n *\n * `TState` is the type of data on your reducer, not global store.\n * `TRequest` is an object type to use in request methods.\n * `TSuccess` is the object type of the T parameter on `LoadingModel`.\n *\n * This assumes you have state represented by:\n * ```typescript\n * interface SomeState {\n *   stateKey: LoadingModel<TSuccess>\n * }\n * ```\n *\n * To dispatch an action:\n * ```typescript\n *\n * // request parameters depend on the object type used as second type parameter\n * // in createLoadingAction\n * this.store.dispatch(someLoadingAction.request())\n *\n * // action created with createLoadingAction<SomeState, { name: string, age: int }>\n * this.store.dispatch(someLoadingAction.request({\n *   name: 'Andrew G',\n *   age: 24\n * }))\n *\n * ```\n *\n * The generated selectors only select data from its fractured state, not the global\n * store. In order to use them, make sure you {@link select} the global state\n * before using them:\n *\n * ```typescript\n *\n * this.store.pipe(\n *   select(selectSomeState),\n *   select(someLoadingAction.selectors.success)\n * ).subscribe(next => {\n *\n * })\n *\n * ```\n *\n * @param actionPrefix - Prefixes actions to uniquely identify them.\n * @param stateKey -  The field within the reducer state to set data on.\n */\nexport const createLoadingAction = <TState, TSuccess extends object = {}, TRequest extends object | undefined = undefined>(\n    actionPrefix: string,\n    stateKey: keyof TState\n): LoadingActionObject<TState, TRequest, TSuccess> => {\n    const buildAction = (postfix: string) => `[${actionPrefix}] ${postfix}`;\n    // @ts-ignore\n    const request = createAction(buildAction('request'), props<TRequest>());\n    const success = createAction(buildAction('success'), props<Payload<TSuccess>>());\n    const error = createAction(buildAction('error'), props<Payload<Error>>());\n    const clear = createAction(buildAction('clear'));\n    const ons: On<TState>[] = [\n        on(request, (state: TState & HashMap<LoadingModel<TSuccess>>, action: LoadingAction<TRequest>) =>\n            ({\n                ...state,\n                [stateKey]: wrapLoading<TSuccess>(state[stateKey]).loading()\n            })),\n        on(success, (state: TState & HashMap<LoadingModel<TSuccess>>, action: LoadingAction<Payload<TSuccess>>) => ({\n            ...state,\n            [stateKey]: LoadingModel.success(action.payload)\n        })),\n        // some reason specifying state like in success and request does not work.\n        on(error, (state: any, action: LoadingAction<Payload<Error>>) => ({\n            ...state,\n            [stateKey]: LoadingModel.error<TSuccess>(action.payload)\n        })),\n        on(clear, () => ({\n            ...this.state,\n            [stateKey]: LoadingModel.empty()\n        }))\n    ];\n    const selectData = (state: TState) => {\n        if (!state) {\n            console.warn('[LoadingActions] State is empty for key', stateKey);\n        }\n        return wrapLoading<TSuccess>(state?.[stateKey] as unknown as LoadingModel<TSuccess>);\n    };\n    const selSuccess = createSelector<TState, LoadingModel<TSuccess>, TSuccess>(\n        selectData,\n        selectSuccess\n    );\n    const selOptionalSuccess = createSelector(\n        selectData,\n        selectOptionalSuccess\n    );\n    const selError = createSelector(\n        selectData,\n        selectOptionalError\n    );\n    const selLoading = createSelector(\n        selectData,\n        selectIsLoading\n    );\n    return {\n        request,\n        success,\n        error,\n        clear,\n        ons,\n        selectors: {\n            success: selSuccess,\n            optionalSuccess: selOptionalSuccess,\n            error: selError,\n            loading: selLoading,\n            model: selectData\n        }\n    };\n};\n","import {\n  Actions,\n  ofType\n} from '@ngrx/effects';\n\nimport { \n  LoadingAction,\n  LoadingActionObject\n} from '../../../loading/src/lib/loading.actions';\n\nimport {\n  catchError,\n  flatMap,\n  map\n} from 'rxjs/operators';\nimport {\n  Observable,\n  of\n} from 'rxjs';\nimport { TypedAction } from '@ngrx/store/src/models';\n\n/**\n * This creates an effect to use in Effects classes. This coordinates a simple\n * success and error payload effect.\n * @param actions - The actions object\n * @param actionObject - The created createLoadingAction object.\n * @param caller - Define what API method or asynchronous operation is needed to\n * run this. Return TSuccess.\n */\nexport const createLoadingEffect = <TState, TSuccess = {}, TRequest extends object | undefined = {}>(\n  actions: Actions, actionObject: LoadingActionObject<TState, TRequest, TSuccess>,\n  caller: (action: LoadingAction<TRequest>) => Promise<TSuccess>): Observable<TypedAction<string>> => actions.pipe(\n  ofType(actionObject.request),\n  flatMap((action) => caller(action as LoadingAction<TRequest>)),\n  map((response: TSuccess) => actionObject.success({ payload: response })),\n  catchError(err => {\n    return of(actionObject.error({ payload: err }));\n  })\n);\n","/* eslint-disable no-underscore-dangle,no-useless-constructor */\n/**\n * Wraps around the typical data objects we write for success, error, loading, and empty state. This convenience\n * wrapper consolidates all of that logic into a handy wrapper.\n */\nexport class LoadingModel<T = {}> {\n    static empty = <T>() => new LoadingModel<T>(false, false, false, undefined);\n\n    static success = <T>(success?: T): LoadingModel<T> =>\n        new LoadingModel(false, false, true, success);\n\n    static error = <T>(error?: Error, optionalSuccess?: T): LoadingModel<T> =>\n        new LoadingModel<T>(false, true, false, optionalSuccess, error);\n\n    /**\n     * Mutates the model with a success state, preserving other state fields.\n     * @param success - override success state.\n     */\n    mutate = <T2 = T>(\n        success: T2 | null) => new LoadingModel(\n        this.isLoading,\n        this.hasError,\n        !!success,\n        !success ? undefined : success\n    );\n\n    loading = (success: T | null = this.success) =>\n        new LoadingModel(\n            true,\n            false,\n            !!success && this.hasSuccess,\n            !success ? undefined : success\n        );\n\n    public get success(): T {\n        return this._success as T;\n    }\n\n    public get optionalSuccess(): T | undefined {\n        return this._success;\n    }\n\n    constructor(\n        public isLoading: boolean,\n        private hasError: boolean,\n        private hasSuccess: boolean,\n        private _success?: T,\n        public error?: Error\n    ) {\n    }\n\n    isEmpty = () => !this.isSuccess() && !this.isError();\n\n    hasLoaded = () => !this.isEmpty() && !this.isLoading;\n\n    isSuccess = () => this.hasSuccess;\n\n    isError = () => this.hasError;\n\n    shouldLoad = () => !this.isSuccess() && !this.isLoading;\n\n    public toString = () =>\n        `Loading: ${this.isLoading}, Success: ${this.hasSuccess}:**${this._success}**, ` +\n        `Error: ${this.hasError}:${this.error}`;\n}\n\n/**\n * Wraps an object that conforms to LoadingModel to restore object loss from\n * hydrating state during development.\n */\nexport const wrapLoading = <T extends any>(loading: any): LoadingModel<T> => {\n    if (loading instanceof LoadingModel) {\n        return loading;\n    } else {\n        if (!loading) {\n            return LoadingModel.empty();\n        } else {\n            return new LoadingModel(\n                loading.isLoading || false,\n                loading.hasError || false,\n                loading.hasSuccess || false,\n                loading._success,\n                loading.error\n            );\n        }\n    }\n};\n","import { LoadingModel, wrapLoading } from './loading.model';\n\nexport const selectSuccess = <T>(state: LoadingModel<T>) =>\n  wrapLoading<T>(state).success;\nexport const selectOptionalSuccess = <T>(state: LoadingModel<T>) =>\n  wrapLoading<T>(state).optionalSuccess;\nexport const selectIsLoading = <T>(state: LoadingModel<T>) =>\n  wrapLoading<T>(state).isLoading;\nexport const selectIsSuccess = <T>(state: LoadingModel<T>) =>\n  wrapLoading<T>(state).isSuccess();\nexport const selectOptionalError = (state: LoadingModel<any>) =>\n  wrapLoading<any>(state).error;\nexport const selectIsError = <T>(state: LoadingModel<T>) =>\n  wrapLoading<T>(state).isError();\nexport const selectHasLoaded = <T>(state: LoadingModel<T>) =>\n  wrapLoading<T>(state).hasLoaded();\nexport const selectIsEmpty = <T>(state: LoadingModel<T>) =>\n  wrapLoading<T>(state).isEmpty();\n\n","import {\n  Observable,\n  Subject\n} from 'rxjs';\nimport { Action } from '@ngrx/store';\nimport { Actions } from '@ngrx/effects';\nimport { TypedAction } from '@ngrx/store/src/models';\nimport { take } from 'rxjs/operators';\nimport {\n  LoadingActionObject\n} from '../src/lib/loading.actions';\n\nexport const generateMockActions = () => {\n  const dispatcher = new Subject<Action>();\n  return {\n    dispatcher,\n    actions: new Actions(dispatcher)\n  };\n};\n\n/**\n * Simple verifier that checks if the request action results in a success returned.\n */\nexport const verifyActionSuccess = <TState, TSuccess, TRequest extends object | undefined = {}>(\n  action: LoadingActionObject<TState, TRequest, TSuccess>,\n  effect: Observable<TypedAction<string>>,\n  dispatcher: Subject<Action>,\n  options: {\n    data: TSuccess,\n    payload?: TRequest,\n  }) => {\n  let result: TypedAction<string>;\n  effect\n    .pipe(take(1))\n    .subscribe(next => {\n      result = next;\n    });\n  // payload has type issues, just ignore them since we specify TRequest as type param already.\n  dispatcher.next(action.request((options.payload || {}) as never));\n\n  expect(result).toBeDefined();\n  expect(result).toStrictEqual(action.success({ payload: options.data }));\n};\n\n/**\n * Simple verifier that checks if the request action results in a failure returned.\n */\nexport const verifyActionError = <TState, TRequest extends object, TSuccess>(\n  action: LoadingActionObject<TState, TRequest, TSuccess>,\n  effect: Observable<TypedAction<string>>,\n  dispatcher: Subject<Action>,\n  options: {\n    error: Error,\n    payload?: TRequest\n  }) => {\n  let result: TypedAction<string>;\n  effect\n    .pipe(take(1))\n    .subscribe(next => {\n      result = next;\n    });\n  // payload has type issues, just ignore them since we specify TRequest as type param already.\n  dispatcher.next(action.request((options.payload || {}) as never));\n\n  expect(result).toBeDefined();\n  expect(result).toStrictEqual(action.error({ payload: options.error }));\n};\n","export * from './effects.testing'\n","export * from './lib/organisation.module';\nexport * from './lib/organisation.actions';\n","import { OrganisationState } from './organisation.reducer';\nimport { createLoadingAction } from '@mckinsey-converge/loading';\nimport { Organisation } from '@mckinsey-converge/data-common';\n\nexport const organisationStateSelector = (state: { organisation: OrganisationState }) => state.organisation;\n\nexport const loadOrganisations = createLoadingAction<OrganisationState, Organisation>('Organisation', 'data');\n","import { Injectable } from '@angular/core';\nimport {\n  Actions,\n  Effect\n} from '@ngrx/effects';\nimport { createLoadingEffect } from '@mckinsey-converge/loading';\nimport { loadOrganisations } from './organisation.actions';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\n\n\n@Injectable()\nexport class OrganisationEffects {\n\n  constructor(private actions: Actions,\n              private organisationService: OrganisationService) {\n  }\n\n  @Effect()\n  public loadOrganisations = createLoadingEffect(this.actions, loadOrganisations,\n    () => this.organisationService.loadOrganisation())\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { organisationReducer } from './organisation.reducer';\nimport { OrganisationEffects } from './organisation.effects';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    EffectsModule.forFeature([\n      OrganisationEffects\n    ]),\n    StoreModule.forFeature('organisation', organisationReducer)\n  ]\n})\nexport class OrganisationModule {\n}\n","import { LoadingModel } from '@mckinsey-converge/loading';\nimport { Organisation } from '@mckinsey-converge/data-common';\nimport { createReducer } from '@ngrx/store';\nimport { loadOrganisations } from './organisation.actions';\n\nexport interface OrganisationState {\n  data: LoadingModel<Organisation>\n}\n\nconst initialState: OrganisationState = {\n  data: LoadingModel.empty()\n};\n\nexport const organisationReducer = createReducer(initialState,\n  ...loadOrganisations.ons);\n","export * from './lib/rooms.module';\nexport * from './lib/rooms.actions'\nexport * from './lib/rooms.reducer'\nexport * from './lib/rooms.types'\nexport * from './lib/rooms.utils'\n","import { createLoadingAction } from '../../../loading/src/lib/loading.actions';\nimport { Space } from '../../../data-common/src/lib/spaces/space.class';\nimport {\n    RoomQueryOptions,\n    RoomState,\n    RoomStoreState\n} from './rooms.types';\nimport {\n    createAction,\n    createSelector,\n    props\n} from '@ngrx/store';\n\nexport const roomStateSelector = (state: RoomStoreState) => state.rooms;\n\nexport const loadRoomsWithQuery = createAction('[Rooms] Load Rooms with query', props<RoomQueryOptions>());\n\nexport const loadRoomsForResults = createLoadingAction<RoomState, Space[], RoomQueryOptions>('Rooms', 'query');\n\nexport const loadRoomsForResultsMap = createLoadingAction<RoomState, Space[], RoomQueryOptions>('Rooms for map', 'query');\n\n\nexport const loadLaterThatDayResults = createLoadingAction<RoomState, Space[], RoomQueryOptions>('Later Rooms', 'later');\n\nexport const loadNextDayResults = createLoadingAction<RoomState, Space[], RoomQueryOptions>('Next Day Rooms', 'next');\n\nexport const loadByIdResults = createLoadingAction<RoomState, Space[], RoomQueryOptions>('By Id Rooms', 'byid');\n\nexport const selectRoomResultsSuccess = createSelector(roomStateSelector,\n    loadRoomsForResults.selectors.optionalSuccess);\n\nexport const loadDiffSizeResults = createLoadingAction<RoomState, Space[], RoomQueryOptions>('Different Size Rooms', 'size');\n","import { Injectable } from '@angular/core';\nimport {\n    Actions,\n    Effect,\n    ofType\n} from '@ngrx/effects';\nimport { SpacesService } from '@mckinsey-converge/data-common';\nimport {\n    createLoadingEffect,\n    LoadingAction\n} from '@mckinsey-converge/loading';\nimport {\n    loadLaterThatDayResults,\n    loadNextDayResults,\n    loadRoomsForResults,\n    loadRoomsForResultsMap,\n    loadRoomsWithQuery,\n    loadByIdResults,\n    loadDiffSizeResults\n} from './rooms.actions';\nimport { mergeMap } from 'rxjs/operators';\nimport {\n    laterThatDayFromDateTz,\n    nextBusinessDay,\n} from './rooms.utils';\nimport {\n    RoomQueryOptions,\n    roomQueryOptionsToSpaceAvailabilityOptions,\n    roomByIdQueryOptionsToSpaceAvailabilityOptions\n} from './rooms.types';\n\n@Injectable()\nexport class RoomsEffects {\n    constructor(private actions: Actions,\n                private spaceService: SpacesService) {\n    }\n\n    @Effect()\n    public afterRequestResultsLoadOthersEffect = this.actions.pipe(\n        ofType(loadRoomsWithQuery),\n        mergeMap((action: LoadingAction<RoomQueryOptions>) => {\n            return [\n                loadRoomsForResults.request({\n                    ...action,\n                    dateTz: action.dateTz\n                }),\n                // loadRoomsForResultsMap.request({\n                //     ...action,\n                //     dateTz: action.dateTz\n                // }),\n                loadLaterThatDayResults.request({\n                    ...action,\n                    dateTz: laterThatDayFromDateTz(action.dateTz)\n                }),\n                loadNextDayResults.request({\n                    ...action,\n                    dateTz: nextBusinessDay(action.dateTz)\n                }),\n                loadDiffSizeResults.request({\n                    ...action,\n                    dateTz: action.dateTz,\n                    diff_capacity: true\n                }),\n            ];\n        })\n    );\n\n    @Effect()\n    public loadRoomsForResultsEffect = createLoadingEffect(this.actions, loadRoomsForResults,\n        (action) => this.spaceService.available(roomQueryOptionsToSpaceAvailabilityOptions(action), 'rooms'));\n   \n    @Effect()        \n    public loadRoomsForResultsMapEffect = createLoadingEffect(this.actions, loadRoomsForResultsMap,\n        (action) => this.spaceService.available(roomQueryOptionsToSpaceAvailabilityOptions(action), 'rooms for maps', false));\n\n    @Effect()\n    public loadLaterThatDayResultsEffect = createLoadingEffect(this.actions, loadLaterThatDayResults,\n        (action) =>\n            this.spaceService.available(roomQueryOptionsToSpaceAvailabilityOptions(action), 'laterResults'));\n\n    @Effect()\n    public loadNextDayResultsEffect = createLoadingEffect(this.actions, loadNextDayResults,\n        (action) =>\n            this.spaceService.available(roomQueryOptionsToSpaceAvailabilityOptions(action), 'nextDay'));\n\n    @Effect()\n    public loadDiffSizeResultsEffect = createLoadingEffect(this.actions, loadDiffSizeResults,\n        (action) =>\n            this.spaceService.available(roomQueryOptionsToSpaceAvailabilityOptions(action), 'diffSize'));\n\n    @Effect()\n    public loadRoomByIdResultsEffect = createLoadingEffect(this.actions, loadByIdResults,\n        (action) => \n            this.spaceService.available(roomByIdQueryOptionsToSpaceAvailabilityOptions(action), 'byId', false));\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { EffectsModule } from '@ngrx/effects';\nimport { StoreModule } from '@ngrx/store';\nimport { roomsReducer } from './rooms.reducer';\nimport { RoomsEffects } from './rooms.effects';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        EffectsModule.forFeature([RoomsEffects]),\n        StoreModule.forFeature('rooms', roomsReducer)\n    ]\n})\nexport class RoomsModule {\n}\n","import { LoadingModel } from '@mckinsey-converge/loading';\nimport { createReducer } from '@ngrx/store';\nimport {\n    loadLaterThatDayResults,\n    loadNextDayResults,\n    loadRoomsForResults,\n    loadByIdResults,\n    loadDiffSizeResults,\n    loadRoomsForResultsMap\n} from './rooms.actions';\nimport { RoomState } from './rooms.types';\n\nexport const initialRoomsState: RoomState = {\n    query: LoadingModel.empty(),\n    later: LoadingModel.empty(),\n    next: LoadingModel.empty(),\n    byid: LoadingModel.empty(),\n    size: LoadingModel.empty(),\n};\n\nexport const roomsReducer = createReducer(initialRoomsState,\n    ...loadRoomsForResults.ons,\n    ...loadRoomsForResultsMap.ons,\n\n    ...loadLaterThatDayResults.ons,\n    ...loadNextDayResults.ons,\n    ...loadByIdResults.ons,\n    ...loadDiffSizeResults.ons);\n","import { LoadingModel } from '../../../loading/src/lib/loading.model';\nimport {\n    Building,\n    DaysOfWeek,\n    ISpaceAvailabilityOptions,\n    RecurrencePeriod,\n    Space\n} from '@mckinsey-converge/data-common';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\n\nexport interface RoomStoreState {\n    rooms: RoomState;\n}\n\nexport interface RoomState {\n    query: LoadingModel<Space[]>\n    later: LoadingModel<Space[]>\n    next: LoadingModel<Space[]>\n    byid: LoadingModel<Space[]>\n    size: LoadingModel<Space[]>\n}\n\nexport interface RoomQueryOptions {\n    dateTz: DateTZ;\n    duration: number;\n    locations: string;\n    capacity?: number;\n    capacity_max?: number;\n    diff_capacity?: boolean;\n   //Recurrence fields\n   recurrence_period?: RecurrencePeriod;\n   recurrence_interval?: number;\n   recurrence_endTz?: DateTZ;\n   recurrence_count?: number;\n   recurrence_starts?: Array<DateTZ>;\n   recurrence_exceptions?: Array<number>; //SHOULD BE DATETZ\n   recurrence_days?: Array<DaysOfWeek>;\n   timezone?: string;\n   offset?: number;\n   buildings?: Building[];\n   is_recurrent?: boolean;\n   bookable?: boolean;\n   ignore?: string;\n}\n\nexport const roomQueryOptionsToSpaceAvailabilityOptions = (options: RoomQueryOptions): ISpaceAvailabilityOptions => ({\n    dateTz: options.dateTz,\n    duration: options.duration,\n    capacity: options.capacity,\n    zone_ids: options.locations,\n    capacity_max: options.capacity_max,\n    diff_capacity: options.diff_capacity,\n    /** Fields to include recurrence in the availability search */\n    is_recurrent: options?.is_recurrent,\n    recurrence_period: options?.recurrence_period,\n    recurrence_interval: options?.recurrence_interval,\n    recurrence_endTz: options?.recurrence_endTz,\n    recurrence_count: options?.recurrence_count,\n    recurrence_starts: options?.recurrence_starts,\n    recurrence_days: options?.recurrence_days,\n    bookable: options?.bookable,\n    ignore: options?.ignore\n});\n\nexport const roomByIdQueryOptionsToSpaceAvailabilityOptions = (options: RoomQueryOptions): ISpaceAvailabilityOptions => ({\n    dateTz: options.dateTz,\n    duration: options.duration,\n    capacity: options.capacity,\n    room_ids: options.locations,\n    capacity_max: options.capacity_max\n});\n","import { Space } from '@mckinsey-converge/data-common';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { DateTZ } from \"@mckinsey-converge/date-tz\";\n\nexport const todayFromDate = (date: number) => new DateTZ({date});\n\n/**\n * Adds 60 mins.\n */\nexport const laterThatDayFromDateTz = (dateTz: DateTZ) => {\n    return dateTz.addValue({ minutes: 60 })\n};\n\n/**\n * Next business day. In most cases 1 day, but on Fridays, it follows to the monday.\n * @param date\n */\nexport const nextBusinessDay = (dateTz: DateTZ) => {\n    let retDate = dateTz.addValue({ days: 1 });\n    if (retDate.dateWeekday >= 6) {\n        retDate = retDate.setValue({ weekday: 8 });\n    }\n    return retDate;\n};\n\nexport const mapRoomToSelectOption = (room?: Space): SelectOption<any> => room ? ({\n    value: room.id,\n    shortDisplay: room.local_name,\n    display: `${room.local_name}, ${room.level?.name}`\n}) : undefined;\n","export * from './lib/rx-utils.module';\nexport * from './lib/operators'\nexport * from './lib/loading-model.utils'\n","import {\n    combineLatest,\n    Observable\n} from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { LoadingModel } from '@mckinsey-converge/loading';\n\n/**\n * Generates the results count based on if data has loaded or not. If not, undefined is returned.\n * Otherwise, it'll return the count of the results.\n */\nexport const resultCountObservable = <T>(loadingObservable: Observable<LoadingModel<T>>,\n                                         resultsObservable: Observable<any[] | undefined>\n): Observable<number | undefined> => combineLatest([\n    loadingObservable.pipe(map(r => r.hasLoaded())),\n    resultsObservable.pipe(map(v => v?.length))\n]).pipe(map(([isLoading, viewModelLength]) => isLoading ? viewModelLength : undefined));\n","import {\n    distinctUntilChanged,\n    filter\n} from 'rxjs/operators';\nimport * as deepEqual from 'fast-deep-equal';\n\n/**\n * Useful for nested objects to prevent unnecessary triggers in RX chain.\n */\nexport const deepDistinctUntilChanged = () => distinctUntilChanged(deepEqual);\n\n/**\n * Won't emit if value is undefined.\n */\nexport const filterUndefined = <T>() => filter<T>(f => !!f);\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n  imports: [CommonModule],\n})\nexport class RxUtilsModule {}\n","export * from './lib/ui.module';\nexport * from './lib/types';\nexport * from './lib/base-template.component';\nexport * from './lib/recurrence-pattern-form/recurrence-pattern-form.component';\nexport * from './lib/recurrence-booking-form/recurrence-booking-form.component';\nexport * from './lib/conflicts-modal/conflicts-modal.component'\nexport * from './lib/override-changes-modal/override-changes-modal.component'\nexport * from './lib/date-tz-calendar-widget/date-tz-calendar-widget.component';\nexport * from './lib/date-tz-date-picker/date-tz-date-picker.component';\nexport * from './lib/date-tz-duration-field/date-tz-duration-field.component';\nexport * from './lib/date-tz-time-field/date-tz-time-field.component';\nexport * from './lib/aca-date-picker/aca-date-picker.component';\nexport * from './lib/conflict-alert-modal/conflict-alert-modal.component';\nexport * from './lib/tooltip/tooltip.enums';\n","import { Component, OnInit, Input, Output, OnChanges, SimpleChanges, forwardRef, EventEmitter } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\nexport interface IDatePickerOptions {\n    /** Unix timestamp with millisecond. First selectable date */\n    from?: number;\n    /** Unix timestamp with millisecond. Last selectable date */\n    to?: number;\n    /** Luxon format string for formatting days of the week. Defaults to `DDD` */\n    day_format?: string;\n    /** Luxon format string for formatting active month. Defaults to `MMMM yyyy` */\n    month_format?: string;\n}\n\ninterface IDateBlock {\n    /** Timestamp value of the date */\n    value: number;\n    /** Day of the month to display */\n    display: string;\n    /** Whether block is the selected date */\n    active: boolean;\n    /** Whether block not selectable */\n    disabled: boolean;\n    /** Whether block outside the active month */\n    non_month: boolean;\n    /** Whether the block is today */\n    today: boolean;\n    /** Number of events on this block */\n    count?: number;\n}\n\n@Component({\n    selector: 'aca-date-picker',\n    templateUrl: './aca-date-picker.component.html',\n    styleUrls: ['./aca-date-picker.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => AcaDatePickerComponent),\n            multi: true\n        }\n    ]\n})\nexport class AcaDatePickerComponent implements OnInit, OnChanges, ControlValueAccessor {\n    /** CSS class to add to the root element of the component */\n    @Input() public klass = 'default';\n    /** Counters of the events on given dates. Key format is `yyyy-MM-dd` */\n    @Input() public counters: { [date: string]: number };\n    /** Settings for the date picker component */\n    @Input() public options: IDatePickerOptions;\n    /** Offset of the display month from the current month */\n    @Output() public month = new EventEmitter<number>();\n    /** Display the last selected day as active */\n    @Input() public show_last_selection?: boolean = true\n\n    public date: number = DateNow(new Date()).ms;\n\n    // R--- this is the date picker that needs to be TZ aware\n    /** Offset of the month displayed from the current month */\n    public offset = 0;\n    /** Minimum offset for changing the month */\n    public min_offset = -999999;\n    /** Maximum offset for changing the month */\n    public max_offset = 999999;\n    /** Blocks representing the rendering details of the display days of the month */\n    public date_list: IDateBlock[] = [];\n    /** Name of the actively displayed month */\n    public month_name = DateNow(new Date()).formatDate('MMMM yyyy');\n    /** Name of the days of the week to display */\n    public days_of_week = [];\n    /** First selectable date */\n    private from: DateTZ;\n    /** Last selectable date */\n    private to: DateTZ;\n    /** Luxon format string for formatting days of the week. Defaults to `dd` */\n    private day_format = 'EEE';\n    /** Luxon format string for formatting active month. Defaults to `MMMM yyyy` */\n    private month_format = 'MMMM yyyy';\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n    /** ID of the timer used for changing the month */\n    private _change_timer: number;\n\n    public ngOnInit(): void {\n        this.generateMonth();\n        this.generateDaysOfTheWeek();\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.options) {\n            this.updateOptions();\n        }\n        if (changes.counters) {\n            this.generateMonth();\n        }\n    }\n\n    /** Change date using the given block */\n    public setDate(item: IDateBlock) {\n        this.date = item.value;\n        if (this._onChange) {\n            this._onChange(this.date);\n        }\n        this.generateMonth();\n    }\n\n    /**\n     * Update offset to show the selected date\n     */\n    public updateDate(): void {\n        \n        if (!this.date) {\n            return;\n        }\n        const now = DateNow(new Date()).startOfValue('month');\n        const date_ = new DateTZ({date: this.date})\n        const date = date_.startOfValue('month');\n        if (date.valid) {\n            const difference = date.dateDiff(now, 'months', 'months');\n            if (this.offset !== difference) {\n                this.offset = difference;\n                this.month.emit(this.offset);\n            }\n            this.generateMonth();\n        }\n    }\n\n    /**\n     * Update local properties based off changes to settings\n     */\n    public updateOptions(): void {\n        if (this.options) {\n            // Setup from date\n            if (this.options.from) {\n                const date_ = new DateTZ({date: this.options.from})\n                this.from = date_.startOfValue('day');;\n                const today = DateNow(new Date()).startOfValue('month');\n                const date = this.from.startOfValue('month');\n                this.min_offset = date.dateDiff(today, 'months', 'months');\n            } else if (this.from) {\n                this.from = null;\n                this.min_offset = -999999;\n            }\n            // Setup to date\n            if (this.options.to) {\n                const date_ = new DateTZ({date: this.options.to})\n                this.to = date_.startOfValue('day');\n                const today = DateNow(new Date()).startOfValue('month');\n                const date = this.to.startOfValue('month');\n                this.max_offset = date.dateDiff(today, 'months', 'months');\n            } else if (this.to) {\n                this.to = null;\n                this.max_offset = 999999;\n            }\n            if (this.options.month_format) {\n                this.month_format = this.options.month_format || 'MMMM yyyy';\n            }\n            if (this.options.day_format) {\n                this.day_format = this.options.day_format || 'EEE';\n                this.generateDaysOfTheWeek();\n            }\n            // Update date blocks\n            this.generateMonth();\n        }\n    }\n\n    /**\n     * Generate the display blocks for the days of the active month\n     */\n    private generateMonth(): void {\n        if (!this.date) {\n            return;\n        }\n        const date = DateNow(new Date()).addValue({ months : this.offset });\n        const active = new DateTZ({date: this.date});\n        let start = date.setValue({ day: 1 }).setValue({ weekday: 7 }).subtractValue({ weeks: 1 });\n        const end_ = new DateTZ({date: start.ms})\n        const end = end_.addValue({ weeks: 1 }).endOfValue('month').addValue({ days: 2 }).endOfValue('week');\n        this.date_list = [];\n        while (start.isBeforeDate(end) || start.isSameDate(end, 'day')) {\n            this.date_list.push({\n                value: start.ms,\n                display: start.formatDate('d'),\n                active:  this.show_last_selection && active.isSameDate(start, 'day'),\n                non_month: !date.isSameDate(start, 'month'),\n                count: this.counters ? this.counters[start.formatDate('yyyy-MM-dd')] || 0 : 0,\n                disabled: (this.from ? start.isBeforeDate(this.from, 'day') : false) || (this.to ? start.isAfterDate(this.to, 'day') : false),\n                today: DateNow(new Date()).isSameDate(start, 'day')\n            });\n            start = start.addValue({ days : 1 });\n        }\n        this.month_name = date.formatDate(this.month_format);\n    }\n\n    /**\n     * Generate this weekdays to display in the header of the calendar\n     */\n    private generateDaysOfTheWeek() {\n        let date = DateNow(new Date()).startOfValue('week');\n        this.days_of_week = [];\n        for (let i = 0; i < 7; i++) {\n            this.days_of_week.push(date.formatDate(this.day_format));\n            date = date.addValue({ days : 1 });\n        }\n    }\n\n    /**\n     * Changes the month offset by the given value.\n     * Does nothing if the new month is not available to be selected\n     * @param value Number of months to change the offset by\n     */\n    public changeMonth(value: number): void {\n        if (this._change_timer) {\n            clearTimeout(this._change_timer);\n        }\n        this._change_timer = <any>setTimeout(() => {\n            const new_offset = this.offset + value;\n            const now = DateNow(new Date())\n            const date = now.addValue({ months : new_offset, days: now.dateMonth === 2 ? 2 : 0 }); //add 2 days if month is february to avoid calc errors\n            if (this.from && date.isBeforeDate(this.from, 'month')) { return; }\n            if (this.to && date.isAfterDate(this.to, 'month')) { return; }\n            this.offset = new_offset;\n            this.month.emit(this.offset);\n            this.generateMonth();\n            this._change_timer = null;\n        }, 100);\n    }\n\n    /**\n     * Reset the month offset to the month of the selected date\n     */\n    public reset() {\n        const date = new DateTZ({date: this.date});\n        const offset = this.offset;\n        this.offset = DateNow(new Date()).dateDiff(date, 'months', 'months');\n        if (offset !== this.offset) {\n            this.generateMonth();\n        }\n        this.month.emit(this.offset);\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        this.date = value;\n        this.updateDate();\n        this.generateMonth();\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n}\n","<div [class]=\"'date-picker' + (klass ? ' ' + klass : '')\" widget>\n    <div class=\"header\">\n        <div class=\"arrow previous\" [class.disabled]=\"offset <= min_offset\" (click)=\"changeMonth(-1)\" (touchend)=\"changeMonth(-1)\">\n            <div class=\"previous icon\"></div>\n        </div>\n        <div class=\"month\" (dblclick)=\"reset()\">{{month_name}}</div>\n        <div class=\"arrow next\" [class.disabled]=\"offset >= max_offset\" (click)=\"changeMonth(1)\" (touchend)=\"changeMonth(1)\">\n            <div class=\"next icon\"></div>\n        </div>\n    </div>\n    <div class=\"week\">\n        <div class=\"block\" *ngFor=\"let item of days_of_week\">{{item}}</div>\n    </div>\n    <div class=\"body\">\n        <div class=\"block\" *ngFor=\"let item of date_list\">\n            <div class=\"date\" \n                (click)=\"item.disabled ? null : setDate(item)\"\n                (touchend)=\"item.disabled ? null : setDate(item)\"\n                [class.non-month]=\"item.non_month\"\n                [class.active]=\"item.active\"\n            >\n                {{item.display}}\n                <div class=\"dot\" *ngIf=\"item.today\"></div>\n                <div class=\"count\" *ngIf=\"item.count\">{{item.count > 9 ? '+9' : item.count}}</div>\n            </div>\n        </div>\n    </div>\n</div>","import {\n    Component,\n    EventEmitter,\n    Input,\n    OnChanges,\n    OnInit,\n    Output,\n    SimpleChanges\n} from '@angular/core';\n\nexport enum AlertMode {\n    Warning = 'warning',\n    Coachmark = 'coachmark',\n    BlueCoachmark = 'blue-coachmark',\n    Error = 'error'\n}\n\nexport enum AlertBannerDisplay {\n    /**\n     * New UI\n     */\n    V2 = 'v2',\n\n    /**\n     * Default, legacy ui.\n     */\n    V1 = 'v1',\n}\n\n@Component({\n    selector: 'mck-alert-banner',\n    template: `\n        <div class=\"alert-container {{mode}}\">\n            <div class=\"alert-icon-container {{mode}}\">\n                <img [src]=\"iconPath\">\n            </div>\n            <div class=\"content-wrap\">\n                <div name=\"message\" class=\"message {{mode}} {{display}}\" [innerHTML]=\"message | sanitize\"></div>\n                <div class=\"actions-button-container {{display}}\" *ngIf=\"buttonText\">\n                    <button name=\"action-button\"\n                            color=\"{{materialColor}}\"\n                            class=\"{{materialColor}} {{display}}\"\n                            [class.mck-stroked-button]=\"display === 'v2'\"\n                            [class.mck-short]=\"display === 'v2'\"\n                            type=\"button\" mat-stroked-button\n                            (click)=\"action.emit($event)\">{{buttonText}}</button>\n                </div>\n            </div>\n            <button\n                *ngIf=\"showClose\"\n                mat-icon-button name=\"close-button\" class=\"close-button\"\n                aria-label=\"Close\"\n                color=\"{{materialColor}}\"\n                (click)=\"close.emit($event)\">\n                <img [attr.src]=\"'assets/img/' + closeIcon\">\n            </button>\n        </div>\n    `,\n    styleUrls: ['./alert-banner.component.scss']\n})\nexport class AlertBannerComponent implements OnInit, OnChanges {\n\n    @Input()\n    public mode: AlertMode = AlertMode.Warning;\n\n    @Output()\n    public close = new EventEmitter<MouseEvent>();\n\n    @Output()\n    public action = new EventEmitter<MouseEvent>();\n\n    @Input()\n    public message: string;\n\n    @Input()\n    public buttonText: string;\n\n    @Input()\n    public showClose = true;\n\n    @Input()\n    public display: AlertBannerDisplay = AlertBannerDisplay.V1;\n\n    public iconPath: string = 'assets/icon/warning-yellow.svg';\n    public materialColor: string = 'black';\n    public closeIcon: string = 'close_outline.svg';\n\n    public ngOnInit(): void {\n        this._onModeChange();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.mode) {\n            this._onModeChange();\n        }\n    }\n\n    private _onModeChange() {\n        this.iconPath = 'assets/icon/warning-yellow.svg';\n        this.closeIcon = 'close_outline.svg';\n        switch (this.mode) {\n            case AlertMode.Warning:\n                this.materialColor = 'black';\n                break;\n            case AlertMode.Coachmark:\n                this.materialColor = 'coachmark';\n                this.closeIcon = 'close_outline_coachmark.svg';\n                break;\n            case AlertMode.BlueCoachmark:\n                this.iconPath = 'assets/icon/info-bg-dark.svg'\n                this.materialColor = 'blue-coachmark'\n                break;\n            case AlertMode.Error:\n                this.iconPath = 'assets/img/error-icon.svg'\n                this.materialColor = 'white'\n                break;\n            default:\n                this.materialColor = 'black';\n        }\n    }\n\n}\n","import {\n    Component,\n    Directive,\n    EventEmitter,\n    Input,\n    OnChanges,\n    OnDestroy,\n    OnInit,\n    Optional,\n    Output,\n    Self,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    NgControl\n} from '@angular/forms';\nimport { SelectOption } from '../types';\nimport {\n    BehaviorSubject,\n    combineLatest,\n    from,\n    Subject\n} from 'rxjs';\nimport {\n    COMMA,\n    ENTER\n} from '@angular/cdk/keycodes';\nimport { MatChipInputEvent } from '@angular/material/chips';\nimport {\n    distinctUntilChanged,\n    map,\n    take\n} from 'rxjs/operators';\nimport { MatCheckboxChange } from '@angular/material/checkbox';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { MatAutocompleteTrigger } from '@angular/material/autocomplete';\n\n@Component({\n    selector: 'mck-autocomplete-chip-select-item',\n    template: `\n        <div class=\"mck-column mck-form-input\" [ngClass]=\"mobileFullScreen ? 'mobile-select' : ''\">\n            <button *ngIf=\"mobileFullScreen\" name=\"CloseButton\" class=\"close-button\" mat-icon-button (click)=\"loseFocus()\">\n                <div class=\"close-image\"></div>\n            </button>\n            <mck-label [required]=\"required\">{{label}}</mck-label>\n            <mat-form-field\n                appearance=\"outline\"\n                floatLabel=\"never\"\n                [ngClass]=\"showError ? 'mck-error' : ''\"\n                matAutocompleteOrigin\n                #origin=\"matAutocompleteOrigin\">\n                <div class=\"mck-row input-container\">\n                    <input\n                        matInput\n                        #componentInput=\"matInput\"\n                        #trigger=\"matAutocompleteTrigger\"\n                        [style.width]=\"'100%'\"\n                        [style.margin]=\"'0'\"\n                        [formControl]=\"filterFormControl\"\n                        placeholder=\"{{placeHolder}}\"\n                        type=\"text\"\n                        (focusin)=\"onFocus(true)\"\n                        (input)=\"keyedInput($event.target.value)\"\n                        [matAutocomplete]=\"auto\"\n                        [matAutocompleteConnectedTo]=\"origin\"\n                        [matChipInputFor]=\"chipList\"\n                        (matChipInputTokenEnd)=\"add($event)\"\n                    >\n                    <div class=\"mck-row\">\n                        <div class=\"suffix\" matSuffix *ngIf=\"loading\">\n                            <mat-spinner diameter=\"16\"></mat-spinner>\n                        </div>\n                        <mck-selected-chip-count\n                            (close)=\"clearSelections()\"\n                            *ngIf=\"hasChips\"\n                            [count]=\"(chipOptions | async).length\"></mck-selected-chip-count>\n                        <div class=\"mck-column icon-container {{focused ? '' : 'not-clickable'}}\"\n                             (click)=\"onClickArrow()\" *ngIf=\"!hideDropdownCarret\">\n                            <mck-chevron-icon [up]=\"focused\"\n                                              fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n                        </div>\n                    </div>\n                </div>\n                <mck-spacer size=\"4px\" *ngIf=\"hasChips\"></mck-spacer>\n                <mat-chip-list #chipList>\n                    <!-- empty chip useful for padding -->\n                    <mat-chip *ngIf=\"focused && !hasChips\"\n                              [style.visibility]=\"'collapse'\"></mat-chip>\n                    <mat-chip *ngFor=\"let selected of (chipOptions | async)\" removable\n                              (removed)=\"removeOption(selected)\" class=\"{{selected.meta?.color ? selected.meta?.color : ''}}\">{{selected.shortDisplay}}\n                        <mck-close-icon matChipRemove [fillClass]=\"iconFillClass(selected.meta?.color)\">close</mck-close-icon>\n                    </mat-chip>\n                </mat-chip-list>\n                <mck-spacer size=\"4px\" *ngIf=\"hasChips\"></mck-spacer>\n                <mat-autocomplete\n                    class=\"{{!!mobileFullScreen && 'mobile-select'}} mck-checkbox-panel\"\n                    #auto=\"matAutocomplete\"\n                    (opened)=\"onPanelFocusChange(true)\"\n                    (closed)=\"onPanelFocusChange(false)\"\n                    (optionSelected)=\"selectOption($event.option.value)\"\n                    multiple>\n                    <div class='checkbox-container'>\n                        <mat-option\n                            [disabled]=\"!option.enabled\"\n                            class=\"mck-truncated {{(option.groupHeader || option.displayAsHeader) && 'mck-checkbox-group-header'}} {{option.groupChild && !option.displayAsHeader && 'mck-checkbox-group-child'}}\"\n                            (click)=\"$event.stopPropagation()\"\n                            *ngFor=\"let option of filteredAutocompleteOptions | async | groupHeaderPatch\"\n                            [value]=\"option.value\">\n                            <mat-checkbox\n                                [ngClass]=\"!option.enabled && 'mck-checkbox-disabled'\"\n                                [disabled]=\"!option.enabled\"\n                                [style.display]=\"'block'\"\n                                [checked]=\"option.selected\"\n                                (change)=\"onChanged(option, $event)\"\n                                (click)=\"$event.stopPropagation()\">\n                                {{option.dropdownOverride || option.display}}\n                            </mat-checkbox>\n                        </mat-option>\n                    </div>\n                    <div class='checkbox-cta-container' *ngIf='displayCTA'>\n                        <button\n                            mat-stroked-button class=\"mck-secondary-button\"\n                            (click)=\"clearSelections()\"\n                            [disabled]=\"!enableCTAs\"\n                        >\n                            Clear\n                        </button>\n                        <button\n                            mat-button class=\"mck-primary-button\"\n                            (click)=\"onFocus(false)\"\n                            [disabled]=\"!enableCTAs\"\n                        >\n                            Confirm\n                        </button>\n                    </div>\n                </mat-autocomplete>\n            </mat-form-field>\n            <mck-error-message *ngIf=\"showError\">{{errorMessage}}</mck-error-message>\n        </div>\n    `,\n    styleUrls: ['./auto-complete-chip-select-item.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class AutoCompleteChipSelectItemComponent extends BaseDirective implements OnInit, OnChanges, ControlValueAccessor, OnDestroy {\n\n    @ViewChild('trigger')\n    trigger: MatAutocompleteTrigger;\n\n    @ViewChild('componentInput')\n    componentInput: HTMLInputElement;\n\n    @Input()\n    label: string;\n\n    @Input()\n    required?: boolean;\n\n    @Input()\n    feedbackInput?: boolean;\n\n    @Input()\n    loading?: boolean;\n\n    @Input()\n    placeHolder: string;\n\n    @Input()\n    options: Subject<SelectOption<any>[]>;\n\n    @Input()\n    selectedOptions: Subject<SelectOption<any>[]>;\n\n    @Input()\n    useCTAs?: boolean;\n\n    @Output()\n    optionSelected = new EventEmitter<SelectOption<any>>();\n\n    @Output()\n    feedbackOutput = new EventEmitter<any>();\n\n    @Output()\n    chipsCleared: EventEmitter<void> = new EventEmitter<void>();\n\n    @Output()\n    onClickConfirm: EventEmitter<void> = new EventEmitter<void>();\n\n    /**\n     * If true, only allow 1 group at a time to get selected. Show others as disabled.\n     */\n    @Input()\n    selectOnlyOneGroup = false;\n\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n\n    @Input() public localFilter: boolean = true;\n\n    /**\n     * If error exists, a message.\n     */\n    @Input()\n    errorMessage?: string;\n\n    @Input()\n    hideDropdownCarret?: boolean;\n\n    @Input()\n    displayCTA?: boolean;\n\n    private selectOnlyOneGroupChange = new BehaviorSubject(false);\n\n    separatorKeysCodes = [ENTER, COMMA];\n\n    public filterFormControl: FormControl = new FormControl();\n\n    public focused = false;\n    public mobileFullScreen = false;\n\n    public autocompleteOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n    public filteredAutocompleteOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    /** List shown to user, filters children if a group header is added **/\n    public chipOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    /** Form control on change handler */\n    private _onChange?: (_: SelectOption<any>[]) => void;\n    /** Form control on touch handler */\n    private _onTouch?: (_: string) => void;\n\n    private value = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public enableCTAs: boolean = false\n\n    public hasChips: boolean = false;\n\n    constructor(@Self() @Optional() private control: NgControl) {\n        super();\n        if (this.control) {\n            this.control.valueAccessor = this;\n        }\n    }\n\n    public get invalid(): boolean {\n        return this.control ? this.control.invalid : false;\n    }\n\n    public get showError(): boolean {\n        if (!this.control) {\n            return false;\n        }\n\n        const { dirty, touched } = this.control;\n\n        return this.invalid ? (dirty && touched) : false;\n    }\n\n    public iconFillClass(color?: string): string {\n        return color === 'external' ? 'mck-icon-fill-gray' : 'mck-icon-fill-white'\n    }\n\n    ngOnInit() {\n        this.subscription('autoCompleteOptions', combineLatest([\n            this.options,\n            this.selectedOptions,\n            this.selectOnlyOneGroupChange\n        ])\n            .pipe(\n                map(([options, selectedOptions, selectOnlyOneGroup]) => {\n                    this.hasChips = !!selectedOptions.length;\n                    return options.map(option => {\n                        const selected = !!selectedOptions.find(s => s.value === option.value);\n                        let enabled = true;\n                        if (selectOnlyOneGroup) {\n                            // find first group item in selection\n                            const selectedGroupHeader = selectedOptions.find(s => s.groupHeader || s.groupId === option.groupId);\n\n                            // if no options chosen, enable it, otherwise only allow selections from other options.\n                            enabled =\n                                selectedOptions.length === 0 ||\n                                (selectedGroupHeader ? selectedGroupHeader.groupId === option.groupId : false);\n                            this.enableCTAs = selectedOptions.length !== 0\n                        }\n\n                        return {\n                            ...option,\n                            enabled,\n                            selected\n                        } as SelectOption<any>;\n                    });\n                })\n            ).subscribe(next => {\n                const options = next.sort((a, b) => {\n                    if (a.groupId === b.groupId) {\n                        return b.display > a.display ? -1 : 1;\n                    }\n                    return b.groupId > a.groupId ? -1 : 1;\n                });\n                this.autocompleteOptions.next(options);\n                this.filteredAutocompleteOptions.next(this.getFilteredAutocompleteOptions(this.filterFormControl.value?.trim()));\n            }));\n        this.subscription('filterFormControlChanges',\n            this.filterFormControl.valueChanges.subscribe(value => {\n                if (this.localFilter && value.length) {\n                    this.filteredAutocompleteOptions.next(this.getFilteredAutocompleteOptions(value));\n                } else {\n                    this.filteredAutocompleteOptions.next(this.getFilteredAutocompleteOptions());\n                }\n            }));\n        this.subscription('chipOptions', this.selectedOptions\n            .pipe(map(selectedOptions => {\n                // find group headers and check if children are part of that group.\n                // if part of group, filter them out as redundant.\n                const groupHeaders = selectedOptions.filter(s => s.groupHeader) || [];\n                return selectedOptions.filter(s => s.groupHeader || s.groupChild && !(groupHeaders.find(g => g.groupId === s.groupId)));\n            }))\n            .subscribe(next => {\n                this.chipOptions.next(next);\n            }));\n\n        this.subscription('formData', this.selectedOptions\n            .pipe(map(selected => {\n                // group headers always contain children, so only pick out children for data\n                return selected;\n            }))\n            .subscribe(next => {\n                this.value.next(next);\n            }));\n\n        // tie value changes to change.\n        this.subscription('valueChanges', this.value\n            .pipe(distinctUntilChanged())\n            .subscribe(next => {\n                if (this._onChange) {\n                    // rewrote this to avoid read only error\n                    const values = [];\n                    next.forEach((v, i) => {\n                        const value = { ...v };\n                        if (v.meta?.user) {\n                            value.display = v.meta.user.name;\n                        }\n                        values.push(value);\n                    });\n                    this._onChange(values);\n                }\n            }));\n\n        window.addEventListener('scroll', this.scrollEvent, true);\n    }\n\n    getFilteredAutocompleteOptions(searchString: string = '') {\n        // Exact matches of the groupId or display value\n        const exactMatches = this.autocompleteOptions.value.filter(o => {\n            if (searchString && searchString.length) {\n                return o.groupId.toLowerCase().indexOf(searchString.toLowerCase()) === 0 || o.display.toLowerCase().indexOf(searchString.toLowerCase()) === 0;\n            }\n            return o.groupId && o.display;\n        });\n        // Fuzzier search of the dropdownOverride field\n        const moreOptions = this.autocompleteOptions.value.filter(o => {\n            if (o?.dropdownOverride?.length && searchString) {\n                const match = o.dropdownOverride?.toLowerCase().indexOf(searchString.toLowerCase()) > -1;\n                // only return found locations that don't exist in exactMatches.\n                return match && !exactMatches.find(e => {\n                    return e.value === o.value\n                });\n            }\n            return false;\n        });\n\n        // Merge the two result sets\n        let joinedOptions = exactMatches.concat(moreOptions).sort((a, b) => {\n            if (a.groupId === b.groupId) {\n                return b.display > a.display ? -1 : 1;\n            }\n            return b.groupId > a.groupId ? -1 : 1;\n        });\n\n        // Create a 1D array of the groupId\n        const groupIds = joinedOptions.map(o => o.groupId);\n        // Get a deduped list of the group parents\n        const parents = this.autocompleteOptions.value.filter(o => {\n            return o?.groupHeader && groupIds.indexOf(o.groupId) !== -1;\n        });\n\n        // Remove the parents from the joinedOptions and merge with the reduced parents set, and then sort by groupId.\n        // Resulting array sets the parents first in order so the widget renders properly.\n        const filteredAutocompleteOptions = parents.concat(joinedOptions.filter(jo => !!jo.dropdownOverride)).sort((a, b) => {\n            return b.groupId > a.groupId ? -1 : 1;\n        });\n        return filteredAutocompleteOptions;\n    }\n\n    loseFocus(): void {\n        this.mobileFullScreen = false;\n        this.focused = false;\n    }\n\n    ngOnChanges(changes: SimpleChanges): void {\n        if (changes.selectOnlyOneGroup) {\n            this.selectOnlyOneGroupChange.next(this.selectOnlyOneGroup);\n        }\n    }\n\n    keyedInput(matInput: string) {\n        if (this.feedbackInput) {\n            this.feedbackOutput.emit(matInput);\n        }\n    }\n\n    selectOption(value: string) {\n        this.options.pipe(\n            take(1),\n            map((options: SelectOption<any>[]) => options.find(o => o.value === value))\n        ).subscribe(next => {\n            if (next) {\n                this.optionSelected.emit(next);\n            }\n        });\n    }\n\n    removeOption(value: SelectOption<any>) {\n        this.optionSelected.emit(value);\n        if (this.useCTAs) {\n            this.onClickConfirm.emit();\n        }\n\n    }\n\n    clearSelections() {\n        this.selectedOptions.next([]);\n        this.chipsCleared.emit();\n    }\n\n    onClickArrow() {\n        // only close events we allow arrow to close panel.\n        if (this.focused) {\n            this.onFocus(false);\n        }\n    }\n\n    onPanelFocusChange(focusIn: boolean) {\n        this.onFocus(focusIn, true);\n    }\n\n    onFocus(focusIn: boolean, fromPanel?: boolean) {\n        if (!focusIn && this.useCTAs) {\n            this.onClickConfirm.emit();\n        }\n        // Only for location input???\n        if (this.localFilter && fromPanel && focusIn) {\n            // open on focus, mobile needs a refocus\n            this.mobileFullScreen = true;\n            this.timeout('showDefaults', () => {\n                // All results do not show as expected unless I focus again.\n                // Something about the mobile styles.\n                this.onFocus(true);\n            }, 100)\n        }\n\n        if (this.feedbackInput && !fromPanel) {\n            // clear input when input creates options\n            this.componentInput.value = '';\n            this.filterFormControl.setValue('');\n            this.feedbackOutput.emit('');\n        }\n\n        if (this.focused !== focusIn) {\n            this.focused = focusIn;\n            // clear on close\n            if (!focusIn) {\n                this.componentInput.value = '';\n                this.filterFormControl.setValue('');\n            }\n            if (!fromPanel) {\n                if (focusIn) {\n                    this.trigger.openPanel();\n                } else {\n                    this.trigger.closePanel();\n                    // close the mobile full screen\n                    this.loseFocus();\n                }\n            }\n        }\n    }\n\n    onChanged(value: SelectOption<any>, event: MatCheckboxChange) {\n        this.optionSelected.emit(value);\n    }\n\n    add(event: MatChipInputEvent) {\n        // reset\n        if (event.input) {\n            event.input.value = '';\n        }\n        this.filterFormControl.setValue('');\n    }\n\n    registerOnChange(fn: any): void {\n        this._onChange = fn;\n    }\n\n    registerOnTouched(fn: any): void {\n        this._onTouch = fn;\n    }\n\n    setDisabledState(isDisabled: boolean): void {\n        // TODO: disabled not implemented yet.\n        this.disabled = isDisabled;\n    }\n\n    writeValue(obj: SelectOption<any>[] | undefined): void {\n        // update selected options when this value is written\n        this.options?.pipe(\n            take(1),\n            map((options: SelectOption<any>[]) => {\n                return options.filter(o => obj ? !!obj.find(spl => o.value === spl.value) : false );\n            })\n        ).subscribe(next => {\n            this.selectedOptions.next(next);\n        });\n    }\n\n    private scrollEvent = (event): void => {\n        if (this.trigger === null) {\n          return;\n        }\n        /**\n         * IF - to confirm user not scrolling from autocomplete opened panel and close panel if scroll event triggers from outside of panel\n         */\n        if (this.trigger.panelOpen && event.target.closest('.mat-autocomplete-panel') === null && !event.srcElement.classList.contains('mat-form-field-autofill-control')) {\n            this.onFocus(false);\n            this.trigger['_element'].nativeElement.blur();\n        }\n      }\n      public ngOnDestroy(): void {\n        window.removeEventListener('scroll', this.scrollEvent, true);\n      }\n}\n\n\n","import {\n    Pipe,\n    PipeTransform\n} from '@angular/core';\nimport { SelectOption } from '../types';\n\n/**\n * Patch orphaned SelectOption children into acting as their own group headers.\n *\n * This intends to help in the common scenario where filters have (for whatever\n * reason) prevented the child's usual group header from appearing.\n */\n@Pipe({\n    name: 'groupHeaderPatch',\n})\nexport class GroupHeaderPipe implements PipeTransform {\n    transform(items: SelectOption<any>[]): SelectOption<any>[] {\n        if (!items) {\n            return [];\n        }\n\n        return items.map(v => {\n            const hasHeader = !!items.find(i => i.groupHeader && i.groupId === v.groupId);\n            return {\n                ...v,\n                displayAsHeader: !hasHeader,\n            }\n        })\n    }\n\n}\n","import { Component, Input, Output, forwardRef, SimpleChanges, OnChanges, OnInit, EventEmitter, ViewChild, OnDestroy } from '@angular/core';\nimport { ControlValueAccessor, FormControl, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { Observable } from 'rxjs';\nimport { map, startWith } from 'rxjs/operators';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { MatAutocompleteTrigger } from '@angular/material/autocomplete';\nimport {\n  BehaviorSubject\n} from 'rxjs';\n\n/**\n * @title Autocomplete filtering select of a single option via text search.\n */\n@Component({\n  selector: 'mck-autocomplete-select-option',\n  templateUrl: 'auto-complete-select-option.component.html',\n  styleUrls: ['auto-complete-select-option.component.scss'],\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => AutoCompleteSelectOptionComponent),\n      multi: true\n    }\n  ],\n})\nexport class AutoCompleteSelectOptionComponent implements OnInit, OnChanges, ControlValueAccessor, OnDestroy{\n  @Input()\n  public label: string;\n\n  @Input()\n  public required: boolean;\n\n  @Input()\n  public options: SelectOption<any>[] = [];\n\n  @Input()\n  public selectedValue: SelectOption<any> | undefined;\n\n  @Input()\n  public resetInput: number | undefined;\n\n  @Input()\n  public placeholder: string;\n\n  @Input()\n  public noEntriesFoundLabel: string;\n\n  @Output()\n  public filteredOptionsChange = new EventEmitter<SelectOption<any>[]>();\n\n  @Output()\n  public inputTextChange = new EventEmitter<string>();\n\n  @Output() emptyBoxEvent = new EventEmitter();\n\n  /** Form control on change handler */\n  private _onChange: (_: SelectOption<any>) => void;\n  /** Form control on touch handler */\n  private _onTouch: (_: SelectOption<any>) => void;\n\n  filterFormControl = new FormControl();\n  filteredOptions: Observable<SelectOption<any>[]>;\n\n  /** The selected value */\n  public value = new BehaviorSubject<any | undefined>('');\n\n  /** Available options to search / select from */\n  public _options = new BehaviorSubject<SelectOption<any>[]>(this.options);\n  @ViewChild('trigger')\n    trigger: MatAutocompleteTrigger;\n\n  ngOnInit() {\n    this.updateFilteredOptions();\n    window.addEventListener('scroll', this.scrollEvent, true);\n  }\n\n  public ngOnChanges(changes: SimpleChanges): void {\n    // Watch and apply changes from the parent component.\n    if (changes.options || changes.selectedValue) {\n      if (changes.options && !changes.selectedValue) {\n        this.filterFormControl.setValue('')\n      }\n      this.updateFilteredOptions();\n    }\n    if (changes.resetInput) {\n      this.filterFormControl.setValue('');\n      this.updateFilteredOptions();\n    }\n    \n  }\n\n  private updateFilteredOptions() {\n    this.filteredOptions = this.filterFormControl.valueChanges\n      .pipe(\n        startWith(''),\n        map(value => typeof value === 'string' ? value : value && value?.display ? value.display : ''),\n        map(name => name ? this._filter(name) : this.options.slice())\n      );\n  }\n\n  displayFn(data: SelectOption<any>): string {\n    return data && data?.display ? data.display : '';\n  }\n\n  private _filter(display: string): SelectOption<any>[] {\n    const filterValue = display.toLowerCase();\n    // return all the matches found\n    const filtered = this.options.filter(option => {\n      // split this input and index both, if both\n      // match return true.\n      if (filterValue.includes(' ')) {\n        const filterValues =filterValue.split(' ');\n        let matchesAll = true;\n        for (let x = 0; x < filterValues.length; x++) {\n          if (option.display.toLowerCase().indexOf(filterValues[x]) === -1) {\n            matchesAll = false;\n          }\n        }\n        if (matchesAll) {\n          return true;\n        }\n      }\n      // match the whole string\n      return option.display.toLowerCase().indexOf(filterValue) > -1;\n    });\n    this.inputTextChange.emit(filterValue);\n    this.filteredOptionsChange.emit(filtered);\n    return filtered;\n  }\n\n  /**\n   * Update the form field value\n   * @param new_value New value to set on the form field\n   */\n  public setValue(new_value: SelectOption<any>): void {\n    this.value.next(new_value);\n    if (this._onChange) {\n      this._onChange(this.options.find(f => f.value === new_value.value));\n    }\n  }\n\n  /**\n * Update local value when form control value is changed\n * @param value The new value for the component\n */\n  public writeValue(value: SelectOption<any> | null) {\n    if (value != null) {\n      this.value.next(value.value);\n    }\n  }\n\n  /**\n   * Registers a callback function that is called when the control's value changes in the UI.\n   * @param fn The callback function to register\n   */\n  public registerOnChange(fn: (_: SelectOption<any>) => void): void {\n    this._onChange = fn;\n  }\n\n  /**\n   * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n   * @param fn The callback function to register\n   */\n  public registerOnTouched(fn: (_: SelectOption<any>) => void): void {\n    this._onTouch = fn;\n  }\n\n  public onChangeInput() {\n    if (this.filterFormControl.value === '') {\n      this.emptyBoxEvent.emit(true);\n    }\n  }\n\n  private scrollEvent = (event): void => {\n    if (this.trigger === null) {\n      return;\n    }\n    /**\n     * IF - to confirm user not scrolling from autocomplete opened panel and close panel if scroll event triggers from outside of panel\n     */\n    if (this.trigger.panelOpen && event.target.closest('.mat-autocomplete-panel') === null ) {\n      this.trigger.closePanel();\n        this.trigger['_element'].nativeElement.blur();\n    }\n  }\n  public ngOnDestroy(): void {\n    window.removeEventListener('scroll', this.scrollEvent, true);\n  }\n\n}","<div class=\"mck-column mck-form-input\">\n    <mck-label *ngIf=\"label\" [required]=\"required\">{{label}}</mck-label>\n    <mat-form-field\n                appearance=\"outline\"\n                class=\"mck-center-suffix\">\n      <input\n        type=\"text\"\n        autocomplete=\"off\"\n        matInput\n        #trigger=\"matAutocompleteTrigger\"\n        [formControl]=\"filterFormControl\"\n        [matAutocomplete]=\"auto\"\n        [placeholder]=\"placeholder\"\n        value={{selectedValue?.display}}\n        (keyup)=\"onChangeInput();\"\n      >\n      <mat-autocomplete\n        #auto=\"matAutocomplete\"\n        [displayWith]=\"displayFn\"\n        (optionSelected)=\"setValue($event.option.value)\"\n      >\n        <mat-option *ngFor=\"let option of filteredOptions | async\" [value]=\"option\">\n          {{option.shortDisplay || option.display}}\n        </mat-option>\n      </mat-autocomplete>\n    </mat-form-field>\n</div>","import {\n    AfterViewInit,\n    OnDestroy,\n    OnInit,\n    TemplateRef,\n    ViewChild,\n    ViewContainerRef,\n} from '@angular/core';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\n/**\n * A helper class for rendering embedded views (ng-template) as standalone components.\n *\n * If the view is lazy and does not render upon initialization,\n * it attempts embedding view again later.\n *\n * When testing a component directly that extends this class, its best to wrap the component\n * in a wrapper component for testing so that it can render itself.\n */\nexport class BaseTemplateComponent extends BaseDirective implements AfterViewInit, OnInit, OnDestroy {\n    @ViewChild(TemplateRef, { static: true })\n    public template: TemplateRef<any>;\n\n    private isRendered = false;\n\n    constructor(private vcRef: ViewContainerRef) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        // try early rendering\n        this.attemptViewEmbed();\n    }\n\n    public attemptViewEmbed() {\n        if (this.template && !this.isRendered) {\n            this.isRendered = true;\n            this.vcRef.createEmbeddedView(this.template);\n            return true;\n        }\n        return false;\n    }\n\n    public ngAfterViewInit(): void {\n        if (!this.isRendered) {\n            console.log('View not rendered yet, attempting to post initialization');\n            setTimeout(() => {\n                console.log('Timeout ended, trying again', this.template);\n                if (!this.attemptViewEmbed()) {\n                    console.log('Attempting render in after view initialization');\n                    setTimeout(() => {\n                        if (!this.attemptViewEmbed()) {\n                            console.error('FAILED TO LOAD TEMPLATE');\n                        }\n                    }, 1000);\n                }\n            });\n        }\n    }\n\n    public ngOnDestroy(): void {\n        super.ngOnDestroy();\n        this.isRendered = false;\n    }\n}\n","import {\n    Component,\n    Output,\n    TemplateRef,\n    ViewChild,\n    EventEmitter,\n    Input\n  } from \"@angular/core\";\n  import { DropdownPanel } from \"./dropdown-panel\";\n  \n  @Component({\n    selector: \"cng-select-options\",\n    templateUrl: \"./cng-select-options.component.html\",\n    styleUrls: [\"./cng-select-options.component.scss\"]\n  })\n  export class CngSelectOptionsComponent implements DropdownPanel {\n    @ViewChild(TemplateRef) templateRef: TemplateRef<any>;\n    @Output() closed = new EventEmitter<void>();\n    @Input() ddWidth: string;\n  \n    constructor() {}\n  }\n  ","<ng-template>\n    <div (click)=\"closed.emit()\" class=\"dropdown-content flex-column\" [ngStyle]=\"{'width': ddWidth}\" >\n      <ng-content></ng-content>\n    </div>\n  </ng-template>","import {\n    Component,\n    Output,\n    TemplateRef,\n    ViewChild,\n    EventEmitter,\n    Input,\n    OnInit\n  } from \"@angular/core\";\n  import { DropdownPanel, DropdownOpion } from \"./dropdown-panel\";\n  \n  @Component({\n    selector: \"cng-select\",\n    templateUrl: \"./cng-select.component.html\",\n    styleUrls: [\"./cng-select.component.scss\"]\n  })\n  export class CngSelectComponent implements OnInit {\n    @Input() data: any;\n    public isClosed: boolean = false;\n    public selected: DropdownOpion;\n    constructor() {\n\n    }\n    ngOnInit(): void {\n      this.selected = this.data.defaultSelected;\n    }\n\n    public optionSelected(item: DropdownOpion) {\n      // this.selected = item;\n      this.data.defaultSelected = item;\n      this.data?.onChangeCallback && this.data?.onChangeCallback(item);\n    }\n  }\n  ","\n\n<div name=\"level\" [dropdownTriggerFor]=\"dropdown\" class=\"cng-select flex-row\" [class]=\"data?.ddBoxClass\" [ngClass]=\"{'focus': isClosed, 'disabled': data?.disabled }\" matRipple (isPanelOpened)=\"isClosed = !isClosed\">\n  <span class=\"selecte-sort\" style=\"flex: 1 1 auto ;\">{{data?.defaultSelected?.display}}</span>\n  <div class=\"mck-column select-chevron\">\n      <mck-chevron-icon [up]=\"isClosed\" matSuffix fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n  </div>\n</div>\n<cng-select-options #dropdown ddWidth >\n    <div matRipple *ngFor=\"let item of data?.options\" (click)=\" optionSelected(item)\" class=\"dropdown-item flex-row\" [class]=\"data?.optionBoxClass\" [ngClass]=\"{'selected' : data?.defaultSelected?.value === item?.value }\">{{item?.display}}</div>\n</cng-select-options>","import {\n  AfterViewInit,\n    Directive,\n    ElementRef,\n    EventEmitter,\n    Input,\n    OnDestroy,\n    OnInit,\n    Output,\n    Renderer2,\n    ViewContainerRef\n  } from '@angular/core';\n  import { DropdownPanel } from './dropdown-panel';\n  import { Overlay, OverlayRef } from '@angular/cdk/overlay';\n  import { TemplatePortal } from '@angular/cdk/portal';\n  import { merge, Observable, Subscription } from 'rxjs';\n  \n  @Directive({\n    selector: '[dropdownTriggerFor]',\n    host: {\n      '(click)': 'toggleDropdown()'\n    }\n  })\n  export class DropdownTriggerForDirective implements OnDestroy, AfterViewInit, OnInit {\n    private isDropdownOpen = false;\n    private overlayRef: OverlayRef;\n    private dropdownClosingActionsSub = Subscription.EMPTY;\n  \n    @Input('dropdownTriggerFor') public dropdownPanel: DropdownPanel;\n    @Output() isPanelOpened = new EventEmitter<boolean>();\n    constructor(\n      private overlay: Overlay,\n      private elementRef: ElementRef<HTMLElement>,\n      private viewContainerRef: ViewContainerRef,\n      private renderer: Renderer2\n    ) {\n     \n    }\n    ngOnInit(): void {\n      // const cngSelectEl = this.elementRef.nativeElement.nextElementSibling; \n      // const parentWidth = this.elementRef.nativeElement.offsetWidth; \n      // this.renderer.setStyle(cngSelectEl, 'width', `${parentWidth}px`);\n    }\n    ngAfterViewInit(): void {\n      \n    }\n\n  \n    toggleDropdown(): void {\n      this.isDropdownOpen ? this.destroyDropdown() : this.openDropdown();\n      \n    }\n  \n    openDropdown(): void {\n      let {ddWidth} = this.dropdownPanel;\n      this.dropdownPanel.ddWidth = ddWidth !=='' ? ddWidth : `${this.elementRef.nativeElement.offsetWidth}px`;\n      this.isDropdownOpen = true;\n      this.isPanelOpened.emit(this.isDropdownOpen);\n      this.overlayRef = this.overlay.create({\n        hasBackdrop: true,\n        backdropClass: 'cdk-overlay-transparent-backdrop',\n        scrollStrategy: this.overlay.scrollStrategies.close(),\n        positionStrategy: this.overlay\n          .position()\n          .flexibleConnectedTo(this.elementRef)\n          .withPositions([\n            {\n              originX: 'end',\n              originY: 'bottom',\n              overlayX: 'end',\n              overlayY: 'top',\n              offsetY: 8\n            }\n          ])\n      });\n  \n      const templatePortal = new TemplatePortal(\n        this.dropdownPanel.templateRef,\n        this.viewContainerRef\n      );\n      this.overlayRef.attach(templatePortal);\n  \n      this.dropdownClosingActionsSub = this.dropdownClosingActions().subscribe(\n        () => this.destroyDropdown()\n      );\n    }\n  \n    private dropdownClosingActions(): Observable<MouseEvent | void> {\n      const backdropClick$ = this.overlayRef.backdropClick();\n      const detachment$ = this.overlayRef.detachments();\n      const dropdownClosed = this.dropdownPanel.closed;\n  \n      return merge(backdropClick$, detachment$, dropdownClosed);\n    }\n  \n    private destroyDropdown(): void {\n      if (!this.overlayRef || !this.isDropdownOpen) {\n        return;\n      }\n  \n      this.dropdownClosingActionsSub.unsubscribe();\n      this.isDropdownOpen = false;\n      this.isPanelOpened.emit(this.isDropdownOpen);\n      this.overlayRef.detach();\n    }\n  \n    ngOnDestroy(): void {\n      if (this.overlayRef) {\n        this.overlayRef.dispose();\n      }\n    }\n  }\n  ","import {\n    Component,\n    Input,\n    OnInit,\n    ViewEncapsulation\n} from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\n\n@Component({\n    selector: 'mck-collapse-header',\n    template: `\n        <mat-expansion-panel\n            [disabled]=\"isLoading\"\n            name=\"expansion-panel\"\n            class=\"mck-expansion-panel {{(isExpanded | async) && 'mck-expanded'}}\"\n            (opened)=\"isExpanded.next(true)\"\n            (closed)=\"isExpanded.next(false)\" hideToggle>\n            <mat-expansion-panel-header *ngIf=\"!isLoading\" name=\"expansion-panel-header\">\n                <mat-panel-title>{{title}}</mat-panel-title>\n                <div class=\"mck-collapse-icon\" [class.expanded]=\"isExpanded | async\"></div>\n            </mat-expansion-panel-header>\n            <mat-expansion-panel-header *ngIf=\"isLoading\">\n                <div class=\"mck-row mck-center\">\n                    <ngx-skeleton-loader class=\"mck-skeleton-header\"></ngx-skeleton-loader>\n                </div>\n            </mat-expansion-panel-header>\n            <mat-panel-description *ngIf=\"description && (isExpanded | async)\">{{description}}</mat-panel-description>\n            <ng-template matExpansionPanelContent>\n                <ng-content></ng-content>\n            </ng-template>\n        </mat-expansion-panel>\n    `,\n    styleUrls: ['./collapse-header.component.scss'],\n})\nexport class CollapseHeaderComponent implements OnInit {\n\n    @Input()\n    title: string;\n\n    @Input()\n    description: string;\n\n    /**\n     * If true, show skeleton.\n     */\n    @Input()\n    isLoading = false;\n\n    public isExpanded = new BehaviorSubject(false);\n\n    constructor() {\n    }\n\n    ngOnInit(): void {\n    }\n\n}\n","import { ChangeDetectionStrategy, Component, Inject, OnInit, ViewEncapsulation } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\n\nexport interface RoomAvaibilityModalData {\n\theaderText: string,\n\tmessage: string,\n\tbuttonLabel: string,\n\tcallback: Function,\n    shouldClose: boolean\n}\n\n@Component({\n    selector: 'conflict-alert-modal',\n    templateUrl: 'conflict-alert-modal.component.html',\n    styleUrls: ['./conflict-alert-modal.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n})\nexport class ConflictAlertModalComponent implements OnInit {\n    constructor(public dialogRef: MatDialogRef<ConflictAlertModalComponent>,\n        @Inject(MAT_DIALOG_DATA) public dialogData: RoomAvaibilityModalData) {\n    }\n    ngOnInit(): void {}\n\n    public done() {\n        this.dialogData?.callback(); this.dialogRef.close()\n    }\n}\n","<div>\n    <mck-modal [shouldClose]=\"dialogData?.shouldClose\">\n        <div class=\"nc-modal\">\n\t\t\t\t\t<div class=\"mck-column modal-heading\">\n\t\t\t\t\t\t\t<div class=\"header mck-column\">\n\t\t\t\t\t\t\t\t\t<img src=\"assets/icon/room-not-available.svg\" />\n\t\t\t\t\t\t\t\t\t<span>{{dialogData?.headerText}}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"alert-message\">{{dialogData?.message}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</mck-modal>\n\t\t\t<mat-dialog-actions>\n\t\t\t\t\t <mck-modal-button-row [primaryLabel]=\"dialogData?.buttonLabel\" (primarySubmit)=\"done()\"></mck-modal-button-row>\n\t\t\t</mat-dialog-actions>\n</div>","import {Component, EventEmitter, Inject, Input, OnInit, Output} from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport {DialogEvent} from '@mckinsey-converge/base';\nimport {DateTZ, isToday} from '@mckinsey-converge/date-tz';\n\nexport interface ConflictsModalComponentData {\n  room_name: string;\n  conflicts: number[];\n  copy_conflicts?: boolean;\n  timezone: string;\n}\n\n@Component({\n  selector: 'app-conflicts-modal',\n  templateUrl: './conflicts-modal.component.html',\n  styleUrls: ['./conflicts-modal.component.scss']\n})\nexport class ConflictsModalComponent implements OnInit{\n  public room_name: string;\n  public conflicts: number[];\n  public copy_conflicts: boolean;\n  public timezone;\n\n\n  @Output() public event = new EventEmitter<DialogEvent>();\n\n  constructor(@Inject(MAT_DIALOG_DATA) private _data: ConflictsModalComponentData){\n\n  }\n\n  public ngOnInit(){\n    this.timezone = this._data.timezone;\n    this.room_name = this._data.room_name\n    this.conflicts = this._data.conflicts\n    this.copy_conflicts = this._data.copy_conflicts\n  }\n\n  public formatDate(date: number) {\n    const dateTZ = new DateTZ({date: date*1000,  is_local_tz: false, building_tz: this._data.timezone});\n    const dateIsToday = isToday(dateTZ, this.timezone);\n    const display = dateTZ.formatDate('ccc dd MMM yyyy');\n    return `${display}${dateIsToday ? ' (Today)' : ''}`;\n  }\n\n  public continue(): void {\n    this.event.emit({ reason: 'done' });\n  }\n\n  public close(): void {\n    this.event.emit({ reason: 'close' });\n  }\n\n  public copy(): void {\n    this.event.emit({ reason: 'action' });\n  }\n\n\n}\n","<div class=\"header\">\n    <button mat-icon-button mat-dialog-close name=\"close\">\n        <div class=\"close-image\"></div>\n    </button>\n</div>\n<mat-dialog-content #content>\n    <div class=\"conflicts-content-header\">\n        <h2>Conflicts ({{conflicts.length}})</h2>\n        <div class=\"info\" *ngIf=\"!copy_conflicts\">\n            The {{room_name}} room is not available on the following dates.\n            Do you want to proceed <span>without booking</span> these days?\n        </div>\n        <div class=\"info\" *ngIf=\"copy_conflicts\">\n            The {{room_name}} room is not available on the following dates.\n            You need to make individual bookings to cover these days, please.\n        </div>\n    </div>\n    <div class=\"conflicts-list\">\n        <div class=\"conflicts-list--header\">\n            Date\n        </div>\n        <div class=\"items\">\n            <div class=\"item\" *ngFor=\"let conflict of conflicts\">\n                {{formatDate(conflict)}}\n            </div>\n        </div>\n    </div>\n</mat-dialog-content>\n<mat-dialog-actions>\n    <button\n            mat-button\n            class=\"inverse\"\n            i18n=\"Booking spaces cancel action\"\n            (click)=\"copy_conflicts ? copy() : close()\"\n            [class.copy]=\"copy_conflicts\"\n    >\n       {{copy_conflicts ? 'Copy to clipboard' : 'Close'}}\n    </button>\n    <button\n            mat-button\n            name=\"next\"\n            i18n=\"Booking spaces continue action\"\n            (click)=\"copy_conflicts ? close() : continue()\"\n            [class.copy]=\"copy_conflicts\"\n    >\n    {{copy_conflicts ? 'Close' : 'Continue'}}\n    </button>\n</mat-dialog-actions>\n","import {\n    Component,\n    OnInit,\n    Input,\n    Output,\n    OnChanges,\n    SimpleChanges,\n    forwardRef,\n    EventEmitter,\n} from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { BaseClass } from '@mckinsey-converge/base';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\nexport interface IDateTzPickerOptions {\n    /** DateTZ object. First selectable date */\n    fromDateTz?: DateTZ;\n    /** DateTZ object. Last selectable date */\n    untilDateTz?: DateTZ;\n    /** Luxon format string for formatting days of the week. Defaults to `DDD` */\n    day_format?: string;\n    /** Luxon format string for formatting active month. Defaults to `MMMM yyyy` */\n    month_format?: string;\n}\n\ninterface IDateBlock {\n    /** Timestamp value of the date */\n    value: DateTZ;\n    /** Day of the month to display */\n    display: string;\n    /** Whether block is the selected date */\n    active: boolean;\n    /** Whether block not selectable */\n    disabled: boolean;\n    /** Whether block outside the active month */\n    non_month: boolean;\n    /** Whether the block is today */\n    today: boolean;\n    /** Number of events on this block */\n    count?: number;\n}\n\n@Component({\n    selector: 'date-tz-calendar-widget',\n    templateUrl: './date-tz-calendar-widget.component.html',\n    styleUrls: ['./date-tz-calendar-widget.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DateTzCalendarWidgetComponent),\n            multi: true,\n        },\n    ],\n})\nexport class DateTzCalendarWidgetComponent\n    extends BaseClass\n    implements OnInit, OnChanges, ControlValueAccessor\n{\n    /** CSS class to add to the root element of the component */\n    @Input() public className = 'default';\n    /** Counters of the events on given dates. Key format is `yyyy-MM-dd` */\n    @Input() public counters: { [date: string]: number };\n    /** Settings for the date picker component */\n    @Input() public options: IDateTzPickerOptions;\n    /** Offset of the display month from the current month */\n    @Output() public month = new EventEmitter<number>();\n\n    public readonly weeks = new Array(6).fill(0);\n    public selectedDateTz: DateTZ = DateNow();\n\n    // R--- this is the date picker that needs to be TZ aware\n    /** Offset of the month displayed from the current month */\n    public offset = 0;\n    /** Minimum offset for changing the month */\n    public min_offset = -999999;\n    /** Maximum offset for changing the month */\n    public max_offset = 999999;\n    /** Blocks representing the rendering details of the display days of the month */\n    public date_list: IDateBlock[] = [];\n    /** Name of the actively displayed month */\n    public month_name = DateNow(new Date()).formatDate('MMMM yyyy');\n    /** Name of the days of the week to display */\n    public days_of_week = [];\n    /** First selectable date */\n    private fromTz: DateTZ;\n    /** Last selectable date */\n    private toTz: DateTZ;\n    /** Luxon format string for formatting days of the week. Defaults to `dd` */\n    private day_format = 'EEE';\n    /** Luxon format string for formatting active month. Defaults to `MMMM yyyy` */\n    private month_format = 'MMMM yyyy';\n    /** Form control on change handler */\n    private _onChange: (_: DateTZ) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: DateTZ) => void;\n\n    private _today = DateNow();\n\n    public get timezone() {\n        return this.selectedDateTz?.building_tz || '';\n    }\n\n    public ngOnInit(): void {\n        this.generateMonth();\n        this.generateDaysOfTheWeek();\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.options) {\n            this.updateOptions();\n        }\n        if (changes.counters) {\n            this.generateMonth();\n        }\n    }\n\n    /** Change date using the given block */\n    public setDate(item: IDateBlock) {\n        this.selectedDateTz = item.value;\n        if (this._onChange) {\n            this._onChange(this.selectedDateTz);\n        }\n        this.generateMonth();\n    }\n\n    /**\n     * Update offset to show the selected date 2\n     */\n    public updateDate(): void {\n        if (!this.selectedDateTz) {\n            return;\n        }\n        const now = this._today.startOfValue('month');\n        const startOfMonthDateTz = this.selectedDateTz.startOfValue('month');\n        if (startOfMonthDateTz.valid) {\n            const difference = startOfMonthDateTz.dateDiff(\n                now,\n                'months',\n                'months'\n            );\n            if (this.offset !== difference) {\n                this.offset = Math.round(difference);\n                this.month.emit(this.offset);\n            }\n            this.generateMonth();\n        }\n    }\n\n    /**\n     * Update local properties based off changes to settings\n     */\n    public updateOptions(): void {\n        if (this.options) {\n            // Setup from date\n            if (this.options.fromDateTz) {\n                const today = this._today.startOfValue('month');\n                this.fromTz = this.options.fromDateTz.startOfValue('day');\n                this.min_offset = Math.round(\n                    this.fromTz\n                        .startOfValue('month')\n                        .dateDiff(today, 'months', 'months')\n                );\n            } else if (this.fromTz) {\n                this.fromTz = null; // R-- check if ok\n                this.min_offset = -999999;\n            }\n            // Setup to date\n            if (this.options.untilDateTz) {\n                const today = this._today.startOfValue('month');\n                this.toTz = this.options.untilDateTz.startOfValue('day');\n                this.max_offset = this.toTz\n                    .startOfValue('month')\n                    .dateDiff(today, 'months', 'months');\n            } else if (this.toTz) {\n                this.toTz = null;\n                this.max_offset = 999999;\n            }\n            if (this.options.month_format) {\n                this.month_format = this.options.month_format || 'MMMM yyyy';\n            }\n            if (this.options.day_format) {\n                this.day_format = this.options.day_format || 'EEE';\n                this.generateDaysOfTheWeek();\n            }\n            // Update date blocks\n            this.generateMonth();\n        }\n    }\n\n    /**\n     * Generate the display blocks for the days of the active month\n     */\n    private generateMonth(): void {\n        this._today = new DateTZ({ date: Date.now(), is_local_tz: !this.timezone, building_tz: this.timezone });\n        const startOfMonthDateTz = this._today.addValue({ months: this.offset });\n        const active = this.selectedDateTz || DateNow();\n        let startDate = startOfMonthDateTz\n            .setValue({ day: 1 })\n            .setValue({ weekday: 7 })\n            .subtractValue({ weeks: 1 });\n        this.date_list = [];\n        for (let i = 0; i < 42; i++) {\n            this.date_list.push({\n                value: startDate,\n                display: startDate.formatDate('d'),\n                active: active.isSameDate(startDate, 'day'),\n                non_month: !startOfMonthDateTz.isSameDate(startDate, 'month'),\n                count: this.counters\n                    ? this.counters[startDate.formatDate('yyyy-MM-dd')] || 0\n                    : 0,\n                disabled:\n                    (this.fromTz ? startDate.ms < this.fromTz.ms : false) ||\n                    (this.toTz ? startDate.ms > this.toTz.ms : false),\n                today: this._today.isSameDate(startDate, 'day'),\n            });\n            startDate = startDate.addValue({ days: 1 });\n        }\n        this.month_name = startOfMonthDateTz.formatDate(this.month_format);\n    }\n\n    /**\n     * Generate this weekdays to display in the header of the calendar\n     */\n    private generateDaysOfTheWeek() {\n        let date = this._today.startOfValue('week');\n        this.days_of_week = [];\n        for (let i = 0; i < 7; i++) {\n            this.days_of_week.push(date.formatDate(this.day_format));\n            date = date.addValue({ days: 1 });\n        }\n    }\n\n    /**\n     * Changes the month offset by the given value.\n     * Does nothing if the new month is not available to be selected\n     * @param value Number of months to change the offset by\n     */\n    public changeMonth(value: number): void {\n        const new_offset = Math.min(\n            this.max_offset,\n            Math.max(this.min_offset, this.offset + value)\n        );\n        this.offset = Math.round(new_offset);\n        this.generateMonth();\n        this.month.emit(this.offset);\n    }\n\n    /**\n     * Reset the month offset to the month of the selected date\n     */\n    public reset() {\n        const offset = this.offset;\n        this.offset = Math.round(\n            this._today.dateDiff(this.selectedDateTz, 'months', 'months')\n        );\n        if (offset !== this.offset) this.generateMonth();\n        this.month.emit(this.offset);\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: DateTZ) {\n        if (value) {\n            this.selectedDateTz = value;\n            this.updateDate();\n            this.generateMonth();\n        }\n    }\n\n    public readonly registerOnChange = (fn: (_: DateTZ) => void) => this._onChange = fn;\n    public readonly registerOnTouched = (fn: (_: DateTZ) => void) => this._onTouch = fn;\n}\n","<div [class]=\"'date-picker' + (className ? ' ' + className : '')\" widget>\n    <div class=\"header\">\n        <button\n            matRipple\n            class=\"arrow previous\"\n            [disabled]=\"offset <= min_offset\"\n            (click)=\"changeMonth(-1)\"\n        >\n            <div class=\"previous icon\"></div>\n        </button>\n        <div class=\"month\" (dblclick)=\"reset()\">{{ month_name }}</div>\n        <button\n            matRipple\n            class=\"arrow next\"\n            [disabled]=\"offset >= max_offset\"\n            (click)=\"changeMonth(1)\"\n        >\n            <div class=\"next icon\"></div>\n        </button>\n    </div>\n    <table>\n        <thead>\n            <td *ngFor=\"let item of days_of_week\">{{ item }}</td>\n        </thead>\n        <tbody>\n            <tr *ngFor=\"let week of weeks; let i = index\">\n                <td *ngFor=\"let item of date_list | slice: i * 7:i * 7 + 7\">\n                    <button\n                        matRipple\n                        class=\"date\"\n                        (click)=\"setDate(item)\"\n                        [disabled]=\"item.disabled\"\n                        [class.non-month]=\"item.non_month\"\n                        [class.active]=\"item.active\"\n                    >\n                        {{ item.display }}\n                        <div class=\"dot\" *ngIf=\"item.today\"></div>\n                        <div class=\"count\" *ngIf=\"item.count\">{{item.count > 9 ? '+9' : item.count}}</div>\n                    </button>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n</div>\n","import {\n    Component,\n    EventEmitter,\n    forwardRef,\n    Input,\n    Output,\n    ViewChild,\n    OnInit\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\n\nimport { MatMenuTrigger } from '@angular/material/menu';\nimport {\n    BehaviorSubject,\n    Observable\n} from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { DateTzCalendarWidgetComponent } from '../date-tz-calendar-widget/date-tz-calendar-widget.component';\n\n@Component({\n    selector: 'date-tz-date-picker',\n    template: `\n        <div\n            [class.icon-only]=\"icon_only\"\n            [class.mck-form-input]=\"!icon_only\"\n            [class.mck-column]=\"!icon_only\"\n            [class.error]=\"error\"\n        >\n            <mck-label [required]=\"true\" *ngIf=\"!icon_only && label\">{{label}}</mck-label>\n                <div\n                    [class.mck-date-display]=\"!icon_only\"\n                    [class.mck-input]=\"!icon_only\"\n                    role=\"button\"\n                    form-field\n                    tabindex=\"0\"\n                    [class.active]=\"is_open\"\n                    [attr.disabled]=\"disabled\"\n                    (keydown.enter)=\"openDatePicker()\"\n                    [matMenuTriggerFor]=\"appMenu\"\n                    [class.date-error]=\"invalid || error\"\n                    \n                >\n                <div class=\"display\" *ngIf=\"!icon_only\">{{ dateString | async }}</div>\n                <div class=\"icon\">\n                    <mck-calendar-icon\n                        [fillClass]=\"is_open ? 'mck-icon-fill-open' : 'mck-icon-fill-black'\"></mck-calendar-icon>\n                </div>\n            </div>\n            \n            <mat-menu #appMenu=\"matMenu\" xPosition=\"before\" (close)=\"onDatePickerClose()\">\n                <div class=\"date-picker\" (click)=\"$event.stopPropagation()\">\n                    <date-tz-calendar-widget\n                        className=\"mck-date-picker\"\n                        [counters]=\"counters\"\n                        [ngModel]=\"selectedDateTzValue | async\"\n                        [options]=\"{ fromDateTz: fromDateTz, untilDateTz: untilDateTz, day_format: 'EEE' }\"\n                        (ngModelChange)=\"setValue($event); closeDatePicker()\"\n                    ></date-tz-calendar-widget>\n                    <button\n                        mat-stroked-button\n                        color=\"primary\"\n                        class=\"mck-stroked-button today-button\"\n                        *ngIf=\"can_pick_today\"\n                        (click)=\"goToToday()\"\n                    >Today\n                    </button>\n                </div>\n            </mat-menu>\n        </div>\n    `,\n    styleUrls: ['./date-tz-date-picker.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DateTzDatePickerComponent),\n            multi: true\n        }\n    ]\n})\nexport class DateTzDatePickerComponent extends BaseDirective implements OnInit, ControlValueAccessor {\n    @Input() public label?: string;\n    /** Earliest date available the user is allowed to pick */\n    @Input() public fromDateTz: DateTZ = DateNow(new Date());\n    /** Latest date available the user is allowed to pick */\n    @Input() public untilDateTz: DateTZ = DateNow(new Date()).endOfValue('day').addValue({ years: 1 });\n    /** Position of the tooltip */\n    @Input() public position: 'right' | 'left' = 'right';\n    /** Offset of the tooltip */\n    @Input() public offset: 'top' | 'bottom' = 'bottom';\n    /** Whether form control is disabled */\n    @Input() public disabled: boolean;\n    // R-- possible TODO, address all_day that disables this input and displays \"Add Day for the value like the time picker\"\n    @Input() public all_day: boolean = false;\n    /** Whether to show the calendar tooltip */\n    @Input() public icon_only: boolean = false;\n\n    @Input() public counters: any;\n\n    @Input() public initialDateSelectionTz?: DateTZ;\n\n    @Output() public onSelect = new EventEmitter();\n\n    @Input() public invalid?: boolean;\n\n    @Input() public timezone?: string;\n\n    @Input() public can_pick_today: boolean = true;\n\n    /** Whether form control is invalid, touched and contains errors */\n    @Input() public error?: boolean;\n\n    public ngOnInit(): void {\n        if (this.initialDateSelectionTz) {\n            this.writeValue(this.initialDateSelectionTz)\n        }\n    }\n\n    /** Whether to show the calendar tooltip */\n    public show_tooltip: boolean;\n    /** Form control on change handler */\n    private _onChange: (_: DateTZ) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: DateTZ) => void;\n\n    @ViewChild(MatMenuTrigger, { static: true }) private _trigger: MatMenuTrigger;\n    @ViewChild(DateTzCalendarWidgetComponent, {static: true }) private _acaDatePicker: DateTzCalendarWidgetComponent;\n    /** Currently selected date */\n    public selectedDateTzValue = new BehaviorSubject<DateTZ>(DateNow(new Date()));\n\n    /** Display value for the current date */\n    public get dateString(): Observable<string> {\n        return this.selectedDateTzValue.pipe(map(d => {\n            const display = d.formatDate('ccc dd MMM yyyy');\n            return `${display}${d.isSameDate(new DateTZ({ is_local_tz: false, building_tz: d.building_tz }), 'day') ? ' (Today)' : ''}`;\n        }));\n    }\n\n    /** Whether date picker is open */\n    public get is_open(): boolean {\n        return this._trigger.menuOpen;\n    }\n\n    // date\n    public get dateTzObservable(): Observable<DateTZ> {\n        return this.selectedDateTzValue.pipe(map(d => {\n            return d \n        }));\n\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(newValueTz: DateTZ) {\n        // Keep hours and minutes of the old date\n        const old_date = this.selectedDateTzValue.value;\n        let newDateTz = newValueTz.setValue({ hour: old_date.dateHour, minute: old_date.minutes, second: old_date.second });\n\n        // Check that new date is before from\n        if (newDateTz.ms < this.fromDateTz.ms) {\n            newDateTz = this.fromDateTz;\n        }\n\n        this.selectedDateTzValue.next(newDateTz);\n        if (this._onChange) {\n            this._onChange(newDateTz);\n        }\n\n        this.onSelect.emit(newDateTz);\n        this.show_tooltip = false;\n    }\n\n    public goToToday() {\n        const building_tz = this.timezone || this.fromDateTz.building_tz\n        const is_local_tz = DateNow(new Date()).building_tz === building_tz\n        this.setValue(new DateTZ({ is_local_tz, building_tz }));\n    }\n\n    public resetToLastSelection = () => this._acaDatePicker.updateDate();\n\n    public onDatePickerClose() {\n        this.resetToLastSelection();\n    }\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(selectedDateTz: DateTZ) {\n        this.selectedDateTzValue.next(selectedDateTz);\n        this.show_tooltip = false;\n    }\n\n    public readonly registerOnChange = (fn: (_: DateTZ) => void) => this._onChange = fn;\n    public readonly registerOnTouched = (fn: (_: DateTZ) => void) => this._onTouch = fn;\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /** Set the state of the tooltip to closed after delay */\n    public closeDatePicker() {\n        this._trigger.closeMenu();\n    }\n\n    /** Set the state of the tooltip to closed after delay */\n    public openDatePicker() {\n        this._trigger.openMenu();\n    }\n}\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport {\n    BaseDirective,\n    DurationGroup,\n    nearestDurationToInput,\n} from '@mckinsey-converge/base';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\nimport {\n    BehaviorSubject,\n    combineLatest\n} from 'rxjs';\n\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { map } from 'rxjs/operators'; \nimport {\n    DEFAULT_DURATION,\n    defaultDurationGroups,\n    generateDurationOptionsFromGroups\n} from '../utils/time.utils';\nimport { MatSelect } from '@angular/material/select';\nimport { convertLocalTimestampToTimezonedDateTz, convertTimezonedTimestampToLocalDateTz, DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'date-tz-duration-field',\n    template: `\n        <div class=\"mck-column mck-form-input\">\n            <mck-label *ngIf=\"label\" [required]=\"required\">{{label}}</mck-label>\n            <mat-form-field appearance=\"outline\" class=\"mck-center-suffix\">\n                <mat-select\n                    #select\n                    [placeholder]=\"(placeHolderOption | async)?.display\"\n                    panelClass=\"mck-select-panel\"\n                    [disabled]=\"all_day\"\n                    [value]=\"value | async\"\n                    (valueChange)=\"setValue($event)\"\n                    disableOptionCentering>\n                    <mat-option>\n                        <ngx-mat-select-search\n                            noEntriesFoundLabel=\"No timeslots found for current search. Try selecting one in the dropdown.\"\n                            [placeholderLabel]=\"(selectedOption | async)?.display\"\n                            [formControl]=\"filterFormControl\"></ngx-mat-select-search>\n                    </mat-option>\n                    <mat-option\n                        *ngFor=\"let option of options | async | filter: (nearestStep | async): 'display'\"\n                        [value]=\"option.value\"\n                        [disabled]=\"isDisabled(option)\">\n                        <mck-select-option\n                            [option]=\"option\"\n                            [selected]=\"isSelected(option) | async\"\n                        ></mck-select-option>\n                    </mat-option>\n                </mat-select>\n                <div class=\"mck-column\">\n                    <mck-chevron-icon [up]=\"isOpen\" matSuffix fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n                </div>\n            </mat-form-field>\n        </div>\n    `,\n    styleUrls: ['./date-tz-duration-field.component.css'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DateTzDurationFieldComponent),\n            multi: true\n        }\n    ],\n    encapsulation: ViewEncapsulation.None\n})\nexport class DateTzDurationFieldComponent extends BaseDirective implements OnInit, ControlValueAccessor, OnChanges {\n    @Input() public label?: string;\n    @Input() public required: boolean;\n    @Input() max_length?: number;\n\n    // /** Whether form field is disabled */\n    // @Input() public disabled: boolean;\n    /** Start date value to count from */\n    @Input() public startDateTz: DateTZ;\n    /** Set to limit the duration options */\n    @Input() public extended?: boolean;\n    /** Whether form all_day is enabled. */\n    // R-- need to address all_day that disables this input and displays \"Add Day for the value\"\n    @Input() public all_day: boolean = false;\n\n    /**\n     * Specify the slice of durations to use when generating options.\n     */\n    @Input() public durationGroups: DurationGroup[] = defaultDurationGroups;\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    /** Select field for selecting the time */\n    @ViewChild('select') private select_field: MatSelect;\n\n    /** Component will return a number of minutes */\n    public value = new BehaviorSubject<number>(DEFAULT_DURATION);\n\n    public currentStartDateTz = new BehaviorSubject(DateNow(new Date()));\n\n    public filterFormControl: FormControl = new FormControl();\n\n    public nearestStep = combineLatest([this.filterFormControl.valueChanges, this.currentStartDateTz]).pipe(\n            \n            map(([value, currentStartDate]) => { \n                /**\n                 * convert current start date/time to building time zone first\n                 *  \n                 */\n                const ms = convertTimezonedTimestampToLocalDateTz(currentStartDate.ms, currentStartDate.building_tz).ms;\n                return nearestDurationToInput(this.durationGroups, ms, value); \n            }\n        ));\n\n    public options = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public placeHolderOption = this.options.pipe(\n        map(options => options.find(o => o.value === DEFAULT_DURATION))\n    );\n\n    public selectedOption = combineLatest([this.options, this.value]).pipe(\n        map(([options, value]) => options.find(o => o.value === value))\n    );\n\n    public isSelected(option: SelectOption<any>) {\n        return this.value.pipe(map(t => t === option.value));\n    }\n\n    public isDisabled(option: SelectOption<any>) {\n        return this.max_length ? option.value > this.max_length : false;\n    }\n\n    public get isOpen() {\n        return this.select_field?.panelOpen ?? false;\n    }\n\n    ngOnInit(): void {\n        this.subscription('OptionsCalculation',\n            this.currentStartDateTz.pipe(\n                map(d => generateDurationOptionsFromGroups(d, this.durationGroups, this.extended))\n            ).subscribe(next => {\n                this.options.next(next);\n            }));\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.timezone) {\n            const dopt = generateDurationOptionsFromGroups(this.currentStartDateTz.value, this.durationGroups, this.extended);\n            this.options.next(dopt);\n        }\n        if (changes.startDateTz) {\n            this.currentStartDateTz.next(changes.startDateTz.currentValue);\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number): void {\n        this.writeValue(new_value);\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    writeValue(obj: number): void {\n        this.value.next(obj);\n        if (this._onChange) {\n            this._onChange(obj);\n        }\n    }\n\n    // public setDisabledState(disabled: boolean) {\n    //     this.disabled = disabled;\n    // }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n}\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation,\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    NG_VALUE_ACCESSOR,\n} from '@angular/forms';\nimport { MatSelect } from '@angular/material/select';\n\nimport {\n    BaseDirective,\n    closestToTimeSlotTz,\n    nearestStepToInput,\n    timeWithGmtOffsetFormatString,\n} from '@mckinsey-converge/base';\n\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport {\n    generateAvailableTimes,\n    generateAvailableTimesTz,\n} from '../utils/time.utils';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { filter, map, withLatestFrom } from 'rxjs/operators';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { DateTime } from 'luxon';\n\n@Component({\n    selector: 'date-tz-time-field',\n    template: `\n        <div class=\"mck-column mck-form-input\">\n            <mck-label *ngIf=\"label\" [required]=\"required\">{{\n                label\n            }}</mck-label>\n            <mat-form-field appearance=\"outline\" class=\"mck-center-suffix\">\n                <mat-select\n                    #select\n                    [placeholder]=\"(placeHolderOption | async)?.display\"\n                    panelClass=\"mck-select-panel\"\n                    [disabled]=\"all_day\"\n                    [value]=\"selectedTimeString | async\"\n                    (valueChange)=\"setValue($event)\"\n                    disableOptionCentering\n                >\n                    <mat-option>\n                        <ngx-mat-select-search\n                            noEntriesFoundLabel=\"No timeslots found for current search. Try selecting one in the dropdown.\"\n                            [placeholderLabel]=\"\n                                (selectedOption | async)?.display ||\n                                (placeHolderOption | async)?.display ||\n                                ''\n                            \"\n                            [formControl]=\"filterFormControl\"\n                        ></ngx-mat-select-search>\n                    </mat-option>\n                    <mat-option\n                        *ngFor=\"\n                            let option of options\n                                | async\n                                | filter: (nearestStep | async):'shortDisplay'\n                        \"\n                        [value]=\"option.display\"\n                    >\n                        <mck-select-option\n                            [option]=\"option\"\n                            [selected]=\"isSelected(option)\"\n                        ></mck-select-option>\n                    </mat-option>\n                </mat-select>\n                <div class=\"mck-column\">\n                    <mck-chevron-icon\n                        [up]=\"isOpen\"\n                        matSuffix\n                        fillClass=\"mck-icon-fill-black\"\n                    ></mck-chevron-icon>\n                </div>\n            </mat-form-field>\n        </div>\n    `,\n    styleUrls: ['./date-tz-time-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DateTzTimeFieldComponent),\n            multi: true,\n        },\n    ],\n    encapsulation: ViewEncapsulation.None,\n})\nexport class DateTzTimeFieldComponent\n    extends BaseDirective\n    implements OnInit, OnChanges, ControlValueAccessor\n{\n    @Input() public label?: string;\n    @Input() public required: boolean;\n    /** Time step between each allowed time option */\n    @Input() public step = 15;\n    /** Whether form field is disabled */\n    // @Input() public disabled: boolean;\n    /** Whether past times are allowed */\n    @Input() public noPastTimes = true;\n    /** Representing the DateTZ object datetime to start time options from **/\n    @Input() public fromDateTz: DateTZ = DateNow(new Date());\n    // Disables this input and displays R--- \"All Day\" for the value\n    @Input() public all_day: boolean = false;\n    @Input() public show_current: boolean = false;\n    @Input() public startFromDateTz: boolean = false;\n\n    /** Form control on change handler */\n    private _onChange: (_: DateTZ) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: DateTZ) => void;\n\n    /** Select field for selecting the time */\n    @ViewChild('select') private select_field: MatSelect;\n    /** DateTZ object representing the currently set datetime */\n    public selectedDateTz = new BehaviorSubject(\n        closestToTimeSlotTz(DateNow(new Date()), this.step)\n    );\n\n    /** string representing the currently set datetime display value, needed for the input to display the slected value */\n    public selectedTimeString = new BehaviorSubject(\n        timeWithGmtOffsetFormatString(this.selectedDateTz.value)\n    );\n\n    public filterFormControl: FormControl = new FormControl();\n\n    /** Available time blocks for the selected date */\n    public options = new BehaviorSubject<SelectOption<any>[]>(\n        generateAvailableTimesTz(\n            DateNow(),\n            !this.noPastTimes,\n            this.step,\n            this.timezone,\n            this.all_day,\n            this.show_current\n                ? [generateOptionForDateTz(DateNow())]\n                : [],\n            this.startFromDateTz\n        )\n    );\n\n    public ngOnInit(): void {\n        // Generate the time input options for the booking date\n        this.options.next(\n            generateAvailableTimesTz(\n                this.selectedDateTz.value,\n                !this.noPastTimes,\n                this.step,\n                this.timezone,\n                this.all_day,\n                this.show_current\n                    ? [generateOptionForDateTz(this.selectedDateTz.value)]\n                    : [],\n                this.startFromDateTz\n            )\n        );\n        // Subscribe to selected option changes\n        this.subscription(\n            'dateTimeChanges',\n            combineLatest([this.selectedDateTz])\n                .pipe(\n                    map(([selectedDateTz]) => {\n                        /**\n                         * The selectedDateTz should already be pegged to the closest time slot, but\n                         * if the selected time rolls into the past this can correct it.  // R--- verify this statement\n                         */\n                        return closestToTimeSlotTz(selectedDateTz, this.step);\n                    }),\n                    withLatestFrom(this.options),\n                    filter(\n                        ([date, timeOptions]: [\n                            DateTZ,\n                            SelectOption<any>[]\n                        ]) => {\n                            // if new time slot opened up when date / time changes, add it here.\n                            return !timeOptions.find(\n                                (t) => t.value === date.formatDate('HH:mm')\n                            );\n                        }\n                    ),\n                    map(([dateTz, timeOptions]) => {\n                        // TODO probably an issue here with going from a future date and time earlier than now back to day showing null\n                        // Push the current date option in\n                        timeOptions.push({\n                            display: timeWithGmtOffsetFormatString(dateTz),\n                            shortDisplay: dateTz.formatDate('hh:mma'),\n                            value: dateTz,\n                        });\n\n                        // Sort the time options\n                        timeOptions.sort((a, b) =>\n                            `${a.value}`.localeCompare(`${b.value}`)\n                        );\n                        return timeOptions;\n                    })\n                )\n                .subscribe((next) => {\n                    return this.options.next(next);\n                })\n        );\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (\n            changes.no_past_times ||\n            changes.step ||\n            changes.fromDateTz ||\n            changes.all_day\n        ) {\n            // If there's a new date value then update the time options\n            this.options.next(\n                generateAvailableTimesTz(\n                    this.selectedDateTz.value,\n                    !this.noPastTimes,\n                    this.step,\n                    this.timezone,\n                    this.all_day,\n                    this.show_current\n                        ? [generateOptionForDateTz(this.selectedDateTz.value)]\n                        : [],\n                    this.startFromDateTz\n                )\n            );\n            // If today and all day goes from on to off the selected value isn't going to be available.\n            if (\n                changes.all_day &&\n                !changes.all_day.currentValue &&\n                changes.all_day.previousValue\n            ) {\n                this.setValue(this.options.value[0].display);\n            }\n        }\n    }\n\n    /**\n     * Getter if the time picker options are visiable or not\n     */\n    public get isOpen() {\n        return this.select_field?.panelOpen ?? false;\n    }\n\n    /**\n     * Getter to return the current form timestamp from the from date object\n     */\n    public get timezone(): string {\n        return this.fromDateTz.building_tz;\n    }\n\n    /**\n     * A filter for finding a matching value when using the input text search\n     */\n    public nearestStep = combineLatest([\n        this.filterFormControl.valueChanges,\n        this.selectedDateTz,\n    ]).pipe(\n        map(([value, selectedDateTz]) => {\n            return nearestStepToInput(\n                this.step,\n                value,\n                DateTime.now().valueOf()\n            );\n        })\n    );\n\n    /**\n     * Default text displayed in the search field when the component initializes\n     */\n    public placeHolderOption = this.options.pipe(\n        map((os) => os.length > 0 && os[0])\n    );\n\n    /**\n     * Returns the selected option object by matching the selectedDateTz formated string with the option.display string\n     */\n    public selectedOption = combineLatest([\n        this.options,\n        this.selectedDateTz,\n    ]).pipe(\n        map(([options, selectedDateTz]) =>\n            options.find(\n                (o) =>\n                    o.display === timeWithGmtOffsetFormatString(selectedDateTz)\n            )\n        )\n    );\n\n    /**\n     * Determines the visually selected value when the options list is visible.\n     *\n     * @param option DateTZ\n     * @returns boolean\n     */\n    public isSelected(option: SelectOption<DateTZ>) {\n        return this.selectedTimeString.value === option.display;\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: DateTZ) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: DateTZ) => void): void {\n        this._onTouch = fn;\n    }\n\n    /**\n     * Method just used in unit tests to test disabling the input\n     * @param disabled\n     */\n    // public setDisabledState(disabled: boolean) {\n    //     this.disabled = disabled;\n    // }\n\n    /**\n     * Update the selected values\n     * @param dateTz the DateTz object for the new time\n     */\n    public setSelectedValues(dateTz: DateTZ) {\n        // Update the selected DateTz and string representations\n        this.selectedTimeString.next(timeWithGmtOffsetFormatString(dateTz));\n        this.selectedDateTz.next(dateTz);\n        if (this._onChange) {\n            this._onChange(dateTz);\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param displayString The \"display\" value of this.options set by the time picker\n     */\n    public setValue(displayString: string): void {\n        // Convert the display time string to the actual option object via an array find.\n        const newTimeTz = this.options.value.find(\n            (opt) => opt.display === displayString\n        ).value;\n        // Update the selected DateTz and string representations\n        this.setSelectedValues(newTimeTz);\n        // Send the\n        if (newTimeTz) {\n            if (this._onChange) {\n                this._onChange(newTimeTz);\n            }\n        }\n    }\n\n    /**\n     * Fires when the form control value is changed\n     * @param dateTz The new value for the component\n     */\n    public writeValue(dateTz: DateTZ | null) {\n        // Init is null ?\n        if (dateTz != null) {\n            // Update the selected DateTz and string representations\n            this.setSelectedValues(dateTz);\n            // Update the available options\n            this.options.next(\n                generateAvailableTimesTz(\n                    dateTz,\n                    !this.noPastTimes,\n                    this.step,\n                    dateTz.building_tz,\n                    this.all_day,\n                    this.show_current\n                        ? [generateOptionForDateTz(dateTz)]\n                        : [],\n                    this.startFromDateTz\n                )\n            );\n        }\n    }\n}\n\nfunction generateOptionForDateTz(dateTz: DateTZ): SelectOption<DateTZ> {\n    return {\n        display: timeWithGmtOffsetFormatString(dateTz),\n        shortDisplay: dateTz.formatDate('hh:mma'),\n        value: dateTz, \n    }\n}\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport {\n    BaseDirective,\n    nearestDurationToInput,\n    DurationGroup,\n} from '@mckinsey-converge/base';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\nimport {\n    BehaviorSubject,\n    combineLatest\n} from 'rxjs';\n\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport {\n    map\n} from 'rxjs/operators';\nimport {\n    DEFAULT_DURATION,\n    defaultDurationGroups,\n    generateDurationOptionsFromGroups\n} from '../utils/time.utils';\nimport { MatSelect } from '@angular/material/select';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'mck-duration-field',\n    template: `\n        <div class=\"mck-column mck-form-input\">\n            <mck-label [required]=\"required\">{{label}}</mck-label>\n            <mat-form-field appearance=\"outline\" class=\"mck-center-suffix\">\n                <mat-select\n                    #select\n                    [placeholder]=\"(placeHolderOption | async)?.display\"\n                    panelClass=\"mck-select-panel\"\n                    [value]=\"value | async\"\n                    [disabled]=\"disabled\"\n                    (valueChange)=\"setValue($event)\"\n                    disableOptionCentering>\n                    <mat-option>\n                        <ngx-mat-select-search\n                            noEntriesFoundLabel=\"No timeslots found for current search. Try selecting one in the dropdown.\"\n                            [placeholderLabel]=\"(selectedOption | async)?.display\"\n                            [formControl]=\"filterFormControl\"></ngx-mat-select-search>\n                    </mat-option>\n                    <mat-option\n                        *ngFor=\"let option of options | async | filter: (nearestStep | async): 'display'\"\n                        [value]=\"option.value\"\n                        [disabled]=\"isDisabled(option)\">\n                        <mck-select-option\n                            [option]=\"option\"\n                            [selected]=\"isSelected(option) | async\"\n                        ></mck-select-option>\n                    </mat-option>\n                </mat-select>\n                <div class=\"mck-column\">\n                    <mck-chevron-icon [up]=\"isOpen\" matSuffix fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n                </div>\n            </mat-form-field>\n        </div>\n    `,\n    styleUrls: ['./duration-field.component.css'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => DurationFieldComponent),\n            multi: true\n        }\n    ],\n    encapsulation: ViewEncapsulation.None\n})\nexport class DurationFieldComponent extends BaseDirective implements OnInit, ControlValueAccessor, OnChanges {\n    @Input()\n    public label: string;\n    @Input()\n    public required: boolean;\n    @Input() max_length?: number;\n\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Start date value to count from */\n    @Input() public startDate: number;\n    /** Set to limit the duration options */\n    @Input() public extended?: boolean;\n    /** Representing desired timezone **/\n    @Input() public timezone?: string = new DateTZ({ date: Date.now() }).local_tz;\n\n    /**\n     * Specify the slice of durations to use when generating options.\n     */\n    @Input() public durationGroups: DurationGroup[] = defaultDurationGroups;\n\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    /** Select field for selecting the time */\n    @ViewChild('select') private select_field: MatSelect;\n\n    public value = new BehaviorSubject<number>(DEFAULT_DURATION);\n\n    public currentStartDate = new BehaviorSubject(DateNow(new Date()));\n\n    public filterFormControl: FormControl = new FormControl();\n\n    public nearestStep = combineLatest([this.filterFormControl.valueChanges, this.currentStartDate]).pipe(\n        map(([value, currentStartDate]) => nearestDurationToInput(this.durationGroups, currentStartDate.ms, value)\n    ));\n\n    public options = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public placeHolderOption = this.options.pipe(\n        map(options => options.find(o => o.value === DEFAULT_DURATION))\n    );\n\n    public selectedOption = combineLatest([this.options, this.value]).pipe(\n        map(([options, value]) => options.find(o => o.value === value))\n    );\n\n    public isSelected(option: SelectOption<any>) {\n        return this.value.pipe(map(t => t === option.value));\n    }\n\n    public isDisabled(option: SelectOption<any>) {\n        return this.max_length ? option.value > this.max_length : false;\n    }\n\n    public get isOpen() {\n        return this.select_field?.panelOpen ?? false;\n    }\n\n    ngOnInit(): void {\n        this.subscription('OptionsCalculation',\n            this.currentStartDate.pipe(\n                map(d => generateDurationOptionsFromGroups(d.toZone(this.timezone), this.durationGroups, this.extended))\n            ).subscribe(next => {\n                this.options.next(next);\n            }));\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.timezone) {\n            const dopt = generateDurationOptionsFromGroups(this.currentStartDate.value.toZone(this.timezone), this.durationGroups, this.extended);\n            this.options.next(dopt);\n        }\n        if (changes.startDate) {\n            // R--- refactor input param\n            const date = new DateTZ({date: this.startDate})\n            this.currentStartDate.next(date);\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number): void {\n        this.writeValue(new_value);\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    writeValue(obj: number): void {\n        this.value.next(obj);\n        if (this._onChange) {\n            this._onChange(obj);\n        }\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n}\n","import { Component } from '@angular/core';\n\n@Component({\n    selector: 'mck-error-message',\n    template: `\n        <div class=\"mck-row\">\n            <div class=\"mck-row mck-center content\">\n                <div class=\"error-icon\"></div>\n                <span>\n                    <ng-content></ng-content>\n                </span>\n            </div>\n        </div>\n    `,\n    styleUrls: ['./error-message.component.scss']\n})\nexport class ErrorMessageComponent {\n\n    constructor() {\n    }\n\n}\n","import {\n    Component,\n    Input,\n    ViewContainerRef\n} from '@angular/core';\nimport { BaseTemplateComponent } from '../../base-template.component';\n\n@Component({\n    selector: 'mck-calendar-icon',\n    template: `\n        <ng-template>\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n                      [ngClass]=\"fillClass\"\n                      d=\"M4 0.5V2H1.5C0.671858 2 0 2.67186 0 3.5V5.5V14.5C0 15.3281 0.671858 16 1.5 16H14.5C15.3281 16 16 15.3281 16 14.5V5.5V3.5C16 2.67186 15.3281 2 14.5 2H12V0.5C12 0.223858 11.7761 0 11.5 0C11.2239 0 11 0.223858 11 0.5V2H5V0.5C5 0.223858 4.77614 0 4.5 0C4.22386 0 4 0.223858 4 0.5ZM11.5 3H4.5H1.5C1.22414 3 1 3.22414 1 3.5V5H15V3.5C15 3.22414 14.7759 3 14.5 3H11.5ZM1 6V14.5C1 14.7759 1.22414 15 1.5 15H14.5C14.7759 15 15 14.7759 15 14.5V6H1Z\"\n                />\n            </svg>\n        </ng-template>\n    `,\n})\nexport class CalendarIconComponent extends BaseTemplateComponent {\n\n    @Input()\n    fillClass?: string;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n}\n","import {\n    Component,\n    Input,\n    ViewContainerRef\n} from '@angular/core';\nimport { BaseTemplateComponent } from '../../base-template.component';\n\n@Component({\n    selector: 'mck-chevron-icon',\n    template: `\n        <ng-template>\n            <ng-container>\n                <div class=\"mck-chevron-icon\" [class.turn-up]=\"up\">\n                    <svg width=\"24\" height=\"24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n                            d=\"M11.957 10.664l4 4 .707-.707-4.707-4.707-4.707 4.707.707.707 4-4z\"\n                            [ngClass]=\"fillClass\"\n                            \n                        />\n                    </svg>\n                </div>\n            </ng-container>\n            <!-- <ng-container *ngIf=\"!up\">\n                <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                    <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n                          d=\"M11.9571 13.25L7.95711 9.25L7.25 9.95711L11.9571 14.6642L16.6642 9.95711L15.9571 9.25L11.9571 13.25Z\"\n                          [ngClass]=\"fillClass\" />\n                </svg>\n            </ng-container> -->\n        </ng-template>\n    `\n})\nexport class ChevronIconComponent extends BaseTemplateComponent {\n\n    @Input()\n    fillClass?: string;\n\n    @Input()\n    up?: boolean;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n}\n","import {\n    Component,\n    Input,\n    OnInit\n} from '@angular/core';\n\n@Component({\n    selector: 'mck-close-icon',\n    template: `\n        <svg width=\"9\" height=\"9\" viewBox=\"0 0 9 9\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n                  d=\"M7.50209 1.08543L1.08543 7.50209C0.971524 7.616 0.971524 7.80067 1.08543 7.91457C1.19933 8.02848 1.384 8.02848 1.49791 7.91457L7.91457 1.49791C8.02848 1.384 8.02848 1.19933 7.91457 1.08543C7.80067 0.971524 7.616 0.971524 7.50209 1.08543Z\"\n                  [ngClass]=\"fillClass\" />\n            <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n                  d=\"M1.08543 1.49791L7.50209 7.91457C7.616 8.02848 7.80067 8.02848 7.91457 7.91457C8.02848 7.80067 8.02848 7.616 7.91457 7.50209L1.49791 1.08543C1.384 0.971524 1.19933 0.971524 1.08543 1.08543C0.971524 1.19933 0.971524 1.384 1.08543 1.49791Z\"\n                  [ngClass]=\"fillClass\"\n            />\n        </svg>\n    `\n})\nexport class CloseIconComponent implements OnInit {\n\n    @Input()\n    fillClass?: string;\n\n    constructor() {\n    }\n\n    ngOnInit(): void {\n    }\n\n}\n","import {\n    Component,\n    Input,\n    ViewContainerRef,\n    ViewEncapsulation\n} from '@angular/core';\nimport { BaseTemplateComponent } from '../base-template.component';\n\n@Component(\n    {\n        selector: 'mck-informational-image',\n        template: `\n            <ng-template>\n                <div class=\"body\">\n                    <div class=\"info-block full\">\n                        <div class=\"image-wrapper full\">\n                            <img src=\"{{src}}\">\n                        </div>\n                    </div>\n                </div>\n            </ng-template>\n        `,\n        styleUrls: ['./informational-image.component.scss'],\n        encapsulation: ViewEncapsulation.None\n    }\n)\nexport class InformationalImageComponent extends BaseTemplateComponent {\n\n    @Input()\n    public src: string;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n}\n","import {\n    Component,\n    Input,\n    OnInit,\n    ViewContainerRef\n} from '@angular/core';\nimport { BaseTemplateComponent } from '../base-template.component';\n\n@Component({\n    selector: 'mck-label',\n    template: `\n        <ng-template>\n            <mat-label>\n                <ng-content></ng-content>\n                <span class=\"required-star\" *ngIf=\"required\">*</span>\n            </mat-label>\n        </ng-template>\n    `,\n    styleUrls: ['./label.component.scss']\n})\nexport class LabelComponent extends BaseTemplateComponent implements OnInit {\n\n    @Input()\n    required = false;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n\n}\n","import {\n    Component,\n    Input,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport { MatSelect } from '@angular/material/select';\nimport { SelectOption } from '../options/select-option';\n\n@Component({\n    selector: 'mck-legend-dropdown',\n    template: `\n        <div class=\"mck-column mck-form-input legend-container\">\n            <mat-form-field\n                appearance=\"outline\"\n                class=\"mck-center-suffix mck-select-dropdown-button\">\n                <mat-select\n                    class=\"legend-select\"\n                    #select\n                    panelClass=\"mck-select-panel select-panel-position\"\n                    disableOptionCentering>\n                    <mat-option\n                        [disabled]=\"true\"\n                        *ngFor=\"let option of options\"\n                        [value]=\"option.value\">\n                        <mck-select-option\n                            [ignoreDisabled]=\"true\"\n                            [option]=\"option\"\n                            [selected]=\"false\">\n                            <div class=\"legend-color-{{option.value}}\"></div>\n                        </mck-select-option>\n                    </mat-option>\n                </mat-select>          \n                <span class=\"legend-placeholder\">{{ buildPlaceholder() }}</span>\n                <mck-spacer\n                    size=\"1px\"\n                    [mode]=\"'vertical'\"\n                    spacerClass=\"legend-divider\"></mck-spacer>\n                <div class=\"mck-column chevron-container\">\n                    <mck-chevron-icon [up]=\"isOpen\" matSuffix fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n                </div>              \n            </mat-form-field>\n        </div>\n    `,\n    styleUrls: ['./legend-dropdown.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class LegendDropdownComponent {\n\n    @Input()\n    public placeholder: string;\n\n    @Input()\n    public options: SelectOption<any>[] = [];\n\n    @Input()\n    public placeholderOpen?: string\n\n    /** Select field for selecting the value */\n    @ViewChild('select') private select_field: MatSelect;\n\n    public get isOpen() {\n        return this.select_field?.panelOpen ?? false;\n    }\n\n    public buildPlaceholder(){\n        return this.isOpen && this.placeholderOpen ? this.placeholderOpen : this.placeholder\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    forwardRef,\n    Input,\n    Output,\n    ViewChild,\n    OnInit\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\n\nimport { MatMenuTrigger } from '@angular/material/menu';\nimport {\n    BehaviorSubject,\n    Observable\n} from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { AcaDatePickerComponent } from '../aca-date-picker/aca-date-picker.component';\n\n@Component({\n    selector: 'mck-date-picker',\n    template: `\n        <div\n            [class.icon-only]=\"icon_only\"\n            [class.mck-form-input]=\"!icon_only\"\n            [class.mck-column]=\"!icon_only\"\n        >\n            <mck-label [required]=\"true\" *ngIf=\"!icon_only\">Date</mck-label>\n            <div\n                [class.mck-date-display]=\"!icon_only\"\n                [class.mck-input]=\"!icon_only\"\n                [class.date-error]=\"invalid\"\n                role=\"button\"\n                form-field\n                tabindex=\"0\"\n                [class.active]=\"is_open\"\n                [attr.disabled]=\"disabled\"\n                (keydown.enter)=\"openDatePicker()\"\n                [matMenuTriggerFor]=\"appMenu\"\n                \n            >\n                <div class=\"display\" *ngIf=\"!icon_only\">{{ dateString | async }}</div>\n                <div class=\"icon\">\n                    <mck-calendar-icon\n                        [fillClass]=\"is_open ? 'mck-icon-fill-open' : 'mck-icon-fill-black'\"></mck-calendar-icon>\n                </div>\n            </div>\n            \n            <mat-menu #appMenu=\"matMenu\" xPosition=\"before\" (close)=\"onDatePickerClose()\">\n                <div mat-menu-item class=\"date-picker mck-column\" (click)=\"$event.stopPropagation()\">\n                    <date-tz-calendar-widget\n                        klass=\"mck-date-picker\"\n                        [ngModel]=\"date | async\"\n                        [options]=\"{ from: from, to: until, day_format: 'EEE' }\"\n                        (ngModelChange)=\"setValue($event); closeDatePicker()\"\n                    ></date-tz-calendar-widget>\n                    <button\n                        mat-stroked-button\n                        color=\"primary\"\n                        class=\"mck-stroked-button today-button\"\n                        (click)=\"goToToday()\"\n                    >Today\n                    </button>\n                </div>\n            </mat-menu>\n        </div>\n    `,\n    styleUrls: ['./mck-date-picker.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => MckDatePickerComponent),\n            multi: true\n        }\n    ]\n})\nexport class MckDatePickerComponent extends BaseDirective implements OnInit, ControlValueAccessor {\n    /** Earliest date available the user is allowed to pick */\n    @Input('from') public _from: number = DateNow(new Date()).ms;\n    /** Latest date available the user is allowed to pick */\n    @Input('to') public _to: number;\n    /** Position of the tooltip */\n    @Input() public position: 'right' | 'left' = 'right';\n    /** Offset of the tooltip */\n    @Input() public offset: 'top' | 'bottom' = 'bottom';\n    /** Whether form control is disabled */\n    @Input() public disabled: boolean;\n    /** Whether to show the calendar tooltip */\n    @Input() public icon_only: boolean = false;\n\n    @Input() public initialDateSelection?: number;\n\n    @Input() public invalid?: boolean;\n\n    @Output() public onSelect = new EventEmitter();\n\n    // R--- or is this the date picker to refactor. too tired.\n    public ngOnInit(): void {\n        if (this.initialDateSelection) {\n            this.writeValue(this.initialDateSelection)\n        }\n    }\n\n    /** Whether to show the calendar tooltip */\n    public show_tooltip: boolean;\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    @ViewChild(MatMenuTrigger, { static: true }) private _trigger: MatMenuTrigger;\n    @ViewChild(AcaDatePickerComponent, {static: true }) private _acaDatePicker: AcaDatePickerComponent;\n\n    /** Currently selected date */\n    public dateValue = new BehaviorSubject<DateTZ>(DateNow(new Date()));\n\n    /** First allowed date on the calendar */\n    public get from(): number {\n        return this._from || DateNow(new Date()).startOfValue('day').ms;\n    }\n\n    /** Current date value */\n    public get until(): number {\n        return this._to || DateNow(new Date()).endOfValue('day').addValue({ years: 1 }).ms;\n    }\n\n    /** Display value for the current date */\n    public get dateString(): Observable<string> {\n        return this.dateValue.pipe(map(d => {\n            const display = d.formatDate('ccc dd MMM yyyy');\n            return `${display}${d.isSameDate(DateNow(new Date()), 'day') ? ' (Today)' : ''}`;\n        }));\n    }\n\n    /** Whether date picker is open */\n    public get is_open(): boolean {\n        return this._trigger.menuOpen;\n    }\n\n    public get date(): Observable<DateTZ> {\n        return this.dateValue;\n\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: number) {\n        // Keep hours and minutes of the old date\n        const old_date = this.dateValue.value;\n        const d = new DateTZ({date: new_value})\n        let new_date = d\n            .setValue({ hour: old_date.dateHour, minute: old_date.minutes })\n            .ms;\n        // Check that new date is before from\n        if (new_date < this.from) {\n            new_date = this.from;\n        }\n        const new_d = new DateTZ({ date: new_date })\n        this.dateValue.next(new_d);\n        if (this._onChange) {\n            this._onChange(new_date);\n        }\n        this.onSelect.emit(new_date);\n        this.show_tooltip = false;\n    }\n\n    public goToToday() {\n        this.setValue(DateNow(new Date()).ms);\n    }\n\n    public resetToLastSelection = () => this._acaDatePicker.updateDate();\n\n    public onDatePickerClose() {\n        this.resetToLastSelection();\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number) {\n        const date = new DateTZ({date: value})\n        this.dateValue.next(date);\n        this.show_tooltip = false;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /** Set the state of the tooltip to closed after delay */\n    public closeDatePicker() {\n        this._trigger.closeMenu();\n    }\n\n    /** Set the state of the tooltip to closed after delay */\n    public openDatePicker() {\n        this._trigger.openMenu();\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output,\n    ViewContainerRef\n} from '@angular/core';\nimport { BaseTemplateComponent } from '../base-template.component';\n\n@Component({\n    selector: 'mck-modal-button-row',\n    template: `\n        <ng-template>\n            <div\n                class=\"button-wrapper\"\n                [class.has-fixed]=\"!disableFixed\">\n                <mck-spacer\n                    [autoSize]=\"true\"\n                    spacerClass=\"mck-spacer-content-expand-mobile mck-spacer-content-divider\"\n                    size=\"1px\">\n                </mck-spacer>\n                <div class=\"mck-row mck-center button-row\" [class.small-buttons]=\"smallButtons\">\n                    <button\n                        *ngIf=\"secondaryLabel\"\n                        mat-stroked-button class=\"mck-secondary-button mck-modal-secondary-button\"\n                        type=\"submit\"\n                        (click)=\"secondarySubmit.emit()\"\n                        [disabled]=\"secondaryDisabled\"\n                    >\n                        {{secondaryLabel}}\n                    </button>\n                    <button\n                        *ngIf=\"primaryLabel\"\n                        mat-button class=\"mck-primary-button mck-modal-primary-button\"\n                        type=\"submit\"\n                        (click)=\"primarySubmit.emit()\"\n                        [disabled]=\"primaryDisabled\"\n                    >\n                        {{primaryLabel}}\n\n                    </button>\n                </div>\n            </div>\n        </ng-template>\n    `,\n    styleUrls: ['./modal-button-row.component.scss']\n})\nexport class ModalButtonRowComponent extends BaseTemplateComponent {\n\n    @Input()\n    primaryLabel?: string;\n\n    /**\n     * Specify if you want to disable the primary button\n     */\n    @Input()\n    primaryDisabled?: boolean = false;\n\n    /**\n     * Used only if primaryLabel is specified.\n     */\n    @Output()\n    public primarySubmit = new EventEmitter();\n\n    /**\n     * Specify if you want to show a secondary label button\n     */\n    @Input()\n    secondaryLabel?: string;\n\n    @Input()\n    disableFixed: boolean = false;\n\n    /**\n     * Specify if you want to disable the secondary button\n     */\n    @Input()\n    secondaryDisabled?: boolean = false;\n\n    /**\n     * Used only if secondaryLabel is specified.\n     */\n    @Output()\n    public secondarySubmit = new EventEmitter();\n\n    @Input()\n    smallButtons?: boolean = false;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n\n}\n","import {\n    Component,\n    Input\n} from '@angular/core';\nimport { MatDialogRef } from '@angular/material/dialog';\n\n@Component({\n    selector: 'mck-modal',\n    template: `\n        <mat-dialog-content class=\"mck-column modal-container\">\n            <div class=\"mck-column modal-top mck-content-expand-width mck-stretch\">\n                <div class=\"button-row\">\n                    <button *ngIf=\"shouldClose\" name=\"CloseButton\" mat-icon-button (click)=\"close()\">\n                        <div class=\"close-image\"></div>\n                    </button>\n                </div>\n                <div class=\"mck-column mck-center\">\n                    <h1 name=\"ModalHeader\" class=\"modal-header\" *ngIf=\"header\">{{header}}</h1>\n                </div>\n            </div>\n            <ng-content></ng-content>\n        </mat-dialog-content>\n    `,\n    styleUrls: ['./modal.component.scss']\n})\nexport class ModalComponent {\n\n    @Input()\n    header?: string;\n    @Input() shouldClose?: boolean = true;\n\n    constructor(private dialogRef: MatDialogRef<ModalComponent>) {\n    }\n\n    public close() {\n        this.dialogRef.close();\n    }\n}\n","import { Component, EventEmitter, Inject, OnInit, Output } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { DialogEvent } from '@mckinsey-converge/base';\nimport { DateTZ, isToday } from '@mckinsey-converge/date-tz';\n\n\n@Component({\n  selector: 'override-changes-modal',\n  templateUrl: './override-changes-modal.component.html',\n  styleUrls: ['./override-changes-modal.component.scss']\n})\nexport class OverrideChangesModalComponent implements OnInit{\n\n  public edits;\n  public timezone;\n\n  @Output() public event = new EventEmitter<DialogEvent>();\n\n  constructor(@Inject(MAT_DIALOG_DATA) private _data: OverrideChangesModalComponent){\n\n  }\n\n  public ngOnInit(){\n      this.edits = this._data.edits.sort((a, b) =>  a - b);\n  }\n\n  public formatDate(date: number) {\n    const dateTZ = new DateTZ({date: date*1000, is_local_tz: false, building_tz: this._data.timezone });\n    const dateIsToday = isToday(dateTZ, this._data.timezone);\n    const display = dateTZ.formatDate('ccc dd MMM yyyy');\n    return `${display}${dateIsToday ? ' (Today)' : ''}`;\n  }\n\n  public continue(): void {\n    this.event.emit({ reason: 'done' });\n  }\n\n  public close(): void {\n    this.event.emit({ reason: 'close' });\n  }\n}","<header class=\"override-header\">\n    <button class=\"hidden\">button3</button>\n    <button mat-icon-button mat-dialog-close>\n        <i [class]=\"\">\n            <svg style=\"width:24px;height:24px\" viewBox=\"0 0 24 24\">\n                <path fill=\"currentColor\" d=\"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z\" />\n            </svg>\n        </i>\n    </button>\n</header>\n<mat-dialog-content #content class=\"mck-column modal-container\">\n    <svg class=\"red-icon\" width=\"48\" height=\"48\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M24 1C11.3 1 1 11.3 1 24C1 36.7 11.3 47 24 47C36.7 47 47 36.7 47 24C47 11.3 36.7 1 24 1ZM32.7 31.3C33.1 31.7 33.1 32.3 32.7 32.7C32.5 32.9 32.3 33 32 33C31.7 33 31.5 32.9 31.3 32.7L24 25.4L16.7 32.7C16.5 32.9 16.3 33 16 33C15.7 33 15.5 32.9 15.3 32.7C14.9 32.3 14.9 31.7 15.3 31.3L22.6 24L15.3 16.7C14.9 16.3 14.9 15.7 15.3 15.3C15.7 14.9 16.3 14.9 16.7 15.3L24 22.6L31.3 15.3C31.7 14.9 32.3 14.9 32.7 15.3C33.1 15.7 33.1 16.3 32.7 16.7L25.4 24L32.7 31.3Z\" fill=\"#D51F31\"/>\n    </svg>\n\n    <h2>Overriding Changes</h2>\n    <p>Editing the series here will override all previous changes made to individual occurrences. Are you sure you want to proceed?</p>\n\n    <table class=\"table\">\n        <thead>\n            <tr>\n                <th>Dates</th>\n            </tr>\n        </thead>\n        <tbody>\n            <tr *ngFor=\"let edit of edits\">\n                <td>{{formatDate(edit)}}</td>\n            </tr>\n        </tbody>\n    </table>\n</mat-dialog-content>\n\n<mat-dialog-actions>\n    <button mat-stroked-button (click)=\"close()\"><span>Back</span></button>\n    <button mat-button (click)=\"continue()\"><span>Yes, Override</span></button>\n</mat-dialog-actions>","import {\n    Pipe,\n    PipeTransform\n} from '@angular/core';\n\n/**\n * Transforms input by returning a subset of items based on if the\n * any items include the search text based on passed objectKey.\n *\n * objectKey can be pipe separated keys. e.g: 'name|age'. Then it will check against all.\n */\n@Pipe({\n    name: 'filter'\n})\nexport class FilterPipe implements PipeTransform {\n    transform(items: any[], searchText: string, objectKey?: string): any[] {\n        if (!items) return [];\n        if (!searchText) return items;\n        searchText = searchText.toLowerCase();\n        const splitKeys = objectKey?.split('|') ?? [];\n        return items.filter(it => {\n            let included = false;\n            splitKeys.forEach((key) => {\n                if (it[key]?.toLowerCase().includes(searchText)) {\n                    included = true;\n                }\n            });\n            if (splitKeys.length === 0) {\n                return it.toLowerCase().includes(searchText);\n            }\n            return included;\n        });\n    }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport {\n    DomSanitizer,\n    SafeHtml,\n    SafeResourceUrl,\n    SafeScript,\n    SafeStyle,\n} from '@angular/platform-browser';\n\nexport enum SecurityContext {\n    NONE = 0,\n    HTML = 1,\n    STYLE = 2,\n    SCRIPT = 3,\n    URL = 4,\n    RESOURCE_URL = 5,\n}\n\n@Pipe({\n    name: 'sanitize',\n})\nexport class SanitizePipe implements PipeTransform {\n    constructor(private sanitizer: DomSanitizer) {}\n\n    transform(\n        value: string,\n        type: 'resource' | 'url' | 'script' | 'style' | 'html' = 'html'\n    ): SafeHtml | SafeResourceUrl | SafeScript | SafeStyle {\n        switch (type) {\n            case 'resource':\n                return (\n                    this.sanitizer.sanitize(\n                        SecurityContext.RESOURCE_URL,\n                        value\n                    ) || ''\n                );\n            case 'url':\n                return (\n                    this.sanitizer.sanitize(SecurityContext.URL, value) || ''\n                );\n            case 'script':\n                return (\n                    this.sanitizer.sanitize(SecurityContext.SCRIPT, value) || ''\n                );\n            case 'style':\n                return (\n                    this.sanitizer.sanitize(SecurityContext.STYLE, value) || ''\n                );\n        }\n        return this.sanitizer.sanitize(SecurityContext.HTML, value) || '';\n    }\n}\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnInit,\n    ViewContainerRef\n} from '@angular/core';\nimport { SelectOption } from '../types';\nimport {\n    ControlValueAccessor,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\nimport { BaseTemplateComponent } from '../base-template.component';\nimport { BehaviorSubject } from 'rxjs';\n\n@Component({\n    selector: 'mck-radio-select',\n    template: `\n        <ng-template>\n            <div class=\"mck-column mck-form-input mck-radio-select\">\n                <mck-label [required]=\"required\">{{label}}</mck-label>\n                <mat-radio-group [disabled]=\"disabled\"\n                                 [value]=\"(value | async).value\"\n                                 (change)=\"setValue($event.value)\">\n                    <mat-radio-button *ngFor=\"let option of options\"\n                                      [value]=\"option.value\">{{option.display}}</mat-radio-button>\n                </mat-radio-group>\n            </div>\n        </ng-template>\n    `,\n    styleUrls: ['./radio-select.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => RadioSelectComponent),\n            multi: true\n        }\n    ]\n})\nexport class RadioSelectComponent extends BaseTemplateComponent implements OnInit, ControlValueAccessor {\n\n    @Input()\n    label: string;\n\n    @Input()\n    required?: boolean;\n\n    @Input()\n    options: SelectOption<any>[];\n\n    public value = new BehaviorSubject<SelectOption<any> | undefined>(undefined);\n\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Form control on change handler */\n    private _onChange: (_: SelectOption<any>) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: SelectOption<any>) => void;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n\n    registerOnChange(fn: any): void {\n        this._onChange = fn;\n    }\n\n    registerOnTouched(fn: any): void {\n        this._onTouch = fn;\n    }\n\n    setDisabledState(isDisabled: boolean): void {\n        this.disabled = isDisabled;\n    }\n\n    public setValue(value: string) {\n        const obj = this.options.find(o => o.value === value);\n        this.writeValue(obj);\n        if (this._onChange) {\n            this._onChange(obj)\n        }\n    }\n\n    writeValue(obj: SelectOption<any>): void {\n        this.value.next(obj);\n    }\n}\n","import { Component, Input, OnInit, ViewChild } from \"@angular/core\";\nimport { FormGroup } from \"@angular/forms\";\nimport { OrganisationService, RecurrencePeriod, RecurrenceType, removeExpiredOcurrences, RepeatsOn } from \"@mckinsey-converge/data-common\";\nimport { DateTZ } from \"@mckinsey-converge/date-tz\";\nimport { first } from \"rxjs/operators\";\nimport { RecurrencePatternForm } from \"../recurrence-pattern-form/recurrence-pattern-form.component\";\n\n@Component({\n    selector: 'recurrence-booking-form',\n    templateUrl: './recurrence-booking-form.component.html',\n    styleUrls: ['./recurrence-booking-form.component.scss']\n})\n\nexport class RecurringBookingForm implements OnInit {\n    /** Form fields for booking */\n    @Input() public form: FormGroup;\n\n    public current_type: RecurrenceType; \n    public recurrence_types: Array<RecurrenceType> = [\n        {type: RepeatsOn.PATTERN, label: 'Repeats on'},\n        {type: RepeatsOn.DATE, label: 'Repeats on specific date'}\n    ]\n\n    public building_tz = \"\";\n\n    @ViewChild(RecurrencePatternForm) pattern_form: RecurrencePatternForm;\n\n    constructor(\n        private _org: OrganisationService,\n    ) {}\n\n    public get recurrencePeriod(){\n        return this.form.get('recurrence_period')\n    }\n\n    public ngOnInit(): void {\n        this._org.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.building_tz = this._org?.building?.timezone || 'America/Chicago';\n        })\n        if(this.recurrencePeriod.value === RecurrencePeriod.LIST){\n            this.current_type = this.recurrence_types[1];\n            removeExpiredOcurrences(this.form)\n        }else{\n            this.current_type = this.recurrence_types[0];\n        }\n    }\n\n    public onChangeType(value: string) {\n        this.current_type = this.recurrence_types.filter((type) => type.type === value)[0]\n        if(this.current_type.type === RepeatsOn.PATTERN){\n            this.recurrencePeriod.setValue(this.pattern_form.recurrencePatternFormControl.value)\n        }else{\n            this.recurrencePeriod.setValue(RecurrencePeriod.LIST)\n        }\n    }\n\n    public dateToBuildingTz(date?: number){\n        return new DateTZ({date, building_tz: this.building_tz, is_local_tz: false})\n    }\n\n    public get error(){\n        const recurrence_starts = this.form.controls.recurrence_starts\n        const recurrence_days = this.form.controls.recurrence_days\n        return recurrence_starts.invalid || recurrence_days.invalid\n    }\n\n}\n","<div class=\"recurrence-form-container\" [class.error-state]=\"error\">\n    <mat-radio-group [value]=\"current_type.type\" (change)=\"onChangeType($event.value)\">\n        <div class=\"type-container\">\n            <!-- the repeats on button -->\n            <mat-radio-button [value]=\"recurrence_types[0].type\">\n                {{recurrence_types[0].label}}\n            </mat-radio-button>\n            <recurrence-pattern-form \n                [disabled]=\"current_type.type !== recurrence_types[0].type\" \n                [form]=\"form\">\n            </recurrence-pattern-form>\n        </div>\n        <div class=\"type-container\">\n            <!-- the repeats on specific date button -->\n            <mat-radio-button [value]=\"recurrence_types[1].type\">\n                {{recurrence_types[1].label}}\n            </mat-radio-button>\n            <recurrence-date-form\n                [disabled]=\"current_type.type !== recurrence_types[1].type\" \n                [form]=\"form\">\n            </recurrence-date-form>\n        </div>\n    </mat-radio-group>\n</div>\n<mck-error-message *ngIf=\"error\">The recurrence pattern is not valid.</mck-error-message>","import { Component, Input, OnInit, ViewChild } from \"@angular/core\";\nimport { FormGroup } from \"@angular/forms\";\nimport { MatMenuTrigger } from \"@angular/material/menu\";\nimport { BaseDirective, closestToTimeSlotTz } from \"@mckinsey-converge/base\";\nimport { OrganisationService } from \"@mckinsey-converge/data-common\";\nimport { DateNow, DateTZ,toMiddayUTC } from \"@mckinsey-converge/date-tz\";\n\n@Component({\n    selector: 'recurrence-date-form',\n    templateUrl: './recurrence-date-form.component.html',\n    styleUrls: ['./recurrence-date-form.component.scss']\n})\n\nexport class RecurrenceDateForm extends BaseDirective implements OnInit {\n    /** Form fields for booking */\n    @Input() public form: FormGroup;\n    @Input() disabled: boolean;\n    @ViewChild(MatMenuTrigger, { static: true }) private _trigger: MatMenuTrigger;\n\n    public selected_dates: Array<DateTZ> = []\n    public timezone: string = '';\n    public nowTz: DateTZ = DateNow(new Date());\n    public fromDateTz: DateTZ = this.nowTz.clone();\n    public untilDateTz: DateTZ = this.fromDateTz.endOfValue('day').addValue({ years: 1 });\n    public dateTz: DateTZ = DateNow(new Date());\n\n    public get recurrenceStarts(){\n        return this.form.get('recurrence_starts');\n    }\n\n    public get formDateTz(){\n        return this.form.get('dateTz');\n    }\n\n    constructor (private _org: OrganisationService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        // Setup some data to only run once, the previous giters were hogs\n        this.timezone = this.form.get('timezone').value;\n        this.nowTz = new DateTZ({ date: Date.now(), is_local_tz: false, building_tz: this.timezone });\n        // R--- The fromDateTz is curious, would it make sense to be based on the form dateTz?\n        this.fromDateTz = this.nowTz.clone()\n        this.untilDateTz = this.fromDateTz.endOfValue('day').addValue({ years: 1 });\n\n        if(this.recurrenceStarts.value){\n            const tempForSort = [...this.recurrenceStarts.value]; // due to cannot assign to read only property '0' of object '[object Array]'\n            this.selected_dates = tempForSort.sort((d1: DateTZ, d2: DateTZ) => d1.ms - d2.ms);\n        }\n        this.subscription('ocurrenceChanges',  this.recurrenceStarts.valueChanges\n            .subscribe(() => {\n                this.selected_dates = [...this.recurrenceStarts.value]\n            })\n        ); \n    }\n\n    /**\n     * Add value to the list of selected dates\n     * @param newDateTz\n     */\n    public addDate(newDateTz: DateTZ) {\n        const d = newDateTz.clone();\n        const start_date = this.formDateTz.value;\n        let new_date = d.setValue({hour: start_date.dateHour, minute: start_date.minutes})\n        \n        /**  Prevent user from selecting past dates */\n        if (new_date.isBeforeDate(this.fromDateTz)) {\n            new_date = this.fromDateTz;\n        }\n\n        /** Prevent user from selecting the same date more than once */\n        const is_selected = this.selected_dates.filter((date: DateTZ)=> new_date.isSameDate(date, 'day'))\n        if(is_selected.length){\n            return\n        }\n       \n        this.selected_dates.push(new_date);\n        this.recurrenceStarts.setValue(this.selected_dates.sort((d1, d2) => d1.ms - d2.ms));\n        this.setDateTzForm();\n    }\n\n    /**\n     * \n     * @param dateMsValue: number\n     * @returns  \n     */\n     public setPickerToGivenDate(dateTsValue: DateTZ) {\n        this.fromDateTz = dateTsValue.clone();\n    }\n\n    /**\n     * Function calls on close of date picker without date selection\n     */\n    public onDatePickerClose = () => {\n        this.setPickerToGivenDate(this.nowTz)\n    };\n\n    public goToToday() {\n        this.addDate(this.nowTz);\n        this.setPickerToGivenDate(this.nowTz);\n    }\n\n    public closeDatePicker() {\n        this._trigger.closeMenu();\n    }\n\n    public openDatePicker() {\n        this._trigger.openMenu();\n    }\n\n    public deleteDate(date: DateTZ) {\n        const index = this.selected_dates.map((d: DateTZ) => d.ms).indexOf(date.ms)\n        this.selected_dates.splice(index, 1)\n        this.recurrenceStarts.setValue(this.selected_dates)\n        this.setDateTzForm()\n    }\n\n    public isToday(date) {\n        return new DateTZ({\n            date: toMiddayUTC(date).ms,\n            is_local_tz: false,\n            building_tz: this.timezone,\n        }).isSameDate(\n            new DateTZ({\n                date: Date.now(),\n                is_local_tz: false,\n                building_tz: this.timezone,\n            }),\n            'day'\n        );\n    }\n\n    public formatDate(date: DateTZ){\n        const isToday = this.isToday(date);\n        const display = date.formatDate('ccc dd MMM yyyy');\n\n        return  `${display}${isToday ? ' (Today)' : ''}`;\n    }\n\n    private setDateTzForm(): void {\n        if (this.selected_dates.length === 0)\n            return;\n\n        const tz = this._org.building.timezone;\n        const date_now = DateNow(new Date()).toZone(tz);\n        let dateTz = this.selected_dates[0].clone();\n\n        dateTz = dateTz.setValue({\n            hour: (this.formDateTz.value as DateTZ).hours,\n            minute: (this.formDateTz.value as DateTZ).minutes\n         });\n\n        if (this.selected_dates[0].isSameDate(this.nowTz, \"day\") && dateTz.hours < date_now.hours) {\n            const { minutes: minute, hours: hour } = closestToTimeSlotTz(this.nowTz, 15);\n            dateTz = dateTz.setValue({ minute, hour, second: 0 });\n        }\n\n        this.formDateTz.setValue(dateTz);\n    }\n}\n","<div class=\"type-form\" [class.disabled]=\"disabled\">\n    <table [cellSpacing]=\"0\">\n        <tr>\n            <th>Date</th>\n            <th>Action</th>\n        </tr>\n        <tr *ngFor=\"let date of selected_dates\">\n            <td>{{formatDate(date)}}</td>\n            <td class=\"cell-centered pointer\" (click)=\"deleteDate(date)\">Delete</td>\n        </tr>\n        <tr>\n            <td class=\"underlined pointer\">\n                <div (keydown.enter)=\"openDatePicker()\"\n                [matMenuTriggerFor]=\"appMenu\">[+] Add another date</div>\n                <mat-menu #appMenu=\"matMenu\" xPosition=\"before\"  (closed)=\"onDatePickerClose()\">\n                    <div mat-menu-item class=\"date-picker mck-column\" (click)=\"$event.stopPropagation()\">\n                        <date-tz-calendar-widget\n                            className=\"mck-date-picker\"\n                            [ngModel]=\"fromDateTz\"\n                            [options]=\"{ fromDateTz: fromDateTz, untilDateTz: untilDateTz, day_format: 'EEE' }\"\n                            (ngModelChange)=\"addDate($event); closeDatePicker()\"\n                        ></date-tz-calendar-widget>\n                        <button\n                            mat-stroked-button\n                            color=\"primary\"\n                            class=\"mck-stroked-button today-button\"\n                            (click)=\"goToToday()\"\n                        >Today\n                        </button>\n                    </div>\n                </mat-menu>\n            </td>\n            <td></td>\n        </tr>\n    </table>\n</div>","import { Component, Input, OnInit } from \"@angular/core\";\nimport { FormGroup, Validators } from \"@angular/forms\";\nimport { BaseDirective, closestToTimeSlotTz } from \"@mckinsey-converge/base\";\nimport { arrayWithValues, generateWeekDays, RecurrencePeriod, recurrencePeriodToDurationType, RepeatPeriod, validDateTZ, WeekDays } from \"@mckinsey-converge/data-common\";\nimport { DateNow, DateTZ } from \"@mckinsey-converge/date-tz\";\n\n@Component({\n    selector: 'recurrence-pattern-form',\n    templateUrl: './recurrence-pattern-form.component.html',\n    styleUrls: ['./recurrence-pattern-form.component.scss']\n})\n\nexport class RecurrencePatternForm extends BaseDirective implements OnInit {\n    /** Form fields for booking */\n    @Input() public form: FormGroup;\n    @Input() disabled: boolean;\n\n    /** Range of dates for the Start Date Picker*/\n    public nowTz: DateTZ = DateNow(new Date());\n    public fromStartTz: DateTZ = this.nowTz.setValue({ minute: Math.ceil(this.nowTz.minutes / 5) * 5 });\n    public untilTz: DateTZ = this.nowTz.addValue({ years: 1 }).endOfValue('day');\n    public timezone: string = '';\n    \n\n    /** Range of dates for the End Date Picker*/\n    public fromEndTz: DateTZ;\n\n    public repeat_period_options: Array<RepeatPeriod> = [\n        {label: 'Day', id: RecurrencePeriod.DAILY},\n        {label: 'Week',id: RecurrencePeriod.WEEKLY},\n        {label: 'Month', id: RecurrencePeriod.ABSOLUTE_MONTHLY}\n    ]\n    public week_days: Array<WeekDays> = []\n\n    public repeat_every_options\n\n\n    public get recurrenceDateStartTzFormControl() {\n        return this.form.get('dateTz')\n    }\n\n    public get recurrenceEndFormControl(){\n        return this.form.get('recurrence_endTz')\n    }\n\n    public get recurrencePeriodFormControl(){\n        return this.form.get('recurrence_period')\n    }\n\n    public get recurrenceIntervalFormControl(){\n        return this.form.get('recurrence_interval')\n    }\n\n    public get recurrencePatternFormControl(){\n        return this.form.get('recurrence_pattern')\n    }\n\n    public get recurrenceDaysFormControl(){\n        return this.form.get('recurrence_days')\n    }\n\n    public ngOnInit(): void {\n        // Setup some data to only run once, the previous giters were hogs\n        this.timezone = this.form.get('timezone').value;\n        this.nowTz = new DateTZ({ date: Date.now(), is_local_tz: false, building_tz: this.timezone });\n        // R--- The from date is curious, why isn't it based on the form dateTz?\n        this.repeat_every_options = new Array(1)\n        this.fromStartTz = closestToTimeSlotTz(this.nowTz, 15)\n        this.untilTz = this.nowTz.addValue({ years: 1 }).endOfValue('day');\n        this.fromEndTz = this.fromStartTz.addValue({days: 1})\n\n        this.setEndDateFromStartDate(this.recurrenceDateStartTzFormControl.value) //make sure end date is after start date\n\n        if(!this.recurrencePeriodFormControl.value){\n            this.recurrencePeriodFormControl.setValue(RecurrencePeriod.WEEKLY)\n        }\n\n        if(this.recurrencePeriodFormControl.value !== RecurrencePeriod.LIST){\n            this.recurrencePatternFormControl.setValue(this.recurrencePeriodFormControl.value)\n        }\n\n        this.week_days = generateWeekDays(this.recurrenceDateStartTzFormControl.value.ms, { building_tz: this.fromStartTz.building_tz })\n        this.generateMaxIntervals()\n\n        if(this.recurrenceDaysFormControl.value.length > 0){\n            this.week_days = this.week_days.map((day) => \n                ({...day, active: this.recurrenceDaysFormControl.value.includes(day.full_name)})\n            )\n        }\n\n        if(!this.recurrenceDaysFormControl.value.length && this.recurrencePeriodFormControl.value === RecurrencePeriod.WEEKLY){\n            const current_days = this.week_days.filter((day) => day.active).map((day)=>day.full_name)\n            this.recurrenceDaysFormControl.setValue(current_days)\n        }\n\n        this.generateOcurrenceList()\n\n        this.subscription('startTimeChanges',  this.recurrenceDateStartTzFormControl.valueChanges\n            .subscribe((next) => {\n                this.setEndDateFromStartDate(next)               \n            })\n        );\n\n        this.subscription('endTimeChanges',  this.recurrenceEndFormControl.valueChanges\n            .subscribe(() => {\n                this.generateMaxIntervals();\n            })\n        );\n        \n        this.subscription('recurrencePeriodFormControlChanges',  this.recurrencePeriodFormControl.valueChanges\n            .subscribe(() => {\n                this.generateMaxIntervals();\n            })\n        );  \n    }\n\n    public setEndDateFromStartDate(startDateTz: DateTZ){\n        let end_date = this.recurrenceEndFormControl.value.setValue({hour: startDateTz.dateHour, minute: startDateTz.minutes})\n\n        /**Update the End date picker range */\n        this.fromEndTz = startDateTz.isSameDate(this.untilTz,'day') ? startDateTz : startDateTz.addValue({days: 1})\n\n        if(end_date.isBeforeDate(this.fromEndTz)){\n            end_date = this.fromEndTz\n        }\n\n        this.recurrenceEndFormControl.setValue(end_date)\n\n        this.generateMaxIntervals()\n        this.updateActiveWeekday() \n    }\n\n    public setRepeatPeriod(value: RecurrencePeriod){\n        this.updateValidators(value)\n        this.recurrencePeriodFormControl.setValue(value);\n        this.recurrencePatternFormControl.setValue(value);\n        this.recurrenceIntervalFormControl.setValue(1)\n        this.generateOcurrenceList();\n    }\n\n    public setRepeatEvery(value: number){\n        this.recurrenceIntervalFormControl.setValue(value)\n        this.generateOcurrenceList()\n    }\n\n    public repeatTimeString(value: string){\n        return this.recurrenceIntervalFormControl.value !== 1 ? `${value}(s)` : value\n    }\n\n    public get displayWeekdays(){\n        return this.recurrencePatternFormControl.value === RecurrencePeriod.WEEKLY\n    }\n\n    /* Check if selected interval is valid and reset to 1 if not*/\n    private validateRecurrenceInterval = () => {\n        if(this.repeat_every_options.length < this.recurrenceIntervalFormControl.value){\n            this.recurrenceIntervalFormControl.setValue(1)\n        }    \n    };\n\n    /**\n     * Generate max value for dorpdown interval\n     */\n    public generateMaxIntervals(){\n        const start = this.recurrenceDateStartTzFormControl.value;\n        const date_diff = this.recurrenceEndFormControl.value.dateDiff(start, this.periodToDurationType, this.periodToDurationType)\n        //If no diff default to 1\n        this.repeat_every_options = new Array(Math.round(date_diff) || 1)\n        this.validateRecurrenceInterval();\n        if(this.recurrencePeriodFormControl.value !== RecurrencePeriod.LIST){\n            this.generateOcurrenceList()\n        }\n    }\n\n    /**\n     * Generate ocurrence list base on the selected interval\n     */\n    public generateOcurrenceList() {\n\n        /**If selected period is list then we don't want \n         * to generate a list based on the repeats on selections*/\n        if(this.recurrencePeriodFormControl.value === RecurrencePeriod.LIST){\n            return\n        }\n\n        const occurrence = []\n        const first_date = this.recurrenceDateStartTzFormControl.value;\n        let start = first_date\n        const end = this.recurrenceEndFormControl.value;\n        const interval = this.recurrenceIntervalFormControl.value\n        const recurr_days = this.week_days.filter(day => day.active)\n        /**\n         * isLastDayOfMonth : Boolean\n         *  flag - to generate last day of every month in case of day or month reccuring booking if start date is last day of month\n         */\n        //  const isLastDayOfMonth = first_date.date.day === first_date.date.daysInMonth && this.recurrencePeriodFormControl.value === RecurrencePeriod.ABSOLUTE_MONTHLY;\n        const isLastDayOfMonth = first_date.dateDay === 31 && this.recurrencePeriodFormControl.value === RecurrencePeriod.ABSOLUTE_MONTHLY ;\n        \n        if(this.recurrencePeriodFormControl.value === RecurrencePeriod.WEEKLY){\n            start = start.startOfValue('week')\n        }\n\n        while (end.dateDiff(start.startOfValue('day'), this.periodToDurationType, this.periodToDurationType) >= 0) {\n            \n            if(this.recurrencePeriodFormControl.value !== RecurrencePeriod.WEEKLY){\n                occurrence.push(start) \n                start = start.addValue({[this.periodToDurationType]: interval}, isLastDayOfMonth);\n               /**\n                * IF - should only consider resetting start under mentioned condition of ticket - https://acaprojects.atlassian.net/browse/MCK-2085\n                *  In summery - If user select any date except 31st, other months in the series (no matter 30 or 31 day month) should have same date select as start date.\n                *  If user select 31st as an start date, other month in the seleries should have select last day of the month (30th/31st/28th/29th).\n                *  Exception for February - February should select 28th or 29th  If in above both selection includes date between 28th - 31st.\n                * \n                */\n                if(start.dateDay !== first_date.dateDay && start.dateDay !== start.date.daysInMonth && this.recurrencePeriodFormControl.value === RecurrencePeriod.ABSOLUTE_MONTHLY) {\n                    start = start.setValue({day: first_date.dateDay});\n                }   \n            }else {\n                recurr_days.forEach((day)=>{\n                    const date = start.addValue({days: day.day_index})\n                    if((date.isAfterDate(first_date) || date.isSameDate(first_date, 'day')) && \n                      (date.isBeforeDate(end) || date.isSameDate(end, 'day'))){\n                        occurrence.push(date)\n                    }\n                })\n                start = start.addValue({[this.periodToDurationType]: interval})\n            }\n        }\n\n        this.form.controls.recurrence_count.setValue(occurrence.length)\n        this.form.controls.recurrence_starts.setValue(occurrence.sort((d1, d2) => d1.ms - d2.ms))\n        \n    }\n\n    public get periodToDurationType(){\n        const period = this.recurrencePeriodFormControl.value\n        return recurrencePeriodToDurationType(period)\n    }\n\n    /**\n     * Update active weekday in the weekdays array\n     */\n     private updateActiveWeekday() {\n        const _week_days = this.week_days.map((day)=>{\n            if(this.recurrenceDaysFormControl.value.includes(day.full_name)){\n                return {...day, active: true}\n            }else{\n                return {...day, active: false}\n            }\n        })\n        this.week_days = [..._week_days]         \n    }\n\n    public setWeekDays(new_day: WeekDays){\n        const days = this.recurrenceDaysFormControl.value\n        if(this.disabled){\n            return\n        }\n\n        if(!new_day.active){\n            days.push(new_day.full_name)\n        }else{\n            const current_index = days.indexOf(new_day.full_name)\n            days.splice(current_index,1)\n        }\n        this.recurrenceDaysFormControl.setValue([...days])\n        this.updateActiveWeekday()\n        this.generateOcurrenceList()\n    }\n\n    /**Update the recurrence days validator if period changes */\n    public updateValidators(value: RecurrencePeriod){\n        if(value === RecurrencePeriod.WEEKLY && this.recurrencePeriodFormControl.value !== RecurrencePeriod.WEEKLY){\n            const arrayValidators = [Validators.required];\n            arrayValidators.push(arrayWithValues);\n            this.recurrenceDaysFormControl.setValidators(arrayValidators);\n            this.recurrenceDaysFormControl.updateValueAndValidity();\n        }else if(value !== RecurrencePeriod.WEEKLY && this.recurrencePeriodFormControl.value === RecurrencePeriod.WEEKLY){\n            this.recurrenceDaysFormControl.clearValidators();\n            this.recurrenceDaysFormControl.updateValueAndValidity();\n        }\n    }\n}\n","<div class=\"type-form\" [formGroup]=\"form\" [class.disabled]=\"disabled\">\n    <div class=\"date-field\">\n        <label i18n=\"Booking form start date label\">Start date<span>*</span> </label>\n        <date-tz-date-picker\n            class=\"mck-form-input time-inputs-calendar\"\n            formControlName=\"dateTz\"\n            [fromDateTz]=\"fromStartTz\"\n            [untilDateTz]=\"untilTz\"\n            [disabled]=\"disabled\"\n            [invalid]=\"recurrenceDateStartTzFormControl.invalid\">\n        </date-tz-date-picker>\n        <mck-error-message *ngIf=\"recurrenceDateStartTzFormControl.invalid\">Date and time must be in the future</mck-error-message>\n    </div>\n    <div class=\"date-field\">\n        <label i18n=\"Booking form end date label\">End date<span>*</span> </label>\n        <date-tz-date-picker\n            class=\"mck-form-input time-inputs-calendar\"\n            formControlName=\"recurrence_endTz\"\n            [fromDateTz]=\"fromEndTz\"\n            [untilDateTz]=\"untilTz\"\n            [disabled]=\"disabled\"\n            [invalid]=\"recurrenceEndFormControl.invalid\">\n        </date-tz-date-picker>\n        <mck-error-message *ngIf=\"recurrenceEndFormControl.invalid\">Date and time must be in the future</mck-error-message>\n    </div>\n    <div class=\"pattern-container flex-row\">\n        <div class=\"flex-column repeat-every \">\n            <label i18n=\"Booking form repeat time label\">Repeats every<span>*</span> </label>\n            <div class=\"flex-row mck-form-input\">\n                <mat-form-field appearance=\"outline\">\n                    <mat-select #select [value]=\"recurrenceIntervalFormControl.value\" [disabled]=\"disabled\" (valueChange)=\"setRepeatEvery($event)\">\n                        <mat-option *ngFor=\"let in of repeat_every_options;let i = index\" [value]=\"i + 1\">\n                            {{ i + 1}}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select #select [value]=\"recurrencePatternFormControl.value\" [disabled]=\"disabled\" (valueChange)=\"setRepeatPeriod($event)\">\n                        <mat-option *ngFor=\"let option of repeat_period_options\" [value]=\"option.id\">\n                            {{ repeatTimeString(option.label) }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n        </div>\n        <div class=\"flex-column repeat-on\" *ngIf=\"displayWeekdays\">\n            <label i18n=\"Booking form repeat on label\">On</label>\n            <div class=\"flex-row\">\n                <div \n                class=\"week-day\" \n                *ngFor=\"let day of week_days\" \n                [class.active-weekday]='day.active'\n                (click)=\"setWeekDays(day)\">\n                    {{day.id}}\n                </div>    \n            </div>\n        </div>\n    </div>\n</div>","import {\n    Component,\n    Input,\n    ViewContainerRef\n} from '@angular/core';\nimport { BaseTemplateComponent } from '../base-template.component';\nimport { SelectOption } from '../types';\n\n@Component({\n    selector: 'mck-select-option',\n    template: `\n        <ng-template>\n            <div\n                *ngIf=\"option\"\n                [ngClass]=\"{ 'mck-ignore-disabled': ignoreDisabled }\"\n                class=\"mck-row mck-select-option-{{selected ? 'selected' : 'unselected'}} mck-select-option mck-center-align\">\n                <mck-spacer\n                    [autoSize]=\"true\"\n                    size=\"5px\"\n                    class=\"mck-select-option-bar\"\n                    [mode]=\"'vertical'\"></mck-spacer>\n                <ng-content></ng-content>\n                {{ option.display }}\n            </div>\n        </ng-template>\n    `,\n    styleUrls: ['./select-option.component.css']\n})\nexport class SelectOptionComponent extends BaseTemplateComponent {\n\n    @Input()\n    option: SelectOption<any>;\n\n    @Input()\n    selected: boolean;\n\n    /**\n     * If true, we still display as if it wasn't disabled.\n     */\n    @Input()\n    ignoreDisabled = false;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n\n}\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport {\n    BehaviorSubject,\n    combineLatest\n} from 'rxjs';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { map } from 'rxjs/operators';\nimport { MatSelect } from '@angular/material/select';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\n\n@Component({\n    selector: 'mck-select',\n    templateUrl: './select.component.html',\n    styleUrls: ['./select.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => SelectComponent),\n            multi: true\n        }\n    ],\n    encapsulation: ViewEncapsulation.None\n})\nexport class SelectComponent implements OnInit, OnChanges, ControlValueAccessor {\n\n    @Input()\n    public label: string;\n\n    @Input()\n    public required: boolean;\n\n    @Input()\n    public options: SelectOption<any>[] = [];\n\n    @Input()\n    public selectedValue: SelectOption<any> | undefined;\n\n    /**\n     * When true, can filter by searching on the input.\n     */\n    @Input()\n    public searchEnabled = false;\n\n    @Input()\n    public splitDisplay = false;\n\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n\n    @Input()\n    public noEntriesFoundLabel: string;\n\n    @Input()\n    public showDivider: boolean = false\n\n    /** Form control on change handler */\n    private _onChange: (_: SelectOption<any>) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: SelectOption<any>) => void;\n\n    public filterFormControl: FormControl = new FormControl();\n\n    public value = new BehaviorSubject<string | undefined>(this.selectedValue || this.options[0]?.value);\n\n    /** Available time blocks for the selected date */\n    public _options = new BehaviorSubject<SelectOption<any>[]>(this.options);\n\n    /** Select field for selecting the value */\n    @ViewChild('select') private select_field: MatSelect;\n\n    public selectedOption = combineLatest([this._options, this.value]).pipe(\n        map(([options, value]) => options.find(o => o.value === value))\n    );\n\n    public placeHolderOption = this._options.pipe(\n        map(os => os.length > 0 && os[0])\n    );\n\n    public isSelected(option: SelectOption<any>) {\n        return this.value.pipe(map(t => t === option.value));\n    }\n\n    public get isOpen() {\n        return this.select_field?.panelOpen ?? false;\n    }\n\n\n    constructor() {\n    }\n\n    public ngOnInit(): void {\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.options) {\n            this._options.next(this.options);\n            this.value.next(this.selectedValue || this.options?.[0]?.value);\n        }\n        if (changes.selectedValue) {\n            this.value.next(this.selectedValue?.value);\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: string): void {\n        this.value.next(new_value);\n        if (this._onChange) {\n            this._onChange(this.options.find(f => f.value === new_value));\n        }\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: SelectOption<any> | null) {\n        if (value != null) {\n            this.value.next(value.value);\n        }\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: SelectOption<any>) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: SelectOption<any>) => void): void {\n        this._onTouch = fn;\n    }\n\n}\n","<div class=\"mck-column mck-form-input\" [class.disabled]=\"disabled\">\n    <mck-label [required]=\"required\">{{label}}</mck-label>\n    <mat-form-field\n        appearance=\"outline\"\n        class=\"mck-center-suffix\">\n        <mat-select\n            #select\n            [placeholder]=\"(placeHolderOption | async)?.display\"\n            panelClass=\"mck-select-panel\"\n            [value]=\"value | async\"\n            [disabled]=\"disabled\"\n            (valueChange)=\"setValue($event)\"\n            disableOptionCentering>\n            <mat-option *ngIf=\"searchEnabled\">\n                <ngx-mat-select-search\n                    noEntriesFoundLabel=\"{{noEntriesFoundLabel}}\"\n                    [placeholderLabel]=\"(selectedOption | async)?.display\"\n                    [formControl]=\"filterFormControl\"></ngx-mat-select-search>\n            </mat-option>\n            <mat-option\n                *ngFor=\"let option of _options | async | filter: (filterFormControl.valueChanges | async): 'display'\"\n                [value]=\"option.value\">\n                <mck-select-option\n                    [option]=\"option\"\n                    [selected]=\"isSelected(option) | async\"\n                ></mck-select-option>\n            </mat-option>\n        </mat-select>\n        <mck-spacer\n            *ngIf=\"showDivider\"\n            size=\"1px\"\n            [mode]=\"'vertical'\"\n            spacerClass=\"legend-divider select-divider\"></mck-spacer>\n        <div class=\"mck-column select-chevron\">\n            <mck-chevron-icon [up]=\"isOpen\" matSuffix fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n        </div>\n    </mat-form-field>\n</div>\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output\n} from '@angular/core';\n\n@Component({\n    selector: 'mck-selected-chip-count',\n    template: `\n        <div\n            (click)=\"close.emit()\"\n            class=\"mck-row mck-center selected-count-chip\">\n            <span>{{count}}</span>\n            <mck-close-icon fillClass=\"mck-icon-fill-black\"></mck-close-icon>\n        </div>\n    `,\n    styleUrls: ['./selected-chip-count.component.scss']\n})\nexport class SelectedChipCountComponent {\n\n    @Input()\n    count: number;\n\n    @Output()\n    close = new EventEmitter<void>();\n\n}\n","import {\n    Component,\n    Input,\n    OnInit,\n    ViewContainerRef\n} from '@angular/core';\nimport { BaseTemplateComponent } from '../base-template.component';\n\nexport enum SpacerMode {\n    /**\n     * If vertical, it expands in the vertical direction. Size is width.\n     */\n    Vertical = 'vertical',\n    /**\n     * If horizontal, it expands in the horizontal direction. Size is height.\n     */\n    Horizontal = 'horizontal',\n}\n\n@Component({\n    selector: 'mck-spacer',\n    template: `\n        <ng-template>\n            <div class=\"mck-spacer-content {{spacerClass}}\"\n                 *ngIf=\"mode === SpacerMode.Vertical\"\n                 [ngStyle]=\"{ width: size, height: autoSize ? 'auto' : '100%'}\">\n            </div>\n            <div class=\"mck-spacer-content {{spacerClass}}\"\n                 *ngIf=\"mode === SpacerMode.Horizontal\"\n                 [ngStyle]=\"{ height: size, width: autoSize ? 'auto' : '100%'}\">\n            </div>\n        </ng-template>\n    `,\n    styleUrls: ['./spacer.component.css'],\n})\nexport class SpacerComponent extends BaseTemplateComponent implements OnInit {\n    SpacerMode = SpacerMode;\n\n    @Input()\n    size: string;\n\n    @Input()\n    mode: SpacerMode = SpacerMode.Horizontal;\n\n    @Input()\n    autoSize?: boolean;\n\n    @Input()\n    spacerClass?: string;\n\n    constructor(vcRef: ViewContainerRef) {\n        super(vcRef);\n    }\n\n\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    OnInit,\n    Output\n} from '@angular/core';\nimport { SelectOption } from '@mckinsey-converge/ui';\n\n@Component({\n    selector: 'mck-switch-group',\n    template: `\n        <div class=\"mck-column mck-content-expand-width mck-stretch switch-container\">\n            <span\n                id=\"{{title}}\"\n                class=\"switch-title\">{{title}}</span>\n            <mat-slide-toggle\n                class=\"mck-slide-toggle\"\n                labelPosition=\"before\"\n                name=\"{{title}} - toggle - {{option.display}}\"\n                *ngFor=\"let option of options\"\n                (change)=\"onCheckedChange(option)\"\n                [checked]=\"isSelected(option)\">{{option.display}}</mat-slide-toggle>\n        </div>\n    `,\n    styleUrls: ['./switch-group.component.scss']\n})\nexport class SwitchGroupComponent implements OnInit {\n\n    @Input()\n    title: string;\n\n    @Input()\n    options: SelectOption<any>[];\n\n    @Input()\n    selectedOptions: SelectOption<any>[] = [];\n\n    @Output()\n    optionChecked = new EventEmitter<SelectOption<any>>();\n\n    constructor() {\n    }\n\n    ngOnInit(): void {\n    }\n\n    public onCheckedChange(option: SelectOption<any>) {\n        this.optionChecked.emit(option);\n    }\n\n    public isSelected(option: SelectOption<any>) {\n        return !!this.selectedOptions.find(s => s.value === option.value);\n    }\n}\n","import {\n    Component,\n    forwardRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport {\n    ControlValueAccessor,\n    FormControl,\n    NG_VALUE_ACCESSOR\n} from '@angular/forms';\nimport { MatSelect } from '@angular/material/select';\n\nimport {\n    BaseDirective,\n    closestToTimeSlot,\n    nearestStepToInput,\n    timeWithGmtOffsetFormatString\n} from '@mckinsey-converge/base';\n\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { generateAvailableTimes } from '../utils/time.utils';\nimport {\n    BehaviorSubject,\n    combineLatest\n} from 'rxjs';\nimport {\n    filter,\n    map,\n    withLatestFrom\n} from 'rxjs/operators';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { DateTime } from 'luxon';\n\n@Component({\n    selector: 'mck-time-field',\n    template: `\n        <div class=\"mck-column mck-form-input\">\n            <mck-label [required]=\"required\">{{label}}</mck-label>\n            <mat-form-field\n                appearance=\"outline\"\n                class=\"mck-center-suffix\">\n                <mat-select\n                    #select\n                    [placeholder]=\"(placeHolderOption | async)?.display\"\n                    panelClass=\"mck-select-panel\"\n                    [value]=\"value | async\"\n                    [disabled]=\"disabled\"\n                    (valueChange)=\"setValue($event)\"\n                    disableOptionCentering>\n                    <mat-option>\n                        <ngx-mat-select-search\n                            noEntriesFoundLabel=\"No timeslots found for current search. Try selecting one in the dropdown.\"\n                            [placeholderLabel]=\"(selectedOption | async)?.display\"\n                            [formControl]=\"filterFormControl\"></ngx-mat-select-search>\n                    </mat-option>\n                    <mat-option\n                        *ngFor=\"let option of options | async | filter: (nearestStep | async): 'shortDisplay'\"\n                        [value]=\"option.value\">\n                        <mck-select-option\n                            [option]=\"option\"\n                            [selected]=\"isSelected(option) | async\"\n                        ></mck-select-option>\n                    </mat-option>\n                </mat-select>\n                <div class=\"mck-column\">\n                    <mck-chevron-icon [up]=\"isOpen\" matSuffix fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n                </div>\n            </mat-form-field>\n        </div>\n    `,\n    styleUrls: ['./time-field.component.scss'],\n    providers: [\n        {\n            provide: NG_VALUE_ACCESSOR,\n            useExisting: forwardRef(() => TimeFieldComponent),\n            multi: true\n        }\n    ],\n    encapsulation: ViewEncapsulation.None\n})\nexport class TimeFieldComponent extends BaseDirective implements OnInit, OnChanges, ControlValueAccessor {\n    @Input()\n    public label: string;\n    @Input()\n    public required: boolean;\n    /** Time step between each allowed time option */\n    @Input() public step = 15;\n    /** Whether form field is disabled */\n    @Input() public disabled: boolean;\n    /** Whether past times are allowed */\n    @Input() public noPastTimes = true;\n    /** Representing the date from start **/\n    @Input() public from: number;\n    /** Representing desired timezone **/\n    @Input() public timezone?: string = new DateTZ({ date: Date.now() }).local_tz;\n\n    // R-- Which time field is going to be used, there's too many\n    /** Form control on change handler */\n    private _onChange: (_: number) => void;\n    /** Form control on touch handler */\n    private _onTouch: (_: number) => void;\n\n    /** Select field for selecting the time */\n    @ViewChild('select') private select_field: MatSelect;\n\n    /** String representing the currently set date */\n    public date = new BehaviorSubject(DateNow(new Date()).ms);\n\n    public filterFormControl: FormControl = new FormControl();\n\n    public nearestStep = combineLatest([\n        this.filterFormControl.valueChanges,\n        this.date]).pipe(\n        map(([value, date]) => nearestStepToInput(this.step, value, DateTime.now().valueOf()))\n    );\n\n    /** String representing the currently set time */\n    public value = new BehaviorSubject<string>(closestToTimeSlot(DateTime.now(), this.step).toFormat('HH:mm'));\n\n    /** Available time blocks for the selected date */\n    public options = new BehaviorSubject<SelectOption<any>[]>(generateAvailableTimes(DateNow(new Date()).ms, !this.noPastTimes, this.step, this.timezone));\n\n    public selectedOption = combineLatest([this.options, this.value]).pipe(\n        map(([options, value]) => options.find(o => o.value === value))\n    );\n\n    public placeHolderOption = this.options.pipe(\n        map(os => os.length > 0 && os[0])\n    );\n\n    public isSelected(option: SelectOption<any>) {\n        return this.value.pipe(map(t => t === option.value));\n    }\n\n    public get isOpen() {\n        return this.select_field?.panelOpen ?? false;\n    }\n\n    public ngOnInit(): void {\n        // Generate the time input options for the booking date\n        this.options.next(generateAvailableTimes(this.date.value, !this.noPastTimes, this.step, this.timezone));\n\n        // Subscribe to selected option changes\n        this.subscription('dateTimeChanges',\n            combineLatest([\n                this.date\n            ]).pipe(\n                map(([date]) => {\n                    // R--- The time input needing to be TZ aware.\n                    const closestTimeSlot = closestToTimeSlot(DateTime.fromMillis(date.valueOf()), this.step);\n                    // Need to return the date with building timezone or the HH:mm representation will no match the option values\n                    return new DateTZ({date: closestTimeSlot.valueOf(), is_local_tz:false, building_tz: this.timezone});\n                }),\n                withLatestFrom(this.options),\n                filter(([date, timeOptions]: [DateTZ, SelectOption<any>[]]) => {\n                    // if new time slot opened up when date / time changes, add it here.\n                    return !timeOptions.find(t => t.value === date.formatDate('HH:mm'));\n                }),\n                map(([date, timeOptions]) => {\n                    // TODO probably an issue here with going from a future date and time earlier than now back to day showing null\n                    // Push the current date option in\n                    timeOptions.push({\n                        display: timeWithGmtOffsetFormatString(date),\n                        value: date.formatDate('HH:mm')\n                    });\n                    // Sort the time options\n                    timeOptions.sort((a, b) => `${a.value}`.localeCompare(`${b.value}`));\n                    return timeOptions;\n                })\n            ).subscribe(next => this.options.next(next)));\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.no_past_times || changes.step || changes.timezone) {\n            // If there's a new date value then update the time options\n            this.options.next(generateAvailableTimes(this.date.value, !this.noPastTimes, this.step, this.timezone));\n            const buildingDate = new DateTZ({date: this.from, is_local_tz: false, building_tz: this.timezone}).startOfValue('minute');\n            this.value.next(buildingDate.formatDate('HH:mm'));\n        }\n        if (changes.from) {\n            // When the from input param changes update the date value\n            this.date.next(this.from);\n        }\n    }\n\n    /**\n     * Update the form field value\n     * @param new_value New value to set on the form field\n     */\n    public setValue(new_value: string): void {\n        // value comes in as a HH:mm string\n        const newTime = (new_value.indexOf(':') > 0 ? new_value : '00:00').split(':');\n        // need the date with the building timezone so the hour set is relative to there and not local.\n        const d = new DateTZ({ date: this.date.value, is_local_tz: false, building_tz: this.timezone });\n        const date = d.setValue({ hour: parseInt(newTime[0]), minute: parseInt(newTime[1]) });\n        if (date) {\n            if (this._onChange) {\n                this._onChange(date.ms);\n            }\n        }\n    }\n\n    /**\n     * Update local value when form control value is changed\n     * @param value The new value for the component\n     */\n    public writeValue(value: number | null) {\n        if (value != null) {\n            // Time input value in building time milliseconds\n            this.date.next(value);\n            // Get the closest time to slot in case the browser was idle and elapse the valid times\n            const date = closestToTimeSlot(DateTime.fromMillis(value).startOf('minute'), this.step);\n            // Need the building time so HH:mm is correct\n            const buildingDate = new DateTZ({date: date.valueOf(), is_local_tz: false, building_tz: this.timezone}).startOfValue('minute');\n            this.options.next(generateAvailableTimes(buildingDate.ms, !this.noPastTimes, this.step, this.timezone));\n        }\n    }\n\n    public setDisabledState(disabled: boolean) {\n        this.disabled = disabled;\n    }\n\n    /**\n     * Registers a callback function that is called when the control's value changes in the UI.\n     * @param fn The callback function to register\n     */\n    public registerOnChange(fn: (_: number) => void): void {\n        this._onChange = fn;\n    }\n\n    /**\n     * Registers a callback function is called by the forms API on initialization to update the form model on blur.\n     * @param fn The callback function to register\n     */\n    public registerOnTouched(fn: (_: number) => void): void {\n        this._onTouch = fn;\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output\n} from '@angular/core';\nimport { SelectOption } from '@mckinsey-converge/ui';\n\n@Component({\n    selector: 'mck-toggle',\n    template: `\n        <div class=\"mck-row toggle-container\">\n            <button *ngFor=\"let option of options\" [class.desktop-only]=\"!option?.meta?.mobile\"\n                name=\"{{option.display}}\"\n                class=\"mck-toggle-button {{isSelected(option) ? 'mck-toggle-button-selected' : ''}}\"\n                mat-ripple\n                (click)=\"onTapOption(option)\"\n                >{{option.display}} </button>\n        </div>\n    `,\n    styleUrls: ['./toggle.component.scss']\n})\nexport class ToggleComponent {\n\n    @Input()\n    options: SelectOption<any>[];\n\n    @Input()\n    selected: SelectOption<any>;\n\n    @Output()\n    selectedChange = new EventEmitter<SelectOption<any>>();\n\n    public onTapOption(option: SelectOption<any>) {\n        this.selectedChange.emit(option);\n    }\n\n    isSelected(option: SelectOption<any>) {\n        return this.selected === option;\n    }\n}\n","import { Component, Input } from '@angular/core';\nimport {TooltipPosition, TooltipTheme} from \"./tooltip.enums\";\n\n@Component({\n  selector: 'app-tooltip',\n  templateUrl: './tooltip.component.html',\n  styleUrls: ['./tooltip.component.scss']\n})\nexport class TooltipComponent {\n  isVisible: boolean = false; // To control the visibility of the tooltip\n  position: TooltipPosition = TooltipPosition.DEFAULT;\n  theme: TooltipTheme = TooltipTheme.DEFAULT;\n  tooltip = '';\n  left = 0;\n  top = 0;\n  visible = false;\n}","<div class=\"tooltip\" [ngClass]=\"['tooltip--'+position, 'tooltip--'+theme]\" [class.tooltip--visible]=\"visible\"\n  [style.left]=\"left + 'px'\" [style.top]=\"top + 'px'\">\n  <div *ngFor=\"let string of tooltip\">\n    {{string}}\n  </div>\n</div>","import {\n  ApplicationRef,\n  ComponentFactoryResolver,\n  ComponentRef,\n  Directive,\n  ElementRef,\n  EmbeddedViewRef,\n  HostListener,\n  Injector,\n  Input,\n  ViewContainerRef\n} from '@angular/core';\nimport {TooltipComponent} from \"./tooltip.component\";\nimport {TooltipPosition, TooltipTheme} from \"./tooltip.enums\";\n\n@Directive({\n  selector: '[tooltip]'\n})\nexport class TooltipDirective {\n\n  @Input() tooltip = '';\n  @Input() position: TooltipPosition = TooltipPosition.DEFAULT;\n  @Input() theme: TooltipTheme = TooltipTheme.DEFAULT;\n  @Input() trigger: 'hover' | 'click' = 'hover'; \n  @Input() showDelay = 0;\n  @Input() hideDelay = 0;\n  @Input() show: boolean = true;\n\n  private componentRef: ComponentRef<any> | null = null;\n  private showTimeout?: number;\n  private hideTimeout?: number;\n  private touchTimeout?: number;\n\n  constructor(private elementRef: ElementRef, private appRef: ApplicationRef,\nprivate componentFactoryResolver: ComponentFactoryResolver, private injector: Injector) {\n  }\n\n  @HostListener('mouseenter')\n  onMouseEnter(): void {\n    if (this.trigger === 'hover') {\n      this.initializeTooltip();\n    }\n  }\n\n  @HostListener('mouseleave')\n  onMouseLeave(): void {\n    if (this.trigger === 'hover') {\n      this.setHideTooltipTimeout();\n    }\n  }\n\n  @HostListener('click')\n  onClick(): void {\n    if (this.trigger === 'click') {\n      if (this.componentRef === null) {\n        this.initializeTooltip();\n      } else {\n        this.destroy(); // Hide tooltip if it is already shown\n      }\n    }\n  }\n\n  @HostListener('touchstart', ['$event'])\n  onTouchStart($event: TouchEvent): void {\n    $event.preventDefault();\n    window.clearTimeout(this.touchTimeout);\n    this.touchTimeout = window.setTimeout(this.initializeTooltip.bind(this), 500);\n  }\n\n  @HostListener('touchend')\n  onTouchEnd(): void {\n    window.clearTimeout(this.touchTimeout);\n    this.setHideTooltipTimeout();\n  }\n\n  private initializeTooltip() {\n    if (this.componentRef === null) {\n      window.clearInterval(this.hideDelay);\n      const componentFactory = this.componentFactoryResolver.resolveComponentFactory(TooltipComponent);\n      this.componentRef = componentFactory.create(this.injector);\n\n      this.appRef.attachView(this.componentRef.hostView);\n      const [tooltipDOMElement] = (this.componentRef.hostView as EmbeddedViewRef<any>).rootNodes;\n\n      this.setTooltipComponentProperties();\n\n      document.body.appendChild(tooltipDOMElement);\n      this.showTimeout = window.setTimeout(this.showTooltip.bind(this), this.showDelay);\n    }\n  }\n\n  private setTooltipComponentProperties() {\n    if (this.componentRef !== null) {\n      this.componentRef.instance.tooltip = this.tooltip;\n      this.componentRef.instance.position = this.position;\n      this.componentRef.instance.theme = this.theme;\n\n      const {left, right, top, bottom} = this.elementRef.nativeElement.getBoundingClientRect();\n\n      switch (this.position) {\n        case TooltipPosition.BELOW: {\n          this.componentRef.instance.left = Math.round((right - left) / 2 + left);\n          this.componentRef.instance.top = Math.round(bottom);\n          break;\n        }\n        case TooltipPosition.ABOVE: {\n          this.componentRef.instance.left = Math.round((right - left) / 2 + left);\n          this.componentRef.instance.top = Math.round(top);\n          break;\n        }\n        case TooltipPosition.RIGHT: {\n          this.componentRef.instance.left = Math.round(right);\n          this.componentRef.instance.top = Math.round(top + (bottom - top) / 2);\n          break;\n        }\n        case TooltipPosition.LEFT: {\n          this.componentRef.instance.left = Math.round(left);\n          this.componentRef.instance.top = Math.round(top + (bottom - top) / 2);\n          break;\n        }\n        default: {\n          break;\n        }\n      }\n    }\n  }\n\n  private showTooltip() {\n    if (this.componentRef !== null) {\n      this.componentRef.instance.visible = this.show ? true : false;\n    }\n  }\n\n  private setHideTooltipTimeout() {\n    this.hideTimeout = window.setTimeout(this.destroy.bind(this), this.hideDelay);\n  }\n\n  ngOnDestroy(): void {\n    this.destroy();\n  }\n\n  destroy(): void {\n    if (this.componentRef !== null) {\n      window.clearInterval(this.showTimeout);\n      window.clearInterval(this.hideDelay);\n      this.appRef.detachView(this.componentRef.hostView);\n      this.componentRef.destroy();\n      this.componentRef = null;\n    }\n  }\n}\n","export enum TooltipPosition {\n    ABOVE = 'above',\n    BELOW = 'below',\n    LEFT = 'left',\n    RIGHT = 'right',\n    DYNAMIC = 'dynamic',\n    DEFAULT = 'below'\n}\n\nexport enum TooltipTheme {\n    DARK = 'dark',\n    LIGHT = 'light',\n    DEFAULT = 'dark'\n}\n","export { AlertMode, AlertBannerDisplay } from './alert-banner/alert-banner.component';\nexport { SelectOption } from './options/select-option';\nexport * from './cng-select/dropdown-panel';","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatSelectModule } from '@angular/material/select';\nimport { AutoCompleteChipSelectItemComponent } from './auto-complete-chip-select-item/auto-complete-chip-select-item.component';\nimport { AutoCompleteSelectOptionComponent } from './auto-complete-select-option/auto-complete-select-option.component';\nimport {\n    FormsModule,\n    ReactiveFormsModule\n} from '@angular/forms';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { NgxMatSelectSearchModule } from 'ngx-mat-select-search';\nimport { RadioSelectComponent } from './radio-select/radio-select.component';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatRippleModule } from '@angular/material/core';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\nimport { FilterPipe } from './pipes/filter.pipe';\nimport { MatIconModule } from '@angular/material/icon';\nimport { TimeFieldComponent } from './time-field/time-field.component';\nimport { DateTzTimeFieldComponent } from './date-tz-time-field/date-tz-time-field.component';\nimport { SpacerComponent } from './spacer/spacer.component';\nimport { DurationFieldComponent } from './duration-field/duration-field.component';\nimport { DateTzDurationFieldComponent } from './date-tz-duration-field/date-tz-duration-field.component';\nimport { AcaDatePickerComponent } from './aca-date-picker/aca-date-picker.component'; // the old widget\nimport { MckDatePickerComponent } from './mck-date-picker/mck-date-picker.component'; // the old form field \nimport { DateTzCalendarWidgetComponent } from './date-tz-calendar-widget/date-tz-calendar-widget.component'; // the new widget\nimport { DateTzDatePickerComponent } from './date-tz-date-picker/date-tz-date-picker.component'; // the new form field \nimport { CalendarIconComponent } from './icons/calendar/calendar-icon.component';\nimport { ChevronIconComponent } from './icons/calendar/chevron-icon.component';\nimport { SelectOptionComponent } from './select-option/select-option.component';\nimport { CloseIconComponent } from './icons/close/close-icon.component';\nimport { SelectedChipCountComponent } from './selected-chip-count/selected-chip-count.component';\nimport { AlertBannerComponent } from './alert-banner/alert-banner.component';\nimport { ErrorMessageComponent } from './error-message/error-message.component';\nimport { ToggleComponent } from './toggle/toggle.component';\nimport { LabelComponent } from './label/label.component';\nimport { ModalComponent } from './modal/modal.component';\nimport { CollapseHeaderComponent } from './collapse-header/collapse-header.component';\nimport { MatExpansionModule } from '@angular/material/expansion';\nimport { SwitchGroupComponent } from './switch-group/switch-group.component';\nimport { ModalButtonRowComponent } from './modal-button-row/modal-button-row.component';\nimport { InformationalImageComponent } from './informational-image/informational-image.component';\nimport { GroupHeaderPipe } from './auto-complete-chip-select-item/groupHeader.pipe';\nimport { SelectComponent } from './select/select.component';\nimport { LegendDropdownComponent } from './legend-dropdown/legend-dropdown.component';\nimport { NgxSkeletonLoaderModule } from 'ngx-skeleton-loader';\nimport { RecurrencePatternForm } from './recurrence-pattern-form/recurrence-pattern-form.component'; \nimport { RecurrenceDateForm } from './recurrence-date-form/recurrence-date-form.component';\nimport { ConflictsModalComponent } from './conflicts-modal/conflicts-modal.component';\nimport { RecurringBookingForm } from './recurrence-booking-form/recurrence-booking-form.component';\nimport { OverrideChangesModalComponent } from './override-changes-modal/override-changes-modal.component';\nimport { SanitizePipe } from './pipes/sanitise.pipe';\nimport { ConflictAlertModalComponent } from './conflict-alert-modal/conflict-alert-modal.component';\nimport { CngSelectComponent } from './cng-select/cng-select.component';\nimport { OverlayModule } from '@angular/cdk/overlay';\nimport { DropdownTriggerForDirective } from './cng-select/dropdown-trigger-for.directive';\nimport { CngSelectOptionsComponent } from './cng-select/cng-select-options.component';\nimport { TooltipComponent } from './tooltip/tooltip.component';\nimport { TooltipDirective } from './tooltip/tooltip.directive';\n\nexport const MATERIAL_MODULES: any[] = [\n    MatButtonModule,\n    MatSnackBarModule,\n    MatDialogModule,\n    MatFormFieldModule,\n    MatIconModule,\n    MatInputModule,\n    MatProgressSpinnerModule,\n    MatProgressBarModule,\n    MatAutocompleteModule,\n    MatSelectModule,\n    MatChipsModule,\n    MatRippleModule,\n    MatMenuModule,\n    MatCheckboxModule,\n    MatTooltipModule,\n    MatRadioModule,\n    MatTabsModule,\n    MatSlideToggleModule,\n    MatExpansionModule,\n    OverlayModule\n];\n\n@NgModule({\n    imports: [CommonModule,\n        ...MATERIAL_MODULES,\n        ReactiveFormsModule,\n        FormsModule,\n        NgxMatSelectSearchModule, NgxSkeletonLoaderModule],\n    declarations: [\n        AutoCompleteChipSelectItemComponent,\n        AutoCompleteSelectOptionComponent,\n        AcaDatePickerComponent,\n        MckDatePickerComponent,\n        DateTzCalendarWidgetComponent,\n        DateTzDatePickerComponent,\n        TimeFieldComponent,\n        DateTzTimeFieldComponent,\n        DurationFieldComponent,\n        DateTzDurationFieldComponent,\n        GroupHeaderPipe,\n        RadioSelectComponent,\n        FilterPipe,\n        SanitizePipe,\n        SpacerComponent,\n        CalendarIconComponent,\n        ChevronIconComponent,\n        SelectOptionComponent,\n        CloseIconComponent,\n        SelectedChipCountComponent,\n        AlertBannerComponent,\n        ErrorMessageComponent,\n        ToggleComponent,\n        LabelComponent,\n        ModalComponent,\n        CollapseHeaderComponent,\n        SwitchGroupComponent,\n        ModalButtonRowComponent,\n        InformationalImageComponent,\n        SelectComponent,\n        LegendDropdownComponent,\n        RecurrencePatternForm,\n        RecurrenceDateForm,\n        RecurringBookingForm,\n        ConflictsModalComponent,\n        OverrideChangesModalComponent,\n        ConflictAlertModalComponent,\n        CngSelectComponent, \n        DropdownTriggerForDirective,\n        CngSelectOptionsComponent,\n        TooltipComponent,\n        TooltipDirective\n    ],\n    exports: [\n        AutoCompleteChipSelectItemComponent,\n        AutoCompleteSelectOptionComponent,\n        AcaDatePickerComponent,\n        MckDatePickerComponent,\n        DateTzCalendarWidgetComponent,\n        DateTzDatePickerComponent,\n        TimeFieldComponent,\n        DateTzTimeFieldComponent,\n        DurationFieldComponent,\n        DateTzDurationFieldComponent,\n        RadioSelectComponent,\n        FilterPipe,\n        SanitizePipe,\n        SpacerComponent,\n        CalendarIconComponent,\n        ChevronIconComponent,\n        AlertBannerComponent,\n        ReactiveFormsModule,\n        FormsModule,\n        ToggleComponent,\n        LabelComponent,\n        ModalComponent,\n        CollapseHeaderComponent,\n        SwitchGroupComponent,\n        ModalButtonRowComponent,\n        InformationalImageComponent,\n        SelectComponent,\n        LegendDropdownComponent,\n        RecurrencePatternForm,\n        RecurrenceDateForm,\n        RecurringBookingForm,\n        ConflictsModalComponent,\n        OverrideChangesModalComponent,\n        ConflictAlertModalComponent,\n        CngSelectComponent, DropdownTriggerForDirective,\n        CngSelectOptionsComponent,\n        TooltipComponent,\n        TooltipDirective\n    ]\n})\nexport class UiModule {\n}\n","/**\n * Generate a list of time options for the given date\n * @param datestamp Date to generate options for\n * @param show_past Whether past times should be options\n */\n\nimport {\n    closestToTimeSlot,\n    closestToTimeSlotTz,\n    DurationGroup,\n    durationHumanized,\n    timeFormatString,\n    timeWithGmtOffsetFormatString,\n    unique\n} from '@mckinsey-converge/base';\nimport { SelectOption } from '../types';\nimport { DateTZ } from \"@mckinsey-converge/date-tz\";\nimport { DateTime } from 'luxon';\n\n// 24 hours\nexport const ALL_DAY_BOOKING_VALUE = 60 * 24;\n\nexport const DEFAULT_DURATION = 30;\n\n// R--- depreciate.\nexport const generateAvailableTimes = (\n    datestamp: number,\n    showPast: boolean,\n    step: number = 15,\n    timezone: string = new DateTZ({ date: Date.now() }).local_tz\n): SelectOption<any>[] => {\n    // R--- refactor to only used dateTz input and drop timezone param.\n    // now needs the building timezone for isAfter to work correctly\n    const now = new DateTZ({ date: Date.now(), is_local_tz: false, building_tz: timezone });\n    // date needs the building timezone for isAfter to work correctly\n    let date = new DateTZ({ date: datestamp, is_local_tz: false, building_tz: timezone });\n    // Check if we're today or a future date\n    const blocks: SelectOption<any>[] = [];\n    if (showPast || date.isAfterDate(now, 'day')) {\n        // later than today\n        date = date.startOfValue('day');\n    } else {\n        // today\n        date = now;\n    }\n    // Get the closest timeslot to the start time\n    const inputDate = DateTime.fromMillis(date.ms);\n    const closestDate = closestToTimeSlot(inputDate, step);\n    // Date changed to the closest time\n    date = new DateTZ({ date: closestDate.valueOf(), is_local_tz: false, building_tz: timezone });\n    const end = date.endOfValue('day');\n    // Add options for the rest of the day\n    while (date.isBeforeDate(end)) {\n        blocks.push({\n            display: timeWithGmtOffsetFormatString(date),\n            shortDisplay: date.formatDate('hh:mma'),\n            value: date.formatDate('HH:mm')\n        });\n        date = date.addValue({ minutes: step });\n    }\n    return blocks;\n};\n\n\nexport const generateAvailableTimesTz = (\n    fromDateTz: DateTZ,\n    showPast: boolean,\n    step: number = 15,\n    timezone: string = new DateTZ({ date: Date.now() }).local_tz,\n    all_day: boolean = false,\n    extras: SelectOption<DateTZ>[] = [],\n    startFromDateTz: boolean = false\n): SelectOption<DateTZ>[] => {\n    // now needs the building timezone for isAfter to work correctly\n    const now = new DateTZ({ date: Date.now(), is_local_tz: false, building_tz: timezone });\n    // date needs the building timezone for isAfter to work correctly\n    let dateTz = fromDateTz.clone();\n    // Check if we're today or a future date\n    const blocks: SelectOption<DateTZ>[] = [];\n    if (showPast || dateTz.isAfterDate(now, 'day')) {\n        // later than today\n        dateTz = dateTz.startOfValue('day');\n    } else {\n        // today/fromDateTz using the flag\n        dateTz = startFromDateTz ? dateTz : now;\n    }\n    // Get the closest timeslot to the start time\n    dateTz = closestToTimeSlotTz(dateTz, step);\n    // Date changed to the closest time\n    const end = dateTz.endOfValue('day');\n    // Add the all day option for today\n    if (all_day && dateTz.isSameDate(now, 'day')) {\n        const startOfDay = dateTz.startOfValue('day');\n        blocks.push({\n            display: timeWithGmtOffsetFormatString(startOfDay),\n            shortDisplay: startOfDay.formatDate('hh:mma'),\n            value: startOfDay\n        })\n    }\n    // Add options for the rest of the day\n    while (dateTz.isBeforeDate(end)) {\n        blocks.push({\n            display: timeWithGmtOffsetFormatString(dateTz),\n            shortDisplay: dateTz.formatDate('hh:mma'),\n            value: dateTz, \n        });\n        \n        dateTz = dateTz.addValue({ minutes: step });\n    }\n\n    return unique(extras.concat(blocks), 'shortDisplay');\n};\n\n/**\n * Generates list of duration options for new booking flow.\n * @param date - The start dateTime\n * @param max - The max number of minutes to go to from the date param.\n * @param min - The min number of minutes to display first time from.\n * @param step - The number of minutes to step up by for timeslots.\n */\nexport const generateDurationOptions = (\n    date: DateTZ,\n    max: number,\n    min: number,\n    step: number,\n    extended: boolean): SelectOption<any>[] => {\n    const blocks: SelectOption<any>[] = [];\n    let value = min;\n    while (value <= max) {\n        let duration: string;\n        if (extended) {\n            const d = durationHumanized(value - min, true);\n            duration = d ? `+${d}` : 'Current';\n        } else {\n            duration = durationHumanized(value, true);\n        }\n\n        blocks.push({\n            value,\n            display: `${date.addValue({ minutes: value }).formatDate(timeFormatString()).toLocaleLowerCase()} (${duration})`,\n        });\n        value += step;\n    }\n    return blocks;\n};\n\nexport const allDayOption: SelectOption<any> = ({\n    value: ALL_DAY_BOOKING_VALUE,\n    display: 'All Day'\n});\n\nexport const oneWeekOption: SelectOption<any> = ({\n    value: 60 * 24 * 7, // 1 week\n    display: 'One Week'\n});\n\nexport const defaultDurationGroups: DurationGroup[] = [\n    {\n        start: 15,\n        step: 15,\n        max: 60 * 24\n    }\n    // , {\n    //     start: 60,\n    //     step: 30,\n    //     max: (60 * 8) - 1  // 8 hours\n    // }, {\n    //     start: 60 * 8,\n    //     step: 60,\n    //     max: 60 * 24 // 24 hours\n    // }\n];\n\n/**\n * Maps the {@link DurationGroup} to {@link SelectOption} and appends the default all day and week options.\n */\nexport const generateDurationOptionsFromGroups = (date: DateTZ, durationGroups: DurationGroup[], extended: boolean): SelectOption<any>[] => [\n    ...(durationGroups.map(duration => generateDurationOptions(date, duration.max, duration.start, duration.step, extended)).reduce(((previousValue, currentValue) => {\n        previousValue.push(...currentValue);\n        return previousValue;\n    }), [])),\n        // allDayOption,\n        // oneWeekOption\n    ];\n","export * from './lib/user.module';\nexport * from './lib/user.actions'\nexport * from './lib/user.types'\nexport * from './lib/user.reducer'\n","import { \n    createLoadingAction\n  } from '../../../loading/src/lib/loading.actions';\nimport {\n    UserState,\n    UserStoreState\n} from './user.types';\nimport { User } from '../../../data-common/src/lib/users/user.class';\nimport { createSelector } from '@ngrx/store';\n\nexport const loadUser = createLoadingAction<UserState, User>('CurrentUser', 'current');\n\nexport const selectUserState = ({ user }: UserStoreState) => user;\n\nexport const selectHasUserData = createSelector(createSelector(selectUserState, loadUser.selectors.model), (state) => !!state.optionalSuccess);\n\nexport const selectCurrentUser = createSelector(selectUserState, loadUser.selectors.optionalSuccess);\n","import { Injectable } from '@angular/core';\nimport {\n    Actions,\n    Effect\n} from '@ngrx/effects';\nimport { createLoadingEffect } from '@mckinsey-converge/loading';\nimport { loadUser } from './user.actions';\nimport { UsersService } from '../../../data-common/src/lib/users/users.service';\n\n\n@Injectable()\nexport class UserEffects {\n\n    constructor(private actions: Actions,\n                private userService: UsersService) {\n    }\n\n    @Effect()\n    loadUser = createLoadingEffect(this.actions, loadUser, () => this.userService.loadCurrentUser());\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { StoreModule } from '@ngrx/store';\nimport { userReducer } from './user.reducer';\nimport { EffectsModule } from '@ngrx/effects';\nimport { UserEffects } from './user.effects';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        StoreModule.forFeature('user', userReducer),\n        EffectsModule.forFeature([UserEffects])\n    ]\n})\nexport class UserModule {\n}\n","import { createReducer } from '@ngrx/store';\nimport { UserState } from './user.types';\nimport { LoadingModel } from '@mckinsey-converge/loading';\nimport { loadUser } from './user.actions';\n\n\nexport const initialUserState: UserState = {\n    current: LoadingModel.empty()\n};\n\nexport const userReducer = createReducer(initialUserState,\n    ...loadUser.ons);\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { ShellWrapperComponent } from './shell/shell.component';\n\nconst routes: Routes = [\n    {\n        path: '',\n        component: ShellWrapperComponent,\n        children: [\n            {\n                path: 'home',\n                loadChildren: () => import('./booking/booking.module').then((m) => m.BookingModule),\n            },\n            { path: '**', redirectTo: 'home' },\n        ],\n    },\n    { path: '**', redirectTo: 'home' },\n];\n\n@NgModule({\n    imports: [RouterModule.forRoot(routes, { useHash: true })],\n    exports: [RouterModule],\n})\nexport class AppRoutingModule {}\n","import {\n    Component,\n    OnInit,\n    ViewEncapsulation\n} from '@angular/core';\nimport { ActivatedRoute, GuardsCheckEnd, NavigationEnd, NavigationStart, Router } from '@angular/router';\nimport { BaseDirective, detectIE } from '@mckinsey-converge/base';\nimport {\n    ApplicationService,\n    BookingsService,\n    OrganisationService,\n    SpacesService\n} from '@mckinsey-converge/data-common';\nimport { environment } from 'src/environments/environment';\n\n@Component({\n    selector: 'app-root',\n    templateUrl: './app.component.html',\n    styleUrls: [\n        './styles/app.component.scss',\n        './styles/custom-element.styles.scss',\n        './styles/native-element.styles.scss'\n    ],\n    encapsulation: ViewEncapsulation.None\n})\nexport class AppComponent extends BaseDirective implements OnInit {\n    constructor(\n        private _app: ApplicationService,\n        private _org: OrganisationService,\n        private _spaces: SpacesService,\n        private _bookings: BookingsService,\n        private _router: Router,\n        private _route: ActivatedRoute,\n    ) {\n        super();\n\n        // ensure app is trusted in dev mode so we can preserve login.\n        if (!environment.production) {\n            localStorage.setItem('trusted', 'true');\n        }\n\n\n        if (detectIE() && detectIE() < 12) {\n            location.href = `${location.origin}${location.pathname}assets/not-supported.html`;\n            return;\n        }\n    }\n\n    public ngOnInit(): void {\n        this._router.events.subscribe((val: NavigationStart) => {\n            const bookingForm = JSON.parse(localStorage.getItem('bookingForm'));\n            if (val && val.navigationTrigger && val.url) {\n                // Redirect everyone who doesn't have an active bookingForm back to the home page.\n                const cleanHash = location?.hash.split('?')[0];\n                const isLoadBookingUrl = cleanHash.indexOf('#/home/booking/') === 0;\n                const isLoadCateringUrl = cleanHash.indexOf('#/home/catering/') === 0;\n                if (!isLoadBookingUrl && !isLoadCateringUrl && cleanHash && ['#/home', '#/home/manage', '#/home/create', '#/home/edit'].indexOf(cleanHash) === -1 && bookingForm && !bookingForm?.activeForm) {\n                    location.href = `${location.origin}`;\n                    return;\n                }\n            }\n\n        })\n    }\n}\n","<div class=\"app\">\n    <router-outlet></router-outlet>\n</div>\n","// remove after trigger build\nimport { BrowserModule } from '@angular/platform-browser';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\nimport { NgModule } from '@angular/core';\nimport { HttpClientModule } from '@angular/common/http';\nimport { FormsModule } from '@angular/forms';\nimport { MAT_LABEL_GLOBAL_OPTIONS } from '@angular/material/core';\n\nimport { ComposerModule } from '@placeos/composer';\n\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\nimport { environment } from '../environments/environment';\nimport { SharedContentModule } from './shared/shared.module';\n\nimport { ShellWrapperComponent } from './shell/shell.component';\nimport {\n    ActionReducer,\n    MetaReducer,\n    StoreModule\n} from '@ngrx/store';\nimport { StoreDevtoolsModule } from '@ngrx/store-devtools';\nimport { BookingModule } from 'src/app/booking/booking.module';\nimport { BookingsModule } from '@mckinsey-converge/bookings';\nimport { BuildingsModule } from '@mckinsey-converge/buildings';\nimport { EffectsModule } from '@ngrx/effects';\nimport { DEFAULT_SETTINGS } from 'src/environments/settings';\nimport { provideMockSettingsObject } from '@mckinsey-converge/data-common';\nimport { OrganisationModule } from '@mckinsey-converge/organisation';\nimport { localStorageSync } from 'ngrx-store-localstorage';\nimport { UiModule } from '@mckinsey-converge/ui';\nimport { RoomsModule } from '@mckinsey-converge/rooms';\nimport { ENVIRONMENT_TOKEN } from '@mckinsey-converge/environment';\nimport { LegacyOverlaysModule } from '@mckinsey-converge/legacy-overlays';\nimport { UserModule } from '@mckinsey-converge/user';\nimport { MapModule } from 'src/app/map/map.module';\n\n/**\n * Cache some state in local storage. Not for use in production.\n */\nexport function localStorageSyncReducer(reducer: ActionReducer<any>): ActionReducer<any> {\n    // Keys needed to fix prod reloading.  MCK-1229\n    let keys = [\n        'buildings',\n        'bookingForm',\n        'rooms',\n    ];\n\n    if (!environment.production) {\n        keys = [\n            'bookings',\n            'buildings',\n            'organisation',\n            'bookingForm',\n            'rooms',\n            'user'\n        ];\n    }\n\n    return localStorageSync({\n        keys,\n        rehydrate: true,\n    })(reducer);\n}\n\nconst metaReducers: Array<MetaReducer<any, any>> = [localStorageSyncReducer];\n\n\n@NgModule({\n    declarations: [\n        AppComponent,\n        ShellWrapperComponent\n    ],\n    imports: [\n        BrowserModule,\n        BrowserAnimationsModule,\n        AppRoutingModule,\n        HttpClientModule,\n        FormsModule,\n        ComposerModule,\n        SharedContentModule,\n        LegacyOverlaysModule,\n        StoreModule.forRoot({}, { metaReducers }),\n        StoreDevtoolsModule.instrument({\n            maxAge: 100,\n            logOnly: environment.production\n        }),\n        EffectsModule.forRoot(),\n        BookingsModule,\n        BookingModule,\n        BuildingsModule,\n        MapModule,\n        OrganisationModule,\n        RoomsModule,\n        UiModule,\n        UserModule\n    ],\n    providers: [\n        { provide: MAT_LABEL_GLOBAL_OPTIONS, useValue: { float: 'nevet' } },\n        provideMockSettingsObject(DEFAULT_SETTINGS),\n        { provide: ENVIRONMENT_TOKEN, useValue: environment }\n    ],\n    bootstrap: [AppComponent]\n})\nexport class AppModule {\n}\n","import { Component, OnInit, Input, Output, EventEmitter, ViewChild } from '@angular/core';\nimport { MatMenuTrigger } from '@angular/material/menu';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\nimport { BookingStateService, OrganisationService } from '@mckinsey-converge/data-common';\nimport { DateNow, DateTZ, getTimezoneOffsetString, toMiddayUTC } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'calendar-date-widget',\n    templateUrl: './calendar-date-widget.component.html',\n    styleUrls: ['./calendar-date-widget.component.scss'],\n})\nexport class CalendarDateWidgetComponent extends BaseDirective implements OnInit {\n    /** Currently selected date */\n    @Input() public dateTz: DateTZ = DateNow(new Date());\n    /** Currently building timezone */\n    @Input() public timezone: string;\n    /** Currently active zone */\n    @Input() public zone: string;\n    /** Whether to show new item button */\n    @Input() public show_add_item = false;\n    /** Whether to show the events for the active month */\n    @Input() public show_events: boolean = false;\n    /** Preserve last selected date */\n    @Input() public retainSelectedDate: boolean = false;\n    /** Emitter for changes selected date */\n    @Output() public dateChangeTz = new EventEmitter<DateTZ>();\n    /** Emitter for add item button */\n    @Output() public event = new EventEmitter();\n    /** Counters of the events on given dates. Key format is `yyyy-MM-dd` */\n    public event_map: { [date: string]: number };\n\n    public fromDateTz = DateNow().subtractValue({ months: 6 });\n\n    public get now() {\n        return DateNow();\n    }\n\n    /** Display string for the currently selected date */\n    public get tz(): string {\n        return getTimezoneOffsetString(this.timezone_value);\n    }\n\n    public get timezone_value() {\n        return localStorage.getItem('CONCIERGE.timezone') || this.timezone || this.now.building_tz;\n    }\n\n    public get is_today() {\n        return new DateTZ({\n            date: toMiddayUTC(this.dateTz).ms,\n            is_local_tz: false,\n            building_tz: this.timezone_value,\n        }).isSameDate(\n            new DateTZ({\n                date: Date.now(),\n                is_local_tz: false,\n                building_tz: this.timezone_value,\n            }),\n            'day'\n        );\n    }\n\n    constructor(private _bookings: BookingStateService, private _org: OrganisationService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        // CONCIERGE.date: Get the localstorage date and timezone when changing pages.\n       let date: any;\n        if(!this.retainSelectedDate) {\n             date = +localStorage.getItem('CONCIERGE.date') || this.now.ms;\n        } else {\n             date = this.now.ms;\n        }\n\n        \n        /* istanbul ignore else */\n        if (date && (date !== this.dateTz.ms || this.timezone_value !== this.dateTz.building_tz)) {\n            // CONCIERGE.date Reapply the localstorage date and timezone when changing pages.\n            this.timeout(\n                'init',\n                () => {\n                    this.dateTz = new DateTZ({\n                        date,\n                        is_local_tz: false,\n                        building_tz: this.timezone_value,\n                    });\n                    this.dateChangeTz.emit(this.dateTz);\n                    this.updateDate();\n                },\n                10\n            );\n        }\n        this.subscription(\n            'events',\n            this._bookings._noOfMeetings.subscribe((list) => {\n                this.event_map = {};\n                this.event_map = list[0];\n            })\n        );\n    }\n\n    public noOfCount(event) {\n       // Disabling bellow until find more reliable way to call as it is been called multiple times on hover/click\n        // this._bookings.getDailyMeetingCount();\n        // event.stopPropogation();\n    }\n\n    /**\n     * Change the selected date with the arrow controls\n     *\n     */\n    public changeDate(value: number) {\n        let date = new DateTZ({\n            date: toMiddayUTC(this.dateTz).ms,\n            is_local_tz: false,\n            building_tz: this.timezone_value,\n        });\n        date = date.addValue({ days: value });\n        this.dateTz = date;\n        this.dateChangeTz.emit(this.dateTz);\n        localStorage.setItem('CONCIERGE.date', `${this.dateTz.ms}`);\n        localStorage.setItem('CONCIERGE.timezone', `${this.timezone_value}`);\n        this.updateDate();\n    }\n\n    /**\n     * Change the selected date with the calendar widget\n     *\n     */\n    public applyDatePickerValue(dateInputTz: DateTZ) {\n        this.dateTz = new DateTZ({\n            date: toMiddayUTC(dateInputTz).ms,\n            is_local_tz: false,\n            building_tz: this.timezone_value,\n        });\n        this.dateChangeTz.emit(this.dateTz);\n        localStorage.setItem('CONCIERGE.date', `${this.dateTz.ms}`);\n        localStorage.setItem('CONCIERGE.timezone', `${this.timezone_value}`);\n        this.updateDate();\n        this.closeDatePicker();\n    }\n\n    public updateDate() {\n        this.timeout('update_date', () => this._bookings.setDate(this.dateTz));\n    }\n\n    /** Reset date to the current date */\n    public resetDate() {\n        this.dateTz = new DateTZ({\n            date: toMiddayUTC(this.now).ms,\n            is_local_tz: false,\n            building_tz: this.timezone_value,\n        });\n        this.dateChangeTz.emit(this.dateTz);\n        localStorage.setItem('CONCIERGE.date', `${this.dateTz.ms}`);\n        localStorage.setItem('CONCIERGE.timezone', `${this.timezone_value}`);\n        this.updateDate();\n    }\n\n    public closeDatePicker() {\n        this.updateDate();\n    }\n\n    /** New Item button click */\n    public newItem(): void {\n        this.event.emit('new_item');\n    }\n}\n","<div class=\"topbar-header\">\n\n    \n    <div class=\"date\">\n        <div class=\"picker\">\n            <button mat-icon-button name=\"previous\" (click)=\"changeDate(-1)\">\n                <app-icon\n                    [icon]=\"{ class: 'material-icons', content: 'keyboard_arrow_left' }\"\n                ></app-icon>\n            </button>\n            <div class=\"text\" (dblclick)=\"resetDate()\">\n                <p small *ngIf=\"is_today\">Today</p>\n                <p [class.medium]=\"is_today\">{{ dateTz.ms | date: 'mediumDate':tz }}</p>\n            </div>\n            <button mat-icon-button name=\"next\" (click)=\"changeDate(1)\">\n                <app-icon\n                    [icon]=\"{ class: 'material-icons', content: 'keyboard_arrow_right' }\"\n                ></app-icon>\n            </button>\n        </div>\n        <div class=\"divide\" (click)=\"noOfCount($event)\">\n            <date-tz-date-picker\n                class=\"time-inputs-calendar\"\n                [icon_only]=\"true\"\n                [counters]=\"show_events ? event_map : {}\"\n                [(ngModel)]=\"dateTz\"\n                [fromDateTz]=\"fromDateTz\"\n                [can_pick_today]=\"false\"\n                [timezone]=\"timezone_value\"\n                (onSelect)=\"applyDatePickerValue($event)\"\n            >\n            </date-tz-date-picker>\n        </div>\n    </div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { BookingCalendarWrapperComponent } from './booking-calendar-wrapper.component';\n\n\nconst routes: Routes = [\n    { path: '', component: BookingCalendarWrapperComponent },\n    { path: ':level', component: BookingCalendarWrapperComponent },\n    { path: '**', redirectTo: '' }\n];\n\n@NgModule({\n    imports: [RouterModule.forChild(routes)],\n    exports: [RouterModule],\n})\nexport class BookingCalendarRoutingModule {}\n","import {\n    Component,\n    OnInit,\n    ViewEncapsulation\n} from '@angular/core';\nimport { ActivatedRoute, GuardsCheckEnd, NavigationEnd, NavigationStart, Router } from '@angular/router';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport {\n    ApplicationService,\n    BookingFormData,\n    BookingsService,\n    Building,\n    OrganisationService,\n    SettingsService,\n    SpacesService,\n    selectActiveForm\n} from '@mckinsey-converge/data-common';\nimport { Store, select } from '@ngrx/store';\nimport { distinctUntilChanged, first } from 'rxjs/operators';\n\nimport { RoutePayload, TopBarHeaderMode } from 'src/app/components/topbar-header/topbar-header.component';\nimport { RoomResultsState } from '../room-details/room-details.component';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\n@Component({\n    selector: 'booking-calendar-wrapper',\n    templateUrl: './booking-calendar-wrapper.html',\n    styleUrls: ['./booking-calendar.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class BookingCalendarWrapperComponent extends BaseDirective implements OnInit {\n    public TopBarHeaderMode = TopBarHeaderMode;\n\n    public backRoute: RoutePayload = {\n        route: ['/home', 'results'],\n        queryParams: { display: 'list' },\n    };\n    orgBuildings: Building[] = [];\n    \n    constructor(\n        private _org: OrganisationService,\n        private _spaces: SpacesService,\n        private _bookings: BookingsService,\n        private settingService: SettingsService,\n        private store: Store<RoomResultsState>,\n    ) {\n        super();\n\n        \n    }\n\n    public ngOnInit(): void {\n        /** allow booking bypass to receive bookings for staff calendar view only */\n        this.settingService.bypass_bookings = true;\n\n        this.orgBuildings = this._org.buildings;\n\n        this.subscription('activeForm', this.store.pipe(\n            select(selectActiveForm),\n            distinctUntilChanged()\n          ).subscribe((next: BookingFormData | undefined) => {\n            if (next && next?.dateTz) {\n                localStorage.setItem('CONCIERGE.date', `${next.dateTz.ms}`);\n                localStorage.setItem('CONCIERGE.timezone', `${next.timezone}`);\n              const building = this._org.buildings.find(\n                 (_) => _.id === next.location.filter(el => el.groupChild)[0]?.meta?.building?.id\n                );\n                if(building) {\n                    this._org.building = building;\n                }\n                \n            }\n          }));\n\n          this._org.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.orgBuildings = this._org.buildings;\n          })\n\n          \n    }\n\n    public onBackCallback() {}\n\n    public ngOnDestroy(): void {\n         /** disallowed booking bypass when you are moving from staff app calendar view*/\n         this.settingService.bypass_bookings = false;\n    }\n\n}\n","<div class=\"mck-column mck-content-expand mck-content-page-container \" >\n\t<header class=\"header\">\n\t\t<a-topbar-header [mode]=\"TopBarHeaderMode.Light\"\n\t\t\t(onBack)=\"onBackCallback()\"\n      [back]=\"backRoute\"> \n\t\t</a-topbar-header>\n\t</header>\n\t<staff-calendar *ngIf=\"orgBuildings.length\"></staff-calendar>\n\t\n</div>","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule,  ReactiveFormsModule } from '@angular/forms';\n\nimport { BookingCalendarWrapperComponent } from './booking-calendar-wrapper.component';\n\nimport { StaffCalendarComponent } from './staff-calendar/staff-calendar.component';\nimport { CalendarDateWidgetComponent } from './booking-calendar-date-widget/calendar-date-widget.component';\nimport { DayViewTimelineComponent } from './staff-calendar/timeline/timeline.component';\nimport { DayViewSpaceComponent } from './staff-calendar/space/space.component';\nimport { DayViewSpaceEventComponent } from './staff-calendar/space/event/event.component';\n\n\nimport { BookingCalendarRoutingModule } from './booking-calendar-routing.module';\nimport { SharedContentModule } from 'src/app/shared/shared.module';\nimport { UiModule } from '@mckinsey-converge/ui';\n\nimport {CngMenuItemComponent} from './cng-menu-item/cng-menu-item.component';\n\nexport const bookingModuleDeclarations = [\n    BookingCalendarWrapperComponent,\n    StaffCalendarComponent,\n    CalendarDateWidgetComponent,\n    DayViewTimelineComponent,\n    DayViewSpaceComponent,\n    DayViewSpaceEventComponent,\n    CngMenuItemComponent\n   ];\n\nexport const bookingModuleImports = [\n    CommonModule,FormsModule,\n    ReactiveFormsModule,\n    SharedContentModule,\n    UiModule,\n    \n   \n];\n\n\n@NgModule({\n    declarations: [...bookingModuleDeclarations],\n    imports: [\n        ...bookingModuleImports,\n        BookingCalendarRoutingModule,\n        // StoreModule.forFeature('bookingForm', bookingFormReducer)\n    ]\n})\nexport class BookingCalendarModule {\n}","import {Component, EventEmitter, Input, OnInit, Output, ViewChild} from '@angular/core';\nimport {Router} from '@angular/router';\nimport {NavItem} from './nav-item';\nimport { MatMenu } from '@angular/material/menu';\n\n@Component({\n  selector: 'cng-menu-item',\n  templateUrl: './cng-menu-item.component.html',\n  styleUrls: ['./cng-menu-item.component.scss']\n})\nexport class CngMenuItemComponent implements OnInit {\n  @Input() items: NavItem[];\n  @Input() activeOption: string;\n  @ViewChild('childMenu', {static: true}) public childMenu: any;\n\n  @Output() public onChildSelect = new EventEmitter<{}>();\n  \n  constructor(public router: Router) {\n  }\n\n  ngOnInit() {\n  }\n\n  public notifySelection(node) {\n    this.onChildSelect.emit(node);\n  }\n}\n","<mat-menu #childMenu=\"matMenu\" [overlapTrigger]=\"false\" >\n    <ng-container *ngFor=\"let child of items\">\n      <!-- Handle branch node menu items -->\n      <ng-container *ngIf=\"child.children && child.children.length > 0\">\n        <button mat-menu-item   [matMenuTriggerFor]=\"menu.childMenu\"  [ngClass]=\"{'focus': child.displayName === activeOption }\">\n          <mat-icon>{{child.iconName}}</mat-icon>\n          <span>{{child.displayName}}</span>\n        </button>\n        <cng-menu-item #menu [items]=\"child.children\"  (onChildSelect)=\"notifySelection($event)\"></cng-menu-item>\n      </ng-container>\n      <!-- Handle leaf node menu items -->\n      <ng-container *ngIf=\"!child.children || child.children.length === 0\">\n        <button mat-menu-item [routerLink]=\"child.route\" (click)=\"notifySelection(child)\">\n          <mat-icon>{{child.iconName}}</mat-icon>\n          <span>{{child.displayName}}</span>\n        </button>\n      </ng-container>\n    </ng-container>\n  </mat-menu>\n  ","import {\n    Component,\n    OnInit,\n    Input,\n    OnChanges,\n    SimpleChanges,\n    Output,\n    EventEmitter,\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n} from '@angular/core';\nimport { Router } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { Space, BOOKING_STATUS, CloseDialogService, DialogIds, BookingStoreState, User } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { CateringOrder } from '@mckinsey-converge/data-common';\n\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { RoomStoreState } from '@mckinsey-converge/rooms';\nimport { BuildingStoreState } from '@mckinsey-converge/buildings';\nimport { UserStoreState, selectCurrentUser } from '@mckinsey-converge/user';\nimport { Store } from '@ngrx/store';\nimport { take } from 'rxjs/operators';\n\n/** Details about the associated event overlapping with other events */\nexport interface IEventOverlap {\n    /** Index of this item with the overlapping items */\n    index: number;\n    /** Total number of items overlapping with this one */\n    total: number;\n}\nexport interface BookingDetailInfo {\n    bookedBy: {\n        display:boolean,\n        value: string\n    }\n}\nexport type RoomResultsState = BookingStoreState\n  & RoomStoreState\n  & BuildingStoreState\n  & UserStoreState;\n  \n@Component({\n    selector: 'day-view-space-event',\n    templateUrl: './event.component.html',\n    styleUrls: ['./event.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class DayViewSpaceEventComponent extends BaseDirective implements OnInit, OnChanges {\n    /** Event to display */\n    @Input() public booking: Booking;\n    /** Date to display bookings for */\n    @Input() public dateTz: DateTZ = DateNow(new Date());\n    /** Space associated with the booking */\n    @Input() public space: Space;\n    /** Whether the item is a fixed size */\n    @Input() public fixed: boolean;\n    /** Overlap details for the booking */\n    @Input() public overlap: IEventOverlap;\n    /** Whether an action is being processed for this booking */\n    @Input() public loading: boolean;\n    /** Emitter for the current position of the booking within the timeline */\n    @Output() public position = new EventEmitter<{ top: number; height: number }>();\n\n    /** Position of the booking start time in the day */\n    public top: number;\n    /** Position of the booking relative to overlapping bookings */\n    public left: number;\n    /** Height based of the duration of the booking */\n    public height: number;\n    /** Size of the booking when overlapping with other bookings */\n    public width: number;\n    /** Offset from the booking's top that the setup time starts */\n    public overflow_top: number;\n    /** Offset from the booking's bottom that the breakdown time ends */\n    public overflow_bottom: number;\n\n    public approved: boolean;\n    public declined: boolean;\n    public bookingDetails: BookingDetailInfo;\n    currentUser: User;\n    constructor(\n        private _service: ApplicationService,\n        public store: Store<RoomResultsState>,\n        private _dialog: MatDialog,\n        private _router: Router,\n        private cdRef: ChangeDetectorRef,\n        private closeDialogService: CloseDialogService\n    ) {\n        super();\n    }\n\n    ngOnInit(): void {\n        this.subscription('currentUser', this.store.select(selectCurrentUser)\n            .pipe(take(1))\n            .subscribe((user: User | undefined) => {\n            // Once we know we have the user loaded.\n            this.currentUser = new User(user);\n            })\n        );\n\n        this.approved = this.booking.status === BOOKING_STATUS.approved;\n        this.declined = this.booking.status === BOOKING_STATUS.declined;\n        // test comment\n        const {creator, organiser, booker_concierge} = this.booking;\n        this.bookingDetails = {\n            bookedBy: {\n                display: creator && ( creator.email !== organiser.email || (creator.email === organiser.email && booker_concierge !== null && organiser.email !==booker_concierge['email']) ),\n                value: (creator.email === organiser.email && booker_concierge !== null && organiser.email !==booker_concierge['email']) ?  booker_concierge['name'] || booker_concierge['email']  :  creator?.name || creator.email\n            }\n        }\n    }\n\n    public get local_id(): string {\n        return this.booking.icaluid.substr(0, 6);\n    }\n\n    /** Type of booking */\n    public get type(): string {\n        const userEmail = this.currentUser.email;\n        const { creator, organiser } = this.booking;\n        if(userEmail === creator.email || userEmail === organiser.email) \n            return this.booking.getType();\n        else \n            return 'others-booking';\n    }\n\n    /** Period that the booking will occur during the day */\n    public get period(): string {\n        // the booking time is being pass in as the local timezone version.\n        return this.booking.time_period;\n    }\n\n    /** Number attendees expected to turn up to the booking */\n    public get expected(): number {\n        const expected = this.booking.expected_attendees;\n        return this.space ? expected[this.space.email] || 0 : 0;\n    }\n\n    /** Whether the meeting has catering attached */\n    public get has_catering(): boolean {\n        return !!this.order;\n    }\n\n    public get order(): CateringOrder {\n        return this.booking.catering.find((order) => order.location_id === this.space.email);\n    }\n\n    /** Whether booking is active */\n    public get active(): boolean {\n        const booking = this._service.get('CONCIERGE.day_view.viewing');\n        return !booking || booking.id === this.booking.id;\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.booking || changes.overlap || changes.dateTz) {\n            this.calculatePosition();\n            this.approved = this.booking.status === BOOKING_STATUS.approved;\n            this.declined = this.booking.status === BOOKING_STATUS.declined;\n        }\n    }\n\n    /** Store the order details for viewing in another component */\n    public storeOrder(order: CateringOrder) {\n        const booking_details = this.booking.toApiJSON();\n        localStorage.setItem('CONCIERGE.view_order', JSON.stringify(order.toJSON()));\n        localStorage.setItem('CONCIERGE.view_booking', JSON.stringify(booking_details));\n        localStorage.setItem('CONCIERGE.date', `${this.booking.startDateTz.ms}`);\n        localStorage.setItem('CONCIERGE.timezone', `${this.booking.startDateTz.building_tz}`);\n    }\n\n    /**\n     * View catering order for the booking\n     */\n    public viewOrder(order: CateringOrder) {\n        /* istanbul ignore else */\n        if (this.booking && this.booking.catering) {\n            /* istanbul ignore else */\n            if (localStorage) {\n                this.storeOrder(order);\n            }\n            this._router.navigate(['/catering', 'orders'], {\n                queryParams: { booking: this.booking.id, view: order.id },\n            });\n        }\n    }\n\n    /** Calculate the position */\n    private calculatePosition() {\n        /* istanbul ignore else */\n        if (this.booking) {\n            const overlap = this.overlap || { index: 0, total: 1 };\n            const shown_date = this.dateTz.startOfValue('day');\n            const date = this.booking.startDateTz.startOfValue('minute');\n            const end = this.booking.endDateTz.startOfValue('minute');\n            const from_previous_day = !date.isSameDate(shown_date, 'day');\n            if (end.isBeforeDate(shown_date, 'day')) { // Hide booking if not on shown date\n                this.top = -100;\n                this.height = 1;\n                return;\n            }\n\n            //R-- Stragest thing, but one time this was logging bookings form different timezones?\n            // this.dateTz.logDateTz('calculatePosition this.dateTz')\n            // this.booking.startDateTz.logDateTz('calculatePosition this.booking.startDateTz')\n\n            const start = from_previous_day ? 0 : Math.abs(+date.dateDiff(shown_date, 'hours', 'hours').toFixed(3));\n            const duration = Math.min(\n                this.booking.duration,\n                Math.abs(shown_date.dateDiff(date.addValue({ minutes: this.booking.duration }), 'minutes'))\n            );\n            this.top = Math.max(0, (start / 24) * 100);\n            this.height = Math.min(\n                100 - this.top,\n                this.fixed ? duration / 60 : (duration / 60 / 24) * 100\n            );\n            this.position.emit({ top: this.top, height: (duration / 60 / 24) * 100 });\n            this.width = Math.min(100, 100 / overlap.total + 5);\n            this.left = Math.min(100 - this.width, this.width * overlap.index - 5 * overlap.index);\n            this.overflow_top =\n                (this.booking.setup[this.space.email]\n                    ? (this.booking.setup[this.space.email] / 60) / duration\n                    : -0.1) * 100;\n            this.overflow_bottom =\n                (this.booking.breakdown[this.space.email]\n                    ? (this.booking.breakdown[this.space.email] / 60) / duration\n                    : -0.1) * 100;\n            if (this.booking.all_day) {\n                this.top = 0;\n                this.height = 100;\n            }\n        }\n    }\n\n    public get emailURL() {\n        const userEmail = this.currentUser.email;\n        const userName = this.currentUser.name\n        const { creator, organiser } = this.booking;\n\t\treturn `mailto:${encodeURIComponent(organiser.email)}?cc=${encodeURIComponent(userEmail)}&subject=Request%20to%20release%20room%20reservation%20-%20${encodeURIComponent(this.space.simple_name)}`;\n\t}\n\n    /** Whether booking has been ended */\n    public expired(): boolean {\n        return ['started','in_progress','expired_yesterday', 'done'].includes(this.booking.timeBasedStatusLabel);\n    }\n}\n","<div\n    class=\"event-container\"\n    [id]=\"'event-' + local_id\"\n    *ngIf=\"booking\"\n    [class.fixed]=\"fixed\"\n    [style.top]=\"top + '%'\"\n    [style.left]=\"left + '%'\"\n    [style.width]=\"fixed ? '15rem' : width + '%'\"\n    [style.height]=\"fixed ? height * 3 + 'rem' : height + '%'\"\n>\n    \n    <div\n        [class]=\"'overflow' + (type ? ' staff-' + type : '')\"\n        [style.top]=\"-overflow_top + '%'\"\n        [style.bottom]=\"-overflow_bottom + '%'\"\n    ></div>\n    <div\n        [class]=\"'event' + (type ? ' staff-' + type : '') + (top > 50 ? ' low' : '')\"\n        [style.z-index]=\"(overlap?.index || 0) + 2\"\n        \n    >\n        <div class=\"header\">\n            <div class=\"text\">{{ booking.all_day ? 'All Day' : period }}</div>\n            <div class=\"handle\"  *ngIf=\"type === 'your-booking'\">\n                <app-icon\n                    *ngIf=\"!loading && (declined || approved)\"\n                    [icon]=\"{\n                        class: 'material-icons',\n                        content: approved ? 'done' : declined ? 'event_busy' : ''\n                    }\"\n                >\n\n                </app-icon>\n                <mat-spinner *ngIf=\"loading\" diameter=\"16\"></mat-spinner>\n            </div>\n        </div>\n        <div class=\"body\">\n            <div class=\"field host\">\n                <div class=\"label\">Host:&nbsp;</div>\n                <div class=\"value\" [title]=\"'Host: ' + (booking.organiser?.name || booking.organiser)\">\n                    {{ booking.organiser?.name || booking.organiser }}\n                </div>\n            </div>\n            <div\n                class=\"field booked-by\" *ngIf=\"bookingDetails?.bookedBy?.display\" >\n                <div class=\"label\">Booked by:&nbsp;</div>\n                <div class=\"value\" [title]=\"'Booked By: ' + (bookingDetails.bookedBy.value)\">\n                    {{ bookingDetails.bookedBy.value }}\n                </div>\n            </div>\n            <div *ngIf=\"type !== 'others-booking'\">\n                <div class=\"field\">\n                    <div class=\"value\" [title]=\"'Title: ' + booking.title\">{{ booking.title }}</div>\n                </div>\n                <div class=\"field\">\n                    <div class=\"value\">\n                        {{ booking.attendees ? booking.attendees.length || 'No' : 'No' }} Attendee{{\n                            booking.attendees?.length === 1 ? '' : 's'\n                        }}{{ expected ? '(' + expected + ' Expected)' : '' }}\n                    </div>\n                </div>\n                <div class=\"field\" *ngIf=\"booking.company.length > 0\">\n                    <div class=\"value\">\n                        Company: {{ booking.company.length }}\n                    </div>\n                </div>\n                <div class=\"field\" *ngIf=\"booking.organiser?.name || booking.organiser\"\n                    [title]=\"'Welcomed by: ' + booking.organiser.name || booking.organiser\">\n                    <div class=\"value\">Welcomed by: {{ booking.organiser?.name || booking.organiser }}</div>\n                </div>\n                <div class=\"field\" *ngIf=\"has_catering\">\n                    <div class=\"value\">Catered</div>\n                </div>\n            </div>\n            \n        </div>\n    </div>\n    <button  *ngIf=\"type === 'others-booking'\"\n        class=\"catering-icon\"\n        mat-icon-button\n        name=\"view-catering\"\n        trigger=\"hover\" \n        [tooltip]=\"['Reach out to the host to inquire about releasing the room reservation.']\" \n        position=\"below\"\n        [show]=\"!expired()\"\n        [disabled]=\"expired() \"\n    >\n\n        <a style=\"display: flex;\" \n        [ngStyle]=\"{ 'pointer-events': expired() ? 'none' : 'initial', 'cursor': expired() ? 'default' : 'pointer' }\"\n        \n            mat-icon-button\n            target=\"_blank\"\n            [href]=\"emailURL\">\n                <app-icon [icon]=\"{ class: 'material-icons', content: 'mail' }\"></app-icon>\n            </a>\n    </button>\n</div>\n","import {\n    Component,\n    OnChanges,\n    Input,\n    SimpleChanges,\n    Output,\n    EventEmitter,\n    ViewChild,\n    ElementRef,\n    OnInit,\n    ChangeDetectorRef,\n} from '@angular/core';\nimport { CdkDragMove, CdkDragDrop } from '@angular/cdk/drag-drop';\nimport { MatDialog } from '@angular/material/dialog';\nimport { first } from 'rxjs/operators';\n\nimport { IEventOverlap } from './event/event.component';\nimport { BaseDirective, closestToTimeSlotTz, Identity } from '@mckinsey-converge/base';\nimport { OrganisationService, Space } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { ConfirmModalComponent } from '@mckinsey-converge/legacy-overlays';\nimport { DialogEvent, HashMap } from '@mckinsey-converge/base';\nimport { DayViewSettings } from '@mckinsey-converge/data-common';\nimport { SpacesService } from '@mckinsey-converge/data-common';\nimport { BookingsService } from '@mckinsey-converge/data-common';\n\nimport { BookingStateService } from '@mckinsey-converge/data-common';\nimport { convertTimezonedTimestampToLocalDateTz, DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n// import { BookingModalComponent } from 'src/app/bookings/booking-modal/booking-modal.component';\n\n@Component({\n    selector: 'day-view-space',\n    templateUrl: './space.component.html',\n    styleUrls: ['./space.component.scss'],\n})\nexport class DayViewSpaceComponent extends BaseDirective implements OnInit, OnChanges {\n    /** List of space dropzones connected to */\n    @Input() public space_list: string[];\n    /** Date to display events for */\n    @Input() public dateTz: DateTZ;\n    /** Space to display events for */\n    @Input() public space: Space;\n    /** Scroll value of the day view */\n    @Input() public scroll: number;\n    /** Only show events with setup and/or breakdown times */\n    @Input() public overflow_only: boolean;\n    /** Mapping of whether to show events with a given legend id */\n    @Input() public legend: HashMap<boolean> = {};\n    /** Scroll value to add to drop placeholders */\n    @Input('scrollTop') public scroll_top: number;\n    /** Last update time of the displayed bookings */\n    @Input('lastUpdate') public last_update: number;\n\n    @Input() public eventMovingLoader :  HashMap<boolean> = {};\n    /** Emitter for whether the space column is in view */\n    @Output() public inView = new EventEmitter<boolean>();\n    /** Emitter for whether an event is being dragged */\n    @Output() public dragging = new EventEmitter<boolean>();\n    /** Emitter for whether an event is being dropped and moving in progress */\n    @Output() public moving = new EventEmitter<{}>();\n    /** List of bookings for the current date and space */\n    public event_list: Booking[] = [];\n    /** Mapping of event IDs to overlap details */\n    public overlap_details: HashMap<IEventOverlap> = {};\n    /** Mapping of positions of event in the day */\n    public position_list: HashMap<{ top: number; height: number }> = {};\n    /** Override for mapped position */\n    public top: number;\n    /** Client Rectangle for the container element box */\n    public box: ClientRect;\n    /** Whether the space list is in view */\n    public in_view: boolean;\n    /** ID of the booking with an action processing */\n    public override_state: string;\n    /** Map of bookings to whether they are loading */\n    public loading: HashMap<boolean> = {};\n    /** Settings for day view */\n    public settings: DayViewSettings = {} as any;\n\n    /** Container element for the component contents */\n    @ViewChild('view', { static: true }) private view: ElementRef<HTMLDivElement>;\n\n    /** List of timeblocks to display */\n    public time_blocks: Identity[] = this.generateTimeBlocks();\n\n    /** Generate time blocks to display on the day view */\n    private generateTimeBlocks(): Identity[] {\n        const blocks: Identity[] = [];\n        const date = DateNow(new Date()).startOfValue('hour');\n        for (let i = 0; i < 24; i++) {\n            blocks.push({\n                id: date.setValue({ hour: i }).formatDate('HH:mm'),\n                name: date.setValue({ hour: i }).formatDate('h:mma').toLocaleLowerCase(),\n            });\n        }\n        return blocks;\n    }\n    constructor(\n        private _service: ApplicationService,\n        private _spaces: SpacesService,\n        private _booking_state_service: BookingStateService,\n        private _bookings: BookingsService,\n        private _dialog: MatDialog,\n        private cdr: ChangeDetectorRef,\n        private _org: OrganisationService,\n    ) {\n        super();\n    }\n\n    /** Events to display for the active date */\n    public  events: Booking[]  = []\n\n    public ngOnInit(): void {\n        this.events = this.filterEvents();\n        this._service.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.settings = this._service.setting('app.day_view') || {};\n            // this.subscription(\n            //     'breakdown',\n            //     this._service\n            //         .listen('APP.breakdown')\n            //         .subscribe((state) => {\n            //             this.overflow_only = state;\n            //             this.events = [...this.filterEvents()];\n            //         })\n            // );\n            // this.subscription(\n            //     'legend',\n            //     this._service\n            //         .listen('CONCIERGE.legend')\n            //         .subscribe((state) => (this.legend = state || {}))\n            // );\n            this.subscription(\n                'bookings',\n                this._booking_state_service.filtered.subscribe((list) => {\n                    this.event_list = [...list];\n                    this.events = [...this.filterEvents()];\n                    this.cdr.detectChanges();\n                })\n            );\n            this.checkInView();\n        });\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.scroll) {\n            this.checkInView();\n        }\n        if (changes.space) {\n            this.event_list = [...this.event_list];\n            this.timeout('in_view', () => this.checkInView(), 100);\n        }\n        /* istanbul ignore else */\n        if (changes.last_update) {\n            this.timeout('update_overlaps', () => this.calculateOverlaps(), 1000);\n        }\n    }\n\n    private filterEvents(): Booking[] {\n        if (this.space) {\n            const bookings = this.event_list;\n            const list = bookings.filter((event) => {\n            if (this.override_state && this.override_state === event.icaluid) {\n                this.loading[event.id] = true;\n            }\n\n            const ignore = event.is_recurrent && event.recurrence_type === 'master';\n\n            return (\n                    !ignore && !event.declined && // filtered declied bookings\n                    event.room.email === this.space.email &&\n                    (!this.overflow_only ||\n                        event.setup[event.room.email] ||\n                        event.breakdown[event.room.email])\n                );\n            }).map(e => new Booking({...e.toJSON()})  );\n\n            return list;\n        }\n        return [];\n    }\n\n    /* istanbul ignore next */\n    /**\n     * Track by function for ngFor optimisation\n     * @param index Index of the item\n     * @param item Data associated with the item at the given index\n     */\n    public trackByFn(index: number, item: Booking) {\n        return item.id || index;\n    }\n\n    /**\n     * Calculate to overlap details for the booking events on the space\n     */\n    private calculateOverlaps() {\n        const events = this.events.sort(\n            (a, b) =>\n                a.startDateTz.ms - b.startDateTz.ms ||\n                a.duration - b.duration ||\n                (a.title || '').localeCompare(b.title || '')\n        );\n        events.forEach((i) => (this.overlap_details[i.id] = { index: 0, total: 1 }));\n        for (const bkn of events) {\n            const bkn_start = bkn.startDateTz.startOfValue('minute');\n            const bkn_end = bkn.endDateTz.startOfValue('minute');\n            let count = 1;\n            let index = 0;\n            const collisions: Booking[] = [];\n            for (const cmp of events) {\n                /* istanbul ignore else */\n                if (bkn.id !== cmp.id) {\n                    const cmp_start = cmp.startDateTz.startOfValue('minute');\n                    const cmp_end = cmp.endDateTz.startOfValue('minute');\n                    /* istanbul ignore else */\n                    if (\n                        bkn_start.isSameDate(cmp_start, 'minute') ||\n                        (bkn_start.isAfterDate(cmp_start)  && bkn_start.isBeforeDate(cmp_end)) ||\n                        bkn_end.isSameDate(cmp_end, 'minute') ||\n                        (bkn_end.isAfterDate(cmp_start) && bkn_end.isBeforeDate(cmp_end))\n                    ) {\n                        count++;\n                        collisions.push(bkn);\n                        /* istanbul ignore else */\n                        if (\n                            events.findIndex((i) => i.id === bkn.id) >\n                            events.findIndex((i) => i.id === cmp.id)\n                        ) {\n                            index++;\n                        }\n                    }\n                }\n            }\n            this.overlap_details[bkn.id] = { index: Math.max(0, index), total: count };\n        }\n    }\n\n    /**\n     * Check whether the space column is with the view of the\n     */\n    private checkInView() {\n        /* istanbul ignore else */\n        if (this.view && this.view.nativeElement) {\n            const el = this.view.nativeElement;\n            this.in_view =\n                el.offsetLeft + this.scroll >= -240 &&\n                el.offsetLeft + this.scroll <= window.innerWidth;\n            this.inView.emit(this.in_view);\n        }\n    }\n\n    /**\n     * Initialise drag events\n     */\n    public initDrag() {\n        this.box = this.view.nativeElement.getBoundingClientRect();\n        this.dragging.emit(true);\n    }\n\n    /**\n     * Cleanup after drag\n     */\n    public endDrag() {\n        this.timeout('end_drag', () => (this.top = 0), 10);\n        this.dragging.emit(false);\n    }\n\n    /**\n     * Update top position of the dragged event placeholder\n     * @param booking Booking being dragged\n     * @param event Drag event\n     */\n    public updateDragTop(event: CdkDragMove<Booking>) {\n        /* istanbul ignore else */\n        if (event.delta.y) {\n            const y = event.pointerPosition.y;\n            const top = (y - this.box.top - this.scroll_top) / this.box.height;\n            const top_minutes = (Math.round((top * 24 * 60) / 15) * 15) / 60;\n            this.top = (top_minutes / 24) * 100;\n\n        }\n    }\n\n\n\n\n\n    public checkAvailabilityOnGivenTime(selectedBlockStart, selectedBlockEnd) {\n        const runningBookings =\n            this.events?.filter((bks) => {\n                const startEpoch = new DateTZ({\n                    date: bks.start_epoch * 1000,\n                    is_local_tz: false,\n                    building_tz: bks.timezone,\n                }).ms;\n                const endEpoch = new DateTZ({\n                    date: bks.end_epoch * 1000,\n                    is_local_tz: false,\n                    building_tz: bks.timezone,\n                }).ms;\n                const hasValidBreakdown: boolean =\n                    bks.breakdown &&\n                    Object.values(bks.breakdown).some((value) => value !== null);\n                if (selectedBlockStart.ms === endEpoch && hasValidBreakdown) {\n                    return true;\n                } else\n                    return (\n                        (selectedBlockStart.ms >= startEpoch && selectedBlockStart.ms < endEpoch) ||\n                        (selectedBlockEnd.ms > startEpoch && selectedBlockEnd.ms < endEpoch)\n                    );\n            }) || [];\n        return !!runningBookings.length;\n    }\n\n\t\t/** Whether booking has been ended */\n    public expired(booking): boolean {\n\t\t\treturn booking.timeBasedStatusLabel === 'done';\n\t\t}\n\n\t\t\n}\n","<div\n\tclass=\"space-display\"\n\t#view\n\tcdkDropList\n\tcdkDropListSortingDisabled\n\t[cdkDropListConnectedTo]=\"space_list || []\"\n\t[cdkDropListData]=\"{ top: top, list: events }\"\n\tscrollContainer=\"#day-view-scroll\"\n\t[id]=\"'space-col-' + space?.id\">\n\n    <div class=\"time-lines\" [style.min-width]=\"'100%'\" >\n        <div class=\"block\"  *ngFor=\"let item of time_blocks\">\n            <div class=\"line\"></div>\n        </div>\n    </div>\n\n    <!-- <div class=\"drop-zone\" cdkDrag></div> -->\n    <div\n        [style.display]=\"in_view !== false ? '' : 'none'\"\n        *ngFor=\"let item of events; trackBy: trackByFn\"\n        cdkDrag\n        (cdkDragStarted)=\"initDrag()\"\n        (cdkDragMoved)=\"updateDragTop($event)\"\n        (cdkDragReleased)=\"endDrag()\"\n        [id]=\"item?.id\"\n        [cdkDragDisabled]=\" expired(item) ||  item.declined || !settings.dragdrop \"\n    >\n        <day-view-space-event\n            [space]=\"space\"\n            [dateTz]=\"dateTz\"\n            [booking]=\"item\"\n            [loading]=\"eventMovingLoader ? eventMovingLoader[item.id] : null\"\n            [overlap]=\"overlap_details ? overlap_details[item.id] : null\"\n            (position)=\"position_list ? position_list[item.id] = $event : ''\">\n\t\t</day-view-space-event>\n        <div class=\"event-preview\" *cdkDragPreview>\n            <div class=\"content\">\n                <day-view-space-event\n                    [fixed]=\"true\"\n                    [space]=\"space\"\n                    [booking]=\"item\"\n                ></day-view-space-event>\n            </div>\n        </div>\n        <div class=\"event-placeholder\" *cdkDragPlaceholder\n            [style.top]=\"(top || (position_list[item.id] ? position_list[item.id].top : 0)) + '%'\" \n            [style.height]=\"(position_list[item.id] ? position_list[item.id].height : 100) + '%'\"></div>\n    </div>\n</div>\n\n","import { Component, Input, OnDestroy, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { first, take } from 'rxjs/operators';\n\nimport { BaseDirective, HashMap, Identity } from '@mckinsey-converge/base';\n// import { BookingModalComponent } from 'src/app/bookings/booking-modal/booking-modal.component';\n\nexport interface NavItem {\n\tdisplayName: string;\n\ticonName?: string;\n\troute?: string;\n\tmeta?:{}; \n\tchildren?: NavItem[];\n}\n\n\nimport {\n    ApplicationService,\n    BookingStateService,\n    BookingStoreState,\n    BuildingLevel,\n    OrganisationService,\n    selectBookingByIdResultsFromState,\n    User,\n    Booking,\n    SpacesService,\n    Space,\n    Building\n} from '@mckinsey-converge/data-common';\n\n\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { UserStoreState } from '@mckinsey-converge/user';\nimport { Store } from '@ngrx/store';\nimport { BuildingStoreState } from 'libs/buildings/src';\nimport { MyBookingsStoreState } from '@mckinsey-converge/bookings';\nimport { Subscription } from 'rxjs';\nimport { DropdownOpion } from '@mckinsey-converge/ui';\n\nexport type RoomBookingStoreState = BookingStoreState & BuildingStoreState & MyBookingsStoreState & UserStoreState;\n\n@Component({\n    selector: 'staff-calendar',\n    templateUrl: './staff-calendar.component.html',\n    styleUrls: ['./staff-calendar.component.scss']\n})\nexport class StaffCalendarComponent extends BaseDirective implements OnInit {\n    /** Currently selected date, starts out with no timezone data, gets updated later */\n    public dateTz: DateTZ = DateNow(new Date());\n\n    /** ID of the currently selected level */\n    public active_level: string = '';\n    /** ID of the currently selected type */\n    public active_type: string = '';\n    /** List of levels available for the active building */\n    public levels: BuildingLevel[] = [];\n    /** List of space types available for the active building */\n    public space_types: Identity[] = [];\n    /** Whether to show only items with a setup and/or breakdown time */\n    public only_overflow: boolean;\n   \n\n\t\tprivate spaceTypesSubscription: Subscription;\n\n\t\tevent_list: Booking[] = [];\n\t\tsearchStr: any;\n\t\tfoundSearchLength: number = 0;\n\t\tsearchedCounter: any = 1;\n\t\tshowSrchWarning: boolean;\n\t\ttotalFoundItem: number = 0;\n        spaces: Space[] = [];\n\t\tbuildingsInSameCity: Building[];\n\t\tbuildingMenuItems: NavItem[];\n\t\tactiveBuildingName: string;\n\t    levelsDD: any = [];\n\t    roomLevelDD: { ddBoxClass: string; options: any; defaultSelected: any; onChangeCallback: any; };\n        \n\n\n    constructor(\n        private _service: ApplicationService,\n        private _org: OrganisationService,\n        private _dialog: MatDialog,\n        private _router: Router,\n        private _route: ActivatedRoute,\n        private _booking_state_service: BookingStateService,\n        private _spaces: SpacesService,\n        private store: Store<RoomBookingStoreState>,\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._service.title = 'Day View';\n\n\t\t\t\tthis._org.initialised.pipe(first((_) => _)).subscribe(() => {\n            // Init dateTz here once the organization data is loaded.\n            this.dateTz = new DateTZ({ date: this.dateTz.ms, is_local_tz: false, building_tz: this.timezone });\n            this.subscription(\n                'route.params',\n                this._route.paramMap.subscribe((params) => {\n                    /* istanbul ignore else */\n                    if (params.has('level') && this.active_level !== params.get('level')) {\n                        const level = this._org.levelWithID(params.get('level'));\n                        /* istanbul ignore else */\n                        if (level) {\n                            const building = this._org.buildings.find(\n                                (bld) => bld.id === level.building_id\n                            );\n                            /* istanbul ignore else */\n                            if (building) {\n                                this.active_level = level.id;\n                                this._org.building = building;\n                                this._booking_state_service.setZone(this.active_level || this._org.building.id);\n                            }\n                        }\n                    }\n                })\n            );\n            this.subscription(\n                'building',\n                this._org.listen('active_building').subscribe(() => {\n                    this._booking_state_service.updateRoomList();\n                    // Update dateTz here when the building is changed.\n\t\t\t\t\t\t\t\t\t\tthis.dateTz = new DateTZ({\n\t\t\t\t\t\t\t\t\t\t\tdate: this.dateTz.ms,\n\t\t\t\t\t\t\t\t\t\t\tis_local_tz: false,\n\t\t\t\t\t\t\t\t\t\t\tbuilding_tz: this.timezone,\n\t\t\t\t\t\t\t\t\t\t});\n                    const building = this._org.building;\n\n                    /* istanbul ignore else */\n                    if (!building.levels.find((lvl) => lvl.id === this.active_level)) {\n                        this.active_level = building?.levels[0]?.id;\n                        this.updateLevel();\n                    }\n\t\t\t\t\t\t\t\t\t\tthis.initSpace();\n\n                    this.levels = [{ id: '', name: 'All Levels' } as any].concat(building.levels);\n\t\t\t\t\t\t\t\t\t\tthis.levels.sort((a, b) => b.name.localeCompare(a.name, undefined, {\n\t\t\t\t\t\t\t\t\t\t\t\tnumeric: true,\n\t\t\t\t\t\t\t\t\t\t\t\tignorePunctuation: true,\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t\tthis.levelsDD = [];\n\t\t\t\t\t\t\t\t\t\tthis.levels.forEach(el => {\n\t\t\t\t\t\t\t\t\t\t\tthis.levelsDD.push({\n\t\t\t\t\t\t\t\t\t\t\t\t display: el.name, value: el.id, meta: {} \n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\t\t\t\tthis.roomLevelDD = {\n\t\t\t\t\t\t\t\t\t\t\tddBoxClass: 'room-level',\n\t\t\t\t\t\t\t\t\t\t\toptions: this.levelsDD,\n\t\t\t\t\t\t\t\t\t\t\tdefaultSelected: this.levelsDD.filter(el => el.value ===  this.active_level )[0],\n\t\t\t\t\t\t\t\t\t\t\tonChangeCallback: this.onChangeActiveLevel.bind(this)\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\t\n\n\t\t\t\t\t\t\t\t\t\tthis.buildingsInSameCity = this._org.buildings.filter(\n\t\t\t\t\t\t\t\t\t\t\t(_) => _.city === building.city\n\t\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t\tthis.generateBuildingMenu();\n\n                    \n                })\n            );\n            \n        });\n\n        this.subscription(\n            'bookings',\n            this._booking_state_service.filtered.subscribe((list) => {\n                this.event_list = [...this.filterEvents(list)];\n\n            })\n        );\n    }\n\n    private filterEvents(list): Booking[] {\n\t\t\tconst bookings = list;\n\t\t\tconst filterd_booking = bookings.filter((event) => {\n\t\t\t\t\tconst ignore = event.is_recurrent && event.recurrence_type === 'master';\n\t\t\t\t\treturn ( !ignore );\n\t\t\t});\n\n\t\t\treturn filterd_booking || [];\n    }\n\n    public initSpace() {\n        this.subscription(\n            'spaces',\n            this._spaces.listen('list').subscribe((spaces) => {\n                const zone_id = !this.active_level ? this._org.building.id : this.active_level;\n                this.spaces = this._spaces.filter((_) => _.zones.indexOf(zone_id) >= 0 && _.bookable);\n            })\n        );\n    }\n\n    isIncludes = (item: any, field: string, searchVaue: string) => (item && item[field] && item[field].toLowerCase().includes(searchVaue));\n    \n    searchBooking(value) {\n\n        // Resetting warning flag\n       this.showSrchWarning = false;\n\n       // Converting search value to lower case for case-insensitive comparison\n       const searchValue = value.toLowerCase().trim();\n       \n       // Combining event list and space arrays into one arrya for searchig \n      const allItems = [...this.event_list, ...this.spaces];\n       // console.log('BOOKING : ',allItems[0]['organiser'])\n      // Filtering the combine array to find matching room or booking \n      const filteredItems = allItems.filter( (item: any ) => \n       this.isIncludes(item.creator, 'name', searchValue) ||\n       this.isIncludes(item.organiser, 'name', searchValue) ||\n       this.isIncludes(item, 'simple_name', searchValue) \n       );\n\n       // Updating the total number of found items in serach\n       this.totalFoundItem = filteredItems.length;\n\n       // Setting showSrchWarning flag if no result were found \n       this.showSrchWarning = !this.totalFoundItem;\n\n       // Updating lenght of found items for later use\n       this.foundSearchLength = this.totalFoundItem - 1;\n\n\n       if(this.searchStr !== value) {\n           // Setting the first found as the current viewing item\n           this._service.set('CONCIERGE.day_view.viewing', filteredItems[0]);\n           // Resetting the search counter\n           this.searchedCounter = 0;\n       }\n       else {\n           // Handling case where seached string is the same as previou one \n           // Incrementing search counter, loopoing back to 0 if it exceed the length of found items\n           this.searchedCounter = ( this.searchedCounter < this.foundSearchLength  ) ? this.searchedCounter + 1 : 0\n           // Setting the next found items as the current viewing item\n           this._service.set('CONCIERGE.day_view.viewing', filteredItems[this.searchedCounter]);\n       }\n\n       // Storing the current search string for future camparison\n       this.searchStr = value;\n    }\n\n\n    public ngOnDestroy(): void {\n        this._service.set('CONCIERGE.day_view.viewing', []);\n     }\n\n\n   \n\n    // that encapsulates the common elements.\n    public get timezone() {\n        return this._org.building?.timezone || localStorage.getItem('CONCIERGE.timezone');\n    }\n\n    public updateDateTz(dateTz: DateTZ) {\n        this.dateTz = dateTz;\n    }\n\n    public updateLevel() {\n        this._booking_state_service.setZone(this.active_level || this._org.building.id);\n\t\t\t\tthis.initSpace();\n        // this._router?.url?.includes('/booking-calendar') && this._router.navigate(['/home/results/booking-calendar', this.active_level], {relativeTo: this._route});\n    }\n\n\t\tpublic generateBuildingMenu() {\n\n\n\t\t\tif(this.buildingsInSameCity.length) {\n\n\t\t\t\tconst menuItem: NavItem[] = [{\n\t\t\t\t\tdisplayName: this._org.building.name,\n\t\t\t\t\ticonName: 'close',\n\t\t\t\t\tchildren:[]\n\t\t\t\t}];\n\n\n\t\t\t\tthis.buildingsInSameCity.forEach(el => {\n\t\t\t\t\tconst buildingLevels: NavItem[] = [];\n\n\t\t\t\t\tel.levels.forEach(lvl => buildingLevels.push({\n\t\t\t\t\t\tdisplayName: lvl.name,\n\t\t\t\t\t\tchildren: [],\n\t\t\t\t\t\tmeta: {\n\t\t\t\t\t\t\tlevel_id : lvl.id,\n\t\t\t\t\t\t\tbuilding_id: lvl.building_id\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t);\n\n\t\t\t\t\tbuildingLevels.push({ displayName: 'All Levels', children: [], meta: {\n\t\t\t\t\t\t\tlevel_id : '',\n\t\t\t\t\t\t\tbuilding_id: el.id\n\t\t\t\t\t\t} \n\t\t\t\t\t});\n\n\t\t\t\t\tmenuItem[0].children.push({\n\t\t\t\t\t\tdisplayName: el.name,\n\t\t\t\t\t\tchildren: buildingLevels,\n\t\t\t\t\t\tmeta: {\n\t\t\t\t\t\t\tbuilding_id: el.id\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t});\n\n\t\t\t\tthis.buildingMenuItems = menuItem;\n\n\t\t\t}\n\n\t\t\t\n\t\t}\n\n\t\tpublic updateActiveBuilding (node) {\n\t\t\t// console.log(node);\n\t\t\tconst building = this.buildingsInSameCity.filter(bld => bld.id === node.meta.building_id)[0];\n\t\t\tthis._org.building = building;\n\t\t\tthis.activeBuildingName = building.name;\n\n\t\t\n\t\t\t\tthis.levels = [{ id: '', name: 'All Levels' } as any].concat(building.levels);\n\t\t\t\tthis.levels.sort((a, b) => b.name.localeCompare(a.name, undefined, {\n\t\t\t\t\t\tnumeric: true,\n\t\t\t\t\t\tignorePunctuation: true,\n\t\t\t\t\t})\n\t\t\t\t);\n\n\n\t\t\t\tthis.active_level = node.meta.level_id;\n\t\t\t\tthis.roomLevelDD.defaultSelected = this.levelsDD.filter(el => el.value ===  this.active_level )[0];\n\t\t\t\tthis.updateLevel();\n\t\t}\n\n\t\tonChangeActiveLevel(level:any) {\n\t\t\tthis.active_level = level.value;\n\t\t\t\n\t\t\tthis.updateLevel();\n\n\t\t}\n\n\t\t\n}\n\n","<div class=\"staff-calendar\">\n    <div class=\"group\">\n       \n        <div class=\"topbar\">\n           \n            <div class=\" buildings-dd \">\n                <span *ngFor=\"let item of buildingMenuItems\">\n                    <!-- Handle branch node buttons here -->\n                    <span *ngIf=\"item.children && item.children.length > 0\">\n                    <div [matMenuTriggerFor]=\"menu.childMenu\" #t=\"matMenuTrigger\" class=\"cng-select flex-row\" [ngClass]=\"{'focus': t.menuOpen }\" matRipple >\n                        <span class=\"selected\" style=\"flex: 1 1 auto ;\">{{activeBuildingName || item.displayName}}</span>\n                        <div class=\"mck-column select-chevron\">\n                            <mck-chevron-icon [up]=\"t.menuOpen\" matSuffix fillClass=\"mck-icon-fill-black\"></mck-chevron-icon>\n                        </div>\n                      </div>\n                    <cng-menu-item #menu [items]=\"item.children\" [activeOption]=\"activeBuildingName\" (onChildSelect)=\"updateActiveBuilding($event)\"></cng-menu-item>\n                </span>\n                    <!-- Leaf node buttons here -->\n                    <!-- <span *ngIf=\"!item.children || item.children.length === 0\">\n                    <button mat-button color=\"primary\" [routerLink]=\"item.route\">\n                        {{item.displayName}}\n                    </button>\n                    </span> -->\n              </span>\n           </div>\n           \n            <cng-select [data]=\"roomLevelDD\" *ngIf=\"levels && levels.length > 1\"></cng-select>\n\n            <div class=\"cng-serach\" style=\"width: 100%;display: flex;\tflex:1;\tplace-content: center;\">\n                <mat-form-field [class.rounded]=\"true\" appearance=\"outline\" style=\"width: 24em\">\n                    <app-icon [icon]=\"{ class: 'material-icons', content: 'search' }\" matPrefix></app-icon>\n                    <input  #box  matInput class=\"seach-booking\" [(ngModel)]=\"searchStr\" (keyup.enter)=\"box.value !== '' && searchBooking(box.value)\" name=\"search-name\" placeholder=\"Search by booking host name or room name\" (ngModelChange)=\"showSrchWarning = false; totalFoundItem = 0\" />\n                    <div class=\"search-count\" *ngIf=\"searchStr && totalFoundItem\">{{ totalFoundItem }}</div>\n                    <button mat-icon-button matSuffix *ngIf=\"searchStr\" (click)=\"searchStr = ''; box.value = ''; showSrchWarning = false; totalFoundItem = 0 \">\n                        <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n                    </button>\n                    <div class=\"search-warning\" *ngIf=\"showSrchWarning && searchStr\">\n                        <app-icon [icon]=\"{ class: 'material-icons', type: 'img', src: 'assets/icon/warning-yellow.svg' }\"></app-icon>\n                        No search found!\n                    </div>\n                </mat-form-field>\n            </div>\n\n            \n            <calendar-date-widget\n                [(dateTz)]=\"dateTz\"\n                [timezone]=\"timezone\"\n                [zone]=\"active_level\"\n                [show_events]=\"true\"\n                [show_add_item]=\"true\"\n                [retainSelectedDate]=\"false\"\n                (dateChangeTz)=\"updateDateTz($event)\">\n            </calendar-date-widget>\n        \n        </div>\n\n        <main >\n            <day-view-timeline\n                [dateTz]=\"dateTz\"\n                [level]=\"active_level\"\n                [overflow_only]=\"only_overflow\"\n                [space_type]=\"active_type\"\n            ></day-view-timeline>\n        </main>\n    </div>\n</div>\n\n","import {\n    Component,\n    ElementRef,\n    HostListener,\n    Input,\n    OnChanges,\n    OnDestroy,\n    OnInit,\n    Renderer2,\n    SimpleChanges,\n    ViewChild, NgZone, DoCheck, ChangeDetectionStrategy, ChangeDetectorRef\n} from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { filter, first } from 'rxjs/operators';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { Space } from '@mckinsey-converge/data-common';\nimport { ApplicationService } from '@mckinsey-converge/data-common';\nimport { Booking } from '@mckinsey-converge/data-common';\nimport { HashMap, Identity } from '@mckinsey-converge/base';\n// import { MeetingDetailsModalComponent } from 'src/app/calendar/meeting-details-modal/meeting-details-modal.component';\nimport { SpacesService } from '@mckinsey-converge/data-common';\nimport { OrganisationService } from '@mckinsey-converge/data-common';\nimport { BookingStateService } from '@mckinsey-converge/data-common';\nimport { DateNow, DateTZ, toMiddayUTC } from '@mckinsey-converge/date-tz';\nimport { isToday } from 'date-fns';\nimport { CdkVirtualScrollViewport } from '@angular/cdk/scrolling';\n\n\n\nconst UPDATE_INTERVAL = 10;\n\n@Component({\n    selector: 'day-view-timeline',\n    templateUrl: './timeline.component.html',\n    styleUrls: ['./timeline.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class DayViewTimelineComponent\n    extends BaseDirective\n    implements OnInit, OnChanges, OnDestroy\n{\n    /** DateTZ object of the active date */\n    @Input() public dateTz: DateTZ = DateNow(new Date());\n    /** ID of the active level */\n    @Input() public level: string;\n    /** ID of the room type to filter displayed spaces by */\n    @Input() public space_type: string;\n    /** List of shown legend items */\n    @Input() public legend: HashMap<boolean> = {};\n    /** Whether to show only items with a setup and/or breakdown time */\n    @Input() public overflow_only: boolean;\n    /** Whether space bookings are being loaded */\n    @Input() public loading: boolean;\n\n    @Input() undo_action;\n\n    /** List of timeblocks to display */\n    public time_blocks: Identity[] = this.generateTimeBlocks();\n    /** Top value of the content scroll */\n    public scroll_top: number = 0;\n    /** Left value of the content scroll */\n    public scroll_left: number = 0;\n    /** Offset of the scroll value when starting a drag */\n    public scroll_offset: number = 0;\n    /** List of spaces to display for  */\n    public spaces: Space[] = [];\n    /** List of spaces to display for  */\n    public filtered_spaces: Space[] = [];\n    /** Mapping of space ids to whether they are in view */\n    public in_view: { [id: string]: boolean } = {};\n    /** Percent of the day that is now */\n    public now: number;\n    /** Currently active hour of the day */\n    public active_hour: string;\n    /** Mapping of spaces loading booking date */\n    public loading_space: { [id: string]: boolean } = {};\n    /** Booking ID to open modal for */\n    public view_id: string;\n    /** Last update time for the space bookings */\n    public last_update: number = 0;\n    /** Whether an event is being dragged */\n    public is_dragging: boolean;\n    /** Client rectangle for the scroll area */\n    public box: ClientRect;\n    /** Whether to show the holding bay */\n    // public show_holding_bay: boolean = true;\n\n    public space_zones: string[] = [];\n\n    public is_today: boolean = this.isToday();\n    public modalInitialized = false;\n\n    /** Scrollable area of the day view */\n    @ViewChild('scroll_area', { static: true }) private scroll_area: ElementRef<HTMLDivElement>;\n\n    @ViewChild(CdkVirtualScrollViewport) virtualScroll: CdkVirtualScrollViewport;\n    isEventMoving: boolean = false;\n    bookingEl: any;\n    timeoutID: any;\n    column: any;\n\n    /** Update scroll box when the window is resized */\n    @HostListener('window:resize')\n    public onResize() {\n        if (this.scroll_area['elementRef'].nativeElement) {\n            this.box = this.scroll_area['elementRef'].nativeElement.getBoundingClientRect();\n        }\n    }\n\n    public get is_loading() {\n        return this._booking_state_service.loading;\n    }\n\n    public isToday() {\n        return new DateTZ({\n            date: toMiddayUTC(this.dateTz).ms,\n            is_local_tz: false,\n            building_tz: this._org.building?.timezone || localStorage.getItem('CONCIERGE.timezone'),\n        }).isSameDate(\n            new DateTZ({\n                date: Date.now(),\n                is_local_tz: false,\n                building_tz: this._org.building?.timezone || localStorage.getItem('CONCIERGE.timezone'),\n            }),\n            'day'\n        );\n    }\n\n    constructor(\n        private _service: ApplicationService,\n        private _spaces: SpacesService,\n        private _booking_state_service: BookingStateService,\n        private _org: OrganisationService,\n        private _route: ActivatedRoute,\n        private _renderer: Renderer2,\n        private _dialog: MatDialog,\n        private _zone: NgZone,\n        private cdr: ChangeDetectorRef,\n    ) {\n        super();\n    }\n\n    public get holding_bay(): Space {\n        const bld = this._org.building;\n        /* istanbul ignore else */\n        if (bld && bld.holding_bay) {\n            return this._spaces.find(bld.holding_bay);\n        }\n        return null;\n    }\n\n    public ngOnInit(): void {\n        this._spaces.initialised.pipe(first((_) => _)).subscribe(() => {\n            this._org.initialised.pipe(first((_) => _)).subscribe(() => {\n                this._booking_state_service.startPollingEveryFiveMin();\n                const zone_id = !this.level ? this._org.building.id : this.level;\n                this.spaces = this._spaces.filter((_) => _.zones.indexOf(zone_id) >= 0);\n                this.init();\n                this.initSpaces();\n                // Update time\n                this.updateTime();\n                this._zone.runOutsideAngular(() => {\n                    this.interval('time', () => this.updateTime(), 15 * 1000);\n                });\n                // R--- return to see if the booking service needs updating\n                this.subscription(\n                    'dateTz',\n                    this._booking_state_service.dateTz.subscribe((dateTz) => {\n                        // const dateTz = new DateTZ({date});\n                        this.dateTz = dateTz;\n                    })\n                );\n            });\n        });\n        this.is_today = this.isToday();\n\n        this.subscription(\n            'spaces',\n            this._spaces.listen('list').subscribe((spaces) => {\n                const zone_id = !this.level ? this._org.building.id : this.level;\n                this.spaces = this._spaces.filter((_) => _.zones.indexOf(zone_id) >= 0);\n                this.init();\n                this.initSpaces();\n                // Update time\n                this.updateTime();\n            })\n        );\n\n    }\n\n    ngAfterViewInit() {\n        const d2 = this._renderer.createElement('div');\n        this._renderer.addClass(d2, 'adjustable-room-block-2');\n        this.virtualScroll.elementRef && this._renderer.appendChild(this.virtualScroll.elementRef.nativeElement, d2);\n      }\n\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        /* istanbul ignore else */\n        if (changes.level && this._org.building) {\n            const zone_id = !this.level ? this._org.building.id : this.level;\n            this.spaces = this._spaces.filter((_) => _.zones.indexOf(zone_id) >= 0);\n            this.updateTime();\n            this.initSpaces();\n        }\n        if (changes.space_type) {\n            this.initSpaces();\n        }\n    }\n\n    public ngOnDestroy() {\n        if (this._booking_state_service?.stopPolling) this._booking_state_service?.stopPolling();\n    }\n\n    public init() {\n        this._service.title = 'Day View';\n        this.subscription(\n            'viewing',\n            this._service\n                .listen('CONCIERGE.day_view.viewing')\n                .subscribe((event) => this.scrollIntoView(event) )\n        );\n        // Subscribe to route query changes\n        this.subscription(\n            'route.query',\n            this._route.queryParamMap.subscribe((params) => {\n                /* istanbul ignore else */\n                if (params.has('view') || localStorage.getItem('CONCIERGE.view_booking')) {\n                    this.view_id = params.get('view');\n                    const details = localStorage.getItem('CONCIERGE.view_booking');\n                    const spaceJson = localStorage.getItem('CONCIERGE.view_booking_space');\n                    /* istanbul ignore else */\n                    if (details) {\n                        const space: Space | undefined = spaceJson\n                            ? new Space(JSON.parse(spaceJson))\n                            : undefined;\n                        const booking = new Booking({ ...JSON.parse(details), room: space });\n                        if(!this.modalInitialized) {\n                            this.modalInitialized = true;\n                            // this.view(booking, space);\n                            localStorage.removeItem('CONCIERGE.view_booking');\n                            localStorage.removeItem('CONCIERGE.view_booking_space');\n                        }\n                    }\n                }\n            })\n        );\n        \n        /* istanbul ignore else */\n        if (this.scroll_area['elementRef'].nativeElement) {\n            this.box = this.scroll_area['elementRef'].nativeElement.getBoundingClientRect();\n        }\n    }\n\n    /**\n     * Update scroll parameters to match the change in the scroll position\n     * @param event\n     */\n    public updateScroll(event) {\n        this.scroll_top = event.target.scrollTop;\n        this.scroll_left = event.target.scrollLeft;\n    }\n\n\n\n    /** Generate time blocks to display on the day view */\n    private generateTimeBlocks(): Identity[] {\n        const blocks: Identity[] = [];\n        const date = DateNow(new Date()).startOfValue('hour');\n        for (let i = 0; i < 24; i++) {\n            blocks.push({\n                id: date.setValue({ hour: i }).formatDate('HH:mm'),\n                name: date.setValue({ hour: i }).formatDate('h:mma').toLocaleLowerCase(),\n            });\n        }\n        return blocks;\n    }\n\n    /** Update the now line position */\n    private updateTime() {\n        const now = new DateTZ({\n            date: Date.now(),\n            is_local_tz: false,\n            building_tz: this._org.building?.timezone || localStorage.getItem('CONCIERGE.timezone'),\n        });\n        this.now = (now.dateHour + now.minutes / 60) / 24;\n        this.active_hour = now.startOfValue('hour').formatDate('HH:mm');\n        this.is_today = this.isToday();\n        this.cdr.detectChanges();\n    }\n\n\n    /**\n     * Scroll booking to the event on the day view\n     * @param booking Booking to scroll into view\n     */\n    private scrollIntoView(searchData:  Booking | Space ) {\n        if (searchData && this.scroll_area && this.scroll_area['elementRef'].nativeElement) {\n            this.column && this._renderer.removeClass(this.column, 'wild');\n\n            /** Select space column element using space id in search data - \n             * space.id if seach data is space object or data.space.id if search data is booking object\n             * \n             */\n            const spaceId = searchData['space'] ? searchData['space'].id : searchData.id;\n            const element: HTMLDivElement = this.scroll_area['elementRef']\n                .nativeElement.querySelector(`#space-col-${spaceId}`);\n\n\n            this.column = element;\n\n            this.bookingEl && this._renderer.removeClass(this.bookingEl, 'wild');\n            if(searchData['space'] && searchData['space'].id) \n                this.bookingEl = element?.querySelector(`#${searchData.id}`)?.querySelector('.event-container');\n\n\n            /* istanbul ignore else */\n            if (element) {\n                this.timeoutID && clearTimeout(this.timeoutID);\n                this._renderer.addClass(element, 'wild');\n                this.bookingEl && this._renderer.addClass(this.bookingEl, 'wild');\n                const scroll_box = this.scroll_area['elementRef'].nativeElement.getBoundingClientRect();\n\n                let date_percent;\n                if(searchData['space'] && searchData['space'].id) {\n                     date_percent = Math.abs(\n                        searchData['startDateTz'].dateDiff(\n                            searchData['startDateTz'].startOfValue('day'),\n                            'minutes'\n                        )\n                    ) / (24 * 60);\n                }\n                \n\n                const box = element.getBoundingClientRect();\n                const left = box.left - scroll_box.left + this.scroll_area['elementRef'].nativeElement.scrollLeft - 500;\n                const top = (searchData['space'] && searchData['space'].id) ? \n                    this.scroll_area['elementRef'].nativeElement.scrollHeight * date_percent - 10 :\n                    0\n\n\n                this.scroll_area['elementRef'].nativeElement.scrollTo({\n                    left: left,\n                    top: top,\n                    behavior: 'smooth',\n                });\n\n                this.timeoutID =  setTimeout(()=> {\n                    element && this._renderer.removeClass(element, 'wild');\n                    this.bookingEl &&  this._renderer.removeClass(this.bookingEl, 'wild');\n                }, 3000);\n            }\n        }\n    }\n\n    /**\n     * Setup an auto-scroll for the display view\n     * @param x\n     * @param y\n     */\n    public scrollView(x: number, y: number) {\n        /* istanbul ignore else */\n        if (x || y) {\n            this.scroll_area['elementRef'].nativeElement.scrollTop += y || 0;\n            this.scroll_area['elementRef'].nativeElement.scrollLeft += x || 0;\n            /* istanbul ignore else */\n            if (\n                (y &&\n                    this.scroll_area['elementRef'].nativeElement.scrollTop >=\n                        this.scroll_area['elementRef'].nativeElement.scrollHeight) ||\n                (x &&\n                    this.scroll_area['elementRef'].nativeElement.scrollLeft >=\n                        this.scroll_area['elementRef'].nativeElement.scrollWidth) ||\n                (y && this.scroll_area['elementRef'].nativeElement.scrollTop <= 0) ||\n                (x && this.scroll_area['elementRef'].nativeElement.scrollLeft <= 0)\n            ) {\n                this.clearInterval('auto_scroll');\n            }\n        //    this.updateScroll({ target: this.scroll_area['elementRef'].nativeElement });\n        }\n    }\n\n    public clearSelected() {\n        this._service.set('CONCIERGE.day_view.viewing', null);\n    }\n\n    public cancelScroll() {\n        this.clearInterval('auto_scroll');\n    }\n\n    /**  */\n\n    // public dragChange(is_dragging: boolean) {\n    //     if (is_dragging) {\n    //         this.scroll_offset = this.scroll_area['elementRef'].nativeElement.scrollTop; \n    //         this.subscription(\n    //             'listen_move',\n    //             this._renderer.listen('window', 'mousemove', (event: MouseEvent) => {\n    //                 const position = { x: event.clientX, y: event.clientY };\n    //                 const y = position.y > this.box.bottom - this.box.height * 0.05\n    //                             ? 1\n    //                             : position.y < this.box.top + this.box.height * 0.05\n    //                             ? -1\n    //                             : 0;\n    //                 const x = position.x > this.box.right - this.box.width * 0.05\n    //                             ? 1\n    //                             : position.x < this.box.left + this.box.height * 0.05\n    //                             ? -1\n    //                             : 0;\n    //                 this.scrollView(x * 5, y * 5);\n    //                 this._zone.runOutsideAngular(() => {\n    //                     this.interval('auto_scroll', () => {\n    //                         return this.scrollView(x * 40, y * 40) \n    //                     }, 15);\n    //                 });\n    //                 this.cdr.detectChanges();\n    //             })\n    //         );\n    //         this.clearInterval('bookings');\n    //     } else {\n    //         this.cancelScroll();\n    //         this.unsub('listen_move');\n    //     }\n    // }\n\n    private initSpaces() {\n        const holding_bay = this.holding_bay;\n        this.filtered_spaces = this.spaces.filter(\n            (i) =>\n                (!this.space_type || i.zones.indexOf(this.space_type) >= 0) &&\n                (!holding_bay || i.id !== holding_bay.id) &&\n                i.bookable\n        );\n        this.filtered_spaces.sort((a, b) => a.local_name.localeCompare(b.local_name));\n        this.space_zones = this.spaces.map((i) => `space-col-${i.id}`);\n    }\n\n\n\n\t// public onEventDragging(isDragging: boolean): void {\n\t// \t\t// Check if dragging is initiated\n\t// \t\tif (isDragging) {\n\t// \t\t\t// Store the current scroll position\n\t// \t\t\tthis.scroll_offset = this.scroll_area['elementRef'].nativeElement.scrollTop;\n\t// \t\t\t// Subscribe to mouse move events\n\t// \t\t\tthis.subscribeToMouseMove();\n\t// \t\t\t// Clear existing interval for bookings\n\t// \t\t\tthis.clearInterval('bookings');\n\t// \t\t} else {\n\t// \t\t\t// Cancel scroll operation\n\t// \t\t\tthis.cancelScroll();\n\t// \t\t\t// Unsubscribe from mouse move events\n\t// \t\t\tthis.unsubscribeFromMouseMove();\n\t// \t\t}\n\t// }\n\n\t// Subscribe to mouse move events and handle scroll logic\n\t// private subscribeToMouseMove(): void {\n\t// \tthis.subscription(\n\t// \t\t'listen_move',\n\t// \t\tthis._renderer.listen('window', 'mousemove', (event: MouseEvent) => {\n\t// \t\t\t// Get mouse position\n\t// \t\t\tconst position = { x: event.clientX, y: event.clientY };\n\t// \t\t\t// Calculate scroll direction based on mouse position\n\t// \t\t\tconst [x, y] = this.calculateScrollDirection(position);\n\t// \t\t\t// Scroll the view based on calculated direction\n\t// \t\t\tthis.scrollView(x * 5, y * 5);\n\t// \t\t\t// Run auto-scroll logic\n\t// \t\t\tthis.runAutoScroll(x, y);\n\t// \t\t\t// Detect changes to update the view\n\t// \t\t\tthis.cdr.detectChanges();\n\t// \t\t})\n\t// \t);\n\t// }\n\n\t// Calculate scroll direction based on mouse position\n\t// private calculateScrollDirection(position: { x: number, y: number }): [number, number] {\n\t// \tconst tolerance = 0.05;\n\t// \tconst x = this.calculateDirection(position.x, this.box.left, this.box.right, tolerance);\n\t// \tconst y = this.calculateDirection(position.y, this.box.top, this.box.bottom, tolerance);\n\t// \treturn [x, y];\n\t// }\n\n\t// Calculate direction based on mouse position and element boundaries\n\t// private calculateDirection(pos: number, min: number, max: number, tolerance: number): number {\n\t// \tif (pos > max - this.box.width * tolerance) {\n\t// \t\t\treturn 1; // Scroll right\n\t// \t} else if (pos < min + this.box.width * tolerance) {\n\t// \t\t\treturn -1; // Scroll left\n\t// \t} else {\n\t// \t\t\treturn 0; // Do not scroll\n\t// \t}\n\t// }\n\n\t// Run auto-scroll logic\n\t// private runAutoScroll(x: number, y: number): void {\n\t// \tthis._zone.runOutsideAngular(() => {\n\t// \t\t\tthis.interval('auto_scroll', () => this.scrollView(x * 10, y * 10), 10);\n\t// \t});\n\t// }\n\n\t// Unsubscribe from mouse move events\n\t// private unsubscribeFromMouseMove(): void {\n\t// \tthis.unsub('listen_move');\n\t// }\n\n    // public movingEvent(booking) {\n    //     this.isEventMoving = booking.isMoving;\n    //     this.loading_space[booking.movingId] = booking.isMoving;\n        \n    // }\n\n}\n\n","<div class=\"timeline\">\n\t<div class=\"loader\" *ngIf=\"is_loading | async\">\n\t\t<mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>\n\t</div>\n\n\t<div class=\"body\" (click)=\"clearSelected()\">\n\t\t<div class=\"flex content\" [class.is_banner_shown]=\"undo_action\"  id=\"day-view-scroll\" >\n\t\t\t<cdk-virtual-scroll-viewport\n\t\t\t\t#scroll_area\n\t\t\t\titemSize=\"50\"\n\t\t\t\tclass=\"viewport\"\n\t\t\t\torientation=\"horizontal\"\n\t\t\t\tminBufferPx=\"200\" maxBufferPx=\"1000\"\n\t\t\t\t(scroll)=\"updateScroll($event)\" >\n\n\t\t\t\t<div class=\"time-blocks\" >\n\t\t\t\t\t<div class=\"group\">\n\t\t\t\t\t\t<div class=\"text\">Time</div>\n\t\t\t\t\t\t<div class=\"block\" *ngFor=\"let timeslot of time_blocks\">\n\t\t\t\t\t\t\t<div div class=\"hour\" [class.active]=\"is_today && timeslot.id === active_hour\"> {{ timeslot.name }} </div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"room-blocks\">\n\t\t\t\t\t<div class=\"space-header\" *ngFor=\"let room of filtered_spaces\" [title]=\"room.local_name\">\n\t\t\t\t\t\t<div class=\"details\">\n\t\t\t\t\t\t\t<div class=\"text\">{{ room.local_name }}</div>\n\t\t\t\t\t\t\t<div class=\"icon\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"capacity\">\n\t\t\t\t\t\t\tCapacity - {{ room.capacity || '0' }}\n\t\t\t\t\t\t\t{{ room.capacity === 1 ? 'person' : 'people' }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"adjustable-room-block\"></div>\n\n\t\t\t\t\n\t\t\t\t<div class=\"time-grid-container\" >\n\t\t\t\t\t<div class=\"container-space\">\n\t\t\t\t\t\t<div class=\"space-day\" >\n\t\t\t\t\t\t\t<div class=\"space\" [style.min-height]=\"time_blocks.length * 3 + 'rem'\"\n\t\t\t\t\t\t\t\t*ngFor=\"let item of filtered_spaces\" cdkDropListGroup>\n\n\t\t\t\t\t\t\t\t<day-view-space\n\t\t\t\t\t\t\t\t\t[space_list]=\"space_zones\"\n\t\t\t\t\t\t\t\t\t[dateTz]=\"dateTz\"\n\t\t\t\t\t\t\t\t\t[space]=\"item\"\n\t\t\t\t\t\t\t\t\t[legend]=\"legend\"\n\t\t\t\t\t\t\t\t\t[overflow_only]=\"overflow_only\"\n\t\t\t\t\t\t\t\t\t[scroll]=\"-scroll_left\"\n\t\t\t\t\t\t\t\t\t[scrollTop]=\"scroll_offset - scroll_top\"\n\t\t\t\t\t\t\t\t\t[lastUpdate]=\"last_update\"\n\t\t\t\t\t\t\t\t\t[eventMovingLoader]=\"loading_space\"\n\t\t\t\t\t\t\t\t\t(dragging)=\"dragChange($event)\"\n\t\t\t\t\t\t\t\t\t(inView)=\"in_view[item.id] = $event\"\n\t\t\t\t\t\t\t\t\t(moving)=\"movingEvent($event)\">\n\t\t\t\t\t\t\t\t</day-view-space>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</cdk-virtual-scroll-viewport>\n\t\t</div>\n\n\t\t<div class=\"now-line\" *ngIf=\"is_today\"  [style.top]=\" 'calc(' + now * time_blocks.length * 3 + 'rem - ' + (scroll_top - 48 ) + 'px)' | safe: 'style' \" >\n\t\t\t<div class=\"knob\"></div>\n\t\t</div>\n    </div>\n</div>\n<div class=\"moving-overlay\" *ngIf=\"isEventMoving\">\n\t<div class=\"moving\" >\n\t\t<div class=\"text\">Moving meeting</div>\n\t\t<div class=\"spinner\">\n\t\t\t<mat-spinner diameter=\"32\"></mat-spinner>\n\t\t</div>\n\t</div>\n</div>\n","import {\n    Component,\n    Input,\n    Output,\n    EventEmitter\n} from '@angular/core';\nimport {\n    Router\n} from '@angular/router';\nimport {\n    BaseDirective,\n} from '@mckinsey-converge/base';\nimport {\n    generateFeedbackUrl,\n    Urls\n} from '../../utilities/urls';\nimport {\n    Store\n} from '@ngrx/store';\nimport {\n    Booking,\n    Building,\n    BookingStoreState,\n    clearBookingFormData,\n    cateringAllowed,\n    openBookingSurvey,\n    roomHasCateringHours\n} from '@mckinsey-converge/data-common';\n\nexport enum TopBarHeaderMode {\n    Light = 'light',\n    Dark = 'dark',\n}\n\nexport interface statusObject {\n    text: string,\n    title: string,\n    image: string,\n}\n\n@Component({\n    selector: 'booking-confirmation',\n    template: `\n        <div class=\"booking-confirmation mck-row\" *ngIf=\"confirmed || loading\">\n            <header class=\"header\" *ngIf=\"hasData()\">\n                <a-topbar-header\n                    [mode]=\"mode\"\n                    [backModal]=\"true\"\n                    [noSurvey]=\"true\"\n                    (closeCallback)=\"returnHome()\">\n                </a-topbar-header>\n            </header>\n            <div class=\"confirm-wrapper\">\n            <div class=\"mck-column mck-center results-container mck-scroll\">\n                <div class=\"mck-column mck-scroll mck-content-expand-width \">\n                    <div class=\"content mck-column mck-center mck-content-body\">\n                        <div class=\"section\" [class.skeleton]=\"!hasData()\">\n                            <ng-container *ngIf=\"hasData()\">\n                              <h1>{{  data?.isEditSeries || (booking.is_recurrent && booking.recurrence_type === 'master') ? 'Recurring Series' : 'Booking' }}  {{data?.status.title}}</h1>\n                            </ng-container>\n                            <ng-container *ngIf=\"!hasData()\">\n                              <ngx-skeleton-loader class=\"mck-skeleton-line-1 header\"></ngx-skeleton-loader>\n                            </ng-container>\n                            <div>\n                                <div>\n                                    <div class=\"title\" *ngIf=\"hasData()\">\n                                      <h2 *ngIf=\"!isUnavailable()\">{{ booking.title }}</h2>\n                                      <h2 *ngIf=\"isUnavailable()\">Room is no longer available for your chosen date and time</h2>\n                                    </div>\n                                    <ng-container *ngIf=\"hasData()\">\n                                      <div class=\"booking-data\" *ngIf=\"!data?.isEditSeries && data.booking.recurrence_type !== 'master' \">\n                                        <div class=\"pb\" *ngIf=\"!isUnavailable()\">Status:  {{data?.status.text}}</div>\n                                        <div>Date: {{data?.dateString}}</div>\n                                        <div>Time: {{data?.timeString}}</div>\n                                        <div>{{data?.typeString}} meeting ({{data?.durationString}})</div>\n                                      </div>\n                                      <div class=\"booking-data\"  *ngIf=\"data?.isEditSeries || data.booking.recurrence_type === 'master' \">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"rec-details-period\">{{booking?.recurrence_period === 'list' ? 'Specific dates' : booking?.recurrence_period | titlecase}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span *ngIf=\"data?.isConflictWithOccurences()?.is_conflict\" (click)=\"data?.openRecurrenceConflictsModal(booking?.room)\"> - Conflicts({{data?.isConflictWithOccurences()?.total_Conflicts}}) </span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>Start date: {{data?.dateString}}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>End date: {{data?.endDateString}}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>Time: {{data?.timeString}}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>{{data?.type}} meeting ({{data?.durationString}})</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n                                    </ng-container>\n                                    <ng-container *ngIf=\"!hasData()\">\n                                        <div class=\"skeleton\">\n                                          <div><ngx-skeleton-loader class=\"mck-skeleton-line-1\"></ngx-skeleton-loader></div>\n                                          <div><ngx-skeleton-loader class=\"mck-skeleton-line-50p-thin\"></ngx-skeleton-loader></div>\n                                          <div class=\"gap-a\"></div>\n                                          <div>\n                                            <ngx-skeleton-loader class=\"mck-skeleton-line-60p-thin\"></ngx-skeleton-loader>\n                                            <ngx-skeleton-loader class=\"mck-skeleton-line-90p-thin\"></ngx-skeleton-loader>\n                                            <ngx-skeleton-loader class=\"mck-skeleton-line-60p-thin\"></ngx-skeleton-loader>\n                                        </div>\n                                        </div>\n                                    </ng-container>\n                                    <div class=\"booking-data\">\n                                        <ng-container *ngIf=\"hasData()\">\n                                            <div>\n                                                Address: {{building.address}},\n                                                {{building.city}}\n                                            </div>\n                                            <div>Room: {{booking.space.local_name}}</div>\n                                            <div>Room Capacity: {{booking.space.capacity}}</div>\n                                        </ng-container>\n                                        <ng-container *ngIf=\"!hasData()\">\n                                            <div class=\"gap-b\"></div>\n                                            <ngx-skeleton-loader class=\"mck-skeleton-line-90p-thin\"></ngx-skeleton-loader>\n                                            <ngx-skeleton-loader class=\"mck-skeleton-line-60p-thin\"></ngx-skeleton-loader>\n                                            <ngx-skeleton-loader class=\"mck-skeleton-line-60p-thin\"></ngx-skeleton-loader>\n                                            <ngx-skeleton-loader class=\"mck-skeleton-line-60p-thin\"></ngx-skeleton-loader>\n                                        </ng-container>\n                                    </div>\n                                </div>\n                                <div class=\"status {{ getStatusColor(data?.status.text.toLowerCase()) }}\" [class.skeleton]=\"!hasData()\">\n                                    <ng-container *ngIf=\"hasData()\">\n                                        <div>\n                                            <img [src]=\"data?.status.image\" />\n                                            <p>{{ data?.status.text }}</p>\n                                        </div>\n                                    </ng-container>\n                                    <ng-container *ngIf=\"!hasData()\">\n                                        <div>\n                                            <ngx-skeleton-loader class=\"mck-skeleton-line-1\"></ngx-skeleton-loader>\n                                            <p>\n                                              <ngx-skeleton-loader class=\"mck-skeleton-line-1\"></ngx-skeleton-loader>\n                                            </p>\n                                        </div>\n                                    </ng-container>\n                                </div>\n                            </div>\n                        </div>\n                        <div class=\"details\" [class.skeleton]=\"!hasData()\">\n                            <div *ngIf=\"!isUnavailable()\">\n                                <div class='booking-data'>\n                                    <ng-container *ngIf=\"hasData()\">\n                                      <p><label>Host:</label> {{booking.organiser.name}}</p>\n                                      <p><label>Attendees:</label> {{attendees}}</p>\n                                      <p *ngIf=\"company\"><label>Company:</label> {{company}}</p>\n                                      <p><label>Charge Code:</label> {{charge_code}}</p>\n                                      <p><label>Headcount Estimate:</label> {{headcount}}</p>\n                                      <p><label>Additional Requirements:</label> {{notes}}</p>\n                                      <p *ngIf=\"data.booking.opt_out\"><label>Email notification for this booking has been opted out.</label></p>\n                                    </ng-container>\n                                    <ng-container *ngIf=\"!hasData()\">\n                                      <p><ngx-skeleton-loader class=\"mck-skeleton-line-60p-thin\"></ngx-skeleton-loader></p>\n                                      <p><ngx-skeleton-loader class=\"mck-skeleton-line-60p-thin\"></ngx-skeleton-loader></p>\n                                      <p><ngx-skeleton-loader class=\"mck-skeleton-line-60p-thin\"></ngx-skeleton-loader></p>\n                                      <p><ngx-skeleton-loader class=\"mck-skeleton-line-50p-thin\"></ngx-skeleton-loader></p>\n                                      <p><ngx-skeleton-loader class=\"mck-skeleton-line-50p-thin\"></ngx-skeleton-loader></p>\n                                      <p>\n                                        <ngx-skeleton-loader class=\"mck-skeleton-line-60p-thin\"></ngx-skeleton-loader>\n                                        <ngx-skeleton-loader class=\"mck-skeleton-line-90p-thin\"></ngx-skeleton-loader>\n                                        <ngx-skeleton-loader class=\"mck-skeleton-line-50p-thin\"></ngx-skeleton-loader>\n                                      </p>\n                                    </ng-container>\n                                </div>\n                                <div class=\"catering\" *ngIf=\"roomHasCatering && hasData()\" [class.skeleton]=\"!hasData()\">\n                                    <div>\n                                      <h2><img src=\"assets/icon/catering.svg\"> Catering is available for this meeting room</h2>\n                                      <button\n                                          mat-stroked-button\n                                          color=\"primary\"\n                                          class=\"mck-stroked-button mck-short mck-column mck-center mck-primary\"\n                                          [disabled]=\"disableCateringButton\"\n                                          (click)=\"startCatering()\"\n                                      ><span>Add catering</span></button>\n\n                                      <catering-order-table [booking]=\"booking\"></catering-order-table>\n                                  </div>\n                                </div>\n                                <div class=\"catering skeleton\" *ngIf=\"!hasData()\">\n                                  <div>\n                                    <ngx-skeleton-loader class=\"mck-skeleton-checkbox\"></ngx-skeleton-loader>\n                                    <h2><ngx-skeleton-loader class=\"mck-skeleton-line-70p-thin\"></ngx-skeleton-loader></h2>\n                                    <h2><ngx-skeleton-loader class=\"mck-skeleton-line-70p-thin\"></ngx-skeleton-loader></h2>\n                                    <p>&nbsp;</p>\n                                    <ngx-skeleton-loader class=\"mck-skeleton-load-more-100p\"></ngx-skeleton-loader>\n                                  </div>\n\n                                </div>\n                            </div>\n                            <div *ngIf=\"isUnavailable()\" class='unavailable-details'>\n                                <h2>Ooops - we're sorry!</h2>\n                                <p>Unfortunately your selected room has been booked by another user</p>\n                                <p>Please try searching for another room.</p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"footer mck-column mck-center\">\n                    <ng-container *ngIf=\"hasData()\">\n                        <div>\n                            <button mat-button color=\"primary\" class=\"mck-primary-button\" (click)=\"returnHome()\">{{ !isUnavailable() ? 'Close' : 'Back to results' }}</button>\n                        </div>\n                    </ng-container>\n                    <ng-container *ngIf=\"!hasData()\">\n                      <div class=\"skeleton\">\n                          <ngx-skeleton-loader class=\"mck-skeleton-load-more\"></ngx-skeleton-loader>\n                      </div>\n                    </ng-container>\n                </div>\n            </div>\n        </div>\n    `,\n    styleUrls: ['./booking-confirmation.component.scss']\n})\nexport class BookingConfirmationComponent extends BaseDirective {\n    /** The theme to use **/\n    @Input() public mode: TopBarHeaderMode = TopBarHeaderMode.Light;\n\n    @Input() public confirmed: boolean;\n    @Input() public loading: boolean;\n\n    @Input() public modal: boolean;\n\t\t@Input('dataForConfirmation') public data: any; // consolidated data using for confirmation template\n\n    /** Emitter for close events */\n    @Output() public callback = new EventEmitter<void>();\n\n    public currentPage: string;\n\n\t\tpublic get booking(): Booking {\n\t\t\treturn this.data?.booking\n\t\t};\n\n\n    public get building(): Building {\n        return this.data?.booking.room.building;\n    };\n\n    public get disableCateringButton(): boolean {\n      return !cateringAllowed(this.data?.booking, this.building);\n    }\n\n    public get charge_code() {\n        return (this.data?.booking.equipment_codes || {})[\n            this.data?.booking.room.email\n        ] || 'No Charge Code'\n    }\n\n    public get headcount() {\n        return (this.data?.booking.expected_attendees || {})[\n            this.data?.booking.room.email\n        ] || 0\n    }\n\n    public get attendees() {\n        const a = Array.isArray(this.data?.booking.attendees) ? this.data?.booking.attendees.map(u => u?.name ? u.name : '') : [];\n        return a.join(', ');\n    }\n\n    public get company() {\n        return this.data?.booking.company.join(', ');\n    }\n\n    public get notes() {\n        const note = this.data?.booking.notes.find(n => n.type === 'equipment');\n        return note ? note.message : '';\n    }\n\n    public get feedback() {\n        return generateFeedbackUrl(this.currentPage);\n    }\n\n    public get roomHasCatering() {\n        return roomHasCateringHours(this.building, this.data?.booking?.space) && cateringAllowed(this.data?.booking, this.building);\n    }\n\n    public listItems(order) {\n        return order.items.map(i => `(${i.amount}) ${i.name}`).join(', ');\n    }\n\n    public formatDeliveryTime(order) {\n        return this.data?.booking.startDateTz.addValue({ minutes: order?.delivery_time }).formatDate(\"h:mma\");\n    }\n\n    constructor(\n        private store: Store<BookingStoreState>,\n        private _router: Router,\n    ) {\n        super();\n    }\n\n    public getStatusColor (statusText: string): string {\n        switch (statusText) {\n            case 'confirmed':\n                return 'approved'\n            case 'unavailable':\n                return 'cancelled'\n            default:\n                return statusText;\n        }\n    }\n\n    public hasData() {\n        return (this.confirmed && !this.loading) || this.isUnavailable();\n    }\n\n    public goToHelp() {\n        window.open(Urls.Help);\n    }\n\n    public async returnHome() {\n        \n        if (this.modal) {\n            this.confirmed = false;\n            this.loading = false;\n            this.callback.emit();\n        } else {\n            if(!this.isUnavailable()){\n                this.store.dispatch(openBookingSurvey());\n                // Clear everything out\n                this.store.dispatch(clearBookingFormData());\n                this._router.navigate(['/', 'home']);\n            } else {\n                await this._router.navigate(['/home', 'results'], { queryParams: { display: 'list' }});\n            }\n        }\n    }\n\n    public async startCatering() {\n        this.store.dispatch(clearBookingFormData());\n        this.confirmed = false;\n        this.loading = false;\n        this.callback.emit();\n        await this._router.navigate(['/', 'home', 'catering', this.data?.booking.id]);\n    }\n\n    public isUnavailable() {\n        return this.data?.status.text.toLowerCase() === 'unavailable'\n    }\n}\n","import {\n    Component,\n    OnInit,\n} from '@angular/core';\nimport {\n    select,\n} from '@ngrx/store';\nimport {\n    Booking,\n    BookingFormData,\n    selectActiveForm,\n    checkCollisions,\n    getStatusErrorMessage,\n    clearBookingFormData,\n    BOOKING_STATUS,\n\t\tSpace,\n\t\tgetLastDateFromList\n} from '@mckinsey-converge/data-common';\nimport {\n    distinctUntilChanged,\n} from 'rxjs/operators';\nimport { BookingFormBaseComponent } from './booking-form-base.component';\nimport { ConflictsModalComponent, ConflictsModalComponentData } from '@mckinsey-converge/ui';\nimport { MatDialog } from '@angular/material/dialog';\nimport { DialogEvent, shorterLocalDateFormatString } from '@mckinsey-converge/base';\n\n@Component({\n    selector: 'app-booking-create',\n    templateUrl: './booking-form-base.component.html',\n    styleUrls: ['./booking-create.component.scss']\n})\nexport class BookingCreateComponent extends BookingFormBaseComponent implements OnInit {\n\n\n    public ngOnInit(): void {\n        super.ngOnInit();\n        this.subscription('activeForm', this.store.pipe(\n            select(selectActiveForm),\n            distinctUntilChanged()\n        ).subscribe((next: BookingFormData | undefined) => {\n            if (next && next?.dateTz) {\n                this.data.next(next);\n                this.booking = this.bookingFormToBooking(next);\n            }\n        }));\n\n\t\t\t\t// in the parent component\n\t\t\t\tthis.updateConfimatinModal();\n    }\n\n\n    /**\n     * Save booking changes\n     */\n    public saveChanges() {\n        this.loading = true;\n        this.booking = this.bookingFormToBooking(this.data.value);\n        // const booking_form_data = this.data.value;\n        this.booking.status = BOOKING_STATUS.approved;\n        checkCollisions(\n            this._spaces,\n            this.booking\n        ).then((bookable: boolean) => {\n            if (!bookable) {\n                // Refactored for\n                //\thttps://acaprojects.atlassian.net/browse/MCK-1498\n                //\thttps://mckinsey.atlassian.net/browse/CNG-97\n                // API is retuning bookings ouside of requested time range\n                // TODO check booking date and times for conflict manually\n                this.booking.status = BOOKING_STATUS.unavailable;\n                return;\n            }\n\n            // this.booking['opt_out'] = false;\n            this._bookings_service.save(this.booking).then(\n                (bkn) => {\n\t\t\t\t\t\t\t\t\t// update template properties and booking\n\t\t\t\t\t\t\t\t\tthis.handleBookingSuccessResponse(bkn);\n                },\n                (err) => {\n                    if (err.status === 409) {\n                      this.handleBookingErrorMessage();\n                    } else {\n\t\t\t\t\t\t\t\t\t\t\tthis.loading = false;\n                    \tthis.confirmed = false;\n                      this.displayWarningBanner(getStatusErrorMessage(err.status));\n                    }\n                }\n            );\n        },(err) => {\n                this.timeout('error', () => {\n\t\t\t\t\t\t\t\t\tthis.handleBookingErrorMessage();\n                }, 500);\n            }\n        );\n    }\n\n}\n","<div class=\"mck-column mck-content-expand mck-content-page-container booking-form-base-container\" [class.fullpage-modal]=\"modal\">\n    <div class=\"fixed warning banner\" *ngIf=\"showWarningBanner\">\n        <img src=\"assets/icon/booking_cancelled.svg\"/>\n        <p class=\"banner-text\">{{ warningMessage }}</p>\n        <img src=\"assets/icon/close-red.svg\" (click)=\"hideWarningBanner()\"/>\n    </div>\n    <div class=\"header\">\n      <a-topbar-header\n          *ngIf=\"modal\"\n          [mode]=\"TopBarHeaderMode.Light\"\n          [modal]=\"true\"\n          [noSurvey]=\"true\"\n          (closeCallback)=\"discardChanges()\">\n      </a-topbar-header>\n      <a-topbar-header\n          *ngIf=\"!modal\"\n          [mode]=\"TopBarHeaderMode.Light\"\n          [back]=\"backRoute\">\n      </a-topbar-header>\n    </div>\n  <div class=\"mck-column mck-center results-container mck-scroll\">\n      <div class=\"mck-column mck-scroll mck-content-expand-width \">\n          <div class=\"booking-content mck-column mck-center mck-content-body\">\n              <div class=\"details\">\n                  <div>\n                      <h1>Book {{booking?.space?.local_name}}</h1>\n                      <div class=\"section\">\n                          <div>\n                              <app-room-booking-details-form\n                                  [booking]=\"booking\"\n                                  [triggerSubmit]=\"submitTimestamp\"\n                                  (submitForm)=\"submitForm($event)\"\n                                  (validateForm)=\"validateForm($event)\"\n                              ></app-room-booking-details-form>\n                          </div>\n                      </div>\n                      <div class=\"section bottom\">\n                          <div>\n                              <h2>{{ data?.value?.is_recurrent ? 'Recurring' : 'Room' }} Booking Details</h2>\n                              <div *ngIf=\"!data?.value?.is_recurrent\">\n                                  <div>Date: {{dateString}}</div>\n                                  <div>Time: {{timeString}}</div>\n                                  <div>{{type}} meeting ({{durationString}})</div>\n                              </div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div  *ngIf=\"data?.value?.is_recurrent\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"rec-details-period\">{{data?.value?.recurrence_period === 'list' ? 'Specific dates' : data?.value?.recurrence_period | titlecase}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span *ngIf=\"isConflictWithOccurences()?.is_conflict\" (click)=\"openRecurrenceConflictsModal(booking?.room)\"> - Conflicts({{isConflictWithOccurences()?.total_Conflicts}}) </span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>Start date: {{dateString}}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>End date: {{endDateString}}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>Time: {{timeString}}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>{{type}} meeting ({{durationString}})</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n                              <div>\n                                  <div>Address: {{building?.address}},\n                                      {{building?.city}}</div>\n                                  <div>Room: {{booking?.space?.local_name}}</div>\n                                  <div>Capacity: {{booking?.space?.capacity}}</div>\n                              </div>\n                          </div>\n                      </div>\n                  </div>\n              </div>\n          </div>\n      </div>\n  </div>\n  <div class=\"bottom-panel\">\n      <div class=\"buttons\">\n          <div *ngIf=\"!modal\">\n              <button mat-button color=\"secondary\" class=\"mck-secondary-button\" [disabled]=\"loading\" (click)=\"goToBackRoute()\">Back</button>\n              <button mat-button color=\"primary\" class=\"mck-primary-button\" [disabled]=\"loading || invalidForm\" (click)=\"createBooking()\" [class.disabled]=\"invalidForm\">{{ isEditSeries ? 'Update' : 'Create'}} Booking{{is_request ? ' Request' : ''}}</button>\n          </div>\n          <div *ngIf=\"modal\">\n            <button mat-button color=\"secondary\" class=\"mck-secondary-button\" [disabled]=\"loading\" (click)=\"discardChanges()\">Back</button>\n            <button mat-button color=\"primary\" class=\"mck-primary-button\" [disabled]=\"loading || invalidForm\" (click)=\"createBooking()\" [class.disabled]=\"invalidForm\">Update Booking</button>\n          </div>\n      </div>\n  </div>\n  <booking-confirmation\n      [confirmed]=\"confirmed\"\n      [loading]=\"loading\"\n\n      [modal]=\"modal\"\n\t\t\t[dataForConfirmation]=\"dataForConfirmation\"\n      (callback)=\"callback()\"\n  ></booking-confirmation>\n</div>\n","import {Component,OnInit,Input,Output,EventEmitter,\n  } from '@angular/core';\n  import {\n    Booking,\n    selectActiveForm,\n    BookingFormData,\n\t\tBookingStoreState,\n  } from '@mckinsey-converge/data-common';\n  import {\n\t\tStore,\n    select,\n  } from '@ngrx/store';\n  import {\n    distinctUntilChanged, take,\n  } from 'rxjs/operators';\n  import { BaseDirective } from '@mckinsey-converge/base';\n\timport {\n\t\tRoomStoreState,\n\t} from '@mckinsey-converge/rooms';\n\timport {\n\t\tBuildingStoreState\n\t} from '@mckinsey-converge/buildings';\n\timport { UserStoreState } from '@mckinsey-converge/user';\n\n\texport type RoomResultsState = BookingStoreState\n  & RoomStoreState\n  & BuildingStoreState\n  & UserStoreState;\n\n\n  @Component({\n    selector: 'app-booking-edit-wrapper',\n    template: `  <div >\n\t\t\t\t\t\t\t\t\t\t<app-booking-edit\n\t\t\t\t\t\t\t\t\t\t\t\t*ngIf=\"!loading\"\n\t\t\t\t\t\t\t\t\t\t\t\t[booking]=\"booking\"\n\t\t\t\t\t\t\t\t\t\t\t\t(closeCallback)=\"toggleUpdateView($event)\"\n\t\t\t\t\t\t\t\t\t\t></app-booking-edit>\n\t\t\t\t\t\t\t\t\t\t<ngx-skeleton-loader *ngIf=\"loading\" class=\"mck-skeleton-load-more-100p\"></ngx-skeleton-loader>\n\t\t\t\t\t\t\t\t</div>`,\n    styleUrls: ['./booking-create.component.scss']\n  })\n  export class BookingEditWrapperComponent extends BaseDirective implements OnInit {\n\n\t\tpublic booking: Booking;\n\t\tpublic loading: boolean = true;\n\n    constructor(\n        public store: Store<RoomResultsState>,\n      ) {\n        super();\n      }\n\n    public ngOnInit(): void {\n\n      this.subscription('activeForm',\n        this.store.pipe(take(1),\n\t\t\t\t\tselect(selectActiveForm),\n        \tdistinctUntilChanged()\n\t\t\t\t\t).subscribe((next: BookingFormData | undefined) => {\n\t\t\t\t\t\tthis.loading = false;\n        \t\tif (next && next?.dateTz) {\n          \t\tthis.booking = new Booking(next);\n        \t\t}\n      }));\n\n    }\n\n  }\n","import {\n  Component,\n  OnInit,\n  Input,\n  Output,\n  EventEmitter,\n} from '@angular/core';\nimport {\n  Booking,\n  selectActiveForm,\n  storeBookingFormData,\n  BookingFormData,\n  checkCollisions,\n  getStatusErrorMessage,\n  clearBookingFormData,\n  BOOKING_STATUS,\n  getLastDateFromList,\n  Space,\n  SeriesAction\n} from '@mckinsey-converge/data-common';\nimport {\n  select,\n} from '@ngrx/store';\nimport {\n  distinctUntilChanged,\n} from 'rxjs/operators';\nimport { BookingFormBaseComponent } from './booking-form-base.component';\nimport * as cloneDeep from 'lodash/cloneDeep';\n\n@Component({\n  selector: 'app-booking-edit',\n  templateUrl: './booking-form-base.component.html',\n  styleUrls: ['./booking-create.component.scss']\n})\nexport class BookingEditComponent extends BookingFormBaseComponent implements OnInit {\n  @Input() public booking: Booking;\n  @Output() public updateCallback = new EventEmitter<Booking>();\n  public roomEmail: string;\n\n  public ngOnInit(): void {\n    super.ngOnInit();\n\n    this.subscription('activeForm', this.store.pipe(\n      select(selectActiveForm),\n      distinctUntilChanged()\n    ).subscribe((next: BookingFormData | undefined) => {\n      if (next && next?.dateTz) {\n        this.data.next(next);\n        this.isEditSeries = next.action === SeriesAction.EDIT;\n      }\n    }));\n\n    this.modal = !this.isEditSeries;\n    this.roomEmail = this.booking.space.email;\n    const attendees = (this.data?.value?.attendees?.length && this.data?.value?.attendees[0]?.meta)\n      ?  this.data.value.attendees\n      : this.booking.attendees.filter(bk => bk.name !== '' && bk.email !=='').map(u => {\n          return {\n            value: u.email,\n            display: u.name,\n            groupId: 'one',\n            groupHeader: true,\n            shortDisplay: u.name,\n            meta: { external: u.external, user: u, color: u.email.toLowerCase().includes('mckinsey.') ? 'internal' : 'external' },\n          }\n        });\n\n    const company = (this.data?.value?.company?.length && this.data?.value?.company[0]?.groupId)\n      ? this.data?.value?.company\n      : this.booking.company.map(u => {\n        return {\n          value: u,\n          display: u,\n          groupId: 'two',\n          groupHeader: true,\n          shortDisplay: u,\n        }\n      });\n\n    const head_count = this.booking?.expected_attendees[this.roomEmail] ? this.booking?.expected_attendees[this.roomEmail] : 0;\n    const code = this.booking?.equipment_codes[this.roomEmail] ? this.booking?.equipment_codes[this.roomEmail] : '';\n    const organiser = (this.data?.value?.organiser && this.data?.value?.organiser?.meta)\n      ? this.data?.value?.organiser\n      : {\n        display: this.booking.organiser.name,\n        value: this.booking.organiser.email,\n        meta: { user: this.booking.organiser }\n      };\n    const notes = Array.isArray(this.booking.notes) ?  this.booking.notes.find(n => n.type === 'equipment')?.message : this.booking.notes;\n    const selectedRoom = this.data?.value?.selectedRoom\n      ?\n      this.data?.value?.selectedRoom\n      :\n      {\n        space: this.booking.room, // this.building,\n      };\n\n      const payload = {\n        ...this.booking.toJSON(),\n        attendees,\n        code,\n        head_count,\n        notes,\n        organiser,\n        selectedRoom,\n        company\n      };\n    this.store.dispatch(storeBookingFormData({\n      payload: payload\n    }));\n    \n    if(this.isEditSeries) {\n      this.booking = this.bookingFormToBooking(this.data.value, this.isEditSeries); \n    }\n    // in parent component\n    this.updateConfimatinModal();\n\n\n  }\n\n  public updateNotes(booking, note, room) {\n    const notes = [];\n    const cateringNotes = this._cateringNotesService.getNotes();\n    const isEquipmentNote = booking.notes.find(note => note.type === 'equipment');\n    const isCateringNote = booking.notes.find(note => note.type === 'catering');\n\n    if (cateringNotes.length && !isCateringNote) {\n      notes.push(cateringNotes[0]);\n    }\n\n    if (isEquipmentNote) {\n      booking.notes.map(item => {\n        const message = cateringNotes.length && item.type === 'catering' ? cateringNotes[0].message : item.message;\n\n        notes.push({\n          ...item,\n          author : this.currentUser.name,\n          message : item.type === 'equipment' ? note : message,\n          space: item.type === 'equipment' ? room : item.space,\n          date: item.type === 'equipment' ? new Date().getTime() : item.date\n        })\n      });\n    } else {\n      if (note) {\n        notes.push({\n          author: this.currentUser.name,\n          type: \"equipment\",\n          message: note,\n          space: room,\n          date: new Date().getTime()\n        })\n      }\n    }\n    return notes;\n  }\n\n  /**\n   * Save booking changes\n   */\n  public saveChanges() {\n    const booking_form_data = this.data.value;\n\n    if(!this.isEditSeries) {\n\t\t\t // clone booking to allow editing\n       const booking = cloneDeep(this.booking);\n      \n\t\t\tbooking.title = booking_form_data.title;\n\t\t\tbooking.attendees = this.formToAttendees(booking_form_data.attendees);\n\t\t\tbooking.company = this.formToCompany(booking_form_data.company);\n\t\t\tbooking.notes = this.updateNotes(this.booking, booking_form_data.notes, this.roomEmail);;\n\t\t\tbooking.equipment_codes = { [this.roomEmail]: booking_form_data.code };\n\t\t\tbooking.expected_attendees = { [this.roomEmail]: booking_form_data.head_count };\n\t\t\tbooking.organiser = booking_form_data.organiser?.meta.user;\n\t\t\tconst has_note_buffer = booking_form_data.notes && booking_form_data.notes?.length ? {[booking_form_data.selectedRoom?.space?.email || booking?.space?.email]: 900} : null; // 900 seconds = 15 min\n\t\t\t// Removing the note does not remove the existing setup / breakdown\n\t\t\tif (has_note_buffer) {\n\t\t\t  booking.setup = has_note_buffer;\n\t\t\t  booking.breakdown = has_note_buffer;\n\t\t\t}\n      booking.opt_out = booking_form_data.opt_out;\n\t\t\tthis.booking = booking;\n\t\t }\n\t\t else {\n\t\t\tthis.booking = this.bookingFormToBooking(booking_form_data, this.isEditSeries);\n\t\t }\n\n\n    this.loading = true;\n    checkCollisions(\n      this._spaces,\n      this.booking\n    ).then((bookable: boolean) => {\n        // We expect the current booking to be returned form this api call,\n        if (bookable) {\n\n          this._bookings_service.save(this.booking,  this.isEditSeries).then(\n            (bkn) => {\n              // update template properties and booking\n              this.handleBookingSuccessResponse(bkn);\n              // update callback in case of standard booking edit\n              this.updateCallback && this.updateCallback.emit(this.booking);\n\n            },\n            (err) => {\n              if (err.status === 409) {\n                this.handleBookingErrorMessage();\n              } else {\n                this.loading = false;\n                this.confirmed = false;\n                this.displayWarningBanner(getStatusErrorMessage(err.status));\n              }\n            }\n          );\n        } else {\n          this.handleBookingErrorMessage();\n          return;\n        }\n    },\n      (err) => {\n        this.handleBookingErrorMessage();\n      }\n    );\n  }\n\n  public callback() {\n    this.closeCallback.emit(true);\n  }\n\n}\n","import {\n  Component,\n  OnInit,\n  Output,\n  EventEmitter,\n} from '@angular/core';\nimport { TopBarHeaderMode, RoutePayload } from 'src/app/components/topbar-header/topbar-header.component';\nimport {\n  Store\n} from '@ngrx/store';\nimport {\n  BaseDirective,\n  dateLocalFormatString,\n  startEndTimeWithZoneFormatString,\n  humaniseDuration,\n  toTitleCase,\n  dateBuildingFormatString,\n  shorterLocalDateFormatString,\n  DialogEvent,\n} from '@mckinsey-converge/base';\nimport {\n  ApplicationService,\n  Booking,\n  BookingsService,\n  BookingStateService,\n  Space,\n  SpacesService,\n  User,\n  BookingNote,\n  BookingFormData,\n  BookingStoreState,\n  storeBookingFormData,\n  bookingStatusDetails,\n  clearBookingFormData,\n  CateringNotesService,\n  getLastDateFromList,\n  BOOKING_STATUS,\n  DataForConfirmation,\n  UsersService\n} from '@mckinsey-converge/data-common';\nimport {\n  BehaviorSubject,\n} from 'rxjs';\nimport {\n  take,\n} from 'rxjs/operators';\nimport {\n  BuildingStoreState\n} from '@mckinsey-converge/buildings';\nimport {\n  RoomStoreState,\n} from '@mckinsey-converge/rooms';\nimport {\n  Router\n} from '@angular/router';\nimport { UserStoreState } from '@mckinsey-converge/user';\nimport { selectCurrentUser } from '@mckinsey-converge/user';\nimport { MatDialog } from '@angular/material/dialog';\nimport { DateNow, DateTZ } from \"@mckinsey-converge/date-tz\";\nimport { ConflictsModalComponent, ConflictsModalComponentData } from '@mckinsey-converge/ui';\n\n\nexport type RoomResultsState = BookingStoreState\n  & RoomStoreState\n  & BuildingStoreState\n  & UserStoreState;\n\n@Component({\n  selector: 'app-booking-base',\n  templateUrl: './booking-form-base.component.html',\n  styleUrls: ['./booking-create.component.scss']\n})\nexport class BookingFormBaseComponent extends BaseDirective implements OnInit {\n  public TopBarHeaderMode = TopBarHeaderMode;\n\n  public backRoute: RoutePayload = {\n    route: ['/home', 'results', 'room'],\n    queryParams: {}\n  };\n\n  @Output() public closeCallback = new EventEmitter<boolean>();\n\n  // Eliminate selectedRoom (room building capacity )\n  public modal = false;\n  public data = new BehaviorSubject<BookingFormData | undefined>(undefined);\n  public submitTimestamp: number;\n  public confirmed: boolean = false;\n  /** Whether booking has succeeded */\n  public success: boolean;\n  public updated: boolean;\n  /** Display loading template */\n  public loading: boolean;\n  public booking: Booking = new Booking({});\n  /** Current User */\n  public currentUser: User;\n  public invalidForm: boolean = true;\n  public showWarningBanner: boolean = false;\n  public warningMessage: string;\n\n  dataForConfirmation: DataForConfirmation;\n  isEditSeries: boolean = false;\n\n\n  constructor(\n    public _service: ApplicationService,\n    public store: Store<RoomResultsState>,\n    public router: Router,\n    public _bookings_service: BookingsService,\n    public _booking_state_service: BookingStateService,\n    public _spaces: SpacesService,\n    public _cateringNotesService: CateringNotesService,\n    public dialog: MatDialog,\n    private _users: UsersService\n  ) {\n    super();\n  }\n\n  public ngOnInit(): void {\n    this.subscription('currentUser', this.store.select(selectCurrentUser)\n      .pipe(take(1))\n      .subscribe((user: User | undefined) => {\n        // Once we know we have the user loaded.\n        this.currentUser = new User(user);\n      })\n    );\n\n\n  }\n\n  public get building(){\n    return this.booking.room.building;\n  }\n\n  public get type() {\n    return this.booking.bookingTypeLabel;\n  }\n\n  public get internal_external_type() {\n    return this.booking.room.filters.external === true? \"External\" : \"Internal\";\n  }\n\n  public get date(){\n    // R--- remove if no longer used.\n    return this.booking.startDateTz;\n  }\n\n  public get dateString() {\n    return this.booking.startDateTz.formatDate('ccc d MMM yyyy'); //shorterLocalDateFormatString(this.booking.startDateTz);\n    \n  }\n\n  public get timeString() {\n    return startEndTimeWithZoneFormatString(this.booking.startDateTz, this.booking?.displayEndDateTz);\n  }\n\n  public get durationString() {\n    return humaniseDuration(this.booking?.duration);\n  }\n\n  public get status() {\n    return bookingStatusDetails(this.booking);\n  }\n\n  public async goToBackRoute() {\n    await this.router.navigate(this.backRoute.route, { queryParams: this.backRoute.queryParams });\n  }\n\n  /**\n   * Continue to Booking Form\n   */\n  public createBooking() { // todo change links based on usage\n    // trigger the booking form submit\n    this.submitTimestamp = new Date().getTime();\n  }\n\n  // submit the booking form\n  public submitForm(formGroup: any) {\n    let creator: User;\n    if (formGroup.has_delegate) {\n      if (formGroup.organiser.value !== this.currentUser.email) {\n        creator = this.currentUser;\n      }\n    }\n\n    // Combines booking with selected form fields and not the entire formGroup like other places.\n    // to combine booking with selected form fields on submit - WHY IS THIS NEEDED TO DISPACH TO STORE BOOKING FORM DATA ???\n    // THIS ISSUE IS SPILLING INTO - libs/data-common/src/lib/booking/booking.selectors.ts lno: 70\n    // - due to .toJSON recurrence_starts becomes Array<number> ?!?\n    this.store.dispatch(storeBookingFormData({\n      payload: {\n        ...this.booking.toJSON(),\n        attendees: formGroup.attendees,\n        code: formGroup.code,\n        head_count: formGroup.head_count,\n        notes: formGroup.notes,\n        organiser: formGroup.organiser,\n        creator,\n        title: formGroup.title,\n        company: formGroup.company,\n        opt_out: formGroup.opt_out\n      }\n    }));\n    this.saveChanges();\n  }\n\n  // submit the booking form\n  public validateForm(valid: boolean) {\n    this.invalidForm = !valid;\n  }\n\n  public setupNotes(note: string, roomEmail: string) {\n    if (note && note.length  ) {\n      // this note was required to update setup and breakdown\n      return [{\n        author: this.currentUser.name,\n        type: \"equipment\",\n        message: !Array.isArray(note) ?  note : note[0].message,\n        space: roomEmail,\n        date: new Date().getTime()\n      }] as BookingNote[];\n    }\n\n    return [];\n  }\n\n  public formToAttendees(attendees: any[]) {\n    return !attendees ? [] : attendees.map(a => {\n      let raw_user = {\n        first_name: '',\n        last_name: '',\n        email: '',\n        name: '',\n        type: 'internal',\n        external: false,\n        visitor: false,\n      };\n      if (a.meta?.external) {\n        // External users get assigned a random email\n        const nameParts = a.display.split(' ');\n        const length = nameParts.length;\n        if (length) {\n          raw_user.first_name = nameParts[0];\n          raw_user.name = nameParts.join(' ');\n        }\n        if (length > 1) {\n          nameParts.shift();\n          raw_user.last_name = nameParts.join(' ');\n        }\n        raw_user.email = a.value ?? `${Math.floor(Math.random() * 99999)}@guest.mckinsey.com`;\n        raw_user.type = 'external'; // retain external identity\n        raw_user.external = true;\n        raw_user.visitor = true;\n      }  if (a.meta?.user) {\n        raw_user = a.meta.user;\n      }\n      else {\n        raw_user = a;\n      }\n      return new User(raw_user);\n    });\n  }\n\n  public formToCompany(companies: any[]) {\n    return !companies ? [] : companies.map(a => {\n      return a.value;\n    });\n  }\n\n  /**\n   * Save booking changes\n   */\n  public saveChanges() {\n    this.loading = true;\n    const booking_form_data = this.data.value;\n    // override in child class\n  }\n\n  public callback() {\n    // mock interface\n  }\n\n  public get is_request(): boolean {\n    const data = this.data.value;\n\n    /* istanbul ignore else */\n    if (!data?.selectedRoom?.space) {\n        return false;\n    }\n\n    const space = new Space(data.selectedRoom.space);\n    return space.byRequest({\n        dateTz: data.dateTz,\n        duration: data.duration,\n        host: this.currentUser\n    });\n  }\n\n  public displayWarningBanner(custom: string) {\n    this.warningMessage = custom;\n    this.showWarningBanner = true;\n    this.timeout('close banner', () => {\n      this.showWarningBanner = false;\n    }, 10000);\n  }\n\n  public hideWarningBanner() {\n      this.showWarningBanner= false;\n  }\n\n  public discardChanges() {\n    this.store.dispatch(clearBookingFormData());\n    this.closeCallback.emit(true)\n  }\n\n\n\n  setupOrganiser(booking_form_data: BookingFormData) {\n    if(booking_form_data.organiser?.meta?.user){\n        return booking_form_data.organiser?.meta?.user;\n    }\n    else{\n        booking_form_data.organiser = {...booking_form_data.organiser, meta: {user: this.currentUser}}\n        return booking_form_data.organiser?.meta.user;\n    }\n  }\n\n  public bookingFormToBooking(bookingData, isEditSeries: boolean = false): Booking {\n    let booking_form_data = bookingData;\n    const has_note_buffer = booking_form_data.notes && booking_form_data.notes?.length ? {[booking_form_data.selectedRoom.space.email]: 900} : {}; // 900 seconds = 15 min\n    const attendees = this.formToAttendees(booking_form_data.attendees);\n    const company = this.formToCompany(booking_form_data.company);\n    const start_epoch = booking_form_data?.dateTz?.seconds;\n    const end_epoch = booking_form_data.dateTz.addValue({ minutes: booking_form_data.duration }).seconds;\n\n    const raw_data = {\n        id: isEditSeries ? booking_form_data.id : '',\n        all_day: booking_form_data.all_day || false,\n        attendees,\n        booking_type: booking_form_data.bookingType.value,\n        catering: booking_form_data.catering || [],\n        start_epoch,\n        end_epoch,\n        timezone: booking_form_data.timezone,\n        equipment_codes: {[booking_form_data.selectedRoom.space.email]: booking_form_data.code},\n        expected_attendees: {[booking_form_data.selectedRoom.space.email]: booking_form_data.head_count},\n        has_catering: booking_form_data.has_catering || false,\n        needs_space: booking_form_data.needs_space || false,\n        organiser: this.setupOrganiser(booking_form_data),\n        notes: this.setupNotes(booking_form_data.notes, booking_form_data.selectedRoom.space.email),\n        creator: booking_form_data.creator,\n        room: booking_form_data.selectedRoom.space,\n        title: booking_form_data.title,\n        setup: has_note_buffer,\n        breakdown: has_note_buffer,\n        company,\n        /* Staff Recurring form fields */\n        is_recurrent: booking_form_data.is_recurrent,\n        recurrence_count: booking_form_data.recurrence_count,\n        recurrence_days: booking_form_data.recurrence_days,\n        recurrence_endTz: booking_form_data.recurrence_endTz,\n        recurrence_exceptions: booking_form_data.recurrence_exceptions,\n        recurrence_interval: booking_form_data.recurrence_interval,\n        recurrence_period: booking_form_data.recurrence_period,\n        recurrence_starts: booking_form_data.recurrence_starts,\n\n        occurrence_details: booking_form_data.occurrence_details,\n        // occurrence_edits: booking_form_data.occurrence_edits || null,\n        // occurrence_ids: booking_form_data.occurrence_ids || null,\n        recurrence_type: booking_form_data.recurrence_type || null,\n        recurrence_master_id: booking_form_data.recurrence_master_id,\n        edits: booking_form_data?.edits,\n        ignore: booking_form_data?.ignore,\n\n        opt_out: bookingData.opt_out\n\n\n    };\n\n    return new Booking(raw_data);\n  }\n\n\n  public async handleBookingSuccessResponse(bkn) {\n\n    // const user: User = this._users.current;\n    // if(this._users.current.email === bkn.organiser.email) {\n    //   this._users.current.opt_out = true;\n    // }else {\n    //   this._users.current.delegates.map(el => { \n    //     if(el.email === bkn.organiser.email) {\n    //       el.opt_out = true;\n    //     }\n    //     return el;\n    //   })\n    // }\n    \n\n    //const responceBkn = new Booking({...bkn}); // \n    this.booking = new Booking({ ...this.booking, ...bkn.toApiJSON() });\n    this.updateConfimatinModal();\n    this._booking_state_service.replace(this.booking);\n\n    /**\n     * update the master booking in case of recurring to have latest updated in the system\n     */\n    if(this.booking.recurrence_master_id !== null && this.isEditSeries)\n    {\n        const master_booking = await this._bookings_service.show(this.booking.recurrence_master_id);\n        this._booking_state_service.replace(master_booking);\n    }\n\n    // Clear the current booking form\n    this.store.dispatch(clearBookingFormData());\n\n    this.loading = false;\n    this.success = true;\n    this.confirmed = true;\n\n    // Heap track event\n    this._service.analytics.track('update', {\n      booking_id: this.booking.id,\n      office: this.booking.room.building.name, // this.building.name,\n      room: this.booking.room.simple_name,\n      start_time: this.booking.startDateTz.ms,\n      end_time: this.booking.endDateTz.ms,\n      catering: !!this.booking.catering.length,\n      headcount: this.data.value.head_count,\n    });\n\n  }\n\n\n  public handleBookingErrorMessage() {\n    this.loading = false;\n    this.booking.status = BOOKING_STATUS.unavailable\n    this._booking_state_service.replace(this.booking);\n    this.confirmed = true;\n    this.success = false;\n    this.updateConfimatinModal();\n  }\n\n  /**\n * Public method to update the confirmation modal data.\n * This method updates the dataForConfirmation object with the necessary information\n * for displaying the confirmation modal in the application.\n */\n  public updateConfimatinModal() {\n\n    // Prepare an object with booking details and related information for the confirmation modal\n    this.dataForConfirmation = {\n      booking: this.booking,  // Information about the booking\n      status: this.status,  // Status of the booking (e.g., confirmed, pending, etc.)\n      dateString: this.dateString,  // Date of the booking in string format\n      endDateString: this.endDateString,   // End date of the booking in string format\n      timeString: this.timeString,  // Time of the booking in string format\n      durationString: this.durationString,  // Duration of the booking in string format\n      type: this.type,  // Type of booking (e.g., internal, external, etc.)\n      isEditSeries: this.isEditSeries,  // Boolean indicating whether it's an edit in a series of events\n     // Function to check if there are conflicts with occurrences of the booking\n      isConflictWithOccurences: this.isConflictWithOccurences.bind(this),\n      // Function to open a modal in case of conflicts with recurring events\n      openRecurrenceConflictsModal: this.openRecurrenceConflictsModal.bind(this)\n    }\n  }\n\n  /**\n * Checks if there are conflicts with the current booking and its occurrences.\n * Calculates the difference between total occurrences and available occurrences\n * to determine if there are conflicts.\n *\n * @returns {Object} An object containing conflict information:\n *   - is_conflict: A boolean indicating if there are conflicts (true if conflicts exist, false otherwise).\n *   - total_Conflicts: The total number of conflicts (the difference between total occurrences and available occurrences).\n */\n  public isConflictWithOccurences() {\n    const conflicts = this?.booking?.room?.totalOccurrences - this?.booking?.room?.availableOccurrences;\n    return { is_conflict: !!conflicts, total_Conflicts: conflicts };\n  }\n\n\n/**\n * Retrieves the end date string for the booking, considering recurrence if applicable.\n * If the booking is recurrent, it calculates the end date based on recurrence starts;\n * otherwise, it uses the booking's start date as the end date.\n *\n * @returns {string} The formatted end date string in a shorter local date format.\n */\n  public get endDateString(): string {\n    // Determine the array of date-time strings based on recurrence or single start date\n    let recurrenceStart: Array<DateTZ>= [];\n    const { is_recurrent, recurrence_starts, occurrence_details, timezone} = this.booking;\n    if(is_recurrent && recurrence_starts.length) {\n      recurrenceStart = this.booking.recurrence_starts;\n    }\n    else if(is_recurrent && !recurrence_starts.length && occurrence_details?.length) {\n      this.booking.occurrence_details.forEach(element => {\n        recurrenceStart.push(new DateTZ({ date: element.start_epoch * 1000, is_local_tz: false, building_tz: timezone}));\n      });\n      recurrenceStart = recurrenceStart.sort((d1: DateTZ, d2: DateTZ) => d1.ms - d2.ms);\n    }\n    else {\n      recurrenceStart = [this.booking.startDateTz];\n    }\n\n\n    // const endDtz = (this.booking.is_recurrent && this.booking.recurrence_starts.length) ? this.booking.recurrence_starts : [this.booking.startDateTz]\n    // Get the last date from the list of date-time strings and format it in a shorter local date format\n    return getLastDateFromList(recurrenceStart).formatDate('ccc d MMM yyyy'); //shorterLocalDateFormatString(getLastDateFromList(recurrenceStart));\n  }\n\n /**\n * Opens a modal to display recurrence conflicts for a given room.\n *\n * @param {Space} room - The room for which recurrence conflicts are being displayed.\n *\n * This function opens a modal dialog to show recurrence exceptions (conflicts)\n * for the specified room.\n *\n * TO DO: SAME FUNCTION BEING USED IN apps/staff/src/app/booking/room-details/room-details.component.ts\n * and mckinsey-converge/apps/staff/src/app/booking/catering/catering.component.ts\n */\n  public openRecurrenceConflictsModal(room: Space) {\n    let {  recurrence_exceptions } = this.data.value;\n\n    const recurr_ref = this.dialog.open<ConflictsModalComponent,\n    ConflictsModalComponentData>(ConflictsModalComponent, {\n      maxWidth: '95vw',\n      width: '32em',\n      data: {\n        room_name: room.simple_name,\n        conflicts: recurrence_exceptions,\n        timezone: room.building.timezone\n      }\n    });\n    this.subscription(\n      'conflicts_modal_events',\n      recurr_ref.componentInstance.event.subscribe((event: DialogEvent) => {\n          recurr_ref.close();\n      })\n    );\n    recurr_ref.afterClosed().subscribe(() => this.unsub('conflicts_modal_events'));\n  }\n\n\n}\n","import {BehaviorSubject,fromEvent,\n} from 'rxjs';\nimport {take,throttleTime,tap,distinctUntilChanged,map\n} from 'rxjs/operators';\nimport {select,Store\n} from '@ngrx/store';\nimport {Component,Inject,OnInit,\n} from '@angular/core';\nimport { BaseDirective, dateBuildingFormatString, startEndTimeWithZoneFormatString, humaniseDuration, toTitleCase, closestToTimeSlotTz\n} from '@mckinsey-converge/base';\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { User,\n\tApplicationService,\n\tAvailableBookingFields,\n\tBooking,\n\tBookingFormData,\n\tBookingFlowSettings,\n\tSpacesService,\n\tstoreBookingFormData,\n\tDateDurationData,\n\tselectFilteredByIdResults,\n\tgenerateBookingForm,\n\tcateringAllowed,\n\trulesForSpace,\n\tgetStatusErrorMessage,\n\troomHasCateringHours,\n\tBookingsService,\n\tSpaceConflictAlertModalData,\n\tSpaceFilterReason,\n\tBuilding,\n\tBuildingCity,\n\tflattenDisplayOffices,\n\troomSizeOptions,\n\tDEFAULT_BOOKING_DURATION,\n\tbookingTypeOptions,\n\troomFormDataToQuery,\n\tclearBookingFormData,\n\tBookingStateService,\n\tRecurrencePeriod,\n\tselectActiveForm,\n\tSeriesAction\n} from '@mckinsey-converge/data-common';\nimport { first } from 'rxjs/operators';\nimport { selectCurrentUser } from '@mckinsey-converge/user';\nimport { TopBarHeaderMode } from 'src/app/components/topbar-header/topbar-header.component';\nimport { CancelBookingModalComponent } from '../cancel-booking-modal/cancel-booking-modal.component';\nimport { BookingDurationModalComponent } from '../booking-duration-modal/booking-duration-modal.component';\nimport { RoomResultsState } from '../room-details/room-details.component';\nimport {\n\tloadByIdResults, loadRoomsForResults, loadRoomsForResultsMap,\n} from '@mckinsey-converge/rooms';\nimport { FormGroup } from '@angular/forms';\nimport { loadBookingsWithQuery } from '@mckinsey-converge/bookings';\nimport { DateNow, DateTZ } from \"@mckinsey-converge/date-tz\";\nimport { ConflictAlertModalComponent, SelectOption } from '@mckinsey-converge/ui';\nimport { buildingStateSelector, selectBuildingOptionsGroupedByCity } from '@mckinsey-converge/buildings';\nimport { RoomBookingModalComponent } from '../room-booking-modal/room-booking-modal.component';\nimport { Router, ActivatedRoute } from '@angular/router';\n\nconst EMPTY_ARRAY = [];\n\n@Component({\n\tselector: 'app-booking-details-modal',\n\ttemplate: `\n        <div class=\"booking-details\">\n            <div *ngIf=\"_data.hasLoaderUrl\" class=\"modal_mask\">&nbsp;</div>\n            <div class=\"fixed info banner\" *ngIf=\"showInfoBanner\">\n                <img src=\"assets/icon/info-bg-blue.svg\"/>\n                <p class=\"banner-text\">Your booking date and/or time was successfully updated</p>\n                <img src=\"assets/icon/close-blue.svg\" (click)=\"hideInfoBanner()\"/>\n            </div>\n            <div class=\"fixed warning banner\" *ngIf=\"showWarningBanner\">\n                <img src=\"assets/icon/booking_cancelled.svg\"/>\n                <p class=\"banner-text\">{{ warningMessage }}</p>\n                <img src=\"assets/icon/close-red.svg\" (click)=\"hideWarningBanner()\"/>\n            </div>\n            <mck-modal header=\"\">\n                <div class=\"header\" [class.is-recurring-body]=\"isRecurrentBooking && !disableCancelButton\">\n                    <div class=\"reccuring-banner\" *ngIf=\"isRecurrentBooking && !disableCancelButton\">\n                        <div class=\"flex-column status-info\">\n                           <div class=\"flex-row status-head\">\n                                <img [src]=\"statusImage\" />\n                                <span class=\"recurring-status\"> Recurring booking status: {{ statusText }} </span>\n                           </div>\n                           <div class=\"flex-row\">\n                                <img class=\"recurring-info-icon\" src=\"assets/icon/recurring-data-icon.svg\" />\n                                <div class=\"banner-info-txt\" [ngSwitch]=\"recurrence_period\">\n                                    <ng-template [ngSwitchCase]=\"'daily'\">\n                                        This is one occurrence in a recurring series which occurs every {{recurrence_interval > 1 ? recurrence_interval + ' Days' : 'Day'}} effective {{  _data?.master_booking?.dateString }} until {{  _data?.master_booking?.endDateString }}.\n                                    </ng-template>\n                                    <ng-template [ngSwitchCase]=\"'weekly'\">\n                                        This is one occurrence in a recurring series which occurs every {{recurrence_interval > 1 ? recurrence_interval + ' Weeks' : 'Week'}} effective {{  _data?.master_booking?.dateString }} until {{  _data?.master_booking?.endDateString }}.\n                                    </ng-template>\n                                    <ng-template [ngSwitchCase]=\"'monthly'\">\n                                        This is one occurrence in a recurring series which occurs every {{recurrence_interval > 1 ? recurrence_interval + ' Months' : 'Month'}} effective {{  _data?.master_booking?.dateString }} until {{  _data?.master_booking?.endDateString }}.\n                                    </ng-template>\n                                    <ng-template ngSwitchDefault>\n                                        This is one occurrence in a recurring series which occurs on <span class=\"spcific-date-toggle\" (click)=\"toggleSpecificDates()\">Specific Dates</span> effective {{  _data?.master_booking?.dateString }} until {{  _data?.master_booking?.endDateString }}\n                                        <div class=\"hint\" *ngIf=\"specific_dates\">\n                                            <div class=\"triangle\"></div>\n                                            <div class=\"hint-wrapper\">\n                                                <div *ngFor=\"let occurrence of occurrence_details\">{{ occurrence.dateTz.formatDate('dd MMM yyyy') }}</div>\n                                            </div>\n                                        </div>\n                                    </ng-template>\n                                </div>\n                           </div>\n                        </div>\n                        <div class=\"flex-column\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t*ngIf=\"!loading && !disableCancelButton\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmat-stroked-button class=\"mck-secondary-button mck-modal-secondary-button edit-recrring-cta\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(click)=\"editRecurringSeries()\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[disabled]=\"disableSeriesEditButton\">\n                                Edit series\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n                            <button *ngIf=\"!loading \"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmat-stroked-button class=\"mck-secondary-button mck-modal-secondary-button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(click)=\"cancelBooking({ series: true })\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCancel series\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ngx-skeleton-loader *ngIf=\"loading\" class=\"mck-skeleton-load-more-100p\"></ngx-skeleton-loader>\n                        </div>\n                    </div>\n\n                    <div class=\"status\" [ngClass]=\"status\" *ngIf=\"!loading\">\n                        <div class=\"flex-row flex-space-between\">\n                            <p><img [src]=\"statusImage\" /> Booking {{ statusText.toLowerCase() }}</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span > {{timeString}} </span>\n                        </div>\n                    </div>\n                    <!-- <div class=\"blue-banner\" *ngIf=\"isRecurrentBooking && !disableCancelButton\">\n                        <img src=\"assets/icon/info-icon.svg\" />\n                        <div>\n                            <p>As this booking is part of a recurring series, editing options have been disabled.\n                            If you need to make any changes - please contact your local backoffice team.</p>\n                        </div>\n                    </div> -->\n                    <div *ngIf=\"loading\">\n                        <div>\n                            <ngx-skeleton-loader class=\"mck-skeleton-header\"></ngx-skeleton-loader>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"detail-body\" [class.is-recurring-body]=\"isRecurrentBooking && !disableCancelButton\">\n                    <div class=\"status-cta-block\">\n                        <div>\n                            <h1 *ngIf=\"!loading\">Booking Status: {{statusText}}</h1>\n                            <h1 *ngIf=\"loading\">\n                                <ngx-skeleton-loader\n                                    class=\"mck-skeleton-load-more\"\n                                ></ngx-skeleton-loader>\n                            </h1>\n                        </div>\n                        <div>\n                            <div>\n                                <a type=\"button\"\n                                    *ngIf=\"!loading\"\n                                    mat-stroked-button class=\"mck-secondary-button mck-modal-secondary-button\"\n                                    target=\"email\"\n                                    [href]=\"emailURL\"\n                                >\n                                Contact front of house</a>\n                                <ngx-skeleton-loader\n                                    *ngIf=\"loading\"\n                                    class=\"mck-skeleton-load-more-100p\"\n                                ></ngx-skeleton-loader>\n                            </div>\n                            <div>\n                                <button\n                                    *ngIf=\"!loading && !disableCancelButton\"\n                                    mat-stroked-button class=\"mck-secondary-button mck-modal-secondary-button\"\n                                    (click)=\"cancelBooking()\"\n                                >\n                                    Cancel booking</button>\n                                <ngx-skeleton-loader\n                                    *ngIf=\"loading\"\n                                    class=\"mck-skeleton-load-more-100p\"\n                                ></ngx-skeleton-loader>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"v-panels\">\n                        <div class=\"v-panel\">\n                            <div *ngIf=\"!loading\">\n                                <h2>\n                                    <img src=\"assets/icon/location-pin.svg\">\n                                    {{title}}\n                                </h2>\n                                <p>\n                                    Date: {{dateString}}<br/>\n                                    Time: {{timeString}}<br/>\n                                    {{type}} meeting ({{durationString}})\n                                </p>\n\n                                <button\n                                    mat-stroked-button class=\"mck-secondary-button mck-modal-secondary-button cancel-button\"\n                                    [disabled]=\"disableEditTimeButton\"\n                                    (click)=\"toggleEditView()\"\n                                >\n                                    Edit date or time\n                                </button>\n\n                                <p>\n                                    Address: {{roomLocation}}<br/>\n                                    Room: {{roomName}}<br/>\n                                    Capacity: {{capacity}}\n                                </p>\n\n                                <div class=\"room-map\">\n                                    <div *ngIf=\"!expandedLocation\">\n                                        <input class=\"zoom\"\n                                            type=\"image\"\n                                            src=\"assets/icon/expand-button.svg\"\n                                            (click)=\"expandLocation()\"\n                                        />\n                                    </div>\n\n                                    <room-location-preview\n                                        viewMode=\"booking_preview\"\n                                        [mapUrl]=\"mapUrl\"\n                                        [focus]=\"focusedRoom\"\n                                        [expanded]=\"expandedLocation\"\n                                        [building]=\"_data.booking.room.building\"\n                                        [level]=\"_data.booking.room.level\"\n                                        [space]=\"_data.booking.room\"\n                                        [mode]=\"TopBarHeaderMode.Light\"\n                                        (handleExpand)=\"handleClose(false)\"\n                                    ></room-location-preview>\n                                </div>\n\n                                <button\n                                    mat-stroked-button class=\"mck-secondary-button mck-modal-secondary-button cancel-button\"\n                                    [disabled]=\"extendableMaximum === 0\"\n                                    (click)=\"extendBooking()\"\n                                >\n                                    {{ checkingExtendable ? 'Checking availability...' : 'Extend booking duration'}}\n                                </button>\n                            </div>\n                            <div *ngIf=\"loading\">\n                                <h2>\n                                    <ngx-skeleton-loader class=\"mck-skeleton-line-70p-thick\"></ngx-skeleton-loader>\n                                </h2>\n                                <p>\n                                    <ngx-skeleton-loader class=\"mck-skeleton-line-70p-thin\"></ngx-skeleton-loader>\n                                    <ngx-skeleton-loader class=\"mck-skeleton-line-70p-thin\"></ngx-skeleton-loader>\n                                    <ngx-skeleton-loader class=\"mck-skeleton-line-50p-thin\"></ngx-skeleton-loader>\n                                </p>\n                                <ngx-skeleton-loader class=\"mck-skeleton-load-more\"></ngx-skeleton-loader>\n                                <ngx-skeleton-loader class=\"mck-skeleton-line-80p-thin\"></ngx-skeleton-loader>\n                                <p>\n                                    <ngx-skeleton-loader class=\"mck-skeleton-line-30p-thin\"></ngx-skeleton-loader>\n                                    <ngx-skeleton-loader class=\"mck-skeleton-line-50p-thin\"></ngx-skeleton-loader>\n                                    <ngx-skeleton-loader class=\"mck-skeleton-line-50p-thin\"></ngx-skeleton-loader>\n                                </p>\n                                <ngx-skeleton-loader class=\"mck-skeleton-room-availability\"></ngx-skeleton-loader>\n                                <ngx-skeleton-loader class=\"mck-skeleton-line-50p-thick\"></ngx-skeleton-loader>\n                            </div>\n                        </div>\n                        <div class=\"v-panel\" *ngIf=\"!loading\">\n                            <div>\n                                <h2>\n                                    <img src=\"assets/icon/details-note.svg\">\n                                    Booking Details\n                                </h2>\n                                <p><strong>Host:</strong> {{host}}</p>\n                                <p><strong>Attendees:</strong> {{attendeesString}}</p>\n                                <p *ngIf=\"companyString\"><strong>Company:</strong> {{companyString}}</p>\n                                <p><strong>Charge code:</strong> {{chargeCode}}</p>\n                                <p><strong>Headcount estimate:</strong> {{headcount}}</p>\n                                <p><strong>Additional requirements:</strong> {{requirements}}</p>\n\t\t\t\t\t\t\t\t<p *ngIf=\"opt_out\">Email notification for this booking has been opt out. </p>\n\n                                <button\n                                    mat-stroked-button class=\"mck-secondary-button mck-modal-secondary-button\"\n                                    [disabled]=\"disableUpdateDetailsButton\"\n                                    (click)=\"toggleUpdateView()\"\n                                >\n                                    Update details\n                                </button>\n                            </div>\n                            <div *ngIf=\"roomHasCatering\">\n                                <h2>\n                                    <img src=\"assets/icon/catering.svg\">\n                                    Catering\n                                </h2>\n                                <h3>Catering available for this room</h3>\n                                <button\n                                    mat-stroked-button class=\"mck-secondary-button mck-modal-secondary-button\"\n                                    [disabled]=\"disableCateringButton\"\n                                    (click)=\"addCatering()\"\n                                >\n                                    Add catering\n                                </button>\n\n                                <catering-order-table [booking]=\"_data?.booking\"></catering-order-table>\n                            </div>\n                        </div>\n                        <div class=\"v-panel\" *ngIf=\"loading\">\n                            <div>\n                                <h2>\n                                    <ngx-skeleton-loader class=\"mck-skeleton-line-50p-thick\"></ngx-skeleton-loader>\n                                </h2>\n                                <ngx-skeleton-loader class=\"mck-skeleton-line-45p-thin\"></ngx-skeleton-loader>\n                                <ngx-skeleton-loader class=\"mck-skeleton-line-70p-thin\"></ngx-skeleton-loader>\n                                <ngx-skeleton-loader class=\"mck-skeleton-line-50p-thin\"></ngx-skeleton-loader>\n                                <ngx-skeleton-loader class=\"mck-skeleton-line-60p-thin\"></ngx-skeleton-loader>\n                                <ngx-skeleton-loader class=\"mck-skeleton-line-45p-thin\"></ngx-skeleton-loader>\n                                <ngx-skeleton-loader class=\"mck-skeleton-line-50p-thin\"></ngx-skeleton-loader>\n                            </div>\n                            <div *ngIf=\"roomHasCatering\">\n                                <h2>\n                                    <ngx-skeleton-loader class=\"mck-skeleton-line-50p-thick\"></ngx-skeleton-loader>\n                                </h2>\n                                <h3>\n                                    <ngx-skeleton-loader class=\"mck-skeleton-line-70p-thick\"></ngx-skeleton-loader>\n                                </h3>\n                                <ngx-skeleton-loader class=\"mck-skeleton-line-50p-thin\"></ngx-skeleton-loader>\n                            </div>\n                        </div>\n                    </div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"booking-details-modal-actions\" *ngIf=\"!expandedAvailability\">\n\t\t\t\t\t<mat-dialog-actions>\n\t\t\t\t\t\t<mck-modal-button-row\n\t\t\t\t\t\t\t*ngIf=\"!loading\"\n\t\t\t\t\t\t\tprimaryLabel=\"Close\"\n\t\t\t\t\t\t\t(primarySubmit)=\"close()\">\n\t\t\t\t\t\t</mck-modal-button-row>\n\t\t\t\t\t\t<ngx-skeleton-loader *ngIf=\"loading\" class=\"mck-skeleton-load-more\"></ngx-skeleton-loader>\n\t\t\t\t\t</mat-dialog-actions>\n\t\t\t\t</div>\n                </div>\n\t\t\t\t\n            </mck-modal>\n\n            \n        </div>\n\n        <room-availability-preview\n            *ngIf=\"expandedAvailability\"\n            [dateTz]=\"_data?.booking?.startDateTz\"\n            [alternativeWeekStartDateTz]=\"alternativeWeekStartDateTz\"\n            [duration]=\"_data?.booking?.duration\"\n            [currentBooking]=\"_data.booking\"\n            [bookings]=\"byIdResults.value\"\n            [bookingId]=\"_data?.booking?.id\"\n            [building]=\"_data.booking.room.building\"\n            [level]=\"_data?.booking?.space?.level\"\n            [space]=\"_data?.booking?.space\"\n            [expanded]=\"expandedAvailability\"\n            [currentUser]=\"currentUser\"\n            (handleExpand)=\"handleClose(true)\"\n            (updateCalendarWeekView)=\"updateCalendarWeekView($event)\"\n            (confirmChanges)=\"confirmChanges($event)\"\n        ></room-availability-preview>\n\n        <div *ngIf=\"showDetails\">\n            <app-booking-edit\n                *ngIf=\"!loading\"\n                [booking]=\"_data?.booking\"\n                (closeCallback)=\"toggleUpdateView($event)\"\n                (updateCallback)=\"updateBookingState($event)\"\n            ></app-booking-edit>\n            <ngx-skeleton-loader *ngIf=\"loading\" class=\"mck-skeleton-load-more-100p\"></ngx-skeleton-loader>\n        </div>\n        <div *ngIf=\"showCatering\">\n            <booking-catering\n                [form]=\"form\"\n\t\t\t\t[isOccurence]=\"true\"\n                [booking]=\"_data?.booking\"\n                (event)=\"saveBookingWithCatering($event)\"\n                (showCatering)=\"addCatering()\"\n            ></booking-catering>\n        </div>\n    `,\n\tstyleUrls: ['./booking-details-modal.component.scss']\n})\nexport class BookingDetailsModalComponent extends BaseDirective implements OnInit {\n\tpublic TopBarHeaderMode = TopBarHeaderMode;\n\tpublic title: string;\n\tpublic roomName: string;\n\tpublic roomLocation: string;\n\tpublic host: string;\n\tpublic hostEmail: string;\n\tpublic type: string;\n\tpublic status: string;\n\tpublic statusText: string = '';\n\tpublic statusImage: string;\n\tpublic durationString: string;\n\tpublic dateString: string;\n\tpublic timeString: string;\n\tpublic capacity: number;\n\tpublic attendeesString: string;\n\tpublic chargeCode: string;\n\tpublic headcount: number;\n\tpublic requirements: string;\n\tpublic showDetails: boolean;\n\tpublic warningMessage: string;\n\tpublic mapUrl: string;\n\tpublic focusedRoom: string;\n\tpublic expandedLocation = false;\n\tpublic isRecurrentBooking = false;\n\n\tpublic checkingExtendable: boolean;\n\tpublic extendableMaximum: number;\n\n\tpublic receiptionEmail: string;\n\n\tpublic data = new BehaviorSubject<BookingFormData | undefined>(undefined);\n\tpublic byIdResults = new BehaviorSubject<any | undefined>(undefined);\n\n\t// Track event date changes in the UI in this param\n\tpublic alternativeWeekStartDateTz: DateTZ;\n\t/** Current User */\n\tpublic currentUser: User;\n\tpublic expandedAvailability: boolean = false;\n\t// Set in the room availablity callback\n\tpublic mobile: boolean = false;\n\tpublic loading: boolean = false;\n\tpublic showInfoBanner: boolean = false;\n\tpublic showWarningBanner: boolean = false;\n\tpublic showCatering: boolean = false;\n\t/** Application settings for bookings */\n\tpublic settings: BookingFlowSettings;\n\tpublic form: FormGroup;\n\tpublic companyString: string;\n\n\tinvalidDueToOfficeRule: boolean;\n\tbuildings: SelectOption<any>[];\n\tmaster_booking: Booking;\n\n\tprivate recurrence_period: RecurrencePeriod;\n\tprivate recurrence_interval: number;\n\toccurrence_details: { start_epoch: number; dateTz: DateTZ; id: string; }[];\n\tdisableSeriesEditButton: boolean = false;\n\topt_out: boolean;\n\t/** List of available booking fields for the form */\n\tpublic get available_fields(): AvailableBookingFields[] {\n\t\treturn this.settings?.show_fields || [];\n\t}\n\n\tpublic get emailURL() {\n\t\treturn `mailto:${encodeURIComponent(this.receiptionEmail)}?cc=${encodeURIComponent(this.hostEmail)}&subject=Enquiry%3A%20${encodeURIComponent(this.roomName)}&body=Details%3A%0ADate%3A%20${encodeURIComponent(this.dateString)}%0ATime%3A%20${encodeURIComponent(this.timeString)}%0A${encodeURIComponent(this.type)}%20meeting%20(${encodeURIComponent(this.durationString)})%0AAddress%3A%20${encodeURIComponent(this.roomLocation)}%0ARoom%3A%20${encodeURIComponent(this.roomName)}%0ACapacity%3A%20${encodeURIComponent(this.capacity)}%20people%0A%0ANeeding%20assistance%20with%3A%0A`;\n\t}\n\n\tpublic disableCancelButton: boolean = false;\n\tpublic disableEditTimeButton: boolean = false;\n\tpublic disableUpdateDetailsButton: boolean = false;\n\n\tprivate _specific_dates = false;\n\n\n\tconstructor(\n\t\t private router: Router,\n        private route: ActivatedRoute,\n\t\t@Inject(MAT_DIALOG_DATA) public _data: any,\n\t\tprivate dialogRef: MatDialogRef<BookingDetailsModalComponent>,\n\t\tprivate store: Store<RoomResultsState>,\n\t\tpublic _bookings: BookingsService,\n\t\tprivate _service: ApplicationService,\n\t\tprivate _spaces: SpacesService,\n\t\tprivate dialog: MatDialog,\n\t) {\n\t\tsuper();\n\t\tthis.roomLocation = this._data.booking.room.street_and_city;\n\t\tthis.initDisplayValues(this._data.booking);\n\t\tthis.timeout('slowinit', () => {\n\t\t\tthis.initDisplayValues(this._data.booking);\n\t\t\tif (this._data.cancel && this.displayCancelModal()) {\n\t\t\t\tthis.cancelBooking();\n\t\t\t}\n\t\t\tif (this._data.addCatering && this.roomHasCatering) {\n\t\t\t\tthis.addCatering();\n\t\t\t}\n\t\t\t// Close up the loader panel\n\t\t\tthis.timeout('hide modal mask', () => {\n\t\t\t\tthis._data.hasLoaderUrl = false;\n\t\t\t}, 300);\n\t\t}, 1000);\n\t}\n\n\n\tpublic ngOnInit() {\n\n\t\t/**\n\t\t * Update booking recurrence and occurrence details based on master booking data.\n\t\t *\n\t\t * This code block checks if there is a master booking available in the data.\n\t\t * If a master booking exists, it extracts recurrence period and interval information,\n\t\t * and processes occurrence details, excluding the current booking itself. Occurrence\n\t\t * start epochs are converted to milliseconds and date-time strings are created in the\n\t\t * building's timezone.\n\t\t */\n\t\tif(this._data?.master_booking !== null) {\n\t\t\tthis.recurrence_period = this._data?.master_booking?.recurrence_period;\n\t\t\tthis.recurrence_interval = this._data?.master_booking?.recurrence_interval;\n\n\t\t\tthis.occurrence_details = this._data?.master_booking?.occurrence_details && this._data?.master_booking?.occurrence_details\n\t\t\t\t.filter(ocurrence => ocurrence.id !== this._data.master_booking.id)\n\t\t\t\t.map(ocurrence => ({\n\t\t\t\t\t...ocurrence,\n\t\t\t\t\tstart_epoch: ocurrence.start_epoch * 1000, // Convert start epoch to milliseconds\n\t\t\t\t\tdateTz: new DateTZ({\n\t\t\t\t\t\tdate: ocurrence.start_epoch * 1000, // Create a DateTZ object with the converted epoch\n\t\t\t\t\t\tis_local_tz: false,\n\t\t\t\t\t\tbuilding_tz: this._data.master_booking.timezone\n\t\t\t\t\t})\n\t\t\t\t}));\n\n\t\t}\n\n\n\t\tthis.subscription('currentUser', this.store.select(selectCurrentUser)\n\t\t\t.pipe(take(1))\n\t\t\t.subscribe((user: User | undefined) => {\n\t\t\t\t// Once we know we have the user loaded.\n\t\t\t\tthis.currentUser = new User(user);\n\t\t\t})\n\t\t);\n\n\t\tthis.subscription('byId', this.store.pipe(\n\t\t\tselect(selectFilteredByIdResults)\n\t\t).subscribe(next => {\n\t\t\t// Should be fired when loading by ID in URL\n\t\t\tthis.byIdResults.next(next.success?.spaces?.length ? next.success.spaces[0].settings.bookings : EMPTY_ARRAY);\n\t\t}));\n\n\t\tthis._spaces.initialised.pipe(first((_) => _)).subscribe(() => {\n\t\t\tthis.settings = this._service.setting('app.booking');\n\t\t\tthis.form = generateBookingForm(this._data.booking, this.available_fields);\n\t\t});\n\n\t\tconst breakpoint = 450;\n\t\tif (window) {\n\t\t\tthis.mobile = window.innerWidth < breakpoint;\n\t\t}\n\n\t\tfromEvent(window, 'resize').pipe(throttleTime(500)).pipe(tap({\n\t\t\tnext: val => {\n\t\t\t\tconst target = val.target as Window;\n\t\t\t\tthis.mobile = target.innerWidth < breakpoint;\n\t\t\t}\n\t\t})).subscribe();\n\n\n\t\tthis.subscription('buildings', this.store.pipe(\n\t\t\tselect(buildingStateSelector),\n\t\t\tselect(selectBuildingOptionsGroupedByCity),\n\t\t\tmap((grouped: Map<BuildingCity, Building[]>) => {\n\t\t\t\treturn flattenDisplayOffices(grouped);\n\t\t\t}),\n\t\t\tdistinctUntilChanged()\n\t\t).subscribe(next => {\n\t\t\tthis.buildings = next;\n\t\t\t!this.showDetails && this.dispatchToGetFloorCurrentStatus(this._data.booking);\n\t\t}));\n\n\n\t}\n\n\n\tpublic get disableCateringButton() {\n\t\tswitch (this.status) {\n\t\t\tcase 'cancelled':\n\t\t\tcase 'declined':\n\t\t\tcase 'expired':\n\t\t\t\treturn true\n\t\t\tdefault:\n\t\t\t\treturn !cateringAllowed(this._data?.booking, this._data.booking.room.building);\n\t\t}\n\t}\n\n\tpublic get roomHasCatering() {\n\t\treturn roomHasCateringHours(this._data.booking.room.building, this._data.booking?.room);\n\t}\n\n\tpublic get catering() {\n\t\treturn this._data.booking?.catering || [];\n\t}\n\n\tpublic formatDeliveryTime(order) {\n\t\treturn this._data.booking.startDateTz.addValue({ minutes: order?.delivery_time }).formatDate(\"h:mma\");\n\t}\n\n\tpublic initDisplayValues(booking: Booking) {\n\t\tconst roomEmail = booking.room.email || '';\n\t\tthis.dateString = dateBuildingFormatString(booking.startDateTz, true);\n\t\tthis.timeString = startEndTimeWithZoneFormatString(booking.startDateTz, booking.displayEndDateTz);\n\t\tthis.host = booking.organiser.name;\n\t\tthis.opt_out = booking.opt_out;\n\t\tthis.hostEmail = booking.organiser.email;\n\t\tthis.title = booking.title;\n\t\tthis.type = toTitleCase(booking.booking_type);\n\t\tthis.roomName = booking.room.local_name || '';\n\t\tthis.durationString = humaniseDuration(booking.duration);\n\t\tthis.capacity = booking.room.capacity;\n\t\tthis.attendeesString = booking.attendees.map(a => a.name).join(', ');\n\t\tthis.chargeCode = booking.equipment_codes[roomEmail];\n\t\tthis.headcount = booking.expected_attendees[roomEmail];\n\t\tthis.mapUrl = booking.room.level.map_url;\n\t\tthis.extendableMaximum = 0;\n\t\tthis.focusedRoom = `area-${booking.room.map_id}-status`;\n\t\tthis.checkingExtendable = false;\n\t\tthis.receiptionEmail = this._data.booking.room.building?._settings?.discovery_info?.reception_email || '';\n\t\tthis.companyString = booking.company.join(', ');\n\t\t// UI button availability\n\t\tthis.disableCancelButton = true; // CSS hide disabled\n\t\tthis.disableEditTimeButton = true;\n\t\tthis.disableUpdateDetailsButton = true;\n\t\tthis.isRecurrentBooking = (booking.recurrence_type !== null || booking.recurrence_type === '') && booking.recurrence_period !== null ? true : false;\n\n\t\t// Room Availability modal start date\n\t\tthis.setAlternativeWeekStartDate(booking.startDateTz);\n\n\t\t// Get the equiptment notes\n\t\tconst requirements = booking.notes.find(n => {\n\t\t\tif (n.type === 'equipment') {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\t\tthis.requirements = requirements ? requirements.message : '';\n\n\t\t// Setup the UI status based on the booking approval status\n\t\tif (booking.status) {\n\t\t\t// mark bookings before today expired\n\t\t\tconst orgStatus = booking.status;\n\t\t\tthis.status = booking.status;\n\t\t\tconst recentlyExpired = DateNow(new Date()).subtractValue({ minutes: 5 }).isBeforeDate(booking.startDateTz.addValue({ minutes: booking.duration }));\n\t\t\tif (!['declined', 'cancelled'].includes(booking.status)) {\n\t\t\t\tthis.status = DateNow(new Date()).isAfterDate(booking.startDateTz.addValue({ minutes: booking.duration })) ? 'expired' : booking.status;\n\t\t\t}\n\n\t\t\tif(this._data.master_booking && this._data.master_booking.status === 'tentative' ) {\n\t\t\t\tthis.disableSeriesEditButton = true;\n\t\t\t}\n\n\t\t\tswitch (this.status) {\n\t\t\t\tcase 'tentative':\n\t\t\t\t\tthis.statusImage = 'assets/icon/booking_pending.svg';\n\t\t\t\t\tthis.statusText = 'Pending';\n\t\t\t\t\tthis.disableCancelButton = false;\n\t\t\t\t\tthis.disableUpdateDetailsButton = false;\n\t\t\t\t\tthis.disableEditTimeButton = false;\n\t\t\t\t\t// Verify the booking date makes it updatable.\n\t\t\t\t\tif (DateNow(new Date()).isAfterDate(booking.startDateTz)) {\n\t\t\t\t\t\t// disable edit date time\n\t\t\t\t\t\tthis.disableEditTimeButton = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'accepted':\n\t\t\t\t\tthis.statusImage = 'assets/icon/booking_confirmed.svg';\n\t\t\t\t\tthis.statusText = 'Confirmed';\n\t\t\t\t\tthis.disableCancelButton = false;\n\t\t\t\t\tthis.disableUpdateDetailsButton = false;\n\t\t\t\t\tthis.disableEditTimeButton = false;\n\t\t\t\t\tthis.checkingExtendable = true;\n\t\t\t\t\t// edit date time on but returns to tenative on save\n\t\t\t\t\tthis.findMaxExtension().then(v => {\n\t\t\t\t\t\tthis.extendableMaximum = v;\n\t\t\t\t\t\tthis.checkingExtendable = false;\n\t\t\t\t\t});\n\t\t\t\t\t// Verify the booking date makes it updatable.\n\t\t\t\t\tif (DateNow(new Date()).isAfterDate(booking.startDateTz)) {\n\t\t\t\t\t\t// disable edit date time\n\t\t\t\t\t\tthis.disableEditTimeButton = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'approved':\n\t\t\t\t\tthis.statusImage = 'assets/icon/booking_confirmed.svg';\n\t\t\t\t\tthis.statusText = 'Confirmed';\n\t\t\t\t\tthis.disableCancelButton = false;\n\t\t\t\t\tthis.disableUpdateDetailsButton = false;\n\t\t\t\t\tthis.disableEditTimeButton = false; // BLOCKED: API doesn't update 'approval_status' on save.\n\t\t\t\t\tthis.checkingExtendable = true;\n\t\t\t\t\t// edit date time on, back to pending on change.\n\t\t\t\t\tthis.findMaxExtension().then(v => {\n\t\t\t\t\t\tthis.extendableMaximum = v;\n\t\t\t\t\t\tthis.checkingExtendable = false;\n\t\t\t\t\t});\n\t\t\t\t\t// Verify the booking date makes it updatable.\n\t\t\t\t\tif (DateNow(new Date()).isAfterDate(booking.startDateTz)) {\n\t\t\t\t\t\t// disable edit date time\n\t\t\t\t\t\tthis.disableEditTimeButton = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'declined':\n\t\t\t\t\tthis.statusImage = 'assets/icon/booking_cancelled.svg';\n\t\t\t\t\tthis.statusText = 'Cancelled';\n\t\t\t\t\t// you can edit time and go back to pending\n\t\t\t\t\tthis.extendableMaximum = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'cancelled':\n\t\t\t\t\tthis.statusImage = 'assets/icon/booking_cancelled.svg';\n\t\t\t\t\tthis.statusText = 'Cancelled';\n\t\t\t\t\tthis.extendableMaximum = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'expired':\n\t\t\t\t\tthis.statusImage = 'assets/icon/booking_expired.svg';\n\t\t\t\t\tthis.statusText = 'Expired';\n\t\t\t\t\tthis.extendableMaximum = 0;\n\n\t\t\t\t\tif (recentlyExpired && ['accepted', 'approved'].includes(orgStatus)) {\n\t\t\t\t\t\tthis.checkingExtendable = true;\n\t\t\t\t\t\tthis.findMaxExtension().then(v => {\n\t\t\t\t\t\t\tthis.extendableMaximum = v;\n\t\t\t\t\t\t\tthis.checkingExtendable = false;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault: // TODO What is an appropriate default ? And refactor where else this is common.\n\t\t\t\t\tthis.statusImage = 'assets/icon/booking_expired.svg';\n\t\t\t\t\tthis.statusText = 'Expired';\n\t\t\t\t\tthis.extendableMaximum = 0;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic listItems(order) {\n\t\treturn order.items.map(i => `(${i.amount}) ${i.name}`).join(', ');\n\t}\n\n\tpublic expandLocation() {\n\t\tthis.expandedLocation = true;\n\t}\n\n\tpublic handleClose(fetchRooms: boolean = false) {\n\t\tthis.expandedLocation = false;\n\t\tthis.expandedAvailability = false;\n\t\tif (fetchRooms) {\n\t\t\tthis.fetchRooms(false);\n\t\t\tthis.invalidDueToOfficeRule && this.alertIfItHasConflict(false, true);\n\t\t\tthis.invalidDueToOfficeRule = false;\n\t\t}\n\t}\n\n\tpublic close(flag: string = '') {\n\t\tthis.dialogRef.close(flag);\n\t}\n\n\t/**\n\t * Check if there are any booking collisions with the new booking time\n\t * @param room_id 'sys-' id of room in question\n\t * @param date proposed booking time\n\t * @param duration proposed booking length (in minutes)\n\t */\n\tprivate async findMaxExtension(): Promise<number> {\n\t\tconst setupInSeconds = this._data.booking.setup[this._data.booking.room.email] || 0;\n\t\tconst breakdownInMinutes = this._data.booking.breakdown[this._data.booking.room.email] ? this._data.booking.breakdown[this._data.booking.room.email] / 60 : 0;\n\n\t\t// Add a seconds, since the end time ends in :59, and add the setup time\n\t\tconst endTz = this._data.booking.endDateTz.addValue({ seconds: setupInSeconds + 1 });// (this._data.booking.date + this._data.booking.duration*60000)*0.001 -1\n\t\tconst params = {\n\t\t\troom_ids: this._data.booking.room.id,\n\t\t\tdateTz: endTz, // (((end + 60 + setupSeconds) * 1000)),\n\t\t\tduration: 60 + breakdownInMinutes,\n\t\t\thide_bookings: true,\n\t\t};\n\n\t\treturn await this._spaces\n\t\t\t.available(params, null, false)\n\t\t\t.then(\n\t\t\t\t(list) => {\n\t\t\t\t\t// measure gap in booking instead and have options\n\t\t\t\t\tconst gapInMinutes = ((list[0].available_until - (endTz.seconds - 60)) / 60);\n\t\t\t\t\tconst value = Math.min(60, gapInMinutes);\n\t\t\t\t\treturn value >= 15 ? value : 0;\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t);\n\t}\n\n\tpublic toggleUpdateView() {\n\t\tthis.showDetails = !this.showDetails;\n\t\t!this.showDetails && this.dispatchToGetFloorCurrentStatus(this._data.booking);\n\t}\n\n\n\n\n\tpublic getLocation(booking: Booking): any {\n\n\t\tif (this.buildings && booking.building_zone) {\n\t\t\treturn this.buildings.find(b => booking.building_zone === b.value);\n\t\t}\n\t\treturn [];\n\t}\n\n\n\t/**\n * Dispatches data for getting the current status of the booking floor.\n *\n * This function prepares and dispatches necessary data to retrieve the current status\n * of the booking floor.\n *\n * @param {Object} booking - The booking details object, containing room, date, duration, etc.\n * @param {boolean} editingSeries - A boolean indicating whether the booking is part of a series and being edited.\n\n */\n\tpublic dispatchToGetFloorCurrentStatus(booking, editingSeries: boolean = false) {\n\t\tconst timezone = booking.timezone;\n\t\tconst { capacity, internal_or_external } = booking.room;\n\t\tconst roomOption = capacity < 3 ? 0 : (capacity > 2 && capacity < 10) ? 1 : 2;\n\t\tconst roomSize = roomSizeOptions[roomOption];\n\n\t\t// Process recurrence data if the booking is part of a series being edited\n\t\tlet recurringBookingData = {};\n\t\tlet recurrenceStart = [];\n\t\tif(booking.is_recurrent && editingSeries) {\n\n\t\t\tthis._data.master_booking.occurrence_details.forEach(element => {\n\t\t\t\trecurrenceStart.push(new DateTZ({ date: element.start_epoch * 1000, is_local_tz: false, building_tz: timezone}));\n\t\t\t});\n\t\t\trecurrenceStart = recurrenceStart.sort((d1: DateTZ, d2: DateTZ) => d1.ms - d2.ms);\n\n\t\t\tconst {\n\t\t\t\tid,\n\t\t\t\trecurrence_period,\n\t\t\t\trecurrence_interval,\n\t\t\t\trecurrence_count,\n\t\t\t\tis_recurrent,\n\t\t\t\trecurrence_exceptions,\n\t\t\t\trecurrence_pattern,\n\t\t\t\trecurrence_days,\n\t\t\t\trecurrenEndFromOcurrences,\n\t\t\t\toccurrence_details,\n\t\t\t\toccurrence_edits,\n\t\t\t\toccurrence_ids,\n\t\t\t\trecurrence_type,\n\t\t\t\trecurrence_master_id,\n\t\t\t\tedits } = this._data.master_booking\n\n\t\t\tconst rec_endTz = recurrenEndFromOcurrences.bind(this._data.master_booking);\n\t\t\tconst recurrence_endTz = rec_endTz(occurrence_details)\n\n\n\n\n\t\t\trecurringBookingData = {\n\t\t\t\tid:id,\n\t\t\t\trecurrence_period: recurrence_period,\n\t\t\t\trecurrence_interval: recurrence_interval || 1,\n\t\t\t\trecurrence_endTz: recurrence_endTz, //this._data.master_booking.recurrence_endTz,\n\t\t\t\trecurrence_count: recurrence_count || 1,\n\t\t\t\tis_recurrent: is_recurrent,\n\t\t\t\trecurrence_starts: recurrenceStart,\n\t\t\t\trecurrence_exceptions: recurrence_exceptions || [],\n\t\t\t\trecurrence_pattern: recurrence_pattern || \"weekly\", //Helper value to store the last selected pattern (daily, weekly, monthly),\n\t\t\t\trecurrence_days: recurrence_days || [],\n\n\t\t\t\toccurrence_details: occurrence_details,\n        occurrence_edits: occurrence_edits || null,\n        occurrence_ids: occurrence_ids || null,\n        recurrence_type: recurrence_type || null,\n        recurrence_master_id: recurrence_master_id,\n\t\t\t\tedits: edits\n\t\t\t}\n\t\t};\n\n\n\t\tconst formGroup: BookingFormData = {\n\t\t\tlocation: [this.getLocation(booking)],\n\t\t\t//date: booking.date,\n\t\t\t// dateTz: recurrenceStart[0], //building_tz: timezone\n\t\t\tdateTz: recurrenceStart.length >=1 ? recurrenceStart[0] : closestToTimeSlotTz(new DateTZ({ date: Date.now(), is_local_tz: false }),\t15\t).toZone(timezone),\n\t\t\tduration: booking.duration,\n\t\t\tbookingType: internal_or_external === 'internal' ? bookingTypeOptions[0] : bookingTypeOptions[1],\n\t\t\troomSize: roomSize,\n\t\t\tselectedRoom: null,\n\t\t\ttimezone: timezone,\n\t\t\t// buildings: buildings,\n\t\t\t...this._data?.master_booking?.toJSON(),\n\t\t\t...recurringBookingData,\n\t\t\topt_out:booking.opt_out,\n\t\t\taction: 'edit_booking'\n\n\t\t};\n\n\t\t// Clear existing form and result data, then dispatch the updated form data\n\t\tthis.clearFormAndResultData();\n\t\tthis.store.dispatch(storeBookingFormData({ payload: formGroup }));\n\n\t\t// Dispatch a request to load available rooms based on the updated form data\n\t\tthis.store.dispatch(loadRoomsForResultsMap.request(roomFormDataToQuery(formGroup)))\n\t}\n\n\t/**\n * Opens a modal for editing a recurring series of bookings.\n */\n\tpublic editRecurringSeries() {\n\t\t// Dispatch the current status of the booking floor for editing the recurring series\n\t\tthis.dispatchToGetFloorCurrentStatus(this._data.booking, true);\n\n\t\tconst dialog_ref = this.dialog.open(RoomBookingModalComponent, {\n\t\t\t\tpanelClass: 'mck-modal',\n\t\t\t\tautoFocus: false,\n\t\t\t\tbackdropClass: 'mck-modal-backdrop',\n\t\t\t\tdata: {\n\t\t\t\t\tnavigateTo: this.navigateT0Search.bind(this),\n\t\t\t\t\taction: SeriesAction.EDIT, // Indicates the action type (editing a series)\n\t\t\t\t}\n\t\t});\n\n\t\t// Subscribe to the modal's closed event to handle the result\n\t\tdialog_ref.afterClosed().subscribe((flag) => {\n\t\t\t// Close the modal if the operation was successful (flag is truthy)\n\t\t\tflag && this.close(flag); //console.log('ROOM MODAL CLOSED')\n\t\t});\n\n\t}\n\n\tnavigateT0Search() {\n\t\tthis.router.navigate(['../home/results'], { relativeTo: this.route });\n\t}\n\n\n\tpublic clearFormAndResultData() {\n\t\tthis.store.dispatch(clearBookingFormData());\n\t\tthis.store.dispatch(loadRoomsForResults.clear());\n\t}\n\n\n\tpublic toggleEditView() {\n\t\tthis.fetchRooms(true);\n\t\tthis.expandedAvailability = true;\n\t}\n\n\tpublic updateBookingState(booking: Booking) {\n\t\tthis._data.booking = booking;\n\t\tthis.initDisplayValues(booking);\n\t\tthis.store.dispatch(loadBookingsWithQuery({ 'id': booking.id, 'email': this.currentUser.email, 'target': 'bookingById', 'offset': 0 }));\n\t\t// reload all booking for user from - apps/staff/src/app/booking/room-booking/room-booking.component.ts\n\t\tthis._data.refresh(); //\n\t}\n\n\tpublic cancelBooking(opts: { series?: boolean } = {}) {\n\t\t// Open the cancel booking modal\n\t\tthis.dialog.open(CancelBookingModalComponent, {\n\t\t\tpanelClass: 'mck-noexpand',\n\t\t\tdata: {\n\t\t\t\t...this._data,\n\t\t\t\t...opts,\n\t\t\t\tcallback: () => {\n\t\t\t\t\tconst booking = this._data.booking.clone();\n\t\t\t\t\tthis._data.booking.delete(opts).then(\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t// @TODO:API The deleted record is still being returned for quite some time regardless of timeout.\n\t\t\t\t\t\t\tthis._data.refresh()\n\t\t\t\t\t\t\t// this.timeout('refresh', () => this._data.refresh(), 1000);\n\t\t\t\t\t\t\t// Heap track event\n\t\t\t\t\t\t\tthis._service.analytics.track('delete', {\n\t\t\t\t\t\t\t\tbooking_id: booking.id,\n\t\t\t\t\t\t\t\toffice: booking.room.building.name,\n\t\t\t\t\t\t\t\troom: booking.room.name,\n\t\t\t\t\t\t\t\tstart_time: booking.startDateTz.ms,\n\t\t\t\t\t\t\t\tend_time: booking.endDateTz.ms,\n\t\t\t\t\t\t\t\tcatering: !!booking.catering.legth,\n\t\t\t\t\t\t\t\theadcount: booking?.expected_attendees[booking.room.email],\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\t(err) => {\n\t\t\t\t\t\t\tthis.displayWarningBanner(getStatusErrorMessage(err?.status));\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tautoFocus: false,\n\t\t\tbackdropClass: 'mck-modal-backdrop',\n\t\t});\n\t}\n\n\tpublic extendBooking() {\n\t\t// open the extend booking modal\n\t\tconst dialogRefX = this.dialog.open(BookingDurationModalComponent, {\n\t\t\tpanelClass: 'mck-noexpand',\n\t\t\tdata: {\n\t\t\t\tbooking: this._data.booking,\n\t\t\t\tmaximum: this.extendableMaximum,\n\t\t\t},\n\t\t\tautoFocus: false,\n\t\t\tbackdropClass: 'mck-modal-backdrop',\n\t\t});\n\n\t\tdialogRefX.afterClosed().subscribe((booking?: Booking) => {\n\t\t\tif (booking) {\n\t\t\t\tthis.updateBookingState(booking);\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic displayCancelModal() {\n\t\t// Can the display cancel modal open? If it isn't one of these statuses\n\t\treturn !['cancelled', 'expired', 'declined'].includes(this.status);\n\t}\n\n\n\tpublic confirmChanges(data: DateDurationData) {\n\t\t// Confirm the changes returned from the room availability modal.\n\t\tthis.mobile = data.mobile;\n\t\tthis.setAlternativeWeekStartDate(data.dateTz);\n\n\t\t// New booking flow has this.data\n\t\tif (this.data.value) {\n\t\t\tthis.fetchRooms(true, this.alternativeWeekStartDateTz);\n\t\t\t// submit\n\t\t\tthis.store.dispatch(storeBookingFormData({\n\t\t\t\tpayload: {\n\t\t\t\t\t...this.data.value,\n\t\t\t\t\tdateTz: data.dateTz,\n\t\t\t\t\tduration: data.duration,\n\t\t\t\t}\n\t\t\t}));\n\t\t} else if (data.save) {\n\t\t\t// update booking date/duration\n\t\t\tconst booking = this._data.booking.clone();\n\t\t\tconst pendingChanges = booking.duration !== data.duration || booking.startDateTz.ms !== data.dateTz.ms;\n\t\t\t// booking.duration = data.duration;\n\t\t\tbooking.startDateTz = data.dateTz; // date = data.dateTz.ms;\n\t\t\tbooking.endDateTz = data.dateTz.addValue({ minutes: data.duration });\n\t\t\tthis.loading = true;\n\n\t\t\tconst roomRules = rulesForSpace({\n\t\t\t\ttime: booking.date,\n\t\t\t\tduration: booking.duration,\n\t\t\t\tuser: this.currentUser,\n\t\t\t\trules: this._data.booking.room.building?.booking_rules,\n\t\t\t\tspace: booking.room\n\t\t\t});\n\n\t\t\t// Rooms requiring approval are reset to tentative when the time changes.\n\t\t\tif (pendingChanges && !roomRules?.auto_approve) {\n\t\t\t\t// https://acaprojects.atlassian.net/browse/MCK-1481\n\t\t\t\t/**\n\t\t\t\t * Having 2 ways of containing the status is icky but until PlaceOS\n\t\t\t\t * depreciates approval_status it's necessry.\n\t\t\t\t */\n\t\t\t\t// booking.approval_status[booking.room.email] = \"tentative\";\n\t\t\t\tbooking.status = \"tentative\";\n\t\t\t\tbooking.time_changed = true;\n\t\t\t}\n\t\t\telse if (roomRules.reason === SpaceFilterReason.OfficeRules) {\n\t\t\t\t// this.alertIfItHasConflict(false, true);\n\t\t\t\tthis.invalidDueToOfficeRule = true;\n\t\t\t\tthis.loading = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// booking.save() won't use the toAPIJSON conversion so use the booking service.\n\t\t\tthis._bookings.save(booking).then(\n\t\t\t\t(bkn) => {\n\t\t\t\t\t// update booking\n\t\t\t\t\tthis.updateBookingState(booking);\n\t\t\t\t\tthis.form = generateBookingForm(booking, this.available_fields);\n\t\t\t\t\tthis.loading = false;\n\t\t\t\t\tthis.displayInfoBanner();\n\t\t\t\t\tbooking.room.building.name\n\t\t\t\t\tthis._service.analytics.track('update', {\n\t\t\t\t\t\tbooking_id: booking.id,\n\t\t\t\t\t\toffice: booking.room.building.name,\n\t\t\t\t\t\troom: booking.room.global_name,\n\t\t\t\t\t\tstart_time: booking.startDateTz.ms,\n\t\t\t\t\t\tend_time: booking.endDateTz.ms,\n\t\t\t\t\t\tcatering: !!booking.catering.legth,\n\t\t\t\t\t\theadcount: booking.head_count,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t(err) => {\n\t\t\t\t\tthis.loading = false;\n\t\t\t\t\tthis.expandedAvailability = false;\n\t\t\t\t\tthis.displayWarningBanner(getStatusErrorMessage(err?.status));\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t *  Open dialog if booking date and time is out of office rule\n\t *  TO DO :  Redundant code - same validaiton been applied over room detail while creating new booking - need to handle more graceful way. better if user been prohibited from choose future date if out of office rule on show avaialability calender itself\n\t *  related to - https://acaprojects.atlassian.net/browse/MCK-2419\n\t */\n\n\talertIfItHasConflict(isBookable, isAvailable) {\n\t\t// this.isAlertDisplayed = true;\n\t\tconst data = {\n\t\t\theaderText: !isBookable ? SpaceConflictAlertModalData.NotBookableHeaderText : !isAvailable ? SpaceConflictAlertModalData.NotAvailableHeaderText : '',\n\t\t\tmessage: SpaceConflictAlertModalData.NotBookableDueToOfficeRule,\n\t\t\tbuttonLabel: 'Close',\n\t\t\tcallback: () => null,\n\t\t\tshouldClose: false\n\t\t};\n\t\tconst dialog = this.dialog.open(ConflictAlertModalComponent,\n\t\t\t{\n\t\t\t\tdata: data,\n\t\t\t\tpanelClass: 'mck-alert',\n\t\t\t\tautoFocus: false,\n\t\t\t\tbackdropClass: 'mck-modal-backdrop',\n\t\t\t\tdisableClose: !isBookable\n\t\t\t});\n\t}\n\n\n\n\tpublic displayInfoBanner() {\n\t\tthis.showInfoBanner = true;\n\t\tthis.timeout('close banner', () => {\n\t\t\tthis.showInfoBanner = false;\n\t\t}, 3000);\n\t}\n\n\tpublic displayWarningBanner(custom: string) {\n\t\tthis.warningMessage = custom;\n\t\tthis.showWarningBanner = true;\n\t\tthis.timeout('close banner', () => {\n\t\t\tthis.showWarningBanner = false;\n\t\t}, 10000);\n\t}\n\n\tpublic hideInfoBanner() {\n\t\tthis.showInfoBanner = false;\n\t}\n\n\tpublic hideWarningBanner() {\n\t\tthis.showWarningBanner = false;\n\t}\n\n\tpublic setAlternativeWeekStartDate(bookingDate: DateTZ) {\n\t\tif (!bookingDate) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.mobile) {\n\t\t\tthis.alternativeWeekStartDateTz = bookingDate.clone();\n\t\t} else {\n\t\t\tthis.alternativeWeekStartDateTz = bookingDate.clone().startOfValue('week').startOfValue('day');\n\t\t}\n\t}\n\n\tpublic updateCalendarWeekView(alternativeWeekStartDateTz: DateTZ) {\n\t\tthis.alternativeWeekStartDateTz = alternativeWeekStartDateTz.clone();\n\t\tthis.fetchRooms(true, this.alternativeWeekStartDateTz);\n\t}\n\n\tpublic fetchRooms(allWeek: boolean = true, alternativeWeekStartDateTz: DateTZ = null) {\n\t\tif (!this._data?.booking?.space?.id) {\n\t\t\treturn\n\t\t}\n\n\t\tconst day = 24 * 60;\n\t\tconst week = day * 7;\n\t\tconst date = (alternativeWeekStartDateTz || this._data?.booking?.startDateTz).clone(); // new DateTZ({date: alternativeWeekStartDateTz || this._data?.booking?.date});\n\t\tconst startOfDay = date.startOfValue('day').setValue({ second: 0, millisecond: 0 });\n\t\tconst startOfWeek = date.startOfValue('week');\n\n\t\t// Query for the entire day for this room\n\t\tconst query = {\n\t\t\tdateTz: allWeek ? startOfWeek : startOfDay,\n\t\t\tduration: allWeek ? week : day,\n\t\t\tlocations: this._data?.booking?.space?.id,\n\t\t\tcapacity: this._data?.booking?.space?.capacity,\n\t\t};\n\t\tthis.store.dispatch(loadByIdResults.request(query));\n\t}\n\n\tpublic addCatering() {\n\t\t// For the Add Catering button\n\t\tthis.showCatering = true;\n\t}\n\n\tpublic saveBookingWithCatering(form: FormGroup) {\n\t\t// Response from the catering modal closing\n\t\t// Close catering and confirmation modals and just show booking details modal\n\t\tif (!form) {\n\t\t\tthis.showCatering = false;\n\t\t\tthis.showDetails = false;\n\t\t\treturn;\n\t\t}\n\t\t// Update the booking state.\n\t\tconst booking = this._data.booking.clone();\n\t\tbooking.catering = form.controls.catering.value;\n\n\t\tif (booking.catering.length) {\n\t\t\tconst setup = {};\n\t\t\tsetup[booking.room.email] = booking.setup[booking.room.email] || 900;\n\t\t\tconst breakdown = {};\n\t\t\tbreakdown[booking.room.email] = booking.breakdown[booking.room.email] || 900;\n\n\t\t\tbooking.setup = setup\n\t\t\tbooking.breakdown = breakdown\n\t\t}\n\n\t\tthis.updateBookingState(booking);\n\t}\n\n\tpublic set specific_dates(val: boolean) {\n\t\tthis._specific_dates = val;\n\t}\n\n\tpublic get specific_dates(): boolean {\n\t\treturn this._specific_dates;\n\t}\n\n\n\tpublic toggleSpecificDates() {\n\t\tthis.specific_dates = !this.specific_dates;\n\t}\n\n\n}\n","import {\n    Component,\n    Inject,\n    OnInit,\n    ViewEncapsulation\n} from '@angular/core';\nimport {\n    BaseDirective,\n  } from '@mckinsey-converge/base';\nimport {\n    Booking,\n    BookingsService,\n    DEFAULT_BOOKING_DURATION,\n} from '@mckinsey-converge/data-common';\nimport {\n    MAT_DIALOG_DATA,\n    MatDialogRef\n} from '@angular/material/dialog';\nimport {\n    FormControl,\n    FormGroup,\n    Validators\n} from '@angular/forms';\nimport * as cloneDeep from 'lodash/cloneDeep';\n\ninterface extendData {\n    booking: Booking;\n    maximum: number\n}\n\n@Component({\n    selector: 'app-booking-duration-modal',\n    template: `\n        <mat-dialog-content class=\"booking-duration-content\">\n            <div class=\"fixed warning banner\" *ngIf=\"showWarningBanner\">\n                <img src=\"assets/icon/booking_cancelled.svg\"/>\n                <p class=\"banner-text\">Your booking failed to update, please try again</p>\n                <img src=\"assets/icon/close-red.svg\" (click)=\"hideWarningBanner()\"/>\n            </div>\n            <div class=\"mck-column modal-heading\">\n                <button name=\"CloseButton\" class=\"close-button\" mat-icon-button (click)=\"closeModal()\">\n                    <div class=\"close-image\"></div>\n                </button>\n                <div class=\"info\">Extend booking duration</div>\n            </div>\n            <div class=\"mck-column modal-body\">\n                <mck-duration-field\n                    class=\"time-inputs\"\n                    label=\"End time\"\n                    name=\"end-time\"\n                    [startDate]=\"formGroup.controls.dateTz.value.ms\"\n                    [required]=\"true\"\n                    [ngModel]=\"formGroup.controls.duration.value\"\n                    [ngModelOptions]=\"{ standalone: true }\"\n                    (ngModelChange)=\"formGroup.controls.duration.setValue($event)\"\n                    [extended]=\"true\"\n                    [durationGroups]=\"durationGroups\"\n                    [timezone]=\"data.booking?.timezone\"\n                >\n                </mck-duration-field>\n            </div>\n            <div class=\"mck-column modal-body-footer\">\n                <mck-modal-button-row\n                    [disableFixed]=\"true\"\n                    primaryLabel=\"Extend\"\n                    (primarySubmit)=\"updateBookingDuration()\"\n                    secondaryLabel=\"Back\"\n                    (secondarySubmit)=\"closeModal()\"\n                ></mck-modal-button-row>\n            </div>\n        </mat-dialog-content>\n    `,\n    styleUrls: ['./booking-duration-modal.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n})\nexport class BookingDurationModalComponent extends BaseDirective implements OnInit {\n\n    public loading: string;\n    public showWarningBanner: boolean = false;\n\n    public get durationGroups() {\n        const step = 15;\n        const steps = Math.floor(this.data.maximum / step);\n        const max = (steps * step) + this.data.booking.duration;\n\n        return [{\n            start: this.data.booking.duration,\n            step,\n            max\n        }];\n    }\n\n    public formGroup = new FormGroup({\n        date: new FormControl(this.data.booking.date, [Validators.required]),\n        dateTz: new FormControl(this.data.booking.startDateTz, [Validators.required]),\n        duration: new FormControl(DEFAULT_BOOKING_DURATION, [Validators.required]),\n    });\n\n    constructor(\n            @Inject(MAT_DIALOG_DATA) public data: extendData,\n            private dialogRef: MatDialogRef<BookingDurationModalComponent>,\n            public _bookings: BookingsService,\n        ) {\n        super();\n    }\n\n    ngOnInit() {\n        this.formGroup.setValue({\n            date: this.data.booking.date,\n            dateTz: this.data.booking.startDateTz,\n            duration: this.data.booking.duration,\n        });\n    }\n\n    public closeModal(booking?: Booking) {\n        this.dialogRef.close(booking);\n    }\n\n    public updateBookingDuration() {\n        const formData = this.formGroup.getRawValue();\n        this.loading = 'Saving...';\n\n        // clone booking to allow editing\n        // const booking = this.data.booking.clone(); // this line commented for bug appearing in CNG-352. Used cloneDeep instead\n        const booking = cloneDeep(this.data?.booking);\n        booking.endDateTz = booking.startDateTz.addValue({ minutes: formData.duration });\n        this._bookings.save(booking).then(\n            () => {\n                this.loading = null;\n                this.closeModal(booking);\n            },\n            (err) => {\n                this.loading = null;\n                this.displayWarningBanner()\n            }\n        );\n    }\n\n\n    public displayWarningBanner() {\n        this.showWarningBanner = true;\n        this.timeout('close banner', () => {\n            this.showWarningBanner = false;\n        }, 10000);\n    }\n\n    public hideWarningBanner() {\n        this.showWarningBanner= false;\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output,\n    OnInit,\n} from '@angular/core';\nimport { BookingResultsViewModel } from '../manage-bookings/manage-bookings.viewmodel';\nimport {\n    BaseDirective,\n    shorterLocalDateFormatString,\n    timeWithZoneFormatString,\n    startEndTimeFormatString,\n    humaniseDuration,\n    closestToTimeSlotTz,\n} from '@mckinsey-converge/base';\nimport { DateNow, DateTZ, localTimezone } from \"@mckinsey-converge/date-tz\";\nimport { Booking, BookingFormData, BookingStoreState, bookingTypeOptions, Building, BuildingCity, clearBookingFormData, defaultRoomSizeOption, DEFAULT_BOOKING_DURATION, flattenDisplayOffices, roomFormDataToQuery, roomSizeOptions, storeBookingFormData } from '@mckinsey-converge/data-common';\nimport { buildingStateSelector, BuildingStoreState, selectBuildingOptionsGroupedByCity } from '@mckinsey-converge/buildings';\nimport {\n    select,\n    Store\n} from '@ngrx/store';\nimport {\n    BehaviorSubject,\n} from 'rxjs';\n\nimport { distinctUntilChanged, map } from 'rxjs/operators';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { loadRoomsForResults, loadRoomsForResultsMap } from '@mckinsey-converge/rooms';\nimport { MyBookingsStoreState } from '@mckinsey-converge/bookings';\nimport { UserStoreState } from '@mckinsey-converge/user';\n\nexport type RoomBookingStoreState = BookingStoreState & BuildingStoreState & MyBookingsStoreState & UserStoreState;\n@Component({\n    selector: 'app-booking-result-item',\n    templateUrl: './booking-result-item.component.html',\n    styleUrls: ['./booking-result-item.component.scss']\n})\nexport class BookingResultItemComponent extends BaseDirective implements OnInit {\n    /**\n     * If undefined, we display in loading state.\n     */\n    @Input()\n    public viewModel: BookingResultsViewModel | undefined;\n    \n    @Input()\n    public bookings: BookingResultsViewModel[];\n\n    @Input()\n    public list: string;\n\n    @Input() public index: number;\n\n    @Input() public small: boolean = false;\n\n    @Output()\n    public bookingSelect = new EventEmitter<BookingResultsViewModel>();\n\n    public buildings = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public roomName: string;\n    public roomLocation: string;\n    public host: string;\n    public status: string;\n    public timeStringParts: string[] = [' ', ' '];\n    public localTimeStringParts: string[] = [' ', ' '];\n    public isAnotherTimezone: boolean = false;\n    public statusText: string;\n    public statusImage: string;\n    public durationString: string;\n    public timeRangeString: string;\n    public building: any;\n    public get dateString() {\n        if (!this.bookings || !this.bookings.length) return '';\n        const bkn1 = this.bookings[this.index].booking;\n        const d1 = new DateTZ({ date: bkn1.startDateTz.ms, is_local_tz: false, building_tz: bkn1.startDateTz.building_tz });\n        if (this.index === 0) {\n            return shorterLocalDateFormatString(d1);\n        }\n        const bkn2 = this.bookings[this.index - 1].booking;\n        const d2 = new DateTZ({ date: bkn2.startDateTz.ms, is_local_tz: false, building_tz: bkn2.startDateTz.building_tz });\n        if (!d1.isSameDate(d2, 'day')) {\n            return shorterLocalDateFormatString(d1);\n        }\n        return '';\n    }\n    public get todayString() {\n        if (!this.bookings || !this.bookings.length) {\n            return '';\n        }\n        \n        // Strip the booking of it's timezone infomation so isSameDate is just based on timestamp and local time.\n        const d1 = new DateTZ({ date: this.bookings[this.index].booking.startDateTz.ms });\n        return DateNow(new Date()).isSameDate(d1, 'day') ? '(Today)' : '';\n    }\n\n    public get attendeesCount(): number {\n        // allAttendees is booking.attendees + 1 (booking.organizer)\n        return this.viewModel.booking?.allAttendees.length; \n    }\n\n    public get has_catering(): number {\n        return this.viewModel.booking?.has_catering && this.viewModel.booking?.catering?.length;\n    }\n\n    public get upcoming() {\n        return ['tentative', 'accepted', 'approved'].includes(this.status);\n    }\n\n    constructor(private store: Store<RoomBookingStoreState>) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.setupDisplayFields();\n        this.subscription('buildings', this.store.pipe(\n            select(buildingStateSelector),\n            select(selectBuildingOptionsGroupedByCity),\n            map((grouped: Map<BuildingCity, Building[]>) => {\n                return flattenDisplayOffices(grouped);\n            }),\n            distinctUntilChanged()\n        ).subscribe(next => {\n            this.buildings.next(next);\n        }));\n    }\n\n    public hasData() {\n        return this.viewModel !== undefined;\n    }\n\n    public setupDisplayFields() {  \n        if (!this.viewModel?.booking) {\n            return;\n        }\n        this.timeStringParts = timeWithZoneFormatString(this.viewModel.booking.startDateTz).split(' ');\n        this.timeRangeString = startEndTimeFormatString(this.viewModel.booking.startDateTz, this.viewModel.booking.displayEndDateTz);\n        this.isAnotherTimezone = !this.viewModel.booking.startDateTz.is_local_tz;\n        this.localTimeStringParts = timeWithZoneFormatString(this.viewModel.booking.startDateTz.toZone(localTimezone())).split(' ');\n        this.host = this.viewModel.booking.organiser.name;\n        this.roomName = this.viewModel.booking.room.local_name;\n        this.roomLocation = this.viewModel.booking.room.street_and_city;\n        this.durationString = humaniseDuration(this.viewModel.booking.duration, 'medium');\n\n        if (this.viewModel.booking.status) {\n            // mark bookings before today expired\n            this.status = (DateNow(new Date()).isAfterDate(this.viewModel.booking.endDateTz) && this.list !== 'cancelled') ? 'expired' : this.viewModel.booking.status;\n            switch(this.status) {\n                case 'tentative':\n                    this.statusImage = 'assets/icon/booking_pending.svg';\n                    this.statusText = 'Pending';\n                    break;\n                case 'accepted':\n                    this.statusImage = 'assets/icon/booking_confirmed.svg';\n                    this.statusText = 'Confirmed';\n                    break;\n                case 'approved':\n                    this.statusImage = 'assets/icon/booking_confirmed.svg';\n                    this.statusText = 'Confirmed';\n                    break;\n                case 'declined':\n                    this.statusImage = 'assets/icon/booking_cancelled.svg';\n                    this.statusText = 'Cancelled';\n                    break;\n                case 'cancelled':\n                    this.statusImage = 'assets/icon/booking_cancelled.svg';\n                    this.statusText = 'Cancelled';\n                    break;\n                case 'expired':\n                    this.statusImage = 'assets/icon/booking_expired.svg';\n                    this.statusText = 'Expired';\n                    break;\n                default: // TODO\n                    this.statusImage = 'assets/icon/booking_expired.svg';\n                    this.statusText = 'Expired';\n                break;\n            }\n        }\n        return;\n    }\n\n}\n","<h3 *ngIf=\"dateString\">\n    {{ dateString }} <span>{{ todayString }}</span>\n</h3>\n<div class=\"mck-row result-container\">\n    <div class=\"result-row datetime\" [class.skeleton]=\"!hasData()\">\n        <div *ngIf=\"hasData()\">\n            <div class=\"status-block\">\n                <div class=\"booking-tz-display\">\n                    {{ timeStringParts[0] }} ({{ timeStringParts[1] }}) ({{\n                        durationString\n                    }})\n                </div>\n                <div *ngIf=\"isAnotherTimezone\" class=\"local-tz-display\">\n                    {{ localTimeStringParts[0] }} ({{ localTimeStringParts[1] }}) in your\n                    local timezone\n                </div>\n            </div>\n        </div>\n        <ng-container *ngIf=\"!hasData()\">\n            <ngx-skeleton-loader class=\"mck-skeleton-line-80p\"></ngx-skeleton-loader>\n            <ngx-skeleton-loader class=\"mck-skeleton-line-2\"></ngx-skeleton-loader>\n            <ngx-skeleton-loader class=\"mck-skeleton-line-30p\"></ngx-skeleton-loader>\n        </ng-container>\n    </div>\n    <div class=\"result-row status\" [ngClass]=\"status\">\n        <div *ngIf=\"hasData()\">\n            <div class=\"message\"><img [src]=\"statusImage\" /> {{ statusText }}</div>\n            <div class=\"time\">\n                {{ timeRangeString }}\n            </div>\n        </div>\n        <ngx-skeleton-loader class=\"mck-skeleton-status\" *ngIf=\"!hasData()\"> </ngx-skeleton-loader>\n    </div>\n    <div class=\"result-row panel\">\n        <div class=\"mobile-only-cta\" *ngIf=\"hasData()\" (click)=\"bookingSelect.emit(viewModel)\">\n            <div class=\"right-arrow\" alt=\"Right Arrow\" aria-label=\"Details Arrow\"></div>\n        </div>\n        <div class=\"result-row title\">\n            <ng-container *ngIf=\"hasData()\">\n                <div class=\"type-title\">{{ viewModel.booking.title }}</div>\n                <span class=\"type-text\" [ngClass]=\"viewModel.booking.bookingTypeId\">{{\n                    viewModel.booking.bookingTypeLabel\n                }}</span>\n                <button mat-ripple (click)=\"bookingSelect.emit(viewModel)\">View Details</button>\n            </ng-container>\n            <ng-container *ngIf=\"!hasData()\">\n                <ngx-skeleton-loader class=\"mck-skeleton-line-50p\"></ngx-skeleton-loader>\n            </ng-container>\n        </div>\n        <div class=\"result-row text\">\n            <ng-container *ngIf=\"hasData()\">\n                <span><img src=\"assets/icon/room-icon.svg\" />{{ roomName }}</span>\n                <span><img src=\"assets/icon/location-icon.svg\" />{{ roomLocation }}</span>\n                <span><img src=\"assets/icon/host-icon.svg\" />Host: {{ host }}</span>\n                <span><img src=\"assets/icon/attendees-icon.svg\" />{{ attendeesCount }}pp</span>\n                <span *ngIf=\"has_catering\"><img src=\"assets/icon/catering-icon.svg\" />Catered</span>\n            </ng-container>\n            <ng-container *ngIf=\"!hasData()\">\n                <ngx-skeleton-loader class=\"mck-skeleton-line-3\"></ngx-skeleton-loader>\n                <ngx-skeleton-loader class=\"mck-skeleton-line-70p\"></ngx-skeleton-loader>\n                <ngx-skeleton-loader class=\"mck-skeleton-line-3\"></ngx-skeleton-loader>\n                <ngx-skeleton-loader class=\"mck-skeleton-line-50p\"></ngx-skeleton-loader>\n                <ngx-skeleton-loader class=\"mck-skeleton-line-50p\"></ngx-skeleton-loader>\n            </ng-container>\n        </div>\n    </div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { RoomBookingComponent } from 'src/app/booking/room-booking/room-booking.component';\nimport { RoomResultsComponent } from 'src/app/booking/room-results/room-results.component';\nimport { RoomDetailsComponent } from 'src/app/booking/room-details/room-details.component';\nimport { BookingCreateComponent } from './booking-create/booking-create.component';\nimport { BookingEditWrapperComponent } from './booking-create/booking-edit-wrapper.component';\nimport { RoomFiltersModalComponent } from 'src/app/booking/room-filters-modal/room-filters-modal.component';\nimport { ManageBookingsComponent } from './manage-bookings/manage-bookings.component';\nimport { OfficeFloorComponent } from './office-floor/office-floor/office-floor.component';\n\nconst routes: Routes = [\n    {\n        path: 'results',\n        component: RoomResultsComponent,\n    },\n    {\n        path: 'results/filter',\n        component: RoomFiltersModalComponent,\n    },\n    {\n        path: 'results/room',\n        component: RoomDetailsComponent,\n    },\n    {\n        path: 'create',\n        component: BookingCreateComponent,\n    },\n    {\n        path: 'edit',\n        component: BookingEditWrapperComponent,\n    },\n    {\n        path: 'manage',\n        component: ManageBookingsComponent,\n    },\n    {\n        path: 'catering/:id',\n        data: { hasCatering: true },\n        component: ManageBookingsComponent,\n    },\n    {\n        path: 'booking/:id/:verb',\n        component: ManageBookingsComponent,\n    },\n    {\n        path: 'booking/:id',\n        component: ManageBookingsComponent,\n    },\n    {\n        path: 'floor-map',\n        component: OfficeFloorComponent,\n    },\n    {\n        path: 'results/booking-calendar',\n        loadChildren: () => import('./booking-calendar/booking-calendar.module').then((m) => m.BookingCalendarModule),\n    },\n    {\n        path: '**',\n        component: RoomBookingComponent,\n    },\n];\n\n@NgModule({\n    imports: [RouterModule.forChild(routes)],\n    exports: [RouterModule],\n})\nexport class BookingRoutingModule {}\n","import {\n    createReducer,\n    on\n} from '@ngrx/store';\nimport { \n    BookingFormState,\n    clearBookingFormData,\n    clearRoomFilters,\n    openBookingSurvey,\n    storeBookingFormData,\n    storeRoomFilters\n} from '@mckinsey-converge/data-common';\n\nexport const initialBookingFormState: BookingFormState = {\n    activeFormFilters: []\n};\n\nexport const bookingFormReducer = createReducer(initialBookingFormState,\n    on(storeBookingFormData, (state: BookingFormState, action) => {\n        return {\n            ...state,\n            activeForm: {\n                ...state.activeForm,\n                ...action.payload\n            }\n        } as BookingFormState;\n    }),\n    on(clearBookingFormData, state => ({\n        ...state,\n        activeForm: {\n            location: state?.activeForm?.location\n        }\n    }) as BookingFormState),\n    on(openBookingSurvey, state => ({\n        ...state,\n        bookingCompleted: new Date()\n    }) as BookingFormState),\n    on(storeRoomFilters, (state: BookingFormState, action) => {\n        return {\n            ...state,\n            activeFormFilters: action.payload\n        } as BookingFormState;\n    }),\n    on(clearRoomFilters, (state: BookingFormState) => ({\n        ...state,\n        activeFormFilters: initialBookingFormState.activeFormFilters\n    }) as BookingFormState)\n);\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { BookingRoutingModule } from './booking-routing.module';\nimport { BookingsListingComponent } from './bookings-listing/bookings-listing.component'\nimport { RoomBookingComponent } from './room-booking/room-booking.component';\nimport { RoomDetailsComponent } from './room-details/room-details.component';\nimport { BookingFormBaseComponent } from './booking-create/booking-form-base.component';\nimport { BookingCreateComponent } from './booking-create/booking-create.component';\nimport { BookingEditComponent } from './booking-create/booking-edit.component';\nimport { BookingConfirmationComponent } from './booking-confirmation/booking-confirmation.component';\nimport { UiModule } from '@mckinsey-converge/ui';\nimport { NgxMatSelectSearchModule } from 'ngx-mat-select-search';\nimport { MatSelectModule } from '@angular/material/select';\nimport {\n    FormsModule,\n    ReactiveFormsModule\n} from '@angular/forms';\nimport { SharedContentModule } from 'src/app/shared/shared.module';\nimport { MatButtonModule } from '@angular/material/button';\nimport { StoreModule } from '@ngrx/store';\nimport { bookingFormReducer } from 'src/app/booking/booking.form.reducer';\nimport { BookingResultItemComponent } from './booking-result-item/booking-result-item.component';\nimport { BookingDetailsModalComponent } from './booking-details-modal/booking-details-modal.component';\nimport { BookingDurationModalComponent } from './booking-duration-modal/booking-duration-modal.component';\nimport { CancelBookingModalComponent } from './cancel-booking-modal/cancel-booking-modal.component';\nimport { ManageBookingsComponent } from './manage-bookings/manage-bookings.component';\nimport { RoomResultsComponent } from './room-results/room-results.component';\nimport { SearchedLocationComponent } from './searched-location/searched-location.component';\nimport { ResultsHeaderComponent } from './results-header/results-header.component';\nimport { RoomAvailabilityPreviewComponent } from './room-availability-preview/room-availability-preview.component';\nimport { RoomLocationPreviewComponent } from './room-location-preview/room-location-preview.component';\nimport { RoomResultItemComponent } from './room-result-item/room-result-item.component';\nimport { RoomBookingFormComponent } from './room-booking-form/room-booking-form.component';\nimport { RoomBookingDetailsFormComponent } from './room-booking-details-form/room-booking-details-form.component';\nimport { RoomBookingModalComponent } from './room-booking-modal/room-booking-modal.component';\nimport { RoomResultsPaginatedComponent } from './room-results-paginated/room-results-paginated.component';\nimport { RoomFiltersModalComponent } from './room-filters-modal/room-filters-modal.component';\nimport { RoomFiltersFormComponent } from './room-filters-form/room-filters-form.component';\nimport { RoomAvailabilityPreviewModalComponent } from './room-availability-preview-modal/room-availability-preview-modal.component';\nimport { MapModule } from 'src/app/map/map.module';\nimport { OfficeFloorMapModule } from 'src/app/booking/office-floor/office-floor-map.module';\nimport { NgxSkeletonLoaderModule } from 'ngx-skeleton-loader';\nimport { RoomResultsSectionComponent } from './room-results-section/room-results-section.component';\nimport { CalendarModule, DateAdapter } from 'angular-calendar';\nimport { adapterFactory } from 'angular-calendar/date-adapters/date-fns';\nimport { BookingCateringComponent } from './catering/catering.component';\nimport { OrderTableComponent } from './catering/order-table/order-table.component';\nimport { BookingCateringOrderDetailsComponent } from './catering/order-details/order-details.component';\nimport { BookingCateringOrderListComponent } from './catering/order-list/order-list.component';\nimport { CateringOrderListItemComponent } from './catering/order-list/item/item.component';\nimport { CateringMenuCategoryComponent }  from './catering/order-details/category/category.component';\nimport { SurveyModalComponent } from '../components/survey-modal/survey-modal.component';\nimport { BookingEditWrapperComponent } from './booking-create/booking-edit-wrapper.component';\n\nexport const bookingModuleDeclarations = [\n    BookingFormBaseComponent,\n    BookingCreateComponent,\n    BookingEditComponent,\n    BookingConfirmationComponent,\n    BookingDetailsModalComponent,\n    BookingDurationModalComponent,\n    BookingsListingComponent,\n    BookingResultItemComponent,\n    CancelBookingModalComponent,\n    ManageBookingsComponent,\n    BookingCateringComponent,\n    BookingCateringOrderDetailsComponent,\n    BookingCateringOrderListComponent,\n    CateringMenuCategoryComponent,\n    CateringOrderListItemComponent,\n    RoomBookingComponent,\n    RoomDetailsComponent,\n    RoomResultsComponent,\n    SearchedLocationComponent,\n    ResultsHeaderComponent,\n    RoomAvailabilityPreviewComponent,\n    RoomLocationPreviewComponent,\n    RoomResultItemComponent,\n    RoomBookingModalComponent,\n    RoomBookingFormComponent,\n    RoomBookingDetailsFormComponent,\n    RoomResultsPaginatedComponent,\n    RoomFiltersModalComponent,\n    RoomFiltersFormComponent,\n    RoomResultsSectionComponent,\n    RoomAvailabilityPreviewModalComponent,\n    CateringMenuCategoryComponent,\n    OrderTableComponent,\n    SurveyModalComponent,\n    BookingEditWrapperComponent\n];\n\nexport const bookingModuleImports = [\n    CommonModule,\n    UiModule,\n    MatSelectModule,\n    MatButtonModule,\n    NgxMatSelectSearchModule,\n    ReactiveFormsModule,\n    SharedContentModule,\n    FormsModule,\n    NgxSkeletonLoaderModule,\n    MapModule,\n    CalendarModule.forRoot({\n        provide: DateAdapter,\n        useFactory: adapterFactory,\n    }),\n    OfficeFloorMapModule\n];\n\n\n@NgModule({\n    declarations: [...bookingModuleDeclarations],\n    imports: [\n        ...bookingModuleImports,\n        BookingRoutingModule,\n        StoreModule.forFeature('bookingForm', bookingFormReducer)\n    ]\n})\nexport class BookingModule {\n}","import { Component, Input, OnInit, OnChanges } from '@angular/core';\nimport { throttleTime, tap } from 'rxjs/operators';\nimport { fromEvent } from 'rxjs';\nimport { TopBarHeaderMode } from 'src/app/components/topbar-header/topbar-header.component';\nimport { select, Store } from '@ngrx/store';\nimport { BehaviorSubject } from 'rxjs';\nimport { take } from 'rxjs/operators';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { BuildingStoreState } from '@mckinsey-converge/buildings';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Booking, User, IEngineResponse, BookingStoreState, clearBookingFormData, BookingsService } from '@mckinsey-converge/data-common';\nimport { UserStoreState } from '@mckinsey-converge/user';\nimport { loadBookingsWithQuery, MyBookingsStoreState } from '@mckinsey-converge/bookings';\nimport { LoadingModel } from '@mckinsey-converge/loading';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport {\n    mapResultsToViewModels,\n    BookingResultsViewModel,\n} from 'src/app/booking/manage-bookings/manage-bookings.viewmodel';\nimport { selectCurrentUser } from '@mckinsey-converge/user';\nimport { BookingDetailsModalComponent } from '../booking-details-modal/booking-details-modal.component';\nimport { BookingPagination } from '@mckinsey-converge/bookings';\nimport { DateNow } from '@mckinsey-converge/date-tz';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { loadRoomsForResults } from '@mckinsey-converge/rooms';\n\nexport type ManageBookingsStoreState = BookingStoreState &\n    BuildingStoreState &\n    MyBookingsStoreState &\n    UserStoreState;\n\n@Component({\n    selector: 'app-bookings-listing',\n    templateUrl: './bookings-listing.component.html',\n    styleUrls: ['./bookings-listing.component.scss'],\n})\nexport class BookingsListingComponent extends BaseDirective implements OnInit, OnChanges {\n    @Input() public config: any;\n    @Input() public buildings: BehaviorSubject<SelectOption<any>[]>;\n\n    public bookingResults = new BehaviorSubject<LoadingModel<IEngineResponse>>(\n        LoadingModel.empty()\n    );\n    public bookings: BookingResultsViewModel[];\n    public showBookings = false;\n    public reloading = false;\n    public TopBarHeaderMode = TopBarHeaderMode;\n    public mobile: boolean = false;\n\n    /** Current User */\n    public currentUser: User;\n    master_booking: BookingResultsViewModel;\n    allBookings: any[];\n\n    public pagination: BookingPagination = {\n        currentPage: 1,\n        totalRecords: 0,\n        pageLimit: 4,\n    };\n\n    public get lastPage() {\n        return this.pages.total === this.pagination.currentPage;\n    }\n\n    public get pages() {\n        const p = this.pagination;\n        const total = Math.ceil(p.totalRecords / p.pageLimit);\n        const group = Math.ceil(p.currentPage / 5);\n        const startPosition = Math.max(\n            1,\n            Math.min(group > 1 ? (group - 1) * (p.pageLimit + 1) + 1 : 1, total - 4)\n        );\n        let pages = [];\n        for (let x = startPosition; x <= Math.min(startPosition + 4, total); x++) {\n            pages.push(x);\n        }\n        if (!pages.length) {\n            pages.push(1);\n        }\n        const maxed = () => {\n            if (total <= 5 || p.currentPage >= total - 4) {\n                return false;\n            }\n            return true;\n        };\n        const mined = () => {\n            if (total <= 5 || p.currentPage < 6) {\n                return false;\n            }\n            return true;\n        };\n        const start = p.currentPage > 5;\n        const end = !(p.currentPage > total - 5);\n        return {\n            total,\n            pages,\n            min: mined(),\n            max: maxed(),\n            start,\n            end,\n        };\n    }\n\n    constructor(\n        private store: Store<ManageBookingsStoreState>,\n        private _route: ActivatedRoute,\n        private _router: Router,\n        private dialog: MatDialog,\n\t\t\t\tprivate _bookings: BookingsService,\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        const breakpoint = 450;\n        const selector = this.config.selector;\n        const target = this.config.type;\n\n        this.subscription(\n            'currentUser',\n            this.store\n                .select(selectCurrentUser)\n                .pipe(take(1))\n                .subscribe((user: User | undefined) => {\n                    // Once we know we have the user loaded.\n                    this.currentUser = new User(user);\n                    this.store.dispatch(\n                        loadBookingsWithQuery({\n                            email: this.currentUser.email,\n                            from: DateNow(new Date()).ms,\n                            target,\n                            offset: 0,\n                        })\n                    );\n                    // start the timer at the top of the minute;\n                    const offset = DateNow(new Date()).startOfValue('minute').addValue({ minutes: 1 }).ms - DateNow(new Date()).ms;\n                    // fetch it on one minute interval now that there is room data.\n                    setTimeout(() => {\n                        this.refresh(target);\n                        this.interval('refreshBookings', () => this.refresh(target), 60 * 1000);\n                    }, offset + 5000);\n                })\n        );\n        const sort_asc = (a, b) => a.date - b.date;\n        const sort_desc = (a, b) => b.date - a.date;\n\n        this.subscription(\n            'bookingResults',\n            this.store.pipe(select(selector)).subscribe((next) => {\n                this.bookingResults.next(next);\n                if (!next.isEmpty() && Array.isArray(next?.success?.results)) {\n                    let results = [...next?.success?.results].sort(\n                        this.config.reverse_sort ? sort_desc : sort_asc\n                    );\n                    this.showBookings = !!results.length;\n                    this.reloading = false;\n                    this.bookings = mapResultsToViewModels(results).filter(b => !(b.booking.is_recurrent && b.booking.recurrence_type === 'master'));\n                    this.allBookings = results;\n\t\t\t\t\t\t\t\t\t\tthis.pagination.totalRecords = next.success.total;\n                } else {\n                    this.showBookings = false;\n                    this.bookings = [];\n                    this.pagination.totalRecords = 0;\n                }\n            })\n        );\n\n        if (window) {\n            this.mobile = window.innerWidth < breakpoint;\n        }\n\n        fromEvent(window, 'resize')\n            .pipe(throttleTime(500))\n            .pipe(\n                tap({\n                    next: (val) => {\n                        const target = val.target as Window;\n                        this.mobile = target.innerWidth < breakpoint;\n                    },\n                })\n            )\n            .subscribe();\n        this.timeout('query', () =>\n            this.subscription(\n                'route.query',\n                this._route.queryParamMap.subscribe((params) => {\n                    if (params.has('page')) this.setPage(+params.get('page'), false);\n                })\n            )\n        );\n    }\n\n    public ngOnChanges($change: any) {\n        if ($change?.buildings.currentValue !== $change.buildings.previousValue) {\n            this.refresh(this.config.type);\n        }\n    }\n\n    public showResults() {\n        // Don't show the loading state while we're reloading with Building details.\n        return this.reloading || this.bookingResults?.value?.hasLoaded();\n    }\n\n    public getBuilding(booking: Booking) {\n        if (this.buildings && booking.building_zone) {\n            return this.buildings.value.find((b) => booking.building_zone === b.value)?.meta\n                .building;\n        }\n        return null;\n    }\n\n    // From the Manage Bookings page\n    public async viewBooking(viewModel: BookingResultsViewModel) {\n\n        if(viewModel.booking.is_recurrent) {\n            let booking = this.allBookings.find(bkn => bkn.id === viewModel.booking.recurrence_master_id && bkn.recurrence_type === 'master1') ;\n            if (!booking) {\n                booking = await this._bookings.show(viewModel.booking.recurrence_master_id);\n            }\n            this.master_booking = mapResultsToViewModels([booking])[0];\n        }\n\n\n        // real booking.room here.\n        const dialogRefX = this.dialog.open(BookingDetailsModalComponent, {\n            panelClass: 'mck-modal-wide-manage-booking',\n            data: {\n                booking: viewModel.booking,\n                refresh: () => {\n                    this.refresh('all');\n                },\n\n                building: this.getBuilding(viewModel.booking),\n                master_booking: this.master_booking?.booking || null,\n            },\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n\n        dialogRefX.afterClosed().subscribe((flag) => {\n            flag !== 'DoNotClearActiveForm' && this.clearFormAndResultData();\n            // this.timeout('refreshBookings', () => this.refresh('all'), 1000);\n            // this.timeout('refreshBookings', () => this.refresh('all'), 5000);\n        });\n    }\n\n    public clearFormAndResultData() {\n        this.store.dispatch(clearBookingFormData());\n        this.store.dispatch(loadRoomsForResults.clear());\n    }\n\n    public readonly prevPage = () => this.setPage(this.pagination.currentPage - 1);\n    public readonly nextPage = () => this.setPage(this.pagination.currentPage + 1);\n    public readonly prevGroup = () => this.setPage(this.pagination.currentPage - 5);\n    public readonly nextGroup = () => this.setPage(this.pagination.currentPage + 5);\n    public readonly gotoPage = (page: number) => this.setPage(page);\n\n    public setPage(page_idx: number, route: boolean = true) {\n        if (!this.pages.total) return;\n        const page = Math.max(1, Math.min(page_idx, this.pages.total));\n        if (route) this._router.navigate([], { relativeTo: this._route, queryParams: { page } });\n        this.pagination.currentPage = page;\n        this.refresh();\n    }\n\n    public refresh(target: string = this.config.type) {\n        if (!this.currentUser?.email) {\n            return;\n        }\n\n        const offset = (this.pagination.currentPage - 1) * this.pagination.pageLimit;\n        // fetch it on one minute interval now that there is room data.\n        this.store.dispatch(\n            loadBookingsWithQuery({\n                email: this.currentUser.email,\n                from: DateNow(new Date()).ms,\n                target,\n                offset,\n            })\n        );\n        this.reloading = true;\n    }\n}\n","<div class=\"mck-content-body mck-column results-container mck-scroll\">\n  <!-- <div>\n    <cng-select [data]=\"delegateDD\" *ngIf=\" hostOptions && hostOptions.length\"></cng-select>\n  </div> -->\n  \n  <div\n    class=\"mck-column mck-scroll bookings-list mck-content-expand-width mck-content-body\"\n    #resultsContainer\n  >\n    <div *ngIf=\"showResults() else loading_message\">\n      <div *ngIf=\"showBookings\">\n          <app-booking-result-item\n              *ngFor=\"let viewModel of bookings; let i = index\"\n              [small]=\"mobile\"\n              [list]=\"config.type\"\n              [viewModel]=\"viewModel\"\n              [bookings]=\"bookings\"\n              [index]=\"i\"\n              (bookingSelect)=\"viewBooking(viewModel)\">\n          </app-booking-result-item>\n      </div>\n      <div class=\"no\" [class.mini]=\"lastPage\" *ngIf=\"!showBookings || lastPage\">\n        <div *ngIf=\"config.type === 'upcoming' && !lastPage\">\n          <img src=\"assets/icon/upcoming.svg\">\n          <p>You have no upcoming bookings</p>\n        </div>\n        <div *ngIf=\"config.type === 'past'\">\n          <img src=\"assets/icon/clock-circle-filled.svg\">\n          <p>End of list. Past meetings are saved for up to 48 hours. </p>\n        </div>\n        <div *ngIf=\"config.type === 'cancelled'\">\n        <img src=\"assets/icon/clock-circle-filled.svg\">\n          <p>End of list. Cancelled meetings are saved for up to 48 hours. </p>\n        </div>\n      </div>\n    </div>\n    <ng-template #loading_message>\n        <app-booking-result-item *ngFor=\"let i of [0, 1, 2, 4]\">\n        </app-booking-result-item>\n    </ng-template>\n  </div>\n</div>\n<div class=\"pagination\">\n<ul>\n  <li (click)=\"prevPage()\"><img src=\"assets/icon/left-arrow.svg\" /></li>\n  <li (click)=\"gotoPage(1)\" *ngIf=\"pages.start\" >1</li>\n  <li (click)=\"prevGroup()\" *ngIf=\"pages.min\">...</li>\n  <li (click)=\"gotoPage(p)\" [class.active]=\"p === pagination.currentPage\"  *ngFor=\"let p of pages.pages\" >\n    {{p}}\n  </li>\n  <li (click)=\"nextGroup()\" *ngIf=\"pages.max\">...</li>\n  <li (click)=\"gotoPage(pages.total)\"  *ngIf=\"pages.end\" >\n    {{pages.total}}\n  </li>\n  <li (click)=\"nextPage()\"><img src=\"assets/icon/right-arrow.svg\" /></li>\n</ul>\n</div>","import { Component, Inject, ViewEncapsulation } from '@angular/core';\nimport {\n    dateBuildingFormatString,\n    startEndTimeWithZoneFormatString,\n} from '@mckinsey-converge/base';\nimport { Booking, Building, RecurrencePeriod } from '@mckinsey-converge/data-common';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { BaseClass } from '@mckinsey-converge/base';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\n\ninterface data {\n    booking: Booking;\n    building: Building;\n    callback: Function;\n    master_booking?: Booking;\n    hasLoaderUrl?: boolean;\n    refresh?: Function;\n\t\tseries?:{};\n}\n\n@Component({\n    selector: 'app-cancel-booking-modal',\n    template: `\n        <mat-dialog-content class=\"cancel-dialog-content\">\n            <div class=\"button-row\" *ngIf=\"!canceled\">\n                <button name=\"CloseButton\" mat-icon-button (click)=\"closeModal()\">\n                    <div class=\"close-image\"></div>\n                </button>\n            </div>\n            <div class=\"mck-column modal-heading\" [class.canceled]=\"canceled\">\n                <img src=\"assets/icon/stop.svg\" />\n                <div class=\"info\">{{ subtitle }}</div>\n            </div>\n            <div class=\"mck-column modal-body\" *ngIf=\"!canceled\">\n                <p>{{ data.booking.title }}</p>\n\n                <div\n                    class=\"banner-info-txt flex-column\"\n                    [ngSwitch]=\"recurrence_period\"\n                    *ngIf=\"data?.series\"\n                >\n                    <p *ngIf=\"recurrence_period !== 'list'\">\n                        <ng-template [ngSwitchCase]=\"'daily'\"> Daily from </ng-template>\n                        <ng-template [ngSwitchCase]=\"'weekly'\">\n                            <p>\n                                weekly on {{ data?.master_booking?.recurrence_days[0] | titlecase }}\n                            </p>\n                            <p>from</p>\n                        </ng-template>\n                        <ng-template [ngSwitchCase]=\"'monthly'\"> Monthly on </ng-template>\n\n                        {{ data?.master_booking?.dateString }} until\n                        {{ data?.master_booking?.endDateString }}\n                    </p>\n                    <ng-template ngSwitchDefault>\n                        <!-- This is one occurrence in a recurring series which occurs on<button name=\"specificdates\" type=\"button\" (click)=\"toggleSpecificDates()\">Specific Dates.</button> -->\n                        <span>Specific Dates: </span>\n                        <div class=\"hint\">\n                            <div class=\"hint-wrapper flex-column\">\n                                <div class=\"flex-row\">Date</div>\n                                <div class=\"flex-column\">\n                                    <div *ngFor=\"let occurrence of occurrence_details\" class=\"flex-row\">\n                                        {{ occurrence.dateTz.formatDate('dd MMM yyyy') }}\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </ng-template>\n                </div>\n\n                <p *ngIf=\"!data?.series\">{{ dateString }}</p>\n                <p>{{ timeString }}</p>\n                <p>{{ buildingAddress }}</p>\n                <p>{{ data.booking.room.local_name }}</p>\n            </div>\n            <div class=\"mck-column modal-body-footer\" *ngIf=\"!canceled\">\n                <mck-modal-button-row\n                    [disableFixed]=\"true\"\n                    primaryLabel=\"Yes\"\n                    (primarySubmit)=\"cancelBooking()\"\n                    secondaryLabel=\"No\"\n                    (secondarySubmit)=\"closeModal()\"\n                ></mck-modal-button-row>\n            </div>\n        </mat-dialog-content>\n    `,\n    styleUrls: ['./cancel-booking-modal.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n})\nexport class CancelBookingModalComponent extends BaseClass {\n    public title: string;\n    public roomName: string;\n    public buildingAddress: string;\n    public dateString: string;\n    public timeString: string;\n    public canceled = false;\n    private _specific_dates = false;\n    private recurrence_period: RecurrencePeriod;\n    public occurrence_details: { start_epoch: number; dateTz: DateTZ; id: string }[];\n    private recurrence_interval: number;\n\n    public get subtitle() {\n        return this.canceled\n            ? `${this.title} booking cancelled`\n            : this.data?.series\n            ? 'Are you sure you want to cancel this recurring series?'\n            : 'Are you sure you want to cancel this booking?';\n    }\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) public data: data,\n        private dialogRef: MatDialogRef<CancelBookingModalComponent>\n    ) {\n        super();\n        this.dateString = dateBuildingFormatString(this.data.booking.startDateTz, true);\n        this.timeString = startEndTimeWithZoneFormatString(this.data.booking.startDateTz, this.data.booking.displayEndDateTz);\n        this.title = this.data.booking.title;\n        this.buildingAddress = this.data.booking.room.street_and_city;\n\n\n\t\t\t\tif(this.data?.master_booking !== null) {\n\n\t\t\t\t\tthis.recurrence_period = this.data?.master_booking?.recurrence_period;\n\t\t\t\t\tthis.recurrence_interval = this.data?.master_booking?.recurrence_interval;\n\n\t\t\t\t\tthis.occurrence_details = this.data?.master_booking?.occurrence_details &&\n\t\t\t\t\t\tthis.data?.master_booking?.occurrence_details\n\t\t\t\t\t\t\t.filter((ocurrence) => ocurrence.id !== this.data?.master_booking?.id)\n\t\t\t\t\t\t\t.map((ocurrence) => ({\n\t\t\t\t\t\t\t\t...ocurrence,\n\t\t\t\t\t\t\t\tstart_epoch: ocurrence.start_epoch * 1000,\n\t\t\t\t\t\t\t\tdateTz: new DateTZ({\n\t\t\t\t\t\t\t\t\tdate: ocurrence.start_epoch * 1000,\n\t\t\t\t\t\t\t\t\tis_local_tz: false,\n\t\t\t\t\t\t\t\t\tbuilding_tz: this.data.master_booking.timezone,\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t}));\n\t\t\t\t}\n\n    }\n\n    public closeModal() {\n        this.dialogRef.close();\n    }\n\n    public cancelBooking() {\n        this.canceled = true;\n        this.data.callback();\n        this.timeout('closeModal', () => this.closeModal(), 2000);\n    }\n\n    public set specific_dates(val: boolean) {\n        this._specific_dates = val;\n    }\n\n    public get specific_dates(): boolean {\n        return this._specific_dates;\n    }\n\n    public toggleSpecificDates() {\n        this.specific_dates = !this.specific_dates;\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output,\n    OnInit\n} from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport {\n    Booking,\n    Building,\n    CateringOrder,\n    Space,\n    bookingStatusDetails,\n    ApplicationService,\n    CateringCategory,\n    BookingsService,\n    DataForConfirmation,\n    getLastDateFromList\n} from '@mckinsey-converge/data-common';\nimport {\n    DialogEvent,\n    HashMap,\n    shorterLocalDateFormatString\n} from '@mckinsey-converge/base';\nimport {\n    BaseDirective,\n    dateBuildingFormatString,\n    startEndTimeWithZoneFormatString,\n    humaniseDuration,\n    toTitleCase\n} from '@mckinsey-converge/base';\nimport { TopBarHeaderMode } from 'src/app/components/topbar-header/topbar-header.component';\nimport {\n    CateringDetailsModalComponent,\n    CateringDetailsModalData\n} from '@mckinsey-converge/legacy-overlays';\nimport { MatDialog } from '@angular/material/dialog';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\nexport interface BookingFlowEvent {\n    /** Type of flow event */\n    type: 'previous' | 'next' | 'reset' | 'close' | 'error';\n    /** Step which the event was emitted from */\n    step: string;\n    /** Additional metadata for the event */\n    metadata?: HashMap;\n}\n\n@Component({\n    selector: 'booking-catering',\n    templateUrl: './catering.component.html',\n    styleUrls: ['./catering.component.scss']\n})\nexport class BookingCateringComponent extends BaseDirective implements OnInit  {\n    /** Form fields for the booking */\n    @Input() public form: FormGroup;\n    /** Emitter for flow update events */\n    @Output() public event = new EventEmitter<FormGroup>();\n    @Input() public booking: Booking;\n    @Input() public isOccurence: boolean;\n    /** Emitter for open catering */\n    @Output() public showCatering = new EventEmitter<void>();\n    dataForConfirmation: DataForConfirmation;\n    isEditSeries: boolean = false;\n\n    constructor(\n        private _dialog: MatDialog,\n        public _service: ApplicationService,\n        public _bookings: BookingsService,\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n     this.updateConfimatinModal();\n    }\n\n    /** Active order to display details for */\n    public active_order: CateringOrder;\n    public TopBarHeaderMode = TopBarHeaderMode;\n    public confirmed: boolean = false;\n    public next_disabled: boolean = true;\n\n    public loading: boolean = false;\n\n\n    public get building(): Building {\n        return this.booking.room.building;\n    };\n\n    /** Field for storing catering details */\n    public get catering_field() {\n        return this.form && this.form.controls.catering ? this.form.controls.catering : null;\n    }\n\n    /** List of spaces selected for the booking */\n    public get space_list(): Space[] {\n        return this.form && this.form?.controls?.space_list?.value.length\n            ? this.form.controls.space_list.value\n            : [];\n    }\n\n    /** Date of the booking */\n    public get dateTz(): number {\n        return this.form && this.form.controls.dateTz\n            ? this.form.controls.dateTz.value\n            : DateNow(new Date()).startOfValue('minute');\n    }\n\n    /** Duration of the booking */\n    public get duration(): number {\n        return this.form && this.form.controls.duration ? this.form.controls.duration.value : 60;\n    }\n\n    /** Whether booking is all day */\n    public get all_day(): boolean {\n        return this.form && this.form.controls.all_day && this.form.controls.all_day.value;\n    }\n\n\n    public get type() {\n        return toTitleCase(this.booking?.class);\n    }\n\n    public get dateString() {\n        return dateBuildingFormatString(this.booking.startDateTz);\n    }\n\n    public get timeString() {\n        return startEndTimeWithZoneFormatString(this.booking.startDateTz, this.booking?.displayEndDateTz);\n    }\n\n    public get durationString() {\n        return humaniseDuration(this.booking?.duration);\n    }\n\n    public get status() {\n        return bookingStatusDetails(this.booking);\n    }\n\n    /** Create a new catering order */\n    public newOrder(): void {\n        const order = new CateringOrder({ booking_timezone: this.booking?.timezone });\n        this.active_order = order;\n    }\n\n    // Combine the same items for the same timeslot into the same order item\n    public combineItems = (newItems: CateringCategory[], oldItems: CateringCategory[]) => {\n        // Group and Sum the items in an Item ID keyed object\n        const itemsObj = {};\n        oldItems.forEach((i) => {\n            if (itemsObj[i.id]) {\n                itemsObj[i.id].setAmount(itemsObj[i.id].amount + i.amount);\n            } else {\n                itemsObj[i.id] = i;\n            }\n        });\n        newItems.forEach((i) => {\n            if (itemsObj[i.id]) {\n                itemsObj[i.id].setAmount(itemsObj[i.id].amount + i.amount);\n            } else {\n                itemsObj[i.id] = i;\n            }\n        })\n        // Convert the object to an array\n        const items = [];\n        for (const item in itemsObj) {\n            items.push(itemsObj[item]);\n        }\n        // return the items consolidated by item ID.\n        return items;\n    }\n\n    /** Handle changes to catering order */\n    public handleOrderEvent(order: CateringOrder) {\n        /* istanbul ignore else */\n        if (order) {\n            this.next_disabled = false;\n            const orders = this.form.controls.catering.value;\n            // When the order edit button is clicked we are editing an existing order\n            const index = orders.findIndex((an_order) => {\n                return order.id === an_order.id\n            });\n\n            // If editing an existing order row it will have an index, if not create a new row\n            if (index < 0) {\n                // Add the new order\n                orders.push(order);\n            } else {\n                // Replace the existing order with the edited order\n                orders.splice(index, 1, order);\n            }\n\n            // Setup the \"reduced\" data containers\n            const reduceItems = {};\n            const reduceOrders = {};\n            orders.forEach((o) => {\n                if (reduceItems[o.delivery_time]) {\n                    // An order for this timeslot already exists, combine the same items to dedupe rows\n                    reduceItems[o.delivery_time] = this.combineItems(o.items, reduceItems[o.delivery_time]);\n                } else {\n                    // Since this is a new timeslot, use the existing items\n                    reduceItems[o.delivery_time] = o.items;\n                    // Copy the order and clear its item contents, placeholder for the updated items\n                    reduceOrders[o.delivery_time] = o;\n                    reduceOrders[o.delivery_time].items = [];\n                }\n            });\n\n            // Add the reduced items to the reduced orders\n            let consolidatedOrders = [];\n            for (const deliveryTime in reduceOrders) {\n                const order = reduceOrders[deliveryTime];\n                order.items = reduceItems[deliveryTime]\n                consolidatedOrders.push(order);\n            }\n\n            this.form.controls.catering.setValue(consolidatedOrders);\n        }\n        this.active_order = null;\n    }\n\n    public closeCallback() {\n        // Bail and close the catering component\n        this.next_disabled = true;\n        this.active_order = null;\n\n        // Need to clone to avoid readonly errors\n        this.form.controls.catering.setValue(this.booking.catering.map(order => order.clone()));\n        this.event.emit();\n    }\n\n    public closeConfirmation() {\n        this.event.emit();\n    }\n\n    /** Open modal for adding equipment requirements to booking */\n    private openCateringDetailsModal() {\n        const ref = this._dialog.open<CateringDetailsModalComponent, CateringDetailsModalData>(\n            CateringDetailsModalComponent,\n            {\n                maxWidth: '95vw',\n                width: '32em',\n                data: {\n                    spaces: this.form.controls.space_list.value,\n                    notes_field: this.form.controls.notes,\n                    catering: this.form.controls.catering,\n                    booking: this.booking\n                }\n            }\n        );\n        this.subscription(\n            'modal_events',\n            ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                // Catering requirements and charge code modal closed event\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    // Closed with the reason done\n                    ref.close();\n\n                    // Display the loading animation and the Booking Confrimation component\n                    this.loading = true;\n                    this.confirmed = true;\n\n                    this.saveBooking();\n                }\n            })\n        );\n        ref.afterClosed().subscribe(() => this.unsub('modal_events'));\n    }\n\n    public saveBooking() {\n        // Clone and append the catering and note data to the booking\n        let booking = this.booking.clone();\n        booking.catering = this.form.controls.catering.value;\n        booking.notes = this.form.controls.notes.value;\n        if(booking.notes.length || booking.catering.length) {\n\n            const setup = { ...booking.setup };\n            setup[booking.space.email] =  booking.setup[booking.space.email] || 900;\n            booking.setup = setup;\n\n            const breakdown = { ...booking.breakdown };\n            breakdown[booking.space.email] = booking.breakdown[booking.space.email] || 900;\n            booking.breakdown = breakdown;\n        }\n\n\n        // Save to the API and respond. && !this.isOccurence\n        this._bookings.save(booking, booking.is_recurrent ).then(\n            (bkn) => {\n                this.booking = new Booking({ ...this.booking, ...bkn.toApiJSON() }); \n                // Stop the loading animation and show the booking confirmation component.\n                this.updateConfimatinModal();\n\n                this.loading = false;\n                this.confirmed = true;\n                this.event.emit(this.form)\n            },\n            (err) => {\n                // Stop the loading animation and return to the catering flow with an error.\n                this.loading = false;\n                this.confirmed = false;\n                this._service.notifyError(\n                    `Error updating booking.`\n                );\n            }\n        )\n    }\n\n    public handleOrderListEvent($event: any) {\n        const orders = this.form.controls.catering.value;\n        // Handle the Previous and Next buttons\n        if ($event.type === 'previous') {\n            // Bail and close the catering component\n            this.next_disabled = true;\n            this.active_order = null;\n            // Need to clone to avoid readonly errors\n            this.form.controls.catering.setValue(this.booking.catering.map(order => order.clone()));\n            this.event.emit();\n        }\n        if ($event.type === 'next') {\n            // Move on to the catering details modal\n            this.next_disabled = false;\n            if (orders.length) {\n                this.openCateringDetailsModal();\n            } else {\n                // Display the loading animation and the Booking Confrimation component\n                this.loading = true;\n                this.confirmed = true;\n                this.saveBooking();\n            }\n        }\n    }\n\n    public openCatering() {\n        // Start catering from the Booking Confirmation page Add Catering button\n        this.confirmed = false;\n        this.next_disabled = true;\n        this.showCatering.emit();\n    }\n\n    /**\n     * Public method to update the confirmation modal data.\n     * This method updates the dataForConfirmation object with the necessary information\n     * for displaying the confirmation modal in the application.\n     */\n    public updateConfimatinModal() {\n\n        // Prepare an object with booking details and related information for the confirmation modal\n        this.dataForConfirmation = {\n        booking: this.booking,  // Information about the booking\n        status: this.status,  // Status of the booking (e.g., confirmed, pending, etc.)\n        dateString: this.dateString,  // Date of the booking in string format\n        endDateString: this.endDateString,   // End date of the booking in string format\n        timeString: this.timeString,  // Time of the booking in string format\n        durationString: this.durationString,  // Duration of the booking in string format\n        type: this.type,  // Type of booking (e.g., internal, external, etc.)\n        isEditSeries: this.isEditSeries,  // Boolean indicating whether it's an edit in a series of events\n        // Function to check if there are conflicts with occurrences of the booking\n        isConflictWithOccurences: this.isConflictWithOccurences.bind(this),\n        // Function to open a modal in case of conflicts with recurring events\n        // openRecurrenceConflictsModal: this.openRecurrenceConflictsModal.bind(this)\n        }\n    }\n\n     /**\n     * Checks if there are conflicts with the current booking and its occurrences.\n     * Calculates the difference between total occurrences and available occurrences\n     * to determine if there are conflicts.\n     *\n     * @returns {Object} An object containing conflict information:\n     *   - is_conflict: A boolean indicating if there are conflicts (true if conflicts exist, false otherwise).\n     *   - total_Conflicts: The total number of conflicts (the difference between total occurrences and available occurrences).\n     */\n    public isConflictWithOccurences() {\n        const conflicts = this?.booking?.room?.totalOccurrences - this?.booking?.room?.availableOccurrences;\n        return { is_conflict: !!conflicts, total_Conflicts: conflicts };\n    }\n\n    /**\n * Retrieves the end date string for the booking, considering recurrence if applicable.\n * If the booking is recurrent, it calculates the end date based on recurrence starts;\n * otherwise, it uses the booking's start date as the end date.\n *\n * @returns {string} The formatted end date string in a shorter local date format.\n */\n  public get endDateString(): string {\n    // Determine the array of date-time strings based on recurrence or single start date\n    let recurrenceStart: Array<DateTZ>= [];\n    const { is_recurrent, recurrence_starts, occurrence_details, timezone} = this.booking;\n    if(is_recurrent && recurrence_starts.length) {\n      recurrenceStart = this.booking.recurrence_starts;\n    }\n    else if(is_recurrent && !recurrence_starts.length && occurrence_details.length) {\n      this.booking.occurrence_details.forEach(element => {\n        recurrenceStart.push(new DateTZ({ date: element.start_epoch * 1000, is_local_tz: false, building_tz: timezone}));\n      });\n      recurrenceStart = recurrenceStart.sort((d1: DateTZ, d2: DateTZ) => d1.ms - d2.ms);\n    }\n    else {\n      recurrenceStart = [this.booking.startDateTz];\n    }\n\n\n    // const endDtz = (this.booking.is_recurrent && this.booking.recurrence_starts.length) ? this.booking.recurrence_starts : [this.booking.startDateTz]\n    // Get the last date from the list of date-time strings and format it in a shorter local date format\n    return shorterLocalDateFormatString(getLastDateFromList(recurrenceStart));\n  }\n\n}\n","<div class=\"mck-column mck-content-expand mck-content-page-container catering-container fullpage-modal\">\n    <div class=\"header\">\n        <a-topbar-header\n            [mode]=\"TopBarHeaderMode.Light\"\n            [modal]=\"true\"\n            [noSurvey]=\"true\"\n            (closeCallback)=\"closeCallback()\">\n        </a-topbar-header>\n      </div>\n    <div class=\"mck-column mck-center\">\n        <div class=\"mck-column mck-content-expand-width\" *ngIf=\"!confirmed\">\n            <div class=\"catering\">\n                <ng-container *ngIf=\"!active_order; else order_display\">\n                    <a-catering-order-list\n                        [space_list]=\"space_list\"\n                        [catering]=\"catering_field\"\n                        [date]=\"date\"\n                        [all_day]=\"all_day\"\n                        [next_disabled]=\"next_disabled\"\n                        (order)=\"$event ? (active_order = $event) : newOrder()\"\n                        (event)=\"handleOrderListEvent($event)\"\n                    ></a-catering-order-list>\n                </ng-container>\n            </div>\n            <ng-template #order_display>\n                <a-catering-order-details\n                    [space_list]=\"space_list\"\n                    [order]=\"active_order\"\n                    [dateTz]=\"dateTz\"\n                    [duration]=\"duration\"\n                    [all_day]=\"all_day\"\n                    (event)=\"handleOrderEvent($event)\"\n                ></a-catering-order-details>\n            </ng-template>\n        </div>\n        <div class=\"mck-column mck-content-expand-width\" *ngIf=\"confirmed\">\n            <booking-confirmation\n                [confirmed]=\"confirmed\"\n                [loading]=\"loading\"\n                [modal]=\"true\"\n                [dataForConfirmation]=\"dataForConfirmation\"\n                (callback)=\"closeConfirmation()\"\n            ></booking-confirmation>\n        </div>\n    </div>\n</div>","import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { FormControl } from '@angular/forms';\n\nimport { CateringCategory } from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-category-display',\n    templateUrl: './category.component.html',\n    styleUrls: ['./category.component.scss']\n})\nexport class CateringMenuCategoryComponent {\n    /** Category to display details for */\n    @Input() public category: CateringCategory;\n    /** Form control for the list of order items */\n    @Input() public items: FormControl;\n    /** Currency symbol for the active space */\n    @Input() public symbol: string;\n    /** Whether item should be disabled if not available anytime */\n    @Input() public disabled: boolean;\n    /** Whether to show smaller version of component */\n    @Input() public compact: boolean;\n    /** Emitter for close events */\n    @Output() public close = new EventEmitter<void>();\n}\n","<div class=\"header\">\n    <div class=\"content\">\n        <button mat-icon-button (click)=\"close.emit()\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'arrow_back' }\"></app-icon>\n        </button>\n        <div class=\"name\">{{ category?.name }}</div>\n    </div>\n</div>\n<ng-container *ngIf=\"category.availableItems && category.availableItems.length; else empty_state\">\n    <div class=\"item\" *ngFor=\"let item of category.availableItems\">\n        <a-catering-menu-item\n            [compact]=\"compact\"\n            [disabled]=\"disabled\"\n            [symbol]=\"symbol\"\n            [item]=\"item\"\n            [field]=\"items\"\n        ></a-catering-menu-item>\n    </div>\n</ng-container>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\" i18n=\"Catering category empty label\">\n            Category contains no available items\n        </div>\n    </div>\n</ng-template>\n","import {\n    Component,\n    ElementRef,\n    EventEmitter,\n    Input,\n    OnInit,\n    Output,\n    SimpleChanges,\n    ViewChild\n} from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    FormControl,\n    FormGroup\n} from '@angular/forms';\nimport { BehaviorSubject } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nimport {\n    Building,\n    CateringCategory,\n    CateringItem,\n    CateringMenuService,\n    CateringOrder,\n    OrganisationService,\n    Space\n} from '@mckinsey-converge/data-common';\nimport {\n    DialogEvent,\n    Identity\n} from '@mckinsey-converge/base';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport {\n    BookingCateringConfirmModalComponent,\n    CateringConfirmModalData\n} from '@mckinsey-converge/legacy-overlays';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n\ninterface StartEndResponse {\n    timezone: string,\n    start: DateTZ;\n    end: DateTZ\n}\n\n@Component({\n    selector: 'a-catering-order-details',\n    templateUrl: './order-details.component.html',\n    styleUrls: ['./order-details.component.scss']\n})\nexport class BookingCateringOrderDetailsComponent extends BaseDirective implements OnInit {\n    /** Catering order to edit details of */\n    @Input() public order: CateringOrder;\n    /** Booking date */\n    @Input() public dateTz: DateTZ;\n    /** Booking duration */\n    @Input() public duration: number;\n    /** Booking duration */\n    @Input() public space_list: Space[];\n    /** Whether booking is all day */\n    @Input() public all_day: boolean;\n    /** Whether top header details should be shown */\n    @Input() public hide_details: boolean;\n    /** Whether to show smaller version of component */\n    @Input() public compact: boolean;\n    /** Emitter for changes to the catering order */\n    @Output() public event = new EventEmitter<CateringOrder>();\n    /** Form controls for order */\n    public form: FormGroup;\n    /** List of available catering item categories */\n    public category_list: CateringCategory[] = [];\n    /** Active category to display details for */\n    public active_category: CateringCategory;\n    /** List of available times for delivering catering */\n    public available_times: Identity[] = [];\n    /** Whether the menu is loading */\n    public loading: boolean;\n    /** Whether the search input should be shown */\n    public show_search: boolean;\n    /** Current search string for filtering */\n    public readonly search$ = new BehaviorSubject('');\n    /** List of menu items that match the search string */\n    public matched_items: CateringItem[] = [];\n\n    @ViewChild('input') private _input_el: ElementRef<HTMLInputElement>;\n\n    /** Whether user is able to order from the currently selected space */\n    public get can_order(): boolean {\n        return (\n            (this.active_building.has_catering || this.category_list.length) &&\n            (!this.within_restricted_time || this.has_available_items) &&\n            !this.out_of_hours\n        );\n    }\n\n    /** Building associated with the selected space */\n    public get active_building(): Building {\n        const form_controls = (this.form || { controls: { location_id: { value: '' } } }).controls;\n        const space: Space =\n            this.space_list.find((space) => space.email == form_controls.location_id.value) ||\n            ({ level: {} } as any);\n        return (\n            this._org.buildings.find((bld) => space.level.building_id === bld.id) ||\n            ({ catering_restricted_from: 0 } as any)\n        );\n    }\n\n    /** Currency code for the active building */\n    public get symbol(): string {\n        return this.active_building.currency || 'USD';\n    }\n\n    /** Number of items in the order */\n    public get item_count(): number {\n        return this.form\n            ? this.form.controls.items.value.reduce((total, item) => total + item.amount, 0)\n            : 0;\n    }\n\n    /* istanbul ignore next */\n    /** Whether booking time is outside of catering hours */\n    public get out_of_hours(): boolean {\n        return this.form.controls.delivery_time.value < 0;\n    }\n\n    /** Whether booking is with the restricted ordering period */\n    public get within_restricted_time(): boolean {\n        const expired = DateNow(new Date()).addValue({ hours: this.active_building.catering_restricted_from }).startOfValue('minute');\n        return this.dateTz.isBeforeDate(expired);\n    }\n\n    /** Whether items are available for order at anytime */\n    public get has_available_items(): boolean {\n        return this.category_list.reduce(\n            (available, category) => available || category.can_order_anytime,\n            false\n        );\n    }\n\n    constructor(\n        private _menu: CateringMenuService,\n        private _org: OrganisationService,\n        private _dialog: MatDialog\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.generateAvailableTimes();\n        this.subscription('search', this.search$.pipe(map((str) => {\n            const search = str.toLowerCase();\n            const items = [];\n            for (const category of this.category_list) {\n                if (category.items) {\n                    for (const group of category.items) {\n                        if ((group as any).items) {\n                            if (\n                                (group as any).package &&\n                                (group.name.toLowerCase().includes(search) ||\n                                    (group as any).items.find((item) =>\n                                        item.name.toLowerCase().includes(search)\n                                    ))\n                            ) {\n                                items.push(group);\n                            } else {\n                                for (const item of (group as any).items) {\n                                    if (item.name.toLowerCase().includes(search)) {\n                                        items.push(item);\n                                    }\n                                }\n                            }\n                        } else {\n                            if (group.name.toLowerCase().includes(search)) {\n                                items.push(group);\n                            }\n                        }\n                    }\n                }\n            }\n            return items;\n        })).subscribe((items) => this.matched_items = items));\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        /* istanbul ignore else */\n        if (changes.date || changes.duration) {\n            this.generateAvailableTimes();\n            /* istanbul ignore else */\n            if (\n                this.form &&\n                !this.available_times.find(\n                    (time) => time.id === this.form.controls.delivery_time.value\n                )\n            ) {\n                this.form.controls.delivery_time.setValue(this.available_times[0].id);\n            }\n        }\n        /* istanbul ignore else */\n        if (changes.space_list) {\n            /* istanbul ignore else */\n            if (this.form && this.space_list && !this.form.controls.location_id.value) {\n                this.form.controls.location_id.setValue(this.space_list[0].email);\n            }\n        }\n        /* istanbul ignore else */\n        if (changes.order && this.order) {\n            this.initForm();\n        }\n    }\n\n    public focusSearch() {\n        if (this._input_el && this.show_search) {\n            this._input_el.nativeElement.focus();\n        }\n    }\n\n    public initForm() {\n        this.form = new FormGroup({\n            id: new FormControl(this.order.id),\n            booking_date: new FormControl(\n                this.all_day ? this.dateTz.startOfValue('day').ms : this.dateTz.ms\n            ),\n            location_id: new FormControl(this.order.location_id || this.space_list[0].email),\n            delivery_time: new FormControl(this.order.delivery_time || this.available_times[0].id),\n            items: new FormControl(this.order.items.map((item) => new CateringItem(item)))\n        });\n        this.subscription(\n            'space_change',\n            this.form.controls.location_id.valueChanges.subscribe((space) => {\n                this.generateAvailableTimes();\n                if (\n                    !this.available_times.find(\n                        (time) => time.id === this.form.controls.delivery_time.value\n                    )\n                ) {\n                    this.form.controls.delivery_time.setValue(this.available_times[0].id);\n                }\n                this.form.controls.items.setValue([]);\n                this.loadMenu();\n            })\n        );\n        this.loadMenu();\n        this.generateAvailableTimes();\n        if (\n            this.form &&\n            !this.available_times.find((time) => time.id === this.form.controls.delivery_time.value)\n        ) {\n            this.form.controls.delivery_time.setValue(this.available_times[0].id);\n        }\n    }\n\n    public confirmOrder() {\n        const ref = this._dialog.open<BookingCateringConfirmModalComponent,\n            CateringConfirmModalData>(BookingCateringConfirmModalComponent, {\n                maxWidth: '95vw',\n                data: {\n                    all_day: this.all_day,\n                    dateTz: this.dateTz,\n                    form: this.form\n                }\n            });\n        this.subscription(\n            'confirm_event',\n            ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                /* istanbul ignore else */\n                if (event.reason === 'done') {\n                    const order = new CateringOrder({ ...this.order, ...this.form.value });\n                    // order is emited but who is receiving?\n                    this.event.emit(order);\n                    ref.close();\n                }\n            })\n        );\n        ref.afterClosed().subscribe(() => {\n            this.unsub('confirm_event');\n        });\n    }\n\n    private loadMenu() {\n        const space = this.space_list.find(\n            (space) => space.email === this.form.controls.location_id.value\n        );\n\n        this.loading = true;\n        this._menu\n            .query({ zone_id: this._org.buildings.find((bld) => space.zones.includes(bld.id)).id })\n            .then(\n                (list) => {\n                    this.loading = false;\n                    this.category_list = list.map((i) => new CateringCategory(i))\n                        .filter(c => !c.out_of_stock);\n                },\n                () => (this.loading = false)\n            );\n    }\n\n    /** Generate a list of available delivery times for the given booking time */\n    private generateAvailableTimes() {\n        let { timezone, start, end } = this.generateStartAndEndTimes();\n        start = start.setValue({ minute: Math.ceil(start.minutes / 5) * 5 });\n        // will be different from staff in these commonly named methods.\n        const start_date = this.dateTz;\n        this.available_times = [];\n        while (start.isBeforeDate(end)) {\n            this.available_times.push({\n                id: Math.abs(start_date.dateDiff(start, 'minutes')),\n                name: start.formatDate('h:mma').toLocaleLowerCase(),\n            });\n            start = start.addValue({ minutes: 5 });\n        }\n        /* istanbul ignore else */\n        if (this.available_times.length === 0) {\n            this.available_times.push({ id: -1, name: 'Out of hours' });\n        }\n    }\n\n    private generateStartAndEndTimes(): StartEndResponse {\n        const now = DateNow(new Date())\n        let timezone = now.local_tz;\n        const space_email = this.form ? this.form.controls.location_id.value : null;\n        let catering_hours = { start: 7, end: 20 };\n        let building_time = this.dateTz.startOfValue('day');\n        let cat_start_time = building_time.addValue({ hours: catering_hours.start });\n        let cat_end_time = building_time.addValue({ hours: catering_hours.end });\n\n        if (space_email) {\n            // Fetch the Space and Building\n            const space = this.space_list.find((space) => space.email === space_email);\n            const building = this._org.buildings.find((bld) => space?.zones.includes(bld.id));\n            if (building.timezone) {\n                // Update to the building timezone if defined.\n                timezone = building.timezone;\n                building_time = this.dateTz.toZone(timezone).startOfValue('day');\n            }\n            if (building?.catering_hours) {\n                // Update to the building catering hours if defined.\n                catering_hours = building?.catering_hours;\n            }\n            // Update the hours with the currently defined timezone.\n            cat_start_time = building_time.addValue({ hours: catering_hours.start });\n            cat_end_time = building_time.addValue({ hours: catering_hours.end });\n        }\n\n        // Start Time of the Booking\n        let start = this.dateTz.toZone(timezone);\n        let end = this.dateTz.toZone(timezone).addValue({ minutes: this.duration });\n\n        // Do the booking start and end time coincide with the catering hours?\n        if (start.isBeforeDate(cat_start_time)) {\n            // booking start before catering opens'\n            if (cat_end_time.isAfterDate(start)) {\n                // catering closes after booking starts'\n                start = cat_start_time.addValue({});\n            } else {\n                // were just closed, catering closes before booking start'\n                start = cat_end_time.addValue({});\n                end = cat_end_time.addValue({});\n                return { timezone, start, end };\n            }\n        } else {\n            // booking starts after catering is open'\n            if (cat_end_time.isBeforeDate(start)) {\n                // were just closed, catering closed before booking start'\n                start = cat_end_time.addValue({});\n                end = cat_end_time.addValue({});\n                return { timezone, start, end };\n            }\n        }\n\n        if (end.isBeforeDate(cat_end_time)) {\n            // booking ends before catering closes'\n            if (cat_start_time.isAfterDate(end)) {\n                // were just closed, catering opens is after booking ends'\n                start = cat_start_time.addValue({});\n                end = cat_start_time.addValue({});\n                return { timezone, start, end };\n            }\n        } else {\n            // booking ends after catering closes'\n            // set the booking end to the catering close time.'\n            end = cat_end_time.addValue({});\n        }\n\n        return { timezone, start, end };\n    }\n}\n\n","<div class=\"catering order-details\" [class.compact]=\"compact\">\n    <div class=\"header\" *ngIf=\"form\">\n        <form [formGroup]=\"form\">\n            <div class=\"field\" *ngIf=\"!hide_details\">\n                <div class=\"cat_field_label\" i18n=\"Catering order location div\">Deliver to:</div>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select formControlName=\"location_id\">\n                        <mat-option *ngFor=\"let space of space_list\" [value]=\"space.email\">\n                            {{ space.local_name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class=\"field\" *ngIf=\"!hide_details\">\n                <div class=\"cat_field_label\" for=\"start\" i18n=\"Catering order delivery time label\">At:</div>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select name=\"start\" formControlName=\"delivery_time\">\n                        <mat-option *ngFor=\"let time of available_times\" [value]=\"time.id\">\n                            {{ time.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class=\"search\" [class.min]=\"hide_details\">\n                <button\n                    mat-icon-button\n                    [disabled]=\"!can_order\"\n                    (click)=\"\n                        show_search = !show_search;\n                        !show_search ? search$.next('') : '';\n                        focusSearch()\n                    \"\n                >\n                    <app-icon\n                        [icon]=\"{\n                            class: 'material-icons',\n                            content: show_search ? 'close' : 'search'\n                        }\"\n                    ></app-icon>\n                </button>\n                <div class=\"search-input\" [class.show]=\"show_search || compact\">\n                    <div class=\"input\">\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                #input\n                                matInput\n                                [ngModel]=\"search$ | async\"\n                                (ngModelChange)=\"search$.next($event)\"\n                                [ngModelOptions]=\"{ standalone: true }\"\n                                placeholder=\"Search for items...\"\n                            />\n                        </mat-form-field>\n                    </div>\n                </div>\n            </div>\n        </form>\n    </div>\n    <div class=\"body\" [class.is-search]=\"search$ | async\" *ngIf=\"!loading; else load_state\">\n        <ng-container *ngIf=\"search$ | async; else menu\">\n            <div class=\"item\" *ngFor=\"let item of matched_items\">\n                <a-catering-menu-item\n                    [compact]=\"compact\"\n                    [disabled]=\"within_restricted_time && !item.can_order_anytime\"\n                    [symbol]=\"symbol\"\n                    [item]=\"item\"\n                    [field]=\"form.controls.items\"\n                ></a-catering-menu-item>\n            </div>\n        </ng-container>\n        <ng-template #menu>\n            <ng-container *ngIf=\"!active_category; else category_display\">\n                <div class=\"contents\" *ngIf=\"can_order && category_list.length; else empty_state\">\n                    <button\n                        mat-button\n                        class=\"category\"\n                        *ngFor=\"let item of category_list\"\n                        [style.background-image]=\"'url(' + item.image_path + ')' | safe:'style'\"\n                        [disabled]=\"within_restricted_time && !item.can_order_anytime\"\n                        (click)=\"active_category = item\"\n                    >\n                        <div class=\"overlay\"></div>\n                        <div class=\"name\">{{ item.name }}</div>\n                    </button>\n                </div>\n            </ng-container>\n        </ng-template>\n    </div>\n    <div class=\"bottom-panel-buttons\">\n        <div class=\"buttons\">\n            <button\n                mat-button\n                color=\"secondary\"\n                class=\"mck-secondary-button\"\n                name=\"previous\"\n                (click)=\"event.emit()\"\n                i18n=\"Catering order cancel action\"\n            >\n                Back\n            </button>\n            <button\n                mat-button\n                color=\"primary\"\n                class=\"mck-primary-button\"\n                name=\"next\"\n                [disabled]=\"!item_count || out_of_hours\"\n                (click)=\"confirmOrder()\"\n                i18n=\"Catering order confirm action\"\n            >\n                Confirm Order({{ item_count || '0' }})\n            </button>\n        </div>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div class=\"empty-state center\">\n        <div class=\"icon\">\n            <img alt=\"No Catering Available\" src=\"assets/img/no-catering.svg\" />\n        </div>\n        <p i18n=\"Catering order unavailable\">\n            Catering is <span class=\"bold\">not available</span> for this booking.<br />\n            Catering must be ordered within business hours at {{ active_building?.name }}.\n        </p>\n    </div>\n</ng-template>\n<ng-template #load_state>\n    <div class=\"body\">\n        <div class=\"info-block center\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"48\"></mat-spinner>\n            </div>\n            <div class=\"text\" i18n=\"Catering order loading label\">\n               Loading menu for {{ active_building?.name }}...\n            </div>\n        </div>\n    </div>\n</ng-template>\n<ng-template #category_display>\n    <a-category-display\n        [compact]=\"compact\"\n        [category]=\"active_category\"\n        [symbol]=\"symbol\"\n        [items]=\"form.controls.items\"\n        [disabled]=\"within_restricted_time\"\n        (close)=\"active_category = null\"\n    ></a-category-display>\n</ng-template>\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    OnInit,\n    Output\n} from '@angular/core';\n\nimport {\n    CateringOrder,\n    Space,\n    SpacesService\n} from '@mckinsey-converge/data-common';\nimport { DateNow } from '@mckinsey-converge/date-tz'\n\n\n@Component({\n    selector: 'catering-order-list-item',\n    templateUrl: './item.component.html',\n    styleUrls: ['./item.component.scss']\n})\nexport class CateringOrderListItemComponent implements OnInit {\n    /** Catering order to display */\n    @Input() order: CateringOrder;\n    /**  */\n    @Input() public space_list: Space[];\n    /** Selected datetime */\n    @Input() date: number = DateNow(new Date()).ms;\n    /** Emitter for edit events */\n    @Output() public edit = new EventEmitter<void>();\n    /** Emitter for delete events */\n    @Output() public delete = new EventEmitter<void>();\n\n    public room: Space;\n\n    public ngOnInit(): void {\n        this.room = (this.space_list || []).find(space => space.email === this.order.location_id);\n    }\n\n    public get space_in_booking(): boolean {\n        return !!this.room;\n    }\n\n    /** Space selected for delivery */\n    public get local_space_name(): string {\n        return this.room?.local_name || '<No Location>';\n    }\n\n    /** Delivery time for the order */\n    public get delivery_time(): string {\n        /* istanbul ignore else */\n        if (!this.order) {\n            return '<Meeting Start>';\n        }\n\n        // R--- there's probably a helper for this calculation on the Catering Order \n        return this.order.bookingDateTz.addValue({ minutes: this.order.delivery_time || 0 }).formatDate('h:mma').toLocaleLowerCase();\n    }\n\n    /** Total cost of the order */\n    public get order_cost(): number {\n        const items = (this.order || { items: [] }).items as any;\n        return items.reduce((amount, item) => amount + item.amount * item.unit_price, 0);\n    }\n\n    /** Number of items in the order */\n    public get item_count(): number {\n        const items = (this.order || { items: [] }).items as any;\n        return items.reduce((amount, item) => amount + item.amount, 0);\n    }\n\n    /** Currency symbol for the selected space */\n    public get symbol(): string {\n        /* istanbul ignore else */\n        if (!this.room || !this.room.level) {\n            return 'USD';\n        }\n\n        return this.room?.building?.currency || 'USD';\n    }\n\n    constructor(private _spaces: SpacesService) {\n    }\n}\n","<div class=\"details\" i18n=\"Catering order item delivery details\">\n    Deliver to <span>{{ local_space_name }}</span> at <span>{{ delivery_time }}</span>\n</div>\n<div class=\"group\">\n    <div class=\"cost\">\n        {{ item_count }}\n        <span i18n=\"Items\">{ item_count, plural, =1 { item } other { items } }</span>\n    </div>\n    <div class=\"cost\">{{ order_cost / 100 | currency: symbol }}</div>\n</div>\n<div class=\"actions\">\n    <button\n        mat-icon-button\n        name=\"edit\"\n        [class.warn]=\"!space_in_booking\"\n        (click)=\"edit.emit()\"\n        [matTooltip]=\"\n            !space_in_booking\n                ? 'Space for this order is not in the booking anymore. On confirmation this order will be removed unless the space is re-added.'\n                : ''\n        \"\n    >\n        <app-icon\n            [icon]=\"{ class: 'material-icons', content: space_in_booking ? 'edit' : 'warning' }\"\n        ></app-icon>\n    </button>\n    <button mat-icon-button name=\"delete\" class=\"inverse\" (click)=\"delete.emit()\">\n        <app-icon [icon]=\"{ class: 'material-icons', content: 'delete' }\"></app-icon>\n    </button>\n</div>\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output\n} from '@angular/core';\nimport { FormControl } from '@angular/forms';\n\nimport {\n    CateringOrder,\n    Space\n} from '@mckinsey-converge/data-common';\nimport { BookingFlowEvent } from '../../catering/catering.component';\nimport { DateTZ } from '@mckinsey-converge/date-tz'\n\n\n@Component({\n    selector: 'a-catering-order-list',\n    templateUrl: './order-list.component.html',\n    styleUrls: ['./order-list.component.scss']\n})\nexport class BookingCateringOrderListComponent {\n    /** Form field for storing catering orders */\n    @Input() public catering: FormControl;\n    /** Selected datetime for the booking */\n    @Input() public date: number;\n    /**  */\n    @Input() public space_list: Space[];\n    /** Whether booking is all day */\n    @Input() public all_day: boolean;\n    /** Whether booking is all day */\n    @Input() public next_disabled: boolean;\n    /** Emitter for flow update events */\n    @Output() public event = new EventEmitter<BookingFlowEvent>();\n    /** Emiiter for order events */\n    @Output() public order = new EventEmitter<CateringOrder>();\n\n    public delete: boolean = false;\n\n    /** List of orders in the booking */\n    public get orders(): CateringOrder[] {\n        /* istanbul ignore else */\n        if (!this.catering) {\n            return [];\n        }\n        let orders = [];\n        const date_ = new DateTZ({date: this.date})\n        this.catering.value.forEach(\n            order => {\n                const newOrder = order;\n                newOrder.booking_date = this.all_day\n                                    ? date_.startOfValue('day').ms\n                                    : this.date;\n                orders.push(newOrder);\n            }\n                \n        );\n        return orders;\n    }\n\n    /** Emit event for a new catering order */\n    public newOrder() {\n        this.order.emit();\n    }\n\n    /** Emit event for editing existing order */\n    public editOrder(order: CateringOrder) {\n        this.order.emit(order);\n    }\n\n    /** Remove order from the list */\n    public deleteOrder(order: CateringOrder) {\n        const orders = this.orders;\n        const index = orders.findIndex(an_order => order.id === an_order.id);\n        /* istanbul ignore else */\n        if (index >= 0) {\n            orders.splice(index, 1);\n            this.catering.setValue(orders);\n            this.delete = true;\n        }\n    }\n\n    /**\n     * Proceed to the next step in the space booking flow\n     */\n    public next(): void {\n        // Open the confirmation modal\n        this.event.emit({ type: 'next', step: 'catering' });\n    }\n\n    /** Move flow to previous step */\n    public previous(): void {\n        this.event.emit({ type: 'previous', step: 'catering' });\n    }\n}\n","<div class=\"catering order-list\">\n    <div class=\"header\">\n        <h3 i18n=\"Catering order list header\">Catering Orders</h3>\n    </div>\n    <div class=\"body\">\n        <ng-container *ngIf=\"orders && orders.length; else empty_state\">\n            <div class=\"list\">\n                <catering-order-list-item\n                    *ngFor=\"let order of orders\"\n                    [space_list]=\"space_list\"\n                    [order]=\"order\"\n                    [date]=\"date\"\n                    (edit)=\"editOrder(order)\"\n                    (delete)=\"deleteOrder(order)\"\n                ></catering-order-list-item>\n            </div>\n            <button mat-button name=\"new\" (click)=\"newOrder()\" i18n=\"Catering order list add action\">\n                Add Order\n            </button>\n        </ng-container>\n    </div>\n    <div class=\"bottom-panel-buttons\">\n        <div class=\"buttons\">\n            <button\n                mat-button\n                color=\"secondary\"\n                class=\"mck-secondary-button\"\n                name=\"previous\"\n                (click)=\"previous()\"\n                i18n=\"Catering order list cancel action\"\n            >\n                Back\n            </button>\n            <button\n                mat-button \n                color=\"primary\"\n                class=\"mck-primary-button\"\n                [disabled]=\"next_disabled && !delete\"\n                name=\"next\" (click)=\"next()\" i18n=\"Catering order list continue action\">\n                Next\n            </button>\n        </div>\n    </div>\n</div>\n<ng-template #empty_state>\n    <div class=\"info-block center\">\n        <div class=\"icon\">\n            <app-icon [icon]=\"{ class: 'material-icons', content: 'close' }\"></app-icon>\n        </div>\n        <div class=\"text\" i18n=\"Catering order list empty label\">No catering orders</div>\n        <button mat-button name=\"new\" (click)=\"newOrder()\" i18n=\"Catering order list add action\">\n            Add Order\n        </button>\n    </div>\n</ng-template>\n","import {\n    Component,\n    Input,\n} from '@angular/core';\nimport {\n    BaseDirective,\n} from '@mckinsey-converge/base';\nimport {\n    Booking,\n} from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'catering-order-table',\n    template: `\n    <div class=\"catering-orders-table\" *ngIf=\"booking.cateringOrders.length\">\n        <table>\n            <tr class=\"even\">\n                <td class=\"header time\">\n                    Delivery\n                </td>\n                <td class=\"header\">Charge Code</td>\n                <td class=\"header\">Order</td>\n            </tr>\n            <tr *ngFor=\"let order of booking.cateringOrders; let i = index\" [class]=\"oddEvenClass(i)\">\n                <td>\n                    {{formatDeliveryTime(order)}}\n                </td>\n                <td class=\"code\">\n                    {{order?.charge_code}} \n                </td>\n                <td>\n                    {{listItems(order)}}\n                </td>\n            </tr>\n        </table>\n    </div>\n    `,\n    styleUrls: ['./order-table.component.scss']\n})\nexport class OrderTableComponent extends BaseDirective {\n    /** The theme to use **/\n    @Input() public booking: Booking;\n\n    public listItems(order) {\n        return order.items.map(i => `${i.name}${i.amount > 1 ? ` (${i.amount})` : ''}`).join(', ');\n    }\n\n    public formatDeliveryTime(order) {\n        return this.booking.startDateTz.addValue({ minutes: order?.delivery_time }).formatDate('h:mma').toLocaleLowerCase();\n    }\n\n    public oddEvenClass(x) {\n        return x % 2 === 0 ? 'odd' : 'even';\n    }\n}\n","import {\n    Component,\n    OnInit\n} from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { TopBarHeaderMode } from 'src/app/components/topbar-header/topbar-header.component';\nimport {\n    select,\n    Store\n} from '@ngrx/store';\nimport {\n    BaseDirective,\n} from '@mckinsey-converge/base';\nimport {\n    User,\n    Booking,\n    Building,\n    BuildingCity,\n    flattenDisplayOffices,\n    selectCancelledBookingsResultsFromState,\n    selectUpcomingBookingsResultsFromState,\n    selectPastBookingsResultsFromState,\n    selectBookingByIdResultsFromState,\n} from '@mckinsey-converge/data-common';\nimport {\n    clearBookingByIdResults,\n} from '@mckinsey-converge/bookings';\nimport {\n    BehaviorSubject,\n} from 'rxjs';\nimport {\n    distinctUntilChanged,\n    map,\n    take,\n} from 'rxjs/operators';\nimport { loadBookingsWithQuery } from '@mckinsey-converge/bookings';\nimport { loadOrganisations } from '@mckinsey-converge/organisation';\nimport {\n    SelectOption\n} from '@mckinsey-converge/ui';\nimport {\n    buildingStateSelector,\n    selectBuildingOptionsGroupedByCity\n} from '@mckinsey-converge/buildings';\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\nimport { BookingDetailsModalComponent } from '../booking-details-modal/booking-details-modal.component';\nimport { selectCurrentUser } from '@mckinsey-converge/user';\nimport { RoomBookingStoreState } from '../room-booking/room-booking.component';\nimport { MatTabChangeEvent } from '@angular/material/tabs';\n\n@Component({\n    selector: 'app-manage-bookings',\n    template: `\n        <div class=\"mck-column mck-content-expand mck-content-page-container manage-booking\">\n            <div *ngIf=\"hasLoaderUrl\" class=\"modal_mask\">&nbsp;</div>\n            <header class=\"header\">\n                <a-topbar-header\n                    [mode]=\"TopBarHeaderMode.Light\">\n                </a-topbar-header>\n            </header>\n            <div class=\"mck-column\">\n                <div class=\"bookings-header\">\n                    <h1>Manage Bookings</h1>\n                    <mat-tab-group class=\"mck-tab\" (selectedTabChange)=\"clearPage($event)\">\n                        <div *ngFor=\"let type of bookingTypes;\">\n                          <mat-tab [label]=\"type.display\">\n                            <app-bookings-listing [config]=\"type\" [buildings]=\"buildings\">\n                            </app-bookings-listing>\n                            </mat-tab>\n                        </div>\n                    </mat-tab-group>\n                </div>\n            </div>\n        </div>\n    `,\n    styleUrls: ['./manage-bookings.component.scss']\n})\nexport class ManageBookingsComponent extends BaseDirective implements OnInit {\n    public TopBarHeaderMode = TopBarHeaderMode;\n    public buildings = new BehaviorSubject<SelectOption<any>[]>([]);\n    public bookingTypes = [\n        {\n            type: 'upcoming',\n            display: 'Upcoming',\n            selector: selectUpcomingBookingsResultsFromState\n        },\n        {\n            type: 'past',\n            display: 'Past',\n            selector: selectPastBookingsResultsFromState\n        },\n        {\n            type: 'cancelled',\n            display: 'Cancelled',\n            reverse_sort: true,\n            selector: selectCancelledBookingsResultsFromState\n        },\n    ];\n\n    /** Current User */\n    public currentUser: User;\n    public dialogRef: MatDialogRef<BookingDetailsModalComponent, any>;\n    public modalInitialized = false;\n    public hasLoaderUrl = true;\n\n    constructor(\n        private dialog: MatDialog,\n        private store: Store<RoomBookingStoreState>,\n        private route: ActivatedRoute,\n        private _router: Router,\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n\n        // Get the router params\n        const bookingId = this.route.snapshot.paramMap.get('id');\n        const verb = this.route.snapshot.paramMap.get('verb');\n        // Load the buildings data\n        this.store.dispatch(loadOrganisations.request());\n        this.route.data.subscribe(initData => {\n            // Determine if the cancel or booking submodal is loading\n            const cancel = verb === 'cancel';\n            const addCatering = initData.hasCatering;\n            /**\n             * When using the catering or cancel URLs,\n             * Users reported the modals loading after one another was\n             * jarring so, so the UI is masked out until the modal is loaded.\n             */\n            this.hasLoaderUrl = addCatering || cancel;\n\n            this.subscription('buildings', this.store.pipe(\n                select(buildingStateSelector),\n                select(selectBuildingOptionsGroupedByCity),\n                map((grouped: Map<BuildingCity, Building[]>) => {\n                    return flattenDisplayOffices(grouped);\n                }),\n                distinctUntilChanged()\n            ).subscribe(next => {\n                this.buildings.next(next);\n                    if (bookingId && !this.modalInitialized) {\n                        this.store.dispatch(clearBookingByIdResults())\n                        this.modalInitialized = true;\n                        // Once the data loads viewBooking\n                        this.subscription('bookingResults', this.store.pipe(\n                            select(selectBookingByIdResultsFromState)\n                        ).subscribe(next => {\n                            const booking = next.success ? next.success?.[0] : null;\n                            if (booking && booking.room) {\n                                // Modal Madness, close the existing booking details modals.\n                                if (this.dialogRef) {\n                                    this.dialogRef.close();\n                                }\n                                if (this.dialog) {\n                                   this.dialog.closeAll();\n                                }\n                                // Call viewBookingFromEmailLink with cancel = true to trigger the cancel modal\n                                // Call viewBookingFromEmailLink with addCatering = true to trigger the add Catering modal\n                                this.viewBookingFromEmailLink(booking, cancel, addCatering);\n\n                                // Remove the \"loader\" url from view\n                                this.timeout('rewrite url',() => {\n                                    this._router.navigate(['/home','manage'], { replaceUrl: true });\n                                })\n                            }\n                        }));\n                    }\n            }));\n\n        })\n\n        this.subscription('currentUser', this.store.select(selectCurrentUser)\n            .pipe(take(1))\n            .subscribe((user: User | undefined) => {\n                // Once we know we have the user loaded.\n                this.currentUser = new User(user);\n                if (bookingId) {\n                    // If there's a booking ID loadBookingById\n                    this.store.dispatch(loadBookingsWithQuery({ 'id': bookingId, 'email': this.currentUser.email, 'target': 'bookingById', 'offset': 0 }));\n                }\n            }));\n    }\n\n    public getBuilding(booking: Booking) {\n        if (this.buildings && booking.building_zone) {\n            return this.buildings.value.find(b => booking.building_zone === b.value)?.meta.building;\n        }\n        return null;\n    }\n\n    // Only fires from an email link\n    public viewBookingFromEmailLink(booking: Booking, cancel: boolean = false, addCatering: boolean = false) {\n        if (this.modalInitialized && this.dialogRef) {\n            this.dialogRef.close();\n            this.dialogRef = null;\n        }\n        // R--- Verify the email links are working.\n        // Open the booking details modal\n        if (!this.dialogRef && booking.room) {\n            this.dialogRef = this.dialog.open(BookingDetailsModalComponent, {\n                panelClass: 'mck-modal-wide-manage-booking',\n                data: {\n                    booking,\n                    building: this.getBuilding(booking),\n                    cancel,\n                    addCatering,\n                    hasLoaderUrl: this.hasLoaderUrl,\n                    refresh: () => null\n                },\n                autoFocus: false,\n                backdropClass: 'mck-modal-backdrop',\n            });\n            // Close up the loader panel\n            setTimeout(() => {\n                this.hasLoaderUrl = false;\n            }, 1000);\n        }\n    }\n\n    public clearPage(event : MatTabChangeEvent) {\n        this._router.navigate([], { relativeTo: this.route, queryParams: { page: 1 } });\n    }\n\n}\n","import {\n    Booking\n} from '@mckinsey-converge/data-common';\n\n\nexport class BookingResultsViewModel {\n    constructor(public booking: Booking) {\n    }\n}\n\n/**\n * For each result from results, we find its level and building from the lists.\n */\nexport const mapResultsToViewModels = (results: Booking[]): BookingResultsViewModel[] => {\n    if (!results || !results[0]?.space) {\n        return [];\n    }\n    return results.map((booking: Booking) => {\n        return new BookingResultsViewModel(\n            booking,\n        );\n    });    \n}\n\n","import { Component, Inject, OnInit, ViewEncapsulation, ElementRef, Input, ViewChild, ChangeDetectorRef } from '@angular/core';\nimport {\n    Space,\n    RoomResultsViewModel,\n    BookingStoreState,\n    User,\n    Booking,\n    BookingFormData,\n    BOOKING_STATUS,\n    checkCollisions,\n    SpacesService,\n    BookingsService,\n    BookingStateService,\n    clearBookingFormData,\n    ApplicationService,\n    selectFilteredByIdResults,\n    FilteredSpaces,\n    selectActiveForm,\n    roomFormDataToQuery,\n    storeBookingFormData,\n    getNextFreeBookingSlot,\n} from '@mckinsey-converge/data-common';\nimport { MAP_OVERLAY_DATA } from '@acaprojects/ngx-interactive-map';\nimport { DateTime } from 'luxon';\nimport { Point, BaseDirective, closestToTimeSlot, HashMap, closestToTimeSlotTz } from '@mckinsey-converge/base';\nimport { BehaviorSubject, Observable, interval, timer, of } from 'rxjs';\nimport { CENTER_POINT, MIN_ZOOM_LEVEL } from 'src/app/map/map.utils';\nimport { Store, select } from '@ngrx/store';\nimport { RoomStoreState, loadByIdResults, loadRoomsForResults } from '@mckinsey-converge/rooms';\nimport { BuildingStoreState } from '@mckinsey-converge/buildings';\nimport { UserStoreState } from '@mckinsey-converge/user';\nexport type RoomResultsState = BookingStoreState &\n    RoomStoreState &\n    BuildingStoreState &\n    UserStoreState;\nimport { selectCurrentUser } from '@mckinsey-converge/user';\nimport { delay, map, take } from 'rxjs/operators';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\n// import { WAITING_TIME } from '../floor-map.utils'; // commented and re declare below due to circular dependency overlay > util > overlay\n\nexport const WAITING_TIME = 15;\n\ninterface SpaceWithReturnData extends Space {\n    // callback?: Function,\n    room?: RoomResultsViewModel;\n    parentComponent?: any;\n    roomObs?: Observable<RoomResultsViewModel>\n}\n\ninterface InProgressRoomBookingTimeInfo {\n\tcurrentStatus: string,\n\tactiveBookings: Booking[],\n\ttimeUntilNextBooking: number,\n\ttimeRemainingInActiveBooking : number,\n}\n/**\n * Replaces the built-in {@link MapPinComponent} based on design.\n */\n@Component({\n    selector: 'foor-map-overlay',\n    template: `\n        <div class=\"mck-column mck-center map-overlay-container\">\n          <div  class=\"overlay-modal flex-coloum\">\n\n            <div class=\"room-availability-header flex-row flex-center\">\n\t\t\t\t\t\t\t<img *ngIf=\"isAvailable && diff\" src=\"assets/icon/book-available-room.svg\" />\n\t\t\t\t\t\t\t<img  *ngIf=\"!isAvailable\"  src=\"assets/img/room-is-booked-kiosk.png\"  />\n             \t<button class=\"close\">\n                <img src=\"assets/img/close_outline.svg\" (click)=\"closeModal()\" (touchend)=\"closeModal()\" />\n              </button>\n            </div>\n\n\t\t\t\t\t\t<div *ngIf=\"isAvailable && diff\" class=\"flex-coloum container\" >\n\t\t\t\t\t\t\t<div class=\"availability-text-head flex-row flex-center\">\n\t\t\t\t\t\t\t\t<span>This room is available</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"availability-text flex-row flex-center\">\n\t\t\t\t\t\t\t\t<span>Room {{ data.simple_name || data.name || '' }} is available for booking</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"availability-text flex-row flex-center\">\n\t\t\t\t\t\t\t\t<span>Book now for:</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"flex-row flex-center\">\n\t\t\t\t\t\t\t\t<button mat-button color=\"primary\" class=\"mck-button mck-short mck-column mck-center mck-primary\" *ngIf=\"diff >= 15\" (click)=\"onBook(15)\" (touchend)=\"onBook(15)\" >\n\t\t\t\t\t\t\t\t\t<!-- diff - 15 >= 15 -->\n\t\t\t\t\t\t\t\t\t\t{{ this.start_epoch }}-{{ this.end_epoch_15 }} (15 minutes)\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"flex-row flex-center\">\n\t\t\t\t\t\t\t\t\t<button mat-button color=\"primary\" class=\"mck-button mck-short mck-column mck-center mck-primary\" *ngIf=\"diff >= 30\" (click)=\"onBook(30)\" (touchend)=\"onBook(30)\">\n\t\t\t\t\t\t\t\t\t{{ this.start_epoch }}-{{ this.end_epoch_30 }} (30 minutes)\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"availability-text flex-row flex-center\" *ngIf=\"this.untilNextBookingFlag\">\n\t\t\t\t\t\t\t\t<!--  -->\n\t\t\t\t\t\t\t\t<span >Until next booking</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"flex-row flex-center\"  *ngIf=\"this.untilNextBookingFlag\">\n\t\t\t\t\t\t\t\t<!--  -->\n\t\t\t\t\t\t\t\t<button mat-button color=\"primary\" class=\"mck-button mck-short mck-column mck-center mck-primary\"\n\t\t\t\t\t\t\t\t\t(click)=\"onBook(diffInMs / (60 * 1000) - 6)\" (touchend)=\"onBook(diffInMs / (60 * 1000) - 6)\" >\n\t\t\t\t\t\t\t\t\t\t{{ diffInHours }} hours {{ diffInMinutes }} minutes\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"until-next flex-row flex-center\"  *ngIf=\"isTimerActive\">\n\t\t\t\t\t\t\t\t\t<span> Available if you book in the next {{minutesRemaining}}:{{secondsRemaining}} minutes</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"until-next flex-row flex-center\" *ngIf=\"!isTimerActive\">\n\t\t\t\t\t\t\t\t\tRefresing availability ...\n\t\t\t\t\t\t\t</div>\n          \t</div>\n\t\t\t\t\t\t<div *ngIf=\"!isAvailable\" class=\" flex-column container\">\n\n\t\t\t\t\t\t\t<div class=\"availability-text-head flex-row flex-center\">\n\t\t\t\t\t\t\t\t\t<span>This room is booked</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"availability-text\">\n\t\t\t\t\t\t\t\t\t<span> Apologies, this room has been booked recently by another user, please try another one.   </span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"flex-row flex-center footer\">\n\t\t\t\t\t\t\t\t<button mat-button color=\"primary\" class=\"mck-button mck-short mck-column mck-center mck-primary\" (click)=\"closeModal()\" (touchend)=\"closeModal()\" >\n\t\t\t\t\t\t\t\t\t\tCheck availability\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n          </div>\n          <div class=\"map-icon\"></div>\n        </div>\n    `,\n    styleUrls: ['./floor-map-overlay.component.scss'],\n    encapsulation: ViewEncapsulation.Emulated,\n})\nexport class FloorMapOverlayComponent extends BaseDirective implements OnInit {\n    public selectedRoomId = this.data.id;\n\n    public zoom = new BehaviorSubject(MIN_ZOOM_LEVEL);\n    public center = new BehaviorSubject<Point>(CENTER_POINT);\n\n    public date = DateTime.now().valueOf();\n    /** Current User */\n    public currentUser: User;\n\n    public availableUntil = parseInt(this.data?.settings?.available_until.toString()) * 1000;\n    public diff: any;\n\n    public latestBooking: any[];\n    public latestBookingStartTime: string;\n    public diffInHours: number;\n    public diffInMinutes: number;\n    public booking: Booking = new Booking({});\n    public loading: boolean;\n    public bookingData = new BehaviorSubject<BookingFormData | undefined>(undefined);\n    public confirmed: boolean = false;\n    /** Whether booking has succeeded */\n    public success: boolean;\n    public diffInMs: number;\n    public futureBookingsForTheDay: HashMap<any>[];\n    public untilNextBookingFlag: boolean = false;\n    public start_epoch: any;\n    public end_epoch_15: any;\n    public end_epoch_30: any;\n\n    public userSelectedRoom: RoomResultsViewModel;\n\n    // @ViewChild('time', { static: false }) public time: ElementRef;\n    public isTimerActive: boolean = true;\n    minutesRemaining: number | string;\n    secondsRemaining: number | string;\n    isAvailable: boolean = true;\n    intervalCall_15: any;\n    intervalCall_1: any ;\n\t\ttimerIndex = 0;\n\t\tpublic currentMin;\n\n    constructor(\n        @Inject(MAP_OVERLAY_DATA) public data: SpaceWithReturnData,\n        private elementRef: ElementRef,\n        public store: Store<RoomResultsState>,\n        public _spaces: SpacesService,\n        public _bookings_service: BookingsService,\n        public _booking_state_service: BookingStateService,\n        public _service: ApplicationService,\n        // public cdRef: ChangeDetectorRef,\n    ) {\n        super();\n    }\n\n    public updateRoomData(space) {\n\n\t\t\t\t\t\t// get all booking of selected room\n            this.fetchRoomWithBookings(false);\n\n\t\t\t\t\t\t// subscrip selected room detail with all bookings for the day\n            this.subscription(\n                'bookingSpaceResults',\n                this.store.pipe(select(selectFilteredByIdResults)).subscribe((next) => {\n                    if (next.success.spaces) {\n\n                        space.space = next.success.spaces[0];\n                        this.userSelectedRoom = space;\n\n                        this.isTimerActive = true;\n\n                        this.availableUntil = parseInt(this.userSelectedRoom.space.settings.available_until.toString()) * 1000;\n\n\t\t\t\t\t\t\t\t\t\t\t\t//Retrive and calculate reamining time related information for the selected room and its upcomming bookings\n\t\t\t\t\t\t\t\t\t\t\t\tconst {currentStatus, activeBookings, timeRemainingInActiveBooking, timeUntilNextBooking} = this.calculateRoomBookingTimeInfo();\n\t\t\t\t\t\t\t\t\t\t\t\tthis.diff = timeUntilNextBooking\n                        // inform user if space has been booked by other\n                        if( currentStatus !== 'available') {\n                            if(activeBookings.length && timeRemainingInActiveBooking < 15 &&  timeUntilNextBooking >= 15 ) {\n                                this.setupTimer();\n                                // this.isAvailable = true;\n                                //update up start and end epoch times for a booking button options\n                                this.updateSchedulingEpochs();\n                            } else {\n                                this.isAvailable = false;\n                                this.intervalCall_1?.unsubscribe();\n                                clearInterval(this.intervalCall_15);\n                            }\n\n                        }else {\n                            this.setupTimer();\n                            // this.isAvailable = true;\n                            //update up start and end epoch times for a booking button options\n                            this.updateSchedulingEpochs();\n                        }\n\n\t\t\t\t\t\t\t\t\t\t\t\t// Determine available time until next booking start time\n                        this.determineNextBookingStartTime();\n                    }\n                })\n            );\n\n    }\n\n\t\t/**\n\t\t * Retrive and calculate reamining time related information for the selected room and its upcomming bookings\n\t\t * @returns\n\t\t */\n\t\tpublic calculateRoomBookingTimeInfo(): InProgressRoomBookingTimeInfo {\n\n\t\t\tconst now: any = DateNow(new Date()); // current date time\n\n\t\t\t// Retirive a list of bookings and map them to booking objects\n\t\t\tconst bookings = this.userSelectedRoom.space.settings.bookings.map(b => new Booking(b));\n\n\t\t\t// Filter active/in-progress bookings based on the current time\n\t\t\tconst activeBookings = bookings.filter(booking =>\n\t\t\t\t\t\tnow.isAfterDate(booking.startDateTz.startOfValue('second')) &&\n\t\t\t\t\t\tnow.isBeforeDate(booking.endDateTz.startOfValue('second') )\n\t\t\t);\n\n\t\t\t// Retrive the status of the selected room from parent component data\n\t\t\tconst currentStatus = this.data.parentComponent.roomStatus.statusMap[this.selectedRoomId]; // \" 'available' / 'in-use'\"\"\n\n\t\t\t// Initialize the variable to track time-related information\n\t\t\tlet timeRemainingInActiveBooking = 0; // The remaining time in the active booking in milliseconds\n\t\t\tlet timeUntilNextBooking = 30; // Time until the start of the next booking minutes\n\n\t\t\t// Check if ther are active bookings (room is 'in-use')\n\t\t\tif(activeBookings.length) {\n\t\t\t\tconst nowTime: any = DateTime.now()\n\t\t\t\t// Calculate the time remaining in the active booking in minutes\n\t\t\t\ttimeRemainingInActiveBooking = Math.abs(Math.round((activeBookings[0].end_epoch * 1000 - nowTime.ts) / 60000));\n\n\t\t\t\t// Determine if an extra minute should be added based on the current minute's remainder when devided by WAITING_TIME\n\t\t\t\tconst addMin = DateTime.now().get('minute') % WAITING_TIME === 0 ? 1 : 0;\n\n\t\t\t\t// calculate the start time of the next booking in the same time slot\n\t\t\t\tconst nextBookingStartTime: any = closestToTimeSlot(DateTime.now().plus({ minutes: addMin, seconds:0 }).setZone(this.userSelectedRoom?.building?.timezone), WAITING_TIME);\n\n\t\t\t\t// Filter futute booking for the day to find the next booking\n\t\t\t\tconst futureBookingsForTheDay = this.userSelectedRoom.space?.settings?.bookings.filter((item) =>\n\t\t\t\t\titem.start_epoch * 1000 >= nextBookingStartTime.ts\n\t\t\t\t);\n\n\t\t\t\t// Check if there is an futute booking for the day\n\t\t\t\tif(futureBookingsForTheDay.length) {\n\t\t\t\t\t// calculate the time until start of the next booking in minutes\n\t\t\t\t\tconst nextBookingStartTimeMs = futureBookingsForTheDay[0].start_epoch * 1000;\n\t\t\t\t\ttimeUntilNextBooking = Math.floor((nextBookingStartTimeMs - nowTime.ts) / (1000 * 60));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t\t\t\tcurrentStatus: currentStatus,\n\t\t\t\t\t\t\tactiveBookings: activeBookings,\n\t\t\t\t\t\t\ttimeUntilNextBooking: timeUntilNextBooking,\n\t\t\t\t\t\t\ttimeRemainingInActiveBooking : timeRemainingInActiveBooking,\n\t\t\t\t\t\t};\n\n\t\t}\n\n    public setup15MinTimer() {\n        //interval for 15 min\n        !this.timerIndex && setTimeout(()=>this.setUpTime(), 1100 ) ;\n        this.timerIndex++\n        this.intervalCall_15 = window.setInterval(\n            () => { this.intervalCall_1?.unsubscribe(); setTimeout(()=>this.setUpTime(), 1100 ) }\n            , ( 1000 * 60 * WAITING_TIME ) );\n\n\n    }\n\n    public setUpTime() {\n        // console.log(DateTime.now().setZone(this.userSelectedRoom?.building?.timezone).get('minute'));\n        // console.log(DateTime.now().setZone(this.userSelectedRoom?.building?.timezone).get('minute') % WAITING_TIME)\n        // console.log(DateTime.now().setZone(this.userSelectedRoom?.building?.timezone).get('second'))\n        const addMin = DateTime.now().get('minute') % WAITING_TIME === 0 ? 1 : 0 ;\n        const addSeconds = 60 - DateTime.now().get('second');\n        let start:any = closestToTimeSlot(DateTime.now().plus({ minutes: addMin, seconds:0 }).setZone(this.userSelectedRoom?.building?.timezone), WAITING_TIME);\n            start = start.toLocaleString(DateTime.TIME_SIMPLE);\n            if(start !== this.start_epoch ) {\n\n                this.start_epoch = start;\n\n                // this.availableUntil = parseInt(this.userSelectedRoom.space.settings.available_until.toString()) * 1000;\n                // const currentTime = new Date(DateTime.now().valueOf());\n                // const endTime = new Date(this.availableUntil);\n                // this.diff = Math.abs(Math.round((endTime.getTime() - currentTime.getTime()) / 60000));\n\n                const addMin = DateTime.now().get('minute') % WAITING_TIME === 0 ? 1 : 0 ;\n                const addSeconds = 60 - DateTime.now().get('second');\n                this.startTimer(addMin);\n\n            }\n\n\t\t\t\t\t\t//update up start and end epoch times for a booking button options\n\t\t\t\t\t\tthis.updateSchedulingEpochs()\n\n            // let end_15: any = closestToTimeSlot(DateTime.now().plus({ minutes: addMin, seconds:0 }).setZone(this.userSelectedRoom?.building?.timezone), WAITING_TIME).plus({ minutes: 15 });\n            //     end_15 = end_15.toLocaleString(DateTime.TIME_SIMPLE);\n            // if(end_15 !== this.end_epoch_15) {\n            //     this.end_epoch_15 = end_15\n            // }\n\n            // let end_30: any = closestToTimeSlot(DateTime.now().plus({ minutes: addMin, seconds:0 }).setZone(this.userSelectedRoom?.building?.timezone), WAITING_TIME).plus({ minutes: 30 });\n            //     end_30 = end_30.toLocaleString(DateTime.TIME_SIMPLE);\n            // if(end_30 !== this.end_epoch_30) {\n            //     this.end_epoch_30 = end_30;\n            // }\n    }\n\n    public ngOnInit(): void {\n        this.fetchRoomWithBookings(false);\n\n        this.data.parentComponent.childCallback = this.updateRoomData.bind(this);\n        this.userSelectedRoom = this.data?.room;\n\t\t\t\tthis.updateSchedulingEpochs();\n        this.updateRoomData(this.userSelectedRoom);\n\t\t\t\t// Determine available time until next booking start time\n        // this.determineNextBookingStartTime();\n\n        this.subscription(\n            'currentUser',\n            this.store\n                .select(selectCurrentUser)\n                .pipe(take(1))\n                .subscribe((user: User | undefined) => {\n                    // Once we know we have the user loaded.\n                    this.currentUser = new User(user);\n                })\n        );\n\n        //update up start and end epoch times for a booking button options\n        // this.updateSchedulingEpochs();\n        this.data.parentComponent.isOverlayOpened = true;\n    }\n\n    /**\n     * This function sets up start and end epoch times for a booking scheduling system.\n     * It calculates and assigns various epoch times based on the current time,\n     * available until time, and user-selected room's timezone.\n     */\n    public updateSchedulingEpochs() {\n\n\t\t\tconst now: any = DateTime.now();\n\n\t\t\t// Calculate the time difference in minutes between current and available until time\n\t\t\tconst {currentStatus, activeBookings, timeRemainingInActiveBooking, timeUntilNextBooking} = this.calculateRoomBookingTimeInfo();\n\t\t\t// this.diff = Math.abs(Math.round((this.availableUntil - now.ts) / 60000)); // recheck\n\t\t\tthis.diff = timeUntilNextBooking;\n\n\t\t\t// Determine system availability based on time difference\n\t\t\tthis.isAvailable = timeRemainingInActiveBooking < 15 &&  timeUntilNextBooking >= 15 // this.diff >= 15;\n\n\t\t\t// Calculate the next time slot for scheduling\n\t\t\tconst addMin = now.get('minute') % WAITING_TIME === 0 ? 1 : 0;\n\t\t\tconst adjustedTime = now.plus({ minutes: addMin, seconds: 0 }).setZone(this.userSelectedRoom?.building?.timezone);\n\n\t\t\t// Calculate and assign the start and end epoch times with 15 and 30-minute intervals\n\t\t\tconst timeSlot = closestToTimeSlot(adjustedTime, WAITING_TIME);\n\t\t\tthis.start_epoch = timeSlot.toLocaleString(DateTime.TIME_SIMPLE);\n\t\t\tthis.end_epoch_15 = timeSlot.plus({ minutes: 15 }).toLocaleString(DateTime.TIME_SIMPLE);\n\t\t\tthis.end_epoch_30 = timeSlot.plus({ minutes: 30 }).toLocaleString(DateTime.TIME_SIMPLE);\n    }\n\n    ngAfterViewInit() {\n        this.setupTimer();\n    }\n\n    public setupTimer() {\n        console.log(DateTime.now().get('second'))\n        const addMin = DateTime.now().setZone(this.userSelectedRoom?.building?.timezone).get('minute') % WAITING_TIME === 0 ? 1 : 0 ;\n        const addSeconds = 60 - DateTime.now().get('second');\n        this.startTimer(addMin);\n    }\n\n\n    // countdown timer for coachmark\n    public startTimer(display = 0, addSeconds = 0) {\n\n        // const currentTime = new Date(DateTime.now().valueOf());\n        // const endTime = new Date(closestToTimeSlot(DateTime.now().plus({minutes: display, seconds: addSeconds}).setZone(this.userSelectedRoom?.building?.timezone), WAITING_TIME).valueOf());\n        // const availableTimeToBook = Math.abs((endTime.getTime() - currentTime.getTime()) / 60000)* 60;\n        // let timer = availableTimeToBook; //(this.diff -35) * 60;\n        // let minutes;\n        // let seconds;\n        let timer = 0 ;\n        if(timer >= 0){\n            this.intervalCall_1 =  interval(1000).subscribe(x => {\n\n                const currentTime = new Date(DateTime.now().valueOf());\n                const endTime = new Date(closestToTimeSlot(DateTime.now().plus({minutes: display, seconds: addSeconds}).setZone(this.userSelectedRoom?.building?.timezone), WAITING_TIME).valueOf());\n                const availableTimeToBook = Math.abs((endTime.getTime() - currentTime.getTime()) / 60000)* 60;\n                let timer = availableTimeToBook; //(this.diff -35) * 60;\n\n                this.isTimerActive = true;\n                this.minutesRemaining = Math.floor(timer / 60);\n                this.secondsRemaining = Math.floor(timer % 60);\n\n                this.minutesRemaining = this.minutesRemaining < 10 ? \"0\" + this.minutesRemaining : this.minutesRemaining;\n                this.secondsRemaining = this.secondsRemaining < 10 ? \"0\" + this.secondsRemaining : this.secondsRemaining;\n\n                --timer;\n\n                if (timer <= 0) {\n                    timer = 0\n                    this.intervalCall_1?.unsubscribe();\n                    // clearInterval(this.intervalCall_1);\n                    this.isTimerActive = false;\n                    !this.timerIndex && this.setup15MinTimer();\n\n\t\t\t\t\t\t\t\t\t\tthis.store.select(selectActiveForm).pipe(take(1))\n\t\t\t\t\t\t\t\t\t\t\t.subscribe((form) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst addMin = DateTime.now().setZone(this.userSelectedRoom?.building?.timezone).get('minute') % WAITING_TIME === 0 ? 1 : 0 ;\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst addSeconds = 60 - DateTime.now().setZone(this.userSelectedRoom?.building?.timezone).get('second');\n\t\t\t\t\t\t\t\t\t\t\t\t\tform['date'] =  closestToTimeSlot(DateTime.now().setZone(this.userSelectedRoom?.building?.timezone).plus({ minutes: addMin, seconds:0 }), WAITING_TIME).valueOf(),\n\t\t\t\t\t\t\t\t\t\t\t\t\tform.dateTz = closestToTimeSlotTz(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnew DateTZ({ date: DateTime.now().plus({ minutes: addMin, seconds:0 }), is_local_tz: false, building_tz: form.timezone }),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWAITING_TIME\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.store.dispatch(storeBookingFormData({ payload: form }));\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.store.dispatch(loadRoomsForResults.request(roomFormDataToQuery(form)));\n\n\t\t\t\t\t\t\t\t\t\t\t});\n\n                }\n            }) //, 1000, endTime)\n        }\n    }\n\n\t\t/**\n\t\t * This function updates information related to the lates booking in the selected room\n\t\t */\n    public determineNextBookingStartTime() {\n\n\t\t\t\t// Get the current time using DateTime library\n        const now = DateTime.now();\n\n\t\t\t\t// Determine if an extra minute should be added based on the current minute's remainder when devided by WAITING_TIME\n        const addMin = now.get('minute') % WAITING_TIME === 0 ? 1 : 0;\n\n\t\t\t\t// Adjust the current time by adding the calculated minutes adna setting the timezone based on the selected room's building\n        const addjustedTime: any = closestToTimeSlot(\n                now.plus({ minutes: addMin, seconds:0 })\n                .setZone(this.userSelectedRoom?.building?.timezone), WAITING_TIME\n            );\n\n\t\t\t\t\t\t// Check if room is selected and has bookings settings\n        if (this.userSelectedRoom?.space) {\n\t\t\t\t\t// Returive the list of future bookings or initializem it as an empaty array\n            const futureBookings = this.userSelectedRoom?.space?.settings?.bookings || [];\n\n\t\t\t\t\t\t// Calculate the end time for a 30-minute interval from the addjested time\n            const endEpoch30 = addjustedTime.plus({ minutes: 30 }).ts;\n\n\t\t\t\t\t\t// Filter future booking that start after end_epoch_30\n\t\t\t\t\t\tconst futureBookingsForTheDay = futureBookings.filter(item => item.start_epoch * 1000 >= endEpoch30);\n\n\t\t\t\t\t\t// Check if there are futute bookings found\n\t\t\t\t\t\tif(futureBookingsForTheDay.length > 0) {\n\t\t\t\t\t\t\t//Extract the start time of latest booking\n\t\t\t\t\t\t\tconst latestBookingStartTime = new Date(futureBookingsForTheDay[0].start_epoch * 1000);\n\n\t\t\t\t\t\t\t// Calculate the time difference between the latest booking start time and the current time in milliseconds\n\t\t\t\t\t\t\tconst timeDiffMs = latestBookingStartTime.getTime() - now.valueOf();\n\t\t\t\t\t\t\tthis.diffInMs  = timeDiffMs;\n\t\t\t\t\t\t\t// Calculate the timne differenc in hours and minutes\n\t\t\t\t\t\t\tthis.diffInHours = Math.floor(timeDiffMs / (1000 * 60 * 60));\n            \tthis.diffInMinutes = Math.floor((timeDiffMs % (1000 * 60 * 60)) / (1000 * 60));\n\n\t\t\t\t\t\t\t// Set flag to indicate the wether the difference is NaN (no future booking)\n            \tthis.untilNextBookingFlag = !isNaN(timeDiffMs);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tthis.untilNextBookingFlag = false;\n\t\t\t\t\t\t}\n        }\n\n    }\n\n    //fetch all the bookings for selected room for the day to the store\n    public fetchRoomWithBookings(allWeek: boolean = true) {\n        const day = 24 * 60;\n        const week = day * 7;\n        const date = (this.booking?.startDateTz).clone();\n        const startOfDay = date.startOfValue('day').setValue({ second: 0, millisecond: 0 });\n        const startOfWeek = date.startOfValue('week');\n\n        // Query for the entire day for this room\n        const query = {\n            dateTz: allWeek ? startOfWeek : startOfDay,\n            duration: allWeek ? week : day,\n            locations: this.data?.id,\n            capacity: this.booking?.space?.capacity,\n        };\n        this.store.dispatch(loadByIdResults.request(query));\n    }\n\n    public closeModal() {\n        const modal = this.elementRef.nativeElement.querySelector('.map-overlay-container');\n        modal.classList.add('hide');\n        this.data.parentComponent.isOverlayOpened = false;\n        this.timerIndex = 0;\n        this.isAvailable = false;\n\t\t\t\tthis.untilNextBookingFlag = false;\n        this.intervalCall_1?.unsubscribe();\n        // clearInterval(this.intervalCall_1);\n        // this.intervalCall_15?.unsubscribe();\n        clearInterval(this.intervalCall_15);\n    }\n\n    public roomDataCallback() {\n        if (this.data.parentComponent.roomSelected && this.userSelectedRoom) {\n            this.data.parentComponent.roomSelected(this.userSelectedRoom);\n        }\n    }\n\n    public onBook(minutes: number) {\n        minutes = Math.round(minutes);\n        const {filters, settings} = this.userSelectedRoom.space;\n        if ( (filters && filters?.equipment_code ) || (settings && settings?.equipment_code) ) {\n            this.roomDataCallback();\n        } else {\n            this.saveChanges(minutes);\n        }\n    }\n\n    public bookingFormToBooking(minutes): Booking {\n        const booking_form_data = this.bookingData.value;\n        const has_note_buffer =\n            booking_form_data?.notes && booking_form_data.notes?.length\n                ? { [booking_form_data.selectedRoom.space.email]: 900 }\n                : {}; // 900 seconds = 15 min\n        const attendees = this.booking.attendees;\n        const company = this.booking.company;\n        const start_epoch = closestToTimeSlot(DateTime.now(), 15).valueOf() / 1000;\n        const end_epoch =\n            closestToTimeSlot(DateTime.now(), 15).plus({ minutes: minutes }).valueOf() / 1000;\n\n        const raw_data = {\n            space: { id: this.selectedRoomId },\n            all_day: false,\n            attendees,\n            // booking_type: booking_form_data?.bookingType.value,\n            booking_type: this.userSelectedRoom.space.filters.external === true? \"External\" : \"Internal\",\n            catering: [],\n            start_epoch,\n            end_epoch,\n            timezone: booking_form_data?.timezone,\n            equipment_codes: {\n                [booking_form_data?.selectedRoom.space.email]: booking_form_data?.code,\n            },\n            expected_attendees: {\n                [this.data.email]: 1,\n            },\n            has_catering: false,\n            needs_space: false,\n            notes: this.booking.notes,\n            organiser: this.currentUser,\n            creator: this.currentUser,\n            room: this.userSelectedRoom.space,\n            title: 'Ad hoc meeting',\n            setup: has_note_buffer,\n            breakdown: has_note_buffer,\n            company,\n        };\n        console.log(new Booking(raw_data));\n        return new Booking(raw_data);\n    }\n\n    //function for sending final booking request\n    public saveChanges(minutes) {\n        this.loading = true;\n        this.booking = this.bookingFormToBooking(minutes);\n        // const booking_form_data = this.bookingData.value;\n        this.booking.status = BOOKING_STATUS.approved;\n        checkCollisions(this._spaces, this.booking).then(\n            (bookable: boolean) => {\n                if (!bookable) {\n                    // TODO - Refactor for https://acaprojects.atlassian.net/browse/MCK-1498\n                    // API is retuning bookings ouside of requested time range\n                    // TODO check booking date and times for conflict manually\n                    this.booking.status = BOOKING_STATUS.unavailable;\n                    return;\n                }\n\n                this._bookings_service.save(this.booking).then(\n                    (bkn) => {\n                        this.loading = false;\n                        this.success = true;\n                        this.confirmed = true;\n                        this._booking_state_service.replace(bkn);\n\n                        // When saved, the returned booking has a null room.\n                        // Correct this so the rest of the code doesn't flake out.\n                        this.booking = new Booking({ ...bkn.toJSON(), room: this.booking.room });\n                        // Clear the current booking form\n                        this.store.dispatch(clearBookingFormData());\n\n                        // Heap track event\n                        this._service.analytics.track('create', {\n                            booking_id: bkn.id,\n                            office: this.booking.room.building.name,\n                            room: this.booking.room.local_name,\n                            start_time: bkn.startDateTz.ms,\n                            end_time: bkn.endDateTz.ms,\n                            catering: !!bkn.catering.length,\n                            headcount: 1,\n                        });\n                        this.data.parentComponent.confirmBooking(this.booking);\n                    },\n                    (err) => {\n                        this.loading = false;\n                        this.confirmed = false;\n                        if (err.status === 409) {\n                            // Unavailable Confirmation\n                            this.booking.status = BOOKING_STATUS.unavailable;\n                            this._booking_state_service.replace(this.booking);\n                            this.confirmed = true;\n                            this.success = false;\n                        } else {\n                            console.log(err);\n                        }\n                    }\n                );\n            },\n            (err) => {\n                // Unavailable Confirmation\n                this.loading = false;\n                this.timeout(\n                    'error',\n                    () => {\n                        this.booking.status = BOOKING_STATUS.unavailable;\n                        this._booking_state_service.replace(this.booking);\n                        this.confirmed = true;\n                        this.success = false;\n                    },\n                    500\n                );\n            }\n        );\n    }\n}\n","import { SelectOption } from '@mckinsey-converge/ui';\nimport {\n    Space,\n    SpaceStatus,\n    RoomResultsViewModel,\n    MapListener\n} from '@mckinsey-converge/data-common';\nimport {\n    HashMap,\n    Point\n} from '@mckinsey-converge/base';\nimport { MapFeature } from '@acaprojects/ngx-interactive-map/lib/helpers/map.interfaces';\nimport { FloorMapOverlayComponent } from './floor-map-overlay/floor-map-overlay.component';\n\nexport const MIN_ZOOM_LEVEL = 1;\nexport const MAX_ZOOM_LEVEL = 10;\nexport const CENTER_POINT: Point = { x: 0.5, y: 0.5 };\n\nexport const WAITING_TIME = 15;\n\nconst mapSpaceStatusToDisplay = (status: SpaceStatus): string => {\n    switch (status) {\n        case SpaceStatus.NotBookable:\n            return 'Not Bookable';\n        case SpaceStatus.Requestable:\n            return 'Available by Request';\n        case SpaceStatus.Unavailable:\n            return 'In Use';\n        case SpaceStatus.Available:\n        default:\n            return 'Available';\n    }\n};\n\nconst mapSpaceStatusToOption = (status: SpaceStatus) => ({\n    value: status,\n    display: mapSpaceStatusToDisplay(status)\n});\n\nexport const legendOptions = (): SelectOption<any>[] => [\n    SpaceStatus.Available,\n    SpaceStatus.Requestable,\n    SpaceStatus.Unavailable,\n    SpaceStatus.NotBookable\n].map(mapSpaceStatusToOption);\n\n\nexport const defaultMapBookingRules = [\n    'Rooms showing yellow are restricted and must be requested',\n    'Rooms showing green are available to book for one hour',\n    'Rooms showing red are booked',\n    'Rooms showing grey are not bookable but may be used if they are empty'\n];\n\nexport const defaultMapBookingSubtitle = 'You may request restricted rooms but they will need to be approved by an admin';\n\nexport const generateMapStyleForSpace = (\n    space: Space,\n    status: SpaceStatus,\n    colorStatusMap: HashMap) => {\n    const id =\n        `${space.map_id}`.indexOf('area') < 0\n            ? `area-${space.map_id}-status`\n            : space.map_id;\n    return (\n        {\n            id,\n            styles: {\n                fill: colorStatusMap[`space-${status}`] || '#000',\n                opacity: 1\n            }\n        });\n};\n\n/**\n * Generates actions for mapview handling.\n * @param space - the space to generate\n * @param clickSpace - called when clicked or touched\n * @param hoverSpace - called when you hover over a space\n * @param leaveSpace - called when you leave a space.\n */\nexport const generateMapListenersForSpace = (\n    space: Space,\n    hoverSpace: () => void,\n    leaveSpace: () => void,\n    clickSpace: () => void\n): MapListener[] => {\n    const id =\n        `${space.map_id}`.indexOf('area') < 0\n            ? `area-${space.map_id}-status`\n            : space.map_id;\n    const listeners: MapListener[] = [];\n    listeners.push({\n        id,\n        event: 'mouseenter',\n        callback: hoverSpace\n    });\n    listeners.push({\n        id,\n        event: 'mouseleave',\n        callback: leaveSpace\n    });\n    if (space.bookable) {\n        listeners.push({\n            id,\n            event: 'click',\n            callback: clickSpace\n        });\n        listeners.push({\n            id,\n            event: 'touchend',\n            callback: clickSpace\n        });\n    }\n    return listeners;\n};\n\n\nexport const spaceToMapFeature = (space: Space): MapFeature => ({\n    id: `area-${space.map_id}-status`,\n    coordinates: null,\n    content: FloorMapOverlayComponent,\n    data: {\n        ...space\n    }\n});\n\nexport const roomToMapFeature = (room: RoomResultsViewModel, parentComponent?: any): MapFeature => ({\n    id: `area-${room.space.map_id}-status`,\n    coordinates: null,\n    content: FloorMapOverlayComponent,\n    data: {\n        ...room.space,\n        parentComponent,\n        room\n    }\n});\n\n// service account for office floor map view - read only\nexport const SERVICE_ACCOUNT = 'svc_kiosk_converge@mckinsey.onmicrosoft.com';","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { OfficeFloorComponent } from './office-floor/office-floor.component';\nimport { MatButtonModule } from '@angular/material/button';\nimport { LibraryModule } from '@acaprojects/ngx-interactive-map';\nimport { MatSelectModule } from '@angular/material/select';\nimport { UiModule } from '@mckinsey-converge/ui';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MapModule } from 'src/app/map/map.module';\nimport { FloorMapOverlayComponent } from './floor-map-overlay/floor-map-overlay.component';\n\nexport const mapModuleImports = [\n    CommonModule,\n    MatButtonModule,\n    LibraryModule,\n    MatSelectModule,\n    UiModule,\n    MatDialogModule,\n    MapModule,\n];\n\nexport const mapModuleDeclarations = [\n    OfficeFloorComponent,\n    FloorMapOverlayComponent,\n    // MapControlsComponent,\n    // MapFiltersComponent,\n    // OfficeInformationModalComponent,\n    // MapOverlayComponent\n];\n\n@NgModule({\n    declarations: [\n        ...mapModuleDeclarations,\n    ],\n    exports: [\n        ...mapModuleDeclarations\n    ],\n    imports: [\n        ...mapModuleImports\n    ]\n})\nexport class OfficeFloorMapModule {\n}\n","import { Component, Input, OnChanges, OnInit, SimpleChanges } from '@angular/core';\nimport { BehaviorSubject, combineLatest, interval } from 'rxjs';\nimport { BaseDirective, closestToTimeSlot, closestToTimeSlotTz, HashMap, Point } from '@mckinsey-converge/base';\nimport { MapFeature } from '@acaprojects/ngx-interactive-map/lib/helpers/map.interfaces';\nimport { select, Store } from '@ngrx/store';\nimport { BuildingStoreState } from '@mckinsey-converge/buildings';\nimport * as cloneDeep from 'lodash/cloneDeep';\nimport {\n    Building,\n    BuildingLevel,\n    SettingsService,\n    Space,\n    mapBuildingLevelToOption,\n    mapResultsToViewModels,\n    RoomResultsViewModel,\n    selectActiveForm,\n    selectBookingLocations,\n    selectSelectedBuildingOptions,\n    roomFormDataToQuery,\n    FilteredSpaces,\n    BookingStoreState,\n    storeBookingFormData,\n    BookingFormData,\n    MapListener,\n    selectFilteredDiffSizeResults,\n    User,\n    selectMapFilteredResults,\n    ApplicationService,\n    clearRoomFilters,\n\t\tbookingTypeOptions,\n        defaultRoomSizeOption,\n} from '@mckinsey-converge/data-common';\nimport { distinctUntilChanged, map, take, withLatestFrom } from 'rxjs/operators';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { filterUndefined } from '@mckinsey-converge/rx-utils';\nimport { MatDialog } from '@angular/material/dialog';\nimport { OfficeInformationModalComponent } from 'src/app/map/office-information-modal/office-information-modal.component';\n\nimport {\n    CENTER_POINT,\n    generateMapListenersForSpace,\n    generateMapStyleForSpace,\n    MAX_ZOOM_LEVEL,\n    MIN_ZOOM_LEVEL,\n    roomToMapFeature,\n    SERVICE_ACCOUNT,\n    WAITING_TIME,\n} from '../floor-map.utils';\nimport {\n    loadDiffSizeResults,\n    loadRoomsForResults,\n    loadRoomsForResultsMap,\n    mapRoomToSelectOption,\n    RoomStoreState,\n} from '@mckinsey-converge/rooms';\nimport { LoadingModel } from '@mckinsey-converge/loading';\nimport { selectCurrentUser, UserStoreState } from '@mckinsey-converge/user';\nimport { ActivatedRoute, Router, RouterStateSnapshot } from '@angular/router';\nimport { Location } from '@angular/common';\nimport { DateTZ } from '@mckinsey-converge/date-tz';\nimport { DateTime } from 'luxon';\n\nexport type MapSearchStoreState = BuildingStoreState &\n    RoomStoreState &\n    BookingStoreState &\n    UserStoreState;\n\n@Component({\n    selector: 'app-office-floor',\n    templateUrl: './office-floor.component.html',\n    styleUrls: ['./office-floor.component.scss'],\n})\nexport class OfficeFloorComponent extends BaseDirective implements OnInit, OnChanges {\n    @Input()\n    public openHeader: boolean = true;\n\n    public zoom = new BehaviorSubject(MIN_ZOOM_LEVEL);\n\n    public center = new BehaviorSubject<Point>(CENTER_POINT);\n    public listeners = new BehaviorSubject<MapListener[]>([]);\n\n    public focusedMapSpace = new BehaviorSubject<MapFeature | undefined>(undefined);\n    public features = combineLatest([this.focusedMapSpace]).pipe(\n        map((items) => items.filter((i) => !!i))\n    );\n\n    public focusedRoom = new BehaviorSubject<RoomResultsViewModel | undefined>(undefined);\n\n    public resultBuildings = new BehaviorSubject<Building[]>([]);\n    public resultSpaces = new BehaviorSubject<Space[]>([]);\n    public activeBuilding = new BehaviorSubject<Building | undefined>(undefined);\n    public activeLevel = new BehaviorSubject<BuildingLevel | undefined>(undefined);\n    public activeSpace = new BehaviorSubject<Space | undefined>(undefined);\n\n    /** Mapping of elements to CSS styles */\n    public style_map = new BehaviorSubject<HashMap<HashMap<string | number>>>({});\n\n    public mapUrl = this.activeLevel.pipe(map((level) => level?.map_url ?? ''));\n\n    public bookingLocations = new BehaviorSubject<SelectOption<any>[]>([]);\n    public buildingLevelOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n    public spaceListOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public activeBuildingOption = combineLatest([this.activeBuilding, this.bookingLocations]).pipe(\n        map(([building, locations]) => locations.find((l) => l.value === building?.id))\n    );\n\n    public activeLevelOption = this.activeLevel.pipe(map(mapBuildingLevelToOption));\n    public activeSpaceOption = this.activeSpace.pipe(map(mapRoomToSelectOption));\n    public bookingFormData = new BehaviorSubject<BookingFormData | undefined>(undefined);\n\n    public roomStatus: any;\n    public payload: any;\n    /** Current User */\n    public currentUser: User;\n    public bookingConfirmed = false;\n    public bookingData: {};\n    serviceAccount: boolean;\n\n    constructor(\n        private store: Store<MapSearchStoreState>,\n        public dialog: MatDialog,\n        private settingService: SettingsService,\n        private router: Router,\n        private route: ActivatedRoute,\n        public _service: ApplicationService,\n        private location: Location\n    ) {\n        super();\n        this.payload = location.getState();\n        this.payload.floorMap = false;\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        throw new Error('Method not implemented.');\n    }\n\n    public ngOnInit(): void {\n        //clear filters first if any applied previously \n        this.store.dispatch(clearRoomFilters());\n\n        const selection = { value: this.payload?.payload, display: '' };\n        this.payload.building.value = this.payload.building[0].id;\n\n        this.subscription(\n            'currentUser',\n            this.store\n                .select(selectCurrentUser)\n                .pipe(take(1))\n                .subscribe((user: User | undefined) => {\n                    // Once we know we have the user loaded.\n                    this.currentUser = new User(user);\n                    this.serviceAccount = this.currentUser.email === SERVICE_ACCOUNT\n                })\n        );\n\n        // get the active form values\n        this.subscription(\n            'activeForm',\n            this.store\n                .pipe(select(selectActiveForm), distinctUntilChanged())\n                .subscribe((next: BookingFormData | undefined) => {\n                    if (next) {\n                        next.duration = 30;\n                        this.bookingFormData.next(next); /// <---- timezone setting can be done here\n                    }\n                })\n        );\n\n        this.subscription(\n            'bookingLocations',\n            this.store.pipe(select(selectBookingLocations)).subscribe((next) => {\n                this.bookingLocations.next(next);\n                // update the map view MCK-1100 when location changes\n                const self = this;\n                setTimeout(() => {\n                    self.selectActiveBuilding(self.bookingLocations.value[0]);\n                }, 0);\n            })\n        );\n\n        this.subscription(\n            'bookingSpaceResults',\n            combineLatest([\n                this.store.pipe(\n                    select(selectMapFilteredResults),\n                    map((r: LoadingModel<FilteredSpaces>) => r.success)\n                ),\n                this.activeBuilding.pipe(filterUndefined<Building>()),\n                this.activeLevel.pipe(filterUndefined<BuildingLevel>()),\n            ]).subscribe(([filteredSpaces, building, level]) => {\n                this.roomStatus = filteredSpaces;\n\n                const spacesFromSelection = (filteredSpaces.spaces || []).filter(\n                    (s) =>\n                        !!s.map_id &&\n                        s.zones.includes(building.id) &&\n                        s.zones.includes(this.payload?.payload)\n                );\n\n                this.resultSpaces.next(cloneDeep(spacesFromSelection));\n\n                const listeners: MapListener[] = [];\n                const styles: HashMap<HashMap<string | number>> = {};\n                const colour_map = this.settingService.get('app.explore.colors') || {};\n                spacesFromSelection.forEach((space) => {\n                    const status = filteredSpaces.statusMap[space.id];\n                    const mapStyle = generateMapStyleForSpace(space, status, colour_map);\n                    styles[`#${mapStyle.id}`] = mapStyle.styles;\n                    listeners.push(\n                        ...generateMapListenersForSpace(\n                            space,\n                            () => {},\n                            () => {},\n                            () => {\n                                if(!this.serviceAccount) {\n                                    this.activeSpace.next(space);\n                                    this.focusOnRoom();\n                                }\n                               \n                            }\n                        )\n                    );\n                });\n                this.style_map.next(styles);\n                this.listeners.next(listeners);\n                this.isOverlayOpened && this.focusOnRoom();\n            })\n        );\n\n        this.subscription(\n            'bookingResults',\n            this.resultSpaces\n                .pipe(withLatestFrom(this.activeSpace))\n                .subscribe(([resultSpaces, activeSpace]) => {\n                    this.spaceListOptions.next(resultSpaces.map(mapRoomToSelectOption));\n                })\n        );\n\n        this.subscription(\n            'setActiveSpace',\n            this.resultSpaces\n            .subscribe((next) => {\n                // console.log(this.focusedRoom?.value?.space?.id);\n                const space =  next.find((s) => s.id === this.focusedRoom?.value?.space?.id)\n                space && this.activeSpace.next(space);\n            })\n        );\n\n\n       \n\n        this.subscription(\n            'storeResultedBuildings',\n            this.store.pipe(select(selectSelectedBuildingOptions)).subscribe((buildings) => {\n                this.resultBuildings.next(this.payload.building);\n                // if we dont have active building yet, set it here.\n                if (buildings.length > 0 && !this.activeBuilding.value) {\n                    const firstBuilding = buildings[0];\n                    this.activeBuilding.next(firstBuilding);\n                }\n            })\n        );\n\n        this.subscription(\n            'activeBuildingChange',\n            this.activeBuilding\n                .pipe(\n                    filterUndefined<Building>(),\n                    map((b: Building) => b.levels)\n                )\n                .subscribe((levels) => {\n                    this.buildingLevelOptions.next(levels.map(mapBuildingLevelToOption));\n                })\n        );\n\n        // if levels change and active level no longer part of list, pick first.\n        this.subscription(\n            'updateActiveLevelOnActiveBuildingChange',\n            this.activeBuilding\n                .pipe(\n                    filterUndefined<Building>(),\n                    distinctUntilChanged(),\n                    withLatestFrom(this.activeLevel),\n                    map(\n                        ([building, activeLevel]) =>\n                            (activeLevel && building.levels.find((l) => l.id === activeLevel.id)) ||\n                            building.levels[0]\n                    )\n                )\n                .subscribe((level) => {\n                    this.activeLevel.next(level);\n                })\n        );\n\n        // re-request rooms every minute to update space status.\n        this.subscription(\n            'updateSpaceStatusInterval',\n            interval(60 * 1000)\n                .pipe(withLatestFrom(this.store.select(selectActiveForm)))\n                .subscribe(([, form]) => {\n                   \n                    form['date'] =  closestToTimeSlot(DateTime.now().plus({ minutes: 1 }), WAITING_TIME).valueOf(),\n                    form.dateTz = closestToTimeSlotTz(\n                        new DateTZ({ date: DateTime.now().plus({ minutes: 1 }), is_local_tz: false, building_tz: form.timezone }),\n                        WAITING_TIME\n                    )\n                    this.store.dispatch(storeBookingFormData({ payload: form }));\n                    this.store.dispatch(loadRoomsForResults.request(roomFormDataToQuery(form)));\n                })\n        );\n\n        this.selectActiveBuilding(this.payload.building);\n        this.selectBuildingLevel(selection);\n\n    }\n\n    public zoomIn() {\n        if (this.zoom.value < MAX_ZOOM_LEVEL) {\n            this.zoom.next(this.zoom.value + 1);\n        }\n    }\n\n    public zoomOut() {\n        if (this.zoom.value > MIN_ZOOM_LEVEL) {\n            this.zoom.next(this.zoom.value - 1);\n        }\n    }\n\n    public displayOfficeInformation() {\n        this.dialog.open(OfficeInformationModalComponent, {\n            data: this.activeBuilding.value,\n            panelClass: 'mck-alert',\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n    }\n\n    public resetZoomLevels() {\n        this.zoom.next(MIN_ZOOM_LEVEL);\n        this.center.next(CENTER_POINT);\n        this.focusedRoom.next(undefined);\n    }\n\n    public selectActiveBuilding(selection: SelectOption<any>) {\n        this.resultBuildings\n            .pipe(\n                map((all) => all.find((b) => b.id === selection.value)),\n                take(1),\n                filterUndefined<Building>()\n            )\n            .subscribe((next) => {\n                this.activeBuilding.next(next);\n            });\n    }\n\n    public selectBuildingLevel(selection: SelectOption<any>) {\n        this.activeBuilding\n            .pipe(\n                map((b) => b.levels?.find((l) => l.id === selection?.value)),\n                take(1),\n                filterUndefined<BuildingLevel>()\n            )\n            .subscribe((next) => {\n                this.activeLevel.next(next);\n            });\n    }\n\n    public selectActiveSpace(selection?: SelectOption<any>) {\n        this.resultSpaces\n            .pipe(\n                map((all) => all.find((s) => s.id === this.focusedRoom?.value.space.id)),\n                // take(1),\n                filterUndefined<Space>()\n            )\n            .subscribe((next) => {\n                this.activeSpace.next(next);\n            });\n    }\n\n    public focusOnRoom() {\n        // this.selectedSpace = space;\n        this.activeSpace.pipe(take(1), filterUndefined<Space>()).subscribe((next) => {\n            let delay = 0;\n            if (next.level.id !== this.activeLevel.value.id) {\n                this.activeLevel.next(next.level);\n                delay = 500;\n            }\n            this.timeout(\n                'updateLevelAndRoom',\n                () => {\n                    const focusedRoom = mapResultsToViewModels(\n                        [this.activeSpace.value],\n                        [this.activeLevel.value],\n                        [this.activeBuilding.value]\n                    );\n                    // this.focusedRoom.next(null);\n                   \n                    this.focusedRoom.next(cloneDeep(focusedRoom[0]));\n                    this.isOverlayOpened && this.childCallback( cloneDeep(focusedRoom[0]) );\n\n\t\t\t\t\tconst { filters, settings } = this.focusedRoom?.value?.space; // use of new data structure fields\n                    if ( this.roomStatus.statusMap[this.focusedRoom.value.space.id] === 'requestable' || (filters?.equipment_code ||  settings?.equipment_code) ) {\n                        // submit\n                        this.store.dispatch(\n                            storeBookingFormData({\n                                payload: {\n                                    ...this.bookingFormData.value,\n                                    selectedRoom: this.focusedRoom.value,\n                                },\n                            })\n                        );\n                        this.roomSelected(this.focusedRoom.value);\n                    }\n                    !this.isOverlayOpened && this.focusedMapSpace.next(roomToMapFeature(this.focusedRoom.value, this));\n                    this.zoom.next(6);\n                },\n                delay\n            );\n        });\n    }\n\n    public isOverlayOpened =  false;\n    public childCallback;\n\n    public exitFullscreen(route: string): void {\n        this.store.dispatch(clearRoomFilters());\n\n        this.store.select(selectActiveForm).pipe(take(1))\n\t\t\t\t\t.subscribe((form) => {\n\t\t\t\t\t\tform.bookingType = bookingTypeOptions[0],\n                        form.roomSize = defaultRoomSizeOption,\n\t\t\t\t\t\t\tthis.store.dispatch(storeBookingFormData({ payload: form }));\n\t\t\t\t\t});\n\n        const navigationExtras = {\n            state: { payload: this.activeLevel.value },\n            relativeTo: this.route,\n            queryParams: {\n                display: 'map',\n            },\n        };\n        this._service.kioskFormFilter = true;\n        this.router.navigate([route], navigationExtras);\n    }\n\n    // public triggerRefresh(){\n    //     this.subscription(\n    //         'activeForm',\n    //         this.store\n    //             .pipe(select(selectActiveForm), distinctUntilChanged())\n    //             .subscribe((next: BookingFormData | undefined) => {\n    //                 if (next) {\n    //                     next.duration = 35;\n    //                     this.bookingFormData.next(next);\n    //                 }\n    //             })\n    //     );\n\n    //     this.subscription(\n    //         'bookingSpaceResults',\n    //         combineLatest([\n    //             this.store.pipe(\n    //                 select(selectMapFilteredResults),\n    //                 map((r: LoadingModel<FilteredSpaces>) => r.success)\n    //             ),\n    //             this.activeBuilding.pipe(filterUndefined<Building>()),\n    //             this.activeLevel.pipe(filterUndefined<BuildingLevel>()),\n    //         ]).subscribe(([filteredSpaces, building, level]) => {\n    //             this.roomStatus = filteredSpaces;\n\n    //             const spacesFromSelection = (filteredSpaces.spaces || []).filter(\n    //                 (s) =>\n    //                     !!s.map_id &&\n    //                     s.zones.includes(building.id) &&\n    //                     s.zones.includes(this.payload?.payload)\n    //             );\n\n    //             this.resultSpaces.next(spacesFromSelection);\n\n    //             const listeners: MapListener[] = [];\n    //             const styles: HashMap<HashMap<string | number>> = {};\n    //             const colour_map = this.settingService.get('app.explore.colors') || {};\n    //             spacesFromSelection.forEach((space) => {\n    //                 const status = filteredSpaces.statusMap[space.id];\n    //                 const mapStyle = generateMapStyleForSpace(space, status, colour_map);\n    //                 styles[`#${mapStyle.id}`] = mapStyle.styles;\n    //                 listeners.push(\n    //                     ...generateMapListenersForSpace(\n    //                         space,\n    //                         () => {},\n    //                         () => {},\n    //                         () => {\n    //                             this.activeSpace.next(space);\n    //                             this.focusOnRoom();\n    //                         }\n    //                     )\n    //                 );\n    //             });\n    //             this.style_map.next(styles);\n    //             this.listeners.next(listeners);\n    //         })\n    //     );\n\n    //     this.subscription(\n    //         'bookingResults',\n    //         this.resultSpaces\n    //             .pipe(withLatestFrom(this.activeSpace))\n    //             .subscribe(([resultSpaces, activeSpace]) => {\n    //                 this.spaceListOptions.next(resultSpaces.map(mapRoomToSelectOption));\n    //             })\n    //     );\n    // }\n\n    public roomSelected(room: RoomResultsViewModel) {\n        // submit\n        // this.store.dispatch(\n        //     storeBookingFormData({\n        //         payload: {\n        //             ...this.bookingFormData.value,\n        //             selectedRoom: room,\n        //         },\n        //     })\n        // );\n\n        let organiser = { display: this.currentUser.name, value: this.currentUser.email };\n        this.store.dispatch(\n            storeBookingFormData({\n                payload: {\n                    organiser: organiser,\n                    title: 'Ad hoc meeting',\n                    // attendees: [this.currentUser],\n                    code: '',\n                    notes: '',\n                    head_count: 1,\n                    selectedRoom: room,\n                },\n            })\n        );\n\n        this.router.navigate(['../create'], { relativeTo: this.route });\n    }\n\n    public getDayOfWeek(date: string | number | Date) {\n        const dayOfWeek = new Date(date).getDay();\n        return isNaN(dayOfWeek)\n            ? null\n            : ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'][\n                  dayOfWeek\n              ];\n    }\n\n    public confirmBooking = (bookingData: {}) => {\n        this.bookingConfirmed = true;\n        this.bookingData = bookingData;\n    };\n}\n","<div>\n    <div class=\"mck-column map-search-container\" *ngIf=\"!bookingConfirmed\">\n        <div class=\"map-wrapper\" [class.wrapper-height]=\"openHeader\">\n            <img\n                src=\"assets/icon/map-info.png\"\n                (click)=\"displayOfficeInformation()\"\n                class=\"map-info-button\"\n            />\n            <app-map-controls\n                (zoomInClick)=\"zoomIn()\"\n                (zoomOutClick)=\"zoomOut()\"\n                (refreshClick)=\"resetZoomLevels()\"\n            ></app-map-controls>\n            <a-map\n                [zoom]=\"zoom | async\"\n                (zoomChange)=\"zoom.next($event)\"\n                [center]=\"center | async\"\n                (centerChange)=\"center.next($event)\"\n                [src]=\"mapUrl | async\"\n                [css]=\"style_map | async\"\n                [listeners]=\"listeners | async\"\n                [features]=\"features | async\"\n                [focus]=\"(focusedMapSpace | async)?.id\"\n            >\n            </a-map>\n        </div>\n        <button *ngIf=\"!serviceAccount\"\n            class=\"\n                exit-button\n                mat-focus-indicator\n                mck-secondary-button\n                mat-stroked-button mat-button-base\n            \"\n            (click)=\"exitFullscreen('/home/results')\"\n        >\n            Exit Fullscreen\n        </button>\n    </div>\n    <div *ngIf=\"bookingConfirmed\" class=\"booking-confirmation\">\n        <div class=\"scroll-wrapper\">\n            <div class=\"booking-info-top\">\n                <div class=\"center-wrapper\">\n                    <div>Booking Confirmed</div>\n                    <div class=\"booking-info-top-card\">\n                        <div class=\"green-confirmation-bar\">\n                            <img src=\"assets/icon/booking_confirmed.svg\" />\n                            <div>Confirmed</div>\n                        </div>\n                        <div class=\"card\">\n                            <div>Status: Confirmed</div>\n                            <div>Date: {{this.getDayOfWeek(this.bookingData?.date_string)}}, {{this.bookingData?.date_string}}</div>\n                            <div>Time: {{this.bookingData?.time_period}} GMT{{this.bookingData?.tz_offset}}</div>\n                            <div>{{this.bookingData?.booking_type}} meeting ({{this.bookingData?.duration}} minutes)</div>\n                            <div>Address: {{this.activeBuilding?.value.address}}, {{this.activeBuilding?.value.city}}</div>\n                            <div>Room: {{this.focusedRoom.value.title}}</div>\n                            <div>Room {{this.focusedRoom.value.capacity}} </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class=\"booking-info-bottom\">\n                <div class=\"booking-info-wrapper\">\n                <div>Host: {{this.currentUser?.name}}</div>\n                <div>Attendees: {{this.currentUser?.name}}</div>\n                <div>Charge Code: {{this.focusedRoom?.value.space.filters.charge_code === false ? \"No charge code\" : \"\"}}</div>\n                <div>Headcount Estimate: {{this.bookingData?.attendees.length}}</div>\n                <div>Additional Requirements: {{this.bookingData?.notes[0]}}</div>\n            </div>\n        </div>\n        </div>\n        <div class=\"bottom-card\">\n            <button\n                (click)=\"exitFullscreen('/home')\"\n                class=\"\n                    mat-focus-indicator\n                    mck-primary-button mck-modal-primary-button\n                    mat-button mat-button-base\n                \"\n            >\n                Close\n            </button>\n        </div>\n    </div>\n</div>\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    OnInit,\n    Output\n} from '@angular/core';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { BehaviorSubject } from 'rxjs';\nimport {\n    ActivatedRoute,\n    ParamMap,\n    Router\n} from '@angular/router';\nimport { deepDistinctUntilChanged } from '@mckinsey-converge/rx-utils';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\n@Component({\n    selector: 'app-results-header',\n    template: `\n        <div class=\"mck-row results-header\">\n            <div class=\"mck-column mck-space-between mck-flex-1\">\n                <h1 class=\"results-header-text\">Results</h1>\n                <span class=\"results-header-matching-criteria\"\n                      *ngIf=\"resultsCount >= 0\">Matching your search criteria ({{resultsCount}})</span>\n            </div>\n            \n            <mck-toggle [options]=\"toggleOptions\"\n                        [selected]=\"selectedToggle | async\"\n                        (selectedChange)=\"onSelectedChange($event)\"></mck-toggle>\n        </div>\n    `,\n    styleUrls: ['./results-header.component.scss']\n})\nexport class ResultsHeaderComponent extends BaseDirective implements OnInit {\n\n    public toggleOptions: SelectOption<any>[] = [\n        {\n            value: 0,\n            display: 'List',\n            meta: { \n                mobile: true\n            }\n        },\n        {\n            value: 1,\n            display: 'Map',\n            meta: { \n                mobile: true\n            }\n        },\n        {\n            value: 2,\n            display: 'Calendar',\n            meta: { \n                route: 'booking-calendar',\n                mobile: false\n            }\n        }\n    ];\n\n    public selectedToggle = new BehaviorSubject<SelectOption<any>>(this.toggleOptions[0]);\n\n    @Input()\n    public resultsCount: number | undefined;\n\n    @Output()\n    public selectedToggleChange = new EventEmitter<SelectOption<any>>();\n\n    constructor(private router: Router,\n                private route: ActivatedRoute) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.selectedToggleChange.next(this.selectedToggle.value);\n\n        this.subscription('paramsToUI', this.route.queryParamMap\n            .pipe(deepDistinctUntilChanged())\n            .subscribe((next: ParamMap) => {\n                const retrievedOption = this.toggleOptions.find(o => o.display.toLowerCase() === next.get('display'));\n                this.onSelectedChange(retrievedOption ?? this.toggleOptions[0]);\n            }));\n    }\n\n    public onSelectedChange(option: SelectOption<any>) {\n        this.selectedToggle.next(option);\n        this.selectedToggleChange.next(option);\n\n        if(option.meta?.route) {\n            this.router.navigate(['booking-calendar'], { relativeTo: this.route });\n        }\n        else {\n             // toggle route.\n            this.router.navigate([], {\n                relativeTo: this.route,\n                queryParams: {\n                    display: option.display.toLowerCase()\n                },\n                queryParamsHandling: 'merge'\n            });\n        }\n       \n\n    }\n\n}\n","import {\n    Component,\n    Inject,\n    OnInit,\n    Output,\n    EventEmitter,\n    ViewEncapsulation\n} from '@angular/core';\nimport {\n    MAT_DIALOG_DATA,\n    MatDialogRef\n} from '@angular/material/dialog';\n\nimport {\n    AbstractControl,\n    FormControl,\n    FormGroup,\n    Validators\n} from '@angular/forms';\nimport {\n    dateBuildingFormatString,\n    startEndTimeWithZoneFormatString,\n    humaniseDuration,\n    closestToTimeSlotTz\n} from '@mckinsey-converge/base';\nimport {\n    Space,\n    SpacesService,\n    DEFAULT_BOOKING_DURATION,\n    checkCollisions,\n    Booking\n} from '@mckinsey-converge/data-common';\nimport { DateTZ, convertLocalTimestampToTimezonedDateTz, convertTimezonedTimestampToLocalDateTz, DateNow } from '@mckinsey-converge/date-tz';\n\ninterface ModalData {\n    dateTz: DateTZ,\n    duration: number,\n    pendingDateTz: DateTZ,\n    pendingDuration: number,\n    space?: Space,\n    rules?: any,\n    bookingId?: string,\n    currentBooking?: Booking,\n}\n\n@Component({\n    selector: 'app-room-availability-preview-modal',\n    template: `\n        <div>\n        <mat-dialog-content class=\"av-modal\">\n            <div class=\"mck-column modal-heading\">\n                <button name=\"CloseButton\" class=\"close-button\" mat-icon-button (click)=\"closeModal()\">\n                    <div class=\"close-image\"></div>\n                </button>\n                <div class=\"header\">New Booking Date/Time</div>\n                <form [formGroup]=\"formGroup\">\n                    <div class=\"mck-row-flow\">\n                        <date-tz-date-picker\n                            label=\"Start date\"\n                            [required]=\"true\"\n                            class=\"mck-form-input time-inputs-calendar\"\n                            formControlName=\"dateTz\"\n                            (onSelect)=\"updateDatePickerValue($event)\">\n                        </date-tz-date-picker>\n                        <mck-spacer size=\"16px\" [mode]=\"'vertical'\" [autoSize]=\"true\"\n                                spacerClass=\"mck-spacer-content-collapse-tablet\"></mck-spacer>\n                        <date-tz-time-field\n                            class=\"time-inputs\"\n                            label=\"Start time\"\n                            [required]=\"true\"\n                            name=\"start-time\"\n                            [fromDateTz]=\"fromDateTz\"\n                            [ngModel]=\"formGroup.controls.dateTz.value\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            (ngModelChange)=\"setValue($event, formGroup.controls.dateTz)\">\n                        </date-tz-time-field>\n                        <mck-spacer size=\"16px\" [mode]=\"'vertical'\" [autoSize]=\"true\"></mck-spacer>\n                        <date-tz-duration-field\n                            class=\"time-inputs\"\n                            label=\"End time\"\n                            name=\"end-time\"\n                            [startDateTz]=\"formGroup.controls.dateTz.value\"\n                            [max_length]=\"data.rules?.max_length\"\n                            [required]=\"true\"\n                            [ngModel]=\"formGroup.controls.duration.value\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            (ngModelChange)=\"setValue($event, formGroup.controls.duration)\">\n                        </date-tz-duration-field>\n                    </div>\n                </form>\n                <p *ngIf=\"available === true\" class=\"available\">Room is available for selected date/time.</p>\n                <p *ngIf=\"available === false\">Room is unavailable for selected date/time.</p>\n                <p *ngIf=\"available === null\" class=\"checking pulsate\">Checking availability for selected date/time...</p>\n                <p *ngIf=\"localTimezone !== buildingTimezone\" class=\"coachmark\">\n                    Please be aware that this booking starts at {{localStart}} and ends at {{localEnd}} in your local timezone.\n                </p>\n            </div>\n            <div class=\"mck-column modal-body\">\n                <div>\n                    <div>\n                        <h3>Old</h3>\n                        <p>Date: {{dateString}}</p>\n                        <p>Time: {{timeString}}</p>\n                        <p>({{durationString}})</p>\n                        <img src=\"assets/icon/next-arrow.svg\" />\n                    </div>\n                    <div class=\"new\">\n                        <h3>New</h3>\n                        <p>Date: {{pendingDateString}}</p>\n                        <p>Time: {{pendingTimeString}}</p>\n                        <p>({{pendingDurationString}})</p>\n                    </div>\n                </div>\n            </div>\n        </mat-dialog-content>\n        <mat-dialog-actions>\n                <mck-modal-button-row\n                    [primaryDisabled]=\"!available\"\n                    primaryLabel=\"Confirm\" (primarySubmit)=\"confirm()\"\n                    secondaryLabel=\"Cancel\" (secondarySubmit)=\"closeModal()\"\n                ></mck-modal-button-row>\n        </mat-dialog-actions>\n        </div>\n    `,\n    styleUrls: ['./room-availability-preview-modal.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n})\nexport class RoomAvailabilityPreviewModalComponent implements OnInit {\n    @Output() public submitForm = new EventEmitter<any>();\n    public dateString: string;\n    public timeString: string;\n    public durationString: string;\n    public pendingDateString: string;\n    public pendingTimeString: string;\n    public pendingDurationString: string;\n    public mapBookingRules: readonly string[];\n    public mapBookingSubtitle: string;\n    public fromDateTz: DateTZ = closestToTimeSlotTz(new DateTZ(), 15);\n    public available: boolean = null;\n    public formGroup = new FormGroup({\n        dateTz: new FormControl(this.fromDateTz, [Validators.required]),\n        duration: new FormControl(DEFAULT_BOOKING_DURATION, [Validators.required])\n    });\n    public localTimezone = \"\";\n    public buildingTimezone = \"\";\n    public localStart = \"\";\n    public localEnd = \"\"\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) public data: ModalData,\n        private dialogRef: MatDialogRef<RoomAvailabilityPreviewModalComponent>,\n        private _spaces: SpacesService,\n    ) {}\n\n    public get pending_date(){\n        return this.data.pendingDateTz; // new DateTZ({ date: this.data.pendingDate.valueOf(), is_local_tz: false, building_tz: this.data?.space?.timezone })\n    }\n\n    public ngOnInit(): void {\n        console.log('Here 1');\n        this.formGroup.setValue({\n            dateTz: this.data.pendingDateTz,\n            duration: this.data.pendingDuration,\n        });\n        console.log('Here 2');\n        this.updateDisplay();\n    }\n\n    // Method run when the confirming the modal.\n    public applyChanges(changes: any): void {\n        this.data.pendingDateTz = changes.pendingDateTz; // new Date(changes.pendingDate.valueOf());\n        this.data.pendingDuration = changes.pendingDuration;\n        this.updateDisplay();\n    }\n\n    public updateDisplay() {\n        // this.data.dateTz is the existing time in building time\n        // this.data.pendingDateTz is the new time in building time\n        const dateTz = this.data.dateTz;\n        this.dateString = dateBuildingFormatString(dateTz);\n        this.timeString = startEndTimeWithZoneFormatString(dateTz, dateTz.addValue({ minutes: this.data.duration }));\n        this.durationString = humaniseDuration(this.data.duration);\n\n        const pendingDateTz = this.data.pendingDateTz;\n        this.pendingDateString = dateBuildingFormatString(pendingDateTz);\n        this.pendingTimeString = startEndTimeWithZoneFormatString(pendingDateTz, pendingDateTz.addValue({ minutes: this.data.pendingDuration }));\n        this.pendingDurationString = humaniseDuration(this.data.pendingDuration);\n        this.fromDateTz = closestToTimeSlotTz(pendingDateTz, 15); // building value\n\n        const setup = {};\n        setup[this.data.space.email] = this.data?.currentBooking?.setup[this.data?.space?.email] || 0;\n        const breakdown = {};\n        breakdown[this.data.space.email] = this.data?.currentBooking?.setup[this.data?.space?.email] || 0;\n\n        this.updateCoachmarkTimes(this.data?.space?.timezone);\n\n        const mockBooking = new Booking({\n            id: this.data.bookingId,\n            start_epoch: this.data.pendingDateTz.seconds,\n            end_epoch: this.data.pendingDateTz.addValue({ minutes: this.data.pendingDuration }).seconds,\n            room: this.data.space,\n            setup,\n            breakdown, \n        });\n\n        checkCollisions(\n            this._spaces,\n            mockBooking\n        ).then((bookable: boolean) => {\n            this.available = bookable;\n        }).catch(() => {\n            this.available = false;\n        });\n    }\n\n    public closeModal() {\n        this.dialogRef.close(null);\n    }\n\n    public updateDatePickerValue(dateTz: DateTZ) {\n        const pending_date: DateTZ = this.formGroup.value.dateTz\n        const day = pending_date.setValue({ \n            day: dateTz.dateDay,\n            month: dateTz.dateMonth,\n            year: dateTz.dateYear\n         });\n        this.setValue(day, this.formGroup.controls.dateTz);\n    }\n\n    public setValue($value, formControl: AbstractControl) {\n        // valid options are in building time\n        formControl.setValue($value); // bulding time\n        this.submitForm.emit(this.formGroup.value);\n    }\n\n    public confirm() {\n        const setup = {};\n        setup[this.data.space.email] = this.data?.currentBooking?.setup[this.data?.space?.email] || 0;\n        const breakdown = {};\n        breakdown[this.data.space.email] = this.data?.currentBooking?.setup[this.data?.space?.email] || 0;\n\n        const buildingDate = convertLocalTimestampToTimezonedDateTz(this.data.pendingDateTz.ms, this.data?.currentBooking?.timezone);\n        const mockBooking = new Booking({\n            id: this.data.bookingId,\n            start_epoch: buildingDate.seconds,\n            end_epoch: buildingDate.addValue({ minutes: this.data.pendingDuration }),\n            room: this.data.space,\n            setup,\n            breakdown, \n        });\n\n        checkCollisions(\n            this._spaces,\n            mockBooking\n        ).then((bookable: boolean) => {\n            this.available = bookable;\n            this.dialogRef.close({\n                ...this.formGroup.value,\n            });            \n        }).catch(() => {\n            this.available = false;\n        });\n    }\n\n    private updateCoachmarkTimes(timezone: string) {\n        if (timezone) {\n            this.buildingTimezone = timezone;\n            const localizedStartDate = this.formGroup.value.dateTz;\n            const localizedEndDate = localizedStartDate.addValue({ minutes: this.formGroup.value.duration });\n            this.localStart = localizedStartDate.formatLocalDate(\"h:mma\");\n            this.localEnd = localizedEndDate.formatLocalDate(\"h:mma\");\n        } else {\n            this.buildingTimezone = this.localTimezone.slice(0);\n            this.localStart = \"\";\n            this.localEnd = \"\";\n        } \n    }\n}\n","import {\n    Component,\n    ChangeDetectionStrategy,\n    Input,\n    OnInit,\n    OnChanges,\n    ElementRef,\n    ViewChild,\n    EventEmitter,\n    Output,\n    SimpleChanges,\n    ChangeDetectorRef,\n} from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { fromEvent, Subject, BehaviorSubject, Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { throttleTime, tap } from 'rxjs/operators';\nimport { CalendarEvent, CalendarEventTimesChangedEvent } from 'angular-calendar';\nimport { BaseClass, durationHumanized, isLessThanBreakpoint } from '@mckinsey-converge/base';\nimport {\n    Booking,\n    Building,\n    BuildingLevel,\n    Space,\n    User,\n    rulesForSpace,\n    SpaceRules,\n} from '@mckinsey-converge/data-common';\nimport { generateFeedbackUrl, Urls } from '../../utilities/urls';\nimport { TopBarHeaderMode } from '../room-location-preview/room-location-preview.component';\nimport { RoomAvailabilityPreviewModalComponent } from '../room-availability-preview-modal/room-availability-preview-modal.component';\nimport {\n    DateNow,\n    DateTZ,\n    convertLocalTimestampToTimezonedDateTz,\n    convertTimezonedTimestampToLocalDateTz,\n    timezoneOffset,\n} from '@mckinsey-converge/date-tz';\nimport { utcToZonedTime } from 'date-fns-tz';\nimport { FormControl } from '@angular/forms';\nimport { DateTime } from 'luxon';\n\nconst WEEKEND_DAYS = [6, 7];\nconst colors = {\n    grey: {\n        secondary: '#D2D2D2',\n        primary: '#A19F9F',\n    },\n    blue: {\n        secondary: '#C0DBF5',\n        primary: '#00A9F4',\n    },\n    red: {\n        secondary: '#EB5757',\n        primary: '#EB5757',\n    },\n};\n\ninterface CalendarClickEvent {\n    date: Date;\n}\n\nexport interface BookingBumper {\n    top?: string;\n    bottom?: string;\n    height: string;\n    backgroundColor: string;\n}\nexport interface BookingBumpers {\n    top: BookingBumper;\n    bottom: BookingBumper;\n}\n\nexport type BookingPlus = Booking & { start: number; end: number }; // R--- why again?\nexport type CalendarEventPlus = CalendarEvent<any> & { bumper?: BookingBumpers; booking?: Booking };\n\n@Component({\n    selector: 'room-availability-preview',\n    templateUrl: './room-availability-preview.component.html',\n    styleUrls: ['./room-availability-preview.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class RoomAvailabilityPreviewComponent extends BaseClass implements OnInit, OnChanges {\n    @ViewChild('scrollContainer') scrollContainer: ElementRef<HTMLElement>;\n\n    @Input() public alternativeWeekStartDateTz: DateTZ;\n    // Used when editing a booking\n    @Input() public bookingId?: string;\n    @Input() public bookings: BookingPlus[];\n    /** retain as mutable */\n    @Input() public building: Building;\n    // R--- could probably use the currentBooking ID edit,\n    // The bookingId was an after thought\n    @Input() public currentBooking: Booking;\n    @Input() public currentUser: User;\n    @Input() public dateTz: DateTZ;\n    @Input() public duration: number;\n    @Input() public expanded: boolean;\n    @Input() public level: BuildingLevel;\n    /** The theme to use **/\n    @Input() public mode: TopBarHeaderMode = TopBarHeaderMode.Light;\n    @Input() public space: Space;\n    // @Input() public timezone: string;\n\n    @Output() public confirmChanges: EventEmitter<any> = new EventEmitter();\n    @Output() public handleExpand: EventEmitter<any> = new EventEmitter();\n    @Output() public updateCalendarWeekView: EventEmitter<DateTZ> = new EventEmitter();\n    @Output() public warnIfItHasConflict: EventEmitter<any> = new EventEmitter();\n\n    constructor(public dialog: MatDialog) {\n        super();\n    }\n\n    public breakpoint = 768;\n    public mobile = false;\n    public showDatePicker = false;\n    public events: CalendarEventPlus[] = [];\n    public dayStartHour: number;\n    public dayEndHour: number;\n    public viewDateTz: DateTZ;\n    public weekViewDateTz: DateTZ;\n    public weekViewRangeText: string;\n    public showWeekend: boolean = false;\n    public currentPage: string;\n    public calendarPopupValue = new BehaviorSubject<DateTZ>(DateNow(new Date()));\n    public pendingChange: boolean = false;\n    public pendingDateTz: DateTZ;\n    public pendingDuration: number;\n    public eventSnapSize: number = 15;\n    public dayRefresh: Subject<any> = new Subject();\n    public weekRefresh: Subject<any> = new Subject();\n    public addMarginOnConflict: boolean = false; // helps to add html class to adjust margin top in case of QR code scan conflict\n    public event: CalendarEventPlus = {\n        start: new Date(),\n        end: new Date(),\n        title: '',\n        color: colors.blue,\n        cssClass: 'selected',\n        actions: null,\n        resizable: {\n            beforeStart: false,\n            afterEnd: false,\n        },\n        draggable: false,\n    };\n\n    public get timezone(): string {\n        return this.dateTz.building_tz;\n    }\n\n    public get one_day_in_millis() {\n        return 86400000;\n    }\n\n    public get thirty_minutes_in_millis() {\n        return 1800000;\n    }\n    public rules: SpaceRules;\n    public modal_data: any = {};\n    public scrollFired: boolean = false;\n\n    // Values to display a span on the date picker, but the date picker doesn't support this.\n    public date_span = {\n        start: 0,\n        end: 0,\n    };\n\n    // I can't think of any reason the calendar widget needs to go back further than 2 years, if even that.\n    public fromDateTz = DateNow(new Date()).subtractValue({ years: 2 });\n\n    public dateControl = new FormControl(new Date().valueOf());\n\n    public isEventDate(d: CalendarClickEvent) {\n        const date = new DateTZ({ date: d.date.valueOf() }); // local time I think.. problem TODO\n        return this.pendingDateTz.isSameDate(date, 'day');\n    }\n\n    public get inputDate(): Observable<DateTZ> {\n        return this.calendarPopupValue.pipe(map((d) => d));\n    }\n\n    public get feedback() {\n        return generateFeedbackUrl(this.currentPage);\n    }\n\n    public ngOnInit(): void {\n        // R--- retrun to document\n        this.mobile = isLessThanBreakpoint(this.breakpoint);\n        this.pendingDateTz = this.dateTz.clone();\n        const date = this.dateTz.clone();\n        const currentBookingStartDate = this.currentBooking\n            ? this.currentBooking.startDateTz.addValue({ seconds: 0 })\n            : date;\n        this.alternativeWeekStartDateTz = date.startOfValue('week').startOfValue('day');\n\n        // Not sure if this is correct\n        this.weekViewDateTz = this.alternativeWeekStartDateTz.clone();\n\n        this.calendarCenter();\n        this.pendingDuration = this.duration;\n        this.viewDateTz = new DateTZ({ \n            date: DateTime.fromISO(this.pendingDateTz.formatDate('yyyy-MM-dd'))\n        }).setValue({ hour: 12, minute: 0 });\n        this.setCalendarValue(this.pendingDateTz);\n        this.showWeekend =\n            WEEKEND_DAYS.includes(currentBookingStartDate.dateWeekday) ||\n            WEEKEND_DAYS.includes(date.dateWeekday);\n        this.setupEventName();\n        this.transformBookings();\n        fromEvent(window, 'resize')\n            .pipe(throttleTime(500))\n            .pipe(\n                tap({\n                    next: (val) => {\n                        const target = val.target as Window;\n                        this.mobile = target.innerWidth < this.breakpoint;\n                        this.expanded ? this.weekRefresh.next() : this.dayRefresh.next();\n                    },\n                })\n            )\n            .subscribe();\n\n        this.rules = rulesForSpace({\n            time: this.dateTz.ms,\n            duration: this.duration,\n            user: this.currentUser,\n            rules: this.building?.booking_rules,\n            space: this.space,\n        });\n\n        // Update the display when the screen resizes.\n        fromEvent(window, 'resize')\n            .pipe(throttleTime(500))\n            .pipe(\n                tap({\n                    next: (val) => {\n                        this.mobile = isLessThanBreakpoint(this.breakpoint);\n                        this.calendarCenter();\n                        this.setDislayValues();\n                    },\n                })\n            )\n            .subscribe();\n        this.dateControl.setValue(this.dateTz);\n        this.transformBookings();\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.expanded) {\n            // set if the event is editable\n            this.event.draggable = this.expanded;\n            this.event.resizable = {\n                beforeStart: this.expanded,\n                afterEnd: this.expanded,\n            };\n            const date = this.dateTz;\n            this.setCalendarValue(date);\n        }\n\n        if (this.dayStartHour) this.scrollTo();\n\n        if (!this.pendingDateTz) return;\n\n        if (changes.bookings || changes.expanded) {\n            this.transformBookings();\n        }\n        if (changes.alternativeWeekStartDateTz) {\n            this.setDislayValues();\n        }\n        if (changes.expanded) {\n            this.expanded ? this.weekRefresh.next() : this.dayRefresh.next();\n        }\n    }\n\n    public setDislayValues() {\n        const tz_offset = timezoneOffset(this.alternativeWeekStartDateTz.building_tz).hours\n        const week_start_date = this.alternativeWeekStartDateTz.subtractValue({hours: tz_offset}).clone(); // Operation needed to trick the mwl-calendar-week-view to display the correct day if the day changes between timezones \n        this.weekViewDateTz = this.weekViewDateTz || this.alternativeWeekStartDateTz.clone();\n        let week_view_date = this.weekViewDateTz.startOfValue('week'); // new DateTZ({date: this.weekViewDate?.valueOf()}).startOfValue('week')\n        if (!this.showWeekend) {\n            // Advance from Sunday to Monday\n            week_view_date = week_view_date.addValue({ days: 1 });\n        }\n\n        if (this.mobile) {\n            this.weekViewDateTz = week_start_date\n            this.weekViewRangeText = `${this.weekViewDateTz.formatDate('d MMMM')}`;\n            this.calendarPopupValue.next(this.weekViewDateTz);\n        } else {\n            this.weekViewDateTz = week_start_date.addValue({ days: this.showWeekend ? 0 : 1 }); // new Date(week_start_date.addValue({ days: this.showWeekend ? 0 : 1 }).ms);\n            this.weekViewRangeText = `${week_view_date.formatDate('d MMMM')} - ${week_view_date\n                .addValue({ days: this.showWeekend ? 6 : 4 })\n                .formatDate('d MMMM yyyy')}`;\n            this.calendarPopupValue.next(week_view_date);\n        }\n    }\n\n    public getBumpers(booking: Booking, selected: boolean = false) {\n        const email = booking.space.email || this.space.email;\n        const setup = booking.setup[email] ? booking.setup[email] / 60 : 0;\n        const breakdown = booking.breakdown[email] ? booking.breakdown[email] / 60 : 0;\n\n        return {\n            top: {\n                top: `-${setup - 1}px`,\n                height: `${setup}px`,\n                backgroundColor: selected ? colors.blue.secondary : colors.grey.secondary,\n            },\n            bottom: {\n                bottom: `-${breakdown - 1}px`,\n                height: `${breakdown}px`,\n                backgroundColor: selected ? colors.blue.secondary : colors.grey.secondary,\n            },\n        };\n    }\n\n    public setupEventName() {\n        this.setDislayValues();\n        const pending_date = this.pendingDateTz.clone();\n        const start_date = pending_date.setValue({ second: 0, millisecond: 0 });\n        this.event.start = start_date.JSDate;\n        this.event.end = start_date.addValue({ minutes: this.pendingDuration }).JSDate;\n        const startHour = parseInt(pending_date.formatDate('H'), 10);\n\n        if (startHour === 0) {\n            this.dayStartHour = startHour;\n        } else if (startHour < 6) {\n            const offset = startHour > 3 ? startHour - 2 : startHour;\n            this.dayStartHour = startHour - offset;\n        } else {\n            // The min of 18 is needed so start times after 6pm\n            // don't push the calendar view beyond midnight.\n            const offset = Math.min(18, startHour - 3);\n            this.dayStartHour = offset;\n        }\n\n        if (!this.scrollFired && this.dayStartHour) {\n            this.scrollTo();\n        }\n\n        this.dayEndHour = Math.max(24, this.dayStartHour + 6);\n        this.event.title = `${pending_date\n            .formatDate('h:mma')\n            .toLocaleLowerCase()} (${durationHumanized(this.pendingDuration, true)})`;\n        this.event.cssClass = `selected ${this.showWeekend ? 'show-weekend' : ''} ${\n            this.mobile && this.expanded ? 'mobile' : ''\n        } `;\n\n        if (this.currentBooking) {\n            this.event.bumper = this.getBumpers(this.currentBooking);\n            this.event.booking = this.currentBooking;\n        }\n        this.expanded ? this.weekRefresh.next() : this.dayRefresh.next();\n    }\n\n    public transformBookings() {\n        this.calendarSpan();\n        const events = [];\n        if (Array.isArray(this.bookings)) {\n            this.bookings.forEach((raw_booking) => {\n                const booking = new Booking(raw_booking);\n                const { mode, duration } = this.displayClass(\n                    booking.startDateTz.ms,\n                    booking.endDateTz.ms\n                );\n\n                // back off a ms when end of day to avoid all day wrapping to next day.\n                let end = booking.endDateTz;\n                const endTime = booking.endDateTz;\n                if (endTime.minutes === 0 && endTime.seconds === 0) {\n                    // back off a ms when the end of day to avoid all day wrapping to next day.\n                    end = booking.endDateTz.subtractValue({ seconds: 1 });\n                }\n\n                // When editing skip over the current booking\n                if (booking.id === this.bookingId) return;\n\n                const utcStart = booking.startDateTz; // building time\n                const utcEnd = end; // building time\n                // adjust the time to appear as the same time locally ( but technically incorrect for building timezone )\n                const adjustedStartDate = utcToZonedTime(utcStart.ms, booking.timezone); // return local time\n                const adjustedEndDate = utcToZonedTime(utcEnd.ms, booking.timezone); // return local time\n\n                events.push({\n                    start: adjustedStartDate,\n                    end: adjustedEndDate,\n                    title: `Booked by ${booking.booker['name']}`,\n                    color: colors.grey,\n                    actions: null,\n                    cssClass: `booked ${this.mobile && 'mobile'} ${\n                        this.showWeekend ? 'show-weekend' : ''\n                    } ${mode}`,\n                    bumper: this.getBumpers(booking),\n                    resizable: {\n                        beforeStart: false,\n                        afterEnd: false,\n                    },\n                    draggable: false,\n                    booking,\n                });\n            });\n        }\n\n        const { mode, duration } = this.displayClass(\n            this.event.start.getTime(),\n            this.event.end.getTime()\n        );\n        const event = Object.assign({}, this.event);\n        const endTime = new DateTZ({ date: this.event.start.valueOf() }).addValue({\n            minutes: this.pendingDuration,\n        }); // building time\n        if (endTime.minutes === 0 && endTime.second === 0) {\n            // back off a ms when the end of day to avoid all day wrapping to next day.\n            event.end = endTime.subtractValue({ milliseconds: 1 }).JSDate; // building time\n        }\n\n        // adjust the time to appear as the same time locally ( but technically incorrect for building timezone )\n        // will need to adjust the other way with drag and drop and click actions.\n        event.start = utcToZonedTime(event.start, this.timezone); // local time\n        event.end = utcToZonedTime(event.end, this.timezone); // local time\n\n        event.cssClass = `selected ${this.mobile && this.expanded ? 'mobile' : ''}  ${mode}`;\n        if (this.currentBooking) {\n            event.bumper = this.getBumpers(this.currentBooking, true);\n            event.booking = this.currentBooking;\n        }\n\n        events.push(event);\n        this.events = events.slice();\n        this.updateTileColor();\n    }\n\n    public updateTileColor() {\n        const pending_date = this.pendingDateTz.clone();\n        const start = pending_date.setValue({ second: 0, millisecond: 0 });\n        const end = start.addValue({ minutes: this.pendingDuration });\n        const booked = this.events.filter((e) => !e.draggable); // this.events are in local time\n        const conflict = this.hasConflict(start, end, booked);\n        const isEvents = this.events.filter((e) => e.draggable);\n        if(isEvents.length ) {\n            isEvents[0].color = conflict ? colors.red : colors.blue;\n            this.addMarginOnConflict = conflict ? true : false;\n            \n        } \n        !this.expanded && this.warnIfItHasConflict.emit({room: this.space, hasConflict: conflict});\n    }\n    public displayClass(start: number, end: number) {\n        const duration = end - start;\n        return {\n            duration,\n            mode: duration > this.thirty_minutes_in_millis ? 'extended' : 'minimal',\n        };\n    }\n\n    public setCalendarValue(dateTz: DateTZ) {\n        let toDate = DateNow().startOfValue('minute');\n        if (dateTz) {\n            toDate = dateTz.startOfValue('minute');\n        }\n        if (!this.mobile && toDate.dateWeekday !== 7) {\n            toDate = toDate.startOfValue('week');\n        }\n        this.updateCalendarWeekView.emit(toDate);\n        this.weekRefresh.next();\n        this.alternativeWeekStartDateTz = toDate;\n        this.setDislayValues();\n    }\n\n    /**\n     * Convert the true bulding based time object to a timestamp skewed to the local time\n     *\n     * @param buildingTz - DateTZ object of time in bulding timezone\n     * @returns number - timestamp in local time skewed from bulding time\n     */\n    public convertTimezonedValueForCalendar(buildingTz: DateTZ) {\n        return convertTimezonedTimestampToLocalDateTz(buildingTz.ms, this.timezone).ms;\n    }\n\n    public hasConflict(startTz, endTz, booked) {\n        // Convert the start and end building times to the local timezone for comparison with the localized bookings.\n        const localizedStartTime = startTz.ms;\n        const localizedEndTime = endTz.ms;\n        let email = this.space?.email || this.currentBooking?.room?.email;\n        return booked.some((b) => {\n            email = email || b.booking?.room?.email;\n            // Booking here are local time to render on the calendar correctly\n            const setup = b.booking?.setup[email] || 0;\n            // R---  This weird augmented booking with start and end needs to be with DateTZ and a getter when ms is needed.\n            const bookingStartTime = new DateTZ({ date: b.start.valueOf() }); // local times\n            const bookingEndTime = new DateTZ({ date: b.end.valueOf() }); // local times\n            const bstart = bookingStartTime.subtractValue({ seconds: setup }).ms;\n            const breakdown = b.booking?.breakdown[email] || 0;\n            const bend = bookingEndTime.addValue({ seconds: breakdown }).ms;\n\n            if (\n                (localizedStartTime >= bstart && localizedStartTime < bend) || // booking starts durring a meeting\n                (localizedStartTime <= bstart && localizedEndTime > bstart) || // booking ends durring meeting\n                (localizedStartTime >= bstart && localizedEndTime <= bend) || // booking starts and ends durring a meeting\n                (localizedStartTime <= bstart && localizedEndTime >= bend) // booking overlaps entire meeting\n            ) {\n                return b.booking?.id !== this.currentBooking?.id;\n            }\n            return false;\n        });\n    }\n\n    public eventTimesChanged({ event, newStart, newEnd }: CalendarEventTimesChangedEvent): void {\n        const s = convertLocalTimestampToTimezonedDateTz(\n            newStart.valueOf(),\n            this.timezone\n        );\n        if (s.ms < Date.now()) return;\n        // newStart and newEnd are local times from the calendar component\n        // merging in with localized bookings in this.events\n        this.events = this.events.map((iEvent) => {\n            if (event.id && iEvent.id === event.id) {\n                return {\n                    ...event,\n                    start: newStart,\n                    end: newEnd,\n                };\n            }\n            return iEvent;\n        }); // local times\n\n        let buildingStartDateTz = new DateTZ(\n            { date: newStart.valueOf()}\n        );\n        let buildingEndDateTz = new DateTZ(\n            { date: Math.ceil(newEnd.valueOf()/900000)*900000 } //For latest bug in CNG-309, make sure end time follows a 15-min interval\n        );\n\n        // Clear out the seconds and miliseconds to avoid collision by seconds.\n        buildingStartDateTz.setValue({ millisecond: 0, second: 0 });\n\n        if (buildingStartDateTz < DateNow(new Date())) {\n            // compare building time to now\n            // Abandon updates if the past\n            this.transformBookings();\n            return;\n        }\n\n        let pendingDuration = Math.floor(\n            (buildingEndDateTz.ms - buildingStartDateTz.ms) / 60 / 1000\n        );\n        // Make adjustments to the time and duration so the snap to behavior aligns\n        // with the Mckinsey time and duration rules.\n        const new_start = buildingStartDateTz.clone(); //new DateTZ({date: buildingNewStart.getTime()});  // building time\n        if (pendingDuration >= 60) {\n            // check that duration is inc of 1/2 hr\n            const d = pendingDuration % 30;\n            // if (d) {\n                // pendingDuration = Math.floor(pendingDuration + (30 - d));\n                // buildingEndDateTz = new_start.addValue({ minutes: pendingDuration }); // building time\n            // }\n            // check that the start time is 1/2 hr\n            const m = parseInt(new_start.formatDate('m'), 10);\n            const md = m % 30;\n            // if (md) {\n                // buildingStartDateTz = new_start.addValue({ minutes: md }); // building time\n                // buildingEndDateTz = new_start.addValue({ minutes: pendingDuration }); // building time\n            // }\n            // Update snap to rules\n            // this.eventSnapSize = 30; //done for CNG-309\n        } else {\n            // check that duration is inc of 1/4 hr\n            const d = pendingDuration % 15;\n            if (d) {\n                // pendingDuration = Math.floor(pendingDuration + (15 - d));\n                // buildingEndDateTz = new_start.addValue({ minutes: pendingDuration }); // building time\n            }\n            this.eventSnapSize = 15;\n        }\n\n        // Drag and Drop / Resize duration\n        const dnd_duration = buildingEndDateTz.ms - buildingStartDateTz.ms;\n        if (dnd_duration >= this.one_day_in_millis - 1) {\n            // Add that millisecond back in so the angular calender drag and drop snapping still works.\n            buildingEndDateTz = buildingEndDateTz.addValue({ milliseconds: 1 });\n        }\n\n        if (this.rules?.max_length) {\n            if (dnd_duration / 60000 > this.rules?.max_length) {\n                // Abandon updates if exceeeds max duration\n                this.transformBookings();\n                return;\n            }\n        }\n\n        // Setup values for conflict checking, add on the setup and breakdown times form comparison\n        let conflictCheckStartTime = buildingStartDateTz.clone();\n        let conflictCheckEndTime = buildingEndDateTz.clone();\n        // Setup and Breakdown\n        if (this.currentBooking) {\n            const setup = this.currentBooking.setup[this.currentBooking.space.email] || 0;\n            if (setup) {\n                const start = buildingStartDateTz.clone();\n                conflictCheckStartTime = start.subtractValue({ seconds: setup });\n            }\n            const breakdown = this.currentBooking.breakdown[this.currentBooking.space.email] || 0;\n            if (breakdown) {\n                const end = buildingEndDateTz.subtractValue({ seconds: 1 });\n                conflictCheckEndTime = end.addValue({ minutes: breakdown });\n            }\n        }\n\n        // check existing events\n        const start = conflictCheckStartTime;\n        const end = conflictCheckEndTime;\n        const booked = this.events.filter((e) => e.draggable === false); // this.events are in local time\n        const conflict = this.hasConflict(start, end, booked);\n        this.dateControl.setValue(start);\n        if (conflict) {\n            // Abandon updates if conflict\n            this.transformBookings();\n            return;\n        }\n\n        // check if the time or duration has changed\n        if (this.pendingDateTz !== buildingStartDateTz) {\n            this.pendingChange = true;\n        } else if (this.pendingDuration !== pendingDuration) {\n            this.pendingChange = true;\n        }\n\n        // set the new Pending Date\n        this.pendingDateTz = convertLocalTimestampToTimezonedDateTz(buildingStartDateTz.ms, this.timezone); // building time\n        this.pendingDuration = pendingDuration;\n\n        this.setupEventName();\n        this.transformBookings();\n    }\n\n    public hourClicked(event: CalendarClickEvent) {\n        // convert the calender local input to the building times\n        const buildingStartDate = convertLocalTimestampToTimezonedDateTz(\n            event.date.valueOf(),\n            this.timezone\n        ); // return building time\n        let startTz = buildingStartDate.clone();\n        let endTz = startTz.addValue({ minutes: this.pendingDuration });\n\n        if (buildingStartDate.ms < Date.now()) {\n            // compare building time to now\n            // Abandon past events\n            return;\n        }\n\n        // this.pendingDate is in building time\n        if (this.pendingDateTz.ms !== startTz.ms) {\n            // comparing building to building\n            // Setup and Breakdown\n            if (this.currentBooking) {\n                const setup = this.currentBooking.setup[this.currentBooking.space.email] || 0;\n                if (setup) {\n                    startTz = startTz.subtractValue({ seconds: setup });\n                }\n                const breakdown =\n                    this.currentBooking.breakdown[this.currentBooking.space.email] || 0;\n                if (breakdown) {\n                    endTz = endTz.addValue({ minutes: breakdown });\n                }\n            }\n\n            // check existing events\n            const booked = this.events.filter((e) => e.draggable === false);\n            // building start and end time but localized bookings\n            const conflict = this.hasConflict(startTz, endTz, booked);\n            if (conflict) {\n                // Abandon updates if conflict\n                this.transformBookings();\n                return;\n            }\n\n            this.pendingChange = true;\n            this.pendingDateTz = buildingStartDate; // building time\n\n            this.setupEventName();\n            this.transformBookings();\n        }\n    }\n\n    public displayConfirmationModal() {\n        this.modal_data = {\n            pendingDateTz: this.pendingDateTz, // building time , new time\n            pendingDuration: this.pendingDuration,\n            dateTz: this.dateTz, // building time, existing time\n            duration: this.duration,\n            space: new Space(this.space),\n            rules: this.rules,\n            bookingId: this.bookingId,\n            currentBooking: this.currentBooking,\n        };\n\n        const dialogRef = this.dialog.open(RoomAvailabilityPreviewModalComponent, {\n            data: this.modal_data,\n            panelClass: 'mck-modal',\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n\n        dialogRef.componentInstance.submitForm.subscribe((d: any) => {\n            // Apply the confirmed changes\n            this.pendingChange = true;\n            this.pendingDateTz = d.dateTz;\n            this.pendingDuration = d.duration;\n\n            dialogRef.componentInstance.applyChanges({\n                dateTz: d.dateTz,\n                duration: this.pendingDuration,\n                pendingDateTz: this.pendingDateTz,\n                pendingDuration: this.pendingDuration,\n            });\n            this.setupEventName();\n            this.transformBookings();\n            // Change View\n            this.setCalendarValue(d.dateTz);\n        });\n\n        dialogRef.afterClosed().subscribe((d) => {\n            // Update the current with pending record\n            if (d) {\n                // convert the local input values returned into the same time in the building timezone\n                const buildingDate = convertLocalTimestampToTimezonedDateTz(\n                    d.dateTz.ms,\n                    this.timezone\n                );\n                this.dateTz = buildingDate;\n                this.duration = d.duration;\n                this.viewDateTz = new DateTZ({ \n                    date: DateTime.fromISO(buildingDate.formatDate('yyyy-MM-dd'))\n                }).setValue({ hour: 12, minute: 0 })\n                this.pendingChange = false;\n                this.confirmChanges.emit({ ...d, mobile: this.mobile, save: true });\n            } else {\n                // this is ok\n                const md = this.modal_data;\n                this.dateTz = md.dateTz;\n                this.duration = md.duration;\n                this.pendingDateTz = md.dateTz;\n                this.pendingDuration = md.duration;\n                this.viewDateTz = new DateTZ({ \n                    date: DateTime.fromISO(md.dateTz.formatDate('yyyy-MM-dd'))\n                }).setValue({ hour: 12, minute: 0 })\n                this.pendingChange = false;\n                // This is reverting the changes\n                this.confirmChanges.emit({\n                    dateTz: md.dateTz,\n                    duration: this.duration,\n                    mobile: this.mobile,\n                    save: !!d,\n                });\n                this.setupEventName();\n                this.transformBookings();\n                this.weekRefresh.next();\n                this.alternativeWeekStartDateTz = this.viewDateTz;\n                this.setDislayValues();\n            }\n        });\n    }\n\n    public goToHelp() {\n        window.open(Urls.Help);\n    }\n\n    public scrollTo() {\n        if (this.scrollFired) return;\n        this.timeout(\n            'scroll_to',\n            () => {\n                const ele = document.getElementById('calendarScrollContainer');\n                if (ele) {\n                    ele.scrollTo({\n                        top: this.dayStartHour * 64,\n                        left: 0,\n                        behavior: 'smooth',\n                    });\n                    this.scrollFired = true;\n                }\n            },\n            500\n        );\n    }\n\n    public toggleDatePicker() {\n        this.showDatePicker = !this.showDatePicker;\n    }\n\n    public collapse() {\n        this.handleExpand.emit(false);\n        // Reset to the initial view\n        this.pendingDateTz = this.dateTz; // = new Date(this.date);\n        this.pendingDuration = this.duration;\n        this.viewDateTz = new DateTZ({ \n            date: DateTime.fromISO(this.dateTz.formatDate('yyyy-MM-dd'))\n        }).setValue({ hour: 12, minute: 0 })\n        this.pendingChange = false;\n        this.setupEventName();\n        this.transformBookings();\n        this.dayRefresh.next();\n    }\n\n    public calendarBack() {\n        let today = this.alternativeWeekStartDateTz; // new DateTZ({date: this.alternativeWeekStartDate});\n        if (this.mobile) {\n            today = today.subtractValue({ days: 1 });\n        } else {\n            today = today.subtractValue({ weeks: 1 }).startOfValue('day');\n        }\n        this.updateCalendarWeekView.emit(today);\n        this.weekRefresh.next();\n        this.alternativeWeekStartDateTz = today;\n        this.setDislayValues();\n    }\n\n    public calendarSpan() {\n        let today = this.pendingDateTz; // new DateTZ({date: this.pendingDate.valueOf()});\n        if (this.mobile || !this.expanded) {\n            this.date_span.start = today.startOfValue('day').ms;\n            this.date_span.end = today.endOfValue('day').ms;\n        } else {\n            this.date_span.start = today.startOfValue('week').ms;\n            this.date_span.end = today.endOfValue('week').ms;\n        }\n    }\n\n    public calendarCenter() {\n        let today = this.pendingDateTz.startOfValue('day');\n        if (!this.mobile) {\n            today = today.startOfValue('week');\n        }\n\n        this.updateCalendarWeekView.emit(today);\n        this.weekRefresh.next();\n        this.alternativeWeekStartDateTz = today;\n        this.setDislayValues();\n    }\n\n    public calendarForward() {\n        let today = this.alternativeWeekStartDateTz // new DateTZ({date: this.alternativeWeekStartDate});\n        if (this.mobile) {\n            today = today.addValue({ days: 1 });\n        } else {\n            today = today.addValue({ weeks: 1 }).startOfValue('day');\n        }\n        this.updateCalendarWeekView.emit(today);\n        this.weekRefresh.next();\n        this.alternativeWeekStartDateTz = today;\n        this.setDislayValues();\n    }\n\n    public toggleWeekend() {\n        this.showWeekend = !this.showWeekend;\n        this.setupEventName();\n    }\n}\n","<div class=\"room-availability mck-row\">\n    <header class=\"header\">\n        <a-topbar-header\n            *ngIf=\"expanded\"\n            [mode]=\"mode\"\n            [backModal]=\"true\"\n            [noSurvey]=\"true\"\n            (closeCallback)=\"collapse()\">\n        </a-topbar-header>\n    </header>\n    <div class=\"room-availability scroll-container\" [class.expanded]=\"expanded\">\n        <mwl-calendar-day-view\n            *ngIf=\"!expanded\"\n            [class.np]=\"!expanded\"\n            [viewDate]=\"viewDateTz.ms\"\n            [events]=\"events\"\n            [refresh]=\"dayRefresh\"\n            (eventTimesChanged)=\"eventTimesChanged($event)\"\n            [dayStartHour]=\"dayStartHour\"\n            [dayEndHour]=\"dayEndHour\">\n        </mwl-calendar-day-view>\n        <div *ngIf=\"expanded\" class=\"mck-center\" [class.has-conflict]=\"addMarginOnConflict\">\n            <div class=\"mck-column\">\n                <div class=\"intro\">\n                    <h1>Room Availability</h1>\n                    <p>{{space.local_name}}</p>\n                    <p>{{building?.name}}, {{level?.name}}, {{building?.address}}</p>\n                </div>\n                <div class=\"cal-controls\">\n                    <div>\n                        <div class=\"dir\">\n                            <input type=\"image\" src=\"assets/icon/chevron-left.svg\" (click)=\"calendarBack()\" />\n                            <button (click)=\"calendarCenter()\">\n                                Current Selection\n                            </button>\n                            <input type=\"image\" src=\"assets/icon/chevron-right.svg\" (click)=\"calendarForward()\" />\n                        </div>\n                        <div class=\"date\" [class.right]=\"mobile\">\n                            <span>{{weekViewRangeText}}</span>\n                            <date-tz-date-picker\n                                [formControl]=\"dateControl\"\n                                class=\"time-inputs-calendar\"\n                                [icon_only]=\"true\"\n                                [fromDateTz]=\"fromDateTz\"\n                                [timezone]=\"timezone\"\n                                [initialDateSelectionTz]=\"viewDateTz\"\n                                (onSelect)=\"setCalendarValue($event); this.toggleDatePicker();\"\n                                >\n                            </date-tz-date-picker>\n                        </div>\n                        <mat-slide-toggle name=\"overflow\" class=\"weekends mck-toggle\" [class.mobile]=\"mobile\"\n                            labelPosition=\"after\" title=\"Show weekends on the calendar\"\n                            [checked]=\"showWeekend\" (change)=\"toggleWeekend()\">\n                            Show Weekend\n                        </mat-slide-toggle>\n                    </div>\n                </div>\n                <div class=\"mck-scroll\" id=\"calendarScrollContainer\" [class.has-conflict]=\"addMarginOnConflict\">\n                    <mwl-calendar-week-view\n                        [viewDate]=\"weekViewDateTz.ms\"\n                        [events]=\"events\"\n                        [refresh]=\"weekRefresh\"\n                        (eventTimesChanged)=\"eventTimesChanged($event)\"\n                        (hourSegmentClicked)=\"hourClicked($event)\"\n                        [daysInWeek]=\"mobile ? 1 : showWeekend ? 7 : 5\"\n                        precision=\"minutes\"\n                        snapDraggedEvents=false\n                        [eventSnapSize]=\"eventSnapSize\"\n                        [headerTemplate]=\"headerTemplate\"\n                        [eventTemplate]=\"eventTemplate\"\n                    ></mwl-calendar-week-view>\n\n                    <ng-template #headerTemplate\n                        let-days=\"days\"\n                        let-locale=\"locale\"\n                        let-dayHeaderClicked=\"dayHeaderClicked\"\n                        let-eventDropped=\"eventDropped\">\n                        <div class=\"cal-day-headers\">\n                        <div\n                            class=\"cal-header\"\n                            *ngFor=\"let day of days; trackBy:trackByWeekDayHeaderDate\"\n                            [class.cal-past]=\"day.isPast\"\n                            [class.cal-event-date]=\"isEventDate(day)\"\n                            [class.cal-future]=\"day.isFuture\"\n                            [class.cal-weekend]=\"day.isWeekend\"\n                            [class.show-weekend]=\"showWeekend\"\n                            [ngClass]=\"day.cssClass\"\n                            (mwlClick)=\"dayHeaderClicked.emit({day: day})\"\n                            mwlDroppable\n                            dragOverClass=\"cal-drag-over\"\n                            (drop)=\"eventDropped.emit({event: $event.dropData.event, newStart: day.date})\">\n                            {{ day.date | calendarDate:'weekViewColumnHeader':locale }} {{ day.date | calendarDate:'weekViewColumnSubHeader':locale }}\n                            <p>{{ isEventDate(day) ? '(Current Selection)' : '' }}</p>\n                        </div>\n                        </div>\n                    </ng-template>\n\n                    <ng-template\n                        #eventTemplate\n                        let-weekEvent=\"weekEvent\"\n                        let-tooltipPlacement=\"tooltipPlacement\"\n                        let-eventClicked=\"eventClicked\"\n                        let-tooltipTemplate=\"tooltipTemplate\"\n                        let-tooltipAppendToBody=\"tooltipAppendToBody\"\n                        let-tooltipDisabled=\"tooltipDisabled\"\n                        let-tooltipDelay=\"tooltipDelay\"\n                        let-column=\"column\"\n                        let-daysInWeek=\"daysInWeek\"\n                    >\n                        <div\n                        class=\"cal-event\"\n                        [class.expanded]=\"expanded\"\n                        [ngStyle]=\"{\n                            backgroundColor: weekEvent.event.color?.secondary,\n                            borderColor: weekEvent.event.color?.primary\n                        }\"\n                        [mwlCalendarTooltip]=\"\n                            !tooltipDisabled\n                            ? (weekEvent.event.title\n                                | calendarEventTitle\n                                : (daysInWeek === 1 ? 'dayTooltip' : 'weekTooltip')\n                                : weekEvent.tempEvent || weekEvent.event)\n                            : ''\n                        \"\n                        [tooltipPlacement]=\"tooltipPlacement\"\n                        [tooltipEvent]=\"weekEvent.tempEvent || weekEvent.event\"\n                        [tooltipTemplate]=\"tooltipTemplate\"\n                        [tooltipAppendToBody]=\"tooltipAppendToBody\"\n                        [tooltipDelay]=\"tooltipDelay\"\n                        (mwlClick)=\"eventClicked.emit({ sourceEvent: $event })\"\n                        (mwlKeydownEnter)=\"eventClicked.emit({ sourceEvent: $event })\"\n                        tabindex=\"0\"\n                        role=\"application\"\n                        [attr.aria-label]=\"\n                            { event: weekEvent.tempEvent || weekEvent.event, locale: locale }\n                            | calendarA11y: 'eventDescription'\n                        \"\n                        >\n                        <div class=\"bumper\" [style]=\"weekEvent.event?.bumper?.top\"></div>\n                        <div class=\"bumper\" [style]=\"weekEvent.event?.bumper?.bottom\"></div>\n                        <div class=\"berry top\"></div>\n                        <div class=\"berry bot\"></div>\n                        <mwl-calendar-event-actions\n                            [event]=\"weekEvent.tempEvent || weekEvent.event\"\n                            [customTemplate]=\"eventActionsTemplate\"\n                        >\n                        </mwl-calendar-event-actions>\n                        &ngsp;\n                        <mwl-calendar-event-title\n                            [event]=\"weekEvent.tempEvent || weekEvent.event\"\n                            [customTemplate]=\"eventTitleTemplate\"\n                            [view]=\"daysInWeek === 1 ? 'day' : 'week'\"\n                        >\n                        </mwl-calendar-event-title>\n                        </div>\n                    </ng-template>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"footer mck-column mck-center\" *ngIf=\"expanded\">\n            <div>\n                <button mat-button color=\"secondary\" class=\"mck-secondary-button\" (click)=\"collapse()\">{{pendingChange ? 'Cancel' : 'Close'}}</button>\n                <button mat-button color=\"primary\" class=\"mck-primary-button\" (click)=\"displayConfirmationModal()\"\n                    [disabled]=\"!pendingChange\">Confirm</button>\n            </div>\n        </div>\n    </div>\n</div>\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    OnInit,\n    OnChanges,\n    Output,\n    ViewContainerRef,\n    ViewChild\n} from '@angular/core';\nimport {\n    AbstractControl,\n    FormControl,\n    FormGroup,\n    FormGroupDirective,\n    Validators\n} from '@angular/forms';\nimport {\n    BehaviorSubject,\n    Observable,\n    of,\n    Subject\n} from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    distinctUntilChanged,\n    first,\n    map,\n    switchMap,\n    take,\n    withLatestFrom,\n} from 'rxjs/operators';\nimport {\n    Store\n} from '@ngrx/store';\nimport {\n    checkCollisions,\n    Booking,\n    User,\n    UsersService,\n    BookingFormData,\n    selectActiveForm,\n    SpacesService,\n} from '@mckinsey-converge/data-common';\nimport {\n    matchToHighlight\n} from '@mckinsey-converge/base';\n\nimport {\n    BaseTemplateComponent,\n    SelectOption\n} from '@mckinsey-converge/ui';\nimport { selectCurrentUser } from '@mckinsey-converge/user';\nimport { MatSnackBar } from '@angular/material/snack-bar';\n\n@Component({\n    selector: 'app-room-booking-details-form',\n    templateUrl: './room-booking-details-form.component.html',\n    styleUrls: ['./room-booking-details-form.component.scss']\n})\nexport class RoomBookingDetailsFormComponent extends BaseTemplateComponent implements OnInit, OnChanges {\n    @ViewChild('formRef')\n    public formRef: FormGroupDirective;\n    /** Number of characters needed before a search will start */\n    @Input() public limit = 3;\n    /** When the value changes, the form is submitted */\n    @Input() public triggerSubmit = '';\n    /** Need booking details */\n    @Input() public booking: Booking = null;\n    /** Data returned to parent */\n    @Output() public submitForm = new EventEmitter<BookingFormData>();\n    /** Data returned to parent */\n    @Output() public validateForm = new EventEmitter<boolean>();\n    /** Current User */\n    public currentUser: User;\n    /** Host list to display */\n    public host_list: User[];\n    /** User list to display from the Attendees search */\n    public user_list: User[];\n    /** Whether user list is loading */\n    public loading: boolean;\n    /** Whether to show the attendees hint */\n    public showHint = false;\n    /** Attendee Input / Search String  */\n    public searchString: string;\n    /** List of users from an API search */\n    public searchResults: Observable<User[]>;\n    /** Subject holding the value of the search */\n    public searchSubject = new Subject<string>();\n    /** Host field options */\n    public hostOptions = [];\n    /** Attendees options */\n    public options = new BehaviorSubject<SelectOption<any>[]>([]);\n    /** Selected Attendees */\n    public selectedOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n    public selectedUsers = new BehaviorSubject<SelectOption<any>[]>([]);\n    public needs_charge_code = false;\n    public has_delegate = false;\n    public available: boolean = null;\n    public notesHandle = null;\n    public noteValidationClass = '';\n    public selectedCompanies = new BehaviorSubject<SelectOption<any>[]>([]);\n    public companyOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    /** Data collected on this form */\n    public bookingFormGroup = new FormGroup({\n        organiser: new FormControl(),\n        title: new FormControl('', [ Validators.minLength(1)]), //Validators.pattern(\"[^=`~!@#$%*{};:'\\\",_.<>]*\")\n        attendees: new FormControl(),\n        code: new FormControl('', [Validators.minLength(4), Validators.pattern(/^[a-zA-Z0-9]*$/)]),\n        notes: new FormControl(),\n        head_count: new FormControl(1, [Validators.required, Validators.min(1)]),\n        user_list: new FormControl(),\n        host_list: new FormControl(),\n        company: new FormControl(),\n        opt_out: new FormControl()\n    });\n    action: string;\n\n    public get invalid_charge_error(): string {\n        if (this.bookingFormGroup.controls.code.errors?.required) {\n            return 'Charge Code is required';\n        }\n        if (this.bookingFormGroup.controls.code.errors?.minlength) {\n            return 'Charge Code must be at least four characters';\n        }\n        if (this.bookingFormGroup.controls.code.errors?.pattern) {\n            return 'Charge Code cannot contain spaces or special characters';\n        }\n        return '';\n    }\n\n    public get headCountControl(): AbstractControl {\n        return this.bookingFormGroup.get('head_count');\n    }\n\n    constructor(\n        private _spaces: SpacesService,\n        private _snackBar: MatSnackBar,\n        private store: Store,\n        vcRef: ViewContainerRef,\n        private _users: UsersService) {\n        super(vcRef);\n    }\n\n    public ngOnInit(): void {\n        super.ngOnInit();\n        this.subscription('currentUser', this.store.select(selectCurrentUser)\n            .pipe(take(1))\n            .subscribe((user: User) => {\n                // Once we know we have the user loaded.\n                this.currentUser = new User(user);\n            })\n        );\n\n        this._users.initialised.pipe(first((_) => _)).subscribe(() => {\n            const user: User = this._users.current;\n            const delegates = user.delegates.map((del) => {\n                // the kludgy or new User is for when the user service isn't ready.\n                const ifUser = this._users.find(del.email);\n                return ifUser ? \n                    new User({ email: ifUser.email, name: ifUser.name, opt_out: del.opt_out }) : \n                    new User({ email: del.email, name: del.email.split('@')[0].split('_').map((s) => s.charAt(0).toUpperCase() + s.substring(1))\n                    .join(' ')\n                    , opt_out: del.opt_out });\n\n                // (del) => new User({ email: del.email, name: del.email.split('@')[0].split('_').join(' '), opt_out: del.opt_out })\n                });\n            if (delegates.length) {\n                this.has_delegate = true;\n            }\n            this.host_list = [user].concat(delegates);\n            this.hostOptions = this.host_list.map(h => ({ display: h.name, value: h.email, meta: { user: h } }));\n        });\n\n        // if we have an active form, refill the information here once.\n        this.subscription('reduxData', this.store.select(selectActiveForm)\n            .pipe(take(1))\n            .subscribe((next: BookingFormData | undefined) => {\n                if (next) {\n                    // Get the Equipment charge code mandatory requirement\n                    const { filters, settings } = next.selectedRoom?.space;\n                    const roomBasedEqCode = filters?.equipment_code || settings?.equipment_code;\n                    const officeBasedEqCode = next.selectedRoom?.building?.required?.equipment_code;\n                    this.needs_charge_code = roomBasedEqCode !== undefined ? roomBasedEqCode : officeBasedEqCode !== undefined ? officeBasedEqCode: false;\n                    \n\n                    if (this.needs_charge_code) {\n                        this.bookingFormGroup.controls.code.setValidators([Validators.required, Validators.minLength(4), Validators.pattern(/^[a-zA-Z0-9]*$/)]);\n                    }\n                    // build the initial options\n                    const options = [];\n                    const attendees = next?.attendees || [];\n                    const organiser = next?.organiser || { display: this.currentUser.name , value: this.currentUser.email, meta: { external: false, user: this.currentUser }};\n                    const company = next?.company || [];\n\n                    const opt_out = next?.opt_out || false;\n                    this.action = next.action || 'new';\n                    // Load the saved form\n                    this.bookingFormGroup.setValue({\n                        organiser,\n                        title: next.title || '',\n                        attendees, // options will display current user\n                        code: next.code || '',\n                        notes: next.notes || '',\n                        head_count: next.head_count || '',\n                        user_list: [],\n                        host_list: [],\n                        company,\n                        opt_out: opt_out\n                    });\n                    this.selectedOptions.next(attendees);\n                    this.options.next(attendees);\n                    this.selectedCompanies.next(company);\n                    this.companyOptions.next(company);\n                }\n            })\n        );\n\n        // Listen for input changes\n        this.searchResults = this.searchSubject.pipe(\n            debounceTime(500),\n            distinctUntilChanged(),\n            switchMap((query) => {\n                this.loading = true;\n                return query.length >= this.limit\n                    ? this._users.query({\n                        q: query,\n                        cache: 60 * 1000\n                    })\n                    : Promise.resolve([]);\n            }),\n            catchError((_) => of([])),\n            map((list: User[]) => {\n                this.loading = false;\n                return list;\n            })\n        );\n\n        // Process API results\n        this.subscription(\n            'search_results',\n            this.searchResults.subscribe((list) => {\n                this.user_list = list;\n                this.user_list.forEach((i: any) => {\n                    i.match_name = matchToHighlight(i.match_name);\n                    i.match_email = matchToHighlight(i.match_email);\n                    return i;\n                });\n\n                // Build options from returned users\n                const options = this.user_list.map(u => {\n                    return {\n                        value: u.email,\n                        display: `${u.name} ${u.email}`,\n                        groupId: 'one',\n                        groupHeader: true,\n                        shortDisplay: `${u.name}`,\n                        meta: { external: false, user: u },\n                    };\n                });\n                // Add the manual option to the beginning of the array\n                options.unshift({\n                    value: this.searchString,\n                    display: this.searchString,\n                    groupId: 'one',\n                    groupHeader: true,\n                    shortDisplay: this.searchString,\n                    meta: { external: true, user: null },\n                });\n                // this.loading = false;\n                this.options.next(options);\n            })\n        );\n\n        this.bookingFormGroup.valueChanges.subscribe(val => {\n\n            clearTimeout(this.notesHandle);\n            if (val?.notes?.length) {\n                // Check for conflicts if adding a note and default setup and breakdown times.\n                this.notesHandle = setTimeout(() => {\n                    const booking = this.booking.clone();\n                    const setup = {};\n                    setup[booking.space.email] = booking.setup[booking.space.email] || 900;\n                    const breakdown = {};\n                    breakdown[booking.space.email] = booking.breakdown[booking.space.email] || 900;\n\n                    const mockBooking = new Booking({\n                        id: booking.id,\n                        room: booking.space,\n                        start_epoch: booking.startDateTz.seconds,\n                        end_epoch: booking.endDateTz.seconds,\n                        setup,\n                        breakdown,\n                    });\n\n                    checkCollisions(\n                        this._spaces,\n                        mockBooking\n                    ).then((bookable: boolean) => {\n                        this.available = bookable;\n                        this.noteValidationClass = bookable === false ? 'booked' : 'available';\n                    }).catch(() => {\n                        this.available = false;\n                        this.validateForm.emit(false);\n                        this.noteValidationClass = 'booked';\n                        return;\n                    });\n                }, 500);\n            } else {\n                this.available = null;\n                this.noteValidationClass = '';\n            }\n\n           \n\n            // \n            \n            // Return the form validation\n            this.validateForm.emit(this.bookingFormGroup.valid);\n          });\n    }\n\n    public setOrganiserOptOut(opt_out) {\n        this.bookingFormGroup.controls.opt_out.setValue(opt_out);\n    }\n\n    public updateOrganiser(user) {\n        console.log(user);\n    }\n\n    /** Listen for changes */\n    public ngOnChanges(changes: any) {\n        if (changes.triggerSubmit && this.formRef) {\n            // Trigger the form submit and validation\n            this.formRef.onSubmit(undefined);\n        }\n    }\n\n     /**\n     * \n     * @param key : formcontrol name \n     * Function trim value being submitted with only spaces/beginning/end \n     */\n    public trim(key: string): void {\n        this.bookingFormGroup.get(key).setValue(this.bookingFormGroup.get(key).value.trim());\n    }\n\n    /** Toggle an attendee on/off */\n    public toggle(option: SelectOption<any>) {\n        const inputValue = option.value; \n        // Check for character limit\n        if (\n            // this.selectedOptions.value.some((option: SelectOption<any>) => option.value === inputValue) || \n            inputValue.length > 50) {\n            this._snackBar.open('Attendee name cannot exceed 50 characters', 'Close', { duration: 5000 });\n            return;\n        }\n    \n        \n        this.selectedOptions.pipe(\n            take(1),\n            withLatestFrom(this.options),\n            map(([selectedOptions, options]) => {\n                let opts = selectedOptions.slice();\n                const found = opts.some(v => option.value === v.value);\n                if (found) {\n                    opts = opts.filter(v => option.value !== v.value);\n                } else {\n                    const color = option.value.toLowerCase().includes('mckinsey.') ? 'internal' : 'external';\n                    opts.push({\n                        ...option,\n                        meta: {\n                            ...option.meta,\n                            color\n                        }\n                    });\n                }\n\n                return opts;\n            })\n        ).subscribe(next => {\n            if (!this.bookingFormGroup.controls.head_count.touched) {\n                this.bookingFormGroup.controls.head_count.setValue(next.length + 1);\n            }\n            this.selectedOptions.next(next);\n        });\n    }\n\n    public clearHeadcount() {\n        this.headCountControl.setValue(1);\n    }\n\n    /** Return the data to the listening parent */\n    public onSubmitForm() {\n        this.bookingFormGroup.markAllAsTouched();\n        // a bit of an issue that the form state isn't saved unless valid\n        if (this.bookingFormGroup.valid) {\n            const form_data = this.bookingFormGroup.value;\n            form_data.user_list = this.user_list;\n            form_data.host_list = this.host_list;\n            form_data.has_delegate = this.has_delegate;\n            this.submitForm.emit(form_data);\n        }\n    }\n\n    /** Take the input and feed it back to the parent to add to attendees array */\n    public updateAttendeeOptionsFromUserInput(v: string) {\n        const l = v.length;\n        const options = this.selectedOptions.value.slice();\n        if (!l) {\n            this.options.next([]);\n            return;\n        }\n        if (l > 2) {\n            // Triggers the API call to search for the user input\n            this.searchSubject.next(v);\n        }\n\n        options.unshift({\n            value: v,\n            display: v,\n            groupId: 'one',\n            groupHeader: true,\n            shortDisplay: v,\n            meta: { external: true },\n        });\n        this.searchString = v;\n        this.options.next(options);\n    }\n\n    public toggleAttendeesHint() {\n           this.showHint = !this.showHint;\n    }\n\n    public updateCompanyOptionsFromUserInput(v: string) {\n        if (!v.length) {\n            this.companyOptions.next([]);\n            return;\n        }\n        this.companyOptions.next([{\n            value: v,\n            display: v,\n            groupId: 'two',\n            groupHeader: true,\n            shortDisplay: v,\n        }]);\n    }\n\n    public toggleCompany(option: SelectOption<any>) {\n        this.selectedCompanies.pipe(\n            take(1),\n            withLatestFrom(this.companyOptions),\n            map(([selectedCompanies, options]) => {\n                let opts = selectedCompanies.slice();\n                const found = opts.some(v => option.value === v.value);\n                if (found) {\n                    opts = opts.filter(v => option.value !== v.value);\n                } else {\n                    opts.push(option);\n                }\n\n                return opts;\n            })\n        ).subscribe(next => {\n            this.selectedCompanies.next(next);\n        });\n    }\n}\n","<ng-template>\n    <form class=\"mck-column mck-form-input-container\"\n            (ngSubmit)=\"onSubmitForm()\"\n            id=\"booking_form\"\n            #bookingForm\n            #formRef=\"ngForm\"\n            [formGroup]=\"bookingFormGroup\"\n        >\n        <div class=\"mck-row-flow  flex-container\">\n            <div class=\"field mck-column mck-form-input full-width\">\n                <mck-label [required]=\"required\"\n                    for=\"title\"\n                    i18n=\"Meeting title label\"\n                >\n                    Meeting Title<span >*</span>\n                </mck-label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"title\"\n                        formControlName=\"title\"\n                        placeholder=\"\"\n                        i18n-placeholder\n                        [required]=\"true\"\n                        (blur)=\"trim('title')\" \n                    />\n                    <mat-error i18n=\"Meeting title error\">\n                        <div class=\"error-icon\"></div>\n                            <span>\n                                {{ ( bookingFormGroup?.get('title').errors && bookingFormGroup?.get('title').hasError('pattern')) ? 'Some special characters (^=`~!@#$%*{};:\\'_\\\",.\\<>) are not allowed' : 'Meeting Title is required'}}\n                            </span>\n                    </mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"field mck-column mck-form-input full-width\">\n                <mck-select\n                    formControlName=\"organiser\"\n                    class=\"level-selector\"\n                    label=\"Host\"\n                    [options]=\"hostOptions\"\n                    [required]=\"true\"\n                    [disabled]=\"disabled\"\n                >\n                </mck-select>\n            </div>\n        </div>\n        <div class=\"row-with-spacing flex-row\" >\n            <mat-checkbox\n            formControlName=\"opt_out\"\n            [ngModel]=\"(action === 'edit_booking' || action === 'edit' ) ? bookingFormGroup?.value?.opt_out : (bookingFormGroup?.value?.organiser?.meta?.user?.opt_out || bookingFormGroup?.value?.organiser?.opt_out)\"\n            [style.display]=\"'block'\"\n            trigger=\"hover\" \n            [tooltip]=\"['Optout selection will stop sending', ' email notification to the host']\" \n            position=\"right\"> Optout email notification </mat-checkbox>\n        </div>\n\n        <div class=\"row-with-spacing\">\n            <mck-autocomplete-chip-select-item\n                class=\"attendees-input\"\n                errorMessage=\"Attendees must be selected\"\n                label=\"Attendees\"\n                [required]=\"true\"\n                [selectOnlyOneGroup]=\"true\"\n                placeHolder=\"Type an e-mail or name\"\n                formControlName=\"attendees\"\n                [options]=\"options\"\n                [feedbackInput]=\"true\"\n                [localFilter]=\"false\"\n                (feedbackOutput)=\"updateAttendeeOptionsFromUserInput($event.trim())\"\n                [selectedOptions]=\"selectedOptions\"\n                (optionSelected)=\"toggle($event)\"\n                (chipsCleared)=\"clearHeadcount()\"\n                [loading]=\"loading\"\n                [hideDropdownCarret] = \"true\"\n                >\n            </mck-autocomplete-chip-select-item>\n            <mat-hint\n                i18n=\"Why do we need to assign attendees\"\n                (click)=\"toggleAttendeesHint()\"\n            >\n                <span>Why do we need this?</span>\n                <div *ngIf=\"showHint\" class=\"hint\">\n                    <div class=\"triangle\"></div>\n                    Attendee emails are used for visitor management purposes.\n                    Converge won't send any emails to attendees.\n                </div>\n            </mat-hint>\n        </div>\n\n        <div class=\"mck-row-flow row-with-spacing flex-row company-container\">\n            <div class=\"field mck-column mck-form-input company-field\">\n                <mck-autocomplete-chip-select-item\n                label=\"Company\"\n                [required]=\"false\"\n                [selectOnlyOneGroup]=\"true\"\n                placeHolder=\"e.g PlaceOS\"\n                formControlName=\"company\"\n                [options]=\"companyOptions\"\n                [feedbackInput]=\"true\"\n                [localFilter]=\"false\"\n                (feedbackOutput)=\"updateCompanyOptionsFromUserInput($event.trim())\"\n                [selectedOptions]=\"selectedCompanies\"\n                (optionSelected)=\"toggleCompany($event)\"\n                [hideDropdownCarret] = \"true\"\n                >\n                </mck-autocomplete-chip-select-item>\n            </div>\n            <div class=\"field mck-column mck-form-input\">\n                <mat-label\n                    for=\"charge-code\"\n                    i18n=\"Catering details charge code label\"\n                >\n                    Charge Code<span >{{ needs_charge_code ? '*' : '' }}</span>\n                </mat-label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"charge-code\"\n                        formControlName=\"code\"\n                        placeholder=\"\"\n                        i18n-placeholder\n                    />\n                    <mat-error i18n=\"Catering details charge code error\">\n                        <div class=\"error-icon\"></div>\n                        <span>\n                            {{ invalid_charge_error }}\n                        </span>\n                    </mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"field mck-column mck-form-input\">\n                <mat-label\n                    for=\"headcount\"\n                    i18n=\"Headcount Estimate label\"\n                >\n                Headcount estimate<span >*</span>\n                </mat-label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"head-count\"\n                        formControlName=\"head_count\"\n                        placeholder=\"\"\n                        type=\"number\"\n                        i18n-placeholder\n                        numbersOnly\n                    />\n                    <mat-error i18n=\"Headcount error\">\n                        <div class=\"error-icon\"></div>\n                            <span>\n                            Headcount is required\n                        </span>\n                    </mat-error>\n                </mat-form-field>\n            </div>\n        </div>\n\n        <div class=\"mck-row-flow row-with-spacing\">\n            <div class=\"field mck-column mck-form-input\">\n                <mat-label\n                    for=\"notes\"\n                    i18n=\"Additional requirements (e.g room setup, equipment...) label\"\n                >\n                    Additional requirements (e.g room setup, equipment...)<span ></span>\n                </mat-label>\n                <mat-form-field appearance=\"outline\" [class]=\"noteValidationClass\">\n                    <textarea\n                        matInput\n                        name=\"notes\"\n                        formControlName=\"notes\"\n                        i18n-placeholder\n                        (blur)=\"trim('notes')\" \n                    ></textarea>\n                </mat-form-field>\n                <mat-label>\n                    <p *ngIf=\"available === true\" class=\"available sb-status\">\n                        <img src=\"assets/icon/accept-icon.svg\">\n                        A set up and breakdown time of 15 mins was added to either side\n                        of your booking to cater for these additional requirements.\n                    </p>\n                    <p *ngIf=\"available === false\" class=\"sb-status\">\n                        <img src=\"assets/icon/warning-icon.svg\">\n                        A set up and break down time of 15mins was added to either side of your booking to cater for these additional requirements. This has resulted in a conflict with another booking. Please adjust your booking accordingly.\n                    </p>\n                </mat-label>\n            </div>\n        </div>\n    </form>\n</ng-template>\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    OnInit,\n    OnChanges,\n    Output,\n    ViewContainerRef,\n    ViewChild\n} from '@angular/core';\nimport {\n    FormControl,\n    FormGroup,\n    FormGroupDirective,\n    Validators\n} from '@angular/forms';\nimport { MatSnackBar } from '@angular/material/snack-bar';\n\nimport { closestToTimeSlot, closestToTimeSlotTz, resetSecondsOnTimestamp } from '@mckinsey-converge/base';\n\nimport {\n    distinctUntilChanged,\n    map,\n    skip,\n    take,\n    withLatestFrom\n} from 'rxjs/operators';\nimport {\n    select,\n    Store\n} from '@ngrx/store';\nimport {\n    buildingStateSelector,\n    selectBuildingOptionsGroupedByCity\n} from '@mckinsey-converge/buildings';\nimport {\n    Building,\n    BuildingCity,\n    flattenDisplayOffices,\n    toggleSelectedByGroup,\n    storeBookingFormData,\n    BookingFormData,\n    bookingTypeOptions,\n    DEFAULT_BOOKING_DURATION,\n    defaultRoomSizeOption,\n    internalBookingTypeOption,\n    roomSizeOptions,\n    selectActiveForm,\n    ApplicationService,\n    roomSizeOptionsKiosk,\n\t\tRecurrencePeriod,\n        generateBookingForm,\n        SeriesAction,\n        setRecurrenceStartsTime\n} from '@mckinsey-converge/data-common';\nimport { BehaviorSubject } from 'rxjs';\nimport {\n    BaseTemplateComponent,\n    SelectOption\n} from '@mckinsey-converge/ui';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { DateTime } from 'luxon';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Booking } from '../../../../../../libs/data-common/src';\nimport * as cloneDeep from 'lodash/cloneDeep';\n@Component({\n    selector: 'app-room-booking-form',\n    templateUrl: './room-booking-form.component.html',\n    styleUrls: ['./room-booking-form.component.scss']\n})\nexport class RoomBookingFormComponent extends BaseTemplateComponent implements OnInit, OnChanges {\n    @ViewChild('formRef')\n    formRef: FormGroupDirective;\n\n    @Output()\n    public submitForm = new EventEmitter<BookingFormData>();\n\n    @Input()\n    public showCancel = false;\n\n    @Input()\n    public triggerSubmit: number;\n\n    /**\n     * Used only if showCancel is true.\n     */\n    @Output()\n    public cancelSubmit = new EventEmitter();\n\n    // fromDate is the selected date\n    public fromDate: number = closestToTimeSlot(DateTime.now(), 15).valueOf(); // R--- depreciate\n    /** DateTZ object of the date and time that the date and time picker will begin it's options from */\n    public fromDateTz: DateTZ = closestToTimeSlotTz(new DateTZ({ date: Date.now(), is_local_tz: false }), 15);\n    public bookingTypeOptions = bookingTypeOptions;\n    public roomSizeOptions = roomSizeOptions;\n    public localTimezone = DateNow(new Date()).building_tz;\n    public localStart = \"\";\n    public localEnd = \"\"\n\n    public formGroup: FormGroup = new FormGroup({\n        id: new FormControl('', []), // used in case of recurring series edit\n        location: new FormControl([], [Validators.required]),\n        date: new FormControl(this.fromDate, [Validators.required]),\n        dateTz: new FormControl(this.fromDateTz, [Validators.required]), // starts out as the next closest available time interval\n        duration: new FormControl(DEFAULT_BOOKING_DURATION, [Validators.required]),\n        bookingType: new FormControl(internalBookingTypeOption),\n        roomSize: new FormControl(defaultRoomSizeOption),\n        selectedRoom: new FormControl({}),\n        timezone: new FormControl(\"\"),\n        offset: new FormControl(\"\"),\n\n\t\trecurrence_period: new FormControl(RecurrencePeriod.WEEKLY),\n        recurrence_interval: new FormControl( 1),\n        recurrence_endTz: new FormControl( new DateTZ({ date: 1 }).addValue({days: 1})),\n        recurrence_count: new FormControl( 0),\n        is_recurrent: new FormControl(null),\n        recurrence_starts: new FormControl( []),\n        recurrence_exceptions: new FormControl([]),\n        recurrence_pattern: new FormControl(RecurrencePeriod.WEEKLY), //Helper value to store the last selected pattern (daily, weekly, monthly),\n        recurrence_days: new FormControl( []),\n\n        ignore: new FormControl('', []), // used in case of recurring series edit\n        // TODO, there's a few missing from interface BookingFormData, libs/data-common/src/lib/booking/booking.form.data.ts\n    });\n\n\n    public options = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public selectedOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    constructor(private store: Store,\n        // private _service: ApplicationService,\n        vcRef: ViewContainerRef, private _snackBar: MatSnackBar) {\n        super(vcRef);\n        // if(this._service?.kioskFormFilter) {\n        //     this.formGroup.setValue({\n        //         roomSize: roomSizeOptions[3]\n        //     })\n        // }\n    }\n\n    public ngOnInit(): void {\n\n\n        super.ngOnInit();\n        // R--- Complicated, need the TZ aware inputs and to not init those inputs until the building timezone is available.\n        // R--- See if there's any way to make the timezone retrieval less fragile.\n\n        // if we have an active form, refill the information here once.\n        // Doesn't run on initial steps, only if you go back to the home page\n        this.subscription('reduxData', this.store.select(selectActiveForm)\n            .pipe(take(1))\n            .subscribe((next: BookingFormData | undefined) => {\n                if (next) {\n                    // set the fromDate correctly\n                    this.fromDateTz = next.is_recurrent ? next.dateTz : closestToTimeSlotTz(DateNow(), 15); // R--- shouldn't this actually be the current date start of day to make all the options available?\n\n                    const form = cloneDeep(next);\n                    this.formGroup.patchValue({\n                        ...form,\n                    }, { emitEvent: true });\n\n                    // this.formGroup.markAllAsTouched();\n                    // this.formGroup.updateValueAndValidity();\n\n                }\n            })\n        );\n\n        // R--- I only see this fire when the modal opens or going to the home page\n        this.subscription('formChanges', this.formGroup.valueChanges\n            .pipe(\n                skip(1), // initial form changes\n                distinctUntilChanged())\n            .subscribe((next) => {\n                const timezone = next.timezone || this.localTimezone\n                /**\n                 * When the selected date changes update the time picker's start time\n                 * to the nearest available slot of the current day\n                 */\n                this.fromDateTz = next.is_recurrent ? next.dateTz : closestToTimeSlotTz(DateNow(), 15);\n\n                /**\n                 * When the new selected date arrives, update the coachmark displayed below the date time picker\n                 */\n                this.updateCoachmarkTimes(timezone);\n\n            })\n        );\n\n        this.subscription('buildings', this.store.pipe(\n            select(buildingStateSelector),\n            select(selectBuildingOptionsGroupedByCity),\n            map((grouped: Map<BuildingCity, Building[]>) => {\n                return flattenDisplayOffices(grouped);\n            }),\n            distinctUntilChanged()\n        )\n            .subscribe(next => {\n                this.options.next(next);\n            }));\n    }\n\n    public ngOnChanges(changes: any) {\n        if (changes.triggerSubmit && this.formRef) {\n            // Trigger the form submit and validation\n            this.formRef.onSubmit(undefined);\n        }\n    }\n\n    public onSubmitForm() {\n        if(this.formGroup.controls?.is_recurrent?.value){\n            setRecurrenceStartsTime(this.formGroup)\n        }\n        // Check for past date time\n        const formGroupData = this.formGroup.value;\n        const is_past = this._checkDateInPast();\n        if (is_past) {\n            this.openSnackBar('Start Time updated to after current time, please click search again.', 'Close');\n            return;\n        } else {\n            this.formGroup.setValue({\n                ...formGroupData,\n                date: resetSecondsOnTimestamp(formGroupData.dateTz.ms),\n                dateTz: formGroupData.dateTz.setValue({ millisecond: 0, second: 0 })\n            });\n        }\n        this.formGroup.markAllAsTouched();\n        if (this.formGroup.valid) {\n            this.submitForm.emit(this.formGroup.value);\n        }\n    }\n\n    public openSnackBar(message: string, action: string) {\n        this._snackBar.open(message, action, {\n            duration: 5000,\n            panelClass: ['yellow-snackbar']\n        });\n    }\n\n    // Fires when the location selector value is changed\n    public toggle(option: SelectOption<any>) {\n        // update the selected value\n        this.selectedOptions.pipe(\n            take(1),\n            withLatestFrom(this.options),\n            map(([selectedOptions, options]) => {\n                return toggleSelectedByGroup(options, selectedOptions, option);\n            })\n        ).subscribe(next => {\n            // deselecting the location option sets the timezone to local so convert.\n            const formGroupDate = this.formGroup.value;\n            if (!next.length) {\n                this.formGroup.setValue({\n                    ...this.formGroup.value,\n                    timezone: this.localTimezone,\n                    date: formGroupDate.dateTz.ms,\n                    dateTz: formGroupDate.dateTz.toZone(this.localTimezone)\n                });\n            } else {\n                const buildingTimezone = next[0]?.meta?.building?.timezone || next[0]?.meta?.city?.timezone;\n                this.formGroup.setValue({\n                    ...this.formGroup.value,\n                    timezone: buildingTimezone,\n                    date: formGroupDate.dateTz.ms,\n                    dateTz: formGroupDate.dateTz.toZone(buildingTimezone)\n                });\n            }\n            this._checkDateInPast();\n            // Must fire last or location picker will be buggy.\n            this.selectedOptions.next(next);\n        });\n    }\n\n    private _checkDateInPast() {\n        // Check for past date time\n        const formGroupData = this.formGroup.value;\n        const date = new DateTZ({ date: this.formGroup.value.dateTz.ms, building_tz: formGroupData.timezone, is_local_tz:false }).addValue({ seconds: 30 })\n        const now = DateNow(new Date())\n        if (now.isAfterDate(date)) {\n            // Reset the start time if in the past\n            const closestTz = closestToTimeSlotTz(new DateTZ({ date: Date.now(), is_local_tz: false, building_tz: formGroupData.timezone }).addValue({ minutes: 1 }), 15)\n            const prevClosestTz = closestTz.subtractValue({minutes: 15})\n            const prevDateTz = prevClosestTz.addValue({ seconds: 30 });\n            // R-- why do I do this on submit? move to a another method.\n            if(now.isAfterDate(prevDateTz)){\n                this.fromDateTz = closestTz;\n            }else{\n                this.fromDateTz = prevClosestTz;\n            }\n\n            this.formGroup.setValue({\n                ...formGroupData,\n                date: resetSecondsOnTimestamp(this.fromDateTz.ms),\n                dateTz: this.fromDateTz.setValue({ millisecond: 0, second: 0 })\n            });\n            return true;\n        }\n        return false;\n    }\n\n    private updateCoachmarkTimes(timezone: string) {\n        // Resolve the problem that locally I might have the same TZ offset but the names don't match.\n        const localTzOffset = DateTime.now().setZone(this.localTimezone).offset;\n        const buildingTzOffset = DateTime.now().setZone(timezone).offset;\n\n        this.fromDateTz = new DateTZ({ date: this.fromDateTz.ms, is_local_tz: false, building_tz: timezone });\n\n        if (localTzOffset !== buildingTzOffset) {\n            const startDate = this.formGroup.value.dateTz.clone();\n            this.localStart = startDate.formatLocalDate(\"h:mma\");\n            this.localEnd = startDate.addValue({ minutes: this.formGroup.value.duration }).formatLocalDate(\"h:mma\");\n        } else {\n            // No location is selected so coachmark is hidden\n            this.localStart = \"\";\n            this.localEnd = \"\";\n        }\n    }\n}\n","<ng-template>\n  <form class=\"mck-column mck-content-group mck-form-input-container booking-form-container\"\n    (ngSubmit)=\"onSubmitForm()\"\n    [formGroup]=\"formGroup\"\n    #formRef=\"ngForm\"\n  >\n    <mck-autocomplete-chip-select-item\n      errorMessage=\"Location and office must be selected\"\n      label=\"Location and office\"\n      [required]=\"true\"\n      [selectOnlyOneGroup]=\"true\"\n      placeHolder=\"Start typing to filter location or office...\"\n      formControlName=\"location\"\n      [options]=\"options\"\n      [selectedOptions]=\"selectedOptions\"\n      (optionSelected)=\"toggle($event)\"\n      [displayCTA]=\"true\"\n    ></mck-autocomplete-chip-select-item>\n\n\n    <div class=\"mck-row-flow\">\n      <date-tz-date-picker\n        label=\"Date\"\n        class=\"mck-form-input time-inputs-calendar\"\n        [fromDateTz]=\"fromDateTz\"\n        formControlName=\"dateTz\"\n        *ngIf=\"!formGroup.get('is_recurrent')?.value\"></date-tz-date-picker>\n\n      <mck-spacer\n        size=\"16px\" [mode]=\"'vertical'\" [autoSize]=\"true\"\n        spacerClass=\"mck-spacer-content-collapse-tablet\"  *ngIf=\"!formGroup.get('is_recurrent')?.value\" ></mck-spacer>\n      <date-tz-time-field\n        class=\"time-inputs\"\n        label=\"Start time\"\n        [required]=\"true\"\n        name=\"start-time\"\n        [fromDateTz]=\"fromDateTz\"\n        [ngModel]=\"formGroup.controls.dateTz.value\"\n        (ngModelChange)=\"formGroup.controls.dateTz.setValue($event)\"\n        [ngModelOptions]=\"{ standalone: true }\"\n      ></date-tz-time-field>\n      <mck-spacer size=\"16px\" [mode]=\"'vertical'\" [autoSize]=\"true\"></mck-spacer>\n      <date-tz-duration-field\n        class=\"time-inputs\"\n        label=\"End time\"\n        name=\"end-time\"\n        [startDateTz]=\"formGroup.controls.dateTz.value\"\n        [required]=\"true\"\n        [ngModel]=\"formGroup.controls.duration.value\"\n        [ngModelOptions]=\"{ standalone: true }\"\n        (ngModelChange)=\"formGroup.controls.duration.setValue($event)\"\n      ></date-tz-duration-field>\n      <div *ngIf=\"localStart && localEnd\" class=\"coachmark\">\n        Please be aware that this booking starts at {{localStart}} and ends at {{localEnd}} in your local timezone.\n      </div>\n    </div>\n\n    <div class=\"flex-column\">\n      <div class=\"recurrence-siwch flex-row\">\n        <mat-slide-toggle\n        class=\"mck-slide-toggle\"\n        labelPosition=\"after\"\n        name=\"recurrence\"\n        formControlName=\"is_recurrent\">Recurring booking</mat-slide-toggle>\n    </div>\n    <!-- this is recurring booking form that appears when the above recurrence toggle is enabled -->\n    <recurrence-booking-form *ngIf=\"formGroup.get('is_recurrent')?.value\" [form]=\"formGroup\"></recurrence-booking-form>\n\n    </div>\n\n    <mck-radio-select\n      label=\"Booking type\"\n      [required]=\"true\"\n      formControlName=\"bookingType\"\n      [options]=\"bookingTypeOptions\"\n    ></mck-radio-select>\n\n    <mck-radio-select\n      label=\"Select room size\"\n      [required]=\"true\"\n      formControlName=\"roomSize\"\n      [options]=\"roomSizeOptions\"\n    ></mck-radio-select>\n    <mck-spacer size=\"8px\"></mck-spacer>\n    <!-- Inline button-row may be injected into this ng-content tag. -->\n    <ng-content></ng-content>\n  </form>\n</ng-template>","import { Component, ViewEncapsulation, Inject } from '@angular/core';\nimport { BookingFormData, storeBookingFormData, SeriesAction} from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { Store } from '@ngrx/store';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\n// import { Router, ActivatedRoute } from '@angular/router';\n\n@Component({\n    selector: 'app-room-booking-modal',\n    template: `\n        <div class=\"room-booking-modal-container\">\n        <mck-modal header=\"Search for a Meeting Room\">\n            <app-room-booking-form\n                #roomBookingForm\n                [showCancel]=\"true\"\n                [triggerSubmit]=\"trigger\"\n                (submitForm)=\"submitForm($event)\"\n                (cancelSubmit)=\"close()\">\n            </app-room-booking-form>\n        </mck-modal>\n        <mat-dialog-actions class=\"booking-modal-actions\">\n            <mck-modal-button-row\n                primaryLabel=\"Search\"\n                (primarySubmit)=\"triggerSubmit()\"\n                [secondaryLabel]=\"roomBookingForm.showCancel ? 'Cancel' : ''\"\n                (secondarySubmit)=\"roomBookingForm.cancelSubmit.emit()\">\n            </mck-modal-button-row>\n        </mat-dialog-actions>\n        </div>\n    `,\n    styleUrls: ['./room-booking-modal.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class RoomBookingModalComponent extends BaseDirective {\n    public trigger = Date();\n\n    constructor(\n        private store: Store,\n        private dialogRef: MatDialogRef<RoomBookingModalComponent>,\n        @Inject(MAT_DIALOG_DATA) private _data: any )  {\n        super();\n    }\n\n    public triggerSubmit() {\n        this.trigger = Date();\n    }\n\n    public submitForm(next: BookingFormData) {\n        /// submit\n\n        const ignore = this._data?.action === SeriesAction.EDIT ? next.id : null;\n        const bookable = this._data?.action === SeriesAction.EDIT || null;\n\n        this.store.dispatch(storeBookingFormData({\n            payload: {\n                ...next,\n                ignore, // ignore id in case of recurring edit series\n                bookable, // true in case of recurring edit series\n                action: this._data?.action || '' // 'edit' in case of recurring edit series\n            }\n        }));\n        this.close('DoNotClearActiveForm'); // do not clear active form if for submit as form need forther in result module\n        this._data && this._data.navigateTo && this._data.navigateTo(); // navigate to result in case of staff recurring edit\n\n    }\n\n    public close(flag: string = '') {\n        this.dialogRef.close(flag);\n    }\n}\n","import {\n    Component,\n    OnInit,\n    OnDestroy\n} from '@angular/core';\nimport {\n    select,\n    Store\n} from '@ngrx/store';\nimport { BuildingStoreState } from '@mckinsey-converge/buildings';\nimport {\n    AlertMode,\n    SelectOption\n} from '@mckinsey-converge/ui';\nimport { loadOrganisations } from '@mckinsey-converge/organisation';\nimport { BaseDirective,\n    dateBuildingFormatString,\n} from '@mckinsey-converge/base';\nimport {\n    Booking,\n    User,\n    Building,\n    BuildingCity,\n    IEngineResponse,\n    flattenDisplayOffices,\n    selectCancelledBookingsResultsFromState,\n    selectHomepageBookingsResultsFromState,\n    selectPastBookingsResultsFromState,\n    BookingStoreState,\n    BookingFormData,\n    clearBookingFormData,\n    storeBookingFormData,\n    BookingsService\n} from '@mckinsey-converge/data-common';\nimport { TopBarHeaderMode } from 'src/app/components/topbar-header/topbar-header.component';\nimport { Urls } from 'src/app/utilities/urls';\nimport {\n    ActivatedRoute,\n    Router\n} from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { BookingDetailsModalComponent } from '../booking-details-modal/booking-details-modal.component';\nimport { loadRoomsForResults } from '@mckinsey-converge/rooms';\nimport { loadBookingsWithQuery, MyBookingsStoreState } from '@mckinsey-converge/bookings';\nimport { UserStoreState } from '@mckinsey-converge/user';\nimport {\n    BehaviorSubject,\n} from 'rxjs';\nimport {\n    distinctUntilChanged,\n    elementAt,\n    map,\n    take,\n} from 'rxjs/operators';\nimport { LoadingModel } from '@mckinsey-converge/loading';\nimport { selectCurrentUser } from '@mckinsey-converge/user';\nimport {\n    mapResultsToViewModels,\n    BookingResultsViewModel\n} from 'src/app/booking/manage-bookings/manage-bookings.viewmodel';\nimport {\n    buildingStateSelector,\n    selectBuildingOptionsGroupedByCity\n} from '@mckinsey-converge/buildings';\nimport { DateNow } from '@mckinsey-converge/date-tz';\n\nexport type RoomBookingStoreState = BookingStoreState & BuildingStoreState & MyBookingsStoreState & UserStoreState;\n\n@Component({\n    selector: 'app-room-booking',\n    template: `\n        <div class=\"mck-column mck-content-expand mck-content-page-container\">\n            <header class=\"header\">\n                <a-topbar-header\n                    [mode]=\"TopBarHeaderMode.Light\">\n                </a-topbar-header>\n            </header>\n            <div class=\"mck-column mck-stretch mck-overflow room-booking\">\n                <div class=\"mck-column mck-center\">\n                    <div class=\"mck-column heading-container mck-content-body\">\n                        <h1 class=\"heading\">Meeting Room Booking</h1>\n                        <div class=\"mck-row mck-center heading-icon-container\">\n                            <img alt=\"Booking Coachmark\" class=\"heading-icon\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"mck-column mck-center\">\n                    <div class=\"mck-column mck-center mck-content-body mck-shadow input-background\">\n                        <app-room-booking-form\n                            #roomBookingForm\n                            (submitForm)=\"routeToResults($event)\">\n                            <mck-modal-button-row\n                                class=\"search-button\"\n                                primaryLabel=\"Search\"\n                                [secondaryLabel]=\"roomBookingForm.showCancel ? 'Cancel' : ''\"\n                                (secondarySubmit)=\"roomBookingForm.cancelSubmit.emit()\"\n                                [disableFixed]=\"true\">\n                            </mck-modal-button-row>\n                        </app-room-booking-form>\n                    </div>\n                    <div class=\"mck-column mck-center mck-content-body mck-shadow your-bookings\">\n                        <div>\n                            <h2>Your Bookings</h2>\n                            <div *ngIf=\"showResults() else loading_message\">\n                                <div class=\"no\" *ngIf=\"!showBookings\">\n                                    <img src=\"assets/icon/upcoming.svg\">\n                                    <div>You have no upcoming bookings</div>\n                                </div>\n                                <div *ngIf=\"showBookings\">\n                                    <app-booking-result-item\n                                        *ngFor=\"let viewModel of upcomingBookings.slice(0,3); let i = index\"\n                                        [small]=\"true\"\n                                        [viewModel]=\"viewModel\"\n                                        [bookings]=\"upcomingBookings\"\n                                        [index]=\"i\"\n                                        (bookingSelect)=\"viewBooking(viewModel)\">\n                                    </app-booking-result-item>\n                                </div>\n                            </div>\n                            <ng-template #loading_message>\n                                <app-booking-result-item [small]=\"true\" *ngFor=\"let i of [0, 1, 2]\">\n                                </app-booking-result-item>\n                            </ng-template>\n                        </div>\n                        <div class=\"manage-button\">\n                           <button\n                            mat-button class=\"mck-primary-button mck-modal-primary-button\"\n                            [disabled]=\"!showManageButtonA && !showManageButtonB && !showManageButtonC\"\n                            (click)=\"routeToManageBookings()\"\n                            >\n                            Manage</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `,\n    styleUrls: ['./room-booking.component.scss']\n})\nexport class RoomBookingComponent extends BaseDirective implements OnInit, OnDestroy {\n    public TopBarHeaderMode = TopBarHeaderMode;\n    public AlertMode = AlertMode;\n\n    public width = 16;\n\n    // public showBanner = true;\n    public showBookings = false;\n    public showManageButtonA = false;\n    public showManageButtonB = false;\n    public showManageButtonC = false;\n    public dateString: string;\n\n    public homepageBookingResults = new BehaviorSubject<LoadingModel<IEngineResponse>>(LoadingModel.empty());\n    public pastBookingResults = new BehaviorSubject<LoadingModel<IEngineResponse>>(LoadingModel.empty());\n    public upcomingBookings: BookingResultsViewModel[];\n    public buildings = new BehaviorSubject<SelectOption<any>[]>([]);\n    public reloading = false;\n\n    /** Current User */\n    public currentUser: User;\n    master_booking: BookingResultsViewModel;\n    allBookings: any[];\n\n    constructor(private store: Store<RoomBookingStoreState>,\n                private router: Router,\n                private route: ActivatedRoute,\n                private _bookings: BookingsService,\n                private dialog: MatDialog) {\n        super();\n        this.dateString = dateBuildingFormatString(DateNow(new Date()));\n    }\n\n    public ngOnDestroy() {\n        if (typeof window === 'object') {\n            window.onbeforeunload = undefined;\n        }\n\t\t\t\t// clear interval\n\t\t\t\tthis.clearInterval('refreshBookings');\n    }\n\n    public ngOnInit(): void {\n        // only run on window onload\n        if (typeof window === 'object') {\n            window.onbeforeunload = (event) => {\n                const e = event || window.event;\n                this.store.dispatch(clearBookingFormData())\n                return e;\n              };\n        }\n\n        this.store.dispatch(loadOrganisations.request());\n\n        this.subscription('buildings', this.store.pipe(\n            select(buildingStateSelector),\n            select(selectBuildingOptionsGroupedByCity),\n            map((grouped: Map<BuildingCity, Building[]>) => {\n                return flattenDisplayOffices(grouped);\n            }),\n            distinctUntilChanged()\n        ).subscribe(next => {\n            this.buildings.next(next);\n            // console.log('on buildings ')\n            // this.refresh('homepage');\n        }));\n\n        this.subscription('currentUser', this.store.select(selectCurrentUser)\n        .pipe(take(1))\n        .subscribe((user: User) => {\n                // Once we know we have the user loaded\n                this.currentUser = new User(user);\n                this.store.dispatch(loadBookingsWithQuery({ 'email': this.currentUser.email, 'from': DateNow(new Date()).ms, 'target': 'homepage' }));\n                // start the timer at the top of the minute;\n                // const offset = DateNow(new Date()).startOfValue('minute').addValue({ minutes: 1 }).ms - DateNow(new Date()).ms;\n                // fetch it on one minute interval now that there is room data.\n                // setTimeout(() => {\n                //     console.log('on setTimeout ')\n                //     this.refresh('homepage')\n                    this.interval('refreshBookings', () => {\n\t\t\t\t\t\t\t\t\t\t\tthis.refresh('homepage')\n\t\t\t\t\t\t\t\t\t\t}, 60 * 1000);\n                // }, offset + 5000)\n\n            })\n        );\n\n        this.subscription('homepageResults', this.store.pipe(\n            select(selectHomepageBookingsResultsFromState)\n        ).subscribe(next => {\n            this.homepageBookingResults.next(next);\n            if (!next.isEmpty() && next.success && Array.isArray(next.success.results) && next.success.total) {\n                this.reloading = false;\n                this.showManageButtonA = true;\n                this.upcomingBookings = mapResultsToViewModels(next.success.results).filter(b => !(b.booking.is_recurrent && b.booking.recurrence_type === 'master'));\n                this.allBookings = next.success.results;\n\n                if (this.upcomingBookings.length) {\n                    this.showBookings = true;\n                }\n            } else {\n                this.reloading = false;\n                this.showManageButtonA = false;\n                this.upcomingBookings = [];\n                this.showBookings = false;\n            }\n        }));\n\n        this.subscription('pastResults', this.store.pipe(\n            select(selectPastBookingsResultsFromState)\n        ).subscribe(next => {\n            if (!next.isEmpty() && next.optionalSuccess?.total) {\n                this.showManageButtonB = true;\n            }\n        }));\n\n        this.subscription('cancelledResults', this.store.pipe(\n            select(selectCancelledBookingsResultsFromState)\n        ).subscribe(next => {\n            if (!next.isEmpty() && next.optionalSuccess?.total) {\n                this.showManageButtonC = true;\n            }\n        }));\n    }\n\n    public showResults() {\n        // Don't show the loading state while we're reloading with Building details.\n        return this.reloading || this.homepageBookingResults.value.hasLoaded();\n    }\n\n    public getBuilding(booking: Booking) {\n        if (this.buildings && booking.building_zone) {\n            return this.buildings.value.find(b => booking.building_zone === b.value)?.meta.building;\n        }\n        return '';\n    }\n\n    // public hideBanner() {\n    //     this.showBanner = false;\n    // }\n\n    public learnMore() {\n        window.open(Urls.LearnMore);\n    }\n\n    public routeToResults(next: BookingFormData) {\n        this.store.dispatch(storeBookingFormData({\n            payload: {\n                ...next\n            }\n        }));\n        this.store.dispatch(loadRoomsForResults.clear());\n        this.router.navigate(['results'], { relativeTo: this.route });\n    }\n\n    public routeToManageBookings() {\n        this.router.navigate(['manage'], { relativeTo: this.route });\n    }\n\n    public refresh(target: string) {\n        if (!this.currentUser?.email) {\n            return;\n        }\n\n        // tslint:disable-next-line: max-line-length\n        this.store.dispatch(loadBookingsWithQuery({ 'email': this.currentUser.email, 'from': DateNow(new Date()).ms, target }));\n    }\n\n\n\t\t/**\n\t\t * Displays detailed information about a booking in a modal dialog.\n\t\t * If the booking is part of a recurring series, it retrieves the master booking\n\t\t * details and displays them along with the selected booking. The modal allows\n\t\t * users to view and interact with the booking details. After the modal is closed,\n\t\t * it checks for special flags to determine if the active form and result data should be cleared.\n\t\t *\n\t\t * @param {BookingResultsViewModel} viewModel - The view model containing booking information to display.\n\t\t */\n    public async viewBooking(viewModel: BookingResultsViewModel) {\n\n\t\t\t// Handle logic for recurring bookings to fetch the master booking details\n    \t// and set the master_booking property for displaying in the modal\n\t\t\tif(viewModel.booking.is_recurrent) {\n\t\t\t\t\tlet booking = this.allBookings.find(bkn => bkn.id === viewModel.booking.recurrence_master_id && bkn.recurrence_type === 'master1') ;\n\t\t\t\t\tif (!booking) {\n\t\t\t\t\t\t\tbooking = await this._bookings.show(viewModel.booking.recurrence_master_id);\n\t\t\t\t\t}\n\t\t\t\t\tthis.master_booking = mapResultsToViewModels([booking])[0];\n\t\t\t}\n\n\t\t\t// Open a modal dialog to display the booking details along with master booking (if applicable)\n\t\t\tconst dialogRefX = this.dialog.open(BookingDetailsModalComponent, {\n\t\t\t\t\tpanelClass: 'mck-modal-wide-manage-booking',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tbooking: viewModel.booking,\t// Selected booking information\n\t\t\t\t\t\t\tbuilding: this.getBuilding(viewModel.booking),\t// Building information for the booking\n\t\t\t\t\t\t\tmaster_booking: this.master_booking?.booking || null,\t// Master booking details (if available)\n\t\t\t\t\t\t\trefresh: () => {\n\t\t\t\t\t\t\t\t\tthis.refresh('homepage');\t// Function to refresh the homepage after modal closure\n\t\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tautoFocus: false,\n\t\t\t\t\tbackdropClass: 'mck-modal-backdrop',\n\t\t\t});\n\n\t\t\tdialogRefX.afterClosed().subscribe((flag) => {\n\t\t\t\t// Clear form and result data if the flag indicates it's necessary\n\t\t\t\t\tflag !== 'DoNotClearActiveForm' && this.clearFormAndResultData();\n\t\t\t});\n    }\n\n\t\t/**\n\t\t * Clears active form and result data from the store.\n\t\t *\n\t\t * This function dispatches actions to clear the active form data and the loaded\n\t\t * rooms data from the store. It is typically used after a modal interaction or\n\t\t * a specific user action to reset the form state and loaded room information.\n\t\t */\n    public clearFormAndResultData() {\n        this.store.dispatch(clearBookingFormData());\n        this.store.dispatch(loadRoomsForResults.clear());\n    }\n\n\n}\n","import { Component, OnInit } from '@angular/core';\nimport {\n    TopBarHeaderMode,\n    RoutePayload,\n} from 'src/app/components/topbar-header/topbar-header.component';\nimport { select, Store } from '@ngrx/store';\nimport {\n    Booking,\n    User,\n    Space,\n    BookingFormData,\n    selectActiveForm,\n    selectFilteredByIdResults,\n    BookingStoreState,\n    storeBookingFormData,\n    DateDurationData,\n    OrganisationService,\n    SpaceConflictAlertModalData,\n    SpaceStatus,\n    filterSpacesByAppliedFilters,\n    FilteredSpaces,\n    Building,\n    SpaceFilterReason,\n    getLastDateFromList,\n    RoomResultsViewModel,\n    stringToMinutes,\n} from '@mckinsey-converge/data-common';\nimport {\n    BaseDirective,\n    dateBuildingFormatString,\n    DialogEvent,\n    shorterLocalDateFormatString,\n    startEndTimeWithZoneFormatString,\n} from '@mckinsey-converge/base';\nimport { BehaviorSubject, fromEvent } from 'rxjs';\nimport { distinctUntilChanged, take, throttleTime, tap, filter } from 'rxjs/operators';\nimport { BuildingStoreState } from '@mckinsey-converge/buildings';\nimport { RoomStoreState, loadByIdResults } from '@mckinsey-converge/rooms';\nimport { Router, NavigationStart, Event as NavigationEvent } from '@angular/router';\nimport { UserStoreState } from '@mckinsey-converge/user';\nimport { selectCurrentUser } from '@mckinsey-converge/user';\nimport { DateNow, DateTZ } from '@mckinsey-converge/date-tz';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    ConflictAlertModalComponent,\n    ConflictsModalComponent,\n    ConflictsModalComponentData,\n} from '@mckinsey-converge/ui';\n\nexport type RoomResultsState = BookingStoreState &\n    RoomStoreState &\n    BuildingStoreState &\n    UserStoreState;\n\nconst EMPTY_ARRAY = [];\n\n@Component({\n    selector: 'app-room-details',\n    templateUrl: './room-details.component.html',\n    styleUrls: ['./room-details.component.scss'],\n})\nexport class RoomDetailsComponent extends BaseDirective implements OnInit {\n    public TopBarHeaderMode = TopBarHeaderMode;\n    public booking: Booking;\n    // @TODO get this from current settings.\n    public backRoute: RoutePayload = {\n        route: ['/home', 'results'],\n        queryParams: { display: 'list' },\n    };\n\n    public data = new BehaviorSubject<BookingFormData | undefined>(undefined);\n    public byIdResults = new BehaviorSubject<any | undefined>(undefined);\n    public open: boolean = true;\n    // Set to a config once we know where the files are hosted.\n    public rootFolderURL = 'assets/img/rooms/';\n    // Set in the room availablity callback\n    public mobile: boolean = false;\n    public expandedLocation: boolean = false;\n    public expandedAvailability: boolean = false;\n    // Track event date changes in the UI in this param\n    public alternativeWeekStartDateTz: DateTZ = new DateTZ();\n    /** Current User */\n    public currentUser: User;\n    /** Display warning banner by default */\n    public showInfoBanner: boolean = true;\n    /** Space class created from subscribed active form room data */\n    public room: Space;\n    /** Requested booking start time from subscribed active form data */\n    public requestedDateTz: DateTZ;\n    /** Requested booking end time from subscribed active form data */\n    public requestedEndDateTz: DateTZ;\n\n    /** Track alert dialog should display's only once for not bookable or unavailable */\n    private isAlertDisplayed: boolean = false;\n    /** Update availability status of current rooom  */\n    public availabilityStatus: string;\n    /** Space validity per rule */\n    public isSpaceValidAsPerRule: FilteredSpaces;\n\n    public orgBuildings: Building[] = [];\n    /** Subtype of a room or space. */\n    public roomSubtype: string = '';\n\n    /* recurrence booking - occurence availability */\n    public occurenceAvailability: string = '';\n\n    constructor(\n        private store: Store<RoomResultsState>,\n        private router: Router,\n        private _org: OrganisationService,\n        public dialog: MatDialog\n    ) {\n        super();\n        /**\n         * Router extras expecting from\n         * On navigation from result or home page after QR code scan\n         */\n        if ( this.router.getCurrentNavigation() !== null && this.router.getCurrentNavigation().extras?.state?.payload ) {\n\t\t\t\t\tthis.store.dispatch(storeBookingFormData({\n\t\t\t\t\t\t\tpayload: this.router.getCurrentNavigation().extras.state.payload,\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n        }\n    }\n\n    public ngOnInit(): void {\n        this.availabilityStatus = 'unavailable';\n        this.orgBuildings = this._org.buildings;\n\n        this.subscription(\n            'currentUser',\n            this.store\n                .select(selectCurrentUser)\n                .pipe(take(1))\n                .subscribe((user: User | undefined) => {\n                    // Once we know we have the user loaded.\n                    this.currentUser = new User(user);\n                })\n        );\n\n        this.subscription(\n            'activeForm',\n            this.store\n                .pipe(select(selectActiveForm), distinctUntilChanged())\n                .subscribe((next: BookingFormData | undefined) => {\n                    if (next) {\n                        this.data.next(next);\n                        // R--- selectedRoom could sure use some clarity, why is everything but the kitchen sink in there?\n                        if (!this.data.value?.selectedRoom || !this.data.value?.dateTz.ms) {\n                            return;\n                        }\n                        // Create a full fledged Space object since the selectedRoom.space is just JSON\n                        this.room = new Space(this.data.value?.selectedRoom?.space);\n\n                        // Check room validtion of selected room to maintain status on detail page\n                        this.checkAvailabiltyAsPerRule();\n                        this.setAlternativeWeekStartDate(this.data.value?.dateTz);\n\n                        // Query for the entire day for this room\n                        this.fetchRooms(false);\n                        this.setRoomSubType();\n\n                        this.requestedDateTz = this.data.value?.dateTz;\n                        if (next.is_recurrent) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst { is_local_tz, building_tz} = this?.data?.value?.dateTz;\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst endDate = getLastDateFromList( this?.data?.value?.recurrence_starts );\n                            this.requestedEndDateTz =  new DateTZ({ date: endDate.date.valueOf(), is_local_tz, building_tz })\n                            this.occurenceAvailability = `${this?.room?.availableOccurrences} out of ${this?.room?.totalOccurrences}`;\n                        }\n                    }\n                })\n        );\n\n        this.subscription(\n            'byId',\n            this.store.pipe(select(selectFilteredByIdResults)).subscribe((next) => {\n                this.byIdResults.next(\n                    next.success?.spaces?.length\n                        ? next.success.spaces[0].settings.bookings\n                        : EMPTY_ARRAY\n                );\n            })\n        );\n\n        const breakpoint = 450;\n        if (window) {\n            this.mobile = window.innerWidth < breakpoint;\n        }\n\n        fromEvent(window, 'resize')\n            .pipe(throttleTime(500))\n            .pipe(\n                tap({\n                    next: (val) => {\n                        const target = val.target as Window;\n                        this.mobile = target.innerWidth < breakpoint;\n                    },\n                })\n            )\n            .subscribe();\n    }\n\n    public setRoomSubType() {\n        //test\n        const room_type = `${this?.room.internal_or_external}_room_types`;\n        const temp: string = Array.isArray(this?.room?.room_type)\n            ? this?.room?.room_type[0]\n            : this?.room?.room_type;\n        const type = this?._org?.getOrganizationFiltersByRoomType(room_type)[temp];\n        this.roomSubtype = type !== undefined ? `( ${type} Room )` : '';\n    }\n\n    public isConflictWithOccurences() {\n        const conflicts = this?.room?.totalOccurrences - this?.room?.availableOccurrences;\n        return { is_conflict: !!conflicts, total_Conflicts: conflicts };\n    }\n\n    /**\n\t\t * Opens a modal to display recurrence conflicts for a given room.\n\t\t *\n\t\t * @param {Space} room - The room for which recurrence conflicts are being displayed.\n\t\t *\n\t\t * This function opens a modal dialog to show recurrence exceptions (conflicts)\n\t\t * for the specified room.\n\t\t *\n\t\t * TO DO: SAME FUNCTION BEING USED IN apps/staff/src/app/booking/room-details/room-details.component.ts\n\t\t */\n    public openRecurrenceConflictsModal(room: Space) {\n        let { recurrence_exceptions } = this.data.value;\n\n        const recurr_ref = this.dialog.open<ConflictsModalComponent, ConflictsModalComponentData>(\n            ConflictsModalComponent,\n            {\n                maxWidth: '95vw',\n                width: '32em',\n                data: {\n                    room_name: room.simple_name,\n                    conflicts: recurrence_exceptions,\n                    timezone: room.building.timezone,\n                },\n            }\n        );\n        this.subscription(\n            'conflicts_modal_events',\n            recurr_ref.componentInstance.event.subscribe((event: DialogEvent) => {\n                recurr_ref.close();\n            })\n        );\n        recurr_ref.afterClosed().subscribe(() => this.unsub('conflicts_modal_events'));\n    }\n\n\t\t/**\n\t\t * Retrieves the end date string for the booking, considering recurrence if applicable.\n\t\t * If the booking is recurrent.\n\t\t *\n\t\t * @returns {string} The formatted end date string in a shorter local date format.\n\t\t */\n\t\t public get endDateString(): string {\n\t\t\t// if this.requestedEndDateTz is not in use anywhere here in this file than remove that property and use const here\n\t\t\tif(!this.requestedEndDateTz) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\treturn this.requestedEndDateTz.formatDate('ccc d MMM yyyy'); // shorterLocalDateFormatString(this.requestedEndDateTz);\n\t\t}\n\n    /**\n     * Functino to check if room is available as per room/user rules\n     */\n    public checkAvailabiltyAsPerRule() {\n        this.orgBuildings =\n            !this.orgBuildings.length && this.data.value?.buildings\n                ? this.data.value?.buildings\n                : this.orgBuildings;\n        this.isSpaceValidAsPerRule = filterSpacesByAppliedFilters(\n            [],\n            [this.room],\n            this.data.value,\n            this.orgBuildings,\n            this.currentUser\n        );\n    }\n\n    /**\n     * Function popup advise alert dialog if scanned (QR code) room details found conflicts with other booking/s\n     * @param room\n     */\n    alertIfItHasConflict(isBookable, isAvailable) {\n        this.isAlertDisplayed = true;\n        const data = {\n            headerText: !isBookable\n                ? SpaceConflictAlertModalData.NotBookableHeaderText\n                : !isAvailable\n                ? SpaceConflictAlertModalData.NotAvailableHeaderText\n                : '',\n            message:\n                this.isSpaceValidAsPerRule.specificReason === SpaceFilterReason.OfficeRules\n                    ? SpaceConflictAlertModalData.NotBookableDueToOfficeRule\n                    : !isBookable\n                    ? SpaceConflictAlertModalData.NotBookableMessage\n                    : !isAvailable\n                    ? SpaceConflictAlertModalData.NotAvailableMessage\n                    : '',\n            buttonLabel: !isBookable\n                ? SpaceConflictAlertModalData.NotBookableButtonLabel\n                : !isAvailable\n                ? SpaceConflictAlertModalData.NotAvailableButtonLabel\n                : '',\n            callback: !isBookable\n                ? this.goToBackRoute.bind(this)\n                : !isAvailable\n                ? this.expandAvailability.bind(this, true)\n                : null,\n            shouldClose: isBookable,\n        };\n        const dialog = this.dialog.open(ConflictAlertModalComponent, {\n            data: data,\n            panelClass: 'mck-alert',\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n            disableClose: !isBookable,\n        });\n    }\n\n    public warnIfItHasConflict({ room: room, hasConflict: hasConflict }) {\n        if (\n            (!room.bookable || !this.isSpaceValidAsPerRule.spaces.length) &&\n            !this.isAlertDisplayed\n        ) {\n            // room is not bookable(not available to book) and no warning dialog displayed yet\n            this.alertIfItHasConflict(false, true);\n            this.updateAvailabilityStatus(SpaceStatus.Unavailable);\n        } else if (!room.available && hasConflict && !this.isAlertDisplayed) {\n            //room is not available AT THIS TIME to book (booked) and has conflict with other booking and no warning dialog displayed yet\n            this.alertIfItHasConflict(room.bookable, !hasConflict); // (true, true/false)\n            this.updateAvailabilityStatus(SpaceStatus.Booked);\n        } else {\n            /**\n             * Update status of availability - Uavailable/Booked/Requestable/Bookable\n             * If room is not bookable(not available to book) and warning dialog dispalyed once\n             * If room is bookable but not available to boot AT THIS TIME (or and has conflict with other booking) and warning dialog displayed once\n             * If room is bookable and availanle to book AT THIS TIME then check the type of room Requestable? or Bookable\n             */\n            const status =\n                !room.bookable || !this.isSpaceValidAsPerRule.spaces.length\n                    ? SpaceStatus.Unavailable\n                    : !room.available && hasConflict\n                    ? SpaceStatus.Booked\n                    : this.is_request\n                    ? SpaceStatus.Requestable\n                    : SpaceStatus.Bookable;\n            this.updateAvailabilityStatus(status);\n        }\n    }\n\n    public updateAvailabilityStatus(primaryCheck: string, secondaryCheck?: string) {\n        this.availabilityStatus =\n            primaryCheck !== ''\n                ? primaryCheck\n                : this.data.value.is_recurrent ||\n                  ['unavailable', 'booked'].indexOf(this.availabilityStatus) === -1\n                ? secondaryCheck\n                : this.availabilityStatus;\n    }\n\n    public get catering(): string {\n        return (\n            DateNow(new Date())\n                .setValue({ minute: 0, hour: this.room?.building?.catering_hours.start })\n                .formatDate('ha')\n                .toLocaleLowerCase() +\n            ' - ' +\n            DateNow(new Date())\n                .setValue({ minute: 0, hour: this.room?.building?.catering_hours.end })\n                .formatDate('ha')\n                .toLocaleLowerCase()\n        );\n    }\n\n    public get dateString(): string {\n\t\t\t\tif(!this.requestedDateTz) return '';\n        return this.requestedDateTz.formatDate('ccc d MMM yyyy');; //shorterLocalDateFormatString(this.requestedDateTz);\n        \n    }\n\n    public get focusedRoomMapKey(): string {\n        return `area-${this.room?.map_id}-status`;\n    }\n\n    /** Whether we are only allowed to 'request' the selected space */\n    public get is_request(): boolean {\n        const data = this.data.value;\n\n        /* istanbul ignore else */\n        if (!data?.selectedRoom?.space) {\n            return false;\n        }\n\n        const space = new Space(data.selectedRoom.space);\n        const isRequest = space.byRequest({\n            dateTz: data.dateTz,\n            duration: data.duration,\n            host: this.currentUser,\n        });\n        this.updateAvailabilityStatus(\n            '',\n            isRequest ? SpaceStatus.Requestable : SpaceStatus.Bookable\n        );\n        return isRequest;\n    }\n\n    public get roomFeatures(): string[] {\n        // const room_type = `${this.room.internal_or_external}_room_types`\n        const combinedFeatures = {\n            // ...this._org.getOrganizationFiltersByRoomType(room_type),\n            ...this._org.getOrganizationFiltersByRoomType('equipment_types'),\n        };\n        const features = this.room !== undefined ? this.room?.featuresArray.map(\n            (feature: string) => combinedFeatures[feature]\n        ) : [];\n\n        return [...new Set(features)].filter((f) => !!f);\n    }\n\n    public get roomHasCatering() {\n        // Building scope catering available is true or false\n        const building = this.data.value?.selectedRoom?.building;\n        let hasCatering = building ? building.has_catering : false;\n        // but if Room catering is false it overrides the building\n        if (this.room?.has_catering === false) {\n            hasCatering = false;\n        }\n        return hasCatering;\n    }\n\n    public get roomImagesFileSlug(): string {\n        return this.room?.email.split('@')[0];\n    }\n\n    public get mapUrl(): string {\n        return this.room?.level?.map_url;\n    }\n\n    public get timeString(): string {\n\t\t\tif(!this.requestedDateTz) return '';\n\t\t\treturn startEndTimeWithZoneFormatString(\n\t\t\t\t\tthis.requestedDateTz,\n\t\t\t\t\tthis.requestedDateTz.addValue({ minutes: this.data.value?.duration })\n\t\t\t);\n    }\n\n    /**\n     * Get the timezone form the subscribed activeForm\n     */\n    public get timezone(): string {\n        // R--- this.room.timezone wasn't reliable enough on page refresh, something to look into\n        return this.data.value.selectedRoom?.building.timezone;\n    }\n\n    public setAlternativeWeekStartDate(bookingDate: DateTZ) {\n        if (!bookingDate) {\n            return;\n        }\n\n        const booking_date = bookingDate.clone();\n        if (this.mobile) {\n            this.alternativeWeekStartDateTz = booking_date;\n        } else {\n            this.alternativeWeekStartDateTz = booking_date.startOfValue('week');\n        }\n    }\n\n    public updateCalendarWeekView(alternativeWeekStartDateTz: DateTZ) {\n        this.alternativeWeekStartDateTz = alternativeWeekStartDateTz;\n        this.fetchRooms(!this.mobile, this.alternativeWeekStartDateTz);\n    }\n\n    public confirmChanges(data: DateDurationData) {\n        // R-- refactor room-availability-preview to return DateTZ so setAlternativeWeekStartDate can use it.\n        this.mobile = data.mobile;\n        this.setAlternativeWeekStartDate(data.dateTz);\n\n        this.fetchRooms(!this.mobile, this.alternativeWeekStartDateTz);\n        // submit\n        this.store.dispatch(\n            storeBookingFormData({\n                payload: {\n                    ...this.data.value,\n                    dateTz: data.dateTz,\n                    duration: data.duration,\n                },\n            })\n        );\n    }\n\n    public fetchRooms(allWeek: boolean = true, alternativeWeekStartDateTz: DateTZ = null) {\n        if (!this.room?.id) {\n            return;\n        }\n\n        const day = 24 * 60;\n        const week = day * 7;\n\n        let start_date = (alternativeWeekStartDateTz || this.data.value.dateTz).clone();\n        if (allWeek && start_date.dateWeekday !== 7) {\n            start_date = start_date.startOfValue('week');\n        }\n\n        const startOfDay = start_date.startOfValue('day').setValue({ second: 0, millisecond: 0 });\n        const startOfWeek = start_date.setValue({ second: 0, millisecond: 0 }).startOfValue('day');\n\n        // Query for the entire day for this room\n        const query = {\n            dateTz: allWeek ? startOfWeek : startOfDay,\n            duration: allWeek ? week : day,\n            locations: this.room?.id,\n            capacity: this.data.value?.roomSize.value,\n        };\n        this.store.dispatch(loadByIdResults.request(query));\n    }\n\n    public removeDateOffset() {\n        const data = this.data.value;\n        let { dateTz, offset } = data;\n        dateTz = dateTz.subtractValue({ minutes: ((typeof offset === 'string' && offset == '') || (typeof offset === 'undefined')) ? 0 : Number(offset) });\n        this.store.dispatch(\n            storeBookingFormData({\n                payload: {\n                    ...data,\n                    dateTz: dateTz,\n                    offset: 0,\n                },\n            })\n        );\n    }\n\n    public goToBackRoute() {\n        this.removeDateOffset();\n        this.router.navigate(this.backRoute.route, { queryParams: this.backRoute.queryParams });\n    }\n\n    public expandMap(open: boolean) {\n        this.expandedLocation = open;\n    }\n\n    public expandAvailability(open: boolean) {\n        this.fetchRooms(!this.mobile);\n        this.expandedAvailability = open;\n    }\n\n    public handleClose() {\n        this.expandedLocation = false;\n        this.expandedAvailability = false;\n        this.setAlternativeWeekStartDate(this.data.value?.dateTz);\n        this.fetchRooms(false);\n    }\n\n    /**\n     * Continue to Booking Form\n     */\n    public bookRoom() {\n        // submit\n        this.store.dispatch(\n            storeBookingFormData({\n                payload: {\n                    ...this.data.value,\n                },\n            })\n        );\n\n        const bookingRoute = this.data.value.id ? 'edit' : 'create';\n        this.router.navigate(['/home', bookingRoute]);\n    }\n\n    public hideInfoBanner() {\n        this.showInfoBanner = false;\n    }\n}\n","<div class=\"mck-column mck-content-expand mck-content-page-container\">\n    <header class=\"header\">\n        <a-topbar-header\n            [mode]=\"TopBarHeaderMode.Light\"\n            (onBack)=\"removeDateOffset()\"\n            [back]=\"backRoute\">\n        </a-topbar-header>\n    </header>\n    <div class=\"info banner\" *ngIf=\"showInfoBanner && !expandedAvailability\">\n        <img src=\"assets/icon/info-bg-blue.svg\"/>\n        <p class=\"banner-text\">This room is not guaranteed until booking confirmation is received.</p>\n        <img src=\"assets/icon/close-blue.svg\" (click)=\"hideInfoBanner()\"/>\n    </div>\n    <div  class=\"advise banner\" *ngIf=\"expandedAvailability && availabilityStatus==='booked'\" style=\"z-index:9;\">\n        <img src=\"assets/icon/info-bg-dark.svg\">\n        <p  class=\"banner-text\">This time slot is not available, drag or choose a diferent date or time.</p>\n    </div>\n    <div class=\"mck-column mck-center results-container mb-block\" [class.mck-scroll]=\"!expandedLocation && !expandedAvailability\">\n        <div [class.open]=\"open\" class=\"mck-column mck-content-expand-width \">\n            <mck-responsive-inline-images\n                [rootFolderURL]=\"rootFolderURL\"\n                [fileSlug]=\"roomImagesFileSlug\"\n                *ngIf=\"!expandedLocation && !expandedAvailability\"\n            ></mck-responsive-inline-images>\n            <div class=\"room-content mck-column mck-center mck-content-body\">\n                <div class=\"mck-column\"  [ngClass]=\"('mck-border-'+availabilityStatus)\">\n                    <div class=\"mck-row rm-availability-status \" [ngClass]=\"('mck-'+availabilityStatus)\">\n                        {{ availabilityStatus | titlecase }} {{ occurenceAvailability }}\n                    </div>\n                    <div class=\"details\">\n                        <div class=\"mck-row mck-center-align\"> <h1>{{room?.local_name}}</h1> <div class=\"room-type-tag mck-row mck-center\" [ngClass]=\"data.value?.bookingType.value\">{{data.value?.bookingType.display}}</div> </div>\n                        <label>\n                            {{room?.building?.name}}, {{room?.level?.name}}, {{room?.building?.address}}\n                            <span>|</span>\n                            Capacity: {{room?.capacity}} people\n                            <span>|</span>\n                            Room Type: {{data?.value?.bookingType?.display}} <span style=\"padding: 0px;\">  {{roomSubtype}} </span>\n                        </label>\n                        <div class=\"section\">\n                            <div *ngIf=\"roomFeatures.length\">\n                                <img src=\"assets/icon/equipment.svg\">\n                                Equipment\n                                <ul class=\"list\">\n                                    <li *ngFor=\"let feature of roomFeatures\">\n                                        {{feature}}\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n                        <div class=\"section\" *ngIf=\"roomHasCatering\">\n                            <img src=\"assets/icon/catering.svg\">\n                            Catering Available\n                            <ul class=\"list\">\n                                <li>{{catering}}</li>\n                                <li>(specified in the last booking step)</li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"panels\">\n                    <div class=\"part\" *ngIf=\"!data?.value?.is_recurrent\">\n                        <h2>Room Availability:</h2>\n                        <p>{{dateString}}</p>\n                        <room-availability-preview\n                            *ngIf=\"data.value?.dateTz.ms\"\n                            [alternativeWeekStartDateTz]=\"alternativeWeekStartDateTz\"\n                            [bookings]=\"byIdResults.value\"\n                            [building]=\"room?.building\"\n                            [currentBooking]=\"booking\"\n                            [currentUser]=\"currentUser\"\n                            [dateTz]=\"data.value?.dateTz\"\n                            [duration]=\"data.value?.duration\"\n                            [expanded]=\"expandedAvailability\"\n                            [level]=\"room?.level\"\n                            [space]=\"room\"\n                            (confirmChanges)=\"confirmChanges($event)\"\n                            (handleExpand)=\"handleClose()\"\n                            (updateCalendarWeekView)=\"updateCalendarWeekView($event)\"\n                            (warnIfItHasConflict)=\"warnIfItHasConflict($event)\"\n                        ></room-availability-preview>\n                        <div class=\"mck-column\">\n                            <button mat-stroked-button color=\"primary\"\n                                    class=\"mck-stroked-button mck-short mck-center mck-primary\"\n                                    (click)=\"expandAvailability(true)\">\n                                Show full room availability\n                            </button>\n                        </div>\n                    </div>\n                    <div class=\"part\">\n                        <h2>Room Location:</h2>\n                        <p>{{room?.building?.name}}, {{room?.level?.name}}</p>\n                        <room-location-preview\n                            [mapUrl]=\"mapUrl\"\n                            [focus]=\"focusedRoomMapKey\"\n                            [expanded]=\"expandedLocation\"\n                            [building]=\"room?.building\"\n                            [level]=\"room?.level\"\n                            [space]=\"room\"\n                            [mode]=\"TopBarHeaderMode.Light\"\n                            (handleExpand)=\"handleClose()\"\n                        ></room-location-preview>\n                        <div class=\"mck-column\">\n                            <button mat-stroked-button color=\"primary\"\n                                    class=\"mck-stroked-button mck-short mck-center mck-primary\"\n                                    (click)=\"expandMap(true)\">\n                                Show room on map\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"bottom-panel\">\n        <div class=\"mck-content-body\">\n            <div class=\"panel\">\n\n                <div class=\"tap\" (click)=\"open = !open\">\n                    <div>\n                        <img src=\"assets/icon/minimize-bar.svg\" [class.open]=\"open\"/>\n                        {{ open ? '(tap to close)' : '(tap to open)'}}\n                    </div>\n                    <h2>{{ data?.value?.is_recurrent ? 'Recurring' : 'Room' }} Booking Detail</h2>\n                </div>\n\n                <div class=\"hideable\" [class.open]=\"open\" *ngIf=\"!data?.value?.is_recurrent\">\n                    <div>Date: {{dateString}}</div>\n                    <div>Time: {{timeString}}</div>\n                </div>\n                <div class=\"hideable\" [class.open-rec-details]=\"open\" *ngIf=\"data?.value?.is_recurrent\">\n                    <div class=\"rec-details-period\">{{data?.value?.recurrence_period === 'list' ? 'Specific dates' :\n                        data?.value?.recurrence_period | titlecase}}\n                        <span *ngIf=\"isConflictWithOccurences()?.is_conflict\" (click)=\"openRecurrenceConflictsModal(room)\"> -\n                            Conflicts({{isConflictWithOccurences()?.total_Conflicts}}) </span>\n                    </div>\n                    <div>Start date: {{dateString}}</div>\n                    <div>End date: {{endDateString}}</div>\n                    <div>Time: {{timeString}}</div>\n                </div>\n            </div>\n        </div>\n        <div class=\"buttons\">\n            <div>\n                <button mat-button color=\"secondary\" class=\"mck-secondary-button\" (click)=\"goToBackRoute()\">Back</button>\n                <button mat-button color=\"primary\" [disabled]=\"availabilityStatus==='unavailable' || availabilityStatus==='booked'\" class=\"mck-primary-button\" (click)=\"bookRoom()\">{{is_request ? 'Request' : 'Book'}} Room</button>\n            </div>\n        </div>\n    </div>\n</div>\n","import {\n    Component,\n    EventEmitter,\n    OnInit,\n    Output\n} from '@angular/core';\nimport {\n    instantBookOptions,\n    roomDetailsRequired,\n    roomEquipmentRequiredOptions,\n    selectFormFilters,\n    selectIsInternal,\n    roomCateringAvailable,\n    OrganisationService\n} from '@mckinsey-converge/data-common';\nimport {\n    select,\n    Store\n} from '@ngrx/store';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { BehaviorSubject } from 'rxjs';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport {\n    map,\n    take\n} from 'rxjs/operators';\n\n@Component({\n    selector: 'app-room-filters-form',\n    template: `\n        <div class=\"mck-column filters-container\">\n            <mck-switch-group\n                title=\"Instant Book\"\n                (optionChecked)=\"toggleOptionChecked($event)\"\n                [selectedOptions]=\"selectedOptions | async\"\n                [options]=\"instantBookOptions\">\n            </mck-switch-group>\n            <mck-switch-group\n                title=\"Room Equipment\"\n                (optionChecked)=\"toggleOptionChecked($event)\"\n                [selectedOptions]=\"selectedOptions | async\"\n                [options]=\"roomEquipmentRequiredOptions\">\n            </mck-switch-group>\n            <mck-switch-group\n                *ngIf=\"isInternal\"\n                (optionChecked)=\"toggleOptionChecked($event)\"\n                [selectedOptions]=\"selectedOptions | async\"\n                title=\"Internal Room Type\"\n                [options]=\"internalRoomTypeRequiredOptions\">\n            </mck-switch-group>\n            <mck-switch-group\n                *ngIf=\"!isInternal\"\n                (optionChecked)=\"toggleOptionChecked($event)\"\n                [selectedOptions]=\"selectedOptions | async\"\n                title=\"External Room Type\"\n                [options]=\"externalRoomTypeRequiredOptions\">\n            </mck-switch-group>\n            <mck-switch-group\n                title=\"Room Details Required\"\n                (optionChecked)=\"toggleOptionChecked($event)\"\n                [selectedOptions]=\"selectedOptions | async\"\n                [options]=\"roomDetailsRequired\">\n            </mck-switch-group>\n            <mck-switch-group\n                title=\"Catering Available\"\n                (optionChecked)=\"toggleOptionChecked($event)\"\n                [selectedOptions]=\"selectedOptions | async\"\n                [options]=\"roomCateringAvailable\">\n            </mck-switch-group>\n            <mck-spacer size=\"48px\" spacerClass=\"mck-spacer-content-expand-mobile\"></mck-spacer>\n            <!-- Inline button-row may be injected into this ng-content tag. -->\n            <ng-content></ng-content>\n        </div>\n    `,\n    styleUrls: ['./room-filters-form.component.scss']\n})\nexport class RoomFiltersFormComponent extends BaseDirective implements OnInit {\n\n    public instantBookOptions = instantBookOptions;\n    public roomEquipmentRequiredOptions = roomEquipmentRequiredOptions;\n    public roomDetailsRequired = roomDetailsRequired;\n    public roomCateringAvailable = roomCateringAvailable;\n    public internalRoomTypeRequiredOptions = [];\n    public externalRoomTypeRequiredOptions = [];\n    public isInternal = false;\n\n    public selectedOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    @Output()\n    public cancelSubmit = new EventEmitter();\n\n    @Output()\n    public filtersSubmit = new EventEmitter<SelectOption<any>[]>();\n\n    constructor(private store: Store, private _org: OrganisationService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.subscription('bookingType',\n            this.store.pipe(\n                select(selectIsInternal)\n            ).subscribe(next => {\n                this.isInternal = next;\n            }));\n        this.subscription('filters',\n            this.store.pipe(\n                select(selectFormFilters)\n            ).subscribe(next => {\n                this.selectedOptions.next(next);\n            }));\n\n        this.externalRoomTypeRequiredOptions = this.getFilters('external_room_types')\n        this.internalRoomTypeRequiredOptions = this.getFilters('internal_room_types')\n    }\n\n    public toggleOptionChecked(selectOption: SelectOption<any>) {\n        this.selectedOptions.pipe(\n            take(1),\n            map(options => {\n                const found = options.find(o => o.value === selectOption.value);\n                if (found) {\n                    // remove\n                    return options.filter(o => o.value !== selectOption.value);\n                }\n                // add\n                return [...options, selectOption];\n            })\n        ).subscribe(next => {\n            this.selectedOptions.next(next);\n        });\n    }\n\n    public submitFilters() {\n        this.selectedOptions.pipe(\n            take(1)\n        ).subscribe(options => {\n            this.filtersSubmit.emit(options);\n        });\n    }\n\n    public getFilters(type:string) {\n        const filters = this._org.getOrganizationFiltersByRoomType(type) || {}\n        return Object.keys(filters).map((key) => {\n            const display = filters[key]\n            return {\n                value: key,\n                display,\n                shortDisplay: display\n            }\n        })\n    }\n}\n","import {\n    Component,\n    ViewChild\n} from '@angular/core';\nimport { MatDialogRef } from '@angular/material/dialog';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { Store } from '@ngrx/store';\nimport { storeRoomFilters } from '@mckinsey-converge/data-common';\nimport { RoomFiltersFormComponent } from 'src/app/booking/room-filters-form/room-filters-form.component';\n\n@Component({\n    selector: 'app-room-filters',\n    template: `\n        <div>\n        <mck-modal header=\"Filter the Results\" class=\"filters-modal-container\">\n            <app-room-filters-form\n                #roomFiltersForm\n                (cancelSubmit)=\"close()\"\n                (filtersSubmit)=\"submitFilters($event)\">\n            </app-room-filters-form>\n            <mat-dialog-actions class=\"filters-modal-actions\">\n                <mck-modal-button-row\n                    (primarySubmit)=\"roomFiltersForm.submitFilters()\"\n                    (secondarySubmit)=\"roomFiltersForm.cancelSubmit.emit($event)\"\n                    primaryLabel=\"Filter\"\n                    secondaryLabel=\"Cancel\">\n                </mck-modal-button-row>\n            </mat-dialog-actions>\n        </mck-modal>\n        </div>\n    `,\n    styleUrls: ['./room-filters-modal.component.scss']\n})\nexport class RoomFiltersModalComponent {\n\n    @ViewChild(RoomFiltersFormComponent)\n    public form: RoomFiltersFormComponent;\n\n    constructor(\n        private store: Store,\n        private dialogRef: MatDialogRef<RoomFiltersModalComponent>) {\n    }\n\n    public close() {\n        this.dialogRef.close();\n    }\n\n    public submitFilters(filters: SelectOption<any>[]) {\n        this.store.dispatch(storeRoomFilters({\n            payload: filters\n        }));\n        this.close();\n    }\n}\n","import {\n    Component,\n    Input,\n    OnInit,\n    OnChanges,\n    EventEmitter,\n    Output,\n    ViewEncapsulation,\n} from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    BehaviorSubject,\n    combineLatest,\n} from 'rxjs';\nimport {\n    map,\n    take,\n} from 'rxjs/operators';\nimport { filterUndefined } from '@mckinsey-converge/rx-utils';\nimport {\n    select,\n    Store\n} from '@ngrx/store';\nimport {\n    CENTER_POINT,\n    generateMapStyleForSpace,\n    legendOptions,\n    MAX_ZOOM_LEVEL,\n    MIN_ZOOM_LEVEL,\n    spaceToMapFeature,\n} from 'src/app/map/map.utils';\nimport {\n    Building,\n    BuildingLevel,\n    SettingsService,\n    Space,\n    SpaceStatus,\n    selectMapFilteredResults,\n    FilteredSpaces\n} from '@mckinsey-converge/data-common';\nimport {\n    Point,\n    HashMap,\n    BaseDirective,\n} from '@mckinsey-converge/base';\nimport { MapFeature } from '@acaprojects/ngx-interactive-map/lib/helpers/map.interfaces';\nimport { OfficeInformationModalComponent } from 'src/app/map/office-information-modal/office-information-modal.component';\nimport { MapSearchStoreState } from '../../map/map-search/map-search.component';\nimport { LoadingModel } from '@mckinsey-converge/loading';\nimport {\n    generateFeedbackUrl,\n    Urls\n} from '../../utilities/urls';\n\nexport enum TopBarHeaderMode {\n    Light = 'light',\n    Dark = 'dark',\n}\n\n@Component({\n    selector: 'room-location-preview',\n    template: `\n        <div class=\"room-location mck-row\" [class.booking-view]=\"!expanded && viewMode === 'booking_preview'\">\n            <div class=\"map-wrapper\" [class.expanded]=\"expanded\">\n                <header class=\"header\" *ngIf=\"expanded\">\n                    <a-topbar-header\n                        [mode]=\"mode\"\n                        [backModal]=\"true\"\n                        [noSurvey]=\"true\"\n                        (closeCallback)=\"collapse()\">\n                    </a-topbar-header>\n                </header>\n                <div class=\"sub\" *ngIf=\"expanded\">\n                    <div>\n                        <div class=\"title\">\n                            <div class=\"title-name\">\n                                <img src=\"assets/icon/white-location.svg\">\n                                {{building.name}}, {{level.name}}\n                            </div>\n                            <div class=\"title-description\">The pinpoint indicates your selected room's location on the floor. No futher interaction is available.</div>\n                        </div>\n                        <div class=\"map-controls\">\n                            <div class=\"mck-row\">\n                                <button\n                                    name=\"info-button\"\n                                    mat-button\n                                    (click)=\"displayOfficeInformation()\"\n                                    color=\"primary\"\n                                    class=\"mck-warning-button mck-square map-info-button\">\n                                    <div class=\"map-icon-info\"></div>\n                                </button>\n                                <mck-legend-dropdown\n                                    placeholder=\"Show legend\"\n                                    placeholderOpen=\"Hide legend\"\n                                    [options]=\"legendOptions\"\n                                ></mck-legend-dropdown>\n                            </div>\n                            <app-map-controls\n                                (zoomInClick)=\"zoomIn()\"\n                                (zoomOutClick)=\"zoomOut()\"\n                                (refreshClick)=\"resetZoomLevels()\"\n                            ></app-map-controls>\n                        </div>\n                    </div>\n                </div>\n                <a-map\n                    [class.np]=\"!expanded\"\n                    [zoom]=\"zoomLevel\"\n                    [src]=\"mapUrl\"\n                    [focus]=\"focusedRoom | async\"\n                    [center]=\"center | async\"\n                    [css]=\"style_map | async\"\n                    [features]=\"features | async\"\n                >\n                </a-map>\n                <div class=\"footer mck-column mck-center\" *ngIf=\"expanded\">\n                    <div>\n                        <button mat-button color=\"primary\" class=\"mck-primary-button\" (click)=\"collapse()\">Close</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `,\n    styleUrls: ['./room-location-preview.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class RoomLocationPreviewComponent extends BaseDirective implements OnInit, OnChanges {\n    public legendOptions = legendOptions();\n\n    @Input()\n    public mapUrl: string;\n\n    @Input()\n    public focus: any; // @todo fix\n\n    @Input()\n    public expanded: boolean;\n\n    @Input()\n    public building: Building;\n\n    @Input()\n    public space: Space;\n\n    @Input()\n    public level: any; // @todo fix\n\n    /** The theme to use **/\n    @Input() public mode: TopBarHeaderMode = TopBarHeaderMode.Dark;\n\n    // Use \"booking_preview\" to show smaller height with zoom icon\n    @Input() public viewMode: String = null;\n\n    @Output()\n    public handleExpand: EventEmitter<any> = new EventEmitter();\n\n    public currentPage: string;\n\n    public get feedback() {\n        return generateFeedbackUrl(this.currentPage);\n    }\n\n    public get zoomLevel() {\n        return this.expanded ? this.minZoom.value : this.zoom.value;\n    }\n\n    constructor(\n        private store: Store<MapSearchStoreState>,\n        public dialog: MatDialog,\n        private settingService: SettingsService) {\n        super();\n    }\n\n    public focusedRoom = new BehaviorSubject<MapFeature | undefined>(undefined);\n    public featuresRoom = new BehaviorSubject<MapFeature | undefined>(undefined);\n    public zoom = new BehaviorSubject(MIN_ZOOM_LEVEL);\n    public minZoom = new BehaviorSubject(MAX_ZOOM_LEVEL / 3);\n    public features = combineLatest([this.featuresRoom]).pipe(map(items => items.filter(i => !!i)));\n    public setIntervalHandle: any = null;\n    public count = 0;\n    public center = new BehaviorSubject<Point>(CENTER_POINT);\n    /** Mapping of elements to CSS styles */\n    public style_map = new BehaviorSubject<HashMap<HashMap<string | number>>>({});\n\n    public activeBuilding = new BehaviorSubject<Building | undefined>(undefined);\n    public activeLevel = new BehaviorSubject<BuildingLevel | undefined>(undefined);\n    public activeSpace = new BehaviorSubject<Space | undefined>(undefined);\n\n    public ngOnChanges(changes: any): void {\n        if (changes.expanded && changes.expanded.currentValue) {\n            this.activeSpace.pipe(\n                take(1),\n                filterUndefined<Space>(),\n                map(spaceToMapFeature)\n            ).subscribe(next => {\n                this.featuresRoom.next(next);\n            });\n        } else if (changes.expanded && changes.expanded.previousValue && !changes.expanded.currentValue) {\n            this.featuresRoom.next(undefined);\n        }\n    }\n\n    public ngOnInit(): void {\n        this.timeout('Getting Title', () => this.updateRoute(document.title));\n\n        // MCK-1850 And it's even slower when loading form scratch via an email link, so 10 second interval.\n        this.timeout('Zoom to Room', () => this.initMapZoom(), 2000);\n        this.activeSpace.next(this.space);\n        this.activeBuilding.next(this.building);\n        this.activeLevel.next(this.level);\n\n        this.subscription('bookingSpaceResults',\n            combineLatest([\n                this.store.pipe(\n                    select(selectMapFilteredResults),\n                    map((r: LoadingModel<FilteredSpaces>) => r.success)\n                ),\n                this.activeBuilding.pipe(filterUndefined<Building>()),\n                this.activeLevel.pipe(filterUndefined<BuildingLevel>())\n            ]).subscribe(([filteredSpaces, building, level]) => {\n                const spacesFromSelection = (filteredSpaces.spaces || [])\n                    .filter(s => !!s.map_id && s.zones.includes(building.id) && s.zones.includes(level.id));\n\n                const styles: HashMap<HashMap<string | number>> = {};\n                // const colour_map = this.settingService.get('app.explore.colors') || {};\n                // spacesFromSelection.forEach(space => {\n                //     const status = filteredSpaces.statusMap[space.id] || SpaceStatus.Available;\n                //     const mapStyle = generateMapStyleForSpace(space, status, colour_map);\n                //     styles[`#${mapStyle.id}`] = mapStyle.styles;\n                // });\n                this.style_map.next(styles);\n                \n            })\n        );\n\n    }\n\n    public initMapZoom() {\n        const self = this;\n        // Doesn't reliably zoom to room until that component is finished loading and processing elements.\n        // But this alone is not enough when loading from an email link due to how slow the loading is. See the ngOnInit\n        this.setIntervalHandle = setInterval(() => {\n            if (!this.focus) {\n                return;\n            }\n            \n            self.zoomToRoom();\n            self.count ++;\n            if (self.count > 4) {\n                clearInterval(self.setIntervalHandle);\n                self.setIntervalHandle = null;\n            }\n        }, 1000);\n    }\n\n    public updateRoute(location) {\n        location = location.substr(0, location.indexOf(' |'));\n        this.currentPage = location;\n    }\n\n    public goToHelp() {\n        window.open(Urls.Help);\n    }\n\n    public zoomToRoom(): void {\n        this.focusedRoom.next(this.focus);\n        this.zoom.next(MAX_ZOOM_LEVEL);\n    }\n\n    public zoomIn() {\n        if (this.minZoom.value < MAX_ZOOM_LEVEL) {\n            this.minZoom.next(this.minZoom.value + 1);\n        }\n    }\n\n    public zoomOut() {\n        if (this.minZoom.value > MIN_ZOOM_LEVEL) {\n            this.minZoom.next(this.minZoom.value - 1);\n        }\n    }\n\n    public resetZoomLevels() {\n        this.minZoom.next(MIN_ZOOM_LEVEL);\n        this.zoom.next(MIN_ZOOM_LEVEL);\n        this.center.next(CENTER_POINT);\n        this.focusedRoom.next(undefined);\n    }\n\n    public collapse() {\n        this.handleExpand.emit(false);\n        const self = this;\n        self.count = 0;\n\n        this.zoom.next(MAX_ZOOM_LEVEL);\n        this.center.next(CENTER_POINT);\n        this.focusedRoom.next(undefined);\n\n        // Doesn't reliably zoom to room until that component is finished loading and processing elements.\n        this.setIntervalHandle = setInterval(() => {\n            self.zoomToRoom();\n            self.count ++;\n            if (self.count > 4) {\n                clearInterval(self.setIntervalHandle);\n                self.setIntervalHandle = null;\n            }\n        }, 200);\n    }\n\n    public displayOfficeInformation() {\n        this.dialog.open(OfficeInformationModalComponent,\n            {\n                data: this.building,\n                panelClass: 'mck-alert',\n                autoFocus: false,\n                backdropClass: 'mck-modal-backdrop',\n            });\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output,\n    OnInit,\n    OnChanges,\n    SimpleChanges,\n} from '@angular/core';\nimport { BookingFormData, RoomResultsViewModel, setupRoomImages, User } from '@mckinsey-converge/data-common';\nimport { ImageDirective, SpaceImageObject } from '@mckinsey-converge/base';\n\n@Component({\n    selector: 'app-room-result-item',\n    template: `\n        <div class=\"mck-row result-container\" mat-ripple (click)=\"roomSelect.emit(viewModel)\"\n            [ngClass]=\"{ 'result-container-bookable': availability === 'bookable' && hasData(), 'result-container-requestable': availability === 'requestable' && hasData() }\">\n            <div>\n                <div class=\"mck-row\">\n                    <div class=\"room-request-label\" *ngIf=\"hasData()\" [ngClass]=\"{ 'bookable': availability === 'bookable', 'requestable': availability ===  'requestable' }\">\n                        {{ availability ===  'requestable' ? 'Requestable' : 'Bookable'}}\n                        <span *ngIf=\"data.is_recurrent\">{{ viewModel?.space?.availableOccurrences }} out of {{ viewModel?.space?.totalOccurrences }} </span>\n                    </div>\n                    <div class=\"mck-column mck-center placeholder-image\">\n                        <div class=\"desktop-cell\" *ngIf=\"hasData()\"\n                        [ngStyle]=\"{\n                            'background-image': showLabel(foundImages[0].path) ? 'linear-gradient(0deg, rgba(2,0,36,1) 0%, rgba(0,0,0,1) 22%, rgba(0,0,0,0) 100%), url(' + foundImages[0].path + ')' : 'url(' + foundImages[0].path +')'\n                        }\">\n                            <span *ngIf=\"showLabel(foundImages[0].path)\">Images Coming Soon</span>\n                        </div>\n                        <ngx-skeleton-loader\n                            class=\"mck-skeleton-image\"\n                            *ngIf=\"!hasData()\"></ngx-skeleton-loader>\n                    </div>\n                    <div class=\"mck-column mck-center placeholder-image placeholder-image-desktop\">\n                        <div class=\"desktop-cell\" *ngIf=\"hasData()\"\n                            [ngStyle]=\"{\n                            'background-image': showLabel(foundImages[1].path) ? 'linear-gradient(0deg, rgba(2,0,36,1) 0%, rgba(0,0,0,1) 22%, rgba(0,0,0,0) 100%), url(' + foundImages[1].path + ')' : 'url(' + foundImages[1].path +')'\n                        }\">\n                            <span *ngIf=\"showLabel(foundImages[1].path)\">Images Coming Soon</span>\n                        </div>\n                        <ngx-skeleton-loader\n                            class=\"mck-skeleton-image\"\n                            *ngIf=\"!hasData()\"></ngx-skeleton-loader>\n                    </div>\n                </div>\n            </div>\n            <div class=\"mck-column mck-stretch result-container-content-container\">\n                <ng-container *ngIf=\"hasData()\">\n                    <span>{{viewModel.levelDisplay}}, <b>{{viewModel.title}}</b></span>\n                    <span class=\"type-text\" [ngClass]=\"typeClass\">{{type}}</span>\n                    <span *ngIf=\"viewModel.office\">{{viewModel.office}}</span>\n                    <span *ngIf=\"viewModel.capacity\">{{viewModel.capacity}}</span>\n                </ng-container>\n                <ng-container *ngIf=\"!hasData()\">\n                    <ngx-skeleton-loader class=\"mck-skeleton-line-1\"></ngx-skeleton-loader>\n                    <ngx-skeleton-loader class=\"mck-skeleton-line-2\"></ngx-skeleton-loader>\n                    <ngx-skeleton-loader class=\"mck-skeleton-line-3\"></ngx-skeleton-loader>\n                </ng-container>\n            </div>\n            <div class=\"mck-column mck-center\" *ngIf=\"hasData()\">\n                <div class=\"right-arrow\" alt=\"Right Arrow\" aria-label=\"Details Arrow\">\n                </div>\n            </div>\n        </div>\n    `,\n    styleUrls: ['./room-result-item.component.scss']\n})\nexport class RoomResultItemComponent extends ImageDirective implements OnInit, OnChanges {\n\n    public rootFolderURL: string = 'assets/img/rooms/';\n    public fileSlug: string = '';\n    public type: string = '';\n\n    /**\n     * If undefined, we display in loading state.\n     */\n    @Input()\n    public viewModel: RoomResultsViewModel | undefined;\n\n    @Input()\n    public data: BookingFormData;\n\n    @Input()\n    public user: User;\n\n    @Output()\n    public roomSelect = new EventEmitter<RoomResultsViewModel>();\n\n    public availability: \"requestable\" | \"bookable\" | \"booked\" | \"non-bookable\" | null;\n\n    public foundImages: SpaceImageObject[] = [1,2].map(n => {\n        return {path: `assets/img/rooms/placeholder-${n}.png`};\n    });\n\n    public ngOnInit(): void {\n        if (this.viewModel && this.viewModel.space) {\n            this.fileSlug = this.viewModel.space.email.split('@')[0];\n            setupRoomImages(this, [1,2], this.rootFolderURL, this.fileSlug);\n            const t = this.viewModel.space.internal_or_external;// || 'internal';\n            this.type = `${t[0]?.toUpperCase()}${t.toLocaleLowerCase().substring(1)}`\n        }\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (this.availability !== null && (\n            changes.data &&\n            changes.data.firstChange === true &&\n            changes.data.currentValue &&\n            changes.data.currentValue.dateTz &&\n            changes.data.currentValue.duration\n        )) {\n            this.availability = this.viewModel.space.byRequest({\n                dateTz: this.data.dateTz,\n                duration: this.data.duration,\n                host: this.user\n            }) === false ? \"bookable\" : \"requestable\";\n\n        }\n    }\n\n    public hasData() {\n        return this.viewModel !== undefined;\n    }\n\n    public get typeClass() {\n        return this.type.toLocaleLowerCase();\n    }\n\n    public showLabel(path) {\n        return path.includes('placeholder');\n    }\n    public get timestamp () {\n        return (new Date()).getTime()\n    }\n}\n","import {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    EventEmitter,\n    Input,\n    OnInit,\n    Output,\n    ViewContainerRef\n} from '@angular/core';\nimport {\n    select,\n    Store\n} from '@ngrx/store';\nimport {\n    ActivatedRoute,\n    Router\n} from '@angular/router';\nimport {\n    BehaviorSubject,\n    combineLatest,\n    Observable\n} from 'rxjs';\nimport {\n    RoomResultsViewModel,\n    BookingFormData,\n    BookingStoreState,\n    selectActiveForm,\n    storeBookingFormData,\n    SpaceFilterReason,\n    User,\n    OrganisationService,\n} from '@mckinsey-converge/data-common';\nimport {\n    map,\n    take,\n    distinctUntilChanged\n} from 'rxjs/operators';\nimport {\n    AlertBannerDisplay,\n    AlertMode,\n    BaseTemplateComponent,\n    ConflictsModalComponent,\n    ConflictsModalComponentData,\n\t\tOverrideChangesModalComponent\n} from '@mckinsey-converge/ui';\nimport { RoomResultsCoachmarkViewmodel } from 'src/app/booking/room-results/room-results-coachmark.viewmodel';\nimport {\n    RoomStoreState\n} from '@mckinsey-converge/rooms';\nimport {\n    BuildingStoreState,\n} from '@mckinsey-converge/buildings';\nimport { selectCurrentUser, UserStoreState } from '@mckinsey-converge/user';\nimport { MatDialog } from '@angular/material/dialog';\nimport { DialogEvent } from '@mckinsey-converge/base';\n\n\nexport type RoomResultsState = BookingStoreState\n    & RoomStoreState\n    & BuildingStoreState\n    & UserStoreState;\n\n@Component({\n    selector: 'app-room-results-paginated',\n    template: `\n        <ng-template>\n            <div class=\"mck-row mck-center\">\n                <div class=\"mck-content-body mck-column mck-content-expand expanded-content\">\n                    <ng-container *ngFor=\"let c of [coachMark | async]\">\n                        <ng-container *ngIf=\"(isLoading | async) === false && c && c.visible\">\n                            <mck-alert-banner\n                                [display]=\"AlertBannerDisplay.V2\"\n                                [showClose]=\"false\"\n                                [mode]=\"AlertMode.BlueCoachmark\"\n                                [message]=\"c.title\"\n                                [buttonText]=\"c.actionButtonText\"\n                                (action)=\"coachMarkAction.next(c.reason)\"\n                            >\n                            </mck-alert-banner>\n                            <mck-informational-image\n                                src=\"assets/img/booking-coachmark-no-results.svg\"></mck-informational-image>\n                        </ng-container>\n                    </ng-container>\n                    <ng-container *ngIf=\"!isLoading || (isLoading | async) === false && (displayViewModels | async)?.length\" >\n                        <app-room-result-item\n                            *ngFor=\"let result of (displayViewModels | async); trackBy: trackViewModelById\"\n                            [viewModel]=\"result\"\n                            [data]=\"data | async\"\n                            [user]=\"currentUser\"\n                            (roomSelect)=\"roomSelected($event)\"></app-room-result-item>\n\n                        <div class=\"mck-column mck-center\">\n                            <button mat-button color=\"primary\"\n                                    class=\"mck-primary-button load-more-button\"\n                                    (click)=\"loadMore()\"\n                                    *ngIf=\"showLoadMore | async\">\n                                Load more ({{remainingResults | async}})\n                            </button>\n                        </div>\n                    </ng-container>\n                    <ng-container *ngIf=\"(isLoading && (isLoading | async) === true) && !(displayViewModels | async)?.length\" >\n                        <app-room-result-item *ngFor=\"let i of [0, 1, 2]\">\n                        </app-room-result-item>\n                        <div class=\"mck-column mck-center\">\n                            <ngx-skeleton-loader class=\"mck-skeleton-load-more\"></ngx-skeleton-loader>\n                        </div>\n                    </ng-container>\n                </div>\n            </div>\n        </ng-template>\n    `,\n    styleUrls: ['./room-results-paginated.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class RoomResultsPaginatedComponent extends BaseTemplateComponent implements OnInit {\n    public ROOM_DISPLAY_STEP = 10;\n    public ROOM_DISPLAY_START = 3;\n    public AlertMode = AlertMode;\n    public AlertBannerDisplay = AlertBannerDisplay;\n    /** Offset to add to the start time when selecting a space */\n    @Input() public offset = 0;\n\n    @Input()\n    public viewModels: Observable<RoomResultsViewModel[] | undefined>;\n\n    @Input()\n    public coachMark: Observable<RoomResultsCoachmarkViewmodel> | undefined;\n\n    /**\n     * If true, show skeleton.\n     */\n    @Input()\n    public isLoading: Observable<boolean>;\n\n    @Output()\n    public coachMarkAction = new EventEmitter<SpaceFilterReason>();\n\n    public displayCount = new BehaviorSubject(this.ROOM_DISPLAY_START);\n\n    /**\n     * Fake pagination since API does not support it.\n     */\n    public displayViewModels: Observable<RoomResultsViewModel[] | undefined>;\n\n    public showLoadMore: Observable<boolean>;\n\n    public remainingResults: Observable<number>;\n\n    public data = new BehaviorSubject<BookingFormData | undefined>(undefined);\n    public currentUser: User;\n\n    constructor(vcRef: ViewContainerRef,\n        private store: Store<RoomResultsState>,\n        private router: Router,\n        private route: ActivatedRoute,\n        private _org: OrganisationService,\n        private cdRef: ChangeDetectorRef,\n        private _dialog: MatDialog) {\n        super(vcRef);\n    }\n\n    public ngOnInit(): void {\n        super.ngOnInit();\n        //test commet for to trigger build again\n        this.displayViewModels = combineLatest([this.viewModels, this.displayCount])\n            .pipe(\n                map(([vm, displayCount]) => { this.cdRef.markForCheck(); return vm?.slice(0, displayCount) } ));\n\n        this.showLoadMore = combineLatest([this.viewModels, this.displayCount])\n            .pipe(\n                map(([vm, displayCount]) => {\n                    return ((vm?.length ?? 0) > displayCount);\n                })\n            );\n        this.remainingResults = combineLatest([this.viewModels, this.displayCount])\n            .pipe(\n                map(([vm, displayCount]) => vm && (vm.length - displayCount) || 0));\n\n        this.subscription('currentUser', this.store.select(selectCurrentUser)\n            .pipe(take(1))\n            .subscribe((user: User | undefined) => {\n                // Once we know we have the user loaded.\n                this.currentUser = new User(user);\n            })\n        );\n\n        this.subscription('activeForm', this.store.pipe(\n            select(selectActiveForm),\n            distinctUntilChanged()\n        ).subscribe((next: BookingFormData | undefined) => {\n            if (next) {\n                this.data.next(next);\n                this.cdRef.detectChanges();\n\n            }\n        }));\n        this.cdRef.detectChanges();\n    }\n\n    public loadMore() {\n        // fake pagination\n        this.displayCount.pipe(\n            take(1),\n            map(v => v + this.ROOM_DISPLAY_STEP)\n        ).subscribe(next => {\n            this.displayCount.next(next);\n            this.cdRef.detectChanges();\n        });\n    }\n\n    public trackViewModelById(index: number, item: RoomResultsViewModel) {\n        return item.space.id;\n    }\n\n\n\t\t/**\n\t\t * Handles the selection of a room from the search results.\n\t\t * Depending on the room's availability and recurrence conflicts, this function decides\n\t\t * whether to open a modal for recurrence conflicts, override changes, or navigate to the\n\t\t * room details page. It updates the state and user interface accordingly.\n\t\t *\n\t\t * @param {RoomResultsViewModel} room - The selected room from the search results.\n\t\t * @param {number} availableOccurrences - The number of available occurrences of the room.\n\t\t * @param {number} totalOccurrences - The total number of occurrences of the room.\n\t\t */\n    public roomSelected(room: RoomResultsViewModel, availableOccurrences: number, totalOccurrences: number) {\n\n        const { is_recurrent } = this.data.value;\n        this.data.value.recurrence_exceptions = [];\n        if(is_recurrent){\n\t\t\t\t\t// Handle recurrence conflicts if the booking is part of a recurring series\n\t\t\t\t\tconst spaceConflicts = room.space.recurrence_availability.filter(recurr => !recurr.available);\n\t\t\t\t\tthis.data.value.recurrence_exceptions = spaceConflicts.map((recurr)=> recurr.date);\n        }\n\n\t\t\t\t// Determine the action based on recurrence conflicts, occurrence edits, and room availability\n\t\t\t\tif(this.data.value.recurrence_exceptions.length) {\n            this.openRecurrenceConflictsModal(room);\t// Open modal for recurrence conflicts\n        }\n\t\t\t\telse if( this.data.value.occurrence_edits && this.data.value.occurrence_edits.length) {\n\t\t\t\t\tthis.overrideChanges(room);\t// Open modal to override changes\n\t\t\t }\n        else {\n            this.goToRoomDetail(room);\t// Navigate to the room details page\n        }\n\n    }\n\n\t\t/**\n\t\t * Navigates to the room details page for the selected room.\n\t\t * It updates the URL and navigates to the room details page with appropriate query parameters.\n\t\t *\n\t\t * @param {RoomResultsViewModel} room - The selected room from the search results.\n\t\t *\n\t\t * @remarks\n\t\t * The function manages timezone offset and other necessary details to provide accurate room information.\n\t\t * The state object is used to pass relevant data for correct page rendering and form population.\n\t\t *\n\t\t * @private\n\t\t */\n    private goToRoomDetail(room) {\n\t\t\t// Handle timezone offset for accurate date and time information\n        let { dateTz } = this.data.value;\n        if (this.offset) {\n            dateTz = dateTz.addValue({ minutes: this.offset });\n        }\n\n         /**\n         * selectedRoom.space is fully fledged Space class\n         * this.data.value.booking.room is not and does not contain the timezone\n         * this.data.value.booking.timezone is legit\n         */\n        // UPDATE: providing payload as part of extras instead dispatching storeBookingFormData event to avoid redundant backend request calls\n        this.router.navigate(['room'],  { relativeTo: this.route, state:{payload : {\n            ...this.data.value,\n            buildings: this._org.buildings, // require to manage browser refresh on room detail screen!\n            dateTz,\n            offset: this.offset,\n            selectedRoom: room\n        }\n    }});\n    }\n\n\n  /**\n\t * Opens a modal to display recurrence conflicts for the selected room.\n\t * It shows recurrence conflicts, allowing the user to resolve them before proceeding.\n\t * After the modal is closed, it navigates to the room details page if there are no unresolved conflicts.\n\t *\n\t * @param {RoomResultsViewModel} room - The selected room from the search results.\n\t *\n\t * @private\n\t */\n  private openRecurrenceConflictsModal(room: RoomResultsViewModel) {\n    let {  recurrence_exceptions } = this.data.value;\n\n\t\t// Open modal for recurrence conflicts\n    const recurr_ref = this._dialog.open<ConflictsModalComponent, ConflictsModalComponentData>(ConflictsModalComponent, {\n      maxWidth: '95vw',\n      width: '32em',\n      data: {\n        room_name: room.space.simple_name,\n        conflicts: recurrence_exceptions,\n        timezone: room.building.timezone\n      }\n    });\n    this.subscription(\n      'conflicts_modal_events',\n      recurr_ref.componentInstance.event.subscribe((event: DialogEvent) => {\n\n\t\t\t\tif (event.reason === 'done' && !(this.data.value.occurrence_edits && !this.data.value.occurrence_edits.length) ) {\n\t\t\t\t\t\tthis.goToRoomDetail(room); \t// Navigate to room details page after resolving conflicts\n\t\t\t\t}\n        recurr_ref.close();\n      })\n    );\n    recurr_ref.afterClosed().subscribe(() => this.unsub('conflicts_modal_events'));\n  }\n\n\t/**\n\t * Opens a modal to allow the user to override changes made to the booking.\n\t * It provides options to confirm or cancel the override, depending on user preference.\n\t * After the modal is closed, it navigates to the room details page if the user confirms the override.\n\t *\n\t * @param {RoomResultsViewModel} room - The selected room from the search results.\n\t *\n\t * @private\n\t */\n  private overrideChanges(room: RoomResultsViewModel) {\n\t\t// Open modal for overriding changes made to the booking\n    const ref = this._dialog.open<OverrideChangesModalComponent>(OverrideChangesModalComponent, {\n        width: '576px',\n        data: {\n          edits: this.data.value.occurrence_edits,\n          timezone: this.data.value.timezone\n        }\n    });\n    ref.componentInstance.event.subscribe(event => {\n      if (event.reason === 'done') {\n        this.goToRoomDetail(room);\t// Navigate to room details page after confirming the override\n        ref.close();\n      } else if (event.reason === 'close') {\n        ref.close();\n      }\n    });\n  }\n\n\n\n\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    OnInit,\n    Output,\n    SimpleChanges,\n    ViewEncapsulation,\n} from '@angular/core';\nimport { BehaviorSubject, combineLatest, Observable, of, Subject } from 'rxjs';\nimport { LoadingModel } from '@mckinsey-converge/loading';\nimport { distinctUntilChanged, filter, map } from 'rxjs/operators';\nimport { BookingRulesLink, RoomResultsCoachmarkViewmodel } from 'src/app/booking/room-results/room-results-coachmark.viewmodel';\nimport {\n    Building,\n    BuildingLevel,\n    mapResultsToViewModels,\n    RoomResultsViewModel,\n    FilteredSpaces,\n    SpaceFilterReason,\n    selectActiveForm,\n    BookingStoreState,\n    BookingFormData,\n    OrganisationService,\n} from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { select, Store } from '@ngrx/store';\nimport { RoomStoreState } from '@mckinsey-converge/rooms';\nimport {\n    BuildingStoreState,\n} from '@mckinsey-converge/buildings';\nimport { UserStoreState } from '@mckinsey-converge/user';\n\n\nexport type RoomResultsState = BookingStoreState &\n    RoomStoreState &\n    BuildingStoreState &\n    UserStoreState;\n\n\n@Component({\n    selector: 'app-room-results-section',\n    template: `\n        <div *ngIf=\"!collapsable\" class=\"mck-content-expand-width main-results-container\">\n            <ng-container *ngTemplateOutlet=\"pagination\"></ng-container>\n        </div>\n\n        <mck-collapse-header\n            *ngIf=\"collapsable\"\n            [isLoading]=\"resultsLoading | async\"\n            title=\"{{ collapseTitle }}\"\n            description=\"{{ collapseDescription }}\"\n        >\n            <ng-container [ngTemplateOutlet]=\"pagination\"></ng-container>\n        </mck-collapse-header>\n\n        <ng-template #pagination>\n            <app-room-results-paginated\n                [isLoading]=\"resultsLoading\"\n                [viewModels]=\"mainResultViewModels\"\n                [coachMark]=\"coachMarkDisplay\"\n                [offset]=\"offset\"\n                (coachMarkAction)=\"onCoachmarkAction($event)\"\n            >\n            </app-room-results-paginated>\n        </ng-template>\n    `,\n    styleUrls: ['./room-results-section.component.scss'],\n    encapsulation: ViewEncapsulation.Emulated,\n})\nexport class RoomResultsSectionComponent extends BaseDirective implements OnInit {\n    @Input() public rules_link?: BookingRulesLink;\n    /** Offset to add to the start time when selecting a space */\n    @Input() public offset = 0;\n\n    @Input()\n    public collapsable: boolean;\n\n    /**\n     * If collapsable is true, this is used in the collapse header.\n     */\n    @Input()\n    public collapseTitle: string;\n\n    /**\n     * If collapsable is true, this is used in the collapse header.\n     */\n    @Input()\n    public collapseDescription: string;\n\n    @Input()\n    public levelBuildings: Observable<{ flattenedLevels: BuildingLevel[]; buildings: Building[] }>;\n\n    @Input()\n    public results: BehaviorSubject<LoadingModel<FilteredSpaces>>;\n\n    @Output()\n    public coachMarkAction = new EventEmitter<SpaceFilterReason>();\n\n    public mainResultViewModels = new BehaviorSubject<RoomResultsViewModel[] | undefined>(\n        undefined\n    );\n\n    public editing_form = new BehaviorSubject(false);\n\n    public resultsLoading: Observable<boolean>;\n    public coachMarkDisplay: Observable<RoomResultsCoachmarkViewmodel>;\n\n    public AlternateBuildings = [];\n    public location: any;\n\n    private subscribeResultsToViewModels = (\n        subName: string,\n        resultsObservable: Observable<LoadingModel<FilteredSpaces>>,\n        flattenLevelBuildings: Observable<{ flattenedLevels: any; buildings: Building[] }>,\n        viewModelSubject: Subject<RoomResultsViewModel[]>\n    ) => {\n        this.subscription(\n            subName,\n            combineLatest([\n                resultsObservable.pipe(map((r) => r.optionalSuccess?.spaces || [])),\n                flattenLevelBuildings,\n            ])\n                .pipe(\n                    map(([results, { flattenedLevels, buildings }]) =>\n                        mapResultsToViewModels(\n                            results?.length && results[0]?.building ? results : [],\n                            flattenedLevels,\n                            buildings\n                        )\n                    )\n                )\n                .subscribe((next) => {\n                    viewModelSubject.next(next);\n                })\n        );\n    };\n\n    constructor(private store: Store<RoomResultsState>, private _org: OrganisationService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.resultsLoading = this.results.pipe(map((m) => m.isLoading));\n\n        this.subscription(\n            'activeForm',\n            combineLatest([this.editing_form, this.store])\n                .pipe(\n                    filter(([edit]) => !edit),\n                    map(([_, store]) => store),\n                    select(selectActiveForm),\n                    distinctUntilChanged()\n                )\n                .subscribe((next: BookingFormData | undefined) => {\n                    if (next) {\n                        this.location = next.location;\n                        this.updateCoachMark();\n                    } else {\n                    }\n                })\n        );\n\n        this.subscription(\n            'buildings',\n            this._org.listen('buildings').subscribe(() => {\n                this.updateCoachMark();\n            })\n        );\n\n        this.coachMarkDisplay = this.results.pipe(\n            map((r) => r.optionalSuccess?.reason || SpaceFilterReason.None),\n            map(\n                (r) =>\n                    new RoomResultsCoachmarkViewmodel(r, this.rules_link, this.AlternateBuildings)\n            )\n        );\n\n        this.subscribeResultsToViewModels(\n            'resultListing',\n            this.results,\n            this.levelBuildings || of({ flattenedLevels: [], buildings: [] }),\n            this.mainResultViewModels\n        );\n    }\n\n    updateCoachMark() {\n        const buildingsInSameCity = this._org.buildings?.filter(_ => {\n            // Make sure this.location is populated to pass unit tests -\n            if (!this.location || this.location.length === 0) return false;\n            // If all offices are selected, city name will be at this.location[0]?.meta?.city.name, otherwise use this.location[0]?.meta?.city \n            const cityFromLocation = typeof this.location[0]?.meta?.city === 'object' && this.location[0]?.meta?.city !== null\n                ? this.location[0]?.meta?.city.name\n                : this.location[0]?.meta?.city;\n            return _.city === cityFromLocation;\n        });\n        const AlternateBuildings = buildingsInSameCity?.filter(\n            (building) =>\n                !this.location.some(\n                    (locationItem) => locationItem.meta?.building?.id === building.id\n                )\n        );\n        this.AlternateBuildings = AlternateBuildings;\n        this.coachMarkDisplay = this.results.pipe(\n            map((r) => r.optionalSuccess?.reason || SpaceFilterReason.None),\n            map(\n                (r) =>\n                    new RoomResultsCoachmarkViewmodel(r, this.rules_link, this.AlternateBuildings)\n            )\n        );\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.results || changes.levelBuildings || changes.mainResultViewModels) {\n            this.subscribeResultsToViewModels(\n                'resultListing',\n                this.results,\n                this.levelBuildings || of({ flattenedLevels: [], buildings: [] }),\n                this.mainResultViewModels\n            );\n        }\n    }\n\n    public onCoachmarkAction(reason: SpaceFilterReason) {\n        this.coachMarkAction.emit(reason);\n    }\n}\n","import { SpaceFilterReason } from '@mckinsey-converge/data-common';\n\nexport interface BookingRulesLink {\n    name: string;\n    url: string;\n}\nexport class RoomResultsCoachmarkViewmodel {\n    public visible: boolean;\n    public title: string;\n    public actionButtonText: string;\n\n    constructor(public reason: SpaceFilterReason, public rules_link?: BookingRulesLink, alternateBuildings?:any[]) {\n        this.visible = true;\n        switch (reason) {\n            case SpaceFilterReason.DateTime:\n                this.title =\n                'There are no available rooms that match your search criteria. ' +\n                'Please adjust your search criteria and try again.';\n                this.actionButtonText = 'Return to search';\n                break;\n            case SpaceFilterReason.OfficeRules:\n                this.title =\n                    `There are no available rooms that match your search criteria.\n                    Please adjust your search criteria and try again.`;\n                if (alternateBuildings && alternateBuildings.length > 0) {\n                    this.title += ` Alternatively, you can try ${alternateBuildings.length > 1 \n                        ? alternateBuildings.slice(0, -1).map(building => building.name).join(', ') + ', or ' + alternateBuildings[alternateBuildings.length - 1].name \n                        : alternateBuildings[0]?.name\n                    }.`;\n                }\n                if (rules_link) {\n                    this.title +=\n                        `<br/>For information on booking rules please see ` +\n                        `<a href=\"${rules_link.url}\" target=\"_blank\" rel=\"noopener noreferer\">${rules_link.name}</a>`;\n                }\n                this.actionButtonText = 'Return to search';\n                break;\n            case SpaceFilterReason.Filters:\n                this.title =\n                    'No rooms available for your filter criteria. ' +\n                    'Try to clear the filter please.';\n                this.actionButtonText = 'Clear filter';\n                break;\n            case SpaceFilterReason.AlternateBuildingsFound:\n                this.title = `There are no available rooms that match your search criteria. Please try ${\n                    alternateBuildings.length > 1 \n                    ? alternateBuildings.slice(0, -1).map(building => building.name).join(', ') + ', or ' + alternateBuildings[alternateBuildings.length - 1].name \n                    : alternateBuildings[0]?.name\n                }.`;\n                this.actionButtonText = 'Return to search';\n                break;\n            case SpaceFilterReason.None:\n                this.visible = false;\n                this.title = '';\n                this.actionButtonText = '';\n                break;\n        }\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { TopBarHeaderMode } from 'src/app/components/topbar-header/topbar-header.component';\nimport { select, Store } from '@ngrx/store';\nimport {\n    laterThatDayFromDateTz,\n    loadRoomsWithQuery,\n    RoomStoreState,\n    mapRoomToSelectOption,\n    loadRoomsForResultsMap,\n} from '@mckinsey-converge/rooms';\nimport { BaseDirective, timeWithZoneFormatString } from '@mckinsey-converge/base';\nimport { BehaviorSubject, combineLatest, Observable } from 'rxjs';\nimport {\n    Building,\n    BuildingLevel,\n    flattenBuildingsWithLevels,\n    BookingStoreState,\n    FilteredSpaces,\n    SpaceFilterReason,\n    clearRoomFilters,\n    selectActiveForm,\n    selectFilteredLaterDayResults,\n    selectFilteredNextDayResults,\n    selectFilteredResults,\n    selectFormFilters,\n    BookingFormData,\n    roomFormDataToQuery,\n    selectFilteredDiffSizeResults,\n    OrganisationService,\n} from '@mckinsey-converge/data-common';\nimport { LoadingModel } from '@mckinsey-converge/loading';\nimport { debounceTime, distinctUntilChanged, filter, map, shareReplay } from 'rxjs/operators';\nimport {\n    buildingStateSelector,\n    BuildingStoreState,\n    loadBuildings,\n} from '@mckinsey-converge/buildings';\nimport * as cloneDeep from 'lodash/cloneDeep';\nimport { filterUndefined, resultCountObservable } from '@mckinsey-converge/rx-utils';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { MatDialog } from '@angular/material/dialog';\nimport { RoomBookingModalComponent } from 'src/app/booking/room-booking-modal/room-booking-modal.component';\nimport { RoomFiltersModalComponent } from 'src/app/booking/room-filters-modal/room-filters-modal.component';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { trigger, state, style, transition, animate } from '@angular/animations';\nimport {\n    BookingRulesLink,\n    RoomResultsCoachmarkViewmodel,\n} from 'src/app/booking/room-results/room-results-coachmark.viewmodel';\nimport { UserStoreState } from '@mckinsey-converge/user';\nimport { FormControl } from '@angular/forms';\nimport { Location } from '@angular/common';\n\nexport type RoomResultsState = BookingStoreState &\n    RoomStoreState &\n    BuildingStoreState &\n    UserStoreState;\n\n@Component({\n    selector: 'app-room-results',\n    template: `\n        <div\n            class=\"mck-column mck-content-expand mck-content-page-container \"\n            *ngIf=\"!this?.payload?.floorMap\"\n        >\n            <header class=\"header\">\n                <a-topbar-header [mode]=\"TopBarHeaderMode.Light\"> </a-topbar-header>\n            </header>\n            <div class=\"mck-column mck-scroll mb-block\">\n                <div [@collapseHeight]=\"isOpen ? 'open' : 'closed'\">\n                    <div class=\"header-container mck-center\">\n                        <div class=\"mck-content-body hideable\" [class.open]=\"open\">\n                            <app-searched-location\n                                [filters]=\"filters | async\"\n                                [data]=\"data | async\"\n                                (changeClick)=\"changeSearchResults()\"\n                                (filterClick)=\"filterResults()\"\n                                [canFilter]=\"(selectedToggle | async) === 0\"\n                            ></app-searched-location>\n                        </div>\n                        <div class=\"tap\" (click)=\"open = !open\">\n                            <div>\n                                {{ open ? '(tap to close)' : '(tap to open)' }}\n                                <img src=\"assets/icon/minimize-bar.svg\" [class.open]=\"open\" />\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"mck-center\">\n                        <div class=\"mck-content-body results-header\">\n                            <app-results-header\n                                (selectedToggleChange)=\"selectedToggleChange($event)\"\n                                [resultsCount]=\"mainResultsCount | async\"\n                            >\n                            </app-results-header>\n                        </div>\n                    </div>\n                </div>\n                <div\n                    class=\"mck-column mck-center results-container mb-block\"\n                    *ngIf=\"(selectedToggle | async) === 0\"\n                >\n                    <div class=\"mck-content-expand-width\">\n                        <div class=\"mck-column map-filters-container\">\n                            <div class=\"mck-row-flow search-input-container\">\n                                <mck-autocomplete-select-option\n                                    [selectedValue]=\"selectedSpace\"\n                                    [resetInput]=\"resetInput\"\n                                    noEntriesFoundLabel=\"There are no rooms for your current search.\"\n                                    placeholder=\"Type to search (level, number or name) ...\"\n                                    [options]=\"mainResultsSpaces\"\n                                    [formControl]=\"spaceControl\"\n                                    (inputTextChange)=\"inputTextChange($event)\"\n                                    (filteredOptionsChange)=\"filteredRoomsChange($event)\"\n                                    (emptyBoxEvent)=\"changeInput($event)\"\n                                ></mck-autocomplete-select-option>\n                                <button\n                                    *ngIf=\"searchStringPresent\"\n                                    (click)=\"clearRoomSearch()\"\n                                    class=\"close-button mck-short mck-short-height mck-form-input\"\n                                >\n                                    <div class=\"close-button-icon\"></div>\n                                </button>\n                                <button\n                                    class=\"search-button mck-short mck-short-height mck-form-input\"\n                                >\n                                    <div class=\"search-button-icon\"></div>\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                    <div\n                        class=\"mck-column results-container-list mck-content-expand-width mck-content-body\"\n                        #resultsContainer\n                    >\n                        <app-room-results-section\n                            [results]=\"mainResultsFiltered\"\n                            [collapsable]=\"false\"\n                            [rules_link]=\"rules_link\"\n                            [levelBuildings]=\"flattenLevelBuildings\"\n                            (coachMarkAction)=\"onCoachmarkAction($event)\"\n                        >\n                        </app-room-results-section>\n                        <app-room-results-section\n                            [results]=\"diffSizeResults\"\n                            [collapsable]=\"true\"\n                            [rules_link]=\"rules_link\"\n                            [levelBuildings]=\"flattenLevelBuildings\"\n                            collapseTitle=\"Available in a different room size ({{\n                                diffSizeCount | async\n                            }})\"\n                            (coachMarkAction)=\"onCoachmarkAction($event)\"\n                        >\n                        </app-room-results-section>\n                        <app-room-results-section\n                            [results]=\"laterThatDayResults\"\n                            [collapsable]=\"true\"\n                            [rules_link]=\"rules_link\"\n                            [levelBuildings]=\"flattenLevelBuildings\"\n                            collapseTitle=\"Available a bit later that day ({{\n                                laterThatDayCount | async\n                            }})\"\n                            collapseDescription=\"{{ laterThatDayDisplay | async }}\"\n                            [offset]=\"1 * 60\"\n                            (coachMarkAction)=\"onCoachmarkAction($event)\"\n                        >\n                        </app-room-results-section>\n                        <app-room-results-section\n                            [results]=\"nextBusinessDayResults\"\n                            [collapsable]=\"true\"\n                            [rules_link]=\"rules_link\"\n                            [levelBuildings]=\"flattenLevelBuildings\"\n                            collapseTitle=\"Available the next business day ({{\n                                nextBusinessDayCount | async\n                            }})\"\n                            [offset]=\"day_offset * 24 * 60\"\n                            (coachMarkAction)=\"onCoachmarkAction($event)\"\n                        >\n                        </app-room-results-section>\n                    </div>\n                </div>\n                <div\n                    class=\"mck-column mck-center results-container\"\n                    *ngIf=\"(selectedToggle | async) === 1\"\n                >\n                    <div\n                        class=\"results-container-map-container mck-content-body mck-content-expand-height\"\n                        [@expandWidth]=\"isOpen ? 'open' : 'closed'\"\n                        >\n                        <div\n                            class=\"results-container-map mck-content-expand-width mck-content-body\"\n                            class=\"expand-width\"\n                        >\n                            <app-map-search\n                                [openHeader]=\"close\"\n                                (toggleEvent)=\"toggle()\"\n                            ></app-map-search>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `,\n    styleUrls: ['./room-results.component.scss'],\n    animations: [\n        trigger('collapseHeight', [\n            state(\n                'open',\n                style({\n                    height: '*',\n                    opacity: 1,\n                })\n            ),\n            state(\n                'closed',\n                style({\n                    overflow: 'hidden',\n                    opacity: 0,\n                    height: '0px',\n                })\n            ),\n            transition('open <=> closed', animate('600ms ease-out')),\n        ]),\n        trigger('expandWidth', [\n            state(\n                'open',\n                style({\n                    maxWidth: '1024px',\n                })\n            ),\n            state(\n                'closed',\n                style({\n                    maxWidth: '96%',\n                })\n            ),\n            transition('open <=> closed', animate('600ms ease-out')),\n        ]),\n    ],\n})\nexport class RoomResultsComponent extends BaseDirective implements OnInit {\n    public TopBarHeaderMode = TopBarHeaderMode;\n\n    public day_offset = 1;\n\n    public data = new BehaviorSubject<BookingFormData | undefined>(undefined);\n    public filters = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public mainResults = new BehaviorSubject<LoadingModel<FilteredSpaces>>(LoadingModel.empty());\n    public mainResultsFiltered = new BehaviorSubject<LoadingModel<FilteredSpaces>>(\n        LoadingModel.empty()\n    );\n    public laterThatDayResults = new BehaviorSubject<LoadingModel<FilteredSpaces>>(\n        LoadingModel.empty()\n    );\n    public nextBusinessDayResults = new BehaviorSubject<LoadingModel<FilteredSpaces>>(\n        LoadingModel.empty()\n    );\n    public diffSizeResults = new BehaviorSubject<LoadingModel<FilteredSpaces>>(\n        LoadingModel.empty()\n    );\n    public mainResultsSpaces: SelectOption<any>[];\n\n    public laterThatDayDisplay = new BehaviorSubject<string | undefined>(undefined);\n\n    public mainCoachMarkDisplay = this.mainResults.pipe(\n        map((r) => r.optionalSuccess?.reason || SpaceFilterReason.None),\n        map((r) => new RoomResultsCoachmarkViewmodel(r, this.rules_link))\n    );\n\n    public rules_link?: BookingRulesLink;\n\n    public mainResultsCount = resultCountObservable(\n        this.mainResultsFiltered,\n        this.mainResultsFiltered.pipe(map((r) => r.optionalSuccess?.spaces))\n    );\n    public laterThatDayCount = resultCountObservable(\n        this.laterThatDayResults,\n        this.laterThatDayResults.pipe(map((r) => r.optionalSuccess?.spaces))\n    );\n    public nextBusinessDayCount = resultCountObservable(\n        this.nextBusinessDayResults,\n        this.nextBusinessDayResults.pipe(map((r) => r.optionalSuccess?.spaces))\n    );\n    public diffSizeCount = resultCountObservable(\n        this.diffSizeResults,\n        this.diffSizeResults.pipe(map((r) => r.optionalSuccess?.spaces))\n    );\n\n    public selectedToggle = new BehaviorSubject<number>(0);\n\n    public flattenLevelBuildings: Observable<{\n        flattenedLevels: BuildingLevel[];\n        buildings: Building[];\n    }>;\n\n    public open: boolean = true;\n    public editing_form = new BehaviorSubject(false);\n\n    public spaceControl = new FormControl();\n\n    public selectedSpace: SelectOption<any>;\n    public resetInput: number;\n\n    public searchStringPresent = false;\n    public payload: any = {\n        payload: { name: 'test', id: 'test-id' },\n        building: {},\n        floorMap: true,\n    };\n\n    public isOpen = true;\n\n    public toggle() {\n        this.isOpen = !this.isOpen;\n    }\n\n    constructor(\n        private store: Store<RoomResultsState>,\n        private router: Router,\n        private route: ActivatedRoute,\n        private dialog: MatDialog,\n        private _org: OrganisationService,\n        private location: Location\n    ) {\n        super();\n        this.payload = location.getState();\n    }\n\n    public ngOnInit(): void {\n        this.subscription(\n            'filters',\n            this.store.pipe(select(selectFormFilters), distinctUntilChanged()).subscribe((next) => {\n                return this.filters.next(next);\n            })\n        );\n\n        this.subscription(\n            'activeForm',\n            combineLatest([this.editing_form, this.store])\n                .pipe(\n                    filter(([edit]) => !edit),\n                    map(([_, store]) => store),\n                    select(selectActiveForm),\n                    distinctUntilChanged()\n                )\n                .subscribe((next: BookingFormData | undefined) => {\n                    if (next) {\n                        const day = next.dateTz.dateWeekday - 1;\n                        this.day_offset = day >= 4 ? 7 - day : 1;\n                        const building = this._org.buildings.find(\n                            (_) => _.id === next.location[0]?.meta?.building?.id\n                        );\n                        this.rules_link =\n                        building?.setting('booking.rules_link') ||\n                        next.location.find(\n                            office => office?.meta?.building?._settings?.discovery_info?.booking?.rules_link\n                        )?.meta?.building?._settings?.discovery_info?.booking?.rules_link;\n                        // next.location[0]?.meta?.building?.settings?.discovery_info?.booking\n                        //     ?.rules_link;\n                        const nday = laterThatDayFromDateTz(next.dateTz);\n                        this.laterThatDayDisplay.next(`at ${timeWithZoneFormatString(nday)}`);\n                        this.store.dispatch(loadRoomsWithQuery(roomFormDataToQuery(next)));\n                        this.data.next(next);\n                    } else {\n                        //  no form data, likely visiting directly. navigate back to start\n                        this.router.navigate(['../'], {\n                            replaceUrl: true,\n                            relativeTo: this.route,\n                        });\n                    }\n                })\n        );\n\n        this.subscription(\n            'results',\n            this.store.pipe(select(selectFilteredResults)).subscribe((next) => {\n                this.mainResults.next(next);\n                this.mainResultsFiltered.next(next);\n                // Populate results for Search\n                this.mainResultsSpaces = next.success?.spaces\n                    ? next.success?.spaces?.map(mapRoomToSelectOption)\n                    : [];\n            })\n        );\n\n        this.subscription(\n            'laterResults',\n            this.store.pipe(select(selectFilteredLaterDayResults)).subscribe((next) => {\n                this.laterThatDayResults.next(next);\n            })\n        );\n\n        this.subscription(\n            'nextDayResults',\n            this.store.pipe(select(selectFilteredNextDayResults)).subscribe((next) => {\n                this.nextBusinessDayResults.next(next);\n            })\n        );\n\n        this.subscription(\n            'diffSize',\n            this.store.pipe(select(selectFilteredDiffSizeResults)).subscribe((next) => {\n                this.diffSizeResults.next(next);\n            })\n        );\n\n        this.flattenLevelBuildings = this.store.pipe(\n            select(buildingStateSelector),\n            select(loadBuildings.selectors.optionalSuccess),\n            filterUndefined(),\n            map(flattenBuildingsWithLevels),\n            shareReplay(1)\n        );\n\n        this.subscription(\n            'spaceChanges',\n            this.spaceControl.valueChanges.subscribe((value) => {\n                const mainResultsFiltered = cloneDeep(this.mainResults.value);\n                const filteredRooms = this.mainResults.value.success?.spaces?.filter((s) => {\n                    if (s.id === value.value) {\n                        return true;\n                    }\n                    return false;\n                });\n                mainResultsFiltered.success.spaces = filteredRooms;\n                this.mainResultsFiltered.next(mainResultsFiltered);\n            })\n        );\n\n        // if coming from kiosk map url, route there\n        if (this.payload?.floorMap) {\n            this.router.navigate([`../home/floor-map`], {\n                state: { ...this.payload },\n                queryParams: {\n                    display: '',\n                },\n            });\n        }\n\n        this.subscription(\n            'spaceChanges',\n            this.selectedToggle.subscribe((value) => {\n                value === 0 &&\n                    !this.payload?.floorMap &&\n                    this.store.dispatch(loadRoomsWithQuery(roomFormDataToQuery(this.data.value)));\n                (value === 1 || this.payload?.floorMap) &&\n                    this.store.dispatch(\n                        loadRoomsForResultsMap.request(roomFormDataToQuery(this.data.value))\n                    );\n            })\n        );\n    }\n\n    public clearRoomSearch() {\n        this.resetInput = Date.now();\n        this.selectedSpace = null;\n        const mainResults = cloneDeep(this.mainResults.value);\n        this.mainResultsFiltered.next(mainResults);\n        this.searchStringPresent = false;\n    }\n\n    public inputTextChange(event: any) {\n        this.searchStringPresent = !!event.length;\n    }\n\n    public changeInput(event) {\n        if (event) {\n            this.clearRoomSearch();\n        }\n    }\n\n    public filteredRoomsChange(event: SelectOption<any>[]) {\n        const roomIds = event.map((o) => o.value);\n        const mainResultsFiltered = cloneDeep(this.mainResults.value);\n        const filteredRooms = this.mainResults?.value?.success?.spaces\n            ? this.mainResults?.value?.success?.spaces?.filter((s) => {\n                  if (roomIds.includes(s.id)) {\n                      return true;\n                  }\n                  return false;\n              })\n            : [];\n        mainResultsFiltered.success.spaces = filteredRooms;\n        this.mainResultsFiltered.next(mainResultsFiltered);\n    }\n\n    public changeSearchResults() {\n        this.editing_form.next(true);\n        const dialog_ref = this.dialog.open(RoomBookingModalComponent, {\n            panelClass: 'mck-modal',\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n        dialog_ref.afterClosed().subscribe(() => this.editing_form.next(false));\n    }\n\n    public filterResults() {\n        this.dialog.open(RoomFiltersModalComponent, {\n            panelClass: 'mck-modal',\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n    }\n\n    public onCoachmarkAction(reason: SpaceFilterReason) {\n        switch (reason) {\n            case SpaceFilterReason.Filters:\n                this.store.dispatch(clearRoomFilters());\n                break;\n            case SpaceFilterReason.OfficeRules:\n            case SpaceFilterReason.DateTime:\n                this.changeSearchResults();\n                break;\n        }\n    }\n\n    public selectedToggleChange(event: SelectOption<any>) {\n        this.selectedToggle.next(event.value);\n    }\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    OnChanges,\n    OnInit,\n    Output,\n    SimpleChanges\n} from '@angular/core';\n\nimport {\n    humaniseDuration,\n    timeFormatString,\n    timeWithGmtOffsetFormatString,\n    weekDayMonthYearFormat\n} from '@mckinsey-converge/base';\nimport {\n    truncateLocationList,\n    BookingFormData,\n    getLastDateFromList\n} from '@mckinsey-converge/data-common';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { DateTZ } from '@mckinsey-converge/date-tz'\n\n@Component({\n    selector: 'app-searched-location',\n    template: `\n        <div class=\"mck-row search-location-container\">\n            <div class=\"mck-column search-location-content\">\n                <span>{{name}}</span>\n                <span>{{date}}</span>\n                <span>{{timing}}</span>\n                <span class=\"content-bottom\">{{types}}</span>\n                <span class=\"filters-empty\" *ngIf=\"!filterDisplay && canFilter\">No filters applied</span>\n                <span class=\"filters-unavailable\" *ngIf=\"!canFilter\">Filtering unavailable for this view</span>\n                <span class=\"filters\" *ngIf=\"filterDisplay\">{{filterDisplay}}</span>\n            </div>\n            <div class=\"mck-column mck-space-between\">\n                <button mat-stroked-button color=\"primary\"\n                        class=\"mck-stroked-button mck-short mck-column mck-center mck-primary\"\n                        (click)=\"changeClick.emit()\">\n                    Change\n                </button>\n                <button\n                    [disabled]=\"!canFilter\"\n                    mat-button class=\"mck-primary-button mck-short mck-column mck-center\"\n                    (click)=\"filterClick.emit()\">Filter {{filterCount}}\n                </button>\n            </div>\n        </div>\n    `,\n    styleUrls: ['./searched-location.component.scss']\n})\nexport class SearchedLocationComponent implements OnInit, OnChanges {\n\n    @Input()\n    public data: BookingFormData;\n\n    @Input()\n    public filters: SelectOption<any>[] = [];\n\n    @Output()\n    public changeClick = new EventEmitter();\n\n    @Output()\n    public filterClick = new EventEmitter();\n\n    @Input()\n    public canFilter = true;\n\n    public name = '';\n    public date = '';\n    public timing = '';\n    public types = '';\n    public filterDisplay = '';\n    public filterCount = '';\n\n    constructor() {\n    }\n\n    public ngOnChanges(changes: SimpleChanges): void {\n        if (changes.data || changes.filters) {\n            this.computeDisplay();\n        }\n    }\n\n    public ngOnInit(): void {\n        this.computeDisplay();\n    }\n\n\n    public computeDisplay() {\n        if (!this.data) {\n            return;\n        }\n        const { duration, dateTz, location, roomSize, bookingType, is_recurrent, recurrence_endTz } = this.data;\n\n       \n        // this.requestedEndDateTz =  new DateTZ({ date: endDate.date.valueOf(), is_local_tz, building_tz })\n\n        const group = location.find(l => l.groupHeader);\n        if (group) {\n            this.name = group.shortDisplay;\n        } else {\n            this.name = truncateLocationList(location);\n        }\n\n        // R--- blocked until TZ booking form inputs\n        const building_tz = location[0]?.meta?.building?.timezone || location[0]?.meta?.city?.timezone;\n        const startDate = new DateTZ({date: dateTz.ms, is_local_tz: false, building_tz })\n\n        if(is_recurrent) {\n            const occEndDate = getLastDateFromList( this?.data?.recurrence_starts );\n        \tconst endRecDate = new DateTZ({date: occEndDate.ms, is_local_tz: false, building_tz });\n          this.date = `From ${weekDayMonthYearFormat(startDate)} until ${weekDayMonthYearFormat(endRecDate)}` ;\n        }\n        else {\n            this.date = weekDayMonthYearFormat(startDate);\n        }\n\n        const startDisplay = startDate.formatDate(`${timeFormatString()}`).toLocaleLowerCase();\n        const endDate = startDate.addValue({ minutes: duration });\n        const endDisplay = timeWithGmtOffsetFormatString(endDate);\n        this.timing = `${startDisplay}-${endDisplay}`; // - TODO correct for DST?\n\n        const durationDisplay = humaniseDuration(duration, 'short');\n        this.types = `${durationDisplay}, ${bookingType.display}, ${roomSize.display}`;\n\n        this.filterDisplay = this.filters.map(f => f.shortDisplay).join(', ');\n        this.filterCount = this.filters.length > 0 ? `(${this.filters.length})` : '';\n    }\n}\n","import {\n    Component,\n    OnInit\n} from '@angular/core';\nimport { first } from 'rxjs/operators';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport {\n    ApplicationLink,\n    ApplicationService\n} from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-footer-menu',\n    templateUrl: './footer-menu.component.html',\n    styleUrls: ['./footer-menu.component.scss']\n})\nexport class FooterMenuComponent extends BaseDirective implements OnInit {\n\n    /** Tiles to display on the home page */\n    public tiles: ApplicationLink[] = [];\n\n    constructor(private _service: ApplicationService) {\n        super();\n    }\n\n    /** Angular Component initialisation lifecycle hook */\n    public ngOnInit(): void {\n        this._service.initialised.pipe(first(_ => _)).subscribe(() => {\n            this.tiles = this._service.setting('app.home.tiles') || [];\n        });\n    }\n}\n","<div class=\"footer-menu\" *ngIf=\"tiles && tiles.length\">\n    <ng-container *ngFor=\"let item of tiles\">\n        <a *ngIf=\"item.route\" [routerLink]=\"[item.route]\" routerLinkActive=\"active\">\n            <div class=\"tile\">\n                <div class=\"icon\">\n                    <app-icon [icon]=\"item.icon\"></app-icon>\n                </div>\n                <div class=\"text\">{{ item.name }}</div>\n            </div>\n        </a>\n        <a *ngIf=\"!item.route\" [href]=\"item.link | safe: 'url'\">\n            <div class=\"tile\">\n                <div class=\"icon\">\n                    <app-icon [icon]=\"item.icon\"></app-icon>\n                </div>\n                <div class=\"text\">{{ item.name }}</div>\n            </div>\n        </a>\n    </ng-container>\n</div>\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    OnInit,\n    Output\n} from '@angular/core';\nimport {\n    ActivatedRoute,\n    Router\n} from '@angular/router';\nimport { first } from 'rxjs/operators';\n\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport {\n    ApplicationService,\n    Building,\n    BuildingLevel,\n    OrganisationService\n} from '@mckinsey-converge/data-common';\n\n@Component({\n    selector: 'a-map-controls',\n    templateUrl: './map-controls.component.html',\n    styleUrls: ['./map-controls.component.scss']\n})\nexport class MapControlsComponent extends BaseDirective implements OnInit {\n    /** ID of the active building */\n    @Input() public building: string;\n    /** ID of the active level */\n    @Input() public level: string;\n    /** Emitter for changes to the active level */\n    @Output() public levelChange = new EventEmitter<string>();\n    /** Details of the active building */\n    public building_details: Building = this._org.building;\n    /** List of available buildings */\n    public building_list: Building[] = [];\n    /** List of available levels */\n    public level_list: readonly BuildingLevel[] = [];\n\n    public get can_select_building(): boolean {\n        return !!this._service.setting('app.explore.can_select_building');\n    }\n\n    constructor(\n        private _route: ActivatedRoute,\n        private _router: Router,\n        private _service: ApplicationService,\n        private _org: OrganisationService\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this._org.listen('buildings').pipe(first(_ => !!_ && !!_.length)).subscribe(() => {\n            this.subscription(\n                'route.query',\n                this._route.queryParamMap.subscribe(params => {\n                    /* istanbul ignore else */\n                    if (params.has('level')) {\n                        const level_id = params.get('level');\n                        const level = this._org.levelWithID(level_id);\n                        this.level = level.id;\n                        this.setBuilding(level.building_id);\n                        this.levelChange.emit(this.level);\n                        this.clearTimeout('check_building');\n                    }\n                })\n            );\n            this.building_list = this._org.buildings;\n            this.timeout('check_building', () => {\n                /* istanbul ignore else */\n                if (!this.building) {\n                    this.setBuilding(this._org.building.id);\n                }\n                this.levelChange.emit(this.level);\n            });\n        });\n    }\n\n    public setBuilding(bld_id: string) {\n        const building = this._org.buildings.find(bld => bld.id === bld_id);\n        /* istanbul ignore else */\n        if (building) {\n            this.building_details = building;\n            this.building = bld_id;\n            this._org.building = building;\n            this.level_list = building.levels;\n            /* istanbul ignore else */\n            if (this.level_list.length && !this.level_list.find(lvl => lvl.id === this.level)) {\n                this.updateLevel(this.level_list[0].id);\n            }\n        }\n    }\n\n    public updateLevel(lvl_id: string) {\n        this.level = lvl_id;\n        this.levelChange.emit(this.level);\n        this._router.navigate([], {\n            relativeTo: this._route,\n            queryParams: { level: lvl_id }\n        });\n    }\n}\n","<div class=\"map-controls\">\n    <mat-form-field\n        class=\"map\"\n        appearance=\"outline\"\n        *ngIf=\"can_select_building && building_list.length > 1\"\n    >\n        <mat-select name=\"building\" [value]=\"building\" (valueChange)=\"setBuilding($event)\">\n            <mat-select-trigger> {{ building_details?.code }} - {{ building_details?.name }} </mat-select-trigger>\n            <mat-option *ngFor=\"let bld of building_list\" [value]=\"bld.id\">\n                <div class=\"building-name\">\n                    <div class=\"code\">{{ bld.code }}</div>\n                    <div class=\"name\">{{ bld.name }}</div>\n                    <div class=\"address\">{{ bld.address }}</div>\n                </div>\n            </mat-option>\n        </mat-select>\n    </mat-form-field>\n    <mat-form-field class=\"map\" appearance=\"outline\">\n        <mat-select name=\"level\" [(value)]=\"level\" (valueChange)=\"updateLevel($event)\">\n            <mat-option *ngFor=\"let level of level_list\" [value]=\"level.id\">\n                {{ level.name }}\n            </mat-option>\n        </mat-select>\n    </mat-form-field>\n</div>\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    Output\n} from '@angular/core';\n\nimport {\n    ApplicationLink,\n    ApplicationService\n} from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\nimport { DateNow } from '@mckinsey-converge/date-tz';\n\n\n@Component({\n    selector: 'a-overlay-menu',\n    templateUrl: './overlay-menu.component.html',\n    styleUrls: ['./overlay-menu.component.scss']\n})\nexport class OverlayMenuComponent extends BaseDirective {\n    /** Whether to show the menu */\n    @Input() public show: boolean;\n    /** Emitter for changes to show */\n    @Output() public showChange = new EventEmitter<boolean>();\n\n    /** List of links to display on the menu */\n    public get menu_items(): ApplicationLink[] {\n        const settings = this._service.setting('app.general.menu') || { items: [] };\n        return settings.items || [];\n    }\n\n    /** Copyright details for the application */\n    public get copyright(): string {\n        return (this._service.setting('app.general.menu') || {}).copyright || '';\n    }\n\n    public get settings() {\n        const settings = this._service.setting('app.general.menu') || { position: '' };\n        return settings;\n    }\n\n    constructor(private _service: ApplicationService) {\n        super();\n    }\n\n    /** Current year to display for copyright */\n    public get year(): number {\n        return DateNow(new Date()).dateYear;\n    }\n\n    /** Close the overlay menu */\n    public close() {\n        this.show = false;\n        this.showChange.emit(this.show);\n    }\n\n    public delayedClose() {\n        this.timeout('close', () => this.close(), 50);\n    }\n\n    public cancelClose() {\n        this.timeout('cancel_close', () => this.clearTimeout('close'), 10);\n    }\n}\n","<div\n    class=\"overlay-menu\"\n    [class.left]=\"settings?.position === 'left'\"\n    [class.middle]=\"settings?.position === 'middle'\"\n    [class.show]=\"show\"\n    (click)=\"delayedClose()\"\n>\n    <div class=\"menu\" (click)=\"cancelClose()\">\n        <div class=\"header\">\n            <div class=\"location\"></div>\n            <button mat-icon-button (click)=\"close()\">\n                <app-icon\n                    [icon]=\"{ type: 'icon', class: 'material-icons', content: 'close' }\"\n                ></app-icon>\n            </button>\n        </div>\n        <div class=\"body\">\n            <ul>\n                <ng-container *ngFor=\"let item of menu_items\">\n                    <ng-container *ngIf=\"item.route; else external_link\">\n                        <a\n                            [routerLink]=\"[item.route]\"\n                            routerLinkActive=\"active\"\n                            [queryParams]=\"item.query_params\"\n                        >\n                            <li>\n                                <div class=\"text\">{{ item.name }}</div>\n                                <app-icon\n                                    [icon]=\"{\n                                        type: 'icon',\n                                        class: 'material-icons',\n                                        content: 'keyboard_arrow_right'\n                                    }\"\n                                ></app-icon>\n                            </li>\n                        </a>\n                        <ng-container *ngIf=\"item.children && item.children.length\">\n                            <a\n                                *ngFor=\"let sub_item of item.children\"\n                                class=\"sub-link\"\n                                [routerLink]=\"[sub_item.route]\"\n                                routerLinkActive=\"active\"\n                                [queryParams]=\"sub_item.query_params\"\n                            >\n                                <li>\n                                    <div class=\"text\">{{ sub_item.name }}</div>\n                                    <app-icon\n                                        [icon]=\"{\n                                            type: 'icon',\n                                            class: 'material-icons',\n                                            content: 'keyboard_arrow_right'\n                                        }\"\n                                    ></app-icon>\n                                </li>\n                            </a>\n                        </ng-container>\n                    </ng-container>\n                    <ng-template #external_link>\n                        <a [href]=\"item.link | safe: 'url'\">\n                            <li>\n                                <div class=\"text\">{{ item.name }}</div>\n                                <app-icon\n                                    [icon]=\"{\n                                        type: 'icon',\n                                        class: 'material-icons',\n                                        content: 'exit_to_app'\n                                    }\"\n                                ></app-icon>\n                            </li>\n                        </a>\n                    </ng-template>\n                </ng-container>\n            </ul>\n        </div>\n        <div class=\"footer\" *ngIf=\"copyright\" i18n=\"Copyright\">\n            Copyright &copy; {{ year }} {{ copyright }}\n        </div>\n    </div>\n</div>\n","import {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    Input,\n    OnInit\n} from '@angular/core';\nimport { throttleTime, tap } from 'rxjs/operators';\nimport { BehaviorSubject, fromEvent } from 'rxjs';\nimport { ImageDirective } from '@mckinsey-converge/base';\nimport { setupRoomImages } from '@mckinsey-converge/data-common';\nimport { SpaceImageObject } from 'libs/base/src/lib/types.utilities'\n\n@Component({\n    selector: 'mck-responsive-inline-images',\n    template: `\n        <div class=\"\">\n            <div *ngIf=\"mobile\">\n                <carousel\n                    class=\"carousel\"\n                    [cellWidth]=\"'100%'\"\n                    [height]=\"225\"\n                    [arrowsOutside]=\"false\"\n                    [autoplay]=\"true\"\n                    [dots]=\"true\"\n                    [loop]=\"false\"\n                >\n                <div class=\"carousel-cell\"\n                    *ngFor=\"let img of foundImages\"\n                    [ngStyle]=\"{'background-image': 'url(' + img.path +'?'+ timestamp + ')'}\">\n                    <span *ngIf=\"showLabel(img.path)\">Images Coming Soon</span>\n                </div>\n            </carousel>\n            </div>\n            <div *ngIf=\"!mobile\" class=\"desktop-room-images\">\n                <div class=\"desktop-cell\"\n                    *ngFor=\"let img of foundImages\"\n                    [ngStyle]=\"{\n                        'background-image': showLabel(img.path) ? 'linear-gradient(0deg, rgba(2,0,36,1) 0%, rgba(0,0,0,1) 22%, rgba(0,0,0,0) 100%), url(' + img.path + ')' : 'url(' + img.path +'?'+ timestamp + ')'  \n                    }\">\n                    <span *ngIf=\"showLabel(img.path)\">Images Coming Soon</span>\n                </div>\n            </div>\n        </div>\n    `,\n    styleUrls: ['./responsive-inline-images.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ResponsiveInlineImagesComponent extends ImageDirective implements OnInit {\n\n    /** Input array of images */\n    @Input() public rootFolderURL: string;\n    @Input() public fileSlug: string;\n\n    /** Ignore this param, it's only use is to bypass the image onload event in testing */\n    @Input() public imagesLoaded: boolean;\n    public loadImages = new BehaviorSubject<SpaceImageObject[]>([]);\n\n    public foundImages: SpaceImageObject[] = [1,2,3].map(n => {\n        return {path: `assets/img/rooms/placeholder-${n}.png`};\n    });\n\n    public mobile = false;\n\n    constructor(private cdRef: ChangeDetectorRef,) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        const breakpoint = 768;\n\n        if (window) {\n            this.mobile = window.innerWidth < breakpoint;\n        }\n\n        fromEvent(window, 'resize').pipe(throttleTime(500)).pipe(tap({\n            next: val => {\n                const target = val.target as Window;\n                this.mobile = target.innerWidth < breakpoint;\n            }\n        })).subscribe();\n        setupRoomImages(this, [1,2,3], this.rootFolderURL, this.fileSlug, this.imagesLoaded);\n        this.subscription(\n\t\t\t\t\t\t'found_images',\n\t\t\t\t\t\tthis.loadImages.subscribe((imgArr: SpaceImageObject[]) => {\n\t\t\t\t\t\t\tif(imgArr.length) this.foundImages =  imgArr;\n\t\t\t\t\t\t\tthis.cdRef.detectChanges();\n\t\t\t\t\t\t}));\n    }\n\n    public showLabel(path) {\n        return path.includes('placeholder');\n    } \n\n    public get timestamp () {\n        return (new Date()).getTime()\n    }\n}\n","import {\n    Component,\n    Inject,\n    OnInit,\n    ViewEncapsulation,\n} from '@angular/core';\nimport {\n    MatDialogRef,\n    MAT_DIALOG_DATA\n} from '@angular/material/dialog';\nimport {\n    BaseClass\n} from '@mckinsey-converge/base';\nimport { ComposerService } from '@placeos/composer';\nimport { first } from 'rxjs/operators';\n\n@Component({\n    selector: 'a-survey-modal',\n    templateUrl: './survey-modal.component.html',\n    styleUrls: ['./survey-modal.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n})\nexport class SurveyModalComponent extends BaseClass implements OnInit {\n    constructor(\n        @Inject(MAT_DIALOG_DATA) public _data: any,\n        private _composer: ComposerService,\n        private _dialog_ref: MatDialogRef<SurveyModalComponent>,\n    ) {\n        super();\n    }\n\n    /* present experience question by default */\n    public token = '';\n    public phase = 'intro';\n    public baseUrl = '';\n\n    public questions = {\n        created_at: 0,\n        updated_at: 0,\n        header_question: \"What went wrong?\",\n        header_subtext: \"Select one or several options\",\n        options: [],\n        id: \"\"\n    }\n\n    public answers = {\n        questions_id: \"\",\n        positive: true, // Experience is positive until the questions are displayed\n        option_responses: [],\n        comments: \"\"\n    };\n\n    // Show the questions and mark the experience negative. (false positive)\n    public showQuestions(): void {\n        this.answers.positive = false;\n        this.phase = 'questions';\n    }\n\n    public ngOnInit(): void {\n        /* fetch the question options once composer is initialized */\n        this._composer.initialised.pipe(first(_ => _)).subscribe(() => {\n            const token = this._composer.auth.token;\n            this.token = token;\n            this.baseUrl = this._composer.auth.api_endpoint.replace(this._composer.auth.route, '/api/staff/feedback')\n            this.getFeedbackQuestionsFromApi(token, this._data)\n        });\n    }\n\n    public getFeedbackQuestionsFromApi(token: string, questionID: string) {\n        new Promise<any>((resolve, reject) => {\n            const url = `${this.baseUrl}/questions/${questionID}`;\n            let result: any = null;\n            this._composer.http.get(url).subscribe(\n                (d) => (result = d),\n                (e) => {\n                    reject(e);\n                },\n                () => {\n                    resolve(result);\n                }\n            );\n        }).then(d => {\n            this.questions = d;\n            this.answers = {\n                questions_id: this.questions.id,\n                positive: true,\n                option_responses: this.questions.options.map(q => ({ // map the questions to default answers.\n                    id: q.id,\n                    checked: false,\n                })),\n                comments: \"\"\n            };\n        }).catch(e => {\n            console.log('error', e)\n        });\n    }\n\n    // Handle the checkbox changes\n    public handleChange(value: any) {\n        this.answers.option_responses.some((o, i) => {\n            if (o.id === value.id) {\n                this.answers.option_responses[i].checked = !this.answers.option_responses[i].checked;\n                return true;\n            }\n        });\n    }\n\n    // Handle the comment input changes\n    public handleComment($evemt: any) {\n        this.answers.comments = $evemt.target.value;\n    }\n\n    // Submit the Survey in it's current state.\n    public confirm() {\n        new Promise<any>((resolve, reject) => {\n            let result: any = null;\n            this._composer.http.post(this.baseUrl, this.answers).subscribe(\n                (d) => (result = d),\n                (e) => {\n                    reject(e);\n                },\n                () => {\n                    resolve(result);\n                }\n            );\n        }).then(d => {\n            this.phase = 'exit';\n            this.closeModal(true);\n        }).catch(e => {\n            console.log('error', e)\n            this.phase = 'exit';\n            this.closeModal(true);\n        });\n        \n    }\n\n    // Close the modal\n    public closeModal(delayed: boolean = false) {\n        if (delayed) {\n            this.timeout('closeModal', () => {\n                this._dialog_ref.close();\n            }, 2000);\n        } else {\n            this._dialog_ref.close();\n        }\n    }\n}\n","<div>\n    <mat-dialog-content>\n        <div *ngIf=\"phase == 'intro'\">\n            <div class=\"mck-column modal-heading\">\n                <button name=\"CloseButton\" class=\"close-button\" mat-icon-button (click)=\"closeModal()\">\n                    <div class=\"close-image\"></div>\n                </button>\n                <div class=\"header\">\n                    How was your booking experience?\n                </div>\n            </div>\n            <div class=\"mck-column thumbs\">\n                <input type=\"image\" (click)=\"confirm()\" src=\"assets/icon/thumbs-up.svg\" alt=\"Good experience\" />\n                <input type=\"image\" (click)=\"showQuestions()\" src=\"assets/icon/thumbs-down.svg\" alt=\"Poor experience\" />\n            </div>\n        </div>\n\n\n        <div *ngIf=\"phase == 'questions'\">\n            <div class=\"mck-column modal-heading\">\n                <button name=\"CloseButton\" class=\"close-button\" mat-icon-button (click)=\"closeModal()\">\n                    <div class=\"close-image\"></div>\n                </button>\n                <div class=\"sub-header\">\n                    <img  src=\"assets/icon/thumbs-down.svg\" />\n                    What went wrong?\n                    <p>Select one or several options</p>\n                </div>\n            </div>\n            <div class=\"mck-column questions\">\n                <div *ngFor=\"let question of questions.options\">\n                    <mat-checkbox\n                        [checked]=\"false\"\n                        [value]=\"question\"\n                        (change)=\"handleChange(question)\"\n                    >{{question.option}}</mat-checkbox>\n                </div>\n                <div class=\"comment\">\n                    <mat-form-field class=\"\">\n                        <label>Additional comments</label>\n                        <textarea\n                            (input)=\"handleComment($event)\"\n                            class=\"comment_field\"\n                        ></textarea>\n                      </mat-form-field>\n                </div>\n            </div>\n            <mat-dialog-actions>\n                <mck-modal-button-row\n                    [disableFixed]=\"true\"\n                    [smallButtons]=\"true\"\n                    primaryLabel=\"Submit\" (primarySubmit)=\"confirm()\"\n                    secondaryLabel=\"Cancel\" (secondarySubmit)=\"closeModal()\"\n                ></mck-modal-button-row>\n            </mat-dialog-actions>            \n        </div>\n\n        <div *ngIf=\"phase == 'exit'\">\n            <div class=\"mck-column modal-heading\">\n                <button name=\"CloseButton\" class=\"close-button\" mat-icon-button (click)=\"closeModal()\">\n                    <div class=\"close-image\"></div>\n                </button>\n            </div>\n\n            <mat-dialog-actions>\n                <div class=\"thanks\">\n                    Thank you!\n                </div>\n                <mck-modal-button-row\n                    [disableFixed]=\"true\"\n                    [smallButtons]=\"true\"\n                    primaryLabel=\"Close\" (primarySubmit)=\"closeModal()\"\n                ></mck-modal-button-row>\n            </mat-dialog-actions>            \n        </div>\n    </mat-dialog-content>\n</div>","import {\n    Component,\n    EventEmitter,\n    Input,\n    OnInit,\n    Output,\n    ViewEncapsulation,\n} from '@angular/core';\nimport {\n    distinctUntilChanged,\n    first,\n} from 'rxjs/operators';\nimport {\n    ApplicationIcon,\n    BookingFormState,\n    SettingsService,\n    openBookingSurvey,\n    clearBookingFormData,\n    BookingFormData,\n    SeriesAction,\n    selectActiveForm\n} from '@mckinsey-converge/data-common';\nimport { loadRoomsForResults } from '@mckinsey-converge/rooms';\n\nimport { loadOrganisations } from '@mckinsey-converge/organisation';\nimport { BuildingStoreState } from '@mckinsey-converge/buildings';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\nimport {\n    NavigationEnd,\n    Router,\n    ActivatedRoute\n} from '@angular/router';\nimport {\n    generateFeedbackUrl,\n    Urls\n} from '../../utilities/urls';\nimport { SurveyModalComponent } from '../survey-modal/survey-modal.component';\nimport {\n    Store, select\n} from '@ngrx/store';\n\nexport enum TopBarHeaderMode {\n    Light = 'light',\n    Dark = 'dark',\n}\n\nexport interface RoutePayload {\n    /** IE ['/home', 'results'] */\n    route: string[];\n    /** IE { display: '/list' } */\n    queryParams?: object;\n}\n\nexport type RoomBookingStoreState = BookingFormState & BuildingStoreState;\n\n@Component({\n    selector: 'a-topbar-header',\n    template: `\n        <div [class]=\"'topbar-header ' + page + ' ' + mode\">\n            <div class=\"block home\" *ngIf=\"!back && !modal && !backModal\">\n                <button mat-icon-button name=\"home-button\" class=\"home-button\"\n                        [attr.aria-label]=\"'Home'\"\n                        (click)=\"goToHome()\">\n                    <img class=\"icon\" src=\"{{mode == 'dark' ? 'assets/img/home.svg' : 'assets/img/home-light.svg'}}\" />\n                </button>\n            </div>\n            <div class=\"block company-logo-container\" *ngIf=\"!back && !modal && !backModal\">\n                <div class=\"logo\" *ngIf=\"logo\">\n                    <i class=\"logo-icon\" *ngIf=\"logo.type === 'icon'\" [class]=\"logo.class\"\n                       aria-label=\"McKinsey & Company\">{{ logo.content }}</i>\n                    <img class=\"logo-icon\" *ngIf=\"logo.type === 'img'\" [src]=\"logo.src | safe: 'resource'\"\n                         aria-label=\"McKinsey & Company\"\n                    />\n                </div>\n            </div>\n            <div class=\"block back-container\" *ngIf=\"back\">\n                <button mat-icon-button name=\"home-button\" class=\"home-button\"\n                    [attr.aria-label]=\"'Home'\"\n                    (click)=\"goToBackRoute()\">\n                    <img class=\"icon\" src=\"{{mode == 'dark' ? 'assets/icon/back-arrow.svg' : 'assets/icon/back-arrow-light.svg'}}\" />\n                </button>\n            </div>\n            <div class=\"block back-container\" *ngIf=\"backModal\">\n                <button mat-icon-button name=\"home-button\" class=\"home-button\"\n                    [attr.aria-label]=\"'Home'\"\n                    (click)=\"closeCallback.emit(true)\">\n                    <img class=\"icon\" src=\"{{mode == 'dark' ? 'assets/icon/back-arrow.svg' : 'assets/icon/back-arrow-light.svg'}}\" />\n                </button>\n            </div>\n            <div class=\"block back-container\" *ngIf=\"modal\">\n                <button mat-icon-button name=\"close-button\" class=\"close-button\"\n                    [attr.aria-label]=\"'Close'\"\n                    (click)=\"closeCallback.emit(true)\">\n                    <img class=\"icon\" src=\"{{mode == 'dark' ? 'assets/icon/close.svg' : 'assets/icon/close.svg'}}\" />\n                </button>\n            </div>\n            <div class=\"block actions-container\">\n                <button mat-icon-button name=\"feedback-button\" class=\"feedback-button\"\n                    matTooltip=\"Feedback\"\n                    [attr.aria-label]=\"'Feedback'\"\n                    (click)=\"goToFeedback()\"\n                >\n                    <img class=\"icon\" src=\"assets/img/chat-{{mode}}.svg\" alt=\"Feedback Icon\" />\n                    <span>Feedback</span>\n                </button>\n                <button mat-icon-button name=\"help-button\" class=\"help-button\"\n                        matTooltip=\"Help\"\n                        [attr.aria-label]=\"'Help'\"\n                        (click)=\"goToHelp()\"\n                    >\n                        <img class=\"icon\" src=\"assets/img/question-{{mode}}.svg\" alt=\"Help Icon\" />\n                        <span>Help</span>\n                </button>\n            </div>\n        </div>\n    `,\n    styleUrls: ['./topbar-header.component.scss'],\n    // encapsulation: ViewEncapsulation.None,\n})\nexport class TopbarHeaderComponent extends BaseDirective implements OnInit {\n    /** Logo of the application organisation */\n    public logo: ApplicationIcon;\n    /** Whether to show menu */\n    @Input() public menu: boolean;\n    /** Whether to show modal close icon */\n    @Input() public modal: boolean = false;\n    /** Whether t show modal back icon */\n    @Input() public backModal: boolean = false;\n    /** Whether to disable the survey triggers */\n    @Input() public noSurvey: boolean = false;\n    /** Name of the page being rendered */\n    @Input() public page: string;\n    /** The theme to use **/\n    @Input() public mode: TopBarHeaderMode = TopBarHeaderMode.Dark;\n    /** Override the home route. **/\n    @Input() public homeOverride: string | undefined;\n    /** Show history back instead of logo block */\n    @Input() public back: RoutePayload;\n    /** Emitter for changes to menu state */\n    @Output() public menuChange = new EventEmitter<boolean>();\n    /** Emitter for the close button */\n    @Output() public closeCallback = new EventEmitter<boolean>();\n    /** Emitter for the back button */\n    @Output() public onBack = new EventEmitter<void>();\n    /** Name of the currently active page */\n    public currentPage: string;\n    /** Survey modal state */\n    public modalOpen: boolean = false;\n    isEditSeries: boolean = false;\n\n    public get feedback() {\n        return generateFeedbackUrl(this.currentPage);\n    }\n\n    public surveyDialogRef: MatDialogRef<SurveyModalComponent, any> = null;\n\n    public bookingCompleted: Date = new Date();\n    public feedbackId: string = null;\n\n    constructor(private store: Store<RoomBookingStoreState>,\n        private _settings: SettingsService,\n        private _dialog: MatDialog,\n        private route: ActivatedRoute,\n        private _router: Router) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.store.dispatch(loadOrganisations.request());\n        this._settings.initialised.pipe(first(_ => _)).subscribe(() => {\n            this.logo = this._settings.get(`app.logo_${this.mode}`) || { type: 'icon' };\n        });\n        this.timeout('Getting Title', () => this.updateRoute(document.title));\n        this._router.events.subscribe((event: NavigationEnd) => {\n            /* istanbul ignore else */\n            if (event instanceof NavigationEnd) {\n                this.timeout('Getting Title', () => this.updateRoute(document.title));\n            }\n        });\n\n        // if the survey is allowed (don't in modals! due to duplicate appearances)\n        if (!this.noSurvey) {\n            // get the active form values\n            this.subscription('openSurveyModal', this.store.pipe(\n                distinctUntilChanged()\n            ).subscribe((next: any | undefined) => {\n                const feedbackId = next.organisation?.data?.success?._settings?.discovery_info?.feedback_id;\n                if (feedbackId && this.feedbackId !== feedbackId) {\n                    this.feedbackId = feedbackId;\n                }\n                if (next.bookingForm?.bookingCompleted && this.bookingCompleted.getTime() < next.bookingForm.bookingCompleted.getTime()) {\n                    this.bookingCompleted = new Date(next.bookingForm.bookingCompleted.getTime());\n                    this.openFeedbackModal();\n                }\n            }));\n        }\n\n\n        this.subscription('activeForm', this.store.pipe(\n            select(selectActiveForm),\n            distinctUntilChanged()\n        ).subscribe((next: BookingFormData | undefined) => {\n            if (next) {\n                this.isEditSeries = next.action === SeriesAction.EDIT;\n            }\n        }));\n    }\n\n    public updateRoute(location) {\n        location = location.substr(0, location.indexOf(' |'));\n        this.currentPage = location;\n    }\n\n    /** Set menu state to `true` */\n    public showMenu() {\n        this.menu = true;\n        this.menuChange.emit(this.menu);\n    }\n\n    public async goToHome() {\n        this.isEditSeries && this.clearFormAndResultData();\n        await this._router.navigate([this.homeOverride ?? '/']);\n        // await this._router.navigate(['/', 'home'], { relativeTo: this.route });\n        this._dialog.closeAll();\n    }\n\n\n\tpublic clearFormAndResultData() {\n\t\tthis.store.dispatch(clearBookingFormData());\n\t\tthis.store.dispatch(loadRoomsForResults.clear());\n\t}\n\n    public goToHelp() {\n        window.open(Urls.Help);\n    }\n\n    public goToFeedback() {\n        // Over-engineered button action to mimic/test booking confirmation event.\n        this.store.dispatch(openBookingSurvey());\n    }\n\n    public openFeedbackModal() {\n        if (!this.modalOpen && !this.surveyDialogRef) {\n            this.modalOpen = true;\n            this.surveyDialogRef = this._dialog.open(SurveyModalComponent, {\n                disableClose: true,\n                panelClass: 'mck-modal-survey',\n                data: this.feedbackId,\n                autoFocus: false,\n                backdropClass: 'mck-modal-backdrop',\n            });\n            this.surveyDialogRef.afterClosed().subscribe(() => {\n                this.modalOpen = false;\n                this.surveyDialogRef = null;\n            });\n        }\n\n    }\n\n    public async goToBackRoute() {\n        this.onBack.emit();\n        await this._router.navigate(this.back.route, { queryParams: this.back.queryParams });\n    }\n\n}\n","import {\n    Component,\n    OnInit\n} from '@angular/core';\nimport {\n    FormControl,\n    FormGroup,\n    Validators\n} from '@angular/forms';\nimport { first } from 'rxjs/operators';\n\nimport {\n    ApplicationIcon,\n    ApplicationService,\n    UsersService\n} from '@mckinsey-converge/data-common';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\n@Component({\n    selector: 'app-login',\n    templateUrl: './login.component.html',\n    styleUrls: ['./login.component.scss']\n})\nexport class LoginComponent extends BaseDirective implements OnInit {\n    /** Logo of the application organisation */\n    public logo: ApplicationIcon;\n    /** Whether the user credentials are being checked */\n    public loading: boolean;\n    /** Form fields for the login form */\n    public form: FormGroup;\n\n    constructor(private _service: ApplicationService, private _users: UsersService) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.loading = true;\n        this.form = new FormGroup({\n            username: new FormControl('', [Validators.required]),\n            password: new FormControl('', [Validators.required])\n        });\n        this._service.initialised.pipe(first(_ => _)).subscribe(() => {\n            this.loading = false;\n            this.logo = this._service.setting('app.logo_light') || { type: 'icon' };\n        });\n    }\n\n    /** Perform user login */\n    public login() {\n        this.loading = true;\n        const form = this.form.value;\n        this._users.login({\n            username: form.username,\n            password: form.password\n        }, { form: true }).then(() => {\n            this.loading = false;\n        }, () => {\n            this.loading = false;\n            this.form.controls.password.setErrors({ check: true });\n        });\n    }\n\n}\n","<div class=\"login\" *ngIf=\"!loading; else loading_state\">\n    <div class=\"login-form\">\n        <form [formGroup]=\"form\">\n            <div class=\"header\" [style.background-color]=\"logo?.background\">\n                <div class=\"logo\">\n                    <i *ngIf=\"logo?.type === 'icon'\" [class]=\"logo.class\">{{ logo.content }}</i>\n                    <img *ngIf=\"logo?.type === 'img'\" [src]=\"logo.src | safe: 'resource'\" />\n                </div>\n            </div>\n            <div class=\"body\">\n                <ng-container>\n                    <div class=\"field\">\n                        <label\n                            for=\"username\"\n                            [class.error]=\"\n                                form.controls.username.invalid && form.controls.username.touched\n                            \"\n                            i18n=\"Login form username label\"\n                        >\n                            Username:\n                        </label>\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                matInput\n                                name=\"username\"\n                                placeholder=\"Username/Email\"\n                                i18n-placeholder\n                                formControlName=\"username\"\n                            />\n                            <mat-error i18n=\"Login form username error\"\n                                >Username is required</mat-error\n                            >\n                        </mat-form-field>\n                    </div>\n                    <div class=\"field\">\n                        <label\n                            for=\"password\"\n                            [class.error]=\"\n                                form.controls.password.invalid && form.controls.password.touched\n                            \"\n                            i18n=\"Login form password label\"\n                        >\n                            Password:\n                        </label>\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                matInput\n                                name=\"password\"\n                                placeholder=\"Password\"\n                                i18n-placeholder\n                                formControlName=\"password\"\n                                (keyup.enter)=\"login()\"\n                            />\n                            <mat-error i18n=\"Login form password error\"\n                                >Invalid username or password</mat-error\n                            >\n                        </mat-form-field>\n                    </div>\n                </ng-container>\n            </div>\n            <div class=\"footer\">\n                <button mat-button (click)=\"login()\" i18n=\"Login action\">Login</button>\n            </div>\n        </form>\n    </div>\n</div>\n<ng-template #loading_state>\n    <div class=\"info-block center\">\n        <div class=\"spinner\">\n            <img src=\"assets/img/loader.gif\" />\n        </div>\n        <div class=\"text\" i18n=\"Checking login status\">Converge is loading</div>\n    </div>\n</ng-template>\n","import {\n    Component,\n    EventEmitter,\n    OnInit,\n    Output,\n    ViewEncapsulation\n} from '@angular/core';\n@Component({\n    selector: 'app-map-controls',\n    template: `\n        <div class=\"mck-column map-controls-container\">\n            <div class=\"mck-column map-controls-row\">\n                <button\n                    name=\"zoom-in-button\"\n                    mat-stroked-button\n                    (click)=\"zoomInClick.emit()\"\n                    class=\"mck-stroked-button mck-square mck-thin-border-light\"\n                >\n                    <div class=\"map-icon-zoom-in\" aria-label=\"Zoom In\"></div>\n                </button>\n                <button\n                    name=\"zoom-out-button\"\n                    mat-stroked-button\n                    (click)=\"zoomOutClick.emit()\"\n                    class=\"mck-stroked-button mck-square mck-thin-border-light\"\n                >\n                    <div class=\"map-icon-zoom-out\" aria-label=\"Zoom Out\"></div>\n                </button>\n                <button\n                    name=\"refresh-button\"\n                    mat-stroked-button\n                    (click)=\"refreshClick.emit()\"\n                    class=\"mck-stroked-button mck-square mck-thin-border-light\"\n                >\n                    <div class=\"map-icon-refresh\" aria-label=\"Reset View\"></div>\n                </button>\n                <button\n                    (click)=\"toggle()\"\n                    class=\"mck-stroked-button mck-square mck-thin-border-light last-button\"\n                >\n                    <img\n                        class=\"icon\"\n                        src=\"{{\n                            isClosed == true\n                                ? 'assets/img/open_in_full.svg'\n                                : 'assets/img/close_fullscreen.svg'\n                        }}\"\n                    />\n                </button>\n            </div>\n        </div>\n    `,\n    styleUrls: ['./map-controls.component.scss'],\n    encapsulation: ViewEncapsulation.Emulated,\n})\nexport class MapControlsComponent implements OnInit {\n    @Output()\n    public zoomOutClick = new EventEmitter();\n\n    @Output()\n    public zoomInClick = new EventEmitter();\n\n    @Output()\n    public refreshClick = new EventEmitter();\n\n    @Output()\n    public infoClick = new EventEmitter();\n\n    @Output() toggleEvent = new EventEmitter<void>();\n\n    public isClosed = true;\n\n    toggle() {\n        this.toggleEvent.emit();\n        this.isClosed = !this.isClosed;\n    }\n\n    constructor() {}\n\n    ngOnInit(): void {}\n}\n","import {\n    Component,\n    EventEmitter,\n    Input,\n    OnInit,\n    Output,\n    ViewEncapsulation\n} from '@angular/core';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { FormControl } from '@angular/forms';\nimport { BaseDirective } from '@mckinsey-converge/base';\nimport { legendOptions } from '../map.utils';\n\n@Component({\n    selector: 'app-map-filters',\n    template: `\n        <div class=\"mck-column mck-content-expand-width map-filters-container\">\n            <div class=\"mck-row-flow search-input-container\">\n                <mck-autocomplete-select-option\n                [selectedValue]=\"selectedSpace\"\n                [resetInput]=\"resetInput\"\n                noEntriesFoundLabel=\"There are no rooms for your current search.\"\n                placeholder=\"Type to search (level, number or name) ...\"\n                [options]=\"spaces\"\n                [formControl]=\"spaceControl\"\n                (inputTextChange)=\"inputTextChange($event)\"\n                ></mck-autocomplete-select-option>\n                <button\n                    *ngIf=\"searchStringPresent\"\n                    (click)=\"clearRoomSearch()\"\n                    class=\"close-button mck-short mck-short-height mck-form-input\">\n                        <div class=\"close-button-icon\"></div>\n                </button>\n                <button\n                    (click)=\"searchClick.emit()\"\n                    class=\"search-button mck-short mck-short-height mck-form-input\">\n                        <div class=\"search-button-icon\"></div>\n                </button>\n            </div>\n            <div class=\"mck-row-flow controls-background office-level-row \">\n                <mck-select\n                    [showDivider]=\"true\"\n                    [selectedValue]=\"selectedBuilding\"\n                    [formControl]=\"buildingControl\"\n                    class=\"office-selector\"\n                    [options]=\"buildings\"\n                    [disabled]=\"buildings?.length <= 1\"></mck-select>\n                <mck-select\n                    [showDivider]=\"true\"\n                    [selectedValue]=\"selectedLevel\"\n                    [formControl]=\"levelControl\"\n                    class=\"level-selector\"\n                    [options]=\"levels\"\n                    [disabled]=\"levels?.length <= 1\"></mck-select>\n                <mck-legend-dropdown\n                    placeholder=\"Show legend\"\n                    placeholderOpen=\"Hide legend\"\n                    [options]=\"legendOptions\"\n                >\n            </mck-legend-dropdown>\n            </div>\n        </div>\n    `,\n    styleUrls: ['./map-filters.component.scss'],\n    encapsulation: ViewEncapsulation.Emulated\n})\nexport class MapFiltersComponent extends BaseDirective implements OnInit {\n\n    public legendOptions = legendOptions();\n\n    @Input()\n    public buildings: SelectOption<any>[];\n\n    @Input()\n    public selectedBuilding: SelectOption<any>;\n\n    @Output()\n    public selectedBuildingChange = new EventEmitter<SelectOption<any>>();\n\n    @Input()\n    public levels: SelectOption<any>[];\n\n    @Input()\n    public selectedLevel: SelectOption<any>;\n\n    @Output()\n    public selectedLevelChange = new EventEmitter<SelectOption<any>>();\n\n    @Input()\n    public spaces: SelectOption<any>[];\n\n    @Output()\n    public selectedSpaceChange = new EventEmitter<SelectOption<any>>();\n\n    @Input()\n    public selectedSpace: SelectOption<any>;\n\n    @Output()\n    public searchClick = new EventEmitter();\n\n    public buildingControl = new FormControl();\n\n    public levelControl = new FormControl();\n\n    public spaceControl = new FormControl();\n\n    public resetInput: number;\n\n    public searchStringPresent = false;\n\n    constructor() {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.subscription('buildingChanges',\n            this.buildingControl.valueChanges.subscribe(value => this.selectedBuildingChange.emit(value)));\n        this.subscription('levelChanges',\n            this.levelControl.valueChanges.subscribe(value => this.selectedLevelChange.emit(value)));\n        this.subscription('spaceChanges',\n            this.spaceControl.valueChanges.subscribe(value => {\n                this.selectedSpaceChange.emit(value);\n                this.searchClick.emit();\n            }));\n    }\n\n    public clearRoomSearch() {\n        this.resetInput = Date.now();\n        this.selectedSpace = null;\n        this.searchStringPresent = false;\n        // TODO, reset the focused room if required?\n    }\n\n    public inputTextChange(event: any) {\n        this.searchStringPresent = !!event.length;\n    }\n}\n","import {\n    Component,\n    Inject,\n    ViewEncapsulation,\n} from '@angular/core';\nimport {\n    Space,\n    RoomResultsViewModel,\n} from '@mckinsey-converge/data-common';\nimport { MAP_OVERLAY_DATA } from '@acaprojects/ngx-interactive-map';\n\ninterface SpaceWithReturnData extends Space {\n    // callback?: Function,\n    room?: RoomResultsViewModel,\n    parentComponent?: any,\n}\n/**\n * Replaces the built-in {@link MapPinComponent} based on design.\n */\n@Component({\n    selector: 'app-map-overlay',\n    template: `\n        <div class=\"mck-column mck-center map-overlay-container\">\n            <div class=\"map-label\">\n                {{data.simple_name || 'No Label'}}\n                <button mat-stroked-button color=\"primary\" *ngIf=\"data.parentComponent\"\n                    class=\"mck-stroked-button mck-short mck-column mck-center mck-primary\"\n                    (click)=\"roomDataCallback()\"\n                    (touchend)=\"roomDataCallback()\"\n                >\n                    View room detail\n                </button>\n            </div>\n            <div class=\"map-icon\"></div>\n        </div>\n    `,\n    styleUrls: ['./map-overlay.component.scss'],\n    encapsulation: ViewEncapsulation.Emulated\n})\nexport class MapOverlayComponent {\n    constructor(\n        @Inject(MAP_OVERLAY_DATA) public data: SpaceWithReturnData,\n        ) {\n    }\n\n    public roomDataCallback() {\n        if (this.data.parentComponent.roomSelected && this.data.room) {\n            this.data.parentComponent.roomSelected(this.data.room)\n        }\n    }\n}\n","import {\n    ChangeDetectionStrategy,\n    Component,\n    EventEmitter,\n    Input,\n    OnInit,\n    Output,\n    ViewEncapsulation,\n} from '@angular/core';\nimport { BehaviorSubject, combineLatest, interval } from 'rxjs';\nimport { BaseDirective, HashMap, Point } from '@mckinsey-converge/base';\nimport { MapFeature } from '@acaprojects/ngx-interactive-map/lib/helpers/map.interfaces';\nimport { select, Store } from '@ngrx/store';\nimport { BuildingStoreState } from '@mckinsey-converge/buildings';\nimport {\n    Building,\n    BuildingLevel,\n    SettingsService,\n    Space,\n    mapBuildingLevelToOption,\n    mapResultsToViewModels,\n    RoomResultsViewModel,\n    selectActiveForm,\n    selectBookingLocations,\n    selectMapFilteredResults,\n    selectSelectedBuildingOptions,\n    roomFormDataToQuery,\n    FilteredSpaces,\n    BookingStoreState,\n    storeBookingFormData,\n    BookingFormData,\n    MapListener,\n    selectFilteredDiffSizeResults\n} from '@mckinsey-converge/data-common';\nimport { distinctUntilChanged, map, take, withLatestFrom } from 'rxjs/operators';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { filterUndefined } from '@mckinsey-converge/rx-utils';\nimport { MatDialog } from '@angular/material/dialog';\nimport { OfficeInformationModalComponent } from 'src/app/map/office-information-modal/office-information-modal.component';\nimport {\n    CENTER_POINT,\n    generateMapListenersForSpace,\n    generateMapStyleForSpace,\n    MAX_ZOOM_LEVEL,\n    MIN_ZOOM_LEVEL,\n    roomToMapFeature,\n} from 'src/app/map/map.utils';\nimport {\n    loadRoomsForResults,\n    loadRoomsForResultsMap,\n    mapRoomToSelectOption,\n    RoomStoreState,\n} from '@mckinsey-converge/rooms';\nimport { LoadingModel } from '@mckinsey-converge/loading';\nimport { UserStoreState } from '@mckinsey-converge/user';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Location } from '@angular/common';\nimport { trigger, state, style, transition, animate } from '@angular/animations';\n\nexport type MapSearchStoreState = BuildingStoreState &\n    RoomStoreState &\n    BookingStoreState &\n    UserStoreState;\n\n@Component({\n    selector: 'app-map-search',\n    template: `\n        <div class=\"mck-column map-search-container\">\n            <div class=\"mck-content-expand-width map-filter\">\n                <app-map-filters\n                    (selectedBuildingChange)=\"selectActiveBuilding($event)\"\n                    (selectedLevelChange)=\"selectBuildingLevel($event)\"\n                    (selectedSpaceChange)=\"selectActiveSpace($event)\"\n                    [selectedBuilding]=\"activeBuildingOption | async\"\n                    [selectedLevel]=\"activeLevelOption | async\"\n                    [selectedSpace]=\"activeSpaceOption | async\"\n                    [buildings]=\"bookingLocations | async\"\n                    [levels]=\"buildingLevelOptions | async\"\n                    [spaces]=\"spaceListOptions | async\"\n                    (searchClick)=\"focusOnRoom()\"\n                >\n                </app-map-filters>\n            </div>\n            <div class=\"map-wrapper\" [class.wrapper-height]=\"openHeader\" [@expandHeight]=\"isOpen ? 'open' : 'closed'\">\n                <img\n                    src=\"assets/icon/map-info.png\"\n                    (click)=\"displayOfficeInformation()\"\n                    class=\"map-info-button\"\n                />\n                <app-map-controls\n                (toggleEvent)=\"propagateToggle()\"\n                    (zoomInClick)=\"zoomIn()\"\n                    (zoomOutClick)=\"zoomOut()\"\n                    (refreshClick)=\"resetZoomLevels()\"\n                ></app-map-controls>\n                <a-map\n                    [zoom]=\"zoom | async\"\n                    (zoomChange)=\"zoom.next($event)\"\n                    [center]=\"center | async\"\n                    (centerChange)=\"center.next($event)\"\n                    [src]=\"mapUrl | async\"\n                    [css]=\"style_map | async\"\n                    [listeners]=\"listeners | async\"\n                    [features]=\"features | async\"\n                    [focus]=\"(focusedMapSpace | async)?.id\"\n                >\n                </a-map>\n            </div>\n        </div>\n    `,\n    styleUrls: ['./map-search.component.scss'],\n    encapsulation: ViewEncapsulation.Emulated,\n    animations: [\n        trigger('expandHeight', [\n            state(\n                'open',\n                style({\n                    height: '470px',\n                })\n            ),\n            state(\n                'closed',\n                style({\n                    height: 'calc(100vh - 270px)',\n                })\n            ),\n            transition('open <=> closed', animate('600ms ease-out')),\n        ]),\n    ],\n})\nexport class MapSearchComponent extends BaseDirective implements OnInit {\n    @Input()\n    public openHeader: boolean = true;\n\n    public zoom = new BehaviorSubject(MIN_ZOOM_LEVEL);\n\n    public center = new BehaviorSubject<Point>(CENTER_POINT);\n    public listeners = new BehaviorSubject<MapListener[]>([]);\n\n    public focusedMapSpace = new BehaviorSubject<MapFeature | undefined>(undefined);\n    public features = combineLatest([this.focusedMapSpace]).pipe(\n        map((items) => items.filter((i) => !!i))\n    );\n\n    public focusedRoom = new BehaviorSubject<RoomResultsViewModel | undefined>(undefined);\n\n    public resultBuildings = new BehaviorSubject<Building[]>([]);\n    public resultSpaces = new BehaviorSubject<Space[]>([]);\n    public activeBuilding = new BehaviorSubject<Building | undefined>(undefined);\n    public activeLevel = new BehaviorSubject<BuildingLevel | undefined>(undefined);\n    public activeSpace = new BehaviorSubject<Space | undefined>(undefined);\n\n    /** Mapping of elements to CSS styles */\n    public style_map = new BehaviorSubject<HashMap<HashMap<string | number>>>({});\n\n    public mapUrl = this.activeLevel.pipe(map((level) => level?.map_url ?? ''));\n\n    public bookingLocations = new BehaviorSubject<SelectOption<any>[]>([]);\n    public buildingLevelOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n    public spaceListOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n\n    public activeBuildingOption = combineLatest([this.activeBuilding, this.bookingLocations]).pipe(\n        map(([building, locations]) => locations.find((l) => l.value === building?.id))\n    );\n\n    public activeLevelOption = this.activeLevel.pipe(map(mapBuildingLevelToOption));\n    public activeSpaceOption = this.activeSpace.pipe(map(mapRoomToSelectOption));\n    public bookingFormData = new BehaviorSubject<BookingFormData | undefined>(undefined);\n    public floorData: any;\n    public floorDataParam: any;\n    @Output() toggleEvent = new EventEmitter<void>();\n\n    //to capture state for toggling expandHeight animation\n    public isOpen = true;\n\n    propagateToggle() {\n      this.toggleEvent.emit();\n      this.isOpen = !this.isOpen;\n    }\n  \n\n    constructor(\n        private store: Store<MapSearchStoreState>,\n        public dialog: MatDialog,\n        private settingService: SettingsService,\n        private router: Router,\n        private location: Location,\n        private route: ActivatedRoute\n    ) {\n        super();\n        this.floorData = location.getState();\n    }\n\n    public ngOnInit(): void {\n        this.subscription(\n            'bookingLocations',\n            this.store.pipe(select(selectBookingLocations)).subscribe((next) => {\n                this.bookingLocations.next(next);\n                // update the map view MCK-1100 when location changes\n                const self = this;\n                setTimeout(() => {\n                    self.selectActiveBuilding(self.bookingLocations.value[0]);\n                }, 0);\n            })\n        );\n        this.subscription(\n            'bookingSpaceResults',\n            combineLatest([\n                this.store.pipe(\n                    select(selectMapFilteredResults),\n                    map((r: LoadingModel<FilteredSpaces>) => r.success)\n                ),\n                this.activeBuilding.pipe(filterUndefined<Building>()),\n                this.activeLevel.pipe(filterUndefined<BuildingLevel>()),\n            ]).subscribe(([filteredSpaces, building, level]) => {\n                const spacesFromSelection = (filteredSpaces.spaces || []).filter(\n                    (s) => !!s.map_id && s.zones.includes(building.id)\n                );\n                this.resultSpaces.next(spacesFromSelection);\n\n                const listeners: MapListener[] = [];\n                const styles: HashMap<HashMap<string | number>> = {};\n                const colour_map = this.settingService.get('app.explore.colors') || {};\n                spacesFromSelection.forEach((space) => {\n                    const status = filteredSpaces.statusMap[space.id];\n                    const mapStyle = generateMapStyleForSpace(space, status, colour_map);\n                    styles[`#${mapStyle.id}`] = mapStyle.styles;\n                    listeners.push(\n                        ...generateMapListenersForSpace(\n                            space,\n                            () => {},\n                            () => {},\n                            status !== 'in-use' ? \n                                () => {\n                                    this.activeSpace.next(space);\n                                    this.focusOnRoom();\n                                } \n                                : ()=> {}\n                        )\n                    );\n                });\n                this.style_map.next(styles);\n                this.listeners.next(listeners);\n            })\n        );\n        this.subscription(\n            'bookingResults',\n            this.resultSpaces\n                .pipe(withLatestFrom(this.activeSpace))\n                .subscribe(([resultSpaces, activeSpace]) => {\n                    this.spaceListOptions.next(resultSpaces.map(mapRoomToSelectOption));\n                })\n        );\n\n        this.subscription(\n            'storeResultedBuildings',\n            this.store.pipe(select(selectSelectedBuildingOptions)).subscribe((buildings) => {\n                this.resultBuildings.next(buildings);\n                // if we dont have active building yet, set it here.\n                if (buildings.length > 0 && !this.activeBuilding.value) {\n                    const firstBuilding = buildings[0];\n                    this.activeBuilding.next(firstBuilding);\n                }\n            })\n        );\n\n        this.subscription(\n            'activeBuildingChange',\n            this.activeBuilding\n                .pipe(\n                    filterUndefined<Building>(),\n                    map((b: Building) => b.levels)\n                )\n                .subscribe((levels) => {\n                    this.buildingLevelOptions.next(levels.map(mapBuildingLevelToOption));\n                })\n        );\n\n        // if levels change and active level no longer part of list, pick first.\n        this.subscription(\n            'updateActiveLevelOnActiveBuildingChange',\n            this.activeBuilding\n                .pipe(\n                    filterUndefined<Building>(),\n                    distinctUntilChanged(),\n                    withLatestFrom(this.activeLevel),\n                    map(\n                        ([building, activeLevel]) =>\n                            (activeLevel && building.levels.find((l) => l.id === activeLevel.id)) ||\n                            building.levels[0]\n                    )\n                )\n                .subscribe((level) => {\n                    this.activeLevel.next(level);\n                })\n        );\n\n        // re-request rooms every minute to update space status.\n        this.subscription(\n            'updateSpaceStatusInterval',\n            interval(60 * 1000)\n                .pipe(withLatestFrom(this.store.select(selectActiveForm)))\n                .subscribe(([, form]) => {\n                    this.store.dispatch(loadRoomsForResultsMap.request(roomFormDataToQuery(form) ));\n                })\n        );\n\n        // get the active form values\n        this.subscription(\n            'activeForm',\n            this.store\n                .pipe(select(selectActiveForm), distinctUntilChanged())\n                .subscribe((next: BookingFormData | undefined) => {\n                    if (next) {\n                        this.bookingFormData.next(next);\n                    }\n                })\n        );\n\n        if (this.floorData?.payload) {\n            this.floorDataParam = {\n                display: this.floorData?.payload.name,\n                value: this.floorData?.payload.id,\n            };\n            this.selectBuildingLevel(this.floorDataParam);\n            setTimeout(() => {\n                this.refreshFloorNumber();\n            });\n        }\n    }\n\n    public refreshFloorNumber(): void {\n        this.activeLevelOption = this.activeLevel.pipe(map(mapBuildingLevelToOption));\n    }\n\n    public zoomIn() {\n        if (this.zoom.value < MAX_ZOOM_LEVEL) {\n            this.zoom.next(this.zoom.value + 1);\n        }\n    }\n\n    public zoomOut() {\n        if (this.zoom.value > MIN_ZOOM_LEVEL) {\n            this.zoom.next(this.zoom.value - 1);\n        }\n    }\n\n    public displayOfficeInformation() {\n        this.dialog.open(OfficeInformationModalComponent, {\n            data: this.activeBuilding.value,\n            panelClass: 'mck-alert',\n            autoFocus: false,\n            backdropClass: 'mck-modal-backdrop',\n        });\n    }\n\n    public resetZoomLevels() {\n        this.zoom.next(MIN_ZOOM_LEVEL);\n        this.center.next(CENTER_POINT);\n        this.focusedRoom.next(undefined);\n    }\n\n    public selectActiveBuilding(selection: SelectOption<any>) {\n        this.resultBuildings\n            .pipe(\n                map((all) => all.find((b) => b.id === selection.value)),\n                take(1),\n                filterUndefined<Building>()\n            )\n            .subscribe((next) => {\n                this.activeBuilding.next(next);\n            });\n    }\n\n    public selectBuildingLevel(selection: SelectOption<any>) {\n        this.activeBuilding\n            .pipe(\n                map((b) => b.levels?.find((l) => l.id === selection?.value)),\n                take(1),\n                filterUndefined<BuildingLevel>()\n            )\n            .subscribe((next) => {\n\t\t\t\t\t\t\tthis.store.dispatch(loadRoomsForResultsMap.request(roomFormDataToQuery(this.bookingFormData.value) ));\n                this.activeLevel.next(next);\n            });\n    }\n\n    public selectActiveSpace(selection: SelectOption<any>) {\n        this.resultSpaces\n            .pipe(\n                map((all) => all.find((s) => s.id === selection?.value)),\n                take(1),\n                filterUndefined<Space>()\n            )\n            .subscribe((next) => {\n                this.activeSpace.next(next);\n            });\n    }\n\n    public focusOnRoom() {\n        this.activeSpace.pipe(take(1), filterUndefined<Space>()).subscribe((next) => {\n            let delay = 0;\n            if (next.level.id !== this.activeLevel.value.id) {\n                this.activeLevel.next(next.level);\n                delay = 500;\n            }\n            this.timeout(\n                'updateLevelAndRoom',\n                () => {\n                    const focusedRoom = mapResultsToViewModels(\n                        [this.activeSpace.value],\n                        [this.activeLevel.value],\n                        [this.activeBuilding.value]\n                    );\n                    this.focusedRoom.next(focusedRoom[0]);\n                    this.focusedMapSpace.next(roomToMapFeature(this.focusedRoom.value, this));\n                    this.zoom.next(MAX_ZOOM_LEVEL);\n                },\n                delay\n            );\n        });\n    }\n\n    public roomSelected(room: RoomResultsViewModel) {\n        // submit\n        this.store.dispatch(\n            storeBookingFormData({\n                payload: {\n                    ...this.bookingFormData.value,\n                    selectedRoom: room,\n                },\n            })\n        );\n\n        this.router.navigate(['room'], { relativeTo: this.route });\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MapSearchComponent } from './map-search/map-search.component';\nimport { MapControlsComponent } from './map-controls/map-controls.component';\nimport { MatButtonModule } from '@angular/material/button';\nimport { LibraryModule } from '@acaprojects/ngx-interactive-map';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MapFiltersComponent } from './map-filters/map-filters.component';\nimport { UiModule } from '@mckinsey-converge/ui';\nimport { OfficeInformationModalComponent } from './office-information-modal/office-information-modal.component';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MapOverlayComponent } from './map-overlay/map-overlay.component';\n\nexport const mapModuleImports = [\n    CommonModule,\n    MatButtonModule,\n    LibraryModule,\n    MatSelectModule,\n    UiModule,\n    MatDialogModule\n];\n\nexport const mapModuleDeclarations = [\n    MapSearchComponent,\n    MapControlsComponent,\n    MapFiltersComponent,\n    OfficeInformationModalComponent,\n    MapOverlayComponent\n];\n\n@NgModule({\n    declarations: [\n        ...mapModuleDeclarations\n    ],\n    exports: [\n        ...mapModuleDeclarations\n    ],\n    imports: [\n        ...mapModuleImports\n    ]\n})\nexport class MapModule {\n}\n","import { SelectOption } from '@mckinsey-converge/ui';\nimport {\n    Space,\n    SpaceStatus,\n    RoomResultsViewModel,\n    MapListener\n} from '@mckinsey-converge/data-common';\nimport {\n    HashMap,\n    Point\n} from '@mckinsey-converge/base';\nimport { MapFeature } from '@acaprojects/ngx-interactive-map/lib/helpers/map.interfaces';\nimport { MapOverlayComponent } from 'src/app/map/map-overlay/map-overlay.component';\n\nexport const MIN_ZOOM_LEVEL = 1;\nexport const MAX_ZOOM_LEVEL = 10;\nexport const CENTER_POINT: Point = { x: 0.5, y: 0.5 };\n\nconst mapSpaceStatusToDisplay = (status: SpaceStatus): string => {\n    switch (status) {\n        case SpaceStatus.NotBookable:\n            return 'Not Bookable';\n        case SpaceStatus.Requestable:\n            return 'Available by Request';\n        case SpaceStatus.Unavailable:\n            return 'In Use';\n        case SpaceStatus.Available:\n        default:\n            return 'Available';\n    }\n};\n\nconst mapSpaceStatusToOption = (status: SpaceStatus) => ({\n    value: status,\n    display: mapSpaceStatusToDisplay(status)\n});\n\nexport const legendOptions = (): SelectOption<any>[] => [\n    SpaceStatus.Available,\n    SpaceStatus.Requestable,\n    SpaceStatus.Unavailable,\n    SpaceStatus.NotBookable\n].map(mapSpaceStatusToOption);\n\n\nexport const defaultMapBookingRules = [\n    'Rooms showing yellow are restricted and must be requested',\n    'Rooms showing green are available to book for one hour',\n    'Rooms showing red are booked',\n    'Rooms showing grey are not bookable but may be used if they are empty'\n];\n\nexport const defaultMapBookingSubtitle = 'You may request restricted rooms but they will need to be approved by an admin';\n\nexport const generateMapStyleForSpace = (\n    space: Space,\n    status: SpaceStatus,\n    colorStatusMap: HashMap) => {\n    const id =\n        `${space.map_id}`.indexOf('area') < 0\n            ? `area-${space.map_id}-status`\n            : space.map_id;\n    return (\n        {\n            id,\n            styles: {\n                fill: colorStatusMap[`space-${status}`] || '#000',\n                opacity: 0.99\n            }\n        });\n};\n\n/**\n * Generates actions for mapview handling.\n * @param space - the space to generate\n * @param clickSpace - called when clicked or touched\n * @param hoverSpace - called when you hover over a space\n * @param leaveSpace - called when you leave a space.\n */\nexport const generateMapListenersForSpace = (\n    space: Space,\n    hoverSpace: () => void,\n    leaveSpace: () => void,\n    clickSpace: () => void\n): MapListener[] => {\n    const id =\n        `${space.map_id}`.indexOf('area') < 0\n            ? `area-${space.map_id}-status`\n            : space.map_id;\n    const listeners: MapListener[] = [];\n    listeners.push({\n        id,\n        event: 'mouseenter',\n        callback: hoverSpace\n    });\n    listeners.push({\n        id,\n        event: 'mouseleave',\n        callback: leaveSpace\n    });\n    if (space.bookable) {\n        listeners.push({\n            id,\n            event: 'click',\n            callback: clickSpace\n        });\n        listeners.push({\n            id,\n            event: 'touchend',\n            callback: clickSpace\n        });\n    }\n    return listeners;\n};\n\n\nexport const spaceToMapFeature = (space: Space): MapFeature => ({\n    id: `area-${space.map_id}-status`,\n    coordinates: null,\n    content: MapOverlayComponent,\n    data: {\n        ...space\n    }\n});\n\nexport const roomToMapFeature = (room: RoomResultsViewModel, parentComponent?: any): MapFeature => ({\n    id: `area-${room.space.map_id}-status`,\n    coordinates: null,\n    content: MapOverlayComponent,\n    data: {\n        ...room.space,\n        parentComponent,\n        room\n    }\n});","import {\n    Component,\n    Inject,\n    ViewEncapsulation\n} from '@angular/core';\nimport { HashMap } from '@mckinsey-converge/base';\nimport { \n    BookingRuleDetails,\n    Building,\n} from '@mckinsey-converge/data-common';\nimport {\n    MAT_DIALOG_DATA,\n    MatDialogRef\n} from '@angular/material/dialog';\nimport {\n    defaultMapBookingRules,\n    defaultMapBookingSubtitle\n} from 'src/app/map/map.utils';\n\n@Component({\n    selector: 'app-office-information-modal',\n    template: `\n        <mat-dialog-content>\n            <div class=\"mck-column modal-heading\">\n                <div class=\"header\">Booking in {{building?.name}}</div>\n                <div class=\"info\">{{targetLinks(info)}}</div>\n            </div>\n            <div class=\"mck-column modal-body\">\n                <ul class=\"modal-body-list\">\n                    <li\n                        class=\"modal-body-content\"\n                        *ngFor=\"let item of rules\" [innerHTML]=\"targetLinks(item)\"></li>\n                </ul>\n                <div>\n                    <div *ngFor=\"let group of other_rules\">\n                        <span class=\"modal-body-header\">{{group.title}}</span>\n                        <ul class=\"modal-body-list\">\n                            <li\n                                class=\"modal-body-content\"\n                                *ngFor=\"let item of group.rules\" [innerHTML]=\"targetLinks(item)\"></li>\n                        </ul>\n                    </div>\n                </div>\n                <span class=\"modal-body-header\">When booking from maps:</span>\n                <ul class=\"modal-body-list\">\n                    <li\n                        class=\"modal-body-content\"\n                        *ngFor=\"let item of map_rules\" [innerHTML]=\"item\"></li>\n                </ul>\n                <span class=\"modal-body-header\">\n                    <p *ngIf=\"contact\">\n                        For more info email: <a target=\"mail\" [href]=\"'mailto:' + contact\">{{contact}}</a>\n                    </p>\n                    <p *ngIf=\"customHtml\" [innerHTML]=\"targetLinks(customHtml)\"></p>\n                </span>\n            </div>\n            <div class=\"mck-column modal-body-footer\">\n                <mck-modal-button-row primaryLabel=\"Ok\" (primarySubmit)=\"closeModal()\"></mck-modal-button-row>\n            </div>\n        </mat-dialog-content>\n    `,\n    styleUrls: ['./office-information-modal.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n})\nexport class OfficeInformationModalComponent {\n    constructor(@Inject(MAT_DIALOG_DATA) public building: Building,\n                private dialogRef: MatDialogRef<OfficeInformationModalComponent>) {\n    }\n\n\n    /** Booking rule details */\n    public get rules(): string[] {\n        const building: Building = this.building;\n        const details: BookingRuleDetails = building?.booking_details;\n        return details?.rules || [] as any;\n    }\n\n    /** Booking rule details */\n    public get info(): string {\n        const building: Building = this.building;\n        const details: BookingRuleDetails = building?.booking_details;\n        return details?.info || defaultMapBookingSubtitle;\n    }\n\n    public get customHtml(): string | undefined {\n        const building: Building = this.building;\n        const details: BookingRuleDetails = building?.booking_details;\n        return details?.custom_html;\n    }\n\n    /** Booking map rule details */\n    public get map_rules(): string[] {\n        const building: Building = this.building;\n        const details: BookingRuleDetails = building?.booking_details;\n        return details?.map_rules ||  defaultMapBookingRules as any;\n    }\n\n    /** Other special booking rules */\n    public get other_rules(): { title: string, rules: string[] }[] {\n        const building: Building = this.building;\n        const details: BookingRuleDetails = building?.booking_details;\n        const rules: HashMap = (details as any)?.other_rules || {};\n        return Object.keys(rules).reduce((a, v) => {\n            \n            a.push({ title: v, rules: rules[v] || [] });\n            return a;\n        }, []);\n    }\n\n    public get contact(): string {\n        const building: Building = this.building;\n        const details: BookingRuleDetails = building?.booking_details;\n        return details?.contact || '';\n    }\n\n    public get link(): { url?: string, name?: string } {\n        const building: Building = this.building;\n        const details: BookingRuleDetails = building?.booking_details;\n        return details?.link || {};\n    }\n\n    public closeModal() {\n        this.dialogRef.close();\n    }\n\n    public targetLinks(info: string) {\n        const regex = /<a /ig;\n        return info.replace(regex, '<a target=\"_blank\" ');\n    }\n}\n","import {\n    NgModule,\n    Type\n} from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport {\n    FormsModule,\n    ReactiveFormsModule\n} from '@angular/forms';\nimport { RouterModule } from '@angular/router';\nimport { EditorModule } from '@tinymce/tinymce-angular';\nimport { ComposerModule } from '@placeos/composer';\n\nimport { ScrollingModule } from '@angular/cdk/scrolling';\n\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatRippleModule } from '@angular/material/core';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatTabsModule } from '@angular/material/tabs';\n\nimport { IvyCarouselModule } from 'angular-responsive-carousel';\n\nimport { APipesModule } from '@acaprojects/ngx-pipes';\nimport { AInteractiveMapModule } from '@acaprojects/ngx-interactive-map';\nimport { ACustomEventsModule } from '@acaprojects/ngx-custom-events';\nimport { BaseDirective } from '@mckinsey-converge/base';\n\nimport { LoginComponent } from '../login/login.component';\nimport { TopbarHeaderComponent } from '../components/topbar-header/topbar-header.component';\nimport { ResponsiveInlineImagesComponent } from '../components/responsive-inline-images/responsive-inline-images.component';\nimport { OverlayMenuComponent } from '../components/overlay-menu/overlay-menu.component';\nimport { FooterMenuComponent } from '../components/footer-menu/footer-menu.component';\nimport { MapControlsComponent } from '../components/map-controls/map-controls.component';\n\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\nimport { LegacyUiModule } from '@mckinsey-converge/legacy-ui';\nimport { LegacyOverlaysModule } from '@mckinsey-converge/legacy-overlays';\nimport { DragDropModule } from '@angular/cdk/drag-drop';\nimport { CdkTableModule } from '@angular/cdk/table';\n\nconst COMPONENTS: Type<any>[] = [\n    BaseDirective,\n    LoginComponent,\n    TopbarHeaderComponent,\n    ResponsiveInlineImagesComponent,\n    OverlayMenuComponent,\n    FooterMenuComponent,\n    MapControlsComponent\n];\n\nconst MATERIAL_MODULES: any[] = [\n    MatButtonModule,\n    MatSnackBarModule,\n    MatDialogModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatProgressSpinnerModule,\n    MatProgressBarModule,\n    MatAutocompleteModule,\n    MatSelectModule,\n    MatChipsModule,\n    MatRippleModule,\n    MatMenuModule,\n    MatCheckboxModule,\n    MatTooltipModule,\n    MatRadioModule,\n    MatTabsModule,\n    MatSlideToggleModule\n];\n\nconst CDK_MODULES: any[] = [\n    ScrollingModule,\n    DragDropModule,\n    CdkTableModule\n];\n\n\n@NgModule({\n    declarations: [\n        ...COMPONENTS\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        APipesModule,\n        AInteractiveMapModule,\n        ACustomEventsModule,\n        RouterModule,\n        EditorModule,\n        ComposerModule,\n        LegacyUiModule,\n        LegacyOverlaysModule,\n        IvyCarouselModule,\n        ...MATERIAL_MODULES,\n        ...CDK_MODULES\n    ],\n    exports: [\n        APipesModule,\n        AInteractiveMapModule,\n        ACustomEventsModule,\n        LegacyUiModule,\n        LegacyOverlaysModule,\n        ...COMPONENTS,\n        ...MATERIAL_MODULES,\n        ...CDK_MODULES\n    ]\n})\nexport class SharedContentModule {\n}\n","import { Component, OnInit } from '@angular/core';\nimport { filter, first, map, distinctUntilChanged, shareReplay } from 'rxjs/operators';\nimport {\n    ApplicationLoadingState,\n    BaseDirective,\n    closestToTimeSlot,\n    closestToTimeSlotTz,\n    LoadingState,\n} from '@mckinsey-converge/base';\nimport {\n    ApplicationIcon,\n    ApplicationService,\n    Building,\n    BuildingCity,\n    defaultRoomSizeOption,\n    DEFAULT_BOOKING_DURATION,\n    flattenDisplayOffices,\n    internalBookingTypeOption,\n    mapBuildingToSelectOption,\n    mapCityToAllSelectOption,\n    mapResultsToViewModels,\n    OrganisationService,\n    SpacesService,\n    storeBookingFormData,\n    availabilityOptionsToQuery,\n    bookingTypeOptions,\n    selectFilteredDiffSizeResults,\n    flattenBuildingsWithLevels,\n    clearRoomFilters,\n    allBookingTypeOption,\n    roomSizeOptions,\n    roomSizeOptionsKiosk,\n} from '@mckinsey-converge/data-common';\nimport { BehaviorSubject, combineLatest, Observable } from 'rxjs';\nimport { select, Store } from '@ngrx/store';\nimport { loadUser, selectHasUserData, UserStoreState } from '@mckinsey-converge/user';\nimport { ComposerService } from '@placeos/composer';\nimport { ActivatedRoute, Router, NavigationStart, Event as NavigationEvent } from '@angular/router';\n\nimport {\n    DateNow,\n    DateTZ,\n    convertLocalTimestampToTimezonedDateTz,\n} from '@mckinsey-converge/date-tz';\nimport { DateTime } from 'luxon';\nimport { SelectOption } from '@mckinsey-converge/ui';\nimport { selectCurrentUser } from '@mckinsey-converge/user';\nimport {\n    buildingStateSelector,\n    loadBuildings,\n    selectBuildingOptionsGroupedByCity,\n} from '@mckinsey-converge/buildings';\nimport { loadDiffSizeResults, loadRoomsForResults, loadRoomsForResultsMap } from '@mckinsey-converge/rooms';\nimport { timeStamp } from 'console';\nimport { filterUndefined } from '@mckinsey-converge/rx-utils';\n\n@Component({\n    selector: 'app-shell-wrapper',\n    templateUrl: './shell.component.html',\n    styleUrls: ['./shell.component.scss'],\n})\nexport class ShellWrapperComponent extends BaseDirective implements OnInit {\n    /** Loading state of the application */\n    public loading_state: ApplicationLoadingState;\n    /** Logo of the application organisation */\n    public logo: ApplicationIcon;\n\n    private userLoading = new BehaviorSubject<boolean>(true);\n    public isQRCode = new BehaviorSubject<boolean>(true);\n    public buildingOptions = new BehaviorSubject<SelectOption<any>[]>([]);\n    public zone_id: any;\n    public floor: any;\n\n    constructor(\n        private _service: ApplicationService,\n        private placeOs: ComposerService,\n        private _org: OrganisationService,\n        private activatedRoute: ActivatedRoute,\n        private _spaces: SpacesService,\n        private router: Router,\n        private store: Store<UserStoreState>\n    ) {\n        super();\n\n        // Initialize roomID\n        let roomId = null;\n        if (this.activatedRoute.snapshot.queryParamMap.get('id')) {\n            roomId = this.activatedRoute.snapshot.queryParamMap.get('id');\n        } else if (localStorage.oauth_redirect && localStorage.oauth_redirect.includes('?id=')) {\n            roomId = localStorage.oauth_redirect.split('=')[1];\n        }\n        // roomId ? this.isQRCode.next(false) : this.isQRCode.next(true);\n\n        // Initialize zoneID\n        let zone_id = null;\n        if (this.activatedRoute.snapshot.queryParamMap.get('zone_id')) {\n            zone_id = this.activatedRoute.snapshot.queryParamMap.get('zone_id');\n        } else if (\n            localStorage.oauth_redirect &&\n            localStorage.oauth_redirect.includes('?zone_id=')\n        ) {\n            zone_id = localStorage.oauth_redirect.split('=')[1];\n            if (zone_id.includes('&')) {\n                zone_id = zone_id.split('&')[0];\n            }\n        }\n\n        this.zone_id = zone_id;\n\n        // Initialize floor number\n        let floor = null;\n        if (this.activatedRoute.snapshot.queryParamMap.get('floor')) {\n            floor = this.activatedRoute.snapshot.queryParamMap.get('floor');\n        } else if (localStorage.oauth_redirect && localStorage.oauth_redirect.includes('&floor=')) {\n            floor = localStorage.oauth_redirect.split('&floor=')[1];\n        }\n        this.floor = floor;\n        (floor && zone_id) || roomId ? this.isQRCode.next(false) : this.isQRCode.next(true);\n    }\n\n    /** Whether the user needs to login */\n    public get show_login(): Observable<boolean> {\n        return this.userLoading;\n    }\n\n    /** Whether a module is still loading data */\n    public get is_loading(): Observable<boolean> {\n        return this.userLoading;\n    }\n\n    /** List of modules with a loading state */\n    public get loading_state_list(): LoadingState[] {\n        const list: LoadingState[] = [];\n        for (const mod in this.loading_state) {\n            if (this.loading_state[mod]) {\n                list.push(this.loading_state[mod]);\n            }\n        }\n        return list;\n    }\n\n    /**\n     * Function: To check and fetch room details if available for the scanned roomId\n     * @param buildings\n     * @param roomId\n     */\n    public checkRoomId(buildings: Building[], roomId: string) {\n        let formGroup = {\n            location: [],\n            date: closestToTimeSlot(DateTime.now(), 15).valueOf(),\n            dateTz: closestToTimeSlotTz(new DateTZ({ date: Date.now(), is_local_tz: true }), 15),\n            duration: DEFAULT_BOOKING_DURATION,\n            bookingType: bookingTypeOptions[0],\n            roomSize: defaultRoomSizeOption,\n            selectedRoom: null,\n            timezone: null,\n            buildings: buildings,\n        };\n\n        const params = {\n            room_ids: roomId,\n        };\n\n        const availibityParams = {\n            room_ids: roomId,\n            dateTz: closestToTimeSlotTz(new DateTZ({ date: Date.now(), is_local_tz: false }), 15),\n            duration: DEFAULT_BOOKING_DURATION,\n            hide_declined: true,\n        };\n        const query = availabilityOptionsToQuery(availibityParams);\n        this._spaces.queryRooms(query).subscribe(\n            (res) => {\n                //Convert raw data into API object\n                const list = res.map((i) => this._spaces.process(i));\n                this._spaces.setSpaceList(list);\n                /**\n                 * Building form data to resue to navigate to result page if room is not available!\n                 */\n                const bookingRoom = mapResultsToViewModels(\n                    list,\n                    list[0].building.levels,\n                    buildings\n                );\n                const city = list[0].building.city;\n                const timezone = list[0].timezone;\n                const grouped_by_city = {\n                    key: { name: city, timezone },\n                    value: buildings?.filter((bld) => bld.city === city) || [],\n                };\n                const city_buildings = grouped_by_city.value.map((bld) =>\n                    mapBuildingToSelectOption(grouped_by_city.key.name, bld)\n                );\n                const options = [mapCityToAllSelectOption(grouped_by_city.key), ...city_buildings];\n\n                const seledtedZone: SelectOption<any> = options.filter(\n                    (e) => e.value === list[0].building.id\n                )[0];\n                const buildingTimezone = list[0].timezone;\n                // form group data\n                formGroup = {\n                    location: [seledtedZone],\n                    date: closestToTimeSlot(DateTime.now(), 15).valueOf(),\n                    dateTz: closestToTimeSlotTz(\n                        new DateTZ({ date: Date.now(), is_local_tz: false }),\n                        15\n                    ).toZone(buildingTimezone),\n                    duration: DEFAULT_BOOKING_DURATION,\n                    bookingType:\n                        list[0].internal_or_external === 'internal'\n                            ? bookingTypeOptions[0]\n                            : bookingTypeOptions[1],\n                    roomSize: defaultRoomSizeOption,\n                    selectedRoom: bookingRoom[0],\n                    timezone: buildingTimezone,\n                    buildings: buildings,\n                };\n\n                this.store.dispatch(\n                    storeBookingFormData({\n                        payload: formGroup,\n                    })\n                );\n                this.router.navigate([`../home/results/room`], {\n                    state: { payload: { ...formGroup, offset: 0 } },\n                });\n                localStorage.oauth_redirect = localStorage.oauth_redirect.split('?')[0];\n                this.isQRCode.next(true);\n            },\n            (error) => {\n                // console.log(error);\n                this.isQRCode.next(true);\n                // this.router.navigate([`home/`]); // to navigate to default route if room dont exists\n                /**\n                 *  Navigate to room result page if no room/id exist in the db/ removed from the db in future -\n                 */\n                this.store.dispatch(storeBookingFormData({ payload: formGroup }));\n                this.router.navigate([`../home/results`], {\n                    state: { payload: { ...formGroup, offset: 0 } },\n                    queryParams: { display: 'list' },\n                });\n            }\n        );\n    }\n\n    public ngOnInit(): void {\n        // when qr code lands on a url for the second time, reload it (to compensate for different browser/device combination default behaviors)\n        this.subscription(\n            'navigationEventShell',\n            this.router.events\n                .pipe(filter((event) => event instanceof NavigationStart))\n                .subscribe((event: NavigationEvent) => {\n                    if (event instanceof NavigationStart) {\n                        if (\n                            event.navigationTrigger === 'popstate' &&\n                            (event.url.includes('home?zone_id=') || event.url.includes('home?id='))\n                        ) {\n                            this.userLoading.next(true);\n                            window.location.reload();\n                        }\n                    }\n                })\n        );\n\n        let roomId = null;\n        if (this.activatedRoute.snapshot.queryParamMap.get('id')) {\n            roomId = this.activatedRoute.snapshot.queryParamMap.get('id');\n        } else if (localStorage.oauth_redirect && localStorage.oauth_redirect.includes('?id=')) {\n            roomId = localStorage.oauth_redirect.split('=')[1];\n        }\n\n        if (roomId) {\n            this.subscription(\n                'buildings',\n                this._org\n                    .listen('buildings')\n                    .pipe(first((_) => !!_ && !!_.length))\n                    .subscribe((bld_list: Building[]) => {\n                        this.checkRoomId(bld_list, roomId);\n                    })\n            );\n        }\n\n        if (this.zone_id && this.floor) {\n            this.subscription(\n                'buildings',\n                this._org\n                    .listen('buildings')\n                    .pipe(first((_) => !!_ && !!_.length))\n                    .subscribe((bld_list: Building[]) => {\n                        const building = bld_list.filter((el) => el.id === this.zone_id);\n\n                        const city = building[0].city;\n                        const timezone = building[0].timezone;\n\n                        const grouped_by_city = {\n                            key: { name: city, timezone },\n                            value: building || [],\n                        };\n                        const city_buildings = grouped_by_city.value.map((bld) =>\n                            mapBuildingToSelectOption(grouped_by_city.key.name, bld)\n                        );\n                        const options = [\n                            mapCityToAllSelectOption(grouped_by_city.key),\n                            ...city_buildings,\n                        ];\n\n                        const seledtedZone: SelectOption<any> = options.filter(\n                            (e) => e.value === building[0].id\n                        )[0];\n                        const buildingTimezone = building[0].timezone;\n                        // form group data\n                        const addMin = DateTime.now().get('minute') % 5 === 0 ? 1 : 0;\n                        const formGroup = {\n                            location: [seledtedZone],\n                            date: closestToTimeSlot(\n                                DateTime.now().plus({ minutes: addMin }),\n                                15\n                            ).valueOf(),\n                            dateTz: closestToTimeSlotTz(\n                                new DateTZ({\n                                    date: DateTime.now().plus({ minutes: addMin }),\n                                    is_local_tz: false,\n                                    building_tz: buildingTimezone,\n                                }),\n                                15\n                            ),\n                            duration: 35,\n                            bookingType: allBookingTypeOption, // all rooms (including internal and external both)\n                            roomSize: roomSizeOptionsKiosk[3],\n                            selectedRoom: null,\n                            timezone: buildingTimezone,\n                            buildings: bld_list,\n                        };\n\n                        const query2 = {\n                            // capacity: 3,\n                            locations: this.zone_id,\n                            // capacity_max: 9,\n                            // diff_capacity: true,\n                            hide_declined: true,\n                            dateTz: closestToTimeSlotTz(\n                                new DateTZ({\n                                    date: DateTime.now().plus({ minutes: addMin }),\n                                    is_local_tz: false,\n                                    building_tz: buildingTimezone,\n                                }),\n                                15\n                            ),\n                            duration: 35,\n                        };\n\n                        //clear search filters first if any applied previously\n                        this.store.dispatch(clearRoomFilters());\n\n                        this.store.dispatch(loadRoomsForResults.clear());\n                        this.store.dispatch(storeBookingFormData({ payload: formGroup }));\n\n                        this.store.dispatch(loadRoomsForResults.request(query2));\n                        localStorage.oauth_redirect = '';\n                        // To do: navigate to floor-map route\n                        this.router.navigate([`../home/results`], {\n                            state: {\n                                payload: this.floor,\n                                building: building,\n                                floorMap: true,\n                                url: window.location.href,\n                            },\n                            queryParams: { display: '' },\n                        });\n                        this.isQRCode.next(true);\n                    })\n            );\n        }\n\n        this.subscription(\n            'loading',\n            this._service.listen<ApplicationLoadingState>('loading').subscribe((loading) => {\n                this.loading_state = loading;\n            })\n        );\n\n        this._service.initialised.pipe(first((_) => _)).subscribe(() => {\n            this.logo = this._service.setting('app.logo_light') || { type: 'icon' };\n        });\n\n        /**\n         * Load current user into redux. this is meant to remove old way of loading user from user's service.\n         */\n        this.subscription(\n            'currentUser',\n            combineLatest([\n                this.store.pipe(select(selectHasUserData)),\n                this.placeOs.initialised,\n                this.isQRCode, // added to track room details if QR code used to open app\n            ])\n                .pipe(\n                    filter(([_, initialized, isQRCodeScanedAndReady]) => {\n                        console.log(_);\n                        return initialized && isQRCodeScanedAndReady;\n                    })\n                )\n                .subscribe(([next]) => {\n                    this.userLoading.next(!next);\n                    if (!next) {\n                        this.store.dispatch(loadUser.request());\n                    }\n                })\n        );\n    }\n}\n","<div class=\"shell\">\n    <div class=\"view\" *ngIf=\"!(show_login | async)\">\n        <router-outlet></router-outlet>\n    </div>\n    <div class=\"login-module\" *ngIf=\"(show_login | async)\">\n        <app-login></app-login>\n    </div>\n    <div class=\"loading-block\" *ngIf=\"is_loading | async\">\n        <div class=\"info-block\">\n            <div class=\"spinner\">\n                <img src=\"assets/img/loader.gif\" />\n            </div>\n            <div class=\"text\">Converge is loading</div>\n        </div>\n    </div>\n</div>\n","export enum Urls {\n    LearnMore = 'https://our-firm.intranet.mckinsey.com/covid-portal/travel',\n    Feedback = 'mailto:converge_feedback@mckinsey.com?subject=Feedback for page: ',\n    Help = 'https://mckinsey.service-now.com/ghd/?id=product&sys_id=9a4fe901db46ff842bf5453f299619e9&search_term=converge',\n    OfficeContacts = 'https://our-firm.intranet.mckinsey.com/ourfirm/geographies',\n}\n\nexport const generateFeedbackUrl = (page: string) => {\n    return `${Urls.Feedback}${page}`;\n};\n","import { EnvironmentData } from '@mckinsey-converge/environment';\n\nexport const environment: EnvironmentData = {\n    production: true,\n    hmr: false,\n    heap_io_id: 91016686,\n};\n","import { SettingsData } from '@mckinsey-converge/data-common';\n\n;\n/**\n * GENERAL APPLICATION SETTINGS\n */\nconst general = {\n    menu: {\n        items: [],\n        copyright: 'McKinsey & Company',\n        position: 'left'\n    }\n};\n\n/**\n * HOME PAGE SETTINGS\n */\nconst home = {\n    background: 'assets/img/skyline.jpg',\n    tiles: [\n        {\n            name: 'Book',\n            route: '/book/spaces',\n            icon: {\n                type: 'icon',\n                class: 'custom-book'\n            }\n        },\n        {\n            name: 'Maps',\n            route: '/explore/space',\n            icon: {\n                type: 'icon',\n                class: 'custom-spaces'\n            }\n        },\n        {\n            name: 'My Day',\n            route: '/schedule',\n            icon: {\n                type: 'icon',\n                class: 'custom-schedule'\n            }\n        }\n    ]\n};\n/**\n * HELP/SUPPORT SETTINGS\n */\nconst help = {\n    tiles: [],\n    columns: 2\n};\n/**\n * BOOKING FLOW SETTINGS\n */\nconst booking = {\n    booking_types: [\n        { name: 'Internal', id: 'internal' },\n        { name: 'External', id: 'external' },\n    ],\n    show_fields: [\n        'attendees',\n        'body',\n        'catering',\n        'dateTz',\n        'duration',\n        'organiser',\n        'title',\n        'type',\n        'all_day',\n        'needs_space',\n        'has_catering'\n    ],\n    html_body: false,\n    multiple_spaces: true,\n    desk_start: 9\n};\n/*===========================*\\\n||  SPACE LISTING SETTINGS   ||\n\\*===========================*/\nconst space_display = {\n    show_images: false\n};\n/*===========================*\\\n||  USER DIRECTORY SETTINGS  ||\n\\*===========================*/\nconst directory = {\n    show_avatars: true,\n    min_search_length: 3\n};\n/*===========================*\\\n||    EXPLORE MAP SETTINGS   ||\n\\*===========================*/\nconst explore = {\n    colors: {\n        'space-available': '#43a047',\n        'space-requestable': '#ffb300',\n        'space-unavailable': '#e53935',\n        'space-in-use': '#d4483e',\n        'space-not-bookable': '#ccc',\n        'desk-available': '#43a047',\n        'desk-available-stroke': '#1b5e20',\n        'desk-unavailable': '#e53935',\n        'desk-unavailable-stroke': '#b71c1c',\n        'desk-reserved': '#ffb300',\n        'desk-reserved-stroke': '#ff6f00',\n        'desk-not-bookable': '#fff',\n        'desk-not-bookable-stroke': '#ccc',\n        'zone-low': '#43a047',\n        'zone-medium': '#ffb300',\n        'zone-high': '#e53935'\n    },\n    can_select_building: true,\n    show_legend_group_names: false,\n    show_timeline: true,\n    legend: {\n        General: [\n            { key: 'space-available', name: 'Available' },\n            { key: 'space-requestable', name: 'Available by request' },\n            { key: 'space-unavailable', name: 'In use' },\n            { key: 'space-not-bookable', name: 'Not Bookable' }\n        ]\n    }\n};\n\n/*=========================*\\\n||    DAY VIEW SETTINGS    ||\n\\*=========================*/\nconst day_view = {\n    dragdrop: false,\n};\n\n\n/**\n * ROOT APPLICATION SETTINGS\n */\nconst app = {\n    title: 'McKinsey & Company',\n    description: 'McKinsey & Company Staff UI written with Angular Framework',\n    short_name: 'STAFF',\n    logo_light: {\n        type: 'img',\n        src: 'assets/img/logo.svg',\n        background: ''\n    },\n    logo_dark: {\n        type: 'img',\n        src: 'assets/img/logo-inverse.svg',\n        background: ''\n    },\n    heap_io: {\n        app_id: 3540602199,\n        force_ssl: true,\n        secure_cookie: true,\n        disable_text_capture: true,\n        cookie_path: '/staff/'\n    },\n    general,\n    home,\n    help,\n    booking,\n    space_display,\n    directory,\n    explore,\n    day_view\n}\n\n\n/**\n * ROOT SETTIGNS\n */\nexport const DEFAULT_SETTINGS: SettingsData<typeof app> = {\n    debug: true,\n    composer: {\n        domain: '',\n        route: '/staff',\n        protocol: '',\n        port: '',\n        use_domain: false,\n        local_login: false\n    },\n    app,\n    mock: false,\n    frontend: 'staff',\n};\n","import { ApplicationRef, NgModuleRef } from '@angular/core';\nimport { createNewHosts } from '@angularclass/hmr';\n\nexport const hmrBootstrap = (\n    module: any,\n    bootstrap: () => Promise<NgModuleRef<any>>,\n) => {\n    let ngModule: NgModuleRef<any>;\n    module.hot.accept();\n    bootstrap().then(mod => (ngModule = mod));\n    module.hot.dispose(() => {\n        const appRef: ApplicationRef = ngModule.injector.get(ApplicationRef);\n        const elements = appRef.components.map(c => c.location.nativeElement);\n        const makeVisible = createNewHosts(elements);\n        ngModule.destroy();\n        makeVisible();\n    });\n};\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\nimport { environment } from './environments/environment';\nimport { hmrBootstrap } from './hmr';\nimport { AppModule } from './app/app.module';\n\nif (environment.production) {\n    enableProdMode();\n}\n\nconst bootstrap = () => platformBrowserDynamic().bootstrapModule(AppModule);\n\n// comes from https://medium.com/wizardnet972/hot-module-replacement-with-angular-cli-5fc7a3ae4a9c\nif (environment.hmr) {\n    if ((module as any).hot) {\n        hmrBootstrap(module, bootstrap);\n    } else {\n        console.error('HMR is not enabled for webpack-dev-server!');\n        console.log('Are you using the --hmr flag for ng serve?');\n    }\n} else {\n    bootstrap().catch(err => console.log(err));\n}\n"]}