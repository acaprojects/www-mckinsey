(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{cmhh:function(e,t,n){"use strict";n.r(t);var i=n("ofXK"),o=n("tyNb"),a=n("3Pt+"),r=n("Cvi9"),c=n("OaWH"),s=n("IWZj"),l=n("fXoL");function d(e,t){1&e&&l.Rb(0,"booking-desk-flow")}function u(e,t){1&e&&l.Rb(0,"booking-space-flow")}let m=(()=>{class e extends s.a{constructor(e,t,n){super(),this._service=e,this._route=t,this._router=n}ngOnInit(){this._service.title="Book",this.subscription("route.params",this._route.paramMap.subscribe(e=>{e.has("flow")&&(this.flow=e.get("flow"))})),this.subscription("router.events",this._router.events.subscribe(e=>{e instanceof o.c&&e.url.indexOf("book")<0&&localStorage.removeItem("ACA_STAFF.booking_form_data")}))}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(c.a),l.Qb(o.a),l.Qb(o.d))},e.\u0275cmp=l.Kb({type:e,selectors:[["app-bookings"]],features:[l.zb],decls:10,vars:4,consts:[[1,"booking","page"],[1,"header"],[3,"menu","menuChange"],[1,"body"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"footer"],[3,"show","showChange"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.Wb(1,"header",1),l.Wb(2,"a-topbar-header",2),l.lc("menuChange",(function(e){return t.show_menu=e})),l.Vb(),l.Vb(),l.Wb(3,"main",3),l.Ub(4,4),l.Lc(5,d,1,0,"booking-desk-flow",5),l.Lc(6,u,1,0,"booking-space-flow",6),l.Tb(),l.Vb(),l.Wb(7,"footer",7),l.Rb(8,"a-footer-menu"),l.Vb(),l.Vb(),l.Wb(9,"a-overlay-menu",8),l.lc("showChange",(function(e){return t.show_menu=e})),l.Vb()),2&e&&(l.Cb(2),l.vc("menu",t.show_menu),l.Cb(2),l.vc("ngSwitch",t.flow),l.Cb(1),l.vc("ngSwitchCase","desks"),l.Cb(4),l.vc("show",t.show_menu))},styles:[".page[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;flex-direction:column}.page[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}.body[_ngcontent-%COMP%]{min-width:50%;min-height:50%;flex:1}"]}),e})();var f,h,b=n("PCNd"),g=n("xhdr"),p=n("5RMF"),v=n("Ofvs"),_=n("SxV6"),y=n("g0I+"),C=n("0IaG"),w=n("7c/B"),O=n("Wgwc"),k=n("wZkO"),P=n("bTqV"),M=n("0njA"),x=n("m6yr"),V=n("kmnG"),W=n("qFsG");function z(e,t){if(1&e&&l.Rb(0,"mat-tab",11),2&e){const e=t.$implicit,n=l.pc();l.vc("label",e.name+(n.form[e.id].invalid&&n.form[e.id].touched?"*":""))}}f=$localize`:Catering details save action␟6679108dd552b13e53a38ea4c5e5e6f8e6fadab7␟2732940016977811303: Add to booking `,h=$localize`:Catering details equipment notes label␟9560d941e07bf55dfdf44d454055e8dddffb2f91␟5669621286420940838: (eg - allergies, in tolerances, no ice in drinks etc) Additional requests are handled in confidence. `;const I=["placeholder",$localize`:␟f7bdd304a99c014dc0fff3af941e6a9d968371db␟4048193419886450033:Add notes here...`],D=["placeholder",$localize`:␟95984e0af2c6fdc0c7a9e4ad9b413fd969a5324a␟4704310930093496744:Charge Code`];var S,A,$;function L(e,t){1&e&&(l.gc(0,$,1),l.Rb(1,"span"),l.dc())}function N(e,t){if(1&e&&(l.Wb(0,"form",12),l.Wb(1,"div",13),l.Wb(2,"label",14),l.ac(3,h),l.Vb(),l.Wb(4,"mat-form-field",15),l.Wb(5,"textarea",16),l.cc(6,I),l.Vb(),l.Vb(),l.Vb(),l.Wb(7,"div",13),l.Wb(8,"label",17),l.gc(9,$),l.Lc(10,L,2,0,"span",18),l.dc(),l.Vb(),l.Wb(11,"mat-form-field",15),l.Wb(12,"input",19),l.cc(13,D),l.Vb(),l.Wb(14,"mat-error"),l.ac(15,S),l.Vb(),l.Wb(16,"mat-hint"),l.gc(17,A),l.Rb(18,"span"),l.dc(),l.Vb(),l.Vb(),l.Vb(),l.Vb()),2&e){const e=l.pc();l.vc("formGroup",e.active_form),l.Cb(8),l.Gb("error",e.active_form.controls.code.touched&&e.active_form.controls.code.invalid),l.Cb(2),l.vc("ngIf",e.needs_charge_code[e.space_list[e.active_space].id])}}S=$localize`:Catering details charge code error␟4b1851c001235398631979c2ebff230f501e3fb9␟6433134519537727373: Charge Code is required `,A=$localize`:Catering details charge code hint␟309202b2ded3e8d0aa94923fa187763d6ba21830␟1078849591937392404:${"\ufffd#18\ufffd"}:START_TAG_SPAN:Note:${"\ufffd/#18\ufffd"}:CLOSE_TAG_SPAN: Your booking will be confirmed before you are charged. `,$=$localize`:Catering details charge code label␟0623cad0eeefa482e8dadfe201c0f0ddff07f405␟4381230312262498447: Charge Code${"\ufffd*10:1\ufffd\ufffd#1:1\ufffd"}:START_TAG_SPAN:*${"\ufffd/#1:1\ufffd\ufffd/*10:1\ufffd"}:CLOSE_TAG_SPAN:`;const j=function(){return{class:"material-icons",content:"close"}};let T=(()=>{class e{constructor(e,t){this._service=e,this._data=t,this.event=new l.n,this.notes={},this.codes={},this.head_counts={},this.form={},this.needs_charge_code={},this.active_space=0}get space_list(){return this._data.spaces||[]}get active_form(){return this.form[this.space_list[this.active_space].id]}get is_valid(){return this.space_list.reduce((e,t)=>e&&this.form[t.id].valid,!0)}ngOnInit(){const e=(this._data.notes_field.value||[]).filter(e=>"catering"===e.type);this.notes=e.reduce((e,t)=>(e[t.space]=t.message,e),{}),this.codes=(this._data.catering.value||[]).reduce((e,t)=>(e[t.location_id]=t.charge_code,e),{}),this.generateFormFields()}submit(){if(this.space_list.forEach(e=>this.form[e.id].markAllAsTouched()),this.is_valid){const e=(this._data.notes_field.value||[]).filter(e=>"catering"!==e.type),t=this.space_list.map(e=>({author:this._service.Users.current.name,type:"catering",message:this.form[e.id].controls.notes.value,space:e.id,date:O().valueOf()}));this._data.notes_field.setValue(e.concat(t).filter(e=>e.message));const n=(this._data.catering.value||[]).map(e=>new w.a(Object.assign(Object.assign({},e),{charge_code:this.form[e.location_id].controls.code.value})));this._data.catering.setValue(n),this.event.emit({reason:"done"})}}generateFormFields(){for(const e of this.space_list){const t=this._service.Organisation.buildings.find(t=>t.id===e.level.building_id);this.needs_charge_code[e.id]=t.required.equipment_code,this.form[e.id]=new a.i({notes:new a.f(this.notes[e.id]||""),code:new a.f(this.codes[e.id]||"",t.required.equipment_code?[a.F.required]:[])})}}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(c.a),l.Qb(C.a))},e.\u0275cmp=l.Kb({type:e,selectors:[["a-catering-details-modal"]],outputs:{event:"event"},decls:17,vars:5,consts:[[1,"header"],[1,"tabs"],[3,"selectedIndex","selectedIndexChange"],[3,"label",4,"ngFor","ngForOf"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"details"],["src","assets/img/food-notes.svg"],[1,"text"],[3,"formGroup",4,"ngIf"],["mat-button","",3,"tapped"],[3,"label"],[3,"formGroup"],[1,"field"],["for","equipment-notes"],["appearance","outline"],["matInput","","name","equipment-notes","formControlName","notes",6,"placeholder"],["for","charge-code"],[4,"ngIf"],["matInput","","name","charge-code","formControlName","code",6,"placeholder"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.Wb(1,"div",1),l.Wb(2,"mat-tab-group",2),l.lc("selectedIndexChange",(function(e){return t.active_space=e})),l.Lc(3,z,1,1,"mat-tab",3),l.Vb(),l.Vb(),l.Wb(4,"button",4),l.Rb(5,"app-icon",5),l.Vb(),l.Vb(),l.Wb(6,"mat-dialog-content"),l.Wb(7,"main"),l.Wb(8,"div",6),l.Rb(9,"img",7),l.Wb(10,"div",8),l.Nc(11,"Please specify any allergies or gluten intolerances"),l.Vb(),l.Vb(),l.Lc(12,N,19,4,"form",9),l.Vb(),l.Vb(),l.Wb(13,"mat-dialog-actions"),l.Wb(14,"footer"),l.Wb(15,"button",10),l.lc("tapped",(function(){return t.submit()})),l.ac(16,f),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Cb(2),l.vc("selectedIndex",t.active_space),l.Cb(1),l.vc("ngForOf",t.space_list),l.Cb(2),l.vc("icon",l.wc(4,j)),l.Cb(7),l.vc("ngIf",t.space_list[t.active_space]&&t.active_form))},directives:[k.c,i.s,P.b,C.d,M.a,C.f,i.t,C.c,x.c,k.a,a.H,a.s,a.j,V.b,W.a,a.c,a.r,a.h,V.a,V.e],styles:[".header[_ngcontent-%COMP%]{display:flex;align-items:center;border-bottom:1px solid #ccc;width:100%}.header[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{min-width:50%;flex:1}.details[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;text-align:center;margin-bottom:1em}main[_ngcontent-%COMP%]{padding:1em 1em 0}mat-hint[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#1937ea}label[_ngcontent-%COMP%]{min-width:100%;margin-right:1em;font-weight:700;font-size:.8em;width:100%;margin-top:0;margin-bottom:.5em}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ffb300}label.error[_ngcontent-%COMP%]{color:#e53935}mat-form-field[_ngcontent-%COMP%]{flex:1}mat-tab[_ngcontent-%COMP%]{display:none!important}.field[_ngcontent-%COMP%]{display:flex;min-width:14em;flex:1;flex-wrap:wrap}textarea[_ngcontent-%COMP%]{min-height:7em}.fieldset[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0 .25em}@media only screen and (orientation:portrait) and (max-width:450px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0}}@media only screen and (orientation:landscape) and (max-width:800px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{margin:0}}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:first-child{margin-left:0}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:last-child{margin-right:0}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),e})();var F,E=n("Kj3r"),q=n("/uUt"),R=n("eIep"),B=n("JIr8"),G=n("lJxs"),Q=n("XNiG"),U=n("LRne"),Y=n("YxBP"),X=n("CbDI"),H=n("bSwM"),K=n("A5z7");function Z(e,t){if(1&e){const e=l.Xb();l.Wb(0,"div",14),l.Wb(1,"mat-checkbox",15),l.lc("change",(function(n){l.Dc(e);const i=t.$implicit,o=l.pc(2);return n.checked?o.addLocationFilter(i):o.removeLocationFilter(i)})),l.Wb(2,"div",16),l.Wb(3,"div",17),l.Nc(4),l.Vb(),l.Wb(5,"div",18),l.Nc(6),l.Vb(),l.Wb(7,"div",19),l.Nc(8),l.Vb(),l.Vb(),l.Vb(),l.Vb()}if(2&e){const e=t.$implicit;l.Cb(4),l.Oc(e.code),l.Cb(2),l.Oc(e.name),l.Cb(2),l.Oc(e.address)}}F=$localize`:Booking space filters locations label␟b7052a01675881e6c47a045f17e24883c8a0708b␟9185812574124356046:Select locations(s)`;const J=function(){return{type:"icon",class:"material-icons",content:"close"}};function ee(e,t){if(1&e){const e=l.Xb();l.Wb(0,"mat-chip",23),l.lc("removed",(function(){l.Dc(e);const n=t.$implicit;return l.pc(3).removeLocationFilter(n)})),l.Nc(1),l.Rb(2,"app-icon",24),l.Vb()}if(2&e){const e=t.$implicit;l.vc("id",e.id)("removable",!0),l.Cb(1),l.Pc(" ",e.name," "),l.Cb(1),l.vc("icon",l.wc(4,J))}}function te(e,t){if(1&e&&(l.Wb(0,"div",20),l.Wb(1,"mat-chip-list",21),l.Lc(2,ee,3,5,"mat-chip",22),l.Vb(),l.Vb()),2&e){const e=l.pc(2);l.Cb(2),l.vc("ngForOf",e.location_list)}}const ne=function(){return{class:"material-icons",content:"keyboard_arrow_left"}},ie=function(){return{class:"material-icons",content:"keyboard_arrow_right"}},oe=function(e){return{class:"material-icons",content:e}};function ae(e,t){if(1&e){const e=l.Xb();l.Wb(0,"div",1),l.Wb(1,"div",2),l.Wb(2,"div",3),l.Wb(3,"button",4),l.lc("tapped",(function(){return l.Dc(e),l.pc().changeDate(-1)})),l.Rb(4,"app-icon",5),l.Vb(),l.Wb(5,"div",6),l.Nc(6),l.Vb(),l.Wb(7,"button",7),l.lc("tapped",(function(){return l.Dc(e),l.pc().changeDate(1)})),l.Rb(8,"app-icon",5),l.Vb(),l.Vb(),l.Wb(9,"div",8),l.Wb(10,"div",9),l.lc("tapped",(function(){l.Dc(e);const t=l.pc();return t.show_locations=!t.show_locations})),l.Rb(11,"img",10),l.Wb(12,"div",6),l.ac(13,F),l.Vb(),l.Rb(14,"app-icon",5),l.Vb(),l.Wb(15,"div",11),l.Lc(16,Z,9,3,"div",12),l.Vb(),l.Vb(),l.Vb(),l.Lc(17,te,3,1,"div",13),l.Vb()}if(2&e){const e=l.pc();l.Cb(3),l.vc("disabled",e.is_today),l.Cb(1),l.vc("icon",l.wc(8,ne)),l.Cb(2),l.Oc(e.date_display),l.Cb(2),l.vc("icon",l.wc(9,ie)),l.Cb(6),l.vc("icon",l.xc(10,oe,"keyboard_arrow_"+(e.show_locations?"up":"down"))),l.Cb(1),l.vc("@show",e.show_locations?"show":"hide"),l.Cb(1),l.vc("ngForOf",e.building_list),l.Cb(1),l.vc("ngIf",e.location_list&&e.location_list.length)}}let re=(()=>{class e extends s.a{constructor(e){super(),this._service=e,this.locations=[],this.locationsChange=new l.n}get is_today(){const e=O(this.date.value);return O().isSame(e,"d")}get date_display(){const e=O(this.date.value);return this.is_today?"Today":e.format("DD MMM YYYY")}get location_list(){return(this.locations||[]).map(e=>this.building_list.find(t=>t.id===e))}changeDate(e=1){let t=O(this.date.value).add(e,"d");const n=O().startOf("m");t.isBefore(n,"s")&&(t=n),this.date.setValue(t.valueOf())}ngOnInit(){this.building_list=this._service.Organisation.buildings,this.building_list&&this.building_list.length||this.timeout("init",()=>this.ngOnInit(),300)}addLocationFilter(e){this.locations||(this.locations=[]),this.locations.push(e.id),this.locations=Object(Y.l)(this.locations),this.locationsChange.emit(this.locations)}removeLocationFilter(e){this.locations&&(this.locations.splice(this.locations.findIndex(t=>e.id===t),1),this.locationsChange.emit(this.locations))}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(c.a))},e.\u0275cmp=l.Kb({type:e,selectors:[["booking-space-filters"]],inputs:{date:"date",locations:"locations"},outputs:{locationsChange:"locationsChange"},features:[l.zb],decls:1,vars:1,consts:[["class","space-filters",4,"ngIf"],[1,"space-filters"],[1,"actions"],[1,"date"],["mat-icon-button","",3,"disabled","tapped"],[3,"icon"],[1,"text"],["mat-icon-button","",3,"tapped"],[1,"location-list"],[1,"inner",3,"tapped"],["src","assets/img/location-img.svg"],[1,"list"],["class","item",4,"ngFor","ngForOf"],["class","filters",4,"ngIf"],[1,"item"],[3,"change"],[1,"building-name"],[1,"code"],[1,"name"],[1,"address"],[1,"filters"],["aria-label","Location Filters"],["color","primary",3,"id","removable","removed",4,"ngFor","ngForOf"],["color","primary",3,"id","removable","removed"],["matChipRemove","",3,"icon"]],template:function(e,t){1&e&&l.Lc(0,ae,18,12,"div",0),2&e&&l.vc("ngIf",t.date)},directives:[i.t,P.b,x.c,M.a,i.s,H.a,K.d,K.a,K.e],styles:[".space-filters[_ngcontent-%COMP%]{width:100%}.actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;padding:1em}@media only screen and (orientation:portrait) and (max-width:450px){.actions[_ngcontent-%COMP%]{padding:.5em}}@media only screen and (orientation:landscape) and (max-width:800px){.actions[_ngcontent-%COMP%]{padding:.5em}}.actions[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:0 .5em}.date[_ngcontent-%COMP%]{display:flex;align-items:center;border:1px solid #1937ea;height:2.5em;overflow:hidden}@media only screen and (orientation:portrait) and (max-width:450px){.date[_ngcontent-%COMP%]{margin-bottom:.5em!important}}@media only screen and (orientation:landscape) and (max-width:800px){.date[_ngcontent-%COMP%]{margin-bottom:.5em!important}}.date[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0;color:#1937ea;background-color:rgba(25,55,234,.1);height:2.5em;width:2.5em;margin:0}.date[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{background-color:#f0f0f0;color:rgba(0,0,0,.35)}.date[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;border-left:1px solid #1937ea;border-right:1px solid #1937ea;width:8em;height:100%}.location-list[_ngcontent-%COMP%]{position:relative;border:1px solid #ccc;width:24em}.location-list[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]{position:relative;overflow:hidden;display:flex;align-items:center;height:2.5em}.location-list[_ngcontent-%COMP%]   .inner[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.5em}.location-list[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:-10px;left:-10px}.location-list[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1;min-width:50%;margin-left:3em;padding:0 1em}.location-list[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{position:absolute;bottom:0;transform:translateY(100%);background-color:#41485b;color:#fff;width:24em;max-height:25em;overflow:hidden auto;z-index:999;max-width:100%}.location-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{margin:.5em;width:24em}.filters[_ngcontent-%COMP%]{padding:0 1em 1em;margin:0 auto;max-width:720px;width:100%}@media only screen and (orientation:portrait) and (max-width:450px){.filters[_ngcontent-%COMP%]{padding-bottom:.5em}}@media only screen and (orientation:landscape) and (max-width:800px){.filters[_ngcontent-%COMP%]{padding-bottom:.5em}}.building-name[_ngcontent-%COMP%]{display:flex;align-items:center}.building-name[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{width:4em}.building-name[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:8em}.building-name[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{flex:1;min-width:6em;max-width:50vw;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:.2em!important}.mat-menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:0 1em}.mat-menu-item[_ngcontent-%COMP%]   app-icon[_ngcontent-%COMP%]{font-size:1.2em}.mat-menu-item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1;min-width:50%;margin-left:.5em;padding-right:2em}.mat-chip.mat-standard-chip[_ngcontent-%COMP%]   .mat-chip-remove[_ngcontent-%COMP%]{color:hsla(0,0%,100%,.85)}"],data:{animation:[X.a]}}),e})();var ce,se,le,de=n("vxfF"),ue=(n("KsZa"),n("ceWj")),me=n("daPb");function fe(e,t){if(1&e){const e=l.Xb();l.Wb(0,"div",6),l.Wb(1,"div",7),l.Nc(2),l.Vb(),l.Wb(3,"div",8),l.Wb(4,"button",9),l.lc("tapped",(function(){l.Dc(e);const n=t.$implicit;return l.pc().selectSpace(n)})),l.Wb(5,"div",10),l.Nc(6),l.Vb(),l.Vb(),l.Vb(),l.Vb()}if(2&e){const e=t.$implicit,n=l.pc();l.Cb(2),l.Oc(e.date_string),l.Cb(2),l.Gb("inverse",!e.available&&!e.replaced_by),l.Cb(2),l.Pc(" ",e.replaced_by||(e.available?n.space.name:"Find Room")," ")}}ce=$localize`:Space recurrence header␟0d8f27b9a841ca2917819f2ff73ada4f8ab59d79␟8622659837326450623:Recurrence - ${"\ufffd0\ufffd"}:INTERPOLATION:`,se=$localize`:Space recurrence information␟5adceef379acff2f5b02b532d6246dc4b5d58063␟2284203384413164791: * Select individual dates to update selected space `,le=$localize`:Space recurrence save action␟dac15c8d36c2c7ab047c86ba8aaf8807ad675087␟7340520212541034776: Add to Booking `;const he=function(){return{type:"icon",class:"material-icons",content:"close"}};let be=(()=>{class e extends s.a{constructor(e,t,n){super(),this._data=e,this._dialog=t,this._service=n,this.event=new l.n,this.occurrences=[],this.space_details=[]}get space(){return this._data.space}get occurrences_valid(){return this.occurrences.reduce((e,t)=>e&&(t.available||!!t.replaced_by),!0)}ngOnInit(){this.space_details=[].concat(this._data.conflicts||[]),this.updateOccurrences()}save(){this.event.emit({reason:"done",metadata:this.space_details})}selectSpace(e){const t=this._dialog.open(me.a,{width:"auto",height:"auto",maxWidth:"95vw",data:{spaces:[],zone_ids:this.space.level.building_id,date:1e3*e.date,duration:this._data.duration,host:this._data.host,multiple:!1}});this.subscription("new_spaces",t.componentInstance.event.subscribe(n=>{if("done"===n.reason){const i=n.metadata[0];i&&(console.log("Space:",i),this.space_details.unshift({date:e.date,space:i.email,replaces:this.space.email}),this.space_details=Object(Y.l)(this.space_details,"date")),this.updateOccurrences(),t.close(),this.unsub("new_spaces")}}))}updateOccurrences(){this.occurrences=this._data.space.recurr_available.map(e=>{const t=this.space_details.find(t=>t.date===e.date&&t.replaces===this.space.email),n=(t||{}).space,i=this._service.Spaces.item(n)||{email:n,name:n};return console.log("Space:",t,i),Object.assign(Object.assign({},e),{date_string:O(1e3*e.date).format("dddd, DD MMMM YYYY"),replaced_by:i.name})}),console.log("Occurrences:",this.occurrences)}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(C.a),l.Qb(C.b),l.Qb(c.a))},e.\u0275cmp=l.Kb({type:e,selectors:[["a-recurrence-spaces-modal"]],outputs:{event:"event"},features:[l.zb],decls:14,vars:5,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"info"],["class","item",4,"ngFor","ngForOf"],["mat-button","",3,"disabled","tapped"],[1,"item"],[1,"date"],[1,"action"],["mat-button","",3,"tapped"],[1,"content"]],template:function(e,t){1&e&&(l.Wb(0,"header"),l.Wb(1,"div",0),l.ac(2,ce),l.Vb(),l.Wb(3,"button",1),l.Rb(4,"app-icon",2),l.Vb(),l.Vb(),l.Wb(5,"mat-dialog-content"),l.Wb(6,"main"),l.Wb(7,"div",3),l.ac(8,se),l.Vb(),l.Lc(9,fe,7,4,"div",4),l.Vb(),l.Vb(),l.Wb(10,"mat-dialog-actions"),l.Wb(11,"footer"),l.Wb(12,"button",5),l.lc("tapped",(function(){return t.save()})),l.ac(13,le),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Cb(2),l.ec(t.space.name),l.bc(2),l.Cb(2),l.vc("icon",l.wc(4,he)),l.Cb(5),l.vc("ngForOf",t.occurrences),l.Cb(3),l.vc("disabled",!t.occurrences_valid))},directives:[P.b,C.d,M.a,C.f,i.s,C.c,x.c],styles:[".heading[_ngcontent-%COMP%]{flex:1}.item[_ngcontent-%COMP%], main[_ngcontent-%COMP%]{padding:.5em}.item[_ngcontent-%COMP%]{display:flex;align-items:center}.item[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{flex:1;margin-right:1em}.item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:13em}.item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{width:10.5em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.info[_ngcontent-%COMP%]{font-size:.8em;color:#1937ea;margin-bottom:1em;font-style:italic}.info[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{text-align:center}footer[_ngcontent-%COMP%]{width:100%}"]}),e})();var ge,pe;function ve(e,t){if(1&e&&l.Rb(0,"div",14),2&e){const e=l.pc(2);l.Kc("background-image","url("+e.space.image+")",l.Jb)}}function _e(e,t){if(1&e&&(l.Wb(0,"div",15),l.gc(1,pe),l.Rb(2,"span"),l.dc(),l.Vb()),2&e){const e=l.pc(2);l.Cb(2),l.ec(e.availability),l.bc(1)}}ge=$localize`:Booking space locate action␟f130d84389fb831e5eb6580c7562dffc2d52a8ea␟4746077833803509960: Map `,pe=$localize`:Booking space availability label␟2a1fc73ce353aecee76c8fe49d4f9884dd1ffc78␟8859996495474290193: Available for ${"\ufffd#2\ufffd"}:START_TAG_SPAN:${"\ufffd0\ufffd"}:INTERPOLATION:${"\ufffd/#2\ufffd"}:CLOSE_TAG_SPAN: meeting ocurrences `;const ye=function(){return{type:"icon",class:"material-icons",content:"account_circle"}};function Ce(e,t){if(1&e){const e=l.Xb();l.Wb(0,"div",1),l.Wb(1,"div",2),l.Lc(2,ve,1,2,"div",3),l.Rb(3,"div",4),l.Wb(4,"div",5),l.Nc(5),l.Vb(),l.Wb(6,"div",6),l.Wb(7,"div",7),l.Nc(8),l.Vb(),l.Wb(9,"div",8),l.Rb(10,"app-icon",9),l.Nc(11),l.Vb(),l.Vb(),l.Lc(12,_e,3,1,"div",10),l.Vb(),l.Wb(13,"div",11),l.Wb(14,"button",12),l.lc("tapped",(function(){return l.Dc(e),l.pc().selectSpace()})),l.Nc(15),l.Vb(),l.Wb(16,"button",13),l.lc("tapped",(function(){return l.Dc(e),l.pc().locate()})),l.ac(17,ge),l.Vb(),l.Vb(),l.Vb()}if(2&e){const e=l.pc();l.Gb("with-image",e.show_image),l.Cb(2),l.vc("ngIf",e.space.image),l.Cb(3),l.Oc(e.space.name),l.Cb(3),l.Oc(e.location),l.Cb(2),l.vc("icon",l.wc(13,ye)),l.Cb(1),l.Pc(" ",e.space.capacity||"0"," "),l.Cb(1),l.vc("ngIf",e.space.recurr_available&&e.space.recurr_available.length),l.Cb(2),l.Gb("inverse",e.multi&&!e.selected)("request",e.is_request),l.Cb(1),l.Pc(" ",e.multi?e.selected?"Remove":"Select":e.is_request?"Request":"Book"," ")}}let we=(()=>{class e extends s.a{constructor(e,t){super(),this._service=e,this._dialog=t,this.select=new l.n}get show_image(){return this._service.setting("app.space_display.show_images")}get selected(){return!(!this.form&&this.space)&&this.form.controls.space_list&&!!(this.form.controls.space_list.value||[]).find(e=>e.id===this.space.id)}get is_request(){return!!this.form&&this.space.byRequest({date:this.form.controls.date.value,duration:this.form.controls.duration.value,host:this.form.controls.organiser.value||this._service.Users.current})}get availability(){const e=this.space.recurr_available.reduce((e,t)=>e+(t.available?1:0),0);return e>=this.space.recurr_available.length?"all":`${e} of ${this.space.recurr_available.length}`}get location(){if(!this.space)return"Unable to determine location";const e=this.space.level,t=this._service.Organisation.buildings.find(t=>t.id===e.building_id);return`${t?t.name+", ":""}${e.name}`}locate(){this._dialog.open(ue.a,{width:"auto",height:"auto",maxWidth:"95vw",maxHeight:"95vh",data:{space:this.space}})}selectSpace(){if(!this.space.recurr_available||"all"===this.availability||this.selected)this.select.emit();else{const e=this._dialog.open(be,{width:"auto",height:"auto",maxWidth:"95vw",maxHeight:"95vh",data:{space:this.space,duration:this.form.controls.duration.value,host:this.form.controls.organiser.value,conflicts:this.form.controls.recurrence.value.conflicts||[]}});this.subscription("recurr_conflicts",e.componentInstance.event.subscribe(t=>{if("done"===t.reason){const n=this.form.controls.recurrence.value,i=n.conflicts||[];for(const e of t.metadata){const t=i.findIndex(t=>t.date===e.date&&t.replaces===e.replaces);t>=0?i.splice(t,1,e):i.push(e)}this.form.controls.recurrence.setValue(Object.assign(Object.assign({},n),{conflicts:i})),this.select.emit(),e.close()}}))}}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(c.a),l.Qb(C.b))},e.\u0275cmp=l.Kb({type:e,selectors:[["a-booking-space-item"]],inputs:{space:"space",form:"form",multi:"multi"},outputs:{select:"select"},features:[l.zb],decls:1,vars:1,consts:[["class","space-details",3,"with-image",4,"ngIf"],[1,"space-details"],[1,"details"],["class","image",3,"background-image",4,"ngIf"],[1,"overlay"],[1,"name"],[1,"info"],[1,"location"],[1,"capacity"],[3,"icon"],["class","info recurr",4,"ngIf"],[1,"actions"],["mat-button","",3,"tapped"],["mat-button","",1,"inverse",3,"tapped"],[1,"image"],[1,"info","recurr"]],template:function(e,t){1&e&&l.Lc(0,Ce,18,14,"div",0),2&e&&l.vc("ngIf",t.space)},directives:[i.t,M.a,P.b,x.c],styles:[".space-details[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;width:720px;max-width:calc(100vw - 1em);background-color:#fff;flex-wrap:wrap;border-radius:0;overflow:hidden;transition:box-shadow .2s,top .2s;top:0;margin:.5em auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.space-details[_ngcontent-%COMP%]:hover{box-shadow:0 1px 3px 2px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);top:-2px}.space-details[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:none}.with-image[_ngcontent-%COMP%]{padding-top:0;width:480px}.with-image[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{display:initial;background-color:rgba(0,0,0,.65);color:#fff;transition:opacity .2s}.with-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.with-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{overflow:hidden;background-position:50%;background-size:cover}.with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{-webkit-filter:drop-shadow(0 0 2px #000);filter:drop-shadow(0 0 2px black);color:#fff}.with-image[_ngcontent-%COMP%]:hover   .details[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{opacity:0}.with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{position:relative;height:6em;width:24em;margin:0 auto 0 0;max-width:24em;overflow:hidden;height:12em}.with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .capacity[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%], .with-image[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{transition:-webkit-filter .2s;transition:filter .2s;transition:filter .2s,-webkit-filter .2s}.with-image[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;bottom:2em;color:#fff}.with-image[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{position:absolute;bottom:1em;color:hsla(0,0%,100%,.65);width:calc(100% - 2em)}.details[_ngcontent-%COMP%]{flex:1;min-width:50%;padding:1em;min-width:99%}.info[_ngcontent-%COMP%]{display:flex;align-items:center;color:rgba(0,0,0,.65)}.name[_ngcontent-%COMP%]{font-size:1.2em}.location[_ngcontent-%COMP%]{font-size:.8em;flex:1;min-width:50%}.capacity[_ngcontent-%COMP%]{display:flex;align-items:center}.recurr[_ngcontent-%COMP%]{color:#1937ea;font-size:.8em}.recurr[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-decoration:underline}.actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;flex:1}button[_ngcontent-%COMP%]{min-width:12em;flex:1;margin:0;border-radius:0}button.request[_ngcontent-%COMP%]{color:#fff;background-color:#ffb300;border-color:#ffb300}button.request.inverse[_ngcontent-%COMP%]{color:#ffb300;background-color:#fff}"]}),e})();var Oe,ke,Pe,Me,xe=n("Xa2L");function Ve(e,t){if(1&e){const e=l.Xb();l.Ub(0),l.Wb(1,"a-booking-space-item",14),l.lc("select",(function(){l.Dc(e);const n=t.$implicit;return l.pc(3).selectSpace(n)})),l.Vb(),l.Tb()}if(2&e){const e=t.$implicit,n=l.pc(3);l.Cb(1),l.vc("form",n.form)("space",e)("multi",n.multiple)}}function We(e,t){if(1&e&&(l.Wb(0,"cdk-virtual-scroll-viewport",12),l.Lc(1,Ve,2,3,"ng-container",13),l.Vb()),2&e){const e=l.pc(2);l.vc("itemSize",e.item_size),l.Cb(1),l.vc("cdkVirtualForOf",e.space_list)}}function ze(e,t){if(1&e&&(l.Ub(0),l.Lc(1,We,2,2,"cdk-virtual-scroll-viewport",11),l.Tb()),2&e){const e=l.pc(),t=l.Ac(13);l.Cb(1),l.vc("ngIf",e.space_list&&e.space_list.length)("ngIfElse",t)}}function Ie(e,t){if(1&e){const e=l.Xb();l.Wb(0,"button",15),l.lc("tapped",(function(){return l.Dc(e),l.pc().next()})),l.ac(1,ke),l.Vb()}if(2&e){const e=l.pc();l.vc("disabled",!e.spaces.value||!e.spaces.value.length)}}function De(e,t){1&e&&(l.Wb(0,"div",16),l.Wb(1,"div",17),l.Wb(2,"div",18),l.Rb(3,"mat-spinner",19),l.Vb(),l.Wb(4,"div",20),l.ac(5,Pe),l.Vb(),l.Vb(),l.Vb())}Oe=$localize`:Booking spaces cancel action␟cda31dbd724cf5f4fa7a4274d9120651490c8a8c␟8890553633144307762:Back`,ke=$localize`:Booking spaces continue action␟39494c73fcb8affcef6b03a8c7e52f8c789b2d1d␟6609643060537118464: Next `,Pe=$localize`:Booking spaces loading label␟e4560a146a9929dd23ee2c39d318816ced7e48f0␟3487485599479520443:Checking space availability...`,Me=$localize`:Booking spaces empty label␟43777c73f6bf125d154fca4427a6e1ea0d3cb778␟3717593149132753615:No spaces available for the selected time`;const Se=function(){return{class:"material-icons",content:"close"}};function Ae(e,t){1&e&&(l.Wb(0,"div",16),l.Wb(1,"div",17),l.Wb(2,"div",18),l.Rb(3,"app-icon",21),l.Vb(),l.Wb(4,"div",20),l.ac(5,Me),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Cb(3),l.vc("icon",l.wc(1,Se)))}let $e=(()=>{class e extends s.a{constructor(e){super(),this._service=e,this.event=new l.n,this.space_list=[],this.change$=new Q.a}get item_size(){return window,window,window,130}get multiple(){return this._service.setting("app.booking.multiple_spaces")}ngOnInit(){if(!this._service.is_initialised&&this._service.Spaces.list().length)return this.timeout("init",()=>this.ngOnInit());this.search_results$=this.change$.pipe(Object(E.a)(400),Object(q.a)(),Object(R.a)(e=>{this.loading=!0;const t=this.form.controls.recurrence?this.form.controls.recurrence.value:null,n=t&&t.period&&"None"!==t.period?{recurr_period:(t.period||"").toLowerCase(),recurr_end:O(t.end).unix()}:{},i=Object.assign({date:this.form.controls.date.value,duration:this.form.controls.duration.value,zone_ids:this._service.Organisation.building.id,bookable:!0},n);return this.zone_ids&&this.zone_ids.length&&(i.zone_ids=this.zone_ids.join(",")),this._service.Spaces.available(i)}),Object(B.a)(e=>(console.error(e),Object(U.a)([]))),Object(G.a)(e=>(this.loading=!1,e))),this.subscription("search_results",this.search_results$.subscribe(e=>this.space_list=e)),this.change$.next("")}ngOnChanges(e){e.form&&(this.form.controls.date&&this.subscription("date_field",this.form.controls.date.valueChanges.subscribe(e=>this.change$.next(e))),this.form.controls.duration&&this.subscription("duration_field",this.form.controls.duration.valueChanges.subscribe(e=>this.change$.next(e))))}selectSpace(e){if(this.multiple){const t=this.spaces.value||[],n=t.find(t=>t.id===e.id);this.spaces.setValue(n?t.filter(t=>t.id!==e.id):t.concat([e]))}else this.spaces.setValue([e]),this.event.emit({type:"next",step:"search"})}next(){this.event.emit({type:"next",step:"search"})}previous(){this.event.emit({type:"previous",step:"search"})}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(c.a))},e.\u0275cmp=l.Kb({type:e,selectors:[["booking-find-space"]],inputs:{spaces:"spaces",form:"form"},outputs:{event:"event"},features:[l.zb,l.Ab],decls:14,vars:5,consts:[[1,"find-space"],[1,"background"],[1,"header"],[3,"date","locations","locationsChange"],[4,"ngIf","ngIfElse"],[1,"footer"],[1,"box"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"disabled","tapped",4,"ngIf"],["load_state",""],["empty_state",""],[3,"itemSize",4,"ngIf","ngIfElse"],[3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf"],[3,"form","space","multi","select"],["mat-button","",3,"disabled","tapped"],[1,"body"],[1,"info-block","center"],[1,"icon"],["diameter","48"],[1,"text"],[3,"icon"]],template:function(e,t){if(1&e&&(l.Wb(0,"div",0),l.Rb(1,"div",1),l.Wb(2,"div",2),l.Wb(3,"booking-space-filters",3),l.lc("locationsChange",(function(e){return t.zone_ids=e}))("locationsChange",(function(e){return t.change$.next(e)})),l.Vb(),l.Vb(),l.Lc(4,ze,2,2,"ng-container",4),l.Wb(5,"div",5),l.Wb(6,"div",6),l.Wb(7,"button",7),l.lc("tapped",(function(){return t.previous()})),l.ac(8,Oe),l.Vb(),l.Lc(9,Ie,2,1,"button",8),l.Vb(),l.Vb(),l.Vb(),l.Lc(10,De,6,0,"ng-template",null,9,l.Mc),l.Lc(12,Ae,6,2,"ng-template",null,10,l.Mc)),2&e){const e=l.Ac(11);l.Cb(3),l.vc("date",t.form.controls.date)("locations",t.zone_ids),l.Cb(1),l.vc("ngIf",!t.loading)("ngIfElse",e),l.Cb(5),l.vc("ngIf",t.multiple)}},directives:[re,i.t,P.b,x.c,de.d,de.a,de.c,we,xe.c,M.a],styles:[".find-space[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;flex-direction:column;height:100%;width:100%;max-height:calc(100vh - 7.5em);overflow:hidden}@media only screen and (orientation:portrait) and (max-width:450px){.find-space[_ngcontent-%COMP%]{max-height:calc(100vh - 6.5em)}}@media only screen and (orientation:landscape) and (max-width:800px){.find-space[_ngcontent-%COMP%]{max-height:calc(100vh - 6.5em)}}.header[_ngcontent-%COMP%]{position:relative;z-index:999;width:100%;max-width:100vw;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}@media only screen and (orientation:portrait) and (max-width:450px){.header[_ngcontent-%COMP%]{border-radius:0}}@media only screen and (orientation:landscape) and (max-width:800px){.header[_ngcontent-%COMP%]{border-radius:0}}.body[_ngcontent-%COMP%], cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{position:relative;width:100%;flex:1;min-height:50%}.box[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;max-width:100vw;background-color:#fff;padding:.5em;margin:auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);border-top:1px solid #ccc}.box[_ngcontent-%COMP%], .footer[_ngcontent-%COMP%]{width:100%}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:0 .5em}.background[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:50%;transform:translateX(-50%);width:768px;max-width:100vw}.info-block[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:2.5em;width:2.5em}"]}),e})();var Le,Ne;Le=$localize`:Catering order item delivery details␟860413d275ab6e50489dae7e770f40364267d1be␟2502060370458020279: Deliver to ${"[\ufffd#2\ufffd|\ufffd#3\ufffd]"}:START_TAG_SPAN:${"\ufffd0\ufffd"}:INTERPOLATION:${"[\ufffd/#2\ufffd|\ufffd/#3\ufffd]"}:CLOSE_TAG_SPAN: at ${"[\ufffd#2\ufffd|\ufffd#3\ufffd]"}:START_TAG_SPAN:${"\ufffd1\ufffd"}:INTERPOLATION_1:${"[\ufffd/#2\ufffd|\ufffd/#3\ufffd]"}:CLOSE_TAG_SPAN:`,Le=l.fc(Le),Ne=$localize`:Items␟02072719ffd1bb48ba4003201565037d2695a251␟8762707649498451477:{VAR_PLURAL, plural, =1 {item } other {items }}`,Ne=l.fc(Ne,{VAR_PLURAL:"\ufffd0\ufffd"});const je=function(){return{class:"material-icons",content:"edit"}},Te=function(){return{class:"material-icons",content:"delete"}};let Fe=(()=>{class e{constructor(e){this._service=e,this.edit=new l.n,this.delete=new l.n}get space(){if(!this.order)return"<No Location>";const e=this._service.Spaces.item(this.order.location_id);return(e?e.name:"")||"<No Location>"}get delivery_time(){return this.order?O(this.order.booking_date).add((this.order.changes||{}).delivery_time||this.order.delivery_time,"m").format("h:mm A"):"<Meeting Start>"}get order_cost(){return((this.order?this.order.items:null)||[]).reduce((e,t)=>e+t.amount*t.unit_price,0)}get item_count(){return((this.order?this.order.items:null)||[]).reduce((e,t)=>e+t.amount,0)}get symbol(){const e=this._service.Spaces.item(this.order.location_id);if(!e||!e.level)return"USD";const t=this._service.Organisation.buildings.find(t=>t.id===e.level.building_id);return t?t.currency:"USD"}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(c.a))},e.\u0275cmp=l.Kb({type:e,selectors:[["catering-order-list-item"]],inputs:{order:"order",date:"date"},outputs:{edit:"edit",delete:"delete"},decls:17,vars:12,consts:[[1,"details"],[1,"group"],[1,"cost"],[1,"actions"],["mat-icon-button","",3,"tapped"],[3,"icon"],["mat-icon-button","",1,"inverse",3,"tapped"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.gc(1,Le),l.Rb(2,"span"),l.Rb(3,"span"),l.dc(),l.Vb(),l.Wb(4,"div",1),l.Wb(5,"div",2),l.Nc(6),l.Wb(7,"span"),l.ac(8,Ne),l.Vb(),l.Vb(),l.Wb(9,"div",2),l.Nc(10),l.qc(11,"currency"),l.Vb(),l.Vb(),l.Wb(12,"div",3),l.Wb(13,"button",4),l.lc("tapped",(function(){return t.edit.emit()})),l.Rb(14,"app-icon",5),l.Vb(),l.Wb(15,"button",6),l.lc("tapped",(function(){return t.delete.emit()})),l.Rb(16,"app-icon",5),l.Vb(),l.Vb()),2&e&&(l.Cb(3),l.ec(t.space)(t.delivery_time),l.bc(1),l.Cb(3),l.Pc(" ",t.item_count," "),l.Cb(2),l.ec(t.item_count),l.bc(8),l.Cb(2),l.Oc(l.sc(11,7,t.order_cost/100,t.symbol)),l.Cb(4),l.vc("icon",l.wc(10,je)),l.Cb(2),l.vc("icon",l.wc(11,Te)))},directives:[P.b,x.c,M.a],pipes:[i.d],styles:["[_nghost-%COMP%]{display:flex;align-items:center;padding:.25em;margin:.25em;border-radius:4px}.details[_ngcontent-%COMP%]{flex:1;padding:.5em}.details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:400}.cost[_ngcontent-%COMP%]{padding:.25em .5em;border-radius:4px;font-size:.8rem;margin:.25em .4rem .25em 0;white-space:nowrap;text-align:center}.cost[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{color:#fff;background-color:#1937ea}button[_ngcontent-%COMP%]{margin:.25em}button.inverse[_ngcontent-%COMP%]{background-color:#fff;color:#e53935;border:1px solid #e53935}"]}),e})();var Ee,qe,Re,Be,Ge,Qe;function Ue(e,t){if(1&e){const e=l.Xb();l.Wb(0,"catering-order-list-item",10),l.lc("edit",(function(){l.Dc(e);const n=t.$implicit;return l.pc(2).editOrder(n)}))("delete",(function(){l.Dc(e);const n=t.$implicit;return l.pc(2).deleteOrder(n)})),l.Vb()}if(2&e){const e=t.$implicit,n=l.pc(2);l.vc("order",e)("date",n.date)}}function Ye(e,t){if(1&e){const e=l.Xb();l.Ub(0),l.Wb(1,"div",8),l.Lc(2,Ue,1,2,"catering-order-list-item",9),l.Vb(),l.Wb(3,"button",6),l.lc("tapped",(function(){return l.Dc(e),l.pc().newOrder()})),l.ac(4,Be),l.Vb(),l.Tb()}if(2&e){const e=l.pc();l.Cb(2),l.vc("ngForOf",e.orders)}}Ee=$localize`:Catering order list header␟198d88d73d77e70a466db43ea2283f95a26f022b␟7084836568225090871:Catering Orders`,qe=$localize`:Catering order list cancel action␟9dc973b1a2fa6ac0ac5a539eeb8a44c2f7ab8138␟6168722822529020983: Back `,Re=$localize`:Catering order list continue action␟75db05d5e0bebee12a6a7b0e31ea09754d18d8fb␟7200802776192640190: Next `,Be=$localize`:Catering order list add action␟307c09c102f6ec213cf0e452b7302b85fd27b155␟4992565535187194144: Add Order `,Ge=$localize`:Catering order list empty label␟c6e5750edd2f95032c6113e88975d7be3b55b6c7␟4052001556626773369:No catering orders`,Qe=$localize`:Catering order list add action␟4bcabe959483f6b5cfb07513161e79223ee32d52␟2633188293896971176: Add Order `;const Xe=function(){return{class:"material-icons",content:"close"}};function He(e,t){if(1&e){const e=l.Xb();l.Wb(0,"div",11),l.Wb(1,"div",12),l.Rb(2,"app-icon",13),l.Vb(),l.Wb(3,"div",14),l.ac(4,Ge),l.Vb(),l.Wb(5,"button",6),l.lc("tapped",(function(){return l.Dc(e),l.pc().newOrder()})),l.ac(6,Qe),l.Vb(),l.Vb()}2&e&&(l.Cb(2),l.vc("icon",l.wc(1,Xe)))}let Ke=(()=>{class e{constructor(){this.event=new l.n,this.order=new l.n}get orders(){if(!this.catering)return[];const e=this.catering.value||[];return e.forEach(e=>e.booking_date=this.all_day?O(this.date).startOf("d").valueOf():this.date),e}newOrder(){this.order.emit()}editOrder(e){this.order.emit(e)}deleteOrder(e){const t=this.orders,n=t.findIndex(t=>e.id===t.id);n>=0&&(t.splice(n,1),this.catering.setValue(t))}next(){this.event.emit({type:"next",step:"catering"})}previous(){this.event.emit({type:"previous",step:"catering"})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=l.Kb({type:e,selectors:[["a-catering-order-list"]],inputs:{catering:"catering",date:"date",all_day:"all_day"},outputs:{event:"event",order:"order"},decls:13,vars:2,consts:[[1,"catering","order-list"],[1,"header"],[1,"body"],[4,"ngIf","ngIfElse"],[1,"footer"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"tapped"],["empty_state",""],[1,"list"],[3,"order","date","edit","delete",4,"ngFor","ngForOf"],[3,"order","date","edit","delete"],[1,"info-block","center"],[1,"icon"],[3,"icon"],[1,"text"]],template:function(e,t){if(1&e&&(l.Wb(0,"div",0),l.Wb(1,"div",1),l.Wb(2,"h3"),l.ac(3,Ee),l.Vb(),l.Vb(),l.Wb(4,"div",2),l.Lc(5,Ye,5,1,"ng-container",3),l.Vb(),l.Wb(6,"div",4),l.Wb(7,"button",5),l.lc("tapped",(function(){return t.previous()})),l.ac(8,qe),l.Vb(),l.Wb(9,"button",6),l.lc("tapped",(function(){return t.next()})),l.ac(10,Re),l.Vb(),l.Vb(),l.Vb(),l.Lc(11,He,7,2,"ng-template",null,7,l.Mc)),2&e){const e=l.Ac(12);l.Cb(5),l.vc("ngIf",t.orders&&t.orders.length)("ngIfElse",e)}},directives:[i.t,P.b,x.c,i.s,Fe,M.a],styles:["[_nghost-%COMP%]{height:100%}.order-list[_ngcontent-%COMP%]{flex-direction:column;height:100%;width:768px;margin:auto;max-width:100vw;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.body[_ngcontent-%COMP%], .order-list[_ngcontent-%COMP%]{display:flex;align-items:center}.body[_ngcontent-%COMP%]{position:relative;flex-direction:column;flex:1;width:100%;min-height:50%;overflow:auto}.body[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:8em}.list[_ngcontent-%COMP%]{width:100%}.list[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{border:1px solid #ccc}.list[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.05)}.footer[_ngcontent-%COMP%]{width:100%;text-align:center;border-top:1px solid #ccc}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:.5em}.info-block[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:1em}"]}),e})();var Ze,Je,et=n("IRj4"),tt=n("aXH1"),nt=n("QibW");function it(e,t){1&e&&l.Sb(0)}function ot(e,t){if(1&e){const e=l.Xb();l.Wb(0,"mat-checkbox",11),l.lc("change",(function(t){l.Dc(e);const n=l.pc(2).$implicit,i=l.pc(2).package;return l.pc().updateAmount(i,n,t.checked)})),l.Nc(1),l.Vb()}if(2&e){const e=l.pc(2).$implicit;l.vc("checked",!!e.amount),l.Cb(1),l.Pc(" ",e.name," ")}}function at(e,t){if(1&e){const e=l.Xb();l.Wb(0,"mat-radio-button",12),l.lc("change",(function(t){l.Dc(e);const n=l.pc(2).$implicit,i=l.pc(2).package;return l.pc().updateAmount(i,n,t.value===n.id)})),l.Nc(1),l.Vb()}if(2&e){const e=l.pc(2).$implicit;l.vc("value",e.id),l.Cb(1),l.Pc(" ",e.name," ")}}function rt(e,t){if(1&e&&(l.Ub(0),l.Lc(1,ot,2,2,"mat-checkbox",9),l.Lc(2,at,2,2,"mat-radio-button",10),l.Tb()),2&e){const e=l.pc(3).package;l.Cb(1),l.vc("ngIf",e.must_select>1),l.Cb(1),l.vc("ngIf",1===e.must_select)}}function ct(e,t){if(1&e&&(l.Ub(0),l.Nc(1),l.Tb()),2&e){const e=l.pc().$implicit;l.Cb(1),l.Pc(" ",e.name," ")}}function st(e,t){1&e&&l.Sb(0)}Ze=$localize`:Catering package options header␟15bd44965d742d8d8427ae3b909d26a812cc552f␟8442475149770947712:Package Options`,Je=$localize`:Catering package options save action␟efd2d9627cb8a4759431044f8adbef29895bc3c6␟7017188217946174407: Confirm Options `;const lt=function(e){return{package:e}};function dt(e,t){if(1&e&&(l.Wb(0,"div",8),l.Lc(1,rt,3,2,"ng-container",5),l.Lc(2,ct,2,1,"ng-container",5),l.Lc(3,st,1,0,"ng-container",2),l.Vb()),2&e){const e=t.$implicit,n=l.pc(2).package;l.pc();const i=l.Ac(13);l.Db("to-select",e.must_select),l.Cb(1),l.vc("ngIf",n.must_select&&n.must_select<n.items.length&&!e.must_select),l.Cb(1),l.vc("ngIf",n.must_select>=n.items.length||e.must_select),l.Cb(1),l.vc("ngTemplateOutlet",i)("ngTemplateOutletContext",l.xc(5,lt,e))}}function ut(e,t){if(1&e&&(l.Ub(0),l.Wb(1,"mat-radio-group",6),l.Lc(2,dt,4,7,"div",7),l.Vb(),l.Tb()),2&e){const e=l.pc().package,t=l.pc();l.Cb(1),l.vc("ngModel",t.active_items[e.id]),l.Cb(1),l.vc("ngForOf",e.items)}}function mt(e,t){if(1&e&&l.Lc(0,ut,3,2,"ng-container",5),2&e){const e=t.package;l.vc("ngIf",e.items&&e.items.length)}}const ft=function(){return{class:"material-icons",content:"close"}};let ht=(()=>{class e{constructor(e){this._data=e,this.event=new l.n}get requirements_met(){return function e(t){const n=t.items||[];return t.must_select>=n.length?n.reduce((t,n)=>t&&e(n),!0):n.reduce((e,t)=>e+t.amount?1:0,0)===t.must_select}(this.item)}get active_items(){return function e(t){let n={};if(t.items){const i=t.items.find(e=>e.amount>0);i&&(n[t.id]=i.id),t.items.forEach(t=>n=Object.assign(Object.assign({},n),e(t)))}return n}(this.item)}ngOnInit(){this.item=this._data.item}updateAmount(e,t,n){if(n){const n=e.must_select;e.items.filter(e=>e.amount>0).length>=n&&e.items.find(e=>e.amount>0).setAmount(0),t.setAmount(1)}else t.setAmount(0)}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(C.a))},e.\u0275cmp=l.Kb({type:e,selectors:[["a-package-options-modal"]],outputs:{event:"event"},decls:14,vars:7,consts:[["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["mat-button","",3,"disabled","tapped"],["item_display",""],[4,"ngIf"],[3,"ngModel"],["class","item",4,"ngFor","ngForOf"],[1,"item"],[3,"checked","change",4,"ngIf"],[3,"value","change",4,"ngIf"],[3,"checked","change"],[3,"value","change"]],template:function(e,t){if(1&e&&(l.Wb(0,"header"),l.Wb(1,"h3"),l.ac(2,Ze),l.Vb(),l.Wb(3,"button",0),l.Rb(4,"app-icon",1),l.Vb(),l.Vb(),l.Wb(5,"mat-dialog-content"),l.Wb(6,"main"),l.Lc(7,it,1,0,"ng-container",2),l.Vb(),l.Vb(),l.Wb(8,"mat-dialog-actions"),l.Wb(9,"footer"),l.Wb(10,"button",3),l.lc("tapped",(function(){return t.event.emit({reason:"done"})})),l.ac(11,Je),l.Vb(),l.Vb(),l.Vb(),l.Lc(12,mt,1,1,"ng-template",null,4,l.Mc)),2&e){const e=l.Ac(13);l.Cb(4),l.vc("icon",l.wc(4,ft)),l.Cb(3),l.vc("ngTemplateOutlet",e)("ngTemplateOutletContext",l.xc(5,lt,t.item)),l.Cb(3),l.vc("disabled",!t.requirements_met)}},directives:[P.b,C.d,M.a,C.f,i.A,C.c,x.c,i.t,nt.b,a.r,a.u,i.s,H.a,nt.a],styles:["main[_ngcontent-%COMP%]{width:24em;min-height:24em;overflow:hidden auto}main[_ngcontent-%COMP%] > mat-radio-group[_ngcontent-%COMP%] > .item[_ngcontent-%COMP%]{background:none;border:none;border-bottom:1px solid #ccc}main[_ngcontent-%COMP%] > mat-radio-group[_ngcontent-%COMP%] > .item[_ngcontent-%COMP%]:last-child{border:none}.item[_ngcontent-%COMP%]{padding:.5em;border:1px solid #ccc;width:100%}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{border-bottom:none}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:first-child{border-radius:4px 4px 0 0;margin-top:.25em}mat-radio-group[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:last-child{margin-bottom:.25em;border-radius:0 0 4px 4px;border-bottom:1px solid #ccc}mat-dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #ccc}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),e})();var bt,gt,pt,vt,_t=n("Qu3c"),yt=n("019G");function Ct(e,t){if(1&e&&l.Rb(0,"div",15),2&e){const e=l.pc(2);l.Kc("background-image","url("+e.item.image_path+")",l.Jb)}}function wt(e,t){if(1&e&&(l.Wb(0,"div",16),l.Nc(1),l.qc(2,"currency"),l.Vb()),2&e){const e=l.pc(2);l.Cb(1),l.Pc(" ",l.sc(2,1,e.item.unit_price/100,e.symbol)," ")}}function Ot(e,t){if(1&e&&(l.Wb(0,"div",17),l.ac(1,gt),l.Vb()),2&e){const e=l.pc(2);l.vc("matTooltip",e.contents),l.Cb(1),l.ec(e.item.items.length)(e.item.items.length),l.bc(1)}}function kt(e,t){if(1&e&&(l.Wb(0,"div",17),l.Nc(1),l.Wb(2,"span",18),l.ac(3,pt),l.Vb(),l.Vb()),2&e){const e=l.pc(2);l.vc("matTooltip",e.contents),l.Cb(1),l.Pc(" ",e.item.must_select," ")}}function Pt(e,t){if(1&e){const e=l.Xb();l.Wb(0,"button",19),l.lc("tapped",(function(){return l.Dc(e),l.pc(2).updatePackageOptions()})),l.ac(1,vt),l.Vb()}}function Mt(e,t){if(1&e&&(l.Wb(0,"div",20),l.Nc(1),l.qc(2,"currency"),l.Vb()),2&e){const e=l.pc(2);l.Cb(1),l.Pc(" ",l.sc(2,1,e.item.unit_price/100,e.symbol)," ")}}function xt(e,t){if(1&e){const e=l.Xb();l.Wb(0,"a-counter",21),l.lc("ngModelChange",(function(t){return l.Dc(e),l.pc(2).updateAmount(t)})),l.Vb()}if(2&e){const e=l.pc(2);l.vc("ngModel",e.item.amount)}}bt=$localize`:␟326d978c4b2de6f42edfe0ac588e188b6fc40471␟3278355766885608724:{VAR_PLURAL, plural, =1 {Contains {INTERPOLATION} item } other {Contains {INTERPOLATION} items }}`,bt=l.fc(bt,{VAR_PLURAL:"\ufffd0\ufffd",INTERPOLATION:"\ufffd1\ufffd"}),gt=$localize`:Catering order item available options label␟8d2393e9c6ca1b836a6850f9fdb5f171e496ea1b␟7552499218458333923: ${bt}:ICU: `,pt=$localize`:Catering order item selected options label␟ef028ca4d759738e1437e4c8c753a05a09d0bf5a␟9119132180854167033: Selected `,vt=$localize`:Catering order item options change action␟7519e367547b18c1a111e6fe13cd5b318a6d1cf5␟204010548841636282: Customise `;const Vt=function(e){return{class:"material-icons",content:e}};function Wt(e,t){if(1&e){const e=l.Xb();l.Wb(0,"button",22),l.lc("tapped",(function(){l.Dc(e);const t=l.pc(2);return t.show_children=!t.show_children})),l.Rb(1,"app-icon",23),l.Vb()}if(2&e){const e=l.pc(2);l.Cb(1),l.vc("icon",l.xc(1,Vt,e.show_children?"keyboard_arrow_up":"keyboard_arrow_down"))}}function zt(e,t){if(1&e&&(l.Wb(0,"div",3),l.Lc(1,Ct,1,2,"div",4),l.Wb(2,"div",5),l.Wb(3,"div",6),l.Nc(4),l.Vb(),l.Wb(5,"div",7),l.Nc(6),l.Vb(),l.Wb(7,"div",8),l.Lc(8,wt,3,4,"div",9),l.Lc(9,Ot,2,3,"div",10),l.Lc(10,kt,4,2,"div",10),l.Lc(11,Pt,2,0,"button",11),l.Vb(),l.Vb(),l.Lc(12,Mt,3,4,"div",12),l.Lc(13,xt,1,1,"a-counter",13),l.Lc(14,Wt,2,3,"button",14),l.Vb()),2&e){const e=l.pc();l.Gb("subitem",e.subitem),l.Db("disabled",e.disabled&&!e.item.can_order_anytime),l.Cb(1),l.vc("ngIf",!e.subitem),l.Cb(3),l.Oc(e.item.name),l.Cb(2),l.Qc("",e.item.package?"[Package] ":"","",e.item.description,""),l.Cb(2),l.vc("ngIf",e.item.unit_price),l.Cb(1),l.vc("ngIf",e.item.package&&e.item.items.length&&!e.item.must_select),l.Cb(1),l.vc("ngIf",e.item.package&&e.item.must_select&&e.item.amount>0),l.Cb(1),l.vc("ngIf",e.item.package&&e.item.must_select&&e.item.amount>0),l.Cb(1),l.vc("ngIf",e.item.unit_price),l.Cb(1),l.vc("ngIf",!e.item.items||e.item.package),l.Cb(1),l.vc("ngIf",e.item.items&&e.item.items.length&&!e.item.package)}}function It(e,t){if(1&e&&l.Rb(0,"a-catering-order-item",24),2&e){const e=t.$implicit,n=l.pc();l.vc("subitem",!0)("symbol",n.symbol)("item",e)("field",n.field)}}let Dt=(()=>{class e extends s.a{constructor(e,t){super(),this._service=e,this._dialog=t}get contents(){return this.item.items?this.item.items.reduce((e,t)=>(e&&(e+="\n\n"),e+`${t.name}${t.items?t.items.reduce((e,t)=>e+`\n ${t.amount?"\u2713":"\u2022"} ${t.name} `,""):""} ${t.amount?"\u2713":""}`),""):""}ngOnChanges(e){if(e.field&&this.field){const e=this.field.value.find(e=>e.id===this.item.id);this.item.setAmount(e?e.amount:0),this.subscription("field_change",this.field.valueChanges.subscribe(e=>{const t=e.find(e=>e.id===this.item.id);this.item.setAmount(t?t.amount:0)}))}}updateAmount(e){if(this.field){const t=this.field.value||[],n=t.find(e=>e.id===this.item.id);if(n)this.item.setAmount(e),n.setAmount(e);else{const n=this.item.amount;this.item.setAmount(e),this.item.package&&n<e?this.selectPackageOptions().then(e=>{t.push(new tt.a(e)),this.field.setValue(t.filter(e=>e.amount))},()=>{this.item.setAmount(999),this.timeout("amount",()=>this.item.setAmount(0),5),this._service.notifyWarn("Package options not selected. Item removed from order")}):t.push(new tt.a(this.item))}this.field.setValue(t.filter(e=>e.amount))}}updatePackageOptions(){this.selectPackageOptions().then(()=>null,()=>null)}selectPackageOptions(){return new Promise((e,t)=>{const n=this._dialog.open(ht,{maxWidth:"95vw",data:{item:new et.a(this.item)}});let i=!1;n.componentInstance.event.subscribe(t=>{"done"===t.reason&&(i=!0,e(n.componentInstance.item),n.close())}),n.afterClosed().subscribe(()=>{i||t()})})}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(c.a),l.Qb(C.b))},e.\u0275cmp=l.Kb({type:e,selectors:[["a-catering-order-item"]],inputs:{subitem:"subitem",item:"item",field:"field",symbol:"symbol",disabled:"disabled"},features:[l.zb,l.Ab],decls:3,vars:3,consts:[["class","catering-item",3,"subitem",4,"ngIf"],[1,"children"],[3,"subitem","symbol","item","field",4,"ngFor","ngForOf"],[1,"catering-item"],["class","image",3,"background-image",4,"ngIf"],[1,"details"],[1,"name"],[1,"description"],[1,"options"],["class","option price mobile-only",4,"ngIf"],["class","option",3,"matTooltip",4,"ngIf"],["mat-button","",3,"tapped",4,"ngIf"],["class","option price not-mobile",4,"ngIf"],[3,"ngModel","ngModelChange",4,"ngIf"],["mat-icon-button","",3,"tapped",4,"ngIf"],[1,"image"],[1,"option","price","mobile-only"],[1,"option",3,"matTooltip"],[1,"not-mobile"],["mat-button","",3,"tapped"],[1,"option","price","not-mobile"],[3,"ngModel","ngModelChange"],["mat-icon-button","",3,"tapped"],[3,"icon"],[3,"subitem","symbol","item","field"]],template:function(e,t){1&e&&(l.Lc(0,zt,15,14,"div",0),l.Wb(1,"div",1),l.Lc(2,It,1,4,"a-catering-order-item",2),l.Vb()),2&e&&(l.vc("ngIf",t.item),l.Cb(1),l.vc("@show",t.show_children?"show":"hide"),l.Cb(1),l.vc("ngForOf",t.item.items))},directives:[i.t,i.s,_t.a,P.b,x.c,yt.a,a.r,a.u,M.a,e],pipes:[i.d],styles:[".catering-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem}.catering-item[disabled=true][_ngcontent-%COMP%]{pointer-events:none;opacity:.35;background-color:rgba(0,0,0,.2)}.subitem[_ngcontent-%COMP%]{border-top:1px solid #ccc}.name[_ngcontent-%COMP%]{max-width:480px}.image[_ngcontent-%COMP%]{height:3em;width:3em;min-width:3em;border-radius:4px;background-color:rgba(0,0,0,.05);background-position:50%;background-size:cover;border:1px solid rgba(0,0,0,.05)}.details[_ngcontent-%COMP%]{flex:1;min-width:25%;padding:0 .5em;display:flex;flex-direction:column}.details[_ngcontent-%COMP%]   *[_ngcontent-%COMP%] > {white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.options[_ngcontent-%COMP%]{display:flex;align-items:center}.options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;font-size:.8em;height:1.5em;color:rgba(0,0,0,.85);line-height:1em;padding:0 .25em;text-decoration:underline}.option[_ngcontent-%COMP%]{padding:.25em .5em;border-radius:4px;color:#fff;font-size:.8rem;background-color:#1937ea;margin:.25em .4rem .25em 0;white-space:nowrap}.description[_ngcontent-%COMP%]{font-size:.75em;margin-top:.25em}.children[_ngcontent-%COMP%]{font-size:.9em;background-color:rgba(0,0,0,.05)}"],data:{animation:[X.a]}}),e})();var St,At;function $t(e,t){if(1&e&&l.Rb(0,"a-catering-order-item",9),2&e){const e=t.$implicit,n=l.pc();l.vc("field",n.item_field)("subitem",!0)("item",e)("symbol",n.symbol)}}St=$localize`:Catering confirm order header␟6340fbfb7791b769818d351dcad5944eea4af597␟1890120752020168546:Confirm Catering Order`,At=$localize`:Catering confirm save action␟e787287c2a4bf3ec6b3208d05d1c3d5f21688ced␟7260697646773693724:Save Order`;const Lt=function(){return{class:"material-icons",content:"close"}};let Nt=(()=>{class e extends s.a{constructor(e,t,n){super(),this._service=e,this._dialog_ref=t,this._data=n,this.event=new l.n,this.item_list=[]}get space(){return this._data.form&&this._data.form.controls.space?this._data.form.controls.space.value:{}}get delivery_time(){return O(this._data.date).format("h:mm A")}get item_field(){return this._data.form?this._data.form.controls.items:null}get order_cost(){return this.item_list.reduce((e,t)=>e+t.amount*t.unit_price,0)}get symbol(){if(!this.space||!this.space.level)return"USD";const e=this._service.Organisation.buildings.find(e=>e.id===this.space.level.building_id);return e?e.currency:"USD"}ngOnInit(){this._data.form.controls.items&&this.subscription("item_list",this._data.form.controls.items.valueChanges.subscribe(e=>{(!e||e.length<=0)&&this._dialog_ref.close()})),this.item_list=(this._data.form&&this._data.form.controls.items?this._data.form.controls.items.value:[]).map(e=>new tt.a(e))}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(c.a),l.Qb(C.h),l.Qb(C.a))},e.\u0275cmp=l.Kb({type:e,selectors:[["a-catering-confirm-modal"]],outputs:{event:"event"},features:[l.zb],decls:26,vars:9,consts:[[1,"heading"],["mat-icon-button","","mat-dialog-close",""],[3,"icon"],[1,"details"],[1,"list"],[3,"field","subitem","item","symbol",4,"ngFor","ngForOf"],[1,"total"],[1,"value"],["mat-button","",3,"tapped"],[3,"field","subitem","item","symbol"]],template:function(e,t){1&e&&(l.Wb(0,"header"),l.Wb(1,"div",0),l.ac(2,St),l.Vb(),l.Wb(3,"button",1),l.Rb(4,"app-icon",2),l.Vb(),l.Vb(),l.Wb(5,"mat-dialog-content"),l.Wb(6,"main"),l.Wb(7,"div",3),l.Nc(8," Delivering to "),l.Wb(9,"span"),l.Nc(10),l.Vb(),l.Nc(11," at "),l.Wb(12,"span"),l.Nc(13),l.Vb(),l.Vb(),l.Wb(14,"div",4),l.Lc(15,$t,1,4,"a-catering-order-item",5),l.Vb(),l.Wb(16,"div",6),l.Wb(17,"label"),l.Nc(18,"Order Total:"),l.Vb(),l.Wb(19,"div",7),l.Nc(20),l.qc(21,"currency"),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Wb(22,"mat-dialog-actions"),l.Wb(23,"footer"),l.Wb(24,"button",8),l.lc("tapped",(function(){return t.event.emit({reason:"done"})})),l.ac(25,At),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Cb(4),l.vc("icon",l.wc(8,Lt)),l.Cb(6),l.Oc(t.space.name||"<Unset>"),l.Cb(3),l.Oc(t.delivery_time),l.Cb(2),l.vc("ngForOf",t.item_list),l.Cb(5),l.Oc(l.sc(21,5,t.order_cost/100,t.symbol)))},directives:[P.b,C.d,M.a,C.f,i.s,C.c,x.c,Dt],pipes:[i.d],styles:[".heading[_ngcontent-%COMP%]{flex:1}.details[_ngcontent-%COMP%]{padding:1em;text-align:center}.details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:400}.list[_ngcontent-%COMP%]{height:50vh;overflow:auto}.total[_ngcontent-%COMP%]{border-top:1px solid #ccc;display:flex;align-items:center;justify-content:flex-end;padding:.5em 1em}.total[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.8em;font-weight:500;margin-right:1.5em}mat-dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #ccc}footer[_ngcontent-%COMP%]{width:100%;text-align:center}"]}),e})();var jt,Tt=function(e,t){return(n=(t={exports:{}}).exports).isLeapYear=function(e){return e%4==0&&e%100!=0||e%400==0},n.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.valueOf())},n.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},n.zeroPad=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n="0";return(e+="").length>=t?e:new Array(t-e.length+1).join(n)+e},n.titleCase=function(e){return e?e[0].toUpperCase()+e.substr(1):""},n.ordinal=function(e){var t=e%10,n=e%100;return 1===t&&11!==n?e+"st":2===t&&12!==n?e+"nd":3===t&&13!==n?e+"rd":e+"th"},n.toCardinal=function(e){return e=(e=String(e)).replace(/([0-9])(st|nd|rd|th)$/i,"$1"),parseInt(e,10)},n.normalize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"day"===(e=(e=(e=(e=e.toLowerCase().trim()).replace(/ies$/,"y")).replace(/s$/,"")).replace(/-/g,""))?"date":e},n.getEpoch=function(e){return"number"==typeof e?e:n.isDate(e)?e.getTime():e.epoch?e.epoch:null},n.beADate=function(e,t){return!1===n.isObject(e)?t.clone().set(e):e},n.formatTimezone=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=Math.abs(e),o=e>0?"+":"-";return"".concat(o).concat(n.zeroPad(i)).concat(t,"00")},t.exports;var n}(),Ft=Tt.zeroPad,Et=function(e,t,n,i){var o=new Date(e),a=(o.getTimezoneOffset()||0)+60*i;a=60*a*1e3;var r=function(e){return Ft(e.getMonth()+1)+"/"+Ft(e.getDate())+":"+Ft(e.getHours())}(o=new Date(e+a));return r>=t&&r<n},qt=function(e){var t=e.timezones[e.tz];if(void 0===t)return console.warn("Warning: couldn't find timezone "+e.tz),0;if(void 0===t.dst)return t.offset;var n=t.offset,i=t.offset+1;"n"===t.hem&&(i=n-1);var o=t.dst.split("->");return!0===Et(e.epoch,o[0],o[1],n)?n:i},Rt=["africa","america","asia","atlantic","australia","brazil","canada","chile","europe","indian","mexico","pacific","antarctica","etc"],Bt=(jt=Object.freeze({__proto__:null,default:{"9|s":"2/dili,2/jayapura","9|n":"2/chita,2/khandyga,2/pyongyang,2/seoul,2/tokyo,11/palau","9.5|s|04/05:03->10/04:02":"4/adelaide,4/broken_hill,4/south,4/yancowinna","9.5|s":"4/darwin,4/north","8|s":"12/casey,2/kuala_lumpur,2/makassar,2/singapore,4/perth,4/west","8|n|03/25:03->09/29:23":"2/ulan_bator","8|n":"2/brunei,2/choibalsan,2/chongqing,2/chungking,2/harbin,2/hong_kong,2/irkutsk,2/kuching,2/macao,2/macau,2/manila,2/shanghai,2/taipei,2/ujung_pandang,2/ulaanbaatar","8.75|s":"4/eucla","7|s":"12/davis,2/jakarta,9/christmas","7|n":"2/bangkok,2/barnaul,2/ho_chi_minh,2/hovd,2/krasnoyarsk,2/novokuznetsk,2/novosibirsk,2/phnom_penh,2/pontianak,2/saigon,2/tomsk,2/vientiane","6|s":"12/vostok","6|n":"2/almaty,2/bishkek,2/dacca,2/dhaka,2/kashgar,2/omsk,2/qyzylorda,2/thimbu,2/thimphu,2/urumqi,9/chagos","6.5|n":"2/rangoon,2/yangon,9/cocos","5|s":"12/mawson,9/kerguelen","5|n":"2/aqtau,2/aqtobe,2/ashgabat,2/ashkhabad,2/atyrau,2/baku,2/dushanbe,2/karachi,2/oral,2/samarkand,2/tashkent,2/yekaterinburg,9/maldives","5.75|n":"2/kathmandu,2/katmandu","5.5|n":"2/calcutta,2/colombo,2/kolkata","4|s":"9/reunion","4|n":"2/dubai,2/muscat,2/tbilisi,2/yerevan,8/astrakhan,8/samara,8/saratov,8/ulyanovsk,8/volgograd,2/volgograd,9/mahe,9/mauritius","4.5|n|03/21:00->09/20:24":"2/tehran","4.5|n":"2/kabul","3|s":"12/syowa,9/antananarivo","3|n|03/29:03->10/25:04":"2/famagusta,2/nicosia,8/athens,8/bucharest,8/helsinki,8/kiev,8/mariehamn,8/nicosia,8/riga,8/sofia,8/tallinn,8/uzhgorod,8/vilnius,8/zaporozhye","3|n|03/29:02->10/25:03":"8/chisinau,8/tiraspol","3|n|03/29:00->10/24:24":"2/beirut","3|n|03/27:02->10/25:02":"2/jerusalem,2/tel_aviv","3|n|03/27:00->10/31:01":"2/gaza,2/hebron","3|n|03/27:00->10/30:01":"2/amman","3|n|03/27:00->10/29:24":"2/damascus","3|n":"0/addis_ababa,0/asmara,0/asmera,0/dar_es_salaam,0/djibouti,0/juba,0/kampala,0/mogadishu,0/nairobi,2/aden,2/baghdad,2/bahrain,2/istanbul,2/kuwait,2/qatar,2/riyadh,8/istanbul,8/kirov,8/minsk,8/moscow,8/simferopol,9/comoro,9/mayotte","2|s|03/29:02->10/25:02":"12/troll","2|s":"0/gaborone,0/harare,0/johannesburg,0/lubumbashi,0/lusaka,0/maputo,0/maseru,0/mbabane","2|n|03/29:02->10/25:03":"0/ceuta,arctic/longyearbyen,3/jan_mayen,8/amsterdam,8/andorra,8/belgrade,8/berlin,8/bratislava,8/brussels,8/budapest,8/busingen,8/copenhagen,8/gibraltar,8/ljubljana,8/luxembourg,8/madrid,8/malta,8/monaco,8/oslo,8/paris,8/podgorica,8/prague,8/rome,8/san_marino,8/sarajevo,8/skopje,8/stockholm,8/tirane,8/vaduz,8/vatican,8/vienna,8/warsaw,8/zagreb,8/zurich","2|n":"0/blantyre,0/bujumbura,0/cairo,0/khartoum,0/kigali,0/tripoli,8/kaliningrad","1|s|04/02:01->09/03:03":"0/windhoek","1|s":"0/kinshasa,0/luanda","1|n|04/19:03->05/24:02":"0/casablanca,0/el_aaiun","1|n|03/29:01->10/25:02":"3/canary,3/faeroe,3/faroe,3/madeira,8/belfast,8/dublin,8/guernsey,8/isle_of_man,8/jersey,8/lisbon,8/london","1|n":"0/algiers,0/bangui,0/brazzaville,0/douala,0/lagos,0/libreville,0/malabo,0/ndjamena,0/niamey,0/porto-novo,0/tunis","14|n":"11/kiritimati","13|s|04/05:04->09/27:03":"11/apia","13|s|01/15:02->11/05:03":"11/tongatapu","13|n":"11/enderbury,11/fakaofo","12|s|04/05:03->09/27:02":"12/mcmurdo,12/south_pole,11/auckland","12|s|01/12:03->11/08:02":"11/fiji","12|n":"2/anadyr,2/kamchatka,2/srednekolymsk,11/funafuti,11/kwajalein,11/majuro,11/nauru,11/tarawa,11/wake,11/wallis","12.75|s|04/05:03->04/05:02":"11/chatham","11|s":"12/macquarie,11/bougainville","11|n":"2/magadan,2/sakhalin,11/efate,11/guadalcanal,11/kosrae,11/noumea,11/pohnpei,11/ponape","11.5|n|04/05:03->10/04:02":"11/norfolk","10|s|04/05:03->10/04:02":"4/act,4/canberra,4/currie,4/hobart,4/melbourne,4/nsw,4/sydney,4/tasmania,4/victoria","10|s":"12/dumontdurville,4/brisbane,4/lindeman,4/queensland","10|n":"2/ust-nera,2/vladivostok,2/yakutsk,11/chuuk,11/guam,11/port_moresby,11/saipan,11/truk,11/yap","10.5|s|04/05:01->10/04:02":"4/lhi,4/lord_howe","0|n|03/29:00->10/25:01":"1/scoresbysund,3/azores","0|n":"0/abidjan,0/accra,0/bamako,0/banjul,0/bissau,0/conakry,0/dakar,0/freetown,0/lome,0/monrovia,0/nouakchott,0/ouagadougou,0/sao_tome,0/timbuktu,1/danmarkshavn,3/reykjavik,3/st_helena,13/gmt,13/gmt+0,13/gmt-0,13/gmt0,13/greenwich,13/utc,13/universal,13/zulu","-9|n|03/08:02->11/01:02":"1/adak,1/atka","-9|n":"11/gambier","-9.5|n":"11/marquesas","-8|n|03/08:02->11/01:02":"1/anchorage,1/juneau,1/metlakatla,1/nome,1/sitka,1/yakutat","-8|n":"11/pitcairn","-7|n|03/08:02->11/01:02":"1/dawson,1/ensenada,1/los_angeles,1/santa_isabel,1/tijuana,1/vancouver,1/whitehorse,6/pacific,6/yukon,10/bajanorte","-7|n":"1/creston,1/dawson_creek,1/hermosillo,1/phoenix","-6|s|04/04:22->09/05:22":"7/easterisland,11/easter","-6|n|04/05:02->10/25:02":"1/chihuahua,1/mazatlan,10/bajasur","-6|n|03/08:02->11/01:02":"1/boise,1/cambridge_bay,1/denver,1/edmonton,1/inuvik,1/ojinaga,1/shiprock,1/yellowknife,6/mountain","-6|n":"1/belize,1/costa_rica,1/el_salvador,1/guatemala,1/managua,1/regina,1/swift_current,1/tegucigalpa,6/east-saskatchewan,6/saskatchewan,11/galapagos","-5|s":"1/lima,1/rio_branco,5/acre","-5|n|04/05:02->10/25:02":"1/bahia_banderas,1/merida,1/mexico_city,1/monterrey,10/general","-5|n|03/12:03->11/05:01":"1/north_dakota","-5|n|03/08:02->11/01:02":"1/chicago,1/knox_in,1/matamoros,1/menominee,1/rainy_river,1/rankin_inlet,1/resolute,1/winnipeg,6/central","-5|n":"1/atikokan,1/bogota,1/cancun,1/cayman,1/coral_harbour,1/eirunepe,1/guayaquil,1/jamaica,1/panama,1/porto_acre","-4|s|05/13:23->08/13:01":"12/palmer","-4|s|04/04:24->09/06:00":"1/santiago,7/continental","-4|s|03/21:24->10/04:00":"1/asuncion","-4|s|02/16:24->11/03:00":"1/campo_grande,1/cuiaba","-4|s":"1/la_paz,1/manaus,5/west","-4|n|03/12:03->11/05:01":"1/indiana,1/kentucky","-4|n|03/08:02->11/01:02":"1/detroit,1/fort_wayne,1/grand_turk,1/indianapolis,1/iqaluit,1/louisville,1/montreal,1/nassau,1/new_york,1/nipigon,1/pangnirtung,1/port-au-prince,1/thunder_bay,1/toronto,6/eastern","-4|n|03/08:00->11/01:01":"1/havana","-4|n":"1/anguilla,1/antigua,1/aruba,1/barbados,1/blanc-sablon,1/boa_vista,1/caracas,1/curacao,1/dominica,1/grenada,1/guadeloupe,1/guyana,1/kralendijk,1/lower_princes,1/marigot,1/martinique,1/montserrat,1/port_of_spain,1/porto_velho,1/puerto_rico,1/santo_domingo,1/st_barthelemy,1/st_kitts,1/st_lucia,1/st_thomas,1/st_vincent,1/tortola,1/virgin","-3|s":"1/argentina,1/buenos_aires,1/cordoba,1/fortaleza,1/montevideo,1/punta_arenas,1/sao_paulo,12/rothera,3/stanley,5/east","-3|n|03/08:02->11/01:02":"1/glace_bay,1/goose_bay,1/halifax,1/moncton,1/thule,3/bermuda,6/atlantic","-3|n":"1/araguaina,1/bahia,1/belem,1/catamarca,1/cayenne,1/jujuy,1/maceio,1/mendoza,1/paramaribo,1/recife,1/rosario,1/santarem","-2|s":"5/denoronha","-2|n|03/28:22->10/24:23":"1/godthab","-2|n|03/08:02->11/01:02":"1/miquelon","-2|n":"1/noronha,3/south_georgia","-2.5|n|03/08:02->11/01:02":"1/st_johns,6/newfoundland","-1|n":"3/cape_verde","-11|n":"11/midway,11/niue,11/pago_pago,11/samoa","-10|n":"11/honolulu,11/johnston,11/rarotonga,11/tahiti"}}))&&jt.default||jt,Gt={};Object.keys(Bt).forEach((function(e){var t=e.split("|"),n={offset:Number(t[0]),hem:t[1]};t[2]&&(n.dst=t[2]),Bt[e].split(",").forEach((function(e){e=e.replace(/(^[0-9]+)\//,(function(e,t){return t=Number(t),Rt[t]+"/"})),Gt[e]=n}))})),Gt.utc={offset:0,hem:"n"};for(var Qt=-14;Qt<=14;Qt+=.5){var Ut=Qt;Ut>0&&(Ut="+"+Ut);var Yt="etc/gmt"+Ut;Gt[Yt]={offset:-1*Qt,hem:"n"},Gt[Yt="utc/gmt"+Ut]={offset:-1*Qt,hem:"n"}}var Xt,Ht=Gt,Kt=/(\-?[0-9]+)h(rs)?/i,Zt=/(\-?[0-9]+)/,Jt=/utc([\-+]?[0-9]+)/i,en=/gmt([\-+]?[0-9]+)/i,tn=function(e){return(e=Number(e))>-13&&e<13?"etc/gmt"+(e=((e*=-1)>0?"+":"")+e):null},nn=null===(Xt=function(){if("undefined"==typeof Intl||void 0===Intl.DateTimeFormat)return null;var e=Intl.DateTimeFormat();if(void 0===e||void 0===e.resolvedOptions)return null;var t=e.resolvedOptions().timeZone;return t?t.toLowerCase():null}())?"utc":Xt,on=Object.keys(Ht).reduce((function(e,t){var n=t.split("/")[1]||"";return e[n=n.replace(/_/g," ")]=t,e}),{}),an=function(e,t){if(!e)return nn;var n=e.trim(),i=e.split("/");if(i.length>2&&!1===t.hasOwnProperty(n)&&(n=i[0]+"/"+i[1]),n=n.toLowerCase(),!0===t.hasOwnProperty(n))return n;if(n=function(e){return(e=(e=(e=(e=(e=e.replace(/ time/g,"")).replace(/ (standard|daylight|summer)/g,"")).replace(/\b(east|west|north|south)ern/g,"$1")).replace(/\b(africa|america|australia)n/g,"$1")).replace(/\beuropean/g,"europe")).replace(/\islands/g,"island")}(n),!0===t.hasOwnProperty(n))return n;if(!0===on.hasOwnProperty(n))return on[n];if(!0===/[0-9]/.test(n)){var o=function(e){var t=e.match(Kt);if(null!==t)return tn(t[1]);if(null!==(t=e.match(Jt)))return tn(t[1]);if(null!==(t=e.match(en))){var n=-1*Number(t[1]);return tn(n)}return null!==(t=e.match(Zt))?tn(t[1]):null}(n);if(o)return o}throw new Error("Spacetime: Cannot find timezone named: '"+e+"'. Please enter an IANA timezone id.")},rn={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5};rn.date=rn.day,rn.month=25488e5,rn.week=6048e5,rn.year=3154e7,Object.keys(rn).forEach((function(e){rn[e+"s"]=rn[e]}));var cn=rn,sn=function(e,t,n,i,o){var a=e.d[n]();if(a!==t){var r=null===o?null:e.d[o](),c=e.epoch,s=t-a;e.epoch+=cn[i]*s,"day"===i&&Math.abs(s)>28&&t<28&&(e.epoch+=cn.hour);for(var l=cn[i]/2;e.d[n]()<t;)e.epoch+=l;for(;e.d[n]()>t;)e.epoch-=l;null!==o&&r!==e.d[o]()&&(e.epoch=c,e.epoch+=cn[i]*s*.89)}},ln={year:{valid:function(e){return e>-4e3&&e<4e3},walkTo:function(e,t){return sn(e,t,"getFullYear","year",null)}},month:{valid:function(e){return e>=0&&e<=11},walkTo:function(e,t){var n=e.d,i=n.getMonth(),o=e.epoch,a=n.getFullYear();if(i!==t){for(e.epoch+=cn.day*(28*(t-i)),a!==e.d.getFullYear()&&(e.epoch=o);e.d.getMonth()<t;)e.epoch+=cn.day;for(;e.d.getMonth()>t;)e.epoch-=cn.day}}},date:{valid:function(e){return e>0&&e<=31},walkTo:function(e,t){return sn(e,t,"getDate","day","getMonth")}},hour:{valid:function(e){return e>=0&&e<24},walkTo:function(e,t){return sn(e,t,"getHours","hour","getDate")}},minute:{valid:function(e){return e>=0&&e<60},walkTo:function(e,t){return sn(e,t,"getMinutes","minute","getHours")}},second:{valid:function(e){return e>=0&&e<60},walkTo:function(e,t){e.epoch=e.seconds(t).epoch}},millisecond:{valid:function(e){return e>=0&&e<1e3},walkTo:function(e,t){e.epoch=e.milliseconds(t).epoch}}},dn=function(e,t){for(var n=Object.keys(ln),i=e.clone(),o=0;o<n.length;o++){var a=n[o],r=t[a];if(void 0===r&&(r=i[a]()),"string"==typeof r&&(r=parseInt(r,10)),!ln[a].valid(r))return e.epoch=null,void(!1===e.silent&&console.warn("invalid "+a+": "+r));ln[a].walkTo(e,r)}},un=["jan","feb","mar","apr","may","jun","jul","aug","sept","oct","nov","dec"],mn=["january","february","march","april","may","june","july","august","september","october","november","december"],fn=function(){return un},hn=function(){return function(){for(var e={sep:8},t=0;t<un.length;t++)e[un[t]]=t;for(var n=0;n<mn.length;n++)e[mn[n]]=n;return e}()},bn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=(t=t.replace(/^\s+/,"").toLowerCase()).match(/([0-9]{1,2}):([0-9]{1,2}):?([0-9]{1,2})?[:\.]?([0-9]{1,4})?/);if(null!==n){var i=Number(n[1]);if(i<0||i>24)return e.startOf("day");var o=Number(n[2]);if(n[2].length<2||o<0||o>59)return e.startOf("day");e=(e=(e=(e=e.hour(i)).minute(o)).seconds(n[3]||0)).millisecond(n[4]||0);var a=t.match(/[\b0-9](am|pm)\b/);return null!==a&&a[1]&&(e=e.ampm(a[1])),e}if(null!==(n=t.match(/([0-9]+) ?(am|pm)/))&&n[1]){var r=Number(n[1]);return r>12||r<1?e.startOf("day"):e=(e=(e=e.hour(n[1]||0)).ampm(n[2])).startOf("hour")}return e.startOf("day")},gn=[31,28,31,30,31,30,31,31,30,31,30,31],pn=Tt.isLeapYear,vn=function(e){return!0===gn.hasOwnProperty(e.month)&&(1===e.month?!!(pn(e.year)&&e.date<=29)||e.date<=28:e.date<=(gn[e.month]||0))},_n=hn(),yn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=parseInt(e.trim(),10);return t||(new Date).getFullYear()},Cn=[{reg:/^(\-?0?0?[0-9]{3,4})-([0-9]{1,2})-([0-9]{1,2})[T| ]([0-9.:]+)(Z|[0-9\-\+:]+)?$/,parse:function(e,t,n,i){var o=parseInt(t[2],10)-1,a={year:t[1],month:o,date:t[3]};return!1===vn(a)?(e.epoch=null,e):(function(e,t){if(!t)return e;"Z"===t&&(t="+0000");var n=0;/^[\+-]?[0-9]{2}:[0-9]{2}$/.test(t)&&(!0===/:00/.test(t)&&(t=t.replace(/:00/,"")),!0===/:30/.test(t)&&(t=t.replace(/:30/,".5"))),/^[\+-]?[0-9]{4}$/.test(t)&&(t=t.replace(/30$/,".5")),n=parseFloat(t),Math.abs(n)>100&&(n/=100),(n*=-1)>=0&&(n="+"+n);var i="etc/gmt"+n;e.timezones[i]&&(e.tz=i)}(e,t[5]),dn(e,a),e=bn(e,t[4]))}},{reg:/^([0-9]{4})[\-\/]([0-9]{1,2})[\-\/]([0-9]{1,2}),?( [0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(e,t){var n={year:t[1],month:parseInt(t[2],10)-1,date:parseInt(t[3],10)};return n.month>=12&&(n.date=parseInt(t[2],10),n.month=parseInt(t[3],10)-1),!1===vn(n)?(e.epoch=null,e):(dn(e,n),e=bn(e,t[4]))}},{reg:/^([0-9]{1,2})[\-\/]([0-9]{1,2})[\-\/]?([0-9]{4})?,?( [0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(e,t){var n=parseInt(t[1],10)-1,i=parseInt(t[2],10);(e.british||n>=12)&&(i=parseInt(t[1],10),n=parseInt(t[2],10)-1);var o={year:t[3]||(new Date).getFullYear(),month:n,date:i};return!1===vn(o)?(e.epoch=null,e):(dn(e,o),e=bn(e,t[4]))}},{reg:/^([0-9]{1,2})[\-\/]([a-z]+)[\-\/]?([0-9]{4})?$/i,parse:function(e,t){var n=_n[t[2].toLowerCase()],i={year:yn(t[3]),month:n,date:Tt.toCardinal(t[1]||"")};return!1===vn(i)?(e.epoch=null,e):(dn(e,i),e=bn(e,t[4]))}},{reg:/^([a-z]+) ([0-9]{1,2}(?:st|nd|rd|th)?),?( [0-9]{4})?( ([0-9:]+( ?am| ?pm| ?gmt)?))?$/i,parse:function(e,t){var n=_n[t[1].toLowerCase()],i={year:yn(t[3]),month:n,date:Tt.toCardinal(t[2]||"")};return!1===vn(i)?(e.epoch=null,e):(dn(e,i),e=bn(e,t[4]))}},{reg:/^([a-z]+) ([0-9]{4})$/i,parse:function(e,t){var n=_n[t[1].toLowerCase()],i={year:yn(t[2]),month:n,date:1};return!1===vn(i)?(e.epoch=null,e):(dn(e,i),e=bn(e,t[4]))}},{reg:/^([0-9]{1,2}(?:st|nd|rd|th)?) ([a-z]+),?( [0-9]{4})?,? ?([0-9]{1,2}:[0-9]{2}:?[0-9]{0,2}? ?(am|pm|gmt))?$/i,parse:function(e,t){var n=_n[t[2].toLowerCase()];if(!n)return null;var i={year:yn(t[3]),month:n,date:Tt.toCardinal(t[1])};return!1===vn(i)?(e.epoch=null,e):(dn(e,i),e=bn(e,t[4]))}},{reg:/^[0-9,]+ ?b\.?c\.?$/i,parse:function(e,t){var n=t[0]||"";n=(n=n.replace(/^([0-9,]+) ?b\.?c\.?$/i,"-$1")).replace(/,/g,"");var i=parseInt(n.trim(),10),o=new Date,a={year:i,month:o.getMonth(),date:o.getDate()};return!1===vn(a)?(e.epoch=null,e):(dn(e,a),e=bn(e))}},{reg:/^[0-9,]+ ?(a\.?d\.?|c\.?e\.?)$/i,parse:function(e,t){var n=t[0]||"";n=n.replace(/,/g,"");var i=parseInt(n.trim(),10),o=new Date,a={year:i,month:o.getMonth(),date:o.getDate()};return!1===vn(a)?(e.epoch=null,e):(dn(e,a),e=bn(e))}},{reg:/^[0-9]{4}( ?a\.?d\.?)?$/i,parse:function(e,t){var n=yn(t[0]),i=new Date,o={year:n,month:i.getMonth(),date:i.getDate()};return!1===vn(o)?(e.epoch=null,e):(dn(e,o),e=bn(e))}}],wn={now:function(e){return e.epoch=Date.now(),e},tonight:function(e){return e.epoch=Date.now(),e.hour(18)},today:function(e){return e.epoch=Date.now(),e},tomorrow:function(e){return e.epoch=Date.now(),(e=e.add(1,"day")).startOf("day")},yesterday:function(e){return e.epoch=Date.now(),(e=e.subtract(1,"day")).startOf("day")},christmas:function(e){var t=(new Date).getFullYear();return e.set([t,11,25,18,0,0])},"new years":function(e){var t=(new Date).getFullYear();return e.set([t,11,31,18,0,0])}};wn["new years eve"]=wn["new years"];var On=wn,kn={year:(new Date).getFullYear(),month:0,date:1},Pn=function(e,t,n){if("number"==typeof t)return t>0&&t<25e8&&!1===e.silent&&(console.warn("  - Warning: You are setting the date to January 1970."),console.warn("       -   did input seconds instead of milliseconds?")),e.epoch=t,e;if(e.epoch=Date.now(),null==t)return e;if(!0===Tt.isDate(t))return e.epoch=t.getTime(),e;if(!0===Tt.isArray(t))return function(e,t){for(var n=["year","month","date","hour","minute","second","millisecond"],i=0;i<n.length;i++)e=e[n[i]](t[i]||kn[n[i]]||0);return e}(e,t);if(!0===Tt.isObject(t))return t.epoch?(e.epoch=t.epoch,e.tz=t.tz,e):e=function(e,t){t=Object.assign({},kn,t);for(var n=Object.keys(t),i=0;i<n.length;i++){var o=n[i];void 0!==e[o]&&"function"==typeof e[o]&&null!=t[o]&&""!==t[o]&&(e=e[o](t[o]||kn[o]||0))}return e}(e,t);if("string"!=typeof t)return e;if(t=(t=(t=t.replace(/\b(mon|tues|wed|wednes|thu|thurs|fri|sat|satur|sun)(day)?\b/i,"")).replace(/,/g,"")).replace(/ +/g," ").trim(),!0===On.hasOwnProperty(t))return On[t](e);for(var i=0;i<Cn.length;i++){var o=t.match(Cn[i].reg);if(o){var a=Cn[i].parse(e,o,n);if(null!==a)return a}}return!1===e.silent&&console.warn("Warning: couldn't parse date-string: '"+t+"'"),e.epoch=null,e},Mn=["sun","mon","tue","wed","thu","fri","sat"],xn=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Vn=function(){return Mn},Wn=function(){return xn},zn=function(e){var t=e.timezone().current.offset,n=t<0,i="00";return.5===Math.abs(t%1)&&(i="30",t=t>=0?Math.floor(t):Math.ceil(t)),"+00:00"==(t=(t=n?"-"+(t=Tt.zeroPad(t*=-1,2)):"+"+(t=Tt.zeroPad(t,2)))+":"+i)&&(t="Z"),t},In={day:function(e){return Tt.titleCase(e.dayName())},"day-short":function(e){return Tt.titleCase(Vn()[e.day()])},"day-number":function(e){return e.day()},"day-ordinal":function(e){return Tt.ordinal(e.day())},"day-pad":function(e){return Tt.zeroPad(e.day())},date:function(e){return e.date()},"date-ordinal":function(e){return Tt.ordinal(e.date())},"date-pad":function(e){return Tt.zeroPad(e.date())},month:function(e){return Tt.titleCase(e.monthName())},"month-short":function(e){return Tt.titleCase(fn()[e.month()])},"month-number":function(e){return e.month()},"month-ordinal":function(e){return Tt.ordinal(e.month())},"month-pad":function(e){return Tt.zeroPad(e.month())},"iso-month":function(e){return Tt.zeroPad(e.month()+1)},year:function(e){var t=e.year();return t>0?t:(t=Math.abs(t))+" BC"},"year-short":function(e){var t=e.year();return t>0?"'".concat(String(e.year()).substr(2,4)):(t=Math.abs(t))+" BC"},"iso-year":function(e){var t=e.year(),n=t<0,i=Tt.zeroPad(Math.abs(t),4);return n&&(i="-"+(i=Tt.zeroPad(i,6))),i},time:function(e){return e.time()},"time-24":function(e){return"".concat(e.hour24(),":").concat(Tt.zeroPad(e.minute()))},hour:function(e){return e.hour12()},"hour-pad":function(e){return Tt.zeroPad(e.hour12())},"hour-24":function(e){return e.hour24()},"hour-24-pad":function(e){return Tt.zeroPad(e.hour24())},minute:function(e){return e.minute()},"minute-pad":function(e){return Tt.zeroPad(e.minute())},second:function(e){return e.second()},"second-pad":function(e){return Tt.zeroPad(e.second())},ampm:function(e){return e.ampm()},quarter:function(e){return"Q"+e.quarter()},season:function(e){return e.season()},era:function(e){return e.era()},json:function(e){return e.json()},timezone:function(e){return e.timezone().name},offset:function(e){return zn(e)},numeric:function(e){return"".concat(e.year(),"/").concat(Tt.zeroPad(e.month()+1),"/").concat(Tt.zeroPad(e.date()))},"numeric-us":function(e){return"".concat(Tt.zeroPad(e.month()+1),"/").concat(Tt.zeroPad(e.date()),"/").concat(e.year())},"numeric-uk":function(e){return"".concat(Tt.zeroPad(e.date()),"/").concat(Tt.zeroPad(e.month()+1),"/").concat(e.year())},"mm/dd":function(e){return"".concat(Tt.zeroPad(e.month()+1),"/").concat(Tt.zeroPad(e.date()))},iso:function(e){var t=e.format("iso-year"),n=Tt.zeroPad(e.month()+1),i=Tt.zeroPad(e.date()),o=Tt.zeroPad(e.h24()),a=Tt.zeroPad(e.minute()),r=Tt.zeroPad(e.second()),c=Tt.zeroPad(e.millisecond(),3),s=zn(e);return"".concat(t,"-").concat(n,"-").concat(i,"T").concat(o,":").concat(a,":").concat(r,".").concat(c).concat(s)},"iso-short":function(e){var t=Tt.zeroPad(e.month()+1),n=Tt.zeroPad(e.date());return"".concat(e.year(),"-").concat(t,"-").concat(n)},"iso-utc":function(e){return new Date(e.epoch).toISOString()},nice:function(e){return"".concat(fn()[e.month()]," ").concat(Tt.ordinal(e.date()),", ").concat(e.time())},"nice-year":function(e){return"".concat(fn()[e.month()]," ").concat(Tt.ordinal(e.date()),", ").concat(e.year())},"nice-day":function(e){return"".concat(Vn()[e.day()]," ").concat(Tt.titleCase(fn()[e.month()])," ").concat(Tt.ordinal(e.date()))},"nice-full":function(e){return"".concat(e.dayName()," ").concat(Tt.titleCase(e.monthName())," ").concat(Tt.ordinal(e.date()),", ").concat(e.time())}},Dn={"day-name":"day","month-name":"month","iso 8601":"iso","time-h24":"time-24","time-12":"time","time-h12":"time",tz:"timezone","day-num":"day-number","month-num":"month-number","month-iso":"iso-month","year-iso":"iso-year","nice-short":"nice",mdy:"numeric-us",dmy:"numeric-uk",ymd:"numeric","yyyy/mm/dd":"numeric","mm/dd/yyyy":"numeric-us","dd/mm/yyyy":"numeric-us","little-endian":"numeric-uk","big-endian":"numeric","day-nice":"nice-day"};Object.keys(Dn).forEach((function(e){return In[e]=In[Dn[e]]}));var Sn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!0!==e.isValid())return"";if(In.hasOwnProperty(t)){var n=In[t](e)||"";return"json"!==t&&(n=String(n),"ampm"!==t&&(n=Tt.titleCase(n))),n}if(-1!==t.indexOf("{")){var i=/\{(.+?)\}/g;return t.replace(i,(function(t,n){return n=n.toLowerCase().trim(),In.hasOwnProperty(n)?String(In[n](e)||""):""}))}return e.format("iso-short")},An=Tt.zeroPad,$n=Tt.formatTimezone,Ln={G:function(e){return e.era()},GG:function(e){return e.era()},GGG:function(e){return e.era()},GGGG:function(e){return"AD"===e.era()?"Anno Domini":"Before Christ"},y:function(e){return e.year()},yy:function(e){return parseInt(String(e.year()).substr(2,4),10)},yyy:function(e){return e.year()},yyyy:function(e){return e.year()},yyyyy:function(e){return"0"+e.year()},Q:function(e){return e.quarter()},QQ:function(e){return e.quarter()},QQQ:function(e){return e.quarter()},QQQQ:function(e){return e.quarter()},M:function(e){return e.month()+1},MM:function(e){return An(e.month()+1)},MMM:function(e){return e.format("month-short")},MMMM:function(e){return e.format("month")},w:function(e){return e.week()},ww:function(e){return An(e.week())},d:function(e){return e.date()},dd:function(e){return An(e.date())},D:function(e){return e.dayOfYear()},DD:function(e){return An(e.dayOfYear())},DDD:function(e){return An(e.dayOfYear(),3)},E:function(e){return e.format("day-short")},EE:function(e){return e.format("day-short")},EEE:function(e){return e.format("day-short")},EEEE:function(e){return e.format("day")},EEEEE:function(e){return e.format("day")[0]},e:function(e){return e.day()},ee:function(e){return e.day()},eee:function(e){return e.format("day-short")},eeee:function(e){return e.format("day")},eeeee:function(e){return e.format("day")[0]},a:function(e){return e.ampm().toUpperCase()},aa:function(e){return e.ampm().toUpperCase()},aaa:function(e){return e.ampm().toUpperCase()},aaaa:function(e){return e.ampm().toUpperCase()},h:function(e){return e.h12()},hh:function(e){return An(e.h12())},H:function(e){return e.hour()},HH:function(e){return An(e.hour())},m:function(e){return e.minute()},mm:function(e){return An(e.minute())},s:function(e){return e.second()},ss:function(e){return An(e.second())},A:function(e){return e.epoch-e.startOf("day").epoch},z:function(e){return e.timezone().name},zz:function(e){return e.timezone().name},zzz:function(e){return e.timezone().name},zzzz:function(e){return e.timezone().name},Z:function(e){return $n(e.timezone().current.offset)},ZZ:function(e){return $n(e.timezone().current.offset)},ZZZ:function(e){return $n(e.timezone().current.offset)},ZZZZ:function(e){return $n(e.timezone().current.offset,":")}},Nn=function(e,t,n){for(var i=e,o=t,a=0;a<n;a+=1)Ln[i]=Ln[o],i+=e,o+=t};Nn("q","Q",4),Nn("L","M",4),Nn("Y","y",4),Nn("c","e",4),Nn("k","H",2),Nn("K","h",2),Nn("S","s",2),Nn("v","z",4),Nn("V","Z",4);var jn=["year","season","quarter","month","week","day","quarterHour","hour","minute"],Tn=function(e,t){var n=e.clone().startOf(t),i=e.clone().endOf(t);return parseFloat(((e.epoch-n.epoch)/(i.epoch-n.epoch)).toFixed(2))},Fn=function(e,t,n){var i=0;for(e=e.clone();e.isBefore(t);)e=e.add(1,n),i+=1;return e.isAfter(t,n)&&(i-=1),i},En=function(e,t,n){return e.isBefore(t)?Fn(e,t,n):-1*Fn(t,e,n)},qn={months:{almost:10,over:4},days:{almost:25,over:10},hours:{almost:20,over:8},minutes:{almost:50,over:20},seconds:{almost:50,over:20}};function Rn(e,t){return 1===e&&(t=t.slice(0,-1)),e+" "+t}var Bn={north:[["spring",2,1],["summer",5,1],["fall",8,1],["autumn",8,1],["winter",11,1]],south:[["fall",2,1],["autumn",2,1],["winter",5,1],["spring",8,1],["summer",11,1]]},Gn=[null,[0,1],[3,1],[6,1],[9,1]],Qn={minute:function(e){return dn(e,{second:0,millisecond:0}),e},quarterhour:function(e){var t=e.minutes();return e=e.minutes(t>=45?45:t>=30?30:t>=15?15:0),dn(e,{second:0,millisecond:0}),e},hour:function(e){return dn(e,{minute:0,second:0,millisecond:0}),e},day:function(e){return dn(e,{hour:0,minute:0,second:0,millisecond:0}),e},week:function(e){var t=e.clone();return(e=e.day(e._weekStart)).isAfter(t)&&(e=e.subtract(1,"week")),dn(e,{hour:0,minute:0,second:0,millisecond:0}),e},month:function(e){return dn(e,{date:1,hour:0,minute:0,second:0,millisecond:0}),e},quarter:function(e){var t=e.quarter();return Gn[t]&&dn(e,{month:Gn[t][0],date:Gn[t][1],hour:0,minute:0,second:0,millisecond:0}),e},season:function(e){var t=e.season(),n="north";"South"===e.hemisphere()&&(n="south");for(var i=0;i<Bn[n].length;i++)if(Bn[n][i][0]===t){var o=e.year();return"winter"===t&&e.month()<3&&(o-=1),dn(e,{year:o,month:Bn[n][i][1],date:Bn[n][i][2],hour:0,minute:0,second:0,millisecond:0}),e}return e},year:function(e){return dn(e,{month:0,date:1,hour:0,minute:0,second:0,millisecond:0}),e},decade:function(e){var t=(e=e.startOf("year")).year(),n=10*parseInt(t/10,10);return e.year(n)},century:function(e){var t=(e=e.startOf("year")).year(),n=100*parseInt(t/100,10);return e.year(n)}};Qn.date=Qn.day;var Un=function(e){return!!Vn().find((function(t){return t===e}))||!!Wn().find((function(t){return t===e}))},Yn=function(e){var t=e.timezones,n=e.tz;if(!1===t.hasOwnProperty(n)&&(n=an(e.tz,t)),null===n)return!1===e.silent&&console.warn("Warn: could not find given or local timezone - '"+e.tz+"'"),{current:{epochShift:0}};var i,o,a=t[n],r={name:(i=n,i=(i=(i=i[0].toUpperCase()+i.substr(1)).replace(/\/gmt/,"/GMT")).replace(/[\/_]([a-z])/gi,(function(e){return e.toUpperCase()}))),hasDst:Boolean(a.dst),default_offset:a.offset,hemisphere:"s"===a.hem?"South":"North",current:{}};if(r.hasDst){var c=(o=a.dst)?o.split("->"):[];r.change={start:c[0],back:c[1]}}var s=a.offset,l=s;return!0===r.hasDst&&(l="North"===r.hemisphere?s-1:a.offset+1),!1===r.hasDst?(r.current.offset=s,r.current.isDST=!1):!0===Et(e.epoch,r.change.start,r.change.back,s)?(r.current.offset=s,r.current.isDST="North"===r.hemisphere):(r.current.offset=l,r.current.isDST="South"===r.hemisphere),r},Xn=["century","decade","year","month","date","day","hour","minute","second","millisecond"],Hn={set:function(e,t){var n=this.clone();return n=Pn(n,e),t&&(this.tz=an(t)),n},timezone:function(){return Yn(this)},isDST:function(){return Yn(this).current.isDST},hasDST:function(){return Yn(this).hasDst},offset:function(){return 60*Yn(this).current.offset},hemisphere:function(){return Yn(this).hemisphere},format:function(e){return Sn(this,e)},unixFmt:function(e){return function(e,t){for(var n=t.split(""),i=[n[0]],o=!1,a=1;a<n.length;a+=1){if("'"===n[a]){if(1!=(o=!o)||!n[a+1]||"'"!==n[a+1])continue;o=!0}!0===o||n[a]===i[i.length-1][0]?i[i.length-1]+=n[a]:i.push(n[a])}return i.reduce((function(t,n){return t+(void 0!==Ln[n]?Ln[n](e)||"":n)}),"")}(this,e)},startOf:function(e){return function(e,t){var n=e.clone();return t=Tt.normalize(t),Qn[t]?Qn[t](n):"summer"===t||"winter"===t?(n=n.season(t),Qn.season(n)):n}(this,e)},endOf:function(e){return function(e,t){var n=e.clone();return t=Tt.normalize(t),Qn[t]?n=(n=(n=Qn[t](n)).add(1,t)).subtract(1,"milliseconds"):n}(this,e)},leapYear:function(){var e=this.year();return Tt.isLeapYear(e)},progress:function(e){return function(e,t){if(t)return t=Tt.normalize(t),Tn(e,t);var n={};return jn.forEach((function(t){n[t]=Tn(e,t)})),n}(this,e)},nearest:function(e){return function(e,t){var n=e.progress();return"quarterhour"===(t=Tt.normalize(t))&&(t="quarterHour"),void 0!==n[t]?(n[t]>.5&&(e=e.add(1,t)),e=e.startOf(t)):!1===e.silent&&console.warn("no known unit '"+t+"'"),e}(this,e)},diff:function(e,t){return function(e,t,n){t=Tt.beADate(t,e);var i=!1;if(e.isAfter(t)){var o=e;e=t,t=o,i=!0}var a=function(e,t){var n=t.epoch-e.epoch,i={milliseconds:n,seconds:parseInt(n/1e3,10)};i.minutes=parseInt(i.seconds/60,10),i.hours=parseInt(i.minutes/60,10);var o=e.clone();return i.years=function(e,t){var n=t.year()-e.year();return(e=e.year(t.year())).isAfter(t)&&(n-=1),n}(o,t),o=e.add(i.years,"year"),i.months=12*i.years,o=e.add(i.months,"month"),i.months+=En(o,t,"month"),i.weeks=52*i.years,o=e.add(i.weeks,"week"),i.weeks+=En(o,t,"week"),i.days=7*i.weeks,o=e.add(i.days,"day"),i.days+=En(o,t,"day"),i}(e,t);return i&&(a=function(e){return Object.keys(e).forEach((function(t){e[t]*=-1})),e}(a)),n?(n=Tt.normalize(n),!0!==/s$/.test(n)&&(n+="s"),"dates"===n&&(n="days"),a[n]):a}(this,e,t)},since:function(e){return e||(e=this.clone().set()),function(e,t){var n,i,o,a=function(e,t){var n=e.isBefore(t),i=n?t:e,o=n?e:t;o=o.clone();var a={years:0,months:0,days:0,hours:0,minutes:0,seconds:0};return Object.keys(a).forEach((function(e){if(!o.isSame(i,e)){var t=o.diff(i,e);o=o.add(t,e),a[e]=t}})),n&&Object.keys(a).forEach((function(e){0!==a[e]&&(a[e]*=-1)})),a}(e,t=Tt.beADate(t,e));if(!0===Object.keys(a).every((function(e){return!a[e]})))return{diff:a,rounded:"now",qualified:"now",precise:"now"};var r=[];return Object.keys(a).forEach((function(e,t,o){var c=Math.abs(a[e]);if(0!==c){var s=Rn(c,e);if(r.push(s),!n){if(n=i=s,t>4)return;var l=o[t+1],d=Math.abs(a[l]);d>qn[l].almost?(n=Rn(c+1,e),i="almost "+n):d>qn[l].over&&(i="over "+s)}}})),o=r.splice(0,2).join(", "),!0===e.isAfter(t)?(n+=" ago",i+=" ago",o+=" ago"):(n="in "+n,i="in "+i,o="in "+o),{diff:a,rounded:n,qualified:i,precise:o}}(this,e)},next:function(e){return this.add(1,e).startOf(e)},last:function(e){return this.subtract(1,e).startOf(e)},isValid:function(){return!(!this.epoch&&0!==this.epoch||isNaN(this.d.getTime()))},goto:function(e){var t=this.clone();return t.tz=an(e,t.timezones),t},every:function(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;if(!t||!n)return[];if(t=Tt.normalize(t),n=e.clone().set(n),e.isAfter(n)){var i=e;e=n,n=i}var o=e.clone();Un(t)?(o=o.next(t),t="week"):o=o.next(t);for(var a=[];o.isBefore(n);)a.push(o),o=o.add(1,t);return a}(this,e,t)},isAwake:function(){var e=this.hour();return!(e<8||e>22)},isAsleep:function(){return!this.isAwake()},log:function(){return console.log(""),console.log(Sn(this,"nice-short")),this},logYear:function(){return console.log(""),console.log(Sn(this,"full-short")),this},json:function(){var e=this;return Xn.reduce((function(t,n){return t[n]=e[n](),t}),{})},debug:function(){var e=this.timezone(),t=this.format("MM")+" "+this.format("date-ordinal")+" "+this.year();return t+="\n     - "+this.format("time"),console.log("\n\n",t+"\n     - "+e.name+" ("+e.current.offset+")"),this},from:function(e){return(e=this.clone().set(e)).since(this)},fromNow:function(){return this.clone().set(Date.now()).since(this)},weekStart:function(e){if("number"==typeof e)return this._weekStart=e,this;if("string"==typeof e){e=e.toLowerCase().trim();var t=Vn().indexOf(e);-1===t&&(t=Wn().indexOf(e)),-1===t&&(t=1),this._weekStart=t}else console.warn("Spacetime Error: Cannot understand .weekStart() input:",e);return this}};Hn.inDST=Hn.isDST,Hn.round=Hn.nearest,Hn.each=Hn.every;var Kn=Hn,Zn=function(e){return"string"==typeof e&&(e=parseInt(e,10)),e},Jn=["year","month","date","hour","minute","second","millisecond"],ei=function(e,t,n){for(var i=Jn.indexOf(n),o=Jn.slice(i,Jn.length),a=0;a<o.length;a++){var r=t[o[a]]();e[o[a]](r)}return e},ti=function(e,t){t=Zn(t);var n=e.clone(),i=e.minute()-t;return e.epoch-=i*cn.minute,ei(e,n,"second"),e.epoch},ni=function(e,t){(t=Zn(t))>=24?t=24:t<0&&(t=0);var n=e.clone(),i=e.hour()-t;return e.epoch-=i*cn.hour,dn(e,{hour:t}),ei(e,n,"minute"),e.epoch},ii=function(e,t){return t=Zn(t),dn(e,{year:t}),e.epoch},oi=function(e){return(e=(e=e.minute(0)).second(0)).millisecond(1)},ai=Object.assign({},{millisecond:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){t=Zn(t);var n=e.millisecond();return e.epoch-(n-t)}(t,e),t}return this.d.getMilliseconds()},second:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){t=Zn(t);var n=e.second()-t;return e.epoch-n*cn.second}(t,e),t}return this.d.getSeconds()},minute:function(e){if(void 0!==e){var t=this.clone();return t.epoch=ti(t,e),t}return this.d.getMinutes()},hour:function(e){var t=this.d;if(void 0!==e){var n=this.clone();return n.epoch=ni(n,e),n}return t.getHours()},hourFloat:function(e){if(void 0!==e){var t=this.clone(),n=e%1;n*=60;var i=parseInt(e,10);return t.epoch=ni(t,i),t.epoch=ti(t,n),t}var o=this.d;return o.getHours()+o.getMinutes()/60},hour12:function(e){var t=this.d;if(void 0!==e){var n=this.clone(),i=(e=""+e).match(/^([0-9]+)(am|pm)$/);if(i){var o=parseInt(i[1],10);"pm"===i[2]&&(o+=12),n.epoch=ni(n,o)}return n}var a=t.getHours();return a>12&&(a-=12),0===a&&(a=12),a},time:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){var n=t.match(/([0-9]{1,2}):([0-9]{1,2})(am|pm)?/);if(!n){if(!(n=t.match(/([0-9]{1,2})(am|pm)/)))return e.epoch;n.splice(2,0,"0")}var i=!1,o=parseInt(n[1],10),a=parseInt(n[2],10);return o>12&&(i=!0),!1===i&&("am"===n[3]&&12===o&&(o=0),"pm"===n[3]&&o<12&&(o+=12)),(e=(e=(e=(e=e.hour(o)).minute(a)).second(0)).millisecond(0)).epoch}(t,e),t}return"".concat(this.h12(),":").concat(Tt.zeroPad(this.minute())).concat(this.ampm())},ampm:function(e){var t="am",n=this.hour();if(n>=12&&(t="pm"),"string"!=typeof e)return t;var i=this.clone();return e=e.toLowerCase().trim(),n>=12&&"am"===e?i.hour(n-=12):n<12&&"pm"===e?i.hour(n+=12):i},dayTime:function(e){if(void 0!==e){var t={morning:"7:00am",breakfast:"7:00am",noon:"12:00am",lunch:"12:00pm",afternoon:"2:00pm",evening:"6:00pm",dinner:"6:00pm",night:"11:00pm",midnight:"23:59pm"},n=this.clone();return e=(e=e||"").toLowerCase(),!0===t.hasOwnProperty(e)&&(n=n.time(t[e])),n}var i=this.hour();return i<6?"night":i<12?"morning":i<17?"afternoon":i<22?"evening":"night"},iso:function(e){return void 0!==e?this.set(e):this.format("iso")}},{date:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){if((t=Zn(t))>28){var n=gn[e.month()];t>n&&(t=n)}return t<=0&&(t=1),dn(e,{date:t}),e.epoch}(t,e),t}return this.d.getDate()},day:function(e){if(void 0===e)return this.d.getDay();var t=this.clone(),n=e;"string"==typeof e&&(e=e.toLowerCase(),-1===(n=Vn().indexOf(e))&&(n=Wn().indexOf(e)));var i=this.d.getDay(),o=this.subtract(24*(i-n),"hours");return dn(o,{hour:t.hour(),minute:t.minute(),second:t.second()}),o},dayName:function(e){return void 0===e?Wn()[this.day()]:this.clone().day(e)},month:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){"string"==typeof t&&(t=hn()[t.toLowerCase()]),(t=Zn(t))>=12&&(t=11),t<=0&&(t=0);var n=e.date();return n>gn[t]&&(n=gn[t]),dn(e,{month:t,date:n}),e.epoch}(t,e),t}return this.d.getMonth()}},{dayOfYear:function(e){if(void 0!==e){var t=this.clone();return t.epoch=function(e,t){t=Zn(t);var n=e.clone();return(t-=1)<=0?t=0:t>=365&&(t=364),e=(e=e.startOf("year")).add(t,"day"),ei(e,n,"hour"),e.epoch}(t,e),t}for(var n,i=0,o=this.d.getMonth(),a=1;a<=o;a++)(n=new Date).setDate(1),n.setFullYear(this.d.getFullYear()),n.setHours(1),n.setMinutes(1),n.setMonth(a),n.setHours(-2),i+=n.getDate();return i+this.d.getDate()},week:function(e){if(void 0!==e){var t=this.clone();return t=(t=(t=t.month(0)).date(1)).day("monday"),"december"===(t=oi(t)).monthName()&&(t=t.add(1,"week")),t.add(e-=1,"weeks")}var n=this.clone();n=(n=n.month(0)).date(1),"december"===(n=(n=oi(n)).day("monday")).monthName()&&(n=n.add(1,"week"));var i=1;1===n.date()&&(i=0),n=n.minus(1,"second");var o=this.epoch;if(n.epoch>o)return 1;var a=0,r=4*this.month();for(n.epoch+=cn.week*r,a+=r;a<52;a++){if(n.epoch>o)return a+i;n=n.add(1,"week")}return 52},monthName:function(e){return void 0===e?mn[this.month()]:this.clone().month(e)},quarter:function(e){if(void 0!==e&&("string"==typeof e&&(e=e.replace(/^q/i,""),e=parseInt(e,10)),Gn[e])){var t=this.clone();return(t=(t=t.month(Gn[e][0])).date(1)).startOf("day")}for(var n=this.d.getMonth(),i=1;i<Gn.length;i++)if(n<Gn[i][0])return i-1;return 4},season:function(e){var t="north";if("South"===this.hemisphere()&&(t="south"),void 0!==e){for(var n=this.clone(),i=0;i<Bn[t].length;i++)e===Bn[t][i][0]&&(n=(n=(n=n.month(Bn[t][i][1])).date(1)).startOf("day"));return n}for(var o=this.d.getMonth(),a=0;a<Bn[t].length-1;a++)if(o>=Bn[t][a][1]&&o<Bn[t][a+1][1])return Bn[t][a][0];return"winter"},year:function(e){if(void 0!==e){var t=this.clone();return t.epoch=ii(t,e),t}return this.d.getFullYear()},era:function(e){if(void 0!==e){var t=this.clone();e=e.toLowerCase();var n=t.d.getFullYear();return"bc"===e&&n>0&&(t.epoch=ii(t,-1*n)),"ad"===e&&n<0&&(t.epoch=ii(t,-1*n)),t}return this.d.getFullYear()<0?"BC":"AD"},decade:function(e){if(void 0!==e){if(!(e=(e=(e=String(e)).replace(/([0-9])'?s$/,"$1")).replace(/([0-9])(th|rd|st|nd)/,"$1")))return console.warn("Spacetime: Invalid decade input"),this;2===e.length&&/[0-9][0-9]/.test(e)&&(e="19"+e);var t=Number(e);return isNaN(t)?this:(t=10*Math.floor(t/10),this.year(t))}return this.startOf("decade").year()},century:function(e){if(void 0!==e){"string"==typeof e&&(e=(e=(e=e.replace(/([0-9])(th|rd|st|nd)/,"$1")).replace(/([0-9]+) ?(b\.?c\.?|a\.?d\.?)/i,(function(e,t,n){return n.match(/b\.?c\.?/i)&&(t="-"+t),t}))).replace(/c$/,""));var t=Number(e);return isNaN(e)?(console.warn("Spacetime: Invalid century input"),this):(0===t&&(t=1),this.year(t=t>=0?100*(t-1):100*(t+1)))}var n=this.startOf("century").year();return(n=Math.floor(n/100))<0?n-1:n+1},millenium:function(e){if(void 0!==e){if("string"==typeof e&&(e=e.replace(/([0-9])(th|rd|st|nd)/,"$1"),e=Number(e),isNaN(e)))return console.warn("Spacetime: Invalid millenium input"),this;e>0&&(e-=1);var t=1e3*e;return 0===t&&(t=1),this.year(t)}var n=Math.floor(this.year()/1e3);return n>=0&&(n+=1),n}});ai.milliseconds=ai.millisecond,ai.seconds=ai.second,ai.minutes=ai.minute,ai.hours=ai.hour,ai.hour24=ai.hour,ai.h12=ai.hour12,ai.h24=ai.hour24,ai.days=ai.day;var ri=["millisecond","second","minute","hour","date","month"],ci={second:ri.slice(0,1),minute:ri.slice(0,2),quarterhour:ri.slice(0,2),hour:ri.slice(0,3),date:ri.slice(0,4),month:ri.slice(0,4),quarter:ri.slice(0,4),season:ri.slice(0,4),year:ri,decade:ri,century:ri};ci.week=ci.hour,ci.season=ci.date,ci.quarter=ci.date;var si={year:!0,quarter:!0,season:!0,month:!0,week:!0,day:!0},li={month:!0,quarter:!0,season:!0,year:!0},di={millisecond:function(e){return e.epoch},second:function(e){return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second()].join("-")},minute:function(e){return[e.year(),e.month(),e.date(),e.hour(),e.minute()].join("-")},hour:function(e){return[e.year(),e.month(),e.date(),e.hour()].join("-")},day:function(e){return[e.year(),e.month(),e.date()].join("-")},week:function(e){return[e.year(),e.week()].join("-")},month:function(e){return[e.year(),e.month()].join("-")},quarter:function(e){return[e.year(),e.quarter()].join("-")},year:function(e){return e.year()}};di.date=di.day;var ui,mi=Ht,fi=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.epoch=null,this.tz=an(t,mi),this.silent=n.silent||!0,this.british=n.dmy||n.british,this._weekStart=1,void 0!==n.weekStart&&(this._weekStart=n.weekStart),Object.defineProperty(this,"d",{get:function(){var e=qt(this),t=(new Date(this.epoch).getTimezoneOffset()||0)+60*e;return t=60*t*1e3,new Date(this.epoch+t)}}),Object.defineProperty(this,"timezones",{get:function(){return mi},set:function(e){return mi=e,e}}),void 0!==e||null===e){var i=Pn(this,e,t);this.epoch=i.epoch}};Object.keys(Kn).forEach((function(e){fi.prototype[e]=Kn[e]})),fi.prototype.clone=function(){return new fi(this.epoch,this.tz,{silent:this.silent,weekStart:this._weekStart})},fi.prototype.toLocalDate=function(){return new Date(this.epoch)},ui=fi,Object.keys(ai).forEach((function(e){ui.prototype[e]=ai[e]})),function(e){e.prototype.add=function(e,t){var n=this.clone();if(!t||0===e)return n;var i=this.clone();t=Tt.normalize(t),cn[t]?n.epoch+=cn[t]*e:"week"===t?n.epoch+=cn.day*(7*e):"quarter"===t||"season"===t?n.epoch+=cn.month*(4*e):"season"===t?n.epoch+=cn.month*(4*e):"quarterhour"===t&&(n.epoch+=15*cn.minute*e);var o={};if(ci[t]&&ci[t].forEach((function(e){o[e]=i[e]()})),si[t]){var a=i.timezone().current.offset-n.timezone().current.offset;n.epoch+=3600*a*1e3}if("month"===t&&(o.month=i.month()+e,o=function(e,t){if(e.month>0){var n=parseInt(e.month/12,10);e.year=t.year()+n,e.month=e.month%12}else if(e.month<0){var i=Math.floor(Math.abs(e.month)/13,10);i=Math.abs(i)+1,e.year=t.year()-i,e.month=e.month%12,e.month=e.month+12,12===e.month&&(e.month=0)}return e}(o,i)),"week"===t){var r=i.date()+7*e;r<=28&&r>1&&(o.date=r)}else if("date"===t){var c=i.date()+e;c<=28&&c>1?o.date=c:0!==e&&i.isSame(n,"day")&&(o.date=i.date()+e)}else"year"===t&&n.year()===i.year()?n.epoch+=cn.week:"decade"===t?o.year=n.year()+10:"century"===t&&(o.year=n.year()+100);if(li[t]){var s=gn[o.month];o.date=i.date(),o.date>s&&(o.date=s)}return dn(n,o),n},e.prototype.subtract=function(e,t){return this.clone().add(-1*e,t)},e.prototype.minus=e.prototype.subtract,e.prototype.plus=e.prototype.add}(fi),function(e){e.prototype.isSame=function(t,n){return n?("string"!=typeof t&&"number"!=typeof t||(t=new e(t,this.timezone.name)),n=n.replace(/s$/,""),di[n]?di[n](this)===di[n](t):null):null}}(fi),function(e){var t={isAfter:function(e){e=Tt.beADate(e,this);var t=Tt.getEpoch(e);return null===t?null:this.epoch>t},isBefore:function(e){e=Tt.beADate(e,this);var t=Tt.getEpoch(e);return null===t?null:this.epoch<t},isEqual:function(e){e=Tt.beADate(e,this);var t=Tt.getEpoch(e);return null===t?null:this.epoch===t},isBetween:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=Tt.beADate(e,this),t=Tt.beADate(t,this);var i=Tt.getEpoch(e);if(null===i)return null;var o=Tt.getEpoch(t);return null===o?null:n?this.isBetween(e,t)||this.isEqual(e)||this.isEqual(t):i<this.epoch&&this.epoch<o}};Object.keys(t).forEach((function(n){e.prototype[n]=t[n]}))}(fi),function(e){var t={i18n:function(e){var t;Tt.isObject(e.days)&&(Mn=(t=e.days).short||Mn,xn=t.long||xn),Tt.isObject(e.months)&&function(e){un=e.short||un,mn=e.long||mn}(e.months)}};Object.keys(t).forEach((function(n){e.prototype[n]=t[n]}))}(fi);var hi=fi,bi=function(e,t,n){return new hi(e,t,n)};bi.now=function(e,t){return new hi((new Date).getTime(),e,t)},bi.today=function(e,t){return new hi((new Date).getTime(),e,t).startOf("day")},bi.tomorrow=function(e,t){return new hi((new Date).getTime(),e,t).add(1,"day").startOf("day")},bi.yesterday=function(e,t){return new hi((new Date).getTime(),e,t).subtract(1,"day").startOf("day")},bi.extend=function(e){return Object.keys(e).forEach((function(t){hi.prototype[t]=e[t]})),this},bi.whereIts=function(e,t){var n=new hi(null),i=new hi(null);n=n.time(e),i=t?i.time(t):n.add(59,"minutes");var o=n.hour(),a=i.hour();return Object.keys(n.timezones).filter((function(e){if(-1===e.indexOf("/"))return!1;var t=new hi(null,e),r=t.hour();return r>=o&&r<=a&&!(r===o&&t.minute()<n.minute())&&!(r===a&&t.minute()>i.minute())}))},bi.version="6.4.3",bi.plugin=bi.extend;var gi,pi=bi,vi=n("d3UM"),_i=n("FKr1");function yi(e,t){if(1&e&&(l.Wb(0,"div",8),l.Rb(1,"a-catering-order-item",9),l.Vb()),2&e){const e=t.$implicit,n=l.pc(2);l.Cb(1),l.vc("disabled",n.disabled)("symbol",n.symbol)("item",e)("field",n.items)}}function Ci(e,t){if(1&e&&(l.Ub(0),l.Lc(1,yi,2,4,"div",7),l.Tb()),2&e){const e=l.pc();l.Cb(1),l.vc("ngForOf",e.category.items)}}gi=$localize`:Catering category empty label␟413312f415b4e0acfd6be72da7d811ea1e3a60de␟8482974523885197860:Category contains no available items`;const wi=function(){return{class:"material-icons",content:"close"}};function Oi(e,t){1&e&&(l.Wb(0,"div",10),l.Wb(1,"div",11),l.Rb(2,"app-icon",3),l.Vb(),l.Wb(3,"div",12),l.ac(4,gi),l.Vb(),l.Vb()),2&e&&(l.Cb(2),l.vc("icon",l.wc(1,wi)))}const ki=function(){return{class:"material-icons",content:"arrow_back"}};let Pi=(()=>{class e{constructor(){this.close=new l.n}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=l.Kb({type:e,selectors:[["a-category-display"]],inputs:{category:"category",items:"items",symbol:"symbol",disabled:"disabled"},outputs:{close:"close"},decls:9,vars:5,consts:[[1,"header"],[1,"content"],["mat-icon-button","",3,"tapped"],[3,"icon"],[1,"name"],[4,"ngIf","ngIfElse"],["empty_state",""],["class","item",4,"ngFor","ngForOf"],[1,"item"],[3,"disabled","symbol","item","field"],[1,"info-block","center"],[1,"icon"],[1,"text"]],template:function(e,t){if(1&e&&(l.Wb(0,"div",0),l.Wb(1,"div",1),l.Wb(2,"button",2),l.lc("tapped",(function(){return t.close.emit()})),l.Rb(3,"app-icon",3),l.Vb(),l.Wb(4,"div",4),l.Nc(5),l.Vb(),l.Vb(),l.Vb(),l.Lc(6,Ci,2,1,"ng-container",5),l.Lc(7,Oi,5,2,"ng-template",null,6,l.Mc)),2&e){const e=l.Ac(8);l.Cb(3),l.vc("icon",l.wc(4,ki)),l.Cb(2),l.Oc(null==t.category?null:t.category.name),l.Cb(1),l.vc("ngIf",t.category.items&&t.category.items.length)("ngIfElse",e)}},directives:[P.b,x.c,M.a,i.t,i.s,Dt],styles:[".header[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;width:100%;background-color:#fff;border-bottom:1px solid #ccc;padding:.5em;z-index:1}.header[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;align-items:center;width:640px;max-width:100vw;margin:auto}.header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{flex:1;text-align:center;margin-right:3em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.item[_ngcontent-%COMP%]{position:relative;width:640px;margin:.5em auto;background-color:#fff;border:1px solid #ccc;border-radius:4px;overflow:hidden;max-width:calc(100vw - 1em);z-index:0}"]}),e})();var Mi,xi,Vi,Wi,zi,Ii;function Di(e,t){if(1&e&&(l.Wb(0,"mat-option",17),l.Nc(1),l.Vb()),2&e){const e=t.$implicit;l.vc("value",e),l.Cb(1),l.Pc(" ",e.name," ")}}function Si(e,t){if(1&e&&(l.Wb(0,"mat-option",17),l.Nc(1),l.Vb()),2&e){const e=t.$implicit;l.vc("value",e.id),l.Cb(1),l.Pc(" ",e.name," ")}}function Ai(e,t){if(1&e&&(l.Wb(0,"div",9),l.Wb(1,"form",10),l.Wb(2,"div",11),l.Wb(3,"label"),l.ac(4,Vi),l.Vb(),l.Wb(5,"mat-form-field",12),l.Wb(6,"mat-select",13),l.Lc(7,Di,2,2,"mat-option",14),l.Vb(),l.Vb(),l.Vb(),l.Wb(8,"div",11),l.Wb(9,"label",15),l.ac(10,Wi),l.Vb(),l.Wb(11,"mat-form-field",12),l.Wb(12,"mat-select",16),l.Lc(13,Si,2,2,"mat-option",14),l.Vb(),l.Vb(),l.Vb(),l.Vb(),l.Vb()),2&e){const e=l.pc();l.Cb(1),l.vc("formGroup",e.form),l.Cb(6),l.vc("ngForOf",e.space_list),l.Cb(6),l.vc("ngForOf",e.available_times)}}function $i(e,t){if(1&e){const e=l.Xb();l.Wb(0,"button",23),l.lc("tapped",(function(){l.Dc(e);const n=t.$implicit;return l.pc(4).active_category=n})),l.Rb(1,"div",24),l.Wb(2,"div",25),l.Nc(3),l.Vb(),l.Vb()}if(2&e){const e=t.$implicit,n=l.pc(4);l.Kc("background-image","url("+e.image_path+")",l.Jb),l.vc("disabled",n.within_restricted_time&&!e.can_order_anytime),l.Cb(3),l.Oc(e.name)}}function Li(e,t){if(1&e&&(l.Wb(0,"div",21),l.Lc(1,$i,4,4,"button",22),l.Vb()),2&e){const e=l.pc(3);l.Cb(1),l.vc("ngForOf",e.category_list)}}function Ni(e,t){if(1&e&&(l.Ub(0),l.Lc(1,Li,2,1,"div",20),l.Tb()),2&e){const e=l.pc(2),t=l.Ac(9);l.Cb(1),l.vc("ngIf",e.can_order&&e.category_list.length)("ngIfElse",t)}}function ji(e,t){if(1&e&&(l.Wb(0,"div",18),l.Lc(1,Ni,2,2,"ng-container",19),l.Vb()),2&e){const e=l.pc(),t=l.Ac(13);l.Cb(1),l.vc("ngIf",!e.active_category)("ngIfElse",t)}}function Ti(e,t){if(1&e&&(l.gc(0,zi,1),l.Rb(1,"span",29),l.dc()),2&e){const e=l.pc(2);l.Cb(1),l.ec((null==e.active_building?null:e.active_building.catering_restricted_from)||"0"),l.bc(0)}}function Fi(e,t){if(1&e&&(l.Wb(0,"div",26),l.Wb(1,"div",27),l.Rb(2,"img",28),l.Vb(),l.Wb(3,"p"),l.gc(4,zi),l.Rb(5,"span",29),l.Rb(6,"br"),l.Lc(7,Ti,2,1,"span",30),l.dc(),l.Vb(),l.Vb()),2&e){const e=l.pc();l.Cb(7),l.vc("ngIf",null==e.active_building?null:e.active_building.catering_restricted_from),l.ec(null==e.active_building?null:e.active_building.name),l.bc(4)}}function Ei(e,t){if(1&e&&(l.Wb(0,"div",18),l.Wb(1,"div",31),l.Wb(2,"div",27),l.Rb(3,"mat-spinner",32),l.Vb(),l.Wb(4,"div",33),l.ac(5,Ii),l.Vb(),l.Vb(),l.Vb()),2&e){const e=l.pc();l.Cb(5),l.ec(null==e.active_building?null:e.active_building.name),l.bc(5)}}function qi(e,t){if(1&e){const e=l.Xb();l.Wb(0,"a-category-display",34),l.lc("close",(function(){return l.Dc(e),l.pc().active_category=null})),l.Vb()}if(2&e){const e=l.pc();l.vc("category",e.active_category)("symbol",e.symbol)("items",e.form.controls.items)("disabled",e.within_restricted_time)}}Mi=$localize`:Catering order cancel action␟cda31dbd724cf5f4fa7a4274d9120651490c8a8c␟8890553633144307762:Back`,xi=$localize`:Catering order confirm action␟65b17a3b00a67be5d8022c4c834ee46cfbf7e8c1␟4100878296986971969: Confirm Order(${"\ufffd0\ufffd"}:INTERPOLATION:) `,Vi=$localize`:Catering order location label␟c2931e3c6024d3f3125d9eae5ea680549dfef481␟5372192538848052965:Deliver to:`,Wi=$localize`:Catering order delivery time label␟ef36f0dc0067decf548cc11905ef3100f5bbd004␟7479716926471212179:At:`,zi=$localize`:Catering order unavailable␟448721d1af607594c77bfa7c99edf1405aaac332␟6239341027793385302: Catering is ${"\ufffd#5\ufffd"}:START_TAG_SPAN:not available${"[\ufffd/#5\ufffd|\ufffd/#1:1\ufffd\ufffd/*7:1\ufffd]"}:CLOSE_TAG_SPAN: for this booking.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Catering must be ordered within business hours ${"\ufffd*7:1\ufffd\ufffd#1:1\ufffd"}:START_TAG_SPAN_1: at least ${"\ufffd0:1\ufffd"}:INTERPOLATION: hours in advance for meetings ${"[\ufffd/#5\ufffd|\ufffd/#1:1\ufffd\ufffd/*7:1\ufffd]"}:CLOSE_TAG_SPAN: at ${"\ufffd0\ufffd"}:INTERPOLATION_1:. `,zi=l.fc(zi),Ii=$localize`:Catering order loading label␟bfda21d2176fb36e23aa0481fe88e423db437c00␟3030815663356248509:Loading menu for ${"\ufffd0\ufffd"}:INTERPOLATION:...`;let Ri=(()=>{class e extends s.a{constructor(e,t){super(),this._service=e,this._dialog=t,this.event=new l.n,this.category_list=[],this.available_times=[]}get can_order(){if(!this.form||!this.form.controls.space)return!1;const e=this.form.controls.space.value;return(this._service.Organisation.buildings.find(t=>t.id===e.level.building_id).has_catering||this.category_list.length)&&(!this.within_restricted_time||this.has_available_items)}get active_building(){if(!this.form||!this.form.controls.space)return null;const e=this.form.controls.space.value;return e?this._service.Organisation.buildings.find(t=>e.level.building_id===t.id):null}get symbol(){const e=this.active_building;return e&&e.currency||"USD"}get item_count(){return this.form?(this.form.controls.items.value||[]).reduce((e,t)=>e+t.amount,0):0}get out_of_hours(){return!!this.form&&this.form.controls.start.value<0}get within_restricted_time(){if(!this.form||!this.form.controls.space)return!1;const e=this.form.controls.space.value,t=this._service.Organisation.buildings.find(t=>t.id===e.level.building_id);if(!t.catering_restricted_from||t.catering_restricted_from<=0)return!1;const n=O(),i=O(this.date).subtract(t.catering_restricted_from,"h");return n.isAfter(i,"s")}get has_available_items(){return this.category_list.reduce((e,t)=>e||t.can_order_anytime,!1)}ngOnInit(){this.generateAvailableTimes(),this.loadMenu()}ngOnChanges(e){(e.date||e.duration)&&(this.generateAvailableTimes(),this.form&&!this.available_times.find(e=>e.id===this.form.controls.start.value)&&this.form.controls.start.setValue(this.available_times[0].id)),e.space_list&&this.form&&this.space_list&&!this.form.controls.space.value&&this.form.controls.space.setValue(this.space_list[0]),e.order&&this.order&&this.initForm()}initForm(){this.form=new a.i({id:new a.f(this.order.id),booking_date:new a.f(this.all_day?O(this.date).startOf("d").valueOf():this.date),space:new a.f(this._service.Spaces.item(this.order.location_id)||this.space_list[0]),location_id:new a.f(this.order.location_id||this.space_list[0].id),start:new a.f(this.order.delivery_time||this.available_times[0].id),items:new a.f((this.order.items||[]).map(e=>new tt.a(e)))}),this.timeout("init_items",()=>this.form.controls.items.setValue((this.order.items||[]).map(e=>new tt.a(e))),50),this.subscription("space_change",this.form.controls.space.valueChanges.subscribe(e=>{this.form.controls.location_id.setValue(e.id),this.generateAvailableTimes(),this.available_times.find(e=>e.id===this.form.controls.start.value)||this.form.controls.start.setValue(this.available_times[0].id),this.loadMenu()})),this.generateAvailableTimes(),this.form&&!this.available_times.find(e=>e.id===this.form.controls.start.value)&&this.form.controls.start.setValue(this.available_times[0].id)}confirmOrder(){const e=this._dialog.open(Nt,{maxWidth:"95vw",data:{date:this.date,form:this.form}});this.subscription("confirm_event",e.componentInstance.event.subscribe(t=>{if("done"===t.reason){const t=new w.a(this.form.value);this.event.emit(t),e.close()}})),e.afterClosed().subscribe(()=>this.unsub("confirm_event"))}loadMenu(){const e=this.form?this.form.controls.space.value:null;e&&(this.form.controls.items.setValue([]),this.loading=!0,this._service.Menu.query({room_id:e.id}).then(e=>{this.loading=!1,this.category_list=(e||[]).map(e=>new et.a(e))},()=>this.loading=!1))}generateAvailableTimes(){const e=this.all_day?O(this.date).startOf("d"):O(this.date);let{start:t,end:n}=this.generateStartAndEndTimes();for(t=t.minute(5*Math.ceil(t.minute()/5)),this.available_times=[];t.isBefore(n);)this.available_times.push({id:Math.abs(e.diff(t,"m")),name:t.format("h:mm A")}),t=t.add(5,"m");0===this.available_times.length&&this.available_times.push({id:-1,name:"Out of hours"})}generateStartAndEndTimes(){let e=O(this.date);this.all_day&&(e=e.startOf("d"));let t=this.all_day?e.endOf("d"):e.add(this.duration,"m"),n=pi(e.toDate());n=n.hour(7);const i=O(n.toLocalDate());if(console.log("Timezone start:",i.format("DD MMM, h:mm A")),e.isBefore(i,"m"))e=i,t=e.add(13,"h");else{const e=i.hour(20);console.log("Timezone end:",e.format("DD MMM, h:mm A")),t.isAfter(e)&&(t=e)}return{start:e,end:t}}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(c.a),l.Qb(C.b))},e.\u0275cmp=l.Kb({type:e,selectors:[["a-catering-order-details"]],inputs:{order:"order",date:"date",duration:"duration",space_list:"space_list",all_day:"all_day"},outputs:{event:"event"},features:[l.zb,l.Ab],decls:14,vars:5,consts:[[1,"catering","order-details"],["class","header",4,"ngIf"],["class","body",4,"ngIf","ngIfElse"],[1,"footer"],["mat-button","",1,"inverse",3,"tapped"],["mat-button","",3,"disabled","tapped"],["empty_state",""],["load_state",""],["category_display",""],[1,"header"],[3,"formGroup"],[1,"field"],["appearance","outline"],["formControlName","space"],[3,"value",4,"ngFor","ngForOf"],["for","start"],["name","start","formControlName","start"],[3,"value"],[1,"body"],[4,"ngIf","ngIfElse"],["class","contents",4,"ngIf","ngIfElse"],[1,"contents"],["mat-button","","class","category",3,"background-image","disabled","tapped",4,"ngFor","ngForOf"],["mat-button","",1,"category",3,"disabled","tapped"],[1,"overlay"],[1,"name"],[1,"empty-state","center"],[1,"icon"],["alt","No Catering Available","src","assets/img/no-catering.svg"],[1,"bold"],["class","bold",4,"ngIf"],[1,"info-block","center"],["diameter","48"],[1,"text"],[3,"category","symbol","items","disabled","close"]],template:function(e,t){if(1&e&&(l.Wb(0,"div",0),l.Lc(1,Ai,14,3,"div",1),l.Lc(2,ji,2,2,"div",2),l.Wb(3,"div",3),l.Wb(4,"button",4),l.lc("tapped",(function(){return t.event.emit()})),l.ac(5,Mi),l.Vb(),l.Wb(6,"button",5),l.lc("tapped",(function(){return t.confirmOrder()})),l.ac(7,xi),l.Vb(),l.Vb(),l.Vb(),l.Lc(8,Fi,8,2,"ng-template",null,6,l.Mc),l.Lc(10,Ei,6,1,"ng-template",null,7,l.Mc),l.Lc(12,qi,1,4,"ng-template",null,8,l.Mc)),2&e){const e=l.Ac(11);l.Cb(1),l.vc("ngIf",t.form),l.Cb(1),l.vc("ngIf",!t.loading)("ngIfElse",e),l.Cb(4),l.vc("disabled",!t.item_count||t.out_of_hours),l.Cb(1),l.ec(t.item_count||"0"),l.bc(7)}},directives:[i.t,P.b,x.c,a.H,a.s,a.j,V.b,vi.a,a.r,a.h,i.s,_i.g,xe.c,Pi],styles:["[_nghost-%COMP%]{height:100%}.order-details[_ngcontent-%COMP%]{height:100%;margin:auto;max-width:100vw}.header[_ngcontent-%COMP%], .order-details[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;width:100%}.header[_ngcontent-%COMP%]{justify-content:center;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);z-index:99}.body[_ngcontent-%COMP%]{position:relative;flex:1;width:100%;min-height:50%;overflow:hidden auto}.footer[_ngcontent-%COMP%]{width:100%;text-align:center;border-top:1px solid #ccc;background-color:#fff;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:.5em}form[_ngcontent-%COMP%]{display:flex;align-items:center}.field[_ngcontent-%COMP%]{margin:0 .5em;max-height:3.5em}@media only screen and (orientation:portrait) and (max-width:450px){.field[_ngcontent-%COMP%]{max-height:4.75em}}@media only screen and (orientation:landscape) and (max-width:800px){.field[_ngcontent-%COMP%]{max-height:4.75em}}.contents[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;max-width:768px;margin:auto}.category[_ngcontent-%COMP%]{position:relative;background-position:50%;background-size:cover;height:11em;width:11em;margin:1em;border-radius:4px;border:none;padding:0;background-color:#fff;transition:box-shadow .2s}.category[_ngcontent-%COMP%]:hover{box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.category[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.35);border-radius:4px}.category[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:99;max-width:9em;white-space:normal;line-height:1.25em;margin:0}@media only screen and (orientation:portrait) and (max-width:450px){mat-form-field[_ngcontent-%COMP%]{width:11.75em}}@media only screen and (orientation:landscape) and (max-width:800px){mat-form-field[_ngcontent-%COMP%]{width:11.75em}}label[_ngcontent-%COMP%]{font-weight:500;font-size:.8em;margin-right:.75em}.empty-state[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;background-color:#fff;border-radius:4px;padding:1em;max-width:calc(100vw - 2em);box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}.empty-state[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ce1a51}.empty-state[_ngcontent-%COMP%]   .bold[_ngcontent-%COMP%]{font-weight:400}.empty-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:6em;width:8em}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;max-width:24em}.info-block[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:2.5em;width:2.5em}"]}),e})();function Bi(e,t){if(1&e){const e=l.Xb();l.Ub(0),l.Wb(1,"a-catering-order-list",3),l.lc("order",(function(t){l.Dc(e);const n=l.pc();return t?n.active_order=t:n.newOrder()}))("event",(function(t){return l.Dc(e),l.pc().event.emit(t)})),l.Vb(),l.Tb()}if(2&e){const e=l.pc();l.Cb(1),l.vc("catering",e.catering_field)("date",e.date)("all_day",e.all_day)}}function Gi(e,t){if(1&e){const e=l.Xb();l.Wb(0,"a-catering-order-details",4),l.lc("event",(function(t){l.Dc(e);const n=l.pc();return t?n.handleOrderEvent(t):n.active_order=null})),l.Vb()}if(2&e){const e=l.pc();l.vc("space_list",e.space_list)("order",e.active_order)("date",e.date)("duration",e.duration)("all_day",e.all_day)}}let Qi=(()=>{class e{constructor(){this.event=new l.n}get catering_field(){return this.form?this.form.controls.catering:null}get space_list(){return this.form?this.form.controls.space_list.value:[]}get date(){return this.form?this.form.controls.date.value:O().startOf("m").valueOf()}get duration(){return this.form?this.form.controls.duration.value:60}get all_day(){return!!this.form&&this.form.controls.all_day.value}newOrder(){const e=new w.a({});this.active_order=e}handleOrderEvent(e){if(e){const t=this.form.controls.catering.value||[],n=t.findIndex(t=>e.id===t.id);n<0?t.push(e):t.splice(n,1,e),this.form.controls.catering.setValue(t)}this.active_order=null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=l.Kb({type:e,selectors:[["booking-catering"]],inputs:{form:"form"},outputs:{event:"event"},decls:4,vars:2,consts:[[1,"catering"],[4,"ngIf","ngIfElse"],["order_display",""],[3,"catering","date","all_day","order","event"],[3,"space_list","order","date","duration","all_day","event"]],template:function(e,t){if(1&e&&(l.Wb(0,"div",0),l.Lc(1,Bi,2,3,"ng-container",1),l.Vb(),l.Lc(2,Gi,1,5,"ng-template",null,2,l.Mc)),2&e){const e=l.Ac(3);l.Cb(1),l.vc("ngIf",!t.active_order)("ngIfElse",e)}},directives:[i.t,Ke,Ri],styles:[".catering[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%;width:100%}"]}),e})();var Ui=n("4Man");const Yi=["container"];var Xi,Hi,Ki;Xi=$localize`:Booking form header␟bd532c9813cc0577fcc3ff32640a61afef2bf40a␟6464057252608386690:New Booking`,Hi=$localize`:Booking form cancel action␟cda31dbd724cf5f4fa7a4274d9120651490c8a8c␟8890553633144307762:Back`,Ki=$localize`:Booking form continue action␟f732c304c7433e5a83ffcd862c3dce709a0f4982␟3885497195825665706:Next`;const Zi=function(){return{class:"material-icons",content:"refresh"}};let Ji=(()=>{class e{constructor(){this.event=new l.n}next(){this.form.markAllAsTouched(),this.form.valid?this.event.emit({type:"next",step:"form"}):this.container&&this.container.nativeElement.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}previous(){this.event.emit({type:"previous",step:"form"})}resetForm(){this.event.emit({type:"reset",step:"form"})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=l.Kb({type:e,selectors:[["booking-spaces-form"]],viewQuery:function(e,t){var n;1&e&&l.Jc(Yi,!0),2&e&&l.zc(n=l.mc())&&(t.container=n.first)},inputs:{form:"form"},outputs:{event:"event"},decls:15,vars:4,consts:[[1,"booking-form"],["container",""],[1,"header"],["mat-icon-button","","name","reset",3,"tapped"],[3,"icon"],[3,"formGroup","ngSubmit"],[1,"body"],[3,"form"],[1,"footer"],["mat-button","","type","button",1,"inverse",3,"tapped"],["mat-button","","type","submit"]],template:function(e,t){1&e&&(l.Wb(0,"div",0,1),l.Wb(2,"div",2),l.Wb(3,"h3"),l.ac(4,Xi),l.Vb(),l.Wb(5,"button",3),l.lc("tapped",(function(){return t.resetForm()})),l.Rb(6,"app-icon",4),l.Vb(),l.Vb(),l.Wb(7,"form",5),l.lc("ngSubmit",(function(){return t.next()})),l.Wb(8,"div",6),l.Rb(9,"a-booking-form",7),l.Vb(),l.Wb(10,"div",8),l.Wb(11,"button",9),l.lc("tapped",(function(){return t.previous()})),l.ac(12,Hi),l.Vb(),l.Wb(13,"button",10),l.ac(14,Ki),l.Vb(),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Cb(6),l.vc("icon",l.wc(3,Zi)),l.Cb(1),l.vc("formGroup",t.form),l.Cb(2),l.vc("form",t.form))},directives:[P.b,x.c,M.a,a.H,a.s,a.j,Ui.a],styles:[".booking-form[_ngcontent-%COMP%]{width:768px;max-width:95vw;min-height:100%;background-color:#fff;margin:auto;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12)}form[_ngcontent-%COMP%]{padding:1em}.header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5em 1em;border-bottom:1px solid #f0f0f0}h3[_ngcontent-%COMP%]{min-width:50%;flex:1;margin:0}.footer[_ngcontent-%COMP%]{margin-top:1em;text-align:center}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em;margin:0 .5em}"]}),e})();function eo(e,t){if(1&e){const e=l.Xb();l.Wb(0,"booking-find-space",5),l.lc("event",(function(t){return l.Dc(e),l.pc(2).handleFlowEvent(t)})),l.Vb()}if(2&e){const e=l.pc(2);l.vc("spaces",e.form.controls.space_list)("form",e.form)}}function to(e,t){if(1&e&&(l.Ub(0),l.Lc(1,eo,1,2,"booking-find-space",4),l.Tb()),2&e){const e=l.pc();l.Cb(1),l.vc("ngIf",e.form)}}function no(e,t){if(1&e){const e=l.Xb();l.Wb(0,"booking-catering",7),l.lc("event",(function(t){return l.Dc(e),l.pc(2).handleFlowEvent(t)})),l.Vb()}if(2&e){const e=l.pc(2);l.vc("form",e.form)}}function io(e,t){if(1&e&&(l.Ub(0),l.Lc(1,no,1,1,"booking-catering",6),l.Tb()),2&e){const e=l.pc();l.Cb(1),l.vc("ngIf",e.form)}}function oo(e,t){if(1&e){const e=l.Xb();l.Wb(0,"booking-spaces-form",7),l.lc("event",(function(t){return l.Dc(e),l.pc(2).handleFlowEvent(t)})),l.Vb()}if(2&e){const e=l.pc(2);l.vc("form",e.form)}}function ao(e,t){if(1&e&&(l.Ub(0),l.Lc(1,oo,1,1,"booking-spaces-form",6),l.Tb()),2&e){const e=l.pc();l.Cb(1),l.vc("ngIf",e.form)}}let ro=(()=>{class e extends s.a{constructor(e,t,n,i){super(),this._service=e,this._route=t,this._router=n,this._dialog=i}get available_fields(){return this._service.setting("app.booking.show_fields")||[]}ngOnInit(){this._service.initialised.pipe(Object(_.a)(e=>e)).subscribe(()=>{this.settings=this._service.setting("app.booking"),this.subscription("route.params",this._route.paramMap.subscribe(e=>{e.has("step")&&(this.flow_step=e.get("step"))})),this._service.Spaces.initialised.pipe(Object(_.a)(e=>e)).subscribe(()=>{this.loadFormData()})})}handleFlowEvent(e){"next"===e.type?this.toNextFlowStep(e):"previous"===e.type?this.toPreviousFlowStep(e):"reset"===e.type&&this.resetForm()}toNextFlowStep(e){const t=this.form.controls.space_list.value;switch(e.step){case"search":!(t&&t.length&&this.settings.multiple_spaces)||e.metadata&&e.metadata.ref&&"equipment"===e.metadata.ref?this.form.controls.has_catering&&this.form.controls.has_catering.value?this.navigate("catering"):(this.navigate("form"),this.confirmBooking()):this.openEquipmentDetailsModal();break;case"catering":const n=this.form.controls.catering.value;!n||!n.length||e.metadata&&e.metadata.ref&&"details"===e.metadata.ref?(this.navigate("form"),this.confirmBooking()):this.openCateringDetailsModal();break;default:this.form.controls.needs_space&&(!this.form.controls.needs_space.value||t&&t.length)?this.confirmBooking():this.navigate("search")}}toPreviousFlowStep(e){switch(e.step){case"search":this.navigate("form");break;case"catering":this.navigate("search")}}navigate(e){this._router.navigate(["book","spaces",e],{queryParamsHandling:"preserve"}),this.flow_step=e}resetForm(){this.booking.clearPendingChanges(),delete this.form,this.form=Object(p.a)(this.booking,this._service.Users.current,this.available_fields)}loadFormData(){let e={};if(localStorage){const n=localStorage.getItem("ACA_STAFF.booking_form_data");if(n)try{e=JSON.parse(n)}catch(t){}}if(this.booking=new g.a(this._service.Bookings,e||{}),this.subscription("form_changes",this.booking.changeEvents.subscribe(()=>this.saveFormData())),this.form=Object(p.a)(this.booking,this._service.Users.current,this.available_fields),e&&!e.id)for(const n in e)this.form.controls[n]?this.form.controls[n].setValue(e[n]):this.booking.hasOwnProperty("")&&this.booking.storePendingChange(n,e[n]);e&&e.room_ids&&this.form.controls.space_list&&this.form.controls.space_list.setValue(e.room_ids.map(e=>this._service.Spaces.item(e)||{id:e,name:e}))}saveFormData(){localStorage&&this.booking&&localStorage.setItem("ACA_STAFF.booking_form_data",JSON.stringify(this.booking.toJSON(!0)))}openEquipmentDetailsModal(){const e=this._dialog.open(y.a,{maxWidth:"95vw",width:"32em",data:{spaces:this.form.controls.space_list.value,notes_field:this.form.controls.notes,codes_field:this.form.controls.equipment_codes,head_counts_field:this.form.controls.expected_attendees}});this.subscription("modal_events",e.componentInstance.event.subscribe(t=>{"done"===t.reason&&(this.toNextFlowStep({type:"next",step:"search",metadata:{ref:"equipment"}}),e.close())})),e.afterClosed().subscribe(()=>this.unsub("modal_events"))}openCateringDetailsModal(){const e=this._dialog.open(T,{maxWidth:"95vw",width:"32em",data:{spaces:this.form.controls.space_list.value,notes_field:this.form.controls.notes,catering:this.form.controls.catering}});this.subscription("modal_events",e.componentInstance.event.subscribe(t=>{"done"===t.reason&&(this.toNextFlowStep({type:"next",step:"catering",metadata:{ref:"details"}}),e.close())})),e.afterClosed().subscribe(()=>this.unsub("modal_events"))}confirmBooking(){this.booking.has_changes?this.form.valid&&this._dialog.open(v.a,{width:"32em",maxWidth:"95vw",maxHeight:"95vh",data:{booking:this.booking}}).componentInstance.event.subscribe(e=>{"success"===e.type&&this._router.navigate(["/schedule"])}):this._service.notifyInfo("No changes have been made to booking")}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(c.a),l.Qb(o.a),l.Qb(o.d),l.Qb(C.b))},e.\u0275cmp=l.Kb({type:e,selectors:[["booking-space-flow"]],features:[l.zb],decls:5,vars:3,consts:[[1,"space-flow"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"spaces","form","event",4,"ngIf"],[3,"spaces","form","event"],[3,"form","event",4,"ngIf"],[3,"form","event"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.Ub(1,1),l.Lc(2,to,2,1,"ng-container",2),l.Lc(3,io,2,1,"ng-container",2),l.Lc(4,ao,2,1,"ng-container",3),l.Tb(),l.Vb()),2&e&&(l.Cb(1),l.vc("ngSwitch",t.flow_step),l.Cb(1),l.vc("ngSwitchCase","search"),l.Cb(1),l.vc("ngSwitchCase","catering"))},directives:[i.x,i.y,i.z,i.t,$e,Qi,Ji],styles:[".space-flow[_ngcontent-%COMP%]{height:100%;overflow:auto}"]}),e})();var co,so,lo,uo,mo,fo,ho,bo=n("1gA9"),go=n("5fZw"),po=n("1DiH"),vo=n("oTgu");function _o(e,t){if(1&e){const e=l.Xb();l.Wb(0,"div",11),l.Wb(1,"i",12),l.lc("modelChange",(function(t){return l.Dc(e),l.pc().bookings=t}))("modelChange",(function(){return l.Dc(e),l.pc().processDeskBookings()})),l.Vb(),l.Vb()}if(2&e){const e=l.pc();l.Cb(1),l.vc("model",e.bookings)("sys",e.system_id)("bind",e.active_level+":bookings")}}function yo(e,t){if(1&e&&(l.Wb(0,"div"),l.Nc(1),l.Vb()),2&e){const e=l.pc(2);l.Eb("status "+(e.available||e.belongs_to_user?"available":"unavailable")),l.Cb(1),l.Pc(" ",e.available||e.belongs_to_user?"Available":"Not Available"," ")}}function Co(e,t){1&e&&(l.Wb(0,"div",20),l.ac(1,co),l.Vb())}function wo(e,t){if(1&e){const e=l.Xb();l.Wb(0,"div"),l.Wb(1,"button",21),l.lc("tapped",(function(){return l.Dc(e),l.pc(2).check_in()})),l.ac(2,so),l.Vb(),l.Wb(3,"div"),l.ac(4,lo),l.Vb(),l.Vb()}}function Oo(e,t){if(1&e){const e=l.Xb();l.Wb(0,"div"),l.Wb(1,"div"),l.Nc(2,"Now reserved for"),l.Vb(),l.Wb(3,"div",22),l.Nc(4),l.Vb(),l.Wb(5,"button",21),l.lc("tapped",(function(){return l.Dc(e),l.pc(2).check_out()})),l.ac(6,uo),l.Vb(),l.Wb(7,"div"),l.ac(8,mo),l.Vb(),l.Vb()}if(2&e){const e=l.pc(2);l.Cb(4),l.Oc(e.user.name)}}function ko(e,t){if(1&e){const e=l.Xb();l.Wb(0,"div",23),l.Wb(1,"div",24),l.Wb(2,"div",25),l.ac(3,fo),l.Vb(),l.Wb(4,"a-time-field",26),l.lc("ngModelChange",(function(t){return l.Dc(e),l.pc(2).date=t})),l.Vb(),l.Wb(5,"div",27),l.Wb(6,"button",28),l.lc("tapped",(function(){return l.Dc(e),l.pc(2).book()})),l.Nc(7," Confirm "),l.Vb(),l.Vb(),l.Vb(),l.Vb()}if(2&e){const e=l.pc(2);l.Cb(4),l.vc("ngModel",e.date)}}function Po(e,t){if(1&e&&(l.Wb(0,"div",13),l.Wb(1,"div",14),l.Wb(2,"div",15),l.Nc(3),l.Vb(),l.Lc(4,yo,2,3,"div",16),l.Lc(5,Co,2,0,"div",17),l.Lc(6,wo,5,0,"div",18),l.Lc(7,Oo,9,1,"div",18),l.Vb(),l.Lc(8,ko,8,1,"div",19),l.Vb()),2&e){const e=l.pc();l.Cb(3),l.Pc(" ",e.desk," "),l.Cb(1),l.vc("ngIf",!(e.belongs_to_user&&e.current_booking.checked_in)),l.Cb(1),l.vc("ngIf",!e.available&&!e.belongs_to_user),l.Cb(1),l.vc("ngIf",e.belongs_to_user&&!e.current_booking.checked_in),l.Cb(1),l.vc("ngIf",e.belongs_to_user&&e.current_booking.checked_in),l.Cb(1),l.vc("ngIf",e.available)}}function Mo(e,t){1&e&&(l.Wb(0,"div",13),l.Wb(1,"div",14),l.Wb(2,"div",15),l.ac(3,ho),l.Vb(),l.Vb(),l.Vb())}function xo(e,t){1&e&&l.Rb(0,"mat-spinner",3)}function Vo(e,t){if(1&e){const e=l.Xb();l.Wb(0,"a-map-controls",29),l.lc("levelChange",(function(t){return l.Dc(e),l.pc().active_level=t}))("levelChange",(function(){return l.Dc(e),l.pc().onLevelChange()})),l.Vb()}if(2&e){const e=l.pc();l.vc("level",e.active_level)}}co=$localize`:Select another desk␟5ca89aea2cadf208387d22a6722fa691328e4639␟8438296162356008540: Please select a different desk from the map `,so=$localize`:Desk check in␟8c41f97fbceb9b04d8ab986819decab585f02a32␟5207140864145722677: Check-In `,lo=$localize`:Desk check in description␟5898dd87be2a12fc0d908be4efce0227e3283dc0␟6699028280403914993: Checking in will reserve this desk under your name for the rest of the day. `,uo=$localize`:Desk checkout␟f72126dcb376d87a60b0bdc49340712b91452ac9␟5393506726404439645: Check-Out `,mo=$localize`:Desk checkout description␟ed326ff843f67937c1d04c582a52fa7bb67ff945␟7079828377705672895: Checking out makes the desk available for others `,fo=$localize`:Reserve desk description␟765c353930cb1b8fdd2493639c68e467b9c6d82d␟7556704774845594175: Reserve this desk for use from: `,ho=$localize`:Select desk description␟8262190b8373d8939609ad2b1f7b452777152de7␟121158745294466959: Choose a desk on the map. `;let Wo=(()=>{class e extends s.a{constructor(e,t,n){super(),this._service=e,this._route=t,this._router=n,this.style_map={},this.status_map={},this.colour_map={}}ngOnInit(){this._service.initialised.pipe(Object(_.a)(e=>e)).subscribe(()=>{this.colour_map=this._service.setting("app.explore.colors")||{},this.user=this._service.Users.current,this.date=O().valueOf(),this.subscription("route.queryparams",this._route.queryParamMap.subscribe(e=>{e.has("desk")&&(this.desk=e.get("desk")),e.has("level")?(this.active_level=e.get("level"),this.loadSystem(this.active_level)):(this.active_level=this.loadLevel(),this.loadSystem(this.active_level)),this.processDeskBookings()}))})}loadSystem(e){if(e){const t=this._service.Organisation.levelWithID(e),n=this._service.Organisation.buildings.find(e=>e.id===t.building_id);this.system_id=n.systems.desk_bookings}else{const e=this._service.Organisation.building;e&&e.levels.length&&(this.active_level=e.levels[0].id),this.system_id=e.systems.desk_bookings}}get desks_list(){return this.bookings?Object.keys(this.bookings):[]}get on_level(){return!(!this.desks_list||!this.desk||!this.desks_list.find(e=>e===this.desk))}focusDesk(){this.focus=this.desk,this.features=[{id:this.desk,coordinates:null,content:bo.e,data:{text:""}}],this.zoom=2}get map_url(){return(this._service.Organisation.levelWithID(this.active_level)||{map_url:""}).map_url||""}get belongs_to_user(){return this.current_booking&&this.current_booking.email===this.user.email}get available(){return!this.current_booking}processStatuses(){const e={};(this.status_map.desks||[]).forEach(t=>e[`#${t.id}`]=t.styles),this.style_map=e}changeDate(e){const t=this._service.setting("app.booking.desk_start")||9;this.date=O().isSame(O(e),"d")?O().valueOf():O(e).hour(t).startOf("h").valueOf(),this.processDeskBookings()}processDeskBookings(){this.timeout("desk_bookings",()=>{const e=[],t=[];this.on_level?this.focusDesk():(this.focus=null,this.center={x:.5,y:.5},this.zoom=1),this.desks_list.forEach(n=>{const i=this.getBooking(n);this.desk&&n===this.desk&&(this.current_booking=i);const o=i?"unavailable":"available";e.push({id:n,styles:{fill:this.colour_map[`desk-${o}`],stroke:this.colour_map[`desk-${o}-stroke`]},status_id:o}),t.push({id:n,event:"click",callback:()=>{this._router.navigate(["book","desks"],{queryParams:{level:this.active_level,desk:n}})}})}),this.status_map.desks=e,this.processStatuses(),this.listeners=t})}getBooking(e){const t=O(this.date).format("YYYY-MM-DD");if(!(this.bookings&&this.bookings[e]&&this.bookings[e][t]))return null;{const n=this.bookings[e][t];for(const e in n)if(O(this.date).unix()>=n[e].start&&O(this.date).unix()<=n[e].end)return{email:e,start:n[e].start,end:n[e].end,checked_in:n[e].checked_in}}}book(){const e=this._service.Composer.bindings.module(this.system_id,"DeskBookings");e&&e.exec("book",[this.desk,O(this.date).unix()]).then(e=>{this._service.notifySuccess("The desk was booked successfully")})}check_in(){const e=this._service.Composer.bindings.module(this.system_id,"DeskBookings");e&&e.exec("check_in",[this.desk,!0]).then(e=>{this._service.notifySuccess("Checked in successfully")})}check_out(){const e=this._service.Composer.bindings.module(this.system_id,"DeskBookings");e&&e.exec("check_in",[this.desk,!1]).then(e=>{this._service.notifySuccess("Checked out successfully")})}loadLevel(){return localStorage?localStorage.getItem("STAFF.desk.level"):null}onLevelChange(){localStorage&&localStorage.setItem("STAFF.desk.level",this.active_level)}}return e.\u0275fac=function(t){return new(t||e)(l.Qb(c.a),l.Qb(o.a),l.Qb(o.d))},e.\u0275cmp=l.Kb({type:e,selectors:[["booking-desk-flow"]],features:[l.zb],decls:13,vars:13,consts:[[1,"desk-flow"],["class","bindings","hidden","",4,"ngIf"],[3,"zoom","center","src","css","listeners","features","focus","zoomChange","centerChange"],["diameter","32"],[1,"body"],["class","main",4,"ngIf"],["diameter","32",4,"ngIf"],[1,"header"],["overlay","",3,"level","levelChange",4,"ngIf"],[1,"date"],["position","left",3,"ngModel","ngModelChange"],["hidden","",1,"bindings"],["binding","","mod","DeskBookings",3,"model","sys","bind","modelChange"],[1,"main"],[1,"title"],[1,"name"],[3,"class",4,"ngIf"],["class","description",4,"ngIf"],[4,"ngIf"],["class","form-wrapper",4,"ngIf"],[1,"description"],["mat-button","",1,"button",3,"tapped"],[1,"user-name"],[1,"form-wrapper"],[1,"form"],[1,"text"],[3,"ngModel","ngModelChange"],[1,"footer"],["mat-button","","name","confirm",1,"success",3,"tapped"],["overlay","",3,"level","levelChange"]],template:function(e,t){1&e&&(l.Wb(0,"div",0),l.Lc(1,_o,2,3,"div",1),l.Wb(2,"a-map",2),l.lc("zoomChange",(function(e){return t.zoom=e}))("centerChange",(function(e){return t.center=e})),l.Rb(3,"mat-spinner",3),l.Vb(),l.Ub(4),l.Wb(5,"div",4),l.Lc(6,Po,9,6,"div",5),l.Lc(7,Mo,4,0,"div",5),l.Lc(8,xo,1,0,"mat-spinner",6),l.Vb(),l.Tb(),l.Wb(9,"div",7),l.Lc(10,Vo,1,1,"a-map-controls",8),l.Wb(11,"div",9),l.Wb(12,"a-date-field",10),l.lc("ngModelChange",(function(e){return t.changeDate(e)})),l.Vb(),l.Vb(),l.Vb(),l.Vb()),2&e&&(l.Cb(1),l.vc("ngIf",t.system_id),l.Cb(1),l.vc("zoom",t.zoom)("center",t.center)("src",t.map_url)("css",t.style_map)("listeners",t.listeners)("features",t.features)("focus",t.focus),l.Cb(4),l.vc("ngIf",!t.loading&&t.on_level),l.Cb(1),l.vc("ngIf",!t.on_level),l.Cb(1),l.vc("ngIf",t.loading),l.Cb(2),l.vc("ngIf",t.active_level),l.Cb(2),l.vc("ngModel",t.date))},directives:[i.t,bo.d,xe.c,go.a,a.r,a.u,r.a,P.b,x.c,po.a,vo.a],styles:[".desk-flow[_ngcontent-%COMP%]{height:100%;overflow:auto;display:flex;flex-direction:column}.desk-flow[_ngcontent-%COMP%]   a-map[_ngcontent-%COMP%]{height:55%;background-color:#fff}.desk-flow[_ngcontent-%COMP%]   a-map.large[_ngcontent-%COMP%]{height:70%}.desk-flow[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex:1;background-color:rgba(26,47,66,.97);padding:1.5em}.desk-flow[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{height:100%}.desk-flow[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{height:25%;font-size:1.2em;color:#fff}.desk-flow[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{font-weight:700}.desk-flow[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .available[_ngcontent-%COMP%]{color:#43a047}.desk-flow[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .unavailable[_ngcontent-%COMP%]{color:#e53935}.desk-flow[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin:1em 0}.desk-flow[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{margin-top:1em}.desk-flow[_ngcontent-%COMP%]   .user-name[_ngcontent-%COMP%]{color:#1937ea}.desk-flow[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%]{height:75%;display:flex;align-items:flex-start;justify-content:center}.desk-flow[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{background-color:#fff;padding:1em;border-radius:.5em}.desk-flow[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{margin-bottom:.5em}.desk-flow[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:1em}.desk-flow[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{position:absolute;width:100%;display:flex;padding:1em;justify-content:space-between;pointer-events:none}.desk-flow[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{pointer-events:auto}.desk-flow[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   a-map-controls[_ngcontent-%COMP%]{z-index:10}.desk-flow[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{background-color:#fff;z-index:10}"]}),e})();var zo=n("Nuht"),Io=n("DWOX"),Do=n("ocbO"),So=n("4Uey"),Ao=n("p5rm"),$o=n("q/nq"),Lo=n("4kJo"),No=n("A+eD"),jo=n("vJ8U"),To=n("1k4r"),Fo=n("WE8N"),Eo=n("CTJb"),qo=n("opQU"),Ro=n("zx1i"),Bo=n("cH1L"),Go=n("dNgK"),Qo=n("ihCf"),Uo=n("bv9b"),Yo=n("/1cH"),Xo=n("STbY"),Ho=n("q/DJ");n.d(t,"BookingsModule",(function(){return Zo}));const Ko=[{path:":flow",component:m},{path:":flow/:step",component:m},{path:"",redirectTo:"spaces"}];let Zo=(()=>{class e{}return e.\u0275mod=l.Ob({type:e}),e.\u0275inj=l.Nb({factory:function(t){return new(t||e)},imports:[[i.c,o.h.forChild(Ko),b.a,a.l,a.B,r.b]]}),e})();l.Gc(m,[i.q,i.r,i.s,i.t,i.A,i.w,i.x,i.y,i.z,i.u,i.v,o.i,o.e,o.g,o.f,o.j,bo.d,bo.e,bo.f,x.b,x.c,zo.a,s.a,Io.a,M.a,Do.a,So.a,Ao.a,$o.a,Lo.a,No.a,Ui.a,vo.a,jo.a,To.a,go.a,Fo.a,po.a,Eo.a,qo.a,Ro.a,yt.a,P.b,P.a,Bo.b,Go.b,C.e,C.d,C.i,C.f,C.c,V.a,V.b,V.e,V.f,V.g,V.h,V.i,Qo.b,Qo.c,W.a,W.c,xe.a,xe.c,Uo.a,Yo.a,_i.g,_i.f,Yo.d,Yo.c,vi.a,vi.c,K.d,K.a,K.c,K.e,K.b,K.f,_i.j,Xo.e,Xo.b,Xo.d,Xo.a,H.a,H.c,_t.a,_t.c,nt.b,nt.a,k.c,k.d,k.a,k.f,k.e,k.b,de.a,de.b,de.c,de.d,a.H,a.w,a.G,a.c,a.x,a.A,a.a,a.D,a.E,a.z,a.r,a.s,a.C,a.n,a.m,a.y,a.b,a.d,a.u,a.v,a.t,a.g,a.j,a.h,a.k,a.e,r.a,m,ro,Ji,$e,we,re,Qi,Ke,Ri,Fe,Pi,Nt,Dt,ht,y.a,T,be,Wo],[i.b,i.G,i.p,i.k,i.E,i.g,i.C,i.F,i.d,i.f,i.i,i.j,i.l,Ho.b,Ho.c])}}]);